<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01106</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006526</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Computational techniques</subject><subj-group><subject>Split-decomposition method</subject><subj-group><subject>Multiple alignment calculation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject><subj-group><subject>Entropy</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antigen-presenting cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antigen-presenting cells</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>Antigen-presenting cells</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Synthetic protein alignments by CCMgen quantify noise in residue-residue contact prediction</article-title>
<alt-title alt-title-type="running-head">Synthetic protein alignments by CCMgen</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7347-4704</contrib-id>
<name name-style="western">
<surname>Vorberg</surname> <given-names>Susann</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7530-9841</contrib-id>
<name name-style="western">
<surname>Seemayer</surname> <given-names>Stefan</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9642-8244</contrib-id>
<name name-style="western">
<surname>Söding</surname> <given-names>Johannes</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<addr-line>Quantitative and Computational Biology Group, Max-Planck Institute for Biophysical Chemistry, Göttingen, Germany</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Wallner</surname> <given-names>Björn</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Linköping University, SWEDEN</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label>
<p>Current address: BASF SE, Ludwigshafen – Chemical Park, Germany</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">soeding@mpibpc.mpg.de</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>11</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>5</day>
<month>11</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>11</issue>
<elocation-id>e1006526</elocation-id>
<history>
<date date-type="received">
<day>27</day>
<month>6</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>9</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Vorberg et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006526"/>
<abstract>
<p>Compensatory mutations between protein residues in physical contact can manifest themselves as statistical couplings between the corresponding columns in a multiple sequence alignment (MSA) of the protein family. Conversely, large coupling coefficients predict residue contacts. Methods for de-novo protein structure prediction based on this approach are becoming increasingly reliable. Their main limitation is the strong systematic and statistical noise in the estimation of coupling coefficients, which has so far limited their application to very large protein families. While most research has focused on improving predictions by adding external information, little progress has been made to improve the statistical procedure at the core, because our lack of understanding of the sources of noise poses a major obstacle. First, we show theoretically that the expectation value of the coupling score assuming no coupling is proportional to the product of the square roots of the column entropies, and we propose a simple entropy bias correction (EntC) that subtracts out this expectation value. Second, we show that the average product correction (APC) includes the correction of the entropy bias, partly explaining its success. Third, we have developed CCMgen, the first method for simulating protein evolution and generating realistic synthetic MSAs with pairwise statistical residue couplings. Fourth, to learn exact statistical models that reliably reproduce observed alignment statistics, we developed CCMpredPy, an implementation of the persistent contrastive divergence (PCD) method for exact inference. Fifth, we demonstrate how CCMgen and CCMpredPy can facilitate the development of contact prediction methods by analysing the systematic noise contributions from phylogeny and entropy. Using the entropy bias correction, we can disentangle both sources of noise and find that entropy contributes roughly twice as much noise as phylogeny.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Knowledge about the three-dimensional structure of proteins is key to understanding their function and role in biological processes and diseases. The experimental structure determination techniques, such as X-ray crystallography or electron cryo-microscopy, are labour intensive, time-consuming and expensive. Therefore, complementary computational methods to predict a protein’s structure have become indispensable. Over the last years, immense progress has been made in predicting protein structures from their amino acid sequence by utilizing highly accurate predictions of spatial contacts between amino acid residues as constraints in folding simulations. However, contact prediction methods require large numbers of homologous protein sequences in order to discriminate between signal and noise. A major obstacle preventing progress on the statistical methodology is our limited understanding of the different components of noise that are known to affect the predictions. We provide two tools, CCMpredPy and CCMgen, that can be used to learn highly accurate statistical models for contact prediction and to simulate protein evolution according to the statistical constraints between positions of residues as specified by these models, respectively. We showcase their usefulness by quantifying the relative contribution of noise arising from entropy and phylogeny on the predicted contacts, which will facilitate the improvement of the statistical methodology.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>Graduate School of Quantitative Biosciences Munich (QBM)</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7347-4704</contrib-id>
<name name-style="western">
<surname>Vorberg</surname> <given-names>Susann</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>grant GRK 1721</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7530-9841</contrib-id>
<name name-style="western">
<surname>Seemayer</surname> <given-names>Stefan</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>SS is supported by the Deutsche Forschungsgemeinschaft (grant GRK 1721). SV is supported by a fellowship of the Deutsche Forschungsgemeinschaft through the Graduate School of Quantitative Biosciences Munich (QBM), <ext-link ext-link-type="uri" xlink:href="http://qbm.genzentrum.lmu.de/" xlink:type="simple">http://qbm.genzentrum.lmu.de/</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-11-15</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>CCMpredPy and CCMgen are available under GNU AGPL3 at <ext-link ext-link-type="uri" xlink:href="https://github.com/soedinglab/ccmgen" xlink:type="simple">https://github.com/soedinglab/ccmgen</ext-link>. Code reproducing the analysis results can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/soedinglab/ccmgen-scripts" xlink:type="simple">https://github.com/soedinglab/ccmgen-scripts</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>In the course of evolution, proteins are under selective pressure to maintain their function and correspondingly their structure. A possible mechanism to maintain structural integrity is the compensation of deleterious mutations between residue pairs in physical contact, known as compensatory mutations: Upon the mutation of one residue the contacting residue has an increased probability to mutate into a residue that will locally restabilize the protein structure, for instance by regaining a lost interaction between them. In multiple sequence alignments (MSAs) of related proteins, this effect leads to correlations between columns of residues in contact among most protein family members [<xref ref-type="bibr" rid="pcbi.1006526.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref004">4</xref>]. Many of these correlations are indirect, though, and arise through transitive chains of contacting residue pairs [<xref ref-type="bibr" rid="pcbi.1006526.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref008">8</xref>].</p>
<p>By applying statistical techniques that can distinguish mere correlation from direct statistical coupling of residue positions [<xref ref-type="bibr" rid="pcbi.1006526.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref009">9</xref>], many false positive predictions could be eliminated. The adoption of this class of statistical models, known as Markov random fields (MRFs), or Potts models in statistical physics, led to a breakthrough in de-novo (template-free) protein structure prediction: The predicted contacts proved sufficiently accurate to be used as spatial restraints to reliably predict protein 3D structures purely from sequence information [<xref ref-type="bibr" rid="pcbi.1006526.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref020">20</xref>].</p>
<p>The requirement for large MSAs for sufficiently precise predictions has limited the applicability of contact-assisted de-novo protein structure prediction, all the more because large protein families are more likely to contain at least one member whose structure has been solved and which can be used as a template for homology modelling. Therefore, most research has focused on making contact prediction reliable enough for medium-sized protein families [<xref ref-type="bibr" rid="pcbi.1006526.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref025">25</xref>].</p>
<p>The background noise effects arising in residue-residue contact prediction have been postulated to arise from three sources [<xref ref-type="bibr" rid="pcbi.1006526.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref032">32</xref>]: random sampling noise due to the limited number of sequences, phylogenetic noise due to the evolutionary relatedness of sequences in the MSA, and entropic noise or rather bias, which biases high-entropy columns towards higher scores. Unfortunately, the relative contribution and properties of the three different sources of noise are difficult to study in real alignments, mainly because the true values of coupling parameters are not known. In addition, the stochastic noise, entropy-dependent noise and phylogenetic noise cannot be modified independently (for example by subsampling), as these noise sources are indirect, complex consequences of learning on only a limited number of sequences that are statistically dependent on each other according to their phylogenetic relationship.</p>
<p>Many correction schemes for removing noise from the matrix of predicted contact scores have been examined [<xref ref-type="bibr" rid="pcbi.1006526.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref036">36</xref>], and the <italic>average product correction</italic> (<italic>APC</italic>) [<xref ref-type="bibr" rid="pcbi.1006526.ref026">26</xref>] came out as a clear winner and is used in almost all recent studies. However, it is widely acknowledged in the field that our limited understanding of what noise effects APC is correcting and why it is so effectively correcting them is severely impeding progress in developing better statistical methods to predict contacting residue pairs. We repeatedly made the experience that a promising extension to the standard MRF model that considerably improved the contact prediction performance <italic>before</italic> applying the APC was doomed to failure because it inexplicably yielded worse results than the baseline method <italic>after</italic> applying APC.</p>
<p>Based on theoretical considerations (<xref ref-type="sec" rid="sec012">Material and methods</xref>), we propose a simple entropy bias correction (EntC) that is computed solely from per-column entropies of the input MSA and corrects for entropy-dependent bias without affecting noise from phylogenetic effects. We find that the EntC eliminates nearly as much noise as the APC. The observation that both corrections can be expressed as a product of two factors depending only on each column separately explains partly the success of APC and suggests that it mainly corrects for entropy noise. Whereas the APC is applied as a post-correction to the matrix of predicted contact scores, the EntC can be applied directly on the statistical couplings of the MRF model, prior to computing a contact score and other post-processing treatments.</p>
<p>To systematically study the sources of noise limiting the accuracy of contact predictions from MSAs and to facilitate progress in the development of better contact prediction methods, we have developed CCMgen, a method for generating realistic synthetic protein sequence alignments whose residues obey the selection pressures described by a MRF with pairwise statistical couplings between residue positions.</p>
<p>For that purpose, CCMgen requires an exact statistical model that will reliably reproduce the empirical alignment statistics, such as single-site, pairwise or even higher-order amino acid frequencies, of the input MSA that was used to learn the MRF model in the first place. A typical strategy to obtain estimates of the MRF model parameters would involve maximizing the logarithm of the likelihood function over all sequences in the MSA. However, the normalization factor in the likelihood function requires to sum 20<sup><italic>L</italic></sup> terms, where <italic>L</italic> is the protein length, and methods to optimize the full likelihood are very slow for realistic proteins [<xref ref-type="bibr" rid="pcbi.1006526.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref041">41</xref>]. The most popular approximation is to maximize the pseudo-likelihood instead of the likelihood, as it can be shown that it converges to the same solution for large numbers of samples and it is fast to compute [<xref ref-type="bibr" rid="pcbi.1006526.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref044">44</xref>]. Even though pseudo-likelihood maximization gives results of the same quality of predicted residue-residue contacts as those using the full likelihood optimization, several studies unveiled that the pseudo-likelihood model is inaccurate and not able to accurately reproduce the empirical alignment statistics [<xref ref-type="bibr" rid="pcbi.1006526.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref045">45</xref>].</p>
<p>We provide an implementation of an alternative precise inference technique, persistent contrastive divergence (PCD) [<xref ref-type="bibr" rid="pcbi.1006526.ref046">46</xref>] with our tool CCMpredPy. Compared to pseudo-likelihood maximization, PCD achieves identical precision for contact prediction while the inferred MRF model reproduces empirical marginals much more precisely. The increased quality of the models comes at the expense of longer run times, which are however still practical for even large proteins and alignments using a single desktop computer. High quality MRF models learned with PCD might prove beneficial beyond the purpose of contact prediction when problems require exact model statistics, e.g. when studying mutational effects or designing new protein features using the model energies.</p>
<p>Finally, we employ CCMgen in combination with MRF models that have been learned with the PCD algorithm and our entropy bias correction to quantify the relative effect sizes of phylogenetic and entropic bias on the precision of contact prediction. We find that the contribution of entropy noise in contact prediction is on average twice as big as that of phylogenetic noise.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Persistent contrastive divergence allows accurate inference of MRFs</title>
<p>An exactly inferred MRF will reliably reproduce the empirical single-site and pairwise amino acid frequencies, <italic>f</italic><sub><italic>i</italic></sub>(<italic>a</italic>) and <italic>f</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) for all positions <italic>i</italic>, <italic>j</italic> in the MSA and all amino acids <italic>a</italic>, <italic>b</italic> ∈ {1, …, 20} [<xref ref-type="bibr" rid="pcbi.1006526.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref047">47</xref>]. Several studies demonstrated that pseudo-likelihood maximization, while being the method of choice for contact prediction, yields models that cannot accurately reproduce the empirical alignment statistics [<xref ref-type="bibr" rid="pcbi.1006526.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref045">45</xref>].</p>
<p>We developed a method that uses an inference technique called persistent contrastive divergence(PCD) [<xref ref-type="bibr" rid="pcbi.1006526.ref046">46</xref>] to learn MRF models that accurately reproduce the empirical alignment statistics. As in the study by Figliuzzi <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1006526.ref037">37</xref>], we computed for all Pfam MSAs in the PSICOV dataset the single-column and paired-column amino acid frequencies as well as covariances, <inline-formula id="pcbi.1006526.e001"><alternatives><graphic id="pcbi.1006526.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mtext>cov</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>f</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>δ</italic><sub><italic>a</italic>,<italic>x</italic></sub> is the Kronecker symbol. We compared these statistics with those from sequences obtained by Markov chain Monte Carlo (MCMC) sampling from MRFs that were trained on the Pfam MSAs using either pseudo-likelihood maximization or PCD.</p>
<p>We find that the empirical single-site amino acid frequencies are well reproduced by both models. But whereas the empirical pairwise amino acid frequencies and covariances correlate strongly with the corresponding statistics computed from the PCD samples, the correlation is much weaker for samples obtained from pseudo-likelihood MRF models (<xref ref-type="fig" rid="pcbi.1006526.g001">Fig 1A and 1B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006526.s003">S1 Fig</xref>).</p>
<fig id="pcbi.1006526.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006526.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Persistent contrastive divergence permits the inference of high-quality models.</title>
<p><bold>A</bold> and <bold>B</bold> Comparing single amino acid frequencies (left), pairwise amino acid frequencies (center) and covariances (right) computed from natural sequences (Pfam alignment) and from Markov chain Monte Carlo (MCMC) samples generated from Markov random field (MRF) models trained with either pseudo-likelihood maximization (<bold>A</bold>) or persistent contrastive divergence (PCD) (<bold>B</bold>) for protein 1bkrA in the PSICOV dataset. <bold>C</bold> Mean precision of contacts, predicted as (APC corrected) <italic>L</italic><sub>2</sub> norm of pair couplings of a MRF trained with either pseudo-likelihood maximization or PCD. <bold>D</bold> Distribution of run times in minutes when learning MRF models with CCMpredPy (run on 4 cores). The median runtime in minutes with pseudo-likelihood is 7 minutes and with PCD is 43.5 minutes. Dashed line in boxplots represents the mean, solid line represents the median of the distribution. <bold>C</bold> and <bold>D</bold> are computed over the 150 proteins in the PSICOV dataset.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.g001" xlink:type="simple"/>
</fig>
<p>Furthermore, as in Figliuzzi <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1006526.ref037">37</xref>], we investigated how well the generated MCMC samples reproduce the alignment substructure of the original Pfam alignments with respect to the organisation of subfamilies in sequence space. We projected the protein sequences of the MCMC samples onto the first two principle components obtained from a principal component analysis (PCA) of the original Pfam MSA (for details see <xref ref-type="supplementary-material" rid="pcbi.1006526.s002">S2 Text</xref>). Again, we find that the alignment substructure described by the grouping of sequences that can be observed in the two-dimensional PCA space, is reproduced more reliably by MCMC samples generated from PCD models than from pseudo-likelihood models (<xref ref-type="supplementary-material" rid="pcbi.1006526.s004">S2b and S2d Fig</xref>).</p>
<p>It has been argued that for the purpose of predicting residue contacts an approximate model such as those obtained by maximizing the pseudo-likelihood for a MRF is sufficiently accurate to infer the correct topology of the interaction network of residues [<xref ref-type="bibr" rid="pcbi.1006526.ref045">45</xref>]. <xref ref-type="fig" rid="pcbi.1006526.g001">Fig 1C</xref> shows the mean precision of the predicted contacts from a PCD model and a pseudo-likelihood model versus the number of predictions per columns in the MSA. The precision for one MSA is the fraction of correctly predicted contacting pairs of positions (<italic>i</italic>, <italic>j</italic>) out of all predicted pairs. The correctly predicted pairs (<italic>i</italic>, <italic>j</italic>) are those for which the <italic>C</italic><sub><italic>β</italic></sub> − <italic>C</italic><sub><italic>β</italic></sub> distance in the reference protein structure of the Pfam MSA is below 8Å. Residue pairs that are separated by less than six positions along the protein sequence are not considered for the evaluation as they typically correspond to contacts within secondary structure elements and reflect local geometrical constraints. Indeed, predicted contacts from a PCD model achieve equal precision as predictions from a pseudo-likelihood model. <xref ref-type="supplementary-material" rid="pcbi.1006526.s005">S3 Fig</xref> shows further analysis, comparing the APC-corrected contact scores from pseudo-likelihood and PCD models.</p>
<p>However, more complex problems such as prediction of mutational effects or generating realistic samples of sequences, require exact model statistics. Several methods have been developed that exactly infer MRF models, such as bmDCA and ACE [<xref ref-type="bibr" rid="pcbi.1006526.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref041">41</xref>], but they are computationally intensive which renders them impractical for real proteins. In comparison, our PCD-based CCMpredPy method is only about a magnitude slower than pseudo-likelihood maximization (<xref ref-type="fig" rid="pcbi.1006526.g001">Fig 1D</xref>).</p>
</sec>
<sec id="sec004">
<title>Correcting for entropy bias removes a major source of noise</title>
<p>A major obstacle for improving the statistical methods for residue-residue contact prediction is our lack of understanding of the sources of noise. The background noise effects have been postulated to arise from at least three sources, whose size and properties are difficult to quantify: phylogenetic, entropic and sampling noise.</p>
<p>Phylogenetic noise originates from the violation of the assumption of independence of sequences in the MSA [<xref ref-type="bibr" rid="pcbi.1006526.ref048">48</xref>]. This assumption has been made by all methods that have been employed for contact prediction so far. To understand the origin of phylogenetic noise, consider the example in <xref ref-type="fig" rid="pcbi.1006526.g002">Fig 2</xref>. The MSA is composed of two subtrees whose last common ancestor sequences, DSMF and ETMF, had a mutation at the second and first position respectively. All descendants of the first ancestral sequence whose first two residues have not mutated in the meantime will have a DS at first and second position, while all descendants of the other ancestral sequence whose first two residues have not mutated yet will have a ET at those positions. Therefore, pairs DS and ET are more likely than would be expected from the frequencies of D and E in the first column and of S and T in the second column. The first and second position will therefore appear to be statistically coupled even though they are not.</p>
<fig id="pcbi.1006526.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006526.g002</object-id>
<label>Fig 2</label>
<caption>
<title>The phylogenetic dependence of closely related sequences can produce covariation signals.</title>
<p>Here, two independent mutation events (highlighted in red and blue) in two branches of the tree result in a covariation signal for the two affected positions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.g002" xlink:type="simple"/>
</fig>
<p>Entropic bias describes the tight correlation of the expectation value of the contact score <italic>c</italic><sub><italic>ij</italic></sub> between columns <italic>i</italic> and <italic>j</italic> of a MSA under the assumption of no coupling between both columns with the product of the square roots of column entropies <inline-formula id="pcbi.1006526.e002"><alternatives><graphic id="pcbi.1006526.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:msubsup> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mtext>log</mml:mtext> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1006526.e003"><alternatives><graphic id="pcbi.1006526.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:munder><mml:mo>∝</mml:mo> <mml:mo>∼</mml:mo></mml:munder> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup><mml:mspace width="2pt"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>Put simply, higher column entropies lead to higher expected contact scores <italic>c</italic><sub><italic>ij</italic></sub> even if no coupling exists. To understand the origin of this bias, we need a bit of notation. From the MSA we compute coefficients <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) that quantify the statistical coupling between residue <italic>a</italic> ∈ {1, …, 20} occurring in column <italic>i</italic> and residue <italic>b</italic> ∈ {1, …, 20} in column <italic>j</italic> of the same sequence (<xref ref-type="sec" rid="sec012">Materials and methods</xref>). A coefficient <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) = 0.1 signifies that residue <italic>a</italic> in column <italic>i</italic> and residue <italic>b</italic> in column <italic>j</italic> in the same sequence is exp(0.1) times more likely to occur than what would be expected if the amino acids in both columns were independent of each other.</p>
<p>To predict contacts, we estimate the coupling coefficients <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>), for example by maximizing the pseudo-likelihood, and obtain estimates <inline-formula id="pcbi.1006526.e004"><alternatives><graphic id="pcbi.1006526.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, from which we can calculate a score to predict contacts. The commonly used contact score between columns <italic>i</italic> and <italic>j</italic> of a MSA is simply the norm of the 400-dimensional vector <inline-formula id="pcbi.1006526.e005"><alternatives><graphic id="pcbi.1006526.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>,
<disp-formula id="pcbi.1006526.e006"><alternatives><graphic id="pcbi.1006526.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≔</mml:mo> <mml:mo>∥</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>∥</mml:mo> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:msup><mml:mo>)</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>It sums up the squared coupling coefficients over all possibly coupled amino acid pairs.</p>
<p>Let us assume that a MSA has no statistically coupled residue pairs, meaning that the true coupling coefficients are all zero. But the estimation of the coefficients results in errors, which contribute a systematic bias, as we will now see. The regularization of the MRF will ensure that the coupling coefficients <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) for those amino acid pairs (<italic>a</italic>, <italic>b</italic>) without counts will be zero and will therefore not contribute to the overall contact score <italic>c</italic><sub><italic>ij</italic></sub> for this residue pair. For those pairs (<italic>a</italic>, <italic>b</italic>) with one or more counts, the <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) will be distributed around zero but will rarely be exactly zero, just as <italic>f</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) is rarely exactly equal to <italic>f</italic><sub><italic>i</italic></sub>(<italic>a</italic>) × <italic>f</italic><sub><italic>j</italic></sub>(<italic>b</italic>). So each amino acid pair (<italic>a</italic>, <italic>b</italic>) that occurs at least in one sequence will make a contribution <inline-formula id="pcbi.1006526.e007"><alternatives><graphic id="pcbi.1006526.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> to the sum in <xref ref-type="disp-formula" rid="pcbi.1006526.e006">Eq 2</xref>. These contributions to <italic>c</italic><sub><italic>ij</italic></sub> stemming from noisy estimates <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) create a bias that will increase with the number of pairs (<italic>a</italic>, <italic>b</italic>) of bins over which the <italic>N</italic> counts are distributed. Columns with high entropy tend to disperse the counts of amino acid pairs over more bins (<italic>a</italic>, <italic>b</italic>) than columns with low entropy. It is shown in Materials and Methods that the expectation value of this bias on <italic>c</italic><sub><italic>ij</italic></sub> can be approximated by a term proportional to product of the square roots of the entropies of the two columns.</p>
<p>The factorization of the EntC into two factors depending only on each column separately explains partly the success of APC and suggests that it mainly corrects for entropy noise (<xref ref-type="sec" rid="sec012">Materials and methods</xref>).</p>
<p>Sampling noise on the estimated coupling coefficients would remain, even if we correct for entropic bias and phylogenetic effects, because with a finite sample of sequences we cannot estimate fractions arbitrarily accurately. For example even if the sequences could be assumed to be independent of each other, the probability of an amino acid pair (<italic>a</italic>, <italic>b</italic>) that has been observed <italic>n</italic> ≪ <italic>N</italic> times out of <italic>N</italic> is only estimated to a relative accuracy of approximately <inline-formula id="pcbi.1006526.e008"><alternatives><graphic id="pcbi.1006526.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mi>σ</mml:mi> <mml:mo>/</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:mi>n</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>n</mml:mi> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msqrt> <mml:mo>/</mml:mo> <mml:mi>n</mml:mi> <mml:mo>≈</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msqrt><mml:mi>n</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, according to the standard deviation of the binomial distribution. More precisely, whereas the entropy bias describes the systematic offset of the contact score <italic>c</italic><sub><italic>ij</italic></sub> stemming from the non-zero expectation values <inline-formula id="pcbi.1006526.e009"><alternatives><graphic id="pcbi.1006526.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, the sampling noise originates from the <italic>variance</italic> of the coefficients, <inline-formula id="pcbi.1006526.e010"><alternatives><graphic id="pcbi.1006526.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mtext>var</mml:mtext> <mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which is due to the finite number of measurements (sequences) <italic>N</italic> taken.</p>
<sec id="sec005">
<title>The APC and the EntC in action</title>
<p><xref ref-type="fig" rid="pcbi.1006526.g003">Fig 3A</xref> shows the contact scores <italic>c</italic><sub><italic>ij</italic></sub> (see <xref ref-type="disp-formula" rid="pcbi.1006526.e006">Eq 2</xref>) in grey scale computed from a MRF that has been trained from a typical example MSA. The striping patterns in horizontal and vertical directions reflect strong systematic row- and column-dependent score biases. Some positions seem to obtain generally higher scores than others. Without correction, ranking by these scores would severely overpredict contacts between positions with positive score bias and underpredict contacts between positions with negative bias.</p>
<fig id="pcbi.1006526.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006526.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Entropy correction eliminates major source of noise.</title>
<p>Raw and corrected contact score matrices for protein 1c9oA. The gray scale indicates the contact scores for each residue pair (<italic>i</italic>, <italic>j</italic>) for raw uncorrected scores computed from a Markov random field (MRF) model trained with persistent contrastive divergence (PCD) (<bold>A</bold>, <xref ref-type="disp-formula" rid="pcbi.1006526.e006">Eq 2</xref>), average product corrected scores (<bold>B</bold>, <xref ref-type="disp-formula" rid="pcbi.1006526.e038">Eq 17</xref>) and entropy corrected scores (<bold>C</bold>, <xref ref-type="disp-formula" rid="pcbi.1006526.e039">Eq 18</xref>). The striping pattern in <bold>A</bold> arises from systematic score biases, which originate mainly from entropy.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.g003" xlink:type="simple"/>
</fig>
<p>Applying the APC eliminates the systematic effects leading to the striping patterns (<xref ref-type="fig" rid="pcbi.1006526.g003">Fig 3B</xref>). It thereby greatly improves the performance of all contact prediction scores for local pairwise measures such as mutual information as well as for global statistical coupling methods such as the MRF-based contact score referred to here [<xref ref-type="bibr" rid="pcbi.1006526.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref049">49</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref051">51</xref>].</p>
<p>To disentangle the entropic bias from the phylogenetic noise, we first propose an entropy-dependent correction, EntC, of the contact scores <italic>c</italic><sub><italic>ij</italic></sub> that depends solely on the per-column entropies <italic>s</italic><sub><italic>i</italic></sub> of the MSA from which the MRF was trained,
<disp-formula id="pcbi.1006526.e011"><alternatives><graphic id="pcbi.1006526.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>EntC</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>α</mml:mi> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup><mml:mspace width="2pt"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
with an analytically determined constant <italic>α</italic> that depends on all column entropies <italic>s</italic><sub>1</sub>, …, <italic>s</italic><sub><italic>L</italic></sub>. For a motivation of this score, see <xref ref-type="sec" rid="sec012">Materials and methods</xref>. <xref ref-type="fig" rid="pcbi.1006526.g003">Fig 3C</xref> shows how the entropy correction removes almost as much of the striping effects as APC.</p>
<p><xref ref-type="fig" rid="pcbi.1006526.g004">Fig 4A</xref> reveals how strongly these two corrections correlate (see <xref ref-type="supplementary-material" rid="pcbi.1006526.s006">S4 Fig</xref> for the whole data set). Moreover, the correlation is high (Pearson correlation <italic>ρ</italic> = 0.972) also between the column-specific factors in the APC and EntC, that is, <inline-formula id="pcbi.1006526.e014"><alternatives><graphic id="pcbi.1006526.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mo>·</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006526.e015"><alternatives><graphic id="pcbi.1006526.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msqrt><mml:mrow><mml:mi>α</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:math></alternatives></inline-formula> (compare Eqs <xref ref-type="disp-formula" rid="pcbi.1006526.e038">17</xref> and <xref ref-type="disp-formula" rid="pcbi.1006526.e039">18</xref>). To analyze whether the correlation of APC and EntC is influenced by the phylogenetic dependence between the sequences, we generated synthetic MSAs with CCMgen using a binary and a star tree topology and trained an MRF on these two alignments (for details see next section). The correlation between the column-column APC and EntC correction terms remains as high as for the real Pfam MSA (Pearson correlations 0.983 (binary tree) and 0.975 (star tree) versus 0.971 (Pfam MSA)) (see <xref ref-type="fig" rid="pcbi.1006526.g004">Fig 4C and 4D</xref>). These results suggest that the APC predominantly corrects out entropy bias [<xref ref-type="bibr" rid="pcbi.1006526.ref026">26</xref>] rather than phylogenetic bias. Our theoretical analysis in Materials and Methods further supports this (see also the <xref ref-type="sec" rid="sec007">Discussion</xref>).</p>
<fig id="pcbi.1006526.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006526.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The average product correction (APC) and entropy bias correction (EntC) term correlate strongly.</title>
<p><bold>A</bold> For protein 1c9oA in the PSICOV data set the correction defined by the APC correlates well with the correction determined by our entropy bias correction strategy when learning a Markov random field (MRF) model with persistent contrastive divergence (PCD). <bold>B</bold> Also the factors appearing in the APC and EntC corrections, <inline-formula id="pcbi.1006526.e012"><alternatives><graphic id="pcbi.1006526.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mo>·</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006526.e013"><alternatives><graphic id="pcbi.1006526.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msqrt><mml:mrow><mml:mi>α</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:math></alternatives></inline-formula>., correlate well. <bold>C,D</bold> The Pearson correlation is similarly large when the MRF model is learnt from synthetic alignments generated with CCMgen using binary tree topologies (<bold>C</bold>) or using star tree topologies (<bold>D</bold>), both in the example of protein 1c9oA shown here and also across all 150 proteins in the Pfam dataset (<xref ref-type="supplementary-material" rid="pcbi.1006526.s006">S4 Fig</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.g004" xlink:type="simple"/>
</fig>
<p>However, the relative contributions of entropic and phylogenetic noise limiting the precision of contact prediction are yet unclear. In the following we will use our tool CCMgen to distinguish between both sources of noise.</p>
</sec>
</sec>
<sec id="sec006">
<title>Quantifying noise effects with CCMgen reveals entropy as dominating source of noise</title>
<p>Our workflow to analyse the relative contributions of noise sources is described in <xref ref-type="fig" rid="pcbi.1006526.g005">Fig 5</xref>. First, we estimate the parameters of a second order MRF model with PCD using CCMpredPy for each of the 150 Pfam MSAs in the PSICOV data set. To obtain models with few but precise constraints, we set coupling parameters to zero for non-contacting residue pairs (<italic>C</italic><sub><italic>β</italic></sub> distance &gt;12Å) during parameter learning.</p>
<fig id="pcbi.1006526.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006526.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Workflow for quantifying noise effects.</title>
<p>Artificial multiple sequence alignments (MSAs) are generated with CCMgen using a binary tree phylogeny for sequences with strong interdependencies and using a star tree phylogeny for nearly independently sampled sequences. Then, contacts are predicted and post-corrected using the average product correction (APC) and entropy bias correction (EntC)for both sets of alignments.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.g005" xlink:type="simple"/>
</fig>
<p>In a second step, we use CCMgen with the learned model parameters to generate realistic synthetic MSAs of interdependent sequences with pairwise statistical couplings between some positions as they are observed in MSAs between residues in physical contact. CCMgen provides full control over the generation of the synthetic MSAs by allowing us to specify the evolutionary times and phylogeny along which the sequences are sampled. We sample two sets of synthetic MSAs: one set with a star tree topology and the other with a binary tree topology (<xref ref-type="fig" rid="pcbi.1006526.g006">Fig 6</xref>). Given sufficient evolutionary time, the phylogenetic dependencies between sequences drawn according to the star tree topology should be negligible, whereas sequences drawn along the binary tree are expected to contain stronger interdependencies.</p>
<fig id="pcbi.1006526.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006526.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Idealized phylogenetic tree topologies available with CCMgen.</title>
<p>CCMgen can generate multiple sequence alignments (MSAs) based on a Markov random field (MRF) model and a phylogenetic tree supplied either as Newick file or as one of the two shown, idealized topologies: <bold>A</bold> binary tree and <bold>B</bold> star-shaped tree.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.g006" xlink:type="simple"/>
</fig>
<p>Because the accuracy of predictions strongly depends on alignment depth and diversity [<xref ref-type="bibr" rid="pcbi.1006526.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref052">52</xref>], we ensured that the synthetic alignments contain the same number of sequences and have similar diversities as the original Pfam alignments (for details see <xref ref-type="sec" rid="sec012">Material and methods</xref>). These provisions justify a direct comparison of the results for sampling sequences along the star and binary topologies.</p>
<p>Third, we run CCMpredPy on each of the synthetic MSAs and predict residue-residue contacts by ranking the pairs according to the descending raw contact scores (<xref ref-type="disp-formula" rid="pcbi.1006526.e006">Eq 2</xref>), or by the APC-corrected contact scores (<xref ref-type="disp-formula" rid="pcbi.1006526.e038">Eq 17</xref>) or by entropy corrected scores (<xref ref-type="disp-formula" rid="pcbi.1006526.e039">Eq 18</xref>). Since we know the ground truth of which pairs are coupled from the MRF model used for generating the synthetic MSAs, we can use these alignments to investigate and quantify the effect of phylogenetic noise on the precision of residue-residue contact prediction.</p>
<p><xref ref-type="fig" rid="pcbi.1006526.g007">Fig 7A and 7B</xref> plot the mean precision of the predicted contacts from both types of synthetic MSAs versus the number of predictions per columns in the MSA. As expected, the mean precision drops as more predictions are considered and lower ranks are included.</p>
<fig id="pcbi.1006526.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006526.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Effect of phylogenetic noise on contact prediction accuracy.</title>
<p>MSAs generated with phylogenetic trees with star topologies do not contain phylogenetic noise. Therefore, the entropic bias is fully responsible for the difference in mean precision of predicted contacts between the uncorrected raw coupling scores (green) in (<bold>B</bold>) and the APC- or EntC-corrected scores. On MSAs generated with binary tree topologies, the precision of EntC-corrected scores drops due to phylogenetic noise (<bold>A</bold>). APC seems to correct out a small fraction of this noise, whereas EntC can only correct for entropy-related bias. (<bold>C</bold>) We can estimate the effect of phylogenetic noise as the drop in precision of the entropy-corrected scores (blue) from binary to star tree topology.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.g007" xlink:type="simple"/>
</fig>
<p>Both APC and EntC correction have a huge effect in reducing noise and increasing the precision of predictions. Both corrections give very similar results for MSAs generated with star topology trees, which are not expected to show phylogenetic noise, while the APC performs slightly better than the EntC on MSAs with binary tree topologies. This suggests that the APC corrects out a small part of the phylogenetic noise. This would be plausible because this noise source affects some positions more than others (<xref ref-type="fig" rid="pcbi.1006526.g002">Fig 2</xref>) and would thereby also cause striping, which could be corrected by APC.</p>
<p>We estimate the strength of the phylogenetic noise as the drop in precision between the EntC-corrected precisions on MSAs with star topology and EntC-corrected precision on the MSAs with binary tree topology (<xref ref-type="fig" rid="pcbi.1006526.g007">Fig 7C</xref>). The strength of the entropy noise is shown in terms of the drop in precision between the EntC-corrected and uncorrected, raw contact scores, both for the star tree topology and for the binary tree topology. The contribution of entropy noise to the drop in precision is roughly two times larger than that of the phylogenetic noise.</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<sec id="sec008">
<title>The average product correction explained</title>
<p>The success of the average product correction (APC) (<xref ref-type="disp-formula" rid="pcbi.1006526.e038">Eq 17</xref>) is in part explained by three key insights: First, as we have seen, the entropy bias explains a large part of the noise in residue contact prediction. Second, as shown in Material and Methods, the EntC factorizes over columns, that is, it can be written as a product of two factors, each of which depends only on one column. Third, as we show now, the APC boils down to subtracting from the score <italic>c</italic><sub><italic>ij</italic></sub> an approximation to its expectation value under the null model of no couplings, if this expectation value factorizes into two terms, each of which depend only on one column,
<disp-formula id="pcbi.1006526.e016"><alternatives><graphic id="pcbi.1006526.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>Taken together, these three insights explain why the APC includes the EntC, which corrects for most of the bias.</p>
<p>To demonstrate the third insight, we approximate
<disp-formula id="pcbi.1006526.e017"><alternatives><graphic id="pcbi.1006526.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mstyle><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≈</mml:mo> <mml:mstyle><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover></mml:mstyle> <mml:mi>E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mstyle><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mo>•</mml:mo></mml:msub></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
<disp-formula id="pcbi.1006526.e018"><alternatives><graphic id="pcbi.1006526.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>•</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mstyle><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≈</mml:mo> <mml:mstyle><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover></mml:mstyle> <mml:mi>E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mstyle><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover></mml:mstyle> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>〈</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mo>•</mml:mo></mml:msub> <mml:mo>〉</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
because the sum over <italic>L</italic> terms averages out the fluctuations around the expectation value of each term. This approximation is probably the reason why the APC works better on <italic>c</italic><sub><italic>ij</italic></sub> than on <inline-formula id="pcbi.1006526.e019"><alternatives><graphic id="pcbi.1006526.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> because for <inline-formula id="pcbi.1006526.e020"><alternatives><graphic id="pcbi.1006526.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> the values in the sum are much more dispersed and dominated by one or a few terms, which renders the above approximation much less accurate. The APC correction is then
<disp-formula id="pcbi.1006526.e021"><alternatives><graphic id="pcbi.1006526.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mo>•</mml:mo></mml:msub></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mo>•</mml:mo></mml:msub></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow> <mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mo>•</mml:mo></mml:msub></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>Hence the APC subtracts approximately the expectation value from <italic>c</italic><sub><italic>ij</italic></sub> if it factorizes over columns.</p>
</sec>
<sec id="sec009">
<title>EntC can overcome a major impediment to progress, the APC</title>
<p>As we have seen, the success of the average product correction (APC) (and other denoising techniques such as LRS [<xref ref-type="bibr" rid="pcbi.1006526.ref033">33</xref>]) depends on the specific form of the bias it can correct. The combination of pseudo-likelihood maximization, <italic>L</italic><sub>2</sub> regularization, and the definition of the contact score as the norm of the coupling vector <inline-formula id="pcbi.1006526.e022"><alternatives><graphic id="pcbi.1006526.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mrow><mml:mo>∥</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> lead to a factorized form of the entropy, the leading cause of bias to correct for. It is plausible that changing the statistical model, its method of optimization, the regularization, or the contact score will usually result in the entropy bias to <italic>not</italic> factorize any more. For example, exchanging the <italic>L</italic><sub>2</sub> regularization by an <italic>L</italic><sub>1</sub> regularization destroys the factorization property. Therefore, even though the latter regularizer might work better, it can still perform worse after APC because APC does not correct its entropy bias well any more. A potentially very valuable result of this work is therefore the insight into what the APC actually corrects. If we can work out the expectation value of the contact score under the <italic>L</italic><sub>1</sub> regularization, for example, we could apply the appropriate entropy bias correction specifically for that model and regularization.</p>
<p>As another example, consider the following contact score, which uses amino acid pair-specific weights <italic>β</italic><sub><italic>ab</italic></sub> to upweight those pairs that are more predictive of contacts than others:
<disp-formula id="pcbi.1006526.e023"><alternatives><graphic id="pcbi.1006526.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula></p>
<p>The expectation value of this score does not factorize into separate terms for <italic>i</italic> and <italic>j</italic> any more and therefore the average product correction fails. Similarly, even neural networks would have a hard time to combine the coupling coefficients <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>)<sup>2</sup> while learning to subtract the correct expectation value at the same time. This explains why it has been so difficult to improve on the popular combination of <italic>L</italic><sub>2</sub> regularization and contact score <inline-formula id="pcbi.1006526.e024"><alternatives><graphic id="pcbi.1006526.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>∥</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>∥</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in combination with the APC.</p>
<p>But by subtracting the correct expectation value for each pair (<italic>a</italic>, <italic>b</italic>),
<disp-formula id="pcbi.1006526.e025"><alternatives><graphic id="pcbi.1006526.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mrow><mml:mi>E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mfrac><mml:msup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:msubsup><mml:mo>λ</mml:mo> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
we should be able to overcome this roadblock. For instance we can now define a score with weights <italic>β</italic><sub><italic>ab</italic></sub> whose expectation value under the null model is near 0, as it should,
<disp-formula id="pcbi.1006526.e026"><alternatives><graphic id="pcbi.1006526.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>(</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:mi>E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula></p>
<p>This equation allows for the correction of individual couplings <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>). It could therefore be used to train deep neural networks directly on the EntC-corrected coupling coefficients <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>), combining the advantages of entropy correction with learning directly from the full set of coupling coefficients [<xref ref-type="bibr" rid="pcbi.1006526.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref024">24</xref>] instead of only from their EntC-corrected norms ∥<italic>w</italic><sub><italic>ij</italic></sub>∥, as given in <xref ref-type="disp-formula" rid="pcbi.1006526.e011">Eq 3</xref>.</p>
</sec>
<sec id="sec010">
<title>Persistent contrastive divergence facilitates inference of high quality models</title>
<p>Pseudo-likelihood maximization is the state-of-the-art inference technique for MRF models in contact prediction. Whereas the approximate nature of the model is sufficient for the correct ranking of residue pairs, the model is not exact in a way that it can reliably reproduce the empirical amino acid statistics of the original MSA. We implemented an alternative inference technique for MRFs, known as persistent contrastive divergence (PCD) which yields similar precision for predicted contacts but permits learning the fine statistics of the MRF model with higher precision. Even though other accurate model inference methods such as ACE [<xref ref-type="bibr" rid="pcbi.1006526.ref039">39</xref>] or bmDCA [<xref ref-type="bibr" rid="pcbi.1006526.ref037">37</xref>] can infer model parameters up to arbitrary precision, they are computationally intensive and their applicability is limited to small proteins. On the PSICOV dataset, our open source Python implementation of the PCD algorithm, CCMpredPy, was only about seven times slower than pseudo-likelihood maximization. (Its speed is proportional to the number of Markov chains and thereby depends on the required accuracy.) CCMpredPy might therefore be of use for large-scale studies that require exact models, such as investigating mutational effects or designing new protein features.</p>
</sec>
<sec id="sec011">
<title>CCMgen allows the generation of realistic synthetic alignments</title>
<p>We developed CCMgen, the first tool for generating realistic MSAs of protein sequences for a given phylogenetic tree whose residues follow the pairwise coupling constraints from a Markov random field model. CCMgen provides full control of parameters that determine the interdependencies between sequences through the specification of the phylogenetic topology and the evolutionary rate of the sampling process. It enables to distinguish different sources of noise observed in alignments and how they affect the performance of residue-residue contact predictions. We believe CCMgen will prove to be useful for improving and validating contact prediction methods.</p>
<p>In this study, we demonstrated how CCMgen can be applied to analyse the noise contributions from entropy and phylogeny. Given MRF models learnt on real MSAs, we generated synthetic MSAs with statistically coupled amino acid columns from two types of phylogenetic trees, one in which the sequences are maximally independent (star topology) and one in which the statistical dependences are much stronger (binary tree). By predicting contacts from the two types of synthetic alignments and correcting the predicted contacts either with the APC or with our proposed entropy bias correction, we were able to elucidate the effect of phylogenetic and entropic noise on contact prediction accuracy.</p>
<p>According to the quantification of noise effects, the most important goal for residue-residue contact prediction is an accurate treatment of entropic bias, as it accounts for roughly twice the amount of correctable noise and is especially important for correctly identifying the strongest evolutionary couplings. However, phylogenetic noise has an important contribution to the predictions and only a fraction of it is probably corrected by the popular average product correction (APC). This result shows that it might be very worthwhile to develop methods for contact prediction and for learning of MRFs that can explicitly take the statistical dependencies of sequences by common descent into account.</p>
</sec>
</sec>
<sec id="sec012" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec013">
<title>Recap: MRFs model statistical couplings between columns in a MSA</title>
<p>To predict contacts between residues, a popular approach is to train a Markov random field (MRF) model describing the probability to observe a sequence <bold>x</bold> = (<italic>x</italic><sub>1</sub>, …, <italic>x</italic><sub><italic>L</italic></sub>) of length <italic>L</italic> with <italic>x</italic><sub><italic>i</italic></sub> ∈ {1, …, 20} representing the 20 amino acids,
<disp-formula id="pcbi.1006526.e027"><alternatives><graphic id="pcbi.1006526.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>Z</mml:mi></mml:mfrac> <mml:mtext>exp</mml:mtext> <mml:mspace width="-0.166667em"/><mml:mo>(</mml:mo> <mml:mspace width="-0.166667em"/><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="-0.166667em"/><mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula></p>
<p>The couplings <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) describe the preference to find amino acid <italic>a</italic> at position <italic>i</italic> and <italic>b</italic> at <italic>j</italic> in the same sequence in relation to the probability if these positions were independent, as parametrized by the single-column amino acid preferences <italic>v</italic><sub><italic>i</italic></sub>(<italic>a</italic>). <italic>Z</italic> is the normalization constant, equal to the sum of the exp function in the numerator summed over all possible 20<sup><italic>L</italic></sup> sequences.</p>
<p>To estimate the parameters <italic>v</italic><sub><italic>i</italic></sub>(<italic>a</italic>) and <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) of the MRF, the logarithm of the likelihood for all sequences in the MSA, equal to the sum over the log-likelihood of each sequence <bold>x</bold><sub><italic>n</italic></sub>, could be maximized: <inline-formula id="pcbi.1006526.e028"><alternatives><graphic id="pcbi.1006526.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mtext>log</mml:mtext> <mml:mspace width="4pt"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>→</mml:mo> <mml:mtext>max</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula>. A regularization term that pushes all parameters towards zero needs to be added to prevent overtraining, most commonly a <italic>L</italic><sub>2</sub> penalty,
<disp-formula id="pcbi.1006526.e029"><alternatives><graphic id="pcbi.1006526.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mrow><mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>λ</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mspace width="0.277778em"/><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<p>But the huge number 20<sup><italic>L</italic></sup> of terms in <italic>Z</italic> renders an exact solution infeasible for realistic protein lengths.</p>
<p>A number of approximations have been developed for this general class of problems. The approach that has consistently been found to work best for residue contact prediction is the pseudo-likelihood approximation, in which we replace the likelihood with the pseudo-likelihood and maximize the regularized log pseudo-likelihood [<xref ref-type="bibr" rid="pcbi.1006526.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1006526.ref044">44</xref>],
<disp-formula id="pcbi.1006526.e030"><alternatives><graphic id="pcbi.1006526.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>x</mml:mi></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mo>\</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>P</mml:mi><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>:</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>Z</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>L</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mo>→</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>v</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle></mml:mrow></mml:munder><mml:mtext>max</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
<p>Here, <bold>x</bold><sub><italic>n</italic>,∖<italic>i</italic></sub> denotes the vector obtained from <bold>x</bold><sub><italic>n</italic></sub> by removing the i’th component and <inline-formula id="pcbi.1006526.e031"><alternatives><graphic id="pcbi.1006526.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:msubsup> <mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>:</mml:mo> <mml:mi>j</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is a normalization constant, which can therefore be evaluated easily. The second product runs over all columns <italic>i</italic> for which <italic>x</italic><sub><italic>ni</italic></sub> is not a gap (represented by a 0).</p>
<p>Once the parameters <bold>v</bold>, <bold>w</bold> are estimated from a MSA, we can predict contacts for pairs of positions <italic>i</italic> and <italic>j</italic> using their statistical couplings. The most widely used score for residue contact prediction simply takes the <italic>L</italic><sub>2</sub> norm ∥<bold>w</bold><sub><italic>ij</italic></sub>∥<sub>2</sub> of the 20 × 20-dimensional vector <bold>w</bold><sub><italic>ij</italic></sub> with elements <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) (<xref ref-type="disp-formula" rid="pcbi.1006526.e006">Eq 2</xref>) [<xref ref-type="bibr" rid="pcbi.1006526.ref042">42</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref051">51</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref053">53</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref054">54</xref>]. In this study, we chose the regularization strength λ = 0.2(<italic>L</italic> − 1) [<xref ref-type="bibr" rid="pcbi.1006526.ref051">51</xref>].</p>
</sec>
<sec id="sec014">
<title>Sequence weighting and gap treatment</title>
<p>Sequences in a MSA do not represent independent draws from a probabilistic model. To reduce the effects of redundant sequences, we employ a popular sequence reweighting strategy that has been found to improve contact prediction performance. Every sequence <italic>x</italic><sub><italic>n</italic></sub> of length <italic>L</italic> with <italic>n</italic> ∈ {1, …, <italic>N</italic>} in an alignment with <italic>N</italic> sequences has an associated weight <italic>ω</italic><sub><italic>n</italic></sub> = 1/<italic>m</italic><sub><italic>n</italic></sub>, where <italic>m</italic><sub><italic>n</italic></sub> represents the number of similar sequences:
<disp-formula id="pcbi.1006526.e032"><alternatives><graphic id="pcbi.1006526.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>Id</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>8</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
<disp-formula id="pcbi.1006526.e033"><alternatives><graphic id="pcbi.1006526.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mrow><mml:mtext>Id</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>L</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula></p>
<p>An identity threshold of 0.8 has been used for all analyses. Amino acid counts and frequencies are computed with respect to the sequence weights. For example,
<disp-formula id="pcbi.1006526.e034"><alternatives><graphic id="pcbi.1006526.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mi>ω</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mi>ω</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula>
is the weighted fraction of sequences that have an amino acid <italic>a</italic> in column <italic>i</italic>.</p>
<p>We treat gaps as missing information and not as a 21st character. An example is <xref ref-type="disp-formula" rid="pcbi.1006526.e030">Eq 13</xref>, where the second product runs over all MSA columns <italic>i</italic> except those having a gap in sequence <italic>n</italic>, <italic>x</italic><sub><italic>ni</italic></sub> = 0. This gap treatment leads to very minor changes both to the results and to the equations with respect to treating gaps as 21st character, e.g. the weighted number of sequences <inline-formula id="pcbi.1006526.e035"><alternatives><graphic id="pcbi.1006526.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>ω</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> gets replaced by <inline-formula id="pcbi.1006526.e036"><alternatives><graphic id="pcbi.1006526.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>ω</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>≠</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (the summed weight of sequences that do not contain a gap at positions <italic>i</italic> of the MSA), or by <inline-formula id="pcbi.1006526.e037"><alternatives><graphic id="pcbi.1006526.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>ω</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>≠</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>≠</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. See, for example, Eqs <xref ref-type="disp-formula" rid="pcbi.1006526.e052">24</xref> and <xref ref-type="disp-formula" rid="pcbi.1006526.e074">31</xref> (for details see subsection 3.7.2 of PhD thesis of Susann Vorberg, available from <email xlink:type="simple">soeding@mpibpc.mpg.de</email>).</p>
</sec>
<sec id="sec015">
<title>Recap: Average product correction</title>
<p>The APC subtracts from each score <italic>c</italic><sub><italic>ij</italic></sub> = ∥<bold>w</bold><sub><italic>ij</italic></sub>∥<sub>2</sub> the product of the average score <italic>c</italic><sub><italic>i</italic>•</sub> for row <italic>i</italic> times the average score <italic>c</italic><sub><italic>j</italic>•</sub> for column <italic>j</italic> divided by the average score <italic>c</italic><sub>••</sub> over all cells [<xref ref-type="bibr" rid="pcbi.1006526.ref026">26</xref>]:
<disp-formula id="pcbi.1006526.e038"><alternatives><graphic id="pcbi.1006526.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mtext>APC</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>•</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>•</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>•</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
The APC ensures that the average of the corrected coupling score over each column and over each row is 0. This can be verified by summing <xref ref-type="disp-formula" rid="pcbi.1006526.e038">Eq 17</xref> over all <italic>i</italic> or <italic>j</italic>. The assumption made is that, since each residue is only in contact with a small fraction of all residues, the mean coupling score over a column or row is dominated by the systematic score bias on all pairs in the column or row rather than by the coupling scores on a small fraction of contacting residues. APC can also be interpreted as an approximation to the first principal component of the raw contact matrix [<xref ref-type="bibr" rid="pcbi.1006526.ref033">33</xref>]. It therefore removes the highest variability in the raw contact matrix that is assumed to arise from background biases.</p>
</sec>
<sec id="sec016">
<title>Entropy correction</title>
<p>We define the following entropy bias correction (EntC), which depends solely on the per-column entropies of the MSA from which the MRF was trained:
<disp-formula id="pcbi.1006526.e039"><alternatives><graphic id="pcbi.1006526.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mtext>EC</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>α</mml:mi> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup><mml:mspace width="2pt"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
where <italic>α</italic> is a coefficient determining the strength of the correction, and
<disp-formula id="pcbi.1006526.e040"><alternatives><graphic id="pcbi.1006526.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mtext>log</mml:mtext> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>f</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
is the entropy of column <italic>i</italic>.</p>
<p>We determine <italic>α</italic> by analytically minimizing the sum of squares of the corrected off-diagonal coupling scores,
<disp-formula id="pcbi.1006526.e041"><alternatives><graphic id="pcbi.1006526.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>α</mml:mi> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup><mml:mspace width="2pt"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup> <mml:msup><mml:mo>)</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mo>→</mml:mo> <mml:munder><mml:mtext>min</mml:mtext> <mml:mi>α</mml:mi></mml:munder> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula></p>
<p>By setting the derivative to zero we obtain the optimal <italic>α</italic> value,
<disp-formula id="pcbi.1006526.e042"><alternatives><graphic id="pcbi.1006526.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mrow><mml:mi>α</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:msubsup> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup><mml:mspace width="2pt"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula></p>
<p>We also investigated other correction strategies using entropy statistics computed from the input MSA, such as the joint entropy for pairs of columns or different exponents in <xref ref-type="disp-formula" rid="pcbi.1006526.e039">Eq 18</xref>. The resulting variations of the entropy correction performed comparably regarding the average correlation with APC as well as precision of contact predictions.</p>
</sec>
<sec id="sec017">
<title>Quantitative motivation of the entropy correction</title>
<p>We are given an MSA under the model that the sequences evolved under no pair couplings, that is, <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) = 0 for all columns <italic>i</italic>, <italic>j</italic> and all amino acids <italic>a</italic>, <italic>b</italic>. The square of the coupling score for columns <italic>i</italic> and <italic>j</italic> is <inline-formula id="pcbi.1006526.e043"><alternatives><graphic id="pcbi.1006526.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:msubsup> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006526.e044"><alternatives><graphic id="pcbi.1006526.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are our estimates of the coupling coefficients learnt by maximizing the regularized pseudo-likelihood <italic>PL</italic>(<bold>v</bold>, <bold>w</bold>) in <xref ref-type="disp-formula" rid="pcbi.1006526.e030">Eq 13</xref>. Our task is to calculate the expectation value of the coupling scores <inline-formula id="pcbi.1006526.e045"><alternatives><graphic id="pcbi.1006526.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:msubsup> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:msup><mml:mo>)</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. This expectation value under the null model of no couplings will be subtracted from the score to obtain the entropy-corrected score. For simplicity, we first assume that all sequences are independent draws from an MRF (with zero pair couplings).</p>
<p>From <xref ref-type="disp-formula" rid="pcbi.1006526.e030">Eq 13</xref> we derive the logarithm of the regularized pseudo-likelihood,
<disp-formula id="pcbi.1006526.e046"><alternatives><graphic id="pcbi.1006526.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mspace width="-0.166667em"/><mml:mi>L</mml:mi> <mml:mspace width="-0.166667em"/><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow></mml:msub> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>:</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>≠</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mspace width="-0.166667em"/><mml:mo>(</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>:</mml:mo> <mml:mi>j</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mtext>log</mml:mtext> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="-0.166667em"/><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mo>λ</mml:mo> <mml:mn>2</mml:mn></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:mspace width="-0.166667em"/><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula></p>
<p>At the local and global optimum, its partial derivatives with respect to the coupling coefficients must vanish:
<disp-formula id="pcbi.1006526.e047"><alternatives><graphic id="pcbi.1006526.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mspace width="0.166667em"/><mml:mi>P</mml:mi> <mml:mspace width="-0.166667em"/><mml:mi>L</mml:mi> <mml:mspace width="-0.166667em"/><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>:</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>≠</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:mspace width="0.166667em"/><mml:mi>P</mml:mi> <mml:mspace width="-0.166667em"/><mml:mi>L</mml:mi> <mml:mspace width="-0.166667em"/><mml:msub><mml:mi>L</mml:mi><mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>:</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>≠</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mspace width="0.166667em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mo>\</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mo>λ</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <inline-formula id="pcbi.1006526.e048"><alternatives><graphic id="pcbi.1006526.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>≔</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> counts how often <italic>a</italic> appears in column <italic>i</italic> at the same time as <italic>b</italic> in column <italic>j</italic>.</p>
<p>Under the hypothesis that none of the columns is coupled to any other and that the regularization λ is sufficiently strong, the estimated coupling coefficients <inline-formula id="pcbi.1006526.e049"><alternatives><graphic id="pcbi.1006526.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> will all be fairly small and scattered around zero. Therefore, the model probabilities <inline-formula id="pcbi.1006526.e050"><alternatives><graphic id="pcbi.1006526.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mo>\</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">v</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> can be approximated by the empirical frequency <inline-formula id="pcbi.1006526.e051"><alternatives><graphic id="pcbi.1006526.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>≔</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Hence <xref ref-type="disp-formula" rid="pcbi.1006526.e047">Eq 23</xref> reduces to
<disp-formula id="pcbi.1006526.e052"><alternatives><graphic id="pcbi.1006526.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mrow><mml:mo>λ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>≈</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mfrac><mml:mi>N</mml:mi> <mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mfrac> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.166667em"/><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mspace width="-0.166667em"/><mml:mo>≠</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(24)</label></disp-formula></p>
<p>Because under the null model gaps at position <italic>i</italic> occur approximately independently from <italic>b</italic> at <italic>j</italic>, <inline-formula id="pcbi.1006526.e053"><alternatives><graphic id="pcbi.1006526.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mspace width="-0.166667em"/><mml:mo>≠</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mspace width="-0.166667em"/><mml:mo>≠</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi>N</mml:mi> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, we obtain
<disp-formula id="pcbi.1006526.e054"><alternatives><graphic id="pcbi.1006526.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mrow><mml:mo>λ</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>≈</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>N</mml:mi> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(25)</label></disp-formula></p>
<p>We now show that the counts <italic>n</italic><sub><italic>ijab</italic></sub> are distributed according to a <italic>hypergeometric distribution</italic>,
<disp-formula id="pcbi.1006526.e055"><alternatives><graphic id="pcbi.1006526.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>Hypergeom</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>=</mml:mo><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mi>K</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(26)</label></disp-formula>
with <italic>k</italic> = <italic>n</italic><sub><italic>ijab</italic></sub>|, <italic>n</italic> = <italic>Nf</italic><sub><italic>ia</italic></sub>, and <italic>K</italic> = <italic>Nf</italic><sub><italic>jb</italic></sub>. Suppose you draw <italic>n</italic> objects (here: sequences) without replacement from a set of <italic>N</italic> objects, and <italic>K</italic> of these <italic>N</italic> objects have a certain feature (here: <italic>x</italic><sub><italic>nj</italic></sub> = <italic>b</italic>) while <italic>N</italic> − <italic>K</italic> don’t. Then the probability that <italic>k</italic> out of the <italic>n</italic> drawn objects have the feature is given by the hypergeometric distribution. In our case, the subset of objects = sequences that is drawn is the set of <italic>n</italic> = <italic>Nf</italic><sub><italic>ia</italic></sub> sequences that have an <italic>a</italic> in column <italic>i</italic>. The number <italic>n</italic><sub><italic>ijab</italic></sub> of these sequences that also have the feature <italic>x</italic><sub><italic>nj</italic></sub> = <italic>b</italic> is therefore distributed according to the hypergeomteric distribution.</p>
<p>The expectation value for a variable <italic>k</italic> = <italic>n</italic><sub><italic>ijab</italic></sub> is E[<italic>n</italic><sub><italic>ijab</italic></sub>] = <italic>nK</italic>/<italic>N</italic> = <italic>N</italic> <italic>f</italic><sub><italic>ia</italic></sub> <italic>f</italic><sub><italic>jb</italic></sub>. Therefore, the square of the coupling score <italic>c</italic><sub><italic>ij</italic></sub> can be expressed as
<disp-formula id="pcbi.1006526.e056"><alternatives><graphic id="pcbi.1006526.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold">w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>≈</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mo>λ</mml:mo> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mtext>E</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mi>a</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:msup><mml:mo>)</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula></p>
<p>The expectation value of the numerator is (<italic>n</italic><sub><italic>ijab</italic></sub> − E[<italic>n</italic><sub><italic>ijab</italic></sub>])<sup>2</sup> = var[<italic>n</italic><sub><italic>ijab</italic></sub>] which is <inline-formula id="pcbi.1006526.e057"><alternatives><graphic id="pcbi.1006526.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:mfrac><mml:mrow><mml:mi>n</mml:mi> <mml:mi>K</mml:mi></mml:mrow> <mml:mi>N</mml:mi></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mi>K</mml:mi></mml:mrow> <mml:mi>N</mml:mi></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, or, using our notation <italic>n</italic> = <italic>Nf</italic><sub><italic>ia</italic></sub>, and <italic>K</italic> = <italic>Nf</italic><sub><italic>jb</italic></sub>,
<disp-formula id="pcbi.1006526.e058"><alternatives><graphic id="pcbi.1006526.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msup><mml:mo>λ</mml:mo> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:mfrac><mml:mrow><mml:mi>N</mml:mi> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi>N</mml:mi> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>≈</mml:mo> <mml:mfrac><mml:msup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:msup><mml:mo>λ</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:munderover> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula></p>
<p>Remarkably, the expectation value factorizes into a term depending only on <italic>i</italic> and one depending only on <italic>j</italic>. The factorization is in fact the reason why the APC (<xref ref-type="disp-formula" rid="pcbi.1006526.e038">Eq 17</xref>) works so well, since the APC subtracts a product of two terms, <inline-formula id="pcbi.1006526.e062"><alternatives><graphic id="pcbi.1006526.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>•</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>/</mml:mo> <mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>•</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow> <mml:mo>×</mml:mo> <mml:mrow><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>•</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>/</mml:mo> <mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mo>•</mml:mo> <mml:mo>•</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, one depending only on <italic>i</italic> and the other only on <italic>j</italic>.</p>
<p>The factors in <xref ref-type="disp-formula" rid="pcbi.1006526.e058">Eq 28</xref> are highly correlated with the column entropies <italic>s</italic><sub><italic>i</italic></sub> (<xref ref-type="fig" rid="pcbi.1006526.g008">Fig 8A</xref>), so that we can write
<disp-formula id="pcbi.1006526.e063"><alternatives><graphic id="pcbi.1006526.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e063" xlink:type="simple"/><mml:math display="block" id="M63"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:munder><mml:mo>∝</mml:mo> <mml:mo>∼</mml:mo></mml:munder> <mml:mfrac><mml:msup><mml:mi>N</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:msup><mml:mo>λ</mml:mo> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(29)</label></disp-formula></p>
<fig id="pcbi.1006526.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006526.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Entropy bias correction.</title>
<p>(<bold>A</bold>) Each dot shows the entropy <inline-formula id="pcbi.1006526.e059"><alternatives><graphic id="pcbi.1006526.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mrow><mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:msubsup> <mml:msub><mml:mi>f</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mtext>log</mml:mtext> <mml:msub><mml:mi>f</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> of a randomly sampled probability distribution over the 20 amino acids versus <inline-formula id="pcbi.1006526.e060"><alternatives><graphic id="pcbi.1006526.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:msubsup> <mml:msub><mml:mi>f</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for the same distribution. (<bold>B</bold>) For each of the 150 Pfam MSA we plot the strength of the entropy bias correction <italic>α</italic> from <xref ref-type="disp-formula" rid="pcbi.1006526.e042">Eq 21</xref> versus <inline-formula id="pcbi.1006526.e061"><alternatives><graphic id="pcbi.1006526.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt> <mml:mo>/</mml:mo> <mml:mi>L</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>N</italic> is the number of sequences in the MSA and <italic>L</italic> is the number of columns. Without sequence weighting, a linear dependence would be expected from <xref ref-type="disp-formula" rid="pcbi.1006526.e066">Eq 30</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.g008" xlink:type="simple"/>
</fig>
<p>Finally, the variance of <italic>c</italic><sub><italic>ij</italic></sub> is small in comparison to <inline-formula id="pcbi.1006526.e064"><alternatives><graphic id="pcbi.1006526.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> because usually many approximately independent terms (<italic>n</italic><sub><italic>ijab</italic></sub> − E[<italic>n</italic><sub><italic>ijab</italic></sub>])<sup>2</sup> contribute to <inline-formula id="pcbi.1006526.e065"><alternatives><graphic id="pcbi.1006526.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> such that the fluctuations around the expectation value of each such term tend to average each other out. We can therefore approximate the entropic bias as
<disp-formula id="pcbi.1006526.e066"><alternatives><graphic id="pcbi.1006526.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mtext>E</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mtext>var</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:msup><mml:mo>)</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>≈</mml:mo> <mml:mtext>E</mml:mtext> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:munder><mml:mo>∝</mml:mo> <mml:mo>∼</mml:mo></mml:munder> <mml:mfrac><mml:msup><mml:mi>N</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>λ</mml:mo></mml:mfrac> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup><mml:mspace width="2pt"/><mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(30)</label></disp-formula></p>
<p>Given that <xref ref-type="disp-formula" rid="pcbi.1006526.e058">Eq 28</xref> is a more accurate estimate for <inline-formula id="pcbi.1006526.e067"><alternatives><graphic id="pcbi.1006526.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> than <xref ref-type="disp-formula" rid="pcbi.1006526.e066">Eq 30</xref> is for E[<italic>c</italic><sub><italic>ij</italic></sub>], we were expecting better results by predicting contacting residues (<italic>i</italic>, <italic>j</italic>) based on a ranking by <inline-formula id="pcbi.1006526.e068"><alternatives><graphic id="pcbi.1006526.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:mi>α</mml:mi> <mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>u</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1006526.e069"><alternatives><graphic id="pcbi.1006526.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mn>20</mml:mn></mml:msubsup> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> than when we ranked by the entropy bias corrected score <inline-formula id="pcbi.1006526.e070"><alternatives><graphic id="pcbi.1006526.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mi>α</mml:mi> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. To our surprise, the entropy bias correction worked slightly better. Investigation of this puzzling result is left for future work.</p>
<p>We used a regularization strength proportional to the number of residues <italic>L</italic> in the MSA, λ = 0.2<italic>L</italic>. Therefore, without sequence weighting, <inline-formula id="pcbi.1006526.e071"><alternatives><graphic id="pcbi.1006526.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mfrac><mml:msup><mml:mi>N</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mo>λ</mml:mo></mml:mfrac></mml:math></alternatives></inline-formula> should be proportional to the <italic>α</italic> parameter from <xref ref-type="disp-formula" rid="pcbi.1006526.e042">Eq 21</xref> that defines the optimum strength of the entropy bias. Indeed, <xref ref-type="fig" rid="pcbi.1006526.g008">Fig 8B</xref> shows a tight correlation of <italic>α</italic> with <inline-formula id="pcbi.1006526.e072"><alternatives><graphic id="pcbi.1006526.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt> <mml:mo>/</mml:mo> <mml:mi>L</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. We cannot expect the relationship to be strictly linear, because in our theoretical analysis we had assumed that sequences are independent and have a weight of 1, whereas in the example of <xref ref-type="fig" rid="pcbi.1006526.g008">Fig 8B</xref> the coupling coefficients <inline-formula id="pcbi.1006526.e073"><alternatives><graphic id="pcbi.1006526.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> where learned from Pfam MSAs using sequence weighting.</p>
</sec>
<sec id="sec018">
<title>Learning MRFs with persistent contrastive divergence</title>
<p>While the log likelihood function cannot be efficiently computed because of the exponential complexity of the normalization constant <italic>Z</italic>, it is possible to approximate its gradient with an approach called contrastive divergence [<xref ref-type="bibr" rid="pcbi.1006526.ref055">55</xref>]. The gradient of the log likelihood with respect to the couplings <italic>w</italic><sub><italic>ij</italic></sub>(<italic>a</italic>, <italic>b</italic>) can be written as
<disp-formula id="pcbi.1006526.e074"><alternatives><graphic id="pcbi.1006526.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e074" xlink:type="simple"/><mml:math display="block" id="M74"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>[</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mtext>log</mml:mtext> <mml:mi>Z</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo><mml:mi>b</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula>
where <inline-formula id="pcbi.1006526.e075"><alternatives><graphic id="pcbi.1006526.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>ω</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mspace width="-0.166667em"/><mml:mo>≠</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mspace width="-0.166667em"/><mml:mo>≠</mml:mo> <mml:mspace width="-0.166667em"/><mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the summed weight of sequences that have no gap in either column <italic>i</italic> or <italic>j</italic>, <inline-formula id="pcbi.1006526.e076"><alternatives><graphic id="pcbi.1006526.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:mrow><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo><mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>ω</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo><mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represents the empirically observed pairwise amino acid frequencies that are normalized over <italic>a</italic>, <italic>b</italic> ∈ {1, …, 20}, and <italic>p</italic>(<italic>x</italic><sub><italic>i</italic></sub> = <italic>a</italic>, <italic>x</italic><sub><italic>j</italic></sub> = <italic>b</italic>|<bold>v</bold>, <bold>w</bold>) corresponds to the model probabilities of the MRF for observing an amino acid pair (<italic>a</italic>, <italic>b</italic>) at positions <italic>i</italic> and <italic>j</italic>. The empirical amino acid counts, given by <italic>N</italic><sub><italic>ij</italic></sub><italic>q</italic>(<italic>x</italic><sub><italic>i</italic></sub> = <italic>a</italic>, <italic>x</italic><sub><italic>j</italic></sub> = <italic>b</italic>), are constant and need to be computed only once from the alignment.</p>
<p>The marginal distributions of the MRF cannot be computed analytically as it involves the normalization constant <italic>Z</italic>. Markov chain Monte Carlo (MCMC) algorithms can be used to generate samples from probability distributions that involve the computation of complex integrals such as the normalization constant <italic>Z</italic>. Given that the Markov chains run long enough, the equilibrium statistics of the samples will be identical to the true probability distribution statistics. Thus, an estimate of the marginal distribution of the MRF in the gradient in <xref ref-type="disp-formula" rid="pcbi.1006526.e074">Eq 31</xref>, <italic>p</italic>(<italic>x</italic><sub><italic>i</italic></sub> = <italic>a</italic>, <italic>x</italic><sub><italic>j</italic></sub> = <italic>b</italic>|<bold>v</bold>, <bold>w</bold>), can be obtained by simply computing the expected amino acid counts from MCMC samples. However, MCMC methods require many sampling steps to obtain unbiased estimates from the stationary distribution which comes at high computational costs.</p>
<p>Hinton suggested contrastive divergence (CD) as an approximation to MCMC methods [<xref ref-type="bibr" rid="pcbi.1006526.ref055">55</xref>]. The idea is simple: instead of starting a Markov chain from a random point and running it until it has reached the stationary distribution, we run <italic>C</italic> chains in parallel, each being initialized with one of the sequences from the input MSA and we evolve them for only a small number of steps. Obviously the chains do not converge to the stationary distribution in only a few steps and the sequence samples obtained from the current configuration of the chains present biased estimates. The intuition behind CD is that even though the resulting gradient estimate from the biased samples will also be noisy and biased, it points roughly into the same direction as the true gradient of the full likelihood. Therefore the approximate CD gradient should become zero approximately where the true gradient of the likelihood becomes zero.</p>
<p>We apply CD and generate sequence samples to estimate the marginal probabilities by evolving Markov chains which have been initialized with randomly selected protein sequences from the original Pfam MSAs for one full step of Gibbs sampling. We set the number of Markov chains to <italic>C</italic> = max(500, 0.1<italic>N</italic>), with <italic>N</italic> being the number of sequences in the MSA, which seems to give a good trade-off between performance and runtime. Gibbs sampling requires updating at each sampling step all sequence positions <italic>x</italic><sub><italic>i</italic></sub> with <italic>i</italic> ∈ {1, …, <italic>L</italic>} (<italic>L</italic> = sequence length). For each position, a new amino acid <italic>a</italic> is chosen according to the conditional probability
<disp-formula id="pcbi.1006526.e077"><alternatives><graphic id="pcbi.1006526.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006526.e077" xlink:type="simple"/><mml:math display="block" id="M77"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mspace width="-0.166667em"/><mml:mo>=</mml:mo><mml:mi>a</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">x</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>L</mml:mi></mml:munderover> <mml:mspace width="-0.166667em"/><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>j</mml:mi> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(32)</label></disp-formula></p>
<p>This Gibbs sampling approach is known to generate samples <bold>x</bold><sup>0</sup>, …, <bold>x</bold><sup><italic>t</italic></sup> that are distributed according to the model probability in <xref ref-type="disp-formula" rid="pcbi.1006526.e027">Eq 11</xref> [<xref ref-type="bibr" rid="pcbi.1006526.ref056">56</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref057">57</xref>]. Note that we do not update positions representing a gap and we thereby retain the gap structure of the initial sequence.</p>
<p>A modification of CD known as persistent contrastive divergence (PCD) does not reinitialize the Markov chains at data samples every time a new gradient is computed [<xref ref-type="bibr" rid="pcbi.1006526.ref046">46</xref>]. Instead, the Markov chains are kept persistent: they are evolved between successive gradient computations. The assumption behind PCD is that the model changes only slowly between parameter updates given a sufficiently small learning rate. Consequently, the Markov chains will not be pushed too far from equilibrium after each update but rather stay close to the stationary distribution [<xref ref-type="bibr" rid="pcbi.1006526.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref058">58</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref059">59</xref>].</p>
<p>Tieleman and others observed that PCD performs better than CD in all practical cases tested, even though CD can be faster in the early stages of learning [<xref ref-type="bibr" rid="pcbi.1006526.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref058">58</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref060">60</xref>]. Therefore we start optimizing the full likelihood with CD and switch to PCD at later stages of learning. CCMpredPy settings for training a MRF with persistent contrastive divergence are listed in <xref ref-type="supplementary-material" rid="pcbi.1006526.s001">S1 Text</xref>.</p>
</sec>
<sec id="sec019">
<title>Generating MCMC samples from MRFs with CCMgen</title>
<p>MCMC samples for the analysis in <xref ref-type="fig" rid="pcbi.1006526.g001">Fig 1</xref> have been generated with CCMgen by evolving 10000 Markov chains by repeated Gibbs sampling as described in <xref ref-type="disp-formula" rid="pcbi.1006526.e077">Eq 32</xref>. The Markov chains, each representing protein sequences of length <italic>L</italic> (length of protein in the PSICOV data set) have been randomly initialized with the 20 amino acids. Since the alignment substructure is strongly impacted by the non-random distribution of gaps in the sequences (<xref ref-type="supplementary-material" rid="pcbi.1006526.s004">S2a Fig</xref>), in a second step the gap structure of randomly selected sequences from the original Pfam alignment is copied over (gaps represented as 21st amino acid). Thus, it is ensured that the sampling procedure reproduces the original alignment substructure as closely as possible (<xref ref-type="supplementary-material" rid="pcbi.1006526.s004">S2b and S2c Fig</xref>). The number of Gibbs steps before drawing samples was set to 500. Increasing the number of Gibbs steps to e.g. 1000 does not change the statistics of the MCMC samples, hence we can assume that the Markov chains have reached the equilibrium distribution. CCMgen settings for MCMC sampling are listed in <xref ref-type="supplementary-material" rid="pcbi.1006526.s001">S1 Text</xref>.</p>
</sec>
<sec id="sec020">
<title>Sampling sequences from MRFs along phylogenies with CCMgen</title>
<p>Instead of evolving sequences along a linear path, the MRF model can also be used to sample protein sequences according to an arbitrary phylogenetic tree.</p>
<p>CCMgen can simulate the evolution of sequences along any given phylogenetic tree constrained by a MRF model, such as those calculated from CCMpred for example. The user can either supply a phylogenetic tree in Newick format that has been generated by a phylogenetic reconstruction program such as FastTree [<xref ref-type="bibr" rid="pcbi.1006526.ref061">61</xref>] on a real alignment or choose between two types of idealized trees, a binary and a star-shaped topology. For these idealized trees the user can specify the number of leaf nodes and the total depth of the tree, which is the total number of mutations per position from the sequence at the root to the leaf nodes. The root sequence can either be supplied by the user or be generated by evolving an all-alanine sequence with a number of mutations (i.e. Gibbs sampling steps according to the MRF as described in <xref ref-type="disp-formula" rid="pcbi.1006526.e077">Eq 32</xref>). Sequences at subsequent child nodes are generated one by one, by duplicating the sequence at the parent node and evolving the respective child node sequences each with a number of mutations proportional to the edge length. The output of CCMgen is a MSA file with the sequences at the leaf nodes of the tree. CCMgen is released as open-source python command-line application.</p>
<sec id="sec021">
<title>Workflow for quantification of noise in contact prediction with CCMgen</title>
<p>We used CCMpredPy to learn MRF models for all Pfam alignments in the PSICOV data set using PCD. In order to obtain models with few but precise constraints, we set coupling parameters to zero for non-contacting residue pairs (<italic>C</italic><sub><italic>β</italic></sub> distance &gt; 12Å) by initializing them to zero and setting the gradients to zero in the optimization. This procedure ensures that the majority of residue pairs not forming contacts in the protein structure will not be coupled in the MRF model.</p>
<p>We used CCMgen with the learned MRF models to generate synthetic alignments by evolving sequences along idealized star and binary tree topologies. The ancestral sequence at the root of a tree, <bold>x</bold><sup><italic>t</italic></sup> with <italic>t</italic> = 0, is obtained by evolving an all-alanine sequence for 10 steps of Gibbs sampling as described in <xref ref-type="disp-formula" rid="pcbi.1006526.e077">Eq 32</xref>. The synthetic alignments have the same number of sequences as the corresponding Pfam alignments from the PSICOV set.</p>
<p>We also ensure that the diversity of the resulting MSAs is within 1% of the diversity of the original Pfam MSA from the PSICOV set by adjusting the depth of the trees, which is equivalent to adapting the mutation rate (<xref ref-type="supplementary-material" rid="pcbi.1006526.s007">S5a Fig</xref>). We measure diversity as the number of effective sequences, <italic>N</italic><sub>eff</sub>, defined as the exponential of the average column entropies, as defined in the HH-suite software package [<xref ref-type="bibr" rid="pcbi.1006526.ref062">62</xref>].</p>
<p>For each new CCMgen run with adapted mutation rate a new ancestral sequence is sampled by evolving an all-alanine sequence for 10 Gibbs steps. We found that the aforementioned procedure of masking non-contacting residue pairs during training of the MRF model has the advantageous effect of allowing smaller mutation rates to be used to achieve the desired diversity compared to sampling sequences with a fully parametrized model, likely due to the smaller number of constraints trapping the sampling procedure in local optima. Enforcing small mutation rates is essential for preserving the interdependence between sequences when sampling along binary topologies, which consequently controls the amount of phylogenetic bias. The mutation rates used to obtain synthetic alignments of similar diversity as the original Pfam alignments are very similar regardless of the phylogenetic topology along which sequences were sampled (<xref ref-type="supplementary-material" rid="pcbi.1006526.s007">S5b Fig</xref>).</p>
<p>CCMpredPy and CCMgen settings for training the MRF with persistent contrastive divergence and generating the synthetic alignments along binary and star tree topologies are listed in <xref ref-type="supplementary-material" rid="pcbi.1006526.s001">S1 Text</xref>.</p>
</sec>
</sec>
<sec id="sec022">
<title>Dataset and preprocessing</title>
<p>We used the PSICOV data set that was published together with the PSICOV method [<xref ref-type="bibr" rid="pcbi.1006526.ref049">49</xref>] and which comprises MSAs for 150 Pfam domains with known crystal structures. For each Pfam MSA in the PSICOV set we first removed sequences with more than 75% gaps and columns with more than 50% gaps, similarly as in [<xref ref-type="bibr" rid="pcbi.1006526.ref050">50</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref051">51</xref>, <xref ref-type="bibr" rid="pcbi.1006526.ref063">63</xref>], to reduce the well-known impact of gaps on the analysis.</p>
</sec>
</sec>
<sec id="sec023">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006526.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Running CCMpredPy and CCMgen.</title>
<p>Parameter settings used with CCMpredPy and CCMgen in this study.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006526.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Analysing alignment substructure with principal component analysis (PCA).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006526.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.s003" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Comparing quality of Markov random field (MRF) models learned with pseudo-likelihood maximization and persistent contrastive divergence (PCD).</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006526.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.s004" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Visualizing alignment substructure for protein 1gmxA by projecting sequences of the multiple sequence alignment (MSA) onto their first two principal components.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006526.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.s005" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Contact scores computed from Markov random field (MRF) models trained with pseudo-likelihood maximization and persistent contrastive divergence (PCD) correlate strongly.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006526.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.s006" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Distribution of Pearson correlation coefficients between average product correction (APC) and entropy bias correction (EntC) term.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006526.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006526.s007" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Statistics of synthetic alignments generated with CCMgen along binary and star tree topologies.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Sergey Ovchinnikov for helpful discussion and valuable advice during the revision of the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006526.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Göbel</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Schneider</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Valencia</surname> <given-names>A</given-names></name>. <article-title>Correlated mutations and residue contacts in proteins</article-title>. <source>Proteins</source>. <year>1994</year>;<volume>18</volume>(<issue>4</issue>):<fpage>309</fpage>–<lpage>317</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.340180402" xlink:type="simple">10.1002/prot.340180402</ext-link></comment> <object-id pub-id-type="pmid">8208723</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Neher</surname> <given-names>E</given-names></name>. <article-title>How frequent are correlated changes in families of protein sequences?</article-title> <source>Proc Natl Acad Sci U S A</source>. <year>1994</year>;<volume>91</volume>(<issue>1</issue>):<fpage>98</fpage>–<lpage>102</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.91.1.98" xlink:type="simple">10.1073/pnas.91.1.98</ext-link></comment> <object-id pub-id-type="pmid">8278414</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shindyalov</surname> <given-names>IN</given-names></name>, <name name-style="western"><surname>Kolchanov</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>. <article-title>Can three-dimensional contacts in protein structures be predicted by analysis of correlated mutations?</article-title> “<source>Protein Eng Des Sel</source>. <year>1994</year>;<volume>7</volume>(<issue>3</issue>):<fpage>349</fpage>–<lpage>358</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/protein/7.3.349" xlink:type="simple">10.1093/protein/7.3.349</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Godzik</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>. <article-title>Conservation of residue interactions in a family of Ca-binding proteins</article-title>. “<source>Protein Eng Des Sel</source>. <year>1989</year>;<volume>2</volume>(<issue>8</issue>):<fpage>589</fpage>–<lpage>596</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/protein/2.8.589" xlink:type="simple">10.1093/protein/2.8.589</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lapedes</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Giraud</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Stormo</surname> <given-names>G</given-names></name>. <article-title>Correlated mutations in models of protein sequences: phylogenetic and structural effects</article-title>. <source>Stat Mol Biol</source>. <year>1999</year>;<volume>33</volume>:<fpage>236</fpage>–<lpage>256</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006526.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Giraud</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Heumann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lapedes</surname> <given-names>A</given-names></name>. <article-title>Superadditive correlation</article-title>. <source>Phys Rev E</source>. <year>1999</year>;<volume>59</volume>(<issue>5</issue>):<fpage>4983</fpage>–<lpage>4991</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.59.4983" xlink:type="simple">10.1103/PhysRevE.59.4983</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Szurmant</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hoch</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Hwa</surname> <given-names>T</given-names></name>. <article-title>Identification of direct residue contacts in protein-protein interaction by message passing</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2009</year>;<volume>106</volume>(<issue>1</issue>):<fpage>67</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0805923106" xlink:type="simple">10.1073/pnas.0805923106</ext-link></comment> <object-id pub-id-type="pmid">19116270</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burger</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>van Nimwegen</surname> <given-names>E</given-names></name>. <article-title>Disentangling direct from indirect co-evolution of residues in protein alignments</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>1</issue>):<fpage>e1000633</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000633" xlink:type="simple">10.1371/journal.pcbi.1000633</ext-link></comment> <object-id pub-id-type="pmid">20052271</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomas</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ramakrishnan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bailey-Kellogg</surname> <given-names>C</given-names></name>. <article-title>Graphical Models of Residue Coupling in Protein Families</article-title>. <source>IEEE/ACM Trans Comput Biol Bioinforma</source>. <year>2008</year>;<volume>5</volume>(<issue>2</issue>):<fpage>183</fpage>–<lpage>197</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TCBB.2007.70225" xlink:type="simple">10.1109/TCBB.2007.70225</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Pagnani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zecchina</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Protein 3D structure computed from evolutionary sequence variation</article-title>. <source>PLoS One</source>. <year>2011</year>;<volume>6</volume>(<issue>12</issue>):<fpage>e28766</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0028766" xlink:type="simple">10.1371/journal.pone.0028766</ext-link></comment> <object-id pub-id-type="pmid">22163331</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>. <article-title>Protein structure prediction from sequence variation</article-title>. <source>Nat Biotechnol</source>. <year>2012</year>;<volume>30</volume>(<issue>11</issue>):<fpage>1072</fpage>–<lpage>1080</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.2419" xlink:type="simple">10.1038/nbt.2419</ext-link></comment> <object-id pub-id-type="pmid">23138306</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rost</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>. <article-title>Three-dimensional structures of membrane proteins from genomic sequencing</article-title>. <source>Cell</source>. <year>2012</year>;<volume>149</volume>(<issue>7</issue>):<fpage>1607</fpage>–<lpage>1621</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2012.04.012" xlink:type="simple">10.1016/j.cell.2012.04.012</ext-link></comment> <object-id pub-id-type="pmid">22579045</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nugent</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>DT</given-names></name>. <article-title>Accurate de novo structure prediction of large transmembrane protein domains using fragment-assembly and correlated mutation analysis</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2012</year>;<volume>109</volume>(<issue>24</issue>):<fpage>E1540</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1120036109" xlink:type="simple">10.1073/pnas.1120036109</ext-link></comment> <object-id pub-id-type="pmid">22645369</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Schärfe</surname> <given-names>CPI</given-names></name>, <name name-style="western"><surname>Rodrigues</surname> <given-names>JPGLM</given-names></name>, <name name-style="western"><surname>Green</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bonvin</surname> <given-names>AMJJ</given-names></name>, <etal>et al</etal>. <article-title>Sequence co-evolution gives 3D contacts and structures of protein complexes</article-title>. <source>Elife</source>. <year>2014</year>;<volume>3</volume>:<fpage>e03430</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.03430" xlink:type="simple">10.7554/eLife.03430</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kosciolek</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>DT</given-names></name>. <article-title>De novo structure prediction of globular proteins aided by sequence variation-derived contacts</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>3</issue>):<fpage>e92197</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0092197" xlink:type="simple">10.1371/journal.pone.0092197</ext-link></comment> <object-id pub-id-type="pmid">24637808</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ovchinnikov</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kamisetty</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>D</given-names></name>. <article-title>Robust and accurate prediction of residue-residue interactions across protein interfaces using evolutionary information</article-title>. <source>Elife</source>. <year>2014</year>;<volume>3</volume>:<fpage>e02030</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.02030" xlink:type="simple">10.7554/eLife.02030</ext-link></comment> <object-id pub-id-type="pmid">24842992</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hayat</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Elofsson</surname> <given-names>A</given-names></name>. <article-title>All-atom 3D structure prediction of transmembrane <italic>β</italic>-barrel proteins from sequences</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2015</year>;<volume>112</volume>(<issue>17</issue>):<fpage>5413</fpage>–<lpage>5418</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1419956112" xlink:type="simple">10.1073/pnas.1419956112</ext-link></comment> <object-id pub-id-type="pmid">25858953</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Morinaga</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ihara</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Touhara</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Benton</surname> <given-names>R</given-names></name>. <article-title>Amino acid coevolution reveals three-dimensional structure and functional domains of insect odorant receptors</article-title>. <source>Nat Commun</source>. <year>2015</year>;<volume>6</volume>:<fpage>6077</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms7077" xlink:type="simple">10.1038/ncomms7077</ext-link></comment> <object-id pub-id-type="pmid">25584517</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ovchinnikov</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kinch</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Liao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Pei</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>DE</given-names></name>, <etal>et al</etal>. <article-title>Large scale determination of previously unsolved protein structures using evolutionary information</article-title>. <source>Elife</source>. <year>2015</year>;<volume>4</volume>:<fpage>e09248</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.09248" xlink:type="simple">10.7554/eLife.09248</ext-link></comment> <object-id pub-id-type="pmid">26335199</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ovchinnikov</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Varghese</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Pavlopoulos</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>DE</given-names></name>, <etal>et al</etal>. <article-title>Protein structure determination using metagenome sequence data</article-title>. <source>Science</source>. <year>2017</year>;<volume>355</volume>(<issue>6322</issue>):<fpage>294</fpage>–<lpage>298</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aah4043" xlink:type="simple">10.1126/science.aah4043</ext-link></comment> <object-id pub-id-type="pmid">28104891</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jones</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Kandathil</surname> <given-names>SM</given-names></name>. <article-title>High precision in protein contact prediction using fully convolutional neural networks and minimal sequence features</article-title>. <source>Bioinformatics</source>. <year>2018</year>;bty341. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bty341" xlink:type="simple">10.1093/bioinformatics/bty341</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>He</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Mortuza</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shen</surname> <given-names>HB</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>. <article-title>NeBcon: Protein contact map prediction using neural network training coupled with naïve Bayes classifiers</article-title>. <source>Bioinformatics</source>. <year>2017</year>; <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btx164" xlink:type="simple">10.1093/bioinformatics/btx164</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Michel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Skwark</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Menéndez Hurtado</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ekeberg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Elofsson</surname> <given-names>A</given-names></name>. <article-title>Predicting accurate contacts in thousands of Pfam domain families using PconsC3</article-title>. <source>Bioinformatics</source>. <year>2017</year>;<volume>33</volume>(<issue>18</issue>):<fpage>2859</fpage>–<lpage>2866</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btx332" xlink:type="simple">10.1093/bioinformatics/btx332</ext-link></comment> <object-id pub-id-type="pmid">28535189</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref024">
<label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Golkov V, Skwark MJ, Golkov A, Dosovitskiy A, Brox T, Meiler J, et al. Protein contact prediction from amino acid co-evolution using convolutional networks for graph-valued images. In: Lee DD, Sugiyama M, Luxburg UV, Guyon I, Garnett R, editors. Adv. Neural Inf. Process. Syst. 29. Curran Associates, Inc.; 2016. p. 4222–4230.</mixed-citation>
</ref>
<ref id="pcbi.1006526.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>J</given-names></name>. <article-title>Accurate De Novo Prediction of Protein Contact Map by Ultra-Deep Learning Model</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>13</volume>(<issue>1</issue>):<fpage>e1005324</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005324" xlink:type="simple">10.1371/journal.pcbi.1005324</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dunn</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Wahl</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Gloor</surname> <given-names>GB</given-names></name>. <article-title>Mutual information without the influence of phylogeny or entropy dramatically improves residue contact prediction</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>3</issue>):<fpage>333</fpage>–<lpage>340</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btm604" xlink:type="simple">10.1093/bioinformatics/btm604</ext-link></comment> <object-id pub-id-type="pmid">18057019</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gouveia-Oliveira</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pedersen</surname> <given-names>AG</given-names></name>. <article-title>Finding coevolving amino acid residues using row and column weighting of mutual information and multi-dimensional amino acid representation</article-title>. <source>Algorithms Mol Biol</source>. <year>2007</year>;<volume>2</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1748-7188-2-12" xlink:type="simple">10.1186/1748-7188-2-12</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gloor</surname> <given-names>GB</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Wahl</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Dunn</surname> <given-names>SD</given-names></name>. <article-title>Mutual Information in Protein Multiple Sequence Alignments Reveals Two Classes of Coevolving Positions</article-title>. <source>Biochemistry</source>. <year>2005</year>;<volume>44</volume>(<issue>19</issue>):<fpage>7156</fpage>–<lpage>7165</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/bi050293e" xlink:type="simple">10.1021/bi050293e</ext-link></comment> <object-id pub-id-type="pmid">15882054</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Martin</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Gloor</surname> <given-names>GB</given-names></name>, <name name-style="western"><surname>Dunn</surname> <given-names>SD</given-names></name>, <name name-style="western"><surname>Wahl</surname> <given-names>LM</given-names></name>. <article-title>Using information theory to search for co-evolving residues in proteins</article-title>. <source>Bioinformatics</source>. <year>2005</year>;<volume>21</volume>(<issue>22</issue>):<fpage>4116</fpage>–<lpage>4124</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/bti671" xlink:type="simple">10.1093/bioinformatics/bti671</ext-link></comment> <object-id pub-id-type="pmid">16159918</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Noivirt</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Eisenstein</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Horovitz</surname> <given-names>A</given-names></name>. <article-title>Detection and reduction of evolutionary noise in correlated mutation analysis</article-title>. <source>Protein Eng Des Sel</source>. <year>2005</year>;<volume>18</volume>(<issue>5</issue>):<fpage>247</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/protein/gzi029" xlink:type="simple">10.1093/protein/gzi029</ext-link></comment> <object-id pub-id-type="pmid">15911538</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fodor</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Aldrich</surname> <given-names>RW</given-names></name>. <article-title>Influence of conservation on calculations of amino acid covariance in multiple sequence alignments</article-title>. <source>Proteins</source>. <year>2004</year>;<volume>56</volume>(<issue>2</issue>):<fpage>211</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.20098" xlink:type="simple">10.1002/prot.20098</ext-link></comment> <object-id pub-id-type="pmid">15211506</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Atchley</surname> <given-names>WR</given-names></name>, <name name-style="western"><surname>Wollenberg</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Fitch</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Terhalle</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Dress</surname> <given-names>AW</given-names></name>. <article-title>Correlations Among Amino Acid Sites in bHLH Protein Domains: An Information Theoretic Analysis</article-title>. <source>Mol Biol Evol</source>. <year>2000</year>;<volume>17</volume>(<issue>1</issue>):<fpage>164</fpage>–<lpage>178</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/oxfordjournals.molbev.a026229" xlink:type="simple">10.1093/oxfordjournals.molbev.a026229</ext-link></comment> <object-id pub-id-type="pmid">10666716</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>SC</given-names></name>, <etal>et al</etal>. <article-title>Improving residue-residue contact prediction via low-rank and sparse decomposition of residue correlation matrix</article-title>. <source>Biochem Biophys Res Commun</source>. <year>2016</year>;<volume>472</volume>(<issue>1</issue>):<fpage>217</fpage>–<lpage>222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.bbrc.2016.01.188" xlink:type="simple">10.1016/j.bbrc.2016.01.188</ext-link></comment> <object-id pub-id-type="pmid">26920058</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buslje</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Santos</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Delfino</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>M</given-names></name>. <article-title>Correction for phylogeny, small number of observations and data redundancy improves the identification of coevolving amino acid pairs using mutual information</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>9</issue>):<fpage>1125</fpage>–<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btp135" xlink:type="simple">10.1093/bioinformatics/btp135</ext-link></comment> <object-id pub-id-type="pmid">19276150</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>BC</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>D</given-names></name>. <article-title>A new method for revealing correlated mutations under the structural and functional constraints in proteins</article-title>. <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>19</issue>):<fpage>2506</fpage>–<lpage>2513</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btp455" xlink:type="simple">10.1093/bioinformatics/btp455</ext-link></comment> <object-id pub-id-type="pmid">19628501</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tillier</surname> <given-names>ERM</given-names></name>, <name name-style="western"><surname>Lui</surname> <given-names>TWH</given-names></name>. <article-title>Using multiple interdependency to separate functional from phylogenetic correlations in protein alignments</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>6</issue>):<fpage>750</fpage>–<lpage>755</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btg072" xlink:type="simple">10.1093/bioinformatics/btg072</ext-link></comment> <object-id pub-id-type="pmid">12691987</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Figliuzzi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Barrat-Charlaix</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>. <article-title>How pairwise coevolutionary models capture the collective residue variability in proteins</article-title>. <source>Mol Biol Evol</source>. <year>2018</year>;<volume>35</volume>(<issue>4</issue>):<fpage>1018</fpage>–<lpage>1027</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/msy007" xlink:type="simple">10.1093/molbev/msy007</ext-link></comment> <object-id pub-id-type="pmid">29351669</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barton</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Chakraborty</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Cocco</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jacquin</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Monasson</surname> <given-names>R</given-names></name>. <article-title>On the entropy of protein families</article-title>. <source>Journal of Statistical Physics</source>. <year>2016</year> <month>Mar</month> <day>1</day>;<volume>162</volume>(<issue>5</issue>):<fpage>1267</fpage>–<lpage>93</lpage>. <ext-link ext-link-type="uri" xlink:href="https://arxiv.org/pdf/1512.08101.pdf" xlink:type="simple">https://arxiv.org/pdf/1512.08101.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006526.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barton</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>De Leonardis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Coucke</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cocco</surname> <given-names>S</given-names></name>. <article-title>ACE: adaptive cluster expansion for maximum entropy graphical model inference</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>(<issue>20</issue>):<fpage>3089</fpage>–<lpage>3097</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btw328" xlink:type="simple">10.1093/bioinformatics/btw328</ext-link></comment> <object-id pub-id-type="pmid">27329863</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Haldane</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Flynn</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Vijayan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Levy</surname> <given-names>RM</given-names></name>. <article-title>Structural propensities of kinase family proteins from a potts model of residue co-variation</article-title>. <source>Protein Sci</source>. <volume>258</volume>:<fpage>1378</fpage>–<lpage>1384</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006526.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sutto</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Marsili</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Valencia</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gervasio</surname> <given-names>FL</given-names></name> <article-title>From residue coevolution to protein conformational ensembles and functional dynamics</article-title>. <source>Proc Natl Acad Sci U S A</source> <year>2015</year>, <volume>112</volume>(<issue>44</issue>):<fpage>13567</fpage>–<lpage>13572</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1508584112" xlink:type="simple">10.1073/pnas.1508584112</ext-link></comment> <object-id pub-id-type="pmid">26487681</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Seemayer</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gruber</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Söding</surname> <given-names>J</given-names></name>. <article-title>CCMpred-fast and precise prediction of protein residue-residue contacts from correlated mutations</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>21</issue>):<fpage>3128</fpage>–<lpage>3130</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btu500" xlink:type="simple">10.1093/bioinformatics/btu500</ext-link></comment> <object-id pub-id-type="pmid">25064567</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ekeberg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hartonen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aurell</surname> <given-names>E</given-names></name>. <article-title>Fast pseudolikelihood maximization for direct-coupling analysis of protein structure from many homologous amino-acid sequences</article-title>. <source>J Comput Phys</source>. <year>2014</year>;<volume>276</volume>:<fpage>341</fpage>–<lpage>356</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jcp.2014.07.024" xlink:type="simple">10.1016/j.jcp.2014.07.024</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balakrishnan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kamisetty</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Carbonell</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Langmead</surname> <given-names>CJ</given-names></name>. <article-title>Learning generative models for protein fold families</article-title>. <source>Proteins</source>. <year>2011</year>;<volume>79</volume>(<issue>4</issue>):<fpage>1061</fpage>–<lpage>78</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.22934" xlink:type="simple">10.1002/prot.22934</ext-link></comment> <object-id pub-id-type="pmid">21268112</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cocco</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Feinauer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Figliuzzi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Monasson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>. <article-title>Inverse statistical physics of protein sequences: a key issues review</article-title>. <source>Reports Prog Phys</source>. <year>2018</year>;<volume>81</volume>(<issue>3</issue>):<fpage>032601</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/1361-6633/aa9965" xlink:type="simple">10.1088/1361-6633/aa9965</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tieleman</surname> <given-names>T</given-names></name>. <article-title>Training Restricted Boltzmann Machines using Approximations to the Likelihood Gradient</article-title>. <source>Proc 25th Int Conf Mach Learn</source>. <year>2008</year>;<volume>307</volume>:<fpage>7</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006526.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morcos</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pagnani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lunt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bertolino</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2011</year>;<volume>108</volume>(<issue>49</issue>):<fpage>E1293</fpage>–<lpage>301</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1111471108" xlink:type="simple">10.1073/pnas.1111471108</ext-link></comment> <object-id pub-id-type="pmid">22106262</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qin</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>LJ</given-names></name>. <article-title>Power law tails in phylogenetic systems</article-title>. <source>Proc Natl Acad Sci U S A</source>. (in press).</mixed-citation>
</ref>
<ref id="pcbi.1006526.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jones</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Buchan</surname> <given-names>DWA</given-names></name>, <name name-style="western"><surname>Cozzetto</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pontil</surname> <given-names>M</given-names></name>. <article-title>PSICOV: precise structural contact prediction using sparse inverse covariance estimation on large multiple sequence alignments</article-title>. <source>Bioinformatics</source>. <year>2012</year>;<volume>28</volume>(<issue>2</issue>):<fpage>184</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btr638" xlink:type="simple">10.1093/bioinformatics/btr638</ext-link></comment> <object-id pub-id-type="pmid">22101153</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ekeberg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lövkvist</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Aurell</surname> <given-names>E</given-names></name>. <article-title>Improved contact prediction in proteins: Using pseudolikelihoods to infer Potts models</article-title>. <source>Phys Rev E</source>. <year>2013</year>;<volume>87</volume>(<issue>1</issue>):<fpage>012707</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.87.012707" xlink:type="simple">10.1103/PhysRevE.87.012707</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kamisetty</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ovchinnikov</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Baker</surname> <given-names>D</given-names></name>. <article-title>Assessing the utility of coevolution-based residue-residue contact predictions in a sequence- and structure-rich era</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2013</year>;<volume>110</volume>(<issue>39</issue>):<fpage>15674</fpage>–<lpage>15679</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1314045110" xlink:type="simple">10.1073/pnas.1314045110</ext-link></comment> <object-id pub-id-type="pmid">24009338</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Monastyrskyy</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>D’Andrea</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Fidelis</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Tramontano</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kryshtafovych</surname> <given-names>A</given-names></name>. <article-title>New encouraging developments in contact prediction: Assessment of the CASP11 results</article-title>. <source>Proteins</source>. <year>2015</year>;<volume>84</volume>(<issue>Suppl 1</issue>):<fpage>131</fpage>–<lpage>144</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.24943" xlink:type="simple">10.1002/prot.24943</ext-link></comment> <object-id pub-id-type="pmid">26474083</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Feinauer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Skwark</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Pagnani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Aurell</surname> <given-names>E</given-names></name>. <article-title>Improving contact prediction along three dimensions</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>10</issue>):<fpage>e1003847</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003847" xlink:type="simple">10.1371/journal.pcbi.1003847</ext-link></comment> <object-id pub-id-type="pmid">25299132</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baldassi</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zamparo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Feinauer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Procaccini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zecchina</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Fast and accurate multivariate gaussian modeling of protein families: predicting residue contacts and protein-interaction partners</article-title>. <source>PLoS One</source>. <year>2014</year>;<volume>9</volume>(<issue>3</issue>):<fpage>e92721</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0092721" xlink:type="simple">10.1371/journal.pone.0092721</ext-link></comment> <object-id pub-id-type="pmid">24663061</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>. <article-title>Training Products of Experts by Minimizing Contrastive Divergence</article-title>. <source>Neural Comput</source>. <year>2002</year>;<volume>14</volume>(<issue>8</issue>):<fpage>1771</fpage>–<lpage>1800</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976602760128018" xlink:type="simple">10.1162/089976602760128018</ext-link></comment> <object-id pub-id-type="pmid">12180402</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gelfand</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>AFM</given-names></name>. <article-title>Sampling-Based Approaches to Calculating Marginal Densities</article-title>. <source>J Am Stat Assoc</source>. <year>1990</year>;<volume>85</volume>(<issue>410</issue>):<fpage>398</fpage>–<lpage>409</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/01621459.1990.10476213" xlink:type="simple">10.1080/01621459.1990.10476213</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Geman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Geman</surname> <given-names>D</given-names></name>. <article-title>Stochastic Relaxation, Gibbs Distributions, and the Bayesian Restoration of Images</article-title>. <source>IEEE Trans Pattern Anal Mach Intell</source>. <year>1984</year>;<volume>PAMI-6</volume>(<issue>6</issue>):<fpage>721</fpage>–<lpage>741</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TPAMI.1984.4767596" xlink:type="simple">10.1109/TPAMI.1984.4767596</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref058">
<label>58</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Murphy</surname> <given-names>KP</given-names></name>. <source>Machine Learning: A Probabilistic Perspective</source>. <publisher-name>MIT Press</publisher-name>; <year>2012</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006526.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fischer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Igel</surname> <given-names>C</given-names></name>. <article-title>An Introduction to Restricted Boltzmann Machines</article-title>. <source>Lect Notes Comput Sci Prog Pattern Recognition, Image Anal Comput Vision, Appl</source>. <year>2012</year>;<volume>7441</volume>:<fpage>14</fpage>–<lpage>36</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006526.ref060">
<label>60</label>
<mixed-citation publication-type="other" xlink:type="simple">Swersky K, Chen B, Marlin B, de Freitas N. A tutorial on stochastic approximation algorithms for training Restricted Boltzmann Machines and Deep Belief Nets. In: 2010 Inf. Theory Appl. Work. IEEE; 2010. p. 1–10. Available from: <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/document/5454138/" xlink:type="simple">http://ieeexplore.ieee.org/document/5454138/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006526.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Price</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Dehal</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>AP</given-names></name>. <article-title>FastTree 2—Approximately Maximum-Likelihood Trees for Large Alignments</article-title>. <source>PLoS One</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>e9490</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0009490" xlink:type="simple">10.1371/journal.pone.0009490</ext-link></comment> <object-id pub-id-type="pmid">20224823</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Remmert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Biegert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hauser</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Söding</surname> <given-names>J</given-names></name>. <article-title>HHblits: lightning-fast iterative protein sequence searching by HMM-HMM alignment</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>(<issue>2</issue>):<fpage>173</fpage>–<lpage>175</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.1818" xlink:type="simple">10.1038/nmeth.1818</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006526.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skwark</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Raimondi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Michel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Elofsson</surname> <given-names>A</given-names></name>. <article-title>Improved contact predictions using the recognition of protein like contact patterns</article-title>. <source>PLoS Comput Biol</source>. <year>2014</year>;<volume>10</volume>(<issue>11</issue>):<fpage>e1003889</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003889" xlink:type="simple">10.1371/journal.pcbi.1003889</ext-link></comment> <object-id pub-id-type="pmid">25375897</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>