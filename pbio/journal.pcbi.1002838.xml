<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
        <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00905</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1002838</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Molecular cell biology</subject>
            <subj-group>
              <subject>Gene expression</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Computing methods</subject>
            <subj-group>
              <subject>Mathematical computing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Molecular Biology</subject>
          <subject>Computer Science</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>PERT: A Method for Expression Deconvolution of Human Blood Samples from Varied Microenvironmental and Developmental Conditions</article-title>
        <alt-title alt-title-type="running-head">PERT: A Flexible Expression Deconvolution Method</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Qiao</surname>
            <given-names>Wenlian</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
          <name name-style="western">
            <surname>Quon</surname>
            <given-names>Gerald</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="fn" rid="fn1">
            <sup>¤</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Csaszar</surname>
            <given-names>Elizabeth</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Yu</surname>
            <given-names>Mei</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Morris</surname>
            <given-names>Quaid</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
          <xref ref-type="aff" rid="aff5">
            <sup>5</sup>
          </xref>
          <xref ref-type="aff" rid="aff6">
            <sup>6</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Zandstra</surname>
            <given-names>Peter W.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="aff" rid="aff7">
            <sup>7</sup>
          </xref>
          <xref ref-type="aff" rid="aff8">
            <sup>8</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>Institute of Biomaterials and Biomedical Engineering, University of Toronto, Toronto, Ontario, Canada</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>Department of Computer Science, University of Toronto, Toronto, Ontario, Canada</addr-line>
      </aff>
      <aff id="aff3">
        <label>3</label>
        <addr-line>Department of Chemical Engineering and Applied Chemistry, University of Toronto, Toronto, Ontario, Canada</addr-line>
      </aff>
      <aff id="aff4">
        <label>4</label>
        <addr-line>Department of Molecular Genetics, University of Toronto, Toronto, Ontario, Canada</addr-line>
      </aff>
      <aff id="aff5">
        <label>5</label>
        <addr-line>Banting and Best Department of Medical Research, University of Toronto, Toronto, Ontario, Canada</addr-line>
      </aff>
      <aff id="aff6">
        <label>6</label>
        <addr-line>Donnelly Centre for Cellular and Biomolecular Research, University of Toronto, Toronto, Ontario, Canada</addr-line>
      </aff>
      <aff id="aff7">
        <label>7</label>
        <addr-line>McEwen Centre for Regenerative Medicine, University of Health Network, Toronto, Ontario, Canada</addr-line>
      </aff>
      <aff id="aff8">
        <label>8</label>
        <addr-line>Heart &amp; Stroke/Richard Lewar Centre of Excellence, Toronto, Ontario, Canada</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Bonneau</surname>
            <given-names>Richard</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>New York University, United States of America</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">quaid.morris@utoronto.ca</email> (QM); <email xlink:type="simple">peter.zandstra@utoronto.ca</email> (PWZ)</corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: WQ GQ QM PWZ. Performed the experiments: WQ GQ EC MY. Analyzed the data: WQ GQ. Contributed reagents/materials/analysis tools: GQ QM. Wrote the paper: WQ GQ QM PWZ.</p>
        </fn>
        <fn id="fn1" fn-type="current-aff">
          <label>¤</label>
          <p>Current address: Computer Science and Artificial Intelligence Laboratory, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <month>12</month>
        <year>2012</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>20</day>
        <month>12</month>
        <year>2012</year>
      </pub-date>
      <volume>8</volume>
      <issue>12</issue>
      <elocation-id>e1002838</elocation-id>
      <history>
        <date date-type="received">
          <day>5</day>
          <month>6</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>26</day>
          <month>10</month>
          <year>2012</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2012</copyright-year>
        <copyright-holder>Qiao et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>The cellular composition of heterogeneous samples can be predicted using an expression deconvolution algorithm to decompose their gene expression profiles based on pre-defined, reference gene expression profiles of the constituent populations in these samples. However, the expression profiles of the actual constituent populations are often perturbed from those of the reference profiles due to gene expression changes in cells associated with microenvironmental or developmental effects. Existing deconvolution algorithms do not account for these changes and give incorrect results when benchmarked against those measured by well-established flow cytometry, even after batch correction was applied. We introduce PERT, a new probabilistic expression deconvolution method that detects and accounts for a shared, multiplicative perturbation in the reference profiles when performing expression deconvolution. We applied PERT and three other state-of-the-art expression deconvolution methods to predict cell frequencies within heterogeneous human blood samples that were collected under several conditions (uncultured mono-nucleated and lineage-depleted cells, and culture-derived lineage-depleted cells). Only PERT's predicted proportions of the constituent populations matched those assigned by flow cytometry. Genes associated with cell cycle processes were highly enriched among those with the largest predicted expression changes between the cultured and uncultured conditions. We anticipate that PERT will be widely applicable to expression deconvolution strategies that use profiles from reference populations that vary from the corresponding constituent populations in cellular state but not cellular phenotypic identity.</p>
      </abstract>
      <abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>The cellular composition of heterogeneous samples can be predicted from reference gene expression profiles that represent the homogeneous, constituent populations of the heterogeneous samples. However, existing methods fail when the reference profiles are not representative of the constituent populations. We developed PERT, a new probabilistic expression deconvolution method, to address this limitation. PERT was used to deconvolve the cellular composition of variably sourced and treated heterogeneous human blood samples. Our results indicate that even after batch correction is applied, cells presenting the same cell surface antigens display different transcriptional programs when they are uncultured versus culture-derived. Given gene expression profiles of culture-derived heterogeneous samples and profiles of uncultured reference populations, PERT was able to accurately recover proportions of the constituent populations composing the heterogeneous samples. We anticipate that PERT will be widely applicable to expression deconvolution strategies that use profiles from reference populations that vary from the corresponding constituent populations in cellular state but not cellular phenotypic identity.</p>
      </abstract>
      <funding-group>
        <funding-statement>This work was funded by Natural Science and Engineering Research Council operating grants to QM and PWZ, a Canadian Stem Cell Network grant to PWZ, a Early Researcher Award to QM, and an Ontario Graduate Scholarship to WQ. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="14"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Heterogeneity as a description of a biological sample typically refers to the co-existence of phenotypically and functionally distinct cell populations therein. In a dynamic system such as <italic>in vitro</italic> stem cell growth and differentiation, cells continuously self-renew, differentiate and die in response to a changing microenvironment. The ability to elucidate compositions of heterogeneous samples with respect to their constituent (homogeneous) populations is a pre-requisite for identifying the parameters governing these dynamic systems. Although cellular compositions can be deconvolved using flow cytometry gated on constituent population-associated surface antigens or fluorescent intracellular proteins, these approaches are constrained by their requirements for sample formats – only cells in suspension media can be analysed – and have limited power to discover novel populations emerging from heterogeneous samples. A more efficient, unbiased cellular decomposition technique that recapitulates flow cytometry-based deconvolution of heterogeneous samples using less material is desirable.</p>
      <p>For elucidating compositions of highly heterogeneous samples, gene expression-based cellular deconvolution is more efficient, unbiased and economical. The technique has been used to decompose samples from yeast cell culture <xref ref-type="bibr" rid="pcbi.1002838-Lu1">[1]</xref>, tumor tissues <xref ref-type="bibr" rid="pcbi.1002838-Venet1">[2]</xref>, and peripheral blood of systemic lupus erythematosus <xref ref-type="bibr" rid="pcbi.1002838-Abbas1">[3]</xref> and multiple sclerosis patients <xref ref-type="bibr" rid="pcbi.1002838-Gong1">[4]</xref>. Existing studies model gene expression profiles of heterogeneous samples (termed mixed profiles) as positively weighted sums of the gene expression profiles of pre-specified reference populations, where these reference profiles are chosen to represent constituent populations within the heterogeneous samples. The task is to estimate the proportion of each reference population within the heterogeneous samples. These models have two major limitations. First, reference profiles for all constituent populations of the heterogeneous samples of interest have to be available; however, new cell types or populations may have emerged from cell differentiation in dynamic circumstances, and cannot be accounted for by existing methods. Second, reference profiles must accurately represent the gene expression profiles of the actual constituent populations (termed the constituent profiles) of the heterogeneous samples of interest. However, because reference population samples and heterogeneous samples of interest are likely collected separately and therefore may exhibit transcriptional variations due to microenvironmental (e.g., inter-cellular communication) and developmental (e.g., culture conditions) changes, reproduction of flow cytometry analysis under such transcriptional variations cannot be achieved by existing methods. Thus, we aimed to develop flexible deconvolution models that consider the presence of new cell types or populations in heterogeneous samples, and also consider systematic fluctuations in gene expression between reference profiles and constituent profiles.</p>
      <p>Recently, Quon and Morris developed ISOLATE <xref ref-type="bibr" rid="pcbi.1002838-Quon1">[5]</xref> based on the Latent Dirichlet Allocation (LDA) model <xref ref-type="bibr" rid="pcbi.1002838-Blei1">[6]</xref> for estimating proportions of cancer cells in tumor samples using quantitative gene expression data. In contrast to the linear regression models, these models use a multinomial noise model <xref ref-type="bibr" rid="pcbi.1002838-Posekany1">[7]</xref> that is a better fit to measurement noise in gene expression data <xref ref-type="bibr" rid="pcbi.1002838-Tu1">[8]</xref>. We hypothesized that these models could be extended to allow transcriptional variations between reference and constituent populations.</p>
      <p>Here we compare four models: a linear regression model called the non-negative least squares model (NNLS) <xref ref-type="bibr" rid="pcbi.1002838-Lawson1">[9]</xref>, the non-negative maximum likelihood model (NNML), the non-negative maximum likelihood new population model (NNML<sub>np</sub>), and the perturbation model (PERT). NNLS assumes all constituent populations are represented in the reference profiles, and uses a linear regression framework to estimate the proportion of each heterogeneous sample attributable to each of the reference populations. NNML makes the same assumptions and solves the same problem as NNLS, but uses the LDA <xref ref-type="bibr" rid="pcbi.1002838-Blei1">[6]</xref> framework for posing and solving the problem. NNML<sub>np</sub> is a version of ISOLATE <xref ref-type="bibr" rid="pcbi.1002838-Quon1">[5]</xref> that assumes there is an additional constituent population in the heterogeneous samples that is not represented by the available reference profiles, and is therefore estimated. PERT is our new model that is based on the NNML framework but accounts for transcriptional variations between reference and constituent profiles. The models were applied to uncultured mono-nucleated and lineage-depleted (Lin-, where cells expressing blood cell lineage-associated cell surface antigens are removed) cells enriched from fresh human umbilical cord blood, and cultured-derived Lin- cells. Model predictions were validated using an established flow cytometry assay. Overall, our analysis demonstrated that averaged absolute differences between PERT's predictions and flow cytometry measurements were significantly lower than the other models for uncultured mono-nucleated cells, uncultured Lin- cells, and culture-derived Lin- cells. Gene Ontology enrichment analysis of the genes that underwent 2-fold perturbation when comparing uncultured with culture-derived cells suggested that the transcriptional variations between these two cell populations were the result of up-regulation of cell cycle related genes in culture-derived cells.</p>
      <p>We show that (i) cells presenting the same cell surface antigens can exhibit differences in transcriptional programs when they are subjected to different microenvironmental and developmental conditions; (ii) these variations cannot be corrected using current batch effect models, highlighting the need for care when comparing primary cells subjected to different exogenous perturbations; and (iii) these variations can be captured by modeling a shared gene-specific rescaling (in other words, a multiplicative perturbation) as part of the expression deconvolution. Our new model, PERT, is a deconvolution model that addresses transcriptional variations between reference and constituent profiles. The model is readily applicable to circumstances where available reference profiles are collected under different microenvironmental or developmental conditions from the heterogeneous samples.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Deconvolution model formulation</title>
        <p>In this study, four models, NNLS, NNML, NNML<sub>np</sub> and PERT, were compared for their ability to deconvolve uncultured and culture-derived heterogeneous human blood samples. We used two measures of success: deconvolution accuracy defined as the proportion of variance (R<sup>2</sup>) in the measured proportions of constituent populations explained by the model's predictions, and averaged absolute difference between model predictions and experimental measurements.</p>
        <p>Given the gene expression profile of a heterogeneous sample that is a physical mixture of its constituent populations (<xref ref-type="fig" rid="pcbi-1002838-g001">Figure 1A</xref>), NNLS (<xref ref-type="fig" rid="pcbi-1002838-g001">Figure 1B-i</xref>) assumes that both the reference populations (whose gene expression profiles were provided for deconvolution) and the constituent populations were subjected to the same microenvironmental and developmental conditions and thus were equivalent. Therefore, a mixed profile is modeled as a positively weighted sum of reference profiles. Weight w<sub>i</sub> indicates the proportion of reference population <italic>i</italic> within the heterogeneous sample, and is fit by minimizing the least squares error between the estimated and observed mixed profiles under an additive Gaussian measurement noise model <xref ref-type="bibr" rid="pcbi.1002838-Lu1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002838-Abbas1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1002838-Gong1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002838-Venet2">[10]</xref> while constraining the weights to be non-negative <xref ref-type="bibr" rid="pcbi.1002838-Lawson1">[9]</xref>. However, several studies have shown that the variance in gene expression measurement noise scales with the mean <xref ref-type="bibr" rid="pcbi.1002838-Tu1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002838-Hardin1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002838-Weng1">[12]</xref>, contrary to the assumption of the additive Gaussian noise model. NNML <xref ref-type="bibr" rid="pcbi.1002838-Blei1">[6]</xref> (<xref ref-type="fig" rid="pcbi-1002838-g001">Figure 1B-i</xref>) is similar to NNLS, but replaces the additive Gaussian measurement noise model with a multinomial noise model which has the desired scaling. However, neither NNLS nor NNML is designed to address two key challenges: first, the presence of additional constituent populations in the heterogeneous sample whose corresponding reference profiles are not available; second, transcriptional variations between constituents and corresponding reference populations that arise due to microenvironmental or developmental factors.</p>
        <fig id="pcbi-1002838-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002838.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Schematic of deconvolution models.</title>
            <p>(A) Generation of mixed profiles from heterogeneous samples. (A-i) represents a heterogeneous sample whose composition is unknown. Each bar in (A-ii) represents individual gene expression levels of the heterogeneous sample. (B) Schematic of four deconvolution models. (B-i) The non-negative least squares model (NNLS) (Lawson and Hanson (1995)) and the non-negative maximum likelihood model (NNML) predict proportions of pre-specified reference populations in a heterogeneous sample using mixed and reference profiles. (B-ii) The non-negative maximum likelihood new population model (NNML<sub>np</sub>) estimates the gene expression profile of a new reference population that may exist in a heterogeneous sample; simultaneously, the model predicts proportions of both input reference populations and the new reference population. (B-iii) The perturbation model (PERT) perturbs the input reference profiles using a genome-wide perturbation vector <bold><italic>ρ</italic></bold>; simultaneously, the model predicts proportions of the reference populations in a heterogeneous sample. Parameters shown in red are model predicted.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002838.g001" position="float" xlink:type="simple"/>
        </fig>
        <p>We addressed the first challenge using NNML<sub>np</sub> (<xref ref-type="fig" rid="pcbi-1002838-g001">Figure 1B-ii</xref>). The model estimates the gene expression profile <bold><italic>γ</italic></bold> of a new, latent reference population to capture expression patterns in the heterogeneous samples that are not explained by the provided reference profiles. Simultaneously, the model estimates the proportions of individual reference populations in the heterogeneous samples.</p>
        <p>We developed PERT (<xref ref-type="fig" rid="pcbi-1002838-g001">Figure 1B-iii</xref>) to address the second challenge. The model estimates a genome-wide perturbation vector <bold><italic>ρ</italic></bold> where each element of <bold><italic>ρ</italic></bold>, <italic>ρ<sub>g</sub></italic>, reflects the fold difference in expression of gene <italic>g</italic> in the constituent profiles versus the reference profiles: <italic>ρ<sub>g</sub></italic>&gt;1 indicates increased expression of gene <italic>g</italic> in constituent profiles compared to the reference profiles; <italic>ρ<sub>g</sub></italic> = 1 indicates no change; and <italic>ρ<sub>g</sub></italic>&lt;1 indicates decreased expression. Simultaneously, the model estimates the proportions of individual reference populations in the heterogeneous samples (Materials and Methods).</p>
      </sec>
      <sec id="s2b">
        <title>NNML does not require cell line signature genes</title>
        <p>To compare deconvolution accuracy (R<sup>2</sup>) and averaged absolute differences between the linear regression and LDA-based probabilistic models, we used archival gene expression data of heterogeneous samples created by mixing RNA samples of Raji, Jurkat, IM-9 and THP-1 cell lines in known proportions <xref ref-type="bibr" rid="pcbi.1002838-Abbas1">[3]</xref>. Compositions of the RNA mixtures were deconvolved using NNLS and NNML with gene expression profiles of 54,613 Affymetrix probes. The model predicted cell proportions were benchmarked against the results from <xref ref-type="bibr" rid="pcbi.1002838-Abbas1">[3]</xref> (<xref ref-type="fig" rid="pcbi-1002838-g002">Figure 2A</xref>), which were obtained using a NNLS model with an optimal number of 275 signature probes per cell line that were selected to maximize transcriptional distinction between the cell lines.</p>
        <fig id="pcbi-1002838-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002838.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>NNML recovers known compositions of immune cell line mixtures.</title>
            <p>Microarray data of IM-9 (○), Jurkat (▵), Raji (□), THP-1 (+), and the mixtures of these four cell lines in known proportions were obtained from Abbas et al. (2009). Proportions of each cell line were predicted using (A) NNLS with cell line signature probes (reproduced from Abbas et al. (2009)), (B) NNLS without cell line signature probe, (C) NNML with cell line signature probes, and (D) NNLS without cell line signature probes. Model predictions were compared with the input proportions used to create the mixtures. Cell line signature probes were obtained from Abbas et al. (2009).</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002838.g002" position="float" xlink:type="simple"/>
        </fig>
        <p>The deconvolution accuracy achieved by NNML using the 54,613 probes (<xref ref-type="fig" rid="pcbi-1002838-g002">Figure 2D</xref>) was only 0.01 lower than that achieved by NNLS using the optimized signature probes (<xref ref-type="fig" rid="pcbi-1002838-g002">Figure 2A</xref>), and the averaged absolute difference of NNML was 0.18% higher. For NNML using the optimized probes, the deconvolution accuracy (<xref ref-type="fig" rid="pcbi-1002838-g002">Figure 2C</xref>) was 0.08 lower than that of NNLS (<xref ref-type="fig" rid="pcbi-1002838-g002">Figure 2A</xref>), and the averaged absolute difference was 1.55% higher. In contrast, deconvolution accuracy of NNLS using all the probes (<xref ref-type="fig" rid="pcbi-1002838-g002">Figure 2B</xref>) was 0.25 lower than that of NNLS using the optimized probes, and the averaged absolute difference was 5.02% higher.</p>
        <p>In this cell line analysis, the mixed profiles were derived from mixtures of RNA samples of 4 cell lines; there was no opportunity for microenvironmental or developmental factors to influence the gene expression of the reference and the constituent populations. Our analysis establishes a baseline that the LDA-based probabilistic model eliminates the need for cell line signature probes while performing deconvolution as accurately as the linear regression model with carefully optimized cell line signature probes, when the reference profiles match the constituent profiles of heterogeneous samples (Figures S1, S2, S3 in <xref ref-type="supplementary-material" rid="pcbi.1002838.s017">Text S1</xref>).</p>
      </sec>
      <sec id="s2c">
        <title>Homogeneous populations with identical phenotypes exhibit varied transcriptional programs under varied environmental conditions</title>
        <p>Analysis of blood progenitor cell surface antigens is a widely used surrogate for cellular functional properties, despite widespread recognition that this parameter is dynamic, especially on culture-derived cells <xref ref-type="bibr" rid="pcbi.1002838-Dorrell1">[13]</xref>. Assuming that functional properties of a cell population are encoded by its transcriptional program, we hypothesized that cells from different microenvironmental and developmental conditions exhibit varied transcriptional programs despite their identical presentation of cell surface antigens. To validate this hypothesis, we compared genome-wide transcriptome profiles of uncultured and culture-derived blood mature cells and progenitor cells. The experimental protocol is shown in <xref ref-type="fig" rid="pcbi-1002838-g003">Figure 3A</xref>. In brief, megakaryocytes and colony forming unit-monocytes (CFU-M) were sorted from fresh (day-0) human umbilical cord blood. Enriched Lin- cells from the same umbilical cord blood samples were cultured as described in <xref ref-type="bibr" rid="pcbi.1002838-Kirouac1">[14]</xref>. Megakaryocytes and CFU-M were harvested on day 4 using the same cell surface antigens and gating strategies as for day-0 samples (Figure S4 in <xref ref-type="supplementary-material" rid="pcbi.1002838.s017">Text S1</xref>). Gene expression profiles of the uncultured (day-0) and culture-derived (day-4) cells were obtained. As all the samples were prepared by following the same technical procedure, no batch removal analysis of gene expression data was performed. <xref ref-type="fig" rid="pcbi-1002838-g003">Figure 3B</xref> shows that robust multi-array average (RMA) <xref ref-type="bibr" rid="pcbi.1002838-Irizarry1">[15]</xref> normalized gene expression profiles of the day-0 and day-4 samples segregated into “uncultured” and “cultured” clusters based on their Pearson's correlation coefficients, instead of “megakaryocyte” and “CFU-M” clusters as would be expected from a functional perspective. Gene set enrichment analysis (GSEA) <xref ref-type="bibr" rid="pcbi.1002838-Subramanian1">[16]</xref> suggested that genes up-regulated in day-4 samples compared to day-0 samples were enriched in cell cycle related processes, and those down-regulated were enriched in immune and inflammatory responses (<xref ref-type="fig" rid="pcbi-1002838-g003">Figure 3C</xref>, <xref ref-type="supplementary-material" rid="pcbi.1002838.s004">Table S1</xref>). We anticipated that a “cell culture effect” had caused uncultured and culture-derived cells expressing the same lineage-associated surface antigens to exhibit different transcriptional programs.</p>
        <fig id="pcbi-1002838-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002838.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>PERT captures cell culture effects.</title>
            <p>(A) Experimental setup for profiling genome-wide transcriptome expression of uncultured (day-0) and culture-derived (day-4) colony forming unit-monocytes (CFU-M) and megakaryocytes (MEGA). Lin-: lineage-depleted cells; TPO: thrombopoietin; SCF: stem cell factor; FLT3LG: fms-related tyrosine kinase 3 ligand. (B) Pearson's correlation comparison between day-0 and day-4 samples. (C) Plots of Gene Ontology enrichment analysis showing the enrichment scores of cell cycle phase genes, immune response genes, and inflammatory response genes by day-4 samples compared with day-0 samples. NES denotes the normalized enrichment score. P-values (<italic>P</italic>) were calculated using the hypergeometric test. (D) Pearson's correlation comparison between day-0 CFU-M, day-4 CFU-M, and perturbed day-0 CFU-M (or model predicted day-4 CFU-M) gene expression profiles. (E) Pearson's correlation comparison between day-0 megakaryocyte, day-4 megakaryocyte, and perturbed day-0 megakaryocyte (or model predicted day-4 megakaryocyte) gene expression profiles.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002838.g003" position="float" xlink:type="simple"/>
        </fig>
        <p>We then explored if PERT could capture and account for the cell culture effect. The model was applied to day-0 and day-4 megakaryocytes (or CFU-M) to estimate a genome-wide multiplicative perturbation vector, <bold><italic>ρ</italic></bold>, to capture gene-specific cell culture effects (<xref ref-type="supplementary-material" rid="pcbi.1002838.s005">Table S2</xref>). GSEA was applied to the genes whose expression levels had been perturbed by more than 2-fold (<italic>ρ<sub>g</sub></italic>&lt;0.5 or <italic>ρ<sub>g</sub></italic>&gt;2) when comparing day-4 megakaryocytes with day-0 megakaryocytes, and day-4 CFU-M with day-0 CFU-M. We found that the GSEA results for megakaryocytes (<xref ref-type="supplementary-material" rid="pcbi.1002838.s006">Table S3</xref>) and CFU-M (<xref ref-type="supplementary-material" rid="pcbi.1002838.s007">Table S4</xref>) were similar. Overall, the day-4 samples exhibited higher expression of cell cycle, cell division, DNA and RNA metabolic processes and cell component assembly related genes (Conditional hypergeometric test <xref ref-type="bibr" rid="pcbi.1002838-Falcon1">[17]</xref>, <italic>P</italic>&lt;0.01), and the day-4 samples exhibited a decrease in expression of immune system related genes (Conditional hypergeometric test <xref ref-type="bibr" rid="pcbi.1002838-Falcon1">[17]</xref>, <italic>P</italic>&lt;0.01). These results were consistent with the results shown in <xref ref-type="fig" rid="pcbi-1002838-g003">Figure 3C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002838.s004">Table S1</xref>, suggesting that PERT had captured the cell culture effects. The <bold><italic>ρ</italic></bold> vector from comparing day-4 with day-0 megakaryocytes (or from comparing day-4 with day-0 CFU-M) was then applied to the gene expression profiles of day-0 CFU-M (or day-0 megakaryocytes) to obtain perturbed gene expression profiles of day-0 CFU-M (or day-0 megakaryocyte). As shown in <xref ref-type="fig" rid="pcbi-1002838-g003">Figure 3D</xref> (or 3E), the perturbed gene expression profiles of day-0 CFU-M (or day-0 megakaryocyte) exhibited a stronger Pearson's correlation with that of day-4 CFU-M (or day-4 megakaryocyte) than the original gene expression profiles of day-0 CFU-M (or day-0 megakaryocyte), confirming the success of PERT in estimating systematic effect of cell culture on reference profiles (Figures S5 and S6 in <xref ref-type="supplementary-material" rid="pcbi.1002838.s017">Text S1</xref>).</p>
      </sec>
      <sec id="s2d">
        <title>PERT recovers constituent proportions of uncultured human umbilical cord blood samples</title>
        <p>Having established that expression deconvolution was accurate for samples where all constituent populations were known and that PERT could capture systematic transcriptional variations between uncultured populations and the cultured versions of those populations, we then used the four models — NNLS, NNML, NNML<sub>np</sub> and PERT — to deconvolve uncultured human mono-nucleated and Lin- umbilical cord blood samples (<xref ref-type="fig" rid="pcbi-1002838-g004">Figure 4A</xref>) where compositions are not pre-specified.</p>
        <fig id="pcbi-1002838-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002838.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>PERT recovers compositions of uncultured human cord blood mono-nucleated and lineage-depleted (Lin-) cells.</title>
            <p>(A) Schematic compositions of mono-nucleated cell samples and Lin- cell samples. (B) Model predicted proportions of 11 homogeneous blood cell lineages, namely granulocytes (GRAN), erythrocytes (ERY), monocytes (MONO), precursor B cells (PREB), megakaryocyte-erythrocyte progenitors (MEP), megakaryocytes (MEGA), primitive progenitor cells (PPC), eosinophils (EOS), granulocyte-monocyte progenitors (GMP), common myeloid progenitors (CMP), and basophils (BASO) in uncultured human mono-nucleated cord blood cell samples. (C) Flow cytometry measured proportions of the 11 blood cell lineages in the uncultured human mono-nucleated cord blood cell samples shown in (B). (D) Model predicted proportions in uncultured human Lin- cord blood cell samples. (E) Flow cytometry measured proportions in the uncultured human Lin- cord blood cell samples shown in (D). (F) R<sup>2</sup> calculated from the Pearson's correlation coefficients between the model predicted cell proportions and the ones assigned by flow cytometry. See <xref ref-type="table" rid="pcbi-1002838-t002">Table 2</xref> for the associated t-statistics and P-values. (G) Averaged absolute differences of model predicted cell proportions. Error bars show standard deviations of the absolute differences between model predicted and flow cytometry assigned proportions of the 11 blood cell lineages. (H) The Bayesian information criterion (BIC) calculated from the parameters in <xref ref-type="table" rid="pcbi-1002838-t001">Table 1</xref>.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002838.g004" position="float" xlink:type="simple"/>
        </fig>
        <p>Mixed profiles of mono-nucleated cells enriched from fresh human umbilical cord blood were first deconvolved to estimate the proportions of 11 developmentally and functionally distinct blood populations (<xref ref-type="supplementary-material" rid="pcbi.1002838.s008">Table S5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002838.s017">Text S1</xref>) using their reference profiles from <xref ref-type="bibr" rid="pcbi.1002838-Novershtern1">[18]</xref>. As expected, because the two sets of samples were obtained by different labs, batch effects between the mixed profiles and the reference profiles were observed, and these were removed using the supervised normalization of microarray (SNM) method <xref ref-type="bibr" rid="pcbi.1002838-Mecham1">[19]</xref>. We benchmarked the model predicted cell proportions (<xref ref-type="fig" rid="pcbi-1002838-g004">Figure 4B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002838.s009">Table S6</xref>) against those measured by flow cytometry (<xref ref-type="fig" rid="pcbi-1002838-g004">Figure 4C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002838.s009">Table S6</xref>) using the same cell surface antigens originally used to recover the reference populations in <xref ref-type="bibr" rid="pcbi.1002838-Novershtern1">[18]</xref>. The same analysis was performed for fresh human umbilical cord blood-derived Lin- cell samples (<xref ref-type="fig" rid="pcbi-1002838-g004">Figures 4D and 4E</xref>, and <xref ref-type="supplementary-material" rid="pcbi.1002838.s009">Table S6</xref>), which are known to have different compositions from mono-nucleated cell samples. The gene expression profile <bold><italic>γ</italic></bold> of the new reference population from NNML<sub>np</sub> and the perturbation vector <bold><italic>ρ</italic></bold> from PERT are given in <xref ref-type="supplementary-material" rid="pcbi.1002838.s010">Table S7</xref>. Results of GSEA for genes whose perturbation factor <italic>ρ<sub>g</sub></italic> is &lt;0.5 or &gt;2 are in <xref ref-type="supplementary-material" rid="pcbi.1002838.s011">Table S8</xref>.</p>
        <p>Notably, the deconvolved proportions of uncultured mono-nucleated cell samples and Lin- cell samples using NNML and that of NNML<sub>np</sub> were not substantially different (<italic>P</italic> = 2.43×10<sup>−1</sup>) (<xref ref-type="fig" rid="pcbi-1002838-g004">Figures 4F and 4G</xref>). For mono-nucleated cell samples, there was a large improvement in the deconvolution performance of PERT compared to the other three models in terms of both the deconvolution accuracy R<sup>2</sup> and the averaged absolute differences (<xref ref-type="fig" rid="pcbi-1002838-g004">Figures 4F and 4G</xref>). However, for Lin- cell samples, while the deconvolution accuracy R<sup>2</sup> of NNLS and PERT were both high, the absolute differences of PERT were significantly lower than that of NNLS (<italic>P</italic> = 5.00×10<sup>−3</sup>). The Bayesian information criterion (BIC) indicated preferential applicability of PERT in deconvolving these uncultured heterogeneous samples (<xref ref-type="table" rid="pcbi-1002838-t001">Table 1</xref> and <xref ref-type="fig" rid="pcbi-1002838-g004">Figure 4H</xref>).</p>
        <table-wrap id="pcbi-1002838-t001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002838.t001</object-id>
          <label>Table 1</label>
          <caption>
            <title>Parameters of NNML, NNML<sub>np</sub> and PERT for the Bayesian information criterion (BIC) calculations shown in <xref ref-type="fig" rid="pcbi-1002838-g004">Figure 4H</xref> and <xref ref-type="fig" rid="pcbi-1002838-g005">Figure 5F</xref>.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002838-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002838.t001" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td colspan="3" align="left" rowspan="1">Uncultured mono-nucleated and lineage-depleted cell samples</td>
                  <td colspan="3" align="left" rowspan="1">Culture-derived (day-4) lineage-depleted cell samples</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td align="left" rowspan="1" colspan="1">NNML</td>
                  <td align="left" rowspan="1" colspan="1">NNML<sub>np</sub></td>
                  <td align="left" rowspan="1" colspan="1">PERT</td>
                  <td align="left" rowspan="1" colspan="1">NNML</td>
                  <td align="left" rowspan="1" colspan="1">NNML<sub>np</sub></td>
                  <td align="left" rowspan="1" colspan="1">PERT</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">N<sub>reference</sub></td>
                  <td align="left" rowspan="1" colspan="1">118</td>
                  <td align="left" rowspan="1" colspan="1">118</td>
                  <td align="left" rowspan="1" colspan="1">118</td>
                  <td align="left" rowspan="1" colspan="1">118</td>
                  <td align="left" rowspan="1" colspan="1">118</td>
                  <td align="left" rowspan="1" colspan="1">118</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">N<sub>heterogenous</sub></td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">N<sub>probes</sub></td>
                  <td align="left" rowspan="1" colspan="1">-</td>
                  <td align="left" rowspan="1" colspan="1">22215</td>
                  <td align="left" rowspan="1" colspan="1">22215</td>
                  <td align="left" rowspan="1" colspan="1">-</td>
                  <td align="left" rowspan="1" colspan="1">22215</td>
                  <td align="left" rowspan="1" colspan="1">22215</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">θ</td>
                  <td align="left" rowspan="1" colspan="1">468</td>
                  <td align="left" rowspan="1" colspan="1">468</td>
                  <td align="left" rowspan="1" colspan="1">468</td>
                  <td align="left" rowspan="1" colspan="1">468</td>
                  <td align="left" rowspan="1" colspan="1">468</td>
                  <td align="left" rowspan="1" colspan="1">468</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">ω</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1"/>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">κ</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                  <td align="left" rowspan="1" colspan="1">1</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">α</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                  <td align="left" rowspan="1" colspan="1">4</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">β</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">22214</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">22214</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">ρ</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">22215</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">0</td>
                  <td align="left" rowspan="1" colspan="1">22215</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">N<sub>parameters</sub></td>
                  <td align="left" rowspan="1" colspan="1">468</td>
                  <td align="left" rowspan="1" colspan="1">45039</td>
                  <td align="left" rowspan="1" colspan="1">45036</td>
                  <td align="left" rowspan="1" colspan="1">468</td>
                  <td align="left" rowspan="1" colspan="1">45039</td>
                  <td align="left" rowspan="1" colspan="1">45036</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">N<sub>observations</sub></td>
                  <td align="left" rowspan="1" colspan="1">68133988</td>
                  <td align="left" rowspan="1" colspan="1">68133988</td>
                  <td align="left" rowspan="1" colspan="1">68133988</td>
                  <td align="left" rowspan="1" colspan="1">45933224</td>
                  <td align="left" rowspan="1" colspan="1">45933224</td>
                  <td align="left" rowspan="1" colspan="1">45933224</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">In(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002838.e001" xlink:type="simple"/></inline-formula>)</td>
                  <td align="left" rowspan="1" colspan="1">−6.07E+08</td>
                  <td align="left" rowspan="1" colspan="1">−6.02E+08</td>
                  <td align="left" rowspan="1" colspan="1">−5.89E+08</td>
                  <td align="left" rowspan="1" colspan="1">−4.13E+08</td>
                  <td align="left" rowspan="1" colspan="1">−4.00E+08</td>
                  <td align="left" rowspan="1" colspan="1">−3.91E+08</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">BIC</td>
                  <td align="left" rowspan="1" colspan="1">1.21E+09</td>
                  <td align="left" rowspan="1" colspan="1">1.20E+09</td>
                  <td align="left" rowspan="1" colspan="1">1.18E+09</td>
                  <td align="left" rowspan="1" colspan="1">8.26E+08</td>
                  <td align="left" rowspan="1" colspan="1">8.00E+08</td>
                  <td align="left" rowspan="1" colspan="1">7.83E+08</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
        </table-wrap>
        <table-wrap id="pcbi-1002838-t002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002838.t002</object-id>
          <label>Table 2</label>
          <caption>
            <title>Associated statistics for the Pearson's correlation analysis between the model predicted and flow cytometry assigned cell proportions for uncultured mono-nucleated and lineage-depleted cell samples enriched from fresh human umbilical cord blood.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002838-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002838.t002" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" rowspan="1" colspan="1"/>
                  <td colspan="3" align="left" rowspan="1">Mono-nucleated cells samples</td>
                  <td colspan="3" align="left" rowspan="1">Lineage-depleted cells samples</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Models</td>
                  <td align="left" rowspan="1" colspan="1">R</td>
                  <td align="left" rowspan="1" colspan="1">t-stats</td>
                  <td align="left" rowspan="1" colspan="1">P-value</td>
                  <td align="left" rowspan="1" colspan="1">R</td>
                  <td align="left" rowspan="1" colspan="1">t-stats</td>
                  <td align="left" rowspan="1" colspan="1">P-value</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">NNLS</td>
                  <td align="left" rowspan="1" colspan="1">0.29</td>
                  <td align="left" rowspan="1" colspan="1">0.91</td>
                  <td align="left" rowspan="1" colspan="1">0.39</td>
                  <td align="left" rowspan="1" colspan="1">0.92</td>
                  <td align="left" rowspan="1" colspan="1">7.04</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">NNML</td>
                  <td align="left" rowspan="1" colspan="1">0.58</td>
                  <td align="left" rowspan="1" colspan="1">2.14</td>
                  <td align="left" rowspan="1" colspan="1">0.06</td>
                  <td align="left" rowspan="1" colspan="1">0.56</td>
                  <td align="left" rowspan="1" colspan="1">2.03</td>
                  <td align="left" rowspan="1" colspan="1">0.07</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">NNML<sub>np</sub></td>
                  <td align="left" rowspan="1" colspan="1">0.58</td>
                  <td align="left" rowspan="1" colspan="1">2.14</td>
                  <td align="left" rowspan="1" colspan="1">0.06</td>
                  <td align="left" rowspan="1" colspan="1">0.58</td>
                  <td align="left" rowspan="1" colspan="1">2.14</td>
                  <td align="left" rowspan="1" colspan="1">0.06</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">PERT</td>
                  <td align="left" rowspan="1" colspan="1">0.99</td>
                  <td align="left" rowspan="1" colspan="1">21.05</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                  <td align="left" rowspan="1" colspan="1">0.97</td>
                  <td align="left" rowspan="1" colspan="1">11.97</td>
                  <td align="left" rowspan="1" colspan="1">0.00</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>R: Pearson's correlation coefficients.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>This analysis indicates that PERT recovered cell proportions of 11 reference populations with averaged absolute differences as low as 2%. In addition, PERT only required two biological samples of mono-nucleated cells and Lin- cells, and 4 to 10 biological profiles of individual reference populations, whereas flow cytometry required preparation of 41 aliquot samples (including controls) to measure the proportions of the same constituent populations as the deconvolution analysis in one mono-nucleated or Lin- cell sample.</p>
      </sec>
      <sec id="s2e">
        <title>PERT recovers constituent proportions of culture-derived human blood samples</title>
        <p>Having established that PERT could capture culture-associated changes in gene expression in relatively pure populations (analysis of day-4 versus day-0 megakaryocytes and CFU-M) and microenvironment-associated changes in heterogeneous samples (analysis of uncultured mono-nucleated and Lin- cell samples), we next applied the model to analyze culture-derived heterogeneous samples from a hematopoietic stem and progenitor cell (HSPC) expansion culture. The experimental setup is described in detail elsewhere <xref ref-type="bibr" rid="pcbi.1002838-Kirouac2">[20]</xref>. In brief, human umbilical cord blood Lin- cells were seeded in a suspension culture that had been optimized for HSPC expansion. After 4 days, Lin- cells were harvested, and then their genome-wide transcriptome expression was profiled (<xref ref-type="fig" rid="pcbi-1002838-g005">Figure 5A</xref>).</p>
        <fig id="pcbi-1002838-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002838.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>PERT recovers compositions of culture-derived lineage-depleted (Lin-) human blood cells.</title>
            <p>(A) Schematic of experiment setup. (B) Model predicted cell proportions of 11 blood cell lineages (defined in <xref ref-type="fig" rid="pcbi-1002838-g004">Figure 4</xref>) in day-4 Lin- human blood cell samples. (C) Flow cytometry assigned averaged cell proportions (N = 3) in the day-4 Lin- human blood cell samples shown in (B). (D) R<sup>2</sup> calculated from the Pearson's correlation coefficients between the model predicted cell proportions and the ones assigned by flow cytometry. (E) Averaged absolute differences of model predicted cell proportions. Error bars show standard deviations of the absolute differences of the 11 blood cell lineages. (F) The Bayesian information criterion (BIC) calculated from the parameters in <xref ref-type="table" rid="pcbi-1002838-t001">Table 1</xref>.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002838.g005" position="float" xlink:type="simple"/>
        </fig>
        <p>Proportions of the 11 blood cell lineages <xref ref-type="bibr" rid="pcbi.1002838-Novershtern1">[18]</xref> were deconvolved (<xref ref-type="supplementary-material" rid="pcbi.1002838.s008">Table S5</xref> and Figure S8 in <xref ref-type="supplementary-material" rid="pcbi.1002838.s017">Text S1</xref>). Model predictions (<xref ref-type="fig" rid="pcbi-1002838-g005">Figure 5B</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002838.s009">Table S6</xref>) were validated by the cell proportions assigned by flow cytometry (<xref ref-type="fig" rid="pcbi-1002838-g005">Figure 5C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002838.s009">Table S6</xref>). The deconvolution accuracy R<sup>2</sup> of PERT was significantly higher than that of the other models (<xref ref-type="fig" rid="pcbi-1002838-g005">Figure 5D</xref>), and the averaged absolute differences of PERT were lower as assessed by the Wilcoxon signed rank test (<italic>P</italic> for PERT versus NNLS, PERT versus NNML, and PERT versus NNML<sub>np</sub> were 9.00×10<sup>−3</sup>, 1.00×10<sup>−3</sup> and 1.39×10<sup>−1</sup>, respectively) (<xref ref-type="fig" rid="pcbi-1002838-g005">Figure 5E</xref>). In addition, the BIC (<xref ref-type="table" rid="pcbi-1002838-t001">Table 1</xref> and <xref ref-type="fig" rid="pcbi-1002838-g005">Figure 5F</xref>) indicates preferential applicability of PERT in this case. Intriguingly, compared with the results for uncultured samples for which deconvolution accuracy R<sup>2</sup> and averaged absolute differences of NNML and NNML<sub>np</sub> were not significantly different, the predictions of NNML<sub>np</sub> were much more correlated (R<sup>2</sup> = 0.49 versus R<sup>2</sup> = 0.06) with the cell proportions in the culture-derived samples than the NNML model, although the averaged absolute differences of the two models were similar.</p>
        <p>GSEA was performed for genes identified by PERT as being perturbed in the mixed profiles by more than 2-fold over the reference profiles (<xref ref-type="supplementary-material" rid="pcbi.1002838.s012">Table S9</xref>). Cultured-derived Lin- cells were found to upregulate genes enriched in cell cycle, metabolic and catabolic processes, and biosynthetic processes (Conditional hypergeometric test <xref ref-type="bibr" rid="pcbi.1002838-Falcon1">[17]</xref>, <italic>P</italic>&lt;0.01) (<xref ref-type="supplementary-material" rid="pcbi.1002838.s013">Table S10</xref>).</p>
        <p>Collectively, this analysis showed that PERT recovered cell proportions of culture-derived heterogeneous samples using the gene expression profiles of uncultured reference populations. PERT analysis revealed that transcriptome differences between uncultured and culture-derived cells of the same phenotypic identity were attributable to the increased expression of cell cycle process related genes by the culture-derived cells.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>We have demonstrated that the transcriptional variations due to microenvironmental and developmental differences could not be addressed using existing batch effect models in gene expression deconvolution. We have introduced PERT, a new deconvolution method that allows for transcriptional variations between reference populations and constituent populations in heterogeneous samples of interest.</p>
      <p>Transcriptional programs of human cells fluctuate with circadian rhythms and vary among individuals <xref ref-type="bibr" rid="pcbi.1002838-Whitney1">[21]</xref>. Furthermore, procedures of blood collection, cell isolation and RNA extraction affect the expression of specific genes <xref ref-type="bibr" rid="pcbi.1002838-Debey1">[22]</xref>. As reference profiles and mixed profiles are often collected by different labs, available reference profiles may not accurately represent the corresponding constituent populations composing the mixed profiles, even though they have the same cell surface markers. Gene expression differences between the reference profiles and the constituent profiles cannot be accounted for by the existing batch effect models because they assume that the reference and the constituent populations are the same, except for technical differences in data collection.</p>
      <p>Differences in performance of the four models for culture-derived samples may be explained by one of several factors that can complicate deconvolution. First, progenitor cells in culture can differentiate and give arise to intermediate cell types or populations that are not included in the reference populations. This could explain why NNML<sub>np</sub> captured seven times more compositional variation than NNML when they were used on culture-derived Lin- cells, but the two models produced similar results when they were used on uncultured samples. Second, culture-derived heterogeneous samples and reference samples which were directly isolated from patient samples had been exposed to different environments. Cell extrinsic factors cause genome-wide transcriptional variations <xref ref-type="bibr" rid="pcbi.1002838-Venet3">[23]</xref> between the reference and constituent profiles. We found that these variations were not easily captured by modeling the presence of a new population in heterogeneous samples as is done by NNML<sub>np</sub>. In contrast, modeling these variations by a systematic genome-wide perturbation to the reference profiles as done by PERT was more successful.</p>
      <p>We anticipate that the improved performance of PERT in deconvolving heterogeneous samples over the other tested models herein is attributed to its more flexible and appropriate model assumptions. First, accumulating evidence has indicated the association between cell phenotypes and molecular networks consists of relatively small numbers of genes out of the whole genome <xref ref-type="bibr" rid="pcbi.1002838-Novershtern1">[18]</xref>. Although components of cell phenotype-associated molecular networks can be used as cell signature genes for NNLS deconvolution, identification of those components is challenging, especially for a large number of cell types within the hematopoietic system because mature hematopoietic cells are generated from hematopoietic stem and progenitor cells through an amplifying differentiation hierarchy and the transcriptional profiles that distinguish different but related cell types is still very much an area of active investigation <xref ref-type="bibr" rid="pcbi.1002838-Novershtern1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1002838-Notta1">[24]</xref>. Second, definition of cell type signature genes is technically subjective. Third, although NNML eliminates the need to identify cell type signature genes, the model assumes that each constituent population is represented by one or more reference populations, and that the reference profiles are accurate estimates of the profiles of the constituent populations. However, reference profiles are rarely accurate estimates of the constituent profiles in practice due to the effects of environmental factors, technical factors and cell-cell interactions on gene expression that often occur in cell culture. While NNML<sub>np</sub> can help address the problem of an incomplete reference profile set, it cannot account for systematic variations in reference and constituent profiles. PERT is the first step towards addressing these transcriptional variations due to culture conditions. A future development of PERT could be to estimate a perturbation factor for each reference population to represent cell type specific culture effect, as opposed to the shared perturbation factor used here. Such a model would be similar to an expression deconvolution model in which both the reference populations and their proportions were unknown with a strong prior to guide the deconvolution and ensure identifiability. We suspect that such model would require more data to fit.</p>
      <p>Here we demonstrated success in applying <italic>in silico</italic> techniques to deconvolve compositions of heterogeneous samples using reference profiles collected under different conditions. As a large amount of resource and energy is required to generate a comprehensive data set of reference profiles, the ability to use available reference profiles to decompose heterogeneous samples potentially collected from different environmental conditions should dramatically extend the utility of archival gene expression datasets. Selection of a proper deconvolution model can be challenging in the situation where the nature or content of mixed samples is uncertain. In this work, we explored R<sup>2</sup>, averaged absolute differences, and BIC as a means to select between NNLS, NNML, NNML<sub>np</sub> and PERT. Intriguingly, we found that PERT performed as well as, or better than the other models in all tested cases. The model has allowed us to recapitulate flow cytometry estimated cellular compositions of heterogeneous samples in a more efficient, unbiased manner. Our results demonstrated the importance of including prior knowledge of biological systems (e.g., existence of new cell populations, transcriptional variations between reference and constituent populations) to achieve excellent deconvolution accuracy. We anticipate that PERT is not only relevant to the hematopoietic system, but is applicable to any heterogeneous biological system given prior knowledge about the gene expression profiles of reference populations.</p>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>Non-negative least squares model (NNLS) formulation</title>
        <p>In the following model description, variables are in italics, constants are in uppercase, and vectors are in bold. All deconvolution models herein make several common assumptions. They assume that the input consists of two sets of expression profiles. One set consists of D heterogeneous profiles corresponding to the gene expression profiles of D heterogeneous samples, where <bold><italic>x</italic></bold><italic><sub>d</sub></italic> is a vector of length G and <italic>x<sub>d,g</sub></italic> is the discretized total intensity measurement for gene <italic>g</italic> in sample <italic>d</italic>. The other set consists of K reference profiles corresponding to the gene expression profiles of K reference cell populations, where <bold><italic>v</italic></bold><italic><sub>k</sub></italic> is a vector of length G and <italic>v<sub>k,g</sub></italic> is the total intensity measurement for gene <italic>g</italic> in reference population <italic>k</italic>.</p>
        <p>The standard formulation for deconvolution is to model each heterogeneous profile <bold><italic>x</italic></bold><italic><sub>d</sub></italic> as a linear combination of measurements of the reference populations, <bold><italic>v</italic></bold><italic><sub>k</sub></italic>, weighted by mixture proportions <bold><italic>θ</italic></bold><italic><sub>d</sub></italic>:<disp-formula id="pcbi.1002838.e002"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e002" xlink:type="simple"/><label>(1)</label></disp-formula></p>
        <p>We used log<sub>2</sub> transformed gene expression data and the nnls() function from the nnls package (version 1.4) of R to estimate the optimal non-negative values of <italic>θ<sub>d,k</sub></italic> as previously described <xref ref-type="bibr" rid="pcbi.1002838-Lawson1">[9]</xref>. We then re-scaled the values <italic>θ<sub>d,k</sub></italic> such that Σ<sub>k</sub><italic>θ<sub>d,k</sub></italic> = 1 as done in <xref ref-type="bibr" rid="pcbi.1002838-Abbas1">[3]</xref>.</p>
        <p>There are several limitations with the NNLS model that we aimed to address in this work. First, NNLS requires cell type signature genes. However, identifying cell type-specific signature genes for different but related reference populations is challenging (<xref ref-type="supplementary-material" rid="pcbi.1002838.s017">Text S1</xref>). Second, as shown below, probabilistic representations of deconvolution can be naturally extended to estimate the profile of an additional (unknown) reference population, or to explicitly model the effects of cell culture on the gene expression profiles of cells.</p>
      </sec>
      <sec id="s4b">
        <title>Non-negative maximum likelihood model (NNML) formulation</title>
        <p>NNML is a probabilistic alternative to NNLS, which uses a different noise model that is less sensitive to the selection of cell type signature genes and also provides a basis upon which to address the estimation of an unknown reference population (NNML<sub>np</sub>) or cell culture effects (PERT). NNML treats heterogeneous expression profiles as digital measurements of gene abundances in a sample: that is, <italic>x<sub>d,g</sub></italic> represents a count of the number of times that gene <italic>g</italic> was found in sample <italic>d</italic> as measured in arbitrary units of intensity or read density. In other words, there are <italic>x<sub>d,g</sub></italic> observations of a unit of intensity. We model each of those <italic>x<sub>d,g</sub></italic> observations as coming from exactly one constituent population; <italic>x<sub>d,g</sub></italic> is therefore the sum of contributions from each of the constituent cell populations present in the heterogeneous sample, and N<italic><sub>d</sub></italic> = Σ<sub>g</sub><italic>x<sub>d,g</sub></italic> is the total number of observations for sample <italic>d</italic>. In this work, the units are selected so that N<italic><sub>d</sub></italic> is on the order of 10<sup>7</sup>. The goal of deconvolution is to estimate <italic>θ<sub>d,k</sub></italic>, the fraction of all observations in sample <italic>d</italic> attributable to reference population <italic>k</italic>, by identifying from which reference population each observation originates.</p>
        <p>In order to infer from which reference population each observation originates, we expand each heterogeneous expression profile from the compact vector <bold><italic>x</italic></bold><italic><sub>d</sub></italic> into an alternative vector <bold><italic>t</italic></bold><italic><sub>d</sub></italic> of length N<italic><sub>d</sub></italic>, where <italic>t<sub>d,n</sub></italic> ∈ {1,…,G} represents the <italic>n</italic><sup>th</sup> observation from sample <italic>d</italic>. Note that the vectors <bold><italic>t</italic></bold><italic><sub>d</sub></italic> and <bold><italic>x</italic></bold><italic><sub>d</sub></italic> store the same information because Σ<sub>n</sub>[<italic>t<sub>d,n</sub></italic> = g] = <italic>x<sub>d,g</sub></italic>, where [<italic>t<sub>d,n</sub></italic> = g] is the indictor function that is 1 if <italic>t<sub>d,n</sub></italic> = g, and otherwise 0. Representing heterogeneous profile <italic>d</italic> using the vector <bold><italic>t</italic></bold><italic><sub>d</sub></italic> allows us to simplify the deconvolution problem to inferring a vector <bold><italic>z</italic></bold><italic><sub>d</sub></italic> of length N<italic><sub>d</sub></italic>, where <italic>z<sub>d,n</sub></italic> = k indicates that the observation <italic>t<sub>d,n</sub></italic> originated from reference population <italic>k</italic>. Inference of all <italic>z<sub>d,n</sub></italic> variables allows straightforward estimation of <italic>θ<sub>d,k</sub></italic>; we can set <italic>θ<sub>d,k</sub></italic> = Σ<sub>n</sub>[<italic>z<sub>d,n</sub></italic> = k]/N<italic><sub>d</sub></italic>.</p>
        <p>Also, because NNML treats heterogeneous expression profiles <italic>t<sub>d,n</sub></italic> as digital measurements, it is natural to treat each observation <italic>t<sub>d,n</sub></italic> as a draw from a discrete distribution, whose parameters characterize the expression profile of the sample <italic>d</italic>. We first converted each of the reference expression profiles <bold><italic>v</italic></bold><italic><sub>k</sub></italic> into parameters of a discrete distribution <bold><italic>β</italic></bold><italic><sub>k</sub></italic>, where <italic>β<sub>k,g</sub></italic> = <italic>v<sub>k,g</sub></italic>/N<italic><sub>k</sub></italic> and N<italic><sub>k</sub></italic> = Σ<sub>g</sub><italic>v<sub>k,g</sub></italic>. For each observation <italic>t<sub>d,n</sub></italic> in heterogeneous sample <italic>d</italic>, conditioned on the knowledge of which constituent population it is from (i.e. knowledge of <italic>z<sub>d,n</sub></italic>), the likelihood of observing the specific gene <italic>t<sub>d,n</sub></italic> is defined by the appropriate reference distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002838.e003" xlink:type="simple"/></inline-formula>.</p>
        <p>NNML makes two limiting assumptions. First, it assumes that all constituent populations of each heterogeneous sample are represented by at least one discrete distribution <bold><italic>β</italic></bold><italic><sub>k</sub></italic> from the provided reference profiles. Second, it assumes that each reference profile <bold><italic>β</italic></bold><italic><sub>k</sub></italic> faithfully recapitulates the gene expression pattern of the corresponding cell type <italic>k</italic> in each heterogeneous sample. Under these assumptions, NNML estimates <bold><italic>θ</italic></bold><italic><sub>d</sub></italic> by maximizing the following complete log likelihood function using conjugate gradient descent until convergence of the likelihood function:<disp-formula id="pcbi.1002838.e004"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e004" xlink:type="simple"/><label>(2)</label></disp-formula><disp-formula id="pcbi.1002838.e005"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e005" xlink:type="simple"/><label>(3)</label></disp-formula><disp-formula id="pcbi.1002838.e006"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e006" xlink:type="simple"/><label>(4)</label></disp-formula><disp-formula id="pcbi.1002838.e007"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e007" xlink:type="simple"/><label>(5)</label></disp-formula></p>
        <p>The initial states of the hidden variables <bold><italic>θ</italic></bold><italic><sub>d</sub></italic> are all set to 1/K before optimization. See Program S2 for the NNML program. NNML deconvolution was performed on linear, untransformed gene expression data.</p>
      </sec>
      <sec id="s4c">
        <title>Non-negative maximum likelihood new population model (NNML<sub>np</sub>) formulation</title>
        <p>NNML<sub>np</sub> is an extension of NNML. This model relaxes NNML's assumption that all constituent populations in each heterogeneous sample are represented in the provided reference sets <bold><italic>β</italic></bold><italic><sub>k</sub></italic>. Namely, NNML<sub>np</sub> assumes that there exists a single cell population <bold><italic>γ</italic></bold> that is not in the reference set <bold><italic>β</italic></bold><italic><sub>k</sub></italic> but that is present in at least one of the heterogeneous samples. NNML<sub>np</sub> is a slightly modified version of the ISOLATE <xref ref-type="bibr" rid="pcbi.1002838-Quon1">[5]</xref> model that we reported previously. In order to prevent overfitting in the estimation of <bold><italic>γ</italic></bold>, we place a prior over <bold><italic>γ</italic></bold> such that <bold><italic>γ</italic></bold> is drawn from a Dirichlet distribution centred on a convex combination of the existing reference populations <bold><italic>β</italic></bold><italic><sub>k</sub></italic> because we assume that, all else being equal, the new population will be related to the existing reference populations. The convex weights <bold><italic>ω</italic></bold>, as well as the strength of the prior <italic>κ</italic>, are estimated from the data. Finally, NNML<sub>np</sub> also puts a Dirichlet prior over each variable <bold><italic>θ</italic></bold><italic><sub>d</sub></italic> to prevent overfitting: that prior has mean <bold><italic>α</italic></bold> that is also estimated. Estimating the hidden variables and parameters (<bold><italic>γ</italic></bold>, <bold><italic>ω</italic></bold>, <italic>κ</italic>, <bold><italic>α</italic></bold> and <bold><italic>θ</italic></bold><italic><sub>d</sub></italic>) are optimized by (block) coordinate descent; the complete log likelihood function is cyclically optimized with respect to each set of hidden variables and parameters using conjugate gradient descent, until convergence of the likelihood function. The complete likelihood function is as follows (variables <bold><italic>θ</italic></bold><italic><sub>d</sub></italic>, <italic>t<sub>d,n</sub></italic>, <italic>z<sub>d,n</sub></italic>, and <bold><italic>β</italic></bold><italic><sub>k</sub></italic> have the same meaning as for NNML):<disp-formula id="pcbi.1002838.e008"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e008" xlink:type="simple"/><label>(6)</label></disp-formula><disp-formula id="pcbi.1002838.e009"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e009" xlink:type="simple"/><label>(7)</label></disp-formula><disp-formula id="pcbi.1002838.e010"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e010" xlink:type="simple"/><label>(8)</label></disp-formula><disp-formula id="pcbi.1002838.e011"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e011" xlink:type="simple"/><label>(9)</label></disp-formula><disp-formula id="pcbi.1002838.e012"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e012" xlink:type="simple"/><label>(10)</label></disp-formula><disp-formula id="pcbi.1002838.e013"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e013" xlink:type="simple"/><label>(11)</label></disp-formula></p>
        <p>Initialization of model parameters is described in the <xref ref-type="supplementary-material" rid="pcbi.1002838.s018">Text S2</xref>. The major difference between NNML<sub>np</sub> and ISOLATE is that the Dirichlet prior on the new population (<xref ref-type="disp-formula" rid="pcbi.1002838.e009">eq. 7</xref>) in NNML<sub>np</sub> is replaced with a product of Gamma priors in ISOLATE. See Program S2 for the NNML<sub>np</sub> program. NNML<sub>np</sub> deconvolution was performed on linear, untransformed gene expression data.</p>
      </sec>
      <sec id="s4d">
        <title>Perturbation model (PERT) formulation</title>
        <p>In contrast to NNML<sub>np</sub>, PERT extends NNML by relaxing its other main assumption, namely, that the provided reference distributions <bold><italic>β</italic></bold><italic><sub>k</sub></italic> faithfully represent the expression patterns of the actual constituent cell populations in each heterogeneous sample. PERT defines new constituent profiles <bold><italic>γ</italic></bold><sub>1</sub> through <bold><italic>γ</italic></bold><sub>K</sub>, where <bold><italic>γ</italic></bold><italic><sub>k</sub></italic> is based on the reference profile <bold><italic>β</italic></bold><italic><sub>k</sub></italic> that has been adjusted for systematic differences due to cell culture effects, for example. These systematic changes in gene expression are assumed to act equally across all constituent cell populations, and are defined by multiplicative perturbation factors <italic>ρ<sub>g</sub></italic>. PERT uses a prior distribution over <italic>ρ<sub>g</sub></italic>, with a mean of one and strength of <italic>κ</italic>, to regularize <italic>ρ<sub>g</sub></italic> such that it introduces as few deviations as possible. Similar to NNML<sub>np</sub>, we introduce a prior over <bold><italic>θ</italic></bold><italic><sub>d</sub></italic> for regularization, where the mean of that prior, <bold><italic>α</italic></bold>, is also estimated. Estimating hidden variables and parameters (<italic>ρ<sub>g</sub></italic>, <italic>κ</italic>, <bold><italic>α</italic></bold> and <bold><italic>θ</italic></bold><italic><sub>d</sub></italic>) is done by cyclically optimizing the complete log likelihood function with respect to each hidden variable and parameter using conjugate gradient descent, until convergence of the likelihood function. The likelihood function is as follows (variables <bold><italic>θ</italic></bold><italic><sub>d</sub></italic>, <italic>t<sub>d,n</sub></italic>, <italic>z<sub>d,n</sub></italic>, and <bold><italic>β</italic></bold><italic><sub>k</sub></italic> have the same meaning as for NNML):<disp-formula id="pcbi.1002838.e014"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e014" xlink:type="simple"/><label>(12)</label></disp-formula><disp-formula id="pcbi.1002838.e015"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e015" xlink:type="simple"/><label>(13)</label></disp-formula><disp-formula id="pcbi.1002838.e016"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e016" xlink:type="simple"/><label>(14)</label></disp-formula><disp-formula id="pcbi.1002838.e017"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e017" xlink:type="simple"/><label>(15)</label></disp-formula><disp-formula id="pcbi.1002838.e018"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e018" xlink:type="simple"/><label>(16)</label></disp-formula><disp-formula id="pcbi.1002838.e019"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002838.e019" xlink:type="simple"/><label>(17)</label></disp-formula></p>
        <p>Initialization of model parameters is described in the <xref ref-type="supplementary-material" rid="pcbi.1002838.s018">Text S2</xref>. See Program S3 for the PERT program. PERT deconvolution was performed on linear, untransformed gene expression data.</p>
      </sec>
      <sec id="s4e">
        <title>Model implementation</title>
        <p>NNML, NNML<sub>np</sub> and PERT were implemented in Matlab, and the programs were used to obtain the results herein. The Matlab programs were converted into Octave to allow them to be used with free software. The programs are found in the supporting information (See instructions in <xref ref-type="supplementary-material" rid="pcbi.1002838.s018">Text S2</xref>).</p>
      </sec>
      <sec id="s4f">
        <title>Microarray preparation for mono-nucleated cell and lineage-depleted cell samples</title>
        <p>Samples of human umbilical cord blood were obtained from Mount Sinai Hospital (Toronto, ON, Canada) and processed in accordance to guidelines approved by the University of Toronto. Mono-nucleated cells were obtained by lysing the erythrocytes. Lineage-depleted (Lin-) cells were isolated from mono-nucleated cells using the EasySep system (Stemcell Technologies, Vancouver, BC, Canada) according to the manufacture's protocol.</p>
        <p>Genome-wide expression of mono-nucleated cells and Lin- cells were profiled by isolating total RNA using Rneasy Mini kits (Qiagen). RNA quality was tested on both NanoDrop (ND-1000) and BioAnalyzer machines. cDNA samples were prepared using Nugen IVT kit, and split into 2 technical replicates. Hybridization was performed using Affymetrix Gene Chip HG-U133A2.0 arrays on the Affymetrix Gene Chip Scanner 3000 machine.</p>
      </sec>
      <sec id="s4g">
        <title>Microarray preparation for CFU-M and megakaryocytes</title>
        <p>CD34<sup>−</sup>CD33<sup>+</sup>CD13<sup>+</sup> colony forming unit-monocytes (CFU-M) and CD34<sup>−</sup>CD41<sup>+</sup>CD61<sup>+</sup>CD45<sup>−</sup> megakaryocytes were sorted from pooled fresh human umbilical cord blood samples on BD FACS Aria (CD34: PE; CD33: APC; CD13: PERCP; CD41: PE; CD61: FITC; CD45: APC. All antibodies were purchased from BD BioScience). Lin- cells were cultured as described in <xref ref-type="bibr" rid="pcbi.1002838-Kirouac1">[14]</xref>. On day 4, CFU-M and megakaryocytes were sorted. Total RNA of the four samples was isolated using RNeasy Micro kit (Qiagen). RNA quality was tested on both NanoDrop (ND-1000) and BioAnalyzer machines. cDNA samples were prepared using Ambion IVT kit. Hybridization was performed using Affymetrix HG-U133Plus2 arrays on the Affymetrix Gene Chip Scanner 3000 machine. Data of two biological replicates were collected.</p>
      </sec>
      <sec id="s4h">
        <title>Flow cytometry</title>
        <p>Compositions of mono-nucleated cells and Lin- cells were analyzed by flow cytometry on either BD FACS Canto Flow Cytometer or BD LSRFortessa. Data analysis was performed with BD FACSDiva Software version 5.0.1.</p>
      </sec>
      <sec id="s4i">
        <title>Downloaded microarray data sets</title>
        <p>Normalized gene expression data (Affymetrix Gene Chip HG-U133Plus2) of IM-9, Jurkat, Raji, THP-1 cell lines, and mixtures of the four cell lines were downloaded from the Gene Expression Omnibus (GSE11103; downloaded on 23<sup>rd</sup> August 2012). Affymetrix CEL files (Affymetrix Gene Chip HG_U133AAofAv2) of 21 human umbilical cord blood-derived pure populations (<xref ref-type="supplementary-material" rid="pcbi.1002838.s008">Table S5</xref>) were obtained from the authors of <xref ref-type="bibr" rid="pcbi.1002838-Novershtern1">[18]</xref> (GSE24759). Affymetrix CEL files (Affymetrix Gene Chip HG-U133Plus2) of day-4 Lin- cells were obtained from the authors of <xref ref-type="bibr" rid="pcbi.1002838-Kirouac2">[20]</xref> (GSE16589).</p>
      </sec>
      <sec id="s4j">
        <title>Microarray pre-processing and batch effect removal</title>
        <p>Microarray data were analyzed in BioConductor using the affy package. For the analysis of CFU-M and megakaryocyte profiles, RMA <xref ref-type="bibr" rid="pcbi.1002838-Irizarry1">[15]</xref> background adjusted, normalized profiles, without batch removal, were used because all the samples for this analysis were processed under the same technical setup. The processed data of CFU-M and megakaryocyte samples are found in <xref ref-type="supplementary-material" rid="pcbi.1002838.s014">Table S11</xref>. For the deconvolution studies of uncultured and culture-derived samples, RMA <xref ref-type="bibr" rid="pcbi.1002838-Irizarry1">[15]</xref> background adjusted, non-normalized reference and mixed profiles were post-processed by the supervised normalization of microarray (SNM) method <xref ref-type="bibr" rid="pcbi.1002838-Mecham1">[19]</xref> in order to normalize data while removing the batch effects between the two datasets. The processed data of uncultured and culture-derived samples are found in <xref ref-type="supplementary-material" rid="pcbi.1002838.s015">Table S12</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002838.s016">Table S13</xref>, respectively.</p>
      </sec>
      <sec id="s4k">
        <title>Hierarchical clustering</title>
        <p>Hierarchical clustering shown in <xref ref-type="fig" rid="pcbi-1002838-g003">Figure 3</xref> was obtained from log<sub>2</sub> gene expression values using an average agglomeration method with a distance matrix of (1 - Pearson's correlation coefficients).</p>
      </sec>
      <sec id="s4l">
        <title>Gene set enrichment analysis</title>
        <p>GSEA was either done using the GSEA program (v2.0) from the GSEA website using gene sets c5.all.v3.0.orig.gmt (downloaded on Jan 23, 2012), or using the GSEAStat (v2.20.0) and GSEABase (v1.16.0) packages with the generic GOslim gene sets (download from the GSEA website on Jan 21, 2012) in the BioConductor.</p>
      </sec>
      <sec id="s4m">
        <title>Statistics analysis</title>
        <p>Unless otherwise stated, all P-values were calculated using the Wilcoxon signed rank test in R. Association test of Pearson's correlation was done in R using the cor.test() function.</p>
      </sec>
      <sec id="s4n">
        <title>Accession codes</title>
        <p>Gene Expression Omnibus, GSE40831.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002838.s001" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s001" position="float" xlink:type="simple">
        <label>Program S1</label>
        <caption>
          <p>
            <bold>Octave program for NNML.</bold>
          </p>
          <p>(ZIP)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s002" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s002" position="float" xlink:type="simple">
        <label>Program S2</label>
        <caption>
          <p>
            <bold>Octave program for NNML<sub>np</sub>.</bold>
          </p>
          <p>(ZIP)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s003" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s003" position="float" xlink:type="simple">
        <label>Program S3</label>
        <caption>
          <p>
            <bold>Octave program for PERT.</bold>
          </p>
          <p>(ZIP)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s004" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s004" position="float" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <p><bold>Gene ontology difference between culture-derived and uncultured blood cell samples.</bold> Gene set enrichment analysis was performed for pooled day-4 CFU-M and day-4 megakaryocyte profiles and pooled day-0 CFU-M and day-0 megakaryocyte profiles.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s005" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s005" position="float" xlink:type="simple">
        <label>Table S2</label>
        <caption>
          <p><bold>Gene-specific perturbation factors obtained from comparing culture-derived samples to uncultured samples.</bold> (A) Perturbation vectors <bold><italic>ρ</italic></bold> from comparing gene expression profiles of day-0 megakaryocytes to that of day-4 megakaryocytes. (B) Perturbation vectors <bold><italic>ρ</italic></bold> from comparing gene expression profiles of day-0 CFU-M to that of day-4 CFU-M.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s006" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s006" position="float" xlink:type="simple">
        <label>Table S3</label>
        <caption>
          <p><bold>Enriched biological processes of the perturbed genes when comparing culture-derived to uncultured megakaryocytes.</bold> Gene expression profiles of day-4 megakaryocyte were compared to that of day-0 megakaryocytes using PERT. Gene set enrichment analysis was performed for Affymetrix probes that exhibited 2-fold perturbation (<italic>ρ<sub>g</sub></italic>&lt;0.5 or <italic>ρ<sub>g</sub></italic>&gt;2). The enriched gene sets (<italic>P</italic>&lt;0.01) are tabulated.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s007" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s007" position="float" xlink:type="simple">
        <label>Table S4</label>
        <caption>
          <p><bold>Enriched biological processes of the perturbed genes when comparing culture-derived to uncultured CFU-M.</bold> Gene expression profiles of day-4 CFU-M were compared to that of day-0 CFU-M using PERT. Gene set enrichment analysis was performed for Affymetrix probes that exhibited 2-fold perturbation (<italic>ρ<sub>g</sub></italic>&lt;0.5 or <italic>ρ<sub>g</sub></italic>&gt;2). The enriched gene sets (<italic>P</italic>&lt;0.01) are tabulated.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s008" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s008" position="float" xlink:type="simple">
        <label>Table S5</label>
        <caption>
          <p>
            <bold>Reference populations for decomposing human cord blood samples.</bold>
          </p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s009" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s009" position="float" xlink:type="simple">
        <label>Table S6</label>
        <caption>
          <p><bold>Comparison between flow cytometry-assigned and model-predicted cell compositions of different mixed samples.</bold> (A) Mono-nucleated cells enriched from fresh human umbilical cord blood. (B) Lineage-depleted cells enriched from fresh human umbilical cord blood. (C) Lineage-depleted cells enriched from the 4<sup>th</sup> day of hematopoietic stem and progenitor cell expansion culture.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s010" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s010" position="float" xlink:type="simple">
        <label>Table S7</label>
        <caption>
          <p><bold>NNML<sub>np</sub> and PERT analysis for fresh human umbilical cord blood samples.</bold> Gene expression profiles of mono-nucleated and lineage-depleted cell samples enriched from fresh human umbilical cord blood were analyzed by NNML<sub>np</sub> and PERT. (A) The predicted gene expression profile <bold><italic>γ</italic></bold> of the new reference population obtained using NNML<sub>np</sub>. (B) The predicted perturbation vector <bold><italic>ρ</italic></bold> obtained using PERT.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s011" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s011" position="float" xlink:type="simple">
        <label>Table S8</label>
        <caption>
          <p><bold>Differences between biological properties of uncultured heterogeneous samples and that of reference populations.</bold> Gene expression profiles of mono-nucleated and lineage-depleted cell samples enriched from fresh human umbilical cord blood were analyzed by PERT. Gene Ontology (GO) enrichment analysis was performed for Affymetrix probes that exhibited 2-fold up-regulation (<italic>ρ<sub>g</sub></italic>&gt;2) in the mixed profiles. Enriched GO terms (<italic>P</italic>&lt;0.01) are tabulated.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s012" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s012" position="float" xlink:type="simple">
        <label>Table S9</label>
        <caption>
          <p><bold>NNML<sub>np</sub> and PERT analysis for culture-derived human blood samples.</bold> Gene expression profiles of cultured-derived lineage-depleted human blood cell samples were analyzed by NNML<sub>np</sub> and PERT. (A) The predicted gene expression profile <bold><italic>γ</italic></bold> of the new reference population obtained using NNML<sub>np</sub>. (B) The predicted perturbation vector <bold><italic>ρ</italic></bold> obtained using PERT.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s013" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s013" position="float" xlink:type="simple">
        <label>Table S10</label>
        <caption>
          <p><bold>Differences between biological properties of culture-derived heterogeneous samples and reference populations.</bold> Gene expression profiles of culture-derived lineage-depleted human blood cell samples were analyzed by PERT. Gene ontology (GO) enrichment analysis was performed for genes that exhibited 2-fold up-regulation (<italic>ρ<sub>g</sub></italic>&gt;2) in the mixed profiles. Enriched GO terms (<italic>P</italic>&lt;0.01) are shown.</p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s014" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s014" position="float" xlink:type="simple">
        <label>Table S11</label>
        <caption>
          <p>
            <bold>Processed gene expression profiles of CFU-M and megakaryocyte samples.</bold>
          </p>
          <p>(XLSX)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s015" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s015" position="float" xlink:type="simple">
        <label>Table S12</label>
        <caption>
          <p>
            <bold>Gene expression profiles for deconvolving uncultured mono-nucleated and lineage-depleted cell samples.</bold>
          </p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s016" mimetype="application/x-excel" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s016" position="float" xlink:type="simple">
        <label>Table S13</label>
        <caption>
          <p>
            <bold>Gene expression profiles for deconvolving culture-derived lineage-depleted cell samples.</bold>
          </p>
          <p>(XLS)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s017" mimetype="application/msword" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s017" position="float" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>
            <bold>Performance analysis of NNLS, NNML, NNML<sub>np</sub> and PERT.</bold>
          </p>
          <p>(DOC)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002838.s018" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" xlink:href="info:doi/10.1371/journal.pcbi.1002838.s018" position="float" xlink:type="simple">
        <label>Text S2</label>
        <caption>
          <p>
            <bold>Initialization and usage of NNML, NNML<sub>np</sub> and PERT.</bold>
          </p>
          <p>(DOCX)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors thank the donors and the Research Centre for Women's and Infants' Health BioBank of Mount Sinai Hospital for supplying the umbilical cord blood samples used in this study. The authors thank staff at The Center for Applied Genomics for their technical support with collecting microarray data. The authors would also like to thank Dr. Weijia Wang for her advice on flow cytometry experiments, and Dr. Geoff Clarke for his critical comments on the manuscript. PWZ is the Canada Research Chair in Stem Cell Bioengineering.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002838-Lu1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lu</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Nakorchevskiy</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Marcotte</surname><given-names>EM</given-names></name> (<year>2003</year>) <article-title>Expression deconvolution: a reinterpretation of DNA microarray data reveals dynamic changes in cell populations</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>100</volume>: <fpage>10370</fpage>–<lpage>10375</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Venet1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Venet</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pecasse</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Maenhaut</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bersini</surname><given-names>H</given-names></name> (<year>2001</year>) <article-title>Separation of samples into their constituents using gene expression data</article-title>. <source>Bioinformatics</source> <volume>17 Suppl 1</volume>: <fpage>S279</fpage>–<lpage>87</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Abbas1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abbas</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Wolslegel</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Seshasayee</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Modrusan</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Clark</surname><given-names>HF</given-names></name> (<year>2009</year>) <article-title>Deconvolution of blood microarray data identifies cellular activation patterns in systemic lupus erythematosus</article-title>. <source>PLoS ONE</source> <volume>4</volume>: <fpage>e6098</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0006098" xlink:type="simple">10.1371/journal.pone.0006098</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Gong1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gong</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hartmann</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Kohane</surname><given-names>IS</given-names></name>, <name name-style="western"><surname>Brinkmann</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Staedtler</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Optimal deconvolution of transcriptional profiling data using quadratic programming with application to complex clinical blood samples</article-title>. <source>PLoS ONE</source> <volume>6</volume>: <fpage>e27156</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0027156" xlink:type="simple">10.1371/journal.pone.0027156</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Quon1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quon</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Morris</surname><given-names>Q</given-names></name> (<year>2009</year>) <article-title>ISOLATE: a computational strategy for identifying the primary origin of cancers using high-throughput sequencing</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>2882</fpage>–<lpage>2889</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp378" xlink:type="simple">10.1093/bioinformatics/btp378</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Blei1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blei</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ng</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Jordan</surname><given-names>M</given-names></name> (<year>2003</year>) <article-title>Latent Dirichlet Allocation</article-title>. <source>JMLR</source> <volume>3</volume>: <fpage>993</fpage>–<lpage>1022</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Posekany1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Posekany</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Felsenstein</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Sykacek</surname><given-names>P</given-names></name> (<year>2011</year>) <article-title>Biological assessment of robust noise models in microarray data analysis</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>807</fpage>–<lpage>814</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr018" xlink:type="simple">10.1093/bioinformatics/btr018</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Tu1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Stolovitzky</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Klein</surname><given-names>U</given-names></name> (<year>2002</year>) <article-title>Quantitative noise analysis for gene expression microarray experiments</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>99</volume>: <fpage>14031</fpage>–<lpage>14036</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.222164199" xlink:type="simple">10.1073/pnas.222164199</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Lawson1">
        <label>9</label>
        <mixed-citation publication-type="other" xlink:type="simple">Lawson C, Hanson R (1995) Solving least square problems. Philadelphia: SIAM. pp.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Venet2">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Venet</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Pecasse</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Maenhaut</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bersini</surname><given-names>H</given-names></name> (<year>2001</year>) <article-title>Separation of samples into their constituents using gene expression data</article-title>. <source>Bioinformatics</source> <volume>17 Suppl 1</volume>: <fpage>S279</fpage>–<lpage>87</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Hardin1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hardin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>A note on oligonucleotide expression values not being normally distributed</article-title>. <source>Biostatistics</source> <volume>10</volume>: <fpage>446</fpage>–<lpage>450</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biostatistics/kxp003" xlink:type="simple">10.1093/biostatistics/kxp003</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Weng1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weng</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Dai</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Zhan</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>He</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Stepaniants</surname><given-names>SB</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Rosetta error model for gene expression analysis</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>1111</fpage>–<lpage>1121</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl045" xlink:type="simple">10.1093/bioinformatics/btl045</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Dorrell1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dorrell</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gan</surname><given-names>OI</given-names></name>, <name name-style="western"><surname>Pereira</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Hawley</surname><given-names>RG</given-names></name>, <name name-style="western"><surname>Dick</surname><given-names>JE</given-names></name> (<year>2000</year>) <article-title>Expansion of human cord blood CD34(+)CD38(−) cells in ex vivo culture during retroviral transduction without a corresponding increase in SCID repopulating cell (SRC) frequency: dissociation of SRC phenotype and function</article-title>. <source>Blood</source> <volume>95</volume>: <fpage>102</fpage>–<lpage>110</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Kirouac1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kirouac</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Madlambayan</surname><given-names>GJ</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Sykes</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Ito</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Cell-cell interaction networks regulate blood stem and progenitor cell fate</article-title>. <source>Mol Syst Biol</source> <volume>5</volume>: <fpage>293</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2009.49" xlink:type="simple">10.1038/msb.2009.49</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Irizarry1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Irizarry</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Hobbs</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Collin</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Beazer-Barclay</surname><given-names>YD</given-names></name>, <name name-style="western"><surname>Antonellis</surname><given-names>KJ</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Exploration, normalization, and summaries of high density oligonucleotide array probe level data</article-title>. <source>Biostatistics</source> <volume>4</volume>: <fpage>249</fpage>–<lpage>264</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biostatistics/4.2.249" xlink:type="simple">10.1093/biostatistics/4.2.249</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Subramanian1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Subramanian</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Tamayo</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Mootha</surname><given-names>VK</given-names></name>, <name name-style="western"><surname>Mukherjee</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ebert</surname><given-names>BL</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>102</volume>: <fpage>15545</fpage>–<lpage>15550</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0506580102" xlink:type="simple">10.1073/pnas.0506580102</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Falcon1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Falcon</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gentleman</surname><given-names>R</given-names></name> (<year>2007</year>) <article-title>Using GOstats to test gene lists for GO term association</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>257</fpage>–<lpage>258</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl567" xlink:type="simple">10.1093/bioinformatics/btl567</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Novershtern1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Novershtern</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Subramanian</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lawton</surname><given-names>LN</given-names></name>, <name name-style="western"><surname>Mak</surname><given-names>RH</given-names></name>, <name name-style="western"><surname>Haining</surname><given-names>WN</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Densely interconnected transcriptional circuits control cell States in human hematopoiesis</article-title>. <source>Cell</source> <volume>144</volume>: <fpage>296</fpage>–<lpage>309</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2011.01.004" xlink:type="simple">10.1016/j.cell.2011.01.004</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Mecham1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mecham</surname><given-names>BH</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>PS</given-names></name>, <name name-style="western"><surname>Storey</surname><given-names>JD</given-names></name> (<year>2010</year>) <article-title>Supervised normalization of microarrays</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>1308</fpage>–<lpage>1315</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq118" xlink:type="simple">10.1093/bioinformatics/btq118</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Kirouac2">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kirouac</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Ito</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Csaszar</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Roch</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Dynamic interaction networks in a hierarchically organized tissue</article-title>. <source>Mol Syst Biol</source> <volume>6</volume>: <fpage>417</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2010.71" xlink:type="simple">10.1038/msb.2010.71</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Whitney1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Whitney</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Diehn</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Popper</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Alizadeh</surname><given-names>AA</given-names></name>, <name name-style="western"><surname>Boldrick</surname><given-names>JC</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Individuality and variation in gene expression patterns in human blood</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>100</volume>: <fpage>1896</fpage>–<lpage>1901</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.252784499" xlink:type="simple">10.1073/pnas.252784499</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Debey1">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Debey</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Schoenbeck</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Hellmich</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gathof</surname><given-names>BS</given-names></name>, <name name-style="western"><surname>Pillai</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Comparison of different isolation techniques prior gene expression profiling of blood derived cells: impact on physiological responses, on overall expression and the role of different cell types</article-title>. <source>Pharmacogenomics J</source> <volume>4</volume>: <fpage>193</fpage>–<lpage>207</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/sj.tpj.6500240" xlink:type="simple">10.1038/sj.tpj.6500240</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Venet3">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Venet</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Dumont</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Detours</surname><given-names>V</given-names></name> (<year>2011</year>) <article-title>Most random gene expression signatures are significantly associated with breast cancer outcome</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>: <fpage>e1002240</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002240" xlink:type="simple">10.1371/journal.pcbi.1002240</ext-link></comment>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002838-Notta1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Notta</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Doulatov</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Poeppl</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Jurisica</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Dick</surname><given-names>JE</given-names></name> (<year>2010</year>) <article-title>Isolation of single human hematopoietic stem cells capable of long-term multilineage engraftment</article-title>. <source>Science</source> <volume>833</volume>: <fpage>6039</fpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>