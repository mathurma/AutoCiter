<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0030188</article-id><article-id pub-id-type="publisher-id">06-PLCB-RA-0286R2</article-id><article-id pub-id-type="sici">plcb-03-10-07</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Immunology</subject>
          <subject>Infectious Diseases</subject>
          <subject>Mathematics</subject>
        </subj-group>
        <subj-group subj-group-type="System Taxonomy">
          <subject>Viruses</subject>
        </subj-group>
      </article-categories><title-group><article-title>A Statistical Framework for Modeling HLA-Dependent T Cell Response Data</article-title><alt-title alt-title-type="running-head">Statistical Modeling of T Cell Responses</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Listgarten</surname>
            <given-names>Jennifer</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Frahm</surname>
            <given-names>Nicole</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Kadie</surname>
            <given-names>Carl</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Brander</surname>
            <given-names>Christian</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Heckerman</surname>
            <given-names>David</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1">
				<label>1</label><addr-line> Microsoft Research, Redmond, Washington, United States of America
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Partners AIDS Research Center, Massachusetts General Hospital, Charlestown, Massachusetts, United States of America
			</addr-line></aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Bourne</surname>
            <given-names>Philip E</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University of California San Diego, United States of America</aff><author-notes>
        <fn fn-type="con" id="ack1">
          <p>JL and DH were responsible for algorithm design and writing of the paper. JL was responsible for implementation. NF and CB designed and performed laboratory experiments leading to the need for the algorithm (and performed biological validation experiments). CK provided initial implementation.</p>
        </fn>
        <corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">heckerma@microsoft.com</email></corresp>
      <fn fn-type="conflict" id="ack3">
        <p> The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="ppub">
        <month>10</month>
        <year>2007</year>
      </pub-date><pub-date pub-type="epub">
        <day>12</day>
        <month>10</month>
        <year>2007</year>
      </pub-date><volume>3</volume><issue>10</issue><elocation-id>e188</elocation-id><history>
        <date date-type="received">
          <day>18</day>
          <month>7</month>
          <year>2007</year>
        </date>
        <date date-type="accepted">
          <day>14</day>
          <month>8</month>
          <year>2007</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2007</copyright-year><copyright-holder>Listgarten et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>The identification of T cell epitopes and their HLA (human leukocyte antigen) restrictions is important for applications such as the design of cellular vaccines for HIV. Traditional methods for such identification are costly and time-consuming. Recently, a more expeditious laboratory technique using ELISpot assays has been developed that allows for rapid screening of specific responses. However, this assay does not directly provide information concerning the HLA restriction of a response, a critical piece of information for vaccine design. Thus, we introduce, apply, and validate a statistical model for identifying HLA-restricted epitopes from ELISpot data. By looking at patterns across a broad range of donors, in conjunction with our statistical model, we can determine (probabilistically) which of the HLA alleles are likely to be responsible for the observed reactivities. Additionally, we can provide a good estimate of the number of false positives generated by our analysis (i.e<italic>.</italic>, the false discovery rate). This model allows us to learn about new HLA-restricted epitopes from ELISpot data in an efficient, cost-effective, and high-throughput manner. We applied our approach to data from donors infected with HIV and identified many potential new HLA restrictions. Among 134 such predictions, six were confirmed in the lab and the remainder could not be ruled as invalid. These results shed light on the extent of HLA class I promiscuity, which has significant implications for the understanding of HLA class I antigen presentation and vaccine development.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <sec id="st1">
          <title/>
          <p>At the core of the human adaptive immune response is the train-to-kill mechanism in which specialized immune cells are sensitized to recognize small peptides from foreign pathogens (e.g., HIV virus). Following this sensitization, these cells are then activated to kill other cells that display this same peptide (and that are infected by this same pathogen). However, for sensitization and killing to occur, the pathogen peptide must be “paired up” with one of the infected person's other specialized immune molecules—an HLA (human leukocyte antigen) molecule. The way in which pathogen peptides interact with these HLA molecules defines if and how an immune response will be generated, which has implications for vaccine design where one may artificially introduce select peptides to pre-train the immune system. Furthermore, there is a huge repertoire of such HLA molecules, with almost no two people having the same set. We introduce a statistical approach for identifying which HLA molecules interact with which pathogen peptides, given a particular kind of laboratory data. Our approach takes as input, data that tells us only which pathogen peptides generate a response, but not which HLA molecules support the response. Our statistical approach fills in this missing information.</p>
        </sec>
      </abstract><funding-group><funding-statement>This work has been funded in whole or in part by US National Institutes of Health contracts N01-Al-15422 and R01-A1-067077.</funding-statement></funding-group><counts>
        <page-count count="8"/>
      </counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group>
        <custom-meta>
          <meta-name>citation</meta-name>
          <meta-value>Listgarten J, Frahm N, Kadie C, Brander C, Heckerman D (2007) A statistical framework for modeling HLA-dependent T cell response data. PLoS Comput Biol 3(10): e188. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030188" xlink:type="simple">10.1371/journal.pcbi.0030188</ext-link></meta-value>
        </custom-meta>
      </custom-meta-group></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>The human adaptive immune response is composed of two core elements: antibody-mediated response (sometimes called humoral response), and T cell–mediated response (sometimes called cellular response). Research on HIV vaccines initially focused on the antibody-mediated response but more recently has included the cellular response [<xref ref-type="bibr" rid="pcbi-0030188-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0030188-b002">2</xref>], which is the focus of our application.</p>
      <p>At the core of the cellular response is the ability of certain antigen-presenting cells to digest viral proteins into smaller peptides, and then to <italic>present</italic> these peptides at the surface of the cell. Presentation of a peptide depends on the peptide first forming a complex with an HLA (human leukocyte antigen) molecule. If a peptide is presented, it can then be recognized by (naive) T cells, allowing activation of these T cells so that they may subsequently recognize and attack virally infected cells displaying the same complex. Any peptide that is able to generate such an immune response in the context of a given HLA allele is called an <italic>epitope</italic>, and, in particular, an epitope <italic>restricted by that allele</italic>. Only certain HLA alleles can form a complex with any given peptide, and hence the compatibility of these two elements is essential for the adaptive immune response just described.</p>
      <p>Several types of T cells exist, each playing its own, though interdependent, role. In ongoing HIV vaccine research, the elicitation of a CD8+ T cell response has shown promise. Since CD8+ T cells recognize only HLA class I bound epitopes, our data, and hence our paper, focus on epitopes recognized in the context of these particular molecules, although the statistical framework is not tailored or limited to this domain and could be immediately applied to HLA class II epitopes, for example. Humans have up to six HLA class I alleles arising from the A, B, and C loci. Currently, there are hundreds of possible alleles at each of these loci, with more being discovered every year [<xref ref-type="bibr" rid="pcbi-0030188-b003">3</xref>].</p>
      <p>A crucial task in HIV vaccine development is the identification of epitopes and the alleles that restrict them, since it is thought that a good vaccine will comprise a robust set of epitopes [<xref ref-type="bibr" rid="pcbi-0030188-b004">4</xref>–<xref ref-type="bibr" rid="pcbi-0030188-b006">6</xref>]. By robust, we mean a set which broadly covers regions that are essential for viral fitness in a given human population characterized by a particular distribution of HLA alleles. Also, note that beyond vaccine design, epitope identification may have important applications such as predicting infectious disease susceptibility and transplantation success.</p>
      <p>Traditional methods for identifying epitopes involve time-consuming, technically demanding, and expensive culturing of T cells. Recently, a more expeditious laboratory technique using ELISpot assays has been developed [<xref ref-type="bibr" rid="pcbi-0030188-b007">7</xref>]. Unfortunately, the ELISpot assay gives only information about which individual donors generated an immune response to a particular peptide, but does not provide any information about which of a donor's HLA alleles are restricting this reaction; it is this HLA specificity that is crucial and in which we are most interested. However, by leveraging information contained in ELISpot reactivity across a large set of donors with known HLA types, in conjunction with the statistical model presented in this paper, we can determine (probabilistically) which HLA alleles are likely to be responsible for the observed reactivities. Thus we are able to learn about new HLA-restricted epitopes in an efficient, cost-effective, and high-throughput manner.</p>
      <p>A related, though distinct problem from our problem of epitope <italic>identification</italic> is that of epitope <italic>prediction</italic> (e.g., [<xref ref-type="bibr" rid="pcbi-0030188-b008">8</xref>–<xref ref-type="bibr" rid="pcbi-0030188-b011">11</xref>]), in which new epitopes are predicted in silico, on the basis of amino acid sequence and other information, but not on the basis of assays that directly measure binding energies or other measures such as the ELISpot assay. The work presented here focuses strictly on the identification of restricting (i.e., epitope presenting) HLA class I alleles from ELISpot data, although newly identified epitopes can aid the task of epitope prediction by providing more known examples to learn from.</p>
    </sec>
    <sec id="s2">
      <title>Methods</title>
      <p>Our statistical model takes as input, measured CD8+ T cell ELISpot reactivities from a set of donors with known HLA class I alleles, for a number of epitopes, and deduces which of the donor's individual HLA alleles are likely to be responsible for the observed reactivities. That is, our model deduces which epitopes are restricted by which HLA alleles. Additionally, we can provide a good estimate of the number of false positive epitope hypotheses returned by our analysis (i.e., the false discovery rate (FDR) [<xref ref-type="bibr" rid="pcbi-0030188-b012">12</xref>,<xref ref-type="bibr" rid="pcbi-0030188-b013">13</xref>]) so that we have a sense of how many new epitope hypotheses to pursue (if any).</p>
      <p>We assume that a given epitope is or is not restricted by a given HLA allele. If an epitope is restricted by a particular HLA allele, it is still likely that a donor with the restricting HLA allele will not react to the epitope. Such false negatives arise from factors including immunodominance, (immunodominance can be thought of as biology's “waste not want not”—that is, the immune system focuses its efforts in a few areas that work well, to the exclusion of others), T cell repertoire, lack of previous peptide exposure (e.g., exposure arising from infection or vaccination), suboptimality of the epitopes (i.e., if a peptide that optimally binds a particular HLA is of length nine amino acids, a peptide of length ten which contains the nine-mer may sometimes bind, but not as efficiently), and experimental noise. Furthermore, an epitope reaction may be falsely associated with some HLA alleles in ELIspot data due to linkage disequilibrium of a nonrestricting and a restricting HLA allele. (For example, if a restricting HLA allele is in linkage disequilibrium with a nonrestricting HLA allele, then the nonrestricting allele will very often be present in a donor with the restricting allele, and so the ELISpot data for this allele will also correlate with positive reactivities—though only as a result of the linkage.) Thus, the task of recovering HLA-restricted epitopes from ELISpot data is not straightforward. As a brief example, if one examines the HIV ELISpot dataset used in this paper and considers any HLA-epitope pair that has any observed reactivity to consist of an HLA-restricted epitope, then one incurs a false positive reactivity rate of roughly 70%. One could then imagine a next logical step of setting a threshold for what minimum fraction of donors must react and so on, soon finding oneself with a rather ad hoc model for which there would be no principled way to set the parameters nor to determine statistical significance. The task of identifying restricting HLA alleles from ELISpot data is in fact nontrivial and well-suited to statistical modeling. Next, we formally outline our statistical model.</p>
      <sec id="s2a">
        <title>A Statistical Model for HLA-Dependent T cell Response Data</title>
        <p>For a set of <italic>J</italic> epitopes (more precisely, each peptide under examination may contain one, or several, epitope(s), but for simplicity of presentation, we refer to the peptides as epitopes) and <italic>K</italic> donors, we have a set of measured binary ELISpot reactivities (actual laboratory assays provide real values which are thought by the laboratory scientists to convey mostly binary information [<xref ref-type="bibr" rid="pcbi-0030188-b014">14</xref>]), which are used as input to our model. We are also given the six HLA class I alleles for each donor.</p>
        <p>Let <italic>h<sub>i</sub></italic> = 1 denote that a donor has HLA allele <italic>i</italic>, and <italic>h<sub>i</sub></italic> = 0 denote that the donor does not have that allele. Let <italic>y<sub>j</sub></italic> be the observed, binary reactivity for epitope <italic>j</italic> in a donor (as measured by the ELISpot assay). An important assumption in our model is the following: whether an epitope is restricted by a particular HLA allele is independent of whether that epitope is also restricted by any other HLA allele. This assumption is commonly referred to as an assumption of <italic>causal independence</italic> [<xref ref-type="bibr" rid="pcbi-0030188-b015">15</xref>]. From this assumption, it follows that the probability of not observing a reaction to a particular epitope, in a given donor, is the probability that none of that donor's HLA alleles cause a reaction. Because of the independence assumption, this is simply the product over the probability of each HLA (that the donor has) not causing a reaction. Formally, if epitope <italic>j</italic> is restricted by HLA <italic>i</italic>, then we let <italic>q<sub>ij</sub></italic> be the probability that we observe a reaction in a donor with HLA <italic>i</italic> and no other HLAs restricted by epitope <italic>j</italic>. Also, let <italic>l<sub>j</sub></italic> be the probability that a reaction is observed to epitope <italic>j</italic> when a donor has none of the restricting HLAs for epitope <italic>j</italic>—a so-called <italic>leak term</italic> (corresponding to unrepresented causes such as reactivity due to HLA E molecules). Given settings for these parameters, <italic>q<sub>ij</sub></italic> and <italic>l<sub>j</sub></italic>, our model stipulates that the probability that a donor does not react to epitope <italic>j</italic>, <italic>p</italic>(<italic>y<sub>j</sub></italic> = 0 | {<italic>q<sub>ij</sub></italic>},<italic>l<sub>j</sub></italic>), or does react, <italic>p</italic>(<italic>y<sub>j</sub></italic> = 1 | {<italic>q<sub>ij</sub></italic>},<italic>l<sub>j</sub></italic>), is given by
					<disp-formula id="pcbi-0030188-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030188.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mo>&lcub;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&rcub;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&prod;</mml:mo><mml:mrow><mml:mo>&lcub;</mml:mo><mml:mi>i</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn><mml:mo>&rcub;</mml:mo></mml:mrow></mml:munder></mml:mstyle><mml:mo stretchy='false'>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:math> --></disp-formula>
					<disp-formula id="pcbi-0030188-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030188.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>p</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn><mml:mo>|</mml:mo><mml:mo>&lcub;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&rcub;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn><mml:mo>&minus;</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn><mml:mo>|</mml:mo><mml:mo>&lcub;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&rcub;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>
				</p>
        <p>Such a model is sometimes referred to as a <italic>noisy-OR model</italic>. It can be viewed as a probabilistic version of the common (deterministic) logical OR, and has been shown to be useful in a number of settings [<xref ref-type="bibr" rid="pcbi-0030188-b016">16</xref>]. The model can be represented in graphical form as shown in <xref ref-type="fig" rid="pcbi-0030188-g001">Figure 1</xref>. Here, nodes represent the variables {<italic>h<sub>i</sub></italic>} and {<italic>y<sub>j</sub></italic>} and an <italic>arc</italic> is drawn from <italic>h<sub>i</sub></italic> to <italic>y<sub>j</sub></italic> if epitope <italic>j</italic> is restricted by HLA <italic>i</italic> (i.e., if <italic>q<sub>ij</sub></italic> &gt; 0). The characteristics of how the probability of an observed reaction changes with an increasing number of restricting alleles depends on the values of {<italic>q<sub>ij</sub></italic>}. For example, if <italic>q<sub>ij</sub></italic> ≡ <italic>q<sub>j</sub> ≈</italic> 1, then for a given donor with <italic>M</italic> restricting alleles, each additional restricting allele beyond one allele would do little to increase the probability of a reaction to epitope <italic>j</italic> (as with a deterministic logical OR). Alternatively, if <italic>q<sub>ij</sub></italic> ≡ <italic>q<sub>j</sub> ≈</italic> 0, then according to the Taylor series expansion <inline-formula id="pcbi-0030188-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030188.ex001" xlink:type="simple"/></inline-formula>
					, the probability of reactivity to epitope <italic>j</italic> would increase roughly linearly with <italic>M</italic>. The likelihood of the ELISpot data under this model is simply the product of likelihood terms for the reaction in each patient k, to each peptide (given the HLA types for each patient) :
					<disp-formula id="pcbi-0030188-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030188.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>L</mml:mi><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&prod;</mml:mo><mml:mi>k</mml:mi></mml:munder></mml:mstyle><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&prod;</mml:mo><mml:mi>j</mml:mi></mml:munder></mml:mstyle><mml:mi>p</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msubsup><mml:mi>y</mml:mi><mml:mi>j</mml:mi><mml:mi>k</mml:mi></mml:msubsup><mml:mo>|</mml:mo><mml:mo>&lcub;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&rcub;</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>l</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>
				</p>
        <fig id="pcbi-0030188-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.0030188.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Graphical Depiction of HLA Restriction Model</title>
            <p>Graphical depiction of the model used to infer HLA-restricted epitopes from ELISpot data. The probability of each peptide having a reaction is parameterized by a noisy-OR distribution over all of the HLA alleles it is connected to (<xref ref-type="disp-formula" rid="pcbi-0030188-e001">Equations 1</xref> and <xref ref-type="disp-formula" rid="pcbi-0030188-e002">2</xref>). The values of the HLA and peptide nodes are observed for each donor, and we are interested in finding which <italic>q<sub>ij</sub></italic> &gt; 0—that is, which arcs are present in the graphical model. Each person has between three and six distinct HLA class 1alleles. Thus, for a given donor, between three and six HLA nodes will be “on” (<italic>h<sub>i</sub></italic> = 1).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030188.g001" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2b">
        <title>Finding HLA-Restricted Epitopes</title>
        <p>Given the model just described, and experimental ELISpot and donor HLA data, we wish to infer which epitopes are restricted by which HLA alleles. That is, we wish to know which <italic>q<sub>ij</sub></italic> should be included in the model (which arcs should appear in the graphical model). This is a problem of <italic>model selection</italic>. Note that this problem breaks down into <italic>J</italic> separate problems, one for each epitope under consideration, since under our model, <italic>q<sub>ij</sub></italic> and <italic>q<sub>i′j′</sub></italic> are independent from one another when <italic>j</italic> ≠ <italic>j′</italic>.</p>
        <p>To tackle this problem of inferring HLA-restricted epitopes from our data and model, one might consider simply learning a maximum likelihood value for all possible <italic>q<sub>ij</sub></italic> simultaneously, and concluding that those for which <italic>q<sub>ij</sub></italic> &gt; 0 are those which support the hypothesis of an HLA-restricted epitope. However, in practice, with finite and noisy-data, almost all <italic>q<sub>ij</sub></italic> &gt; 0, and this approach would lead to a huge number of false epitope hypotheses. Instead, we need a more robust way of deciding which <italic>q<sub>ij</sub></italic> to include in the model. There are a variety of standard approaches to this problem, most centered on some form of <italic>model selection score</italic>, such as the Akaike Information Criterion (AIC) [<xref ref-type="bibr" rid="pcbi-0030188-b017">17</xref>], the BIC (Bayesian Information Criterion) [<xref ref-type="bibr" rid="pcbi-0030188-b018">18</xref>], or the MDL (Minimum Description Length) [<xref ref-type="bibr" rid="pcbi-0030188-b019">19</xref>]—all of which are forms of <italic>penalized likelihood</italic> scores. These scores are but three commonly used model selection scores, and many variations of these exist as well. However, all of these scores have an intuitive interpretation of balancing the fit of the data to the model, with model complexity (controlling the model complexity so that overfitting does not occur). The fit of the data to the model is usually assessed by the maximum likelihood of the data under the model in question, while the model complexity is usually controlled by penalizing for the number of free parameters in the model—hence the term penalized likelihood. For example, the AIC of a model, <italic>M</italic>, is given by <inline-formula id="pcbi-0030188-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030188.ex002" xlink:type="simple"/></inline-formula>
					, where <inline-formula id="pcbi-0030188-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030188.ex003" xlink:type="simple"/></inline-formula>
					 is the maximum likelihood, and <italic>Q</italic> is the number of independently adjusted parameters in the model.
				</p>
        <p>Given a model selection score, one then chooses a search procedure to select <italic>q<sub>ij</sub></italic> (arcs) for inclusion in the model. The ideal way to do so is to try every subset of arcs and choose the subset which gives the highest model score (for example). However, with <italic>n</italic> possible arcs per epitope there are 2<italic><sup>n</sup></italic> subsets, and this approach is not feasible for most problems. Thus, in practice, it is common for some form of greedy, stepwise procedure to be used, such as greedily adding arcs to the model, or greedily adding/deleting arcs, terminating when the model score can no longer be increased. Then the final model built in the greedy sequence of models is taken as the model to be used and/or interpreted. Commonly, the search is started with the empty model (no arcs). In synthetic experiments with our model, we found that a greedy add/delete procedure, starting from the empty set, worked well (see <xref ref-type="sec" rid="s3">Results</xref> for details), and thus we use such a procedure to identify specific HLA alleles restricting given epitopes.</p>
        <p>It may at first seem counterintuitive that deleting an arc could increase the score when in a previous step adding that same arc had increased the score. However, when one considers that different variables can explain the same data to differing degrees, then it becomes clear how this can arise. Suppose one arc most explains some part of the data, followed next by, say, two other arcs, each of which explains that part of the data less well than the first arc, but which together explain the data better than the first arc by itself. In this case, after addition of the first arc, followed by addition of the next two arcs, the first arc would become redundant in light of the other arcs, and so removing it can increase the model selection score (it will not improve the likelihood, but will incur a parameter penalty). In practice, for our problem and data, the delete operator was used only occasionally.</p>
        <p>Different model selection scores used in a given search procedure lead to different recovered models. In particular, AIC is known to be generally less conservative (allowing more arcs) as compared with, say, BIC and MDL. Note that if one were to use an add-only procedure (where deletion of an arc is not allowed) for noisy-OR based models, then the AIC, BIC, MDL, and the Likelihood Ratio Test (LRT) [<xref ref-type="bibr" rid="pcbi-0030188-b020">20</xref>] would each add arcs in the same greedy order, though with each score stopping at a different point in the search (except for BIC and MDL which are equivalent). So the fundamental difference between these scores is not so much which arc to add next, but when to stop adding arcs.</p>
        <p>Rather than dogmatically choosing one score with which to find restricting HLA alleles, we develop a novel approach in which we use a parameterized <italic>family of model scores</italic>. Then, for any chosen model score parameter setting, we are able to estimate the FDR of the resulting model (that is, we are able to estimate the proportion of recovered <italic>q<sub>ij</sub></italic> which are not truly HLA-restricted epitopes). Then we choose a model score parameter setting which produces an FDR that we find reasonable for our purposes (i.e., one producing an FDR that gives us enough epitope hypotheses to pursue, but not too many false leads). This approach to model selection confers two advantages over the more traditional approach described: (1) we do not depend in a fundamental way on the choice of a single model selection score, and (2) regardless of which model selection score we use (within the parameterized family), we are able to estimate the FDR of our selected arcs, providing us with a good sense of what (interpretable) features the model has actually recovered, rather than, say, far less interpretable measures of quality such as the maximum likelihood of the data under the recovered model compared with that under some baseline model.</p>
      </sec>
      <sec id="s2c">
        <title>A Parameterized Family of Model Selection Scores</title>
        <p>We call the parameterized family of model scores XIC, (to denote that it encompasses various Information Criterion such as AIC and BIC). The XIC for model <italic>M</italic> is parameterized by <italic>f</italic> and is given by
					<disp-formula id="pcbi-0030188-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030188.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>X</mml:mi><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equiv;</mml:mo><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>g</mml:mi><mml:mover accent='true'><mml:mi>L</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mo>&minus;</mml:mo><mml:mi>f</mml:mi><mml:mi>Q</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where <inline-formula id="pcbi-0030188-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0030188.ex004" xlink:type="simple"/></inline-formula>
					 is the maximum likelihood of model <italic>M</italic> (<italic>M</italic> represents, for example, a model consisting of a particular subset of {<italic>q<sub>ij</sub></italic>}), <italic>Q</italic> is the number of independently adjusted parameters in the model, and <italic>f</italic> parameterizes the family of scores represented by XIC. When <italic>f</italic> = 1, the XIC behaves identically to the (negative) AIC during search, because it is directly proportional to it. When <italic>f</italic> = ½ log <italic>N</italic>, where <italic>N</italic> is the sample size of the data, then the XIC is identical to the BIC. When <italic>f</italic> = 0, the XIC is the maximum likelihood. Thus by varying <italic>f</italic>, the XIC spans a range of model selection scores, from very liberal ones for low values of <italic>f</italic>, to increasingly conservative ones for higher values of <italic>f</italic>.
				</p>
      </sec>
      <sec id="s2d">
        <title>Model Selection Procedure</title>
        <p>Leaving aside the issue of estimating the FDR for the moment, our model selection procedure is the following:</p>
        <p>1. Select a value for the XIC parameter, <italic>f</italic> = <italic>f<sup>*</sup></italic>.</p>
        <p>2. Start with the empty set of arcs under consideration (that is, no <italic>q<sub>ij</sub></italic> are in the initial model), but include all of the leak terms, <italic>l<sub>j</sub></italic>. Compute the XIC of this “leak-only” base model, <italic>M</italic><sub>0</sub>.</p>
        <p>3. For every <italic>q<sub>ij</sub></italic> under consideration, compute the XIC of the model which is the same as <italic>M</italic><sub>0</sub> but also includes <italic>q<sub>ij</sub></italic>. If none of these models has a higher XIC than <italic>M</italic><sub>0</sub>, stop the search. Otherwise, add the <italic>q<sub>ij</sub></italic> whose corresponding XIC was largest, and call the resulting model, <italic>M</italic><sub>1</sub>.</p>
        <p>4. Repeat the previous step, except using <italic>M</italic><sub>1</sub> in place of <italic>M</italic><sub>0</sub>, and also allowing arc deletions: for all <italic>q<sub>ij</sub></italic> in <italic>M</italic><sub>1</sub>, compute the XIC of the model which is the same as <italic>M</italic><sub>1</sub>, except that it <italic>does not contain q<sub>ij</sub></italic>. Among all the possible arc additions and deletions, choose the operation which most increases the XIC, and call the resulting model <italic>M</italic><sub>2</sub>.</p>
        <p>5. If possible, continue greedily adding/deleting arcs, stopping when the XIC can no longer be increased.</p>
        <p>Then we use the last model in the sequence as our final model from which to infer HLA-restricted epitopes. That is, for all <italic>q<sub>ij</sub></italic> included in the final model, we will call the hypothesis that epitope <italic>j</italic> is restricted by HLA <italic>i</italic>, true. The smaller <italic>f<sup>*</sup></italic> is, the more <italic>q<sub>ij</sub></italic> will be included in the final model. Next we show how to estimate the number of <italic>q<sub>ij</sub></italic> recovered using this procedure that we expect to be spurious (i.e., arising from chance alone, rather than from true HLA restrictions).</p>
      </sec>
      <sec id="s2e">
        <title>Estimating the False Discovery Rate</title>
        <p>For any specified value of the model selection parameter, <italic>f</italic>, we want to know how many <italic>q<sub>ij</sub></italic> in the recovered model are likely to be true (rather than spuriously generated). That is, we want some sort of statistical significance measure for the epitope hypotheses we have generated. We compute such a measure using a method that we have recently developed [<xref ref-type="bibr" rid="pcbi-0030188-b021">21</xref>]. Next we provide some background to this area of research, followed by presentation of our approach.</p>
        <p>When inferring whether a single hypothesis is true or not, statisticians have traditionally relied on the <italic>p</italic>-value, which controls the number of false positives (type I errors). However, when testing hundreds or thousands of hypotheses simultaneously, the <italic>p</italic>-value needs to be corrected to help avoid making conclusions based on chance alone (known as the problem of <italic>multiple hypothesis testing</italic>). A widely used, though conservative correction, is the Bonferroni correction, which controls the Family Wise Error Rate (FWER). The FWER is a compound measure of error, defined as the probability of seeing at least one false positive among all hypotheses tested. In light of the conservative nature of methods which control the FWER, the statistics community now places great emphasis on estimating and controlling a different compound measure of error, the <italic>false discovery rate</italic> (FDR) [<xref ref-type="bibr" rid="pcbi-0030188-b012">12</xref>,<xref ref-type="bibr" rid="pcbi-0030188-b013">13</xref>].</p>
        <p>In a typical computation of FDR, we are given a set of hypotheses where each hypothesis, <italic>i</italic>, is assigned a score, <italic>s<sub>i</sub></italic> (traditionally, a test statistic, or the <italic>p</italic>-value resulting from such a test statistic). The FDR is computed as a function of a threshold, <italic>t</italic>, on these scores, <italic>FDR = FDR</italic>(<italic>t</italic>). For threshold <italic>t</italic>, all hypotheses with <italic>s<sub>i</sub></italic> ≥ <italic>t</italic> are said to be significant (assuming, without loss of generality, that the higher a score, the more we believe a hypothesis). The FDR at threshold <italic>t</italic> is then given by
					<disp-formula id="pcbi-0030188-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030188.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy='true'>&lsqb;</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy='true'>&rsqb;</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math> --></disp-formula>where <italic>S</italic>(<italic>t</italic>) is the number of hypotheses deemed significant at threshold <italic>t</italic> and <italic>F</italic>(<italic>t</italic>) is the number of those hypotheses which are false, and where expectation is taken with respect to datasets of the same sample size as the observed data drawn from the true joint distribution of the variables. When the number of hypotheses is large, as is usually the case, one can take the expectation of the numerator and denominator separately:
					<disp-formula id="pcbi-0030188-e006"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030188.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy='true'>&lsqb;</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy='true'>&rsqb;</mml:mo></mml:mrow><mml:mo>&cong;</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy='true'>&lsqb;</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mo stretchy='true'>&rsqb;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy='true'>&lsqb;</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mo stretchy='true'>&rsqb;</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow></mml:math> --></disp-formula>
				</p>
        <p>Furthermore, it is often sufficient to use the observed <italic>S</italic>(<italic>t</italic>) as an approximation for <italic>E</italic>[<italic>S</italic>(<italic>t</italic>)]. Thus, the computation of <italic>FDR</italic>(<italic>t</italic>) boils down to the computation of <italic>E</italic>[<italic>F</italic>(<italic>t</italic>)]. One approximation for this quantity which can be reasonable is <italic>E</italic>[<italic>F</italic>(<italic>t</italic>)] ≅ <italic>E</italic><sub>0</sub>[<italic>F</italic>(<italic>t</italic>)], where <italic>E</italic><sub>0</sub> denotes expectation with respect to the null distribution (the distribution of scores obtained when no hypotheses are truly significant), and it is this approach that we take. (For traditional applications of FDR, Storey and Tibshirani offer a clever method to compute <italic>E</italic>[<italic>F</italic>(<italic>t</italic>)] which is less conservative than using <italic>E</italic>[<italic>F</italic>(<italic>t</italic>)] ≅ <italic>E</italic><sub>0</sub>[<italic>F</italic>(<italic>t</italic>)] [<xref ref-type="bibr" rid="pcbi-0030188-b013">13</xref>]. However, this approach is not appropriate in the present context.)</p>
        <p>Applying this approach to estimating the number of true <italic>q<sub>ij</sub></italic> recovered by our model selection procedure (i.e<italic>.</italic>, the number of true HLA-restricted epitopes found by our model), we generalize <italic>S</italic>(·) and <italic>F</italic>(·) to be functions of <italic>f</italic>, the XIC parameter in <xref ref-type="disp-formula" rid="pcbi-0030188-e004">Equation 4</xref>. In particular, <italic>S</italic>(<italic>f</italic>) is the number of <italic>q<sub>ij</sub></italic> found by our model selection procedure when the XIC is used with parameter setting <italic>f</italic> and <italic>F</italic>(<italic>f</italic>) is the number of those <italic>q<sub>ij</sub></italic> which do not truly correspond to HLA-restricted epitopes (i.e., false positives). As in the standard FDR approach, we use the approximation <italic>E</italic>(<italic>S</italic>(<italic>f</italic>)) ≅ Q(<italic>D</italic>,<italic>f</italic>), where <italic>Q</italic>(<italic>D</italic>,<italic>f</italic>) is the number of <italic>q<sub>ij</sub></italic> found by applying our model selection procedure with XIC parameter <italic>f</italic> to the observed data <italic>D</italic> (in our application, <italic>D ≡</italic> {<italic>y<sub>j</sub></italic>}). In addition, we estimate <italic>E</italic><sub>0</sub>(<italic>F</italic>(<italic>f</italic>)) to be <italic>N</italic>(<italic>D<sup>r</sup></italic>,<italic>f</italic>) averaged over multiple datasets <italic>D<sup>r</sup></italic>, <italic>r</italic> = 1,…,<italic>R</italic>, drawn from a null distribution. That is, we estimate the FDR of our HLA-restricted epitopes using the following:
					<disp-formula id="pcbi-0030188-e007"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030188.e007" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='right'><mml:mtr><mml:mtd><mml:mi>F</mml:mi><mml:mi>D</mml:mi><mml:mi>R</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mi>E</mml:mi><mml:mrow><mml:mo stretchy='true'>&lsqb;</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo stretchy='true'>&rsqb;</mml:mo></mml:mrow><mml:mo>&cong;</mml:mo><mml:mfrac><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>&lsqb;</mml:mo><mml:mrow><mml:mi>F</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mo>&rsqb;</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>E</mml:mi><mml:mrow><mml:mo>&lsqb;</mml:mo><mml:mrow><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mo>&rsqb;</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&cong;</mml:mo><mml:mfrac><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:mstyle displaystyle='true'><mml:msubsup><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:msubsup></mml:mstyle><mml:mi>Q</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msup><mml:mi>D</mml:mi><mml:mi>r</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>/</mml:mo><mml:mi>R</mml:mi></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>
				</p>
        <p>The addition of 1 to the numerator smoothes the estimate of <italic>E</italic><sub>0</sub>[<italic>F</italic>(<italic>f</italic>)] so as to take into account the number of random permutations performed. Without this smoothing, if one performed too few random permutations such that ∑<italic><sub>f</sub>Q</italic>(<italic>D<sup>r</sup></italic>,<italic>f</italic>) = 0 due to sampling error, then the estimate of <italic>E</italic><sub>0</sub>[<italic>F</italic>(<italic>f</italic>)] and hence FDR (<italic>f</italic>) would also be 0. We prefer our more conservative estimate, especially as the bias it induces diminishes as the number of permutations increases.</p>
        <p>We sample <italic>D<sup>r</sup></italic> from a null distribution for each epitope by permuting the ELISpot data for that epitope, but leaving the HLA types of the donors intact. This permutation guarantees that any <italic>q<sub>ij</sub></italic> recovered from the model selection procedure on this data are only spuriously recovered. Also note that although the parameters <italic>q<sub>ij</sub></italic> are independent for different epitopes, <italic>j</italic>, and thus the model selection procedure, can operate independently on each epitope, for the purposes of estimating the FDR, we pool all of the epitopes together, so that the approximations we make in computing the FDR are more reasonable.</p>
        <p>As shown in the Results section, by way of synthetic experiments, we find that these approximations for estimating the FDR work quite well in practice. There is, however, one concern about the use of the null distribution described, for which we refer the reader to [<xref ref-type="bibr" rid="pcbi-0030188-b021">21</xref>], but which, to our knowledge, does not affect our use of this methodology in this paper.</p>
        <p>By construction, the emphasis of our FDR approach is on the accuracy of the estimate of the number of false positives, and does not examine the number of false negatives. Whereas this emphasis may seem undesirable, it is common for experimenters to be more interested in how many hypothesized interactions are real, rather than how many were missed, because experimenters will in most cases be using resources to pursue the positive hypotheses, not the negative ones. A similar line of reasoning is mentioned in [<xref ref-type="bibr" rid="pcbi-0030188-b013">13</xref>,<xref ref-type="bibr" rid="pcbi-0030188-b022">22</xref>].</p>
      </sec>
      <sec id="s2f">
        <title>Ranking of Hypotheses</title>
        <p>The problem of finding a meaningful ranking of the individual HLA-restricted epitope hypotheses does not immediately fall out of the FDR framework. However, we can naturally construct a ranking algorithm for the epitope hypotheses by using a Likelihood Ratio statistic. Let <italic>M</italic> denote the model that we learn with our model selection procedure (regardless of the value of <italic>f</italic> used). Then we rank our hypotheses using a likelihood ratio statistic, <italic>v<sub>ij</sub></italic>, which is the log of the ratio of the likelihood of the final model, to that of the final model without the <italic>q<sub>ij</sub></italic> we are evaluating. Specifically, our ranking algorithm is:</p>
        <p>For each <italic>q<sub>ij</sub></italic> included in <italic>M</italic>, do the following: construct a model, <italic>M′<sub>ij</sub></italic> defined to be model <italic>M</italic>, but without <italic>q<sub>ij</sub></italic>, and then compute the likelihood ratio:
					<disp-formula id="pcbi-0030188-e008"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0030188.e008" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&equiv;</mml:mo><mml:mi>log</mml:mi><mml:mspace width="2.5pt"/><mml:mover accent='true'><mml:mi>L</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mo stretchy='false'>(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mi>log</mml:mi><mml:mspace width="2.5pt"/><mml:mover accent='true'><mml:mi>L</mml:mi><mml:mo>&circ;</mml:mo></mml:mover><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mstyle displaystyle='true'><mml:msup><mml:mi>M</mml:mi><mml:mo>&prime;</mml:mo></mml:msup></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow></mml:math> --></disp-formula>
				</p>
        <p>Assign a rank to each <italic>q<sub>ij</sub></italic> equal to the rank of <italic>v<sub>ij</sub></italic> in the set {<italic>v<sub>ij</sub></italic>}.</p>
        <p>This ranking assesses each <italic>q<sub>ij</sub></italic> based on how much it contributes to the likelihood of the data in the model, <italic>M</italic>, in the context of all <italic>q<sub>ij</sub></italic> recovered from the model selection procedure. (The likelihood ratio, <italic>v<sub>ij</sub></italic>, viewed from a Bayesian perspective, is a quantity proportional to a BIC approximation to the Bayes factor [<xref ref-type="bibr" rid="pcbi-0030188-b018">18</xref>], which, under the assumption of a uniform prior over arc sets, amounts to the posterior probability of <italic>q<sub>ij</sub></italic> being included in the model, given the remaining arcs in the model.)</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <p>For our experiments, we used two types of datasets: laboratory-generated HIV ELISpot data, as well as synthetic data based on our model and this real data. The HIV ELISpot data is from a set of previously optimally defined CTL epitopes derived from HIV [<xref ref-type="bibr" rid="pcbi-0030188-b014">14</xref>], which were generally optimized for length so as to be recognized at the lowest antigen concentration in the context of a specific restricting HLA class I allele. Note that these “optimal” peptides may not be optimal for other HLA class I alleles which could also restrict them—for example, other alleles could restrict epitopes that are embedded within the longer peptide sequence tested. There were 140 epitopes and 102 donors with a total of 70 unique HLA-I alleles (although HLA alleles are ideally described by a four-digit number; in many cases, this was not available, and as such, we truncated all HLA-I alleles to two digits, with the exception of the HLA-B15 family alleles, which always had the full four digits available since these “subtypes” may present vastly different sets of epitopes [<xref ref-type="bibr" rid="pcbi-0030188-b023">23</xref>,<xref ref-type="bibr" rid="pcbi-0030188-b024">24</xref>]. The number of unique HLA alleles reported is the number obtained after this compression.). First we use synthetic experiments to show that (1) the FDR estimate we have described is reasonably accurate, and (2) the model selection procedure can recover a good proportion of ground-truth HLA-restricted epitopes from data. Finally, we apply our algorithm to the real data.</p>
      <p>Note that to compute the XIC score for our models, we need to find the maximum likelihood solution for noisy-OR nodes. Fortunately, this is a convex optimization problem [<xref ref-type="bibr" rid="pcbi-0030188-b025">25</xref>] and therefore local minima are not a problem.</p>
      <sec id="s3a">
        <title>Synthetic Experiments</title>
        <p>The synthetic model used to generate data was our epitope model, as described earlier, fitted to the real HIV ELISpot data by using our model selection procedure. We used an XIC setting for <italic>f</italic> that resulted in an estimated <italic>FDR</italic> ≅ 0.3 (<italic>f</italic> = 2.9). This produced 165 <italic>q<sub>ij</sub></italic> in our synthetic model. Additionally, we retained the learned maximum likelihood values for these <italic>q<sub>ij</sub></italic> (and the leaks, <italic>l<sub>j</sub></italic>), so as to be able to generate data from the model. To generate synthetic data from this fitted model, donor HLA data was left as it appeared in the real data, and then <xref ref-type="disp-formula" rid="pcbi-0030188-e001">Equations 1</xref> and <xref ref-type="disp-formula" rid="pcbi-0030188-e002">2</xref> were used to compute the probability that a particular donor would react to a particular epitope, <italic>p<sub>j</sub></italic>, conditioned on the learned values of {<italic>q<sub>ij</sub></italic>} and {<italic>l<sub>j</sub></italic>}. Then samples for each donor, <italic>s<sub>j</sub></italic>, were drawn from a uniform distribution on (0,1] and the reactivities, <italic>y<sub>j</sub></italic>, were set to <italic>y<sub>j</sub></italic> = ( <italic>s<sub>j</sub></italic> ≤ <italic>p<sub>j</sub></italic>). Three synthetic datasets (each consisting of 102 donors and 140 epitopes) were generated in this manner, all from the same synthetic, generative model.</p>
        <p>Plots of actual versus expected FDR for the three datasets are shown in <xref ref-type="fig" rid="pcbi-0030188-g002">Figure 2</xref>A. Estimates of FDR are quite accurate at the lower end, which is the region of interest for our problem and also most other problems of interest (where not too many spurious hypotheses are included). That the FDR becomes increasingly conservative (i.e<italic>.</italic>, it peels away from the idealized line) can likely be explained by the approximation we make in generating a null distribution. Further discussion of this issue, and a suggested resolution, can be found in [<xref ref-type="bibr" rid="pcbi-0030188-b021">21</xref>]. For the XIC parameter, <italic>f</italic>, we used the range [1.97,3.46], with <italic>f</italic> = 3.46 producing actual and estimated FDRs around 0.02, and <italic>f</italic> = 1.97 producing actual FDRs around 0.67 and estimated FDRs around 0.95. Note that BIC corresponds to the cluster of points that have estimated FDRs around 0.7 (<italic>f</italic> = 2.3). AIC (<italic>f</italic> = 1) corresponds to something even less conservative than anything shown (even higher FDRs).</p>
        <fig id="pcbi-0030188-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.0030188.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Actual versus Estimated FDR (A) and False Negatives versus False Positives (B)</title>
            <p>Results from using our model selection procedure and FDR estimation procedure on three datasets generated from a synthetic model learned on the real HIV data. There is a one-to-one correspondence between the points plotted in each figure.</p>
            <p>(A) Estimated and actual FDR. The dashed line denotes the idealized curve.</p>
            <p>(B) The number of false negatives (<italic>q<sub>ij</sub></italic> not recovered in these experiments, but appearing in the synthetic model), compared with the number of false positives (<italic>q<sub>ij</sub></italic> recovered in these experiments, but not in the synthetic model).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030188.g002" xlink:type="simple"/>
        </fig>
        <p>Not only do we want to know that our FDR estimate is accurate, but we also want to know that our model selection procedure is a reasonable one. We therefore examine how many ground truth <italic>q<sub>ij</sub></italic> were recovered, and at what cost in false negatives. This information is displayed in <xref ref-type="fig" rid="pcbi-0030188-g002">Figure 2</xref>B. Note that because we created a synthetic model with what were presumed to be 30% spurious <italic>q<sub>ij</sub></italic>, many of these <italic>q<sub>ij</sub></italic> are likely quite small (signifying weak associations), and therefore would be more difficult to recover in synthetic experiments using data generated from this model. Such difficulties are also likely to arise with real data in real applications. The points in <xref ref-type="fig" rid="pcbi-0030188-g002">Figure 2</xref>B that have about 50 false positives correspond to an estimated/actual FDR of around 0.3. The points which have about 150 false positives are those corresponding to <italic>XIC</italic> = <italic>BIC</italic> (for which <italic>FDR</italic> ≅ 0.7). Overall, the tradeoff between the number of false positives and false negatives is very reasonable.</p>
      </sec>
      <sec id="s3b">
        <title>Application to Real Data</title>
        <p>Using the real HIV data, we found 134 HLA-restrictions at <italic>FDR</italic> ≅ 0.2 among the possible 140 × 70 possible HLA restrictions. To validate our predictions on the real HIV dataset, we performed in vitro assays that specifically measured particular HLA restrictions [<xref ref-type="bibr" rid="pcbi-0030188-b026">26</xref>]. Ideally, all 134 pairs should have been evaluated, but this was too expensive and work-intensive. Consequently, six pairs for which the HLA-peptide association is biologically interesting (i.e<italic>.</italic>, unlikely based on current understanding of peptide–HLA binding) were evaluated. All six relationships were confirmed [<xref ref-type="bibr" rid="pcbi-0030188-b026">26</xref>]. Prior to this study (partially reported in [<xref ref-type="bibr" rid="pcbi-0030188-b026">26</xref>]), it was thought that HLA class I epitopes were restricted mainly by a single HLA allele, or if by more than one allele, then only a few that were structurally highly related and commonly fell into the same HLA supertype [<xref ref-type="bibr" rid="pcbi-0030188-b027">27</xref>] (supertypes group together HLA alleles with similar amino acid binding motifs). However, our analysis suggests that a single epitope is frequently restricted by numerous HLA alleles. Additionally, when viewed through the traditional lens of supertypes, we found restrictions across supertypes. For example, IYQEPFKNLK was previously known to be restricted by A11, and we found that it is also restricted by A24 (confirmed experimentally), where A11 and A24 belong to two different supertypes. <xref ref-type="table" rid="pcbi-0030188-t001">Table 1</xref> shows a summary of the number of previously known HIV epitopes restricted by one HLA allele, and up to four HLA alleles (none were known to be restricted by more than four alleles) [<xref ref-type="bibr" rid="pcbi-0030188-b014">14</xref>]. After adding our newly statistically identified HLA-restricted epitopes, these numbers change dramatically, as shown in <xref ref-type="table" rid="pcbi-0030188-t002">Table 2</xref>. These tables suggest that HLA class I epitopes are far more “promiscuous” than originally thought, a notion that has significant implications for the understanding of HLA class I antigen presentation and vaccine development. We refer the reader to [<xref ref-type="bibr" rid="pcbi-0030188-b026">26</xref>] for a more detailed account of the biological findings. (Note that there are a few differences between the results reported in [<xref ref-type="bibr" rid="pcbi-0030188-b026">26</xref>] and the current presentation of results. In [<xref ref-type="bibr" rid="pcbi-0030188-b026">26</xref>], the previously known HLA-restrictions were “fixed” to be present in the model before model selection was used to search for new HLA restrictions. We thought it would be of interest to see the results when this a priori information was not used. Additionally, the number of HIV “optimal” epitopes tested was reported as 162 in [<xref ref-type="bibr" rid="pcbi-0030188-b026">26</xref>], whereas we report 140—this is due to the fact that epitope–HLA pairs were counted in the former, while here we count only unique epitopes—of which some were repeated across HLA restrictions. The raw data are, however, identical.)</p>
        <table-wrap content-type="1col" id="pcbi-0030188-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030188.t001</object-id><label>Table 1</label><caption>
            <p>Previously Known Promiscuity</p>
          </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030188.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="char" charoff="0" char="."/></colgroup><thead><tr><td align="left"><hr/>Number of Restricting HLAs</td><td><hr/>Number of Peptides</td></tr></thead><tbody><tr><td>1</td><td>126</td></tr><tr><td>2</td><td>16</td></tr><tr><td>3</td><td>1</td></tr><tr><td>4</td><td>2</td></tr></tbody></table> --><!-- --></table-wrap>
        <table-wrap content-type="1col" id="pcbi-0030188-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0030188.t002</object-id><label>Table 2</label><caption>
            <p>Promiscuity Updated with Present Analysis</p>
          </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030188.t002" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="left" charoff="0" char=""/><col id="tb2col2" align="char" charoff="0" char="."/></colgroup><thead><tr><td align="left"><hr/>Number of Restricting HLAs</td><td><hr/>Number of Peptides</td></tr></thead><tbody><tr><td>1</td><td>47</td></tr><tr><td>2</td><td>58</td></tr><tr><td>3</td><td>26</td></tr><tr><td>4</td><td>10</td></tr><tr><td>5</td><td>3</td></tr><tr><td>6</td><td>0</td></tr><tr><td>7</td><td>1</td></tr></tbody></table> --><!-- --></table-wrap>
        <p><xref ref-type="supplementary-material" rid="pcbi-0030188-st001">Table S1</xref>A lists all epitopes identified by our statistical analysis, sorted by rank from most to least important, along with their learned <italic>q<sub>ij</sub></italic> values, and noting which epitopes were previously known, which were confirmed, and what other HLA alleles were previously known to restrict each epitope. Of the 134 identified epitopes we identified, 46 were previously known (eight of our top ten ranked epitopes were known).</p>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>We have introduced, implemented, and examined use of a statistical approach for identifying epitope-restricting HLA alleles from ELISpot data. This approach provides a high-throughput, efficient, and cost-effective method for the screening of novel HLA-restricted epitopes. Additionally, our methodology introduces a new approach to the model selection problem, wherein a parameterized family of model selection scores can be explored, by estimating the FDR resulting from the use of each score, and choosing one which suits the needs of the user. In other words, we are able to customize the tradeoff between high discovery rates, and false leads, rather than relying on a single model selection criterion.</p>
      <p>Several improvements to the model are possible. (1) Some donors tend to have a higher overall reaction level, thus it may be fruitful to include a latent variable which models this donor-specific bias. (2) A confounding factor in our analysis is the existence of false negatives due to a failed chemical reaction in the ELISpot assay. One could add an observation component to model this type of experimental noise. (3) We stated that the ELISpot data are real-valued, but thought to be informative at a mostly binary level. However, it might be possible to extract more information by using the actual real-valued measurements.</p>
      <p>Lastly, by applying our methodology to real HIV data, we have helped to shed light on the extent to which HLA class I epitopes are promiscuous. This has significant implications for the understanding of HLA class I antigen presentation and vaccine development.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi-0030188-st001" mimetype="application/msexcel" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0030188.st001" xlink:type="simple">
        <label>Table S1</label>
        <caption>
          <title>Comprehensive List of All HLA-Restricted Epitopes Found on HIV Data</title>
          <p>Known HLA refers to HLA restrictions previously known.</p>
          <p>Recovered HLA refers to restrictions recovered from our statistical analysis.</p>
          <p><italic>v<sub>ij</sub></italic> is the likelihood ration score used to rank the hypotheses (they are shown ranked from strongest to weakest).</p>
          <p><italic>q<sub>ij</sub></italic> is the learned value of the noisy-OR parameter for HLA restriction.</p>
          <p>Known is equal to one if this HLA restriction was already known.</p>
          <p>Tested refers to those peptides which we confirmed experimentally.</p>
          <p>(37 KB XLS)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank Nebojsa Jojic and Bette Korber for useful discussions.</p>
    </ack>
    
    <glossary>
      <title>Abbreviations</title>
      <def-list>
        <def-item>
          <term>AIC</term>
          <def>
            <p>Akaike Information Criterion</p>
          </def>
        </def-item>
        <def-item>
          <term>BIC</term>
          <def>
            <p>Bayesian Information Criterion</p>
          </def>
        </def-item>
        <def-item>
          <term>FDR</term>
          <def>
            <p>false discovery rate</p>
          </def>
        </def-item>
        <def-item>
          <term>FWER</term>
          <def>
            <p>Family-Wise Error Rate</p>
          </def>
        </def-item>
        <def-item>
          <term>HLA</term>
          <def>
            <p>human leukocyte antigen</p>
          </def>
        </def-item>
        <def-item>
          <term>MDL</term>
          <def>
            <p>Minimum Description Length</p>
          </def>
        </def-item>
      </def-list>
    </glossary>
    <ref-list>
      <title>References</title>
      <ref id="pcbi-0030188-b001">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Johnston</surname><given-names>MI</given-names></name><name name-style="western"><surname>Fauci</surname><given-names>AS</given-names></name></person-group>
					<year>2007</year>
					<article-title>An HIV vaccine—Evolving concepts.</article-title>
					<source>N Engl J Med</source>
					<volume>20</volume>
					<fpage>2073</fpage>
					<lpage>2081</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b002">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>McMichael</surname><given-names>A</given-names></name><name name-style="western"><surname>Hanke</surname><given-names>T</given-names></name></person-group>
					<year>2002</year>
					<article-title>The quest for an AIDS vaccine: Is the CD8+ T cell approach feasible?</article-title>
					<source>Nat Rev</source>
					<volume>2</volume>
					<fpage>283</fpage>
					<lpage>291</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b003">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hertz</surname><given-names>T</given-names></name><name name-style="western"><surname>Yanover</surname><given-names>C</given-names></name></person-group>
					<year>2007</year>
					<article-title>Identifying HLA supertypes by learning distance functions.</article-title>
					<source>Bioinformatics</source>
					<volume>23</volume>
					<fpage>e148</fpage>
					<lpage>e155</lpage>
                                    <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/Bioinformatics/btl324" xlink:type="simple">10.1093/Bioinformatics/btl324</ext-link></comment>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b004">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kiepiela</surname><given-names>P</given-names></name><name name-style="western"><surname>Ngumbela</surname><given-names>K</given-names></name><name name-style="western"><surname>Thobakgale</surname><given-names>C</given-names></name><name name-style="western"><surname>Ramduth</surname><given-names>D</given-names></name><name name-style="western"><surname>Honeyborne</surname><given-names>I</given-names></name><etal/></person-group>
					<year>2007</year>
					<article-title>CD8+ T cell responses to different HIV proteins have discordant associations with viral load.</article-title>
					<source>Nat Med</source>
					<volume>13</volume>
					<fpage>46</fpage>
					<lpage>53</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b005">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fischer</surname><given-names>W</given-names></name><name name-style="western"><surname>Perkins</surname><given-names>S</given-names></name><name name-style="western"><surname>Theiler</surname><given-names>J</given-names></name><name name-style="western"><surname>Bhattacharya</surname><given-names>T</given-names></name><name name-style="western"><surname>Yusim</surname><given-names>K</given-names></name><etal/></person-group>
					<year>2007</year>
					<article-title>Polyvalent vaccines for optimal coverage of potential T cell epitopes in global HIV-1 variants.</article-title>
					<source>Nat Med</source>
					<volume>1</volume>
					<fpage>100</fpage>
					<lpage>106</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b006">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Nickle</surname><given-names>DC</given-names></name><name name-style="western"><surname>Rolland</surname><given-names>M</given-names></name><name name-style="western"><surname>Jensen</surname><given-names>MA</given-names></name><name name-style="western"><surname>Pond</surname><given-names>SLK</given-names></name><name name-style="western"><surname>Deng</surname><given-names>W</given-names></name><etal/></person-group>
					<year>2007</year>
					<article-title>Coping with viral diversity in HIV vaccine design.</article-title>
					<source>PLoS Comput Biol</source>
					<volume>3</volume>
					<elocation-id>e75.</elocation-id>
					<comment>doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0030075" xlink:type="simple">10.1371/journal.pcbi.0030075</ext-link></comment>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b007">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Goulder</surname><given-names>P</given-names></name><name name-style="western"><surname>Addo</surname><given-names>M</given-names></name><name name-style="western"><surname>Altfeld</surname><given-names>M</given-names></name><name name-style="western"><surname>Rosenberg</surname><given-names>E</given-names></name><name name-style="western"><surname>Tang</surname><given-names>Y</given-names></name><etal/></person-group>
					<year>2001</year>
					<article-title>Rapid definition of five novel HLA-A*3002-restricted human immunodeficiency virus-specific cytotoxic T-lymphocyte epitopes by Elispot and intracellular cytokine staining assays.</article-title>
					<source>J Virol</source>
					<volume>75</volume>
					<fpage>1339</fpage>
					<lpage>1347</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b008">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zhanga</surname><given-names>GL</given-names></name><name name-style="western"><surname>Bozic</surname><given-names>I</given-names></name><name name-style="western"><surname>Kwoh</surname><given-names>CK</given-names></name><name name-style="western"><surname>August</surname><given-names>JT</given-names></name><name name-style="western"><surname>Brusic</surname><given-names>V</given-names></name></person-group>
					<year>2007</year>
					<article-title>Prediction of supertype-specific HLA class I binding peptides using support vector machines.</article-title>
					<source>J Immunol Methods</source>
					<volume>320</volume>
					<fpage>143</fpage>
					<lpage>154</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b009">
        <label>9</label>
        <element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sette</surname><given-names>A</given-names></name><name name-style="western"><surname>Bui</surname><given-names>HH</given-names></name><name name-style="western"><surname>Sidney</surname><given-names>J</given-names></name><name name-style="western"><surname>Bourne</surname><given-names>P</given-names></name><name name-style="western"><surname>Buus</surname><given-names>S</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>The Immune Epitope Database and analysis resource.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Rajapakse</surname><given-names>JC</given-names></name><name name-style="western"><surname>Wong</surname><given-names>L</given-names></name><name name-style="western"><surname>Acharya</surname><given-names>R</given-names></name></person-group>
					<source>Proceedings of the Pattern Recognition in Bioinformatics International Workshop, PRIB 2006</source>
					<conf-date>20 August 2006;</conf-date>
					<conf-loc>Hong Kong, China.</conf-loc>
					<publisher-loc>Berlin: Springer</publisher-loc>
					<fpage>126</fpage>
					<lpage>132</lpage>
					<comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.immuneepitope.org/references.do" xlink:type="simple">http://www.immuneepitope.org/references.do</ext-link>. Accessed 11 September 2007. </comment>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b010">
        <label>10</label>
        <element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lund</surname><given-names>O</given-names></name><name name-style="western"><surname>Nielsen</surname><given-names>M</given-names></name><name name-style="western"><surname>Lundegaard</surname><given-names>C</given-names></name><name name-style="western"><surname>Kesmir</surname><given-names>C</given-names></name><name name-style="western"><surname>Brunak</surname><given-names>S</given-names></name></person-group>
					<year>2005</year>
					<source>Immunological bioinformatics (computational molecular biology)</source>
					<publisher-loc>Cambridge (Massachusetts)</publisher-loc>
					<publisher-name>MIT Press</publisher-name>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b011">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name><name name-style="western"><surname>Kadie</surname><given-names>CM</given-names></name><name name-style="western"><surname>Listgarten</surname><given-names>J</given-names></name></person-group>
					<year>2007</year>
					<article-title>Leveraging information across HLA alleles/supertypes improves epitope prediction.</article-title>
					<source>J Comput Biol</source>
					<volume>14</volume>
					<fpage>736</fpage>
					<lpage>746</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b012">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name><name name-style="western"><surname>Hochberg</surname><given-names>Y</given-names></name></person-group>
					<year>1995</year>
					<article-title>Controlling the false discovery rate: A practical and powerful approach to multiple testing.</article-title>
					<source>J R Stat Soc</source>
					<volume>57</volume>
					<fpage>289</fpage>
					<lpage>300</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b013">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Storey</surname><given-names>JD</given-names></name><name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name></person-group>
					<year>2003</year>
					<article-title>Statistical significance for genomewide studies.</article-title>
					<source>Proc Natl Acad Sci U S A</source>
					<volume>100</volume>
					<fpage>9440</fpage>
					<lpage>9445</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b014">
        <label>14</label>
        <element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Frahm</surname><given-names>N</given-names></name><name name-style="western"><surname>Goulder</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Brander</surname><given-names>C</given-names></name></person-group>
					<year>2004</year>
					<article-title>Broad HIV-1 specific CTL responses reveal extensive HLA class I binding promiscuity of HIV-derived, optimally defined CTL epitopes.</article-title>
					<comment>In:</comment>
					<source>HIV molecular immunology database</source>
					<publisher-loc>Los Alamos (New Mexico)</publisher-loc>
					<publisher-name>Los Alamos National Laboratory, Theoretical Biology and Biophysics</publisher-name>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b015">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name><name name-style="western"><surname>Breese</surname><given-names>J</given-names></name></person-group>
					<year>1996</year>
					<article-title>Causal independence for probability assessment and inference using Bayesian networks.</article-title>
					<source>IEEE Trans Syst Man Cybern</source>
					<volume>26</volume>
					<fpage>826</fpage>
					<lpage>831</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b016">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Shwe</surname><given-names>M</given-names></name><name name-style="western"><surname>Middleton</surname><given-names>B</given-names></name><name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name><name name-style="western"><surname>Henrion</surname><given-names>M</given-names></name><name name-style="western"><surname>Horvitz</surname><given-names>E</given-names></name><etal/></person-group>
					<year>1991</year>
					<article-title>Probabilistic diagnosis using a reformulation of the INTERNIST-1/QMR knowledge base: Part I. The probabilistic model and inference algorithms.</article-title>
					<source>Methods Inf Med</source>
					<volume>30</volume>
					<fpage>241</fpage>
					<lpage>250</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b017">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Akaike</surname><given-names>H</given-names></name></person-group>
					<year>1974</year>
					<article-title>A new look at the statistical model identification.</article-title>
					<source>IEEE Trans Auto Control</source>
					<volume>19</volume>
					<fpage>716</fpage>
					<lpage>723</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b018">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kass</surname><given-names>R</given-names></name><name name-style="western"><surname>Raftery</surname><given-names>A</given-names></name></person-group>
					<year>1995</year>
					<article-title>Bayes factors.</article-title>
					<source>J Am Stat Assoc</source>
					<volume>90</volume>
					<fpage>773</fpage>
					<lpage>795</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b019">
        <label>19</label>
        <element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>MacKay</surname><given-names>DJC</given-names></name></person-group>
					<year>2003</year>
					<source>Information theory, inference, and learning algorithms</source>
					<publisher-loc>Cambridge (United Kingdom)</publisher-loc>
					<publisher-name>Cambridge University Press</publisher-name>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b020">
        <label>20</label>
        <element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Casella</surname><given-names>G</given-names></name><name name-style="western"><surname>Berger</surname><given-names>R</given-names></name></person-group>
					<year>2001</year>
					<source>Statistical inference</source>
					<publisher-loc>Duxbury (Massachusetts)</publisher-loc>
					<publisher-name>Duxbury Press</publisher-name>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b021">
        <label>21</label>
        <element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Listgarten</surname><given-names>J</given-names></name><name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name></person-group>
					<year>2007</year>
					<article-title>Determining the number of non-spurious arcs in a learned DAG model: Investigation of a Bayesian and a frequentist approach.</article-title>
					<comment>In:</comment>
					<source>UAI '07: Proceedings of the 23rd Conference in Uncertainty in Artificial Intelligence</source>
					<conf-loc>University of British Columbia, Vancouver, British Columbia, Canada,</conf-loc>
					<conf-date>19–22 July 2007.</conf-date>
					<publisher-loc>San Francisco</publisher-loc>
					<publisher-name>Morgan Kaufmann</publisher-name>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b022">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name><name name-style="western"><surname>Koller</surname><given-names>D</given-names></name></person-group>
					<year>2003</year>
					<article-title>Being bayesian about network structure. A bayesian approach to structure discovery in bayesian networks.</article-title>
					<source>Mach Learn</source>
					<volume>50</volume>
					<fpage>95</fpage>
					<lpage>125</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b023">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Frahm</surname><given-names>N</given-names></name><name name-style="western"><surname>Adams</surname><given-names>S</given-names></name><name name-style="western"><surname>Kiepiela</surname><given-names>P</given-names></name><name name-style="western"><surname>Linde</surname><given-names>C</given-names></name><name name-style="western"><surname>Hewitt</surname><given-names>H</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>HLA-B63 presents HLA-B57/B58-restricted cytotoxic T-lymphocyte epitopes and is associated with low human immunodeficiency virus load.</article-title>
					<source>J Virol</source>
					<volume>79</volume>
					<fpage>10218</fpage>
					<lpage>10225</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b024">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Frahm</surname><given-names>N</given-names></name><name name-style="western"><surname>Kiepiela</surname><given-names>P</given-names></name><name name-style="western"><surname>Adams</surname><given-names>S</given-names></name><name name-style="western"><surname>Linde</surname><given-names>C</given-names></name><name name-style="western"><surname>Hewitt</surname><given-names>H</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>Control of human immunodeficiency virus replication by cytotoxic T lymphocytes targeting subdominant epitopes.</article-title>
					<source>Nat Immunol</source>
					<volume>2</volume>
					<fpage>173</fpage>
					<lpage>178</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b025">
        <label>25</label>
        <element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jurgelenaite</surname><given-names>R</given-names></name><name name-style="western"><surname>Heskes</surname><given-names>T</given-names></name></person-group>
					<year>2006</year>
					<article-title>Symmetric causal independence models for classification.</article-title>
					<comment>In:</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Studeny</surname><given-names>M</given-names></name><name name-style="western"><surname>Vomlel</surname><given-names>J</given-names></name></person-group>
					<source>Proceedings of the Third European Workshop on Probabilistic Graphical Models</source>
					<conf-date>12–15 September 2006;</conf-date>
					<publisher-loc>Prague, Czech Republic</publisher-loc>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b026">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Frahm</surname><given-names>N</given-names></name><name name-style="western"><surname>Yusim</surname><given-names>K</given-names></name><name name-style="western"><surname>Suscovich</surname><given-names>T</given-names></name><name name-style="western"><surname>Adams</surname><given-names>S</given-names></name><name name-style="western"><surname>Sidney</surname><given-names>J</given-names></name><etal/></person-group>
					<year>2007</year>
					<article-title>Extensive HLA class I allele promiscuity among viral CTL epitopes.</article-title>
					<source>Eur J Immunol</source>
					<volume>37</volume>
					<fpage>2419</fpage>
					<lpage>2433</lpage>
				</element-citation>
      </ref>
      <ref id="pcbi-0030188-b027">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sette</surname><given-names>A</given-names></name><name name-style="western"><surname>Sidney</surname><given-names>J</given-names></name></person-group>
					<year>1999</year>
					<article-title>Nine major HLA class I supertypes account for the vast preponderance of HLA-A and -B polymorphism.</article-title>
					<source>Immunogenetics</source>
					<volume>50</volume>
					<fpage>201</fpage>
					<lpage>212</lpage>
				</element-citation>
      </ref>
    </ref-list>
  </back>
</article>