<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-02145</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004416</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>SubClonal Hierarchy Inference from Somatic Mutations: Automatic Reconstruction of Cancer Evolutionary Trees from Multi-region Next Generation Sequencing</article-title>
<alt-title alt-title-type="running-head">SubClonal Hierarchy Inference from Somatic Mutations</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Niknafs</surname> <given-names>Noushin</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Beleva-Guthrie</surname> <given-names>Violeta</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Naiman</surname> <given-names>Daniel Q.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Karchin</surname> <given-names>Rachel</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Biomedical Engineering and Institute for Computational Medicine, Johns Hopkins University, Baltimore, Maryland, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Applied Math and Statistics, Johns Hopkins University, Baltimore, Maryland, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Oncology, Johns Hopkins Medical Institutions, Baltimore, Maryland, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Morris</surname> <given-names>Quaid</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Toronto, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: NN RK. Performed the experiments: NN. Analyzed the data: NN. Contributed reagents/materials/analysis tools: NN VBG DQN. Wrote the paper: NN RK.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">karchin@jhu.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>5</day>
<month>10</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>10</issue>
<elocation-id>e1004416</elocation-id>
<history>
<date date-type="received">
<day>1</day>
<month>12</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>6</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Niknafs et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004416" xlink:type="simple"/>
<abstract>
<p>Recent improvements in next-generation sequencing of tumor samples and the ability to identify somatic mutations at low allelic fractions have opened the way for new approaches to model the evolution of individual cancers. The power and utility of these models is increased when tumor samples from multiple sites are sequenced. Temporal ordering of the samples may provide insight into the etiology of both primary and metastatic lesions and rationalizations for tumor recurrence and therapeutic failures. Additional insights may be provided by temporal ordering of evolving subclones—cellular subpopulations with unique mutational profiles. Current methods for subclone hierarchy inference tightly couple the problem of temporal ordering with that of estimating the fraction of cancer cells harboring each mutation. We present a new framework that includes a rigorous statistical hypothesis test and a collection of tools that make it possible to decouple these problems, which we believe will enable substantial progress in the field of subclone hierarchy inference. The methods presented here can be flexibly combined with methods developed by others addressing either of these problems. We provide tools to interpret hypothesis test results, which inform phylogenetic tree construction, and we introduce the first genetic algorithm designed for this purpose. The utility of our framework is systematically demonstrated in simulations. For most tested combinations of tumor purity, sequencing coverage, and tree complexity, good power (≥ 0.8) can be achieved and Type 1 error is well controlled when at least three tumor samples are available from a patient. Using data from three published multi-region tumor sequencing studies of (murine) small cell lung cancer, acute myeloid leukemia, and chronic lymphocytic leukemia, in which the authors reconstructed subclonal phylogenetic trees by manual expert curation, we show how different configurations of our tools can identify either a single tree in agreement with the authors, or a small set of trees, which include the authors’ preferred tree. Our results have implications for improved modeling of tumor evolution and the importance of multi-region tumor sequencing.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Cancer is a genetic disease, driven by DNA mutations. Each tumor is composed of millions of cells with differing genetic profiles that compete with each other for resources in a process similar to Darwinian evolution. We describe a computational framework to model tumor evolution on the cellular level, using next-generation sequencing. The framework is the first to apply a rigorous statistical hypothesis test designed to inform a new search algorithm. Both the test and the algorithm are based on evolutionary principles. The utility of the framework is shown in computer simulations and by automated reconstruction of the cellular evolution underlying murine small cell lung cancers, acute myeloid leukemias and chronic lymophocytic leukemias, from three recent published studies.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by funds from National Cancer Institute R01CA179991 to NN. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="26"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The clonal evolution hypothesis in cancer states that cancer genomes are shaped by numerous rounds of cellular diversification, selection and clonal expansion [<xref ref-type="bibr" rid="pcbi.1004416.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004416.ref002">2</xref>]. Recent methods to characterize tumor clonal evolution can be divided into two broad classes—sample tree reconstruction and subclone tree reconstruction. The first class of methods models the history of clonal evolution in an individual as a phylogenetic tree with leaves being the individual’s tumor samples, yielding a relative temporal ordering and estimate of divergence between the samples [<xref ref-type="bibr" rid="pcbi.1004416.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1004416.ref005">5</xref>]. The second class aims at reconstructing the history of clonal evolution as a tree, which summarizes lineage relationships between cellular subpopulations [<xref ref-type="bibr" rid="pcbi.1004416.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1004416.ref009">9</xref>].</p>
<p>Until single-cell sequencing data is widely available, accurate high resolution modeling of tumor evolution [<xref ref-type="bibr" rid="pcbi.1004416.ref010">10</xref>] will likely remain exceedingly difficult, if not impossible. On the other hand, the coverage depth of current next generation sequencing experiments limits the number of cellular subpopulations or <italic>subclones</italic> detectable in tumor samples to a few (approximately 5–10) that have undergone signficant clonal expansions [<xref ref-type="bibr" rid="pcbi.1004416.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004416.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1004416.ref014">14</xref>]. Each of these subclones emerge from a parental population of cells by acquiring additional somatic mutations, and cells within each subclone can be assumed to be homogeneous. Modeling of subclone evolution often involves estimating the fraction of cancer cells harboring each somatic mutation <italic>i.e</italic>., somatic mutation <italic>cellularity</italic>, which can be inferred from next generation sequencing read count data. For example, PyClone [<xref ref-type="bibr" rid="pcbi.1004416.ref015">15</xref>] employs a Markov Chain Monte Carlo method to identify groups of mutations with similar cellularities, and SciClone [<xref ref-type="bibr" rid="pcbi.1004416.ref016">16</xref>] uses variational Bayes mixture models to cluster somatic mutations by their read count frequencies, which can be a proxy for cellularities.</p>
<p>Most recently, methods that couple the problems of somatic mutation clustering and phylogenetic reconstruction have emerged. PhyloSub applies a tree-structured stick breaking process that introduces tree-compatible cellularity values for mutation clusters [<xref ref-type="bibr" rid="pcbi.1004416.ref006">6</xref>]. A combinatoric approach based on an approximation algorithm for binary tree paritions [<xref ref-type="bibr" rid="pcbi.1004416.ref007">7</xref>] and a mixture deconvolution algorithm [<xref ref-type="bibr" rid="pcbi.1004416.ref008">8</xref>] have also been developed. However to our knowledge, most recently published studies of multi-region tumor sequencing continue to employ manual curation to construct a subclone phylogeny, after mutation cellularity has been estimated computationally [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>–<xref ref-type="bibr" rid="pcbi.1004416.ref014">14</xref>].</p>
<p>We propose that progress in methods to reconstruct subclonal phylogenies will be substantially enabled by decoupling the problems of temporal ordering of subclones from that of mutation cellularity estimation. The SubClonal Hierarchy Inference from Somatic Mutations (SCHISM) framework described here can incorporate a variety of methods to estimate the cellularity of individual mutations, the cellularity of mutation clusters, and to build phylogenetic trees. First, we derive a novel mathematical formulation of assumptions about lineage precedence and lineage divergence in tumor evolution that have been fundamental to other subclone tree reconstruction methods [<xref ref-type="bibr" rid="pcbi.1004416.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1004416.ref009">9</xref>]. Lineage precedence is modeled in terms of a statistical hypothesis test, based on a generalized likelihood ratio. Hypothesis test results are combined with lineage divergence assumptions and formulated as a fitness function that can be used to rank tree topologies, generated by a phylogenetic algorithm. In this work, we designed an implementation of genetic algorithms to build phylogenetic trees. However, the fitness function can also be combined with other approaches to phylogenetic tree reconstruction. The hypothesis test can be combined with any method to estimate mutation or cluster cellularities to infer their temporal orderings.</p>
<p>We use simulations to evaluate the power of the hypothesis test and show that for many combinations of tumor purity, sequencing coverage, and phylogenetic tree complexity, the hypothesis test has good power (≥ 0.8) and Type 1 error is well controlled, when at least three samples from a patient are available. The simulations also confirm that the problem of subclonal phylogenetic tree reconstruction is underdetermined in many settings when the tumor sample count per individual is smaller than the number of subclones <italic>i.e</italic>, nodes in the phylogenetic tree. In these cases, we may see that the genetic algorithm identifies multiple equally plausible phylogenetic trees. However, when the problem is sufficiently determined, in general when the number of samples equals or exceeds the tumor sample count, the genetic algorithm reliably reconstructs the true tree, in most combinations listed above.</p>
<p>Using data from three published multi-region tumor sequencing studies of murine small cell lung cancer [<xref ref-type="bibr" rid="pcbi.1004416.ref013">13</xref>], acute myeloid leukemia [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>] and chronic lymophocytic leukemia [<xref ref-type="bibr" rid="pcbi.1004416.ref014">14</xref>], we show how SCHISM can be configured with a variety of inputs. For all samples in these three studies, SCHISM identified either a single tree in agreement with the tree reconstructed manually by the authors, or a small set of trees, which include the authors’ published tree.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Simulations</title>
<sec id="sec004">
<title>Generalized likelihood ratio hypothesis test</title>
<p>The hypothesis test yielded good power on average and Type 1 error was well controlled (<xref ref-type="fig" rid="pcbi.1004416.g001">Fig 1</xref>). Power improved as the number of samples per individual increased. As the number of nodes in the subclone tree increased, yielding a more complex tree, more samples were required to achieve the same level of power. Even at the lowest purity level (50%) included in our experiments, good power (≥ 0.8) was achieved with 1000X coverage and three or more samples.</p>
<fig id="pcbi.1004416.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004416.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Power and Type 1 error of hypothesis test on simulated data.</title>
<p>For each combination of coverage and purity, results are shown for trees with node counts from three to eight. Each curve was computed by taking the mean over all <italic>instances</italic> and all replicates for each node count. Curves with circular marks show power and curves with triangular marks show Type 1 error. Transparent coloring indicates ±1<italic>SE</italic>. Dotted line indicates power = 0.8.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.g001"/>
</fig>
</sec>
<sec id="sec005">
<title>Automated subclone tree reconstruction</title>
<p>The performance of the genetic algorithm (GA) used for tree reconstruction varied substantially, depending on the simulation inputs: number of tumor samples, node count and topology of the true tree, mutation cluster cellularity values, tumor purity, and sequencing coverage (<xref ref-type="fig" rid="pcbi.1004416.g002">Fig 2</xref>). Given sample count exceeding or equal to node count, the GA most frequently (with probability ≥ 0.5) identified the true tree or a pair of maximum fitness trees that included the true tree. This probability increased to ≥ 0.75 at high purity (0.9) and coverage (1000X). As expected, simpler trees, <italic>e.g</italic>., 3- or 4-node trees, were frequently identified even when the sample count was small. As trees grew more complex, a larger sample count was required, and even the most complex trees in the simulation, which had 8 nodes, were identified frequently when 10 samples were available. However, we also identified combinations of inputs for which the GA had limited success in finding the true tree. We decomposed the performance of the GA into two stages. In Stage 1, we assessed whether the tree reconstruction problem was sufficiently determined by our inputs, meaning that a single maximum fitness tree or a pair of two maximum fitness trees was identified. The GA was more likely to fail in Stage 1 when sample count was smaller than node count (<xref ref-type="fig" rid="pcbi.1004416.g002">Fig 2A1 and 2B1</xref>). Furthermore, the settings of purity and sequencing coverage used in our simulations had less of an effect on Stage 1 success than sample count and tree node count. In Stage 2, we assessed whether the single maximum fitness or pair of maximum fitness trees included the true tree. Samples counts ≥ 5 had the most stable Stage 2 success rates, and the correct tree was recovered with increasing frequency, given higher sample counts, coverage, and purity. As expected, probability of Stage 2 success was higher for trees with smaller node counts. Our estimates of Stage 2 success were noisy when sample count was small and node count high. This behavior was a result of higher failure rates at Stage 1 under these conditions (<xref ref-type="fig" rid="pcbi.1004416.g002">Fig 2A2 and 2B2</xref>).</p>
<fig id="pcbi.1004416.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004416.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Performance of the genetic algorithm evaluated in two stages.</title>
<p>Stage 1: Fraction of simulation runs where the genetic algorithm’s fitness function identified either a single maximum fitness tree (A1) or two maximum fitness trees (B1). Stage 2: Given success in stage 1, fraction of simulation runs where the correct tree was either the single maximum fitness tree (A2) or one of the top two maximum fitness trees (B2). For each combination of coverage and purity, results are shown for trees with node counts from three to eight. Simulations where (sample count) ≥ (node count) are marked by a double circle.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.g002"/>
</fig>
</sec>
</sec>
<sec id="sec006">
<title>Multi-sample sequencing studies</title>
<p>Recent studies of small cell lung cancer (SCLC) in mice [<xref ref-type="bibr" rid="pcbi.1004416.ref013">13</xref>], acute myeloid leukemia (AML) [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>], and chronic lymphocytic leukemia (CLL) [<xref ref-type="bibr" rid="pcbi.1004416.ref014">14</xref>] attempted to infer the subclonal phylogeny underlying tumor progression, based on sequencing of multiple tumor samples. All of the studies applied computational methods to cluster somatic mutations. In some cases mutation cluster cellularities were provided, while in others read counts or cluster mean variant allele fraction was provided. The authors did not use computational methods to reconstruct the subclonal phylogenies.</p>
<p>We applied SCHISM to these datasets, using a variety of configurations. In cases where mutation cluster cellularities were available [<xref ref-type="bibr" rid="pcbi.1004416.ref013">13</xref>], we used the hypothesis test on pairs of mutation clusters. If mean variant allele fraction for clusters was available [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>], we inferred cellularity as described in (<xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref>:Eq.S4) and used the hypothesis test on pairs of mutation clusters. When only read counts and mutation cluster assignments were available [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004416.ref014">14</xref>], we used our own naive estimator to derive cellularity values, and applied the hypothesis test to pairs of mutations. For all configurations, we constructed a precedence order violation matrix for all pairs of mutations (<italic>POV matrix</italic>) or all pairs of mutation clusters (<italic>CPOV matrix</italic>) and ran the genetic algorithm. This approach consistently identified phylogenies identical to those manually constructed by the authors as either the single maximum fitness tree or among a small set trees tied for the maximum fitness, in underdetermined cases. In the AML study, the authors did not construct phylogenies for three out of eight patients, but they predicted which of two general clonal evolution models best explained relapse in these three patients. For two of these patients, our phylogenies were in agreement with the authors’ clonal evolution model. For the third patient, our phylogenies suggested that either of the two clonal evolution models might explain relapse. Methods details are all described in Methods (sections on Hypothesis test, Precedence Order Violation Matrix, Application to mutation clusters, Vote Aggregation and Subclonse size estimation) and <xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref> (sections on Naive mutation cellularity estimate and Cluster cellularity estimation).</p>
<sec id="sec007">
<title>Murine small cell lung carcinoma</title>
<p>This study sequenced small cell lung cancer (SCLC) tumor samples from a cohort of transgenic mice with lung-specific Trp53 and Rb1 compound deletion. The full study included whole exome sequencing (WES) (150X coverage) of 27 primary tumors and metastases from six individual animals [<xref ref-type="bibr" rid="pcbi.1004416.ref013">13</xref>]. The authors applied ABSOLUTE to call copy number alterations, combine them with mutation read counts, and estimate cellularity values of each mutation. Mutation clusters were defined by clustering mutations with similar cellularity values. For three of these animals (with identifiers 3588, 3151, 984), the authors manually built subclonal phylogenetic trees.</p>
<p>Using the hypothesis test on the ABSOLUTE cluster mean cellularities (Fig. 5 in [<xref ref-type="bibr" rid="pcbi.1004416.ref013">13</xref>]), we generated a cluster-level precedence order violation matrix (CPOV) and a cluster cellularity by sample matrix for each mouse.</p>
<p>Animals 3588 and 3151 had data available for one primary and two metatastic tumors. For animal 3588, SCHISM identified an 8-node single maximum fitness tree and that tree (<xref ref-type="fig" rid="pcbi.1004416.g003">Fig 3A</xref>) was identical to the authors’ manually built tree. For animal 3151, SCHISM identified six 9-node maximum fitness trees, and one of these trees was identical to the authors’ tree. While the problem was insufficiently determined, interestingly the trees shared a significant number of lineage relationships, and the main discrepancies among trees were the parental lineage for Clone3 and Clone2b (using notation from [<xref ref-type="bibr" rid="pcbi.1004416.ref013">13</xref>]) (<xref ref-type="fig" rid="pcbi.1004416.g003">Fig 3B</xref>). For animal 984, data was available for one primary one metastatic tumor. SCHISM identified six 7-node maximum fitness trees (<italic>i.e</italic>., underdetermined problem), and one of these trees was identical to the authors’ tree (<xref ref-type="fig" rid="pcbi.1004416.g003">Fig 3C</xref>).</p>
<fig id="pcbi.1004416.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004416.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Reconstruction of subclonal phylogenies in murine models of SCLC.</title>
<p><bold>A. Animal 3588.</bold> SCHISM identified a single maximum fitness 8-node tree using one primary and two metastatic tumors. <bold>B. Animal 3151.</bold> Six maximum fitness 9-node trees were identified using one primary and two metastatic tumors. <bold>C. Animal 984.</bold> Six maximum fitness 7-node trees were identified using one primary and one metastatic tumor. Solid arrows represent lineage relationships shared by all six trees and dashed arrows represent lineage relationships shared by only a subset of the trees. Each arrow is labeled with the fraction of maximum fitness trees that include the lineage relationship. Highlighted arrows indicate the tree manually constructed by the study authors. GL = germline state. Cluster precedence order violation (CPOV) matrices are shown to the left of each tree. Columns and rows represent subclones (or Clones in the terminology of [<xref ref-type="bibr" rid="pcbi.1004416.ref013">13</xref>]). Each red square represents a pair of subclones (I,J) for which the null hypothesis that I could be the parent of J was rejected. Each blue square represents a pair for which the null hypothesis could not be rejected.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.g003"/>
</fig>
</sec>
<sec id="sec008">
<title>Chronic lymphocytic leukemia</title>
<p>This longitudinal study of subclonal evolution in B-cell CLL tracked three patients (CLL 003, CLL006, CLL077) over a period of up to seven years [<xref ref-type="bibr" rid="pcbi.1004416.ref014">14</xref>]. For each patient, five longitudinal peripheral blood samples were collected, and each sample was whole-genome sequenced. For selected somatically mutated sites, they further applied targeted deep sequencing (at reported 100,000X coverage). K-means clustering and expert curation were used to infer mutation clusters and subclonal phylogenetic trees were manually built.</p>
<p>We used mutation cluster assignments and read counts from targeted deep sequencing, for each mutation in each sample (Tables S6, S7, or S8 in [<xref ref-type="bibr" rid="pcbi.1004416.ref014">14</xref>]). Purity was estimated by identifying the mutation cluster with the maximum mean variant allele frequency in each sample. Next, based on purity and read count, we calculated cellularity (and standard error) for each mutation in diploid or copy number = 1 regions with the naive estimator. The hypothesis test was performed for each pair of mutations and a cluster precedence order violation (CPOV) matrix was constructed, using a vote aggregation scheme (Methods).</p>
<p>For patients CLL003 and CLL077, SCHISM identified a single 4-node maximum fitness tree that was identical to the authors’ manually built tree (<xref ref-type="fig" rid="pcbi.1004416.g004">Fig 4A and 4C</xref>). For patient CLL006, two 5-node maximum fitness trees were identified, and one was identical to the authors’ tree (<xref ref-type="fig" rid="pcbi.1004416.g004">Fig 4B</xref>).</p>
<fig id="pcbi.1004416.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004416.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Reconstruction of subclonal phylogenies in CLL.</title>
<p><bold>A. CLL003.</bold> SCHISM identified a single maximum fitness 4-node tree using 5 samples. <bold>B. CLL006.</bold> Two maximum fitness 5-node trees were identified using 5 samples. Solid arrows represent lineage relationships shared by both trees and dashed arrows represent lineage relationships specific to one of the trees. <bold>C. CLL077.</bold> A single maximum fitness 4-node tree was identified using 5 samples. Each arrow is labeled with the fraction of maximum fitness trees that include the lineage relationship. Highlighted arrows indicate the tree manually constructed by the study authors. GL = germline state. Cluster precedence order violation (CPOV) matrices are shown to the left of each tree. Columns and rows represent mutation clusters. Each square represents a pair of mutation clusters (I,J) and the numeric value in the square shows the fraction of mutation pairs (i,j) for which the null hypothesis was rejected (Section Vote Aggregation). The mutated genes assigned to each cluster in [<xref ref-type="bibr" rid="pcbi.1004416.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004416.ref014">14</xref>] are listed.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.g004"/>
</fig>
</sec>
<sec id="sec009">
<title>Acute myeloid leukemia</title>
<p>This study of relapse in acute myeloid leukemia (AML) consisted of whole genome sequencing for primary and relapse samples from eight patients (AML1, AML15, AML27, AML28, AML31, AML35, AML40, AML43) [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>]. For AML1, the authors identified mutation clusters with MClust [<xref ref-type="bibr" rid="pcbi.1004416.ref017">17</xref>] and manually constructed a subclonal phylogeny. For the other patients, mutation cluster means were inferred using kernel density estimation. Phylogenetic trees were constructed as in AML1 for four of the patients (AML40, AML27, AML35, AML43).</p>
<p>The authors described two distinct models of clonal evolution to explain relapse. In the first model, the dominant subclone present in the primary leukemia is not eliminated by therapy, but it acquires new mutations and thrives in the relapse. The patient may not have received a sufficiently aggressive treatment or may have harbored resistance mutations. In the second model, the dominant subclone is eliminated by therapy and a minor subclone in the primary acquires new mutations and thrives in the relapse, while some mutations in the primary are absent in the relapse. The mutations that allow the minor subclone to survive may have been present early on or have been acquired during or after chemotherapy, or both [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>].</p>
<p>For patients where the authors had constructed a tree, we compared it to the best tree(s) identified by SCHISM. For the other patients, we considered whether the SCHISM trees were consistent with their suggested clonal evolution models.</p>
<p>For AML1, we used the published variant allele fractions and mutation cluster assignments (Table S5a in [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>]). In each sample, the naive estimator was used to derive cellularity values (<xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref>) for the subset of mutations which were located in diploid or hemizygous region and had coverage of ≥ 50. Hypothesis tests were performed for pairs of mutations and the CPOV matrix was constructed by voting (Methods). SCHISM identified a single maximum fitness tree, which was identical to the authors’ manually generated tree (<xref ref-type="fig" rid="pcbi.1004416.g005">Fig 5A</xref>). For the remaining seven patients, we used the published cluster mean variant allele frequencies (Table S10 in [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>]) and combined them with the authors’ purity estimates to infer cluster mean cellularities (<xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref>:Eq. S4).</p>
<fig id="pcbi.1004416.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004416.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Reconstruction of subclonal phylogenies in AML.</title>
<p>For each patient, two samples were available from primary and relapse cancers. Purple nodes represent mutation clusters present in both primary and relapse samples. Gray nodes are present in primary but not relapse and green nodes are present in the relapse but not primary. <bold>A. AML1.</bold> SCHISM identified a single maximum fitness 5-node tree. CPOV matrix columns and rows represent mutation clusters. Each square represents a pair of mutation clusters (I,J) and the numeric value in the square shows the fraction of mutation pairs (i,j) for which the null hypothesis was rejected (Section Vote Aggregation). <bold>B. AML27,35,40.</bold> For each patient, SCHISM identified a single maximum fitness 2-node tree. <bold>C. AML15.</bold> Two maximum fitness 3-node trees were identified. Solid arrows represent lineage relationships shared by both trees and dashed arrows represent lineage relationships specific to one of the trees. <bold>D. AML28.</bold> A single maximum fitness 5-node tree. <bold>E. AML31.</bold> A single maximum fitness 4-node tree was identified. <bold>F. AML43.</bold> A single maximum fitness 4-node tree. Each arrow is labeled with the fraction of maximum fitness trees that include the lineage relationship. Highlighted arrows indicate the tree manually constructed by the study authors, if it was available. GL = germline state. CL = cluster. Cluster precedence order violation (CPOV) matrices are shown to the left of each tree. Columns and rows represent mutation clusters. Each red square represents a pair of mutation clusters (I,J) for which the null hypothesis that I could be the parent of J was rejected. Each blue square represents a pair for which the null hypothesis could not be rejected.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.g005"/>
</fig>
<p>Patients AML27, AML35, and AML40 were reported to harbor only two mutation clusters each, and SCHISM identified a single maximum fitness tree for each, which was identical to the authors’ tree (<xref ref-type="fig" rid="pcbi.1004416.g005">Fig 5B</xref>). Patient AML15 was reported to harbor three mutation clusters, and SCHISM identified two maximum fitness trees. Each tree supported one of the authors’ two alternative models of AML relapse (<xref ref-type="fig" rid="pcbi.1004416.g005">Fig 5C</xref>). In one tree, the relapse-specific mutation cluster 3 descended from the dominant subclone in the primary. This subclone consisted of the 92% of cells in the primary that carried both cluster 1 and cluster 2 mutations. In the other tree, it descended from the minor subclone in the primary (the 8% of cells in the primary carrying only cluster 1 mutations). Patient AML28 had five mutation clusters, and SCHISM identified a single maximum fitness tree. While no subclone tree for AML28 was constructed by the authors, they proposed that this patient fit the second clonal evolution model of relapse driven by a minor subclone in the primary. The SCHISM tree was consistent with this model, as the relapse-specific mutation cluster 5 descended from a minor subclone (1% of cells), which harbored only mutation cluster 1, and mutation clusters 3 and 4, which were present in the primary were absent in the relapse cluster (<xref ref-type="fig" rid="pcbi.1004416.g005">Fig 5D</xref>). Patient AML31 had four mutation clusters, and SCHISM identified a single maximum fitness tree (<xref ref-type="fig" rid="pcbi.1004416.g005">Fig 5E</xref>). Although no tree was provided by the authors, they proposed that this patient fit the second clonal evolution model, which was consistent with this tree. In the tree, the relapse-specific mutation cluster 4 descended from a minor subclone (21% of cells) in the primary. Cells in this subclone carried mutations in cluster 1, but not clusters 2 and 3. AML43 was reported to have four mutation clusters and SCHISM identified a single maximum fitness tree that was identical to the authors’ tree (<xref ref-type="fig" rid="pcbi.1004416.g005">Fig 5F</xref>).</p>
</sec>
<sec id="sec010">
<title>SCHISM runtime</title>
<p>On a MacBook Pro labptop with Intel Core i7, 4 GB of memory and 2.7 GHz CPU, a GA run with 20 generations modeling three samples and nine mutation clusters completed in 2 minutes.</p>
</sec>
</sec>
</sec>
<sec id="sec011" sec-type="conclusions">
<title>Discussion</title>
<p>Representing tumor evolution as a phylogenetic tree of cell subpopulations can inform critical questions regarding the temporal order of mutations driving tumor progression and the mechanisms of recurrence and metastasis. As the cost of next generation sequencing with high coverage depth decreases, many labs are employing multi-region tumor sequencing strategies to study tumor evolution. However, going from multi-region sequencing data to a subclonal phylogeny is a computationally challenging task and methods are still in their early days. Here we derived a novel framework to approach the problem. We described a statistical hypothesis test and mathematical representation of constraints on subclone phylogenies, based on rules of lineage precedence and divergence that have informed previous works in the field. We designed a new fitness function that can be used to constrain the process of subclone tree reconstruction. These tools comprise a flexible framework called SCHISM, which can be integrated with many existing methods for mutation cellularity estimation and phylogenetic reconstruction. Combined with a new implementation of genetic algorithms, we demonstrated the utility of SCHISM with simulations and by application to published multi-region sequencing studies. We were able to reconstruct the subclonal phylogenies derived by manual curation in these studies with high fidelity.</p>
<p>Today’s multi-region sequencing studies may often have a limited number of tumor samples, due to restrictions on the number of biopsies likely to be performed for living patients. Our results suggest that even when only a few samples are available, more accurate estimates of mutation cellularity at higher purity and coverage increase the power of the SCHISM hypothesis test. A more subtle result is that the power and Type 1 error of the test also depend on the accuracy of the standard error estimates for cellularity values. The dependency can be seen directly in the derivation of the test statistic itself (Methods:<xref ref-type="disp-formula" rid="pcbi.1004416.e049">Eq 13</xref>) and indirectly in the ability of SCHISM to reconstruct complex subclone phylogenies in murine models of SCLC [<xref ref-type="bibr" rid="pcbi.1004416.ref013">13</xref>]. Although only two or three samples were sequenced from each mouse, the authors provided robust statistical estimates of mutation cluster cellularity and standard deviations.</p>
<p>To our knowledge, our study is the first to apply genetic algorithms to the problem of subclone tree reconstruction. Current sequencing technologies limit discovery to approximately 5–10 major subclones in patient tumor samples, equivalent to phylogenetic trees with 5–10 nodes. It is likely that in the near future, improved technology will enable discovery of a larger number of subclones. The number of topologies for a tree with <italic>n</italic> nodes is equal to <italic>n</italic><sup><italic>n</italic>−2</sup> [<xref ref-type="bibr" rid="pcbi.1004416.ref018">18</xref>]. Therefore it becomes increasingly difficult to use exhaustive enumeration over all topologies when <italic>n</italic> = 9 (approximately 4.8 million topologies), <italic>n</italic> = 10 (approximately 100 million topologies), and certainly for <italic>n</italic> &gt; 10. The genetic algorithm presented here enables heuristic searches over very large numbers of topologies and consequent evaluation of candidate phylogenetic trees, according to the extent to which they violated the rules of lineage precedence and divergence. However, the genetic algorithm will not always succeed when <italic>n</italic> is very large, and its success depends on the topology of the true tree and the distribution of mutation cluster cellularities (<xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref>). Alternative heuristic approaches might also prove useful in this setting such as tabu search [<xref ref-type="bibr" rid="pcbi.1004416.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1004416.ref020">20</xref>], simulating annealing [<xref ref-type="bibr" rid="pcbi.1004416.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004416.ref022">22</xref>], or iterated local search [<xref ref-type="bibr" rid="pcbi.1004416.ref023">23</xref>].</p>
<p>Currently, the topology cost component of the fitness function is informed by a statistical hypothesis test that addresses a dichotomous question about the ancestral relationship of two nodes. The mass cost is a numeric measure that quantifies the extent to which the lineage divergence rule is violated, and tree fitness depends on this numeric value, rather than on acceptance or rejection of a null hypothesis. We took into consideration the power loss that would result from a statistical test based on mass cost. Such a test would depend on the estimated cellularities of a parental cluster and the sum of cellularities of its child clusters (Methods:<xref ref-type="disp-formula" rid="pcbi.1004416.e089">Eq 31</xref>). A possible null hypothesis could be that the difference between parental and sum of child cluster cellularities is non-negative (no violation of lineage divergence rule), and where the absolute value of the difference measures the magnitude of the violation. This test would be underpowered compared to the topology cost test, because the expected confidence interval for the sum of mutation cluster cellularity values (<xref ref-type="disp-formula" rid="pcbi.1004416.e009">Eq 2</xref>) will be larger than that for a single mutation cluster. Thus, we chose to focus our hypothesis testing framework on the topology cost. The value of our current strategy to include a numeric measure of mass cost in the fitness function is explored in (<xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004416.s002">S1 Fig</xref>).</p>
<p>The fitness function used in this work could be further improved by incorporating measures of mutation or mutation cluster importance, using knowledge about ordering of specific driver mutations based on tumor biology, synthetic lethality, or results from single-cell sequencing. The genetic algorithm used in this work could itself be improved by the addition of online termination criteria and adaptive modulation of its key parameters, such as crossover and mutation probabilities.</p>
<p>A number of excellent methods to reconstruct subclonal phylogenies have been recently published [<xref ref-type="bibr" rid="pcbi.1004416.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1004416.ref009">9</xref>], and we believe all of them are likely to be useful to the cancer research community. A feature matrix comparing attributes of SCHISM to four other published methods is in <xref ref-type="supplementary-material" rid="pcbi.1004416.s010">S1 Table</xref>. Key contributions of SCHISM are that its genetic algorithm can handle more complex tree topologies than are tractable by brute force while retaining lack of in-built bias towards linear or branched tree topologies, its modularity, and its capability to integrate information from multiple samples (biopsies from a patient) in a new statistical framework.</p>
<p>Finally, it is clear that under many circumstances, particularly when sample count is low and tree complexity is high, the problem of subclone tree reconstruction is underdetermined. It is likely that for at least some tumor types, the true subclone trees may be very complex. In the future, sequencing studies with a large number of samples per patient will be essential to accurately characterize these trees.</p>
</sec>
<sec id="sec012" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec013">
<title>Framework overview</title>
<p>The hypothesis test and genetic algorithm used in this work are components in a general framework that decomposes the problems of mutation cellularity estimation, mutation clustering and subclone tree reconstruction (<xref ref-type="fig" rid="pcbi.1004416.g006">Fig 6</xref>). Given aligned reads from whole-genome, whole-exome or targeted deep next generation sequencing, any method for mutation cellularity estimation and/or clustering can be combined with the hypothesis test described in this section. If cellularities are estimated for a cluster of mutations, the test can be applied directly to temporal ordering of clusters. If cellularities are estimated for specific mutations, the test can be applied to infer temporal ordering of mutation pairs. Given assignments of mutations to clusters, a voting aggregation scheme can be used to order the clusters themselves. The precedence order violation matrix and cluster precedence order violation matrix summarize the output of the hypothesis tests. They can be used to visualize the statistical support for potential temporal orderings (as in Figs <xref ref-type="fig" rid="pcbi.1004416.g003">3</xref>, <xref ref-type="fig" rid="pcbi.1004416.g004">4</xref> and <xref ref-type="fig" rid="pcbi.1004416.g005">5</xref>). Finally, a fitness function that depends on constraints for possible values of cluster cellularities (mass cost) and the results of the hypothesis test (topology cost) can be used to rank possible topologies of subclone phylogenetic trees. The fitness function is independent of the genetic algorithm search strategy proposed in this work.</p>
<fig id="pcbi.1004416.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004416.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Overview of SCHISM framework.</title>
<p>The framework decouples estimation of somatic mutation cellularities and reconstruction of subclone phylogenies. Given somatic mutation read counts from next generation sequencing data and somatic copy number calls if available, any tools for mutation cellularity estimation and mutation clustering can be applied. Their output is used to estimate the statistical support for temporal ordering of mutation or mutation cluster pairs, using a generalized likelihood ratio test (GLRT). Other approaches to tree reconstruction can be applied, by using the fitness function as the objective for optimization. GA = genetic algorithm, WGS = whole genome sequencing, WES = whole exome sequencing, DS = (targeted) deep sequencing. KDE = kernel density estimation. POV = precedence order violation.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.g006"/>
</fig>
</sec>
<sec id="sec014">
<title>Modeling assumptions</title>
<p>According to the infinite sites assumption [<xref ref-type="bibr" rid="pcbi.1004416.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1004416.ref008">8</xref>], each somatic mutation in a tumor arises only once throughout the history of the disease, and once a mutation occurs in a cell it is inherited by all descendants of the cell. It follows that given multiple tumor samples from an individual, a mutation may be present in varying proportions of the tumor cells in each sample, referred to as varying <italic>cellularity</italic> of the mutation across samples.</p>
<p>SCHISM constructs a rooted phylogenetic tree to represent the history of tumor clonal evolution in an individual. Each tree node represents cells harboring a unique compartment of mutations, defining a subclone. Each edge represents a set of mutations, acquired by the cells in the child node and differentiating them from the cells in its parental node. The somatic mutations of each tumor cell then uniquely map it to one of the nodes in the tree.</p>
<p>From the infinite sites assumption, we can infer that each mutation is uniquely assigned to an edge and the cells represented by a node harbor all mutations present in their parental node. Furthermore, a mutation present at a node cannot have cellularity greater than the mutations at its parental node, defining a <italic>lineage precedence rule</italic>. Also, the sum of mutation cellularities occuring in child nodes cannot exceed the mutation cellularity of their parent, because these mutations occur in mutually exclusive cellular populations, defining a <italic>lineage divergence rule</italic>.</p>
<p>Many methods have been proposed to estimate mutation cellularities, and our framework can be used with any of these methods. In our reconstruction of subclone phylogenies from three multi-sample sequencing studies (Results), cellularities were derived using ABSOLUTE and our own naive estimator (<xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref>). Other methods such as PyClone or SciClone could also be applied.</p>
</sec>
<sec id="sec015">
<title>Hypothesis test</title>
<sec id="sec016">
<title>Generalized likelihood ratio test</title>
<p>The lineage precedence rule for a pair of mutations <italic>i</italic> and <italic>j</italic>, where <italic>i</italic> precedes <italic>j</italic> in the same lineage implies that
<disp-formula id="pcbi.1004416.e001"><alternatives><graphic id="pcbi.1004416.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mi>i</mml:mi> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mi>j</mml:mi> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
for <italic>s</italic> in {1, …, <italic>S</italic>}, where <inline-formula id="pcbi.1004416.e002"><alternatives><graphic id="pcbi.1004416.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e002"/><mml:math id="M2" display="inline" overflow="scroll"><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004416.e003"><alternatives><graphic id="pcbi.1004416.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e003"/><mml:math id="M3" display="inline" overflow="scroll"><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> represent the cellularity of mutations <italic>i</italic> and <italic>j</italic> in sample <italic>s</italic> and <italic>S</italic> denotes the total number of samples from an individual. Then, for each ordered pair of mutations <italic>i</italic> and <italic>j</italic>, the null hypothesis (<inline-formula id="pcbi.1004416.e004"><alternatives><graphic id="pcbi.1004416.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e004"/><mml:math id="M4" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) to be tested is whether mutation <italic>i</italic> <italic>can be</italic> an ancestor of mutation <italic>j</italic>, and the alternative hypothesis (<inline-formula id="pcbi.1004416.e005"><alternatives><graphic id="pcbi.1004416.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e005"/><mml:math id="M5" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>A</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) is that it is not possible for <italic>i</italic> to be ancestral to <italic>j</italic>. Let the estimated cellularity for mutation <italic>i</italic> in sample <italic>s</italic> be (<inline-formula id="pcbi.1004416.e006"><alternatives><graphic id="pcbi.1004416.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e006"/><mml:math id="M6" display="inline" overflow="scroll"><mml:mover accent="true"><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>). It can be represented as a draw from a normal distribution centered at the true cellularity of mutation <italic>i</italic> in sample <italic>s</italic> (<inline-formula id="pcbi.1004416.e007"><alternatives><graphic id="pcbi.1004416.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e007"/><mml:math id="M7" display="inline" overflow="scroll"><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>) and with standard deviation <inline-formula id="pcbi.1004416.e008"><alternatives><graphic id="pcbi.1004416.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e008"/><mml:math id="M8" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>.
<disp-formula id="pcbi.1004416.e009"><alternatives><graphic id="pcbi.1004416.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
Assuming independence between the cellularity estimates for mutations <italic>i</italic> and <italic>j</italic>
<disp-formula id="pcbi.1004416.e010"><alternatives><graphic id="pcbi.1004416.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
<disp-formula id="pcbi.1004416.e011"><alternatives><graphic id="pcbi.1004416.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
<disp-formula id="pcbi.1004416.e012"><alternatives><graphic id="pcbi.1004416.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e012"/><mml:math id="M12" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where <inline-formula id="pcbi.1004416.e013"><alternatives><graphic id="pcbi.1004416.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e013"/><mml:math id="M13" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> represents the true difference in cellularity of mutations <italic>i</italic>, and <italic>j</italic> in sample <italic>s</italic>, and <inline-formula id="pcbi.1004416.e014"><alternatives><graphic id="pcbi.1004416.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e014"/><mml:math id="M14" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the standard deviation of <inline-formula id="pcbi.1004416.e015"><alternatives><graphic id="pcbi.1004416.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e015"/><mml:math id="M15" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, the observed difference in cellularity of mutations <italic>i</italic> and <italic>j</italic> in sample <italic>s</italic>. Under <inline-formula id="pcbi.1004416.e016"><alternatives><graphic id="pcbi.1004416.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e016"/><mml:math id="M16" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, the cellularity of mutation <italic>i</italic> should exceed or be equal to that of mutation <italic>j</italic> in all tumor samples, based on the lineage precedence rule. Thus,
<disp-formula id="pcbi.1004416.e017"><alternatives><graphic id="pcbi.1004416.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e017"/><mml:math id="M17" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mo>∀</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
Under the alternative hypothesis (<inline-formula id="pcbi.1004416.e018"><alternatives><graphic id="pcbi.1004416.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e018"/><mml:math id="M18" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>A</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>), mutation <italic>i</italic> cannot be an ancestor to mutation <italic>j</italic>, and it is supported by the existence of samples in which the lineage precedence rule does not hold, and for which
<disp-formula id="pcbi.1004416.e019"><alternatives><graphic id="pcbi.1004416.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e019"/><mml:math id="M19" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mo>∃</mml:mo> <mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>For a pair of mutations <italic>i</italic> and <italic>j</italic> and observations <inline-formula id="pcbi.1004416.e020"><alternatives><graphic id="pcbi.1004416.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e020"/><mml:math id="M20" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> across <italic>S</italic> tumor samples, <inline-formula id="pcbi.1004416.e021"><alternatives><graphic id="pcbi.1004416.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e021"/><mml:math id="M21" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> can be tested with a generalized likelihood ratio test (<italic>GLRT</italic>).
<disp-formula id="pcbi.1004416.e022"><alternatives><graphic id="pcbi.1004416.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e022"/><mml:math id="M22" display="block" overflow="scroll"><mml:mrow><mml:mo>Λ</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mi>i</mml:mi> <mml:mi>k</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo movablelimits="true" form="prefix">max</mml:mo> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mi>i</mml:mi> <mml:mi>k</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>∪</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mi>A</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
The numerator represents the maximum likelihood for observations <inline-formula id="pcbi.1004416.e023"><alternatives><graphic id="pcbi.1004416.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e023"/><mml:math id="M23" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> when <inline-formula id="pcbi.1004416.e024"><alternatives><graphic id="pcbi.1004416.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e024"/><mml:math id="M24" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> in <italic>ω</italic><sub>0</sub>, the parameter space corresponding to <inline-formula id="pcbi.1004416.e025"><alternatives><graphic id="pcbi.1004416.e025g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e025"/><mml:math id="M25" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1004416.e017">Eq 6</xref>). The denominator represents the maximum likelihood for observations <inline-formula id="pcbi.1004416.e026"><alternatives><graphic id="pcbi.1004416.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e026"/><mml:math id="M26" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> where <italic>d</italic><sub><italic>ij</italic></sub> is in the union of the parameter spaces for <inline-formula id="pcbi.1004416.e027"><alternatives><graphic id="pcbi.1004416.e027g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e027"/><mml:math id="M27" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004416.e028"><alternatives><graphic id="pcbi.1004416.e028g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e028"/><mml:math id="M28" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>A</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>, which implies there is no restriction on the values of <inline-formula id="pcbi.1004416.e029"><alternatives><graphic id="pcbi.1004416.e029g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e029"/><mml:math id="M29" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
<p>Given the assumption of independence between <inline-formula id="pcbi.1004416.e030"><alternatives><graphic id="pcbi.1004416.e030g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e030"/><mml:math id="M30" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> across samples and considering parameter spaces defined by <inline-formula id="pcbi.1004416.e031"><alternatives><graphic id="pcbi.1004416.e031g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e031"/><mml:math id="M31" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1004416.e017">Eq 6</xref>) and <inline-formula id="pcbi.1004416.e032"><alternatives><graphic id="pcbi.1004416.e032g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e032"/><mml:math id="M32" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>A</mml:mi></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1004416.e019">Eq 7</xref>), <xref ref-type="disp-formula" rid="pcbi.1004416.e022">Eq 8</xref> can be simplified as
<disp-formula id="pcbi.1004416.e033"><alternatives><graphic id="pcbi.1004416.e033g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e033"/><mml:math id="M33" display="block" overflow="scroll"><mml:mrow><mml:mo>Λ</mml:mo> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munderover> <mml:mfrac><mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mi>i</mml:mi> <mml:mi>k</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>+</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mi>i</mml:mi> <mml:mi>k</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>,</mml:mo> <mml:mo>+</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
Using the normality assumption (<xref ref-type="disp-formula" rid="pcbi.1004416.e011">Eq 4</xref>), <xref ref-type="disp-formula" rid="pcbi.1004416.e033">Eq 9</xref> is rewritten as
<disp-formula id="pcbi.1004416.e034"><alternatives><graphic id="pcbi.1004416.e034g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e034"/><mml:math id="M34" display="block" overflow="scroll"><mml:mrow><mml:mo>Λ</mml:mo> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munderover> <mml:mfrac><mml:mrow><mml:munder><mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>+</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:munder><mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>,</mml:mo> <mml:mo>+</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup> <mml:mo>]</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula>
To derive the Λ, each <inline-formula id="pcbi.1004416.e035"><alternatives><graphic id="pcbi.1004416.e035g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e035"/><mml:math id="M35" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is replaced by its single sample maximum likelihood estimator under <inline-formula id="pcbi.1004416.e036"><alternatives><graphic id="pcbi.1004416.e036g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e036"/><mml:math id="M36" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> in the numerator. If <inline-formula id="pcbi.1004416.e037"><alternatives><graphic id="pcbi.1004416.e037g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e037"/><mml:math id="M37" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, the value of <inline-formula id="pcbi.1004416.e038"><alternatives><graphic id="pcbi.1004416.e038g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e038"/><mml:math id="M38" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> that maximizes the numerator is equal to <inline-formula id="pcbi.1004416.e039"><alternatives><graphic id="pcbi.1004416.e039g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e039"/><mml:math id="M39" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. On the other hand, for <inline-formula id="pcbi.1004416.e040"><alternatives><graphic id="pcbi.1004416.e040g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e040"/><mml:math id="M40" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, the value of <inline-formula id="pcbi.1004416.e041"><alternatives><graphic id="pcbi.1004416.e041g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e041"/><mml:math id="M41" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> that maximizes the numerator is 0, since negative values of <inline-formula id="pcbi.1004416.e042"><alternatives><graphic id="pcbi.1004416.e042g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e042"/><mml:math id="M42" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are not allowed under <inline-formula id="pcbi.1004416.e043"><alternatives><graphic id="pcbi.1004416.e043g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e043"/><mml:math id="M43" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. In the denominator, since the value of <inline-formula id="pcbi.1004416.e044"><alternatives><graphic id="pcbi.1004416.e044g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e044"/><mml:math id="M44" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is a non-restricted parameter, its maximum likelihood estimator is always equal to <inline-formula id="pcbi.1004416.e045"><alternatives><graphic id="pcbi.1004416.e045g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e045"/><mml:math id="M45" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. Thus <xref ref-type="disp-formula" rid="pcbi.1004416.e034">Eq 10</xref> can be rewritten as
<disp-formula id="pcbi.1004416.e046"><alternatives><graphic id="pcbi.1004416.e046g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e046"/><mml:math id="M46" display="block" overflow="scroll"><mml:mrow><mml:mo>Λ</mml:mo> <mml:mo>=</mml:mo> <mml:munder><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munderover> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>·</mml:mo> <mml:munder><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munderover> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
which simplifies to
<disp-formula id="pcbi.1004416.e047"><alternatives><graphic id="pcbi.1004416.e047g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e047"/><mml:math id="M47" display="block" overflow="scroll"><mml:mrow><mml:mo>Λ</mml:mo> <mml:mo>=</mml:mo> <mml:munder><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munderover> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
Therefore, we reject the null hypothesis that mutation <italic>i</italic> could be an ancestor of mutation <italic>j</italic> (<inline-formula id="pcbi.1004416.e048"><alternatives><graphic id="pcbi.1004416.e048g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e048"/><mml:math id="M48" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>) if the test statistic <italic>T</italic> is significantly large.
<disp-formula id="pcbi.1004416.e049"><alternatives><graphic id="pcbi.1004416.e049g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e049"/><mml:math id="M49" display="block" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mo form="prefix">log</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mo>Λ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munderover> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>·</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
where <italic>I</italic> is a binary indicator variable. <xref ref-type="disp-formula" rid="pcbi.1004416.e049">Eq 13</xref> explicitly shows how <italic>T</italic> depends on the accuracy of cellularity values and their standard deviation. When standard deviation is overestimated, <italic>T</italic> is underestimated, yielding power loss. When standard deviation is underestimated, <italic>T</italic> is overestimated, yielding Type 1 error inflation.</p>
<p>Since the standard deviation is unknown, standard error was used to calculate the test statistic.</p>
</sec>
<sec id="sec017">
<title>Significance evaluation</title>
<p>To assess the significance of an observed value of the <italic>GLRT</italic> test statistic (<italic>T</italic>) (<xref ref-type="disp-formula" rid="pcbi.1004416.e049">Eq 13</xref>), we consider the distribution of <italic>T</italic> under <inline-formula id="pcbi.1004416.e050"><alternatives><graphic id="pcbi.1004416.e050g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e050"/><mml:math id="M50" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and derive the Type 1 error probability of the test. Similar results have previously been derived for a more general class of GLRTs [<xref ref-type="bibr" rid="pcbi.1004416.ref024">24</xref>]. The distribution of each summation term in <xref ref-type="disp-formula" rid="pcbi.1004416.e049">Eq 13</xref> (<inline-formula id="pcbi.1004416.e051"><alternatives><graphic id="pcbi.1004416.e051g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e051"/><mml:math id="M51" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="1pt"/><mml:mo>⋅</mml:mo> <mml:mspace width="1pt"/><mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) depends on the true value of <inline-formula id="pcbi.1004416.e052"><alternatives><graphic id="pcbi.1004416.e052g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e052"/><mml:math id="M52" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="disp-formula" rid="pcbi.1004416.e011">Eq 4</xref>). Given a fixed value of <inline-formula id="pcbi.1004416.e053"><alternatives><graphic id="pcbi.1004416.e053g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e053"/><mml:math id="M53" display="inline" overflow="scroll"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, large positive values of <inline-formula id="pcbi.1004416.e054"><alternatives><graphic id="pcbi.1004416.e054g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e054"/><mml:math id="M54" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> make observation of negative <inline-formula id="pcbi.1004416.e055"><alternatives><graphic id="pcbi.1004416.e055g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e055"/><mml:math id="M55" display="inline" overflow="scroll"><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and thus a corresponding non-zero term in the summation less likely. Therefore,
<disp-formula id="pcbi.1004416.e056"><alternatives><graphic id="pcbi.1004416.e056g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e056"/><mml:math id="M56" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mi>P</mml:mi> <mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>·</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mi>C</mml:mi> <mml:mo>)</mml:mo> <mml:mo>≤</mml:mo> <mml:munder><mml:mi>P</mml:mi> <mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>·</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mi>C</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
By extending the above argument to every term in the summation, we derive an upper bound for the probability of test statistic <italic>T</italic> exceeding a critical value <italic>C</italic> under the null hypothesis <inline-formula id="pcbi.1004416.e057"><alternatives><graphic id="pcbi.1004416.e057g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e057"/><mml:math id="M57" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>.
<disp-formula id="pcbi.1004416.e058"><alternatives><graphic id="pcbi.1004416.e058g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e058"/><mml:math id="M58" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mi>P</mml:mi> <mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:mo stretchy="false">[</mml:mo> <mml:mi>T</mml:mi> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo stretchy="false">]</mml:mo> <mml:mo>=</mml:mo> <mml:munder><mml:mi>P</mml:mi> <mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:mo stretchy="false">[</mml:mo> <mml:mi>T</mml:mi> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo stretchy="false">]</mml:mo> <mml:mo>≤</mml:mo> <mml:munder><mml:mi>P</mml:mi> <mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:mo stretchy="false">[</mml:mo> <mml:mi>T</mml:mi> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula>
Therefore, to control the Type 1 error probability of the test, it is sufficient to control Type 1 error probability of a test where the null hypothesis is reduced to <inline-formula id="pcbi.1004416.e059"><alternatives><graphic id="pcbi.1004416.e059g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e059"/><mml:math id="M59" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (<italic>reduced null hypothesis</italic>). Under the reduced null hypothesis we can derive the exact distribution of the test statistic <italic>T</italic> as follows. Let <inline-formula id="pcbi.1004416.e060"><alternatives><graphic id="pcbi.1004416.e060g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e060"/><mml:math id="M60" display="inline" overflow="scroll"><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> denote <inline-formula id="pcbi.1004416.e061"><alternatives><graphic id="pcbi.1004416.e061g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e061"/><mml:math id="M61" display="inline" overflow="scroll"><mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac></mml:math></alternatives></inline-formula>.
<disp-formula id="pcbi.1004416.e062"><alternatives><graphic id="pcbi.1004416.e062g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e062"/><mml:math id="M62" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:munderover> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mfrac><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mfrac> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>·</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:munderover> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>·</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula></p>
<p>Next, let <italic>δ</italic><sub><italic>V</italic></sub> be a binary random variable representing the event when, for a particular subset <italic>V</italic> of {1, …, <italic>S</italic>}, we have <inline-formula id="pcbi.1004416.e063"><alternatives><graphic id="pcbi.1004416.e063g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e063"/><mml:math id="M63" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for <italic>s</italic> ∈ <italic>V</italic> and <inline-formula id="pcbi.1004416.e064"><alternatives><graphic id="pcbi.1004416.e064g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e064"/><mml:math id="M64" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for <italic>s</italic> ∉ <italic>V</italic>. By the law of total probability,
<disp-formula id="pcbi.1004416.e065"><alternatives><graphic id="pcbi.1004416.e065g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e065"/><mml:math id="M65" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:munderover> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>·</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>V</mml:mi> <mml:mo>⊂</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:munderover> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>·</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
or equivalently,
<disp-formula id="pcbi.1004416.e066"><alternatives><graphic id="pcbi.1004416.e066g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e066"/><mml:math id="M66" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:munderover> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>·</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>V</mml:mi> <mml:mo>⊂</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>V</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
But the reduced null hypothesis (<xref ref-type="disp-formula" rid="pcbi.1004416.e058">Eq 15</xref>) states that all <inline-formula id="pcbi.1004416.e067"><alternatives><graphic id="pcbi.1004416.e067g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e067"/><mml:math id="M67" display="inline" overflow="scroll"><mml:msubsup><mml:mi>d</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1004416.e011">Eq 4</xref> are set to zero, so
<disp-formula id="pcbi.1004416.e068"><alternatives><graphic id="pcbi.1004416.e068g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e068"/><mml:math id="M68" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
or equivalently,
<disp-formula id="pcbi.1004416.e069"><alternatives><graphic id="pcbi.1004416.e069g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e069"/><mml:math id="M69" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula>
Also, for a set of independent identically distributed random draws from <italic>N</italic>(0, 1), the value of the summation in <xref ref-type="disp-formula" rid="pcbi.1004416.e066">Eq 18</xref> is independent of the signs of <inline-formula id="pcbi.1004416.e070"><alternatives><graphic id="pcbi.1004416.e070g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e070"/><mml:math id="M70" display="inline" overflow="scroll"><mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and is a <italic>χ</italic><sup>2</sup> random variable with ∣<italic>V</italic>∣ degrees of freedom.
<disp-formula id="pcbi.1004416.e071"><alternatives><graphic id="pcbi.1004416.e071g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e071"/><mml:math id="M71" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>V</mml:mi><mml:mspace width="1pt"/><mml:mo>⊂</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>V</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>V</mml:mi><mml:mspace width="1pt"/><mml:mo>⊂</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>V</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:msup><mml:mspace width="4.pt"/><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo> <mml:mspace width="1pt"/><mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula>
<disp-formula id="pcbi.1004416.e072"><alternatives><graphic id="pcbi.1004416.e072g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e072"/><mml:math id="M72" display="block" overflow="scroll"><mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>V</mml:mi><mml:mspace width="1pt"/><mml:mo>⊂</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>χ</mml:mi> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>V</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo> <mml:mspace width="1pt"/><mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></alternatives> <label>(22)</label></disp-formula> <xref ref-type="disp-formula" rid="pcbi.1004416.e069">Eq 20</xref> implies that each random variable <inline-formula id="pcbi.1004416.e073"><alternatives><graphic id="pcbi.1004416.e073g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e073"/><mml:math id="M73" display="inline" overflow="scroll"><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> assumes positive and negative signs with equal probability. Thus, the probability of observing a particular sequence of signs for random variables <inline-formula id="pcbi.1004416.e074"><alternatives><graphic id="pcbi.1004416.e074g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e074"/><mml:math id="M74" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, i.e. the probability of each <italic>δ</italic><sub><italic>V</italic></sub> being true, is <inline-formula id="pcbi.1004416.e075"><alternatives><graphic id="pcbi.1004416.e075g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e075"/><mml:math id="M75" display="inline" overflow="scroll"><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi></mml:msup></mml:math></alternatives></inline-formula>.
<disp-formula id="pcbi.1004416.e076"><alternatives><graphic id="pcbi.1004416.e076g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e076"/><mml:math id="M76" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>V</mml:mi><mml:mspace width="1pt"/><mml:mo>⊂</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>χ</mml:mi> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>V</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo> <mml:mspace width="1pt"/><mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>V</mml:mi></mml:msub> <mml:mo stretchy="false">]</mml:mo> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>V</mml:mi><mml:mspace width="1pt"/><mml:mo>⊂</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>χ</mml:mi> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>V</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo> <mml:mspace width="1pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi></mml:msup></mml:mrow></mml:math></alternatives> <label>(23)</label></disp-formula>
Finally, summarizing the sum above over all possible values ∣<italic>V</italic>∣ can take,
<disp-formula id="pcbi.1004416.e077"><alternatives><graphic id="pcbi.1004416.e077g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e077"/><mml:math id="M77" display="block" overflow="scroll"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>V</mml:mi><mml:mspace width="1pt"/><mml:mo>⊂</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>χ</mml:mi> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>V</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi> <mml:mo>]</mml:mo> <mml:mspace width="1pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>S</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:munder><mml:mi>S</mml:mi> <mml:mi>k</mml:mi></mml:munder></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mn>2</mml:mn> <mml:mi>S</mml:mi></mml:msup></mml:mrow></mml:mfrac> <mml:mi>P</mml:mi> <mml:mspace width="1pt"/><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msubsup><mml:mi>χ</mml:mi> <mml:mi>k</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>≥</mml:mo> <mml:mi>C</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(24)</label></disp-formula>
Thus it can be concluded that the distribution of <italic>GLRT</italic> test statistic <italic>T</italic> under the reduced null hypothesis is that of a random variable drawn from a mixture of <italic>χ</italic><sup>2</sup> distributions, with degrees of freedom varying in <italic>k</italic> ∈ {0, …, <italic>S</italic>}, and the weight of each mixture component equal to <inline-formula id="pcbi.1004416.e078"><alternatives><graphic id="pcbi.1004416.e078g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e078"/><mml:math id="M78" display="inline" overflow="scroll"><mml:mfrac><mml:mrow><mml:mo>(</mml:mo> <mml:munder><mml:mi>S</mml:mi> <mml:mi>k</mml:mi></mml:munder> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mn>2</mml:mn> <mml:mi>S</mml:mi></mml:msup></mml:mfrac></mml:math></alternatives></inline-formula>. Here, a <inline-formula id="pcbi.1004416.e079"><alternatives><graphic id="pcbi.1004416.e079g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e079"/><mml:math id="M79" display="inline" overflow="scroll"><mml:msubsup><mml:mi>χ</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> random variable is defined as one that is fixed at zero. We use this derivation to assign a conservative estimate of significance level to an observed value of the test statistic <italic>T</italic> under (<inline-formula id="pcbi.1004416.e080"><alternatives><graphic id="pcbi.1004416.e080g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e080"/><mml:math id="M80" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>).</p>
</sec>
<sec id="sec018">
<title>Precedence order violation matrix</title>
<p>For each possible ordered pair of mutations (<italic>i</italic>, <italic>j</italic>) characterized in a set of tumor samples from the same individual, we test the hypothesis that mutation <italic>i</italic> is a potential ancestor of mutation <italic>j</italic>. A fixed common significance level of <italic>α</italic> = 0.05 is assigned to decide the outcome of each pairwise test. These results can then be organized as a binary <italic>Precedence Order Violation</italic> (<italic>POV</italic>) matrix, where non-zero entries mark mutation pairs (<italic>i</italic>, <italic>j</italic>) for which the null hypothesis <inline-formula id="pcbi.1004416.e081"><alternatives><graphic id="pcbi.1004416.e081g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e081"/><mml:math id="M81" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>→</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> was rejected.</p>
</sec>
<sec id="sec019">
<title>Application to mutation clusters</title>
<p>Given a mapping of individual mutations onto clusters, the hypothesis test can be applied to pairs of clusters rather than to pairs of mutations, and in this case is used to generate a straightforward extension of the POV matrix <italic>Cluster Precedence Order Violation</italic> (<italic>CPOV</italic> matrix) where non-zero entries mark mutation cluster pairs (<italic>I</italic>, <italic>J</italic>) for which the null hypothesis <inline-formula id="pcbi.1004416.e082"><alternatives><graphic id="pcbi.1004416.e082g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e082"/><mml:math id="M82" display="inline" overflow="scroll"><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mi>I</mml:mi> <mml:mo>→</mml:mo> <mml:mi>J</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> was rejected. An alternate approach for generating a CPOV matrix by vote aggregation is described next.</p>
</sec>
</sec>
<sec id="sec020">
<title>Vote aggregation</title>
<p>The Cluster Precedence Order Violation (CPOV) matrix can be generated by the following vote aggregation approach. Let the set of mutations assigned to cluster <italic>I</italic> be <italic>M</italic>(<italic>I</italic>). Rows and columns of the POV matrix can be reordered so that mutations belonging to the same cluster are adjacent. Then the ordered interaction of any pair of clusters (<italic>I</italic>, <italic>J</italic>) is represented by a block of matrix entries with addresses
<disp-formula id="pcbi.1004416.e083"><alternatives><graphic id="pcbi.1004416.e083g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e083"/><mml:math id="M83" display="block" overflow="scroll"><mml:munder><mml:mrow><mml:mi>P</mml:mi> <mml:mi>O</mml:mi> <mml:mi>V</mml:mi> <mml:mspace width="1pt"/><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>M</mml:mi> <mml:mo>(</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mo>∀</mml:mo> <mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>M</mml:mi> <mml:mo>(</mml:mo> <mml:mi>J</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder></mml:math></alternatives> <label>(25)</label></disp-formula>
The support for potential lineage precedence of cluster <italic>I</italic> to cluster <italic>J</italic> can be summarized by a vote of the matrix elements within the block, represented as an element (<italic>I</italic>, <italic>J</italic>) in a cluster-level POV matrix <italic>CPOV</italic>
<disp-formula id="pcbi.1004416.e084"><alternatives><graphic id="pcbi.1004416.e084g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e084"/><mml:math id="M84" display="block" overflow="scroll"><mml:mrow><mml:mi>C</mml:mi> <mml:mi>P</mml:mi> <mml:mi>O</mml:mi> <mml:mi>V</mml:mi> <mml:mspace width="1pt"/><mml:mrow><mml:mo>[</mml:mo> <mml:mi>I</mml:mi> <mml:mo>,</mml:mo> <mml:mi>J</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mstyle scriptlevel="0" displaystyle="true"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>M</mml:mi> <mml:mo>(</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>M</mml:mi> <mml:mo>(</mml:mo> <mml:mi>J</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mi>O</mml:mi> <mml:mi>V</mml:mi> <mml:mspace width="1pt"/><mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>(</mml:mo> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo> <mml:mo>|</mml:mo> <mml:mo>·</mml:mo> <mml:mo>|</mml:mo> <mml:mi>M</mml:mi> <mml:mo>(</mml:mo> <mml:mi>J</mml:mi> <mml:mo>)</mml:mo> <mml:mo>|</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(26)</label></disp-formula>
where ∣<italic>M</italic>(<italic>X</italic>)∣ denotes the number of mutations in cluster <italic>X</italic>.</p>
</sec>
<sec id="sec021">
<title>Genetic algorithm</title>
<p>A genetic algorithm (GA) is a heuristic search inspired by the process of natural selection. In an initial generation, a set of random objects is created and their fitness with respect to a fitness criteria is evaluated. Next, objects from the initial generation are selected according to their fitness to be parents of the following generation, with a preference for the fittest parents. The parental objects reproduce themselves, and their progeny may harbor new variation. The process is repeated for either a fixed number of generations or until a pre-defined convergence criteria is reached.</p>
<p>In our implementation, the GA searches through a space of phylogenetic tree topologies, ranking them with a fitness function that we derived based on our model assumptions. In the initial generation, we generate <italic>G</italic><sub>0</sub> = 1000 random tree topologies and evaluate the fitness of each tree. A sample of size 0.8 * <italic>G</italic><sub>0</sub> trees are selected for reproduction by a fitness proportional selection method [<xref ref-type="bibr" rid="pcbi.1004416.ref025">25</xref>] and their progeny are generated, using crossover and mutation operations (Figs <xref ref-type="fig" rid="pcbi.1004416.g007">7</xref> and <xref ref-type="fig" rid="pcbi.1004416.g008">8</xref>). To increase diversity and avoid too fast convergence to a local optimum, 0.2*<italic>G</italic><sub>0</sub> random tree topologies are also generated. The following generation then consists of a mixture of the progeny of the previous generation(s) and new random trees, and the total number of trees is the same as in the previous generation, so that <italic>G</italic><sub>1</sub> = <italic>G</italic><sub>0</sub>. The process is repeated for a fixed number <italic>γ</italic> = 20 generations. For each generation, the trees selected to be parents are not limited to the previous generation only, but can be selected from any preceding generations. To avoid getting trapped in local optima, four independent runs of the GA are performed, each with 20 generations (1000 trees per generation), and the entire ensemble of trees sampled in the four runs is ranked by tree fitness.</p>
<fig id="pcbi.1004416.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004416.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Crossover operation.</title>
<p>A reproductive crossover operation involving a pair of parental trees is used to generate diversity among toplogies in members of each generation produced by the genetic algorithm.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.g007"/>
</fig>
<fig id="pcbi.1004416.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004416.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Mutation operations.</title>
<p>Two mutation operations are used to increase topological diversity among progeny trees in each generation produced by the genetic algorithm.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.g008"/>
</fig>
<p>In this work, the number of mutation clusters and the cellularity of each mutation cluster in each sample is assumed to be known, and the GA is applied to explore the space of tree topologies with a given node count, including both linear and branched topologies.</p>
<sec id="sec022">
<title>Random topology generation</title>
<p>To generate a random tree topology, a mutation cluster is randomly selected and assigned to the incident edge downstream of the root node. An incident node downstream of the edge is appended. Next, one of the remaining mutation clusters and a non-root node are randomly selected and the cluster is assigned to the incident edge downstream of this node, again appending a new incident node downstream of the edge. The process continues until all mutation clusters in the data have been assigned.</p>
</sec>
<sec id="sec023">
<title>Mutation and crossover operations</title>
<p>The tree topologies selected for sexual reproduction are randomly paired, and each pair undergoes a crossover operation with probability <italic>P</italic><sub><italic>c</italic></sub> to yield two progeny intermediate trees (<xref ref-type="fig" rid="pcbi.1004416.g007">Fig 7</xref>). Next, a mutation operation is applied to each progeny intermediate tree with probability <italic>P</italic><sub><italic>m</italic></sub>. There are two possible mutation operations (<xref ref-type="fig" rid="pcbi.1004416.g008">Fig 8</xref>), and for each tree one is selected with probability <italic>P</italic><sub><italic>s</italic></sub>. The result is a collection of new progeny trees that will appear in the next generation. (Default <italic>P</italic><sub><italic>c</italic></sub> = 0.25 and <italic>P</italic><sub><italic>m</italic></sub> = 0.9 and <italic>P</italic><sub><italic>s</italic></sub> = 0.6.</p>
</sec>
<sec id="sec024">
<title>Fitness function</title>
<p>Tree fitness is evaluated as
<disp-formula id="pcbi.1004416.e085"><alternatives><graphic id="pcbi.1004416.e085g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e085"/><mml:math id="M85" display="block" overflow="scroll"><mml:mrow><mml:mi>Z</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>T</mml:mi> <mml:mi>C</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>M</mml:mi> <mml:mi>C</mml:mi> <mml:mspace width="1pt"/><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula>
where <italic>TC</italic>(<italic>T</italic>) is a <italic>topology cost</italic> that summarizes violations of the lineage precedence rule, and <italic>MC</italic>(<italic>T</italic>) is a <italic>mass cost</italic> that summarizes violations of the lineage divergence rule.</p>
<p>The two components of the fitness function are useful because they represent biological properties of tumor evolution and practically, their combination can identify the true tree in cases where the topology cost or mass cost alone is insufficient (<xref ref-type="supplementary-material" rid="pcbi.1004416.s002">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004416.s003">S2</xref> Figs).</p>
<p>The <italic>topology cost</italic> (<italic>TC</italic>) of tree <italic>T</italic> is
<disp-formula id="pcbi.1004416.e086"><alternatives><graphic id="pcbi.1004416.e086g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e086"/><mml:math id="M86" display="block" overflow="scroll"><mml:mrow><mml:mi>T</mml:mi> <mml:mi>C</mml:mi> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>I</mml:mi> <mml:mo>,</mml:mo> <mml:mi>J</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>E</mml:mi> <mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mo>→</mml:mo> <mml:mi>J</mml:mi></mml:mrow></mml:munder> <mml:mi>t</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>I</mml:mi> <mml:mo>,</mml:mo> <mml:mi>J</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(28)</label></disp-formula>
where <italic>tc</italic>(<italic>I</italic>, <italic>J</italic>) is the topology cost of each (<italic>ancestor</italic> → <italic>descendant</italic>) edge pair, equivalent to <italic>CPOV</italic>[<italic>I</italic>, <italic>J</italic>] (<xref ref-type="disp-formula" rid="pcbi.1004416.e084">Eq 26</xref>) and <italic>E</italic>(<italic>T</italic>) represents the set of edges in tree <italic>T</italic>.</p>
<p>The <italic>mass cost</italic> (<italic>MC</italic>) of tree <italic>T</italic> is
<disp-formula id="pcbi.1004416.e087"><alternatives><graphic id="pcbi.1004416.e087g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e087"/><mml:math id="M87" display="block" overflow="scroll"><mml:mrow><mml:mi>M</mml:mi> <mml:mi>C</mml:mi> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mi>m</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(29)</label></disp-formula>
where <italic>mc</italic>(<italic>n</italic>), the total mass cost for node <italic>n</italic>, is the Euclidean norm of the vector of node mass costs across samples
<disp-formula id="pcbi.1004416.e088"><alternatives><graphic id="pcbi.1004416.e088g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e088"/><mml:math id="M88" display="block" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mi>S</mml:mi></mml:mrow></mml:munderover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:msup><mml:mi>c</mml:mi> <mml:mi>s</mml:mi></mml:msup> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives> <label>(30)</label></disp-formula>
and <italic>mc</italic><sup><italic>s</italic></sup>(<italic>n</italic>) is the mass cost for node <italic>n</italic> in sample <italic>s</italic>
<disp-formula id="pcbi.1004416.e089"><alternatives><graphic id="pcbi.1004416.e089g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e089"/><mml:math id="M89" display="block" overflow="scroll"><mml:mrow><mml:mi>m</mml:mi> <mml:msup><mml:mi>c</mml:mi> <mml:mi>s</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>≥</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>q</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>q</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>q</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:math></alternatives> <label>(31)</label></disp-formula>
where <inline-formula id="pcbi.1004416.e090"><alternatives><graphic id="pcbi.1004416.e090g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e090"/><mml:math id="M90" display="inline" overflow="scroll"><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the cellularity of the mutation cluster associated with the upstream edge incident to node <italic>n</italic>, <italic>i.e</italic>., <italic>p</italic>(<italic>n</italic>) in sample <italic>s</italic>, and <inline-formula id="pcbi.1004416.e091"><alternatives><graphic id="pcbi.1004416.e091g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e091"/><mml:math id="M91" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>q</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the sum of cellularities of mutation clusters associated with its set of immediate <italic>descendant edges</italic> <italic>D</italic>(<italic>n</italic>). The fitness <italic>F</italic> of the tree <italic>T</italic> is then a monotonically decreasing function of the tree cost <italic>Z</italic>(<italic>T</italic>).
<disp-formula id="pcbi.1004416.e092"><alternatives><graphic id="pcbi.1004416.e092g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e092"/><mml:math id="M92" display="block" overflow="scroll"><mml:mrow><mml:mi>F</mml:mi> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:mi>Z</mml:mi> <mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(32)</label></disp-formula>
where <italic>f</italic><sub><italic>c</italic></sub> is a positive-valued scaling coefficient (default <italic>f</italic><sub><italic>c</italic></sub> = 5), yielding fitness reduction by a factor of ∼ 150<monospace>X</monospace> for each unit increase in total cost.</p>
</sec>
</sec>
<sec id="sec025">
<title>Simulations</title>
<p>The simulations were designed to generate data compatible with a set of likely tree topologies and assess how well SCHISM could recover these topologies from the data. Given a tree topology, a simulation produces a set of tumor samples consistent with lineage relationships summarized in the tree. We assume that while the samples share these lineage relationships, each represents an independent instantiation of cellularity distributions over the edges of the tree. The variability among these simulated samples captures the stochastic process of preferential sampling of tumor cells in an individual’s multiple tumor samples. In each simulated sample, we model variant and reference read counts for mutations belonging to each edge in the tree, taking into account sequencing coverage depth, sample purity level and mutation cluster cellularity.</p>
<sec id="sec026">
<title>Generating subclonal phylogenies</title>
<p>Simulated trees range in size from three to eight nodes, with no restrictions on the number of child nodes. For trees with three to five nodes, an exhaustive set of topologies is generated. Otherwise, ten topologies are selected (<xref ref-type="supplementary-material" rid="pcbi.1004416.s004">S3 Fig</xref>). Each unique topology at a given node count is considered an <italic>instance</italic>. A Poisson process with rate parameter <italic>λ</italic> = 10 is used to simulate the number of mutations that occurred along each each edge in the tree. Node count does not include the root node, which represents the germline state prior to any somatic mutations.</p>
<p>A detailed description of how mutation cellularities and mutation variant allele fractions are generated in the simulations is presented in <xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref>.</p>
</sec>
</sec>
<sec id="sec027">
<title>Subclone size estimation</title>
<p>Based on our modeling assumptions, it is straightforward to conclude that in each sample <italic>s</italic>, the fraction of tumor cells belonging to the subclone described by node <italic>n</italic> in a tree can be calculated as
<disp-formula id="pcbi.1004416.e093"><alternatives><graphic id="pcbi.1004416.e093g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e093"/><mml:math id="M93" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>q</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives> <label>(33)</label></disp-formula>
where <inline-formula id="pcbi.1004416.e094"><alternatives><graphic id="pcbi.1004416.e094g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e094"/><mml:math id="M94" display="inline" overflow="scroll"><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the cellularity of the mutation cluster associated with the upstream edge incident to node <italic>n</italic>, <italic>i.e</italic>., <italic>p</italic>(<italic>n</italic>) in sample <italic>s</italic>, and <inline-formula id="pcbi.1004416.e095"><alternatives><graphic id="pcbi.1004416.e095g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004416.e095"/><mml:math id="M95" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>D</mml:mi> <mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>q</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the sum of cellularities of mutation clusters associated with its set of immediate <italic>descendant edges</italic> <italic>D</italic>(<italic>n</italic>).</p>
</sec>
<sec id="sec028">
<title>Assessment of hypothesis test</title>
<p>Each element of the precedence order violation matrix <italic>POV</italic>[<italic>I</italic>, <italic>J</italic>] is a binary indicator of whether the null hypothesis that mutation <italic>i</italic> can be ancestral to mutation <italic>j</italic> is rejected. Each element in the POV matrix is compared with its true value, given the correct tree topology. Performance is summarized by power and Type 1 error.</p>
</sec>
<sec id="sec029">
<title>Assessment of automated subclone tree reconstruction</title>
<p>The ability of the genetic algorithm to identify the correctly reconstructed subclone tree is assessed across multiple settings of key variables: tumor purity (0.5, 0.9), sequencing coverage depth (150X,1000X), tree node count (3–8), and tumor sample count (1–10). For each node count, multiple tree instances (alternate topologies for a given node count) are considered (<xref ref-type="supplementary-material" rid="pcbi.1004416.s004">S3 Fig</xref>). Then for each combination of settings, ten different replicates are run (<xref ref-type="supplementary-material" rid="pcbi.1004416.s005">S4 Fig</xref>). Each replicate can be viewed as an <italic>in silico</italic> patient having the selected number of samples and a distinct cellularity profile across the samples.</p>
<sec id="sec030">
<title>Number of maximum fitness trees identified by the genetic algorithm</title>
<p>In underdetermined cases, ranking of trees generated by the GA for a replicate may result in ties. We conservatively define a <italic>Stage 1 success</italic> for a replicate as an outcome where only one or two maximum fitness trees have been identified. To estimate the probability of Stage 1 success, the frequency of success of all tree instances and their replicates for each of 240 (2x2x6x10) unique settings of the key variables is computed. In practice, multiple maximum fitness trees can be a useful result, but limiting the number of ties in this way makes the assessment of the simulations more tractable. Note that <italic>Stage 1 success</italic> is only an indicator that the phylogeny reconstruction data is sufficiently determined to identify a good solution.</p>
</sec>
<sec id="sec031">
<title>Agreement of maximum fitness tree(s) with the true tree</title>
<p>Even in the absence of ties, the maximum fitness tree discovered by the GA may not be the true tree that was used as the basis for the simulation. For this assessment, <italic>Stage 2 success</italic> for a replicate is an outcome where either a single maximum fitness or top two maximum fitness trees are the true tree. To assess Stage 2 success, we eliminate replicates where Stage 1 failed and of those remaining, calculate the fraction in which the true tree is either the maximum fitness or one of two maximally fit trees.</p>
</sec>
<sec id="sec032">
<title>Software availability</title>
<p>SCHISM software is available for download at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://karchinlab.org/apps/appSchism.html">http://karchinlab.org/apps/appSchism.html</ext-link></p>
</sec>
</sec>
</sec>
<sec id="sec033">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004416.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary Methods and Results.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s002" mimetype="image/tiff" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Limitation of the topology cost in identifying the true tree.</title>
<p>Our fitness function considers both a topology cost and a mass cost. If only topology cost is used, in the case of a completely branched tree (A) and a CPOV matrix with power of 1.0 and Type 1 error of 0, the mass cost is not necessary to narrow down candidate tree topologies. However, if the tree contains linear topologies (B), the topology cost is not sufficient to identify the true tree. <bold>A</bold> and <bold>B.</bold> simple 5-node trees representing branched (A) and linear (B) evolutionary patterns. CPOV matrices under the assumption of power 1.0 and Type error 0 appear to the right of each tree. <bold>C.</bold> Candidate tree topologies. C1 depicts the only tree topology compatible with the CPOV matrix of the branched evolutionary pattern (A); while C1–6 are all compatible with the CPOV matrix of the linear evolutionary pattern (B), showing that in this case the topology cost alone is not sufficient.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s003" mimetype="image/tiff" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Limitation of the mass cost in identifying the true tree.</title>
<p>Our fitness function considers both a topology cost and a mass cost. Mass cost alone is not sufficient to identify the true tree topology for the example cluster cellularity input in (B). The combination of the two cost terms outperforms each term alone in this example. <bold>A</bold> simple 5-node tree representing a moderately branched evolutionary pattern. <bold>B.</bold> Input cellularity values in two simulated samples. <bold>C.</bold> CPOV matrix. <bold>D.</bold> Candidate tree topologies. D1–3 depict topologies with minimum topology cost, and D4–5 depict those with minimum mass cost. Using both topology and mass cost uniquely identifies the true tree topology (D1).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s004" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s004" mimetype="image/tiff" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Tree topologies used in the simulations.</title>
<p>For trees with 3–5 nodes, the exhaustive set of possible topologies were used. Otherwise, we manually selected ten topologies. Each box depicts a tree instance.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s005" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s005" mimetype="image/tiff" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>The genetic algorithm is assessed across multiple settings of tumor purity, sequencing coverage depth, tree node count, and tumor sample count.</title>
<p>The example shows purity of 0.9, coverage of 150X, node count of 4, sample count of 4, and a selected tree instance.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s006" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s006" mimetype="image/tiff" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Performance of Genetic Algorithm in reconstruction of a subclonal phylogeny with large node count (n = 15).</title>
<p><bold>A.</bold> a phylogenetic tree summarizing clonal evolution in a simulated patient <bold>B.</bold> Cellularity values of fifteen mutation clusters (CL0–14) in seven simulated biopsies S1–7 <bold>C.</bold> CPOV matrix depicting the hypothesis test outcomes. Each red square represents a pair of mutation clusters (I,J) for which the null hypothesis that I could be the parent of J was rejected. Each blue square represents a pair for which the null hypothesis could not be rejected. <bold>D.</bold> The Jaccard index (<xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref>, Topology Similarity Measure) of the true tree (A) and the maximum fitness tree(s) in population at the end of each GA generation. In cases where more than a single highest maximum fitness tree was present, the maximum of the Jaccard indices is plotted. Each color trace represent one of ten independent GA runs performed on inputs in (B, C). <bold>E.</bold> The Jaccard index of the true tree and the maximum fitness trees at the end of each generation for a sample GA run. Each transparent circle represents a single maximum fitness tree. This GA run identified 9 maximum fitness tree topologies, one of which was the true tree (A). <bold>F.</bold> The consensus topology of the nine trees identified in (E). These trees shared the majority of their lineage relationships and only disagreed in parental lineage of mutation clusters CL10 and CL14.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s007" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s007" mimetype="image/tiff" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Performance of Genetic Algorithm in reconstruction of a subclonal phylogeny with large node count (n = 15).</title>
<p><bold>A.</bold> a phylogenetic tree summarizing clonal evolution in a second simulated patient <bold>B.</bold> Cellularity values of fifteen mutation clusters (CL0-14) in seven simulated biopsies S1–7 <bold>C.</bold> CPOV matrix depicting the hypothesis test outcomes. Each red square represents a pair of mutation clusters (I,J) for which the null hypothesis that I could be the parent of J was rejected. Each blue square represents a pair for which the null hypothesis could not be rejected. <bold>D.</bold> The Jaccard index (<xref ref-type="supplementary-material" rid="pcbi.1004416.s001">S1 Text</xref>, Topology Similarity Measure) of the true tree (A) and the maximum fitness tree(s) in population at the end of each GA generation. In cases where more than a single maximum fitness tree was present, the maximum of the Jaccard indices is plotted. Each color trace represent one of ten independent GA runs performed on inputs in (B, C). Only one of the ten GA runs (dark purple trace) identified the true tree (indicated by reaching Jaccard Index = 1). <bold>E.</bold> The Jaccard index of the true tree and the maximum fitness trees at the end of each generation for the successful run. Each transparent circle represents a single maximum fitness tree. This GA run also found 16 other phylogenetic trees sharing the maximum fitness with the true tree. (A). <bold>F.</bold> The consensus topology of the seventeen trees identified in (E). These trees disagreed in parental lineage of 5 out 15 mutation clusters CL16, CL7, CL8, CL12, CL14.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s008" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s008" mimetype="image/tiff" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Sensitivity of genetic algorithm to <italic>f</italic><sub><italic>c</italic></sub> parameter.</title>
<p>Simulations were designed to identify a reasonable default value of <italic>f</italic><sub><italic>c</italic></sub> in a few scenarios. An 8-node tree and a 15-node tree were simulated (as described in the Simulations section of Methods). The GA was run 20 times for each tree. For the 8-node tree, each run spanned 20 generations and for the 15-node tree, each run spanned 50 generations to enable good sampling of the tree topology space. <bold>A</bold> 8-node tree <bold>B</bold> 15-node tree. <bold>C</bold> and <bold>D</bold> The number of runs (out of 20) in which the true tree was identified by the GA for six values of <italic>f</italic><sub><italic>c</italic></sub>. The value <italic>f</italic><sub><italic>c</italic></sub> = 5 produces good results for both scenarios.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s009" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s009" mimetype="image/tiff" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Comparison of SCHISM, SubcloneSeeker and TrAp output on patient AML1.</title>
<p>Subclone Seeker and TrAp have similar inputs to SCHISM but the modeling task and outputs are different. <bold>A</bold> SCHISM models a single, unified tree across multiple samples. <bold>B</bold> Subclone Seeker and <bold>C</bold> TrAp model trees for each individual sample. The AML1 patient has one primary and one relapse sample [<xref ref-type="bibr" rid="pcbi.1004416.ref012">12</xref>]. SubcloneSeeker reports six trees for the primary sample and one tree for the relapse (secondary) sample. Primary Tree 11 is reported as compatible with Secondary Tree 1 (marked with asterisks). TrAp reports a top-scoring pair of trees—one tree (left) for the primary and one tree (right) for the relapse sample.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s010" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s010" mimetype="application/pdf" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Feature matrix comparing subclonal phylogeny reconstruction methods.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004416.s011" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004416.s011" mimetype="application/pdf" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Detailed performance of cost function for multi-sample sequencing studies.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Christine Iacobuzio-Donahue and Alvin Makohon-Moore for valuable discussions about subclonal evolution.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004416.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nowell</surname> <given-names>PC</given-names></name>. <article-title>The clonal evolution of tumor cell populations</article-title>. <source>Science</source>. <year>1976</year>;<volume>194</volume>(<issue>4260</issue>):<fpage>23</fpage>–<lpage>28</lpage>. <object-id pub-id-type="pmid">959840</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Greaves</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Maley</surname> <given-names>CC</given-names></name>. <article-title>Clonal evolution in cancer</article-title>. <source>Nature</source>. <year>2012</year> <month>Jan</month>;<volume>481</volume>(<issue>7381</issue>):<fpage>306</fpage>–<lpage>313</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10762" xlink:type="simple">10.1038/nature10762</ext-link></comment> <object-id pub-id-type="pmid">22258609</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kostadinov</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Kuhner</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Sanchez</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Galipeau</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Paulson</surname> <given-names>TG</given-names></name>, <etal>et al</etal>. <article-title>NSAIDs modulate clonal evolution in Barrett’s esophagus</article-title>. <source>PLoS Genetics</source>. <year>2013</year>;<volume>9</volume>(<issue>6</issue>):<fpage>e1003553</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1003553" xlink:type="simple">10.1371/journal.pgen.1003553</ext-link></comment> <object-id pub-id-type="pmid">23785299</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gerlinger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Horswell</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Larkin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rowan</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Salm</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Varela</surname> <given-names>I</given-names></name>, <etal>et al</etal>. <article-title>Genomic architecture and evolution of clear cell renal cell carcinomas defined by multiregion sequencing</article-title>. <source>Nature Genetics</source>. <year>2014</year>;<volume>46</volume>(<issue>3</issue>):<fpage>225</fpage>–<lpage>233</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.2891" xlink:type="simple">10.1038/ng.2891</ext-link></comment> <object-id pub-id-type="pmid">24487277</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Johnson</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Mazor</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hong</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Barnes</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Aihara</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>McLean</surname> <given-names>CY</given-names></name>, <etal>et al</etal>. <article-title>Mutational analysis reveals the origin and therapy-driven evolution of recurrent glioma</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>(<issue>6167</issue>):<fpage>189</fpage>–<lpage>193</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1239947" xlink:type="simple">10.1126/science.1239947</ext-link></comment> <object-id pub-id-type="pmid">24336570</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jiao</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Vembu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Deshwar</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Stein</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>Q</given-names></name>. <article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>35</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-15-35" xlink:type="simple">10.1186/1471-2105-15-35</ext-link></comment> <object-id pub-id-type="pmid">24484323</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hajirasouliha</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Mahmoody</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Raphael</surname> <given-names>BJ</given-names></name>. <article-title>A combinatorial approach for analyzing intra-tumor heterogeneity from high-throughput sequencing data</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>12</issue>):<fpage>i78</fpage>–<lpage>i86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu284" xlink:type="simple">10.1093/bioinformatics/btu284</ext-link></comment> <object-id pub-id-type="pmid">24932008</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Strino</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Parisi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Micsinai</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kluger</surname> <given-names>Y</given-names></name>. <article-title>TrAp: a tree approach for fingerprinting subclonal tumor composition</article-title>. <source>Nucleic Acids Research</source>. <year>2013</year>;<volume>41</volume>(<issue>17</issue>):<fpage>e165</fpage>–<lpage>e165</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt641" xlink:type="simple">10.1093/nar/gkt641</ext-link></comment> <object-id pub-id-type="pmid">23892400</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Qiao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Quinlan</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Jazaeri</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Verhaak</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Wheeler</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Marth</surname> <given-names>GT</given-names></name>. <article-title>SubcloneSeeker: a computational framework for reconstructing tumor clone structure for cancer variant interpretation and prioritization</article-title>. <source>Genome Biol</source>. <year>2014</year>;<volume>15</volume>:<fpage>443</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13059-014-0443-x" xlink:type="simple">10.1186/s13059-014-0443-x</ext-link></comment> <object-id pub-id-type="pmid">25160522</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Navin</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Kendall</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Troge</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Andrews</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Rodgers</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>McIndoo</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Tumour evolution inferred by single-cell sequencing</article-title>. <source>Nature</source>. <year>2011</year>;<volume>472</volume>(<issue>7341</issue>):<fpage>90</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09807" xlink:type="simple">10.1038/nature09807</ext-link></comment> <object-id pub-id-type="pmid">21399628</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Barber</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Davies</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Gerlinger</surname> <given-names>M</given-names></name>. <article-title>Dissecting cancer evolution at the macro-heterogeneity and micro-heterogeneity scale</article-title>. <source>Current Opinion in Genetics and Development</source>. <year>2015</year>;<volume>30</volume>(<issue>0</issue>):<fpage>1</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.gde.2014.12.001" xlink:type="simple">10.1016/j.gde.2014.12.001</ext-link></comment> <object-id pub-id-type="pmid">25555261</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ding</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ley</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Larson</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Koboldt</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>JS</given-names></name>, <etal>et al</etal>. <article-title>Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing</article-title>. <source>Nature</source>. <year>2012</year>;<volume>481</volume>(<issue>7382</issue>):<fpage>506</fpage>–<lpage>510</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10738" xlink:type="simple">10.1038/nature10738</ext-link></comment> <object-id pub-id-type="pmid">22237025</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>McFadden</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Papagiannakopoulos</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Taylor-Weiner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stewart</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Carter</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Cibulskis</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Genetic and clonal dissection of murine small cell lung carcinoma progression by genome sequencing</article-title>. <source>Cell</source>. <year>2014</year>;<volume>156</volume>(<issue>6</issue>):<fpage>1298</fpage>–<lpage>1311</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2014.02.031" xlink:type="simple">10.1016/j.cell.2014.02.031</ext-link></comment> <object-id pub-id-type="pmid">24630729</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schuh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Becq</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Humphray</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Alexa</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Burns</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Clifford</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Monitoring chronic lymphocytic leukemia progression by whole genome sequencing reveals heterogeneous clonal evolution patterns</article-title>. <source>Blood</source>. <year>2012</year>;<volume>120</volume>(<issue>20</issue>):<fpage>4191</fpage>–<lpage>4196</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1182/blood-2012-05-433540" xlink:type="simple">10.1182/blood-2012-05-433540</ext-link></comment> <object-id pub-id-type="pmid">22915640</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="other">Roth A, Khattra J, Yap D, Wan A, Laks E, Biele J, et al. PyClone: statistical inference of clonal population structure in cancer. Nature Methods. 2014;.</mixed-citation>
</ref>
<ref id="pcbi.1004416.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Miller</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>White</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Dees</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Griffith</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Griffith</surname> <given-names>OL</given-names></name>, <etal>et al</etal>. <article-title>SciClone: Inferring clonal architecture and tracking the spatial and temporal patterns of tumor evolution</article-title>. <source>PLoS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>8</issue>):<fpage>e1003665</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003665" xlink:type="simple">10.1371/journal.pcbi.1003665</ext-link></comment> <object-id pub-id-type="pmid">25102416</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="other">Fraley C, Raftery AE. MCLUST version 3: an R package for normal mixture modeling and model-based clustering. DTIC Document; 2006.</mixed-citation>
</ref>
<ref id="pcbi.1004416.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cayley</surname> <given-names>A</given-names></name>. <article-title>A theorem on trees</article-title>. <source>Quart J Math</source>. <year>1889</year>;<volume>23</volume>(<issue>376–378</issue>):<fpage>69</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004416.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Glover</surname> <given-names>F</given-names></name>. <article-title>Tabu search-Part I</article-title>. <source>ORSA Journal on Computing</source>. <year>1989</year>;<volume>1</volume>(<issue>3</issue>):<fpage>190</fpage>–<lpage>206</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1287/ijoc.1.3.190" xlink:type="simple">10.1287/ijoc.1.3.190</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Glover</surname> <given-names>F</given-names></name>. <article-title>Tabu search-Part II</article-title>. <source>ORSA Journal on Computing</source>. <year>1990</year>;<volume>2</volume>(<issue>1</issue>):<fpage>4</fpage>–<lpage>32</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1287/ijoc.2.1.4" xlink:type="simple">10.1287/ijoc.2.1.4</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kirkpatrick</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gelatt</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Vecchi</surname> <given-names>MP</given-names></name>, <etal>et al</etal>. <article-title>Optimization by simmulated annealing</article-title>. <source>Science</source>. <year>1983</year>;<volume>220</volume>(<issue>4598</issue>):<fpage>671</fpage>–<lpage>680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.220.4598.671" xlink:type="simple">10.1126/science.220.4598.671</ext-link></comment> <object-id pub-id-type="pmid">17813860</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cerny</surname> <given-names>V</given-names></name>. <article-title>Thermodynamical approach to the traveling salesman problem: An efficient simulation algorithm</article-title>. <source>Journal of optimization theory and applications</source>. <year>1985</year>;<volume>45</volume>(<issue>1</issue>):<fpage>41</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00940812" xlink:type="simple">10.1007/BF00940812</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004416.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Lourenco</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>OC</given-names></name>, <name name-style="western"><surname>Stutzle</surname> <given-names>T</given-names></name>. <chapter-title>Iterated local search: Framework and applications</chapter-title>. In: <source>Handbook of Metaheuristics</source>. <publisher-name>Springer</publisher-name>; <year>2010</year>. p. <fpage>363</fpage>–<lpage>397</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004416.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Barlow</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Bartholomew</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Bremner</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Brunk</surname> <given-names>HD</given-names></name>. <source>Statistical Inference under Order Restrictions</source>. <publisher-name>John Wiley</publisher-name>; <year>1972</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004416.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Miller</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Goldberg</surname> <given-names>DE</given-names></name>. <article-title>Genetic algorithms, selection schemes, and the varying effects of noise</article-title>. <source>Evolutionary Computation</source>. <year>1996</year>;<volume>4</volume>(<issue>2</issue>):<fpage>113</fpage>–<lpage>131</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/evco.1996.4.2.113" xlink:type="simple">10.1162/evco.1996.4.2.113</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>