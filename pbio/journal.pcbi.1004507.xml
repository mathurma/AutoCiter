<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004507</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00713</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Exposing Hidden Alternative Backbone Conformations in X-ray Crystallography Using qFit</article-title>
<alt-title alt-title-type="running-head">Alternative Backbone Conformations using qFit</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Keedy</surname>
<given-names>Daniel A.</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Fraser</surname>
<given-names>James S.</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>van den Bedem</surname>
<given-names>Henry</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Bioengineering and Therapeutic Sciences, University of California, San Francisco, San Francisco, California, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Division of Biosciences, SLAC National Accelerator Laboratory, Stanford University, California, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Shehu</surname>
<given-names>Amarda</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>George Mason University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: DAK JSF HvdB. Performed the experiments: DAK HvdB. Analyzed the data: DAK HvdB. Contributed reagents/materials/analysis tools: DAK HvdB. Wrote the paper: DAK JSF HvdB.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">vdbedem@slac.stanford.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>27</day>
<month>10</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>10</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>10</issue>
<elocation-id>e1004507</elocation-id>
<history>
<date date-type="received">
<day>5</day>
<month>5</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>6</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Keedy et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004507" xlink:type="simple"/>
<abstract>
<p>Proteins must move between different conformations of their native ensemble to perform their functions. Crystal structures obtained from high-resolution X-ray diffraction data reflect this heterogeneity as a spatial and temporal conformational average. Although movement between natively populated alternative conformations can be critical for characterizing molecular mechanisms, it is challenging to identify these conformations within electron density maps. Alternative side chain conformations are generally well separated into distinct rotameric conformations, but alternative backbone conformations can overlap at several atomic positions. Our model building program qFit uses mixed integer quadratic programming (MIQP) to evaluate an extremely large number of combinations of sidechain conformers and backbone fragments to locally explain the electron density. Here, we describe two major modeling enhancements to qFit: peptide flips and alternative glycine conformations. We find that peptide flips fall into four stereotypical clusters and are enriched in glycine residues at the <italic>n</italic>+1 position. The potential for insights uncovered by new peptide flips and glycine conformations is exemplified by HIV protease, where different inhibitors are associated with peptide flips in the “flap” regions adjacent to the inhibitor binding site. Our results paint a picture of peptide flips as conformational switches, often enabled by glycine flexibility, that result in dramatic local rearrangements. Our results furthermore demonstrate the power of large-scale computational analysis to provide new insights into conformational heterogeneity. Overall, improved modeling of backbone heterogeneity with high-resolution X-ray data will connect dynamics to the structure-function relationship and help drive new design strategies for inhibitors of biomedically important systems.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Describing the multiple conformations of proteins is important for understanding the relationship between molecular flexibility and function. However, most methods for interpreting data from X-ray crystallography focus on building a single structure of the protein, which limits the potential for biological insights. Here we introduce an improved algorithm for using crystallographic data to model these multiple conformations that addresses two previously overlooked types of protein backbone flexibility: peptide flips and glycine movements. The method successfully models known examples of these types of multiple conformations, and also identifies new cases that were previously unrecognized but are well supported by the experimental data. For example, we discover glycine-driven peptide flips in the inhibitor-gating “flaps” of the drug target HIV protease that were not modeled in the original structures. Automatically modeling “hidden” multiple conformations of proteins using our algorithm may help drive biomedically relevant insights in structural biology pertaining to, e.g., drug discovery for HIV–1 protease and other therapeutic targets.</p>
</abstract>
<funding-group>
<funding-statement>JSF is a Searle Scholar, Pew Scholar, and Packard Fellow, and is supported by NIH OD009180, NIH GM110580, and NSF STC-1231306. DAK is an AP Giannini Foundation Fellow. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="2"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Even well-folded globular proteins exhibit significant flexibility in their native state [<xref rid="pcbi.1004507.ref001" ref-type="bibr">1</xref>]. However, despite advances in nuclear magnetic resonance dynamics experiments and computational simulations, accurately characterizing the nature and extent of biomolecular flexibility remains a formidable challenge [<xref rid="pcbi.1004507.ref002" ref-type="bibr">2</xref>]. While traditionally X-ray crystallography is associated with characterizing the ground state of a biomolecule, the ensemble nature of diffraction experiments means that precise details of alternative conformations can be accessed when the electron density maps are of sufficient quality and resolution [<xref rid="pcbi.1004507.ref003" ref-type="bibr">3</xref>]. These maps represent spatiotemporal averaged electron density from conformational heterogeneity across the millions of unit cells within a crystal [<xref rid="pcbi.1004507.ref004" ref-type="bibr">4</xref>, <xref rid="pcbi.1004507.ref005" ref-type="bibr">5</xref>].</p>
<p>Computational methods have made strides toward uncovering and modeling conformational heterogeneity in protein structures from crystallographic data [<xref rid="pcbi.1004507.ref003" ref-type="bibr">3</xref>]. However, there is currently no automated approach to recognize the features of extensive backbone flexibility in electron density maps, model the constituent alternative conformations, and validate that the incorporation of heterogeneity improves the model. B-factors theoretically model harmonic displacements from the mean position of each atom, but in practice are often convolved with occupancies of discrete alternative positions when multiple backbone conformations partially overlap [<xref rid="pcbi.1004507.ref005" ref-type="bibr">5</xref>]. Statistical analyses of electron density using Ringer has revealed evidence for a surprising number of “hidden” alternative conformations in electron density maps [<xref rid="pcbi.1004507.ref006" ref-type="bibr">6</xref>, <xref rid="pcbi.1004507.ref007" ref-type="bibr">7</xref>]. The phenix.ensemble_refinement method [<xref rid="pcbi.1004507.ref008" ref-type="bibr">8</xref>] uses electron density to bias molecular dynamics simulations, then assembles snapshots from this trajectory into a multi-copy ensemble model. However, energy barriers of the simulation may prevent sampling of well separated backbone conformations. Accurately modeling protein conformational heterogeneity, in particular when the mainchain adopts distinct conformations for one or a number of contiguous residues, remains a difficult task. The spatial overlap of electron density of multiple conformations and the relatively similar profiles of branching mainchain and sidechains blur structural features that can guide the human eye to reduce the large number of possible interpretations [<xref rid="pcbi.1004507.ref009" ref-type="bibr">9</xref>].</p>
<p>We have previously developed qFit [<xref rid="pcbi.1004507.ref010" ref-type="bibr">10</xref>], a method for automatically disentangling and modeling alternative conformations and their associated occupancies, which are represented by the variable <italic>q</italic> (for “oc<underline><italic>cu</italic></underline>pancy”) in standard structure factor equations. The qFit algorithm examines a vast number of alternative interpretations of the electron density map simultaneously. To propitiously explore a high-dimensional search space, conformational sampling is guided by the anisotropy of electron density at the Cβ atom position, the nexus of backbone and sidechain in polypeptides [<xref rid="pcbi.1004507.ref011" ref-type="bibr">11</xref>]. For each slightly shifted Cβ atom position, qFit samples sidechain conformations with a rotamer library [<xref rid="pcbi.1004507.ref012" ref-type="bibr">12</xref>] and uses inverse kinematics to maintain backbone closure [<xref rid="pcbi.1004507.ref009" ref-type="bibr">9</xref>]. Finally, it selects a set of one to four conformations for each residue that, collectively, optimally explain the local electron density in real space.</p>
<p>However, the anisotropy of the Cβ atom limits the exploration radius of qFit to model backbone conformational heterogeneity. While protein backbone motions are often associated with large-amplitude conformational flexibility of surface loop regions, subtle motions can have important ripple effects in closely packed areas via sidechain-backbone coupling. For example, fast (ps-ns) backbone NH and sidechain methyl order parameters from spin relaxation experiments are highly correlated with each other in flexible regions [<xref rid="pcbi.1004507.ref013" ref-type="bibr">13</xref>], suggesting that mainchain and sidechain motions collectively sample conformational substates. For example, a backbone backrub motion [<xref rid="pcbi.1004507.ref014" ref-type="bibr">14</xref>] repositions the Cα-Cβ bond vector in a plane perpendicular to the chain direction, enabling the sidechain to access alternative, often sparsely populated rotamers that otherwise would be energetically unfavorable. We previously linked coupled transitions between alternative sidechain conformations, like “falling dominos”, to enzymatic turnover and allostery [<xref rid="pcbi.1004507.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1004507.ref016" ref-type="bibr">16</xref>].</p>
<p>Additionally, qFit cannot model discrete conformational substates such as peptide flips, which are &gt;90° rotations of a peptide group while minimally perturbing the flanking residues. Some structure validation methods highlight incorrect peptide orientations [<xref rid="pcbi.1004507.ref017" ref-type="bibr">17</xref>] and even automate subsequent model rebuilding [<xref rid="pcbi.1004507.ref018" ref-type="bibr">18</xref>]. However, rebuilding fits a correct, unique conformation rather than multiple well-populated alternative peptide conformations. Peptide flips can have important functional roles in proteins. For example, flavodoxin undergoes peptide rotations between functional states as part of the catalytic cycle [<xref rid="pcbi.1004507.ref019" ref-type="bibr">19</xref>], and peptide flips that convert β-sheet to α-sheet have been linked to amyloid formation [<xref rid="pcbi.1004507.ref020" ref-type="bibr">20</xref>]. Furthermore, high-resolution crystal structures have shown that alternative conformations related by a peptide flip may be populated in the same crystal, although not as commonly as backrubs [<xref rid="pcbi.1004507.ref014" ref-type="bibr">14</xref>].</p>
<p>Modeling alternative conformations of glycine residues, which lack a Cβ atom, is also a current limitation of qFit. The lack of a Cβ atom allows glycine residues to access otherwise forbidden regions of conformational space [<xref rid="pcbi.1004507.ref011" ref-type="bibr">11</xref>] and thereby fill special structural roles such as capping helix C-termini [<xref rid="pcbi.1004507.ref021" ref-type="bibr">21</xref>]. In addition, the flexibility of glycines may contribute directly to function at flexible inter-domain linkers or conformationally dynamic enzyme active sites [<xref rid="pcbi.1004507.ref022" ref-type="bibr">22</xref>]. Automatically modeling such cases as alternative conformations with qFit paves the way toward understanding their contributions to protein function. Increasingly, new experiments are being proposed which, combined with computational analysis, can extract the spatiotemporal ensemble from electron density maps [<xref rid="pcbi.1004507.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1004507.ref023" ref-type="bibr">23</xref>, <xref rid="pcbi.1004507.ref024" ref-type="bibr">24</xref>].</p>
<p>Adding the capability to model peptide flips and alternative conformations for glycines will increase our power to uncover conformational heterogeneity. While the number of sampled conformations for glycines is modest owing to a missing side-chain, including peptide flips for all amino acids adds significant computational complexity to the qFit algorithm. A powerful quadratic programming algorithm lies at the core of qFit and is necessary to determine non-zero occupancies for up to four conformations from among hundreds or even thousands of candidate conformations for each residue. Even for modest sample sizes, around 500, the number of combinations of candidate conformations is enormous, exceeding 10<sup>9</sup>. As more backbone motion is incorporated into qFit, the computational complexity increases, demanding a parallelized approach to refinement on a residue by residue basis. Although this moves rebuilding away from a single node towards a larger compute cluster, the combination of data-driven sampling and selection has enabled qFit to automatically build multiconformer models that have illuminated intramolecular networks of coupled conformational substates [<xref rid="pcbi.1004507.ref016" ref-type="bibr">16</xref>] and the effects of cryocooling crystals [<xref rid="pcbi.1004507.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1004507.ref026" ref-type="bibr">26</xref>]. Similar hybrid approaches using robotics sampling and selection based on experimental NMR data are also being extended to nucleotide systems such as the excited state of HIV–1 TAR RNA [<xref rid="pcbi.1004507.ref027" ref-type="bibr">27</xref>].</p>
<p>Here we introduce qFit 2.0, an updated version of the qFit algorithm with new capabilities for modeling near-native backbone conformational heterogeneity in crystal structures. We first describe the quadratic programming procedure that allows selection of a small set of conformations per residue that collectively account for the local electron density, and discuss its extension to fitting backbone atoms in addition to sidechain atoms. We then describe new conformational sampling features of qFit 2.0, in particular glycine shifts and peptide flips. Finally, we validate the updated algorithm with both synthetic and experimental X-ray data. qFit 2.0 is freely available by webserver and source code is available for download at <ext-link ext-link-type="uri" xlink:href="https://simtk.org/home/qfit" xlink:type="simple">https://simtk.org/home/qfit</ext-link>.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Improved backbone sampling and selection in qFit</title>
<p>To automatically identify alternative backbone conformations, including peptide flips, we augmented the sample-and-select protocol in qFit (see <xref rid="pcbi.1004507.g001" ref-type="fig">Fig 1</xref> and <xref rid="sec012" ref-type="sec">Methods</xref>). Previously, conformations were sampled based on anisotropy of the Cβ atom and were selected based on the fit between observed and calculated electron density for the sidechain (Cβ atom and beyond) only. Alternative conformations for mainchain atoms were ultimately included in the multiconformer model only because they accommodated the best sidechain fits. In qFit 2.0, we now select conformations based on the fit between observed and calculated electron density for the sidechain atoms and also the backbone O atom. The O atom is an excellent yardstick for identifying backbone conformational heterogeneity for two reasons. First, it is furthest from the Cα-Cα axis so its density profile is somewhat isolated and is displaced most by rotations around that axis [<xref rid="pcbi.1004507.ref014" ref-type="bibr">14</xref>]. Second, it has more electrons than other backbone heavy atoms, so is most evident in electron density maps. This change allows us to select peptide flips outside of α-helices and β-sheets, where flips are prevented by steric and hydrogen-bonding constraints, then directly select flipped conformations. This procedure is effective because the large movement of the backbone O during a peptide flip leaves a major signature in the electron density.</p>
<fig id="pcbi.1004507.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Flowchart of the qFit 2.0 algorithm.</title>
<p>qFit can operate on each residue in the protein (orange boxes) in parallel (1 ≤ <italic>n</italic> ≤ <italic>N</italic> indices are for residues in the protein). Anisotropic refinement gives a thermal ellipsoid for the Cβ (orange model), and refinement with occupancies set to 0 gives an omit map (purple model). These inputs are combined, backbone translations and peptide flips are sampled (blue models), each backbone is decorated with sidechain rotamers, and an MIQP is used to select 1–4 conformations for the residue. Residues with consecutive multiple backbone conformations, called fragments (yellow boxes), are then subjected to a second MIQP to trace compatible alternative backbone conformations across residues. Residues and fragments are combined into an intermediate model. Finally, a Monte Carlo procedure is used to adjust alternative conformation labels (“altloc” identifiers) to minimize steric overlaps, and the final model is refined.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.g001" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Glycine modeling</title>
<p>Incorporating the backbone O atom also enhances the detection of less discrete backbone conformational changes. In particular, we now sample alternative glycine conformations based on anisotropy of the electron density for the O atom, by analogy to the Cβ-driven sampling for all other amino acids. This results in alternative glycine conformations that are dictated by their own local electron density. After sampling, we select combinations of conformers from a pool of candidates based on both sidechain and backbone O atoms for all amino acids, including glycines. This addition results in greater potential to discover alternative conformations throughout the protein and include additional conformational heterogeneity in the final multiconformer model.</p>
</sec>
<sec id="sec005">
<title>Characterizing peptide flip geometry</title>
<p>The nullspace inverse kinematics procedure of qFit [<xref rid="pcbi.1004507.ref009" ref-type="bibr">9</xref>] naturally encodes backrub [<xref rid="pcbi.1004507.ref014" ref-type="bibr">14</xref>], crankshaft [<xref rid="pcbi.1004507.ref028" ref-type="bibr">28</xref>, <xref rid="pcbi.1004507.ref029" ref-type="bibr">29</xref>], and shear [<xref rid="pcbi.1004507.ref030" ref-type="bibr">30</xref>, <xref rid="pcbi.1004507.ref031" ref-type="bibr">31</xref>] motions (<xref rid="pcbi.1004507.s001" ref-type="supplementary-material">S1 Fig</xref>) where they are dictated by the anisotropy of the electron density for the Cβ atom. However, this anisotropy cannot identify more discrete substates of the backbone, such as peptide flips. Peptide flips are large, ~180° rotations of a peptide plane in protein backbone with minimal disturbance of adjacent peptide conformations. Enumerating many peptide flip candidate conformations with the nullspace inverse kinematics procedure would quickly lead to prohibitively large sample sizes. We therefore examined common geometries of discrete peptide flips to expedite sampling of discrete backbone substates in qFit 2.0.</p>
<p>Steric interactions prevent arbitrary rotations of the peptide plane, much like sidechains adopt preferred rotamer conformations. To identify plausible geometries for peptides relative to a single input peptide, we examined cases where the peptide rotates by 90–180° around the Cα-Cα axis. We identified 147 peptide flips modeled as alternative conformations in high-quality structures. After filtering this set of peptide flips with structure validation criteria and reserving some examples for a test set, we retained 79 examples that clustered around four geometries (<xref rid="pcbi.1004507.s003" ref-type="supplementary-material">S1 Table</xref>, <xref rid="pcbi.1004507.s004" ref-type="supplementary-material">S1 Data</xref>). We observed that peptide flips often included rotation and translation within the peptide plane such that the first Cα moves “below” the Cα-Cα axis and the second Cα moves “above” it (from the view in <xref rid="pcbi.1004507.g002" ref-type="fig">Fig 2A and 2C</xref>). These in-plane movements justify sampling geometries found in natural peptide flips in qFit 2.0 rather than, e.g., simply rotating the peptide 180° around the Cα-Cα axis. The first two clusters, “simple down” (<xref rid="pcbi.1004507.g002" ref-type="fig">Fig 2A and 2C</xref>, blue) and “tweaked down” (<xref rid="pcbi.1004507.g002" ref-type="fig">Fig 2A and 2C</xref>, red), feature a very nearly 180° rotation around the Cα-Cα axis, but with different in-plane adjustments. By contrast, the second two clusters, “left” (<xref rid="pcbi.1004507.g002" ref-type="fig">Fig 2B and 2D</xref>, green) and “right” (<xref rid="pcbi.1004507.g002" ref-type="fig">Fig 2B and 2D</xref>, brown), feature rotations closer to 120°, but in opposite directions. Our dataset here is sufficient to propose plausible, well-validated peptide flip geometries for sampling in qFit 2.0, and suggests that the four clusters could also be used to inspire moves in protein design.</p>
<fig id="pcbi.1004507.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Geometry and distribution of peptide flips in training set.</title>
<p><bold>(A,B)</bold> Reference primary conformation peptide (black) and four cluster centroids for secondary peptide conformations (colors), from the side <bold>(A)</bold> or “top-down” <bold>(B)</bold>. <bold>(C)</bold> Members from the training set segregate into two ~180° rotated clusters with different translations in the peptide plan (blue vs. red). View from roughly the same angle as <bold>(A)</bold>. <bold>(D)</bold> Other members from the training set segregate into +120° and -120° rotated clusters (green vs. brown). View from roughly the same angle as <bold>(B)</bold>.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.g002" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Structural context of flips</title>
<p>We found that the two “down” clusters were more common in tight turns between β-strands: 41–50% of flips in these clusters were found in turns, as compared to 0–14% for the other two flip clusters (with a conservative definition of a turn; see <xref rid="sec012" ref-type="sec">Methods</xref>) (<xref rid="pcbi.1004507.t001" ref-type="table">Table 1</xref>). The flip is nearly always associated with a transition between Type I/I’ and II/II’ turns. The “left”/”right” clusters were dispersed among many irregular structural contexts, but not α-helices or β-sheets. Across the four clusters, the first residue of the peptide was a glycine 7.5% of the time, in line with the general abundance of glycines in proteins (7–8%). However, the second residue of the peptide was a glycine significantly more frequently (50%, p &lt; 10<sup>−22</sup>). This was true for the “left”/”right” clusters (21%, p &lt; 0.05) and especially the two “down” clusters (<xref rid="pcbi.1004507.g002" ref-type="fig">Fig 2C</xref>) (64%, p &lt; 10<sup>−24</sup>). This may be in part because a glycine as the second residue of a peptide can lower the flip transition energy [<xref rid="pcbi.1004507.ref032" ref-type="bibr">32</xref>]. These results generally agree with reports of flip-like conformational differences between the same tight turn in separate homologous structures [<xref rid="pcbi.1004507.ref033" ref-type="bibr">33</xref>].</p>
<table-wrap id="pcbi.1004507.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.t001</object-id>
<label>Table 1</label> <caption><title>Peptide flip geometries aggregate into distinct clusters.</title> <p>Colors refer to <xref rid="pcbi.1004507.g002" ref-type="fig">Fig 2</xref>.</p></caption>
<alternatives>
<graphic id="pcbi.1004507.t001g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.t001" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Cluster</th>
<th align="left" rowspan="1" colspan="1"># of examples</th>
<th align="left" rowspan="1" colspan="1"># (%) in tight turn</th>
<th align="left" rowspan="1" colspan="1"># (%) with Gly as first residue</th>
<th align="left" rowspan="1" colspan="1"># (%) with Gly as second residue</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">“tweaked down” (red)</td>
<td align="left" rowspan="1" colspan="1">26</td>
<td align="left" rowspan="1" colspan="1">13 (50%)</td>
<td align="left" rowspan="1" colspan="1">0 (0%)</td>
<td align="left" rowspan="1" colspan="1">16 (62%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">“simple down” (blue)</td>
<td align="left" rowspan="1" colspan="1">29</td>
<td align="left" rowspan="1" colspan="1">12 (41%)</td>
<td align="left" rowspan="1" colspan="1">4 (14%)</td>
<td align="left" rowspan="1" colspan="1">19 (66%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">“left” (green)</td>
<td align="left" rowspan="1" colspan="1">10</td>
<td align="left" rowspan="1" colspan="1">0 (0%)</td>
<td align="left" rowspan="1" colspan="1">1 (10%)</td>
<td align="left" rowspan="1" colspan="1">2 (20%)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">“right” (brown)</td>
<td align="left" rowspan="1" colspan="1">14</td>
<td align="left" rowspan="1" colspan="1">2 (14%)</td>
<td align="left" rowspan="1" colspan="1">1 (7%)</td>
<td align="left" rowspan="1" colspan="1">3 (21%)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec007">
<title>Tests with synthetic datasets</title>
<p>To test these advances, we first explored synthetic datasets spanning resolutions from 0.9 to 2.0 Å with increasing B-factors as a function of resolution and Gaussian noise added to structure factors (see <xref rid="sec012" ref-type="sec">Methods</xref>). We used the Top8000 peptide flip geometry cluster centroids, with the alternative conformations at 70/30 occupancies for the “tweaked down” cluster and 50/50 occupancies for the other three clusters. Because qFit uses these geometries to sample peptide flips, we expected it would be able to successfully identify each flipped alternative conformation starting from the primary (labeled “A”) conformation at high-to-medium simulated resolution, but less well at lower simulated resolution. Indeed, qFit 2.0 successfully finds the flipped conformations for most peptide flip geometry clusters across resolutions with a 92% success rate overall; this rate drops only slightly with resolution from 0.9 to 2.0 Å (<xref rid="pcbi.1004507.g003" ref-type="fig">Fig 3</xref>). Since we rebuilt the entire protein chain, we also assessed the performance on other residues. By contrast to the true positive peptide flip results, the peptide flip and rotamer false positive rates remain quite low across clusters and resolutions (<xref rid="pcbi.1004507.g003" ref-type="fig">Fig 3</xref>). These results indicate that qFit 2.0 is effective at identifying peptide flip alternative conformations across a wide range of crystallographic resolutions without introducing spurious conformations.</p>
<fig id="pcbi.1004507.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.g003</object-id>
<label>Fig 3</label>
<caption>
<title>True vs. false positives with synthetic data.</title>
<p>Peptide flip true positives = percent of peptide flips in the actual synthetic model that are present in the qFit 2.0 model. Peptide flip false positives = percent of residues with a peptide flip in the qFit 2.0 model that are not in the actual synthetic model. Rotamer false positives = percent of sidechain rotamers (as defined by MolProbity [<xref rid="pcbi.1004507.ref012" ref-type="bibr">12</xref>, <xref rid="pcbi.1004507.ref034" ref-type="bibr">34</xref>]) in the qFit 2.0 model that are not in the actual synthetic model. True positives in green; false positives in red. Peptide flips in solid lines; rotamers in dotted line. Data is averaged over all four synthetic datasets (corresponding to the four peptide flip geometry clusters in <xref rid="pcbi.1004507.g002" ref-type="fig">Fig 2</xref>) and all three mainchain amplitudes are considered; see <xref rid="sec012" ref-type="sec">Methods</xref>.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.g003" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Tests with experimental datasets</title>
<p>Although tests with synthetic datasets offer insight into resolution dependence, a more direct test of the usefulness of qFit 2.0 involves crystal structures with real data. We combined structures left out of the training set from the Top8000 peptide flip examples with a few more manually curated examples for a total of 15 test cases (<xref rid="pcbi.1004507.t002" ref-type="table">Table 2</xref>). When comparing qFit 2.0 models to rerefined original structures, R<sub>free</sub> is better for 7/15 cases and R<sub>work</sub> is better for 8/15 cases (<xref rid="pcbi.1004507.s002" ref-type="supplementary-material">S2 Fig</xref>). However, after rerefinement with automated removal and addition of water molecules to allow the ordered solvent to respond to the new protein alternative conformations modeled by qFit (see <xref rid="sec012" ref-type="sec">Methods</xref>), R<sub>free</sub> is better for the qFit 2.0 model for 10/15 cases and R<sub>work</sub> is better for 13/15 cases (<xref rid="pcbi.1004507.g004" ref-type="fig">Fig 4</xref>). The differences generally are small: the average ΔR<sub>free</sub> is ~0.1%. Overall, these results suggest that qFit 2.0 models explain experimental crystallographic data as well as or better than traditional refinement protocols at a global structural level.</p>
<table-wrap id="pcbi.1004507.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.t002</object-id>
<label>Table 2</label> <caption><title>List of positive-control peptide flip test cases.</title> <p>Last column indicates whether or not qFit 2.0 found the peptide flip alternative conformations for at least one of the three backbone amplitude parameters. Overall, 14/18 (78%) peptide flips were successfully identified.</p></caption>
<alternatives>
<graphic id="pcbi.1004507.t002g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.t002" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">PDB ID</th>
<th align="left" rowspan="1" colspan="1">Resolution (Å)</th>
<th align="left" rowspan="1" colspan="1">Chain</th>
<th align="left" rowspan="1" colspan="1">Peptide</th>
<th align="left" rowspan="1" colspan="1">Found flip?</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1w0n</td>
<td align="char" char="." rowspan="1" colspan="1">0.80</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">42–43</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">1nki</td>
<td align="char" char="." rowspan="1" colspan="1">0.95</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">53–54</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">1nki</td>
<td align="char" char="." rowspan="1" colspan="1">0.95</td>
<td align="left" rowspan="1" colspan="1">B</td>
<td align="left" rowspan="1" colspan="1">53–54</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">1x9i</td>
<td align="char" char="." rowspan="1" colspan="1">1.16</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">65–66</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">1c9o</td>
<td align="char" char="." rowspan="1" colspan="1">1.17</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">36–37</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">1c9o</td>
<td align="char" char="." rowspan="1" colspan="1">1.17</td>
<td align="left" rowspan="1" colspan="1">B</td>
<td align="left" rowspan="1" colspan="1">36–37</td>
<td align="left" rowspan="1" colspan="1">n</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2c6z</td>
<td align="char" char="." rowspan="1" colspan="1">1.20</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">227–228</td>
<td align="left" rowspan="1" colspan="1">n</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2qd6</td>
<td align="char" char="." rowspan="1" colspan="1">1.28</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">50–51</td>
<td align="left" rowspan="1" colspan="1">n</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2qd6</td>
<td align="char" char="." rowspan="1" colspan="1">1.28</td>
<td align="left" rowspan="1" colspan="1">B</td>
<td align="left" rowspan="1" colspan="1">150–151</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3n6z</td>
<td align="char" char="." rowspan="1" colspan="1">1.30</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">177–178</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2c0c</td>
<td align="char" char="." rowspan="1" colspan="1">1.45</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">44–45</td>
<td align="left" rowspan="1" colspan="1">n</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3h0u</td>
<td align="char" char="." rowspan="1" colspan="1">1.50</td>
<td align="left" rowspan="1" colspan="1">C</td>
<td align="left" rowspan="1" colspan="1">115–116</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3el5</td>
<td align="char" char="." rowspan="1" colspan="1">1.60</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">50–51</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3el5</td>
<td align="char" char="." rowspan="1" colspan="1">1.60</td>
<td align="left" rowspan="1" colspan="1">B</td>
<td align="left" rowspan="1" colspan="1">50–51</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3ii7</td>
<td align="char" char="." rowspan="1" colspan="1">1.63</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">539–540</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3ie5</td>
<td align="char" char="." rowspan="1" colspan="1">1.69</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">61–62</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2ozv</td>
<td align="char" char="." rowspan="1" colspan="1">1.70</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">54–55</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3f7w</td>
<td align="char" char="." rowspan="1" colspan="1">1.85</td>
<td align="left" rowspan="1" colspan="1">A</td>
<td align="left" rowspan="1" colspan="1">48–49</td>
<td align="left" rowspan="1" colspan="1">Y</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1004507.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Multiconformer modeling with qFit results in similar or better crystallographic R-factors.</title>
<p>R<sub>work</sub> and R<sub>free</sub> are plotted vs. PDB ID sorted from high to low resolution. X’s indicate rerefined original structures and filled circles indicate qFit 2.0 models; both are after refinement with water picking.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.g004" position="float" xlink:type="simple"/>
</fig>
<p>While global metrics are important, a major focus of the current work is correctly identifying local alternative backbone conformations. To explore this aspect, we compared results from qFit 2.0 to those from qFit 1.0 and original deposited structures for our test set (<xref rid="pcbi.1004507.t002" ref-type="table">Table 2</xref>). qFit 2.0 successfully models both flipped conformations in 14/18 (78%) cases. For example, Val539-Gly540 in the Kelch domain of human KLHL7 is modeled with two alternative conformations related by a peptide flip (1.63 Å, PDB ID 3ii7) (<xref rid="pcbi.1004507.g005" ref-type="fig">Fig 5A</xref>). qFit 1.0 fails to discover the flip, resulting in significant difference electron density peaks (<xref rid="pcbi.1004507.g005" ref-type="fig">Fig 5B</xref>). By contrast, qFit 2.0 beautifully recovers both alternative conformations (<xref rid="pcbi.1004507.g005" ref-type="fig">Fig 5C</xref>). In another example, Asn42-Gly43 in carbohydrate binding domain 36 at high resolution (0.8 Å, PDB 1w0n) adopts flipped peptide conformations—yet MolProbity flags geometry errors in the deposited structure that indicate it re-converges too quickly, with alternative conformations for only the Asn42 and not also Gly43 (<xref rid="pcbi.1004507.g005" ref-type="fig">Fig 5D</xref>). qFit 1.0 fails to capture the flip (<xref rid="pcbi.1004507.g005" ref-type="fig">Fig 5E</xref>). However, qFit 2.0 not only identifies both peptide flip conformations for Asn42, but also includes split conformations for Gly43, thereby repairing the covalent backbone geometry (<xref rid="pcbi.1004507.g005" ref-type="fig">Fig 5F</xref>). In both cases, the peptide flip and glycine sampling enhancements in qFit 2.0 combine to model discrete backbone heterogeneity as accurately as or even better than the original structure.</p>
<fig id="pcbi.1004507.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.g005</object-id>
<label>Fig 5</label>
<caption>
<title>qFit 2.0 successfully identifies known peptide flips.</title>
<p><bold>(A-C)</bold> Val539-Gly540 in the Kelch domain of human KLHL7 at 1.63 Å (PDB ID 3ii7). 2mFo-DFc electron density is contoured at 1.2 σ (cyan) and 2.5 σ (blue); mFo-DFc electron density is contoured at +3.0 σ (green) and -3.0 σ (red). <bold>(A)</bold> The deposited model includes alternative conformations for this peptide, which are well justified by the electron density. <bold>(B)</bold> qFit 1.0 starting from single-conformer input fails to find the second conformation, resulting in peaks in the difference density map (arrow). <bold>(C)</bold> qFit 2.0 finds both conformations, resulting in the disappearance of the difference peaks. <bold>(D-E)</bold> Asn42-Gly43 in carbohydrate binding domain 36 at 0.8 Å resolution (PDB ID 1w0n). The Asn42 sidechain (left, darker green/purple) points up out of the image so is visually truncated. In <bold>(E-F)</bold>, 2mFo-DFc electron density is contoured at 1.5 σ (cyan) and 2.5 σ (blue); mFo-DFc electron density is contoured at +3.0 σ (green) and -3.0 σ (red). <bold>(D)</bold> The deposited structure includes alternative conformations (green and purple) related by a peptide flip, but re-converges too early at the Gly43 backbone N atom, resulting in &gt;4 σ bond length (red and blue fans) and bond angle (red and blue springs) outliers [<xref rid="pcbi.1004507.ref034" ref-type="bibr">34</xref>]. <bold>(E)</bold> qFit 1.0 fails to identify the flip, leaving significant difference density map features. <bold>(F)</bold> qFit 2.0 identifies the flip at Asn43 and also correctly splits Gly43 into separate conformations, thereby flattening the difference map relative to qFit 1.0 and eliminating the covalent geometry errors in the original structure.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.g005" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Discovering new conformational heterogeneity from experimental datasets</title>
<p>In addition to retrospective positive-control tests, we also looked prospectively for “hidden” peptide flip alternative conformations that are unmodeled in existing structures. One such example is Met519-Thr520 in RNA binding protein 39. In chain A of the room-temperature structure (PDB ID 4j5o), the mFo-DFc difference electron density map around this peptide has significant positive and negative peaks, indicating it is mismodeled as a single conformation (<xref rid="pcbi.1004507.g006" ref-type="fig">Fig 6A</xref>). Other instances of this peptide—including in chain B of the room-temperature structure and both chains of the cryogenic structure—feature conformational diversity, much of which may be related to crystal contacts; however, these conformations fail to account for the room-temperature chain A mFo-DFc peaks (<xref rid="pcbi.1004507.g006" ref-type="fig">Fig 6B</xref>). However, using the room-temperature data, qFit 2.0 identifies a peptide flip in this region, which repositions Met519 and flattens the local difference density (<xref rid="pcbi.1004507.g006" ref-type="fig">Fig 6C</xref>). By contrast, it does not identify a peptide flip for this region in either chain using the cryogenic data, which is in accord with previous reports that cryocooling crystals can conceal or otherwise perturb conformational heterogeneity that is present at room temperature [<xref rid="pcbi.1004507.ref025" ref-type="bibr">25</xref>, <xref rid="pcbi.1004507.ref026" ref-type="bibr">26</xref>].</p>
<fig id="pcbi.1004507.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.g006</object-id>
<label>Fig 6</label>
<caption>
<title>qFit 2.0 finds a hidden peptide flip at room temperature.</title>
<p><bold>(A)</bold> Met519-Thr520 in mouse RNA binding protein 39 (RBM39) is modeled with just a single conformation in chain A of the 1.11 Å room-temperature structure (PDB ID 4j5o, pink). There appear to missing unmodeled conformations based on mFo-DFc difference electron density contoured at +3.0 σ (green) and -3.0 σ (red). 2mFo-DFc electron density is shown contoured at 0.9 σ (cyan) and 2.5 σ (dark blue). <bold>(B)</bold> Although there is diversity for this region in chain B of the asymmetric unit from this structure and in chains A and B from the 0.95 Å cryogenic structure (PDB ID 3s6e, blue), none of the other instances explain the electron density at RT in chain A. There is also no clear evidence for missing alternative conformations in these other instances. <bold>(C)</bold> In the RT qFit model, the peptide has two alternative conformations (both in red) related by a flip. The new second conformation positions the Met519 sidechain differently (down in this view). Collectively, these changes better explain the local electron density.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.g006" position="float" xlink:type="simple"/>
</fig>
<p>In addition to selection of conformers based on fit to density for the backbone O atom for all amino acids, qFit 2.0 also adds sampling based on this atom for glycine, enabling density-driven backbone sampling for the most flexible amino acid. This facilitates modeling peptide flips in which one of the constituent residues is a glycine, as seen in the examples above (<xref rid="pcbi.1004507.g005" ref-type="fig">Fig 5</xref>)—but also opens the door to modeling less discrete glycine flexibility. For the 489 glycines across the 15 datasets in the test set (<xref rid="pcbi.1004507.t002" ref-type="table">Table 2</xref>), qFit 1.0 cannot model more than a single conformation, but qFit 2.0 models alternative conformations for 365/489 (75%) of glycines. The Cα displacements average 0.28 Å and range from &lt;0.01 Å up to 1.70 Å. Only 4 (4%) of these glycines were modeled with alternative conformations in the original PDB structures. These results show that the direct sampling and selection based on electron density for glycine backbone atoms in qFit 2.0 successfully identify conformational heterogeneity that was formerly unrecognized. For example, a small, glycine-rich loop in PDB ID 3ie5 is modeled with a single conformation in the deposited structure and qFit 1.0 model (<xref rid="pcbi.1004507.g007" ref-type="fig">Fig 7A</xref>). By contrast, qFit 2.0 recognizes the anisotropy of the electron density for each of the three glycine O atoms in the loop, so models them with alternative conformations that collectively shift the entire mini-loop region (<xref rid="pcbi.1004507.g007" ref-type="fig">Fig 7B</xref>).</p>
<fig id="pcbi.1004507.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.g007</object-id>
<label>Fig 7</label>
<caption>
<title>qFit 2.0 identifies alternative glycine conformations.</title>
<p>This small loop in the 1.69 Å structure of Hyp–1 protein from St. John’s wort (PDB ID 3ie5) includes several glycines: 49, 50, and 52. <bold>(A)</bold> The deposited structure (orange) depicts these glycines with single conformations. The qFit 1.0 model (red) does the same, because it cannot sample alternative glycine conformations. <bold>(B)</bold> The qFit 2.0 model identifies alternative conformations (green/purple) for the entire loop, including all three glycines, based on subtly anisotropic backbone O atoms (arrows). 2mFo-DFc electron density contoured at 1.0 σ (cyan) and 3.0 σ (blue); mFo-DFc electron density contoured at +3.0 σ (green) and -3.0 σ (red).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.g007" position="float" xlink:type="simple"/>
</fig>
<p>Selecting conformers based on fit to density for the backbone O atom helps find alternative conformations not only for glycines, but also more generally for other amino acids. In many cases, this additional data-driven aspect to conformer selection drives the identification of subtle, non-discrete backbone motions that are coupled to larger, discrete sidechain changes. Indeed, for the 15 proteins in <xref rid="pcbi.1004507.t002" ref-type="table">Table 2</xref>, qFit 2.0 shifts the Cα more than does qFit 1.0 for 52% of residues, but the reverse is true for only 20% of residues (the remaining residues are not moved by either version) (<xref rid="pcbi.1004507.g008" ref-type="fig">Fig 8A</xref>). Furthermore, for 63% of the residues for which qFit 2.0 finds a new sidechain rotamer that qFit 1.0 does not, qFit 2.0 also moves the Cα more (<xref rid="pcbi.1004507.g008" ref-type="fig">Fig 8B</xref>). These results imply that the backbone sampling by qFit 2.0 not only increases backbone heterogeneity in and of itself, but also drives discovery of sidechain conformational heterogeneity. As one specific example, Thr157 in cyclophilin A is modeled with alternative backbone and rotamer conformations in the deposited structure (<xref rid="pcbi.1004507.g008" ref-type="fig">Fig 8A</xref>). qFit 1.0 fails to find the alternative rotamer because it maintains a single backbone conformation (<xref rid="pcbi.1004507.g008" ref-type="fig">Fig 8B</xref>), but, driven by carbonyl O anisotropy, qFit 2.0 identifies the alternative backbone conformations, allowing it to discover the second rotamer (<xref rid="pcbi.1004507.g008" ref-type="fig">Fig 8C</xref>).</p>
<fig id="pcbi.1004507.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Extra backbone heterogeneity in qFit 2.0 helps discover new sidechain heterogeneity.</title>
<p><bold>(A)</bold> Histogram of difference in maximum Cα displacement across all combinations of alternative conformations between qFit 2.0 and qFit 1.0 for the test set. Vertical dotted line at 0 difference. <bold>(B)</bold> Maximum Cα displacements for qFit 2.0 vs. 1.0 for residues with a newly discovered sidechain rotamer in the qFit 2.0 model but not in the qFit 1.0 model. Many of these residues fall above the diagonal line, meaning the Cα moves more in the qFit 2.0 model than in the qFit 1.0 model. <bold>(C-D)</bold> Thr157 in cyclophilin A at room temperature (PDB ID 3k0n). 2mFo-DFc electron density is contoured at 0.5 σ (cyan) and 3.0 σ (blue); mFo-DFc difference electron density is contoured at +3.1 σ (green) and -3.1 σ (red). <bold>(C)</bold> The deposited structure has alternative rotamers that were correctly manually modeled. <bold>(D)</bold> qFit 1.0 does not move the backbone and misses the alternative rotamer, as evidenced by a peak of +mFo-DFc density (arrow). <bold>(E)</bold> qFit 2.0 does move the backbone (note especially the backbone carbonyl displacement), and successfully identifies the alternative rotamer.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.g008" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Newly identified peptide flips in the “flap” region of HIV protease</title>
<p>We also observed hidden peptide flips for the Ile50-Gly51 tight turn in the “flap” region of HIV–1 protease. HIV–1 protease is a homodimer, with residue numbers often denoted by 1–99 and 1’-99’. The flap region consisting of residues 46–56 is an antiparallel β-sheet and tight turn at the interface of the dimer (<xref rid="pcbi.1004507.g009" ref-type="fig">Fig 9A</xref>). In most of the hundreds of crystal structures of HIV–1 protease, the two tight turns (Leu50-Gly51 and Leu50’-Gly51’) adopt an asymmetric conformation, with one flap in a single type I conformation and the other in a single type II conformation. However, NMR relaxation data suggest that these flips can undergo chemical exchange on a slow (~10 μs) timescale in solution [<xref rid="pcbi.1004507.ref035" ref-type="bibr">35</xref>]. Mutational data also linked collective conformational exchanges of these flips to catalytic rates [<xref rid="pcbi.1004507.ref036" ref-type="bibr">36</xref>]. In line with these solution studies, we noticed that for many HIV–1 protease crystal structures, the electron density maps actually reveal strong evidence for alternative conformations related by dual peptide flips. For example, in one high-resolution inhibitor-bound structure (PDB ID 3qih), the Leu50-Gly51 and Leu50’-Gly51’ flaps are modeled with single asymmetric conformations, but strong positive mFo-DFc electron density coincides with potentially flipped states (<xref rid="pcbi.1004507.g009" ref-type="fig">Fig 9B</xref>). Strikingly, qFit 2.0 automatically identifies dual “flap flips”, suggesting the flaps actually populate two different asymmetric states (green vs. purple in <xref rid="pcbi.1004507.g009" ref-type="fig">Fig 9C</xref>) in this particular inhibitor complex. More generally, this result suggests that these inhibitor-gating flaps in HIV–1 protease sample multiple conformations more often than previously recognized across many inhibitor complexes, which may motivate further investigation of the effects that protein and inhibitor flexibility have on binding affinity, efficiency of catalytic inhibition, and arisal of drug resistance in this biomedically important target.</p>
<fig id="pcbi.1004507.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004507.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Hidden unmodeled peptide flips in the inhibitor-gating “flaps” of HIV–1 protease.</title>
<p><bold>(A)</bold> In the 1.39 Å structure of a mutant of HIV–1 protease bound to a novel inhibitor (PDB ID 3qih), the Ile50-Gly51 tight turn interacts with the dimer-related copy of itself, Ile50’-Gly51’ (boxed region). Chain A in orange, chain B in red. The inhibitor (sticks) binds in two overlapping poses immediately adjacent to these flaps. <bold>(B)</bold> This dimer interface, viewed as if from above in <bold>(A)</bold>, is asymmetric in the deposited structure: both copies of the peptide point downwards in this view. However, positive difference electron density (arrows) suggest unmodeled conformations. <bold>(C)</bold> qFit 2.0 models this region with coupled asymmetric peptide flips, such that both copies of the peptide point down (~70%, green) or both point up (~30%, purple) in this view. The multiconformer model has diminished difference electron density peaks, suggesting it is a better local fit to the data. Residual difference peaks may reflect unmodeled partial-occupancy waters that are mutually exclusive with the new protein alternative conformations. 2mFo-DFc contoured at 1.2 σ (cyan) and 3.0 σ (blue); mFo-DFc contoured at +3.0 σ (green) and -3.0 σ (red).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.g009" position="float" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec011" sec-type="conclusions">
<title>Discussion</title>
<p>The ruggedness of protein energy landscapes leads to conformational heterogeneity even in folded globular proteins. Evidence for these alternative conformations is remarkably prevalent in high-resolution (&lt;2 Å) crystallographic electron density maps [<xref rid="pcbi.1004507.ref006" ref-type="bibr">6</xref>]. However, because these alternative conformations are difficult and/or time-consuming to model manually using existing graphics and refinement tools, they are underrepresented in the PDB [<xref rid="pcbi.1004507.ref006" ref-type="bibr">6</xref>]. qFit is a computational approach to overcoming these problems, by automatically identifying “hidden” alternative conformations and using quadratic programming to select a parsimonious subset that collectively best explains the diffraction data. Here we have demonstrated a new version of this algorithm, called qFit 2.0, with several enhancements to handling flexible backbone—most notably, automated detection of discrete peptide flips and explicit fitting of backbone atoms for glycines.</p>
<p>qFit has previously captured different types of backbone motion that can occur in secondary structure. For example, it correctly identifies the backrub motion [<xref rid="pcbi.1004507.ref014" ref-type="bibr">14</xref>] that helps Ser99 transition between sidechain rotamers in the active-site β-sheet network of CypA [<xref rid="pcbi.1004507.ref015" ref-type="bibr">15</xref>, <xref rid="pcbi.1004507.ref016" ref-type="bibr">16</xref>], and also identifies a previously hidden α-helix winding/unwinding or “shear” motion [<xref rid="pcbi.1004507.ref014" ref-type="bibr">14</xref>, <xref rid="pcbi.1004507.ref030" ref-type="bibr">30</xref>] (<xref rid="pcbi.1004507.s001" ref-type="supplementary-material">S1 Fig</xref>). However, qFit 2.0 can now model larger backbone motions in which the backbone change itself is discrete, instead of inherently continuous but coupled to discrete sidechain rotamer changes. Specifically, it models peptide flips, which occur outside of helices and sheets and involve discrete jumps over a larger energetic barrier.</p>
<p>Peptide flips have important implications for understanding protein function. For example, our results for HIV–1 protease (<xref rid="pcbi.1004507.g009" ref-type="fig">Fig 9</xref>) strongly suggest that conformational heterogeneity, in particular peptide flips, may play underappreciated roles in protein-inhibitor complexes. Previously, molecular dynamics simulations identified a large-scale “curling” motion of these flaps that is maintained by drug-resistance mutations and therefore seems important for substrate access [<xref rid="pcbi.1004507.ref037" ref-type="bibr">37</xref>]. Although this motion is more dramatic than the peptide flaps at the tips of the flaps that we observe, it underlines that flap flexibility—potentially across multiple length scales—is central to protease function and viral propagation. The peptide flip acts as a key conformational switch between type I/II turns, rearranging its environment beyond its immediate sequence neighbors and enabling alternative sidechain conformations with implications for function. However, the large number of unmodeled turns in HIV protease structures illustrates the challenge of distinguishing alternative conformations in electron density maps, even at high resolution. As an additional example which unfortunately lacks deposited structure factors, the active-site Gly57-Asp58 peptide in <italic>C</italic>. <italic>beijerinckii</italic> flavodoxin adopts distinct peptide flip states in concert with the oxidation state of the FMN prosthetic group [<xref rid="pcbi.1004507.ref019" ref-type="bibr">19</xref>]. The N137A mutation removes artificial lattice contacts that otherwise influence the conformation of the Gly57-Asp58 peptide, which results in a mixture of these peptide conformations simultaneously populated in the crystal; this suggests these multiple flip states may also coexist in solution [<xref rid="pcbi.1004507.ref019" ref-type="bibr">19</xref>].</p>
<p>Beyond the specific improvements to peptide flips, qFit 2.0 now fits conformations for each residue based on both sidechain (beyond Cβ) and backbone (carbonyl O) atoms. Although we originally envisioned this change for modeling glycines, we observed that it results in dramatically more extensive backbone conformational heterogeneity across the protein (<xref rid="pcbi.1004507.g008" ref-type="fig">Fig 8</xref>). R-factors are similar or better (<xref rid="pcbi.1004507.g004" ref-type="fig">Fig 4</xref>), suggesting the new models with more heterogeneity are at least as good an explanation of the experimental data. Notably, these new backbone shifts drive discovery of many more alternative sidechain rotamers (<xref rid="pcbi.1004507.g008" ref-type="fig">Fig 8</xref>). Our results suggest that sidechain and backbone degrees of freedom in proteins are tightly coupled, in agreement with previous reports that even subtle backbone motions can facilitate rotamer changes [<xref rid="pcbi.1004507.ref014" ref-type="bibr">14</xref>], open up breathing room for natural mutations [<xref rid="pcbi.1004507.ref038" ref-type="bibr">38</xref>], and expand accessible sequence space in computational protein design [<xref rid="pcbi.1004507.ref031" ref-type="bibr">31</xref>, <xref rid="pcbi.1004507.ref039" ref-type="bibr">39</xref>].</p>
<p>Future work will investigate an armamentarium of methods for modeling larger backbone conformational change in qFit, including helix shear motions [<xref rid="pcbi.1004507.ref030" ref-type="bibr">30</xref>], adjustments of entire α-helices [<xref rid="pcbi.1004507.ref040" ref-type="bibr">40</xref>, <xref rid="pcbi.1004507.ref041" ref-type="bibr">41</xref>], correlated β-sheet flexing [<xref rid="pcbi.1004507.ref028" ref-type="bibr">28</xref>], automated loop building algorithms such as Xpleo [<xref rid="pcbi.1004507.ref009" ref-type="bibr">9</xref>], and pre-knowledge of conformational differences between homologous structures. While these future steps will move us closer to capturing the full hierarchy of protein conformational substates [<xref rid="pcbi.1004507.ref042" ref-type="bibr">42</xref>], they will also dramatically increase the computational cost of automated multiconformer model building. Many aspects of qFit are parallelizable; however, the total computational cost for reproducing the data in this manuscript is approximately 10<sup>5</sup> CPU hours. As cloud-computing capabilities of 10<sup>8</sup> CPU hours can now be leveraged for pure simulation data [<xref rid="pcbi.1004507.ref043" ref-type="bibr">43</xref>], we envision that marshalling similar computational capabilities will become increasingly important for analysis of experimental X-ray data. Such data-driven computational approaches to studying the dynamic relationship between protein structure and function will be especially powerful when applied to series of datasets in which the protein is subjected to perturbations that modulate conformational distributions, such as ligand binding or temperature change [<xref rid="pcbi.1004507.ref023" ref-type="bibr">23</xref>].</p>
</sec>
<sec id="sec012" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec013">
<title>Learning peptide flip geometries</title>
<p>To define possible relative geometries between flipped peptide conformations, we searched for trustworthy peptide flips modeled as alternative conformations in the Top8000 database. This database contains ~8000 (7957) quality-filtered protein chains from high-resolution crystal structures, each with resolution &lt; 2 Å, MolProbity score [<xref rid="pcbi.1004507.ref034" ref-type="bibr">34</xref>] &lt; 2, nearly ideal covalent geometry, and &lt;70% sequence identity to any other chain in the database [<xref rid="pcbi.1004507.ref044" ref-type="bibr">44</xref>]. We searched the Top8000 for peptides with carbonyl C-O bonds pointed away from each other (O-O distance &gt; C-C distance + 1 Å) and rotated by at least 90°, and for which both flanking Cα atoms reconverged to &lt; 1.5 Å. Although peptide rotations of &lt; 90° also occur, they occur more often in irregular loop regions, have less well-converged backbone for flanking residues, and are generally more diverse and difficult to simply categorize. By contrast, in this study we investigate the class of localized peptide rotations with well-converged backbone for both flanking residues. These are either very small rotations, or large flips with a rotation nearer to 180° —the latter being the focus here. To identify test cases for qFit 2.0, we curated the resulting dataset by removing examples with more than two alternative peptide conformations; a <italic>cis</italic> rather than <italic>trans</italic> conformation for either state; or obvious errors based on steric clashes, strained covalent geometry, or torsional outliers from MolProbity [<xref rid="pcbi.1004507.ref034" ref-type="bibr">34</xref>]. This resulted in 104 examples, from which we kept a randomly selected 79 for a geometry training set (<xref rid="pcbi.1004507.s003" ref-type="supplementary-material">S1 Table</xref>). We combined a subset of the remaining 25 peptide flips with a few other known examples for a test set of 18 examples (<xref rid="pcbi.1004507.t001" ref-type="table">Table 1</xref>). The resolution range is 0.92–1.95 Å for the training set and 0.80–1.85 Å for the test set.</p>
<p>Next we characterized the geometry of peptide flips by clustering the coordinates of the flipped alternative conformation (labeled “B”) in the training set after superimposing onto a reference peptide. We used the k-means algorithm with RMSD between the five heavy atoms of the peptide backbone (Cα1, C1, O1, N2, and Cα2) for different values of k. We selected k = 4 because we observed cluster centroids with approximately 180°, +120°, and -120° rotations and for k &gt; 4 no other significantly different rotations were identified. Notably, all four cluster centroids featured translations of the flanking Cα atoms of &gt;0.2 Å, and as much as &gt;0.9 Å for one cluster (“tweaked down”, red in <xref rid="pcbi.1004507.g002" ref-type="fig">Fig 2</xref>). The transformation matrices relating the flipped peptide cluster centroids to the reference peptide were used in qFit 2.0 to sample plausible alternative conformations, with subsequent refinement adjusting the atomic positions away from the centroid geometry.</p>
</sec>
<sec id="sec014">
<title>Tight turns and glycine enrichment</title>
<p>We defined tight turns as having a mainchain-mainchain hydrogen bond between <italic>i</italic>–1 carbonyl C = O and <italic>i</italic>+2 amide N-H that was detectable by the program Probe [<xref rid="pcbi.1004507.ref045" ref-type="bibr">45</xref>]. This definition is somewhat conservative; several more examples also were visually similar to tight turns. Enrichment of glycines at the two positions involved in a peptide flip was assessed for different peptide flip clusters within the training set relative to a large set of 337 randomly selected structures containing 6,092 total glycines out of 78,094 total amino acid residues. The statistical significance of this enrichment was assessed using a one-tailed Fisher’s exact test based on the hypergeometric distribution [<xref rid="pcbi.1004507.ref046" ref-type="bibr">46</xref>].</p>
</sec>
<sec id="sec015">
<title>qFit</title>
<sec id="sec016">
<title>qFit part 1: Preparing each residue for qFit</title>
<p>qFit exhaustively examines a vast number of interpretations of local electron density, and deterministically selects a small ensemble that optimally explains the density. The method starts from an initial single-conformer model. The occupancies of all atoms in a residue, <italic>k</italic>, beyond the Cβ atom are set to zero with phenix.pdbtools, and the model is refined with phenix.refine. Refinement uses anisotropic B-factors for all residues if the resolution is better than 1.45 Å, or just for residue <italic>k</italic> otherwise. Finally, all atoms in residue <italic>k</italic> beyond the Cβ atom are removed. These steps result in two inputs to qFit: (1) an omit map and (2) starting coordinates with an anisotropic tensor for the Cβ atom.</p>
</sec>
<sec id="sec017">
<title>qFit part 2: Peptide flips and backbone sampling</title>
<p>Next, the peptide from residue <italic>k</italic> to <italic>k</italic>+1 is aligned to the centroids identified from clustering the Top8000 dataset (see above). We calculate local coordinate frames for the peptide and cluster centers by orthogonalizing the Cα<sub>i</sub>-Cα<sub>i+1</sub> and Cα<sub>i</sub>-O<sub>i</sub> vectors and taking their cross-product. Each centroid conformation is then transformed onto the starting peptide using a homogeneous coordinate transformation, resulting in a candidate flipped alternative conformation.</p>
<p>Peptide flips do not occur in canonical secondary structure due to steric constraints, so qFit 2.0 does not attempt them in helices and sheets, as detected by the CCP4 MMDB library [<xref rid="pcbi.1004507.ref047" ref-type="bibr">47</xref>]. This both avoids false positives and affords a computational speedup by reducing combinatorics in the selection steps (see below).</p>
<p>Next, for each residue <italic>k</italic>, a fragment of length 7 centered on residue <italic>k</italic> is extracted. For each candidate conformation (one unflipped plus four flipped), the Cβ atom is moved along the major and minor axes of the ellipsoid (six total directions) by a distance determined by the ellipsoid eigenvectors and a scale value provided by the user. Here we used 0.1, 0.2, and 0.3 for this scale value, and 0.05 for the optional value for random additions to scale. For glycines, which lack a Cβ atom, the backbone O atom is used to define the anisotropic ellipsoid. To preserve the exact geometry of the fragment, we use inverse kinematics to deform the fragment. The gradient of the distance function is projected onto the nullspace spanned by the dihedral degrees of freedom of the fragment [<xref rid="pcbi.1004507.ref009" ref-type="bibr">9</xref>, <xref rid="pcbi.1004507.ref010" ref-type="bibr">10</xref>]. These motions further position backbone atoms to accommodate rotameric sidechain conformations.</p>
</sec>
<sec id="sec018">
<title>qFit part 3: Sidechain sampling</title>
<p>We sample sidechain conformations from the “penultimate” rotamer library [<xref rid="pcbi.1004507.ref012" ref-type="bibr">12</xref>]. For each rotamer for small sidechains (Asn, Asp, Cys, Iso, Leu, Pro, Ser, Thr, Val), a 40° neighborhood of each rotameric χ dihedral angle, starting at -20°, is sampled in 10° increments on each of the 35 backbone conformations. To avoid a combinatorial explosion, large sidechains (Arg, Glu, Gln, His, Lys, Met, Phe, Trp, Tyr) are sampled hierarchically. First, for each rotamer the backbone and first dihedral angle are sampled similarly to small sidechains. A larger neighborhood of 50° is sampled in 4.5° increments to avoid missing conformations that are initially suboptimal but can accommodate better fits for subsequent χ angles. This set is then subjected to the selection procedure, which returns a handful of conformations that fit the density up to the Cγ atom. These selected conformations form the basis for sampling the next χ angle using the same parameters. This procedure is repeated until the entire sidechain is built.</p>
</sec>
<sec id="sec019">
<title>qFit part 4: Conformer selection</title>
<p>For each of the <italic>N</italic> conformations sampled for each residue, we calculate an electron density map <inline-formula id="pcbi.1004507.e001"><alternatives><graphic id="pcbi.1004507.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e001" xlink:type="simple"/><mml:math display="inline" id="M1" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. We scale the observed electron density map <italic>ρ</italic><sup><italic>o</italic></sup> to <italic>ρ</italic><sup><italic>c</italic></sup>. We then subject the weighted sum of <inline-formula id="pcbi.1004507.e002"><alternatives><graphic id="pcbi.1004507.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e002" xlink:type="simple"/><mml:math display="inline" id="M2" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> to a quadratic program (QP) to determine a vector of occupancies <bold><italic>w</italic></bold><sup><italic>T</italic></sup> that minimizes the least squares residuals with respect to the observed electron density:
<disp-formula id="pcbi.1004507.e003">
<alternatives>
<graphic id="pcbi.1004507.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e003" xlink:type="simple"/>
<mml:math display="block" id="M3" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:mstyle><mml:mi>w</mml:mi></mml:munder></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mi>o</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The residuals are calculated over regularly spaced voxels that are within a resolution-dependent radius <italic>r</italic> of any of the sidechain (Cβ and beyond) or carbonyl O atoms. The radius <italic>r</italic> (in Å) is determined by <italic>r</italic> = 0.7 + (<italic>d</italic>—0.6)/3.0 if d &lt; 3.0Å, and 0.5 d if d ≥ 3.0Å, where <italic>d</italic> is the resolution in Å.</p>
<p>The vast number of conformations results in a system that is generally underdetermined. We therefore enforce sparsity of the solution by introducing a resolution-dependent <italic>threshold</italic> constraint <inline-formula id="pcbi.1004507.e004"><alternatives><graphic id="pcbi.1004507.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e004" xlink:type="simple"/><mml:math display="inline" id="M4" overflow="scroll"><mml:mrow><mml:mn>0</mml:mn><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> for the occupancies; i.e.,<inline-formula id="pcbi.1004507.e005"><alternatives><graphic id="pcbi.1004507.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e005" xlink:type="simple"/><mml:math display="inline" id="M5" overflow="scroll"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≥</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> for all <italic>i</italic>. The threshold constraint prevents overfitting by suppressing arbitrarily small occupancies that model noise. Together with the constraint that the total occupancy cannot exceed unity, the threshold also enforces a <italic>cardinality</italic> constraint; i.e., the number of non-zero occupancies is bounded by the integer part of <inline-formula id="pcbi.1004507.e006"><alternatives><graphic id="pcbi.1004507.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e006" xlink:type="simple"/><mml:math display="inline" id="M6" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. In effect, the threshold constraint enforces selection of an optimal subset in the regression. Note that the two constraints imply <inline-formula id="pcbi.1004507.e007"><alternatives><graphic id="pcbi.1004507.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e007" xlink:type="simple"/><mml:math display="inline" id="M7" overflow="scroll"><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mn>0</mml:mn><mml:mo>}</mml:mo></mml:mrow><mml:mo>∪</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Introducing binary variables <italic>z</italic><sub><italic>i</italic></sub>∈{0,1}, we can rewrite the optimization problem as a mixed integer quadratic program (MIQP):
<disp-formula id="pcbi.1004507.e008">
<alternatives>
<graphic id="pcbi.1004507.e008g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e008" xlink:type="simple"/>
<mml:math display="block" id="M8" overflow="scroll">
<mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:mstyle><mml:mi>w</mml:mi></mml:munder></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>‖</mml:mo><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mi>o</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msubsup><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mtext>s</mml:mtext><mml:mo>.</mml:mo><mml:mtext>t</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo stretchy="false">∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>This optimization problem belongs to the class of convex quadratic problems, for which solvers can find a globally optimal solution. An MIQP is NP-hard. We therefore pre-fit conformers with QP, and subject all conformations with non-vanishing occupancies to MIQP. While in theory this no longer guarantees an optimal solution, practice tests on small sets of conformers did not show an effect of pre-fitting.</p>
</sec>
<sec id="sec020">
<title>qFit part 5: Putting the model back together</title>
<p>Assembling a consistent, multiconformer model from individually fitted residues requires two steps. First, backbone heterogeneity can extend over multiple, consecutive residues, each with slightly different occupancies and/or numbers of conformers. To synchronize the number of conformers and their occupancies over a fragment of length <italic>K</italic> residues consisting of consecutive backbone multiconformers, we again rely on conformational selection by MIQP. We enumerate all possible connections between all conformations <italic>C</italic><sub><italic>i</italic></sub> of residues <italic>i</italic> = 1,…,<italic>K</italic> to obtain <inline-formula id="pcbi.1004507.e009"><alternatives><graphic id="pcbi.1004507.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e009" xlink:type="simple"/><mml:math display="inline" id="M9" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>f</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula>
conformations to model this fragment. We subject all <italic>C</italic><sub><italic>f</italic></sub> conformations to the MIQP, which selects a parsimonious ensemble of at most <inline-formula id="pcbi.1004507.e010"><alternatives><graphic id="pcbi.1004507.e010g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004507.e010" xlink:type="simple"/><mml:math display="inline" id="M10" overflow="scroll"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mtext>min</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> conformations based on optimal fit to the observed electron density, each with identical occupancy for all atoms in the fragment. Note that <italic>C</italic><sub><italic>f</italic></sub> can be quite large, even for modestly long fragments. To avoid a combinatorial explosion, for long fragments we implemented a divide-and-conquer procedure that fits segments of each fragment with MIQP. The fitted segments are then combinatorially recombined and again subjected to MIQP to obtain the final set of conformations for the fragment. The peptide-bond geometry of the output model at this stage of qFit can be distorted. A later refinement stage with phenix.refine corrects the geometry.</p>
<p>Second, conformations encoding collective motions are often mutually exclusive.</p>
<p>In crystal structures, each internally consistent set of residues is labeled with an alternative conformation or “altloc” identifier—a capitalized letter (“A”, “B”, etc.) for multiple conformations or a blank space (““) for a single conformation. However, the initial model from the preceding steps in the qFit pipeline has random labels. To identify internally consistent labels, we use a simple downhill Monte Carlo optimization protocol. The program Label minimizes a simple Lennard-Jones score by randomly swapping labels between conformations and accepting the change if the score improves. This is repeated 10,000 times per trial over 10 trials, and the model with the best score is used for subsequent steps.</p>
<p>To finalize the model, we first refine the relabeled model with phenix.refine. Next, we remove conformations that are now indistinguishable from other conformations within predicted coordinate error, and reset occupancies to sum to unity for each atom. Finally, we refine positions, occupancy, and B-factors again, using anisotropic B-factors if the resolution is better than 1.45 Å. Manual modifications are likely to further improve both R<sub>free</sub> and model quality as measured by MolProbity score.</p>
</sec>
</sec>
<sec id="sec021">
<title>Hydrogen treatment</title>
<p>Hydrogens were placed at nuclear positions for Label in qFit 1.0 and at electron-cloud positions for Label in qFit 2.0. Correspondingly, for Label in qFit 2.0, hydrogen van der Waals radii were taken from the new values in Reduce [<xref rid="pcbi.1004507.ref048" ref-type="bibr">48</xref>], which are intended to match those used in PHENIX. Hydrogens were absent for all other steps in qFit, including the final refinement step; however, the user is encouraged to add hydrogens to the final qFit model for their protein of interest and proceed to other analyses. Future work will update programs for downstream analysis of qFit models such as CONTACT [<xref rid="pcbi.1004507.ref016" ref-type="bibr">16</xref>] to also use electron-cloud instead of nuclear hydrogen positions.</p>
</sec>
<sec id="sec022">
<title>Generating synthetic datasets</title>
<p>To generate synthetic datasets for testing qFit, we used the protein chains containing the four peptide flip cluster centroids (3mcw B 101–102, 2ior A 159–160, 2g1u A 51–52, 3g6k F 172–173). We first used phenix.pdbtools to convert any anisotropic B-factors to isotropic, added 10 Å<sup>2</sup> to each B-factor per Å of resolution worse than the original structure’s resolution to roughly simulate the general rise of B-factors with resolution, and placed the chain in a P1 box that comfortably encompassed it. Next we used phenix.fmodel to calculate structure factors (with the “k_sol = 0.4” and “b_sol = 45” bulk solvent parameters, and also generating 5% R-free flags) and added 10% noise in complex space with the sftools utility in CCP4 [<xref rid="pcbi.1004507.ref047" ref-type="bibr">47</xref>]. This process was repeated for every simulated resolution from 0.9 to 2.0 Å with a 0.1 Å step size.</p>
</sec>
<sec id="sec023">
<title>Evaluating true and false positives</title>
<p>qFit uses an input parameter (MC_AMPL) to scale the magnitude of movements of the Cβ (or O for glycines) along the directions dictated by its thermal ellipsoid. As in previous work [<xref rid="pcbi.1004507.ref010" ref-type="bibr">10</xref>, <xref rid="pcbi.1004507.ref016" ref-type="bibr">16</xref>, <xref rid="pcbi.1004507.ref026" ref-type="bibr">26</xref>], we explored multiple values for this parameter: 0.1, 0.2, and 0.3. For evaluating results such as true vs. false positive peptide flips and rotamers here, we considered all three resulting qFit models for each dataset. This is sensible because an end user of qFit 2.0 will likely reproduce this same protocol (with a few MC_AMPL values) and thus have a choice of models to use for developing insights into conformational heterogeneity and its connection to function. For other analyses, we used the minimum-R<sub>free</sub> qFit model model unless otherwise noted.</p>
</sec>
<sec id="sec024">
<title>Re-refinement with water picking</title>
<p>To compare R-factors between the deposited models and qFit 2.0, we finalized both models with phenix.refine for 10 macro-cycles using the same parameters, including the “ordered_solvent = true” flag. The resulting R-factors for qFit 2.0 models are similar or slightly better (<xref rid="pcbi.1004507.g004" ref-type="fig">Fig 4</xref>).</p>
</sec>
<sec id="sec025">
<title>Programs and databases</title>
<p>PHENIX version 1.9–1692 (the most recent official release) [<xref rid="pcbi.1004507.ref049" ref-type="bibr">49</xref>] was used for all steps of both qFit 1.0 and 2.0. Coordinates and structures factors were obtained from the Protein Data Bank [<xref rid="pcbi.1004507.ref050" ref-type="bibr">50</xref>]. qFit uses the following libraries: IBM’s ILOG CPLEX solver for QP and MIQP, which is available free of charge for academic use, and LoopTK for inverse kinematics calculations [<xref rid="pcbi.1004507.ref051" ref-type="bibr">51</xref>]. qFit is implemented in parallel; it is capable of sampling and evaluating conformations for each residue as an independent job on a Linux cluster. We have implemented job management for qFit on both Oracle/Sun Grid Engine and LSF Platform.</p>
</sec>
</sec>
<sec id="sec026">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004507.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004507.s001" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>qFit detects a shear backbone motion in a room-temperature crystal structure of cyclophilin A.</title>
<p><bold>(A)</bold> Residues 142–145 in CypA are modeled with a single conformation in the single-conformer structure (PDB ID 3k0n). The model is a reasonable fit to the 2mFo-DFc electron density contoured at 1.0 σ (cyan) and 2.5 σ (dark blue), which is slightly anisotropic for the central carbonyl oxygen. <bold>(B)</bold> The multiconformer qFit model, on the other hand, includes three alternative conformations with backbones related by a shear-like motion to explain the electron density. Each shear end-state (greens vs. purple) is allocated about 50% occupancy. The multiconformer model adds a second rotamer (purple) in addition to the original rotamer (greens) for Glu143 (left-hand-side of panel) and sweeps the Arg144 sidechain sideways (right-hand-side of panel).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004507.s002" xlink:href="info:doi/10.1371/journal.pcbi.1004507.s002" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Multiconformer modeling with qFit does not result in better crystallographic R-factors before solvent picking.</title>
<p>R<sub>work</sub> and R<sub>free</sub> are plotted vs. PDB ID sorted from high to low resolution. X’s indicate original structures rerefined without automated addition and removal of water molecules, and filled circles indicate qFit 2.0 models.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004507.s003" xlink:href="info:doi/10.1371/journal.pcbi.1004507.s003" mimetype="application/vnd.ms-excel" position="float" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>List of peptide flip examples from Top8000 used as training set.</title>
<p>(XLS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004507.s004" xlink:href="info:doi/10.1371/journal.pcbi.1004507.s004" mimetype="application/gnutar" position="float" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Peptide cluster center geometries.</title>
<p>(tgz)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004507.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smock</surname> <given-names>RG</given-names></name>, <name name-style="western"><surname>Gierasch</surname> <given-names>LM</given-names></name>. <article-title>Sending signals dynamically</article-title>. <source>Science</source>. <year>2009</year>;<volume>324</volume>(<issue>5924</issue>):<fpage>198</fpage>–<lpage>203</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1169377" xlink:type="simple">10.1126/science.1169377</ext-link></comment> <object-id pub-id-type="pmid">19359576</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van den Bedem</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>JS</given-names></name>. <article-title>Integrative, dynamic structural biology at atomic resolution-it's about time</article-title>. <source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>4</issue>):<fpage>307</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3324" xlink:type="simple">10.1038/nmeth.3324</ext-link></comment> <object-id pub-id-type="pmid">25825836</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Woldeyes</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Sivak</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>JS</given-names></name>. <article-title>E pluribus unum, no more: from one crystal, many conformations</article-title>. <source>Curr Opin Struct Biol</source>. <year>2014</year>;<volume>28</volume>:<fpage>56</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.sbi.2014.07.005" xlink:type="simple">10.1016/j.sbi.2014.07.005</ext-link></comment> <object-id pub-id-type="pmid">25113271</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Hendrickson</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Honzatko</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Sheriff</surname> <given-names>S</given-names></name>. <article-title>Structural heterogeneity in protein crystals</article-title>. <source>Biochemistry</source>. <year>1986</year>;<volume>25</volume>(<issue>18</issue>):<fpage>5018</fpage>–<lpage>27</lpage>. <object-id pub-id-type="pmid">3768328</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuzmanic</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pannu</surname> <given-names>NS</given-names></name>, <name name-style="western"><surname>Zagrovic</surname> <given-names>B</given-names></name>. <article-title>X-ray refinement significantly underestimates the level of microscopic heterogeneity in biomolecular crystals</article-title>. <source>Nat Commun</source>. <year>2014</year>;<volume>5</volume>:<fpage>3220</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms4220" xlink:type="simple">10.1038/ncomms4220</ext-link></comment> <object-id pub-id-type="pmid">24504120</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lang</surname> <given-names>PT</given-names></name>, <name name-style="western"><surname>Ng</surname> <given-names>HL</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Corn</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Echols</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sales</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Automated electron-density sampling reveals widespread conformational polymorphism in proteins</article-title>. <source>Protein Sci</source>. <year>2010</year>;<volume>19</volume>(<issue>7</issue>):<fpage>1420</fpage>–<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/pro.423" xlink:type="simple">10.1002/pro.423</ext-link></comment> <object-id pub-id-type="pmid">20499387</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lang</surname> <given-names>PT</given-names></name>, <name name-style="western"><surname>Holton</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Alber</surname> <given-names>T</given-names></name>. <article-title>Protein structural ensembles are revealed by redefining X-ray electron density noise</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2014</year>;<volume>111</volume>(<issue>1</issue>):<fpage>237</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1302823110" xlink:type="simple">10.1073/pnas.1302823110</ext-link></comment> <object-id pub-id-type="pmid">24363322</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Burnley</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Afonine</surname> <given-names>PV</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Gros</surname> <given-names>P</given-names></name>. <article-title>Modelling dynamics in protein crystal structures by ensemble refinement</article-title>. <source>eLife</source>. <year>2012</year>;<volume>1</volume>:<fpage>e00311</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.7554/eLife.00311" xlink:type="simple">10.7554/eLife.00311</ext-link></comment> <object-id pub-id-type="pmid">23251785</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van den Bedem</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lotan</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Latombe</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Deacon</surname> <given-names>AM</given-names></name>. <article-title>Real-space protein-model completion: an inverse-kinematics approach</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source>. <year>2005</year>;<volume>61</volume>(<issue>Pt 1</issue>):<fpage>2</fpage>–<lpage>13</lpage>. <object-id pub-id-type="pmid">15608370</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van den Bedem</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Dhanik</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Latombe</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Deacon</surname> <given-names>AM</given-names></name>. <article-title>Modeling discrete heterogeneity in X-ray diffraction data by fitting multi-conformers</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source>. <year>2009</year>;<volume>65</volume>(<issue>Pt 10</issue>):<fpage>1107</fpage>–<lpage>17</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1107/S0907444909030613" xlink:type="simple">10.1107/S0907444909030613</ext-link></comment> <object-id pub-id-type="pmid">19770508</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lovell</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>IW</given-names></name>, <name name-style="western"><surname>Arendall</surname> <given-names>WB</given-names> <suffix>3rd</suffix></name>, <name name-style="western"><surname>de Bakker</surname> <given-names>PI</given-names></name>, <name name-style="western"><surname>Word</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Prisant</surname> <given-names>MG</given-names></name>, <etal>et al</etal>. <article-title>Structure validation by Calpha geometry: phi,psi and Cbeta deviation</article-title>. <source>Proteins</source>. <year>2003</year>;<volume>50</volume>(<issue>3</issue>):<fpage>437</fpage>–<lpage>50</lpage>. <object-id pub-id-type="pmid">12557186</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lovell</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Word</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>DC</given-names></name>. <article-title>The penultimate rotamer library</article-title>. <source>Proteins</source>. <year>2000</year>;<volume>40</volume>(<issue>3</issue>):<fpage>389</fpage>–<lpage>408</lpage>. <object-id pub-id-type="pmid">10861930</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sharp</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>O'Brien</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kasinath</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wand</surname> <given-names>AJ</given-names></name>. <article-title>On the relationship between NMR-derived amide order parameters and protein backbone entropy changes</article-title>. <source>Proteins</source>. <year>2015</year>;<volume>83</volume>(<issue>5</issue>):<fpage>922</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.24789" xlink:type="simple">10.1002/prot.24789</ext-link></comment> <object-id pub-id-type="pmid">25739366</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Davis</surname> <given-names>IW</given-names></name>, <name name-style="western"><surname>Arendall</surname> <given-names>WB</given-names> <suffix>3rd</suffix></name>, <name name-style="western"><surname>Richardson</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>JS</given-names></name>. <article-title>The backrub motion: how protein backbone shrugs when a sidechain dances</article-title>. <source>Structure</source>. <year>2006</year>;<volume>14</volume>(<issue>2</issue>):<fpage>265</fpage>–<lpage>74</lpage>. <object-id pub-id-type="pmid">16472746</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fraser</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Clarkson</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Degnan</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Erion</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kern</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Alber</surname> <given-names>T</given-names></name>. <article-title>Hidden alternative structures of proline isomerase essential for catalysis</article-title>. <source>Nature</source>. <year>2009</year>;<volume>462</volume>(<issue>7273</issue>):<fpage>669</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08615" xlink:type="simple">10.1038/nature08615</ext-link></comment> <object-id pub-id-type="pmid">19956261</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van den Bedem</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bhabha</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>JS</given-names></name>. <article-title>Automated identification of functional dynamic contact networks from X-ray crystallography</article-title>. <source>Nat Methods</source>. <year>2013</year>;<volume>10</volume>(<issue>9</issue>):<fpage>896</fpage>–<lpage>902</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2592" xlink:type="simple">10.1038/nmeth.2592</ext-link></comment> <object-id pub-id-type="pmid">23913260</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jones</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Zou</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Cowan</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Kjeldgaard</surname> <given-names>M</given-names></name>. <article-title>Improved methods for building protein models in electron density maps and the location of errors in these models</article-title>. <source>Acta Crystallogr A</source>. <year>1991</year>;<volume>47</volume> (<issue>Pt 2</issue>):<fpage>110</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">2025413</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kleywegt</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>TA</given-names></name>. <article-title>Efficient rebuilding of protein structures</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source>. <year>1996</year>;<volume>52</volume>(<issue>Pt 4</issue>):<fpage>829</fpage>–<lpage>32</lpage>. <object-id pub-id-type="pmid">15299648</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ludwig</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Pattridge</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Metzger</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Dixon</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Eren</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Control of oxidation-reduction potentials in flavodoxin from Clostridium beijerinckii: the role of conformation changes</article-title>. <source>Biochemistry</source>. <year>1997</year>;<volume>36</volume>(<issue>6</issue>):<fpage>1259</fpage>–<lpage>80</lpage>. <object-id pub-id-type="pmid">9063874</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Milner-White</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Watson</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Qi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Hayward</surname> <given-names>S</given-names></name>. <article-title>Amyloid formation may involve alpha- to beta sheet interconversion via peptide plane flipping</article-title>. <source>Structure</source>. <year>2006</year>;<volume>14</volume>(<issue>9</issue>):<fpage>1369</fpage>–<lpage>76</lpage>. <object-id pub-id-type="pmid">16962968</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Richardson</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>DC</given-names></name>. <article-title>Amino acid preferences for specific locations at the ends of alpha helices</article-title>. <source>Science</source>. <year>1988</year>;<volume>240</volume>(<issue>4859</issue>):<fpage>1648</fpage>–<lpage>52</lpage>. <object-id pub-id-type="pmid">3381086</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yan</surname> <given-names>BX</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>YQ</given-names></name>. <article-title>Glycine residues provide flexibility for enzyme active sites</article-title>. <source>J Biol Chem</source>. <year>1997</year>;<volume>272</volume>(<issue>6</issue>):<fpage>3190</fpage>–<lpage>4</lpage>. <object-id pub-id-type="pmid">9013553</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref023"><label>23</label><mixed-citation publication-type="other" xlink:type="simple">Keedy DA, Kenner LR, Warkentin M, Woldeyes R, Thompson MC, Brewster AS, et al. Mapping the Conformational Landscape of a Dynamic Enzyme by XFEL and Multitemperature Crystallography2015 2015-01-01 00:00:00.</mixed-citation></ref>
<ref id="pcbi.1004507.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arnlund</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Johansson</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Wickstrand</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Barty</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Malmerberg</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Visualizing a protein quake with time-resolved X-ray scattering at a free-electron laser</article-title>. <source>Nat Methods</source>. <year>2014</year>;<volume>11</volume>(<issue>9</issue>):<fpage>923</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3067" xlink:type="simple">10.1038/nmeth.3067</ext-link></comment> <object-id pub-id-type="pmid">25108686</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fraser</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>van den Bedem</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Samelson</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Lang</surname> <given-names>PT</given-names></name>, <name name-style="western"><surname>Holton</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Echols</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Accessing protein conformational ensembles using room-temperature X-ray crystallography</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2011</year>;<volume>108</volume>(<issue>39</issue>):<fpage>16247</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1111325108" xlink:type="simple">10.1073/pnas.1111325108</ext-link></comment> <object-id pub-id-type="pmid">21918110</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keedy</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>van den Bedem</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Sivak</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Petsko</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Ringe</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Crystal cryocooling distorts conformational heterogeneity in a model Michaelis complex of DHFR</article-title>. <source>Structure</source>. <year>2014</year>;<volume>22</volume>(<issue>6</issue>):<fpage>899</fpage>–<lpage>910</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.str.2014.04.016" xlink:type="simple">10.1016/j.str.2014.04.016</ext-link></comment> <object-id pub-id-type="pmid">24882744</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fonseca</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pachov</surname> <given-names>DV</given-names></name>, <name name-style="western"><surname>Bernauer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>van den Bedem</surname> <given-names>H</given-names></name>. <article-title>Characterizing RNA ensembles from NMR data with kinematic models</article-title>. <source>Nucleic Acids Res</source>. <year>2014</year>;<volume>42</volume>(<issue>15</issue>):<fpage>9562</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gku707" xlink:type="simple">10.1093/nar/gku707</ext-link></comment> <object-id pub-id-type="pmid">25114056</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fenwick</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Orellana</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Esteban-Martin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Orozco</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Salvatella</surname> <given-names>X</given-names></name>. <article-title>Correlated motions are a fundamental property of beta-sheets</article-title>. <source>Nat Commun</source>. <year>2014</year>;<volume>5</volume>:<fpage>4070</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms5070" xlink:type="simple">10.1038/ncomms5070</ext-link></comment> <object-id pub-id-type="pmid">24915882</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fadel</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>DQ</given-names></name>, <name name-style="western"><surname>Montelione</surname> <given-names>GT</given-names></name>, <name name-style="western"><surname>Levy</surname> <given-names>RM</given-names></name>. <article-title>Crankshaft motions of the polypeptide backbone in molecular dynamics simulations of human type-alpha transforming growth factor</article-title>. <source>J Biomol NMR</source>. <year>1995</year>;<volume>6</volume>(<issue>2</issue>):<fpage>221</fpage>–<lpage>6</lpage>. <object-id pub-id-type="pmid">8589611</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hallen</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Keedy</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Donald</surname> <given-names>BR</given-names></name>. <article-title>Dead-end elimination with perturbations (DEEPer): a provable protein design algorithm with continuous sidechain and backbone flexibility</article-title>. <source>Proteins</source>. <year>2013</year>;<volume>81</volume>(<issue>1</issue>):<fpage>18</fpage>–<lpage>39</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.24150" xlink:type="simple">10.1002/prot.24150</ext-link></comment> <object-id pub-id-type="pmid">22821798</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Kortemme</surname> <given-names>T</given-names></name>. <article-title>Backrub-like backbone simulation recapitulates natural protein conformational variability and improves mutant side-chain prediction</article-title>. <source>J Mol Biol</source>. <year>2008</year>;<volume>380</volume>(<issue>4</issue>):<fpage>742</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmb.2008.05.023" xlink:type="simple">10.1016/j.jmb.2008.05.023</ext-link></comment> <object-id pub-id-type="pmid">18547585</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hayward</surname> <given-names>S</given-names></name>. <article-title>Peptide-plane flipping in proteins</article-title>. <source>Protein Sci</source>. <year>2001</year>;<volume>10</volume>(<issue>11</issue>):<fpage>2219</fpage>–<lpage>27</lpage>. <object-id pub-id-type="pmid">11604529</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gunasekaran</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gomathi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ramakrishnan</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Chandrasekhar</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Balaram</surname> <given-names>P</given-names></name>. <article-title>Conformational interconversions in peptide beta-turns: analysis of turns in proteins and computational estimates of barriers</article-title>. <source>J Mol Biol</source>. <year>1998</year>;<volume>284</volume>(<issue>5</issue>):<fpage>1505</fpage>–<lpage>16</lpage>. <object-id pub-id-type="pmid">9878367</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>VB</given-names></name>, <name name-style="western"><surname>Arendall</surname> <given-names>WB</given-names> <suffix>3rd</suffix></name>, <name name-style="western"><surname>Headd</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Keedy</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Immormino</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Kapral</surname> <given-names>GJ</given-names></name>, <etal>et al</etal>. <article-title>MolProbity: all-atom structure validation for macromolecular crystallography</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source>. <year>2010</year>;<volume>66</volume>(<issue>Pt 1</issue>):<fpage>12</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1107/S0907444909042073" xlink:type="simple">10.1107/S0907444909042073</ext-link></comment> <object-id pub-id-type="pmid">20057044</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nicholson</surname> <given-names>LK</given-names></name>, <name name-style="western"><surname>Yamazaki</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Torchia</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Grzesiek</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bax</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stahl</surname> <given-names>SJ</given-names></name>, <etal>et al</etal>. <article-title>Flexibility and function in HIV–1 protease</article-title>. <source>Nat Struct Biol</source>. <year>1995</year>;<volume>2</volume>(<issue>4</issue>):<fpage>274</fpage>–<lpage>80</lpage>. <object-id pub-id-type="pmid">7796263</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Torbeev</surname> <given-names>VY</given-names></name>, <name name-style="western"><surname>Raghuraman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hamelberg</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tonelli</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Westler</surname> <given-names>WM</given-names></name>, <name name-style="western"><surname>Perozo</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Protein conformational dynamics in the mechanism of HIV–1 protease catalysis</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2011</year>;<volume>108</volume>(<issue>52</issue>):<fpage>20982</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1111202108" xlink:type="simple">10.1073/pnas.1111202108</ext-link></comment> <object-id pub-id-type="pmid">22158985</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scott</surname> <given-names>WR</given-names></name>, <name name-style="western"><surname>Schiffer</surname> <given-names>CA</given-names></name>. <article-title>Curling of flap tips in HIV–1 protease as a mechanism for substrate entry and tolerance of drug resistance</article-title>. <source>Structure</source>. <year>2000</year>;<volume>8</volume>(<issue>12</issue>):<fpage>1259</fpage>–<lpage>65</lpage>. <object-id pub-id-type="pmid">11188690</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keedy</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Georgiev</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Triplett</surname> <given-names>EB</given-names></name>, <name name-style="western"><surname>Donald</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>JS</given-names></name>. <article-title>The role of local backrub motions in evolved and designed mutations</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>8</issue>):<fpage>e1002629</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002629" xlink:type="simple">10.1371/journal.pcbi.1002629</ext-link></comment> <object-id pub-id-type="pmid">22876172</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Georgiev</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Keedy</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Donald</surname> <given-names>BR</given-names></name>. <article-title>Algorithm for backrub motions in protein design</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>13</issue>):<fpage>i196</fpage>–<lpage>204</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn169" xlink:type="simple">10.1093/bioinformatics/btn169</ext-link></comment> <object-id pub-id-type="pmid">18586714</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harbury</surname> <given-names>PB</given-names></name>, <name name-style="western"><surname>Plecs</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Tidor</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Alber</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>PS</given-names></name>. <article-title>High-resolution protein design with backbone freedom</article-title>. <source>Science</source>. <year>1998</year>;<volume>282</volume>(<issue>5393</issue>):<fpage>1462</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">9822371</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deis</surname> <given-names>LN</given-names></name>, <name name-style="western"><surname>Pemble</surname> <given-names>CWt</given-names></name>, <name name-style="western"><surname>Qi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hagarman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>JS</given-names></name>, <etal>et al</etal>. <article-title>Multiscale conformational heterogeneity in staphylococcal protein a: possible determinant of functional plasticity</article-title>. <source>Structure</source>. <year>2014</year>;<volume>22</volume>(<issue>10</issue>):<fpage>1467</fpage>–<lpage>77</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.str.2014.08.014" xlink:type="simple">10.1016/j.str.2014.08.014</ext-link></comment> <object-id pub-id-type="pmid">25295398</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frauenfelder</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Sligar</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Wolynes</surname> <given-names>PG</given-names></name>. <article-title>The energy landscapes and motions of proteins</article-title>. <source>Science</source>. <year>1991</year>;<volume>254</volume>(<issue>5038</issue>):<fpage>1598</fpage>–<lpage>603</lpage>. <object-id pub-id-type="pmid">1749933</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kohlhoff</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Shukla</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lawrenz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bowman</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Konerding</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Belov</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Cloud-based simulations on Google Exacycle reveal ligand modulation of GPCR activation pathways</article-title>. <source>Nat Chem</source>. <year>2014</year>;<volume>6</volume>(<issue>1</issue>):<fpage>15</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nchem.1821" xlink:type="simple">10.1038/nchem.1821</ext-link></comment> <object-id pub-id-type="pmid">24345941</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref044"><label>44</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Richardson</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Keedy</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>DC</given-names></name>. <chapter-title>“THE PLOT” THICKENS: MORE DATA, MORE DIMENSIONS, MORE USES</chapter-title>. <source>Biomolecular Forms and Functions: A Celebration of 50 Years of the Ramachandran Map</source>. <year>2013</year>:<fpage>46</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004507.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Word</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Lovell</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>LaBean</surname> <given-names>TH</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Zalis</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Presley</surname> <given-names>BK</given-names></name>, <etal>et al</etal>. <article-title>Visualizing and quantifying molecular goodness-of-fit: small-probe contact dots with explicit hydrogen atoms</article-title>. <source>J Mol Biol</source>. <year>1999</year>;<volume>285</volume>(<issue>4</issue>):<fpage>1711</fpage>–<lpage>33</lpage>. <object-id pub-id-type="pmid">9917407</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rivals</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Personnaz</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Taing</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Potier</surname> <given-names>MC</given-names></name>. <article-title>Enrichment or depletion of a GO category within a class of genes: which test?</article-title> <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>4</issue>):<fpage>401</fpage>–<lpage>7</lpage>. <object-id pub-id-type="pmid">17182697</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Winn</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Ballard</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Cowtan</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Dodson</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Emsley</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>PR</given-names></name>, <etal>et al</etal>. <article-title>Overview of the CCP4 suite and current developments</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source>. <year>2011</year>;<volume>67</volume>(<issue>Pt 4</issue>):<fpage>235</fpage>–<lpage>42</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1107/S0907444910045749" xlink:type="simple">10.1107/S0907444910045749</ext-link></comment> <object-id pub-id-type="pmid">21460441</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Word</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Lovell</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>DC</given-names></name>. <article-title>Asparagine and glutamine: using hydrogen atom contacts in the choice of side-chain amide orientation</article-title>. <source>J Mol Biol</source>. <year>1999</year>;<volume>285</volume>(<issue>4</issue>):<fpage>1735</fpage>–<lpage>47</lpage>. <object-id pub-id-type="pmid">9917408</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adams</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Afonine</surname> <given-names>PV</given-names></name>, <name name-style="western"><surname>Bunkoczi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>VB</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>IW</given-names></name>, <name name-style="western"><surname>Echols</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>PHENIX: a comprehensive Python-based system for macromolecular structure solution</article-title>. <source>Acta crystallographica Section D, Biological crystallography</source>. <year>2010</year>;<volume>66</volume>(<issue>Pt 2</issue>):<fpage>213</fpage>–<lpage>21</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004507.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berman</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Battistuz</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bhat</surname> <given-names>TN</given-names></name>, <name name-style="western"><surname>Bluhm</surname> <given-names>WF</given-names></name>, <name name-style="western"><surname>Bourne</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Burkhardt</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>The Protein Data Bank</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source>. <year>2002</year>;<volume>58</volume>(<issue>Pt 6 No 1</issue>):<fpage>899</fpage>–<lpage>907</lpage>. <object-id pub-id-type="pmid">12037327</object-id></mixed-citation></ref>
<ref id="pcbi.1004507.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yao</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dhanik</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Marz</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Propper</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kou</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Efficient algorithms to explore conformation spaces of flexible protein loops</article-title>. <source>IEEE/ACM Trans Comput Biol Bioinform</source>. <year>2008</year>;<volume>5</volume>(<issue>4</issue>):<fpage>534</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2008.96" xlink:type="simple">10.1109/TCBB.2008.96</ext-link></comment> <object-id pub-id-type="pmid">18989041</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>