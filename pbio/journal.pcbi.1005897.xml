<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00957</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005897</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical properties</subject><subj-group><subject>Viscosity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Physical chemistry</subject><subj-group><subject>Chemical properties</subject><subj-group><subject>Viscosity</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Materials science</subject><subj-group><subject>Materials physics</subject><subj-group><subject>Viscosity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Materials physics</subject><subj-group><subject>Viscosity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Finite element analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Software tools</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Software engineering</subject><subj-group><subject>Software tools</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Deformation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Damage mechanics</subject><subj-group><subject>Deformation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Polymer chemistry</subject><subj-group><subject>Macromolecules</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Fluctuating Finite Element Analysis (FFEA): A continuum mechanics software tool for mesoscale simulation of biomolecules</article-title>
<alt-title alt-title-type="running-head">Mesoscale simulation with Fluctuating Finite Element Analysis (FFEA)</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Solernou</surname> <given-names>Albert</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-6079-4506</contrib-id>
<name name-style="western">
<surname>Hanson</surname> <given-names>Benjamin S.</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9984-2720</contrib-id>
<name name-style="western">
<surname>Richardson</surname> <given-names>Robin A.</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-0135-0112</contrib-id>
<name name-style="western">
<surname>Welch</surname> <given-names>Robert</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1194-9273</contrib-id>
<name name-style="western">
<surname>Read</surname> <given-names>Daniel J.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4593-3547</contrib-id>
<name name-style="western">
<surname>Harlen</surname> <given-names>Oliver G.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2812-1651</contrib-id>
<name name-style="western">
<surname>Harris</surname> <given-names>Sarah A.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Physics and Astronomy, University of Leeds, Leeds, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>School of Chemistry, University College London, London, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>School of Mathematics, University of Leeds, Leeds, United Kingdom</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Astbury Centre for Structural and Molecular Biology, University of Leeds, Leeds, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Poisot</surname> <given-names>Timothée</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Universite de Montreal, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">s.a.harris@leeds.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>23</day>
<month>3</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>3</issue>
<elocation-id>e1005897</elocation-id>
<history>
<date date-type="received">
<day>15</day>
<month>6</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>11</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Solernou et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005897"/>
<abstract>
<p>Fluctuating Finite Element Analysis (FFEA) is a software package designed to perform continuum mechanics simulations of proteins and other globular macromolecules. It combines conventional finite element methods with stochastic thermal noise, and is appropriate for simulations of large proteins and protein complexes at the mesoscale (length-scales in the range of 5 nm to 1 μm), where there is currently a paucity of modelling tools. It requires 3D volumetric information as input, which can be low resolution structural information such as cryo-electron tomography (cryo-ET) maps or much higher resolution atomistic co-ordinates from which volumetric information can be extracted. In this article we introduce our open source software package for performing FFEA simulations which we have released under a GPLv3 license. The software package includes a C ++ implementation of FFEA, together with tools to assist the user to set up the system from Electron Microscopy Data Bank (EMDB) or Protein Data Bank (PDB) data files. We also provide a PyMOL plugin to perform basic visualisation and additional Python tools for the analysis of FFEA simulation trajectories. This manuscript provides a basic background to the FFEA method, describing the implementation of the core mechanical model and how intermolecular interactions and the solvent environment are included within this framework. We provide prospective FFEA users with a practical overview of how to set up an FFEA simulation with reference to our publicly available online tutorials and manuals that accompany this first release of the package.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000266</institution-id>
<institution>Engineering and Physical Sciences Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>EP/M004228/1</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Solernou</surname> <given-names>Albert</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This research was funded by the Engineering and Physical Sciences Research Council (<ext-link ext-link-type="uri" xlink:href="https://www.epsrc.ac.uk/" xlink:type="simple">https://www.epsrc.ac.uk/</ext-link>) through fellowship EP/M004228/1 received by AS. BSH and RAR were funded by studentships kindly provided by the Engineering and Physical Sciences Research Council. RW is funded through a William Wright Smith PhD Scholarship. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="19"/>
<table-count count="2"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-04-09</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The software, documentation and test suite are available from <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/ffea/ffea" xlink:type="simple">https://bitbucket.org/ffea/ffea</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The enormous complexity of biomolecules and their interactions means that molecular modelling and simulation have proven invaluable for interpreting experimental data and providing physical insight into biomolecular mechanisms [<xref ref-type="bibr" rid="pcbi.1005897.ref001">1</xref>]. At the atomistic and near-atomistic level, molecular dynamics (MD) simulations have been widely used to complement experimental structural data, and to include dynamical effects (such as thermal fluctuations) that are known to be important to function, but which are inaccessible experimentally. Computational advances over the past few decades have taken us from all-atom simulations of small molecules such as bovine pancreatic trypsin inhibitor, with only 58 residues [<xref ref-type="bibr" rid="pcbi.1005897.ref002">2</xref>], to simulations of huge macromolecular systems such as the HIV-1 capsid [<xref ref-type="bibr" rid="pcbi.1005897.ref003">3</xref>], containing a staggering 64 million atoms in total. The new field of structural systems biology has enabled comprehensive 3D models of cell-scale structures to be constructed in molecular [<xref ref-type="bibr" rid="pcbi.1005897.ref004">4</xref>]and atomistic detail [<xref ref-type="bibr" rid="pcbi.1005897.ref005">5</xref>] for future simulations. High-resolution simulations of these systems will allow computational biophysicists to understand how nanoscale structure and dynamics give rise to biological function, effectively a ‘computational microscope’ into the biological world [<xref ref-type="bibr" rid="pcbi.1005897.ref006">6</xref>].</p>
<p>At large length-scales, from the micron upwards, a representation based on continuum mechanics is often a more suitable and efficient way to describe the evolution of a system. Methods built on continuum fluid mechanics such as Lattice-Boltzmann can be used for simulations of the flow of biological fluids [<xref ref-type="bibr" rid="pcbi.1005897.ref007">7</xref>], and finite element methods are routinely employed for solid tissue modelling [<xref ref-type="bibr" rid="pcbi.1005897.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005897.ref009">9</xref>].</p>
<p>Mesoscopic processes that occur over time-scales of milliseconds to seconds and length-scales of between 10 nm and 1 μm, such as the walking of cytoplasmic dynein along microtubules [<xref ref-type="bibr" rid="pcbi.1005897.ref010">10</xref>], the aggregation of fibrin molecules during blood clotting [<xref ref-type="bibr" rid="pcbi.1005897.ref011">11</xref>], and the assembly of the kinetochore during cell division [<xref ref-type="bibr" rid="pcbi.1005897.ref012">12</xref>], are also crucial to biological function. For these intermediate mesoscopic length-scales and time-scales there are fewer computational tools available. Coarse-graining strategies to access larger length and time-scales than atomistic techniques have most commonly been “bottom-up”. Single atoms are clustered into larger beads, and interactions are described by potentials of mean force which may either be knowledge-based or derived from physical principles [<xref ref-type="bibr" rid="pcbi.1005897.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1005897.ref015">15</xref>]. Most of the commonly used coarse-grained models are relatively high resolution, and thus only provide modest increases in accessible system sizes. Highly coarse grained methods, such as Dissipative Particle Dynamics [<xref ref-type="bibr" rid="pcbi.1005897.ref016">16</xref>] or Ultra-Coarse-Graining theory [<xref ref-type="bibr" rid="pcbi.1005897.ref017">17</xref>] are also active areas of development. The latter provides a physical rationale for systematically clustering large parts of a biomolecule (such as an individual protein domain) into a single bead, that is itself able to reside in different internal meta-states. Similarly, particle-based reaction-diffusion dynamics [<xref ref-type="bibr" rid="pcbi.1005897.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005897.ref019">19</xref>] has been used as a simplified model to study the diffusion, reaction and self-assembly of biomolecules in cellular environments.</p>
<p>Other techniques allowing access to the mesoscale involve treating macromolecules as rigid bodies. These models have provided vital information about protein diffusion [<xref ref-type="bibr" rid="pcbi.1005897.ref020">20</xref>], cytoplasmic crowding [<xref ref-type="bibr" rid="pcbi.1005897.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005897.ref021">21</xref>], and pathways for the assembly of virus capsids [<xref ref-type="bibr" rid="pcbi.1005897.ref022">22</xref>], but their method of coarse-graining discounts the effects of protein deformation on diffusional dynamics, so cannot be used for highly dynamic biomolecules such as molecular motors. Until recently, there was also a paucity of experimental structural information available for biomolecular complexes at the mesoscale, due to the technical challenges involved in preserving delicate macromolecular complexes in their intact, native states. However, recent advances in biophysical tools such as cryo-electron microscopy and tomography [<xref ref-type="bibr" rid="pcbi.1005897.ref023">23</xref>] and super-resolution microscopy are now starting to generate a wealth of structural and dynamic information at precisely this length-scale. Integrative modelling [<xref ref-type="bibr" rid="pcbi.1005897.ref024">24</xref>] is an effort to characterise large macromolecular assemblies by combining complementary experimental information from multiple sources, but it does not provide a means to study protein mechanics.</p>
<p>In response, we have developed a new software tool “Fluctuating Finite Element Analysis” (FFEA) which uses a continuum representation of biomolecules, thereby modelling the mesoscale “top down”, rather than “bottom up”. It represents the volumetric shape of proteins using a 3D tetrahedral finite element mesh to which we apply thermal fluctuations, providing a dynamic trajectory showing how the protein changes shape over time due to its own structure and in response to its interactions with other molecules [<xref ref-type="bibr" rid="pcbi.1005897.ref025">25</xref>]. The initial co-ordinates for constructing the finite element mesh can come directly from 3D volumetric data, such as cryo-electron tomography maps, or from atomistic structures following an appropriate effective surface calculation method. Algorithms for calculating atomic surfaces based on solvent accessibility or electrostatic repulsion are readily available, implemented within existing visualisation software such as Chimera [<xref ref-type="bibr" rid="pcbi.1005897.ref026">26</xref>] or VMD [<xref ref-type="bibr" rid="pcbi.1005897.ref027">27</xref>].</p>
<p>FFEA uses a viscoelastic constitutive model to represent the continuous deformation of the enclosed volume. This model describes the protein mechanics in such a way that the biomolecule will always relax back towards its equilibrium shape following an external perturbation in a dissipative manner, rather than partially retaining induced deformation via creep effects. The protein models are parameterised by assigning continuum material parameters to the finite element mesh (presently two elastic moduli and two dynamic internal viscosities, though more complicated constitutive models are possible), which define how compliant and dissipative the macromolecule will be when subject to thermally induced deformation. Protein-protein interactions are modelled by a volume exclusion term, preventing different biomolecules occupying the same space within a simulation, together with a short range attractive term, the magnitude and range of which are chosen by the user to best mimic the strength of the specific interaction of interest.</p>
<p>FFEA is designed to operate over length-scales of between 5 nm and 1 μm, which encompasses large macromolecular and subcellular structures such as the nuclear pore complex, the kinetochore, the sarcomere, the axoneme and the cytoskeleton, for example. At this higher level of biomolecular structure and organisation, it is potentially more instructive to consider whole proteins, rather than atoms or molecular subunits, as comprising the fundamental irreducible unit in the simulation. At this scale the proteins are soft nanoscale objects that operate in an environment dominated by thermal noise. Additionally, FFEA has no upper length-scale as, in systems that are sufficiently large, the thermal effects become negligible and FFEA naturally reduces to conventional finite element analysis. At this upper limit, however, well established finite element analysis software can, and should, be used in its place to eliminate the now superfluous calculations of thermal fluctuations. Conversely, since the continuum approximation breaks down when elements comprising the mesh become smaller than ∼5 Å, there is a fundamental limit on the resolution of the method, below which coarse-grained or atomistic MD is more appropriate.</p>
<p>The physical properties of an FFEA protein model share some similarities with Gaussian or Elastic Networks [<xref ref-type="bibr" rid="pcbi.1005897.ref028">28</xref>], which use a network of beads and harmonic springs to represent the structure and dynamics of proteins, and which therefore capture approximately the elastic component of the FFEA viscoelastic constitutive model. This similarity between conventional finite element analysis and network models has been studied previously [<xref ref-type="bibr" rid="pcbi.1005897.ref029">29</xref>]. However, while many (although not all) Gaussian/Elastic Network models only include unbreakable harmonic interactions to simplify the solution of the equations of motion, within FFEA we can represent non-bonded interactions between and within individual proteins within a complex. Moreover, in FFEA the volumetric space within each finite element is filled with material, while in particle-spring models it remains empty. For very large macromolecules, especially those containing irregular shapes such as very long coiled-coil regions, it can be difficult to ensure that beads are sufficiently closely spaced within a Gaussian/Elastic network model to maintain the shape of the complex and to prevent steric overlap between the different proteins in the simulation. Continuum FFEA models also naturally include torsional rigidity, which can be particularly important to the dynamics of irregular and non-spherical proteins, and indeed such differences with Elastic Network Models have been shown in the case of Vacuolar-type ATPases [<xref ref-type="bibr" rid="pcbi.1005897.ref030">30</xref>].</p>
<p>In this paper we present an open source software package that implements FFEA. The package is licensed under GPLv3 and can be downloaded from <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/ffea/ffea" xlink:type="simple">https://bitbucket.org/ffea/ffea</ext-link>. The paper begins with a description of the internal mechanics involved in FFEA and our treatment of protein-protein interactions. We then describe how the resulting algorithms have been implemented within the FFEA code base and the overall structure of the software package, along with the accompanying visualisation and analysis tools, user tutorials, documentation and test suite. Next, we demonstrate the use of FFEA in modelling the molecular chaperone GroEL. Finally, we discuss the future directions for FFEA and for computational exploration of the biomolecular mesoscale more generally. For readers interested in the mathematical background to this work, further detail is provided as supplementary material in the <xref ref-type="supplementary-material" rid="pcbi.1005897.s001">S1 File</xref>.</p>
<p>In the following sections we describe how the protein mechanics are represented within FFEA, and explain how the effect of the solvent environment, protein-protein interactions and structural restraints have been modelled.</p>
<sec id="sec002">
<title>Physics of FFEA</title>
<p>FFEA describes the time evolution of a system of <italic>N</italic> interacting viscoelastic bodies subject to thermal fluctuations. In viscoelastic bodies, the mechanical response to stress depends not only on the strain (as in purely elastic bodies) but also on the strain rate (as in viscous fluids). We model viscoelasticity through the Kelvin-Voigt constitutive model, allowing the viscous and elastic stresses to be calculated separately. This is one of the simplest models that replicates the stress response of viscoelastic solids. Therefore, we write the equation of motion (Cauchy’s momentum equation):
<disp-formula id="pcbi.1005897.e001"><alternatives><graphic id="pcbi.1005897.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:mi>ρ</mml:mi> <mml:mfrac><mml:mrow><mml:mi>D</mml:mi> <mml:mi mathvariant="bold-italic">u</mml:mi></mml:mrow> <mml:mrow><mml:mi>D</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>∇</mml:mo> <mml:mo>·</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mi>v</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mi>e</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold-italic">π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi mathvariant="bold-italic">f</mml:mi></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>ρ</italic> is the density, <italic>D<bold>u</bold></italic>/<italic>Dt</italic> the material derivative of the velocity with respect to time, <bold><italic>σ</italic></bold><sup><italic>v</italic></sup> the viscous stress, <bold><italic>σ</italic></bold><sup><italic>e</italic></sup> the elastic stress and <bold><italic>f</italic></bold> is the external force density. Additionally, we include stochastic thermal noise as an additional component of stress, <bold><italic>π</italic></bold>. A detailed mathematical description of these terms can be found in the <xref ref-type="supplementary-material" rid="pcbi.1005897.s001">S1 File</xref>.</p>
<p>Within the Kelvin-Voigt model, the elastic stress can be independently derived from a strain energy density functional. We chose a constitutive model able to model compressibility, which in our case consists of a hyperelastic response to shear deformation combined with an isotropic resistance to changes in volume. This requires that the user specifies both bulk and shear moduli for the biomaterial. Different sections of a biomolecule may be assigned different values for these moduli.</p>
<p>The internal viscosity of the biomolecule itself arises from an internal friction and therefore has an associated energy loss. At finite temperature, this viscosity is fundamentally coupled to the statistical distribution of the stochastic thermal noise experienced by the molecule (as discussed in more detail below). We model the viscous stress as that of a Newtonian fluid, linear with respect to the strain rate. This requires that the user specifies both bulk and shear viscosities for the biomaterial, which again may be inhomogeneous throughout the volume.</p>
<p>In addition to the internal viscosity, we also define an external viscosity component resulting from interactions with the solvent in which the biomolecule is immersed. We include this effect by assigning an additional local viscous drag force to each node that is proportional to its own velocity relative to a fixed background, together with a corresponding fluctuating thermal force with statistics that satisfy the fluctuation-dissipation theorem (this treatment is equivalent to standard Langevin Dynamics). The local nature of the solvent interaction means that there is presently no inter-molecular hydrodynamic coupling between biomolecules, as there are no correlations between the frictional and thermal forces between nodes in different molecules. Within a single molecule, some hydrodynamic coupling is mediated through the internal viscosity, but not through the external solvent. The importance of hydrodynamic effects in biomolecular systems has been extensively debated [<xref ref-type="bibr" rid="pcbi.1005897.ref031">31</xref>], and a possible treatment, if necessary, could be implemented in the future by coupling the finite element mesh to the solvent using a suitable boundary element method.</p>
<sec id="sec003">
<title>Thermal noise within the protein and the effect of the external solvent</title>
<p>From <xref ref-type="disp-formula" rid="pcbi.1005897.e001">Eq 1</xref>, <bold><italic>π</italic></bold> is the total stochastic thermal stress which provides energy to the protein model in the form of thermal fluctuations. The values of this term are therefore random, but statistically distributed to fulfill the fluctuation-dissipation theorem so that at equilibrium, the kinetic and strain energies of each degree of freedom are correctly distributed. Contributions to <bold><italic>π</italic></bold> come from both internal thermal fluctuations, arising from a coupling to the internal viscosity of the biomolecule, as well as the external thermal fluctuations of the solvent which are coupled to the external solvent viscosity.</p>
<p>Following an approach equivalent to that used by Sharma and Patankar [<xref ref-type="bibr" rid="pcbi.1005897.ref032">32</xref>], our stress tensor is <italic>δ</italic>-correlated in both time and space, and since our viscous dissipation depends only upon the instantaneous deformation rate, this approach allows the fluctuating stress to be calculated entirely locally. It follows that each contribution to the thermal stress, whether arising from internal or external viscosities, is statistically independent and can be individually coupled to their respective viscosities to ensure the correct thermodynamic behaviour. In FFEA, the user has control as to whether to include thermal fluctuations to the simulation or not, and can also choose whether or not to include an external solvent. Input parameters for the temperature and the external viscosity are read from the input file.</p>
</sec>
<sec id="sec004">
<title>Discretisation and protein dynamics</title>
<p>We employ the finite element method to solve <xref ref-type="disp-formula" rid="pcbi.1005897.e001">Eq 1</xref> in the general case by discretizing the material into simple geometric elements. We use tetrahedral elements in which the material velocity is linearly interpolated between the values at the vertices of the tetrahedra, which are also called <italic>nodes</italic> within the finite element framework. Whilst other element geometries are possible, for example hexahedral bricks, tetrahedra are preferable for two reasons. First, it is always possible to create a tetrahedral mesh from a set of points in a body. Second, this provides an implementation for the thermal noise which is local to each element.</p>
<p>The resulting discretised equation of motion is given by:
<disp-formula id="pcbi.1005897.e002"><alternatives><graphic id="pcbi.1005897.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:mi>d</mml:mi> <mml:msub><mml:mi>v</mml:mi> <mml:mi>q</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mo>Λ</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mi>q</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>O</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where the summation convention implies a sum over the index <italic>q</italic>. The indices <italic>p</italic> and <italic>q</italic> correspond to the three spatial coordinates for each node in the mesh. Here, <italic>v</italic><sub><italic>q</italic></sub> is a component of velocity, <italic>M</italic><sub><italic>pq</italic></sub> is the mass matrix which distributes the density contained within an element to its associated nodes, and Λ<sub><italic>pq</italic></sub> the viscosity matrix resulting from internal and external viscosities. <italic>E</italic><sub><italic>p</italic></sub> is the elastic force vector which, although conservative, is a non-linear function of node position. Finally, <italic>N</italic><sub><italic>p</italic></sub> is the stochastic noise force vector, and <italic>O</italic><sub><italic>p</italic></sub> represents all additional conservative external forces. By following the trajectory of each node we can determine the volumetric deformation of each element. This captures the continuum nature of the protein and is therefore fundamentally different from standard bead-spring models. The contents of the mass matrix, <italic>M</italic><sub><italic>pq</italic></sub>, for example depends on how the <italic>density</italic> of the material varies throughout the biomolecule, rather than assigning a mass explicitly to each node. In our own simulations we have generally assumed the density to be homogeneous, but our software permits material inhomogeneity as well.</p>
</sec>
<sec id="sec005">
<title>Temporal discretisation</title>
<p>In order to solve <xref ref-type="disp-formula" rid="pcbi.1005897.e002">Eq 2</xref> we must also introduce a numerical integration scheme. The simplest scheme to use is a forward Euler scheme in which the time derivative is replaced by the finite difference: [<italic>v</italic><sub><italic>q</italic></sub>(<italic>t</italic> + Δ<italic>t</italic>) − <italic>v</italic><sub><italic>q</italic></sub>(<italic>t</italic>)]/Δ<italic>t</italic> for a time-step Δ<italic>t</italic>. This first-order scheme was found to give an acceptable trade-off between accuracy and computational speed in the original implementation of FFEA [<xref ref-type="bibr" rid="pcbi.1005897.ref025">25</xref>]. Thermal equilibration tests verifying this are included in the FFEA test suite, and are discussed later.</p>
<p>However, in cases where the mass is small, this requires very small time-steps for stability. As discussed in [<xref ref-type="bibr" rid="pcbi.1005897.ref033">33</xref>], for many biomolecular applications, the time-scale over which the mass affects the dynamics is often small compared to the time-scale of interest, and in these cases it is more efficient to seek an implicit solution in which we assume, as in the case of Brownian dynamics, that the motion relaxes rapidly to the velocity at which the forces are in equilibrium. By seeking the solution of <xref ref-type="disp-formula" rid="pcbi.1005897.e002">Eq 2</xref> for which the LHS is zero, we obtain:
<disp-formula id="pcbi.1005897.e003"><alternatives><graphic id="pcbi.1005897.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Λ</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mi>q</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>O</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
From here on, Eqs <xref ref-type="disp-formula" rid="pcbi.1005897.e002">2</xref> and <xref ref-type="disp-formula" rid="pcbi.1005897.e003">3</xref> will be referred to later in the text respectively as the Langevin and Brownian equations for FFEA. The software allows the user to choose either equation of motion for each individual biomolecule involved in the system.</p>
</sec>
</sec>
<sec id="sec006">
<title>Protein-protein interactions within FFEA</title>
<p>The interactions between different viscoelastic biological bodies, or <italic>blobs</italic> (BioLOgical BodieS), are taken into account through the body forces in <bold><italic>f</italic></bold>, which transforms into the vector <italic>O</italic><sub><italic>p</italic></sub> following the application of the finite element method.</p>
<sec id="sec007">
<title>Steric repulsion within FFEA</title>
<p>We have introduced a soft potential energy term specifically to describe steric repulsion. In this scheme, interacting <italic>blobs</italic> gain an unfavourable positive energy that is proportional to their intersecting volume. Since this is path-independent, the resulting repulsive force is conservative. Furthermore the total overlapping volume, <italic>V</italic>, is equal to the sum of the overlapping tetrahedra, and therefore the calculation of this energy is independent of how the system is partitioned, facilitating algorithm parallelisation. The resulting repulsive force between two tetrahedra is calculated as the numerical gradient of this intersecting volume <bold><italic>F</italic></bold><sub><italic>steric</italic></sub> = −∇<italic>V</italic>, and applied at the centre of the overlapping volume elements. We then use the finite element method to linearly interpolate this onto the nodes of the interacting elements (see <xref ref-type="fig" rid="pcbi.1005897.g001">Fig 1</xref>). To lessen the computational load as much as possible, this steric overlap term is only computed for tetrahedra at the blob surface, the list of which is calculated at the beginning of the simulation. Implementing the steric overlap term requires FFEA to identify all interacting face pairs from this list, which can be quickly achieved using an algorithm developed by Ganovelli <italic>et al.</italic> [<xref ref-type="bibr" rid="pcbi.1005897.ref034">34</xref>]. The intersecting volume is then efficiently calculated using the method of Franklin and Kankanhalli [<xref ref-type="bibr" rid="pcbi.1005897.ref035">35</xref>].</p>
<fig id="pcbi.1005897.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g001</object-id>
<label>Fig 1</label>
<caption>
<title>2D illustration of the steric repulsion implemented in FFEA, where 3D tetrahedra have been reduced to triangles.</title>
<p>The intersecting elements <italic>a</italic> and <italic>b</italic> gain a positive energy proportional to the area enclosed by their intersection, <italic>V</italic> (labelled <italic>V</italic> as it is a volume intersection in 3D). The repulsive force resulting from the negative spatial gradient of <italic>V</italic> is applied at the centre of the enclosed volume, and interpolated linearly onto the nodes of the two involved elements.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Attractive interactions within FFEA</title>
<p>In particle-based atomistic and coarse-grained simulations, Lennard-Jones (LJ) interactions are commonly used to represent short range attractive forces and to suppress steric overlap. We have implemented an equivalent potential function in the continuum regime within FFEA using surface-surface interactions. The force per unit area exerted at a point <bold><italic>s</italic></bold> on the surface Γ<sub><italic>s</italic></sub> due to another surface Γ<sub><italic>t</italic></sub> can be written as:
<disp-formula id="pcbi.1005897.e004"><alternatives><graphic id="pcbi.1005897.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∫</mml:mo> <mml:msub><mml:mo>Γ</mml:mo> <mml:mi>t</mml:mi></mml:msub></mml:msub> <mml:mi mathvariant="bold-italic">f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msub><mml:mi>A</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <bold><italic>t</italic></bold> is a point on the surface Γ<sub><italic>t</italic></sub>, and <bold><italic>f</italic></bold>(<bold><italic>s</italic></bold>, <bold><italic>t</italic></bold>) is a force per unit area at point <bold><italic>s</italic></bold> per unit area at <bold><italic>t</italic></bold> with the LJ form:
<disp-formula id="pcbi.1005897.e005"><alternatives><graphic id="pcbi.1005897.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi mathvariant="bold-italic">f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>12</mml:mn><mml:mi>ϵ</mml:mi></mml:mrow><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>13</mml:mn></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>r</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">s</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>7</mml:mn></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">r</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>r</italic>(<bold><italic>s</italic></bold>, <bold><italic>t</italic></bold>) is the distance between any points <bold><italic>s</italic></bold> and <bold><italic>t</italic></bold>, <italic>r</italic><sup><italic>eq</italic></sup> is the equilibrium distance for this interaction and <italic>ϵ</italic> is the energy minimum occurring at <italic>r</italic>(<bold><italic>s</italic></bold>, <bold><italic>t</italic></bold>) = <italic>r</italic><sup><italic>eq</italic></sup>. Discretising the volume of the interacting biomolecules into tetrahedra has the effect of partitioning the surfaces into sets of triangles, or faces. Including these LJ interactions results in attracting but impenetrable patches that when discretised into surface-surface interactions are computed through the double sum over all faces in the system. A detailed description on how this is computed within FFEA is provided in the <xref ref-type="supplementary-material" rid="pcbi.1005897.s001">S1 File</xref>.</p>
<p>While the Lennard Jones potential provides a convenient method for describing mid-range attractive and short-range repulsive interactions using a single potential, the hard-core nature of the repulsive potential introduces computational difficulties, as a very short time-step is required to avoid energy escalation from inter-penetration of proteins during the simulation. This can be solved by employing a combination of the steric and Lennard-Jones potentials, where the former accounts for the hard-core repulsion and the latter for the attraction. To transition between the two regimes when 0 &lt; <italic>r</italic>(<bold><italic>s</italic></bold>, <bold><italic>t</italic></bold>) &lt; <italic>r</italic><sup><italic>eq</italic></sup>, we use an analytical polynomial interpolation designed to be continuous in both force and energy.</p>
</sec>
<sec id="sec009">
<title>Precomputed potentials in FFEA</title>
<p>To improve the modelling flexibility within FFEA, we have implemented the ability to include precomputed tabular potentials as external forces. This is a common approach in molecular modelling packages, such as Gromacs [<xref ref-type="bibr" rid="pcbi.1005897.ref036">36</xref>] or NAMD [<xref ref-type="bibr" rid="pcbi.1005897.ref037">37</xref>], allowing FFEA to incorporate specific interactions between functional elements. For situations where experimental information for biomolecular affinities are unavailable, these can be obtained by coarse-graining from atomistic MD simulations. This procedure provides sets of pair-wise interaction forces as a function of the separations of predefined ‘pseudo-particles’ which are considered to be the interacting units during coarse-graining. Once these potentials have been defined, interacting beads are embedded within the volumes of the finite element meshes (see <xref ref-type="fig" rid="pcbi.1005897.g002">Fig 2</xref>), so that each pseudo-particle bead is permanently associated with the tetrahedra having the closest centroid in the initial configuration of the FE mesh. The resulting force calculated from the gradient of this potential is then linearly interpolated throughout the corresponding elements to the nodes, again using the finite element shape functions, and included in the force vector <italic>O</italic><sub><italic>p</italic></sub>.</p>
<fig id="pcbi.1005897.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Five different bead types (shown in different colours) control the interactions of the stalk of the dynein molecular motor (pink) and the microtubule track (blue).</title>
<p>Each bead is assigned to an element of the mesh, and the forces resulting from the tabulated interaction potentials between beads are interpolated linearly onto the nodes of the elements, thus transmitting the force to the corresponding body.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g002" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec010">
<title>Harmonic restraints and frozen nodes within FFEA</title>
<p>It is often useful to include harmonic restraints within biomolecular simulations, either to maintain a particular biomolecular configuration, or to steer an existing conformation into a new state. In FFEA, harmonic restraints can be imposed using Hookean springs to form a simple link between pairs of nodes. The equilibrium distance and the force constant of the Hookean potential can be defined by the user.</p>
<p>The utility to completely freeze the position of either an entire macromolecule, or a selected subset of nodes within a macromolecule, over the course of a simulation is also available. These rigid restraints could be used, for example, to simulate large structures such as microtubules. These superstructures do not deform significantly compared to smaller, more flexible proteins, yet they still interact sterically and through short-range attractive forces, such as at specific binding sites. Rigid restraints reduce the computational load and simplify calculations for simulations involving these kinds of structures.</p>
</sec>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Design and implementation</title>
<p>The FFEA software package is divided into two parts. The “FFEA Runner” is a C ++ implementation of the FFEA algorithms, which computes trajectories containing information on how the thermally fluctuating viscoelastic objects within the simulation change shape and interact with one another. “FFEA Tools” are provided for users to set up the FFEA simulations themselves and to analyse the resulting trajectories. These tools are composed of a Python package with a full Application Programming Interface (API), a viewer implemented as a plugin for PyMOL, and a collection of Python analysis tools under a single command interface.</p>
<p>Setting up a system and performing an FFEA simulation is accomplished via a command line interface. We have provided detailed documentation accompanying the package that can be either read directly from the text files, or built using Doxygen [<xref ref-type="bibr" rid="pcbi.1005897.ref038">38</xref>], a documentation generating tool, and viewed in a web browser. The whole FFEA package, including the documentation, can be freely downloaded and easily configured on any UNIX platform using CMake, while the Python package within the FFEA tools can be installed on its own using Python <monospace>setuptools</monospace>. We have also successfully built the software using the Windows 10 subsystem for Linux. Furthermore, compiled packages for Linux x86 machines are also provided.</p>
<sec id="sec012">
<title>FFEA runner</title>
<sec id="sec013">
<title>General overview</title>
<p>The overall structure of the FFEA code is analogous to a conventional molecular dynamics program. Following an initialisation phase, a loop of <italic>n</italic><sub><italic>t</italic></sub> time-steps is performed, within each of which the program determines all forces affecting each body and subsequently integrates the equations of motion to move the system forward in time. Every <italic>n</italic><sub><italic>c</italic></sub> steps the program outputs the details of the simulation (positions and all quantities required for restart, together with the configurational energy, centre of masses, RMSD, etc).</p>
<p>Within each time-step, the calculation of the forces is deterministic except for the thermal force. Since it is a stochastic function, the thermal force requires a suitable pseudo-random number generator (RNG) to calculate reliably each value and retain the correct statistical properties throughout the simulations. The FFEA software package uses, and is distributed with, an implementation of the random number generator (RNG) RngStreams [<xref ref-type="bibr" rid="pcbi.1005897.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005897.ref040">40</xref>]. This provides a large number of long, uncorrelated streams (period 2<sup>127</sup>), and has the ability to save the state of each active stream at any point, which is essential to stopping and restarting FFEA calculations while avoiding any risk of having correlated random numbers [<xref ref-type="bibr" rid="pcbi.1005897.ref041">41</xref>]. Adaptations of RngStreams are used in a number of software packages such as Arena, Automod, Inosim, Matlab, R, SAS, and others.</p>
<p>FFEA is parallelised using OpenMP, and two executables are produced by compiling the code using different compiler flags automatically through through CMake (ffea and ffea_mb). Under the first scheme (ffea), several loops running over the number of elements and nodes are parallelised, while under the second scheme (ffea_mb) loops running over the different bodies are parallelised. The “loop over bodies” scheme performs better in systems where multiple <italic>blobs</italic> are simulated, as it includes fewer synchronisation points, while the “loop over elements” scheme is appropriate for cases where a single large <italic>blob</italic> is simulated. For each initialised thread in either scheme, RngStreams is able to provide a separate RNG stream local to that thread. Each stream remains uncorrelated from all others as well as itself over the course of the simulation. This increases the computational robustness of the scheme, with a view to future development of the parallelisation procedures.</p>
</sec>
<sec id="sec014">
<title>Face-face interactions</title>
<p>Within the code structure, the Lennard-Jones and steric interactions are implemented as interactions between <italic>faces</italic>, not <italic>nodes</italic>. As it is a softer potential, steric repulsion is the recommended option to keep molecules from passing through one another, whether combined with Lennard-Jones interactions or not. For a system with <italic>N</italic><sub><italic>f</italic></sub> interacting faces in total, the total number of face-face interactions to be calculated in a given time-step can be reduced from <inline-formula id="pcbi.1005897.e006"><alternatives><graphic id="pcbi.1005897.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msubsup><mml:mi>N</mml:mi> <mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> to a much lower number of calculations using linked-lists [<xref ref-type="bibr" rid="pcbi.1005897.ref042">42</xref>]. In this algorithm, the simulation box is tiled into tessellating cuboidal cells, or <italic>voxels</italic>, and each potentially interacting face is assigned to the voxel where it has its centroid, an <italic>O</italic>(<italic>N</italic><sub><italic>f</italic></sub>) operation. At every time-step, face-face interactions are calculated only for pairs assigned to the same or adjacent voxels, significantly reducing the computational cost of the face-face interactions, which are usually <inline-formula id="pcbi.1005897.e007"><alternatives><graphic id="pcbi.1005897.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mi>O</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, whilst retaining physical accuracy. Updating this linked-list structure is performed every <italic>n</italic><sub><italic>nl</italic></sub> time-steps as a background operation, using a specific task thread, and both the size of the voxels and <italic>n</italic><sub><italic>nl</italic></sub> can be controlled from the input file. The voxel size should ideally be slightly larger than the interaction range, which corresponds to the desired cutoff on the Lennard-Jones potential, or roughly half of the length of the largest edge in the steric potential.</p>
<p>Further reduction in computational cost comes from only considering faces pointing towards each other i.e., <bold><italic>n</italic></bold><sub>1</sub> · <bold><italic>n</italic></bold><sub>2</sub> &lt; 0 (where <bold><italic>n</italic></bold><sub><italic>i</italic></sub> is the normal vector to the face <italic>i</italic>) which avoids transmitting the interaction through the protein interior as well as acting as a fast numerical check before computing the full face-face interaction.</p>
<p>In addition to the parameters related to the linked-lists, users can assign a ‘type’ to each of the faces. Each type, <italic>t</italic>, is simply an integer such that −1 ≤ <italic>t</italic> &lt; <italic>N</italic><sub><italic>t</italic></sub>. In the current implementation, <italic>N</italic><sub><italic>t</italic></sub> = 7 but can be increased if needed. <italic>t</italic> = −1 represents an inactive face, which will not interact with anything, and the remaining indices represent different active types. Therefore, for each interacting face pair there exists an associated type pair, {<italic>t</italic>, <italic>s</italic>}. Steric interactions only check whether a face is active or inactive before performing a calculation, whereas LJ interactions consider the different types. For each possible pair interaction type pair, the user is able to provide different associated LJ parameters <inline-formula id="pcbi.1005897.e008"><alternatives><graphic id="pcbi.1005897.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>s</mml:mi></mml:mrow> <mml:mrow><mml:mi>e</mml:mi> <mml:mi>q</mml:mi></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> and <italic>ϵ</italic><sub><italic>ts</italic></sub> for that interaction type. Thus, FFEA allows a large number of different LJ type interactions within the same simulation.</p>
</sec>
<sec id="sec015">
<title>Pre-computed potentials</title>
<p>The set up procedure when using pre-computed potentials associates each bead with the element having the closest centroid. The user has the freedom to restrict this global search to a provided range of elements. The viewer can be of help when finding the relevant element indices.</p>
<p>The tabulated potential is then read in from external files, one for each bead-pair type. If a file is not found for a certain type of bead-pair, the interaction is considered null. At every time-step, the absolute position for every bead is calculated together with the energies and the forces, using the same linked lists algorithm and associated background update used in face-face interactions. The resulting dynamics are implemented by interpolating the forces linearly onto the nodes of the corresponding elements.</p>
</sec>
<sec id="sec016">
<title>Linear elastic model and time-scale calculator</title>
<p>Before performing a full non-linear simulation of the stochastic equations Eqs <xref ref-type="disp-formula" rid="pcbi.1005897.e002">2</xref> or <xref ref-type="disp-formula" rid="pcbi.1005897.e003">3</xref>, we have found it is convenient to obtain an initial and rapid appreciation of the expected modes and range of motion of an individual molecule due to thermal fluctuation together with an estimate of typical time-scales for the motion. This is possible via a linear approximation to the elastic force vector in Eqs <xref ref-type="disp-formula" rid="pcbi.1005897.e002">2</xref> or <xref ref-type="disp-formula" rid="pcbi.1005897.e003">3</xref>. We have integrated additional tools in the main FFEA code to implement this process: these are, the “linear elastic model” (LEM) and “time-scale calculator”.</p>
<p>The main equations of motion Eqs <xref ref-type="disp-formula" rid="pcbi.1005897.e002">2</xref> and <xref ref-type="disp-formula" rid="pcbi.1005897.e003">3</xref> both contain the elastic force vector, <bold><italic>E</italic></bold>, which is a non-linear function of deformation. A linear expansion of this vector with respect to the initial node positions generates a spring constant matrix, <italic>K</italic><sub><italic>pq</italic></sub>, which defines the effective linear elastic constants between each pair of nodes. Diagonalisation of this matrix gives a set of eigenvectors corresponding to the normal modes of motion of the system, and the associated eigenvalues the relative stiffness of each mode. The user can output this both as raw data and in the form of FFEA trajectories, the collection of which we term the FFEA linear elastic model.</p>
<p>In addition, suitable combinations of both the mass matrix and the spring constant matrix with the viscosity matrix give two matrices containing approximate time-constants, <italic>τ</italic><sub><italic>pq</italic></sub>, for the system. Diagonalisation of these matrices will generate the full spectrum of time-scales within the system, allowing the user to make a more educated choice on both their simulation time-step (from the shortest relaxation time), and the total length of simulation required (from the longest relaxation time). More detail on these subroutines can be found in the <xref ref-type="supplementary-material" rid="pcbi.1005897.s001">S1 File</xref>.</p>
</sec>
</sec>
<sec id="sec017">
<title>FFEA tools</title>
<p>Accompanying the FFEA runner, we have also developed the complementary Python package <monospace>ffeatools</monospace>, to aid users in setting up a system for an FFEA simulation and to analyse the resulting trajectories. The core of this toolkit is a collection of Python modules that define classes associated with the various FFEA structures and file formats (<xref ref-type="fig" rid="pcbi.1005897.g003">Fig 3</xref> depicts how data is structured for both the runner and the tools). These modules form the core of the toolkit, standardising the method of interfacing with the <monospace>ffeatools</monospace> package.</p>
<fig id="pcbi.1005897.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Diagram of the structure of data in FFEA.</title>
<p>The same structure is used both in the “runner” and in the “tools”.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g003" xlink:type="simple"/>
</fig>
<p>Additionally, the <monospace>ffeatools</monospace> package also forms the core of a set of programs centralised under a top-level script with the same name. The aim of these programs is to assist the user by automating routine operations. For example:
<disp-formula id="pcbi.1005897.e009"><alternatives><graphic id="pcbi.1005897.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>ffeatools</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>pdbtoemmap</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>example.pdb</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>example.map</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>50</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>50</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>50</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>15</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
will ask <monospace>ffeatools</monospace> to run <monospace>pdbtoemmap</monospace>, a program that will take the atomic data in “example.pdb” and convert it into a 50×50×50 voxel electron density map “example.map” using an effective atomic radius of 15 Å. Each of the specific actions available from <monospace>ffeatools</monospace>, and their purpose, are listed in <xref ref-type="table" rid="pcbi.1005897.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1005897.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.t001</object-id>
<label>Table 1</label>
<caption>
<title>List of actions available to the <monospace>ffeatools</monospace> script.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005897.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" style="border-bottom:thick">ffeatools action</th>
<th align="left" style="border-bottom:thick">brief description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">pdbtoemmap</td>
<td align="left">Calculate an pseudo-electron density map from atomic coordinates in PDB format</td>
</tr>
<tr>
<td align="left">emmaptosurf</td>
<td align="left">Extract a surface profile (.obj or .stl) file from an electron density map</td>
</tr>
<tr>
<td align="left">surftocgsurf</td>
<td align="left">Coarsen a surface profile whilst preserving the enclosed volume</td>
</tr>
<tr>
<td align="left">tettonet</td>
<td align="left">Convert TETGEN mesh files into NETGEN .vol files to be processed by FFEA</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">voltoffea</td>
<td align="left" style="border-bottom:thick">Process the volume mesh file and input material parameters into FFEA input files</td>
</tr>
<tr>
<td align="left">split</td>
<td align="left">Split a trajectory into a number of parts</td>
</tr>
<tr>
<td align="left">thin</td>
<td align="left">Select every <italic>n</italic> snapshots out of a trajectory</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">nodesFromTraj</td>
<td align="left" style="border-bottom:thick">Creates a set of .node (equilibrium) files from a trajectory snapshot</td>
</tr>
<tr>
<td align="left">makestructuremap</td>
<td align="left">Map elements into atoms (.map file)</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick">maptraj</td>
<td align="left" style="border-bottom:thick">Calculate a pseudo atomistic trajectory given a .map file and an FFEA trajectory</td>
</tr>
<tr>
<td align="left">pyPCAbuild</td>
<td align="left">Convert the FFEA trajectory into a PDB format, allowing it to interface with the pyPcazip package</td>
</tr>
<tr>
<td align="left">pyPCAeigen</td>
<td align="left">Extract the PCA eigensystem of an FFEA trajectory</td>
</tr>
<tr>
<td align="left">pyPCAanim</td>
<td align="left">Build animations of the PCA eigenvectors</td>
</tr>
<tr>
<td align="left">pyPCAproj</td>
<td align="left">Calculate a PCA projection trace for a given eigenmode</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Finally, the <monospace>ffeatools</monospace> modules also power the PyMOL plugin (see next section) which provides a means of visualisation for FFEA systems and trajectories. The dependency on <monospace>ffeatools</monospace> for all of our integrated initialisation and analysis protocols creates a self-consistent programming environment, and is essential for the maintenance of this part of the software package.</p>
<p>The final four tools in <xref ref-type="table" rid="pcbi.1005897.t001">Table 1</xref> allow FFEA to interface with pyPcazip [<xref ref-type="bibr" rid="pcbi.1005897.ref043">43</xref>], an open source tool designed for performing principal component analysis (PCA) on atomistic trajectories.</p>
</sec>
<sec id="sec018">
<title>Visualisation of FFEA simulations</title>
<p>We have developed a plugin for the PyMOL visualisation tool [<xref ref-type="bibr" rid="pcbi.1005897.ref044">44</xref>], which enables users to visualise both their system setup and the resulting FFEA trajectories. Prior to loading an FFEA mesh, the user can select whether to display a volumetric or surface mesh, whether to colour different bodies, according to their material parameters (Young’s modulus, shear viscosity, etc) or according to the type of surface faces (see <xref ref-type="fig" rid="pcbi.1005897.g004">Fig 4</xref>). Internally, these functions make use of Compiled Graphics Objects (CGO), which is the format used by PyMOL to create three-dimensional geometries. The CGO API, together with our <monospace>ffeatools</monospace> API, is designed to facilitate the development of further visualisation tools by multiple user groups. Within the viewer, macromolecules can be rotated, hidden, and the colours changed. Configuring springs, pinned nodes, or assigning face-face interactions requires the user to define the internal indices of the relevant nodes. While sub-structures such as nodes or faces are currently not directly selectable, a PyMOL object consisting of a set of atoms mapped onto every node, element or face, can be generated so that the residue number reflects the internal FFEA numbering. The user can then select these atoms with the mouse, and print the residue numbers to the screen.</p>
<fig id="pcbi.1005897.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The FFEA plugin for PyMOL is displayed on the left ready to load a DNA helicase (EMDB entry EMD-2321) with “solid” faces, CGO ‘atom’ objects onto the nodes, and the 3D tetrahedral mesh, together with the FFEA trajectory named in the FFEA input file, if it is found.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>Atomic structures from FFEA simulations</title>
<p>We have also developed a software tool, <monospace>atomicMapper</monospace>, for the user to convert from the continuum FFEA trajectory to an estimated trajectory for the corresponding atomistic structure, provided that atomic structural information is available. Geometrically, a biomolecule within FFEA is simply a set of nodes connected topologically as a set of tessellating tetrahedra. During the simulation the coordinates of the nodes are continuously changing, while its topology remains constant. This enables us to relate the positions of the atoms comprising the biomolecule to the coordinates of the nodes via a linear interpolation scheme.</p>
</sec>
</sec>
<sec id="sec020" sec-type="results">
<title>Results</title>
<p>The FFEA package contains detailed documentation on the software, including installation instructions, in-depth descriptions of the capabilities of the software, a documented API, and a tutorial on how to set up a simulation. We also provide a test suite to validate our software implementation and installation. These tests examine both the computational and physical accuracy of FFEA following installation, and should be run to ensure that a local installation of the FFEA runner is functioning correctly.</p>
<p>To demonstrate the capabilities of FFEA, in our tutorial we demonstrate the full initialisation and simulation procedure for the molecular chaperone GroEL in its “apo” state, a macro-molecular structure for which a fully-atomistic simulation would be extremely computationally demanding. Analysis of the output data showed that the resulting dynamical information is physically meaningful and can aid in the understanding of macromolecule function.</p>
<p>We have also performed a comparison between all-atom MD simulation trajectories and equivalent FFEA simulations of two different proteins. Through this analysis, we aim to show how much dynamical information is preserved as we remodel the system in the FFEA framework.</p>
<sec id="sec021">
<title>A simulation of apo-GroEL</title>
<p>The tutorial uses the molecular chaperone GroEL as an illustrative example to guide the user through setting up and performing an FFEA simulation. GroEL consists of two heptameric rings built of 14 identical subunits, in total weighing approximately 770kDa. With this weight, and at 12 × 14 × 14 nm in size, GroEL would certainly be considered large for conventional atomistic MD simulations with standard computational resources. Structural data is available both at atomic resolution (PDB entry 4HEL), and at lower resolution as an electron density map (EDM) (EMDB entry EMD-5403).</p>
<p>One of the strengths of FFEA is that it is able to to build a continuum structure from low resolution data. To illustrate this, we began our initialisation procedure from the EDM (see <xref ref-type="fig" rid="pcbi.1005897.g005">Fig 5</xref>, left) and extracted a wavefront “.obj” file, a connected triangulated surface file, using <monospace>ffeatools:emmaptosurf</monospace> (see <xref ref-type="fig" rid="pcbi.1005897.g005">Fig 5</xref>, centre). This was then coarsened using <monospace>ffeatools:surftocgsurf</monospace> (which implements an algorithm described by Oliver [<xref ref-type="bibr" rid="pcbi.1005897.ref045">45</xref>]) until the shortest edge in the system was was 12Å, maintaining constant volume. The resulting STereoLithography triangle mesh “.stl”, a standard file format for defining a triangulated surface, is then read into the Tetgen software package to create a volumetric mesh, completely filling the structure with tessellating tetrahedra (<xref ref-type="fig" rid="pcbi.1005897.g005">Fig 5</xref>, right). We emphasise that to create this volumetric mesh, Tetgen (or alternatively Netgen) requires that the provided surface is <italic>closed</italic> i.e. a surface with a well defined and completely separate ‘inside’ and ‘outside’.</p>
<fig id="pcbi.1005897.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g005</object-id>
<label>Fig 5</label>
<caption>
<title>An electron microscopy map of GroEL (EMDB entry EMD-5403) as seen in Chimera [<xref ref-type="bibr" rid="pcbi.1005897.ref026">26</xref>](left), then converted to “.stl” using the <monospace>emmaptosurf</monospace> ffeatool visualised in VMD [<xref ref-type="bibr" rid="pcbi.1005897.ref027">27</xref>] (centre), and the final volumetric mesh, coarsened so that the shortest edge is 12Å visualised using the FFEA plugin for PyMOL (right).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g005" xlink:type="simple"/>
</fig>
<p>For demonstrative purposes we have performed two separate simulations of GroEL, which will be labelled using the index <italic>i</italic>. Each simulation had a different value of the Young’s modulus, <italic>E</italic><sub><italic>i</italic></sub>, which were <italic>E</italic><sub>1</sub> = 0.33GPa and <italic>E</italic><sub>2</sub> = 1GPa. The complementary parameter, the Poisson ratio, was kept constant at <italic>ν</italic> = 0.35 for all simulations. These values are representative of generic globular proteins [<xref ref-type="bibr" rid="pcbi.1005897.ref046">46</xref>]. In addition to these core parameters, we assigned the internal and external viscosity values, <italic>μ</italic> = 10<sup>−3</sup> Pa⋅s, equivalent to that of water. More generally, material parameters can either be inferred from experimental results, such as flexibility information derived from negative stain EM images, or calculated though atomic simulations of constitutive protein fragments. The simulations were performed using the Brownian formulation, i.e. using <xref ref-type="disp-formula" rid="pcbi.1005897.e003">Eq 3</xref> as the equation of motion, which allowed us to use a simulation time-step, <italic>dt</italic> = 0.1<italic>ps</italic>. We performed 3<italic>μ</italic>s FFEA simulations and recorded the shape of the FE mesh representing the protein complexes every 1ns for post-processing. These simulations took approximately 65 hours using 4 cores of an AMD 6376 Opteron processor at 1.4GHz.</p>
</sec>
<sec id="sec022">
<title>Analysis of apo-GroEL</title>
<p>To validate the simulations of GroEL, we measured the average strain energy over the course of the simulation, 〈<italic>U</italic>(<italic>t</italic>)〉, where <italic>t</italic> is the length of time used for the averaging. <xref ref-type="fig" rid="pcbi.1005897.g006">Fig 6</xref> shows that the strain energies successfully converged within approximately 50<italic>ns</italic> (inset) and remained equilibrated for the remainder of the simulation. Simulations 1 and 2 converged to within 0.60% and 1.09% respectively of the theoretical value <inline-formula id="pcbi.1005897.e010"><alternatives><graphic id="pcbi.1005897.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mi>U</mml:mi> <mml:mo>〉</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> per degree of freedom as predicted by the equipartition theorem, where <italic>k</italic><sub><italic>B</italic></sub> is Boltzmann’s constant. We see a small increase in the numerical inaccuracy with larger Young’s moduli due to the corresponding decrease in the system relaxation times.</p>
<fig id="pcbi.1005897.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g006</object-id>
<label>Fig 6</label>
<caption>
<title>The average strain energy of the apo-GroEL simulations plotted as a function of the length of time the average was taken over.</title>
<p>The inset graph shows the first 100ns at higher resolution.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g006" xlink:type="simple"/>
</fig>
<p>By calculating the Root Mean-Squared Deviation (RMSD) throughout the simulation using the nodes of the finite element mesh, we can see the difference in dynamics due to the differing elasticities. <xref ref-type="fig" rid="pcbi.1005897.g007">Fig 7</xref> shows these RMSD traces following an RMS fit of each frame in the trajectory to the average structure. We see that as we increase the stiffness both the size of the fluctuations in the nodal RMSD, as well as the average value, both decrease, showing that the molecule is more tightly restricted to its average structure.</p>
<fig id="pcbi.1005897.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g007</object-id>
<label>Fig 7</label>
<caption>
<title>The RMSD traces of the 2 different simulations of GroEL following an RMS fit to the average structure.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g007" xlink:type="simple"/>
</fig>
<p>To further probe the dynamics of GroEL, we performed PCA on the trajectories to determine the major types of motion. Using the pyPcazip interface (see Section: FFEA tools), we were able to determine the 20 most flexible normal modes of motion from the FFEA trajectory, the eigenvalues of which are shown in <xref ref-type="fig" rid="pcbi.1005897.g008">Fig 8</xref>. The factor 3 difference in the Young’s moduli between simulations 1 and 2 gives the same factor 3 difference between the eigenvalues, which represent the flexibility of the molecule. We also note that in each individual simulation, many of the eigenvalues are similar in magnitude, indicating a near degeneracy of several of the eigenmodes. This is to be expected given the substantial symmetry of the GroEL structure. All the relevant trajectories and analysis files were made available within <xref ref-type="supplementary-material" rid="pcbi.1005897.s004">S1 Text</xref>.</p>
<fig id="pcbi.1005897.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g008</object-id>
<label>Fig 8</label>
<caption>
<title>The eigenvalues, which correspond to positional variance, of the 20 most flexible modes found from PCA analysis of a 3<italic>μ</italic>s FFEA simulations of GroEL.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g008" xlink:type="simple"/>
</fig>
<p>Our interface with pyPcazip also provides functionality for visualising these modes in FFEA format. The 5 most flexible modes are shown in <xref ref-type="fig" rid="pcbi.1005897.g009">Fig 9</xref>, some of which exhibit degeneracy as mentioned above.</p>
<fig id="pcbi.1005897.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g009</object-id>
<label>Fig 9</label>
<caption>
<title>A representation of the 5 most flexible eigenmodes of the GroEL 1GPa model.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g009" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec023">
<title>Recovering atomic structures</title>
<p>In order to demonstrate the functionality of the <monospace>atomicMapper</monospace> tool, we performed the mapping procedure on the <italic>E</italic> = 1GPa GroEL trajectory to produce an equivalent atomistic trajectory that conserves the FFEA calculated dynamics, visualised in <xref ref-type="fig" rid="pcbi.1005897.g010">Fig 10</xref>. The time evolution of the RMSD of both the FFEA trajectory and the mapped atomistic counterpart, calculated using the <italic>nodes</italic> and atoms respectively, can be seen in <xref ref-type="fig" rid="pcbi.1005897.g011">Fig 11</xref>. No alignment has been performed on the frames with respect to the initial structure, meaning that these RMSDs still contain the diffusional dynamics of the system within them. We see negligible difference between both trajectories, showing that physically meaningful measurements are conserved through the mapping procedure.</p>
<fig id="pcbi.1005897.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Four snapshots from the FFEA trajectory of GroEL and the atomistic pseudo-trajectory formed from the mapping procedure.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g010" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005897.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Root Mean-Squared Deviation traces of an FFEA simulation of GroEL (calculated using the <italic>nodes</italic>), and the pseudo-atomic trajectory created via the atomistic mapping procedure.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g011" xlink:type="simple"/>
</fig>
<p>The mapped atomic structures at each time-step were then suitable for higher resolution, atomistic modelling. In <xref ref-type="fig" rid="pcbi.1005897.g012">Fig 12</xref> we see an atomic structure which was created using the <monospace>atomicMapper</monospace> following 1<italic>μ</italic>s of FFEA simulation, and minimised using the AMBER MD package. This multi-resolution scheme could potentially be used to rapidly explore conformational space using a continuum FFEA model, before transforming back to an atomic resolution simulation to explore the dynamics of the new configuration in more detail.</p>
<fig id="pcbi.1005897.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g012</object-id>
<label>Fig 12</label>
<caption>
<title>The minimised structure of fully atomistic GroEL following the mapping procedure.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g012" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec024">
<title>Comparison of FFEA with all-atom molecular dynamics</title>
<p>From the MoDEL database [<xref ref-type="bibr" rid="pcbi.1005897.ref047">47</xref>], we obtained PCA compressed atomistic trajectories for two small proteins (Arfaptin, PDB ID 1I49 [<xref ref-type="bibr" rid="pcbi.1005897.ref048">48</xref>], and xylanase, PDB ID 1TUX [<xref ref-type="bibr" rid="pcbi.1005897.ref049">49</xref>]). These proteins were chosen due to the contrasting dynamical behaviour observed in the first principal components extracted by PCA. For Arfaptin, which is long and thin, the first principal component extracted from the atomistic simulations involved a motion that is delocalised over the entire protein, whereas for the spherical protein xylanase, the first principal component was associated with local motions of individual side chains. Consequently, we expect that FFEA is able to capture the dynamics observed in atomistic simulations of Arfaptin, but not of xylanase. The atomistic and FFEA structures are shown in <xref ref-type="fig" rid="pcbi.1005897.g013">Fig 13</xref>, the animations of selected principal modes are available as Supplementary Information in <xref ref-type="supplementary-material" rid="pcbi.1005897.s002">S2 File</xref>, as well as the trajectories and analysis files within <xref ref-type="supplementary-material" rid="pcbi.1005897.s005">S2 Text</xref>.</p>
<fig id="pcbi.1005897.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g013</object-id>
<label>Fig 13</label>
<caption>
<title>The two molecules used for our FFEA / atomistic comparative study: a) Arfaptin, and b) xylanase.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g013" xlink:type="simple"/>
</fig>
<p>In the FFEA simulations, we assigned homogeneous material parameters of <italic>E</italic> = 1GPa for the Young’s modulus, a Poisson ratio 0.35 and shear, bulk and external solvent viscosities <italic>μ</italic> = 1 × 10<sup>−3</sup>Pa.s. The FFEA simulations were run for 100ns for Arfaptin and 780ns for xylanase, which corresponds to an order of magnitude longer than the atomistic trajectories in each case. Using the mapping procedure described previously, we transformed each of the resulting FFEA trajectories into pseudo-atomistic trajectories before performing PCA with the pyPcazip software [<xref ref-type="bibr" rid="pcbi.1005897.ref043">43</xref>]. Performing this transformation from the FFEA model onto the atomistic structure allows us to directly compare the dynamics of the two types of simulation trajectory on a common coordinate system. For each model, we compared the atomistic and FFEA pseudo-atomistic PCA eigensystems by calculating the inner product matrices of the most flexible 10 eigenmodes from each data set using the pyPczcomp utility of pyPcazip. These matrices are shown in <xref ref-type="fig" rid="pcbi.1005897.g014">Fig 14a</xref>. As expected, while the atomistic and FFEA simulations exhibit common dynamical modes for the global modes of Arfaptin (eigenspace overlap of 0.6), for the xylanase trajectories, which involve only local structural changes, the continuum and atomistic representations show less correlation (eigenspace overlap of 0.4). We also performed an eigenvector comparison between the first and second halves of the atomistic trajectories, for which the inner product matrices are shown in <xref ref-type="fig" rid="pcbi.1005897.g014">Fig 14b</xref> (eigenspace overlaps 0.7 for Arfaptin, and 0.5 for xylanase). A comparison of the first and second halves of the atomistic simulations for Arfaptin shows that the FFEA model provides a similar level of agreement to different segments of an atomistic simulation.</p>
<fig id="pcbi.1005897.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g014</object-id>
<label>Fig 14</label>
<caption>
<title>The eigenvector inner product matrices between compared trajectories.</title>
<p><bold>a)</bold> is the comparison between atomistic and FFEA pseudo-atomistic PCA datasets. <bold>b)</bold> is the comparison between the first and second halves of the atomistic datasets.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g014" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec025">
<title>FFEA code performance</title>
<p>We benchmarked FFEA on two different machines by performing simulations containing an increasing number of GroEL units. The first machine is a single compute node, with two Intel Xeon E5-2640v3 2.60GHz processors, providing a total of 32 hyperthreaded (HT) cores, with 32Gb of memory (DDR4, 1866MHz). Using a single core, FFEA provides 18 ns/hour for a single GroEL, which is comprised of 3×3109 degrees of freedom. The best performance was achieved using all 32 available cores, which ran at a speed of 129.6 ns/hour.</p>
<p>We then benchmarked FFEA for a simulation cell composed of 32 GroELs (as shown in <xref ref-type="fig" rid="pcbi.1005897.g015">Fig 15</xref>). This task is more computationally challenging, because steric interactions between faces belonging to different proteins need to be included to prevent different molecules occupying the same space within the simulation box. <xref ref-type="fig" rid="pcbi.1005897.g016">Fig 16</xref> shows that while the performance increases up to 32 cores, the level of improvement diminishes for higher core numbers.</p>
<fig id="pcbi.1005897.g015" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g015</object-id>
<label>Fig 15</label>
<caption>
<title>Arrangment of 32 GroEL units used to benchmark the performance of the FFEA runner.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g015" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005897.g016" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g016</object-id>
<label>Fig 16</label>
<caption>
<title>Strong scaling plots for a system of 32 GroEL complexes, run using a 32 HT core computer.</title>
<p>a) Execution time b) Speedup.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g016" xlink:type="simple"/>
</fig>
<p>The second machine we used for benchmarking FFEA is an SGI UV2000 shared memory computer, with 32 nodes composed of an Intel E5-4650L processor (8 cores, 2.6GHz) and 8 DIMMs of 16Gb of memory (1600MHz, DDR3) each, resulting in a total of 256 cores and 4Tb of memory. One node is reserved as the login blade, so we used up to 248 cores. To study the weak scaling performance of FFEA, we loaded the machine with increasing numbers of GroEL proteins so that one GroEL could be assigned to each thread. The results in <xref ref-type="fig" rid="pcbi.1005897.g017">Fig 17b</xref> show how the efficiency is reduced when increasing numbers of proteins are placed on successively more cores. The performance reduction is a result of the larger load per thread, due to the increased number of face-face interactions that need to be considered. While the weak scaling benchmarks show that the efficiency is reduced to 7% when using 248 cores in 31 blades, we are still able to simulate as many as 248 GroELs. Consequently, it is possible, if expensive, to simulate a very large biological system with FFEA.</p>
<fig id="pcbi.1005897.g017" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g017</object-id>
<label>Fig 17</label>
<caption>
<title>Weak scaling plots for a system composed of an increasing number of GroEL units matching the number of processors used, up to 248, in a large shared memory machine.</title>
<p>a) Execution time b) Efficiency.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g017" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec026">
<title>FFEA validation</title>
<p>The FFEA package is released with a test suite that should be run by the user following successful compilation. Tests can be run either sequentially (by typing “<monospace>make test</monospace>”) or concurrently (by typing “<monospace>ctest -j</monospace> <monospace>N</monospace>”, where <italic>N</italic> is the number of processes) reporting either failure or success.</p>
<p>This test suite, summarised in <xref ref-type="table" rid="pcbi.1005897.t002">Table 2</xref>, provides structural checks of the FFEA software itself as well as validation of the physical results calculated by the code.</p>
<table-wrap id="pcbi.1005897.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.t002</object-id>
<label>Table 2</label>
<caption>
<title>List of tests included in the FFEA tests suite.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005897.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left" style="border-bottom:thick">test name</th>
<th align="left" style="border-bottom:thick">brief description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><monospace>test_rngStream</monospace></td>
<td align="left">unit tests on the random number generator</td>
</tr>
<tr>
<td align="left"><monospace>test_volume</monospace></td>
<td align="left">the intersection volume of two tetrahedra is checked against a known geometry</td>
</tr>
<tr>
<td align="left"><monospace>test_script_loader</monospace></td>
<td align="left">test of the input file reader for the “runner”.</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick"><monospace>python_load_trajectory</monospace></td>
<td align="left" style="border-bottom:thick">test of loading a trajectory using the <monospace>ffeatools</monospace>.</td>
</tr>
<tr>
<td align="left"><monospace>restart_check</monospace></td>
<td align="left">restart check proving that the RNG used to simulate the thermal noise is used safely</td>
</tr>
<tr>
<td align="left" style="border-bottom:thick"><monospace>precomp_check</monospace></td>
<td align="left" style="border-bottom:thick">calculate the energy for a number of beads interacting through<break/>pre-computed potentials and compare it with the value obtained using Gromacs [<xref ref-type="bibr" rid="pcbi.1005897.ref036">36</xref>].</td>
</tr>
<tr>
<td align="left"><monospace>sphere_mass</monospace><xref ref-type="table-fn" rid="t002fn001">†</xref></td>
<td align="left">showing correct distribution of thermal energy for the Langevin scheme</td>
</tr>
<tr>
<td align="left"><monospace>sphere_nomass</monospace><xref ref-type="table-fn" rid="t002fn001">†</xref></td>
<td align="left">showing correct distribution of thermal energy for the Brownian scheme</td>
</tr>
<tr>
<td align="left"><monospace>sphere_diffusion_mass</monospace><xref ref-type="table-fn" rid="t002fn001">†</xref></td>
<td align="left">showing correct diffusional properties for the Langevin scheme</td>
</tr>
<tr>
<td align="left"><monospace>sphere_diffusion_nomass</monospace><xref ref-type="table-fn" rid="t002fn001">†</xref></td>
<td align="left">showing correct diffusional properties for the Brownian scheme</td>
</tr>
<tr>
<td align="left"><monospace>cyl_youngs_mod</monospace><xref ref-type="table-fn" rid="t002fn001">†</xref></td>
<td align="left">mechanical stretching of a cylindrical beam</td>
</tr>
<tr>
<td align="left"><monospace>cyl_flexrig</monospace><xref ref-type="table-fn" rid="t002fn001">†</xref></td>
<td align="left">mechanical bending of a cylindrical beam</td>
</tr>
<tr>
<td align="left"><monospace>steric_n_springs</monospace><xref ref-type="table-fn" rid="t002fn001">†</xref></td>
<td align="left">test of springs and steric interactions</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001">
<p><sup>†</sup>Tests explained in detail in the main text.</p>
</fn>
</table-wrap-foot>
</table-wrap>
<sec id="sec027">
<title>Tests of thermodynamic properties</title>
<p>In order to check that the systems equilibrate to the correct energy distributions and thus respond correctly to the thermal fluctuations, short trajectories of single spheres are run under the Langevin and Brownian schemes. These spheres have radius <italic>R</italic> = 5nm, a Young’s modulus <italic>E</italic> = 1GPa, Poisson ratio <italic>ν</italic> = 0.35 and viscosity <italic>μ</italic> = 10<sup>−3</sup> Pa⋅s. The trajectories are then analysed and the average energy of the last 60 recorded steps is calculated for the different terms. These are strain energy and, for the Langevin scheme, kinetic energy, and their averages are compared to the theoretical value given by the equipartition theorem (<italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>(3<italic>N</italic> − 6)/2 for the strain energy, and 3<italic>k</italic><sub><italic>B</italic></sub> <italic>TN</italic>/2 for the kinetic energy). A test of 10<sup>5</sup> time-steps (simulating 1ns in less than 20s of CPU time) is sufficient to give an accuracy of 0.6% for the strain energy in the Brownian scheme, and 1.2% for the strain energy and 2.9% for the kinetic energy using the Langevin scheme. Averages using 20ns trajectories give better results, lowering to 0.07% for the Brownian strain, and to 0.03% for the strain energy and 0.1% for the kinetic energy in the Langevin case. We suspect that the kinetic energy does not converge more accurately to the theoretical value due to the time-stepping algorithm used here, in agreement with previous studies (see [<xref ref-type="bibr" rid="pcbi.1005897.ref050">50</xref>] for a comprehensive review). Future work on improving the algorithm for the integration of the stochastic differential equations, especially in the Langevin scheme, is planned in order to provide greater accuracy together with potential increases in speed. This should allow larger simulation time-steps whilst at the same time preserving the stability of the numerical integration and thermodynamic correctness of our thermal stress.</p>
</sec>
<sec id="sec028">
<title>Tests of FFEA mechanics</title>
<p>Two tests are provided to validate the mechanical calculations within FFEA. These perform simulations that separately stretch and bend a cylinder, 160 nm long, with a 10 nm radius and Young’s modulus of 600 GPa. In both cases, one end of the cylinder has all its nodes pinned, and constant force is applied on the other end, spread uniformly over the end surface.</p>
<p>In the stretching test, a force <italic>F</italic> = 10 pN is applied in the same direction of the cylinder axis. When the system reaches equilibrium the increase in length of the cylinder, Δ<italic>L</italic>, is measured and the Young’s modulus is calculated using its definition: <italic>E</italic> = <italic>FL</italic><sub>0</sub>/<italic>A</italic><sub>0</sub>Δ<italic>L</italic>, where <italic>L</italic><sub>0</sub> and <italic>A</italic><sub>0</sub> are the equilibrium length and cross section area respectively. This is then compared with the Young’s modulus used to parametrise the system, resulting in error smaller than 0.2%.</p>
<p>In the bending test, we compare computational and theoretical results for the <italic>flexural rigidity</italic> of the beam, <italic>EI</italic>, i.e. its resistance to bending. From beam theory, a beam with a free end where a force is applied perpendicular to its axis, suffers a deflection of Δ<italic>y</italic> = −<italic>FL</italic><sup>3</sup>/3<italic>EI</italic> [<xref ref-type="bibr" rid="pcbi.1005897.ref051">51</xref>], where <italic>I</italic> is the second moment of the cross-sectional area of the beam, a geometrical property. Computationally, the test runs a trajectory for the same cylinder, where a constant force of 1 pN is now applied in a direction perpendicular to the cylinder axis. When the cylinder reaches equilibrium, Δ<italic>y</italic> is measured, and the corresponding <italic>EI</italic> is compared to the theoretical values. However, in this case, errors depend on the quality of the mesh, the reason being that linear elements restrict bending motion, and therefore coarse meshes are stiff compared to the true continuum. In the mesh used and shipped in the test suite, the error is 4%, but coarser meshes will be less accurate [<xref ref-type="bibr" rid="pcbi.1005897.ref025">25</xref>].</p>
</sec>
<sec id="sec029">
<title>Validating diffusion in FFEA</title>
<p>A test is provided for both the Langevin and Brownian schemes to check that the simulated diffusion of a biomolecule is correct. In each test, a 10 ns simulation is performed on a spherical object, of radius <italic>R</italic> = 5 nm, and the diffusive behaviour compared with the theoretical value.</p>
<p>The viscosity of the solvent results in a drag on the solute which we apply locally to each node. The nodes are modelled as spheres with an effective radius, <italic>r</italic>, embedded in a fluid of viscosity <italic>μ</italic><sup><italic>s</italic></sup>, as explained in <xref ref-type="supplementary-material" rid="pcbi.1005897.s001">S1 File</xref>. Choosing <inline-formula id="pcbi.1005897.e011"><alternatives><graphic id="pcbi.1005897.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>R</mml:mi> <mml:mi>N</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, <italic>R</italic> and <italic>N</italic> being the radius of the sphere and the number of nodes respectively, makes the total drag of the object λ = 6<italic>πRμ</italic><sup><italic>s</italic></sup>, the expected result for a spherical object. In addition to these viscosities, each sphere has density, <italic>ρ</italic> = 1500kgm<sup>−3</sup>, Young’s modulus, <italic>E</italic> = 1GPa and Poisson’s ratio, <italic>ν</italic> = 0.35.</p>
<p>For the Brownian scheme, the diffusion has the well known form:
<disp-formula id="pcbi.1005897.e012"><alternatives><graphic id="pcbi.1005897.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>6</mml:mn> <mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi></mml:mrow> <mml:mo>λ</mml:mo></mml:mfrac> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>For the Langevin scheme however, inertial effects need to be taken into account. For mesoscale objects like our sphere, the ballistic motion only occurs for short periods of time before the background viscosity dominates. In this regime, the approximation 〈(<italic>x</italic> − <italic>x</italic><sub>0</sub>)<sup>2</sup>〉 = 〈<italic>v</italic><sup>2</sup>〉<italic>t</italic><sup>2</sup> is valid, and using the equipartition theorem <italic>m</italic>〈<italic>v</italic><sup>2</sup>〉 = <italic>k</italic><sub><italic>B</italic></sub> <italic>T</italic>,
<disp-formula id="pcbi.1005897.e013"><alternatives><graphic id="pcbi.1005897.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005897.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>3</mml:mn> <mml:mfrac><mml:mrow><mml:msub><mml:mi>k</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>m</mml:mi></mml:mfrac> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula></p>
<p>Short simulations are performed using time-steps small enough to retain numerical accuracy (see <xref ref-type="supplementary-material" rid="pcbi.1005897.s001">S1 File</xref>). Following equilibration, we calculate 〈<italic>r</italic><sup>2</sup>〉 per time-step by averaging (<italic>r</italic><sub><italic>t</italic>+Δ<italic>t</italic></sub> − <italic>r</italic><sub><italic>t</italic></sub>)<sup>2</sup> for 0 &lt; <italic>t</italic> &lt; <italic>t</italic><sub><italic>sim</italic></sub>, where <italic>t</italic><sub><italic>sim</italic></sub> is the total simulation time. We report errors of 2.73% for the inertialess solver, and 8.39% for the inertial solver. These errors differ by ∼ 0.1% between tests due to the random nature of the stochastic noise over short simulations. The higher overall error value for the inertial solver is expected, and is again likely a consequence of our numerical integration scheme.</p>
</sec>
<sec id="sec030">
<title>Tests of the steric repulsion within FFEA</title>
<p>Finally, simulations of viscoelastic cubes in the absence of thermal noise are performed to ensure that the steric repulsion is correctly implemented in both the Langevin and Brownian schemes. For the Brownian scheme, two viscoelastic cubes are placed in face-to-face contact and are pulled together by springs (see <xref ref-type="fig" rid="pcbi.1005897.g018">Fig 18</xref>) during the simulation to test the intermolecular forces. The resulting trajectory is analysed automatically, checking that the centers of mass of both cubes approach progressively while the overlapping volume between the meshes remains approximately zero.</p>
<fig id="pcbi.1005897.g018" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g018</object-id>
<label>Fig 18</label>
<caption>
<title>Two viscoelastic cubes are put side by side with springs pulling from both ends in the configuration displayed (where part of the red cube was made transparent) to test the effectiveness of the steric repulsion introduced.</title>
<p>As it can be seen, the interface between both bodies remains flat, while the overall volume is compressed.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g018" xlink:type="simple"/>
</fig>
<p>To test the Langevin scheme, we show that our implementation of both the springs and the steric forces are conservative, as required. The test performs an FFEA simulation in which two soft, viscoelastic spheres collide, as shown in <xref ref-type="fig" rid="pcbi.1005897.g019">Fig 19</xref>. As a result of the collision, the spheres undergo a large deformation before rebounding, losing energy as a result of dissipation, while still recovering their equilibrium shapes. The deflection of the spheres following the collision from their initial directions of travel prior to impact is small, and the largest rotation angle of a sphere about its own centroid is less than 3°.</p>
<fig id="pcbi.1005897.g019" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005897.g019</object-id>
<label>Fig 19</label>
<caption>
<title/>
<p>a) The two soft, viscoelastic spheres before collision. b) The spheres collide and suffer a large deformation. c) The spheres bounce back as a result of the steric interactions, recover their shape, and experience negligible rotation or deflection. A movie is available in the supplementary <xref ref-type="supplementary-material" rid="pcbi.1005897.s003">S3 File</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.g019" xlink:type="simple"/>
</fig>
</sec>
</sec>
</sec>
<sec id="sec031">
<title>Availability and future directions</title>
<p>With this first release of the FFEA software, we aim to provide a multi-purpose simulation tool for the biomolecular modelling community to perform dynamic simulations of large protein assemblies based on low resolution structural information, such as is available in the EMDB. The software is released with a user-manual and tutorials, along with a test suite to validate every local install of the program. Planned future developments include improvements to the physics, such as inclusion of long-range hydrodynamics. To broaden the capabilities of FFEA, we are currently implementing the ability to switch between pre-defined protein conformational states, so that we can represent the power-stroke of molecular motors, for example. Moreover, we are introducing rod and sheet elements, in addition to tetrahedra, to facilitate FFEA modelling of one-dimensional objects such as coiled-coils, and two dimensional surfaces such as membranes. These additional capabilities will become available in subsequent software releases. There is also the potential to significantly improve code performance, such as through MPI parallelisation or porting to GPUs. Currently, a typical FFEA simulation running for several days on a desktop linux workstation will contain up to 10 interacting proteins, and will routinely explore <italic>μ</italic>s timescales. In the future, when the software can make use of multiple (e.g 1000) cores or accelerator technologies, we anticipate that far larger systems sizes (e.g 1000 interacting proteins) and longer timescales (up to ms) will be accessible. Given the success that MD simulations at the atomistic level have had in improving our understanding of the biomolecular structures within the PDB, new computational tools that bear an equivalent relationship to the EMDB have the potential to be extremely useful in interpreting the new experimental data from the biological mesoscale. FFEA is released under GPL license, made publicly available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/ffea/ffea" xlink:type="simple">https://bitbucket.org/ffea/ffea</ext-link>, documentation built automatically and stored at <ext-link ext-link-type="uri" xlink:href="http://ffea.readthedocs.io/en/stable" xlink:type="simple">http://ffea.readthedocs.io/en/stable</ext-link>.</p>
</sec>
<sec id="sec032">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005897.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.s001" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Detailed physical and mathematical description of FFEA.</title>
<p>This appendix details the physics and mathematics that FFEA model uses, and that have been implemented in the software package.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005897.s002" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.s002" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>PCA comparison of atomistic and FFEA dynamics.</title>
<p>Movie showing the highest overlapping mode for Arfaptin using an atomistic and FFEA trajectories (mapped back to atomistic coordinates).</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005897.s003" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.s003" xlink:type="simple">
<label>S3 File</label>
<caption>
<title>Movie of two soft viscoelastic spheres colliding within FFEA.</title>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005897.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.s004" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Study of the flexibility of GroEL through FFEA simulation and analysis.</title>
<p>The input scripts, structural information, output trajectories, measurement, and results for the GroEL simulations presented in this paper are made available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5518/209" xlink:type="simple">https://doi.org/10.5518/209</ext-link> for FFEA version 2.4.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005897.s005" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005897.s005" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Analysis and comparison of FFEA with all-atom molecular dynamics.</title>
<p>The input scripts, structural information, output trajectories, measurement, and results for the simulations on Arfaptin and xylanase, comparing FFEA and all-atom molecular dynamics presented in this paper, are made available at <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5518/318" xlink:type="simple">https://doi.org/10.5518/318</ext-link>.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Our thanks to Dr Joanna Leng from the Advanced Research Computing team at the University of Leeds and to Dr Toni Collis from the Edinburgh Parallel Computing Centre at the University of Edinburgh for useful discussions, to Dr Christopher Woods at the University of Bristol for his advice on usability, and to Jonathan Boyle at the Numerical Algorithms Group for profiling the code.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005897.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gray</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Harlen</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Khalid</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Leung</surname> <given-names>YM</given-names></name>, <name name-style="western"><surname>Lonsdale</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>In pursuit of an accurate spatial and temporal model of biomolecules at the atomistic level: a perspective on computer simulation</article-title>. <source>Acta Crystallographica Section D: Biological Crystallography</source>. <year>2015</year>;<volume>71</volume>(<issue>1</issue>):<fpage>162</fpage>–<lpage>172</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1107/S1399004714026777" xlink:type="simple">10.1107/S1399004714026777</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McCammon</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Gelin</surname> <given-names>BR</given-names></name>, <name name-style="western"><surname>Karplus</surname> <given-names>M</given-names></name>. <article-title>Dynamics of Folded Proteins</article-title>. <source>Nature</source>. <year>1977</year>;<volume>267</volume>:<fpage>585</fpage>–<lpage>590</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/267585a0" xlink:type="simple">10.1038/267585a0</ext-link></comment> <object-id pub-id-type="pmid">301613</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Perilla</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Yufenyuy</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Meng</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Ning</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Mature HIV-1 capsid structure by cryo-electron microscopy and all-atom molecular dynamics</article-title>. <source>Nature</source>. <year>2013</year>;<volume>497</volume>(<issue>7451</issue>):<fpage>643</fpage>–<lpage>646</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12162" xlink:type="simple">10.1038/nature12162</ext-link></comment> <object-id pub-id-type="pmid">23719463</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnson</surname> <given-names>GT</given-names></name>, <name name-style="western"><surname>Autin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Al-Alusi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goodsell</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Sanner</surname> <given-names>MF</given-names></name>, <name name-style="western"><surname>Olson</surname> <given-names>AJ</given-names></name>. <article-title>cellPACK: a virtual mesoscope to model and visualize structural systems biology</article-title>. <source>Nature methods</source>. <year>2015</year>;<volume>12</volume>(<issue>1</issue>):<fpage>85</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3204" xlink:type="simple">10.1038/nmeth.3204</ext-link></comment> <object-id pub-id-type="pmid">25437435</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Feig</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Harada</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mori</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sugita</surname> <given-names>Y</given-names></name>. <article-title>Complete atomistic model of a bacterial cytoplasm for integrating physics, biochemistry, and systems biology</article-title>. <source>J Mol Graph Model</source>. <year>2015</year>;<volume>58</volume>:<fpage>1</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jmgm.2015.02.004" xlink:type="simple">10.1016/j.jmgm.2015.02.004</ext-link></comment> <object-id pub-id-type="pmid">25765281</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dror</surname> <given-names>RO</given-names></name>, <name name-style="western"><surname>Dirks</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Grossman</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Shaw</surname> <given-names>DE</given-names></name>. <article-title>Biomolecular Simulation: A Computational Microscope for Molecular Biology</article-title>. <source>Ann Rev Biophys</source>. <year>2012</year>;<volume>41</volume>:<fpage>429</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-biophys-042910-155245" xlink:type="simple">10.1146/annurev-biophys-042910-155245</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>. <article-title>Lattice Boltzmann method for microfluidics: models and applications</article-title>. <source>Microfluidics and Nanofluidics</source>. <year>2011</year>;<volume>10</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10404-010-0624-1" xlink:type="simple">10.1007/s10404-010-0624-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Humphrey</surname> <given-names>JD</given-names></name>. <article-title>Continuum biomechanics of soft biological tissues</article-title>. <source>Proc Royal Soc A-Math Phys Eng Sci</source>. <year>2003</year>;<volume>459</volume>(<issue>2029</issue>):<fpage>3</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspa.2002.1060" xlink:type="simple">10.1098/rspa.2002.1060</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sun</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Sacks</surname> <given-names>MS</given-names></name>. <article-title>Finite element implementation of a generalised Fung-elastic constitutive model for planar soft tissues</article-title>. <source>Biomechanics and Modelling in Mechanobiology</source>. <year>2005</year>;<volume>4</volume>(<issue>2-3</issue>):<fpage>190</fpage>–<lpage>99</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10237-005-0075-x" xlink:type="simple">10.1007/s10237-005-0075-x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roberts</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Kon</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Sutoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>SA</given-names></name>. <article-title>Functions and mechanics of dynein motor proteins</article-title>. <source>Nature Reviews: Mol Cell Biol</source>. <year>2013</year>;<volume>14</volume>(<issue>11</issue>):<fpage>713</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrm3667" xlink:type="simple">10.1038/nrm3667</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref011">
<label>11</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Weisel</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Litvinov</surname> <given-names>RI</given-names></name>. <chapter-title>Fibrin formation, structure and properties</chapter-title>. In: <source>Fibrous Proteins: Structures and Mechanisms</source>. <publisher-name>Springer</publisher-name>; <year>2017</year>. p. <fpage>405</fpage>–<lpage>456</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005897.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cheeseman</surname> <given-names>IM</given-names></name>, <name name-style="western"><surname>Desai</surname> <given-names>A</given-names></name>. <article-title>Molecular architecture of the kinetochore-microtubule interface</article-title>. <source>Nature reviews Molecular cell biology</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>33</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrm2310" xlink:type="simple">10.1038/nrm2310</ext-link></comment> <object-id pub-id-type="pmid">18097444</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marrink</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Risselada</surname> <given-names>HJ</given-names></name>, <name name-style="western"><surname>Yefimov</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tielman</surname> <given-names>DP</given-names></name>, <name name-style="western"><surname>de Vries</surname> <given-names>AH</given-names></name>. <article-title>The MARTINI force field: Coarse grained model for biomolecular simulations</article-title>. <source>J Phys Chem B</source>. <year>2007</year>;<volume>111</volume>(<issue>27</issue>):<fpage>7812</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/jp071097f" xlink:type="simple">10.1021/jp071097f</ext-link></comment> <object-id pub-id-type="pmid">17569554</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Peter</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kremer</surname> <given-names>K</given-names></name>. <article-title>Multiscale simulation of soft matter systems—from the atomistic to the coarse-grained level and back</article-title>. <source>Soft Matter</source>. <year>2009</year>;<volume>5</volume>(<issue>22</issue>):<fpage>4357</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1039/b912027k" xlink:type="simple">10.1039/b912027k</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kmiecik</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gront</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kolinski</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wieteska</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dawid</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Kolinski</surname> <given-names>A</given-names></name>. <article-title>Coarse-grained protein models and their applications</article-title>. <source>Chemical Reviews</source>. <year>2016</year>;<volume>116</volume>(<issue>14</issue>):<fpage>7898</fpage>–<lpage>7936</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/acs.chemrev.6b00163" xlink:type="simple">10.1021/acs.chemrev.6b00163</ext-link></comment> <object-id pub-id-type="pmid">27333362</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>LW</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>JZ</given-names></name>. <article-title>Dissipative Particle Dynamics (DPD): An Overview and Recent Developments</article-title>. <source>Archives of Computational Methods in Engineering</source>. <year>2015</year>;<volume>22</volume>(<issue>4</issue>):<fpage>529</fpage>–<lpage>556</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11831-014-9124-x" xlink:type="simple">10.1007/s11831-014-9124-x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dama</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Sinitskiy</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>McCullagh</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Weare</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roux</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dinner</surname> <given-names>AR</given-names></name>, <etal>et al</etal>. <article-title>The theory of ultra-coarse-graining. 1. General principles</article-title>. <source>Journal of Chemical Theory and Computation</source>. <year>2013</year>;<volume>9</volume>(<issue>5</issue>):<fpage>2466</fpage>–<lpage>2480</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ct4000444" xlink:type="simple">10.1021/ct4000444</ext-link></comment> <object-id pub-id-type="pmid">26583735</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schöneberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Noé</surname> <given-names>F</given-names></name>. <article-title>ReaDDy—A software for particle-based reaction-diffusion dynamics in crowded cellular environments</article-title>. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>(<issue>9</issue>):<fpage>e74261</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0074261" xlink:type="simple">10.1371/journal.pone.0074261</ext-link></comment> <object-id pub-id-type="pmid">24040218</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schöneberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ullrich</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Noé</surname> <given-names>F</given-names></name>. <article-title>Simulation tools for particle-based reaction-diffusion dynamics in continuous space</article-title>. <source>BMC Biophys</source>. <year>2014</year>;<volume>7</volume>(<issue>1</issue>):<fpage>11</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s13628-014-0011-5" xlink:type="simple">10.1186/s13628-014-0011-5</ext-link></comment> <object-id pub-id-type="pmid">25737778</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mereghetti</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gabdoulline</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Wade</surname> <given-names>RC</given-names></name>. <article-title>Brownian dynamics simulation of protein solutions structural and dynamical properties</article-title>. <source>Biophys J</source>. <year>2010</year>;<volume>99</volume>(<issue>11</issue>):<fpage>3782</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.bpj.2010.10.035" xlink:type="simple">10.1016/j.bpj.2010.10.035</ext-link></comment> <object-id pub-id-type="pmid">21112303</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McGuffee</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Elcock</surname> <given-names>AH</given-names></name>. <article-title>Diffusion, crowding &amp; protein stability in a dynamic molecular model of the bacterial cytoplasm</article-title>. <source>PLoS Comp Bio</source>. <year>2010</year>;<volume>6</volume>(<issue>3</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1000694" xlink:type="simple">10.1371/journal.pcbi.1000694</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hespenheide</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Jacobs</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Thorpe</surname> <given-names>M</given-names></name>. <article-title>Structural rigidity in the capsid assembly of cowpea chlorotic mottle virus</article-title>. <source>Journal of Physics: Condensed Matter</source>. <year>2004</year>;<volume>16</volume>(<issue>44</issue>):<fpage>S5055</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005897.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Küelbrandt</surname> <given-names>W</given-names></name>. <article-title>The Resolution Revolution</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>(<issue>6178</issue>):<fpage>1443</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1251652" xlink:type="simple">10.1126/science.1251652</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tamo</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Abriata</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Dal Peraro</surname> <given-names>M</given-names></name>. <article-title>The importance of dynamics in integrative modeling of supramolecular assemblies</article-title>. <source>Current opinion in structural biology</source>. <year>2015</year>;<volume>31</volume>:<fpage>28</fpage>–<lpage>34</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.sbi.2015.02.018" xlink:type="simple">10.1016/j.sbi.2015.02.018</ext-link></comment> <object-id pub-id-type="pmid">25795087</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Oliver</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Read</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Harlen</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>SA</given-names></name>. <article-title>A Stochastic Finite Element Model for the Dynamics of Globular Macromolecules</article-title>. <source>J Comp Phys</source>. <year>2013</year>;<volume>239</volume>:<fpage>147</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jcp.2012.12.027" xlink:type="simple">10.1016/j.jcp.2012.12.027</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pettersen</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Couch</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Greenblatt</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Meng</surname> <given-names>EC</given-names></name>, <etal>et al</etal>. <article-title>UCSF Chimera—a visualization system for exploratory research and analysis</article-title>. <source>Journal of computational chemistry</source>. <year>2004</year>;<volume>25</volume>(<issue>13</issue>):<fpage>1605</fpage>–<lpage>1612</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jcc.20084" xlink:type="simple">10.1002/jcc.20084</ext-link></comment> <object-id pub-id-type="pmid">15264254</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Humphrey</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Dalke</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schulten</surname> <given-names>K</given-names></name>. <article-title>VMD—Visual Molecular Dynamics</article-title>. <source>Journal of Molecular Graphics</source>. <year>1996</year>;<volume>14</volume>:<fpage>33</fpage>–<lpage>38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0263-7855(96)00018-5" xlink:type="simple">10.1016/0263-7855(96)00018-5</ext-link></comment> <object-id pub-id-type="pmid">8744570</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Radar</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Chennubhotla</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bahar</surname> <given-names>I</given-names></name>. <source>Normal mode analysis: Theory and applications to biological and chemical systems 9 (Ch. 3)</source>. <publisher-name>Chapman &amp; Hall/CRC</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005897.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bathe</surname> <given-names>M</given-names></name>. <article-title>A finite element framework for computation of protein normal modes and mechanical response</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2008</year>;<volume>70</volume>(<issue>4</issue>):<fpage>1595</fpage>–<lpage>1609</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.21708" xlink:type="simple">10.1002/prot.21708</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Richardson</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Papachristos</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Read</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Harlen</surname> <given-names>OG</given-names></name>, <name name-style="western"><surname>Harrison</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Paci</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Understanding the apparent stator-rotor connections in the rotary ATPase family using coarse-grained computer modelling</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source>. <year>2014</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/prot.24680" xlink:type="simple">10.1002/prot.24680</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Szymczak</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cieplak</surname> <given-names>M</given-names></name>. <article-title>Hydrodynamic effects in proteins</article-title>. <source>Journal of Physics: Condensed Matter</source>. <year>2010</year>;<volume>23</volume>(<issue>3</issue>):<fpage>033102</fpage>. <object-id pub-id-type="pmid">21406855</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sharma</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Patankar</surname> <given-names>NA</given-names></name>. <article-title>Direct numerical simulation of the Brownian motion of particles by using fluctuating hydrodynamic equations</article-title>. <source>Journal of Computational Physics</source>. <year>2004</year>;<volume>201</volume>(<issue>2</issue>):<fpage>466</fpage>–<lpage>486</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jcp.2004.06.002" xlink:type="simple">10.1016/j.jcp.2004.06.002</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hanson</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Oliver</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Read</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Harlen</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>S</given-names></name>. <article-title>Modelling biomacromolecular assemblies with continuum mechanics</article-title>. <source>Biochemical Society Transactions</source>. <year>2015</year>;<volume>43</volume>(<issue>2</issue>):<fpage>186</fpage>–<lpage>192</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1042/BST20140294" xlink:type="simple">10.1042/BST20140294</ext-link></comment> <object-id pub-id-type="pmid">25849915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ganovelli</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Ponchio</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Rocchini</surname> <given-names>C</given-names></name>. <article-title>Fast tetrahedron-tetrahedron overlap algorithm</article-title>. <source>Journal of Graphics Tools</source>. <year>2002</year>;<volume>7</volume>(<issue>2</issue>):<fpage>17</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/10867651.2002.10487557" xlink:type="simple">10.1080/10867651.2002.10487557</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Franklin</surname> <given-names>WR</given-names></name>, <name name-style="western"><surname>Kankanhalli</surname> <given-names>MS</given-names></name>. <article-title>Volumes from overlaying 3-D triangulations in parallel</article-title>. <source>Lecture Notes in Computer Science</source>. <year>1993</year>;<volume>692</volume>:<fpage>477</fpage>–<lpage>489</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/3-540-56869-7_27" xlink:type="simple">10.1007/3-540-56869-7_27</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Van Der Spoel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lindahl</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hess</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Groenhof</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mark</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Berendsen</surname> <given-names>HJC</given-names></name>. <article-title>GROMACS: Fast, flexible, and free</article-title>. <source>J Comp Chem</source>. <year>2005</year>;<volume>26</volume>(<issue>16</issue>):<fpage>1701</fpage>–<lpage>1718</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jcc.20291" xlink:type="simple">10.1002/jcc.20291</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Phillips</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Braun</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Gumbart</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Tajkhorshid</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Villa</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Scalable molecular dynamics with NAMD</article-title>. <source>Journal of computational chemistry</source>. <year>2005</year>;<volume>26</volume>(<issue>16</issue>):<fpage>1781</fpage>–<lpage>1802</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jcc.20289" xlink:type="simple">10.1002/jcc.20289</ext-link></comment> <object-id pub-id-type="pmid">16222654</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref038">
<label>38</label>
<mixed-citation publication-type="other" xlink:type="simple">van Heesch D. Doxygen: Generate documentation from source code; 1999. <ext-link ext-link-type="uri" xlink:href="http://www.stack.nl/~dimitri/doxygen/index.html" xlink:type="simple">http://www.stack.nl/~dimitri/doxygen/index.html</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>L’ecuyer</surname> <given-names>P</given-names></name>. <article-title>Good parameters and implementations for combined multiple recursive random number generators</article-title>. <source>Operations Research</source>. <year>1999</year>;<volume>47</volume>(<issue>1</issue>):<fpage>159</fpage>–<lpage>164</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1287/opre.47.1.159" xlink:type="simple">10.1287/opre.47.1.159</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>L’ecuyer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Simard</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Kelton</surname> <given-names>WD</given-names></name>. <article-title>An object-oriented random-number package with many long streams and substreams</article-title>. <source>Operations research</source>. <year>2002</year>;<volume>50</volume>(<issue>6</issue>):<fpage>1073</fpage>–<lpage>1075</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1287/opre.50.6.1073.358" xlink:type="simple">10.1287/opre.50.6.1073.358</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cerutti</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Duke</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Freddolino</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Fan</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lybrand</surname> <given-names>TP</given-names></name>. <article-title>A vulnerability in popular molecular dynamics packages concerning Langevin and Andersen dynamics</article-title>. <source>Journal of chemical theory and computation</source>. <year>2008</year>;<volume>4</volume>(<issue>10</issue>):<fpage>1669</fpage>–<lpage>1680</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ct8002173" xlink:type="simple">10.1021/ct8002173</ext-link></comment> <object-id pub-id-type="pmid">19180249</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Frenkel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Smit</surname> <given-names>B</given-names></name>. <source>Understanding molecular simulation: from algorithms to applications</source>. <volume>vol. 1</volume>. <publisher-name>Academic press</publisher-name>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005897.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shkurti</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Goni</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Andrio</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Breitmoser</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bethune</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Orozco</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>pyPcazip: A PCA-based toolkit for compression and analysis of molecular simulation data</article-title>. <source>SoftwareX</source>. <year>2016</year>;<volume>5</volume>:<fpage>44</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.softx.2016.04.002" xlink:type="simple">10.1016/j.softx.2016.04.002</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref044">
<label>44</label>
<mixed-citation publication-type="other" xlink:type="simple">Schrödinger, LLC. The PyMOL Molecular Graphics System, Version 1.8; 2015.</mixed-citation>
</ref>
<ref id="pcbi.1005897.ref045">
<label>45</label>
<mixed-citation publication-type="other" xlink:type="simple">Oliver RC. A Stochastic Finite Element Model for the Dynamics of Globular Proteins. [PhD dissertation]. University of Leeds, Soft Matter Physics Group; 2012.</mixed-citation>
</ref>
<ref id="pcbi.1005897.ref046">
<label>46</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Howard</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <source>Mechanics of motor proteins and the cytoskeleton</source>. <publisher-name>Sinauer associates</publisher-name> <publisher-loc>Sunderland, MA</publisher-loc>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005897.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meyer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>D’Abramo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hospital</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rueda</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ferrer-Costa</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Pérez</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>MoDEL (Molecular Dynamics Extended Library): a database of atomistic molecular dynamics trajectories</article-title>. <source>Structure</source>. <year>2010</year>;<volume>18</volume>(<issue>11</issue>):<fpage>1399</fpage>–<lpage>1409</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.str.2010.07.013" xlink:type="simple">10.1016/j.str.2010.07.013</ext-link></comment> <object-id pub-id-type="pmid">21070939</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tarricone</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Xiao</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Justin</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Walker</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>The structural basis of Arfaptin-mediated cross-talk between Rac and Arf signalling pathways</article-title>. <source>Nature</source>. <year>2001</year>;<volume>411</volume>(<issue>6834</issue>):<fpage>215</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/35075620" xlink:type="simple">10.1038/35075620</ext-link></comment> <object-id pub-id-type="pmid">11346801</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Natesh</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bhanumoorthy</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Vithayathil</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sekar</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ramakumar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Viswamitra</surname> <given-names>M</given-names></name>. <article-title>Crystal structure at 1.8 Å resolution and proposed amino acid sequence of a thermostable xylanase from Thermoascus aurantiacus</article-title>. <source>Journal of molecular biology</source>. <year>1999</year>;<volume>288</volume>(<issue>5</issue>):<fpage>999</fpage>–<lpage>1012</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1006/jmbi.1999.2727" xlink:type="simple">10.1006/jmbi.1999.2727</ext-link></comment> <object-id pub-id-type="pmid">10329194</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leimkuhler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Matthews</surname> <given-names>C</given-names></name>. <article-title>Molecular dynamics: with deterministic and stochastic Numerical Methods</article-title>. <source>Interdisciplinary Applied Mathematics</source>. <year>2015</year>;<volume>39</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/978-3-319-16375-8" xlink:type="simple">10.1007/978-3-319-16375-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005897.ref051">
<label>51</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Beer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Johnston</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>DeWolf</surname> <given-names>J</given-names></name>. <source>Mechanics of Materials</source>. <publisher-name>McGraw-Hill</publisher-name>, <publisher-loc>New York</publisher-loc>. <year>2002</year>;.</mixed-citation>
</ref>
</ref-list>
</back>
</article>