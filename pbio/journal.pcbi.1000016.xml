<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="publisher-id">07-PLCB-RA-0649R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000016</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Genetics and Genomics/Bioinformatics</subject><subject>Genetics and Genomics/Genetics of the Immune System</subject><subject>Hematology/Bone Marrow and Stem Cell Transplantation</subject><subject>Immunology</subject><subject>Infectious Diseases/Epidemiology and Control of Infectious Diseases</subject><subject>Infectious Diseases/HIV Infection and AIDS</subject></subj-group></article-categories><title-group><article-title>Statistical Resolution of Ambiguous HLA Typing Data</article-title><alt-title alt-title-type="running-head">Statistical Modeling of T Cell Responses</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Listgarten</surname><given-names>Jennifer</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Brumme</surname><given-names>Zabrina</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Kadie</surname><given-names>Carl</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Xiaojiang</surname><given-names>Gao</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Walker</surname><given-names>Bruce</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Carrington</surname><given-names>Mary</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Goulder</surname><given-names>Philip</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Heckerman</surname><given-names>David</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1"><label>1</label><addr-line>Microsoft Research, Redmond, Washington, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Partners AIDS Research Center, Massachusetts General Hospital, Harvard Medical School, Boston, Massachusetts, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>SAIC-Frederick, National Cancer Institute, Frederick, Maryland, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Howard Hughes Medical Institute, Frederick, Maryland, United States of America</addr-line>       </aff><aff id="aff5"><label>5</label><addr-line>Department of Paediatrics, University of Oxford, Oxford, United Kingdom</addr-line>       </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Bergstrom</surname><given-names>Carl T.</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of Washington, United States of America</aff><author-notes><corresp id="cor1">* E-mail: <email xlink:type="simple">jennl@microsoft.com</email> (JL); <email xlink:type="simple">heckerma@microsoft.com</email> (DH)</corresp><fn fn-type="con"><p>JL contributed algorithm and experiment design, implementation and running of the experiments, and writing of the paper. ZLB organized the data and aided in the writing and experiment design. CK helped make the public Web tool version of the algorithm available. GX provided HLA typing of private data. BDW organized the data. MC provided HLA typing of private data, and aided in the writing. PJG presented the need for statistical HLA refinement. DH contributed algorithm and experiment design, and contributed to the writing of the paper.</p></fn><fn fn-type="conflict"><p>A tool based on our approach will be made freely available for research purposes at <ext-link ext-link-type="uri" xlink:href="http://microsoft.com/science" xlink:type="simple">http://microsoft.com/science</ext-link>.</p></fn></author-notes><pub-date pub-type="collection"><month>2</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>29</day><month>2</month><year>2008</year></pub-date><volume>4</volume><issue>2</issue><elocation-id>e1000016</elocation-id><history><date date-type="received"><day>23</day><month>10</month><year>2007</year></date><date date-type="accepted"><day>30</day><month>1</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Listgarten et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>High-resolution HLA typing plays a central role in many areas of immunology, such as in identifying immunogenetic risk factors for disease, in studying how the genomes of pathogens evolve in response to immune selection pressures, and also in vaccine design, where identification of HLA-restricted epitopes may be used to guide the selection of vaccine immunogens. Perhaps one of the most immediate applications is in direct medical decisions concerning the matching of stem cell transplant donors to unrelated recipients. However, high-resolution HLA typing is frequently unavailable due to its high cost or the inability to re-type historical data. In this paper, we introduce and evaluate a method for statistical, in silico refinement of ambiguous and/or low-resolution HLA data. Our method, which requires an independent, high-resolution training data set drawn from the same population as the data to be refined, uses linkage disequilibrium in HLA haplotypes as well as four-digit allele frequency data to probabilistically refine HLA typings. Central to our approach is the use of haplotype inference. We introduce new methodology to this area, improving upon the Expectation-Maximization (EM)-based approaches currently used within the HLA community. Our improvements are achieved by using a parsimonious parameterization for haplotype distributions and by smoothing the maximum likelihood (ML) solution. These improvements make it possible to scale the refinement to a larger number of alleles and loci in a more computationally efficient and stable manner. We also show how to augment our method in order to incorporate ethnicity information (as HLA allele distributions vary widely according to race/ethnicity as well as geographic area), and demonstrate the potential utility of this experimentally. A tool based on our approach is freely available for research purposes at <ext-link ext-link-type="uri" xlink:href="http://microsoft.com/science" xlink:type="simple">http://microsoft.com/science</ext-link>.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><p>At the core of the human adaptive immune response is the train-to-kill mechanism in which specialized immune cells are sensitized to recognize small peptides from foreign sources (e.g., from HIV or bacteria). Following this sensitization, these immune cells are then activated to kill other cells which display this same peptide (and which contain this same foreign peptide). However, in order for sensitization and killing to occur, the foreign peptide must be “paired up” with one of the infected person's other specialized immune molecules—an HLA molecule. The way in which peptides interact with these HLA molecules defines if and how an immune response will be generated. There is a huge repertoire of such HLA molecules, with almost no two people having the same set. Furthermore, a person's HLA type can determine their susceptibility to disease, or the success of a transplant, for example. However, obtaining high quality HLA data for patients is often difficult because of the great cost and specialized laboratories required, or because the data are historical and cannot be retyped with modern methods. Therefore, we introduce a statistical model which can make use of existing high-quality HLA data, to infer higher-quality HLA data from lower-quality data.</p></abstract><funding-group><funding-statement>This publication has been funded in whole or in part with federal funds from the National Cancer Institute, National Institutes of Health, under contract N01-CO-12400. The content of this publication does not necessarily reflect the views of policies of the Department of Health and Human Services, nor does mention of trade names, commercial products, or organizations imply endorsement by the US Government. This research was supported in part by the Intramural Research Program of NIH, National Cancer Institute, Center for Cancer Research.</funding-statement></funding-group><counts><page-count count="15"/></counts></article-meta></front><body><sec id="s1"><title>Introduction</title><p>The Major Histocompatibility Complex (MHC), located on the short arm of chromosome 6, encodes the Human Leukocyte Antigen (HLA) class I and II genes, whose protein products play an essential role in the adaptive immune response. The HLA class I and class II proteins bind antigenic, pathogen-derived peptides (called <italic>epitopes</italic>) and display them on the cell surface for recognition by CD8+ or CD4+ T-lymphocytes, respectively, thus activating the cellular immune response and mediating pathogen clearance. Critically, each HLA protein can bind only a limited range of peptides (as dictated by HLA-specific binding motifs), and individuals express different (and multiple) HLA class I and class II proteins with different peptide specificities. In addition, the HLA class I and II genes represent the most polymorphic set of genes in the human genome; extensive MHC/HLA genetic diversity on both an individual as well as a population level ensures that the human immune response will be equipped to target a diverse range of pathogens. To date, more than 600, 900, and 300 different alleles have been identified, respectively, for the class I HLA-A,-B and -C-loci, whereas more than 600 alleles have been identified at the class II HLA-DRB1 locus; new alleles are routinely being discovered <xref ref-type="bibr" rid="pcbi.1000016-Hertz1">[1]</xref>. In addition, due to their location within the MHC region on chromosome 6, HLA alleles are in tight linkage disequilibrium, and thus can be thought of in terms of a haplotype <xref ref-type="bibr" rid="pcbi.1000016-Hurley1">[2]</xref>.</p><p>High-resolution HLA typing (meaning the determination of the specific HLA alleles which an individual expresses at each of the class I and/or class II loci) is an essential tool for basic as well as clinical immunology research. For example, HLA typing has been used to identify immunogenetic risk factors for human diseases <xref ref-type="bibr" rid="pcbi.1000016-Thorsby1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Carrington1">[4]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Yee1">[5]</xref> and more recently has been used to investigate how pathogens (such as HIV (e.g., <xref ref-type="bibr" rid="pcbi.1000016-Bhattacharya1">[6]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Brumme1">[7]</xref>) and, more recently Hepatitis C Virus <xref ref-type="bibr" rid="pcbi.1000016-Timm1">[8]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Gaudieri1">[9]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Gaudieri2">[10]</xref>) evolve in response to HLA-restricted immune selective pressures. In addition, HLA typing is essential for vaccine research: the identification and mapping of HLA-restricted T-cell epitopes in the proteomes of different pathogens (e.g., <xref ref-type="bibr" rid="pcbi.1000016-Listgarten1">[11]</xref>), could help inform the selection of potential immunogens in a T-cell based vaccine design. Clinically, high-resolution HLA typing is routinely required in the context of modern transplantation medicine, such as for hematopoietic stem cell transplants: in order to minimize risk of rejection, donors and unrelated recipients must be matched with respect to HLA alleles expressed <xref ref-type="bibr" rid="pcbi.1000016-Gourraud1">[12]</xref>.</p><p>Historically, HLA typing was performed using low-resolution, antibody-based serological tests. However, higher-resolution HLA typing is now achievable using more modern, molecular (DNA-based) methods. Molecular methods for HLA typing include hybridization with sequence-specific oligonucleotide probes (SSOP), PCR amplification with sequence-specific primers (PCR-SSP), and more recently, DNA sequence-based methods. Generally, DNA sequence-based methods involve locus-specific PCR amplification of exons 2 and 3 (for HLA Class I genes), or exon 2 only (for HLA class II), followed by “bulk” DNA sequencing of the amplified product (i.e., sequencing of products derived from both HLA haplotypes). Sequencing is restricted to exons 2 and/or 3 because these regions are the major determinants of HLA peptide-binding specificity and thus contain enough information to discriminate between most allele combinations. If an individual is heterozygous (i.e., possesses two different alleles) at any locus, direct sequencing of an amplified PCR product will yield nucleotide mixtures at positions in which the two alleles differ in sequence. Consequently, there are two reasons why modern sequence-based typing methods may yield ambiguous typing results: first, if the differences between the two alleles are located outside the genotyped region (in most cases, exons 2 and/or 3), and secondly, if two or more allele combinations yield the exact same pattern of heterozygous nucleotide mixtures when combined into a “bulk” sequence.</p><p>Because of the great (and ever-increasing) number of HLA alleles (and thus growing list of ambiguous combinations), unambiguous HLA typing is costly, laborious, and limited to laboratories specializing in this work. For the purposes of scientific research, HLA types are not always unambiguously determined; rather, they are only determined up to some “resolution” (i.e., level of ambiguity). Additionally, because the number of HLA alleles is constantly increasing, sequence-based, SSOP and SSP based typing results, which depend on the list of known alleles, require constant re-interpretation in light of newly discovered alleles. This re-interpretation can result in more ambiguity than originally thought <xref ref-type="bibr" rid="pcbi.1000016-Voorter1">[13]</xref>. Perhaps even more importantly, it is often impossible to re-type historic samples that may have been typed using lower-resolution approaches.</p><p>The practical consequence of these issues is that there is a large incongruence between the high-resolution HLA typing required for scientific investigations and the HLA data that is widely available. As such, any method which can help to increase resolution of HLA data, <italic>post-hoc</italic> and at low cost, will provide a greatly needed service to the scientific and clinical communities. In this paper, we introduce and evaluate a method for statistical, in silico refinement of ambiguous HLA types. Our method uses information available from inferred HLA haplotypes to probabilistically refine HLA data. Our method, which relies upon haplotype inference from unphased data, introduces new methodology to this area which improves upon the most commonly used approach within the HLA community (i.e., multinomial parameterization trained with an EM—Expectation-Maximization—algorithm).</p><p>Our improvements are achieved by using a parsimonious parameterization, and by smoothing the maximum likelihood (ML) solution. These improvements make it possible to scale the refinement to a larger number of alleles and loci in a more computationally efficient and stable manner. We also show how to augment our method in order to make use of data arising from different ethnic backgrounds, and show the potential use of this experimentally. Our method is evaluated using data from various sources, and from various ethnicities, as described in the Experimental section. Additionally, an implementation of our method is available for community-wide use.</p><sec id="s1a"><title>HLA Nomenclature and Typing Ambiguity</title><p>HLA nomenclature is closely tied to the levels of possible HLA ambiguity. Each HLA allele is assigned a letter (or letters) which designate the locus (e.g., A, B, and C for class I; DRA, DRB1, DRB2-9, DQA1, DQB1, DPA1, DPB1, for class II.) This letter is followed by a sequence of numbers, such as A*0301, for one allele at the A locus. The first two digits describe the allele type; in most cases the first two digits correspond to the historical serological antigen groupings. <italic>Low resolution</italic> HLA typing refers to alleles which are reported at this two-digit level (e.g., A*03).</p><p>The third and fourth digits are used to designate the allele subtypes, wherein alleles are assigned numbers from 01–99 roughly according to their order of discovery. A minimum of four digits thus uniquely defines any allele: by definition, any two alleles which differ in their four-digit number, differ by at least one amino acid. For example, A*0301 and A*0302 do not encode the same protein sequence. Because two-digit names are exhausted after 99 alleles, there are a few oddities in the nomenclature. For example, A*02 and A*92 belong to the same two-digit class as do B*15 and B*95 <xref ref-type="bibr" rid="pcbi.1000016-Marsh1">[14]</xref>.) See <ext-link ext-link-type="uri" xlink:href="http://www.anthonynolan.org.uk/HIG/lists/nomenlist.html" xlink:type="simple">http://www.anthonynolan.org.uk/HIG/lists/nomenlist.html</ext-link> and <xref ref-type="bibr" rid="pcbi.1000016-Hurley1">[2]</xref> for more nomenclature details. Sometimes more than four digits are used to designate an allele: the fifth and sixth digits are used to distinguish alleles which differ only by synonymous substitutions (i.e., do not change the amino acid sequence of the protein), while the seventh and eighth digits distinguish alleles which differ in sequence in the non-coding regions of the gene (i.e., the introns or the 5′ or 3′ untranslated regions). For the purpose of our work, we omit this level of detail and limit our analysis to the four-digit level only. In any case, there is not enough data available at the six-to eight- digit resolution level to do any substantial statistical modeling.</p><p>Assuming that HLA resolution beyond four digits are ignored, there are still various levels of ambiguity that can arise from molecular (DNA)-based HLA typing methods. For example, rather than knowing unambiguously which two A alleles a person has, one may instead know only a list of possibilities; for example, A*0301-A*3001 or A*0320-A*3001 or A*0326-A*3001. Such <italic>intermediate resolution</italic> types may result from sequence-specific PCR (SSP) based typing where testing with the initial set of PCR primers will yield a list of possible genotypes that a particular person might have (which may require further testing with additional combinations of allele-specific primers and/or cloning and sequencing of clones before an unambiguous type is achieved). As previously mentioned, even modern sequence-based methods may result in ambiguous allele combinations (if sequenced alleles differ outside the genotyped region, or if different possible allele combinations result in the same pattern of observed nucleotide mixtures). Depending on the clinical and/or research purpose of the HLA typing, additional laboratory testing required for achieving high-level (i.e., four-digit) resolution are often not performed for reasons relating to time and cost. In many cases, intermediate-level resolution data are truncated to two-digit resolution; in the previous example, this individual would be reported as having HLA alleles A*03 and A*30.</p><p>Although related but different HLA alleles (for example, those alleles which share the same first two digits) sometimes share immunogenic properties, higher resolution data allows for more precise and informative downstream use (e.g., <xref ref-type="bibr" rid="pcbi.1000016-Gao1">[15]</xref>). We are thus motivated to develop low-cost techniques for improving resolution, such as the statistical method introduced here.</p><p>The input to our statistical HLA refinement method consists of two data sets. The first is data of interest that have not been typed unambiguously to a four-digit resolution, but for which we would like to increase the resolution as much as possible. The second input is a set of training data consisting of four-digit resolution HLA types for individual people, where the population is drawn from one that is the same (or, in practice, as similar as possible) to the population of interest for which we wish to refine HLA types. First we train our model on the training data. Then we apply this trained model to our limited-resolution data of interest. For example, if a patient in our data set of interest was typed ambiguously at the A locus as having either (1) A*0243, A*0101, or (2) A*0243, A*0122, then our statistical model assigns a probability to each of these two possibilities. More generally, our model assigns a probability to any number of possibilities (not just two), and over many loci. To date, we have used our method, without computational difficulty, to refine up to four loci with 20–130 alleles at each locus, and, on data sets with up to half a million possible haplotypes.</p><p>To be precise about what kind of HLA typing ambiguities our approach can tackle, we emphasize that in principle, our approach can handle any kind of ambiguity, so long as that ambiguity has been resolved in the training data set, and so long as the ambiguity can be defined as an allele or set of alleles, taking on some number of clearly defined possibilities. Two common ambiguities that are of interest to researchers are i) <italic>molecular allele ambiguities</italic>, in which we know that one allele, specified unambiguously (e.g., A*02) is actually one of several possibilities (i.e., A*0201, A*0202, A*0203, <italic>etc</italic>), and ii) <italic>genotype ambiguities</italic>, in which ambiguity arising when various combinations of alleles from both chromosomes produce the same patterns of heterozygous nucleotides in the chromatogram). In this paper, we focus our experiments on the first type of ambiguity, although our approach should work on the second kind as well. It may also be of interest to predict high-resolution HLA types from serological data. So long as it is known which serological types map to which molecular types, our model can, in principle, tackle these types of data.</p></sec><sec id="s1b"><title>Related Work</title><p>At the core of our HLA typing refinement model is the ability to infer and predict haplotype structure of HLA alleles across multiple loci (from unphased data, since this is the data that is widely available). If certain alleles tend to be inherited together because of linkage disequilibrium between them, then clearly this information can help us to disambiguate HLA types—and far more so than using only the most common allele at any particular locus. We derive a method for disambiguating HLA types from this haplotype model.</p><p>Existing methods for haplotype modeling fall into three main categories: <italic>ad hoc</italic> methods, such as Clark's parsimony algorithm <xref ref-type="bibr" rid="pcbi.1000016-Clark1">[16]</xref> which agglomerates haplotypes starting with those uniquely defined by homozygous alleles; EM-based maximum likelihood methods, such as those belonging to the family introduced by Excoffier and Slatkin, and Hawley and Kidd <xref ref-type="bibr" rid="pcbi.1000016-Excoffier1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Hawley1">[18]</xref>, which are related to the so-called <italic>gene-counting</italic> method <xref ref-type="bibr" rid="pcbi.1000016-Ceppellini1">[19]</xref>; and full Bayesian approaches, such as those introduced by Stephens et al. <xref ref-type="bibr" rid="pcbi.1000016-Stephens1">[20]</xref>, with more recent advances by others (e.g., <xref ref-type="bibr" rid="pcbi.1000016-Zhang1">[21]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Xing1">[22]</xref>). Clark's method is no longer used, as it is outperformed by other methods. The full Bayesian methods are more principled than the EM-based methods because they average over all uncertainty including uncertainty about the parameters. However, full Bayesian methods are generally much slower than EM-based methods, and their convergence is generally more difficult to assess <xref ref-type="bibr" rid="pcbi.1000016-Niu1">[23]</xref>, making them less attractive for widespread use.</p><p>The haplotype modeling part of our approach is most closely related to the EM-based maximum-likelihood methods, although it differs in several crucial respects. To our knowledge, all implementations of EM-based maximum likelihood haplotype models use a full (unconstrained) joint probability distribution over all haplotypes (i.e., over all possible alleles, at all possible loci) with the exception of the partition-ligation algorithms noted below. Furthermore, because they are maximum-likelihood based, they do not smooth the parameter estimates, thereby allowing for unstable (i.e., high variance) estimates of rare haplotypes. Together, these two issues make existing methods difficult to scale to a large number of loci or to a large number of alleles per locus. This scalability problem is widely known (e.g., <xref ref-type="bibr" rid="pcbi.1000016-Excoffier1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Thomas1">[24]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Fallin1">[25]</xref>), and several attempts to alleviate it have been suggested, such as eliminating posterior states which can never have non-zero probability <xref ref-type="bibr" rid="pcbi.1000016-Thomas1">[24]</xref>, or using a heuristic divide-and-conquer strategy, called partition-ligation <xref ref-type="bibr" rid="pcbi.1000016-Niu2">[26]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Niu1">[23]</xref> in which the joint probability distribution over haplotypes is factored into independent blocks of contiguous loci, and the solutions to each block are then combined. Although these approaches do help alleviate the problems of scalability, the former does so in a fairly minimal way, and the latter places heuristic constraints on the nature of the solution (through use of the blocks). Furthermore, these methods do not address scaling in the number of alleles, which is the larger concern for HLA typing. In addition, these methods do not address the stability of the statistical estimation procedure. Our EM-based approach tackles the issues of scalability by using a parsimonious haplotype parameterization. This especially helps for scaling up to the large number of alleles in HLA data. Our approach also addresses stability by using MAP (<italic>maximum a posteriori</italic>) parameter estimation rather than an ML estimate.</p><p>We note that within the HLA community, even recently, haplotype inference seems to be exclusively performed with the most basic EM-based algorithm of Excoffier and Slatkin, and Hawley and Kidd <xref ref-type="bibr" rid="pcbi.1000016-Excoffier1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Hawley1">[18]</xref> (e.g., <xref ref-type="bibr" rid="pcbi.1000016-Maiers1">[27]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Leffell1">[28]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Thriskos1">[29]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Kollman1">[30]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Mller1">[31]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Cao1">[32]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Gourraud2">[33]</xref>). In fact, in one of the most recently available publications, Maiers et al. were unable to perform haplotype inference for more than three HLA loci, resorting to more heuristic techniques beyond this number. With our approach, such limitations are not reached. In addition, as we shall see, our approach is more accurate.</p><p>There are two pieces of work which tackle the allele refinement problem using haplotype information: that of Gourraud et al. in the HLA domain <xref ref-type="bibr" rid="pcbi.1000016-Gourraud1">[12]</xref>, and that of Jung et al. in the SNP (single nucleotide polymorphism) domain <xref ref-type="bibr" rid="pcbi.1000016-Jung1">[34]</xref>. Although Gourraud et al. indirectly tackle the HLA refinement problem, their focus is on phasing of HLA data in the presence of ambiguous HLA alleles, and their experimental evaluation is restricted to the phasing task. Additionally, they use the standard, multinomial, EM-based haplotype inference approach, which we show to be inferior for the task of HLA refinement. Also, they do not investigate population-specific effects as we do here. Jung et al., strictly speaking, don't refine their data. Rather, they impute it—that is, they fill in data that is completely missing. The SNP domain is quite different from the HLA domain—the problem of SNP haplotype inference often involves hundreds or thousands of loci, and there are usually only two alleles at each locus (and at most four). HLA haplotype inference, in contrast, involves only a handful of loci with possibly hundreds of alleles at each locus (because we define a locus on an HLA level, not a nucleotide level—although one could do HLA haplotype inference in the nucleotide domain).</p><p>Thus, issues of scalability and the specific nature of haplotypic patterns are substantially different between these two domains. With respect to methodology, Jung et al. perform imputation in a sub-optimal way. First, they apply an EM-based haplotype inference algorithm (<xref ref-type="bibr" rid="pcbi.1000016-Niu1">[23]</xref>) to obtain a <italic>single</italic> best phasing of their data (i.e., a ML point estimate). Next, using the statistically phased data, they compute linkage disequilibrium in the inferred haplotypes using the standard measure of Lewontin's linkage disequilibrium. Thus, they ignore the uncertainty over phases which is available from the EM algorithm. Also, they choose only the single best imputed value, ignoring the uncertainty there as well. Our approach incorporates both types of uncertainty. Lastly, the haplotype inference algorithm used by Jung et al. does not account for population-specific effects. Consequently, they do not investigate this area experimentally, as we do here, showing its potential benefits.</p><p>One other study touches on statistical HLA refinement <xref ref-type="bibr" rid="pcbi.1000016-Mller1">[31]</xref>. In order to estimate haplotype frequencies on serologically-derived HLA data, Muller et al. modify the standard EM-based haplotype inference approach to be able to use donors with unsplit serological HLA types. However, their main purpose is to estimate haplotype frequencies (at a two-digit serological level) rather than to perform HLA refinement; and their experiments focus on this former task.</p></sec></sec><sec id="s2"><title>Materials and Methods</title><p>Before explaining our model in detail, we first explain the standard EM-based model and training algorithm used for haplotype inference <xref ref-type="bibr" rid="pcbi.1000016-Excoffier1">[17]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Hawley1">[18]</xref>. Without loss of generality, suppose that we are performing haplotype inference over three loci, <italic>l</italic><sub>1</sub>, <italic>l</italic><sub>2</sub>, and <italic>l</italic><sub>3</sub>, with <italic>L<sup>i</sup></italic> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e001" xlink:type="simple"/></inline-formula> alleles at each locus. Then, in the standard EM-based approach, the probability of a haplotype is parameterized by a multinomial table which gives the probability of every possible haplotype,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e002" xlink:type="simple"/><label>(1)</label></disp-formula></p><p>In this case, there would be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e003" xlink:type="simple"/></inline-formula> possible haplotypes, requiring <italic>L</italic> parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e004" xlink:type="simple"/></inline-formula>. EM is a general algorithm for solving ML/MAP parameter estimates in the presence of missing data/hidden variables <xref ref-type="bibr" rid="pcbi.1000016-Dempster1">[35]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Neal1">[36]</xref> (which, here, are the phases). In the present context, EM reduces to iterating between two simple steps:</p><list list-type="order"><list-item><p>Given the current parameter estimates (for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e005" xlink:type="simple"/></inline-formula>), find the distribution of phases for each observed genotype. This is the E-step, where the expectation over haplotypes/hidden states is computed.</p></list-item><list-item><p>Given the distribution over haplotypes/hidden states for each observed genotype, compute the maximum likelihood parameter estimates (in this case, the multinomial parameters). This is the M-step, where the parameters are maximized with respect to the <italic>expected complete log likelihood</italic>, where the expectation is taken with respect to the posterior over hidden states, and the complete log likelihood is the likelihood in which the missing information (the phase) has been probabilistically completed proportionally to the posterior distribution over phases.</p></list-item></list><p>Note that in both of these steps, it is assumed that the probability of an individual's genotype data having a particular phasing is the product of the probability of each of the two haplotypes defined by the phasing. Thus this approach assumes Hardy-Weinberg equilibrium (HWE).</p><p>As mentioned earlier, there are two main problems with this modeling approach. The first is that the number of parameters, <italic>L</italic>, scales badly with the number of loci and with the number of alleles at each locus. This creates two practical problems which quickly come into play —computational limitations on the number of loci/alleles which can be handled by the algorithm <xref ref-type="bibr" rid="pcbi.1000016-Maiers1">[27]</xref>, and, poor stability with respect to the parameter estimation because the number of parameters tends to be very large relative to the number of data typically available. We alleviate both of these problems using several modifications, and show experimentally the benefits that these modifications provide.</p><sec id="s2a"><title>ASoftmax-Based Haplotype Model</title><p>First, we describe a model for <italic>p</italic>(<italic>l</italic><sub>1</sub>,<italic>l</italic><sub>2</sub>,<italic>l</italic><sub>3</sub>,) that uses far fewer parameters than the full table. Using the chain rule of probability, we can write<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e006" xlink:type="simple"/><label>(2)</label></disp-formula></p><p>Equation 2 does not introduce any conditional independencies. If we were to use a (conditional) probability table for each of these three local distributions, then this model would capture exactly the same information as Equation 1 and would not reduce the number of parameters. However, instead of using conditional probability tables, we use softmax regression functions (also known as multilogit regression) <xref ref-type="bibr" rid="pcbi.1000016-Bishop1">[37]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Hastie1">[38]</xref>. A <italic>softmax regression function</italic> is an extension of logistic regression to more than two target classes. Using a softmax regression function to parameterize <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e007" xlink:type="simple"/></inline-formula>, the probability that the allele at the third locus is the <italic>k</italic><sup>th</sup> allele, conditioned on the alleles at the other two loci, <italic>l</italic><sub>1</sub>, <italic>l</italic><sub>2</sub>, we have<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e008" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e009" xlink:type="simple"/></inline-formula> are parameter vectors of the softmax regression—one for each possible allele, <italic>j</italic>, at the third locus. Thus, the softmax regression function takes a linear combination of the input features, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e010" xlink:type="simple"/></inline-formula>, plus a constant term, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e011" xlink:type="simple"/></inline-formula>, to model each class, which produces a real-valued number for each class. Then, this real-value is exponentiated, and normalized relative to all of the other classes, to yield the probability of interest.</p><p>Similarly, the softmax regression function for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e012" xlink:type="simple"/></inline-formula> in Equation 2 is written as <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e013" xlink:type="simple"/></disp-formula>and for <italic>p</italic>(<italic>l</italic><sub>1</sub>), trivially, as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e014" xlink:type="simple"/></disp-formula>with respective parameters, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e015" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e016" xlink:type="simple"/></inline-formula>. Because the alleles at each locus are discrete in nature, we use a binarized version of the inputs. That is, we use a <italic>one-hot encoding</italic>, wherein each discrete input, <italic>l<sub>i</sub></italic> = <italic>k</italic> is represented by a binary vector of length <italic>L<sup>i</sup></italic> that contains all zeros, except at the <italic>k</italic><sup>th</sup> position, which contains a one. Correspondingly, the parameter vectors are augmented in length to match this dimensionality. Thus, in this binary representation, the length of each <italic>w<sup>k</sup></italic> would be <italic>L</italic><sup>1</sup>+<italic>L</italic><sup>2</sup>+1, and the total number of scalar parameters required to represent <italic>p</italic>(<italic>l</italic><sub>1</sub>,<italic>l</italic><sub>2</sub>,<italic>l</italic><sub>3</sub>,) would be <italic>M</italic> = <italic>L</italic><sup>3</sup>(<italic>L</italic><sup>1</sup>+<italic>L</italic><sup>2</sup>+1)+<italic>L</italic><sup>2</sup>(<italic>L</italic><sup>1</sup>+1)+<italic>L</italic><sup>1</sup>(1). Note that <italic>M</italic> grows much more slowly here as compared to <italic>L</italic> for the multinomial tables. In particular, <italic>L</italic> grows exponentially in the number of loci and alleles, whereas <italic>M</italic> grows only linearly. Use of full tables versus the softmax regression function relates to the well known bias–variance trade-off <xref ref-type="bibr" rid="pcbi.1000016-Bishop1">[37]</xref> which states that the more flexible a model, the more variance one will have in estimating its parameters. To reduce variance, one can decrease the flexibility of the model (as we have done by using softmax regression rather than multinomial parameterizations), thereby increasing the bias of the learned model (because the family of possible models is more restricted). Whether one has chosen a suitable bias-variance trade-off is normally assessed empirically. In the experimental section, we show that the use of the softmax regression function improves the accuracy of the HLA refinement task over use of a multinomial parameterization.</p><p>This softmax-based model can be easily extended, by direct analogy, to more than three loci, and far more efficiently than can the multinomial-based model. We note that the additive nature of the softmax regression functions leads to the property that similar haplotypes have similar joint probabilities. Coalescent priors used in some Bayesian approaches also have this property, whereas full tables do not.</p></sec><sec id="s2b"><title>Training the Model with EM</title><p>We use the EM algorithm to train our model—that is, to choose good settings of the softmax parameters (<italic>w<sup>j</sup></italic>, <italic>v<sup>j</sup></italic>, and <italic>q<sup>j</sup></italic>) given observed genotype data. The way in which EM operates for our model is very similar to the way in which it works for the multinomial-based models. Again, we iterate between an E-step, where the posterior over possible phases is computed, followed by an M-step, where the parameters of the model are computed based on the posterior computations from the E-step. The difference, of course, is that the posterior uses our softmax model to compute the posterior, and our M-step estimates softmax-regression parameters rather than multinomial parameters.</p><p>Formally, let <italic>g<sup>d</sup></italic> be the observed genotype/HLA data for the <italic>d</italic><sup>th</sup> person in our data set. For example, if we have data for three loci, HLA-A, HLA-B, and HLA-C, then we would have unphased data for each chromosome, for each locus, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e017" xlink:type="simple"/></inline-formula>. There are 2<sup>number of loci−1</sup> possible unique phase states, <italic>h<sub>i</sub><sup>d</sup></italic>, that this data can take on (assuming no ordering of the chromosomes):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e018" xlink:type="simple"/></disp-formula></p><p>For the E-step, we compute <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e019" xlink:type="simple"/></inline-formula> for each data point, for each possible phase. This computation is easily accomplished by determining the likelihood of the data in each possible phase state, and then renormalizing these within each person so that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e020" xlink:type="simple"/></inline-formula>. Here, we assume that each phasing is a priori equiprobable. The likelihood of one datum in a particular phase state, <italic>l<sub>i</sub><sup>d</sup></italic> is given by the product of the likelihood under our haplotype model, for each of the two chromosomes. For example, the likelihood for the <italic>d</italic><sup>th</sup> genotype to be in phase state 2 is given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e021" xlink:type="simple"/><label>(4)</label></disp-formula>and renormalization of these likelihoods gives us the posterior over phase states for a single individual,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e022" xlink:type="simple"/></disp-formula></p><p>For the M-step, we use the E-step posteriors to compute the parameter estimates. As mentioned, we use MAP parameter estimates which are generally more stable. For the prior distribution of each parameter, we use a zero-centered Gaussian distribution. The use of this parameter prior is sometimes referred to as <italic>L2 smoothing</italic> or <italic>L2 regularization</italic>, because its use is equivalent to adding a penalty term to the log likelihood that consists of the square of the L2 norm of the parameter vectors. Thus, whereas in a maximum likelihood setting we would, in the M-step, maximize the quantity<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e023" xlink:type="simple"/></disp-formula>which is the expected complete log likelihood, with respect to the softmax parameters, <italic>w<sup>j</sup></italic>, <italic>v<sup>j</sup></italic>, and <italic>q<sup>j</sup></italic>, we instead maximize the quantity<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e024" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e025" xlink:type="simple"/></inline-formula> denotes the L2 norm of vector <italic>x</italic>. This quantity is the regularized expected complete log likelihood. The regularization parameters, <italic>λ</italic> = (<italic>λ</italic><sub>1</sub>,<italic>λ</italic><sub>2</sub>,<italic>λ</italic><sub>3</sub>,), which are (inversely) related to the variance of the Gaussian prior, are set empirically using a hold out set. Because this MAP estimation problem is embedded inside of an M-step, the regularization parameters are theoretically not independent (except for <italic>λ</italic><sub>1</sub> because it does not depend on the phasing of the data), and hence must be adjusted jointly. We describe how we do so in the experimental section.</p><p>The use of other parameters priors is possible. One commonly used alternative is the Laplacian prior or, equivalently, L1 regularization. In experiments not reported here, we have found L2 and L1 regularization to provide comparable performance on our task.</p><p>By iterating between the E-step and the M-step from some chosen parameter initialization (or, some posterior initialization), we are guaranteed to locally maximize the log posterior of the data, <italic>L</italic>, (keeping the <italic>λ<sub>j</sub></italic> fixed),<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e026" xlink:type="simple"/></disp-formula></p><p>We note that one can smooth/regularize the parameters of the multinomial table using a Dirichlet prior. This smoothing has the effect of adding pseudo-counts to the observed counts of the data when computing the ML estimate during the M-step. In our experiments, we compare our model against both the traditional multinomial haplotype model and a Dirichlet regularized multinomial model.</p><p>The ML (and L2-regularized MAP) softmax regression parameter estimation problem within a single M-step is a convex problem, and hence not subject to local minima. In contrast, <italic>L</italic>(<italic>λ</italic>) is not convex due to unobserved phase and is subject to local minima. Nonetheless, in our experiments, we did not find local minima to be a large problem, and leave further discussion of this to the Experimental section.</p><p>As with the traditional algorithm used in the HLA community, our EM algorithm assumes random mating. In the discussion, we propose one way to remove this assumption.</p></sec><sec id="s2c"><title>Using the Model for Statistical HLA Refinement</title><p>As discussed, we first train our model using the EM algorithm on a data set consisting of four-digit resolution HLA data from a population similar to that of our data of interest. We then use the model to probabilistically refine our lower-resolution data set. To do so, we refine each person's HLA type independently of the others. The way we do so, is to exhaustively write out a list of all possible unique four-digit phasings that are consistent with each person's observed genotype data. We do so by first writing out all possible (mixed resolution) phases, and then expanding each of these to all possible four-digit phases. For example, if one person's observed genotype in the data set of interest was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e027" xlink:type="simple"/></inline-formula>, then we obtain<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e028" xlink:type="simple"/><label>(5)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e029" xlink:type="simple"/><label>(6)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e030" xlink:type="simple"/><label>(7)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e031" xlink:type="simple"/><label>(8)</label></disp-formula></p><p>Expanding Equation 5, for example, we then obtain,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e032" xlink:type="simple"/></disp-formula></p><p>Similarly, we expand each of Equations 6–8 to obtain an additional <italic>J</italic><sup>2</sup>, <italic>J</italic><sup>3</sup>, and <italic>J</italic><sup>4</sup> possible four-digit phasings. The total number of possible four-digit phasings consistent with this person's observed genotype is thus <italic>J</italic> = <italic>J</italic><sup>1</sup>+<italic>J</italic><sup>2</sup>+<italic>J</italic><sup>3</sup>+<italic>J</italic><sup>4</sup>. Alternatively, if our data set of interest contains genotype-ambiguity (in the form of possible pairs of alleles), then we expand the data in all possible ways consistent with those pairs.</p><p>If our desired endpoint is a statistical estimate of phased four-digit data, then we need only compute and renormalize the likelihood of each member of the list (to get the posterior probability of each pair of four-digit haplotypes). However, usually we are interested in a probability distribution over the possible four-digit genotypes. To obtain this distribution, we sum the posterior probabilities of those members of the list that are consistent with each observed genotype. For example, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e033" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e034" xlink:type="simple"/></inline-formula> would give rise to the same observed genotype: (A*3030, A*3002, B*5713, B*0801, Cw*0401, Cw*1502), and so their posterior probabilities would be summed together (along with any other entries in the list which mapped to the same observed genotype) to obtain the posterior probability of that genotype.</p></sec><sec id="s2d"><title>Leveraged Population Models</title><p>Because haplotype patterns are often population (ethnicity)-specific, a natural approach is to use separate models for each population, when the populations are known. For example, if the low-resolution data of interest pertained primarily to individuals of European descent, then one would train a model using data from a European population. Or, if the low-resolution data consisted of both European and Amerindian populations, then one would train a model on European and Amerindian populations separately, and then refine the data of interest using the appropriate model.</p><p>Nonetheless, it is likely that some haplotype patterns are population-specific whereas others are not, or far less so. Consequently, it would be useful to combine data across populations, so that as much data as possible is available for parameter estimation. The challenge of course is how to combine data when appropriate, to maintain population-specific training data when appropriate, and to make good choices automatically. One way to achieve this goal is to augment the feature space (which so far consists of binary encodings of HLA alleles) with population features. We can, for example, include a one-hot encoding of the population labels in our features. Alternatively or in addition, we can add features that correspond to conjunctions of the one-hot encodings of allele and population label. Whereas the first type of augmentation, which we refer to as <italic>simple</italic>, allows us to weight the importance of a haplotype by a linear combination of populations, the second type of augmentation, which we call <italic>conjunctive</italic>, allows us to model specific haplotype–population interactions. In the evaluation section, we shall see that such <italic>leveraged population models</italic> can improve performance. Furthermore, we shall see that the first type of augmentation provides a winning effect over training populations separately and that adding the second type of augmentation leads to no additional improvement in the data set examined.</p><p>The idea of leveraging information across multiple populations is closely related to some of our previous work on epitope prediction in which we show how to leverage information across HLA alleles <xref ref-type="bibr" rid="pcbi.1000016-Heckerman1">[39]</xref>, and is an instance of what is sometimes called multi-task learning <xref ref-type="bibr" rid="pcbi.1000016-Caruana1">[40]</xref>. Xing et al. use a hierarchical Bayesian model to achieve a similar approach when inferring SNP haplotypes <xref ref-type="bibr" rid="pcbi.1000016-Xing1">[22]</xref>.</p></sec><sec id="s2e"><title>Why Require an Independent Training Data Set?</title><p>One could imagine using a mixed-resolution data set of interest (which contains some four-digit HLA types) as its own training data since EM naturally handles incomplete data. If the data that are missing four-digit resolution information are <italic>ignorable</italic>, then such an approach is straightforward <xref ref-type="bibr" rid="pcbi.1000016-Little1">[41]</xref>. By definition, data that are ignorable have the property that the probability that a particular datum is missing (in this case, does not have a four-digit HLA type) is independent of the true, underlying value of the missing datum (in this case, the four-digit HLA type). Of course, if the data are not ignorable, then such a procedure can produce large errors. Unfortunately, missing high-resolution HLA data are not likely to be ignorable, and hence we require an independent data set with no missing data.</p></sec><sec id="s2f"><title>Statistical Significance</title><p>To assess statistical significance of the difference of the performance of two models (e.g., softmax compared to multinomial), either in terms of the number of correct MAP predictions, or, in terms of the test log likelihood, we used a non-parametric, permutation-based, paired test, wherein the null hypothesis is that the average of the pair wise difference in scores is zero.</p><p>Suppose the test set contains <italic>D</italic> individuals, 1,,<italic>D</italic>, and that each model, <italic>m</italic>, assigns a score, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e035" xlink:type="simple"/></inline-formula>, to each individual (where again, this score is either the log probability of the correct assignment, or the number of correct MAP predictions). Then to compare two models, <italic>m</italic><sub>1</sub> and <italic>m</italic><sub>2</sub>, we do the following:</p><list list-type="bullet"><list-item><p>Compute the average difference between paired scores, in each algorithm, <disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e036" xlink:type="simple"/></disp-formula>.</p></list-item><list-item><p>For permutation, <italic>k</italic> = 1,,<italic>K</italic> (we use <italic>K</italic> = 10,000), permute the data in a pair wise fashion to obtain data from the null distribution, and then compute the average difference between paired scores in this permuted data. That is, for each permutation, k,</p></list-item><list-item><list list-type="bullet"><list-item><p>For each datum, <italic>d</italic>, swap the value of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e037" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e038" xlink:type="simple"/></inline-formula> with probability one half. Call the resulting permuted data vectors, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e039" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e040" xlink:type="simple"/></inline-formula>, which are the permuted equivalents of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e041" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e042" xlink:type="simple"/></inline-formula>.</p></list-item><list-item><p>Compute the average difference between paired, permuted scores,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e043" xlink:type="simple"/></disp-formula>.</p></list-item></list></list-item><list-item><p>Then the two-sided p-value for method <italic>m</italic><sub>1</sub> being statistically different from <italic>m</italic><sub>2</sub> is given by the proportion of times that the average difference observed on permutated data matched, or exceeded that observed on the real data. Formally,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e044" xlink:type="simple"/></disp-formula></p></list-item><list-item><p>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e045" xlink:type="simple"/></inline-formula> denotes the size of the set <italic>x</italic>, and abs(<italic>x</italic>) denotes the absolute value of <italic>x</italic>. The addition of one to the numerator smoothes the estimate of <italic>p</italic> so as to take into account the number of random permutations performed. Without this smoothing, one could easily achieve results of <italic>p</italic> = 0 by using too few random permutations. This induces a conservative bias (reducing the type I error, and increasing type II error), which diminishes as the number of permutations increases.</p></list-item></list></sec><sec id="s2g"><title>Data Sets</title><p>We used data sets from two main sources, and denote the number of individuals in each by N. The first data set is a collection of private data derived from a large collection of disease cohorts and controls that were all typed in the laboratory of Mary Carrington. This data set comprises data from four populations, across three loci, as summarized in <xref ref-type="table" rid="pcbi-1000016-t001">Table 1</xref>. Note that most of the African data are derived from African-American individuals, with a small proportion from outside the United States (N = 776). The Hispanic and European data are solely US-based, while the Asian data originated in Asia. Because alleles C17, C18 and A74 were almost never fully resolved to four digits in this data set, we left these as two digit designations. All but 0.1% of HLA alleles in the private data set represented <italic>common and well-defined alleles</italic> (as classified in <xref ref-type="bibr" rid="pcbi.1000016-Cano1">[42]</xref>). Because these large data sets comprise numerous smaller data sets (and sub-populations), we tested each data set, at each locus, for deviance from Hardy-Weinberg Proportions (HWP) using the conventional MCMC approximation to the exact test <xref ref-type="bibr" rid="pcbi.1000016-Guo1">[43]</xref>. The number of MCMC samples was chosen to ensure that the estimated p-value was within 0.01 of the true one with 99% confidence. Alleles deviating from HWE at a level p = 0.1 or stronger (lower p-values) were: European HLA-C locus (p = 0.003), African HLA-C (p = 0.0001), Asian HLA-A, -B, C (p = 0, p = 0, p = 0.0004). In all of these cases, except for the Asian HLA-C locus, the deviation was toward homozygosity. EM algorithms for haplotype frequency estimation have been shown to be robust against deviations toward homozygosity, with the explanation that increased homozygosity reduces the amount of missing phase information that the EM algorithm must overcome <xref ref-type="bibr" rid="pcbi.1000016-Fallin1">[25]</xref>. In any case, our experimental results demonstrate that this issue is not of such great concern as to invalidate our approach.</p><table-wrap id="pcbi-1000016-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.t001</object-id><label>Table 1</label><caption><title>Summary of Private Data</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000016-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1">ethnicity</td><td align="left" colspan="1" rowspan="1">N</td><td align="left" colspan="1" rowspan="1"># unique A alleles</td><td align="left" colspan="1" rowspan="1"># unique B alleles</td><td align="left" colspan="1" rowspan="1"># unique C alleles</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">North American European</td><td align="left" colspan="1" rowspan="1">7526</td><td align="left" colspan="1" rowspan="1">81</td><td align="left" colspan="1" rowspan="1">129</td><td align="left" colspan="1" rowspan="1">48</td></tr><tr><td align="left" colspan="1" rowspan="1">North American African</td><td align="left" colspan="1" rowspan="1">3545</td><td align="left" colspan="1" rowspan="1">60</td><td align="left" colspan="1" rowspan="1">106</td><td align="left" colspan="1" rowspan="1">42</td></tr><tr><td align="left" colspan="1" rowspan="1">Asian</td><td align="left" colspan="1" rowspan="1">1318</td><td align="left" colspan="1" rowspan="1">43</td><td align="left" colspan="1" rowspan="1">76</td><td align="left" colspan="1" rowspan="1">30</td></tr><tr><td align="left" colspan="1" rowspan="1">North American Hispanic</td><td align="left" colspan="1" rowspan="1">881</td><td align="left" colspan="1" rowspan="1">47</td><td align="left" colspan="1" rowspan="1">106</td><td align="left" colspan="1" rowspan="1">35</td></tr></tbody></table></alternatives></table-wrap><p>Class I genotyping: Genomic DNA was amplified using locus-specific primers flanking exons 2 and 3. The PCR products were blotted on nylon membranes and hybridized with a panel of sequence-specific oligonucleotide (SS0) probes (see <ext-link ext-link-type="uri" xlink:href="http://www.ihwg.org/protocols/protocol.htm" xlink:type="simple">http://www.ihwg.org/protocols/protocol.htm</ext-link>). Alleles were assigned by the reaction patterns of the SSO probes. Ambiguous SSOP typing results were resolved by sequencing analysis. Only exons 2 and 3 were examined during HLA typing. Any subtypes determined by sequences outside these exons were not distinguished. In these cases the earliest recognized alleles were assigned, normally the ones of the smallest digit in their names (e.g., B*5801 instead of B*5811).</p><p>The second data set was taken from the publically available dbMHC database (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/mhc/" xlink:type="simple">http://www.ncbi.nlm.nih.gov/mhc/</ext-link>), which we used to test our population-augmented model <xref ref-type="bibr" rid="pcbi.1000016-Cao2">[44]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Cao3">[45]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Cao4">[46]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Cao5">[47]</xref>,<xref ref-type="bibr" rid="pcbi.1000016-Cao6">[48]</xref>, and also for use of our model on four-loci data <xref ref-type="bibr" rid="pcbi.1000016-Williams1">[49]</xref>. These data are summarized in <xref ref-type="table" rid="pcbi-1000016-t002">Table 2</xref>.</p><table-wrap id="pcbi-1000016-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.t002</object-id><label>Table 2</label><caption><title>Summary of dbMHC Data</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000016-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1">ethnicity</td><td align="left" colspan="1" rowspan="1">N</td><td align="left" colspan="1" rowspan="1"># unique A alleles</td><td align="left" colspan="1" rowspan="1"># unique B alleles</td><td align="left" colspan="1" rowspan="1"># unique C alleles</td><td align="left" colspan="1" rowspan="1"># unique DRB1 alleles</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">Irish</td><td align="left" colspan="1" rowspan="1">1000</td><td align="left" colspan="1" rowspan="1">26</td><td align="left" colspan="1" rowspan="1">49</td><td align="left" colspan="1" rowspan="1">23</td><td align="left" colspan="1" rowspan="1">33</td></tr><tr><td align="left" colspan="1" rowspan="1">North American Asian</td><td align="left" colspan="1" rowspan="1">393</td><td align="left" colspan="1" rowspan="1">34</td><td align="left" colspan="1" rowspan="1">66</td><td align="left" colspan="1" rowspan="1">24</td><td align="left" colspan="1" rowspan="1">NA</td></tr><tr><td align="left" colspan="1" rowspan="1">North American European</td><td align="left" colspan="1" rowspan="1">287</td><td align="left" colspan="1" rowspan="1">28</td><td align="left" colspan="1" rowspan="1">48</td><td align="left" colspan="1" rowspan="1">21</td><td align="left" colspan="1" rowspan="1">NA</td></tr><tr><td align="left" colspan="1" rowspan="1">North American Black</td><td align="left" colspan="1" rowspan="1">251</td><td align="left" colspan="1" rowspan="1">28</td><td align="left" colspan="1" rowspan="1">49</td><td align="left" colspan="1" rowspan="1">23</td><td align="left" colspan="1" rowspan="1">NA</td></tr><tr><td align="left" colspan="1" rowspan="1">North American Hispanic</td><td align="left" colspan="1" rowspan="1">240</td><td align="left" colspan="1" rowspan="1">35</td><td align="left" colspan="1" rowspan="1">62</td><td align="left" colspan="1" rowspan="1">25</td><td align="left" colspan="1" rowspan="1">NA</td></tr><tr><td align="left" colspan="1" rowspan="1">North American Amerindian</td><td align="left" colspan="1" rowspan="1">229</td><td align="left" colspan="1" rowspan="1">27</td><td align="left" colspan="1" rowspan="1">55</td><td align="left" colspan="1" rowspan="1">22</td><td align="left" colspan="1" rowspan="1">NA</td></tr><tr><td align="left" colspan="1" rowspan="1">All except Irish</td><td align="left" colspan="1" rowspan="1">1400</td><td align="left" colspan="1" rowspan="1">48</td><td align="left" colspan="1" rowspan="1">102</td><td align="left" colspan="1" rowspan="1">31</td><td align="left" colspan="1" rowspan="1">NA</td></tr></tbody></table></alternatives></table-wrap></sec></sec><sec id="s3"><title>Results</title><p>In order to evaluate our model, and also to compare how it performs to a multinomial-based model, we use data sets consisting of four-digit resolution HLA data from individuals. Then we synthetically mask the known four-digit allele designation for some loci and some individuals, at random. In this way, ground truth is available for quantitative assessment. Specifically, we use the following set-up:</p><list list-type="order"><list-item><p>Start with a four-digit HLA resolution data set, <italic>D</italic>.</p></list-item><list-item><p>Randomly partition <italic>D</italic> into 80% for training (<italic>D</italic><sub>train</sub>) and 20% for testing (<italic>D</italic><sub>test</sub>).</p></list-item><list-item><p>To learn good settings of the regularization parameters, randomly partition <italic>D</italic><sub>train</sub> into 80% for a regularization training set (<italic>S</italic><sub>train</sub>) and 20% for a regularization hold out set (<italic>S</italic><sub>hold</sub>). Train a model on <italic>S</italic><sub>train</sub>, for each value of the regularization parameters, and then test its performance on <italic>S</italic><sub>hold</sub>. Select the regularization parameters which perform best.</p></list-item><list-item><p>Using the best regularization parameters, train the model on <italic>D</italic><sub>train</sub>, and then test its performance on <italic>D</italic><sub>test</sub>).</p></list-item></list><p>To test the performance as mentioned above, we randomly mask 30% of the four-digit HLA types (on an individual and independent allele basis) in the test/hold-out set. That is, we truncate the last two digits of their four-digit designation. We then use our HLA refinement to obtain a probability distribution for all four-digit HLA types which are consistent with the masked values. Then we assess the prediction in two ways. One, we take the four-digit type with the highest probability as the single, best answer, and then count how many of these are correct. We refer to this criterion as the <italic>percentage of correct MAP predictions</italic>. Two, we compute the log probability of the correct four-digit resolution HLA type under our predictive distribution. We refer to this as the <italic>test log likelihood.</italic> If we divide this quantity by the number of masked alleles and then exponentiate, we obtain the geometric mean probability of the correct four-digit allele under our learned model (which is more intuitive than the test log likelihood). We refer to this criterion as the <italic>geometric mean probability.</italic> The first criterion (% correct MAP) is intuitive but informal and coarse. It allows us to easily get a handle on the performance, but throws away valuable information concerning the probabilities generated by the model which may be useful in downstream analyses of the data. In our experiments, we report performance according to both types of criteria. Note that these values should be compared only within a given test set.</p><p>Although we mask the HLA types at random, this is likely not the same process that is responsible for the true, observed, experimental process that results in masking. Nonetheless, we feel that it is a reasonable proxy, because it focuses on how well haplotype patterns have been learned, how strong these patterns are, and how much they can be used to refine HLA data, which is the question of interest. Additionally, we measure performance under a 100% masking, and also a locus-by-locus masking, for broader testing of the performance of our model.</p><p>In addition to experimenting with our softmax-based model, and the multinomial (with and without regularization), we also compare performance to a baseline model of allele marginals. In this baseline model, the probability over four-digit HLA types is proportional to the frequency of that allele in the training set, regardless of the HLA data at other loci. This model, by construction, cannot capture haplotype structure. As we shall see, this model does not perform well.</p><p>For the softmax-based model, we first learned the best value for <italic>λ</italic><sub>1</sub> (i.e., for the first locus) since it is independent of the others. Then, fixing the value of <italic>λ</italic><sub>1</sub> at its best value, we set all other <italic>λ<sub>i</sub></italic> = 0.1. For each of the other loci, <italic>i</italic>, one at a time, we next found the best value of <italic>λ<sub>i</sub></italic> conditioned on the fixed values of the other regularization parameters. We iterated through the loci in this manner until no changes were made. In our experiments, this process reached convergence after only two or three cycles through the loci, indicating that, in practice, the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e052" xlink:type="simple"/></inline-formula> are largely independent of one another. We optimized a single parameter by searching a grid of possible values. The grid used in our softmax-based model experiments was 50;10;5;1;0.5;0.1;0.05;0.01;0.001. For the multinomial-based model, we used the grid 1;5;10;50;100;500;1000;5000;10,000;50,000 for the equivalent sample size of the Dirichlet distributions.</p><p>Lastly, to determine if there is a statistically significant difference between our methods (in terms of either test log likelihood, or number of correct MAP predictions), we use a permutation-based, non-parametric, paired test in which the null hypothesis is that the average of the pair wise difference in scores is zero. Because 10,000 permutations were used, the smallest p-value that could be obtained was <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e046" xlink:type="simple"/></inline-formula>.</p><sec id="s3a"><title>EM Sensitivity to Initialization</title><p>Because the objective function we use, the penalized likelihood, is not convex, our parameter estimation and hence HLA refinement can be sensitive to the initial parameter setting. (Note that by parameters, we mean <italic>w<sup>j</sup></italic>, <italic>v<sup>j</sup></italic>, and <italic>q<sup>j</sup></italic> within the multi-logit functions, and not the regularization parameters, <italic>λ<sub>i</sub></italic>, nor the phasings, <italic>h<sub>i</sub></italic>.) To assess the sensitivity of performance to the initial parameters, we initialized the parameters randomly between 0 and 1 five different times. We performed this assessment on our Hispanic-labeled private data because this set corresponds to one of the smaller ethnicity-specific data sets, and because this ethnic label is less well defined than others. Both factors (small data sets, and ethnicities that are not well-defined) tend to produce greater sensitivity to parameter initialization.</p><p>When training our softmax-based model, the geometric mean probability across the five initializations was aways 0.5255. (A larger geometric mean probability is better.) In all five runs, 262 of the 306 masked alleles were correctly predicted, indicating little sensitivity to parameter initialization. Similarly, for the regularized multinomial-based model, the geometric mean probabilities across the five initializations was always 0.4180. In all five runs, 262 of the 306 masked alleles were correctly predicted, again indicating little sensitivity. For the unregularized multinomial-based model, the geometric mean probabilities across the five initializations were: 0.0077, 0.0117, 0.0126, 0.0092, and 0.0105. Of the 306 masked alleles, 260, 265, 260, 266, and 262 were correctly predicted across the five runs, indicating a far greater sensitivity to initial parameters.</p><p>The geometric mean probability was best for the softmax-based model, followed by the regularized multinomial, followed by the unregularized multinomial model (which does poorly due to its inability to make stable estimates for the huge number of parameters it requires). This is a pattern we shall see throughout our experiments.</p><p>The sensitivity we see here will allow us to gauge how important observed differences are in the remainder of the experiments, where we always initialize the parameters to be all zero. Of course, when deploying this method in a real setting, it would be wise to try several parameter initializations, and then to choose the one that yields the highest likelihoods on hold-out data. Also note that, for the unregularized multinomial model, we regularize it with an equivalent sample size of 1×10<sup>−16</sup> so that negative infinities do not appear when haplotypes not seen in the training sample appear in the test set.</p></sec><sec id="s3b"><title>Large Scale Data Set Comparison</title><p>Next we used our large, private data set to measure the refinement performance of the various models we have discussed. We trained and tested within each ethnic population separately. The results are summarized in <xref ref-type="fig" rid="pcbi-1000016-g001">Figure 1</xref>.</p><fig id="pcbi-1000016-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.g001</object-id><label>Figure 1</label><caption><title>Results on private data, separately for each ethnicity.</title><p>Each set of grouped bars represents the four different modeling approaches. From darkest to lightest: softmax, regularized multinomial, unregularized multinomial, allele marginal. The number of masked alleles, respectively, in the European, African, Asian, and Hispanic data sets was 2669, 1287, 477, and 306, respectively.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.g001" xlink:type="simple"/></fig><p>The softmax model has the best performance overall and can correctly resolve a substantial number of ambiguous alleles. In terms of both criteria, the softmax model is significantly better than the other methods (see <xref ref-type="table" rid="pcbi-1000016-t003">Table 3</xref> for p-values). The allele marginal model consistently has the worst performance in terms of number of correct MAP predictions, presumably because it does not make use of linkage disequilibrium. In contrast, it significantly outperforms the unregularized multinomial model in test log likelihood (<italic>p</italic> = 1×10<sup>−4</sup>), because the allele marginals are naturally regularized due to the small number of parameters.</p><table-wrap id="pcbi-1000016-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.t003</object-id><label>Table 3</label><caption><title>Statistical Significance Results on Private Data, Separately for Each Ethnicity.</title></caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000016-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.t003" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup><thead><tr><td align="left" colspan="1" rowspan="1">Method 1</td><td align="left" colspan="1" rowspan="1">Method 2</td><td align="left" colspan="1" rowspan="1">log likelihood p-value</td><td align="left" colspan="1" rowspan="1"># correct MAP p-value</td></tr></thead><tbody><tr><td align="left" colspan="1" rowspan="1">softmax<xref ref-type="table-fn" rid="nt101">*</xref></td><td align="left" colspan="1" rowspan="1">regularized mult.</td><td align="left" colspan="1" rowspan="1">p = 10<sup>−4</sup></td><td align="left" colspan="1" rowspan="1">p = 2.8×10<sup>−3</sup></td></tr><tr><td align="left" colspan="1" rowspan="1">softmax<xref ref-type="table-fn" rid="nt101">*</xref></td><td align="left" colspan="1" rowspan="1">non-reg. mult.</td><td align="left" colspan="1" rowspan="1">p = 10<sup>−4</sup></td><td align="left" colspan="1" rowspan="1">p = 8×10<sup>−4</sup></td></tr><tr><td align="left" colspan="1" rowspan="1">softmax<xref ref-type="table-fn" rid="nt101">*</xref></td><td align="left" colspan="1" rowspan="1">allele marginals</td><td align="left" colspan="1" rowspan="1">p = 10<sup>−4</sup></td><td align="left" colspan="1" rowspan="1">p = 10<sup>−4</sup></td></tr><tr><td align="left" colspan="1" rowspan="1">regularized mult.<xref ref-type="table-fn" rid="nt101">*</xref></td><td align="left" colspan="1" rowspan="1">non-reg. mult.</td><td align="left" colspan="1" rowspan="1">p = 10<sup>−4</sup></td><td align="left" colspan="1" rowspan="1">p = 0.51</td></tr><tr><td align="left" colspan="1" rowspan="1">non-reg. mult.<xref ref-type="table-fn" rid="nt101">*</xref></td><td align="left" colspan="1" rowspan="1">allele marginals<xref ref-type="table-fn" rid="nt101">*</xref></td><td align="left" colspan="1" rowspan="1">p = 10<sup>−4</sup></td><td align="left" colspan="1" rowspan="1">p = 10<sup>−4</sup></td></tr></tbody></table></alternatives><table-wrap-foot><fn id="nt101"><label>*</label><p>Denotes the method that performed better (except for the last row, where the allele marginals perform better than the unregularized multinomial on the log likelihood, but worse on the number of correct MAP predictions.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3c"><title>When Training and Test Set Are Not Identically Distributed</title><p>In realistic settings where our algorithm will be deployed, it is likely that the data set of interest is not drawn from exactly the same distribution as the training data. To get a sense of how robust our approach is to deviations from this idealized setting, we have performed several experiments more closely mimicking a realistic setting. In particular, we evaluated our refinement accuracy when the training and test distributions were drawn from different populations.</p><p>First, we split the dbMHC Irish data set (HLA-A, HLA-B, HLA-C alleles) into 80% training data and 20% test and masked 30% of the test alleles to two digits. Then we trained a model using the training data, and tested on the test data. Next, we used the model we had previously trained on the ‘private North American European’ data, and used this model to predict the same masked, Irish alleles. Of the 200 people in the Irish test set, there was one person who contained one allele never observed in the European data (B*2409, which is actually a null allele, B*2409N, for which the typing of the private data was not capable of finding). After removal of this person, we then compared the performance when using the dbMHC Irish data set itself for traning, as compared to using our much broader private European data set for training. The resulting test geometric mean probabilities of the test set were 0.8851 when training with the dbMHC Irish, and 0.8891 with the private European. This difference was not significant (p = 0.44).</p><p>Next, we used the model trained on the private Asian data to predict a 30% masking of 279 dbMHC Canton Chinese individuals <xref ref-type="bibr" rid="pcbi.1000016-Trachtenberg1">[50]</xref> with HLA-A,-B, -C data (we randomly chose this population among the Asian dbMHC populations available). Nine of these individuals had alleles not appearing in the training data (A*0210, B*1505, B*1803, B*3508, B*3520, B*4010, B*5801, B*7802), and after their removal, we achieved a prediction accuracy of 441/487 = 91%, roughly equal to the 90% achieved when testing on the private</p><p>Asian data set itself. Because this dbMHC data set was not large enough to partition into a training and test set, we were not able to measure accuracy achieved when training on itself. This is true for the next three dbMHC data sets as well, in which we perform similar experimentation.</p><p>Next we used a model trained on the private North American African data set, to predict masked alleles in 251 dbMHC African American individuals, of which five individuals contained alleles not matching the training data (A*6804, B*1502, B*1515, B*5802). After removal of these individuals, 321/373 = 86% of masked alleles were correctly predicted, which is lower than the 90% accuracy achieved when testing on the private North American African data itself. Results were comparable when we first removed individuals from Africa from the training data (leaving only US-based individuals of Africans descent).</p><p>Next, we used a model trained on the private North American European data set (containig 776 individuals), to predict masked alleles in 287 dbMHC North American European individuals, of which three individuals contained alleles not matching the training data (B*1802, B*4408, B*5202). After removal of these individuals, 478/510 = 94% of masked alleles were correctly predicted, roughly equal to the 95% accuracy achieved when testing on the private North American European data set itself.</p><p>Finally, we used a model trained on the private North American Hispanic data set, to predict masked alleles in 240 dbMHC North American Hispanic individuals, of which 13 individuals contained alleles not matching the training data (A*0212, A*0213, A*2422, A*2608, A*3401, A*6805, B*5105, B*3509, B*4406). After removal of these individuals, 344/400 = 86% of masked alleles were correctly predicted, comparable to accuracy achieved when testing on the private North American Hispanic data set itself.</p><p>Based on this small set of experiments, we believe it may often be feasible to use our broadly defined ethnic categories for resolving ambiguity in other, independently created data sets falling in to the same broad category, or falling into a much more specific sub-category. Of course, this may not generally be true, and in particular, it may be less true for African-derived data. Additionally, a user of a trained model might have access to some high-resolution data for their population of interest, and could thus see how well the trained model works for the subset of their data (by synthetically masking it) before using the model to resolve ambiguity in their low-resolution data.</p><p>Note that there are two statistical <italic>desiderata</italic> when using our method: 1) to use a training data set which mostly closely mimicks the HLA haplotype distribution of the data set of interest, and 2) to get as many training data as possible. Critically, these two desiderata are frequently odds with one another. That is, often a data set of interest is sub-population specific and therefore difficult to obtain high resolution data for in large quanitities. However, by loosening the strictness of the match between training and test populatations, one can often significantly increase the amount of data available. Without more data and experimentation, it is diffult to assess the optimal trade-off between these desiderata. However, as we see, using broad, even presumably admixed training data, can lead to useful results.</p></sec><sec id="s3d"><title>Sensitivity to Training Data Set Size</title><p>To determine whether the availability of more training data may lead to improved refinements, we examined the sensitivity of performance to the size of the training set. For the European and the African private data sets, we iteratively halved the sample size of training data, where the largest available training data set sizes were, respectively, 6020 and 2836. The results shown in <xref ref-type="fig" rid="pcbi-1000016-g002">Figure 2</xref> suggest that more training data would improve the performance on the African data set, and to a smaller extent, on the European data set. Note that the African data set is smaller to start with than the European one, and also known to be more genetically diverse; both are explanations for the observed trends.</p><fig id="pcbi-1000016-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.g002</object-id><label>Figure 2</label><caption><title>Sensitivity to training data set size for the European and African data sets.</title><p>Top row shows the geometric mean probabilities; the bottom row shows the percentage of correct MAP predictions.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.g002" xlink:type="simple"/></fig></sec><sec id="s3e"><title>Leveraged Population Models</title><p>To determine whether leveraging information across populations is useful, we compared our leveraged population models to those built separately on each population. We did so on data from dbMHC, which contains a diverse set of populations. (We excluded the Irish population because this population is extremely homogeneous relative to the others.) Recall that we introduced two types of leveraging features: simple and conjunctive. We used our softmax model both with the simple features alone, and with both the simple and the conjunctive features, as shown in <xref ref-type="fig" rid="pcbi-1000016-g003">Figure 3</xref>.</p><fig id="pcbi-1000016-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.g003</object-id><label>Figure 3</label><caption><title>Results for population-augmented model.</title><p>Abbreviations are: SSC = softmax+simple+conjunctive, SS = softmax+simple, S = simple, RM = regularized multinomial, M = non-regularized multinomial, AM = allele marginals, S = separate. The number of masked alleles in the test set was 514. For all methods, except ‘separate’, a single model was trained on data from all ethnicities.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.g003" xlink:type="simple"/></fig><p>The performance of the population-augmented models are significantly better than the softmax model on test log likelihood (e.g., <italic>p</italic> = 0.02 when comparing softmax+simple to softmax). Although ethnicity labels are notoriously unreliable, they clearly provide beneficial information here. Also, the addition of conjunctive features lends to no apparent improvement.</p></sec><sec id="s3f"><title>Sensitivity to Variable Ordering</title><p>Because we use softmax regression functions in our haplotype model, the order in which we apply the chain rule (Equation 2) to our loci will have an effect on predictive accuracy. We examined the sensitivity of performance to variable ordering on three loci (A,B,C) using the European and Hispanic data sets. The results are shown in <xref ref-type="fig" rid="pcbi-1000016-g004">Figure 4</xref> in which a locus order of ‘B A C’ means we used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e053" xlink:type="simple"/></inline-formula>. The experiments labeled ‘30% mask' denote the performance using the 30% random masking procedure we used in our earlier experiments. Additionally, we systematically masked all (and only) A alleles (‘A mask’), and separately, all and only B alleles (‘B mask’), and all and only C alleles (‘C mask’). This procedure allows us to see if the variable ordering differentially affects our ability to predict particular loci. Statistical significance was measured only on the difference in test log likelihoods.</p><fig id="pcbi-1000016-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.g004</object-id><label>Figure 4</label><caption><title>Sensitivity to Variable Ordering.</title><p>Top two rows are for the Hispanic data set; bottom two rows are for the European data set. Within each of these, the top row is the geometric mean probabilities, and the bottom row shows the percent correct MAP predictions. The number of masked alleles, respectively, in the Hispanic 30% and loci masks (A,B,C), was 306 and 354. The number of masked alleles, respectively, in the European 30% and loci masks (A,B,C), was 2669 and 3012.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.g004" xlink:type="simple"/></fig><p>For the ‘30% mask’ experiments, no statistically significant (<italic>p</italic>⩽0.01) differences were found between variable orderings (and hence the results of our previous experiments should not have been effected by this issue). For the locus-specific maskings in the European data set, only the B alleles showed significant differences (order 1 vs. 4, p = 0.0002; 1 vs. 6, p = 0.001; 2 vs. 4, p = 0.003; 2 vs. 6, p = 0.004; 3 vs. 4, p = 0.0006; 4 vs. 5, p = 0.006). For the locus-specific maskings in the Hispanic data set, the A alleles showed some significant differences (order 1 vs. 2, p = 0.004; 1 vs. 5, p = 0.001; 3 vs. 5, p = 0.004), the B alleles did not show any, and the C alleles showed one (order 4 vs. 5, p = 0.003).</p><p>Note that it is possible to use a parsimonious model which is not dependent upon variable ordering (a so-called ‘undirected’ model <xref ref-type="bibr" rid="pcbi.1000016-Lauritzen1">[51]</xref> in the parlance of the graphical models community). In particular, one can form pair-wise ‘compatibility’ functions between all pairs of HLA loci so that<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e047" xlink:type="simple"/></disp-formula>where the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e048" xlink:type="simple"/></inline-formula> are scalar parameters of the model and where the sum in the denominator is a normalizing constant and sums over all possible haplotypes, (<italic>l<sub>i</sub></italic>,<italic>l<sub>j</sub></italic>,<italic>l<sub>k</sub></italic>,). However, brief experimentation of this model applied to the current problem did not indicate increased performance relative to our softmax-based model.</p></sec><sec id="s3g"><title>Locus-Specific Predictive Accuracy</title><p>In some domains, the ability to predict certain loci is of greater importance than others. For example, in HIV research, the ability to predict B alleles is often paramount (e.g., <xref ref-type="bibr" rid="pcbi.1000016-Gao1">[15]</xref>). We measured locus-specific prediction accuracy for each locus by applying locus-by-locus masking to all four populations in the private data. <xref ref-type="fig" rid="pcbi-1000016-g005">Figure 5</xref> shows the results, which do not indicate any particular pattern. Note that the number of possible alleles at each locus has a direct effect on our ability to predict (as does the linkage between one locus and the others), and so we might expect, <italic>a priori</italic>, for the B alleles to be more difficult to predict, although this does not appear to be the case.</p><fig id="pcbi-1000016-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.g005</object-id><label>Figure 5</label><caption><title>Locus-Specific Predictive Accuracy.</title><p>Each set of grouped bars, from darkest to lightest, represents, respectively, A-masking, B-masking, and C-masking. The number of masked alleles in each masking was 3012, 1418, 528, and 354, respectively, for the European, African, Asian, and Hispanic test sets.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.g005" xlink:type="simple"/></fig></sec><sec id="s3h"><title>Low Resolution Prediction</title><p>Finally, in some instances, only low-resolution data (i.e., two-digit resolution) is available. Consequently, we investigated the prediction accuracy of our algorithm in this situation—that is, when 100% of the alleles were masked to two-digit. The results for the private African, Asian, and Hispanic data sets are shown in <xref ref-type="fig" rid="pcbi-1000016-g006">Figure 6</xref>. Because of the large number of allele combinations in the European data set, it was not possible to perform this experiment in a reasonable amount of time using the current sequential implementation of the algorithm. This problem should not be a big concern, however, as the algorithm can be easily parallelized.</p><fig id="pcbi-1000016-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.g006</object-id><label>Figure 6</label><caption><title>Low Resolution Prediction.</title><p>Each set of grouped bars represents, from darkest to lightest, respectively, 100% mask with softmax model, 100% mask with allele marginals model, 30% mask with softmax model, 30% mask with allele marginals model. The number of masked alleles for the 100% mask was 4254, 1429, and 1062, and for the 30% mask, 1287, 477, and 306, in the African, Asian, and Hispanic test sets, respectively.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.g006" xlink:type="simple"/></fig><p>In order to gauge how much haplotype information is being used in this context, we compare the results to those from the allele marginal model. In all cases, the softmax model performs significantly better than the allele marginal model (<italic>p</italic> = 1×10<sup>−4</sup> for all three population comparisons on the test log likelihood). Thus, a large amount of haplotype information is being used by our model in this 100% masking context, and prediction of four-digits from strictly two-digit data is feasible. For comparison, <xref ref-type="fig" rid="pcbi-1000016-g006">Figure 6</xref> includes the results presented earlier from the 30% masking experiments. To make the test log likelihoods comparable, we have normalized them by the number of alleles in the test set. Interestingly, the performance is comparable across the different maskings according to both criteria.</p></sec><sec id="s3i"><title>Four-Loci Example/Class I and Class II</title><p>We compared our methods on data with four loci, spanning the HLA-A, -B, -C and -DRB1 loci. The four-loci data available to us, with the largest sample size, was the Irish set in dbMHC. As shown in <xref ref-type="fig" rid="pcbi-1000016-g007">Figure 7</xref>, we see that the relative performance of the methods is roughly the same as in earlier experiments. Given that LD may not be as strong between class I and class II alleles, it is of interest to determine how well each locus can be predicted. Thus we used a locus-specific masking, as described earlier. The accuracy at each of the HLA-A, -B, -C and -DRB1 alleles was respectively 97%, 98%,99%, and 80%. This indicates that there is not sufficient linkage between the HLA-A, -B, -C loci and the HLA -DRB1 locus to accurately resolve ambiguity at the DRB1 locus. However, it may be the case that with additional class II loci, refinement of class II data would be feasible.</p><fig id="pcbi-1000016-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000016.g007</object-id><label>Figure 7</label><caption><title>Four-loci, dbMHC Irish data.</title><p>Abbreviations are: S = softmax, RM = regularized multinomial, M = non-regularized multinomial, AM = allele marginals. A total of 468 alleles were masked in the test set.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.g007" xlink:type="simple"/></fig></sec></sec><sec id="s4"><title>Discussion</title><p>We have introduced a method for statistical refinement of low or intermediate resolution HLA data, when a full resolution training data set from a similar population is available. In doing so, we have also improved upon the EM-based approach to haplotype estimation by using a more parsimonious parameterization of the haplotype distribution. Experimentally, we show both that it is feasible to use statistical approaches for HLA refinement, and also that our method outperforms the standard multinomial-based models used throughout the HLA community for haplotype estimation. Our HLA refinement method helps to mitigate the limiting factor of cost in HLA typing today, and allows for lower/intermediate resolution, or historical data to be statistically refined when it cannot be refined by assay. A tool based on our approach is available for research purposes at <ext-link ext-link-type="uri" xlink:href="http://microsoft.com/science" xlink:type="simple">http://microsoft.com/science</ext-link>.</p><p>Although there is widespread caution about the use of assigned, or self-defined ethnicity labels <xref ref-type="bibr" rid="pcbi.1000016-Ellison1">[52]</xref>, we show that the labels associated with dbMHC data carry useful information. Furthermore, we show that by augmenting our softmax-based HLA model, we can make use of these labels to increase the amount of data available while automatically using it in a population-appropriate manner. Future work of interest would be to model the data in yet another way: using a <italic>mixture of haplotype models</italic>, in which each component of the mixture represents one well-defined population (either as defined in the training data, or as uncovered in an unsupervised manner). Then, when data contain multiple populations without ethnicity labels or when labeled populations contain mixtures of latent (unknown) subpopulations, one can use these mixture models to uncover population structure and appropriate weightings of the different populations for individuals in a data set of interest.</p><p>Because our modeling approach assumes that the training and testing populations are drawn from the same distribution, one should take care when trying to use this approach for case-control studies where case and controls are thought to be drawn from different distributions. One may also be wary of using this approach in the domain of transplantation, for similar reasons (patients requiring transplants likely make up a specific sub-population). However, since HLA ambiguity resolution is applied in the area of transplants to potential donors in a registry, rather than the patients themselves (who are routinely typed at high resolution), application in this domain should not be problematic.</p><p>As with the traditional algorithm used in the HLA community, our EM algorithm assumes HWE. One could make a small change to our model which would allow us to circumvent making such an assumption. In the models discussed so far, the probability of data in a particular phasing is defined as follows. If a haplotype, <italic>h</italic>, is specified by partitioning the genoytpes, <italic>g<sub>A</sub></italic><sub>1</sub>,<italic>g<sub>B</sub></italic><sub>1,</sub><italic>g<sub>C</sub></italic><sub>1,</sub><italic>g<sub>A</sub></italic><sub>2</sub>,<italic>g<sub>B</sub></italic><sub>2,</sub><italic>g<sub>C</sub></italic><sub>2</sub> into two sets: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e049" xlink:type="simple"/></inline-formula>, then the probability of the data given this phasing is defined as the product of the probability of each haplotype:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e050" xlink:type="simple"/><label>(9)</label></disp-formula>where each of the probabilities <italic>p</italic>(<italic>g<sub>A</sub></italic><sub>1</sub>,<italic>g<sub>B</sub></italic><sub>1</sub>,<italic>g<sub>C</sub></italic><sub>1</sub>) and <italic>p</italic>(<italic>g<sub>A</sub></italic><sub>2</sub>,<italic>g<sub>B</sub></italic><sub>2</sub>,<italic>g<sub>C</sub></italic><sub>2</sub>) are specified by a <italic>haplotype model</italic> (e.g., softmax or multinomial). To circumvent the assumption of HWE, one could instead define a model which does not factor this probability into two independent terms:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000016.e051" xlink:type="simple"/><label>(10)</label></disp-formula>where now we would not have a haplotype-based model, but instead a more generic, <italic>ordered-genotype</italic> model, which could itself be given a softmax-based parsimonious parameterization. The downside of such an approach is that we essentially halve the amount of available data, because we no longer have two independent data samples from each individual, and hence far more data would be required to effectively make use of such a model.</p><p>Future work in probabilistic HLA refinement may involve comparing EM-based approaches to full Bayesian approaches. Also, an interesting, though perhaps computationally difficult avenue to pursue would be the use of HLA DNA sequences to better model rare haplotypes, or the use of SNP data to directly predict HLA types.</p></sec></body><back><ack><p>We wish to acknowledge the following cohorts and investigators from whom samples used in this study (for HLA typing) were derived: the International HIV Controllers Study, the Multicenter AIDS Cohort Study, the Multicenter Hemophilia Cohort Study, the Washington and New York Men's Cohort Study, the San Francisco City Clinic Cohort, the AIDS Linked to Intravenous Experience, the Swiss HIV Cohort, the Urban Health Study, the NIH Focal Segmental Glomerulosclerosis Genetic Study, Hepatitis C Antiviral Long-term Treatment against Cirrhosis, National Cancer Institute Surveillance Epidemiology and End Results Non-Hodgkin Lymphoma Case-Control Study, Woman Interagency Health Study, Classic Kaposi Sarcoma Case-Control Study I and II, Genetic Modifiers Study, Nairobi CTL Cohort, Grace John-Stewart, Stephen O'Brien, and Thomas O'Brien. We thank John Hansen for useful discussion, David Ross for code which contributed to the softmax regression, Mark Schmidt for use of his L1 code, Giuseppe Cardillo for his publically available implementation of <xref ref-type="bibr" rid="pcbi.1000016-Guo1">[43]</xref>, and Fuh-Mei Duh for compiling the HLA data sets.</p></ack><ref-list><title>References</title><ref id="pcbi.1000016-Hertz1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hertz</surname><given-names>T</given-names></name><name name-style="western"><surname>Yanover</surname><given-names>C</given-names></name></person-group>             <year>2007</year>             <article-title>Identifying HLA supertypes by learning distance functions.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>e148</fpage>             <lpage>e155</lpage>          </element-citation></ref><ref id="pcbi.1000016-Hurley1"><label>2</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hurley</surname><given-names>CK</given-names></name></person-group>             <year>2005</year>             <article-title>Cord Blood: Establishing a National Hematopoietic Stem Cell Bank Program. National Academies Press</article-title>             <fpage>242</fpage>             <lpage>272</lpage>          </element-citation></ref><ref id="pcbi.1000016-Thorsby1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thorsby</surname><given-names>E</given-names></name><name name-style="western"><surname>Lie</surname><given-names>BA</given-names></name></person-group>             <year>2005</year>             <article-title>HLA associated genetic predisposition to autoimmune diseases: Genes involved and possible mechanisms.</article-title>             <source>Transpl Immunol</source>             <volume>14</volume>             <fpage>175</fpage>             <lpage>82</lpage>          </element-citation></ref><ref id="pcbi.1000016-Carrington1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Carrington</surname><given-names>M</given-names></name><name name-style="western"><surname>O'Brien</surname><given-names>S</given-names></name></person-group>             <year>2003</year>             <article-title>The influence of HLA genotype on AIDS.</article-title>             <source>Annu Rev Med</source>             <volume>54</volume>             <fpage>535</fpage>             <lpage>551</lpage>          </element-citation></ref><ref id="pcbi.1000016-Yee1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yee</surname><given-names>L</given-names></name></person-group>             <year>2004</year>             <article-title>Host genetic determinants in hepatitis C virus infection.</article-title>             <source>Genes Immun</source>             <volume>5</volume>             <fpage>237</fpage>             <lpage>245</lpage>          </element-citation></ref><ref id="pcbi.1000016-Bhattacharya1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bhattacharya</surname><given-names>T</given-names></name><name name-style="western"><surname>Daniels</surname><given-names>M</given-names></name><name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name><name name-style="western"><surname>Foley</surname><given-names>B</given-names></name><name name-style="western"><surname>Frahm</surname><given-names>N</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Founder effects in the assessment of HIV polymorphisms and HLA allele associations.</article-title>             <source>Science</source>             <volume>315</volume>             <fpage>1583</fpage>             <lpage>1586</lpage>          </element-citation></ref><ref id="pcbi.1000016-Brumme1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brumme</surname><given-names>Z</given-names></name><name name-style="western"><surname>Brumme</surname><given-names>C</given-names></name><name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name><name name-style="western"><surname>Korber</surname><given-names>B</given-names></name><name name-style="western"><surname>Daniels</surname><given-names>M</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>HLA class-I-associated polymorphisms in HIV-1 identified through a genetic association approach correlate with clinical markers of disease progression.</article-title>             <source>PLoS Pathogens</source>             <volume>3</volume>             <fpage>e94</fpage>          </element-citation></ref><ref id="pcbi.1000016-Timm1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Timm</surname><given-names>J</given-names></name><name name-style="western"><surname>Li</surname><given-names>B</given-names></name><name name-style="western"><surname>Daniels</surname><given-names>MG</given-names></name><name name-style="western"><surname>Bhattacharya</surname><given-names>T</given-names></name><name name-style="western"><surname>Reyor</surname><given-names>L</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Human leukocyte antigen-associated sequence polymorphisms in hepatitis c virus reveal reproducible immune responses and constraints on viral evolution.</article-title>             <source>Hepatology</source>             <volume>46</volume>             <fpage>339</fpage>             <lpage>349</lpage>          </element-citation></ref><ref id="pcbi.1000016-Gaudieri1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gaudieri</surname><given-names>S</given-names></name><name name-style="western"><surname>Rauch</surname><given-names>A</given-names></name><name name-style="western"><surname>Park</surname><given-names>L</given-names></name><name name-style="western"><surname>Freitas</surname><given-names>E</given-names></name><name name-style="western"><surname>Herrmann</surname><given-names>S</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Evidence of viral adaptation to HLA class I-restricted immune pressure in chronic hepatitis C virus infection.</article-title>             <source>J Virol</source>             <volume>80</volume>             <fpage>11094</fpage>             <lpage>11104</lpage>          </element-citation></ref><ref id="pcbi.1000016-Gaudieri2"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gaudieri</surname><given-names>S</given-names></name><name name-style="western"><surname>Rauch</surname><given-names>A</given-names></name><name name-style="western"><surname>Park</surname><given-names>L</given-names></name><name name-style="western"><surname>Freitas</surname><given-names>E</given-names></name><name name-style="western"><surname>Herrmann</surname><given-names>S</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Erratum: Evidence of viral adaptation to HLA class I-restricted immune pressure in chronic hepatitis C virus infection.</article-title>             <source>J Virol</source>             <volume>81</volume>             <fpage>8846</fpage>             <lpage>8848</lpage>          </element-citation></ref><ref id="pcbi.1000016-Listgarten1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Listgarten</surname><given-names>J</given-names></name><name name-style="western"><surname>Frahm</surname><given-names>N</given-names></name><name name-style="western"><surname>Kadie</surname><given-names>C</given-names></name><name name-style="western"><surname>Brander</surname><given-names>C</given-names></name><name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name></person-group>             <year>2007</year>             <article-title>A statistical framework for modeling HLA-dependent T-cell response data.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e188. doi:10.1371/journal.pcbi.0030188</fpage>          </element-citation></ref><ref id="pcbi.1000016-Gourraud1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gourraud</surname><given-names>P</given-names></name><name name-style="western"><surname>Lamiraux</surname><given-names>P</given-names></name><name name-style="western"><surname>El-Kadhi</surname><given-names>M</given-names></name><name name-style="western"><surname>Raffoux</surname><given-names>C</given-names></name><name name-style="western"><surname>Cambon-Thomsen</surname><given-names>A</given-names></name></person-group>             <year>2005</year>             <article-title>Inferred HLA haplotype information for donors from hematopoietic stem cells donor registries.</article-title>             <source>Hum Immunol</source>             <volume>66</volume>             <fpage>563</fpage>             <lpage>570</lpage>          </element-citation></ref><ref id="pcbi.1000016-Voorter1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Voorter</surname><given-names>C</given-names></name><name name-style="western"><surname>Mulkers</surname><given-names>E</given-names></name><name name-style="western"><surname>Liebelt</surname><given-names>P</given-names></name><name name-style="western"><surname>Sleyster</surname><given-names>E</given-names></name><name name-style="western"><surname>van den Berg-Loonen</surname><given-names>E</given-names></name></person-group>             <year>2007</year>             <article-title>Reanalysis of sequence-based HLA-A, -B and -Cw typings: how ambiguous is today's SBT typing tomorrow.</article-title>             <source>Tissue Antigens</source>             <volume>70</volume>             <fpage>383</fpage>             <lpage>389</lpage>          </element-citation></ref><ref id="pcbi.1000016-Marsh1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Marsh</surname><given-names>S</given-names></name><name name-style="western"><surname>Albert</surname><given-names>E</given-names></name><name name-style="western"><surname>Bodmer</surname><given-names>W</given-names></name><name name-style="western"><surname>Bontrop</surname><given-names>R</given-names></name><name name-style="western"><surname>Dupont</surname><given-names>B</given-names></name><etal/></person-group>             <year>2005</year>             <article-title>Nomenclature for factors of the HLA system, 2004.</article-title>             <source>Tissue Antigens</source>             <volume>65</volume>             <fpage>301</fpage>             <lpage>369</lpage>          </element-citation></ref><ref id="pcbi.1000016-Gao1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gao</surname><given-names>X</given-names></name><name name-style="western"><surname>Nelson</surname><given-names>G</given-names></name><name name-style="western"><surname>Karacki</surname><given-names>P</given-names></name><name name-style="western"><surname>Martin</surname><given-names>M</given-names></name><name name-style="western"><surname>Phair</surname><given-names>J</given-names></name><etal/></person-group>             <year>2001</year>             <article-title>Effect of a single amino acid change in MHC class I molecules on the rate of progression to AIDS.</article-title>             <source>N Engl J Med</source>             <volume>344</volume>             <fpage>1668</fpage>             <lpage>1675</lpage>          </element-citation></ref><ref id="pcbi.1000016-Clark1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Clark</surname><given-names>AG</given-names></name></person-group>             <year>1990</year>             <article-title>Inference of haplotypes from PCR-amplified samples of diploid populations.</article-title>             <source>Mol Biol Evol</source>             <volume>7</volume>             <fpage>111</fpage>             <lpage>122</lpage>          </element-citation></ref><ref id="pcbi.1000016-Excoffier1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Excoffier</surname><given-names>L</given-names></name><name name-style="western"><surname>Slatkin</surname><given-names>M</given-names></name></person-group>             <year>1995</year>             <article-title>Maximum-likelihood estimation of molecular haplotype frequencies in a diploid population.</article-title>             <source>Mol Biol Evol</source>             <volume>12</volume>             <fpage>921</fpage>             <lpage>927</lpage>          </element-citation></ref><ref id="pcbi.1000016-Hawley1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hawley</surname><given-names>M</given-names></name><name name-style="western"><surname>Kidd</surname><given-names>K</given-names></name></person-group>             <year>1995</year>             <article-title>HAPLO: a program using the EM algorithm to estimate the frequencies of multi-site haplotypes.</article-title>             <source>J Hered</source>             <volume>86</volume>             <fpage>409</fpage>             <lpage>411</lpage>          </element-citation></ref><ref id="pcbi.1000016-Ceppellini1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ceppellini</surname><given-names>R</given-names></name><name name-style="western"><surname>Siniscalo</surname><given-names>M</given-names></name><name name-style="western"><surname>Smith</surname><given-names>CAB</given-names></name></person-group>             <year>1955</year>             <article-title>The estimation of gene frequencies in a random-mating population.</article-title>             <source>Ann Human Genetics</source>             <volume>20</volume>             <fpage>97</fpage>             <lpage>115</lpage>          </element-citation></ref><ref id="pcbi.1000016-Stephens1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name><name name-style="western"><surname>Smith</surname><given-names>N</given-names></name><name name-style="western"><surname>Donnelly</surname><given-names>P</given-names></name></person-group>             <year>2001</year>             <article-title>A new statistical method for haplotype reconstruction from population data.</article-title>             <source>Am J Hum Genet</source>             <volume>68</volume>             <fpage>978</fpage>             <lpage>989</lpage>          </element-citation></ref><ref id="pcbi.1000016-Zhang1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name><name name-style="western"><surname>Niu</surname><given-names>T</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name></person-group>             <year>2006</year>             <article-title>A coalescence-guided hierarchical bayesian method for haplotype inference.</article-title>             <source>Am J Hum Genet</source>             <volume>79</volume>             <fpage>313</fpage>             <lpage>322</lpage>          </element-citation></ref><ref id="pcbi.1000016-Xing1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Xing</surname><given-names>EP</given-names></name><name name-style="western"><surname>Sohn</surname><given-names>K</given-names></name></person-group>             <year>2007</year>             <article-title>A nonparametric Bayesian approach for haplotype reconstruction from single and multi-population data. Technical Report 07-107. Carnegie Mellon University.</article-title>          </element-citation></ref><ref id="pcbi.1000016-Niu1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Niu</surname><given-names>T</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name></person-group>             <year>2002</year>             <article-title>Partition-ligation-expectation-maximization algorithm for haplotype inference with single-nucleotide polymorphisms.</article-title>             <source>Am J Hum Genet</source>             <volume>71</volume>             <fpage>1242</fpage>             <lpage>1247</lpage>          </element-citation></ref><ref id="pcbi.1000016-Thomas1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thomas</surname><given-names>A</given-names></name></person-group>             <year>2003</year>             <article-title>Accelerated gene counting for haplotype frequency estimation.</article-title>             <source>Ann Hum Genet</source>             <volume>67</volume>             <fpage>608</fpage>             <lpage>612</lpage>          </element-citation></ref><ref id="pcbi.1000016-Fallin1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fallin</surname><given-names>D</given-names></name><name name-style="western"><surname>Schork</surname><given-names>N</given-names></name></person-group>             <year>2000</year>             <article-title>Accuracy of haplotype frequency estimation for biallelic loci, via the Expectation-Maximization algorithm for unphased diploid genotype data.</article-title>             <source>Am J Human Genetics</source>             <volume>67</volume>             <fpage>947</fpage>             <lpage>959</lpage>          </element-citation></ref><ref id="pcbi.1000016-Niu2"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Niu</surname><given-names>T</given-names></name><name name-style="western"><surname>Qin</surname><given-names>ZS</given-names></name><name name-style="western"><surname>Xu</surname><given-names>X</given-names></name><name name-style="western"><surname>Liu</surname><given-names>JS</given-names></name></person-group>             <year>2002</year>             <article-title>Bayesian haplotype inference for multiple linked single-nucleotide polymorphisms.</article-title>             <source>Am J Hum Genet</source>             <volume>70</volume>             <fpage>157</fpage>             <lpage>169</lpage>          </element-citation></ref><ref id="pcbi.1000016-Maiers1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Maiers</surname><given-names>M</given-names></name><name name-style="western"><surname>Gragert</surname><given-names>L</given-names></name><name name-style="western"><surname>Klitz</surname><given-names>W</given-names></name></person-group>             <year>2006</year>             <article-title>High resolution HLA alleles and haplotypes in the US population.</article-title>             <source>Human Immunology</source>             <volume>67</volume>             <fpage>S16</fpage>          </element-citation></ref><ref id="pcbi.1000016-Leffell1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Leffell</surname><given-names>MS</given-names></name><name name-style="western"><surname>Cherikh</surname><given-names>WS</given-names></name><name name-style="western"><surname>Land</surname><given-names>G</given-names></name><name name-style="western"><surname>Zacharay</surname><given-names>AA</given-names></name></person-group>             <year>2007</year>             <article-title>Improved definition of human leukocyte antigen frequencies among minorities and applicability to estimates of transplant compatibility.</article-title>             <source>Transplantation</source>             <volume>83</volume>             <fpage>964</fpage>             <lpage>972</lpage>          </element-citation></ref><ref id="pcbi.1000016-Thriskos1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Thriskos</surname><given-names>P</given-names></name><name name-style="western"><surname>Zintzaras</surname><given-names>E</given-names></name><name name-style="western"><surname>Germenis</surname><given-names>A</given-names></name></person-group>             <year>2007</year>             <article-title>DHLAS: A web-based information system for statistical genetic analysis of HLA population data.</article-title>             <source>Comput Methods Prog Biomed</source>             <volume>85</volume>             <fpage>267</fpage>             <lpage>272</lpage>          </element-citation></ref><ref id="pcbi.1000016-Kollman1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kollman</surname><given-names>C</given-names></name><name name-style="western"><surname>Abella</surname><given-names>E</given-names></name><name name-style="western"><surname>Baitty</surname><given-names>RL</given-names></name><name name-style="western"><surname>Beatty</surname><given-names>PG</given-names></name><name name-style="western"><surname>Chakraborty</surname><given-names>R</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Assessment of optimal size and composition of the u.s. national registry of hematopoietic stem cell donors.</article-title>             <source>Transplantation</source>             <volume>78</volume>             <fpage>89</fpage>             <lpage>95</lpage>          </element-citation></ref><ref id="pcbi.1000016-Mller1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Müller</surname><given-names>CR</given-names></name><name name-style="western"><surname>Ehninger</surname><given-names>G</given-names></name><name name-style="western"><surname>Goldmann</surname><given-names>SF</given-names></name></person-group>             <year>2003</year>             <article-title>Gene and haplotype frequencies for the loci HLA-A, HLA-B, and HLA-DR based on over 13,000 german blood donors.</article-title>             <source>Hum Immunol</source>             <volume>64</volume>             <fpage>137</fpage>             <lpage>151</lpage>          </element-citation></ref><ref id="pcbi.1000016-Cao1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>K</given-names></name><name name-style="western"><surname>Hollenbach</surname><given-names>J</given-names></name><name name-style="western"><surname>Shi</surname><given-names>X</given-names></name><name name-style="western"><surname>Shi</surname><given-names>W</given-names></name><name name-style="western"><surname>Chopek</surname><given-names>M</given-names></name><etal/></person-group>             <year>2001</year>             <article-title>Analysis of the frequencies of HLA-A, B, and C alleles and haplotypes in the five major ethnic groups of the United States reveals high levels of diversity in these loci and contrasting distribution patterns in these populations.</article-title>             <source>Human Immunology</source>             <volume>62</volume>             <fpage>1009</fpage>             <lpage>1030</lpage>          </element-citation></ref><ref id="pcbi.1000016-Gourraud2"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gourraud</surname><given-names>P</given-names></name><name name-style="western"><surname>Genin</surname><given-names>E</given-names></name><name name-style="western"><surname>Cambon-Thomsen</surname><given-names>A</given-names></name></person-group>             <year>2004</year>             <article-title>Handling missing values in population data: consequences for maximum likelihood estimation of haplotype frequencies.</article-title>             <source>Eur J Hum Genet</source>             <volume>12</volume>             <fpage>805</fpage>             <lpage>812</lpage>          </element-citation></ref><ref id="pcbi.1000016-Jung1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jung</surname><given-names>HY</given-names></name><name name-style="western"><surname>Park</surname><given-names>YJ</given-names></name><name name-style="western"><surname>Kim</surname><given-names>YJ</given-names></name><name name-style="western"><surname>Park</surname><given-names>JS</given-names></name><name name-style="western"><surname>Kimm</surname><given-names>K</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>New methods for imputation of missing genotype using linkage disequilibrium and haplotype information.</article-title>             <source>Inf Sci</source>             <volume>177</volume>             <fpage>804</fpage>             <lpage>814</lpage>          </element-citation></ref><ref id="pcbi.1000016-Dempster1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dempster</surname><given-names>AP</given-names></name><name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name><name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name></person-group>             <year>1976</year>             <article-title>Maximum likelihood from incomplete data via the EM algorithm.</article-title>             <source>Proc Roy Stat Soc</source>             <fpage>1</fpage>             <lpage>38</lpage>          </element-citation></ref><ref id="pcbi.1000016-Neal1"><label>36</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Neal</surname><given-names>R</given-names></name><name name-style="western"><surname>Hinton</surname><given-names>G</given-names></name></person-group>             <year>1998</year>             <article-title>A view of the EM algorithm that justifies incremental, sparse, and other variants.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Jordan</surname><given-names>MI</given-names></name></person-group>             <source>Learning in Graphical Models</source>             <publisher-loc>Amsterdam</publisher-loc>             <publisher-name>Kluwer</publisher-name>          </element-citation></ref><ref id="pcbi.1000016-Bishop1"><label>37</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bishop</surname><given-names>CM</given-names></name></person-group>             <year>1996</year>             <article-title>Neural networks for pattern recognition.</article-title>             <publisher-loc>Oxford (United Kingdom)</publisher-loc>             <publisher-name>Oxford University Press</publisher-name>          </element-citation></ref><ref id="pcbi.1000016-Hastie1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name><name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name><name name-style="western"><surname>Friedman</surname><given-names>J</given-names></name></person-group>             <year>2001</year>             <article-title>The Elements of Statistical Learning. Springer.</article-title>          </element-citation></ref><ref id="pcbi.1000016-Heckerman1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name><name name-style="western"><surname>Kadie</surname><given-names>CM</given-names></name><name name-style="western"><surname>Listgarten</surname><given-names>J</given-names></name></person-group>             <year>2007</year>             <article-title>Leveraging information across HLA alleles/supertypes improves epitope prediction.</article-title>             <source>J Computat Biol</source>             <volume>14</volume>             <fpage>736</fpage>             <lpage>746</lpage>          </element-citation></ref><ref id="pcbi.1000016-Caruana1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Caruana</surname><given-names>R</given-names></name></person-group>             <year>1997</year>             <article-title>Multitask learning.</article-title>             <source>Mach Learn</source>             <volume>28</volume>             <fpage>41</fpage>             <lpage>75</lpage>          </element-citation></ref><ref id="pcbi.1000016-Little1"><label>41</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Little</surname><given-names>RJA</given-names></name><name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name></person-group>             <year>1987</year>             <article-title>Statistical analysis with missing data.</article-title>             <publisher-loc>New York</publisher-loc>             <publisher-name>John Wiley</publisher-name>          </element-citation></ref><ref id="pcbi.1000016-Cano1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cano</surname><given-names>P</given-names></name><name name-style="western"><surname>Klitz</surname><given-names>W</given-names></name><name name-style="western"><surname>Mack</surname><given-names>S</given-names></name><name name-style="western"><surname>Maiers</surname><given-names>M</given-names></name><name name-style="western"><surname>Marsh</surname><given-names>S</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Common and well-documented HLA alleles: report of the ad-hoc committee of the American Society for Histocompatiblity and Immunogenetics.</article-title>             <source>Human Immunology</source>             <volume>168</volume>             <fpage>392</fpage>             <lpage>417</lpage>          </element-citation></ref><ref id="pcbi.1000016-Guo1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Guo</surname><given-names>SW</given-names></name><name name-style="western"><surname>Thompson</surname><given-names>EA</given-names></name></person-group>             <year>1992</year>             <article-title>Performing the exact test of Hardy-Weinberg proportion for multiple alleles.</article-title>             <source>Biometrics</source>             <volume>48</volume>             <fpage>361</fpage>             <lpage>372</lpage>          </element-citation></ref><ref id="pcbi.1000016-Cao2"><label>44</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>K</given-names></name><name name-style="western"><surname>Fernández-Viña</surname><given-names>MA</given-names></name></person-group>             <year>2007</year>             <article-title>Asian pacific islander from the United States.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hansen</surname><given-names>J</given-names></name></person-group>             <source>Immunobiology of the Human MHC. Proceedings of the 13th International Histocompatibility Workshop and Conference</source>             <volume>volume 1</volume>             <publisher-loc>Seattle</publisher-loc>             <publisher-name>IHWG Press</publisher-name>             <fpage>648</fpage>             <lpage>651</lpage>          </element-citation></ref><ref id="pcbi.1000016-Cao3"><label>45</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>K</given-names></name><name name-style="western"><surname>Fernández-Viña</surname><given-names>MA</given-names></name></person-group>             <year>2007</year>             <article-title>Native American from the United States.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hansen</surname><given-names>J</given-names></name></person-group>             <source>Immunobiology of the Human MHC. Proceedings of the 13th International Histocompatibility Workshop and Conference</source>             <volume>volume 1</volume>             <publisher-loc>Seattle</publisher-loc>             <publisher-name>IHWG Press</publisher-name>             <fpage>648</fpage>             <lpage>651</lpage>          </element-citation></ref><ref id="pcbi.1000016-Cao4"><label>46</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>K</given-names></name><name name-style="western"><surname>Fernández-Viña</surname><given-names>MA</given-names></name></person-group>             <year>2007</year>             <article-title>Caucasian from the United States.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hansen</surname><given-names>J</given-names></name></person-group>             <source>Immunobiology of the Human MHC. Proceedings of the 13th International Histocompatibility Workshop and Conference</source>             <volume>volume 1</volume>             <publisher-loc>Seattle</publisher-loc>             <publisher-name>IHWG Press</publisher-name>             <fpage>648</fpage>             <lpage>651</lpage>          </element-citation></ref><ref id="pcbi.1000016-Cao5"><label>47</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>K</given-names></name><name name-style="western"><surname>Fernández-Viña</surname><given-names>MA</given-names></name></person-group>             <year>2007</year>             <article-title>Hispanic from the United States.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hansen</surname><given-names>J</given-names></name></person-group>             <source>Immunobiology of the Human MHC. Proceedings of the 13th International Histocompatibility Workshop and Conference</source>             <volume>Volume 1</volume>             <publisher-loc>Seattle</publisher-loc>             <publisher-name>IHWG Press</publisher-name>             <fpage>648</fpage>             <lpage>651</lpage>          </element-citation></ref><ref id="pcbi.1000016-Cao6"><label>48</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>K</given-names></name><name name-style="western"><surname>Fernández-Viña</surname><given-names>MA</given-names></name></person-group>             <year>2007</year>             <article-title>African American from the United States.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hansen</surname><given-names>J</given-names></name></person-group>             <source>Immunobiology of the Human MHC. Proceedings of the 13th International Histocompatibility Workshop and Conference</source>             <volume>Volume 1</volume>             <publisher-loc>Seattle</publisher-loc>             <publisher-name>IHWG Press</publisher-name>             <fpage>648</fpage>             <lpage>651</lpage>          </element-citation></ref><ref id="pcbi.1000016-Williams1"><label>49</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Williams</surname><given-names>F</given-names></name><name name-style="western"><surname>Middleton</surname><given-names>D</given-names></name></person-group>             <year>2007</year>             <article-title>Irish from Northern Ireland.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hansen</surname><given-names>J</given-names></name></person-group>             <source>Immunobiology of the Human MHC. Proceedings of the 13th International Histocompatibility Workshop and Conference</source>             <volume>Volume 1</volume>             <publisher-loc>Seattle</publisher-loc>             <publisher-name>IHWG Press</publisher-name>             <fpage>646</fpage>             <lpage>647</lpage>          </element-citation></ref><ref id="pcbi.1000016-Trachtenberg1"><label>50</label><element-citation publication-type="book" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Trachtenberg</surname><given-names>E</given-names></name><name name-style="western"><surname>Vinson</surname><given-names>M</given-names></name><name name-style="western"><surname>Hayes</surname><given-names>E</given-names></name><name name-style="western"><surname>Hsu</surname><given-names>M</given-names></name><name name-style="western"><surname>Houtchens</surname><given-names>K</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Southern Han Chinese from People's Republic of China.</article-title>             <person-group person-group-type="editor"><name name-style="western"><surname>Hansen</surname><given-names>J</given-names></name></person-group>             <source>Immunobiology of the Human MHC. Proceedings of the 13th International Histocompatibility Workshop and Conference</source>             <volume>Volume 1</volume>             <publisher-loc>Seattle</publisher-loc>             <publisher-name>IHWG Press</publisher-name>             <fpage>616</fpage>             <lpage>617</lpage>          </element-citation></ref><ref id="pcbi.1000016-Lauritzen1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lauritzen</surname><given-names>S</given-names></name></person-group>             <year>1996</year>             <article-title>Graphical Models. Clarendon Press.</article-title>          </element-citation></ref><ref id="pcbi.1000016-Ellison1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ellison</surname><given-names>GTH</given-names></name><name name-style="western"><surname>Smart</surname><given-names>A</given-names></name><name name-style="western"><surname>Tutton</surname><given-names>R</given-names></name><name name-style="western"><surname>Outram</surname><given-names>SM</given-names></name><name name-style="western"><surname>Ashcroft</surname><given-names>R</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Racial categories in medicine: A failure of evidence-based practice?</article-title>             <source>PLoS Medicine</source>             <volume>4</volume>             <fpage>e287</fpage>          </element-citation></ref></ref-list></back></article>