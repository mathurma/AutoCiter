<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004415</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00414</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>ENCORE: Software for Quantitative Ensemble Comparison</article-title>
<alt-title alt-title-type="running-head">ENCORE: Software for Quantitative Ensemble Comparison</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Tiberti</surname>
<given-names>Matteo</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Papaleo</surname>
<given-names>Elena</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Bengtsen</surname>
<given-names>Tone</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Boomsma</surname>
<given-names>Wouter</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Lindorff-Larsen</surname>
<given-names>Kresten</given-names>
</name>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Biotechnology and Biosciences, University of Milano-Bicocca, Milan, Italy</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Structural Biology and NMR Laboratory, Department of Biology, University of Copenhagen, Copenhagen, Denmark</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>de Groot</surname>
<given-names>Bert L.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Max Planck Institute for Biophysical Chemistry, GERMANY</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: MT EP WB KLL. Performed the experiments: MT EP TB WB. Analyzed the data: MT EP WB KLL. Contributed reagents/materials/analysis tools: MT EP TB WB KLL. Wrote the paper: MT EP TB WB KLL.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">wb@bio.ku.dk</email> (WB); <email xlink:type="simple">lindorff@bio.ku.dk</email> (KLL)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>27</day>
<month>10</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>10</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>10</issue>
<elocation-id>e1004415</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>3</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>6</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Tiberti et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004415" xlink:type="simple"/>
<abstract>
<p>There is increasing evidence that protein dynamics and conformational changes can play an important role in modulating biological function. As a result, experimental and computational methods are being developed, often synergistically, to study the dynamical heterogeneity of a protein or other macromolecules in solution. Thus, methods such as molecular dynamics simulations or ensemble refinement approaches have provided conformational ensembles that can be used to understand protein function and biophysics. These developments have in turn created a need for algorithms and software that can be used to compare structural ensembles in the same way as the root-mean-square-deviation is often used to compare static structures. Although a few such approaches have been proposed, these can be difficult to implement efficiently, hindering a broader applications and further developments. Here, we present an easily accessible software toolkit, called ENCORE, which can be used to compare conformational ensembles generated either from simulations alone or synergistically with experiments. ENCORE implements three previously described methods for ensemble comparison, that each can be used to quantify the similarity between conformational ensembles by estimating the overlap between the probability distributions that underlie them. We demonstrate the kinds of insights that can be obtained by providing examples of three typical use-cases: comparing ensembles generated with different molecular force fields, assessing convergence in molecular simulations, and calculating differences and similarities in structural ensembles refined with various sources of experimental data. We also demonstrate efficient computational scaling for typical analyses, and robustness against both the size and sampling of the ensembles. ENCORE is freely available and extendable, integrates with the established MDAnalysis software package, reads ensemble data in many common formats, and can work with large trajectory files.</p>
</abstract>
<funding-group>
<funding-statement>This work was funded by the Novo Nordisk Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.novonordiskfonden.dk/en" xlink:type="simple">http://www.novonordiskfonden.dk/en</ext-link>) and Villum Foundation (<ext-link ext-link-type="uri" xlink:href="http://villumfonden.dk" xlink:type="simple">http://villumfonden.dk</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="16"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>The experimentally-derived conformational ensembles that are analyzed are available from the PDB. The molecular dynamics simulations analyzed are previously published in PLOS ONE (<ext-link ext-link-type="uri" xlink:href="http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0032131" xlink:type="simple">http://journals.plos.org/plosone/article?id=10.1371/journal.pone.0032131</ext-link>). Those simulations are freely available to anyone after requests to the authors of that paper. The software presented/used is freely available at <ext-link ext-link-type="uri" xlink:href="http://encore-similarity.github.io/encore" xlink:type="simple">http://encore-similarity.github.io/encore</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Software paper</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Proteins are dynamical molecules, and the way a protein moves may have a large impact on its function. In addition to determining the “average” structures of proteins, it is therefore becoming increasingly important to describe their structural heterogeneity and dynamics. That is, instead of considering only a single molecular structure of a protein, one should instead represent the entire distribution, or <italic>ensemble</italic> of structures, as representing the structural state [<xref rid="pcbi.1004415.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1004415.ref003" ref-type="bibr">3</xref>]. As an immediate consequence, comparing molecular states now becomes a question of comparing structural ensembles, rather than individual conformations.</p>
<p>When comparing two structures of a protein one typically calculates the root-mean-square-deviation (RMSD), or one of the alternative scores that quantify the similarity between individual structures [<xref rid="pcbi.1004415.ref004" ref-type="bibr">4</xref>]. In contrast there is a scarcity of methods for comparison of structural ensembles. The problem was originally addressed by Brüschweiler, who proposed a generalization of the standard single-conformer RMSD technique [<xref rid="pcbi.1004415.ref005" ref-type="bibr">5</xref>]. A later study by Lindorff-Larsen and Ferkinghoff-Borg defined the problem in terms of comparing the probability distributions that underlie the ensembles, and proposed three different approaches for calculating ensemble similarities [<xref rid="pcbi.1004415.ref006" ref-type="bibr">6</xref>]. More recently, variations of these methods have been proposed [<xref rid="pcbi.1004415.ref007" ref-type="bibr">7</xref>–<xref rid="pcbi.1004415.ref011" ref-type="bibr">11</xref>]. Alternative approaches compare conformational ensembles by directly quantifying similarities in experimental data that report on their structural features [<xref rid="pcbi.1004415.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1004415.ref013" ref-type="bibr">13</xref>].</p>
<p>Thus, although there are now a few different methods for comparing structural ensembles, it is unclear which to use under which circumstance. Further, most algorithms are not easily accessible in publicly available and user-friendly software, and are not straightforward to implement efficiently. This paper addresses these issues by describing freely available, easy-to-use, efficient implementations of a range of existing ensemble comparison methods. The library, called ENCORE (<ext-link ext-link-type="uri" xlink:href="http://encore-similarity.github.io/encore" xlink:type="simple">http://encore-similarity.github.io/encore</ext-link>), interfaces with the MDAnalysis molecular analysis toolkit [<xref rid="pcbi.1004415.ref014" ref-type="bibr">14</xref>] and can be used both as a Python library and from the command line. The computational efficiency ensures that ensembles with tens of thousands of structures can be dealt with efficiently.</p>
<p>After presenting the design and implementation of the software, we demonstrate how it may be used to examine three problems in structural and computational biology. First, we analyse a set of recently published long molecular dynamics (MD) simulations of ubiquitin and the third IgG-binding domain of protein G (GB3) that were performed with eight different force fields [<xref rid="pcbi.1004415.ref015" ref-type="bibr">15</xref>]. ENCORE makes it possible to make detailed statements about similarities and differences between the structural dynamics induced by different force fields. Second, by calculating the similarity of ensembles generated with simulations of different lengths we study the important issue of how an MD simulation progresses towards its final distribution of conformations. Finally, using ubiquitin as a well-studied model system, we demonstrate that ENCORE can be used to compare experimentally determined structural ensembles, including those that explicitly aim to model the structural heterogeneity of proteins. Our results show that several different experimentally derived ensembles of ubiquitin are rather similar, and that MD simulations can in certain cases provide ensembles that are very similar to those obtained from experiments. Together with a demonstration of the computational scalability, the results illustrate how the ENCORE software can be used to study problems in computational structural biology.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Design and Implementation</title>
<p>Molecular ensembles come in different shapes and sizes. Traditionally, Nuclear Magnetic Resonance (NMR) derived experimental structures are typically represented by 10 or 20 structures that individually aim to satisfy all or most of the experimental restraints, and it has been argued that a similar practice should be used in crystallography [<xref rid="pcbi.1004415.ref002" ref-type="bibr">2</xref>]. Methods such as dynamic ensemble refinement [<xref rid="pcbi.1004415.ref001" ref-type="bibr">1</xref>], which aim to capture both the structure and dynamics of a protein, have provided ensembles on the order of 100 structures or more [<xref rid="pcbi.1004415.ref016" ref-type="bibr">16</xref>]. On the other hand, an MD simulation trajectory can also be considered as an ensemble, and might contain thousands if not millions of structures. Indeed, a recent 1-ms simulation of the protein BPTI was saved at a rate of 1 frame per 250 ps of simulation time and generated 4 million individual protein structures [<xref rid="pcbi.1004415.ref017" ref-type="bibr">17</xref>]. The formats used for such data also vary. While smaller ensembles are often reported in the PDB format, trajectory data are typically stored in more compact, binary formats, and typically depend on the simulation program used. When designing software in this field it is important to take into account the heterogeneous formats in which ensembles are represented.</p>
<p>Another obstacle is the lack of consensus about the algorithms used for conducting ensemble comparisons. The methods that have been proposed for this problem are based on different assumptions, and their relative abilities to describe relevant conformational similarities will depend on the degree of fluctuations in the ensemble. For molecules undergoing minor structural fluctuations, a harmonic assumption might be justified, in which case a simple algorithm for ensemble comparisons can be applied. For larger scale motions, more elaborate and computationally expensive approaches are needed.</p>
<p>The design of the ENCORE software package was driven by a desire to take into account both of the problems outlined above. First, the software tool is built on MDAnalysis, a well-established software framework for dealing with different molecular file formats, and can thus automatically deal with a variety of inputs. Second, we make available a number of different comparison algorithms within a single framework, facilitating the process of comparing ensembles with different algorithms.</p>
<p>Currently, three comparison algorithms are available within ENCORE. These have been described in detail elsewhere [<xref rid="pcbi.1004415.ref006" ref-type="bibr">6</xref>], and will only briefly be discussed here (<xref rid="pcbi.1004415.g001" ref-type="fig">Fig 1</xref>). Underlying all three methods is the idea that we first use the structural ensemble to estimate the underlying probability distribution, and then quantify the similarity of two derived probability distributions using symmetrized versions of the Kullback-Leibler divergence measure. The three methods, which mostly differ in how the probability distributions are derived, are: 1) A fast harmonic algorithm for small-scale fluctuations (HES: harmonic ensemble similarity), 2) A structural clustering based method (called CES), where similarity is defined by overlapping membership in the clusters, and 3) a dimensionality reduction method (called DRES), where similarity is defined through projecting the ensembles into lower dimensional spaces. The basic algorithms have been presented before [<xref rid="pcbi.1004415.ref006" ref-type="bibr">6</xref>], and we here focus on a completely new, user-friendly and efficient implementation aimed to make the methods widely available and extendable.</p>
<fig id="pcbi.1004415.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004415.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Overview of ensemble comparison methods implemented in ENCORE.</title>
<p>ENCORE implements three different methods for ensemble comparison. (A) As input ENCORE takes two or more conformational ensembles in a number of formats including PDB files and various trajectory formats. (B) In the harmonic ensemble similarity method (HES) each ensemble is represented as a high-dimensional Gaussian distribution, N(μ,∑) whose mean (μ) and covariance matrix (∑) ENCORE estimates from the conformational ensembles. A similarity score is then calculated as a symmetrized Kullback-Leibler divergence (<inline-formula id="pcbi.1004415.e001"><alternatives><graphic id="pcbi.1004415.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004415.e001" xlink:type="simple"/><mml:math display="inline" id="M1" overflow="scroll"><mml:msub><mml:mrow><mml:mi>D</mml:mi></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">K</mml:mi><mml:mi mathvariant="normal">L</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) between each pair of probability distributions. (C) In the calculation of the two other similarity measures, the first step is to calculate the pairwise RMSD between all structures in all ensembles. In ENCORE, this step can be parallelized over multiple computing cores and the results can be stored on disk for additional later analyses. (D) In the clustering-based ensemble similarity (CES) method, the matrix of pairwise RMSDs is used as input to the Affinity Propagation algorithm to cluster the structures from all ensembles together. The cluster populations from each ensemble are then used as basis for calculating the Jensen-Shannon divergence (<italic>D</italic><sub>JS</sub>) as a measure of ensemble similarity. (E) In the dimensionality-reduction-based ensemble similarity (DRES) method, the matrix of pairwise RMSDs is used as input to the Stochastic Proximity Embedding algorithm to project the high-dimensional conformational ensemble into a low-dimensional space. Using a kernel density estimation method in this lower dimensional space, ENCORE creates probability distributions for each ensemble, which are used as basis for calculating the Jensen-Shannon divergence between the ensembles. See ref. [<xref rid="pcbi.1004415.ref006" ref-type="bibr">6</xref>] for additional details on the three ensemble similarity methods.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004415.g001" position="float" xlink:type="simple"/>
</fig>
<p>The ENCORE software has a modular structure, so that the main steps in the calculations are independent, making it easy to extend and improve the software, as well as to use the modules independently. Most of the control flow and the general structure are written in Python for convenience, while the time-consuming parts are written as C libraries which are called by Python through Cython wrappers [<xref rid="pcbi.1004415.ref018" ref-type="bibr">18</xref>]. For example, the software contains C-implementations of the Affinity Propagation clustering [<xref rid="pcbi.1004415.ref019" ref-type="bibr">19</xref>] and Stochastic Proximity Embedding (SPE) projection [<xref rid="pcbi.1004415.ref020" ref-type="bibr">20</xref>] algorithms. The software is designed to make optimal use of fast multi-core machines in order to speed-up time-limiting operations. The currently implemented clustering-based and the dimensionality-reduction-based methods rely on the availability of a matrix of conformational similarity or distance values (e.g. RMSD), and obtaining this distance matrix can be the main bottleneck in the calculations. Our code therefore executes this calculation on multiple computational cores (with essentially linear-scaling), and the matrix can also be saved conveniently to disk to facilitate multiple analyses on the same system.</p>
</sec>
<sec id="sec003">
<title>Examples of Use of ENCORE</title>
<p>To provide examples of how ENCORE might be used in structural biology research and to demonstrate the general applicability of the software, we provide examples of three different use-cases. The first demonstrates how ensemble comparisons can be utilized to quantify the differences between simulations with different molecular force fields. The second is concerned with assessing convergence in molecular simulations. Finally, we conclude with a comparison of different experimentally derived structural ensembles for the same molecular system. For these examples we have selected previously examined protein systems to ease comparison with earlier observations.</p>
<sec id="sec004">
<title>Comparing force fields</title>
<p>When performing molecular simulations it can be difficult to interpret how the choice of a force field affects the resulting structural ensembles. Although the differences are well described at the parameter level, the structural consequences for a particular system are hard to predict. Sometimes it may be necessary to conduct simulations with different force fields, but even when such simulations have been completed, it is not trivial to quantify the observed differences. The software presented in this paper facilitates this process. As an illustration, we analyse a set of recently published 10-μs MD simulations on ubiquitin and GB3, using eight force fields from the CHARMM, AMBER and OPLS families [<xref rid="pcbi.1004415.ref015" ref-type="bibr">15</xref>]. We calculated the ensemble distances between each pair of trajectories, using 1000 frames from each trajectory (<xref rid="pcbi.1004415.g002" ref-type="fig">Fig 2A</xref> presents the results for GB3). Note that for both proteins, the CHARMM22 trajectories were excluded from these figures, as the structure substantially deteriorated during those simulations and their inclusion would therefore mask the remaining comparisons.</p>
<fig id="pcbi.1004415.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004415.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Comparing molecular simulations using ENCORE.</title>
<p>We used ENCORE to calculate the similarity between seven molecular dynamics simulations of (A, B) protein G and (C) ubiquitin. (A) The plots show the pairwise similarity between the seven ensembles computed using the three different ensemble comparison methods. (B) Using the similarities calculated by the CES method as an example, a tree-preserving embedding method was used to represent the ensembles in two-dimensions. In this plot, the distance between pairs of ensembles mimics (to the extent possible in two dimensions) the similarity between different ensembles. In agreement with the pairwise similarities, three pairs of ensembles (CHARMM22*/CHARMM27, ff99SB-ILDN/ff99SB*-ILDN, and ff03/ff03*) are located relatively close to one another, in line with the similar origins of each pair of force fields. (C) We performed similar calculations on seven ubiquitin simulations, again using the CES method as an example and projecting the similarities into two-dimensions. A similar organization is found for the different ensembles for both proteins, as is also evident from directly comparing the matrices of ensemble similarities. Note that in the projections, the axes have no direct physical meaning beyond their scale, which are determined so that the distance in the projections are close to the calculated <italic>D</italic><sub>JS</sub>. Note also that since these distances are invariant to rotations, translations and inversions of the projections, it is the relative positions in the two plots that should be compared.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004415.g002" position="float" xlink:type="simple"/>
</fig>
<p>As an aid to further interpret and visualize the pairwise similarities between the seven ensembles, we projected the results into two dimensions using a tree preserving embedding method [<xref rid="pcbi.1004415.ref021" ref-type="bibr">21</xref>] (<xref rid="pcbi.1004415.g002" ref-type="fig">Fig 2B</xref>). In this plot, the distance between two ensembles represents (as well as possible in a two-dimensional projection) the similarity between the corresponding ensembles (here represented by the clustering-based method). Such an analysis provides a convenient overview of the relative similarity of the different ensembles, in the same way as e.g. multidimensional scaling [<xref rid="pcbi.1004415.ref022" ref-type="bibr">22</xref>] or non-linear projection methods [<xref rid="pcbi.1004415.ref023" ref-type="bibr">23</xref>] can be used for comparing multiple static structures. Given the different approximations involved in the three methods for ensemble comparison that are currently implemented in ENCORE it is instructive to compare the resulting similarities. We find a good quantitative agreement between the clustering (CES) and dimensionality reduction (DRES) methods, while the harmonic method (HES) is in qualitative agreement (<xref rid="pcbi.1004415.g002" ref-type="fig">Fig 2</xref>). Common to the three methods is that certain pairs of trajectories, in particular Amber ff9SB-ILDN/ff9SB*-ILDN and ff03/ff03*, but also CHARMM22*/CHARMM27, are closer to one another than to the remaining simulations. Also, all methods show clearly that the simulation performed with OPLS differs the most from the remaining six ensembles. Very similar results are obtained when analysing an equivalent set of ubiquitin simulations (<xref rid="pcbi.1004415.g002" ref-type="fig">Fig 2C</xref>).</p>
<p>The results also highlight the fact that the HES scale is different from the DRES and CES scales. This is due to the fact that HES uses a different symmetrized version of the Kullback-Leibler divergence than the other two methods. Thus, while the Jensen-Shannon divergence used in DRES and CES may take on values between zero and ln(2)~0.69, HES can in principle take on values between zero and infinity. We note also that while our choice of Kullback-Leibler-based scores is inspired by its origin in information theory, an alternative interpretation of the divergence measure is as a (non-equilibrium) free-energy difference between the two ensembles [<xref rid="pcbi.1004415.ref024" ref-type="bibr">24</xref>,<xref rid="pcbi.1004415.ref025" ref-type="bibr">25</xref>]. The basis of the similarity scores in both thermodynamics and probability theory also highlights that any differences between ensembles that are not manifested in (equilibrium) distributions of the conformations (e.g. changes in the dynamics or rates of transitions between states) will not be captured.</p>
<p>The similarity of ensembles generated with particular pairs of force fields in <xref rid="pcbi.1004415.g002" ref-type="fig">Fig 2</xref> (e.g. ff99SB-ILDN and ff99SB*-ILDN) is interesting and highlights an important observation on the relationship between force field parameterization and the generated ensembles. These pairs of force fields, whose names differ by the inclusion of an asterisk, differ mostly in the parameters that define the backbone torsion angle potentials. In particular, the force fields ff99SB*, ff03* and CHARMM22* were derived from ff99SB, ff03, and CHARMM27 by modifying the backbone potential to give rise to a more accurate description on the energetic balance between extended and helical structures [<xref rid="pcbi.1004415.ref015" ref-type="bibr">15</xref>]. Our finding that the structural ensembles obtained from the 10 μs long MD simulations are very similar despite these important modifications suggests that simulations of this length are not sufficiently long and have too few transitions between distinct backbone conformations to expose the force field differences, which we expect would otherwise have given rise to more dissimilar ensembles. This observation in turn suggests that simulations with the level of sampling presented here are not alone sufficient to parameterize and test new force fields.</p>
<p>We recently analysed these same trajectories with a standard principal component (PC) analysis [<xref rid="pcbi.1004415.ref026" ref-type="bibr">26</xref>]. The results presented here are fully consistent with those results providing an overall validation of the observations from ENCORE. The current results, however, provide some additional insights. For instance, projections on the first PCs showed that simulations performed with ff99SB-ILDN, ff99SB*-ILDN, CHARMM22* and CHARMM27 cover relatively similar and well-defined structural ensembles, while simulations with ff03 and ff03* sample distinct, but also relatively well-defined regions of the conformational space. Based on the PC analysis and the calculation of the root mean square inner product using the first 10 PCs it was, however, more difficult to discern any differences between the ensembles generated with ff99SB-ILDN, ff99SB*-ILDN, CHARMM22* and CHARMM27. In contrast, the results obtained by ENCORE show clearly that, for both GB3 and ubiquitin, each pair of force fields (ff99SB-ILDN/ ff99SB*-ILDN, ff03/ff03*, CHARMM27/CHARMM22*) gives rise to ensembles that are more similar to one another than to ensembles from any of the remaining force fields. Further, we note that while quantities such as the root mean square inner product [<xref rid="pcbi.1004415.ref027" ref-type="bibr">27</xref>] can provide very useful information about the similarity between the conformational space spanned by ensembles, such methods are less directly affected by variations in the distributions of conformations within these spaces. The PC analysis also revealed that some ensembles appear to sample multiple similar, but distinct structural states. This means that one can only approximately describe these ensembles as normally distributed, which can explain some of the differences between the harmonic ensemble similarity method and the results from clustering and projections (<xref rid="pcbi.1004415.g002" ref-type="fig">Fig 2</xref>).</p>
<p>ENCORE provides the option for assessing the uncertainty of the calculated similarity scores using a bootstrap procedure, which conducts repetitions of the calculations on sub-sampled ensembles. In particular, for each ensemble we sampled (with replacement) a new ensemble with the same number of conformations and calculated the divergences between these resampled ensembles. This procedure was repeated many times and the uncertainties of the divergence measures were calculated as the variance over these estimates. As an example of the method and the level of uncertainty found, we calculated uncertainties for representative entries in <xref rid="pcbi.1004415.g002" ref-type="fig">Fig 2</xref> (<xref rid="pcbi.1004415.t001" ref-type="table">Table 1</xref>). In all cases we found the uncertainties to be rather small (average relative error is 6% with a maximum of 19%), with in particular the HES and CES methods appearing particularly robust. In all cases we find that the differences observed between the different ensembles are substantially larger than the noise level inherent to the procedure. We also analysed ten times smaller ensembles and found the relative error to increase on average by a factor of 3.6 (see also further below on an analysis of the robustness of the divergence measures towards sparsification).</p>
<table-wrap id="pcbi.1004415.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004415.t001</object-id>
<label>Table 1</label> <caption><title>Calculating uncertainties of similarity scores using a bootstrap procedure.</title> <p>The uncertainties were calculated for representative entries from <xref rid="pcbi.1004415.g002" ref-type="fig">Fig 2</xref> as standard deviations over 100 bootstrapped subsamples of the ensembles.</p></caption>
<alternatives>
<graphic id="pcbi.1004415.t001g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004415.t001" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1"/>
<th align="left" rowspan="1" colspan="1">d<sub>HES</sub></th>
<th align="left" rowspan="1" colspan="1">d<sub>CES</sub></th>
<th align="left" rowspan="1" colspan="1">d<sub>DRES</sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Amber03 vs. Amber03*</td>
<td align="left" rowspan="1" colspan="1">66.0±0.1</td>
<td align="left" rowspan="1" colspan="1">0.33±0.01</td>
<td align="left" rowspan="1" colspan="1">0.18±0.03</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Amber03 vs. CHARMM22*</td>
<td align="left" rowspan="1" colspan="1">388.7±0.4</td>
<td align="left" rowspan="1" colspan="1">0.61±0.01</td>
<td align="left" rowspan="1" colspan="1">0.39±0.05</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Amber03* vs. CHARMM22*</td>
<td align="left" rowspan="1" colspan="1">364.5±0.3</td>
<td align="left" rowspan="1" colspan="1">0.53±0.02</td>
<td align="left" rowspan="1" colspan="1">0.23±0.04</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec005">
<title>Assessing convergence</title>
<p>Assessing convergence is crucial when performing molecular simulations or protein structure determination, since only when fully converged does the ensemble actually represent the probability distribution (e.g. Boltzmann distribution of a force field) that one aims to sample. While an exhaustive assessment of the convergence of a simulation is difficult, because there might be events occurring on longer time scales than the one probed in simulation [<xref rid="pcbi.1004415.ref028" ref-type="bibr">28</xref>], it can be valuable to evaluate the degree of convergence within the visited conformational basins [<xref rid="pcbi.1004415.ref029" ref-type="bibr">29</xref>]. The ensemble comparison methods in ENCORE can be used for this task e.g. by quantifying the difference between the full trajectory and time-windows of increasing size. In this way we can answer the question of how quickly a simulation converges to our current best estimate of the complete distribution of conformations (i.e. the entire simulation). This idea is conceptually similar to the commonly used root-mean-square-inner-product [<xref rid="pcbi.1004415.ref030" ref-type="bibr">30</xref>], but differs in that we not only measure the overlap of the conformational spaces that are sampled, but also more directly quantify the extent to which the populations agree.</p>
<p>We illustrate this approach on the trajectories from the previous section, by calculating the ensemble similarities between the full simulations and shorter segments of increasing sizes (<xref rid="pcbi.1004415.g003" ref-type="fig">Fig 3</xref>). By construction, all curves eventually converge to zero, but the shape of the curve provides information about how quickly the simulation starts revisiting states it has already seen. For instance, for both GB3 and ubiquitin the trajectories of CHARMM27, AMBER ff99SB-ILDN and AMBER ff99SB*-ILDN very quickly drop to a low ensemble divergence, showing that these simulations quickly cover the same region of conformational space as the entire 10-μs simulation. The simulations performed with AMBER ff03* (and to some extent also the ff03 simulations) take slightly longer to reach a similarly low level of divergence to the full simulation. This can be understood in terms of the discussion above and our previous PC analysis [<xref rid="pcbi.1004415.ref026" ref-type="bibr">26</xref>], which show that these simulations sample a relatively well-defined state that is slightly different from that sampled in the more accurate (as evaluated by comparison to experimental data [<xref rid="pcbi.1004415.ref015" ref-type="bibr">15</xref>]) simulations with e.g. ff99SB*-ILDN. Thus, since the simulations are initiated from an experimental structure, they first relax into this slightly shifted conformational basin, and then have to explore that state to reach convergence. Finally, for both proteins the convergence analysis of the simulations performed with OPLS shows ensemble similarities that decrease monotonically without reaching a plateau, showing that they continue to explore new conformations. These observations are fully consistent when using both the CES and DRES methods.</p>
<fig id="pcbi.1004415.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004415.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Assessing the rate of convergence in molecular simulations.</title>
<p>Using the CES score we used ENCORE to assess the rate of convergence in seven molecular dynamics simulations of (A) protein G and (B) ubiquitin. In each case, we compared simulations of increasing length to the full ensemble obtained after 10μs of simulation. Per definition, the similarities thus decrease to zero at 10μs, but the rate at which low-values are obtained indicates how quickly the simulations have reached a distribution of conformations that is similar to the full ensemble. For example, simulations of both proteins with Amber ff99SB-ILDN and ff99SB*-ILDN quickly drop to very low values, reflecting the fact that the ensembles obtained after a few microseconds are very similar to those obtained at the end of the simulation. In contrast, for example, simulations with OPLS continue to explore new regions of conformational space during the entire simulations.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004415.g003" position="float" xlink:type="simple"/>
</fig>
<p>Although the convergence assessment procedure as described here can compare only single trajectories, there are various ways in which it can be extended to support multiple-trajectory simulations (such as those arising in distributed computing or replica-exchange simulations). One simple approach is to concatenate the individual trajectories into a target ensemble, and then measure its similarity to sub-ensembles of increasing size. For replica exchange or replica-averaged simulations, where different replicas are often constructed such as to sample the same distribution after convergence, it can also be useful to compare the ensembles obtained by the different replicas as the simulation progresses, to verify that all replicas have sampled the same conformational space.</p>
</sec>
<sec id="sec006">
<title>Comparison of experimentally-derived ensembles</title>
<p>In addition to ensembles generated e.g. by simulations using transferable molecular force fields, it is also becoming increasingly common to generate structural ensembles through a more direct integration of experiments and simulations. Most protein structures that are deposited in the Protein Data Bank have been generated to provide a single conformation that best fits all the available experimental data. (We note that this is also the case for most NMR ensembles, typically consisting of e.g. 10–20 structures, where each structure represents different but equivalent solutions to the optimization problem). Using combinations of experiments and simulations in methods such as ensemble refinement [<xref rid="pcbi.1004415.ref031" ref-type="bibr">31</xref>], time-averaged restrained simulations [<xref rid="pcbi.1004415.ref032" ref-type="bibr">32</xref>], Bayesian [<xref rid="pcbi.1004415.ref033" ref-type="bibr">33</xref>,<xref rid="pcbi.1004415.ref034" ref-type="bibr">34</xref>] or maximum entropy [<xref rid="pcbi.1004415.ref035" ref-type="bibr">35</xref>–<xref rid="pcbi.1004415.ref038" ref-type="bibr">38</xref>] methods one can, however, determine conformational ensembles to represent the structural dynamics of a protein. In short, these methods aim to derive structural ensembles that are simultaneously compatible with the experimental data at the ensemble level and prior structural information, typically encoded in a molecular force field. With increasing quality of the experimental data, molecular force fields [<xref rid="pcbi.1004415.ref015" ref-type="bibr">15</xref>] and theoretical background for such methods [<xref rid="pcbi.1004415.ref038" ref-type="bibr">38</xref>] it is becoming more common to use these methods, but so far no systematic study has compared the ensembles that result from using different kinds of experimental data and refinement approaches. We here demonstrate how ENCORE has allowed us to compare structural ensembles obtained by computation, experiments or through the combination of the two.</p>
<p>In the case of human ubiquitin, several ensembles have been generated using different kinds of experimental data. In addition to providing an atomic level view of the structural dynamics of a protein, these studies have provided insight into the role protein motions may play in function. In particular, a collection of several ubiquitin crystal structures, a so-called HSP ensemble, displays conformational variability similar to that revealed by NMR experiments on free ubiquitin in solution [<xref rid="pcbi.1004415.ref039" ref-type="bibr">39</xref>]. Similarly, a structural ensemble of free ubiquitin derived using NMR data displays a substantial overlap with an HSP ensemble [<xref rid="pcbi.1004415.ref040" ref-type="bibr">40</xref>]. Together, these studies suggest that ubiquitin free in solution samples an ensemble of conformations that may be “predisposed” towards the different structures this protein can take when binding to its various biological targets.</p>
<p>Using ubiquitin as an important model system for studying the structural dynamics of proteins by integrated computational and experimental methods, we here used ENCORE to compare the various structural ensembles of this protein. In particular, we compare thirteen different ubiquitin ensembles: (i) five ensembles determined using different methods for ensemble refinement using NMR data [<xref rid="pcbi.1004415.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1004415.ref016" ref-type="bibr">16</xref>,<xref rid="pcbi.1004415.ref040" ref-type="bibr">40</xref>–<xref rid="pcbi.1004415.ref042" ref-type="bibr">42</xref>] (ii) seven ensembles obtained using molecular dynamics simulations [<xref rid="pcbi.1004415.ref015" ref-type="bibr">15</xref>] and (iii) an HSP ensemble consisting of 46 different crystal structures of ubiquitin [<xref rid="pcbi.1004415.ref040" ref-type="bibr">40</xref>]. Using the CES method implemented in ENCORE we calculated the pairwise similarity between all 13 ensembles (<xref rid="pcbi.1004415.g004" ref-type="fig">Fig 4A</xref>) and projected the results in to two dimensions for easier visualization (<xref rid="pcbi.1004415.g004" ref-type="fig">Fig 4B</xref>).</p>
<fig id="pcbi.1004415.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004415.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparing ubiquitin ensembles from simulations and experiments.</title>
<p>We used ENCORE to compare 13 previously determined conformational ensembles of human ubiquitin: seven ensembles were obtained by molecular dynamics simulations with different force fields, five ensembles were generated via replica-averaged simulations that used experimental NMR data as restraints in molecular simulations and a single ensemble was obtained as a collection of 46 different crystal structures of ubiquitin. (A) Using CES we calculated the pairwise similarity of all 13 ensembles and (B) projected the results into two dimensions. Note how the molecular simulations (yellow labels) result in a broader range of conformational ensembles whereas the ensembles restrained via different kinds of experimental NMR data (blue labels) are all more similar to one another. This observation is evidence of the fact that experimental restraints, when used in replica-averaged simulations, can be thought of as system specific correction to the energy function used, which guides the simulations towards the correct conformational ensemble. Finally, note how the NMR-restrained simulations are also relatively similar to a collection of ubiquitin X-ray structures. This observation reiterates the notion that ubiquitin in solution samples a conformational ensemble that is similar to the variability observed in different ubiquitin structures, and also that such ensembles can be derived relatively robustly by combining NMR data and molecular simulations. Importantly, the five NMR ensembles were obtained using different procedures, force fields and sources and types of experimental data.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004415.g004" position="float" xlink:type="simple"/>
</fig>
<p>The results provide interesting new insight into the conformational ensembles obtained by simulations and experiments. Focusing first on the seven ensembles obtained from MD simulations we find the same overall pattern as obtained above (<xref rid="pcbi.1004415.g002" ref-type="fig">Fig 2</xref>) when these ensembles were analysed alone. Thus, we find that the similarities calculated by ENCORE in this case are not sensitive to the inclusion of the additional ensembles determined by experiments. Looking at the five ensembles obtained by ensemble refinement using e.g. NOEs and relaxation order parameters (DER, MUMO) or using multiple sets of residual dipolar couplings (EROS, ERNST, SB) we find that these ensembles cluster together in a smaller region of conformational space. Thus, it appears that the experimental data indeed can act as system-specific corrections to the energy function used for sampling that give rise to a relatively well-defined solution independent of the both protocol and data. In particular, we note that in addition to the differences in the kinds of data that were used and the way they were integrated with simulations, the different ensembles involved different molecular force fields (DER, MUMO: CHARMM22, SB: Amber ff99SB and EROS: OPLS). Thus, the results that we obtained using ENCORE lead to the conclusion that ensembles obtained by refining conformations against experimental NMR data, when compared to MD simulations, more robustly represent the structural dynamics of ubiquitin.</p>
<p>Of considerable interest we also find that these experimentally refined ensembles in general are close to the X-ray HSP ensemble. This observation strengthens further the conclusion that ubiquitin free in solution samples an ensemble similar to that sampled by ubiquitin when bound to different binding partners [<xref rid="pcbi.1004415.ref039" ref-type="bibr">39</xref>,<xref rid="pcbi.1004415.ref040" ref-type="bibr">40</xref>]. Our observation that the experimental data act to restrain the motions observed in the unbiased MD simulations to a more well-defined ensemble, similar to that found in crystal structures, is in line with recent findings based on an analysis of independently measured residual dipolar couplings [<xref rid="pcbi.1004415.ref043" ref-type="bibr">43</xref>]. Finally, we note that the MD ensembles obtained using either CHARMM27 or CHARMM22* fall within the same region of conformational space as the experimentally determined ensembles (none of which used these two force fields in their refinement) and are also relatively close to the HSP ensemble. These two ensembles were also previously found to provide the best agreement with experimentally measured residual dipolar couplings in ubiquitin [<xref rid="pcbi.1004415.ref015" ref-type="bibr">15</xref>].</p>
</sec>
</sec>
<sec id="sec007">
<title>Performance</title>
<p>Given the tendency towards larger ensembles and trajectories being reported in the literature, ENCORE was designed with efficiency in mind, with the explicit goal of making ensemble comparisons with tens of thousands of structures possible as a routine task. The computational simplicity of the HES method makes it naturally scalable to large ensembles. However, both the CES and DRES ensemble methods rely on the calculation of an RMSD distance matrix, which was found to be prohibitively costly for large ensembles. To improve scaling for these ensemble-comparison methods the RMSD calculation was implemented to take advantage of multiple processing cores in parallel. In addition, all clustering and dimensionality reduction functionality was implemented in C.</p>
<p>We probed the computational scaling behaviour of these critical components in two different ways: 1) the total runtime as a function of the number of processor cores (<xref rid="pcbi.1004415.g005" ref-type="fig">Fig 5A</xref>), and 2) the total runtime as a function of the number of structures in the ensembles (<xref rid="pcbi.1004415.g005" ref-type="fig">Fig 5B</xref>). The former clearly illustrates that the dominating RMSD distance calculation now scales linearly due to parallelized execution on multiple cores. The clustering and dimensionality reduction algorithms have not been parallelized in this first release of ENCORE, but their contribution to the total computational costs can be seen to remain less significant when executing with up to 8–16 cores, which are common values for modern computer architectures. For a fixed number of processing units (16), we see that the clustering itself now dominates slightly with a quadratic complexity, while dimensionality reduction scales a bit better (following the original description, the stress parameter was chosen to scale linearly with ensemble size [<xref rid="pcbi.1004415.ref020" ref-type="bibr">20</xref>]). In all cases, we find that the simpler HES method is computationally much more efficient both in terms of its run time and the scaling with the ensemble size.</p>
<fig id="pcbi.1004415.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004415.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Computational scaling of ENCORE calculations.</title>
<p>We determined how the runtime of ENCORE scales with (A) the number of computer cores when executing ENCORE in a parallel fashion and (B) when varying the number of frames for a fixed number of computer cores. In (A) the black line illustrates how the pairwise RMSD calculation can be sped up by distributing the calculations over multiple cores. As the clustering and dimensionality reduction methods that have so far been implemented have not been parallelized they appear as horizontal lines that will eventually (above 8–16 cores) limit the overall calculations. In (B) we show how the overall runtime increases for both the RMSD calculations, clustering and dimensionality reduction as the number of frames are also increased. We used 16 processor cores for the calculations.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004415.g005" position="float" xlink:type="simple"/>
</fig>
<p>For ensembles arising as trajectories from simulation, a natural way of increasing the performance of the analysis is to decrease the time resolution by only using every n’th frame of the original ensemble. We investigated the sensitivity of the three similarity methods to such sparsifications of the data by calculating the similarity between the original ensemble and ensembles sparsified to include only a fixed number of (uniformly spaced) frames (<xref rid="pcbi.1004415.g006" ref-type="fig">Fig 6</xref>). The results demonstrate that, at least on the types of ensembles considered here, little is gained by using more than 1000 frames.</p>
<fig id="pcbi.1004415.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004415.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Effect of sparsifying the simulation data.</title>
<p>We evaluated the robustness of the calculated similarity scores when decreasing the ensemble size. In particular, we took 8192 (2<sup>13</sup>) frames separated by 1ns from a simulation of GB3 using Amber ff03 as a reference and created subensembles of various sizes by iteratively removing every second frame. We subsequently calculated the three different similarity scores between the full ensemble and the various subensembles that contained between 128 and 4096 frames. The results show that even when only every 16th frame is retained the pairwise similarity is very high (divergence close to zero), demonstrating both the robustness of the calculations and that such sparsification likely is an efficient way of improving computational efficiency in practice.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004415.g006" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Availability and Future Directions</title>
<p>ENCORE is freely available (<ext-link ext-link-type="uri" xlink:href="http://encore-similarity.github.io/encore" xlink:type="simple">http://encore-similarity.github.io/encore</ext-link>), together with its documentation and several examples on how to use it, and is distributed under the GNU general public license, version 3. The code can readily be extended to include additional methods for ensemble comparison as well as for novel uses for the algorithms that have already been implemented. One of the primary directions for future work is to extend the capabilities of the CES and DRES methods to beyond that of tens of thousands of structures. This would require finding alternative methods that do not need the full RMSD distance matrix, since it will neither be feasible to calculate nor store such large matrices in memory. The memory issue can be resolved by supporting on-the-fly distance calculations, or by using landmark-based methods that have previously successfully been used e.g. in projection of conformational ensembles [<xref rid="pcbi.1004415.ref044" ref-type="bibr">44</xref>]. The complexity of the RMSD calculations itself could be overcome by using alternative distance metrics such as Gaussian Integral based techniques [<xref rid="pcbi.1004415.ref045" ref-type="bibr">45</xref>]. Finally, for the CES approach, better scaling would require using a sub-quadratic time clustering method. Other future work on ensemble comparison methods could include using mixture models [<xref rid="pcbi.1004415.ref046" ref-type="bibr">46</xref>] to represent the probability distributions instead of the kernel density estimates currently used in the projection-based method. Also, currently both the clustering and projection based methods use the matrix of pairwise RMSDs to define the overall conformational space. For ensembles generated from simulations of protein folding or for intrinsically disordered proteins it may, however, be more appropriate to use other similarity scores than the RMSD [<xref rid="pcbi.1004415.ref023" ref-type="bibr">23</xref>,<xref rid="pcbi.1004415.ref047" ref-type="bibr">47</xref>] and such scores may also readily be implemented in ENCORE. In the case of molecular dynamics simulations, the time evolution of the system provides additional information that can be used e.g. to build Markov state models [<xref rid="pcbi.1004415.ref048" ref-type="bibr">48</xref>] or in kinetic clustering schemes [<xref rid="pcbi.1004415.ref017" ref-type="bibr">17</xref>]. It has recently been demonstrated how the Jensen-Shannon divergence provides a natural means to compare two different Markov state models [<xref rid="pcbi.1004415.ref049" ref-type="bibr">49</xref>] and it will be interesting to determine to what extent the temporal information, when present, helps in comparing molecular ensembles. Also, we note that as it is difficult to provide a simple geometric interpretation of the scores, we suggest they are currently best interpreted in a relative fashion (e.g. ensemble A is more similar to B than to C), and hope that a more widespread application of the methods will help provide a clearer intuitive understanding for the absolute values of the similarity scores. Finally, we hope that the broad availability and easy use of the ensemble comparison methods that ENCORE confers will spur new studies that both use the methods to provide biological insight as well as allow for more systematic comparisons and evaluations of the strengths and weaknesses of the algorithms involved.</p>
</sec>
<sec id="sec009">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004415.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004415.s001" position="float" xlink:type="simple">
<label>S1 Software</label>
<caption>
<title>ENCORE software and examples.</title>
<p>(GZ)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004415.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Best</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Depristo</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Dobson</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Vendruscolo</surname> <given-names>M</given-names></name> (<year>2005</year>) <article-title>Simultaneous determination of protein structure and dynamics</article-title>. <source>Nature</source> <volume>433</volume>: <fpage>128</fpage>–<lpage>132</lpage>. <object-id pub-id-type="pmid">15650731</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Furnham</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Blundell</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>DePristo</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Terwilliger</surname> <given-names>TC</given-names></name> (<year>2006</year>) <article-title>Is one solution good enough?</article-title> <source>Nat Struct Mol Biol</source> <volume>13</volume>: <fpage>184</fpage>–<lpage>185</lpage> <object-id pub-id-type="pmid">16518382</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Woldeyes</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Sivak</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Fraser</surname> <given-names>JS</given-names></name> (<year>2014</year>) <article-title>E pluribus unum, no more: from one crystal, many conformations</article-title>. <source>Curr Opin Struct Biol</source> <volume>28C</volume>: <fpage>56</fpage>–<lpage>62</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004415.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sierk</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Pearson</surname> <given-names>WR</given-names></name> (<year>2004</year>) <article-title>Sensitivity and selectivity in protein structure comparison</article-title>. <source>Protein Sci</source> <volume>13</volume>: <fpage>773</fpage>–<lpage>785</lpage>. <object-id pub-id-type="pmid">14978311</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brüschweiler</surname> <given-names>R</given-names></name> (<year>2003</year>) <article-title>Efficient RMSD measures for the comparison of two molecular ensembles. Root-mean-square deviation</article-title>. <source>Proteins</source> <volume>50</volume>: <fpage>26</fpage>–<lpage>34</lpage>. <object-id pub-id-type="pmid">12471596</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ferkinghoff-Borg</surname> <given-names>J</given-names></name> (<year>2009</year>) <article-title>Similarity measures for protein ensembles</article-title>. <source>PLoS One</source> <volume>4</volume>: <fpage>e4203</fpage>. A <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0004203" xlink:type="simple">10.1371/journal.pone.0004203</ext-link></comment> <object-id pub-id-type="pmid">19145244</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wolfe</surname> <given-names>KC</given-names></name>, <name name-style="western"><surname>Chirikjian</surname> <given-names>GS</given-names></name> (<year>2012</year>) <article-title>Quantitative Comparison of Conformational Ensembles</article-title>. <source>Entropy</source> <volume>14</volume>: <fpage>213</fpage>–<lpage>232</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004415.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Damas</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Filipe</surname> <given-names>LCS</given-names></name>, <name name-style="western"><surname>Campos</surname> <given-names>SRR</given-names></name>, <name name-style="western"><surname>Lousa</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Victor</surname> <given-names>BL</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Predicting the Thermodynamics and Kinetics of Helix Formation in a Cyclic Peptide Model</article-title>. <source>J Chem Theory Comput</source> <volume>9</volume>: <fpage>5148</fpage>–<lpage>5157</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004415.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xiang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gapsys</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>H-Y</given-names></name>, <name name-style="western"><surname>Bessonov</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hsiao</surname> <given-names>H-H</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Phosphorylation drives a dynamic switch in serine/arginine-rich proteins</article-title>. <source>Structure</source> <volume>21</volume>: <fpage>2162</fpage>–<lpage>2174</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.str.2013.09.014" xlink:type="simple">10.1016/j.str.2013.09.014</ext-link></comment> <object-id pub-id-type="pmid">24183573</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Salmon</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Al-Hashimi</surname> <given-names>HM</given-names></name> (<year>2014</year>) <article-title>Measuring similarity between dynamic ensembles of biomolecules</article-title>. <source>Nat Methods</source> <volume>11</volume>: <fpage>552</fpage>–<lpage>554</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2921" xlink:type="simple">10.1038/nmeth.2921</ext-link></comment> <object-id pub-id-type="pmid">24705474</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McClendon</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Hua</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Barreiro</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jacobson</surname> <given-names>MP</given-names></name> (<year>2012</year>) <article-title>Comparing Conformational Ensembles Using the Kullback-Leibler Divergence Expansion</article-title>. <source>J Chem Theory Comput</source> <volume>8</volume>: <fpage>2115</fpage>–<lpage>2126</lpage>. <object-id pub-id-type="pmid">23316121</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Malmendal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Underhaug</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Otzen</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>NC</given-names></name> (<year>2010</year>) <article-title>Fast mapping of global protein folding states by multivariate NMR: a GPS for proteins</article-title>. <source>PLoS One</source> <volume>5</volume>: <fpage>e10262</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0010262" xlink:type="simple">10.1371/journal.pone.0010262</ext-link></comment> <object-id pub-id-type="pmid">20421996</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hura</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Budworth</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Dyer</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Rambo</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Hammel</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Comprehensive macromolecular conformations mapped by quantitative SAXS analyses</article-title>. <source>Nat Methods</source> <volume>10</volume>: <fpage>453</fpage>–<lpage>454</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2453" xlink:type="simple">10.1038/nmeth.2453</ext-link></comment> <object-id pub-id-type="pmid">23624664</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Michaud-Agrawal</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Denning</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Woolf</surname> <given-names>TB</given-names></name>, <name name-style="western"><surname>Beckstein</surname> <given-names>O</given-names></name> (<year>2011</year>) <article-title>MDAnalysis: A toolkit for the analysis of molecular dynamics simulations</article-title>. <source>J Comput Chem</source>. <volume>32</volume>:<fpage>2319</fpage>–<lpage>2327</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/jcc.21787" xlink:type="simple">10.1002/jcc.21787</ext-link></comment> <object-id pub-id-type="pmid">21500218</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Maragakis</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Piana</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Eastwood</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Dror</surname> <given-names>RO</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Systematic validation of protein force fields against experimental data</article-title>. <source>PLoS One</source> <volume>7</volume>: <fpage>e32131</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0032131" xlink:type="simple">10.1371/journal.pone.0032131</ext-link></comment> <object-id pub-id-type="pmid">22384157</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fenwick</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Esteban-Martín</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Richter</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Walter</surname> <given-names>KFA</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Weak long-range correlated motions in a surface patch of ubiquitin involved in molecular recognition</article-title>. <source>J Am Chem Soc</source> <volume>133</volume>: <fpage>10336</fpage>–<lpage>10339</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ja200461n" xlink:type="simple">10.1021/ja200461n</ext-link></comment> <object-id pub-id-type="pmid">21634390</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shaw</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Maragakis</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Piana</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dror</surname> <given-names>RO</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Atomic-level characterization of the structural dynamics of proteins</article-title>. <source>Science</source> <volume>330</volume>: <fpage>341</fpage>–<lpage>346</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1187409" xlink:type="simple">10.1126/science.1187409</ext-link></comment> <object-id pub-id-type="pmid">20947758</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Behnel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bradshaw</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Citro</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Dalcin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Seljebotn</surname> <given-names>DS</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Cython: The best of both the worlds</article-title>. <source>Comput Sci Eng</source> <volume>13</volume>: <fpage>31</fpage>–<lpage>39</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004415.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frey</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Dueck</surname> <given-names>D</given-names></name> (<year>2007</year>) <article-title>Clustering by passing messages between data points</article-title>. <source>Science</source> <volume>315</volume>: <fpage>972</fpage>–<lpage>976</lpage>. <object-id pub-id-type="pmid">17218491</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Agrafiotis</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>H</given-names></name> (<year>2002</year>) <article-title>A self-organizing principle for learning nonlinear manifolds</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>99</volume>: <fpage>15869</fpage>–<lpage>15872</lpage>. <object-id pub-id-type="pmid">12444256</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shieh</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Hashimoto</surname> <given-names>TB</given-names></name>, <name name-style="western"><surname>Airoldi</surname> <given-names>EM</given-names></name> (<year>2011</year>) <article-title>Tree preserving embedding</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>16916</fpage>–<lpage>16921</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1018393108" xlink:type="simple">10.1073/pnas.1018393108</ext-link></comment> <object-id pub-id-type="pmid">21949369</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levitt</surname> <given-names>M</given-names></name> (<year>1983</year>) <article-title>Molecular dynamics of native protein. II. Analysis and nature of motion</article-title>. <source>J Mol Biol</source> <volume>168</volume>: <fpage>621</fpage>–<lpage>657</lpage>. <object-id pub-id-type="pmid">6193282</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Røgen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Paci</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Vendruscolo</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dobson</surname> <given-names>CM</given-names></name> (<year>2005</year>) <article-title>Protein folding and the organization of the protein topology universe</article-title>. <source>Trends Biochem Sci</source> <volume>30</volume>: <fpage>13</fpage>–<lpage>19</lpage>. <object-id pub-id-type="pmid">15653321</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qian</surname> <given-names>H</given-names></name> (<year>2001</year>) <article-title>Relative entropy: Free energy associated with equilibrium fluctuations and nonequilibrium deviations</article-title>. <source>Phys Rev E</source> <volume>63</volume>: <fpage>042103</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004415.ref025"><label>25</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Wall</surname> <given-names>ME</given-names></name> (<year>2006</year>) <chapter-title>Ligand binding, protein fluctuations, and allosteric free energy</chapter-title>. <name name-style="western"><surname>Clemente-Gallardo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moreno</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lorenzo</surname> <given-names>JFS</given-names></name>, <name name-style="western"><surname>Velazquez-Campoy</surname> <given-names>A</given-names></name>, eds <publisher-loc>New York, USA</publisher-loc> <publisher-name>Am Inst Physics</publisher-name>: <fpage>16</fpage>–<lpage>33</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004415.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Martín-García</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Papaleo</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gomez-Puertas</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Boomsma</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name> (<year>2015</year>) <article-title>Comparing MD force-fields in the essential subspace</article-title>. <source>PLoS One</source> <volume>10</volume>: <fpage>e0121114</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0121114" xlink:type="simple">10.1371/journal.pone.0121114</ext-link></comment> <object-id pub-id-type="pmid">25811178</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hess</surname> <given-names>B</given-names></name> (<year>2002</year>) <article-title>Convergence of sampling in protein simulations</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source> <volume>65</volume>: <fpage>031910</fpage>. <object-id pub-id-type="pmid">11909112</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Genheden</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ryde</surname> <given-names>U</given-names></name> (<year>2012</year>) <article-title>Will molecular dynamics simulations of proteins ever reach equilibrium?</article-title> <source>Phys Chem Chem Phys</source>. <volume>14</volume>: <fpage>8662</fpage>–<lpage>8677</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1039/c2cp23961b" xlink:type="simple">10.1039/c2cp23961b</ext-link></comment> <object-id pub-id-type="pmid">22614001</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mobley</surname> <given-names>DL</given-names></name> (<year>2012</year>) <article-title>Let’s get honest about sampling</article-title>. <source>J Comput Aided Mol Des</source> <volume>26</volume>: <fpage>93</fpage>–<lpage>95</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10822-011-9497-y" xlink:type="simple">10.1007/s10822-011-9497-y</ext-link></comment> <object-id pub-id-type="pmid">22113833</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>De Groot</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>van Aalten</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Amadei</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Berendsen</surname> <given-names>HJ</given-names></name> (<year>1996</year>) <article-title>The consistency of large concerted motions in proteins in molecular dynamics simulations</article-title>. <source>Biophys J</source> <volume>71</volume>: <fpage>1707</fpage>–<lpage>1713</lpage>. <object-id pub-id-type="pmid">8889148</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuriyan</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Osapay</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Burley</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Brünger</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Hendrickson</surname> <given-names>WA</given-names></name>, <etal>et al</etal>. (<year>1991</year>) <article-title>Exploration of disorder in protein structures by X-ray restrained molecular dynamics</article-title>. <source>Proteins</source> <volume>10</volume>: <fpage>340</fpage>–<lpage>358</lpage>. <object-id pub-id-type="pmid">1946343</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Torda</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Scheek</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gunsteren</surname> <given-names>W Van</given-names></name> (<year>1989</year>) <article-title>Time-dependent distance restraints in molecular dynamics simulations</article-title>. <source>Chem Phys Lett</source> <volume>157</volume>: <fpage>289</fpage>–<lpage>294</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004415.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Olsson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Frellsen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Boomsma</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Mardia</surname> <given-names>K V</given-names></name>, <name name-style="western"><surname>Hamelryck</surname> <given-names>T</given-names></name> (<year>2013</year>) <article-title>Inference of structure ensembles of flexible biomolecules from sparse, averaged data</article-title>. <source>PLoS One</source> <volume>8</volume>: <fpage>e79439</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0079439" xlink:type="simple">10.1371/journal.pone.0079439</ext-link></comment> <object-id pub-id-type="pmid">24244505</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beauchamp</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Pande</surname> <given-names>VS</given-names></name>, <name name-style="western"><surname>Das</surname> <given-names>R</given-names></name> (<year>2014</year>) <article-title>Bayesian energy landscape tilting: towards concordant models of molecular ensembles</article-title>. <source>Biophys J</source> <volume>106</volume>: <fpage>1381</fpage>–<lpage>1390</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2014.02.009" xlink:type="simple">10.1016/j.bpj.2014.02.009</ext-link></comment> <object-id pub-id-type="pmid">24655513</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pitera</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Chodera</surname> <given-names>JD</given-names></name> (<year>2012</year>) <article-title>On the Use of Experimental Observations to Bias Simulated Ensembles</article-title>. <source>J Chem Theory Comput</source> <volume>8</volume>: <fpage>3445</fpage>–<lpage>3451</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004415.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roux</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Weare</surname> <given-names>J</given-names></name> (<year>2013</year>) <article-title>On the statistical equivalence of restrained-ensemble simulations with the maximum entropy method</article-title>. <source>J Chem Phys</source> <volume>138</volume>: <fpage>084107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4792208" xlink:type="simple">10.1063/1.4792208</ext-link></comment> <object-id pub-id-type="pmid">23464140</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cavalli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Camilloni</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Vendruscolo</surname> <given-names>M</given-names></name> (<year>2013</year>) <article-title>Molecular dynamics simulations with replica-averaged structural restraints generate structural ensembles according to the maximum entropy principle</article-title>. <source>J Chem Phys</source> <volume>138</volume>: <fpage>094112</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4793625" xlink:type="simple">10.1063/1.4793625</ext-link></comment> <object-id pub-id-type="pmid">23485282</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boomsma</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Ferkinghoff-Borg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name> (<year>2014</year>) <article-title>Combining experiments and simulations using the maximum entropy principle</article-title>. <source>PLoS Comput Biol</source> <volume>10</volume>: <fpage>e1003406</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003406" xlink:type="simple">10.1371/journal.pcbi.1003406</ext-link></comment> <object-id pub-id-type="pmid">24586124</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Best</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>DePristo</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Vendruscolo</surname> <given-names>M</given-names></name> (<year>2006</year>) <article-title>Relation between native ensembles and experimental structures of proteins</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>103</volume>: <fpage>10901</fpage>–<lpage>10906</lpage>. <object-id pub-id-type="pmid">16829580</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lange</surname> <given-names>OF</given-names></name>, <name name-style="western"><surname>Lakomek</surname> <given-names>N-A</given-names></name>, <name name-style="western"><surname>Farès</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Schröder</surname> <given-names>GF</given-names></name>, <name name-style="western"><surname>Walter</surname> <given-names>KFA</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Recognition dynamics up to microseconds revealed from an RDC-derived ubiquitin ensemble in solution</article-title>. <source>Science</source> <volume>320</volume>: <fpage>1471</fpage>–<lpage>1475</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1157092" xlink:type="simple">10.1126/science.1157092</ext-link></comment> <object-id pub-id-type="pmid">18556554</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Richter</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gsponer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Várnai</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Salvatella</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Vendruscolo</surname> <given-names>M</given-names></name> (<year>2007</year>) <article-title>The MUMO (minimal under-restraining minimal over-restraining) method for the determination of native state ensembles of proteins</article-title>. <source>J Biomol NMR</source> <volume>37</volume>: <fpage>117</fpage>–<lpage>135</lpage>. <object-id pub-id-type="pmid">17225069</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Montalvao</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>De Simone</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vendruscolo</surname> <given-names>M</given-names></name> (<year>2012</year>) <article-title>Determination of structural fluctuations of proteins from structure-based calculations of residual dipolar couplings</article-title>. <source>J Biomol NMR</source> <volume>53</volume>: <fpage>281</fpage>–<lpage>292</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10858-012-9644-3" xlink:type="simple">10.1007/s10858-012-9644-3</ext-link></comment> <object-id pub-id-type="pmid">22729708</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maltsev</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Grishaev</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Roche</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zasloff</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bax</surname> <given-names>A</given-names></name> (<year>2014</year>) <article-title>Improved cross validation of a static ubiquitin structure derived from high precision residual dipolar couplings measured in a drug-based liquid crystalline phase</article-title>. <source>J Am Chem Soc</source> <volume>136</volume>: <fpage>3752</fpage>–<lpage>3755</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ja4132642" xlink:type="simple">10.1021/ja4132642</ext-link></comment> <object-id pub-id-type="pmid">24568736</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Das</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Moll</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Stamati</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kavraki</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Clementi</surname> <given-names>C</given-names></name> (<year>2006</year>) <article-title>Low-dimensional, free-energy landscapes of protein-folding reactions by nonlinear dimensionality reduction</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>103</volume>: <fpage>9885</fpage>–<lpage>9890</lpage>. <object-id pub-id-type="pmid">16785435</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harder</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Borg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Boomsma</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Røgen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hamelryck</surname> <given-names>T</given-names></name> (<year>2012</year>) <article-title>Fast large-scale clustering of protein structures using Gauss integrals</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>510</fpage>–<lpage>515</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btr692" xlink:type="simple">10.1093/bioinformatics/btr692</ext-link></comment> <object-id pub-id-type="pmid">22199383</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hirsch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Habeck</surname> <given-names>M</given-names></name> (<year>2008</year>) <article-title>Mixture models for protein structure ensembles</article-title>. <source>Bioinformatics</source> <volume>24</volume>: <fpage>2184</fpage>–<lpage>2192</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn396" xlink:type="simple">10.1093/bioinformatics/btn396</ext-link></comment> <object-id pub-id-type="pmid">18662925</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lindorff-Larsen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Piana</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dror</surname> <given-names>RO</given-names></name>, <name name-style="western"><surname>Shaw</surname> <given-names>DE</given-names></name> (<year>2011</year>) <article-title>How fast-folding proteins fold</article-title>. <source>Science</source> <volume>334</volume>: <fpage>517</fpage>–<lpage>520</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1208351" xlink:type="simple">10.1126/science.1208351</ext-link></comment> <object-id pub-id-type="pmid">22034434</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chodera</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Noé</surname> <given-names>F</given-names></name> (<year>2014</year>) <article-title>Markov state models of biomolecular conformational dynamics</article-title>. <source>Curr Opin Struct Biol</source> <volume>25</volume>: <fpage>135</fpage>–<lpage>144</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.sbi.2014.04.002" xlink:type="simple">10.1016/j.sbi.2014.04.002</ext-link></comment> <object-id pub-id-type="pmid">24836551</object-id></mixed-citation></ref>
<ref id="pcbi.1004415.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Voelz</surname> <given-names>VA</given-names></name>, <name name-style="western"><surname>Elman</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Razavi</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>G</given-names></name> (<year>2014</year>) <article-title>Surprisal Metrics for Quantifying Perturbed Conformational Dynamics in Markov State Models</article-title>. <source>J Chem Theory Comput</source> <volume>10</volume>: <fpage>5716</fpage>–<lpage>5728</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>