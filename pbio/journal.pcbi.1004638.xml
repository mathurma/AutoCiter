<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00107</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004638</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Synaptic plasticity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Developmental neuroscience</subject><subj-group><subject>Synaptic plasticity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Synapses</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Synapses</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neuronal plasticity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject><subj-group><subject>Dendritic structure</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Somato-dendritic Synaptic Plasticity and Error-backpropagation in Active Dendrites</article-title>
<alt-title alt-title-type="running-head">Learning with Active Dendrites</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Schiess</surname> <given-names>Mathieu</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Urbanczik</surname> <given-names>Robert</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Senn</surname> <given-names>Walter</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Physiology, University of Bern, Bern, Switzerland</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Center for Cognition, Learning and Memory, University of Bern, Bern, Switzerland</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Gutkin</surname> <given-names>Boris S.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>École Normale Supérieure, College de France, CNRS, FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: MS RU WS. Performed the experiments: MS. Analyzed the data: MS RU WS. Contributed reagents/materials/analysis tools: MS RU WS. Wrote the paper: MS WS.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">mathieu.schiess@hesge.ch</email> (MS); <email xlink:type="simple">urbanczik@pyl.unibe.ch</email> (RU); <email xlink:type="simple">senn@pyl.unibe.ch</email> (WS)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>3</day>
<month>2</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>2</issue>
<elocation-id>e1004638</elocation-id>
<history>
<date date-type="received">
<day>27</day>
<month>1</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>26</day>
<month>10</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Schiess et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004638"/>
<abstract>
<p>In the last decade dendrites of cortical neurons have been shown to nonlinearly combine synaptic inputs by evoking local dendritic spikes. It has been suggested that these nonlinearities raise the computational power of a single neuron, making it comparable to a 2-layer network of point neurons. But how these nonlinearities can be incorporated into the synaptic plasticity to optimally support learning remains unclear. We present a theoretically derived synaptic plasticity rule for supervised and reinforcement learning that depends on the timing of the presynaptic, the dendritic and the postsynaptic spikes. For supervised learning, the rule can be seen as a biological version of the classical error-backpropagation algorithm applied to the dendritic case. When modulated by a delayed reward signal, the same plasticity is shown to maximize the expected reward in reinforcement learning for various coding scenarios. Our framework makes specific experimental predictions and highlights the unique advantage of active dendrites for implementing powerful synaptic plasticity rules that have access to downstream information via backpropagation of action potentials.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Error-backpropagation is a successful algorithm for supervised learning in neural networks. Whether and how this technical algorithm is implemented in cortical structures, however, remains elusive. Here we show that this algorithm may be implemented within a single neuron equipped with nonlinear dendritic processing. An error expressed as mismatch between somatic firing and membrane potential may be backpropagated to the active dendritic branches where it modulates synaptic plasticity. This changes the classical view that learning in the brain is realized by rewiring simple processing units as formalized by the neural network theory. Instead, these processing units can themselves learn to implement much more complex input-output functions as previously thought. While the original algorithm only considered firing rates, the biological implementation enables learning for both a firing rate and a spike-timing code. Moreover, when modulated by a reward signal, the synaptic plasticity rule maximizes the expected reward in a reinforcement learning framework.</p>
</abstract>
<funding-group>
<funding-statement>The work was supported by the Swiss National Science Foundation (personal grant of WS, 31003A_133094 and 310030L_156863) and the Human Brain Project funded by the European Research Council. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="0"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>One of the fascinating and still enigmatic aspects of cortical organization is the widespread dendritic arborization of neurons. These dendrites have been shown to generate dendritic spikes [<xref ref-type="bibr" rid="pcbi.1004638.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004638.ref003">3</xref>] that support local dendritic processing [<xref ref-type="bibr" rid="pcbi.1004638.ref004">4</xref>–<xref ref-type="bibr" rid="pcbi.1004638.ref007">7</xref>], but the nature of this computation remains elusive. An interesting view is that the dendritic nonlinearities endow the neuron with the structure of a 2-layer neural network of point neurons, in particular if the dendrites show themselves step-like dendritic spikes, but also if the dendritic nonlinearities remain continuous [<xref ref-type="bibr" rid="pcbi.1004638.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1004638.ref011">11</xref>]. Here we show that the dendritic morphology actually offers a substantial additional benefit over the 2-layer network. This is because it allows for the implementation of powerful learning algorithms that rely on the backpropagation of the somatic information along the dendrite that, in a network of point neurons, would not be possible in this form.</p>
<p>Error-backpropagation has become the classical algorithm for adapting the connection strengths in artificial neural networks [<xref ref-type="bibr" rid="pcbi.1004638.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004638.ref013">13</xref>]. In this algorithm, an error at an output unit is assessed by comparing the self-generated activity with a target activity. Plasticity in hidden units is driven by this error that propagates backwards along the connections of the network. Synapses, however, transmit information just in one direction, making it difficult to implement error-backpropagation in biological neuronal circuitries. But this is different for dendritic trees. In the 2-layer structure of a dendritic tree information at the output site may be physically backpropagated across the intermediate computational layer to the synapses targeting the tree.</p>
<p>While the suggested dendritic error-backpropagation is a plasticity rule for supervised learning, it is also suitable for reinforcement learning. Instead of imposing the somatic spiking to learn pre-assigned target spike timings, the somatic spikes can be generated by the dendritic inputs alone, while learning is driven by a delayed reward signal. The synapse itself can be agnostic about the coding and the learning scenario; it learns by continuously adapting synaptic strength according to molecular mechanisms that are identical in the different scenarios.</p>
<p>Various experimental work revealed that synaptic plasticity depends on the precise timing between pre- and postsynaptic action potentials [<xref ref-type="bibr" rid="pcbi.1004638.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1004638.ref015">15</xref>] and the postsynaptic voltage [<xref ref-type="bibr" rid="pcbi.1004638.ref016">16</xref>]. It has further been shown that the specific form of this spike-timing-dependent plasticity (STDP) may vary with the synaptic location on the dendritic tree [<xref ref-type="bibr" rid="pcbi.1004638.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1004638.ref019">19</xref>], and that synaptic plasticity in general is modulated by dendritic spikes [<xref ref-type="bibr" rid="pcbi.1004638.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1004638.ref022">22</xref>]. Yet, no coherent view on the impact of dendritic nonlinearities on plasticity has emerged. Correspondingly, beside an early attempt to assign a fitness score to dendritic synapses [<xref ref-type="bibr" rid="pcbi.1004638.ref023">23</xref>] and the suggestion of a Hebbian-type plasticity rule for synapses on active dendrites [<xref ref-type="bibr" rid="pcbi.1004638.ref024">24</xref>], no computational framework for synaptic plasticity with regenerative dendritic events exists that would guide its experimental exploration. In our previous study, we derived a reward-maximizing plasticity rule that incorporates dendritic spikes, but no online implementation was presented [<xref ref-type="bibr" rid="pcbi.1004638.ref025">25</xref>]. Here, starting from biophysical properties of NMDA conductances [<xref ref-type="bibr" rid="pcbi.1004638.ref026">26</xref>], we consider an integrated somato-dendritic spiking model that captures the main biological ingredients of dendritic spikes and that is simple enough to derive an online plasticity rule for different coding schemes in the context of both supervised and reinforcement learning.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Neuron model</title>
<p>We model a multi-compartment neuron with several active dendritic branches, each directly linked to a somatic compartment (<xref ref-type="fig" rid="pcbi.1004638.g001">Fig 1A1</xref>). The subthreshold dendritic voltage in branch <italic>d</italic> is the weighted sum of normalized postsynaptic potentials (PSPs) triggered by the presynaptic spikes in the afferents projecting to that branch, <inline-formula id="pcbi.1004638.e001"><alternatives><graphic id="pcbi.1004638.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.166667em"/><mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here, <italic>w</italic><sub><italic>di</italic></sub> represents the synaptic strength of the synapse from afferent <italic>i</italic> onto branch <italic>d</italic> that scales the PSP amplitude. The dendritic branches can generate temporally extended NMDA-spikes of a fixed amplitude, similar to experimental observations <italic>in vitro</italic> [<xref ref-type="bibr" rid="pcbi.1004638.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004638.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1004638.ref005">5</xref>] and <italic>in vivo</italic> [<xref ref-type="bibr" rid="pcbi.1004638.ref007">7</xref>]. In our model an NMDA-spike is represented by a square voltage pulse of amplitude <italic>a</italic> and duration Δ = 50 ms (<xref ref-type="fig" rid="pcbi.1004638.g001">Fig 1A2–1A3</xref>). It is stochastically elicited with a rate that is an increasing function of the local subthreshold membrane potential <inline-formula id="pcbi.1004638.e002"><alternatives><graphic id="pcbi.1004638.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and, implicitly, of the local glutamate level. In fact, in an <italic>in vivo</italic> scenario the joint voltage and glutamate condition for triggering an NMDA-spike effectively reduces to a single condition on the local voltage alone. This is because the depolarization required to activate the NMDA receptors is only reached when enough glutamate was released, making the glutamate condition automatically satisfied at high enough voltages (see <xref ref-type="supplementary-material" rid="pcbi.1004638.s001">S1 Text</xref>).</p>
<fig id="pcbi.1004638.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004638.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Neuron model, synaptic plasticity rule and learning of spike timings.</title>
<p><bold>A</bold>: Synaptic inputs targeting dendritic NMDA activation zones (A1, red endings with enlargement) propagate, together with possible NMDA-spikes, to the somatic spike trigger zone (A1, blue). Individual postsynaptic potentials in a dendritic branch (PSPs, arriving e.g. at time <inline-formula id="pcbi.1004638.e005"><alternatives><graphic id="pcbi.1004638.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>pre</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, A2), may trigger NMDA-spikes, e.g. at time <inline-formula id="pcbi.1004638.e006"><alternatives><graphic id="pcbi.1004638.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>5</mml:mn><mml:mspace width="0.166667em"/><mml:mtext>ms</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula> (solid) or 15 ms (dashed) after <inline-formula id="pcbi.1004638.e007"><alternatives><graphic id="pcbi.1004638.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>pre</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, forming a local dendritic plateau potential of 50 ms duration (A3). A somatic spike triggered at <italic>t</italic><sup>s</sup> during the ongoing NMDA-spike (A4) causes a synaptic weight change <inline-formula id="pcbi.1004638.e008"><alternatives><graphic id="pcbi.1004638.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> that is large/small depending on whether the NMDA-spike was triggered 5/15 ms after the presynaptic spike (A5, solid/dashed circle, respectively). A5: <inline-formula id="pcbi.1004638.e009"><alternatives><graphic id="pcbi.1004638.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> as a function of <inline-formula id="pcbi.1004638.e010"><alternatives><graphic id="pcbi.1004638.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msup><mml:mi>t</mml:mi> <mml:mi>s</mml:mi></mml:msup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>pre</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for a NMDA-spike at 5 (solid) and 15 ms (dashed). <bold>B</bold>: Raster plots of freely generated somatic spikes from test trials that are interleaved with learning trials. For the full somato-dendritic synaptic plasticity rule (sdSP) the somatic spikes converge to the 3 target times with a precision of ±3 ms (top), while the rule neglecting the dendritic spikes (i.e. suppressing the term <inline-formula id="pcbi.1004638.e011"><alternatives><graphic id="pcbi.1004638.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>) achieves a precision of only ±14 ms (bottom). <bold>C</bold>: The two spike distributions from C after 3000 presentations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004638.g001" xlink:type="simple"/>
</fig>
<p>The subthreshold dendritic voltage <inline-formula id="pcbi.1004638.e003"><alternatives><graphic id="pcbi.1004638.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and the dendritic spike train NMDA<sub><italic>d</italic></sub>(<italic>t</italic>) in branch <italic>d</italic> propagate with some attenuation factor <italic>α</italic> to the soma where they add up with inputs from other branches to form the somatic voltage <inline-formula id="pcbi.1004638.e004"><alternatives><graphic id="pcbi.1004638.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msup><mml:mi>u</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>d</mml:mi></mml:msub> <mml:mi>α</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mtext>NMDA</mml:mtext> <mml:mi>d</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mi>κ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. This voltage is also modulated by a spike reset kernel <italic>κ</italic>(<italic>t</italic>) incorporating the transient hyperpolarisation caused by each somatic spike (<xref ref-type="fig" rid="pcbi.1004638.g001">Fig 1A4</xref>). For supervised learning, the somatic spikes <italic>S</italic>(<italic>t</italic>) are imposed by an external input, whereas in reinforcement learning they are stochastically triggered with an instantaneous rate <italic>ρ</italic><sup>s</sup>(<italic>t</italic>) that is an increasing function of the somatic potential <italic>u</italic><sup>s</sup> (Online Methods).</p>
</sec>
<sec id="sec004">
<title>Learning rule</title>
<p>We first consider a supervised learning scenario where somatic spikes <italic>S</italic> are enforced by one modality (e.g. a visual stimulus) while the synaptic inputs to the dendritic branches are caused by another modality (e.g. representing an auditory stimulus [<xref ref-type="bibr" rid="pcbi.1004638.ref027">27</xref>]). The strengths of the synapses on the dendrites, <italic>w</italic><sub><italic>di</italic></sub>, are adapted in order to reproduce the somatic spike train <italic>S</italic>(<italic>t</italic>) from just the dendritic input alone, without direct somatic drive. This can be achieved by ongoing synaptic weight changes, <inline-formula id="pcbi.1004638.e012"><alternatives><graphic id="pcbi.1004638.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, that together maximize the likelihood of observing <italic>S</italic> in response to this dendritic input. According to the two types of contributions to the somatic voltage, the sub- and supra-threshold dendritic voltages, <inline-formula id="pcbi.1004638.e013"><alternatives><graphic id="pcbi.1004638.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and NMDA<sub><italic>d</italic></sub>, the synaptic weight change can also be decomposed into a sub- and suprathreshold contribution, <inline-formula id="pcbi.1004638.e014"><alternatives><graphic id="pcbi.1004638.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>ss</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, that take into account the subthreshold somato-synaptic (ss) and the suprathreshold somato-dendro-synaptic (sds) drive. We also refer to <inline-formula id="pcbi.1004638.e015"><alternatives><graphic id="pcbi.1004638.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> as somato-dendritic synaptic plasticity (sdSP).</p>
<p>The somato-synaptic contribution is proportional to the postsynaptic error term (<italic>S</italic> − <italic>ρ</italic><sup>s</sup>) times the local postsynaptic potential PSP<sub><italic>i</italic></sub> induced by synapse <italic>i</italic> on that dendritic branch,
<disp-formula id="pcbi.1004638.e016"><alternatives><graphic id="pcbi.1004638.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>ss</mml:mtext></mml:msubsup> <mml:mo>∝</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>ρ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>This corresponds to the gradient learning rule that was previously derived for a single compartment neuron [<xref ref-type="bibr" rid="pcbi.1004638.ref028">28</xref>] and that was shown to be consistent with the experimentally observed STDP (see e.g. [<xref ref-type="bibr" rid="pcbi.1004638.ref029">29</xref>]). The error term in the rule ensures that if the rate <italic>ρ</italic><sup>s</sup> is too small for generating <italic>S</italic>, the weight is increased, and if the rate is too high, the weight is decreased, eventually leading in average to 〈<italic>S</italic>〉 = <italic>ρ</italic><sup>s</sup>.</p>
<p>The main sdSP-effect stems from the somato-dendro-synaptic contribution <inline-formula id="pcbi.1004638.e017"><alternatives><graphic id="pcbi.1004638.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>. The instantaneous synaptic weight change at time <italic>t</italic> is induced by the dendritic activity Den<sub><italic>d</italic></sub> in branch <italic>d</italic> during the interval Δ prior to <italic>t</italic>. Any NMDA-spike elicited in this interval will affect the somatic voltage at time <italic>t</italic>, and the likelihood of a dendritic spike is itself influenced by the local synaptic potentials PSP<sub><italic>i</italic></sub> arriving in this interval and a few milliseconds before (<xref ref-type="fig" rid="pcbi.1004638.g001">Fig 1A2–1A5</xref>). Overall, we obtain an expression of the form
<disp-formula id="pcbi.1004638.e018"><alternatives><graphic id="pcbi.1004638.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup> <mml:mo>∝</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∖</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mi mathvariant="normal">s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mtext>Den</mml:mtext> <mml:mi>d</mml:mi></mml:msub> <mml:mspace width="-0.166667em"/><mml:mo>∗</mml:mo> <mml:mspace width="-0.166667em"/><mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="0.222222em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where Den<sub><italic>d</italic></sub> ∗ PSP<sub><italic>i</italic></sub> captures the impact of synapse <italic>i</italic> on the triggering of an NMDA-spike in the preceding interval Δ, and <inline-formula id="pcbi.1004638.e019"><alternatives><graphic id="pcbi.1004638.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∖</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mi mathvariant="normal">s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> represents the instantaneous somatic firing rate in the absence of a dendritic spike in branch <italic>d</italic> (see Online Methods). A positive error term <inline-formula id="pcbi.1004638.e020"><alternatives><graphic id="pcbi.1004638.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∖</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mi mathvariant="normal">s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> tells the synapses on branch <italic>d</italic> how worth it is to increase their weights in order to trigger a local NMDA-spike; a negative error term suggests to rather decrease the weights since even without NMDA-spike from that branch the somatic firing rate, in average, is too high. When only dendritic nonlinearities without spiking are present, the rule <xref ref-type="disp-formula" rid="pcbi.1004638.e018">Eq (2)</xref> simplifies to a pure 3-factor rule composed of a somatic difference factor, a dendritic factor, and a presynaptic factor that can be applied to dendrites showing supra- or sublinear dendritic summations (see <xref ref-type="disp-formula" rid="pcbi.1004638.e056">Eq (9)</xref> in Online Methods).</p>
<p>The learning rule of <xref ref-type="disp-formula" rid="pcbi.1004638.e018">Eq (2)</xref> can be interpreted as error-backpropagation for spiking neurons where a somatic error signal is propagated back to the dendrites that represent the nonlinear hidden units. These hidden units further modulate the error signal depending on their impact on the output unit. Classical error-backpropagation would also adapt the weights from the hidden units to the output unit. This would correspond to adapting the impact of NMDA spikes on the somatic voltage and could be modeled as dendritic branch strength plasticity [<xref ref-type="bibr" rid="pcbi.1004638.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004638.ref030">30</xref>]. For conceptual clarity we discard from this extension, but the gradient calculations could also be applied to infer an optimal learning rule for these branch strengths.</p>
</sec>
<sec id="sec005">
<title>Supervised learning with active dendrites</title>
<p>The overall synaptic modification, <italic>Δw</italic><sub><italic>di</italic></sub>, induced by sdSP is obtained by integrating the instantaneous changes <inline-formula id="pcbi.1004638.e021"><alternatives><graphic id="pcbi.1004638.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> over the stimulus duration, <inline-formula id="pcbi.1004638.e022"><alternatives><graphic id="pcbi.1004638.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Using the decomposition <inline-formula id="pcbi.1004638.e023"><alternatives><graphic id="pcbi.1004638.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>ss</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> we may also write <inline-formula id="pcbi.1004638.e024"><alternatives><graphic id="pcbi.1004638.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>ss</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and have a closer look to the somato-dendro-synaptic contribution <inline-formula id="pcbi.1004638.e025"><alternatives><graphic id="pcbi.1004638.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1004638.g001">Fig 1A2–1A5</xref>). We fixed a presynaptic spike at time <inline-formula id="pcbi.1004638.e026"><alternatives><graphic id="pcbi.1004638.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>pre</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and plotted <inline-formula id="pcbi.1004638.e027"><alternatives><graphic id="pcbi.1004638.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> as a function of the somatic spike time <italic>t</italic><sup>s</sup> for the case of a NMDA-spike at <italic>t</italic><sup><italic>d</italic></sup> = 5 ms and 15 ms. The dendritic spike immediately after a presynaptic spike considerably extends the classical time window for causal ‘pre-post’ potentiation to a ‘pre-dend-post’ potentiation. In fact, a presynaptic spike that was taking part in triggering a NMDA-spike may indirectly contribute also to a postsynaptic spike more than 50 ms later. In turn, synaptic depression is induced in an a-causal configuration where the somatic spike comes either before the presynaptic spike or after the NMDA-spike has already decayed.</p>
<p>Endowed with sdSP a neuron is able to learn precise output spike-timings as shown in <xref ref-type="fig" rid="pcbi.1004638.g001">Fig 1B and 1C</xref>; blue) where 3 somatic spike times were imposed during the learning. The dendritic input consisted of 100 frozen presynaptic Poisson spike trains with frequency 6Hz and duration <italic>T</italic> = 500 ms. The dendritic tree had 20 branches, each being targeted by a random subset of the 100 afferents with a connection probability of 0.5. After repeated pattern presentations with somatic output clamped to the target spikes, the neuron learned to generate the target output from the synaptic input alone with a precision of a few milliseconds. The high spike-time precision is lost when synapses are modified only by the somato-synaptic contribution <inline-formula id="pcbi.1004638.e028"><alternatives><graphic id="pcbi.1004638.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>ss</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1004638.g001">Fig 1B and 1C</xref>; pink). Because this plasticity contribution is blind to dendritic activity, small synaptic weight changes may cause undesired appearance or disappearance of NMDA-spikes. In this case dendritic spikes arise as unpredicted knock-on effects of synaptic plasticity. Note that the somato-synaptic contribution alone, being identical to the gradient rule [<xref ref-type="bibr" rid="pcbi.1004638.ref028">28</xref>], would be able to learn the precise spiking (as would also the rules in [<xref ref-type="bibr" rid="pcbi.1004638.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1004638.ref031">31</xref>]) if the neuron were note endowed with the dendritic spiking mechanism and instead would only show linear summation with passive voltage propagation.</p>
</sec>
<sec id="sec006">
<title>Reward-modulated somato-dendritic plasticity</title>
<p>We next considered a reinforcement learning scenario where synaptic modifications are modulated by a binary feedback signal <italic>R</italic> = ±1 that is applied at the end of the stimulus presentation and that assesses the appropriateness of the somatic firing pattern. While this feedback is itself an external quantity, it is assumed to induce an internal signal, e.g. in the form of a neuromodulator, that globally modulates the previously induced synaptic changes. To control the balance between reward and punishment, the internal feedback modulates the past plasticity induction by a factor (<italic>R</italic> − <italic>R</italic><sub>∘</sub>) with a constant reward bias <italic>R</italic><sub>∘</sub>.</p>
<p>When deriving a plasticity rule that maximizes the expected reward we again obtain the same sdSP (see Eqs (<xref ref-type="disp-formula" rid="pcbi.1004638.e016">1</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004638.e018">2</xref>)), but now integrated across the stimulus interval and then modulated by the feedback signal,
<disp-formula id="pcbi.1004638.e031"><alternatives><graphic id="pcbi.1004638.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>∝</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mo>∘</mml:mo></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>ss</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
see <xref ref-type="supplementary-material" rid="pcbi.1004638.s001">S1C Text</xref>. We refer to this rule as reward-modulated somato-dendritic synaptic plasticity (R-sdSP). Due to the term <inline-formula id="pcbi.1004638.e032"><alternatives><graphic id="pcbi.1004638.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> it is effectively a 4-factor rule of the form ‘<italic>Δw</italic> = <italic>Rwrd⋅som⋅dend⋅pre</italic>’. The intuition is that the intrinsic neuronal stochasticities generate fluctuations in the somatic spiking that deviate from the prediction made by the dendritic input and cause an ‘error’ expressed in the somatic factor <inline-formula id="pcbi.1004638.e033"><alternatives><graphic id="pcbi.1004638.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∖</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mi mathvariant="normal">s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> of the rule. These fluctuations will be reinforced or suppressed by the feedback signal. As before, the synaptic modification will be strengthened if a presynaptic spike contributed to a dendritic NMDA-spike that in turn affects the somatic voltage.</p>
</sec>
<sec id="sec007">
<title>Reinforcement learning with active dendrites</title>
<p>We tested R-sdSP for various coding schemes. First, we considered a standard binary classification of frozen Poisson spike patterns by a postsynaptic spike- / no-spike code (<xref ref-type="fig" rid="pcbi.1004638.g002">Fig 2A</xref>). Each input pattern is defined as above (6Hz in 100 afferents for 500 ms) and belongs to one of two classes. For one class the soma is required to fire at least one spike while for the other class it should be silent. After repeated presentations followed by a reward signal, R-sdSP perfectly learned the correct classification of 4 random patterns. In contrast, reward-modulated STDP (R-STDP, [<xref ref-type="bibr" rid="pcbi.1004638.ref032">32</xref>]) implemented in its best performing version (see Online Methods and [<xref ref-type="bibr" rid="pcbi.1004638.ref033">33</xref>]) did not (<xref ref-type="fig" rid="pcbi.1004638.g002">Fig 2B</xref>). To achieve an appropriate alignment of dendritic spikes (<xref ref-type="fig" rid="pcbi.1004638.g002">Fig 2C and 2D</xref>), any successful learning rule needs to take account of the causal chain linking presynaptic spikes to dendritic and somatic spikes, the latter deciding upon reward or punishment. R-sdSP derived from maximizing the expected reward captures this causal relationship, but R-STDP does not, neither with a 10 ms (<xref ref-type="fig" rid="pcbi.1004638.g002">Fig 2B</xref>) nor with a 50 ms learning window (<xref ref-type="supplementary-material" rid="pcbi.1004638.s003">S2 Fig</xref>), and hence fails. Interestingly, R-STDP improves when the NMDA-spike generation is suppressed (<xref ref-type="fig" rid="pcbi.1004638.g002">Fig 2B</xref>, dashed). This shows that the increased flexibility in neuronal information processing provided by dendritic nonlinearities will in fact impede learning when a rule is used that does not take the nonlinearities into account.</p>
<fig id="pcbi.1004638.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004638.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Binary classification of frozen input spike patterns by a somatic spike / no-spike code for the reward-modulated somato-dendritic synaptic plasticity (R-sdSP).</title>
<p><bold>A</bold>: Four input patterns, the two patterns in the top row should elicit no somatic spikes; the patterns in the bottom row should. <bold>B</bold>: R-sdSP perfectly learns the classification after roughly 1000 presentations (blue solid). In contrast, classical R-STDP fails when applied to the presynaptic–somatic (‘pre-som’, solid black) or the presynaptic–dendritic (‘pre-den’, gray) spike pairs. R-STDP improves when the dendritic spike generation is suppressed (black dashed), although it does not reach the high performance of R-sdSP. <bold>C,D</bold>: Dendritic and somatic voltages in response to an input pattern that requires spiking, before (<bold>C</bold>) and after (<bold>D</bold>) learning. The initially sparse dendritic spikes (NMDA<sub><italic>d</italic></sub>(<italic>t</italic>), red bars, overlaid on a <inline-formula id="pcbi.1004638.e029"><alternatives><graphic id="pcbi.1004638.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> intensity plot) become more numerous, co-align and sum up in the soma to enable the somatic firing. Yellow indicates depolarization. Bottom: Time course of the somatic voltage <italic>u</italic><sup>s</sup>(<italic>t</italic>) (blue) with the contribution of the NMDA-spikes and the somatic spike reset kernel (red).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004638.g002" xlink:type="simple"/>
</fig>
<p>R-sdSP is still able to correctly learn the classification even when the spike timings were noisy with a jitter up to 100 ms, or when the somatic voltage modulating the synaptic plasticity (via <italic>ρ</italic><sup>s</sup> and <inline-formula id="pcbi.1004638.e034"><alternatives><graphic id="pcbi.1004638.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∖</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mi mathvariant="normal">s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>) was low-pass filtered to mimic the dilution of information back-propagating to the synaptic site (<xref ref-type="supplementary-material" rid="pcbi.1004638.s003">S2 Fig</xref>).</p>
<p>Incidentally, the same task from <xref ref-type="fig" rid="pcbi.1004638.g002">Fig 2</xref> can also be solved in a supervised scenario e.g. with the tempotron where, beside telling a neuron whether it should spike or not spike in response to a stimulus, the neuron is supposed to have access to the time of the voltage maximum within the stimulus interval [0, T], see e.g. [<xref ref-type="bibr" rid="pcbi.1004638.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1004638.ref035">35</xref>]. Although with these additional assumptions learning in principle becomes faster, the rules will again suffer from the ignorance about NMDA spikes and the possible acausality between a presynaptic spike and an immediately following somatic spike.</p>
</sec>
<sec id="sec008">
<title>Learning direction selectivity and nonlinear separation</title>
<p>To apply the dendritic learning to a biological example we consider the direction selectivity of pyramidal neurons that was found to be mediated by nonlinear dendritic processing <italic>in vitro</italic> [<xref ref-type="bibr" rid="pcbi.1004638.ref005">5</xref>] and <italic>in vivo</italic> [<xref ref-type="bibr" rid="pcbi.1004638.ref007">7</xref>]. To mimick directional inputs moving in the stimulus space from right to left and left to right, we randomly enumerated the synapses across the whole dendritic tree and stochastically activated these synapses once in increasing and once in decreasing order (<xref ref-type="fig" rid="pcbi.1004638.g003">Fig 3A</xref>). After the stimulation, a positive reward signal was applied to the synapses when at least one somatic spike was elicited during the left-to-right patterns, or no somatic spike was elicited during a right-to-left pattern. A negative reward signal was applied in the other cases. R-sdSP, but not R-STDP, could learn such direction selectivity (<xref ref-type="fig" rid="pcbi.1004638.g003">Fig 3B</xref>). Individual dendritic branches may become selective to the synaptic activation order and learn to generate NMDA-spikes that, after summation in the soma, eventually trigger somatic action potentials (<xref ref-type="fig" rid="pcbi.1004638.g003">Fig 3C and 3D</xref>). Hence, the neuron learned to employ the dendritic nonlinearities to achieve direction selectivity, even though solving the task does not require them.</p>
<fig id="pcbi.1004638.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004638.g003</object-id>
<label>Fig 3</label>
<caption>
<title>R-sdSP can exploit the representational power endowed by active dendrites.</title>
<p><bold>A</bold>: Example of presynaptic firing pattern that requires the neuron to be silent (green) or to elicit at least one somatic spike (red). <bold>B</bold>: R-sdSP (blue), but not R-STDP, learns to become direction selective (black: ‘pre-som’; grey: ‘pre-den’). <bold>C, D</bold>: The subthreshold dendritic voltages <inline-formula id="pcbi.1004638.e030"><alternatives><graphic id="pcbi.1004638.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and NMDA traces NMDA<sub><italic>d</italic></sub>(<italic>t</italic>) in response to the two input patterns shown in A (color code as in <xref ref-type="fig" rid="pcbi.1004638.g002">Fig 2</xref>). Individual branches developed direction selectivity (green). Bottom: action potentials are only generated for one direction. <bold>E</bold>: The 4 input patterns of the linearly non-separable feature-binding problem combine one of two shapes (‘circle’ or ‘diamond’) with one of two fill colors (‘blue’ or ‘black’). Each of the four features is represented by 25 afferents (next to the corresponding symbol on the y-axes) that encode its presence or absence by a high (40Hz) or low (5Hz) Poisson firing rate, respectively. <bold>F</bold>: R-sdSP learns the correct response to the 4 inputs, R-STDP does not (line code as above). Inset: average performance of each run after learning.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004638.g003" xlink:type="simple"/>
</fig>
<p>A classical task that exceeds the representational power of a point neuron is the XOR (exclusive-or) problem that is equivalent to the linearly non-separating feature binding problem [<xref ref-type="bibr" rid="pcbi.1004638.ref024">24</xref>]. In this task, the neuron has to respond exclusively to two disjoint pairs of features (e.g. to black &amp; circle and to blue &amp; diamond), but not to the cross combinations of these features (black &amp; diamond and blue &amp; circle). The presence and absence of a feature was encoded in a high and low Poisson firing rate, respectively, of a subpopulation of afferents projecting to our classifying neuron (<xref ref-type="fig" rid="pcbi.1004638.g003">Fig 3E</xref>). R-sdSP on the active dendrites could learn the correct responses, although due to the intrinsic stochasticity failures occurred in some cases. Classical R-STDP failed also in solving the feature binding problem problem on the dendritic tree, whether applied to <italic>pre-dend</italic> or to <italic>pre-som</italic> spike pairings (<xref ref-type="fig" rid="pcbi.1004638.g003">Fig 3F</xref>).</p>
</sec>
<sec id="sec009">
<title>Learning spike timings with delayed reward</title>
<p>Besides learning a spike / no-spike code or a firing rate code, R-sdSP can also learn a spike timing code, i.e. to fire only at specific times. In a first task showing this, the neuron had to learn to spike at a target time <italic>t</italic><sup>targ</sup> = 250 ms in response to a frozen Poisson spike pattern. Deviations from this time were punished at the stimulus ending, using a graded feedback signal that increases with the magnitude of the deviation (Online Methods). During repeated pattern presentations, while applying R-sdSP and the delayed punishing signal, the postsynaptic spiking becomes concentrated in a narrow time window around the target spike (<xref ref-type="fig" rid="pcbi.1004638.g004">Fig 4A–4C</xref>). To understand the role of the active dendrites we separated the time course of the somatic voltage into the contribution from the subthreshold dendritic potentials and the NMDA-spikes (<xref ref-type="fig" rid="pcbi.1004638.g004">Fig 4D and 4E</xref>). After successful learning, the averaged NMDA-spikes form a broad ridge around <italic>t</italic><sup>targ</sup> on top of which the subthreshold dendritic voltages act as ‘scorers’. Before and immediately after <italic>t</italic><sup>targ</sup> the subthreshold voltage is hyperpolarized to prevent somatic spikes from coming too early or too late. Notice that in an individual run the summed NMDA-spikes can form plateaus that are much shorter than the NMDA-spike duration of 50 ms. In the example shown, this arises because just 5 ms after the initiation of an NMDA-spike in one branch another NMDA-spike ends in a second branch, cutting the somatic plateau short to 5 ms (<xref ref-type="fig" rid="pcbi.1004638.g004">Fig 4D</xref>). By virtue of the backpropagated somatic activity, R-sdSP learns to coordinate the timing of the NMDA-spikes in the different branches, creating a narrow window for a somatic spike around the target time.</p>
<fig id="pcbi.1004638.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004638.g004</object-id>
<label>Fig 4</label>
<caption>
<title>R-sdSP learns exact somatic spike timing.</title>
<p><bold>A</bold>: Somatic spike trains during 20000 trials in a reward based scenario. <bold>B</bold>: The distribution of somatic spikes after learning of the target time at 250 ms has a Gaussian half-width of 18 ms. <bold>C</bold>: Evolution of the width (<italic>σ</italic>) of the spike-time distribution during training. <bold>D,E</bold>: Separation of the somatic voltage into a contribution from the NMDA-spikes (red) and the subthreshold dendritic potentials (blue) for a single run (D) and averaged across 20 runs (E). Note that after learning the summed NMDA-spikes can form a narrow depolarizations at the target time beyond the duration of an individual spike (arrow in D).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004638.g004" xlink:type="simple"/>
</fig>
<p>Learning a spike-timing code is also possible if the rewarding / punishing signal is binary and is potentially delayed by several stimulus durations. We conceived a spatial navigation task where 7 positions on a circle are encoded each by a frozen 500 ms spike pattern in 100 afferents projecting to the dendritic branches of the model neuron as before. The task is to jump to position 0 when being in one of the other 6 positions and, after reaching position 0, staying there (<xref ref-type="fig" rid="pcbi.1004638.g005">Fig 5A</xref>). Actions consisted in either no jump or jumps of 1, 2 or 3 steps clock or counter clockwise. No jump is encoded by no somatic spikes, and a jump of <italic>n</italic> steps in the clock or counterclockwise direction is encoded by the first somatic spike arising in the <italic>n</italic>’th time bin to the left or right from the center (<xref ref-type="fig" rid="pcbi.1004638.g005">Fig 5A</xref>, inset). A positive reward signal <italic>R</italic> = 1 is delivered when the agent, being in a non-target position, directly jumps to the target, or when it is at the target position and stays there; else <italic>R</italic> = −1. After an initial average of 20 random actions needed to reach the target position, the R-sdSP modulated agents learned to eventually reach the target with a single action and stay there (<xref ref-type="fig" rid="pcbi.1004638.g005">Fig 5B and 5C</xref>). While initially the first somatic spike times of our model neuron were uniformly distributed across the 500 ms stimulus interval, the neuron eventually learned to respond in the appropriate time bin of 83 ms duration that encoded the correct jumps (<xref ref-type="fig" rid="pcbi.1004638.g005">Fig 5D</xref>). During learning, the dendritic branches develop a shared selectivity for the patterns and until the first NMDA-spikes become properly aligned in the correct time bin (<xref ref-type="fig" rid="pcbi.1004638.g005">Fig 5E</xref>).</p>
<fig id="pcbi.1004638.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004638.g005</object-id>
<label>Fig 5</label>
<caption>
<title>R-sdSP learns the correct spike-timing in a navigational task with binary and delayed feedback.</title>
<p><bold>A</bold>: At each position a fixed spike pattern is presented, and the timing of the first somatic spike tells how many steps in the clock (−) or counter clock (+) direction are taken. Color code of the time bin indicates the preferred spike timing for directly jumping to target position 0 when being at the correspondingly colored circle position (see text). <bold>B</bold>: Evolution of the mean number of jumps needed from a randomly chosen circle position until 0 is reached. <bold>C</bold>: Performance Index defined as the probability of directly jumping from any of the 6 circle positions to the target, and staying there if already at 0. Before learning this probability is 0.13, after learning it is 0.78. <bold>D</bold>: Histogram of first somatic spikes at the various positions before and after learning, averaged across patterns and learning runs (color code as in A). (<bold>E</bold>) Timing of the first NMDA spike in each of the 20 branches (upper panel) and the first somatic spike (lower panel) when stimulated with the patterns associated to the 6 circle positions (colors encode positions as in A). After learning, NMDA-spikes in 2-4 branches co-align and trigger somatic spike timing the appropriate time bin.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004638.g005" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>We derived a synaptic plasticity rule for synapses on active dendrites that minimizes errors in the supervised and maximizes reward in the reinforcement learning scenario. More precisely, the rule follows the gradient of (a lower bound of) the log-likelihood of reproducing a given spike train for supervised learning, and the gradient of the expected reward for reinforcement learning. The rule specifies the optimal timing between the presynaptic, dendritic and somatic spikes, including the time course of the postsynaptic voltages. We showed that neurons can only exploit the increased representational power of active dendrites when synaptic plasticity is modulated by both the somatic and the dendritic spiking. The suggested somato-dendritic spike-dependent synaptic plasticity (sdSP) learns to correctly respond to synaptic input patterns coding by either frozen spikes times or firing rates, while classical STDP fails. It is remarkable that the same plasticity induction that supports the learning of precise spiking in the supervised learning scenario also maximizes the expected reward when modulated by an internal and possibly delayed reward signal, irrespective of whether the postsynaptic code is based on spike times or firing rates.</p>
<p>The neuron model for which we derived the gradient rules considered dendritic spikes as saturating square-shaped depolarizations triggered by the crossing of a dendritic voltage threshold. We showed that the dual voltage-glutamate criterion for NMDA spikes reduces in the presence of balanced excitation and inhibition to a pure voltage criterion. This is because the glutamate condition is always satisfied when reaching the voltage threshold. This leads to a dendritic spike scenario that also includes dendritic sodium [<xref ref-type="bibr" rid="pcbi.1004638.ref036">36</xref>] or calcium spikes [<xref ref-type="bibr" rid="pcbi.1004638.ref037">37</xref>] differing in their voltage threshold, duration and amplitude. In the supervised learning scenario, the general plasticity rule we derived consists of a somatic error term that measures the difference between the actual spiking and the instantaneous spike rate, a dendritic rate- and spike-term, and a presynaptic spike term. Potentiation is triggered if the presynaptic spike is followed by a postsynaptic spike within roughly 10 ms, and this time window is stretched to roughly 50 ms if between the pre- and postsynaptic spike an additional dendritic spike occurs. Plasticity, be it potentiation or depression, can also be boosted by a mere nonlinear dendritic depolarizations without dendritic spikes, linking the rule also to computational models considering nonlinear but continuous dendritic processing [<xref ref-type="bibr" rid="pcbi.1004638.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1004638.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1004638.ref024">24</xref>]. In the reinforcement learning scenario, the same plasticity rule is modulated by a global reward signal.</p>
<p>As learning is driven by a somatic error term, the synapses must be able to readout this error by disentangling the backpropagating spike and the somatic voltage (or at least a low-pass filtered version of it, see <xref ref-type="supplementary-material" rid="pcbi.1004638.s003">S2C–S2F Fig</xref>). Synapses must also read out the local dendritic spike and potential, and the synapse-specific postsynaptic potential (PSP). The PSP may be inferred from the concentration of the local glutamate released by the presynaptic bouton. The somatic and dendritic spikes may be determined from their characteristic voltage upstrokes and sustained depolarizations, and the NMDA spike can be further detected by a rapid increase in the local calcium concentration. Finally, the (subthreshold) somatic and dendritic depolarization may be distinguished by co-sensing local ion concentrations. In fact, the synaptically induced dendritic depolarization goes together with an increased local sodium concentration while the backpropagating somatic voltage does not cause such a ion influx. We assume that synapses developed a molecular machinery to extract these quantities and infer approximate estimates for the terms occuring in our plasticity rules.</p>
<p>Our computational framework for active dendrites contributes to the debate whether plasticity on dendritic branches should depend on the dendritic rather than the somatic spike [<xref ref-type="bibr" rid="pcbi.1004638.ref038">38</xref>], or whether it subserves synaptic clustering [<xref ref-type="bibr" rid="pcbi.1004638.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004638.ref039">39</xref>] or a homeostatic adaptation [<xref ref-type="bibr" rid="pcbi.1004638.ref040">40</xref>]. In fact, when seen in the light of learning, synaptic plasticity is predicted to depend on all the postsynaptic quantities. Based on the model of dendritic NMDA receptor conductances in an <italic>in vivo</italic> stimulation scenario, the learning rule yields a guideline for experimental testings. For instance, it is in line with the observed synaptic depression induced by a synaptically generated dendritic spike alone ([<xref ref-type="bibr" rid="pcbi.1004638.ref041">41</xref>], but see [<xref ref-type="bibr" rid="pcbi.1004638.ref042">42</xref>]), or with the extended time window for plasticity induction involving NMDA-spikes [<xref ref-type="bibr" rid="pcbi.1004638.ref021">21</xref>]. It predicts that an NMDA-spike within roughly 50 ms after an excitatory synaptic input always enhances the synaptic modification. While the sign of the synaptic modification is determined by the presence or absence of a somatic spike following the synaptic input, an additional synaptically evoked NMDA-spike will only enhance it, never revert this sign.</p>
<p>Dendritic structures that have been suggested to form a 2-layer network [<xref ref-type="bibr" rid="pcbi.1004638.ref008">8</xref>] offer the additional advantage of easily backpropagating the information of the output to the synaptic sites 2 layers upstream. From a computational perspective it is interesting to note that, one the one hand, 2-layer networks represent an universal function approximator [<xref ref-type="bibr" rid="pcbi.1004638.ref043">43</xref>] while, on the other hand, networks with more than two layers are difficult to be trained [<xref ref-type="bibr" rid="pcbi.1004638.ref013">13</xref>]. For the dendritic implementation this suggests to limit the internal nonlinearities to a single layer of active dendritic branches. Because stacking dendritic nonlinearities across multiple layers would cause additional cross-talk, the restriction to a single dendritic nonlinearity may just be nature’s solution to the trade-off between achieving more representational power and paying the associated signaling costs required for efficient learning.</p>
<sec id="sec011">
<title>Online Methods</title>
<sec id="sec012">
<title>Neuron parameters</title>
<p>The postsynaptic potentials are defined by <inline-formula id="pcbi.1004638.e035"><alternatives><graphic id="pcbi.1004638.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>∑</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>pre</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where the sum extends across all presynaptic spike times <inline-formula id="pcbi.1004638.e036"><alternatives><graphic id="pcbi.1004638.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>pre</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> of afferent <italic>i</italic>. The spike reset is defined by <italic>κ</italic>(<italic>t</italic>) = ∑<sub><italic>t</italic><sup>s</sup></sub> <italic>κ</italic><sub>∘</sub>(<italic>t</italic> − <italic>t</italic><sup>s</sup>), where the sum extends across all somatic spike times <italic>t</italic><sup>s</sup>. The two kernels are defined as
<disp-formula id="pcbi.1004638.e037"><alternatives><graphic id="pcbi.1004638.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Θ</mml:mo> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mi mathvariant="normal">m</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:msub><mml:mi>κ</mml:mi> <mml:mo>∘</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>Θ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi mathvariant="normal">m</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mspace width="0.277778em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
with <italic>τ</italic><sub>m</sub> = 10 ms and <italic>τ</italic><sub>s</sub> = 1.5 ms. Here, Θ(<italic>t</italic>) = 1 for <italic>t</italic> ≥ 0 and Θ(<italic>t</italic>) = 0 for <italic>t</italic> &lt; 0. The instantaneous rate for generating a NMDA-spike in dendrite <italic>d</italic> is <inline-formula id="pcbi.1004638.e038"><alternatives><graphic id="pcbi.1004638.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:msup><mml:mi>ρ</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and the instantaneous rate of generating a somatic spike is <italic>ρ</italic><sup>s</sup>(<italic>t</italic>)≡<italic>ρ</italic><sup>s</sup>(<italic>u</italic><sup>s</sup>(<italic>t</italic>)) with
<disp-formula id="pcbi.1004638.e039"><alternatives><graphic id="pcbi.1004638.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>ρ</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi mathvariant="normal">D</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi mathvariant="normal">D</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">D</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:msup><mml:mi>ρ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.277778em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>This model of NMDA-spike generation can be deduced from the biophysical properties of NMDA receptors in a roughly balanced input scenario where the glutamate level required to activate the NMDA receptors is always reached for those voltages that also relieve their magnesium block (see <xref ref-type="supplementary-material" rid="pcbi.1004638.s001">S1A Text</xref>). The choice of the saturating rate function for the NMDA generation was motivated both by stability reasons, and also because the dendritic nonlinearities are saturating [<xref ref-type="bibr" rid="pcbi.1004638.ref011">11</xref>].</p>
<p>The neuronal parameters are <italic>r</italic><sub>D</sub> = 5, <italic>β</italic><sub>D</sub> = <italic>β</italic><sub>s</sub> = 5, <italic>θ</italic><sub>s</sub> = 2 and <italic>θ</italic><sub>D</sub> = 2.4. We considered <italic>n</italic> = 20 branches and a dendritic attenuation factor <italic>α</italic> = 0.06. The probability that one out of the 100 afferents is connected to a given branch was <italic>p</italic> = 0.5. The amplitude of the dendritic NMDA-spike is <italic>a</italic> = 6, its duration Δ = 50 ms. Different NMDA-spikes in the same branch add in time but not in amplitude, yielding a dendritic plateau potential in branch <italic>d</italic> of the form NMDA<sub><italic>d</italic></sub>(<italic>t</italic>) = <italic>a</italic> if at least one NMDA-spike was triggered in the interval Δ before <italic>t</italic> and NMDA<sub><italic>d</italic></sub>(<italic>t</italic>) = 0 else. For simplicity we assumed the two parameters <italic>α</italic> and <italic>a</italic> to be identical for all branches, but they may vary across branches or even be treated as adaptable dendritic ‘coupling strengths’ that could be learned by analogous gradient rules as suggested by experimental work [<xref ref-type="bibr" rid="pcbi.1004638.ref030">30</xref>].</p>
</sec>
<sec id="sec013">
<title>The learning rule</title>
<p>To obtain an online rule that is identical in the supervised and reinforcement scenarios up to reward modulation, we consider an additional low-pass filtering of the instantaneous synaptic changes. Plasticity is then triggered when either the stimulus ends or when reward is applied. We introduce the instantaneous synaptic eligibility for somato-synaptic and the somato-dendro-synaptic contribution, respectively, by
<disp-formula id="pcbi.1004638.e040"><alternatives><graphic id="pcbi.1004638.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>ss</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>ρ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula> <disp-formula id="pcbi.1004638.e041"><alternatives><graphic id="pcbi.1004638.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∖</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mi mathvariant="normal">s</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:msub><mml:mtext>Den</mml:mtext> <mml:mi>d</mml:mi></mml:msub> <mml:mspace width="-0.166667em"/><mml:mo>∗</mml:mo> <mml:mspace width="-0.166667em"/><mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
with <italic>S</italic>(<italic>t</italic>) = ∑<sub><italic>t</italic><sup>s</sup></sub> <italic>δ</italic>(<italic>t</italic> − <italic>t</italic><sup>s</sup>) representing the somatic spike train and <inline-formula id="pcbi.1004638.e042"><alternatives><graphic id="pcbi.1004638.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∖</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> the instantaneous somatic escape rate without contribution of the putative NMDA-spike from branch <italic>d</italic> at time <italic>t</italic>,
<disp-formula id="pcbi.1004638.e043"><alternatives><graphic id="pcbi.1004638.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∖</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mi mathvariant="normal">s</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>c</mml:mi> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>ρ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msup> <mml:mo>(</mml:mo> <mml:msup><mml:mi>u</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>α</mml:mi> <mml:msub><mml:mtext>NMDA</mml:mtext> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
Here, <inline-formula id="pcbi.1004638.e044"><alternatives><graphic id="pcbi.1004638.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mi>a</mml:mi> <mml:msub><mml:mi>β</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>α</mml:mi> <mml:mi>a</mml:mi> <mml:msub><mml:mi>β</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Note that a low-pass filtered version of <italic>ρ</italic><sup>s</sup> and <inline-formula id="pcbi.1004638.e045"><alternatives><graphic id="pcbi.1004638.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:mo>∖</mml:mo> <mml:mi>d</mml:mi></mml:mrow> <mml:mi mathvariant="normal">s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> could be extracted at the synaptic site by using the local ionic concentrations to disentangle the local, synaptically generated voltage and NMDA-spike from the backpropagated somatic voltage (see also <xref ref-type="sec" rid="sec010">Discussion</xref>). The factor Den<sub><italic>d</italic></sub>∗PSP<sub><italic>i</italic></sub> expresses a modulation of the synaptic signal PSP<sub><italic>i</italic></sub> by the presence or absence of an NMDA-spike in branch <italic>d</italic> before <italic>t</italic>, i.e. within the time interval <italic>t</italic> − Δ to <italic>t</italic>. If there is such a spike, the last NMDA-spike initiation time at branch <italic>d</italic> in the interval [<italic>t</italic> − Δ, <italic>t</italic>] is denoted by <inline-formula id="pcbi.1004638.e046"><alternatives><graphic id="pcbi.1004638.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. We then set
<disp-formula id="pcbi.1004638.e047"><alternatives><graphic id="pcbi.1004638.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>Den</mml:mtext> <mml:mi>d</mml:mi></mml:msub> <mml:mo>∗</mml:mo> <mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:msup><mml:mi mathvariant="normal">d</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>t</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>within</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>NMDA-spike</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>triggered</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>at</mml:mtext> <mml:mspace width="4.pt"/><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mtext>,</mml:mtext></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:msup><mml:mi mathvariant="normal">d</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>else</mml:mtext> <mml:mspace width="0.166667em"/><mml:mtext>,</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <inline-formula id="pcbi.1004638.e048"><alternatives><graphic id="pcbi.1004638.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:msup><mml:mi mathvariant="normal">d</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>β</mml:mi> <mml:mi mathvariant="normal">D</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi mathvariant="normal">D</mml:mi></mml:msub></mml:mfrac> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi mathvariant="normal">D</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> represents the derivative of <inline-formula id="pcbi.1004638.e049"><alternatives><graphic id="pcbi.1004638.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with respect to <inline-formula id="pcbi.1004638.e050"><alternatives><graphic id="pcbi.1004638.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:mi>u</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>The upper line in <xref ref-type="disp-formula" rid="pcbi.1004638.e047">Eq (8)</xref> can be understood as a sampling version of the lower line: Let <italic>D</italic><sub><italic>d</italic></sub>(<italic>t</italic>) be the sum of delta-functions centered at the triggering times of NMDA-spikes in branch <italic>d</italic>. In the case that the NMDA-spikes in the same dendritic branch would add up, the upper line becomes <inline-formula id="pcbi.1004638.e051"><alternatives><graphic id="pcbi.1004638.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mfrac><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:msup><mml:mi mathvariant="normal">d</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and this averages out to yield the lower line. Since in our case the NMDA-spike triggerings are rare, the two versions for the upper line are roughly equal. We further approximated the integral in the lower line by <italic>ς</italic><sub><italic>di</italic></sub> defined as low-pass filtered version of the integrand, <inline-formula id="pcbi.1004638.e052"><alternatives><graphic id="pcbi.1004638.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ς</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>ς</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:mover accent="true"><mml:mo>Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:msup><mml:mi mathvariant="normal">d</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msubsup> <mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> with filtering time constant <inline-formula id="pcbi.1004638.e053"><alternatives><graphic id="pcbi.1004638.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:mover accent="true"><mml:mo>Δ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. It is also possible to define Den<sub><italic>d</italic></sub>∗PSP<sub><italic>i</italic></sub>(<italic>t</italic>) by any convex combination of the two lines in <xref ref-type="disp-formula" rid="pcbi.1004638.e047">Eq (8)</xref>, but an equal weighting of them yielded best performances in our simulations.</p>
<p>It is illustrative to deduce from the above formulas the limit when the dendritic spiking disappears and merely a dendritic nonlinearity remains. Remember that in deriving these formulas we allowed the NMDA spikes to add up, and since for biological frequences NMDA spikes rarely overlap, this assumption is justified. If NMDA spikes are still allowed to add up (although not to infinity), we may formally scale the NMDA amplitude, the NMDA duration and the NMDA rate function by a factor <italic>λ</italic> → 0, i.e. replacing <italic>a</italic> → <italic>λa</italic>, Δ → <italic>λ</italic>Δ and <inline-formula id="pcbi.1004638.e054"><alternatives><graphic id="pcbi.1004638.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>→</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>/</mml:mo> <mml:msup><mml:mi>λ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and take the limit of <italic>λ</italic> converging to 0. The time course of the dendritic spikes in branch <italic>d</italic>, NMDA<sub><italic>d</italic></sub>(<italic>t</italic>), is then replaced by the nonlinearly summed dendritic voltage <inline-formula id="pcbi.1004638.e055"><alternatives><graphic id="pcbi.1004638.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mrow><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and the somato-dendro-synaptic contribution for synapse <italic>i</italic> on branch <italic>d</italic> (Eqs (<xref ref-type="disp-formula" rid="pcbi.1004638.e018">2</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004638.e041">6</xref>), respectively) becomes the 3-factor rule
<disp-formula id="pcbi.1004638.e056"><alternatives><graphic id="pcbi.1004638.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mi>ρ</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:msup><mml:mi mathvariant="normal">d</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msub><mml:mtext>PSP</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula></p>
<p>This rule could be seen as a gradient version of the pair-based rule in [<xref ref-type="bibr" rid="pcbi.1004638.ref024">24</xref>] and applies to the dendritic nonlinearities considered in [<xref ref-type="bibr" rid="pcbi.1004638.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1004638.ref010">10</xref>]. An alternative derivation of the rule <xref ref-type="disp-formula" rid="pcbi.1004638.e056">Eq (9)</xref> is to consider the deterministic somatic voltage <inline-formula id="pcbi.1004638.e057"><alternatives><graphic id="pcbi.1004638.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:msup><mml:mi>u</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>d</mml:mi></mml:msub> <mml:mi>α</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mi>κ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and derive the learning rule as in [<xref ref-type="bibr" rid="pcbi.1004638.ref028">28</xref>] for the case of the exponential somatic spike rate <italic>ρ</italic><sup>s</sup>(<italic>u</italic><sup>s</sup>) defined in <xref ref-type="disp-formula" rid="pcbi.1004638.e039">Eq (4)</xref>. The direct gradient calculation leads to the two plasticity components in Eqs (<xref ref-type="disp-formula" rid="pcbi.1004638.e040">5</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004638.e056">9</xref>), respectively, corresponding to the linear and nonlinear summation of the dendritic potentials <inline-formula id="pcbi.1004638.e058"><alternatives><graphic id="pcbi.1004638.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msubsup><mml:mi>u</mml:mi> <mml:mi>d</mml:mi> <mml:mi mathvariant="normal">d</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
<p>Coming back to the case with dendritic spikes, the two instantaneous eligibilities for sdSP (Eqs (<xref ref-type="disp-formula" rid="pcbi.1004638.e040">5</xref>) and (<xref ref-type="disp-formula" rid="pcbi.1004638.e041">6</xref>)) are again weighted and low-pass filtered,
<disp-formula id="pcbi.1004638.e059"><alternatives><graphic id="pcbi.1004638.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>E</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi mathvariant="normal">E</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>ss</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
with <inline-formula id="pcbi.1004638.e060"><alternatives><graphic id="pcbi.1004638.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and filtering time constant <italic>τ</italic><sub>E</sub> = <italic>T</italic>/2, <italic>T</italic> = 500 ms. The supervised learning rule (sdSP) is obtained by clamping the somatic output to the target spike train and updating the weights after each stimulus by the synaptic eligibility trace at that time,
<disp-formula id="pcbi.1004638.e061"><alternatives><graphic id="pcbi.1004638.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e061" xlink:type="simple"/><mml:math display="block" id="M61"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>η</mml:mi> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
with optimized learning rate <italic>η</italic> (see below). In reinforcement learning the synaptic weights are updated at the times <italic>t</italic><sup>Rew</sup> when a reward signal is applied, i.e. when a stimulus ends (<italic>t</italic><sup>Rew</sup> = <italic>T</italic> in Figs <xref ref-type="fig" rid="pcbi.1004638.g002">2</xref>–<xref ref-type="fig" rid="pcbi.1004638.g005">5</xref>). For R-sdSP we obtain
<disp-formula id="pcbi.1004638.e062"><alternatives><graphic id="pcbi.1004638.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e062" xlink:type="simple"/><mml:math display="block" id="M62"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mtext>Rew</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>η</mml:mi> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>E</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mtext>Rew</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The reward signal <italic>R</italic> depends on the input spike pattern and somatic spike train <italic>S</italic>, and <italic>R</italic><sub>0</sub> is a baseline set to <italic>R</italic><sub>0</sub> = 1 for all simulations with R-sdSP. Setting <italic>R</italic><sub>0</sub> to a running average of the reward would speed up learning, but for simplicity we refrained from this optimization (see, however, the implementation of R-STDP in <xref ref-type="disp-formula" rid="pcbi.1004638.e067">Eq (11)</xref>, where <italic>R</italic><sub>0</sub> must even depend on the stimulus). For a derivation of the sdSP and R-sdSP as gradient of a target function see <xref ref-type="supplementary-material" rid="pcbi.1004638.s001">S1C Text</xref> and [<xref ref-type="bibr" rid="pcbi.1004638.ref025">25</xref>].</p>
</sec>
<sec id="sec014">
<title>Simulation details</title>
<p>For all tasks and learning rules we optimized the learning rate <italic>η</italic> such that the performance for the optimized value <italic>η</italic> = <italic>η</italic><sub>∘</sub> is better than for the adjacent values <italic>η</italic> = 1.5 <italic>η</italic><sub>∘</sub> and <italic>η</italic> = <italic>η</italic><sub>∘</sub>/1.5. In all the simulations involving R-sdSP we used the binary reward signal <italic>R</italic> = ±1, except for learning the very precise spike timing in <xref ref-type="fig" rid="pcbi.1004638.g004">Fig 4</xref> that required a graded reward. There, <italic>R</italic> = 1 − ∑<sub><italic>t</italic><sup>som</sup></sub> <italic>g</italic>(<italic>t</italic><sup>som</sup> − <italic>t</italic><sup>targ</sup>) with <italic>t</italic><sup>targ</sup> = 250 ms, <inline-formula id="pcbi.1004638.e063"><alternatives><graphic id="pcbi.1004638.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:mi>g</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mo>|</mml:mo> <mml:mi>δ</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and the sum extending across all somatic spike times <italic>t</italic><sup>som</sup> (setting <italic>t</italic><sup>som</sup> = 0 when no somatic spike was emitted).</p>
<p>The R-STDP plasticity rule was implemented in its best performing version found in [<xref ref-type="bibr" rid="pcbi.1004638.ref033">33</xref>]. More precisely, Frémaux et al. defined the eligibility
<disp-formula id="pcbi.1004638.e064"><alternatives><graphic id="pcbi.1004638.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e064" xlink:type="simple"/><mml:math display="block" id="M64"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>STDP</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mo>+</mml:mo></mml:msub> <mml:mspace width="0.166667em"/><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mo>+</mml:mo></mml:msub></mml:mrow></mml:msup> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mo>-</mml:mo></mml:msub> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mspace width="-0.166667em"/><mml:mspace width="-0.166667em"/><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mo>-</mml:mo></mml:msub></mml:mrow></mml:msup> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
with <inline-formula id="pcbi.1004638.e065"><alternatives><graphic id="pcbi.1004638.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>pre</mml:mtext></mml:msubsup></mml:msub> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>pre</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> being the presynaptic spike train in afferent <italic>i</italic>. They set <italic>A</italic><sub>−</sub> = 0, <italic>A</italic><sub>+</sub> = 1, and <italic>τ</italic><sub>+</sub> matched the synaptic time constant <italic>τ</italic><sub>s</sub> = 10 ms. In our case the postsynaptic signal <italic>post</italic>(<italic>s</italic>) is either the somatic spike train <italic>S</italic>(<italic>t</italic>) or the local dendritic spike train <italic>D</italic><sub><italic>d</italic></sub>(<italic>t</italic>) in branch <italic>d</italic>. As pointed out in [<xref ref-type="bibr" rid="pcbi.1004638.ref033">33</xref>], the constant baseline reward <italic>R</italic><sub>0</sub> used in gradient rules must be replaced by a running mean across pattern presentations that depends on the identity of the input pattern <italic>x</italic>, <inline-formula id="pcbi.1004638.e066"><alternatives><graphic id="pcbi.1004638.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mfrac> <mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>p</mml:mi></mml:msub></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here, the history length constant is here set to <italic>τ</italic><sub><italic>p</italic></sub> = 5. The weight update after each stimulus presentation is
<disp-formula id="pcbi.1004638.e067"><alternatives><graphic id="pcbi.1004638.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e067" xlink:type="simple"/><mml:math display="block" id="M67"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>w</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>STDP</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mtext>Rew</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>η</mml:mi> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>-</mml:mo> <mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>STDP</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mtext>Rew</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
where <inline-formula id="pcbi.1004638.e068"><alternatives><graphic id="pcbi.1004638.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:msubsup><mml:mi>E</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>STDP</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> is a low-pass version of the eligibility <inline-formula id="pcbi.1004638.e069"><alternatives><graphic id="pcbi.1004638.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:msubsup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>STDP</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> with time constant <italic>τ</italic><sub>E</sub> (see <xref ref-type="disp-formula" rid="pcbi.1004638.e059">Eq (10)</xref>).</p>
</sec>
</sec>
</sec>
<sec id="sec015">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004638.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004638.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary Information.</title>
<p><bold>A</bold>: From the biophysics to a stochastic NMDA-spike model. <bold>B</bold>: Additional analysis and simulation results. <bold>C</bold>: Mathematical derivations.<bold>D</bold>: Appendix.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004638.s002" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004638.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>For balanced synaptic inputs, the NMDA-spike probability becomes a function of the voltage alone.</title>
<p><bold>A</bold>: Top: AMPA (full line), NMDA (dashed) and GABA<sub><italic>A</italic></sub> (dotted) currents, at the peak conductance level, as a function of <italic>u</italic> defined in Eqns S1 and S2 of the Supporting Information (<italic>α</italic> = <italic>β</italic> = 0.05; excitatory currents with positive sign). Bottom: Voltage traces <italic>u</italic>(<italic>t</italic>) for 6 different synaptic drives <italic>g</italic><sub>∘</sub> = 0,25,50,75,100,125nS (curves from light to dark, Eq S3), with NMDA-spikes elicited by the 2 strongest <italic>g</italic><sub>∘</sub>. <bold>B</bold>: <italic>I</italic>(<italic>u</italic>) (‘I–V curves’) defined by the right-hand-side of Eq S4 for the 6 synaptic drives <italic>g</italic><sub>∘</sub> used in A. <bold>C</bold>: Zero crossings <italic>I</italic>(<italic>u</italic>) = 0 of the family of curves parametrized by <italic>g</italic><sub>∘</sub> and 6 of with shown in B, for different inhibitory-excitatory balancing ratios <italic>β</italic> = 0.05 (red), <italic>β</italic> = 0.10 (blue) and <italic>β</italic> = 0.15 (green); AMPA/NMDA ratio: <italic>α</italic> = 0.05. <bold>D</bold>: The 6 voltage traces <italic>u</italic>(<italic>t</italic>) from A plotted against the glutamate time course at the NMDA receptors, <italic>g</italic><sub>∘</sub> <italic>ε</italic><sup>NMDA</sup>(<italic>t</italic>), overlaid on the red zero-crossing curve shown in C. <bold>E</bold>: Whenever the Gaussian noise (red cloud) added to the mean (<italic>g</italic><sub>∘</sub>, <italic>u</italic>) on the red line (center of cloud) drops into the green area, a NMDA-spike is elicited. <bold>F</bold>: The probability of eliciting a NMDA-spike at a given voltage (<italic>P</italic>(spike|<italic>u</italic>), top) is almost the same for the three different balancing ratios <italic>β</italic> that vary by a factor of 3; it is therefore roughly proportional to the instantaneous spike rate <italic>φ</italic>(<italic>u</italic>) ∝ <italic>P</italic>(spike|<italic>u</italic>) that is a function of <italic>u</italic> alone. Yet, because <italic>u</italic> as a function of <italic>g</italic><sub>∘</sub> saturates (C), plotting <italic>P</italic>(spike|<italic>u</italic>) versus <italic>g</italic><sub>∘</sub> may still give deviating curves (bottom).</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004638.s003" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004638.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Robustness of R-sdSP against noise and imperfect voltage readout.</title>
<p><bold>A</bold>, <bold>B</bold>: When introducing a Gaussian jitter in the spike timings of the 4 frozen 6 Hz Poisson spike patterns (A) their classification into a spike / no spike code only smoothly degrades (B). Standard deviation of spike jitter: 10 ms (blue), 20 ms (red), 50 ms (green) and 100 ms (brown). <bold>C</bold>: The classification is still learnable by R-sdSP when the somatic voltage <italic>u</italic><sup>s</sup>(<italic>t</italic>) is low pass filtered with different time constants: 5 ms (blue), 10 ms (red), 20 ms (green) and 40 ms (brown). <bold>D</bold>: The performance barely changes when only considering the somato-dendro-synaptic contribution <inline-formula id="pcbi.1004638.e070"><alternatives><graphic id="pcbi.1004638.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>sds</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> of the rule (<xref ref-type="disp-formula" rid="pcbi.1004638.e040">Eq (5)</xref> in Online Methods, blue dashed). On the other hand, when learning is only based on the somo-synaptic contribution (<inline-formula id="pcbi.1004638.e071"><alternatives><graphic id="pcbi.1004638.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004638.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:msubsup><mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mtext>ss</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, <xref ref-type="disp-formula" rid="pcbi.1004638.e039">Eq (4)</xref> in Online Methods) the performance degrades (magenta). Inset: performances over the first 1000 presentations. <bold>E</bold>, <bold>F</bold>: Learning curves for R-STDP when the time constant <italic>τ</italic><sub>+</sub> matches the NMDA-spike duration Δ = 50 ms. <bold>E</bold>: Still, R-STDP cannot learn a binary classification of 4 randomized spatio-temporal spike patterns, both when applied to the presynaptic–somatic spikes (solid black; dashed: performance when the NMDA-spikes are suppressed) or the presynaptic–dendritic spikes (gray). <bold>F</bold>: Similarly, R-STDP is not able to learn the XOR-problem (curve legend as in E). Inset: average performance after each of the 20 runs.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank J.P. Pfister for discussions and feedback to an earlier version of the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004638.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Major</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Koester</surname> <given-names>H.J</given-names></name>, and <name name-style="western"><surname>Schiller</surname> <given-names>Y</given-names></name>. <article-title>NMDA spikes in basal dendrites of cortical pyramidal neurons</article-title>. <source><italic>Nature</italic></source>, <volume>404</volume>(<issue>6775</issue>):<fpage>285</fpage>–<lpage>289</lpage>, <year>2000</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35005094" xlink:type="simple">10.1038/35005094</ext-link></comment> <object-id pub-id-type="pmid">10749211</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Polsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mel</surname> <given-names>B.W</given-names></name>, and <name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>. <article-title>Computational subunits in thin dendrites of pyramidal cells</article-title>. <source><italic>Nat. Neurosci.</italic></source>, <volume>7</volume>(<issue>6</issue>):<fpage>621</fpage>–<lpage>627</lpage>, <year>2004</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1253" xlink:type="simple">10.1038/nn1253</ext-link></comment> <object-id pub-id-type="pmid">15156147</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nevian</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Larkum</surname> <given-names>M.E</given-names></name>, <name name-style="western"><surname>Polsky</surname> <given-names>A</given-names></name>, and <name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>. <article-title>Properties of basal dendrites of layer 5 pyramidal neurons: a direct patch-clamp recording study</article-title>. <source><italic>Nat. Neurosci.</italic></source>, <volume>10</volume>:<fpage>206</fpage>–<lpage>214</lpage>, <month>Feb</month> <year>2007</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1826" xlink:type="simple">10.1038/nn1826</ext-link></comment> <object-id pub-id-type="pmid">17206140</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Larkum</surname> <given-names>M.E</given-names></name>, <name name-style="western"><surname>Nevian</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sandler</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Polsky</surname> <given-names>A</given-names></name>, and <name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>. <article-title>Synaptic integration in tuft dendrites of layer 5 pyramidal neurons: a new unifying principle</article-title>. <source><italic>Science</italic></source>, <volume>325</volume>(<issue>5941</issue>):<fpage>756</fpage>–<lpage>760</lpage>, <year>2009</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1171958" xlink:type="simple">10.1126/science.1171958</ext-link></comment> <object-id pub-id-type="pmid">19661433</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Branco</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>B.A</given-names></name>, and <name name-style="western"><surname>Hausser</surname> <given-names>M</given-names></name>. <article-title>Dendritic discrimination of temporal input sequences in cortical neurons</article-title>. <source><italic>Science</italic></source>, <volume>329</volume>(<issue>5999</issue>):<fpage>1671</fpage>–<lpage>1675</lpage>, <month>Sep</month> <year>2010</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1189664" xlink:type="simple">10.1126/science.1189664</ext-link></comment> <object-id pub-id-type="pmid">20705816</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jia</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Rochefort</surname> <given-names>N.L</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>X</given-names></name>, and <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name>. <article-title>Dendritic organization of sensory input to cortical neurons in vivo</article-title>. <source><italic>Nature</italic></source>, <volume>464</volume>(<issue>7293</issue>):<fpage>1307</fpage>–<lpage>1312</lpage>, <year>2010</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08947" xlink:type="simple">10.1038/nature08947</ext-link></comment> <object-id pub-id-type="pmid">20428163</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lavzin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rapoport</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Polsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Garion</surname> <given-names>L</given-names></name>, and <name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>. <article-title>Nonlinear dendritic processing determines angular tuning of barrel cortex neurons in vivo</article-title>. <source><italic>Nature</italic></source>, <year>2012</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11451" xlink:type="simple">10.1038/nature11451</ext-link></comment> <object-id pub-id-type="pmid">22940864</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Poirazi</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Brannon</surname> <given-names>T</given-names></name>, and <name name-style="western"><surname>Mel</surname> <given-names>B.W</given-names></name>. <article-title>Pyramidal neuron as two-layer neural network</article-title>. <source><italic>Neuron</italic></source>, <volume>37</volume>:<fpage>989</fpage>–<lpage>999</lpage>, <year>2003</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(03)00149-1" xlink:type="simple">10.1016/S0896-6273(03)00149-1</ext-link></comment> <object-id pub-id-type="pmid">12670427</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Caze</surname> <given-names>R.D</given-names></name>, <name name-style="western"><surname>Humphries</surname> <given-names>M</given-names></name>, and <name name-style="western"><surname>Gutkin</surname> <given-names>B</given-names></name>. <article-title>Passive dendrites enable single neurons to compute linearly non-separable functions</article-title>. <source><italic>PLoS Comput. Biol.</italic></source>, <volume>9</volume>(<issue>2</issue>):<fpage>e1002867</fpage>, <year>2013</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002867" xlink:type="simple">10.1371/journal.pcbi.1002867</ext-link></comment> <object-id pub-id-type="pmid">23468600</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Breuer</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Timme</surname> <given-names>M</given-names></name>, and <name name-style="western"><surname>Memmesheimer</surname> <given-names>R.M</given-names></name>. <article-title>Statistical Physics of Neural Systems with Nonadditive Dendritic Coupling</article-title>. <source><italic>Physical Review X</italic></source>, <volume>4</volume>(<issue>011053</issue>):<fpage>1</fpage>–<lpage>23</lpage>, <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1004638.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tran-Van-Minh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Caze</surname> <given-names>R.D</given-names></name>, <name name-style="western"><surname>Abrahamsson</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cathala</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Gutkin</surname> <given-names>B.S</given-names></name>, and <name name-style="western"><surname>DiGregorio</surname> <given-names>D.A</given-names></name>. <article-title>Contribution of sublinear and supralinear dendritic integration to neuronal computations</article-title>. <source><italic>Front Cell Neurosci</italic></source>, <volume>9</volume>:<fpage>67</fpage>, <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncel.2015.00067" xlink:type="simple">10.3389/fncel.2015.00067</ext-link></comment> <object-id pub-id-type="pmid">25852470</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rumelhart</surname> <given-names>D.E</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G.E</given-names></name>, and <name name-style="western"><surname>Williams</surname> <given-names>R.J</given-names></name>. <article-title>Learning representations by back-propagating errors</article-title>. <source><italic>Nature</italic></source>, <volume>323</volume>:<fpage>533</fpage>–<lpage>536</lpage>, <year>1986</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/323533a0" xlink:type="simple">10.1038/323533a0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hinton</surname> <given-names>G.E</given-names></name> and <name name-style="western"><surname>Salakhutdinov</surname> <given-names>R.R</given-names></name>. <article-title>Reducing the dimensionality of data with neural networks</article-title>. <source><italic>Science</italic></source>, <volume>313</volume>(<issue>5786</issue>):<fpage>504</fpage>–<lpage>507</lpage>, <year>2006</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1127647" xlink:type="simple">10.1126/science.1127647</ext-link></comment> <object-id pub-id-type="pmid">16873662</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Lübke</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Frotscher</surname> <given-names>M</given-names></name>, and <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>. <article-title>Regulation of synaptic efficacy by concidence of postsynaptic APs and EPSPs</article-title>. <source><italic>Science</italic></source>, <volume>275</volume>:<fpage>213</fpage>–<lpage>215</lpage>, <year>1997</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.275.5297.213" xlink:type="simple">10.1126/science.275.5297.213</ext-link></comment> <object-id pub-id-type="pmid">8985014</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bi</surname> <given-names>G.Q</given-names></name> and <name name-style="western"><surname>Poo</surname> <given-names>M.M</given-names></name>. <article-title>Synaptic modifications in cultured hippocampal neurons: dependence on spike timing, synaptic strength, and postsynaptic cell type</article-title>. <source><italic>J. Neurosci.</italic></source>, <volume>18</volume>(<issue>24</issue>):<fpage>10464</fpage>–<lpage>10472</lpage>, <month>Dec</month> <year>1998</year>. <object-id pub-id-type="pmid">9852584</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sjostrom</surname> <given-names>P.J</given-names></name>, <name name-style="western"><surname>Turrigiano</surname> <given-names>G.G</given-names></name>, and <name name-style="western"><surname>Nelson</surname> <given-names>S.B</given-names></name>. <article-title>Rate, timing, and cooperativity jointly determine cortical synaptic plasticity</article-title>. <source><italic>Neuron</italic></source>, <volume>32</volume>(<issue>6</issue>):<fpage>1149</fpage>–<lpage>1164</lpage>, <year>2001</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(01)00542-6" xlink:type="simple">10.1016/S0896-6273(01)00542-6</ext-link></comment> <object-id pub-id-type="pmid">11754844</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Froemke</surname> <given-names>R.C</given-names></name>, <name name-style="western"><surname>Poo</surname> <given-names>M.M</given-names></name>, and <name name-style="western"><surname>Dan</surname> <given-names>Y</given-names></name>. <article-title>Spike-timing-dependent synaptic plasticity depends on dendritic location</article-title>. <source><italic>Nature</italic></source>, <volume>434</volume>(<issue>7030</issue>):<fpage>221</fpage>–<lpage>225</lpage>, <year>2005</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature03366" xlink:type="simple">10.1038/nature03366</ext-link></comment> <object-id pub-id-type="pmid">15759002</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Letzkus</surname> <given-names>J.J</given-names></name>, <name name-style="western"><surname>Kampa</surname> <given-names>B.M</given-names></name>, and <name name-style="western"><surname>Stuart</surname> <given-names>G.J</given-names></name>. <article-title>Learning rules for spike timing-dependent plasticity depend on dendritic synapse location</article-title>. <source><italic>J. Neurosci.</italic></source>, <volume>26</volume>(<issue>41</issue>):<fpage>10420</fpage>–<lpage>10429</lpage>, <year>2006</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2650-06.2006" xlink:type="simple">10.1523/JNEUROSCI.2650-06.2006</ext-link></comment> <object-id pub-id-type="pmid">17035526</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sjostrom</surname> <given-names>P.J</given-names></name> and <name name-style="western"><surname>Hausser</surname> <given-names>M</given-names></name>. <article-title>A cooperative switch determines the sign of synaptic plasticity in distal dendrites of neocortical pyramidal neurons</article-title>. <source><italic>Neuron</italic></source>, <volume>51</volume>(<issue>2</issue>):<fpage>227</fpage>–<lpage>238</lpage>, <year>2006</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2006.06.017" xlink:type="simple">10.1016/j.neuron.2006.06.017</ext-link></comment> <object-id pub-id-type="pmid">16846857</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Golding</surname> <given-names>N.L</given-names></name>, <name name-style="western"><surname>Staff</surname> <given-names>N.P</given-names></name>, and <name name-style="western"><surname>Spruston</surname> <given-names>N</given-names></name>. <article-title>Dendritic spikes as a mechanism for cooperative long-term potentiation</article-title>. <source><italic>Nature</italic></source>, <volume>418</volume>(<issue>6895</issue>):<fpage>326</fpage>–<lpage>331</lpage>, <year>2002</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature00854" xlink:type="simple">10.1038/nature00854</ext-link></comment> <object-id pub-id-type="pmid">12124625</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gordon</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Polsky</surname> <given-names>A</given-names></name>, and <name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>. <article-title>Plasticity compartments in basal dendrites of neocortical pyramidal neurons</article-title>. <source><italic>J. Neurosci.</italic></source>, <volume>26</volume>(<issue>49</issue>):<fpage>12717</fpage>–<lpage>12726</lpage>, <year>2006</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3502-06.2006" xlink:type="simple">10.1523/JNEUROSCI.3502-06.2006</ext-link></comment> <object-id pub-id-type="pmid">17151275</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Remy</surname> <given-names>J</given-names></name> and <name name-style="western"><surname>Spruston</surname> <given-names>N</given-names></name>. <article-title>Dendritic spikes induce single-burst long-term potentiation</article-title>. <source><italic>Proc. Natl. Acad. Sci. U.S.A.</italic></source>, <volume>104</volume>(<issue>43</issue>):<fpage>17192</fpage>–<lpage>17197</lpage>, <year>2007</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0707919104" xlink:type="simple">10.1073/pnas.0707919104</ext-link></comment> <object-id pub-id-type="pmid">17940015</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Poirazi</surname> <given-names>P</given-names></name> and <name name-style="western"><surname>Mel</surname> <given-names>B.W</given-names></name>. <article-title>Impact of active dendrites and structural plasticity on the memory capacity of neural tissue</article-title>. <source><italic>Neuron</italic></source>, <volume>29</volume>(<issue>3</issue>):<fpage>779</fpage>–<lpage>796</lpage>, <year>2001</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(01)00252-5" xlink:type="simple">10.1016/S0896-6273(01)00252-5</ext-link></comment> <object-id pub-id-type="pmid">11301036</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Legenstein</surname> <given-names>R</given-names></name> and <name name-style="western"><surname>Maass</surname> <given-names>W</given-names></name>. <article-title>Branch-specific plasticity enables self-organization of nonlinear computation in single neurons</article-title>. <source><italic>J. Neurosci.</italic></source>, <volume>31</volume>(<issue>30</issue>):<fpage>10787</fpage>–<lpage>10802</lpage>, <year>2011</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5684-10.2011" xlink:type="simple">10.1523/JNEUROSCI.5684-10.2011</ext-link></comment> <object-id pub-id-type="pmid">21795531</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schiess</surname> <given-names>M.E</given-names></name>, <name name-style="western"><surname>Urbanczik</surname> <given-names>R</given-names></name>, and <name name-style="western"><surname>Senn</surname> <given-names>W</given-names></name>. <article-title>Gradient estimation in dendritic reinforcement learning</article-title>. <source><italic>The Journal of Mathematical Neuroscience</italic></source>, <volume>2</volume>(<issue>2</issue>), <year>2012</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/2190-8567-2-2" xlink:type="simple">10.1186/2190-8567-2-2</ext-link></comment> <object-id pub-id-type="pmid">22657827</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Major</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Polsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Denk</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name>, and <name name-style="western"><surname>Tank</surname> <given-names>D.W</given-names></name>. <article-title>Spatiotemporally graded NMDA spike/plateau potentials in basal dendrites of neocortical pyramidal neurons</article-title>. <source><italic>J. Neurophysiol.</italic></source>, <volume>99</volume>:<fpage>2584</fpage>–<lpage>2601</lpage>, <month>May</month> <year>2008</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00011.2008" xlink:type="simple">10.1152/jn.00011.2008</ext-link></comment> <object-id pub-id-type="pmid">18337370</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kempter</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>van Hemmen</surname> <given-names>J.L</given-names></name>, and <name name-style="western"><surname>Wagner</surname> <given-names>H</given-names></name>. <article-title>A neuronal learning rule for sub-millisecond temporal coding</article-title>. <source><italic>Nature</italic></source>, <volume>383</volume>(<issue>6595</issue>):<fpage>76</fpage>–<lpage>81</lpage>, <month>Sep</month> <year>1996</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/383076a0" xlink:type="simple">10.1038/383076a0</ext-link></comment> <object-id pub-id-type="pmid">8779718</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pfister</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Toyoizumi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Barber</surname> <given-names>D</given-names></name>, and <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Optimal spike-timing-dependent plasticity for precise action potential firing in supervised learning</article-title>. <source><italic>Neural Computation</italic></source>, <volume>18</volume>:<fpage>1318</fpage>–<lpage>1348</lpage>, <year>2006</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2006.18.6.1318" xlink:type="simple">10.1162/neco.2006.18.6.1318</ext-link></comment> <object-id pub-id-type="pmid">16764506</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brea</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Senn</surname> <given-names>W</given-names></name>, and <name name-style="western"><surname>Pfister</surname> <given-names>J.P</given-names></name>. <article-title>Matching recall and storage in sequence learning with spiking neural networks</article-title>. <source><italic>J. Neurosci.</italic></source>, <volume>33</volume>(<issue>23</issue>):<fpage>9565</fpage>–<lpage>9575</lpage>, <month>Jun</month> <year>2013</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4098-12.2013" xlink:type="simple">10.1523/JNEUROSCI.4098-12.2013</ext-link></comment> <object-id pub-id-type="pmid">23739954</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Losonczy</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Makara</surname> <given-names>J.K</given-names></name>, and <name name-style="western"><surname>Magee</surname> <given-names>J.C</given-names></name>. <article-title>Compartmentalized dendritic plasticity and input feature storage in neurons</article-title>. <source><italic>Nature</italic></source>, <volume>452</volume>(<issue>7186</issue>):<fpage>436</fpage>–<lpage>441</lpage>, <month>Mar</month> <year>2008</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06725" xlink:type="simple">10.1038/nature06725</ext-link></comment> <object-id pub-id-type="pmid">18368112</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Memmesheimer</surname> <given-names>R.M</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Olveczky</surname> <given-names>B.P</given-names></name>, and <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>Learning precisely timed spikes</article-title>. <source><italic>Neuron</italic></source>, <volume>82</volume>(<issue>4</issue>):<fpage>925</fpage>–<lpage>938</lpage>, <month>May</month> <year>2014</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2014.03.026" xlink:type="simple">10.1016/j.neuron.2014.03.026</ext-link></comment> <object-id pub-id-type="pmid">24768299</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Izhikevich</surname> <given-names>E</given-names></name>. <article-title>Solving the distal reward problem through linkage of STDP and dopamine signaling</article-title>. <source><italic>Cerebral Cortex</italic></source>, <volume>17</volume>:<fpage>2443</fpage>–<lpage>2452</lpage>, <year>2007</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhl152" xlink:type="simple">10.1093/cercor/bhl152</ext-link></comment> <object-id pub-id-type="pmid">17220510</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frémaux</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sprekeler</surname> <given-names>H</given-names></name>, and <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Functional requirements for reward-modulated spike-timing-dependent plasticity</article-title>. <source><italic>J. Neurosci.</italic></source>, <volume>30</volume>:<fpage>13326</fpage>–<lpage>13337</lpage>, <month>Oct</month> <year>2010</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.6249-09.2010" xlink:type="simple">10.1523/JNEUROSCI.6249-09.2010</ext-link></comment> <object-id pub-id-type="pmid">20926659</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gütig</surname> <given-names>R</given-names></name> and <name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>. <article-title>The tempotron: a neuron that learns spike timing-based decision</article-title>. <source><italic>Nature Neurosci.</italic></source>, <volume>9</volume>:<fpage>420</fpage>–<lpage>428</lpage>, <year>2006</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1643" xlink:type="simple">10.1038/nn1643</ext-link></comment> <object-id pub-id-type="pmid">16474393</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Urbanczik</surname> <given-names>R</given-names></name> and <name name-style="western"><surname>Senn</surname> <given-names>W</given-names></name>. <article-title>A gradient learning rule for the tempotron</article-title>. <source><italic>Neural Comput.</italic></source>, <volume>21</volume>:<fpage>340</fpage>–<lpage>352</lpage>, <year>2009</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2008.09-07-605" xlink:type="simple">10.1162/neco.2008.09-07-605</ext-link></comment> <object-id pub-id-type="pmid">19431262</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Golding</surname> <given-names>N.L</given-names></name> and <name name-style="western"><surname>Spruston</surname> <given-names>N</given-names></name>. <article-title>Dendritic sodium spikes are variable triggers of axonal action potentials in hippocampal CA1 pyramidal neurons</article-title>. <source><italic>Neuron</italic></source>, <volume>21</volume>(<issue>5</issue>):<fpage>1189</fpage>–<lpage>1200</lpage>, <month>Nov</month> <year>1998</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(00)80635-2" xlink:type="simple">10.1016/S0896-6273(00)80635-2</ext-link></comment> <object-id pub-id-type="pmid">9856473</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cichon</surname> <given-names>J</given-names></name> and <name name-style="western"><surname>Gan</surname> <given-names>W.B</given-names></name>. <article-title>Branch-specific dendritic Ca(2+) spikes cause persistent synaptic plasticity</article-title>. <source><italic>Nature</italic></source>, <volume>520</volume>(<issue>7546</issue>):<fpage>180</fpage>–<lpage>185</lpage>, <month>Apr</month> <year>2015</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature14251" xlink:type="simple">10.1038/nature14251</ext-link></comment> <object-id pub-id-type="pmid">25822789</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kampa</surname> <given-names>B.M</given-names></name>, <name name-style="western"><surname>Letzkus</surname> <given-names>J.J</given-names></name>, and <name name-style="western"><surname>Stuart</surname> <given-names>G.J</given-names></name>. <article-title>Dendritic mechanisms controlling spike-timing-dependent synaptic plasticity</article-title>. <source><italic>Trends Neurosci.</italic></source>, <volume>30</volume>(<issue>9</issue>):<fpage>456</fpage>–<lpage>463</lpage>, <month>Sep</month> <year>2007</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tins.2007.06.010" xlink:type="simple">10.1016/j.tins.2007.06.010</ext-link></comment> <object-id pub-id-type="pmid">17765330</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Larkum M.E and Nevian</surname> <given-names>T</given-names></name>. <article-title>Synaptic clustering by dendritic signalling mechanisms</article-title>. <source><italic>Curr. Opin. Neurobiol.</italic></source>, <volume>18</volume>(<issue>3</issue>):<fpage>321</fpage>–<lpage>331</lpage>, <month>Jun</month> <year>2008</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2008.08.013" xlink:type="simple">10.1016/j.conb.2008.08.013</ext-link></comment> <object-id pub-id-type="pmid">18804167</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Goldberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Holthoff</surname> <given-names>K</given-names></name>, and <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>A problem with Hebb and local spikes</article-title>. <source><italic>Trends Neurosci.</italic></source>, <volume>25</volume>(<issue>9</issue>):<fpage>433</fpage>–<lpage>435</lpage>, <year>2002</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0166-2236(02)02200-2" xlink:type="simple">10.1016/S0166-2236(02)02200-2</ext-link></comment> <object-id pub-id-type="pmid">12183194</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Holthoff</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kovalchuk</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>, and <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name>. <article-title>Single-shock LTD by local dendritic spikes in pyramidal neurons of mouse visual cortex</article-title>. <source><italic>J. Physiol. (Lond.)</italic></source>, <volume>560</volume>(<issue>Pt 1</issue>):<fpage>27</fpage>–<lpage>36</lpage>, <year>2004</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.2004.072678" xlink:type="simple">10.1113/jphysiol.2004.072678</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gambino</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pages</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kehayas</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Baptista</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tatti</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Carleton</surname> <given-names>A</given-names></name>, and <name name-style="western"><surname>Holtmaat</surname> <given-names>A</given-names></name>. <article-title>Sensory-evoked LTP driven by dendritic plateau potentials in vivo</article-title>. <source><italic>Nature</italic></source>, <volume>515</volume>(<issue>7525</issue>):<fpage>116</fpage>–<lpage>119</lpage>, <month>Nov</month> <year>2014</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature13664" xlink:type="simple">10.1038/nature13664</ext-link></comment> <object-id pub-id-type="pmid">25174710</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004638.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hornik</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Stinchcombe</surname> <given-names>M</given-names></name>, and <name name-style="western"><surname>White</surname> <given-names>H</given-names></name>. <article-title>Multilayer feedforward networks are universal approximators</article-title>. <source><italic>Neural Networks</italic></source>, <volume>2</volume>:<fpage>359</fpage>–<lpage>366</lpage>, <year>1989</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0893-6080(89)90020-8" xlink:type="simple">10.1016/0893-6080(89)90020-8</ext-link></comment></mixed-citation>
</ref>
</ref-list>
</back>
</article>