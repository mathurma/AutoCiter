<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01812</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003776</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject></subj-group><subj-group><subject>Genetics</subject></subj-group><subj-group><subject>Immunology</subject></subj-group><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbial pathogens</subject><subj-group><subject>Viral pathogens</subject><subj-group><subject>Immunodeficiency viruses</subject><subj-group><subject>HIV</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Viral diseases</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>The Fitness Landscape of HIV-1 Gag: Advanced Modeling Approaches and Validation of Model Predictions by <italic>In Vitro</italic> Testing</article-title>
<alt-title alt-title-type="running-head">The Fitness Landscape of HIV-1 Gag</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Mann</surname><given-names>Jaclyn K.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Barton</surname><given-names>John P.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Ferguson</surname><given-names>Andrew L.</given-names></name><xref ref-type="aff" rid="aff5"><sup>5</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Omarjee</surname><given-names>Saleha</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Walker</surname><given-names>Bruce D.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff6"><sup>6</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Chakraborty</surname><given-names>Arup</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff7"><sup>7</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ndung'u</surname><given-names>Thumbi</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff8"><sup>8</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>HIV Pathogenesis Programme, Doris Duke Medical Research Institute, Nelson R. Mandela School of Medicine, University of KwaZulu-Natal, Durban, South Africa</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>KwaZulu-Natal Research Institute for Tuberculosis and HIV (K-RITH), Nelson R Mandela School of Medicine, University of KwaZulu-Natal, Durban, South Africa</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Chemical Engineering, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Ragon Institute of Massachusetts General Hospital, Massachusetts Institute of Technology and Harvard University, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Department of Materials Science and Engineering, University of Illinois at Urbana-Champaign, Urbana, Illinois, United States of America</addr-line></aff>
<aff id="aff6"><label>6</label><addr-line>Howard Hughes Medical Institute, Chevy Chase, Maryland, United States of America</addr-line></aff>
<aff id="aff7"><label>7</label><addr-line>Departments of Chemistry and Physics, Massachusetts Institute of Technology, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff8"><label>8</label><addr-line>Max Planck Institute for Infection Biology, Berlin, Germany</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Regoes</surname><given-names>Roland R.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>ETH Zurich, Switzerland</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">arupc@mit.edu</email> (AC); <email xlink:type="simple">ndungu@ukzn.ac.za</email> (TN)</corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: JKM JPB ALF AC TN BDW. Performed the experiments: JKM SO. Analyzed the data: JPB ALF JKM. Wrote the paper: JKM JPB ALF AC TN BDW. Led the computational work: JPB ALF AC.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>8</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>7</day><month>8</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>8</issue>
<elocation-id>e1003776</elocation-id>
<history>
<date date-type="received"><day>17</day><month>10</month><year>2013</year></date>
<date date-type="accepted"><day>29</day><month>6</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Mann et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Viral immune evasion by sequence variation is a major hindrance to HIV-1 vaccine design. To address this challenge, our group has developed a computational model, rooted in physics, that aims to predict the fitness landscape of HIV-1 proteins in order to design vaccine immunogens that lead to impaired viral fitness, thus blocking viable escape routes. Here, we advance the computational models to address previous limitations, and directly test model predictions against <italic>in vitro</italic> fitness measurements of HIV-1 strains containing multiple Gag mutations. We incorporated regularization into the model fitting procedure to address finite sampling. Further, we developed a model that accounts for the specific identity of mutant amino acids (Potts model), generalizing our previous approach (Ising model) that is unable to distinguish between different mutant amino acids. Gag mutation combinations (17 pairs, 1 triple and 25 single mutations within these) predicted to be either harmful to HIV-1 viability or fitness-neutral were introduced into HIV-1 NL4-3 by site-directed mutagenesis and replication capacities of these mutants were assayed <italic>in vitro</italic>. The predicted and measured fitness of the corresponding mutants for the original Ising model (<italic>r</italic> = −0.74, <italic>p</italic> = 3.6×10<sup>−6</sup>) are strongly correlated, and this was further strengthened in the regularized Ising model (<italic>r</italic> = −0.83, <italic>p</italic> = 3.7×10<sup>−12</sup>). Performance of the Potts model (<italic>r</italic> = −0.73, <italic>p</italic> = 9.7×10<sup>−9</sup>) was similar to that of the Ising model, indicating that the binary approximation is sufficient for capturing fitness effects of common mutants at sites of low amino acid diversity. However, we show that the Potts model is expected to improve predictive power for more variable proteins. Overall, our results support the ability of the computational models to robustly predict the relative fitness of mutant viral strains, and indicate the potential value of this approach for understanding viral immune evasion, and harnessing this knowledge for immunogen design.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>At least 70 million people have been infected with HIV since the beginning of the epidemic and an effective vaccine remains elusive. The high mutation rate and diversity of HIV strains enables the virus to effectively evade host immune responses, presenting a significant challenge for HIV vaccine design. We have developed an approach to translate clinical databases of HIV sequences into mathematical models quantifying the capacity of the virus to replicate as a function of mutations within its genome. We have previously shown how such “fitness landscapes” can be used to guide the design of vaccines to attack vulnerable regions from which it is difficult for the virus to escape by mutation. Here, using new modeling approaches, we have improved on our previous models of HIV fitness landscape by accounting for undersampling of HIV sequences and the specific identity of mutant amino acids. We experimentally tested the accuracy of the improved models to predict the fitness of HIV with multiple mutations in the Gag protein. The experimental data are in strong agreement with model predictions, supporting the value of these models as a novel approach for determining mutational vulnerabilities of HIV-1, which, in turn, can inform vaccine design.</p>
</abstract>
<funding-group><funding-statement>Financial support was provided by the Ragon Institute (BDW, AKC, JKM, SO, TN), a National Institutes of Health Director's Pioneers Award (AKC), NIH Award AI30914 (BDW), the Howard Hughes Medical Institute (BDW, TN), the South African Department of Science and Technology/National Research Foundation Research Chairs Initiative and the Victor Daitz Foundation (JKM, SO, TN). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="11"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>The ideal way to combat the spread of HIV-1 is with an effective prophylactic or therapeutic vaccine <xref ref-type="bibr" rid="pcbi.1003776-McElrath1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Walker1">[2]</xref>. One of the greatest challenges hindering the achievement of this goal is the incredible sequence diversity and mutability of HIV-1 <xref ref-type="bibr" rid="pcbi.1003776-Korber1">[3]</xref>, which can limit the effectiveness of the immune response <xref ref-type="bibr" rid="pcbi.1003776-Walker1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Johnston1">[4]</xref>.</p>
<p>CD8+ T cells are instrumental in reducing viral load in HIV-1 acute infection <xref ref-type="bibr" rid="pcbi.1003776-Koup1">[5]</xref> and in maintaining the viral set point during chronic HIV/SIV infection <xref ref-type="bibr" rid="pcbi.1003776-Schmitz1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-McMichael1">[7]</xref>. However, HIV-1 is able to escape the CD8+ T cell response through mutations in or adjacent to HIV-1 epitopes that are presented by HLA class I molecules on the surface of the infected cells <xref ref-type="bibr" rid="pcbi.1003776-McMichael1">[7]</xref>. One proposed strategy for realizing a potent prophylactic or therapeutic vaccine is to target CD8+ T cell responses to conserved regions of HIV-1, aiming to reduce incidences of immune escape or, if escape occurs, to reduce viral fitness and lower the viral set point, thereby slowing disease course and reducing transmission at the population level <xref ref-type="bibr" rid="pcbi.1003776-Allen1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Chopera1">[9]</xref>. While escape mutations at highly conserved sites often damage the viability of virus <xref ref-type="bibr" rid="pcbi.1003776-Troyer1">[10]</xref>, this approach is confounded by the development of compensatory mutations which restore or partially restore viral fitness <xref ref-type="bibr" rid="pcbi.1003776-Chopera1">[9]</xref>. Thus, to maximize the effectiveness of a vaccine-induced immune response one must look beyond conservation of single residues to identify regions where mutations are not only highly deleterious, but where further mutations elsewhere in the proteome are unlikely to restore lost fitness, but rather, lead to additional fitness costs due to deleterious synergistic effects.</p>
<p>Our group has developed computational models to identify such vulnerable regions of the HIV-1 proteome and to predict the fitness landscape of HIV-1 proteins, providing tools for designing vaccine immunogens that may limit both HIV-1 evasion of CD8+ T cell responses and the development of compensatory mutations <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Dahirel1">[12]</xref>. In an early qualitative study we identified groups of amino acids in HIV-1 Gag coupled by structural and functional constraints that cause these residues to co-evolve with each other, but evolve nearly independently of the other residues in the protein <xref ref-type="bibr" rid="pcbi.1003776-Dahirel1">[12]</xref>. In analogy with past studies on the economic markets and enzymes <xref ref-type="bibr" rid="pcbi.1003776-Plerou1">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1003776-Laloux1">[15]</xref>, we termed these groups of residues “sectors”. This analysis and human clinical data revealed one sector in Gag, which we termed sector 3, where multiple mutations were more likely to be deleterious. This group of residues is naturally targeted more by elite controllers <xref ref-type="bibr" rid="pcbi.1003776-Dahirel1">[12]</xref>. It is expected to be particularly vulnerable to CD8+ T cell responses that target multiple residues in it since multiple mutations within this sector are likely to significantly diminish viral fitness, thereby restricting available escape and compensatory paths <xref ref-type="bibr" rid="pcbi.1003776-Dahirel1">[12]</xref>.</p>
<p>This approach, however, does not allow us to determine precisely which residues should be targeted, as it does not quantify the relative replicative viability of viral strains bearing specific mutations. Nor does it identify viable escape routes that remain upon targeting residues in the vulnerable regions, or inform how best to block them. To begin to address these issues, we developed a computational model, rooted in statistical physics, which aims to predict the viral fitness landscape (viral fitness as a function of amino acid sequence) from sequence data alone and applied it to HIV-1 Gag <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>. Similar methods have previously been employed to study other complex biological systems, from describing the activity patterns of neuronal networks <xref ref-type="bibr" rid="pcbi.1003776-Roudi1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1003776-Cocco2">[19]</xref> to the prediction of contact residues in protein families <xref ref-type="bibr" rid="pcbi.1003776-Mora1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Weigt1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Morcos1">[21]</xref>.</p>
<p>The idea underlying our approach is to first characterize the distribution of sequences in the population, which we expect to be correlated with fitness (see below). Due to the small number of available sequences compared to the size of the sequence space, direct estimation of the probability distribution characterizing the available sequences is precluded. Thus, we instead aim to infer the least biased probability distribution of sequences that fits the observed frequency of mutations at each site, and all correlations between pairs of mutations (the one- and two-point mutational probabilities). Mathematically, “least biased” implies the distribution that has maximum entropy in the information-theoretic sense <xref ref-type="bibr" rid="pcbi.1003776-Jaynes1">[22]</xref>. The maximum entropy distribution that fits the one- and two-point mutational probabilities has a form reminiscent of that describing equilibrium configurations of an Ising model in statistical mechanics. We generated such models using multiple sequence alignments (MSA) for the four subunit proteins of Gag in HIV-1 clade B <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref> (described in Supporting Information <xref ref-type="supplementary-material" rid="pcbi.1003776.s002">Text S1</xref>, Section 1). This model assigns to each viral strain an “energy” (E), which is inversely related to the probability of observing this sequence.</p>
<p>We expect more prevalent sequences to be more fit, consistent with expectations from simple models of evolution <xref ref-type="bibr" rid="pcbi.1003776-Sella1">[23]</xref> though the precise correspondence between fitness and prevalence may have a more complicated dependence on factors such as the shape of the fitness landscape, as predicted by quasispecies theory <xref ref-type="bibr" rid="pcbi.1003776-Wilke1">[24]</xref>. Furthermore, this expectation could be confounded by immune responses in the patients from whom the virus samples were collected, and phylogeny. Recent analyses suggest (described more fully in the discussion) that in spite of these effects, at least for Gag proteins, the rank order of prevalence and <italic>in vitro</italic> replicative fitness should be similar <xref ref-type="bibr" rid="pcbi.1003776-Shekhar1">[25]</xref>. Strains with high E values are predicted to be less fit than strains with low E values. Predictions of the model seemed to be in good agreement with experimental data on <italic>in vitro</italic> replicative fitness, as well as clinical observations on the frequency and impact of viral escape mutations <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>.</p>
<p>Our aim in the current work is twofold. First, we present new advances in the inference and modeling of viral fitness landscapes that address previous theoretical and computational limitations. Second, we describe new <italic>in vitro</italic> fitness measurements for viruses containing multiple Gag mutations, performed to further test fitness predictions using the improved computational methods. To give a broad test of the predictive power of the fitness models, we have performed comparisons for HIV-1 strains containing multiple mutations predicted to harm HIV-1 viability as well as combinations predicted to be relatively fitness neutral. We find that fitness measurements of these mutant strains are in good agreement with model predictions.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>Computational models to translate sequence data to viral fitness landscapes</title>
<p>Our key hypothesis in formulating models of HIV fitness is that the prevalence of viruses with a given sequence, that is, how often the sequence is observed, is related to its fitness. Simply, fitter viruses should be more frequent in the population than those that are unfit. This hypothesis can be proven for some idealized evolutionary models <xref ref-type="bibr" rid="pcbi.1003776-Sella1">[23]</xref>, but cannot be made exact for the complicated nonequilibrium host-pathogen riposte between humans and HIV. However, our theoretical work, backed by extensive computational studies, suggests that the rank order of fitness and prevalence of strains should be strongly monotonically correlated, provided we compare sequences that are phylogenetically close <xref ref-type="bibr" rid="pcbi.1003776-Shekhar1">[25]</xref>. Thus, if we construct a model to predict the likelihood of observing different viral strains with given sequences, it can predict the relative fitness of the strains. We achieved this goal by constructing a maximum entropy model for the probability of observing sequences in the MSA <xref ref-type="bibr" rid="pcbi.1003776-Binder1">[26]</xref>. The simplest model in this class is an Ising model, a simple model of interacting binary variables from statistical physics which has been widely applied to study collective behavior in complex systems. The parameters of this Ising model are obtained by imposing the constraint that it reproduce the pattern of correlated mutations (relative to the consensus sequence) observed in a multiple sequence alignment (MSA) of HIV-1 amino acid sequences extracted from infected hosts. Specifically, the parameters were chosen such that the frequency of mutations at each single residue and the frequency of simultaneous mutations at each pair of residues were the same in both the Ising model and the MSA. Importantly, the model also reproduced higher order mutational correlations accurately, even though these mutational frequencies were not directly fitted <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>.</p>
<p>As described in our previous publication <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>, in the Ising model amino acid sequences in the MSA are compressed into binary strings by assigning a 0 to each position where the amino acid matches the consensus sequence (“wild-type”), and a 1 to each position with a mismatch (“mutant”). While this binary approximation greatly simplified our modeling approach, the reduction in complexity has several drawbacks. Firstly, there is a loss of residue-specific resolution. The fitness predictions of our model are insensitive to the precise identity of mutant amino acids, and thus the model cannot resolve fitness differences between proteins containing different mutant amino acid residues in a particular position. Secondly, for relatively conserved proteins such as HIV-1 Gag, where the number of viable amino acids at each position is rather limited, this binary simplification represents a reasonable approximation. However, it is less justified for highly mutable proteins where the wild-type residue in each position is not the overwhelmingly most probable amino acid, as is the case for the HIV-1 Env protein.</p>
<p>In our original approach, we fit the Ising model parameters to precisely reproduce the observed one and two-residue mutational correlations within the MSA. However, simultaneous mutations at certain pairs of residues were never observed. This led to another deficiency in our original modeling approach in that pairs of mutations not observed in the MSA were predicted to be completely unviable (<italic>E</italic> = ∞). While it is possible that such mutant viral strains have exactly zero replicative fitness, it is more likely that they are highly unfit strains (possessing non-zero replicative fitness) that simply arise too seldom to be observed within our finite-sized MSA.</p>
<p>In this work, we present three significant advances of our original model to predict viral fitness, which also the aforementioned limitations. First, we incorporate Bayesian regularization into our fitting procedure to eliminate the prediction of zero replicative fitnesses for mutations not present within our MSA. Second, we implement a new algorithm for inferring an Ising model from sequence data, which dramatically accelerates the computation of model parameters. Third, we relax the binary approximation to infer viral fitness landscapes that explicitly retain the amino acid identities at each position. We achieve this by describing the viral fitness landscape using a multistate generalization of the Ising model known as the Potts model, another established and well-studied model in statistical physics <xref ref-type="bibr" rid="pcbi.1003776-Wu1">[27]</xref>. We also implement Bayesian regularization into the fitting of the Potts model parameters.</p>
</sec><sec id="s2b">
<title>Model 1: Regularized and computationally fast inference of Ising models of viral fitness</title>
<p>Inference of the parameters of the Ising models, commonly referred to as the inverse Ising problem, is a canonical inverse problem lacking an analytical solution that may be tackled in many ways <xref ref-type="bibr" rid="pcbi.1003776-Roudi1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Mora1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Cocco2">[19]</xref>–<xref ref-type="bibr" rid="pcbi.1003776-Morcos1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Lezon1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Roudi2">[29]</xref>. We improve upon our previous techniques described in <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref> by incorporating regularization and implementing new inference algorithms, which greatly decrease the computational burden and accelerate model fitting.</p>
<p>To control the effects of undersampling and to improve the predictive power of the inferred fitness models, we incorporate Bayesian regularization into our inference algorithm <xref ref-type="bibr" rid="pcbi.1003776-Cocco1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Cocco2">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Barton1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Sivia1">[31]</xref> in the form of a Gaussian prior distribution for the model parameters describing pairwise couplings between residues (see <xref ref-type="supplementary-material" rid="pcbi.1003776.s002">Text S1</xref>, Sections 1.3 and 2.5). Regularization of this form is also known as Tikhonov regularization or ridge regression <xref ref-type="bibr" rid="pcbi.1003776-Gruber1">[32]</xref>. With this addition, the probability of observing any sequence, including those containing pairs of mutations not observed in the MSA, is nonzero. We have also computed a correction to the energy of each sequence to account for the possible bias that strains near fitness peaks are more likely to be observed than would be expected from their intrinsic fitness when sampled from a finite distribution (see <xref ref-type="supplementary-material" rid="pcbi.1003776.s002">Text S1</xref>, Section 3.2).</p>
<p>In an algorithmic advance over our previous fitting procedure, we fit the parameters of our regularized Ising model using the selective cluster expansion algorithm of Cocco and Monasson <xref ref-type="bibr" rid="pcbi.1003776-Cocco1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Cocco2">[19]</xref> which identifies clusters of strongly interacting sites and iteratively builds a solution for the whole system by solving the inverse Ising problem for each cluster. With this approach, we cut the CPU time necessary to infer the parameters of the Ising model from roughly 12 years <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref> to 5 hours for p24, an improvement by four orders of magnitude. Roughly, we expect algorithm run-time to scale as <italic>O</italic>(<italic>Nn</italic> exp(<italic>n</italic>)), where <italic>N</italic> is the system size (number of amino acids) and <italic>n</italic> is the size of a typical “neighborhood” of strongly interacting sites. For a review and applications of this method see <xref ref-type="bibr" rid="pcbi.1003776-Cocco1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Barton1">[30]</xref>. Complete details of our modeling approach and numerical fitting procedures are provided in the <xref ref-type="supplementary-material" rid="pcbi.1003776.s002">Text S1</xref>, Section 1.</p>
</sec><sec id="s2c">
<title>Model 2: Regularized Potts models of viral fitness</title>
<p>An ideal model of viral fitness would be able to capture the full (unknown) distribution of correlated mutations throughout the sequence, and thus reproduce the prevalence of every viral strain. Sequences in the MSA represent a sample of the possible strains of the virus, providing information about the distribution of point mutations, pairs of simultaneous mutations, triplets of simultaneous mutations, and all higher orders. However, since the number of available sequences in the MSA is very small compared to the size of the accessible sequence space, and because mutations at most sites are rare, higher order mutations will be severely undersampled. Thus, following our previous approach we appeal to the maximum entropy principle to seek the simplest possible model capable of reproducing the single site and pair amino acid frequencies <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Jaynes1">[22]</xref>, for which the problem of undersampling is less severe. From this analysis, the Potts model is the least structured model capable of reproducing the one and two-position frequencies of amino acids observed within the MSA <xref ref-type="bibr" rid="pcbi.1003776-Morcos1">[21]</xref>.</p>
<p>To introduce the Potts model, we represent the sequence of a particular m-residue protein as a vector, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e001" xlink:type="simple"/></inline-formula>, where the elements <italic>A<sub>k</sub></italic> can take on the <italic>q</italic> = 21 integer values [1, 2, …, 21] denoting an arbitrary encoding of the 20 natural amino acids, plus a gap <xref ref-type="bibr" rid="pcbi.1003776-Morcos1">[21]</xref>. In the Potts model the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e002" xlink:type="simple"/></inline-formula> of observing a particular sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e003" xlink:type="simple"/></inline-formula> is given by<disp-formula id="pcbi.1003776.e004"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003776.e004" xlink:type="simple"/><label>(1)</label></disp-formula></p>
<p>In analogy with the statistical physics literature, we refer to E as a dimensionless “energy,” the function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e005" xlink:type="simple"/></inline-formula> as the Hamiltonian, and the normalizing factor Z as the partition function <xref ref-type="bibr" rid="pcbi.1003776-Wu1">[27]</xref>. The model is parameterized by a set of m q-dimensional vectors, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e006" xlink:type="simple"/></inline-formula>, and a set of <italic>m</italic>(<italic>m</italic>−1)/2 q-by-q matrices, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e007" xlink:type="simple"/></inline-formula>. The <italic>h<sub>i</sub></italic> vectors give the contribution of the identity of each amino acid in each position to the overall sequence energy, and the <italic>J<sub>ij</sub></italic> matrices give the contribution to the energy of pairwise interactions between amino acids in different positions.</p>
<p>To fit the Potts model, we implemented a generalization of the semi-analytical extension of the iterative gradient descent implemented by Mora and Bialek <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Mora1">[17]</xref>. This approach implements a multi-dimensional Newton search to iteratively adjust the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e008" xlink:type="simple"/></inline-formula> model parameters until the predictions of the model for the one and two-position frequencies of amino acids reproduce those observed within the MSA. In an advance over the original incarnation of this algorithm, we have derived closed form expressions for the gradients required by the Newton search, thereby obviating the need for their numerical estimation by finite differences (which would result in a more computationally expensive and less numerically stable secant search procedure). Our approach is semi-analytical in the sense that while we have analytical expressions for the Newton search gradients, we use a Monte Carlo procedure to numerically estimate the one and two-position amino acid frequencies predicted by the model at each stage of parameter refinement. We are currently developing a Potts generalization of the cluster expansion algorithm <xref ref-type="bibr" rid="pcbi.1003776-Cocco2">[19]</xref> to accelerate fitting. We incorporate Bayesian regularization into our fitting procedure in a precisely analogous manner to that described above for the regularized Ising model by introducing a Gaussian prior distribution over the <italic>J<sub>ij</sub></italic> parameters. Inference of the Potts model parameters for p24 required approximately 1.4 years of CPU time using a generalization of the gradient descent approach described in Ref. <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>. Fitting the model parameters by gradient descent is expected to scale as <italic>O</italic>((<italic>Np</italic>)<sup>2</sup>), where <italic>N</italic> is the number of amino acids in the protein, and <italic>p</italic> is the characteristic number of mutant residues observed at each position. Full details of the fitting and regularization procedures are provided in <xref ref-type="supplementary-material" rid="pcbi.1003776.s002">Text S1</xref>, Section 2. The code implementing the inverse Potts inference algorithm is also provided in Supporting Information <xref ref-type="supplementary-material" rid="pcbi.1003776.s001">Code S1</xref>.</p>
</sec><sec id="s2d">
<title><italic>In vitro</italic> experiments</title>
<p>To test the accuracy of these models in predicting the fitness landscape of HIV-1 Gag, we performed <italic>in vitro</italic> experiments to measure the fitness of various Gag mutants. Previously we had measured the <italic>in vitro</italic> replication capacities of 19 Gag p24 mutants, 16 of which contained single mutations in Gag p24, and compared these with fitness predictions of our original Ising model <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>. Here, we extend this work to measure the replication capacities of HIV-1 strains containing various combinations of mutations, predicted to be either harmful to HIV-1 viability or fitness-neutral, in Gag p24 and p17 and we compare measurements not only to the original Ising model described in Ref. <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>, but also to regularized versions of Ising and Potts models that we have developed here. Specifically we considered 17 mutations pairs, one triple, and 25 single mutations within these combinations, as listed in <xref ref-type="table" rid="pcbi-1003776-t001">Table 1</xref>. These mutations were introduced into the widely used laboratory-adapted HIV-1 clade B reference strain NL4-3.</p>
<table-wrap id="pcbi-1003776-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003776.t001</object-id><label>Table 1</label><caption>
<title>HIV-1 NL4-3 Gag mutants selected for testing of predicted energy costs (E) by an <italic>in vitro</italic> HIV-1 replication capacity assay.</title>
</caption><alternatives><graphic id="pcbi-1003776-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003776.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Mutant</td>
<td align="left" rowspan="1" colspan="1">Gag subunit</td>
<td align="left" rowspan="1" colspan="1">Category of pairs/triple</td>
<td align="left" rowspan="1" colspan="1">E<xref ref-type="table-fn" rid="nt101">a</xref></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">186I</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">78.74</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">269E</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">43.43</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">186I269E</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Sector 3<xref ref-type="table-fn" rid="nt102">b</xref>, high E<xref ref-type="table-fn" rid="nt103">c</xref></td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">295E</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">22.81</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">186I295E</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Sector 3, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">181R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">44.62</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">310T</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">6.26</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">181R310T</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Sector 3, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">182S</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">25.13</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">198V</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">182S198V</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Sector 3, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">179G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">56.09</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">229K</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">44.63</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">179G229K</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Sector 3, high E</td>
<td align="left" rowspan="1" colspan="1">97.01</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">174G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">243P</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">66.65</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">174G243P</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Sector 3, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">168I</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">38.58</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">315G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">19.11</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">168I315G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">HLA-associated, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">331R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">11.77</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">186I331R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">HLA-associated, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">302R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">11.10</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">302R315G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">HLA-associated, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">315G331R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">HLA-associated, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">190I</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">41.52</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">190I302R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">HLA-associated, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">219Q</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">6.73</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">242N</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">8.68</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">219Q242N</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">p24, low E, compensatory</td>
<td align="left" rowspan="1" colspan="1">10.80</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">146P</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">7.22</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">147L</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">3.42</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">146P147L</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">p24, low E, compensatory</td>
<td align="left" rowspan="1" colspan="1">6.58</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">326S</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">4.59</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">310T326S</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">p24, low E, sector 3</td>
<td align="left" rowspan="1" colspan="1">10.53</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">173T</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">5.92</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">173T286K</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">4.89</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">173T286K147L</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">p24, low E, triple</td>
<td align="left" rowspan="1" colspan="1">4.12</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">12K</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">3.74</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">12K54A</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1">p17, low E</td>
<td align="left" rowspan="1" colspan="1">4.84</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">86F</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">8.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">92M</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">8.74</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">86F92M</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1">p17, high E</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label>a</label><p>Energy cost predicted by original Ising model <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref> taking into account differences in NL4-3 and the multiple sequence alignment used in model generation. E is 2.98 for wild-type NL4-3 p24 and 3.43 for wild-type NL4-3 p17.</p></fn><fn id="nt102"><label>b</label><p>Mutation pairs within an immunologically vulnerable group of co-evolving residues, termed sector 3, that we previously identified qualitatively <xref ref-type="bibr" rid="pcbi.1003776-Dahirel1">[12]</xref>.</p></fn><fn id="nt103"><label>c</label><p><italic>E</italic>&gt;90 or <italic>E</italic> = ∞ were considered high E values and <italic>E</italic>&lt;15 were considered low E values.</p></fn></table-wrap-foot></table-wrap>
<p>The tested mutants can be divided into 4 categories, <italic>viz.</italic> (i) Gag p24 pairs with high E values located within a group of co-evolving amino acids termed sector 3 (cf. Ref <xref ref-type="bibr" rid="pcbi.1003776-Dahirel1">[12]</xref>), (ii) HLA-associated Gag p24 pairs with high E values, (iii) Gag p24 pairs/triple with low E values, and (iv) Gag p17 pairs (<xref ref-type="table" rid="pcbi-1003776-t001">Table 1</xref>). These mutation combinations were chosen according to E values predicted by the published Ising model <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>, where <italic>E</italic>&gt;90 or <italic>E</italic> = ∞ were considered high E values and <italic>E</italic>&lt;15 were considered low E values. Note that, due to the couplings between mutations at different sites, parameterized by the <italic>J<sub>ij</sub></italic> in <xref ref-type="disp-formula" rid="pcbi.1003776.e004">equation 1</xref>, the E values depend not only on the specific mutations introduced but also on the sequence background. The E values for mutations reported here are computed with the HIV-1 NL4-3 sequence background, which differs from the p17 and p24 MSA consensus sequences by 8 mutations (R15K, K28Q, R30K, K76R, V82I, T84V, E93D, S125N) and 2 mutations (N252H, A340G), respectively. The p24 region of Gag was focused on since this is the most conserved region of the protein. First, we selected six mutation pairs, predicted to be unfavorable in combination, in sector 3 of Gag p24 since we previously found this to be an immunologically vulnerable group of co-evolving residues in which multiple mutations are not well-tolerated <xref ref-type="bibr" rid="pcbi.1003776-Dahirel1">[12]</xref>. Since it is desirable to identify low fitness/non-viable combinations of escape mutations for vaccine immunogen design aimed at reducing viral fitness or blocking viable escape pathways, we aimed to identify pairs of likely escape mutations with high E values. Virus mutations that are statistically associated with the expression of specific host HLA class I alleles, which also restrict the same epitopes in which the mutations are found, are likely to be CD8+ T cell-driven escape mutations <xref ref-type="bibr" rid="pcbi.1003776-Goepfert1">[33]</xref>. We therefore tested five high E pairs of mutations located at HLA-associated Gag p24 codons (HLA-associated variants defined in <xref ref-type="bibr" rid="pcbi.1003776-Brumme1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Wright1">[35]</xref>) in or next to optimal CD8+ T cell epitopes (A-list epitopes from the Los Alamos HIV sequence database <xref ref-type="bibr" rid="pcbi.1003776-Los1">[36]</xref>) that were restricted by the same HLA. For comparison with high E mutation pairs, mutation combinations with low predicted E values were included in testing, comprising known favorable compensatory pairs in Gag p24 where 219Q compensates for the 242N escape mutant <xref ref-type="bibr" rid="pcbi.1003776-Brockman1">[37]</xref> and 147L compensates for the 146P escape mutant <xref ref-type="bibr" rid="pcbi.1003776-Troyer1">[10]</xref>, as well as one pair in sector 3 of Gag p24 and a Gag p24 triple mutant. Additionally, for broader testing, two mutation pairs in Gag p17 were selected. We note that the most commonly observed mutant amino acid at each codon was tested.</p>
<p>We introduced these mutation combinations into the HIV-1 NL4-3 plasmid by site-directed mutagenesis and their presence was confirmed by sequencing, as described previously <xref ref-type="bibr" rid="pcbi.1003776-Wright2">[38]</xref>. Generation of mutant viruses from mutated plasmids and the measurement of their replication capacities were performed as previously <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Wright2">[38]</xref>. Briefly, mutated plasmids were electroporated into an HIV-1-inducible green fluorescent protein reporter T cell line, harvested at ≈30% infection of cells, and the replication capacities of the resulting mutant viruses were assayed by flow cytometry using the same cell line. Replication capacities were calculated as the exponential slope of increase in percentage infected cells from days 3–6 following infection at a MOI of 0.003, normalized to the growth of wild-type NL4-3 (<italic>RC</italic> = 1). Three independent measurements were taken and averaged. Mutant viruses were re-sequenced to confirm the presence of introduced mutations.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Comparison of predictions from different models</title>
<p>The values of E predicted by our original and new modeling approaches for the 43 HIV-1 NL4-3 Gag mutants tested here are shown in <xref ref-type="table" rid="pcbi-1003776-t002">Table 2</xref>. Absolute comparison of the E values between the models are not meaningful, but the relative E values of mutants are generally in excellent concordance between models (Pearson's correlation, <italic>r</italic>≥0.85 and <italic>p</italic>≤5.3×10<sup>−11</sup>, two-tailed test).</p>
<table-wrap id="pcbi-1003776-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003776.t002</object-id><label>Table 2</label><caption>
<title>Energy costs (E) of HIV-1 NL4-3 Gag mutants predicted by computational models.</title>
</caption><alternatives><graphic id="pcbi-1003776-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003776.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Mutant</td>
<td align="left" rowspan="1" colspan="1">Gag subunit</td>
<td align="left" rowspan="1" colspan="1">Ising E<xref ref-type="table-fn" rid="nt104">a</xref></td>
<td align="left" rowspan="1" colspan="1">Regularized Ising E<xref ref-type="table-fn" rid="nt105">b</xref></td>
<td align="left" rowspan="1" colspan="1">Regularized Potts E<xref ref-type="table-fn" rid="nt106">c</xref></td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">186I</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">78.74</td>
<td align="left" rowspan="1" colspan="1">9.98</td>
<td align="left" rowspan="1" colspan="1">11.24</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">269E</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">43.43</td>
<td align="left" rowspan="1" colspan="1">11.46</td>
<td align="left" rowspan="1" colspan="1">12.18</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">186I269E</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">17.77</td>
<td align="left" rowspan="1" colspan="1">18.97</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">295E</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">22.81</td>
<td align="left" rowspan="1" colspan="1">9.05</td>
<td align="left" rowspan="1" colspan="1">11.03</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">186I295E</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">15.36</td>
<td align="left" rowspan="1" colspan="1">17.79</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">181R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">44.62</td>
<td align="left" rowspan="1" colspan="1">13.55</td>
<td align="left" rowspan="1" colspan="1">12.12</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">310T</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">6.26</td>
<td align="left" rowspan="1" colspan="1">5.87</td>
<td align="left" rowspan="1" colspan="1">7.20</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">181R310T</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">15.74</td>
<td align="left" rowspan="1" colspan="1">14.87</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">182S</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">25.13</td>
<td align="left" rowspan="1" colspan="1">7.11</td>
<td align="left" rowspan="1" colspan="1">9.68</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">198V</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">12.32</td>
<td align="left" rowspan="1" colspan="1">-<xref ref-type="table-fn" rid="nt107">d</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">182S198V</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">15.77</td>
<td align="left" rowspan="1" colspan="1">-<xref ref-type="table-fn" rid="nt107">d</xref></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">179G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">56.09</td>
<td align="left" rowspan="1" colspan="1">11.14</td>
<td align="left" rowspan="1" colspan="1">11.57</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">229K</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">44.63</td>
<td align="left" rowspan="1" colspan="1">10.52</td>
<td align="left" rowspan="1" colspan="1">11.68</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">179G229K</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">97.01</td>
<td align="left" rowspan="1" colspan="1">17.99</td>
<td align="left" rowspan="1" colspan="1">18.81</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">174G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">15.47</td>
<td align="left" rowspan="1" colspan="1">11.71</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">243P</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">66.65</td>
<td align="left" rowspan="1" colspan="1">11.1</td>
<td align="left" rowspan="1" colspan="1">11.08</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">174G243P</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">22.9</td>
<td align="left" rowspan="1" colspan="1">18.32</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">168I</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">38.58</td>
<td align="left" rowspan="1" colspan="1">9.8</td>
<td align="left" rowspan="1" colspan="1">10.30</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">315G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">19.11</td>
<td align="left" rowspan="1" colspan="1">6.85</td>
<td align="left" rowspan="1" colspan="1">10.64</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">168I315G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">14.78</td>
<td align="left" rowspan="1" colspan="1">16.39</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">331R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">11.77</td>
<td align="left" rowspan="1" colspan="1">7.37</td>
<td align="left" rowspan="1" colspan="1">9.17</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">186I331R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">13.68</td>
<td align="left" rowspan="1" colspan="1">15.85</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">302R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">11.1</td>
<td align="left" rowspan="1" colspan="1">7.75</td>
<td align="left" rowspan="1" colspan="1">9.23</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">302R315G</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">12.4</td>
<td align="left" rowspan="1" colspan="1">15.30</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">315G331R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">10.56</td>
<td align="left" rowspan="1" colspan="1">15.22</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">190I</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">41.52</td>
<td align="left" rowspan="1" colspan="1">8.2</td>
<td align="left" rowspan="1" colspan="1">11.41</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">190I302R</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">12.28</td>
<td align="left" rowspan="1" colspan="1">16.12</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">219Q</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">6.73</td>
<td align="left" rowspan="1" colspan="1">5.65</td>
<td align="left" rowspan="1" colspan="1">6.90</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">242N</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">8.68</td>
<td align="left" rowspan="1" colspan="1">6.7</td>
<td align="left" rowspan="1" colspan="1">8.05</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">219Q242N</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">10.8</td>
<td align="left" rowspan="1" colspan="1">8.04</td>
<td align="left" rowspan="1" colspan="1">10.07</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">146P</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">7.22</td>
<td align="left" rowspan="1" colspan="1">5.62</td>
<td align="left" rowspan="1" colspan="1">6.26</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">147L</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">3.42</td>
<td align="left" rowspan="1" colspan="1">4.25</td>
<td align="left" rowspan="1" colspan="1">6.54</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">146P147L</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">6.58</td>
<td align="left" rowspan="1" colspan="1">5.77</td>
<td align="left" rowspan="1" colspan="1">4.74</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">326S</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">4.59</td>
<td align="left" rowspan="1" colspan="1">4.78</td>
<td align="left" rowspan="1" colspan="1">5.69</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">310T326S</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">10.53</td>
<td align="left" rowspan="1" colspan="1">7.72</td>
<td align="left" rowspan="1" colspan="1">8.81</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">173T</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">5.92</td>
<td align="left" rowspan="1" colspan="1">5.81</td>
<td align="left" rowspan="1" colspan="1">7.02</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">173T286K</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">4.89</td>
<td align="left" rowspan="1" colspan="1">6.56</td>
<td align="left" rowspan="1" colspan="1">7.75</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">173T286K147L</td>
<td align="left" rowspan="1" colspan="1">p24</td>
<td align="left" rowspan="1" colspan="1">4.12</td>
<td align="left" rowspan="1" colspan="1">5.93</td>
<td align="left" rowspan="1" colspan="1">6.78</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">12K</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1">3.74</td>
<td align="left" rowspan="1" colspan="1">1.91</td>
<td align="left" rowspan="1" colspan="1">4.38</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">12K54A</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1">4.84</td>
<td align="left" rowspan="1" colspan="1">3.19</td>
<td align="left" rowspan="1" colspan="1">5.63</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">86F</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1">8</td>
<td align="left" rowspan="1" colspan="1">4.53</td>
<td align="left" rowspan="1" colspan="1">6.00</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">92M</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1">8.74</td>
<td align="left" rowspan="1" colspan="1">6.01</td>
<td align="left" rowspan="1" colspan="1">9.43</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">86F92M</td>
<td align="left" rowspan="1" colspan="1">p17</td>
<td align="left" rowspan="1" colspan="1">Infinity</td>
<td align="left" rowspan="1" colspan="1">9.52</td>
<td align="left" rowspan="1" colspan="1">12.57</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt104"><label>a</label><p>E is 2.98 for wild-type NL4-3 p24 and 3.43 for wild-type NL4-3 p17.</p></fn><fn id="nt105"><label>b</label><p>E is 3.67 for wild-type NL4-3 p24 and 1.64 for wild-type NL4-3 p17.</p></fn><fn id="nt106"><label>c</label><p>E is 4.43 for wild-type NL4-3 p24 and 2.81 for wild-type NL4-3 p17.</p></fn><fn id="nt107"><label>d</label><p>The 198V mutation was not observed within the MSA used to fit the Potts model, precluding the fitted model from assigning an energy to viral strains containing this point mutation.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3b">
<title>Experimental findings</title>
<p>The <italic>in vitro</italic> fitness measurements for all mutants, grouped according to categories, are shown in <xref ref-type="fig" rid="pcbi-1003776-g001">Figure 1</xref>. We initially compared our model predictions and fitness measurements for each category of mutant pairs to evaluate whether mutant combinations with high and low predicted E values corresponded to substantial fitness cost or little/no fitness cost, respectively.</p>
<fig id="pcbi-1003776-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003776.g001</object-id><label>Figure 1</label><caption>
<title>Replication capacities of NL4-3 viruses encoding mutations in HIV-1 Gag.</title>
<p>Graphs show replication capacities of NL4-3 viruses encoding (A) Gag p24 mutation pairs with high E values that were previously identified to be in vulnerable co-evolving groups <xref ref-type="bibr" rid="pcbi.1003776-Dahirel1">[12]</xref> and single mutations within these pairs; (B) Gag p24 HLA-associated pairs with high E values and single mutations within these pairs; (C) Gag p24 pairs/triple with low E values as well as single mutations within these combinations; and (D) Gag p17 pairs including single mutations within the pairs. Those mutants that (i) were not viable or (ii) were not viable unless further mutations developed (indicated with an asterisk), were assigned a replication capacity of zero. Mutation pairs and triples are shown in grey while single mutations within these combinations are shown in black. Replication capacities of mutant viruses are expressed relative to the replication capacity of wild-type NL4-3 virus (<italic>RC</italic> = 1). Bars represent the mean of three independent experiments and error bars represent standard deviation from the mean.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003776.g001" position="float" xlink:type="simple"/></fig>
<p>Briefly, all Gag p24 sector 3 mutation pairs with high E values were not viable in our assay system, and were assigned a replication capacity of zero (<xref ref-type="fig" rid="pcbi-1003776-g001">Figure 1A</xref>). Similarly, with the exception of 315G331R, the five high E HLA-associated mutation pairs showed substantial reduction in replication capacity, to between 0–56% of wild-type levels (<xref ref-type="fig" rid="pcbi-1003776-g001">Figure 1B</xref>). Non-viable mutants (<italic>RC</italic> = 0) were those for which the generation of virus stocks from plasmids encoding these mutation pairs failed, or, in two instances – mutants 186I295E and 186I331R – were not viable unless further mutations developed, confirming unfavorability of the mutation combination. Briefly, concentrated virus stocks for mutants 186I295E and 186I331R were harvested at &gt;22 days post-electroporation compared with the median harvesting time of 6 days post-electroporation for all mutants (at which time the 186I295E and 186I331R mutants had infected ≈1% cells). Sequencing of these viruses revealed the presence of additional mutations and/or reversion of introduced mutations. For mutant 186I295E, amino acid mixtures were detected at codons 63 (Q/R), 177 (D/E) and 186 (I/V), and for mutant 186I331R, mixtures were detected at codons 168 (I/V) and 331 (K/R), as well as reversion of 186I to 186T. On repeating virus generation for these mutants, additional mutations similarly developed – mixtures were observed at codons 214 (R/K) and 271 (N/S) for mutant 186I295E, and 232 (R/M) and 260 (D/E) for mutant 186I331R. With the exception of 186I295E and 186I331R, sequencing confirmed that all mutant viruses had only the specific mutations introduced. The spontaneous mutations 186V, 271S and 232M were not observed in the MSA and the new mutation combinations did not have lowered E values in any of the models, with the exception of the incomplete 186I331R260D combination (complete observed combination 186I, 331R, 232R/M, 260D/E) which displayed a slightly lower energy than 186I331R in the regularized Ising model only (11.5 vs. 13.7) (data not shown). Nevertheless, these observations confirm that 186I295E and 186I331R are unfit mutation combinations requiring compensatory paths to restore viability. Taken together, the data on high E p24 mutants confirm mutation combinations predicted to be unfit, and also identify combinations of HLA-associated mutations in/next to optimal CD8+ T cell epitopes (mutations likely to result in CD8+ T cell escape <xref ref-type="bibr" rid="pcbi.1003776-Goepfert1">[33]</xref>) that carry substantial fitness costs.</p>
<p>Those p24 mutation combinations, including known compensatory pairs, that were predicted to have low E values displayed replication capacities similar to that of wild-type NL4-3, indicating that these combinations had little or no cost to HIV-1 replication capacity in accordance with predictions (<xref ref-type="fig" rid="pcbi-1003776-g001">Figure 1C</xref>). Similarly, all p17 mutants tested had replication capacities close to that of the wild-type NL4-3 virus, consistent with the predicted E values of all mutants except 86F92M (<xref ref-type="fig" rid="pcbi-1003776-g001">Figure 1D</xref>).</p>
<p>Overall, for only two (86F92M and 315G331R) of the 17 mutant pairs the fitness measurement did not correspond to the E value prediction of high or low fitness cost. It should however be noted that the disparity between E values and measured replication capacities for these mutant pairs is somewhat mitigated in the regularized models. The E values for the regularized Ising model for these mutants (which were assigned an E value of infinity by the original Ising model) are lower than those of other mutants previously assigned infinite energies, and the same is true for mutant 86F92M in the regularized Potts model.</p>
</sec><sec id="s3c">
<title>Quantitative comparison between <italic>in silico</italic> predictions and <italic>in vitro</italic> measurements</title>
<p>Next, we assessed the relationship between fitness measurements and E values predicted by our original Ising, regularized Ising and regularized Potts models using Pearson's correlation tests. There is a strong correlation between the metric of fitness (values of E, <xref ref-type="table" rid="pcbi-1003776-t001">Table 1</xref>) predicted by the original unregularized Ising model and our experimental measurements (Pearson's correlation, <italic>r</italic> = −0.74 and <italic>p</italic> = 3.6×10<sup>−6</sup>, two-tailed) (<xref ref-type="fig" rid="pcbi-1003776-g002">Figure 2A</xref>), however this correlation out of necessity excludes mutants with E values equal to infinity (<italic>n</italic> = 13). The regularized Ising model allows for inclusion of these data points resulting in a stronger correlation between predictions and fitness measurements (Pearson's correlation, <italic>r</italic> = −0.83 and <italic>p</italic> = 3.7×10<sup>−12</sup>, two-tailed) (<xref ref-type="fig" rid="pcbi-1003776-g002">Figure 2B</xref>), which is slightly improved by focusing on Gag p24 mutants only (Pearson's correlation, <italic>r</italic> = −0.85 and <italic>p</italic> = 1.4×10<sup>−11</sup>, two-tailed). There is also a strong agreement between the residue-specific Potts model energies and replication capacity (Pearson's correlation, <italic>r</italic> = −0.73 and <italic>p</italic> = 9.7×10<sup>−9</sup>, two-tailed) (<xref ref-type="fig" rid="pcbi-1003776-g002">Figure 2C</xref>).</p>
<fig id="pcbi-1003776-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003776.g002</object-id><label>Figure 2</label><caption>
<title>Relationship between predicted E values and replicative capacities of HIV-1 NL4-3 Gag mutants.</title>
<p>Scatter plots showing strong correlations between measured replication capacities of mutants and E values predicted by (A) original Ising (Pearson's correlation, <italic>r</italic> = −0.74 and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e009" xlink:type="simple"/></inline-formula>, two-tailed test, <italic>n</italic> = 30), (B) regularized Ising (Pearson's correlation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e010" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e011" xlink:type="simple"/></inline-formula>, two-tailed test, <italic>n</italic> = 43) and (C) regularized Potts (Pearson's correlation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e012" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e013" xlink:type="simple"/></inline-formula>, two-tailed test, <italic>n</italic> = 41) models. In the original Ising model (panel A), mutants with E values of infinity (<italic>n</italic> = 13) are excluded from the correlation.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003776.g002" position="float" xlink:type="simple"/></fig>
<p>In practice, one may be concerned with a more coarse-grained measure of viral fitness: will a virus with a given sequence be able to replicate with similar efficiency to the wild-type, or will it be significantly impaired? To explore this point, we grouped the experimentally tested mutants into two categories, “fit” (<italic>RC</italic>≥0.5) and unfit (<italic>RC</italic>&lt;0.5), and tested the ability of the fitness landscape models to predict which class each sequence would belong to based on their E values. This was accomplished by fitting a linear classifier to the data using logistic regression (<xref ref-type="supplementary-material" rid="pcbi.1003776.s002">Text S1</xref>, Section 3.1). The regularized Ising model E classifier is highly accurate (91% accuracy at optimal threshold, <italic>AUROC</italic> = 0.93) – we observed a strong, significant difference in replication capacities between the mutants classified as unfit and those classified as fit (Mann-Whitney <italic>U</italic> = 32, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e014" xlink:type="simple"/></inline-formula>) (<xref ref-type="fig" rid="pcbi-1003776-g003">Figure 3A</xref>). Specifically, four mutants (86F92M, 190I, 190I302R and 243P) were not classified correctly. However, 190I302R, which was classified as unfit (<italic>E</italic> = 8.6), exhibited a fitness close to that of the 0.5 cutoff (<italic>RC</italic> = 0.56) and 243P, which displayed low fitness (<italic>RC</italic> = 0.36), had a predicted E value (<italic>E</italic> = 7.4) bordering on the classifier E value. The Potts model classifier also performs well (81% accuracy at optimal threshold, <italic>AUROC</italic> = 0.80), but provides a slightly weaker difference between the fit and unfit classes (Mann-Whitney <italic>U</italic> = 70, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003776.e015" xlink:type="simple"/></inline-formula>) (<xref ref-type="fig" rid="pcbi-1003776-g003">Figure 3B</xref>). Here, seven mutants were not classified correctly, including the same four not classified correctly by the regularized Ising model as well as mutants 174G, 181R, 269E and 315G331R. Similar to mutant 243P, mutants 174G, 181R and 269E were unfit (<italic>RC</italic> = 0) but had a predicted E values ranging from 7.3 to 7.7, fairly close to that of the classifier E value.</p>
<fig id="pcbi-1003776-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003776.g003</object-id><label>Figure 3</label><caption>
<title>Classification of HIV-1 NL4-3 Gag mutants as unfit/fit using predicted E values.</title>
<p>Graphs show the ability of E classifiers, predicted by regularized Ising (panel A) and Potts (panel B) models, to correctly classify HIV-1 NL4-3 Gag mutants into unfit (<italic>RC</italic>&lt;0.5) and fit (<italic>RC</italic>&gt;0.5) categories. The measured replication capacities of mutants classified as fit or unfit according to their predicted E values were compared with the Mann-Whitney test and p values are shown.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003776.g003" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s4">
<title>Discussion</title>
<p>In this study, we have substantially advanced our modeling approaches and tested the predictive power of these models by <italic>in vitro</italic> fitness measurements of HIV encoding various mutation combinations in the Gag protein. The <italic>in vitro</italic> functional data are overall in strong agreement with the viral fitness landscape models and support the capacity of these models to robustly predict both continuous and “coarse-grained” measures of HIV-1 <italic>in vitro</italic> replicative fitness. Performance of the regularized Potts and regularized Ising models here is similar, which is not unexpected as Gag in general is not highly mutable and the mutants tested here were the most common ones, making the binary approximation a fairly good assumption. Indeed, in instances where the binary approximation is valid, we might encounter <italic>poorer</italic> performance from the Potts model relative to the Ising due to a diminished ratio of samples (i.e., sequences in the MSA) to parameters (i.e., <italic>h</italic> and <italic>J</italic> values) making robust numerical fitting of the former more challenging than the latter. It is nevertheless encouraging that we are capable of fitting a significantly more complicated Potts model that retains residue-specific resolution without compromising the fidelity of our predictions. Improved inverse Potts inference methods which better meet these numerical challenges may also improve performance of the Potts model with respect to the Ising model results.</p>
<p>Simple theoretical analysis suggests that models which differentiate between different mutant amino acids at the same site, like the Potts model employed here, will be necessary to make fitness predictions for highly mutable proteins such as Env and Nef, or to predict the fitness of sequences containing sites with mutations to less frequently observed amino acids. Using a simple toy model, we show in <xref ref-type="supplementary-material" rid="pcbi.1003776.s002">Text S1</xref>, Section 3.4 that the binary approximation (Ising model) has several potential deficiencies compared to a Potts model. In particular, the Ising model generically overestimates the fitness of mutant sequences, particularly for sequences containing uncommon mutations. Also, in the Ising case the inferred interaction between mutations at different sites is dominated by the interaction between the most common mutants, while the Potts model is able to accurately capture interactions between rare mutants. Future work will involve testing Ising and Potts model predictions for more highly variable proteins and for mutations to uncommon amino acids.</p>
<p>While this study confirms the usefulness of this method for predicting HIV-1 replicative fitness, at least for closely related sequences, caution will be necessary in applying this method to predict the relative fitness of multiple strains separated by a large number of mutations. In the measure of prevalence used to infer the Ising and Potts model fitness landscapes, factors such as phylogeny are implicitly included. Analysis conducted in <xref ref-type="bibr" rid="pcbi.1003776-Shekhar1">[25]</xref> suggests that phylogenetic effects influence the value of the inferred fields h<sub>i</sub>, and that a correction should be included for predictions of energy or fitness. This form of a correction is sensible, as phylogenetic effects should make mutations at individual residues less frequent, leading to larger inferred fields. For closely related strains such as those studied here experimentally, any systematic inaccuracies in the energy due to phylogeny should be similar in magnitude, and thus <italic>differences</italic> in energy should predict relative replicative fitness fairly accurately. This would not necessarily be true, however, for sequences separated by many mutations. Further theoretical developments may be needed to separate out the contributions of phylogeny and intrinsic fitness from the Ising and Potts model landscapes presented here <xref ref-type="bibr" rid="pcbi.1003776-Shekhar1">[25]</xref> to predict the relative fitness of strains that differ by many mutations.</p>
<p>In addition to phylogeny, other factors such as host-pathogen interactions and pure stochastic fluctuations affect the observed distribution of sequences, and could complicate fitness predictions. In another work <xref ref-type="bibr" rid="pcbi.1003776-Shekhar1">[25]</xref> we have investigated these issues by carrying out stochastic simulations that aim to mimic the way the samples were collected and host-pathogen dynamics. In this paper, for the p17 protein, we found that the fitness and prevalence were not the same. However, the rank order of fitness and prevalence were the same as long as the strains being compared were not very far apart in sequence space. This is largely because of the diversity of immune responses due to diverse HLA types in the human population. Additionally, the number of virus particles in single infected individuals from whom the virus sequences were extracted is large, as is the number of patients from whom the virus samples were taken. We find that the one and two-point mutational probabilities in the sequence databases have converged <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>; i.e., these correlations do not change upon removal of some sequences, suppressing the effects fluctuations on the inferred model.</p>
<p>We also note that some caution should be taken in comparing E values for sequences belonging to different proteins. The fitness predictions of the Ising and Potts models are unchanged by a constant shift in energy for all sequences, thus comparisons of absolute energy values are not physically meaningful. Differences in energy between two sequences in the same protein, however, can be unambiguously interpreted as the fitness ratio of those sequences. This is the approach we have taken when examining E values from sequences with mutations in p17 and p24 together: rather than comparing the absolute energies, we compare the differences in energy between the mutant and the NL4-3 reference sequence in each protein, which reflect the fitness of the mutant relative to the NL4-3 reference sequence. Finally, translation from differences in energy to differences in fitness might depend on the specific protein that is being considered. While comparisons of energy differences and relative fitnesses of p17 and p24 mutants performed here exhibit no obvious incongruences, further study is needed to confirm the generality of fitness predictions across proteins.</p>
<p>In the case of two mutant pairs (186I295E and 186I331R) that were predicted by the models to have very low fitness, partial reversions and/or additional mutations spontaneously arose in culture that restored virus viability. However, with the exception of one of the spontaneous mutations (260D) observed in combination with 186I331R that modestly decreased the predicted energy (increased fitness) in the regularized Ising model but not the Potts or original Ising models, the models do not predict lower energies (increased fitness) for these mutant pairs in combination with the additional mutations arising <italic>in vitro</italic>. Further, three of the spontaneous mutations – 186V, 271S and 232M – were not observed in the MSA and therefore could not be assessed by the Potts model. As a possible interpretation of these findings, we suggest that it may be the case that these mutation patterns observed <italic>in vitro</italic> are not typically observed <italic>in vivo</italic>, perhaps since these are infrequently explored mutational routes. As a corollary, this could indicate an inherent limitation of computational models derived from clinical sequence data to identify all possible escape-compensatory pathways, and the importance of <italic>in vitro</italic> and <italic>in vivo</italic> experiments to validate and complement model predictions. A mitigating factor, of course, is that mutational pathways observed <italic>in vitro</italic> but not <italic>in vivo</italic> may be of less direct clinical relevance.</p>
<p>In future work, the model predictions will be further validated in animal models by testing the viable escape pathways predicted to emerge following immunization with immunogens containing vulnerable HIV-1 regions only. The validated fitness landscape could then be used to design vaccine immunogens containing epitopes from the vulnerable regions that could be presented by people with diverse HLAs and that target residues particularly harmful to HIV-1 when mutated simultaneously, thereby substantially diminishing viral fitness and/or blocking viable mutational escape <xref ref-type="bibr" rid="pcbi.1003776-Ferguson1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003776-Dahirel1">[12]</xref>. Such immunogens potentially represent good therapeutic vaccine candidates to overcome the challenge of HIV-1 evasion of CD8+ T cell responses. However, further work will also be required to optimize design of such immunogens to ensure that epitopes included are processed effectively and that they are sufficiently immunogenic, as well as to test their immunogenicity, optimal delivery methods and protection efficacy in animal models. Furthermore, fitness landscapes of HIV-1 proteins may also be more widely applied to identify effective antibody targets, and help design potent combinations of neutralizing antibodies for passive immunization as well as small molecule inhibitors for therapy.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003776.s001" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1003776.s001" position="float" xlink:type="simple"><label>Code S1</label><caption>
<p><bold>Source code for the inverse Potts algorithm.</bold> A compressed file containing source code and instructions for its installation and use, along with a set of test data for verifying proper functioning of the code and auxiliary Matlab scripts for computing correlations from a multiple sequence alignment.</p>
<p>(ZIP)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003776.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003776.s002" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Supplementary methods and figures.</bold> Details for sequence data processing and inference of the Ising (Section 1) and Potts models (Section 2) are given. Details on comparison with experimental results and comparison between Ising and Potts models are given in Section 3. A brief summary of statistical tests is presented in Section 4.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003776-McElrath1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McElrath</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Haynes</surname><given-names>BF</given-names></name> (<year>2010</year>) <article-title>Induction of Immunity to Human Immunodeficiency Virus Type-1 by Vaccination</article-title>. <source>Immunity</source> <volume>33</volume><supplement>(4)</supplement>: <fpage>542</fpage>–<lpage>554</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Walker1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walker</surname><given-names>BD</given-names></name>, <name name-style="western"><surname>Burton</surname><given-names>DR</given-names></name> (<year>2008</year>) <article-title>Towards an AIDS Vaccine</article-title>. <source>Science</source> <volume>320</volume><supplement>(5877)</supplement>: <fpage>760</fpage>–<lpage>764</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Korber1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Korber</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Gaschen</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Yusim</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Thakallapally</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kesmir</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Evolutionary and immunological implications of contemporary HIV-1 variation</article-title>. <source>Brit Med Bull</source> <volume>58</volume><supplement>(1)</supplement>: <fpage>19</fpage>–<lpage>42</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Johnston1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Johnston</surname><given-names>MI</given-names></name>, <name name-style="western"><surname>Fauci</surname><given-names>AS</given-names></name> (<year>2008</year>) <article-title>An HIV Vaccine — Challenges and Prospects</article-title>. <source>N Engl J Med</source> <volume>359</volume><supplement>(9)</supplement>: <fpage>888</fpage>–<lpage>890</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Koup1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koup</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Safrit</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Andrews</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>McLeod</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>1994</year>) <article-title>Temporal association of cellular immune responses with the initial control of viremia in primary human immunodeficiency virus type 1 syndrome</article-title>. <source>J Virol</source> <volume>68</volume><supplement>(7)</supplement>: <fpage>4650</fpage>–<lpage>4655</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Schmitz1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schmitz</surname><given-names>JE</given-names></name>, <name name-style="western"><surname>Kuroda</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Santra</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sasseville</surname><given-names>VG</given-names></name>, <name name-style="western"><surname>Simon</surname><given-names>MA</given-names></name>, <etal>et al</etal>. (<year>1999</year>) <article-title>Control of viremia in simian immunodeficiency virus infection by CD8+ lymphocytes</article-title>. <source>Science</source> <volume>283</volume><supplement>(5403)</supplement>: <fpage>857</fpage>–<lpage>860</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-McMichael1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McMichael</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Borrow</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Tomaras</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Goonetilleke</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Haynes</surname><given-names>BF</given-names></name> (<year>2010</year>) <article-title>The immune response during acute HIV-1 infection: clues for vaccine development</article-title>. <source>Nat Rev Immunol</source> <volume>10</volume><supplement>(1)</supplement>: <fpage>11</fpage>–<lpage>23</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Allen1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Allen</surname><given-names>TM</given-names></name>, <name name-style="western"><surname>Altfeld</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>Crippling HIV one mutation at a time</article-title>. <source>J Exp Med</source> <volume>205</volume><supplement>(5)</supplement>: <fpage>1003</fpage>–<lpage>1007</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Chopera1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chopera</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Wright</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Brockman</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Brumme</surname><given-names>ZL</given-names></name> (<year>2011</year>) <article-title>Immune-mediated attenuation of HIV-1</article-title>. <source>Future Virol</source> <volume>6</volume><supplement>(8)</supplement>: <fpage>917</fpage>–<lpage>928</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Troyer1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Troyer</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>McNevin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>SC</given-names></name>, <name name-style="western"><surname>Krizan</surname><given-names>RW</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Variable Fitness Impact of HIV-1 Escape Mutations to Cytotoxic T Lymphocyte (CTL) Response</article-title>. <source>PLoS Pathog</source> <volume>5</volume><supplement>(4)</supplement>: <fpage>1</fpage>–<lpage>13</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Ferguson1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ferguson</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Mann</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Omarjee</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ndung'u</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Walker</surname><given-names>BD</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Translating HIV sequences into quantitative fitness landscapes predicts viral vulnerabilities for rational immunogen design</article-title>. <source>Immunity</source> <volume>38</volume><supplement>(3)</supplement>: <fpage>606</fpage>–<lpage>617</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Dahirel1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dahirel</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Shekhar</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Pereyra</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Miura</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Artyomov</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Coordinate linkage of HIV evolution reveals regions of immunological vulnerability</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>108</volume><supplement>(28)</supplement>: <fpage>11530</fpage>–<lpage>11535</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Plerou1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Plerou</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Gopikrishnan</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Rosenow</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Amaral</surname><given-names>LA</given-names></name>, <name name-style="western"><surname>Guhr</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>Random matrix approach to cross correlations in financial data</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source> <volume>65</volume><supplement>(6 Pt 2)</supplement>: <fpage>066126</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Halabi1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Halabi</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Rivoire</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ranganathan</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Protein sectors: evolutionary units of three-dimensional structure</article-title>. <source>Cell</source> <volume>138</volume><supplement>(4)</supplement>: <fpage>774</fpage>–<lpage>786</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Laloux1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Laloux</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Cizeau</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Bouchaud</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Potters</surname><given-names>M</given-names></name> (<year>1999</year>) <article-title>Noise dressing of financial correlation matrices</article-title>. <source>Phys Rev Lett</source> <volume>83</volume>: <fpage>1467</fpage>–<lpage>1470</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Roudi1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roudi</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Tyrcha</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hertz</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Ising model for neural data: model quality and approximate methods for extracting functional connectivity</article-title>. <source>Phys Rev E</source> <volume>79</volume>: <fpage>051915</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Mora1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mora</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name> (<year>2011</year>) <article-title>Are biological systems poised at criticality?</article-title> <source>J Stat Phys</source> <volume>144</volume>: <fpage>268</fpage>–<lpage>302</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Cocco1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cocco</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Monasson</surname><given-names>R</given-names></name> (<year>2012</year>) <article-title>Adaptive cluster expansion for the inverse Ising problem: convergence, algorithm, and tests</article-title>. <source>J Stat Phys</source> <volume>147</volume><supplement>(2)</supplement>: <fpage>252</fpage>–<lpage>314</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Cocco2"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cocco</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Monasson</surname><given-names>R</given-names></name> (<year>2011</year>) <article-title>Adaptive cluster expansion for inferring Boltzmann machines with noisy data</article-title>. <source>Phys Rev Lett</source> <volume>106</volume>: <fpage>90601</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Weigt1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Weigt</surname><given-names>M</given-names></name>, <name name-style="western"><surname>White</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Szurmant</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Hoch</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Hwa</surname><given-names>T</given-names></name> (<year>2009</year>) <article-title>Identification of direct residue contacts in protein–protein interaction by message passing</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>106</volume>: <fpage>67</fpage>–<lpage>72</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Morcos1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morcos</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Pagnani</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lunt</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bertolino</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Marks</surname><given-names>DS</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>108</volume>: <fpage>E1293</fpage>–<lpage>E1301</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Jaynes1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jaynes</surname><given-names>ET</given-names></name> (<year>1957</year>) <article-title>Information theory and statistical mechanics</article-title>. <source>Phys Rev</source> <volume>106</volume>: <fpage>620</fpage>–<lpage>630</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Sella1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sella</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Hirsh</surname><given-names>AE</given-names></name> (<year>2005</year>) <article-title>The application of statistical physics to evolutionary biology</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>102</volume>: <fpage>9541</fpage>–<lpage>9546</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Wilke1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilke</surname><given-names>CO</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Ofria</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lenski</surname><given-names>RE</given-names></name>, <name name-style="western"><surname>Adami</surname><given-names>C</given-names></name> (<year>2001</year>) <article-title>Evolution of digital organisms at high mutation rates leads to survival of the flattest</article-title>. <source>Nature</source> <volume>412</volume><supplement>(6844)</supplement>: <fpage>331</fpage>–<lpage>333</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Shekhar1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shekhar</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Ruberman</surname><given-names>CF</given-names></name>, <name name-style="western"><surname>Ferguson</surname><given-names>AL</given-names></name>, <name name-style="western"><surname>Barton</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Kardar</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Spin models inferred from patient data faithfully describe HIV fitness landscapes and enable rational vaccine design</article-title>. <source>Phys Rev E</source> <volume>88</volume><supplement>(6)</supplement>: <fpage>062705</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Binder1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Binder</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Young</surname><given-names>AP</given-names></name> (<year>1986</year>) <article-title>Spin glasses: experimental facts, theoretical concepts, and open questions</article-title>. <source>Rev Mod Phys</source> <volume>58</volume>: <fpage>801</fpage>–<lpage>976</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Wu1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>FY</given-names></name> (<year>1982</year>) <article-title>The Potts model</article-title>. <source>Rev Mod Phys</source> <volume>54</volume>: <fpage>235</fpage>–<lpage>268</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Lezon1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lezon</surname><given-names>TR</given-names></name>, <name name-style="western"><surname>Banavar</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Cieplak</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Maritan</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Fedoroff</surname><given-names>NV</given-names></name> (<year>2006</year>) <article-title>Using the principle of entropy maximization to infer genetic interaction networks from gene expression patterns</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>103</volume>: <fpage>19033</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Roudi2"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roudi</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Aurell</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Hertz</surname><given-names>JA</given-names></name> (<year>2009</year>) <article-title>Statistical physics of pairwise probability models</article-title>. <source>Front Comput Neurosci</source> <volume>3</volume>: <fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Barton1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barton</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Cocco</surname><given-names>S</given-names></name> (<year>2013</year>) <article-title>Ising models for neural activity inferred via selective cluster expansion: structural and coding properties</article-title>. <source>J Stat Mech</source> <volume>03</volume>: <fpage>P03002</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Sivia1"><label>31</label>
<mixed-citation publication-type="book" xlink:type="simple">Sivia DS, Skilling J (2006) Data analysis: a Bayesian tutorial. 2nd edition. USA: Oxford University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Gruber1"><label>32</label>
<mixed-citation publication-type="book" xlink:type="simple">Gruber MHJ (2010) Regression Estimators: A Comparative Study. Second Edition. Baltimore, Maryland: JHU Press.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Goepfert1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goepfert</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Lumm</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Farmer</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Matthews</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Prendergast</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Transmission of HIV-1 Gag immune escape mutations is associated with reduced viral load in linked recipients</article-title>. <source>J Exp Med</source> <volume>205</volume>: <fpage>1009</fpage>–<lpage>1017</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Brumme1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brumme</surname><given-names>ZL</given-names></name>, <name name-style="western"><surname>John</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Carlson</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Brumme</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Chan</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>HLA-Associated Immune Escape Pathways in HIV-1 Subtype B Gag, Pol and Nef Proteins</article-title>. <source>PLoS One</source> <volume>4</volume><supplement>(8)</supplement>: <fpage>e6687</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Wright1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Brumme</surname><given-names>ZL</given-names></name>, <name name-style="western"><surname>Carlson</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Kadie</surname><given-names>CM</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Gag-Protease-Mediated Replication Capacity in HIV-1 Subtype C Chronic Infection: Associations with HLA Type and Clinical Parameters</article-title>. <source>J Virol</source> <volume>84</volume><supplement>(20)</supplement>: <fpage>10820</fpage>–<lpage>10831</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Los1"><label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Los Alamos National Laboratory. HIV Molecular Immunology Database. <ext-link ext-link-type="uri" xlink:href="http://www.hiv.lanl.gov/content/immunology/" xlink:type="simple">http://www.hiv.lanl.gov/content/immunology/</ext-link> [Accessed 01/09/2011].</mixed-citation>
</ref>
<ref id="pcbi.1003776-Brockman1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brockman</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Schneidewind</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lahaie</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Schmidt</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Miura</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Escape and Compensation from Early HLA-B57-Mediated Cytotoxic T-Lymphocyte Pressure on Human Immunodeficiency Virus Type 1 Gag Alter Capsid Interactions with Cyclophilin A</article-title>. <source>J Virol</source> <volume>81</volume><supplement>(22)</supplement>: <fpage>12608</fpage>–<lpage>12618</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003776-Wright2"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wright</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Naidoo</surname><given-names>VL</given-names></name>, <name name-style="western"><surname>Brumme</surname><given-names>ZL</given-names></name>, <name name-style="western"><surname>Prince</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Claiborne</surname><given-names>DT</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Impact of HLA-B*81-Associated Mutations in HIV-1 Gag on Viral Replication Capacity</article-title>. <source>J Virol</source> <volume>86</volume><supplement>(6)</supplement>: <fpage>3193</fpage>–<lpage>3199</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>