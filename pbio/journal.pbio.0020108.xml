<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pbio</journal-id><journal-id journal-id-type="nlm-ta">PLoS Biol</journal-id><journal-id journal-id-type="pmc">plosbiol</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Biology</journal-title></journal-title-group><issn pub-type="ppub">1544-9173</issn><issn pub-type="epub">1545-7885</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="doi">10.1371/journal.pbio.0020108</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
          <subject>Oncology</subject>
          <subject>Genetics and Genomics</subject>
        </subj-group>
        <subj-group subj-group-type="System Taxonomy">
          <subject>Homo (human)</subject>
        </subj-group>
      </article-categories><title-group><article-title>Semi-Supervised Methods to Predict Patient Survival from Gene Expression Data</article-title><alt-title alt-title-type="running-head">Methods to Predict Patient Survival</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Bair</surname>
            <given-names>Eric</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Tibshirani</surname>
            <given-names>Robert</given-names>
          </name>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label>
        
        <addr-line>Department of Statistics, Stanford University, Palo Alto, California, United States of America</addr-line>
        
      </aff><aff id="aff2"><label>2</label>
        
        <addr-line>Department of Heath and Research Policy, Stanford University, Palo Alto, California, United States of America</addr-line>
        
      </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Todd Golub</surname>
          </name>
          <role>Academic Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">Dana-Farber Cancer Institute</aff><author-notes>
        <corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">ebair@stanford.edu</email></corresp>
        <fn fn-type="con" id="n2">
          <p> EB and RT conceived and designed the experiments. EB performed the experiments and analyzed the data. EB and RT contributed reagents/materials/analysis tools. EB wrote the paper.</p>
        </fn>
      <fn fn-type="conflict" id="n1">
        <p> The authors have declared that no conflicts of interest exist.</p>
      </fn></author-notes><pub-date pub-type="ppub">
        <month>4</month>
        <year>2004</year>
      </pub-date><pub-date pub-type="epub">
        <day>13</day>
        <month>4</month>
        <year>2004</year>
      </pub-date><volume>2</volume><issue>4</issue><elocation-id>e108</elocation-id><history>
        <date date-type="received">
          <day>18</day>
          <month>7</month>
          <year>2003</year>
        </date>
        <date date-type="accepted">
          <day>10</day>
          <month>2</month>
          <year>2004</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2004</copyright-year><copyright-holder>Bair and Tibshirani</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.</license-p></license></permissions><related-article page="e118" related-article-type="companion" vol="2" xlink:href="info:doi/10.1371/journal.pbio.0020118" xlink:title="synopsis" xlink:type="simple">
        <article-title>Predicting Cancer Patient Survival with Gene Expression Data</article-title>
      </related-article><abstract>
        <p>An important goal of DNA microarray research is to develop tools to diagnose cancer more accurately based on the genetic profile of a tumor. There are several existing techniques in the literature for performing this type of diagnosis. Unfortunately, most of these techniques assume that different subtypes of cancer are already known to exist. Their utility is limited when such subtypes have not been previously identified. Although methods for identifying such subtypes exist, these methods do not work well for all datasets. It would be desirable to develop a procedure to find such subtypes that is applicable in a wide variety of circumstances. Even if no information is known about possible subtypes of a certain form of cancer, clinical information about the patients, such as their survival time, is often available. In this study, we develop some procedures that utilize both the gene expression data and the clinical data to identify subtypes of cancer and use this knowledge to diagnose future patients. These procedures were successfully applied to several publicly available datasets. We present diagnostic procedures that accurately predict the survival of future patients based on the gene expression profile and survival times of previous patients. This has the potential to be a powerful tool for diagnosing and treating cancer.</p>
      </abstract><abstract abstract-type="toc">
        <p>Procedures that utilize both gene expression data and clinical data to identify subtypes of cancer can provide more accurate prognoses.</p>
      </abstract></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <sec id="s1a">
        <title>Predicting Patient Survival</title>
        <p>When a patient is diagnosed with cancer, various clinical parameters are used to assess the patient's risk profile. However, patients with a similar prognosis frequently respond very differently to the same treatment. This may occur because two apparently similar tumors are actually completely different diseases at the molecular level (<xref ref-type="bibr" rid="pbio-0020108-Alizadeh1">Alizadeh et al. 2000</xref>; <xref ref-type="bibr" rid="pbio-0020108-Sorlie1">Sorlie et al. 2001</xref>; <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-Bullinger1">Bullinger et al. 2004</xref>; <xref ref-type="bibr" rid="pbio-0020108-Lapointe1">Lapointe et al. 2004</xref>).</p>
        <p>The main example discussed in this paper concerns diffuse large B-cell lymphoma (DLBCL). This is the most common type of lymphoma in adults, and it can be treated by chemotherapy in only approximately 40% of patients (<xref ref-type="bibr" rid="pbio-0020108-NHLCP1">NHLCP 1997</xref>; <xref ref-type="bibr" rid="pbio-0020108-Vose1">Vose 1998</xref>; <xref ref-type="bibr" rid="pbio-0020108-Coiffier1">Coiffier 2001</xref>). Several recent studies used DNA microarrays to study the gene expression profiles of patients with DLBCL. They found that it is possible to identify subgroups of patients with different survival rates based on gene expression data (<xref ref-type="bibr" rid="pbio-0020108-Alizadeh1">Alizadeh et al. 2000</xref>; <xref ref-type="bibr" rid="pbio-0020108-Rosenwald1">Rosenwald et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-Shipp1">Shipp et al. 2002</xref>).</p>
        <p>If different subtypes of cancer are known to exist, there are a variety of existing techniques that can be used to identify which subtype is present in a given patient (<xref ref-type="bibr" rid="pbio-0020108-Golub1">Golub et al. 1999</xref>; <xref ref-type="bibr" rid="pbio-0020108-Hastie1">Hastie et al. 2001a</xref>; <xref ref-type="bibr" rid="pbio-0020108-Hedenfalk1">Hedenfalk et al. 2001</xref>; <xref ref-type="bibr" rid="pbio-0020108-Khan1">Khan et al. 2001</xref>; <xref ref-type="bibr" rid="pbio-0020108-Ramaswamy1">Ramaswamy et al. 2001</xref>; <xref ref-type="bibr" rid="pbio-0020108-Nguyen1">Nguyen and Rocke 2002a</xref>, <xref ref-type="bibr" rid="pbio-0020108-Nguyen2">2002b</xref>; <xref ref-type="bibr" rid="pbio-0020108-Shipp1">Shipp et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-Tibshirani1">Tibshirani et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-Nutt1">Nutt et al. 2003</xref>). However, most of these techniques are only applicable when the tumor subtypes are known in advance. The question of how to identify such subtypes, however, is still largely unanswered.</p>
        <p>There are two main approaches in the literature to identify such subtypes. One approach uses unsupervised learning techniques, such as hierarchical clustering, to identify patient subgroups. This type of procedure is called “unsupervised” since it does not use any of the clinical information about the patient. The subgroups are identified using only the gene expression data. (In contrast, “supervised learning” would use the clinical data to build the model.) For an overview of unsupervised learning techniques, see <xref ref-type="bibr" rid="pbio-0020108-Gordon1">Gordon (1999</xref>) or <xref ref-type="bibr" rid="pbio-0020108-Hastie2">Hastie et al. (2001b</xref>).</p>
        <p>Hierarchical clustering (<xref ref-type="bibr" rid="pbio-0020108-Eisen1">Eisen et al. 1998</xref>) has successfully identified clinically relevant cancer subtypes in several different studies (<xref ref-type="bibr" rid="pbio-0020108-Alizadeh1">Alizadeh et al. 2000</xref>; <xref ref-type="bibr" rid="pbio-0020108-Bhattacharjee1">Bhattacharjee et al. 2001</xref>; <xref ref-type="bibr" rid="pbio-0020108-Sorlie1">Sorlie et al. 2001</xref>; <xref ref-type="bibr" rid="pbio-0020108-Beer1">Beer et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-Lapointe1">Lapointe et al. 2004</xref>). However, one drawback to unsupervised learning procedures is that they may identify cancer subtypes that are unrelated to patient survival. Although several different subtypes of a given cancer may exist, if the prognosis for all patients is the same regardless of which subtype they have, then the utility of this information is limited. Since unsupervised learning procedures by definition do not use the clinical data to identify subtypes, there is no guarantee that the subtypes they identify will be correlated with the clinical outcome.</p>
        <p>The second approach to identifying subtypes of cancer is based exclusively on the clinical data. For example, patients can be assigned to a “low-risk” or a “high-risk” subgroup based on whether they were still alive or whether their tumor had metastasized after a certain amount of time. This approach has also been used successfully to develop procedures to diagnose patients (<xref ref-type="bibr" rid="pbio-0020108-Shipp1">Shipp et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. 2002</xref>).</p>
        <p>However, by dividing the patients into subgroups based on their survival times, the resulting subgroups may not be biologically meaningful. Suppose, for example, that there are two tumor cell types. Suppose further that patients with cell type 2 live slightly longer than patients with cell type 1 but that there is considerable overlap between the two groups (<xref ref-type="fig" rid="pbio-0020108-g001">Figure 1</xref>). Assume also that the underlying cell types of each patient are unknown. If we were to assign patients to “low-risk” and “high-risk” groups based on their survival times, many patients would be assigned to the wrong group, and any future predictions based on this model would be suspect. We can obtain more accurate predictions by identifying these underlying subtypes and building a model that can determine which subtype is present in future patients.</p>
        <fig id="pbio-0020108-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pbio.0020108.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Two Patient Subgroups with Overlapping Survival Times</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.g001" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s1b">
        <title>Proposed Semi-Supervised Methods</title>
        <p>To overcome these difficulties, we propose a novel procedure that combines both the gene expression data and the clinical data to identify cancer subtypes. The crux of the idea is to use the clinical data to identify a list of genes that correlate with the clinical variable of interest and then apply unsupervised clustering techniques to this subset of the genes.</p>
        <p>For instance, in many studies, the survival times of the patients are known even though no tumor subtypes have been identified (<xref ref-type="bibr" rid="pbio-0020108-Alizadeh1">Alizadeh et al. 2000</xref>; <xref ref-type="bibr" rid="pbio-0020108-Bhattacharjee1">Bhattacharjee et al. 2001</xref>; <xref ref-type="bibr" rid="pbio-0020108-Sorlie1">Sorlie et al. 2001</xref>; <xref ref-type="bibr" rid="pbio-0020108-Beer1">Beer et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-Rosenwald1">Rosenwald et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-Shipp1">Shipp et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. 2002</xref>; <xref ref-type="bibr" rid="pbio-0020108-Nutt1">Nutt et al. 2003</xref>; <xref ref-type="bibr" rid="pbio-0020108-Bullinger1">Bullinger et al. 2004</xref>). We can calculate the Cox score for each gene in the expression data—the Cox score measures the correlation between the gene's expression level and patient survival—and consider only the genes with a Cox score that exceeds a certain threshold.</p>
        <p>Once such a list of significant genes is compiled, there are several methods we can use to identify clinical subgroups. We can apply clustering techniques to identify subgroups of patients with similar expression profiles. Once such subgroups are identified, we can apply existing supervised learning techniques to classify future patients into the appropriate subgroup. In this study, we will use the “nearest shrunken centroids” procedure of <xref ref-type="bibr" rid="pbio-0020108-Tibshirani1">Tibshirani et al. (2002</xref>), which is implemented in the package PAM (<xref ref-type="bibr" rid="pbio-0020108-Tibshirani2">Tibshirani et al. 2003</xref>). For a brief description of the procedure, see “<xref ref-type="sec" rid="s4">Materials and Methods</xref>.”</p>
        <p>Sometimes, however, a continuous predictor of survival is desired. We also describe a supervised version of principal components analysis that can be used to calculate a continuous risk score for a given patient and identify subtypes of cancer. The resulting predictor performs very well when applied to several published datasets.</p>
        <p>These two methods will produce satisfactory results in most datasets. However, we will describe some variations of these methods that can sometimes improve their performance. When we cluster a dataset using only a subset of the genes, it is important that we choose the correct subset of genes. Choosing the genes with the largest Cox scores is generally a good strategy, but this procedure sometimes selects some spurious genes. We will show that one can use partial least squares (PLS) to compute a “corrected” Cox score. Selecting the genes with the largest “corrected” Cox scores can produce better clusters than selecting genes with largest raw Cox scores. Additionally, we will describe two other continuous predictors of survival that we will call β̃ and γ̂. For some problems, they are better predictors than the continuous predictor based on supervised principal components (<xref ref-type="supplementary-material" rid="sg001">Figures S1–S3</xref>). These methods are described in <xref ref-type="supplementary-material" rid="sd018">Protocol S1</xref>.</p>
      </sec>
      <sec id="s1c">
        <title>Related Methods in the Literature</title>
        <p><xref ref-type="bibr" rid="pbio-0020108-Ben-Dor1">Ben-Dor et al. (2001</xref>) and <xref ref-type="bibr" rid="pbio-0020108-von1">von Heydebreck et al. (2001</xref>) attempt to identify biologically meaningful tumor subtypes from gene expression data by clustering on a subset of the genes. The important distinction between these methods and our semi-supervised clustering method is that our method uses the available clinical data to choose the subset of the genes that is used to perform the clustering. The methods of <xref ref-type="bibr" rid="pbio-0020108-von1">von Heydebreck et al. (2001</xref>) and <xref ref-type="bibr" rid="pbio-0020108-Ben-Dor1">Ben-Dor et al. (2001</xref>) do not use this clinical information. We will show that utilizing the available clinical data can improve the quality of the clustering.</p>
        <p>There are also related methods for predicting the survival of cancer patients using gene expression data. <xref ref-type="bibr" rid="pbio-0020108-Nguyen1">Nguyen and Rocke (2002a</xref>) use a form of PLS to predict survival. <xref ref-type="bibr" rid="pbio-0020108-Li1">Li and Luan (2003</xref>) use support vector machines (SVMs). However, a drawback of these methods is the fact that they use a combination of all of the genes to predict survival. Since the vast majority of the genes in a given dataset are unrelated to survival, the result is that many of the inputs to the model are superfluous, which reduces the predictive accuracy of the model. We will show that our semi-supervised methods, which use only a subset of the genes, generally perform better than these methods.</p>
        <p>Moreover, in many applications, we would like to identify which genes are the best predictors of survival. These genes could be analyzed in the laboratory to attempt to discover how they influence survival. They could also be used to develop a diagnostic test based on immunostaining or reverse transcriptase PCR. For these applications, it is important to have a predictor of survival that is based on a small subset of the genes. This is another important advantage of our methods over existing methods.</p>
        <p><xref ref-type="bibr" rid="pbio-0020108-Beer1">Beer et al. (2002</xref>) utilized an ad hoc method that fit a series of univariate Cox proportional hazards models and took a linear combination of the resulting coefficients. A brief description of their method is given in <xref ref-type="supplementary-material" rid="sd018">Protocol S1</xref>. This method is similar to our methods in that it selects a relevant subset of genes by choosing the genes with the largest Cox scores. However, this method is a purely supervised procedure. It does not apply any unsupervised methods (such as clustering or principal components analysis) to this subset of genes to identify additional patterns in the data. We will show that our semi-supervised procedures generally perform better than this method.</p>
      </sec>
      <sec id="s1d">
        <title>Summary</title>
        <p>Our goal is to identify subtypes of cancer that are both clinically relevant and biologically meaningful. Suppose that we have 𝓃 patients, and we measure the expression level of <italic>p</italic> genes for each patient. (Note that 𝓃 ≫ <italic>p</italic>.) We assume that there are several different types (classes) of cancer, each of which responds differently to treatment, and each of which is distinct at the molecular level. Therefore, given a set of 𝓃 patients with different classes of cancer, we wish to train a classifier that can diagnose which type of cancer a future patient has, given the expression levels of the patient's <italic>p</italic> genes. We will show that it is possible to identify such subgroups using the semi-supervised learning techniques described in the previous paragraph, and that identification of such subgroups can enable us to predict the clinical outcome of cancer more accurately.</p>
      </sec>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Fully Unsupervised Clustering</title>
        <p>As noted in the Introduction, we needed to assign each patient to a subgroup before we could apply nearest shrunken centroids. First, we applied an unsupervised 2-means clustering procedure to the DLBCL data of <xref ref-type="bibr" rid="pbio-0020108-Rosenwald1">Rosenwald et al. (2002</xref>). This dataset consisted of measurements on 7399 genes from 240 patients. Of these 240 patients, 160 were used for training the model and 80 were reserved for validating the model. A survival time was given for each patient, which ranged between 0 and 21.8 y.</p>
        <p>We compared the survival times of the two subgroups using a log-rank test. The log-rank test statistic was 0.7, with a corresponding <italic>p-</italic>value of 0.416. Thus, conventional clustering techniques failed to identify subgroups that differed with respect to their survival times. Subgroups identified using hierarchical clustering also did not differ with respect to survival (data not shown).</p>
      </sec>
      <sec id="s2b">
        <title>Using Clinical Data Alone to Generate Class Labels</title>
        <p>We assigned each patient in the training data to either a “low-risk” or “high-risk” subgroup based on their survival time (see “<xref ref-type="sec" rid="s4">Materials and Methods</xref>” for details.) After applying nearest shrunken centroids with crossvalidation, we selected a model that used 249 genes. We then used this model to assign each patient in the independent test data to the “low-risk” or “high-risk” group. The plots of the two survival curves associated with the two classes generated by the model are shown in <xref ref-type="fig" rid="pbio-0020108-g002">Figure 2</xref>. The <italic>p</italic>-value of the log-rank test was 0.03.</p>
        <fig id="pbio-0020108-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pbio.0020108.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Comparison of the Survival Curves of the “Low-Risk” and “High-Risk” Groups</title>
            <p>These were obtained by applying nearest shrunken centroids to the DLBCL test data. Patients in the training data were assigned to either the “low-risk” or “high-risk” group depending on whether or not their survival time was greater than the median survival time of all the patients.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.g002" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2c">
        <title>Supervised Clustering</title>
        <p>In order to identify tumor subclasses that were both biologically meaningful and clinically relevant, we applied a novel, supervised clustering procedure to the DLBCL data. We ranked all of the genes based on their univariate Cox proportional hazards scores, and performed clustering using only the “most significant” genes.</p>
        <p>Recall that when we performed 2-means clustering on the patients in the test data using all 7,399 genes and used a log-rank test to compare the survival times of the patients in the two resulting clusters, the result was not significant. To test our new clustering method, we calculated the Cox scores of all 7,399 genes based on the 160 training observations and ranked the genes from largest to smallest based on their absolute Cox scores. We then clustered the 80 test observations using only the 25 top-scoring genes. This time, the log-rank statistic comparing the survival times of the two clusters was highly significant ( <italic>p</italic> = 0.0001). A plot of the two resulting survival curves is shown in <xref ref-type="fig" rid="pbio-0020108-g003">Figure 3</xref>. A plot of the survival curves that we obtained by applying 2-means clustering to all of the genes is also shown for comparison.</p>
        <fig id="pbio-0020108-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pbio.0020108.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Comparison of the Survival Curves Resulting from Applying Two Different Clustering Methods to the DLBCL Data</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.g003" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2d">
        <title>Other Clustering Methods</title>
        <p>Both <xref ref-type="bibr" rid="pbio-0020108-Ben-Dor1">Ben-Dor et al. (2001</xref>) and <xref ref-type="bibr" rid="pbio-0020108-von1">von Heydebreck et al. (2001</xref>) used a subset of the genes to try to cluster a microarray dataset in a biologically meaningful manner. They observed that clustering using a subset of the genes can produce better results than using all of the genes. However, these methods were still fully unsupervised since they used only the gene expression data to perform the clustering. They did not use the clinical data to identify subgroups.</p>
        <p>Although these methods do a better job of identifying biologically meaningful clusters than clustering based on all of the genes, there is no guarantee that the clusters thus identified are associated with the clinical outcome of interest. Indeed, both <xref ref-type="bibr" rid="pbio-0020108-Ben-Dor1">Ben-Dor et al. (2001</xref>) and <xref ref-type="bibr" rid="pbio-0020108-von1">von Heydebreck et al. (2001</xref>) applied their procedures to a small DLBCL dataset of 40 patients (<xref ref-type="bibr" rid="pbio-0020108-Alizadeh1">Alizadeh et al. 2000</xref>). The clusters they identified did not (with a few exceptions) differ significantly from one another with respect to survival.</p>
        <p>We applied the clustering procedure of <xref ref-type="bibr" rid="pbio-0020108-von1">von Heydebreck et al. (2001</xref>) to the larger DLBCL dataset of <xref ref-type="bibr" rid="pbio-0020108-Rosenwald1">Rosenwald et al. (2002</xref>). <xref ref-type="fig" rid="pbio-0020108-g004">Figure 4</xref> shows the survival curves of the two clusters generated using this method. The survival curves generated by clustering on the genes with the largest Cox scores are included for comparison. Note that the two subgroups identified using the clustering procedure of <xref ref-type="bibr" rid="pbio-0020108-von1">von Heydebreck et al. (2001</xref>) do not differ significantly with respect to survival.</p>
        <fig id="pbio-0020108-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pbio.0020108.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Comparison of the Survival Curves Resulting from Applying Two Different Clustering Methods to the DLBCL Data</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.g004" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2e">
        <title>Survival Diagnosis</title>
        <p>We showed that the cancer subgroups identified using this supervised clustering method can be used to predict survival in future patients. The idea is straightforward. First, we identified subgroups of patients using supervised clustering. Then we trained a nearest shrunken centroid classifier to predict the subgroup to which each patient belonged. Details are given in “<xref ref-type="sec" rid="s4">Material and Methods</xref>.”</p>
        <p>We tested this procedure on the DLBCL data. A clustering based on 343 genes produced the smallest crossvalidation error rate, so we used a classifier based on this clustering to assign each of the 80 test patients to one of the two subgroups. The survival curves of the two predicted subgroups are shown in <xref ref-type="fig" rid="pbio-0020108-g005">Figure 5</xref>; the <italic>p</italic>-value of the log-rank test comparing the two survival curves is 0.008.</p>
        <fig id="pbio-0020108-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pbio.0020108.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Survival Curves for Clusters Derived from the DLBCL Data</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.g005" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2f">
        <title>Supervised Principal Components</title>
        <p>We used a form of the principal components of the expression matrix to predict survival. Principal components analysis is an unsupervised learning technique that is used to reduce the dimensionality of a dataset by calculating a series of “principal components.” The hope is that the first few principal components will summarize a large percentage of the variability in the entire dataset. See <xref ref-type="bibr" rid="pbio-0020108-Hastie2">Hastie et al. (2001b</xref>) for a description of principal components analysis.</p>
        <p>Unfortunately, principal components analysis suffers from the same limitations as purely unsupervised clustering. If we perform principal components analysis using all of the genes in a dataset, there is no guarantee that the resulting principal components will be associated with survival. Thus, we propose a semi-supervised form of principal components analysis that we call “supervised principal components.” Rather than using all of the genes when we perform principal components analysis, we use only a subset of the genes that are correlated with survival.</p>
        <p>Using the 160 training observations, we computed the Cox scores for each gene. We kept the 17 genes with Cox scores of 2.39 or greater. We calculated the principal components of the training data using only these 17 genes. Then we approximated the principal components of the test data using <xref ref-type="disp-formula" rid="pbio-0020108-e011">equation (11)</xref> (see “<xref ref-type="sec" rid="s4">Materials and Methods</xref>” for details.)</p>
        <p><xref ref-type="fig" rid="pbio-0020108-g006">Figure 6</xref> shows that there does appear to be a correlation between the value of the first principal component, υ̂I<sub>1</sub>, and patient survival. To confirm this observation, we fit a Cox proportional hazards model to a linear combination of υ̂I<sub>1</sub> and υ̂I<sub>2</sub>, the estimated first and second principal components of the test data, respectively. (See “<xref ref-type="sec" rid="s4">Materials and Methods</xref>” for a description of how this linear combination was obtained.) The resulting sum was a significant predictor of survival (<italic>R</italic><sup>2</sup> = 0.113, likelihood ratio test statistic = 9.58, 1 d.f., <italic>p</italic> = 0.00197). This predictor is stronger than the discrete predictor shown in <xref ref-type="fig" rid="pbio-0020108-g005">Figure 5</xref> (<italic>R</italic><sup>2</sup> = 0.08, likelihood ratio test statistic = 6.7, 1 d.f., <italic>p</italic> = 0.00966).</p>
        <fig id="pbio-0020108-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pbio.0020108.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Plot of Survival Versus the Predictor υ̂I for the DLBCL Data</title>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.g006" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2g">
        <title>A Breast Cancer Example</title>
        <p>Thus far, all of our examples have been based on the DLBCL data of <xref ref-type="bibr" rid="pbio-0020108-Rosenwald1">Rosenwald et al. (2002</xref>). We now apply our methodology to a set of breast cancer microarray data. In a recent study, <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref> built a model to predict the time to metastasis of breast cancer in patients based on microarray data from 78 patients. They showed that this model could be used to predict the times to metastasis of 20 independent test patients. Later, in a separate study, this same model was applied to a much larger set of 292 patients (<xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. 2002</xref>).</p>
        <p>Unfortunately, the expression levels of only 70 genes were available for the 292 patient dataset, making it difficult to test our methodology. However, we were able to apply our supervised principal components method. The expression levels of approximately 25,000 genes were available for the earlier study (consisting of 78 patients). After applying crossvalidation, we selected a model consisting of eight genes, five of which were included among the 70 genes in the larger dataset. Thus, we fit a supervised principal components model using these five genes and applied it to the dataset of 292 patients.</p>
        <p>The results are shown in <xref ref-type="table" rid="pbio-0020108-t001">Table 1</xref>. (To compare the predictive power of the various models, we fit a Cox proportional hazards model to each predictor and computed the <italic>R</italic><sup>2</sup> statistic for each model. <italic>R</italic><sup>2</sup> measures the percentage of the variation in survival time that is explained by the model. Thus, when comparing models, one would prefer the model with the larger <italic>R</italic><sup>2</sup> statistic.) We see that our supervised principal components method produced a stronger predictor of metastasis than the procedure described in <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref>. Furthermore, our method used only five genes, whereas the predictor of <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref> used 70 genes. These results held even though we did not have the expression data for three genes that we would like to have included in our model.</p>
        <table-wrap id="pbio-0020108-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pbio.0020108.t001</object-id><label>Table 1</label><caption>
            <title>Supervised Principal Components Applied to Breast Cancer Data</title>
          </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.t001" xlink:type="simple"/><table-wrap-foot>
            <fn id="nt101">
              <p>Comparison of the values of the <italic>R</italic><sup>2</sup> statistic of the Cox proportional hazards model (and the <italic>p-</italic>value of the associated log-rank statistic) obtained by fitting the times to metastasis to our supervised principal components method and the discrete predictor described in <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref></p>
            </fn>
          </table-wrap-foot><!-- <table>
            <thead>
              <tr>
                <td></td>
                <td>Supervised Principal Components</td>
                <td>Method of <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><italic>n</italic> = 292</td>
                <td>0.155 (3.12 &times; 10<sup>&minus;5</sup>)</td>
                <td>0.072 (0.00934)</td>
              </tr>
              <tr>
                <td><italic>n</italic> = 234</td>
                <td>0.114 (0.00328)</td>
                <td>0.098 (0.0105)</td>
              </tr>
            </tbody>
          </table> --></table-wrap>
        <p>(Of the 78 patients used to build the model in the original study, 61 were included in the larger dataset of 292 patients. Thus, the values of <italic>R</italic><sup>2</sup> calculated using all 292 patients are inflated, since part of the dataset used to validate the model was also used to train the model. We include these results merely to demonstrate the greater predictive power of our methodology. Moreover, we repeated these calculations using only the 234 patients that were not included in the earlier study to ensure that our results were still valid.)</p>
      </sec>
      <sec id="s2h">
        <title>Comparison With Related Methods in the Literature</title>
        <p>We compared each of our proposed methods to several previously published methods for predicting survival based on microarray data. In particular, we examined three previously published procedures: a method based on SVMs (<xref ref-type="bibr" rid="pbio-0020108-Li1">Li and Luan 2003</xref>), a method based on PLS (<xref ref-type="bibr" rid="pbio-0020108-Nguyen1">Nguyen and Rocke 2002a</xref>), and an ad hoc procedure that calculated a “risk index” for each patient by taking an appropriate linear combination of a subset of the genes (<xref ref-type="bibr" rid="pbio-0020108-Beer1">Beer et al. 2002</xref>). Finally, we considered a naive procedure that split the training data into two groups by finding the bipartition that minimized the <italic>p</italic>-value of the resulting log-rank statistic. A brief description of each of these procedures is given in <xref ref-type="supplementary-material" rid="sd018">Protocol S1</xref>; for a full description of these procedures, see the original papers.</p>
        <p>We compared these methods on four different datasets (See <xref ref-type="supplementary-material" rid="sd001">Datasets S1-S13</xref>). First, we examined the DLBCL dataset (<xref ref-type="bibr" rid="pbio-0020108-Rosenwald1">Rosenwald et al. 2002</xref>) that we used in the earlier examples. Recall that there were 7,399 genes, 160 training patients, and 80 test patients. Second, we considered a breast cancer dataset (<xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. 2002</xref>). There were 4,751 genes and 97 patients in this dataset. We partitioned this dataset into a training set of 44 patients and a test set of 53 patients. Third, we examined a lung cancer dataset (<xref ref-type="bibr" rid="pbio-0020108-Beer1">Beer et al. 2002</xref>). There were 7,129 genes and 86 patients, which we partitioned into a training set of 43 patients and a test set of 43 patients. Finally, we considered a dataset of acute myeloid leukemia patients (<xref ref-type="bibr" rid="pbio-0020108-Bullinger1">Bullinger et al. 2004</xref>). It consisted of 6,283 genes and 116 patients. This dataset was partitioned into a training set of 59 patients and a test set of 53 patients. The results are shown in <xref ref-type="table" rid="pbio-0020108-t002">Table 2</xref>.</p>
        <table-wrap id="pbio-0020108-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pbio.0020108.t002</object-id><label>Table 2</label><caption>
            <title>Comparison of the Different Methods on Four Datasets</title>
          </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.t002" xlink:type="simple"/><table-wrap-foot>
            <fn id="nt201">
              <p>Comparison of the different methods applied to the DLBCL data of <xref ref-type="bibr" rid="pbio-0020108-Rosenwald1">Rosenwald et al. (2002</xref>), the breast cancer data of <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref>, the lung cancer data of Beer et al (2002), and the acute myeloid leukemia (AML) data of <xref ref-type="bibr" rid="pbio-0020108-Bullinger1">Bullinger et al. (2004</xref>). The methods are (1) assigning samples to a “low-risk” or “high-risk” group based on their median survival time; (2) using 2-means clustering based on the genes with the largest Cox scores; (3) using the supervised principal components method; (4) using 2-means clustering based on the genes with the largest PLS-corrected Cox scores; (5) using the continuous predictor
                 ; (6) using 2-means clustering to identify two subgroups; (7) partitioning the training data into “low-risk” and “high-risk” subgroups by choosing the split that minimizes the <italic>p-</italic>value of the log-rank test when applied to the two resulting groups; (8) using SVMs, similar to the method of <xref ref-type="bibr" rid="pbio-0020108-Li1">Li and Luan (2003</xref>); (9) using a discretized version of (8); (10) Using partial least squares regression, similar to the method of <xref ref-type="bibr" rid="pbio-0020108-Nguyen1">Nguyen and Rocke (2002a</xref>); (11) using a discretized version of (11); (12) using the method of <xref ref-type="bibr" rid="pbio-0020108-Beer1">Beer et al. (2002</xref>)
              </p>
            </fn>
          </table-wrap-foot><!-- <table>
            <thead>
              <tr>
                <td>Method</td>
                <td>DLBCL Data</td>
                <td>Breast Cancer Data</td>
                <td>Lung Cancer Data</td>
                <td>AML Data</td>
              </tr>
              <tr>
                <td></td>
                <td><italic>R</italic><sup>2</sup></td>
                <td><italic>p-</italic>value</td>
                <td><italic>R</italic><sup>2</sup></td>
                <td><italic>p-</italic>value</td>
                <td><italic>R</italic><sup>2</sup></td>
                <td><italic>p-</italic>value</td>
                <td><italic>R</italic><sup>2</sup></td>
                <td><italic>p-</italic>value</td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>(1) Median Cut</td>
                <td>0.054</td>
                <td>0.0297</td>
                <td>0.134</td>
                <td>0.00423</td>
                <td>0.153</td>
                <td>0.00162</td>
                <td>0.068</td>
                <td>0.0487</td>
              </tr>
              <tr>
                <td>(2) Clustering-Cox</td>
                <td>0.080</td>
                <td>0.00755</td>
                <td>0.207</td>
                <td>0.000127</td>
                <td>0.074</td>
                <td>0.0499</td>
                <td>0.080</td>
                <td>0.0309</td>
              </tr>
              <tr>
                <td>(3) Supervised PC</td>
                <td>0.113</td>
                <td>0.00124</td>
                <td>0.267</td>
                <td>2.06 &times; 10<sup>&minus;5</sup></td>
                <td>0.361</td>
                <td>1.47 &times; 10<sup>&minus;7</sup></td>
                <td>0.161</td>
                <td>0.00136</td>
              </tr>
              <tr>
                <td>(4) Clustering-PLS</td>
                <td>0.114</td>
                <td>0.00087</td>
                <td>0.143</td>
                <td>0.00123</td>
                <td>0.106</td>
                <td>0.00354</td>
                <td>0.064</td>
                <td>0.050</td>
              </tr>
              <tr>
                <td SPANNAME="span5">(5) <italic>&ycirc;</italic></td>
                <td>0.292</td>
                <td SPANNAME="span6">1.21 &times; 10<sup>&minus;8</sup></td>
                <td>0.224</td>
                <td>0.000436</td>
                <td>0.171</td>
                <td>0.00496</td>
                <td>0.029</td>
                <td>0.201</td>
              </tr>
              <tr>
                <td>(6) 2-Means</td>
                <td>0.014</td>
                <td SPANNAME="span6">0.286</td>
                <td>NA</td>
                <td>NA</td>
                <td>0.021</td>
                <td>0.33</td>
                <td>0.001</td>
                <td>0.803</td>
              </tr>
              <tr>
                <td SPANNAME="span5">(7) Best <italic>p-</italic>value</td>
                <td>0.013</td>
                <td SPANNAME="span6">0.273</td>
                <td>0.113</td>
                <td>0.00371</td>
                <td>0</td>
                <td>0.946</td>
                <td>0.034</td>
                <td>0.141</td>
              </tr>
              <tr>
                <td SPANNAME="span5">(8) SVM (cont)</td>
                <td>0.034</td>
                <td SPANNAME="span6">0.0875</td>
                <td>0.155</td>
                <td>0.0025</td>
                <td>0.026</td>
                <td>0.298</td>
                <td>0.024</td>
                <td>0.247</td>
              </tr>
              <tr>
                <td SPANNAME="span5">(9) SVM (disc)</td>
                <td>0.052</td>
                <td SPANNAME="span6">0.033</td>
                <td>0.179</td>
                <td>0.000345</td>
                <td>0.041</td>
                <td>0.195</td>
                <td>0.062</td>
                <td>0.0646</td>
              </tr>
              <tr>
                <td SPANNAME="span5">(10) PLS Reg. (cont)</td>
                <td>0.047</td>
                <td SPANNAME="span6">0.048</td>
                <td>0.181</td>
                <td>0.000322</td>
                <td>0.176</td>
                <td>0.0043</td>
                <td>0.069</td>
                <td>0.0489</td>
              </tr>
              <tr>
                <td SPANNAME="span5">(11) PLS Reg. (disc)</td>
                <td>0.032</td>
                <td SPANNAME="span6">0.101</td>
                <td>0.211</td>
                <td>8.2 &times; 10<sup>&minus;5</sup></td>
                <td>0.098</td>
                <td>0.0194</td>
                <td>0.011</td>
                <td>0.438</td>
              </tr>
              <tr>
                <td SPANNAME="span5">(12) <xref ref-type="bibr" rid="pbio-0020108-Beer1">Beer et al. (2002</xref>)</td>
                <td>0.007</td>
                <td SPANNAME="span6">0.441</td>
                <td>0.155</td>
                <td>0.00238</td>
                <td>0.091</td>
                <td>0.0419</td>
                <td>0.018</td>
                <td>0.311</td>
              </tr>
            </tbody>
          </table> --></table-wrap>
      </sec>
      <sec id="s2i">
        <title>A Simulation Study</title>
        <p>We compared each of the methods we proposed above on two simulated datasets. (See <xref ref-type="supplementary-material" rid="sd001">Data S1-S4</xref>.) The first simulated dataset <italic>X</italic> had 5,000 genes and 100 samples. All expression values were generated as standard normal random numbers with a few exceptions. Genes 1–50 in samples 1–50 had a mean of 1.0. We randomly selected 40% of the samples to have a mean of 2.0 in genes 51–100, 50% of the samples to have a mean of 1.0 in genes 101–200, and 70% of the samples to have a mean of 0.5 in genes 201–300.</p>
        <p>We then generated survival times. The survival times of samples 1–50 were generated as normal random numbers with a mean of 10.0 and a standard deviation of 2.0, and the survival times of samples 51–100 were generated as normal random numbers with a mean of 8.0 and a standard deviation of 3.0. For each sample, a censoring time was generated as a normal random number with a mean of 10.0 and a standard deviation of 3.0. If the censoring time turned out to be less than the survival time, the observation was considered to be censored. Finally, we generated another 5000 × 100 matrix of test data X̃I, which was generated the same way <italic>X</italic> was generated. Survival times for X̃I were also generated in an identical manner.</p>
        <p>We defined samples 1–50 as belonging to “tumor type 1” and samples 51–100 as belonging to “tumor type 2.” Thus, a successful subgroup discovery procedure should assign samples 1–50 to one subgroup, and samples 51–100 to the other subgroup.</p>
        <p>We applied the methods discussed above to identify these subgroups (and predict survival) for the simulated dataset. This simulation was repeated ten times. The results are shown in <xref ref-type="table" rid="pbio-0020108-t003">Table 3</xref>. The first column of the table shows how many samples were misclassified when the dataset was originally divided into two subgroups. The second column shows the number of crossvalidation errors that occurred when the nearest shrunken centroids model was applied to these putative class labels. The third column shows the number of incorrectly labeled samples when the optimal nearest shrunken centroids model was used to assign labels to the samples in the test data X̃I. The final column is the value of <italic>R</italic><sup>2</sup> obtained by fitting a Cox proportional hazards model to the predicted class labels for the test data (or by fitting a Cox model to γ̂ in the case of methods 4 and 6).</p>
        <table-wrap id="pbio-0020108-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pbio.0020108.t003</object-id><label>Table 3</label><caption>
            <title>Comparison of the Different Methods on Our Simulated Data</title>
          </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.t003" xlink:type="simple"/><table-wrap-foot>
            <fn id="nt203">
              <p>The methods are (1) assigning samples to a “low-risk” or “high-risk” group based on their median survival time; (2) using 2-means clustering to identify two subgroups; (3) using 2-means clustering based on the genes with the largest Cox scores; (4) using the supervised principal components method; (5) using 2-means clustering based on the genes with the largest PLS-corrected Cox scores; (6) using the continuous predictor
                . Each entry in the table represents the mean over 10 simulations; the standard error is given in parentheses
              </p>
            </fn>
          </table-wrap-foot><!-- <table>
            <thead>
              <tr>
                <td>Method</td>
                <td>Initial Cluster Errors</td>
                <td>Crossvalidation Errors</td>
                <td>Test Errors</td>
                <td><italic>R</italic><sup>2</sup></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>(1) Median cut</td>
                <td>35.7 (6.15)</td>
                <td>50.0 (0.0)</td>
                <td>50.0 (0.0)</td>
                <td>0.0 (0.0)</td>
              </tr>
              <tr>
                <td>(2) 2-means</td>
                <td>46.5 (0.93)</td>
                <td>46.6 (0.90)</td>
                <td>46.2 (1.44)</td>
                <td>0.0073 (0.0019)</td>
              </tr>
              <tr>
                <td>(3) Clustering-Cox</td>
                <td>23.4 (3.49)</td>
                <td>16.7 (6.16)</td>
                <td>16.6 (6.49)</td>
                <td>0.11 (0.025)</td>
              </tr>
              <tr>
                <td>(4) Supervised PC</td>
                <td>NA</td>
                <td>NA</td>
                <td>NA</td>
                <td>0.077 (0.023)</td>
              </tr>
              <tr>
                <td>(5) Clustering-PLS</td>
                <td>17.1 (6.82)</td>
                <td>15.4 (7.00)</td>
                <td>13.8 (6.72)</td>
                <td>0.11 (0.030)</td>
              </tr>
              <tr>
                <td>(6) <italic>&ycirc;</italic></td>
                <td>NA</td>
                <td>NA</td>
                <td>NA</td>
                <td>0.013 (0.0034)</td>
              </tr>
            </tbody>
          </table> --></table-wrap>
        <p>In the first simulation, we found that the fully supervised and the fully unsupervised methods produced much worse results than the semi-supervised methods. (For each iteration of the “median cut” method, the crossvalidation error was minimized when all of the observations were assigned to the same class. Hence, each such model had no predictive power, and the value of <italic>R</italic><sup>2</sup> was zero for each iteration. If we had chosen a smaller value of the tuning parameter Δ, the procedure would have performed better, although not significantly better.) The continuous predictor based on supervised principal components performed nearly as well as the methods based on semi-supervised clustering.</p>
        <p>Next, we performed a second simulation. The second simulated dataset <italic>X</italic> had 1000 genes and 100 samples. All expression values were generated as Gaussian random variables with a mean of zero and a variance of 1.5, although again there were a few exceptions. Genes 1–50 had a mean of 0.5 in samples 1–20, a mean of 0.6 in samples 21–40, a mean of 0.7 in samples 41–60, a mean of 0.8 in samples 61–80, and a mean of 0.9 in samples 81–100. And again, we randomly selected 40% of the samples to have a mean of 2.0 in genes 51–100, 50% of the samples to have a mean of 1.0 in genes 101–200, and 70% of the samples to have a mean of 0.5 in genes 201–300. To generate the survival time of each “patient,” we took the sum of the expression levels of the first 50 genes and added a Gaussian noise term with variance 0.01. There was no censoring mechanism for the second simulation. We also generated another 1000 × 100 matrix of test data using an analogous procedure.</p>
        <p>Under this model, there are actually five “tumor subgroups.” However, we still used 2-means clustering on this simulated dataset in order to evaluate the performance of our methods when the number of clusters is chosen incorrectly. Thus, in this simulation, it does not make sense to talk about the number of “misclassification errors;” we can only compare the methods on the basis of their predictive ability.</p>
        <p>We applied the six different methods to this new simulated dataset and repeated this simulation ten times; the results are shown in <xref ref-type="table" rid="pbio-0020108-t004">Table 4</xref>. The supervised principal component method is the clear winner in the second simulation study. The semi-supervised methods performed poorly because there were a large number of subgroups and there was a considerable overlap between subgroups. This example demonstrates that the supervised principal component method performs well regardless of the number of tumor subclasses and that it seems to perform especially well when survival is an additive function of the expression level of certain genes.</p>
        <table-wrap id="pbio-0020108-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pbio.0020108.t004</object-id><label>Table 4</label><caption>
            <title>Comparison of the Different Methods on Our Simulated Data</title>
          </caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.t004" xlink:type="simple"/><table-wrap-foot>
            <fn id="nt301">
              <p>The methods are (1) assigning samples to a “low-risk” or “high-risk” group based on their median survival time; (2) using 2-means clustering to identify two subgroups; (3) using 2-means clustering based on the genes with the largest Cox scores; (4) using the supervised principal components method; (5) using 2-means clustering based on the genes with the largest PLS-corrected Cox scores; (6) using the continuous predictor
                . Each entry in the table represents the mean over 10 simulations; the standard error is given in parentheses
              </p>
            </fn>
          </table-wrap-foot><!-- <table>
            <thead>
              <tr>
                <td>Method</td>
                <td><italic>R<sup>2</sup></italic></td>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>(1) Median Cut</td>
                <td>0.055 (0.011)</td>
              </tr>
              <tr>
                <td>(2) 2-means</td>
                <td>0.017 (0.0049)</td>
              </tr>
              <tr>
                <td>(3) Clustering-Cox</td>
                <td>0.035 (0.012)</td>
              </tr>
              <tr>
                <td>(4) Supervised PC</td>
                <td>0.33 (0.060)</td>
              </tr>
              <tr>
                <td></td>
                <td></td>
              </tr>
              <tr>
                <td>(5) Clustering-PLS</td>
                <td>0.036 (0.014)</td>
              </tr>
              <tr>
                <td>(6)
                  <math display='inline'>
                    <mover accent='true'>
                      <mi>&gamma;</mi>
                      <mo>&#x0302;</mo>
                    </mover>
                  </math>
                </td>
                <td>0.068 (0.014)</td>
              </tr>
            </tbody>
          </table> --></table-wrap>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>One important goal of microarray research is to develop more powerful diagnostic tools for cancer and other diseases. Consider a hypothetical cancer that has two subtypes. One subtype is known to spread much more rapidly than the other subtype, and hence must be treated much more aggressively. We would like to be able to diagnose which type of cancer patients have and give them the appropriate treatment.</p>
      <p>If it is known that two such subtypes of a certain cancer exist, and if we have a training set where it is known which patients have which subtype, then we can use nearest shrunken centroids or other classification methods to build a model to diagnose this cancer in future patients. However, in many cases, we do not know how many subtypes are present, nor do we know which patients belong to which subgroup. Thus, it is important to develop methods to identify such subgroups.</p>
      <p>Unsupervised methods, such as hierarchical clustering, are popular techniques for identifying such subgroups. However, there is no guarantee that subgroups discovered using unsupervised methods will have clinical significance.</p>
      <p>An alternative is to generate class labels using clinical data. The simplicity of the approach of dividing the patients into two subclasses based on their survival time is attractive, and there is evidence that this procedure can successfully predict survival. Indeed, this procedure produced a significant predictor of survival in four different datasets, suggesting that this approach has some utility. However, as noted in the Introduction, subgroups identified in this manner may not be biologically meaningful. When we applied this model to the DLBCL data described earlier, the misclassification error rate for the shrunken centroids model was very high (around 40%), so a diagnosis based on this procedure is likely to be inaccurate.</p>
      <p>Supervised clustering methods can overcome these problems. We have seen that if we selected significant genes prior to clustering the data, we could identify clusters that were clinically relevant. We have also seen how knowledge of these clusters could be used to diagnose future patients.</p>
      <p>This supervised clustering methodology is a useful prognostic tool. It is also easy to interpret. However, it has certain shortcomings as well. Recall our conceptual model shown in <xref ref-type="fig" rid="pbio-0020108-g001">Figure 1</xref>. Patients with tumor type 2 live longer than patients with tumor type 1 on average, but there is still significant variability within each tumor type. Even if we can diagnose a patient with the correct tumor type 100% of the time, the prognosis of the patient may be inaccurate if the variability in survival time within each tumor type is large. Thus, it would be desirable to find a continuous predictor of survival that accounts for this within-group variability.</p>
      <p>One possible such predictor is our supervised principal components procedure. This procedure used the principal components of a subset of the expression matrix <italic>X</italic> as a predictor of patient survival. The chosen subset contained the genes with the largest Cox scores. This method could also be used to detect cancer subtypes, since the principal components will presumably capture the variation that exists between subtypes. It is also capable of identifying variation within these subtypes, which, as discussed above, cannot be identified using supervised clustering. We showed that this procedure could produce a stronger predictor of survival than the discrete predictor based on supervised clustering.</p>
      <p>We compared our methods to several previously published methods for predicting survival based on microarray data. In general, our methods performed significantly better than these existing methods. In particular, our supervised principal components method gave the best results on three of the four datasets. (It performed slightly worse than our γ̂ method on the DLBCL data, but it still outperformed almost all of the other methods.) Furthermore, each of our proposed methods was a significant predictor of survival (at <italic>p</italic> = 0.05) for all four datasets, which was not true for any of the other methods. Finally, if we consider only discrete predictors of survival, our semi-supervised clustering methods performed better than the other models on at least three of the four datasets.</p>
      <p>Another important advantage of our methods is that they select a subset of the genes to use as predictors. The methods of <xref ref-type="bibr" rid="pbio-0020108-Nguyen1">Nguyen and Rocke (2002a</xref>) and <xref ref-type="bibr" rid="pbio-0020108-Li1">Li and Luan (2003</xref>), by contrast, require the use of all (or a large number) of the genes. If we can identify a small subset of genes that predict the survival of cancer patients, it may be possible to develop a diagnostic test using immunostaining or reverse transcriptase PCR. However, such a test would not be feasible if hundreds or thousands of genes were necessary to make the diagnosis.</p>
      <p>Throughout this study, we have used survival data to help us identify genes of interest. However, other clinical variables could also be used, such as the stage of the tumor, or whether or not it has metastasized. Rather than ranking genes based on their Cox scores, one would use a different metric to measure the association between a given gene and the clinical variable of interest. For example, suppose we wished to identify a subgroup of cancer that was associated with a high risk of metastasis. For each gene, we could compute a t-statistic comparing the expression levels in the patients whose cancer metastasized to those in the patients with no metastasis. <xref ref-type="bibr" rid="pbio-0020108-Tusher1">Tusher et al. (2001</xref>) described methods for generating such “significant gene lists” for a variety of possible clinical variables. Many of these methods are implemented in the significance analysis of microarrays software package (<xref ref-type="bibr" rid="pbio-0020108-Chu1">Chu et al. 2002</xref>).</p>
      <p>Information about the risk of metastasis (and death) for a given patient is essential to treat cancer successfully. If the risk of metastasis is high, the cancer must be treated aggressively; if the risk is low, milder forms of treatment can be used. Using DNA microarrays, researchers have successfully identified subtypes of cancer that can be used to assess a patient's risk profile. Our results show that semi-supervised learning methods can identify these subtypes of cancer and predict patient survival better than existing methods. Thus, we believe they can be a powerful tool for diagnosing and treating cancer and other genetic diseases.</p>
    </sec>
    <sec id="s4">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title/>
        <sec id="s4a1">
          <title>Overview of nearest shrunken centroids</title>
          <p>The nearest shrunken centroids procedure calculates the mean expression of each gene within each class. Then it shrinks these centroids toward the overall mean for that gene by a fixed quantity, Δ. Diagonal linear discriminant analysis (LDA) is then applied to the genes that survive the thresholding. Details are given in <xref ref-type="bibr" rid="pbio-0020108-Tibshirani1">Tibshirani et al. (2002</xref>). It has successfully classified tumors based on gene expression data in previous studies. In one experiment, there were a total of 88 patients, each of which had one of four different types of small round blue cell tumors . Nearest shrunken centroids classified 63 training samples and 25 test samples without a single misclassification error (<xref ref-type="bibr" rid="pbio-0020108-Tibshirani1">Tibshirani et al. 2002</xref>).</p>
        </sec>
        <sec id="s4a2">
          <title>Generation of “median cut” class labels<italic/></title>
          <p>We created two classes by cutting the survival times at the median survival time (2.8 y). Any patient who lived longer than 2.8 y was considered to be a “low-risk” patient, and any patient that lived less than 2.8 y was considered to be a “high-risk” patient. In this manner, we assigned a class label to each observation in the training data.</p>
          <p>Unfortunately, many of the patients' survival times were censored, meaning that the individual left the study before the study was completed. When this occurs, we do not know how long the patient survived; we only know how long the patient remained in the study prior to being lost to follow-up.</p>
          <p>If an observation is censored, we may not know to which class it belongs. For example, suppose that the median survival time is 2.8 y, but that a patient left the study after 1.7 y. If the patient died in the interval between 1.7 y and 2.8 y, then the patient should be assigned to the “high-risk” group. Otherwise, the patient should be assigned to the “low-risk” group. However, there is no way to determine which possibility is correct.</p>
          <p>Based on the Kaplan-Meier survival curve for all the patients, we can estimate the probability that a censored case survives a specified length of time (<xref ref-type="bibr" rid="pbio-0020108-Cox1">Cox and Oakes 1984</xref>; <xref ref-type="bibr" rid="pbio-0020108-Therneau1">Therneau and Grambsch 2000</xref>). For example, suppose that the median survival time is 50 months and a patient left the study after 20 months. Let <italic>T</italic> denote the survival time of this patient. Then, using the Kaplan-Meier curve, we can estimate <italic>p</italic>(<italic>T</italic>&gt;50) and <italic>p</italic>(<italic>T</italic>&gt;20). Then we can estimate <italic>p</italic>(<italic>T</italic>&gt;50|<italic>T</italic>&gt;20) as follows:</p>
          <p>
            <disp-formula id="pbio-0020108-e001"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e001" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <mi>P</mi>
                  <mo stretchy='false'>(</mo>
                  <mi>T</mi>
                  <mo>&gt;</mo>
                  <mn>50</mn>
                  <mo>|</mo>
                  <mi>T</mi>
                  <mo>&gt;</mo>
                  <mn>20</mn>
                  <mo stretchy='false'>)</mo>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <mi>P</mi>
                      <mo stretchy='false'>(</mo>
                      <mi>T</mi>
                      <mo>&gt;</mo>
                      <mn>50</mn>
                      <mo stretchy='false'>)</mo>
                    </mrow>
                    <mrow>
                      <mi>P</mi>
                      <mo stretchy='false'>(</mo>
                      <mi>T</mi>
                      <mo>&gt;</mo>
                      <mn>20</mn>
                      <mo stretchy='false'>)</mo>
                    </mrow>
                  </mfrac>
                  <mo>,</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>and, of course,</p>
          <p>
            <disp-formula id="pbio-0020108-e002"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e002" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <mi>P</mi>
                  <mo stretchy='false'>(</mo>
                  <mi>T</mi>
                  <mo>&le;</mo>
                  <mn>50</mn>
                  <mo>|</mo>
                  <mi>T</mi>
                  <mo>&gt;</mo>
                  <mn>20</mn>
                  <mo stretchy='false'>)</mo>
                  <mo>=</mo>
                  <mn>1</mn>
                  <mo>&minus;</mo>
                  <mi>P</mi>
                  <mo stretchy='false'>(</mo>
                  <mi>T</mi>
                  <mo>&gt;</mo>
                  <mn>50</mn>
                  <mo>|</mo>
                  <mi>T</mi>
                  <mo>&gt;</mo>
                  <mn>20</mn>
                  <mo stretchy='false'>)</mo>
                  <mo>.</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>In this manner, we can estimate the probability that each censored observation belongs to the “low-risk” and “high-risk” classes, respectively.</p>
          <p>However, it is still unclear how we would train our classifier based on this information. Nearest shrunken centroids is a modified version of LDA. It is described in detail in <xref ref-type="bibr" rid="pbio-0020108-Hastie2">Hastie et al. (2001b</xref>). Like most classification techniques, LDA assumes that the class labels of the training observations are known with complete certainty. The version of LDA described in <xref ref-type="bibr" rid="pbio-0020108-Hastie2">Hastie et al. (2001b</xref>) and most other books cannot handle probabilistic class labels, where there is a certain probability that a training observation belongs to one class, and a certain probability that it belongs to a different class. We will now describe a simple modification of LDA that can be trained based on this type of data. It is similar to a technique described in <xref ref-type="bibr" rid="pbio-0020108-McLachlan1">McLachlan (1992</xref>) for training an LDA classifier when some of the training observations are missing.</p>
          <p>Let {<bold>x</bold><sub><italic>i</italic></sub>}<inline-formula id="pbio-0020108-e013"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.0020108.e013" xlink:type="simple"/></inline-formula> denote the set of input variables, and let {<bold>y</bold><sub><italic>i</italic></sub>}<inline-formula id="pbio-0020108-e014"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pbio.0020108.e014" xlink:type="simple"/></inline-formula> represent the corresponding response variables. Also, let <italic>g</italic> represent the number of discrete classes to which the <italic>y</italic><sub><italic>i</italic></sub>s may belong. (If we are dividing the training data into “low-risk” and “high-risk” patients, then <italic>g</italic> = 2.) When we perform LDA when all of the <italic>y</italic><sub><italic>i</italic></sub>s are known, the problem is to fit the mixture model
          </p>
          <p>
            <disp-formula id="pbio-0020108-e003"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e003" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <msub>
                    <mi>f</mi>
                    <mi>X</mi>
                  </msub>
                  <mo stretchy='false'>(</mo>
                  <mstyle mathvariant='bold' mathsize='normal'>
                    <mi>x</mi>
                  </mstyle>
                  <mo>;</mo>
                  <mi>&Phi;</mi>
                  <mo stretchy='false'>)</mo>
                  <mo>=</mo>
                  <mstyle displaystyle='true'>
                    <munderover>
                      <mo>&sum;</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mi>g</mi>
                    </munderover>
                  </mstyle>
                  <mtext>&thinsp;</mtext>
                  <msub>
                    <mi>&pi;</mi>
                    <mi>i</mi>
                  </msub>
                  <msub>
                    <mi>f</mi>
                    <mi>i</mi>
                  </msub>
                  <mo stretchy='false'>(</mo>
                  <mstyle mathvariant='bold' mathsize='normal'>
                    <mi>x</mi>
                  </mstyle>
                  <mo>;</mo>
                  <msub>
                    <mi>&theta;</mi>
                    <mi>i</mi>
                  </msub>
                  <mo stretchy='false'>)</mo>
                  <mo>.</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>(Generally, each 𝒻<sub><italic>i</italic></sub> is a Gaussian density function, and the θ<sub><italic>i</italic></sub>s correspond to the mean of the observations in each class. The π<sub><italic>i</italic></sub>s correspond to “prior” probabilities that an observation belongs to class 𝒾.) In this case, we must fit this model on the basis of the classified (uncensored) training data, which we denote by <bold>t</bold>, and the unclassified (censored) feature vectors <bold>x</bold><sub>𝒿</sub> ( 𝒿 = 𝓃+1, …,𝓃+𝓂), which we denote by <bold>t</bold><sub>𝓊</sub>. (Also, note that Φ = (π′,θ′)′ denotes the vector of all unknown parameters.)</p>
          <p>We define the latent variables 𝓏<sub><italic>ij</italic></sub> to be equal to one if the 𝒿th observation belongs to the 𝒾th class, and zero otherwise. Then the complete-data log likelihood is</p>
          <p>
            <disp-formula id="pbio-0020108-e004"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e004" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <mi>l</mi>
                  <mi>o</mi>
                  <mi>g</mi>
                  <msub>
                    <mi>L</mi>
                    <mi>C</mi>
                  </msub>
                  <mo stretchy='false'>(</mo>
                  <mi>&Phi;</mi>
                  <mo stretchy='false'>)</mo>
                  <mo>=</mo>
                  <mstyle displaystyle='true'>
                    <munderover>
                      <mo>&sum;</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mi>g</mi>
                    </munderover>
                  </mstyle>
                  <mtext>&thinsp;</mtext>
                  <mstyle displaystyle='true'>
                    <munderover>
                      <mo>&sum;</mo>
                      <mrow>
                        <mi>j</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow>
                        <mi>n</mi>
                        <mo>+</mo>
                        <mi>m</mi>
                      </mrow>
                    </munderover>
                  </mstyle>
                  <mtext>&thinsp;</mtext>
                  <msub>
                    <mi>z</mi>
                    <mrow>
                      <mi>i</mi>
                      <mi>j</mi>
                    </mrow>
                  </msub>
                  <mi>l</mi>
                  <mi>o</mi>
                  <mi>g</mi>
                  <msub>
                    <mi>f</mi>
                    <mi>i</mi>
                  </msub>
                  <mo stretchy='false'>(</mo>
                  <msub>
                    <mstyle mathvariant='bold' mathsize='normal'>
                      <mi>x</mi>
                    </mstyle>
                    <mi>j</mi>
                  </msub>
                  <mo>;</mo>
                  <msub>
                    <mi>&theta;</mi>
                    <mi>i</mi>
                  </msub>
                  <mo stretchy='false'>)</mo>
                  <mo>+</mo>
                  <mstyle displaystyle='true'>
                    <munderover>
                      <mo>&sum;</mo>
                      <mrow>
                        <mi>i</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mi>g</mi>
                    </munderover>
                  </mstyle>
                  <mtext>&thinsp;</mtext>
                  <mstyle displaystyle='true'>
                    <munderover>
                      <mo>&sum;</mo>
                      <mrow>
                        <mi>j</mi>
                        <mo>=</mo>
                        <mn>1</mn>
                      </mrow>
                      <mrow>
                        <mi>n</mi>
                        <mo>+</mo>
                        <mi>m</mi>
                      </mrow>
                    </munderover>
                  </mstyle>
                  <mtext>&thinsp;</mtext>
                  <msub>
                    <mi>z</mi>
                    <mrow>
                      <mi>i</mi>
                      <mi>j</mi>
                    </mrow>
                  </msub>
                  <mi>l</mi>
                  <mi>o</mi>
                  <mi>g</mi>
                  <msub>
                    <mi>&pi;</mi>
                    <mi>i</mi>
                  </msub>
                  <mo>.</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>The EM algorithm is applied to this model by treating <bold>z</bold><sub><italic>j</italic></sub>(𝒿 = 𝓃+1,…, 𝓃+𝓂) as missing data. It turns out to be very simple in the case of LDA. The E-step is effected here simply by replacing each unobserved indicator variable 𝓏<sub><italic>ij</italic></sub> by its expectation conditional on <bold>x</bold><sub><italic>j</italic></sub>. That is, 𝓏<sub><italic>ij</italic></sub> is replaced by the estimate of the posterior probability that the 𝒿th entity with feature vector <bold>x</bold><sub><italic>j</italic></sub> belongs to <italic>G</italic><sub><italic>i</italic></sub>(𝒾 = 1, …,<italic>G</italic>, 𝒿 = <italic>n</italic> + 1, …,<italic>n</italic>+<italic>m</italic>) (<xref ref-type="bibr" rid="pbio-0020108-McLachlan1">McLachlan 1992</xref>). We take the initial estimates of 𝓏<sub><italic>ij</italic></sub> to be the earlier estimate that the 𝒾th censored observation belongs to class 𝒿 based on the Kaplan-Meier curve.</p>
          <p>The estimates of π<sub><italic>i</italic></sub> and μ<sub><italic>i</italic></sub> in the M-step are equally simple:</p>
          <p>
            <disp-formula id="pbio-0020108-e005"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e005" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <msubsup>
                    <mstyle mathsize='140%' displaystyle='true'>
                      <mover accent='true'>
                        <mi>&pi;</mi>
                        <mo>&#x0302;</mo>
                      </mover>
                    </mstyle>
                    <mi>i</mi>
                    <mrow>
                      <mo stretchy='false'>(</mo>
                      <mi>k</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                      <mo stretchy='false'>)</mo>
                    </mrow>
                  </msubsup>
                  <mo>=</mo>
                  <mrow>
                    <mo>&lcub;</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                      <mo>+</mo>
                      <mstyle displaystyle='true'>
                        <munderover>
                          <mo>&sum;</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>=</mo>
                            <mi>n</mi>
                            <mo>+</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow>
                            <mi>n</mi>
                            <mo>+</mo>
                            <mi>m</mi>
                          </mrow>
                        </munderover>
                      </mstyle>
                      <mtext>&thinsp;</mtext>
                      <msub>
                        <mi>&tau;</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy='false'>(</mo>
                      <msub>
                        <mstyle mathvariant='bold' mathsize='normal'>
                          <mi>x</mi>
                        </mstyle>
                        <mi>j</mi>
                      </msub>
                      <mo>;</mo>
                      <msup>
                        <mi>&Phi;</mi>
                        <mrow>
                          <mo stretchy='false'>(</mo>
                          <mi>k</mi>
                          <mo stretchy='false'>)</mo>
                        </mrow>
                      </msup>
                      <mo stretchy='false'>)</mo>
                    </mrow>
                    <mo>&rcub;</mo>
                  </mrow>
                  <mo>/</mo>
                  <mo stretchy='false'>(</mo>
                  <mi>n</mi>
                  <mo>+</mo>
                  <mi>m</mi>
                  <mo stretchy='false'>)</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>and</p>
          <p>
            <disp-formula id="pbio-0020108-e006"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e006" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <msubsup>
                    <mstyle mathsize='140%' displaystyle='true'>
                      <mover accent='true'>
                        <mi>&mu;</mi>
                        <mo>&#x0302;</mo>
                      </mover>
                    </mstyle>
                    <mi>i</mi>
                    <mrow>
                      <mo stretchy='false'>(</mo>
                      <mi>k</mi>
                      <mo>+</mo>
                      <mn>1</mn>
                      <mo stretchy='false'>)</mo>
                    </mrow>
                  </msubsup>
                  <mo>=</mo>
                  <mrow>
                    <mo>&lcub;</mo>
                    <mrow>
                      <mstyle displaystyle='true'>
                        <munderover>
                          <mo>&sum;</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mi>n</mi>
                        </munderover>
                      </mstyle>
                      <mtext>&thinsp;</mtext>
                      <msub>
                        <mi>z</mi>
                        <mrow>
                          <mi>i</mi>
                          <mi>j</mi>
                        </mrow>
                      </msub>
                      <msub>
                        <mstyle mathvariant='bold' mathsize='normal'>
                          <mi>x</mi>
                        </mstyle>
                        <mi>j</mi>
                      </msub>
                      <mo>+</mo>
                      <mstyle displaystyle='true'>
                        <munderover>
                          <mo>&sum;</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>=</mo>
                            <mi>n</mi>
                            <mo>+</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow>
                            <mi>n</mi>
                            <mo>+</mo>
                            <mi>m</mi>
                          </mrow>
                        </munderover>
                      </mstyle>
                      <mtext>&thinsp;</mtext>
                      <msub>
                        <mi>&tau;</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy='false'>(</mo>
                      <msub>
                        <mstyle mathvariant='bold' mathsize='normal'>
                          <mi>x</mi>
                        </mstyle>
                        <mi>j</mi>
                      </msub>
                      <mo>;</mo>
                      <msup>
                        <mi>&Phi;</mi>
                        <mrow>
                          <mo stretchy='false'>(</mo>
                          <mi>k</mi>
                          <mo stretchy='false'>)</mo>
                        </mrow>
                      </msup>
                      <mo stretchy='false'>)</mo>
                      <msub>
                        <mstyle mathvariant='bold' mathsize='normal'>
                          <mi>x</mi>
                        </mstyle>
                        <mi>j</mi>
                      </msub>
                    </mrow>
                    <mo>&rcub;</mo>
                  </mrow>
                  <mo>/</mo>
                  <msub>
                    <mi>M</mi>
                    <mi>i</mi>
                  </msub>
                  <mo stretchy='false'>(</mo>
                  <msup>
                    <mi>&Phi;</mi>
                    <mrow>
                      <mo stretchy='false'>(</mo>
                      <mi>i</mi>
                      <mo stretchy='false'>)</mo>
                    </mrow>
                  </msup>
                  <mo stretchy='false'>)</mo>
                  <mo>,</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>where</p>
          <p>
            <disp-formula id="pbio-0020108-e007"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e007" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <msub>
                    <mi>M</mi>
                    <mi>i</mi>
                  </msub>
                  <mo stretchy='false'>(</mo>
                  <msup>
                    <mi>&Phi;</mi>
                    <mrow>
                      <mo stretchy='false'>(</mo>
                      <mi>k</mi>
                      <mo stretchy='false'>)</mo>
                    </mrow>
                  </msup>
                  <mo stretchy='false'>)</mo>
                  <mo>=</mo>
                  <mrow>
                    <mo>&lcub;</mo>
                    <mrow>
                      <msub>
                        <mi>n</mi>
                        <mi>i</mi>
                      </msub>
                      <mo>+</mo>
                      <mstyle displaystyle='true'>
                        <munderover>
                          <mo>&sum;</mo>
                          <mrow>
                            <mi>j</mi>
                            <mo>=</mo>
                            <mi>n</mi>
                            <mo>+</mo>
                            <mn>1</mn>
                          </mrow>
                          <mrow>
                            <mi>n</mi>
                            <mo>+</mo>
                            <mi>m</mi>
                          </mrow>
                        </munderover>
                      </mstyle>
                      <mtext>&thinsp;</mtext>
                      <msub>
                        <mi>&tau;</mi>
                        <mi>i</mi>
                      </msub>
                      <mo stretchy='false'>(</mo>
                      <msub>
                        <mstyle mathvariant='bold' mathsize='normal'>
                          <mi>x</mi>
                        </mstyle>
                        <mi>j</mi>
                      </msub>
                      <mo>;</mo>
                      <msup>
                        <mi>&Phi;</mi>
                        <mrow>
                          <mo stretchy='false'>(</mo>
                          <mi>k</mi>
                          <mo stretchy='false'>)</mo>
                        </mrow>
                      </msup>
                      <mo stretchy='false'>)</mo>
                    </mrow>
                    <mo>&rcub;</mo>
                  </mrow>
                  <mtext>&emsp;</mtext>
                  <mtext>&emsp;</mtext>
                  <mo stretchy='false'>(</mo>
                  <mi>i</mi>
                  <mo>=</mo>
                  <mn>1</mn>
                  <mo>,</mo>
                  <mo>&hellip;</mo>
                  <mo>,</mo>
                  <mi>g</mi>
                  <mo stretchy='false'>)</mo>
                  <mo>.</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>In these expressions, τ<sub><italic>i</italic></sub>(<bold>x</bold>;Φ) is the posterior probability that the 𝒿th entity with feature vector <bold>x</bold><sub><italic>j</italic></sub> belongs to <italic>G</italic><sub><italic>i</italic></sub>, or, in other words,</p>
          <p>
            <disp-formula id="pbio-0020108-e008"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e008" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <msub>
                    <mi>&tau;</mi>
                    <mi>i</mi>
                  </msub>
                  <mo stretchy='false'>(</mo>
                  <mstyle mathvariant='bold' mathsize='normal'>
                    <mi>x</mi>
                  </mstyle>
                  <mo>;</mo>
                  <mi>&Phi;</mi>
                  <mo stretchy='false'>)</mo>
                  <mo>=</mo>
                  <mfrac>
                    <mrow>
                      <msub>
                        <mi>&pi;</mi>
                        <mi>i</mi>
                      </msub>
                      <mi>e</mi>
                      <mi>x</mi>
                      <mi>p</mi>
                      <mo>&lcub;</mo>
                      <mo>&minus;</mo>
                      <msup>
                        <mrow>
                          <mo stretchy='false'>(</mo>
                          <mstyle mathvariant='bold' mathsize='normal'>
                            <mi>x</mi>
                          </mstyle>
                          <mo>&minus;</mo>
                          <msub>
                            <mi>&mu;</mi>
                            <mi>i</mi>
                          </msub>
                          <mo stretchy='false'>)</mo>
                        </mrow>
                        <mn>2</mn>
                      </msup>
                      <mo>/</mo>
                      <mn>2</mn>
                      <mo>&rcub;</mo>
                    </mrow>
                    <mrow>
                      <mstyle displaystyle='true'>
                        <msubsup>
                          <mo>&sum;</mo>
                          <mrow>
                            <mi>h</mi>
                            <mo>=</mo>
                            <mn>1</mn>
                          </mrow>
                          <mi>g</mi>
                        </msubsup>
                      </mstyle>
                      <mtext>&thinsp;</mtext>
                      <msub>
                        <mi>&pi;</mi>
                        <mi>h</mi>
                      </msub>
                      <mi>e</mi>
                      <mi>x</mi>
                      <mi>p</mi>
                      <mo>&lcub;</mo>
                      <mo>&minus;</mo>
                      <msup>
                        <mrow>
                          <mo stretchy='false'>(</mo>
                          <mstyle mathvariant='bold' mathsize='normal'>
                            <mi>x</mi>
                          </mstyle>
                          <mo>&minus;</mo>
                          <msub>
                            <mi>&mu;</mi>
                            <mi>h</mi>
                          </msub>
                          <mo stretchy='false'>)</mo>
                        </mrow>
                        <mn>2</mn>
                      </msup>
                      <mo>/</mo>
                      <mn>2</mn>
                      <mo>&rcub;</mo>
                    </mrow>
                  </mfrac>
                  <mo>.</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>We continue these imputations until the algorithm converges. In practice, one imputation seems to be sufficient for most problems, since each imputation is computationally intensive, and additional imputations did not seem to change the results significantly.</p>
        </sec>
        <sec id="s4a3">
          <title>Diagnosing patient survival via supervised clustering<italic/></title>
          <p>We calculated the Cox scores of each gene based on the 160 training observations, and obtained a list of the most significant genes. Then we performed 2-means clustering on these 160 observations using the genes with the largest absolute Cox scores and obtained two subgroups. We repeated this procedure multiple times with different numbers of genes. For each such clustering, we trained a nearest shrunken centroid classifier to assign future patients to one subgroup or the other and examined the crossvalidation error rate.</p>
          <p>The problem of choosing the number of genes on which to perform the clustering is more complicated than it appears. The obvious way to choose the optimal number of genes on which to cluster is to simply minimize the crossvalidation error rate of the nearest shrunken centroids model based on the clustering. This works up to a certain point. It is possible that the clustering procedure will identify a cluster that is unrelated to survival. (Since we are clustering on the genes with the highest Cox scores, this is unlikely to occur. However, it is still possible, especially if the number of genes on which we are clustering is large.) Thus, we needed to build a safeguard against this possibility into our procedure. After performing clustering based on a given set of high-scoring genes, we performed a log-rank test to determine if the resulting clusters differed with respect to survival. If they did not, the clustering was discarded without further analysis. An outline of the procedure follows: (1) Choose a set <italic>G</italic> of possible values of Γ. (2) Let <italic>p</italic><sub>min</sub> = 1 and <italic>e</italic><sub>min</sub> = 1. (3) For each Γ in <italic>G</italic>, do the following: (4) Perform <italic>k</italic>-means clustering using only those genes with absolute Cox scores greater than Γ. (5) Perform a log-rank test to test the hypothesis that the <italic>k</italic> clusters have different survival rates. Call the <italic>p</italic>-value of this test <italic>p</italic>. (6) If <italic>p</italic>≥<italic>p</italic><sub>min</sub>, then return to step 3. (7) Fit a nearest shrunken centroids model based on the clusters obtained in step 3. Calculate the minimum crossvalidation error rate across all values of the shrinkage parameter, and call it <italic>e</italic>. (8) If <italic>e</italic>&lt;<italic>e</italic><sub>min</sub>, then let Γ<sub>best</sub> = Γ, and return to step 3. Otherwise return to step 3 without changing the value of Γ<sub>best</sub>. The optimal value of Γ is taken to be the value of Γ<sub>best</sub> when this procedure terminates.</p>
          <p>Several comments about this procedure are in order. First, note that we did not recalculate the Cox scores at each fold of the crossvalidation procedure. We calculated them only once, using all of the patients in the dataset. There are several reasons for doing this. Recalculating the Cox scores at each fold would be extremely expensive computationally. Moreover, we found that the Cox score of a given gene varied depending on the number of patients (and which patients) we included in the model. Thus, if a given value of Γ produced a low crossvalidation error rate, there was no guarantee that a model based on the full dataset using this value of Γ would produce good results, since the model based on the full dataset may use a different list of genes. Other studies have found that using the entire dataset to produce a “significant gene list” prior to performing crossvalidation can produce more accurate predictions (<xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. 2002</xref>).</p>
          <p>Also, the set <italic>G</italic> was left unspecified in the procedure. The choice of which (and how many) possible values of Γ to include in <italic>G</italic> depends on the problem at hand, as well as the computational power available. As a default, we recommend trying 100 evenly spaced values of Γ between the 90th percentile of the Cox scores and the maximum of the Cox scores. However, the optimal Γ<sub>best</sub> varies greatly from dataset to dataset, so we recommend trying several different forms of <italic>G</italic> if adequate computing power exists.</p>
          <p>Furthermore, note that when we calculated the <italic>p</italic>-value of the log-rank test after performing the original clustering, we insisted not only that the <italic>p</italic>-value be significant, but also that it be lower than the best <italic>p</italic>-value obtained thus far. The reasons for this are twofold. First, experience suggests that if a given set of genes produces a good clustering on the training data (“good” defined as having a low <italic>p</italic>-value from a log-rank test), then it is likely to produce a good clustering on the test data. (We offer no theoretical or biological justification for this statement; it simply represents our experience. However, we have observed this result a sufficient number of times to convince us that it is not coincidental.) Moreover, this speeds up the algorithm substantially. Calculating the nearest shrunken centroids crossvalidation error rate for a given clustering is the slowest part of the procedure; the time required to perform the clustering and calculate the log-rank statistic is insignificant in comparison. Thus, by only considering clusterings which produce a log-rank statistic with a small <italic>p</italic>-value, we allow the set <italic>G</italic> to be much larger than would be feasible otherwise.</p>
          <p>Finally, the number of clusters <italic>k</italic> was unspecified in the procedure. We have experimented with some algorithms to choose the value of <italic>k</italic> automatically, but without success. If possible, we recommend that the value of <italic>k</italic> be chosen based on prior biological knowledge. (Perhaps one could first perform hierarchical clustering, examine a dendogram of the data, and visually search for major subgroups.) If this is not possible, we recommend trying several different small values of <italic>k</italic> and choosing the one that gives the best results. (Our experience suggests that choosing <italic>k</italic> = 2 will give good results for almost all datasets.)</p>
        </sec>
        <sec id="s4a4">
          <title>Supervised principal components<italic/></title>
          <p>As above, let <italic>X</italic> be the <italic>p</italic>×<italic>n</italic> matrix of expression values, for <italic>p</italic> genes and <italic>n</italic> patients. Let <italic>x</italic><sub><italic>ij</italic></sub> denote the expression level of the 𝒾th gene in the 𝒿th patient. Assume that each patient has one of two possible underlying tumor types. Without loss of generality, assume that patients 1, …,<italic>m</italic> have tumor type 1, and that patients <italic>m</italic> + 1,…,<italic>n</italic> have tumor type 2. Then assume that the genetic profiles of the two tumor types are distinct from one another, which is equivalent to assuming that the joint distribution of (<italic>x</italic><sub>1<italic>j</italic></sub>, …,<italic>x</italic><sub><italic>pj</italic></sub>) is different for 1 ≤ 𝒿 ≤ 𝓂 than it is for 𝓂 + 1 ≤ 𝒿 ≤ 𝓃. Thus, if we choose constants {<italic>a</italic><sub><italic>i</italic></sub>}<inline-formula id="form3"><sup><italic>p</italic></sup><sub><italic>i</italic>=1</sub></inline-formula>, the distribution of ∑<inline-formula id="form4"><sup><italic>p</italic></sup><sub><italic>j</italic>=1</sub></inline-formula> <italic>a<sub>j</sub>x<sub>ij</sub></italic> will be different for 1 ≤ 𝒿 ≤ 𝓂 than it is for 𝓂 + 1 ≤ 𝒿 ≤ 𝓃. (Obviously, this is not true for all values of {<italic>a<sub>i</sub></italic>}<inline-formula id="form5"><sup><italic>p</italic></sup><sub><italic>i</italic></sub>=1</inline-formula>. For example, if we let <italic>a<sub>i</sub></italic> = 0 for all 𝒾, then this statement will not hold. However, it will generally be true unless we deliberately choose a pathological set {<italic>a<sub>i</sub></italic>}<inline-formula id="form6"><sup><italic>p</italic></sup><sub><italic>i</italic></sub>=1</inline-formula>.)</p>
          <p>In particular, consider the singular value decomposition of <italic>X</italic>:</p>
          <p>
            <disp-formula id="pbio-0020108-e009"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e009" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <mi>X</mi>
                  <mo>=</mo>
                  <mi>U</mi>
                  <mi>D</mi>
                  <msup>
                    <mi>V</mi>
                    <mi>T</mi>
                  </msup>
                  <mo>,</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>where <italic>U</italic> is a <italic>p</italic> × 𝓃 orthogonal matrix, <italic>D</italic> is an 𝓃 × 𝓃 diagonal matrix, and <italic>V</italic> is an 𝓃 × 𝓃 orthogonal matrix (<xref ref-type="bibr" rid="pbio-0020108-Horn1">Horn and Johnson 1985</xref>). Then the matrix <italic>V</italic> can be written as</p>
          <p>
            <disp-formula id="pbio-0020108-e010"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e010" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <mi>V</mi>
                  <mo>=</mo>
                  <msup>
                    <mi>X</mi>
                    <mi>T</mi>
                  </msup>
                  <mi>U</mi>
                  <msup>
                    <mi>D</mi>
                    <mrow>
                      <mo>&minus;</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                  <mo>.</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>In other words, for a given column of <italic>V</italic>, each row of <italic>V</italic> is a linear combination of the expression values in the corresponding column of <italic>X</italic>. Thus, by the argument in the preceding paragraph, rows 1 through 𝓂 should have a different distribution than rows 𝓂 + 1 through 𝓃. Hence, we propose that the first few columns of <italic>V</italic> be used as continuous predictors of survival for each patient. Formally,</p>
          <p>
            <disp-formula id="pbio-0020108-e011"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e011" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <mover accent='true'>
                    <mi>V</mi>
                    <mo>&#x0302;</mo>
                  </mover>
                  <mo>=</mo>
                  <msup>
                    <mi>X</mi>
                    <mi>T</mi>
                  </msup>
                  <mi>U</mi>
                  <msup>
                    <mi>D</mi>
                    <mrow>
                      <mo>&minus;</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                  <mo>.</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>Moreover, suppose that we have an independent test set X̃I. Then let</p>
          <p>
            <disp-formula id="pbio-0020108-e012"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pbio.0020108.e012" xlink:type="simple"/><!-- <math display='block'>
                <mrow>
                  <mover accent='true'>
                    <mi>V</mi>
                    <mo>&#x0302;</mo>
                  </mover>
                  <mo>=</mo>
                  <msup>
                    <mstyle mathsize='140%' displaystyle='true'>
                      <mover accent='true'>
                        <mi>X</mi>
                        <mo>&#x0303;</mo>
                      </mover>
                    </mstyle>
                    <mi>T</mi>
                  </msup>
                  <mi>U</mi>
                  <msup>
                    <mi>D</mi>
                    <mrow>
                      <mo>&minus;</mo>
                      <mn>1</mn>
                    </mrow>
                  </msup>
                  <mo>,</mo>
                </mrow>
              </math> --></disp-formula>
          </p>
          <p>where <italic>U</italic> and <italic>D</italic> are the same as in <xref ref-type="disp-formula" rid="pbio-0020108-e011">equation (11)</xref> (i.e., derived from the singular value decomposition of the training data). In this case, the first few columns of V̂I can be used to estimate survival for the patients in the independent test set.</p>
          <p>The reason for choosing the first few columns of <italic>V</italic> is because the matrix <italic>U</italic> was chosen so that <italic>X<sup>T</sup>u</italic><sub>1</sub> has the largest sample variance amongst all normalized linear combinations of the rows of <italic>X</italic> (<xref ref-type="bibr" rid="pbio-0020108-Hastie2">Hastie et al. 2001b</xref>). (Here, <italic>u</italic><sub>1</sub> represents the first column of <italic>U</italic>.) Hence, assuming that variation in gene expression accounts for variation in survival, we would expect that <italic>X<sup>T</sup></italic><sub><italic>u</italic>1</sub> captures a large percentage of the variation in survival. (Indeed, in some simple models, it can be proven that <xref ref-type="disp-formula" rid="pbio-0020108-e011">equation [11]</xref> is the best possible predictor of survival; see <xref ref-type="supplementary-material" rid="sd018">Protocol S1</xref>.)</p>
          <p>In theory, we could calculate <italic>V</italic> using the entire dataset <italic>X</italic>, and the rows of <italic>V</italic> would have different distributions depending on the tumor type of the corresponding patient. In practice, however, many of the genes in <italic>X</italic> are unrelated to survival, and if we use the entire dataset <italic>X</italic> to compute <italic>V</italic>, the quality of the resulting predictor is poor. We can overcome this difficulty by using only the genes with the largest Cox scores. Formally, we construct a matrix <italic>X</italic>′ consisting of only those genes whose Cox scores are greater than some threshold Γ, and take the singular value decomposition of <italic>X</italic>′.</p>
          <p>To choose the optimal value of Γ, we employ the following procedure: (1) Choose a set <italic>G</italic> of possible values of Γ. (2) For each Γ in <italic>G</italic>, split the training data into <italic>k</italic> random partitions (i.e., perform <italic>k</italic>-fold crossvalidations). For most problems (and for the rest of this discussion), we can let <italic>k</italic> = 10. (3) For each crossvalidation fold, take a singular value decomposition of <italic>X</italic>, leaving out one of the 10 partitions for validation purposes. Use only those genes with absolute Cox scores greater than Γ. (4) Calculate υ̂ for the 10% of the data that was withheld, as described above. (5) Fit a Cox proportional hazards model to υ̂, and calculate the chi-square statistic for the log-rank test associated with this model. Denote the chi-square statistic for the 𝒾th crossvalidation fold by 𝓌<sub><italic>i</italic></sub>. (6) Average the 𝓌<sub><italic>i</italic></sub>s over the 10 crossvalidation folds. Call this average 𝓌<sub>Γ</sub>. (7) If 𝓌<sub>Γ</sub> is greater than the value of 𝓌<sub>Γ∗</sub>, then let Γ∗ = Γ and 𝓌<sub>Γ∗</sub> = 𝓌<sub>Γ</sub>. (8) Return to step 2. The set <italic>G</italic> is left unspecified in the procedure. As a default, we recommend trying 30 evenly spaced values of Γ between the 90th percentile of the Cox scores and the maximum of the Cox scores, although this recommendation is somewhat arbitrary.</p>
          <p>In some cases, we can improve the predictive power of our model by taking a linear combination of several columns of <italic>V</italic> (rather than simply taking the first column of <italic>V</italic>). Suppose we wish to find a predictor based on the first <italic>k</italic> columns of <italic>V</italic>. We can perform the following procedure: (1) Let <italic>X</italic> denote the training data. Take the singular value decomposition of <italic>X</italic> = <italic>UDV<sup>T</sup></italic> as described above (after selecting an appropriate subset of the genes). (2) Fit a Cox proportional hazards model using the first <italic>k</italic> columns of <italic>V</italic> as predictors. (3) Calculate the matrix V̂I for the test data using <xref ref-type="disp-formula" rid="pbio-0020108-e012">equation (12)</xref> above. (4) Take a linear combination of the first <italic>k</italic> columns of V̂I using the Cox regression coefficients obtained in step 2. Use the resulting sum as a continuous predictor of survival.</p>
        </sec>
        <sec id="s4a5">
          <title>Software and computational details<italic/></title>
          <p>All computations in this study were performed using the R statistical package, which is available on the Internet at <ext-link ext-link-type="uri" xlink:href="http://cran.r-project.org/" xlink:type="simple">http://cran.r-project.org/</ext-link>. R source code for the procedures described in this paper are available from the authors upon request (see also <xref ref-type="supplementary-material" rid="sd001">Data S1–Data S4</xref>). These methods will also be implemented in a future version of the PAM microarray analysis package (<xref ref-type="bibr" rid="pbio-0020108-Tibshirani2">Tibshirani et al. 2003</xref>). (The “median cut” method has been implemented in version 1.20, which is now available.)</p>
        </sec>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="sd001" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd001" xlink:type="simple">
        <label>Data S1</label>
        <caption>
          <title>Documentation of Our R Functions</title>
          <p>This file contains a brief description of the functions contained in the semi-super.R file.</p>
          <p>(1 KB TXT).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd002" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd002" xlink:type="simple">
        <label>Data S2</label>
        <caption>
          <title>R Source Code</title>
          <p>This file contains R functions for implementing the procedures we have described in our study.</p>
          <p>(6 KB TXT).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd003" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd003" xlink:type="simple">
        <label>Data S3</label>
        <caption>
          <title>Source Code for Simulation Study 1</title>
          <p>This file contains the R source code that we used to perform the first simulation study in our paper.</p>
          <p>(31 KB TXT).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd004" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd004" xlink:type="simple">
        <label>Data S4</label>
        <caption>
          <title>Source Code for Simulation Study 2</title>
          <p>This file contains the R source code that we used to perform the second simulation study in our paper.</p>
          <p>(39 KB TXT).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd005" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd005" xlink:type="simple">
        <label>Dataset S1</label>
        <caption>
          <title>Breast Cancer Expression Data: <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref> Study</title>
          <p>The gene expression data for the breast cancer study of <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref>. We include only the expression levels of 4,751 genes identified in the study whose expression varied</p>
          <p>(2.9 MB CSV).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd006" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd006" xlink:type="simple">
        <label>Dataset S2</label>
        <caption>
          <title>Breast Cancer Gene Names: <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref> Study</title>
          <p>The names of each of the 4,751 genes in the study of <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref>.</p>
          <p>(74 KB CSV).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd007" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd007" xlink:type="simple">
        <label>Dataset S3</label>
        <caption>
          <title>Breast Cancer Survival Data: <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref> Study</title>
          <p>The clinical data for the study of <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. (2002)</xref>. The first column represents the time until metastasis (or the time until the patient left the study); the second column is 1 if the tumor metastasized and 0 if it did not.</p>
          <p>(1 KB CSV).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd008" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd008" xlink:type="simple">
        <label>Dataset S4</label>
        <caption>
          <title>Breast Cancer Expression Data: <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. (2002)</xref> Study</title>
          <p>The gene expression data for the 70 genes in the breast cancer study of <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. (2002)</xref>.</p>
          <p>(141 KB CSV).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd009" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd009" xlink:type="simple">
        <label>Dataset S5</label>
        <caption>
          <title>Breast Cancer Gene Names: <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. (2002)</xref> Study</title>
          <p>The names of the 70 genes in the study of <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. (2002)</xref>.</p>
          <p>(1 KB CSV).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd010" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd010" xlink:type="simple">
        <label>Dataset S6</label>
        <caption>
          <title>Repeated Breast Cancer Samples</title>
          <p>A single column that is 1 if the patient was included in the earlier study (that of <xref ref-type="bibr" rid="pbio-0020108-vant1">van't Veer et al. [2002</xref>]), and 0 if the patient was not included in the earlier study.</p>
          <p>(1 KB CSV).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd011" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd011" xlink:type="simple">
        <label>Dataset S7</label>
        <caption>
          <title>Breast Cancer Survival Data: <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. (2002)</xref> Study</title>
          <p>The clinical data for the study of <xref ref-type="bibr" rid="pbio-0020108-vannde1">van de Vijver et al. (2002)</xref>. The format is the same as the format of the earlier file of clinical data.</p>
          <p>(5 KB CSV).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd012" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd012" xlink:type="simple">
        <label>Dataset S8</label>
        <caption>
          <title>DLBCL Expression Data</title>
          <p>The gene expression data for the DLBCL study of <xref ref-type="bibr" rid="pbio-0020108-Rosenwald1">Rosenwald et al. (2002</xref>).</p>
          <p>(24.38 MB CSV).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd013" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd013" xlink:type="simple">
        <label>Dataset S9</label>
        <caption>
          <title>DLBCL Survival Data</title>
          <p>The clinical data for the study of <xref ref-type="bibr" rid="pbio-0020108-Rosenwald1">Rosenwald et al. (2002</xref>). The format is the same as the format of the clinical data above.</p>
          <p>(2 KB CSV).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd014" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd014" xlink:type="simple">
        <label>Dataset S10</label>
        <caption>
          <title>Lung Cancer Gene Expression Data</title>
          <p>This is the gene expression data for the lung cancer dataset of <xref ref-type="bibr" rid="pbio-0020108-Beer1">Beer et al. (2002</xref>).</p>
          <p>(5.39 MB TXT).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd015" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd015" xlink:type="simple">
        <label>Dataset S11</label>
        <caption>
          <title>Lung Cancer Survival Data</title>
          <p>This is the clinical data for the lung cancer dataset of <xref ref-type="bibr" rid="pbio-0020108-Beer1">Beer et al. (2002</xref>). The format is the same as in the clinical data above.</p>
          <p>(1 KB TXT).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd016" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd016" xlink:type="simple">
        <label>Dataset S12</label>
        <caption>
          <title>AML Gene Expression Data</title>
          <p>This is the gene expression data for the AML dataset of <xref ref-type="bibr" rid="pbio-0020108-Bullinger1">Bullinger et al. (2004</xref>).</p>
          <p>(9.96 MB TXT).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd017" mimetype="text/plain" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd017" xlink:type="simple">
        <label>Dataset S13</label>
        <caption>
          <title>AML Survival Data</title>
          <p>This is the clinical data for the AML dataset of <xref ref-type="bibr" rid="pbio-0020108-Bullinger1">Bullinger et al. (2004</xref>). It has the same format as the clinical data above.</p>
          <p>(1 KB TXT).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sg001" mimetype="image/tiff" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sg001" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <title>Results of Using PLS-Derived Cox Scores in the Supervised Clustering Procedure</title>
          <p>(8.26 MB TIFF).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sg002" mimetype="image/tiff" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sg002" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <title>Plot of Survival Versus the Least Squares Estimate of β̃ for the DLBCL Data</title>
          <p>(8.33 MB TIFF).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sg003" mimetype="image/tiff" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sg003" xlink:type="simple">
        <label>Figure S3</label>
        <caption>
          <title>Plot of Survival Versus the Least Squares Estimate of γ̃ for the DLBCL Data</title>
          <p>(8.42 MB TIFF).</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="sd018" mimetype="application/x-tex" position="anchor" xlink:href="info:doi/10.1371/journal.pbio.0020108.sd018" xlink:type="simple">
        <label>Protocol S1</label>
        <caption>
          <title>Additional Models and Methods</title>
          <p>(28 KB TEX).</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>Eric Bair was supported by an NSF graduate research fellowship. Robert Tibshirani was partially supported by National Science Foundation Grant DMS-9971405 and National Institutes of Health Contract N01-HV-28183. We thank the academic editor and three reviewers for their helpful comments.</p>
    </ack>
    
    <ref-list>
      <title>References</title>
      <ref id="pbio-0020108-Alizadeh1">
        <label>1</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Alizadeh</surname>
              <given-names>AA</given-names>
            </name>
            <name name-style="western">
              <surname>Eisen</surname>
              <given-names>MB</given-names>
            </name>
            <name name-style="western">
              <surname>Davis</surname>
              <given-names>RE</given-names>
            </name>
            <name name-style="western">
              <surname>Ma</surname>
              <given-names>C</given-names>
            </name>
            <name name-style="western">
              <surname>Lossos</surname>
              <given-names>IS</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Distinct types of diffuse large B-cell lymphoma identified by gene expression profiling.</article-title>
          <source>Nature</source>
          <year>2000</year>
          <volume>403</volume>
          <fpage>503</fpage>
          <lpage>511</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Beer1">
        <label>2</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Beer</surname>
              <given-names>DG</given-names>
            </name>
            <name name-style="western">
              <surname>Kardia</surname>
              <given-names>SL</given-names>
            </name>
            <name name-style="western">
              <surname>Huang</surname>
              <given-names>CC</given-names>
            </name>
            <name name-style="western">
              <surname>Giordano</surname>
              <given-names>TJ</given-names>
            </name>
            <name name-style="western">
              <surname>Levin</surname>
              <given-names>AM</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene-expression profiles predict survival of patients with lung adenocarcinoma.</article-title>
          <source>Nat Med</source>
          <year>2002</year>
          <volume>8</volume>
          <fpage>816</fpage>
          <lpage>824</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Ben-Dor1">
        <label>3</label>
        <nlm-citation publication-type="book" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Ben-Dor</surname>
              <given-names>A</given-names>
            </name>
            <name name-style="western">
              <surname>Friedman</surname>
              <given-names>N</given-names>
            </name>
            <name name-style="western">
              <surname>Yakhini</surname>
              <given-names>Z</given-names>
            </name>
          </person-group>
          <article-title>Class discovery in gene expression data. Proceedings of the fifth annual international conference on computational biology.</article-title>
          <year>2001</year>
          <publisher-loc>Montreal (Quebec)</publisher-loc>
          <publisher-name>ACM Press</publisher-name>
          <fpage>31</fpage>
          <lpage>38</lpage>
          <comment>doi: <ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1145/369133.369167" xlink:type="simple">10.1145/369133.369167</ext-link></comment>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Bhattacharjee1">
        <label>4</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Bhattacharjee</surname>
              <given-names>A</given-names>
            </name>
            <name name-style="western">
              <surname>Richards</surname>
              <given-names>WG</given-names>
            </name>
            <name name-style="western">
              <surname>Staunton</surname>
              <given-names>J</given-names>
            </name>
            <name name-style="western">
              <surname>Li</surname>
              <given-names>C</given-names>
            </name>
            <name name-style="western">
              <surname>Monti</surname>
              <given-names>S</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Classification of human lung carcinomas by mRNA expression profiling reveals distinct adenocarcinoma subclasses.</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2001</year>
          <volume>98</volume>
          <fpage>13790</fpage>
          <lpage>13795</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Bullinger1">
        <label>5</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Bullinger</surname>
              <given-names>L</given-names>
            </name>
            <name name-style="western">
              <surname>Döhner</surname>
              <given-names>K</given-names>
            </name>
            <name name-style="western">
              <surname>Bair</surname>
              <given-names>E</given-names>
            </name>
            <name name-style="western">
              <surname>Fröhling</surname>
              <given-names>S</given-names>
            </name>
            <name name-style="western">
              <surname>Schlenk</surname>
              <given-names>R</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene expression profiling identifies new subclasses and improves outcome prediction in adult myeloid leukemia.</article-title>
          <source>N Engl J Med</source>
          <year>2004</year>
          <comment>in press</comment>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Chu1">
        <label>6</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Chu</surname>
              <given-names>G</given-names>
            </name>
            <name name-style="western">
              <surname>Narasimhan</surname>
              <given-names>B</given-names>
            </name>
            <name name-style="western">
              <surname>Tibshirani</surname>
              <given-names>R</given-names>
            </name>
            <name name-style="western">
              <surname>Tusher</surname>
              <given-names>V</given-names>
            </name>
          </person-group>
          <article-title>Significance analysis of microarrays (PAM) software.</article-title>
          <year>2002</year>
          <comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www-stat.stanford.edu/tibs/SAM/" xlink:type="simple">http://www-stat.stanford.edu/tibs/SAM/</ext-link> via the Internet. Accessed 16 July 2003</comment>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Coiffier1">
        <label>7</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Coiffier</surname>
              <given-names>B</given-names>
            </name>
          </person-group>
          <article-title>Diffuse large cell lymphoma.</article-title>
          <source>Curr Opin Oncol</source>
          <year>2001</year>
          <volume>13</volume>
          <fpage>325</fpage>
          <lpage>334</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Cox1">
        <label>8</label>
        <nlm-citation publication-type="book" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Cox</surname>
              <given-names>DR</given-names>
            </name>
            <name name-style="western">
              <surname>Oakes</surname>
              <given-names>D</given-names>
            </name>
          </person-group>
          <article-title>Analysis of survival data.</article-title>
          <year>1984</year>
          <publisher-loc>London</publisher-loc>
          <publisher-name>Chapman and Hall</publisher-name>
          <page-count count="208"/>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Eisen1">
        <label>9</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Eisen</surname>
              <given-names>MB</given-names>
            </name>
            <name name-style="western">
              <surname>Spellman</surname>
              <given-names>PT</given-names>
            </name>
            <name name-style="western">
              <surname>Brown</surname>
              <given-names>PO</given-names>
            </name>
            <name name-style="western">
              <surname>Botstein</surname>
              <given-names>D</given-names>
            </name>
          </person-group>
          <article-title>Cluster analysis and display of genome-wide expression patterns.</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>1998</year>
          <volume>95</volume>
          <fpage>14863</fpage>
          <lpage>14868</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Golub1">
        <label>10</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Golub</surname>
              <given-names>T</given-names>
            </name>
            <name name-style="western">
              <surname>Slonim</surname>
              <given-names>DK</given-names>
            </name>
            <name name-style="western">
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name name-style="western">
              <surname>Huard</surname>
              <given-names>C</given-names>
            </name>
            <name name-style="western">
              <surname>Gaasenbeek</surname>
              <given-names>M</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Molecular classification of cancer: Class discovery and class prediction by gene expression monitoring.</article-title>
          <source>Science</source>
          <year>1999</year>
          <volume>286</volume>
          <fpage>531</fpage>
          <lpage>536</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Gordon1">
        <label>11</label>
        <nlm-citation publication-type="book" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Gordon</surname>
              <given-names>AD</given-names>
            </name>
          </person-group>
          <article-title>Classification.</article-title>
          <year>1999</year>
          <publisher-loc>Boca Raton (Louisiana)</publisher-loc>
          <publisher-name>Chapman and Hall</publisher-name>
          <page-count count="256"/>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Hastie1">
        <label>12</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Hastie</surname>
              <given-names>T</given-names>
            </name>
            <name name-style="western">
              <surname>Tibshirani</surname>
              <given-names>R</given-names>
            </name>
            <name name-style="western">
              <surname>Botstein</surname>
              <given-names>D</given-names>
            </name>
            <name name-style="western">
              <surname>Brown</surname>
              <given-names>P</given-names>
            </name>
          </person-group>
          <article-title>Supervised harvesting of expression trees.</article-title>
          <source>Genome Biol</source>
          <year>2001a</year>
          <volume>2</volume>
          <fpage>1</fpage>
          <lpage>12</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Hastie2">
        <label>13</label>
        <nlm-citation publication-type="book" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Hastie</surname>
              <given-names>T</given-names>
            </name>
            <name name-style="western">
              <surname>Tibshirani</surname>
              <given-names>R</given-names>
            </name>
            <name name-style="western">
              <surname>Friedman</surname>
              <given-names>J</given-names>
            </name>
          </person-group>
          <article-title>The elements of statistical learning: Data mining, inference and prediction.</article-title>
          <year>2001b</year>
          <publisher-loc>New York</publisher-loc>
          <publisher-name>Springer-Verlag</publisher-name>
          <page-count count="552"/>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Hedenfalk1">
        <label>14</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Hedenfalk</surname>
              <given-names>I</given-names>
            </name>
            <name name-style="western">
              <surname>Duggan</surname>
              <given-names>D</given-names>
            </name>
            <name name-style="western">
              <surname>Chen</surname>
              <given-names>Y</given-names>
            </name>
            <name name-style="western">
              <surname>Radmacher</surname>
              <given-names>M</given-names>
            </name>
            <name name-style="western">
              <surname>Bittner</surname>
              <given-names>M</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene-expression profiles in hereditary breast cancer.</article-title>
          <source>N Engl J Med</source>
          <year>2001</year>
          <volume>344</volume>
          <fpage>539</fpage>
          <lpage>548</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Horn1">
        <label>15</label>
        <nlm-citation publication-type="book" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Horn</surname>
              <given-names>RA</given-names>
            </name>
            <name name-style="western">
              <surname>Johnson</surname>
              <given-names>CR</given-names>
            </name>
          </person-group>
          <article-title>Matrix analysis.</article-title>
          <year>1985</year>
          <publisher-loc>New York</publisher-loc>
          <publisher-name>Cambridge University Press</publisher-name>
          <page-count count="575"/>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Khan1">
        <label>16</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Khan</surname>
              <given-names>J</given-names>
            </name>
            <name name-style="western">
              <surname>Wei</surname>
              <given-names>JS</given-names>
            </name>
            <name name-style="western">
              <surname>Ringnér</surname>
              <given-names>M</given-names>
            </name>
            <name name-style="western">
              <surname>Saal</surname>
              <given-names>LH</given-names>
            </name>
            <name name-style="western">
              <surname>Ladanyi</surname>
              <given-names>M</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Classification and diagnostic prediction of cancers using gene expression profiling and artificial neural networks.</article-title>
          <source>Nat Med</source>
          <year>2001</year>
          <volume>7</volume>
          <fpage>673</fpage>
          <lpage>679</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Lapointe1">
        <label>17</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Lapointe</surname>
              <given-names>J</given-names>
            </name>
            <name name-style="western">
              <surname>Li</surname>
              <given-names>C</given-names>
            </name>
            <name name-style="western">
              <surname>van de Rijn</surname>
              <given-names>M</given-names>
            </name>
            <name name-style="western">
              <surname>Huggins</surname>
              <given-names>JP</given-names>
            </name>
            <name name-style="western">
              <surname>Bair</surname>
              <given-names>E</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene expression profiling identifies clinically relevant subtypes of prostate cancer.</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2004</year>
          <volume>101</volume>
          <fpage>811</fpage>
          <lpage>816</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Lehmann1">
        <label>18</label>
        <nlm-citation publication-type="book" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Lehmann</surname>
              <given-names>E</given-names>
            </name>
            <name name-style="western">
              <surname>Casella</surname>
              <given-names>G</given-names>
            </name>
          </person-group>
          <article-title>Theory of point estimation.</article-title>
          <year>1998</year>
          <publisher-loc>New York</publisher-loc>
          <publisher-name>Springer-Verlag</publisher-name>
          <page-count count="589"/>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Li1">
        <label>19</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Li</surname>
              <given-names>H</given-names>
            </name>
            <name name-style="western">
              <surname>Luan</surname>
              <given-names>Y</given-names>
            </name>
          </person-group>
          <article-title>Kernel Cox regression models for linking gene expression profiles to censored survival data. Pacific symposium on biocomputing.</article-title>
          <year>2003</year>
          <comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.smi.stanford.edu/projects/helix/psb03/li.pdf" xlink:type="simple">http://www.smi.stanford.edu/projects/helix/psb03/li.pdf</ext-link> via the Internet. Accessed 11 December 2003</comment>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-McLachlan1">
        <label>20</label>
        <nlm-citation publication-type="book" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>McLachlan</surname>
              <given-names>GJ</given-names>
            </name>
          </person-group>
          <article-title>Discriminant analysis and statistical pattern recognition.</article-title>
          <year>1992</year>
          <publisher-loc>New York</publisher-loc>
          <publisher-name>John Wiley and Sons</publisher-name>
          <page-count count="526"/>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Nguyen1">
        <label>21</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Nguyen</surname>
              <given-names>DV</given-names>
            </name>
            <name name-style="western">
              <surname>Rocke</surname>
              <given-names>DM</given-names>
            </name>
          </person-group>
          <article-title>Multi-class cancer classification via partial least squares with gene expression profiles.</article-title>
          <source>Bioinformatics</source>
          <year>2002a</year>
          <volume>18</volume>
          <fpage>1216</fpage>
          <lpage>1226</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Nguyen2">
        <label>22</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Nguyen</surname>
              <given-names>DV</given-names>
            </name>
            <name name-style="western">
              <surname>Rocke</surname>
              <given-names>DM</given-names>
            </name>
          </person-group>
          <article-title>Tumor classification by partial least squares using microarray gene expression data.</article-title>
          <source>Bioinformatics</source>
          <year>2002b</year>
          <volume>18</volume>
          <fpage>39</fpage>
          <lpage>50</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-NHLCP1">
        <label>23</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <collab xlink:type="simple">[NHLCP] Non-Hodgkin's Lymphoma Classification Project</collab>
          <article-title>A clinical evaluation of the international lymphoma study group classification of non-hodgkin's lymphoma.</article-title>
          <source>Blood</source>
          <year>1997</year>
          <volume>89</volume>
          <fpage>3909</fpage>
          <lpage>3918</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Nutt1">
        <label>24</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Nutt</surname>
              <given-names>CL</given-names>
            </name>
            <name name-style="western">
              <surname>Mani</surname>
              <given-names>DR</given-names>
            </name>
            <name name-style="western">
              <surname>Betensky</surname>
              <given-names>RA</given-names>
            </name>
            <name name-style="western">
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name name-style="western">
              <surname>Cairncross</surname>
              <given-names>JG</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene expression-based classification of malignant gliomas correlates better with survival than histological classification.</article-title>
          <source>Cancer Res</source>
          <year>2003</year>
          <volume>63</volume>
          <fpage>1602</fpage>
          <lpage>1607</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Ramaswamy1">
        <label>25</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Ramaswamy</surname>
              <given-names>S</given-names>
            </name>
            <name name-style="western">
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name name-style="western">
              <surname>Rifkin</surname>
              <given-names>R</given-names>
            </name>
            <name name-style="western">
              <surname>Mukherjee</surname>
              <given-names>S</given-names>
            </name>
            <name name-style="western">
              <surname>Yeang</surname>
              <given-names>CH</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Multiclass cancer diagnosis using tumor gene expression signatures.</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2001</year>
          <volume>98</volume>
          <fpage>15149</fpage>
          <lpage>15154</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Rosenwald1">
        <label>26</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Rosenwald</surname>
              <given-names>A</given-names>
            </name>
            <name name-style="western">
              <surname>Wright</surname>
              <given-names>G</given-names>
            </name>
            <name name-style="western">
              <surname>Chan</surname>
              <given-names>WC</given-names>
            </name>
            <name name-style="western">
              <surname>Connors</surname>
              <given-names>JM</given-names>
            </name>
            <name name-style="western">
              <surname>Campo</surname>
              <given-names>E</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>The use of molecular profiling to predict survival after chemotherapy for diffuse large B-cell lymphoma.</article-title>
          <source>N Engl J Med</source>
          <year>2002</year>
          <volume>346</volume>
          <fpage>1937</fpage>
          <lpage>1947</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Shipp1">
        <label>27</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Shipp</surname>
              <given-names>MA</given-names>
            </name>
            <name name-style="western">
              <surname>Ross</surname>
              <given-names>KN</given-names>
            </name>
            <name name-style="western">
              <surname>Tamayo</surname>
              <given-names>P</given-names>
            </name>
            <name name-style="western">
              <surname>Weng</surname>
              <given-names>AP</given-names>
            </name>
            <name name-style="western">
              <surname>Kutok</surname>
              <given-names>JL</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Diffuse large B-cell lymphoma outcome prediction by gene-expression profiling and supervised machine learning.</article-title>
          <source>Nat Med</source>
          <year>2002</year>
          <volume>8</volume>
          <fpage>68</fpage>
          <lpage>74</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Sorlie1">
        <label>28</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Sorlie</surname>
              <given-names>T</given-names>
            </name>
            <name name-style="western">
              <surname>Perou</surname>
              <given-names>C</given-names>
            </name>
            <name name-style="western">
              <surname>Tibshirani</surname>
              <given-names>R</given-names>
            </name>
            <name name-style="western">
              <surname>Aas</surname>
              <given-names>T</given-names>
            </name>
            <name name-style="western">
              <surname>Geisler</surname>
              <given-names>S</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene expression patterns of breast carcinomas distinguish tumor subclasses with clinical implications.</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2001</year>
          <volume>98</volume>
          <fpage>10969</fpage>
          <lpage>10974</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Therneau1">
        <label>29</label>
        <nlm-citation publication-type="book" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Therneau</surname>
              <given-names>TM</given-names>
            </name>
            <name name-style="western">
              <surname>Grambsch</surname>
              <given-names>PM</given-names>
            </name>
          </person-group>
          <article-title>Modelling survival data: Extending the cox model.</article-title>
          <year>2000</year>
          <publisher-loc>New York</publisher-loc>
          <publisher-name>Springer-Verlag</publisher-name>
          <page-count count="350"/>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Tibshirani1">
        <label>30</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Tibshirani</surname>
              <given-names>R</given-names>
            </name>
            <name name-style="western">
              <surname>Hastie</surname>
              <given-names>T</given-names>
            </name>
            <name name-style="western">
              <surname>Narasimhan</surname>
              <given-names>B</given-names>
            </name>
            <name name-style="western">
              <surname>Chu</surname>
              <given-names>G</given-names>
            </name>
          </person-group>
          <article-title>Diagnosis of multiple cancer types by shrunken centroids of gene expression.</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2002</year>
          <volume>99</volume>
          <fpage>6567</fpage>
          <lpage>6572</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Tibshirani2">
        <label>31</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Tibshirani</surname>
              <given-names>R</given-names>
            </name>
            <name name-style="western">
              <surname>Hastie</surname>
              <given-names>T</given-names>
            </name>
            <name name-style="western">
              <surname>Narasimhan</surname>
              <given-names>B</given-names>
            </name>
            <name name-style="western">
              <surname>Chu</surname>
              <given-names>G</given-names>
            </name>
          </person-group>
          <article-title>Prediction analysis for microarrays (PAM) software.</article-title>
          <year>2003</year>
          <comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www-stat.stanford.edu/tibs/PAM/index.html" xlink:type="simple">http://www-stat.stanford.edu/tibs/PAM/index.html</ext-link> via the Internet. Accessed 12 July 2003</comment>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Tusher1">
        <label>32</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Tusher</surname>
              <given-names>VG</given-names>
            </name>
            <name name-style="western">
              <surname>Tibshirani</surname>
              <given-names>R</given-names>
            </name>
            <name name-style="western">
              <surname>Chu</surname>
              <given-names>G</given-names>
            </name>
          </person-group>
          <article-title>Significance analysis of microarrays applied to the ionizing radiation response.</article-title>
          <source>Proc Natl Acad Sci U S A</source>
          <year>2001</year>
          <volume>98</volume>
          <fpage>5116</fpage>
          <lpage>5121</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-vannde1">
        <label>33</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>van de Vijver</surname>
              <given-names>MJ</given-names>
            </name>
            <name name-style="western">
              <surname>He</surname>
              <given-names>YD</given-names>
            </name>
            <name name-style="western">
              <surname>van 't Veer</surname>
              <given-names>LJ</given-names>
            </name>
            <name name-style="western">
              <surname>Dai</surname>
              <given-names>H</given-names>
            </name>
            <name name-style="western">
              <surname>Hart</surname>
              <given-names>AA</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>A gene-expression signature as a predictor of survival in breast cancer.</article-title>
          <source>N Engl J Med</source>
          <year>2002</year>
          <volume>347</volume>
          <fpage>1999</fpage>
          <lpage>2009</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-vant1">
        <label>34</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>van't Veer</surname>
              <given-names>LJ</given-names>
            </name>
            <name name-style="western">
              <surname>Dai</surname>
              <given-names>H</given-names>
            </name>
            <name name-style="western">
              <surname>van de Vijver</surname>
              <given-names>MJ</given-names>
            </name>
            <name name-style="western">
              <surname>He</surname>
              <given-names>YD</given-names>
            </name>
            <name name-style="western">
              <surname>Hart</surname>
              <given-names>AAM</given-names>
            </name>
            <etal/>
          </person-group>
          <article-title>Gene expression profiling predicts clinical outcome of breast cancer.</article-title>
          <source>Nature</source>
          <year>2002</year>
          <volume>415</volume>
          <fpage>530</fpage>
          <lpage>536</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-von1">
        <label>35</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>von Heydebreck</surname>
              <given-names>A</given-names>
            </name>
            <name name-style="western">
              <surname>Huber</surname>
              <given-names>W</given-names>
            </name>
            <name name-style="western">
              <surname>Poustka</surname>
              <given-names>A</given-names>
            </name>
            <name name-style="western">
              <surname>Vingron</surname>
              <given-names>M</given-names>
            </name>
          </person-group>
          <article-title>Identifying splits with clear separation: A new class discovery method for gene expression data.</article-title>
          <source>Bioinformatics</source>
          <year>2001</year>
          <volume>17</volume>
          <supplement>(Suppl 1)</supplement>
          <fpage>S107</fpage>
          <lpage>S114</lpage>
        </nlm-citation>
      </ref>
      <ref id="pbio-0020108-Vose1">
        <label>36</label>
        <nlm-citation publication-type="journal" xlink:type="simple">
          <person-group person-group-type="author">
            <name name-style="western">
              <surname>Vose</surname>
              <given-names>JM</given-names>
            </name>
          </person-group>
          <article-title>Current approaches to the management of non-hodgkin's lymphoma.</article-title>
          <source>Semin Oncol</source>
          <year>1998</year>
          <volume>25</volume>
          <fpage>483</fpage>
          <lpage>491</lpage>
        </nlm-citation>
      </ref>
    </ref-list>
    <glossary>
      <title>Abbreviations</title>
      <def-list>
        <def-item>
          <term>DLBCL</term>
          <def>
            <p>diffuse large B-cell lymphoma</p>
          </def>
        </def-item>
        <def-item>
          <term>LDA</term>
          <def>
            <p>linear discriminant analysis</p>
          </def>
        </def-item>
        <def-item>
          <term>PLS</term>
          <def>
            <p>partial least squares</p>
          </def>
        </def-item>
        <def-item>
          <term>SVM</term>
          <def>
            <p>support vector machine</p>
          </def>
        </def-item>
      </def-list>
    </glossary>
  </back>
</article>