<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-0704R4</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000886</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biophysics/Theory and Simulation</subject><subject>Computational Biology/Computational Neuroscience</subject><subject>Neuroscience/Neuronal Signaling Mechanisms</subject><subject>Neuroscience/Theoretical Neuroscience</subject></subj-group></article-categories><title-group><article-title>Stochastic Ion Channel Gating in Dendritic Neurons: Morphology Dependence and Probabilistic Synaptic Activation of Dendritic Spikes</article-title><alt-title alt-title-type="running-head">Stochastic Ion Channels and Neuronal Morphology</alt-title></title-group><contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Cannon</surname><given-names>Robert C.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>O'Donnell</surname><given-names>Cian</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Nolan</surname><given-names>Matthew F.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Textensor Limited, Edinburgh, United Kingdom</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Neuroinformatics Doctoral Training Centre, University of Edinburgh, Edinburgh, United Kingdom</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Centre for Integrative Physiology, University of Edinburgh, Edinburgh, United Kingdom</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Graham</surname><given-names>Lyle J.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Universit√© Paris Descartes, Centre National de la Recherche Scientifique, France</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">mattnolan@ed.ac.uk</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: RCC CO MFN. Performed the experiments: RCC CO MFN. Analyzed the data: RCC CO MFN. Contributed reagents/materials/analysis tools: RCC MFN. Wrote the paper: MFN. Designed and developed simulation tools: RCC.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>8</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>12</day><month>8</month><year>2010</year></pub-date><volume>6</volume><issue>8</issue><elocation-id>e1000886</elocation-id><history>
<date date-type="received"><day>17</day><month>6</month><year>2009</year></date>
<date date-type="accepted"><day>14</day><month>7</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Cannon et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Neuronal activity is mediated through changes in the probability of stochastic transitions between open and closed states of ion channels. While differences in morphology define neuronal cell types and may underlie neurological disorders, very little is known about influences of stochastic ion channel gating in neurons with complex morphology. We introduce and validate new computational tools that enable efficient generation and simulation of models containing stochastic ion channels distributed across dendritic and axonal membranes. Comparison of five morphologically distinct neuronal cell types reveals that when all simulated neurons contain identical densities of stochastic ion channels, the amplitude of stochastic membrane potential fluctuations differs between cell types and depends on sub-cellular location. For typical neurons, the amplitude of membrane potential fluctuations depends on channel kinetics as well as open probability. Using a detailed model of a hippocampal CA1 pyramidal neuron, we show that when intrinsic ion channels gate stochastically, the probability of initiation of dendritic or somatic spikes by dendritic synaptic input varies continuously between zero and one, whereas when ion channels gate deterministically, the probability is either zero or one. At physiological firing rates, stochastic gating of dendritic ion channels almost completely accounts for probabilistic somatic and dendritic spikes generated by the fully stochastic model. These results suggest that the consequences of stochastic ion channel gating differ globally between neuronal cell-types and locally between neuronal compartments. Whereas dendritic neurons are often assumed to behave deterministically, our simulations suggest that a direct consequence of stochastic gating of intrinsic ion channels is that spike output may instead be a probabilistic function of patterns of synaptic input to dendrites.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>The activity of neurons in the brain is mediated through changes in the probability of random transitions between open and closed states of ion channels. Since differences in morphology define distinct types of neuron and may underlie neurological disorders, it is important to understand how morphology influences the functional consequences of these random transitions. However, the complexities of neuronal morphology, together with the large number of ion channels expressed by a single neuron, have made this issue difficult to explore systematically. We introduce and validate new computational tools that enable efficient generation and simulation of models containing ion channels distributed across complex neuronal morphologies. Using these tools we demonstrate that the impact of random ion channel opening depends on neuronal morphology and ion channel kinetics. We show that in a realistic model of a neuron important for navigation and memory random gating of ion channels substantially modifies responses to synaptic input. Our results suggest a new and general perspective, whereby output from a neuron is a probabilistic rather than a fixed function of synaptic input to its dendrites. These results and new tools will contribute to the understanding of how intrinsic properties of neurons influence computations carried out within the brain.</p>
</abstract><funding-group><funding-statement>This work was supported by a BBSRC Tools and Resources Fund award (BB/E014527/1 to MFN), a Marie Curie Excellence grant (MFN), the Network of European Neuroscience Institutes (<ext-link ext-link-type="uri" xlink:href="http://www.eni-net.org/" xlink:type="simple">http://www.eni-net.org/</ext-link>) and the EPSRC (C'OD). This work has made use of the resources provided by the ECDF (<ext-link ext-link-type="uri" xlink:href="http://www.ecdf.ed.ac.uk/" xlink:type="simple">http://www.ecdf.ed.ac.uk/</ext-link>). The ECDF is partially supported by the eDIKT initiative (<ext-link ext-link-type="uri" xlink:href="http://www.edikt.org.uk" xlink:type="simple">http://www.edikt.org.uk</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="18"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>The appropriate level of physical detail required to understand how complex processes such as cognition and behavior emerge from more simple biological structures is unclear <xref ref-type="bibr" rid="pcbi.1000886-Kitano1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Milner1">[2]</xref>. For example, while it is possible to account for certain aspects of nervous system function using models that represent each neuron as a simple integrate and fire device, it is increasingly clear that this approach does not capture the full range of computations that many real neurons carry out <xref ref-type="bibr" rid="pcbi.1000886-Koch1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Poirazi1">[4]</xref>. Dendritic and axonal morphology are defining features of neuronal cell types and have important influences on the computations that a neuron performs <xref ref-type="bibr" rid="pcbi.1000886-Hausser1">[5]</xref>. Differences in morphology determine how neurons respond to synaptic input and are sufficient to produce distinct patterns of spontaneous activity <xref ref-type="bibr" rid="pcbi.1000886-Mainen1">[6]</xref> and degrees of action potential back-propagation from the soma into the dendrites <xref ref-type="bibr" rid="pcbi.1000886-Vetter1">[7]</xref>. Cable theory and compartmental modeling provide a foundation for predicting the propagation of electrical signals in the dendrites and axons of neurons <xref ref-type="bibr" rid="pcbi.1000886-Rall1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Hines1">[9]</xref>. However, while the assumption that transitions between open and closed states of ion channels can be treated as a deterministic process may be sufficient for some purposes, recent evidence suggests that stochastic transitions between the states of individual ion channels could influence computations carried out by neurons <xref ref-type="bibr" rid="pcbi.1000886-Carelli1">[10]</xref>‚Äì<xref ref-type="bibr" rid="pcbi.1000886-White1">[17]</xref>. Stochastic opening and closing of ion channels causes ‚Äònoisy‚Äô fluctuations in the current or voltage recorded from a neuron <xref ref-type="bibr" rid="pcbi.1000886-Anderson1">[18]</xref>‚Äì<xref ref-type="bibr" rid="pcbi.1000886-White2">[20]</xref>. While cable theory suggests that fluctuations of this kind might be particularly important in fine structures such as axons and dendrites <xref ref-type="bibr" rid="pcbi.1000886-Jack1">[21]</xref>, we nevertheless know very little about how neuronal morphology and stochastic gating of ion channels interact to determine how neurons respond to synaptic input. Given the difficulty of reducing detailed morphological models to simple analytical forms that could also incorporate stochastic gating of individual ion channels <xref ref-type="bibr" rid="pcbi.1000886-Mino1">[22]</xref>, experimentally constrained numerical simulations will be important to enable these issues to be explored systematically.</p>
<p>Investigation of stochastic ion channel gating using numerical simulations has been limited by trades-offs between simulation accuracy and computation time <xref ref-type="bibr" rid="pcbi.1000886-Mino1">[22]</xref>. A simple approach is to add noise sources to deterministic models. However, as ion channels have multiple functional states with transitions that often depend on the membrane voltage <xref ref-type="bibr" rid="pcbi.1000886-Dudman1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Schneidman1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Mino1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Clay1">[23]</xref>, this may not accurately account for the noise introduced by ion channel currents. A more accurate alternative is to explicitly model transitions between different functional states for each ion channel on a neuron's membrane. However, for neurons with complex axonal or dendritic architectures there are two substantial obstacles to this approach. First, typical central neurons express large numbers of ion channels and simulations must be repeated many times to obtain statistically valid descriptions <xref ref-type="bibr" rid="pcbi.1000886-Colquhoun1">[24]</xref>. This is a formidable computational task and even relatively straightforward simulations of the consequences of stochastic channel gating can require substantial computing time (see e.g. <xref ref-type="bibr" rid="pcbi.1000886-Faisal1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Kole1">[13]</xref>). Second, each neuronal ion channel occupies a specific location on the extra-cellular membrane, whereas most neuronal models represent the distribution of ion channels as the density of a deterministic conductance across an area of membrane. Although this formalism has been successful for simulating many aspects of neuronal activity, it is of less use for models that explore the consequences of the localization of individual ion channels, for example to evaluate the macroscopic effects of short range interactions between ion channels and other signaling molecules <xref ref-type="bibr" rid="pcbi.1000886-Bhalla1">[25]</xref>, or the consequences of spatially heterogeneous distributions of ion channels within relatively small sub-cellular structures such as dendritic spines and axon terminals <xref ref-type="bibr" rid="pcbi.1000886-Kollo1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Lujan1">[27]</xref>.</p>
<p>To address the functional consequences of stochastic ion channel gating in neurons with extensive dendritic or axonal arborizations we developed a parallel stochastic ion channel simulator (PSICS), which enables efficient simulation of the electrical activity of neurons with complex morphologies and arbitrary localization of stochastic ion channels on the extracellular membrane, while also addressing limitations of previous approaches. We have also developed an interactive tool (ICING) for visualization and development of models of neurons containing uniquely located ion channels. Here, we illustrate the use of PSICS and ICING, outline the computational strategies used and provide benchmark data for evaluation. We then identify previously unappreciated differences between the effects of stochastic ion channel gating on somatic and dendritic membrane potential activity in several different morphological classes of neuron. We show that the consequences of stochastic gating depend on dendritic morphology and suggest novel functional roles for the kinetics of ion channel gating. Using a previously well-validated realistic model of a CA1 pyramidal neuron we demonstrate that stochastic ion channel gating influences spike output in response to dendritic synaptic input. We show that stochastic gating of axonal or dendritic ion channels substantially modifies synaptically driven dendritic and axonal spike output, with stochastic gating of voltage-dependent sodium and potassium channels having the greatest impact and hyperpolarization-activated channels the least. By demonstrating that neuronal responses to dendritic synaptic input can be intrinsically probabilistic, these results offer a new and general perspective on synaptic integration by central neurons. Full documentation for PSICS/ICING as well as the software, source code and examples are available from the project website (<ext-link ext-link-type="uri" xlink:href="http://www.psics.org" xlink:type="simple">http://www.psics.org</ext-link>).</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Model specification and visualization</title>
<p>To investigate the functional consequences of stochastic ion channel gating for neurons with complex dendritic or axonal morphologies, we first developed new software tools that enable accurate, fast simulation (PSICS) and visualization (ICING) of neuronal models that contain stochastically gating ion channels. The organization and development of the new software tools are described in <xref ref-type="supplementary-material" rid="pcbi.1000886.s005">Text S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1000886.s001">Figure S1</xref> and in more detail on the project website (<ext-link ext-link-type="uri" xlink:href="http://www.psics.org" xlink:type="simple">http://www.psics.org</ext-link>). Here, we briefly outline novel features of model specification and visualization, before describing key benchmark data and simulation experiments that evaluate the functional impact of stochastic ion channel gating in different neuronal cell types. The new software uses a simple XML file structure that enables components of a model either to be constructed manually, to be configured using a graphical interface (<xref ref-type="fig" rid="pcbi-1000886-g001">Figure 1A</xref>), or in the case of ion channels and morphologies to be imported from other programs and databases that allow saving of models in the NeuroML format. For example the morphology of the model CA1 pyramidal neuron shown in <xref ref-type="fig" rid="pcbi-1000886-g001">Figure 1</xref> was downloaded as a NEURON simulation from the modelDB website (<ext-link ext-link-type="uri" xlink:href="http://senselab.med.yale.edu/modeldb" xlink:type="simple">http://senselab.med.yale.edu/modeldb</ext-link>) and exported from NEURON as a .xml file. Similar methods can be used to import models developed with Neuroconstruct (<ext-link ext-link-type="uri" xlink:href="http://www.neuroconstruct.org/" xlink:type="simple">http://www.neuroconstruct.org/</ext-link>) <xref ref-type="bibr" rid="pcbi.1000886-Gleeson1">[28]</xref>.</p>
<fig id="pcbi-1000886-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000886.g001</object-id><label>Figure 1</label><caption>
<title>Specification and visualization of ion channel location.</title>
<p>In PSICS individual ion channels have unique locations that can be viewed along with the compartmentalization chosen for a particular simulation using additional software called ICING. (A) Screen shot of ICING. (B) Detailed view of the compartmentalization of part of the model neuron in (A). (C) Low magnification 3 dimensional detail of dendritic branches from (B). (D) High magnification 3 dimensional detail of dendritic branches in (C) illustrating the location of individual ion channels.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.g001" xlink:type="simple"/></fig>
<p>To specify the membrane conductance we adopted a new approach in which the location of each individual ion channel is first uniquely determined (<xref ref-type="fig" rid="pcbi-1000886-g001">Figure 1</xref>). This approach is complementary to that of the program MCell <xref ref-type="bibr" rid="pcbi.1000886-Stiles1">[29]</xref>, which simulates movement and reactions of molecules within and around cells. In contrast, other neuronal modeling software approximates ion channel location as an average conductance density across a region of membrane. Before simulations are run in PSICS the neuron is discretized into sections that are then treated as isopotential compartments. As neurons are rarely at steady-state and have conductance that varies with membrane voltage, we implemented a discretization procedure that balances the capacitive charging rates for adjacent compartments (see <xref ref-type="sec" rid="s4">Methods</xref>). The granularity of the discretization process is set by the user and determines the number of channels in a particular compartment. After discretization the PSICS simulation engine will by default compute the activity of the population of channels in an isopotential compartment, rather than the activity of each individual ion channel. Modifying the granularity of the discretization process changes the number of channels per compartment, but not the actual distribution or location of channels in the model.</p>
<p>Since the presently available tools for visualization and development of neuronal models are aimed primarily at deterministic simulations, we developed a graphical tool (ICING) to allow display and manipulation of neuronal models with complex three-dimensional architectures and many discrete membrane ion channels (<xref ref-type="fig" rid="pcbi-1000886-g001">Figure 1</xref>). ICING reads neuron morphologies specified either in NeuroML or as .swc files generated by the Neurolucida reconstruction program and used by the NeuroMorpho.org database (<ext-link ext-link-type="uri" xlink:href="http://neuromorpho.org/" xlink:type="simple">http://neuromorpho.org/</ext-link>). This enables components of a PSICS model to be visualized and edited. For example, to: 1) specify the size of compartments to use for the simulation, 2) select ion channels to be included in the model neuron, 3) select sections of the model for insertion of a particular ion channel class, 4) set rules that dictate the distribution of ion channels in their designated sections. The model neuron and its associated ion channels can be displayed in a variety of formats, for example to emphasize labeled sub-regions of the model (<xref ref-type="fig" rid="pcbi-1000886-g001">Figure 1A</xref>), to illustrate the compartmental boundaries in a model (<xref ref-type="fig" rid="pcbi-1000886-g001">Figure 1B</xref>), or to provide a detailed 3-dimensional exploration of the neuron morphology and ion channel distribution (<xref ref-type="fig" rid="pcbi-1000886-g001">Figure 1C‚ÄìD</xref>).</p>
</sec><sec id="s2b">
<title>Simulation of stochastic ion channels</title>
<p>We represent ion channels using Markov models, in which each ion channel may be in one of a number of discrete states with the probability of transition to any other state determined independently of the channel's previous history <xref ref-type="bibr" rid="pcbi.1000886-Colquhoun1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Hille1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Cannon1">[31]</xref>. To efficiently simulate stochastic transitions between states of a channel we developed a modified version of the tau leap method (see <xref ref-type="sec" rid="s4">Methods</xref>) <xref ref-type="bibr" rid="pcbi.1000886-Gillespie1">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Cao1">[33]</xref>. The algorithm we use is equivalent to sampling an exact realization of the number of channels in a particular state at the end of each time step. In principle this results in shorter simulation times than algorithms that track the exact times of transitions between states <xref ref-type="bibr" rid="pcbi.1000886-Gillespie2">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Chow1">[35]</xref>, or methods that permit a maximum of one transition per ion channel during each step <xref ref-type="bibr" rid="pcbi.1000886-Dudman1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Clay1">[23]</xref>. To further reduce the simulation time the algorithm considers only channels with a non-negligible probability of making a transition during a particular step (see <xref ref-type="sec" rid="s4">Methods</xref>). At any particular sample time point and membrane potential, the tau leap algorithm should not produce any systematic error in the mean or variance of the current. However, the modified tau leap algorithm will not explicitly represent transitions that take place between time-points. We show below how this algorithm is particularly advantageous for current-clamp simulations in which high frequency current fluctuations are filtered by the neuronal membrane. We will also address how the choice of simulation parameters determines the accuracy and computation time.</p>
<p>To first evaluate the modified tau leap algorithm for stochastic simulations we consider a simple three-state Na<sup>+</sup> channel model recorded with an ideal voltage-clamp (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000886.s002">Figure S2</xref>). At a fixed membrane potential the simulated current through deterministic Na<sup>+</sup> channels is constant, whereas the equivalent stochastic simulation reveals large fluctuations in the Na<sup>+</sup> channel current (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2A</xref>). With sufficiently long periods of simulated channel activity, the mean amplitude of the stochastic current converges to the amplitude of the deterministic current (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2B</xref>) and the estimated variance of the stochastic current converges to the value predicted from the number of channels and their single channel current amplitude (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2C</xref>). In deterministic simulations positive voltage steps from a negative holding potential elicit smoothly varying inward currents that activate rapidly, inactivate and are followed by a resurgent component after repolarization to the negative holding potential (<xref ref-type="supplementary-material" rid="pcbi.1000886.s002">Figure S2</xref>). In corresponding stochastic simulations the current response contains step-like fluctuations and differs from trial to trial, with the average waveform over many trials converging on the equivalent deterministic waveform (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2D</xref>). To determine whether the expected number of single channels and their single channel conductance could be retrieved from the simulated macroscopic currents, we carried out variance-mean analysis <xref ref-type="bibr" rid="pcbi.1000886-Neher1">[36]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Sigworth1">[37]</xref>. Both parameters could be estimated from either the activating (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2E</xref>) or the inactivating phase of the current (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2F</xref>). Estimates of the number of single channels (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2G</xref>) and their single channel conductance (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2H</xref>) converged over many simulations onto their predicted values. These data demonstrate that our modified tau leap algorithm accurately simulates stochastic voltage-gated ion channel activity. This is further illustrated by the convergence towards zero of the error for the fit of the variance-mean function (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2I</xref>). On the order of 10<sup>4</sup> simulations were required for the fits to reliably converge to within 1% of the actual values, highlighting the importance of obtaining large numbers of repeated observations for estimating single channel properties using variance-mean analysis. Estimates obtained from 10<sup>4</sup> or fewer simulations varied around the actual values depending on the number of simulations used (<xref ref-type="fig" rid="pcbi-1000886-g002">Figure 2G‚ÄìI</xref>), suggesting an additional use of PSICS to quickly simulate the range of errors likely for estimates obtained from variance-mean analysis of macroscopic currents generated by channels with different gating schemes.</p>
<fig id="pcbi-1000886-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000886.g002</object-id><label>Figure 2</label><caption>
<title>Accurate stochastic ion channel simulation.</title>
<p>(A) Examples of simulated stochastic (black traces) and deterministic (red traces) currents in a membrane patch containing 50 stochastic Na<sup>+</sup> channels with single channel conductance of 20 pS. The membrane potential is clamped at ‚àí20 mV. The expanded trace (right) shows the first 5 ms of the compressed trace (left). (B‚ÄìC) Cumulative estimate of the mean (B) and variance (C) of stochastic currents measured as in (A) are plotted as a function of time. Examples from 5 separate simulations of duration 100 s are shown. Values between 100 and 1000 s are from concatenation of separate 100 s simulations. (D) Examples of 10 simulated current responses (black traces, lower plot), of the membrane patch simulated in (A‚ÄìC), to a step change in membrane potential from ‚àí80 mV to +30 mV (upper plot). The mean (red trace) and variance (blue trace) are calculated from 1000 stochastic current responses. (E‚ÄìF) Plot of membrane the membrane current variance as a function of the mean membrane current for the rapid activation phase (E) and slower inactivation phase (F) of the 1000 simulated current responses used to obtain the data for (D). The time window for the activation phase is 0‚Äì0.3 ms after the onset of the voltage step, whereas the time window for the deactivation phase is 0.3‚Äì10 ms after the onset of the voltage step. The number of single channels (N) and the single channel current (I) are estimated from the fit to the simulation data. The red parabola is the variance-mean relationship predicted from I and N of the model and the blue parabola is the fit to the simulation data. (G‚ÄìH) Estimates for the number of channels (G) and single channel current (H), obtained by variance mean analysis of the inactivation phase of the current responses analyzed as in (D), plotted as a function of the number of simulated responses used for the analysis. Each dot corresponds to a set of data used for analysis. The continuous lines show convergence of the estimates as additional simulations are analyzed up to a maximum of 10<sup>4</sup> simulated responses. (I) The RMS error, calculated from the difference between the variance mean fit and the expected variance mean relationship, is plotted as a function of the number of simulated responses. The solid lines indicate progressive convergence up to a maximum of 10<sup>4</sup> simulated responses. For all examples the simulation time step was 10 ¬µS.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.g002" xlink:type="simple"/></fig></sec><sec id="s2c">
<title>Propagation of current and voltage in compartmental models containing stochastic ion channels</title>
<p>Before comparing simulations of neurons with different morphologies, we first established the accuracy of simulation of current and voltage propagation using standard compartmental models for which there are analytical descriptions of the equivalent cable structures <xref ref-type="bibr" rid="pcbi.1000886-Bhalla2">[38]</xref>. We examined the membrane potential of a simple cable containing stochastic leak Na<sup>+</sup> and K<sup>+</sup> channels (<xref ref-type="fig" rid="pcbi-1000886-g003">Figure 3A</xref>). While fluctuations in the membrane potential are very small when both leak channels have a very small single channel conductance (0.01 pS), when either single channel conductance is increased to physiological values (&gt;1 pS), there is a substantial increase in the membrane noise (<xref ref-type="fig" rid="pcbi-1000886-g003">Figure 3B</xref>). Although of physiological relevance, this noise makes comparison with analytical results problematic and therefore for validation of stochastic simulations we used a single channel conductance of 0.01 pS. Membrane potential responses to injection of a current step at one end of the cable, simulated with PSICS using either stochastic or deterministic ion channels, were effectively identical to the analytical result (<xref ref-type="fig" rid="pcbi-1000886-g003">Figure 3C</xref>). Moreover, using a model of a branching dendrite (<xref ref-type="fig" rid="pcbi-1000886-g003">Figure 3D</xref>), stochastic or deterministic ion channel simulations with PSICS also accurately reproduce the predicted voltage change in response to current injection (<xref ref-type="fig" rid="pcbi-1000886-g003">Figure 3E</xref>). Thus, PSICS accurately simulates passive propagation of signals in compartmental models of cable structures, and when stochastic ion channels have very small single channel conductance the electrical behavior of a multi-compartment model is similar to models containing deterministic ion channels.</p>
<fig id="pcbi-1000886-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000886.g003</object-id><label>Figure 3</label><caption>
<title>Simulation of membrane polarization and spike propagation in cable structures containing stochastic ion channels.</title>
<p>(A) Simulated uniform cable with recording and current injection sites. (B) Example membrane potential traces (left) from simulations using leak Na<sup>+</sup> and K<sup>+</sup> channels with the indicated single channel conductances. The membrane potential variance is plotted as a function of the single channel conductance (right). (C) Voltage responses to injection of a current step at one end of the cable. Simulated stochastic (Stoch) and deterministic (Det) responses are plotted along with the analytical solution (Ref). Insets show the voltage as the current responses approach their steady-state values. In each case the traces overlap. As a result the Ref and Det traces are obscured by the Stoch trace. (D) Simulated branched cable structure with recording and current injection sites. (E) Voltage responses to injection of a current step at the base of the tree. Insets show the voltage as the current responses approach their steady-state values. Labels are as in (C). Ref and Det traces are obscured by the Stoch trace. (F) Action potentials generated when Hodgkin-Huxley channels are inserted into the cable in A. The top panel compares results of deterministic simulations using NEURON or PSICS, with stochastic PSICS simulations using a single channel conductance of 0.01 pS. The lower panel shows the output of several stochastic PSICS simulations using a single channel conductance of 20 pS. Membrane potentials in (E) and (F) are labeled as in (C), except that the blue trace is data from a simulation using NEURON.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.g003" xlink:type="simple"/></fig>
<p>We next assessed simulation of excitable neurons. In a model of a cylinder containing active membrane conductances <xref ref-type="bibr" rid="pcbi.1000886-Bhalla2">[38]</xref>, simulations with PSICS that used deterministic ion channel models or stochastic implementations of channels with very small single channel conductance, produced essentially identical results to well established deterministic simulation software (<xref ref-type="fig" rid="pcbi-1000886-g003">Figure 3F</xref>). By contrast, when we increased the single channel conductance to more physiological values, we found that while the action potential waveform was similar, the stochastic ion channel gating introduced jitter into the timing of the action potentials, such that reproducible timing of spike firing was not maintained between trials (<xref ref-type="fig" rid="pcbi-1000886-g003">Figure 3F</xref>). We also compared simulation of an excitable model of a CA1 pyramidal cell shown in <xref ref-type="fig" rid="pcbi-1000886-g001">Figure 1</xref>, with published data obtained with the same model <xref ref-type="bibr" rid="pcbi.1000886-Migliore1">[39]</xref>. The initiation and back propagation of action potentials were reproduced by simulation of this model with PSICS using either deterministic or stochastic ion channels (data not shown).</p>
</sec><sec id="s2d">
<title>The consequences of stochastic gating depend on channel kinetics</title>
<p>While open probability and single channel conductance influence the amplitude of current fluctuations generated by stochastic ion channel gating, little attention has been given to the functional impact of channel kinetics or of interactions between channel properties and the membrane capacitance. The simplified models we used to evaluate PSICS also allowed us to begin to investigate these issues. To avoid non-linearities from voltage-dependent gating, we simulated single-compartment models that contain only passive leak Na<sup>+</sup> and K<sup>+</sup> channels. Each channel has one open and one closed state, with an open probability of 0.7, and the relative density of the channels was adjusted to produce a resting membrane potential of ‚àí60 mV. We compared a version of the model in which the forward and reverse rate constants for entering the open state were 0.07 ms<sup>‚àí1</sup> and 0.03 ms<sup>‚àí1</sup> (slow gating) with a version in which the corresponding rate constants were 7 ms<sup>‚àí1</sup> and 3 ms<sup>‚àí1</sup> (fast gating). The model containing the slow gating channels produced membrane currents in voltage-clamp, or membrane potentials in current-clamp, that fluctuated at frequencies below approximately 15 Hz (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4A</xref>). By contrast, channels with faster gating kinetics produced current fluctuations with similar total power, but smaller amplitude at low frequencies (&lt;‚àº15 Hz) and larger amplitude at higher frequencies (&gt;‚àº15 Hz) (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4B</xref>). In current-clamp simulations, the corresponding high-frequency membrane potential fluctuations were filtered by the membrane capacitance. As a result, the membrane potential fluctuations span a similar range of frequencies to the slow gating model, but have substantially smaller amplitude (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4B</xref>). Thus, the functional impact of stochastic channel gating is determined by gating kinetics in conjunction with the membrane capacitance, as well as by open probability and single channel conductance.</p>
<fig id="pcbi-1000886-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000886.g004</object-id><label>Figure 4</label><caption>
<title>Relationships between channel kinetics, simulation configuration, accuracy and efficiency.</title>
<p>(A‚ÄìB) Examples of membrane currents (top), membrane potential (middle) and corresponding power spectra from 100 s of simulated activity (bottom), for models containing passive leak Na<sup>+</sup> and K<sup>+</sup> channels with slow (A) or fast (B) kinetics. The power spectra are shown for simulations with time steps of 10 ¬µs (solid traces), 100 ¬µs and 1000 ¬µs (light traces). The voltage-clamp simulations are of a single isopotential compartment containing 201 Na<sup>+</sup> and 1407 K<sup>+</sup> leak channels. The current-clamp simulations are for a cable of length 1000 ¬µm and radius 1 ¬µm, containing 8050 channels distributed across 237 compartments. (C) The error in the mean and variance of a simulated current, mediated by 50 Na<sup>+</sup> channels clamped at ‚àí20 mV for 100 s of simulated time, is plotted as a function of the simulation time step. (D) Power spectra for the currents in (C). Long time steps fail to simulate high frequency current fluctuations and introduce aliasing effects at low frequencies. (E‚ÄìF) The computation time per simulation time step, required by NEURON (closed symbols) or PSICS (open symbols) for simulations as in (C‚ÄìD), is plotted as a function of the duration of the simulation time step (E), or as a function of the number of simulated channels when the time step is 20 ¬µs (F). (G) The computation time per simulation time step, required by NEURON or PSICS for simulations as in <xref ref-type="fig" rid="pcbi-1000886-g003">Figure 3F</xref>, is plotted as a function of the duration of the simulation time-step. Simulation times are for a cable divided into either 101 compartments (triangles) or 1001 compartments (circles).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.g004" xlink:type="simple"/></fig>
<p>To examine how the choice of a suitable simulation time step is constrained by these properties, we initially used the simple passive models described above. For the model containing slow leak channels, simulations with time-steps as large as 1 ms reproduced the dominant components of the power spectra of current and voltage fluctuations (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4A</xref>). By contrast, for the model containing fast gating channels, simulation time-steps of 0.01 ms were required to satisfactorily simulate fluctuation of voltage-clamped currents, whereas time steps of duration up to 0.1 ms were sufficient to simulate membrane potential fluctuations in current-clamp conditions (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4B</xref>). Thus, selection of the simulation time-step requires evaluation of the recording configuration, the power spectra of channel activity, the membrane time constant and the kinetics of the simulated channels.</p>
</sec><sec id="s2e">
<title>Efficient simulation of current and voltage propagation</title>
<p>Since simulation of complex neuronal morphologies can take considerable time, even using optimized computational algorithms, before simulating neuronal morphologies we first investigated strategies to minimize the time required for simulations without affecting accuracy of the results. We evaluated a stochastic implementation of the Hodgkin-Huxley Na<sup>+</sup> channel model in a single compartment voltage-clamped at a fixed potential (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4C‚ÄìD</xref>). With simulation time-steps in the range of 1‚Äì1000 ¬µs, currents simulated using PSICS had mean and variance that correspond well to the predicted values (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4C</xref>). However, as the duration of the time-step is increased, the power spectra of the simulated currents reveal aliasing-like effects and failure to accurately simulate high frequency fluctuations (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4D</xref>). Thus, as we expect from the properties of the tau leap algorithm, longer time steps will produce currents with the correct variance and mean amplitude, but will not accurately simulate high frequency components of current fluctuations.</p>
<p>To determine if improvements in simulation efficiency expected from use of the modified tau leap algorithm and an optimized computational core translate into practical reductions in simulation time, we compared the time required for simulations using PSICS to simulations run in the widely used NEURON simulation environment <xref ref-type="bibr" rid="pcbi.1000886-Hines2">[40]</xref>. Stochastic ion channel gating can be simulated in NEURON using the next-transition algorithm which tracks the exact times at which each channel changes state <xref ref-type="bibr" rid="pcbi.1000886-Gillespie2">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Chow1">[35]</xref>. For simulations of voltage-clamped currents using short time-steps and relatively few ion channels, the simulation time with PSICS was approximately three-fold faster than using NEURON (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4E‚ÄìF</xref>). This difference increased to a more than 10 fold reduction in simulation time when PSICS is used for simulations with larger time steps and more ion channels. We next evaluated performance using the spiking single cable model also used for the simulations in <xref ref-type="fig" rid="pcbi-1000886-g003">Figure 3F</xref>. This model contains several types of ion channel distributed across multiple compartments and has a rapidly fluctuating membrane potential. The simulation time per unit biological time was constant for simulations run with NEURON and was independent of the compartment size. By contrast, the times for simulations run with PSICS were faster at all time steps. This difference was &gt;100 fold with relatively large numbers of channels per compartment and long time-steps (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4G</xref>). For simulation parameters likely to be appropriate for many detailed neuronal models we estimate that PSICS obtains approximately an order of magnitude or greater reduction in simulation time. Together, these data establish that the new tools we have developed enable accurate and efficient stochastic simulations of neurons with complex morphologies, with performance that is superior to other general-purpose software.</p>
</sec><sec id="s2f">
<title>Morphology and kinetics interact to determine the influence of stochastic gating on membrane potential</title>
<p>Does morphology influence the functional consequences of stochastic ion channel gating? To address this possibility, we first compared the membrane potential noise resulting from stochastic ion channel gating in a hypothetical dendritic tree that obeys Rall's 2/3 power law, with membrane potential noise resulting from stochastic ion channel gating in the corresponding equivalent cable structure <xref ref-type="bibr" rid="pcbi.1000886-Rall2">[41]</xref> (<xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5</xref>). In both structures spontaneous opening and closing of fast leak K<sup>+</sup> and Na<sup>+</sup> channels causes noisy fluctuations in the membrane potential. These fluctuations increase in amplitude by more than ten fold between the proximal and the distal ends of the branched dendrite model (<xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5D‚ÄìE</xref>)(p&lt;&lt;1e-9), but have relatively small amplitude throughout the equivalent cylinder (<xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5A‚ÄìB</xref>)(p‚Ää=‚Ää0.35). Similar differences in amplitude and location-dependence were present for models that instead contained the slow gating leak channels, but were otherwise identical (<xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5B, E</xref>).</p>
<fig id="pcbi-1000886-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000886.g005</object-id><label>Figure 5</label><caption>
<title>Dendrite morphology determines the influence of stochastic channel opening on membrane potential.</title>
<p>(A‚ÄìF) Recordings of resting membrane potential at proximal (grey traces) and distal (black traces) locations on a multi-compartmental model of a cylinder of length 320 ¬µm and diameter 16 ¬µm (A‚ÄìC) or a hypothetical branched dendrite (D‚ÄìF). The cylinder in (A‚ÄìC) is electrically ‚Äòequivalent‚Äô to the dendrite in (D‚ÄìF), which has a branching organization that follows Rall's 3/2 power law. The distal recordings are from location ‚Äò10‚Äô and the proximal recordings are from location ‚Äò0‚Äô. In each panel the membrane potential when the leak channels have fast kinetics (upper traces) is compared to the membrane potential when the leak channels have slower kinetics (lower traces). Membrane potential when the models have a membrane time constant on the order of 0.1 ms (B,E) is compared to models with a membrane time constant on the order of 10 ms (C,F). The scale bars apply to all traces. (G‚ÄìH) The standard deviation of the resting membrane potential of the models in (A‚ÄìF) is plotted as a function of recording location. Each point is the average of data from 5 simulations of 1s of neuronal activity. The same data were used for statistical analysis (ANOVA). Black and grey symbols correspond to distal and proximal recording locations as in (A‚ÄìF) above.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.g005" xlink:type="simple"/></fig>
<p>Under what conditions do channel kinetics determine the impact of stochastic ion channel gating? Whereas our earlier simulations indicated an important role for channel kinetics (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4A‚ÄìB</xref>), in our initial simulations of the hypothetical dendritic tree and equivalent cable the kinetics of the leak current did not affect the amplitude of the membrane potential fluctuations (p‚Ää=‚Ää0.63)(<xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5G</xref>). However, since the branching tree and the equivalent cable have a membrane time constant on the order of 0.1 ms, whereas many central neurons have membrane time constants on the order of 10 ms, we re-evaluated these models after increasing the membrane capacitance to bring the time constant into this range (<xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5C, F</xref>). In this case, the amplitude of the membrane potential fluctuations was also dependent on location in the branched dendrite (p&lt;&lt;1e-9)(<xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5F</xref>), but not in the equivalent cable (p‚Ää=‚Ää0.474)(<xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5C</xref>). Moreover, in contrast to the models with the fast membrane time constant, for models with a more physiological membrane time constant the kinetics of the leak current profoundly influenced the amplitude of membrane potential fluctuations (<xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5F</xref>). In models containing the fast leak channels the amplitude of membrane potential fluctuations was reduced (p&lt;&lt;1e-9), but in models containing the slow leak channels their amplitude was similar (p‚Ää=‚Ää0.54)(cf. <xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5G,H</xref>). Thus, the cellular effects of stochastic ion channel gating depend on morphology, while the specific effects of morphology depend on the kinetics of the ion channels found in the membrane. Since the consequences of stochastic ion channel gating are sensitive to their specific cellular context, establishing the impact of stochastic gating in particular central neurons will require simulations account for details of their morphology.</p>
</sec><sec id="s2g">
<title>Functional effects of stochastic gating depend on neuronal morphology</title>
<p>Do realistic neuronal morphologies influence the functional impact of stochastic ion channel gating? While the simulations described above suggest this may be the case, they also suggest that the consequences of stochastic gating depend on the specific details of neuronal morphology and ion channel kinetics. To address this question directly, we therefore reasoned that if neuronal morphology is an important determinant of the impact of stochastic ion channel gating, then simulations using identical rules to introduce identical stochastic ion channels into neurons with distinct dendritic morphologies, should predict differences between neurons (<xref ref-type="fig" rid="pcbi-1000886-g006">Figure 6</xref>). We simulated resting membrane potential activity in 29 reconstructed neurons downloaded from neuroMorpho.org <xref ref-type="bibr" rid="pcbi.1000886-Ascoli1">[42]</xref>. The neuronal models spanned 6 distinct morphological classes: neocortical layer V pyramidal neurons (n‚Ää=‚Ää5), cerebellar Purkinje neurons (n‚Ää=‚Ää5), dopaminergic substantia nigra neurons (n‚Ää=‚Ää4), parvalbumin-positive interneurons (n‚Ää=‚Ää5), hippocampal CA1 pyramidal neurons (n‚Ää=‚Ää5) and hippocampal dentate gyrus granule cells (n‚Ää=‚Ää5). Fluctuations in the membrane potential were apparent in all neurons simulated using stochastically gating ion channels (<xref ref-type="fig" rid="pcbi-1000886-g006">Figure 6A</xref>). However, the amplitude of these fluctuations varied significantly both between neurons of the same morphological class (p&lt;0.01 for all classes), between neurons of different morphological classes (p&lt;&lt;1e-9 (<xref ref-type="fig" rid="pcbi-1000886-g006">Figure 6B</xref>), and as a function of dendritic location within neurons (p&lt;&lt;1e-9). For example, pyramidal neurons from the neocortex demonstrate relatively small amplitude membrane potential fluctuations (<xref ref-type="fig" rid="pcbi-1000886-g006">Figure 6</xref>). This is consistent with a previous modeling study of stochastic ion channel activity in a single layer V pyramidal neuron <xref ref-type="bibr" rid="pcbi.1000886-Diba1">[43]</xref>. By contrast, membrane potential fluctuations could be substantially larger in hippocampal dentate gyrus granule cells (<xref ref-type="fig" rid="pcbi-1000886-g006">Figure 6</xref>). Thus, the impact of stochastic gating of dendritic ion channels on neuronal electrical properties is determined by neuronal morphology and can vary according to dendritic location.</p>
<fig id="pcbi-1000886-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000886.g006</object-id><label>Figure 6</label><caption>
<title>Consequences of stochastic ion channel gating differ between morphologically distinct neuronal cell types.</title>
<p>(A) Examples of membrane potential (right) and corresponding morphology (left) from a simulated dentate gyrus granule cell (top), dopaminergic nigral cell (middle) and cortical layer V pyramidal cell (bottom). All models contained identical ion channel distributions. (B) Average membrane potential standard deviation for model neurons of each morphological type plotted as a function of increasing distance along the dendrite from the soma. The membrane potential standard deviation at a particular location corresponds to the right most end of the bar indicated by the corresponding color. The standard deviation increases with distance from the soma.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.g006" xlink:type="simple"/></fig>
<p>As the impact of stochastic gating in the abstract models described above depended on channel kinetics (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4A‚ÄìB</xref> and <xref ref-type="fig" rid="pcbi-1000886-g005">Figure 5</xref>), we asked if this is also the case in the models based on reconstructed neurons. We focused on models of cortical layer V pyramidal neurons and on models of granule cells from the dentate gyrus of the hippocampus. When the fast gating leak channels used for the simulations in <xref ref-type="fig" rid="pcbi-1000886-g006">Figure 6</xref> were replaced with an equivalent deterministic conductance, we found almost no difference in the amplitude of membrane potential fluctuations recorded from somatic or dendritic locations (DG neurons average 1.11 fold difference, p‚Ää=‚Ää0.02; Layer V neurons, average 1.14 fold difference, p‚Ää=‚Ää1.5e-6) (<xref ref-type="fig" rid="pcbi-1000886-g007">Figure 7</xref>). Thus, in the configuration used for simulations in <xref ref-type="fig" rid="pcbi-1000886-g006">Figure 6</xref>, the membrane potential fluctuations are primarily driven by stochastic gating of voltage-gated ion channels, but not by the leak channels. By contrast, when we replaced the fast gating leak channels with otherwise identical slow gating leak channels, the membrane potential fluctuations were approximately three-fold larger than fluctuations recorded from models containing deterministic or fast-gating stochastic leak channels (DG neurons average 3.13 fold difference, p&lt;&lt;1e-9; Layer V neurons, average 3.08 fold difference, p&lt;&lt;1e-9) (<xref ref-type="fig" rid="pcbi-1000886-g007">Figure 7</xref>). Thus, slow gating leak channels can increase the amplitude of spontaneous membrane potential fluctuations. This suggests a novel mechanism for modulation of neuronal activity, whereby modulation of channel gating, without affecting open probability or single channel conductance, could profoundly influence fluctuations in a neuron's somatic or dendritic membrane potential.</p>
<fig id="pcbi-1000886-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000886.g007</object-id><label>Figure 7</label><caption>
<title>Channel kinetics determine the functional impact of stochastic gating.</title>
<p>(A‚ÄìB) Simulated membrane potential of a model layer V pyramidal neuron (A) and a dentate gyrus granule cell (B) containing either a deterministic leak conductance, fast gating stochastic leak channels or slow gating stochastic leak channels. (C‚ÄìD) Mean variance of membrane potential fluctuations, recorded from simulated layer V pyramidal neurons (C) and simulated dentate gyrus granule cells (D), plotted as a function of distance from the cell body.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.g007" xlink:type="simple"/></fig></sec><sec id="s2h">
<title>Stochastic gating of dendritic and axonal ion channels modifies synaptically driven spike output from a detailed model CA1 pyramidal neuron</title>
<p>The previous simulations establish that in principle stochastic gating of intrinsic ion channels might be important for neuronal function, but the impact of stochastic ion channel gating on neuronal responses to physiological patterns of synaptic input is not known. We therefore asked if stochastic gating of post-synaptic ion channels in dendritic neurons influence the transformation of synaptic input into spike output obtained with realistic neuronal morphologies and ion channel properties? In the models described so far, ion channel distributions were chosen to facilitate comparisons between morphologies. To address more realistic ion channel distributions we adopt a model of a CA1 pyramidal neuron that has previously been shown to account well for somatic and dendritically initiated action potentials <xref ref-type="bibr" rid="pcbi.1000886-Jarsky1">[44]</xref> (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8A</xref>). To further increase the approximation of the model to a real CA1 pyramidal neuron we introduced HCN channels with distribution following previous experimental descriptions <xref ref-type="bibr" rid="pcbi.1000886-Golding1">[45]</xref>‚Äì<xref ref-type="bibr" rid="pcbi.1000886-Lorincz1">[47]</xref>. We then examined responses of the model to ongoing activation of 1502 synaptic inputs distributed throughout the basal and apical dendrites, each activated independently according to a Poisson process with an average frequency of 5.5 Hz. We focus here on results of simulations in which the neuron was driven by synaptic input to fire at frequencies of approximately 20 Hz, which is towards the upper end of firing frequency of active CA1 neuron <italic>in vivo</italic> <xref ref-type="bibr" rid="pcbi.1000886-Ahmed1">[48]</xref>. Similar results are obtained for synaptic input that drives firing at lower frequencies and when synaptic input is distributed so that spikes are triggered primarily by depolarization of the distal apical dendrites (not shown). We consider here only asynchronous and distributed synaptic input, which is likely to correspond to activity during the theta state in awake animals <xref ref-type="bibr" rid="pcbi.1000886-Gasparini1">[49]</xref>. As in experimental studies <xref ref-type="bibr" rid="pcbi.1000886-Gasparini1">[49]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Gasparini2">[50]</xref>, forward propagating apical dendritic spikes were only evoked in the model using highly coincident and spatially localized stimuli, but were not observed in response to the patterns of input that we investigate here.</p>
<fig id="pcbi-1000886-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000886.g008</object-id><label>Figure 8</label><caption>
<title>Stochastic ion channels modify synaptically driven spike output from a CA1 pyramidal neuron.</title>
<p>(A) Morphology of the simulated CA1 pyrmidal neurons (described in <xref ref-type="bibr" rid="pcbi.1000886-Jarsky1">[44]</xref>), illustrating positions of recording electrodes placed on the soma (grey), apical (blue) and basal (red) dendrites. (B) Examples of membrane potential responses of the deterministic (red trace) and stochastic (black traces) versions of the model to distributed synaptic input. The summed synaptic current is shown in yellow. Letters and grey bars indicate times of action potentials highlighted in subsequent panels. (C) Spike rasters (top) for responses of the determinisitc model (red) and for 50 consecutive trials of the stochastic model (black) to the synaptic input pattern used in (B). Plotted below is the probability of somatic spike firing in 10 ms duration bins for the deterministic (red) and stochastic (black) versions of the model. (D‚ÄìG) Examples of determinisitc responses (top row) and representative stochastic respones (lower two rows), illustrating ‚Äúextra‚Äù somatic action potentials triggered by an ‚Äúextra‚Äù actively propagating dendritic spike (D), ‚Äúdropped‚Äù somatic action potentials resulting from failed dendritic depolarization (E‚ÄìF), and an ‚Äúextra‚Äù somatic action potental resulting from additional dendritic depolarizing potentials.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.g008" xlink:type="simple"/></fig>
<p>Compared to the deterministic model, the stochastic version generated ‚Äúextra‚Äù spikes at times when the equivalent deterministic neuron was silent and ‚Äúdropped‚Äù spikes at times when the equivalent deterministic neuron fired action potentials (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8B</xref>). Importantly, the ‚Äúextra‚Äù spikes observed during simulation of the stochastic model occurred at similar time-points from trial to trial (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000886.s003">Figure S3</xref>). Thus, stochastic channels allow probabilistic detection of features in the stimulus waveform that would not produce responses in a deterministic neuron. Likewise, not all spikes observed in the deterministic simulation were ‚Äúdropped‚Äù in the stochastic simulation, but rather ‚Äúdropped‚Äù spikes were more likely at particular time points (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000886.s003">Figure S3</xref>). Comparison of spike times from repeated trials demonstrated that stochastic ion channel gating also introduced considerable jitter into the timing of action potentials. Therefore, whereas deterministic neurons encode information using a fixed response to particular patterns of synaptic input, these results suggest that stochastic gating of intrinsic ion channels enables pyramidal neurons to generate probabilistic responses. Thus, while for both stochastic and deterministic neurons certain combinations of synaptic input evoke spikes with high reliability and other combinations fail to elicit spikes, in stochastic neurons some patterns of synaptic input have an intermediate probability of evoking spikes, which is observed as trial-to-trial variability (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8C</xref>). While this intermediate probability might not be decoded in a single trial from a single neuron, if each trial is instead considered as the response of a different neuron within a large population, then the probabilistic responses could quite easily be decoded from the population activity (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8C</xref>).</p>
<p>To evaluate the mechanism for probabilistic initiation of action potentials, we recorded membrane potential from the soma and from proximal parts of each primary dendrite. While some somatic action potentials were preceded by dendritic depolarizations that resemble fully propagating dendritic spikes (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8D</xref>), most were preceded by smaller amplitude dendritic depolarizations (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8E‚ÄìG</xref>). The all-or-nothing nature of these smaller events suggests that they reflect dendritic action potentials that propagate passively to the soma (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8E‚ÄìG</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000886.s003">Figure S3</xref>). This is consistent with experimental recordings from basal dendrites of cortical pyramidal neurons <xref ref-type="bibr" rid="pcbi.1000886-Nevian1">[51]</xref>. In the stochastic model ‚Äúextra‚Äù somatic spikes could result from additional actively propagating dendritic spikes (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8D</xref>) or additional smaller all-or-nothing dendritic depolarizations of sufficient amplitude to elicit somatic action potentials (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8G</xref>), while ‚Äúdropped‚Äù somatic spikes resulted from failures to initiate all-or-nothing dendritic depolarizations (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8E‚ÄìF</xref>). These observations point to the importance of local dendritic signaling for the functional consequences of stochastic ion channel gating in pyramidal neurons and suggest that synaptic initiation and active propagation of dendritic spikes may be particularly sensitive to stochastic membrane potential fluctuations.</p>
<p>To evaluate the relative roles of stochastic axonal compared with stochastic dendritic ion channels we implemented versions of the model in which one population of ion channels was deterministic and the other stochastic. Both axonal and dendritic stochastic channels caused ‚Äúdropped‚Äù and ‚Äúextra‚Äù dendritic spikes (<xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9A‚ÄìB, D</xref>). When only axonal channels were stochastic, the number of ‚Äúdropped‚Äù and ‚Äúextra‚Äù somatic spikes (p&lt;1e-6 in both cases) and dendritic spikes model (p&lt;1e-6 in both cases) were less than in the fully stochastic model (<xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9A</xref>). In contrast, when only the dendritic channels gated stochastically, we found that the number of ‚Äúdropped‚Äù and ‚Äúextra‚Äù somatic spikes was not significantly different compared to the fully stochastic model (p‚Ää=‚Ää0.99 and p‚Ää=‚Ää0.85 respectively), while the number of ‚Äúextra‚Äù (p&lt;1e-6), but not the number of ‚Äúdropped‚Äù (p‚Ää=‚Ää0.81) dendritic spikes differed from the fully stochastic model (<xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9B</xref>). The number of ‚Äúdropped‚Äù and ‚Äúextra‚Äù spikes was much smaller in the stochastic axon model, compared with the stochastic dendrite model (p&lt;1e-6 in all cases). Stochastic gating of axonal channels also caused very little additional jitter in the timing of action potentials, whereas stochastically gating dendritic ion channels could account for almost all of the spike jitter (<xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9E</xref>). These data suggest that while stochastic gating of axonal channels can modify spike patterns, stochastic dendritic channels account for most of the impact of stochastic gating on synaptically driven spike output. This is consistent with the substantial effects of stochastic gating on initiation of dendritic spikes (<xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8D‚ÄìG</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000886.s003">Figure S3</xref>).</p>
<fig id="pcbi-1000886-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000886.g009</object-id><label>Figure 9</label><caption>
<title>Differential impact of distinct ion channel types and locations.</title>
<p>(A‚ÄìB) Rasters for first 20 trials of responses of the CA1 pyramidal neuron simulated as in <xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8</xref>, but with stochastic axonal and deterministic dendritic ion channels (A) or stochastic denritic and deterministic axonal ion channels (B). (C) as for (A‚ÄìB), but only channels mediating <italic>I</italic><sub>h</sub> are stochastic. Shown are rasters (left), examples of membrane potential responses of the fully deterministic model (red) and first six sweeps recorded from the stochastic model (black), and examples of membrane potential waveforms corresponding to an ‚Äúextra‚Äù action potential triggered by an additional dendritic depolarization. (D) Number of ‚Äúdropped‚Äù and ‚Äúextra‚Äù axonal spikes (top) and dendritic spikes (bottom) during 1s of simulated time for each experimental condition tested. Because of their all or nothing nature, large dendritic depolariations are classified as spikes. ANOVA indicated a significant (p&lt;&lt;1e-9) effect of model configuration on ‚Äúdropped‚Äù and ‚Äúextra‚Äù axonal and dendritic spikes. Key post-hoc comparisons are referred to in the main text. (E) Jitter in the timing of axonal (top) and dendritic (bottom) action potentials for each experimental condition.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.g009" xlink:type="simple"/></fig>
<p>Since the model CA1 pyramidal neuron contains several types of ion channel that differ in their kinetics, voltage-dependence and single channel conductance <xref ref-type="bibr" rid="pcbi.1000886-Jarsky1">[44]</xref>, we asked if any particular channel type mediates the consequences of stochastic gating? We compared versions of the model in which only one type of ion channel was simulated stochastically and the others were simulated deterministically. These simulations demonstrated that stochastic gating of any single type of ion channel is insufficient to fully account for all of the ‚Äúdropped‚Äù or ‚Äúextra‚Äù spikes observed in the fully stochastic model (<xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9D‚ÄìE</xref>). The greatest impact on spike output came from stochastically gating voltage-dependent Na<sup>+</sup> channels, followed by A-type and delayed rectifier potassium channels (<xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9D‚ÄìE</xref> and <xref ref-type="supplementary-material" rid="pcbi.1000886.s004">Figure S4</xref>). Thus, the number of ‚Äúdropped‚Äù somatic and dendritic spikes did not differ between the model in which only Na<sup>+</sup> channels gated stochastically compared with the fully stochastic model (p‚Ää=‚Ää0.98 and 0.3), whereas there were fewer ‚Äúextra‚Äù somatic and dendritic spikes (p&lt;1e-4 in both cases). Models in which only one of the other ion channel types gated stochastically differed significantly from the fully stochastic model in all measures of ‚Äúextra‚Äù and ‚Äúdropped‚Äù spikes (p&lt;1e-3). Nevertheless, models containing stochastic gating voltage-dependent K<sup>+</sup> channels generated considerably more than 50% of the number of ‚Äúextra‚Äù and ‚Äúdropped‚Äù spikes observed in the fully stochastic model. Interestingly, stochastic gating of <italic>I</italic><sub>h</sub> channels alone had very little impact on axonal spikes or spike jitter, but nevertheless increased the number of ‚Äúextra‚Äù dendritic spikes. The relative lack of effect of <italic>I</italic><sub>h</sub> can be explained by the small single channel conductance, while the primary effect on additional dendritic spikes may reflect slow gating kinetics and dendritic localization of these channels (<xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9C</xref>). Together, these data suggest that in a well-validated, realistic model of a CA1 pyramidal neuron experiencing distributed synaptic input sufficient to drive action potentials at physiologically relevant rates, stochastic gating of dendritic ion channels substantially modifies spike output. While no single ion channel is sufficient to fully account for modified spike output, stochastic gating of dendritic voltage-gated Na<sup>+</sup> and K<sup>+</sup> channels may be particularly important.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>To address the functional consequences of stochastic gating of neuronal ion channels we developed and validated new, efficient and general-purpose tools for numerical simulation of cells with complex morphologies. Using these tools we have made several new findings. First, we show that the functional impact of stochastic ion channel gating depends on neuronal morphology and as a result differs between neuronal cell types. Second, we show that depending on a neuron's morphology, ion channel kinetics influence the functional consequences of stochastic ion channel gating. These results suggest that detailed and well-constrained simulations will be important for accurate prediction of the specific functional consequences of stochastic gating in particular cell types. Third, we show that in a realistic model CA1 neuron, stochastic gating of non-synaptic ion channels modifies the timing of synaptically driven somatic and dendritic action potentials, and causes substantial numbers of ‚Äúextra‚Äù and ‚Äúdropped‚Äù somatic and dendritic spikes compared to equivalent deterministic neurons. These results suggests a new perspective on dendritic integration of synaptic inputs, whereby stochastic gating of intrinsic ion channels enables populations of neurons to compute using probabilistic rather than fixed spike codes.</p>
<sec id="s3a">
<title>Functional consequences of stochastic ion channel gating depend on neuronal morphology and channel properties</title>
<p>Gating of single ion channels is one of the better-understood stochastic processes in biology <xref ref-type="bibr" rid="pcbi.1000886-Colquhoun1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Hille1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Neher2">[52]</xref>. Nevertheless, the functional consequences of discrete transitions between open and closed states of ion channels found in the membranes of morphologically complex neurons are not well understood and for technical reasons have received relatively little attention. The reductions in computation time obtained with PSICS enable this issue to be addressed systematically for the first time using detailed simulations of large numbers of reconstructed neurons (<xref ref-type="fig" rid="pcbi-1000886-g004">Figures 4</xref>‚Äì<xref ref-type="fig" rid="pcbi-1000886-g005"/><xref ref-type="fig" rid="pcbi-1000886-g006"/><xref ref-type="fig" rid="pcbi-1000886-g007"/><xref ref-type="fig" rid="pcbi-1000886-g008"/><xref ref-type="fig" rid="pcbi-1000886-g009">9</xref>). Modification by stochastic ion channel gating of the pattern and timing of spikes generated in response to synaptic input to a previously well validated model CA1 pyramidal neuron (<xref ref-type="fig" rid="pcbi-1000886-g008">Figures 8</xref> and <xref ref-type="fig" rid="pcbi-1000886-g009">9</xref>), suggests that stochastic ion channel gating substantially influences synaptic integration by dendritic neurons. However, our simulations also suggest reasons for caution in extrapolating between cell types as the consequences of stochastic gating depended on neuronal morphology (<xref ref-type="fig" rid="pcbi-1000886-g005">Figures 5</xref> and <xref ref-type="fig" rid="pcbi-1000886-g006">6</xref>). Thus, the impact of stochastic opening and closing of ion channels varies as a function of sub-cellular location within a neuron and may differ both between neuronal cell types and across neurons of the same cell type. Moreover, our finding that ion channels with identical open probability, but distinct gating kinetics produce different membrane potential fluctuations (<xref ref-type="fig" rid="pcbi-1000886-g007">Figure 7</xref>), while suggesting a previously unexplored mechanism for control of neuronal activity, also indicates that single-channel recordings of ion channels in dendrites and axons (e.g. <xref ref-type="bibr" rid="pcbi.1000886-Hoffman1">[53]</xref>‚Äì<xref ref-type="bibr" rid="pcbi.1000886-Chen1">[55]</xref>) will be important to constrain stochastic models of excitable neurons. Given debates over the accuracy of aspects of reconstructed neuronal morphologies <xref ref-type="bibr" rid="pcbi.1000886-Szilagyi1">[56]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Scorcioni1">[57]</xref>, our comparison of neuronal cell types should be considered as a proof of principle rather than a definitive description of a particular neurons activity. Since experimental tests that replace a neurons stochastic with equivalent deterministically gating dendritic ion channels are not currently possible, accumulation of accurate morphological and biophysical data will be particularly important for further investigator of the roles of stochastic gating in particular cell types.</p>
<p>Irrespective of the details of any particular model, our results suggest that neuronal morphology and ion channel properties interact to determine the functional consequences of ion channel gating. Comparison of model neurons with different morphology, but containing identical ion channels, indicates that dendritic morphology plays a key role in determining the functional consequences of stochastic ion channel gating (<xref ref-type="fig" rid="pcbi-1000886-g006">Figures 6</xref>‚Äì<xref ref-type="fig" rid="pcbi-1000886-g007">7</xref>). Diversity between neurons <italic>in vivo</italic> in their expression of particular ion channels <xref ref-type="bibr" rid="pcbi.1000886-Nusser1">[58]</xref>, could accentuate or attenuate distinctions between neurons predicted on the basis of their morphology. Simulations of the detailed CA1 pyramidal neuron model in which only one ion channel type was implemented stochastically suggest several further insights into the roles of particular types of ion channel. First, stochastic gating of any single ion channel type was insufficient to fully account for probabilistic behavior of the fully stochastic neuron. Second, quantitative differences between the probabilistic behavior of the fully deterministic and stochastic neurons were considerably less than the sum of the differences between the fully deterministic neuron and each version of the model in which only one ion channel type gated stochastically. This suggests considerable redundancy in the functional consequences of gating by any particular type of ion channel. Third, stochastic gating of only a single ion channel type, for example voltage-gated Na<sup>+</sup> channels in <xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9</xref>, can nevertheless substantially modify spike output. The latter two conclusions suggest that the results of our simulations will be robust to different assumptions about single channel properties of particular ion channels and at worst may under-estimate the influence of stochastic ion channel gating (see <xref ref-type="sec" rid="s4">Methods</xref>). Fourth, the impact of stochastic gating differs between ion channels types. For example, compare the model CA1 pyramidal neuron in which only <italic>I</italic><sub>h</sub> channels gate stochastically, with equivalent models in which other ion channels gate stochastically (<xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9</xref>). The relatively small impact of <italic>I</italic><sub>h</sub> is perhaps not surprising given the relatively small underlying single channel conductance, which is estimated to be on the order of 1 pS <xref ref-type="bibr" rid="pcbi.1000886-Kole1">[13]</xref>. Given that <italic>I</italic><sub>h</sub> is a major contribution to the resting dendritic membrane conductance of pyramidal neurons <xref ref-type="bibr" rid="pcbi.1000886-Kole1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Magee1">[46]</xref>, it might at first appear surprising that stochastic gating of other ion channel types can have such large effects. However, we have previously shown that as HCN channels are deactivated by depolarization, at potentials closer to spike threshold their impact is minimal compared to stochastic gating of other types of voltage-dependent ion channel <xref ref-type="bibr" rid="pcbi.1000886-Dudman1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Nolan1">[59]</xref>. The substantial influence on synaptically driven spike output of stochastic gating of voltage-gated Na+ and K+ channels is consistent with this explanation (<xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9</xref>).</p>
</sec><sec id="s3b">
<title>Simulation of stochastic ion channels in cells with complex morphology</title>
<p>Since it is rarely possible to reduce electrical activity within morphologically complex excitable neurons to tractable analytical models, mechanistic simulation of axons and dendrites relies on well-constrained compartmental models. Compartmental simulations necessarily involve trade-offs between accuracy and simulation time. This is a particularly important problem for simulations that aim to account for the stochastic transitions between the states of each individual ion channel in a realistic model neuron. To enable efficient and accurate simulation, we adopted an algorithm that generates a correct distribution of ion channel states at each simulation time point, while sacrificing explicit representation of ion channel states during the interval between time points. Relatively short time steps are required for accurate simulation of voltage-clamped conductances with rapid kinetics (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4</xref>). In contrast, during simulation of membrane voltage recorded in the current-clamp configuration, high frequency current fluctuations are filtered by the membrane capacitance and therefore have little impact on neuronal activity. Therefore, high frequency component of the conductance fluctuations do not have to be explicitly simulated (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4A‚ÄìB</xref>) and so simulations using the modified tau leap algorithm can take advantage of longer time steps.</p>
<p>Our new approach has several advantages over previous methods for simulation of stochastic ion channel gating. While approaches that add noise terms to the equations used to calculate the membrane currents are computationally efficient <xref ref-type="bibr" rid="pcbi.1000886-Saarinen1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Fox1">[60]</xref>, the noise term is at best only indirectly related to the biophysical properties of the simulated channels. Thus, these methods may be of use for efficiently simulating some of the phenomenological consequences of stochastic channel gating, but are of less utility for addressing the relationship between properties of single ion channels and macroscopic neuronal activity <xref ref-type="bibr" rid="pcbi.1000886-Mino1">[22]</xref>. One approach to account for single channel properties is to explicitly track the probability that each channel makes a transition between states during each time step <xref ref-type="bibr" rid="pcbi.1000886-Dudman1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Clay1">[23]</xref>. However, this method is accurate only if sufficiently small time steps are used <xref ref-type="bibr" rid="pcbi.1000886-Mino1">[22]</xref> and is computationally very expensive. An alternative method is to explicitly track the exact time of transitions of channels between states, while counting only the number of channels in each particular state <xref ref-type="bibr" rid="pcbi.1000886-Gillespie2">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Chow1">[35]</xref>. This demands less computation time than explicitly tracking each channel, but nevertheless requires generation of random numbers between time steps and therefore becomes inefficient for longer time steps or large numbers of channels. In contrast, PSICS uses a simulation algorithm that accurately simulates the distribution of ion channel states at each time step without having to track the exact time of each transition, while also counting only the number of ion channels in each state without having to track the states of individual channels. We show that this can lead to an order of magnitude or greater improvement in simulation time without loss of accuracy (<xref ref-type="fig" rid="pcbi-1000886-g004">Figure 4</xref>). For all approaches, including those introduced here, parallel computing produces a further linear reduction in computation time with additional processors simply by enabling the multiple simulations required for statistical evaluation of models to be carried out simultaneously.</p>
</sec><sec id="s3c">
<title>Probabilistic neurons and further functional consequences of stochastic ion channel gating</title>
<p>By implementing a previously well-validated model of a CA1 pyramidal neuron using stochastically gating ion channels, our simulation results provide evidence that synaptic integration by dendritic neurons is probabilistic. While the instantaneous output of a single neuron functioning in this way is relatively unreliable, instantaneous representations distributed across a population of stochastic neurons could be read out by summation of their outputs. The impact of such probabilistic integration on information processing and computation by populations of pyramidal neurons remains to be determined. For CA1 pyramidal neurons in the hippocampus, one possibility is that this probabilistic integration is important for encoding of location by the timing of action potentials relative to ongoing network rhythms <xref ref-type="bibr" rid="pcbi.1000886-OKeefe1">[61]</xref>. Indeed, our results are consistent with relatively unreliable encoding of location by the timing of individual action potentials, but suggest that coding mechanism might be considerably more reliable when the activity of large ensembles of neurons is considered.</p>
<p>Challenges for future experimental and theoretical studies include determining the conditions, additional cell types and sub-cellular locations in which stochastic gating of ion channels affects spike output, and to establish the consequences for computations carried out by neural circuits. At some sub-cellular locations noise introduced by stochastic gating of single ion channels might impose physical constraints on the computational properties of neurons <xref ref-type="bibr" rid="pcbi.1000886-Faisal1">[12]</xref> and may limit the efficiency of neural coding <xref ref-type="bibr" rid="pcbi.1000886-Schreiber1">[62]</xref>. Alternatively, neuronal noise sources may promote detection of signals <xref ref-type="bibr" rid="pcbi.1000886-Collins1">[63]</xref>‚Äì<xref ref-type="bibr" rid="pcbi.1000886-Moss1">[66]</xref>, enable multiplication of synaptic responses <xref ref-type="bibr" rid="pcbi.1000886-Mitchell1">[67]</xref>, or control the pattern of action potential firing <xref ref-type="bibr" rid="pcbi.1000886-Dudman1">[11]</xref>. The tools we introduce here will enable these and other possibilities to be addressed systematically. In addition to exploring physiological mechanisms, systematic simulations may be important for understanding the functional consequences of changes in morphology or ion channel localization that accompany nervous system disorders. For example, changes in dendritic morphology are reported in several forms of mental retardation <xref ref-type="bibr" rid="pcbi.1000886-Newey1">[68]</xref>, but the functional implications of interactions between stochastic gating of dendritic ion channels and disease or behaviorally related changes in dendrite morphology are yet to be addressed.</p>
</sec></sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<p>All calculations were performed with PSICS (<ext-link ext-link-type="uri" xlink:href="http://www.psics.org" xlink:type="simple">www.psics.org</ext-link>) unless indicated otherwise. Both the PSICS shell and ICING are written in Java and can run on Windows, OS X and Linux operating systems. To minimize the time required to run simulations, the default version of the PSICS core is written in Fortran and has been compiled separately for each operating system. A slower version of the core that runs in Java is also available. The core of PSICS performs equivalent deterministic or stochastic simulations of all models. In PSICS ion channels are treated as distinct entities rather than as a conductance density, and channel gating can be simulated either stochastically or in the deterministic limit. Most of the methods involved in such calculations are well documented elsewhere <xref ref-type="bibr" rid="pcbi.1000886-Hines1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Koch2">[69]</xref>. Here we present the two novel aspects of the method: the way ion channels are positioned and mapped onto a discretization of the structure; and the approximations used to generate realizations of the stochastic behaviour of the system much more rapidly than is possible with previous stochastic methods. Further details of PSICS development are given in the Supplemental Text.</p>
<sec id="s4a">
<title>Ion channel positioning</title>
<p>Channel positions are allocated according to user-specified probability densities over the structure such that each channel has a position in three dimensions. The input morphology is sub-sampled at 1 ¬µm for computing local number densities. Axial positions for channels are generated either by sampling a Poisson distribution for the distance to the next channel, or by taking uniform increments to give the desired average density. The angles at which channels occur around a section are allocated randomly from a uniform distribution. At present, these angles only affect the visualization since the structure is later discretized into elements with end faces perpendicular to the axis. The seeds used for the random number generator are stored with the model so that exact allocations can be reproduced. So that allocations are portable across platforms, the generator used is a Mersenne Twister <xref ref-type="bibr" rid="pcbi.1000886-Matsumoto1">[70]</xref>, which is included as part of PSICS rather than relying on a system library.</p>
<p>For computing the propagation of membrane potential changes, the structure is compartmentalized into elements such that all elements have approximately the same value of: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e001" xlink:type="simple"/></inline-formula></p>
<p>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e002" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e003" xlink:type="simple"/></inline-formula> are the positions of the end points of the compartment along the structure, <italic>r</italic> is the local radius and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e004" xlink:type="simple"/></inline-formula> was used throughout this study. This is a purely geometrical property that provides a discretization that balances conductance between compartments against charging rates for membrane capacitance and is independent of the membrane time constant. PSICS allows post-hoc adjustment of the discretization in view of the conductances arising from allocated channels, but the facility was not used for the present study. In general, the resulting elements are neither straight nor of uniform radius so conductances between compartments are also computed as integrals along the structure.</p>
</sec><sec id="s4b">
<title>Realization of stochastic ion channel behavior</title>
<p>Ion channels are represented by kinetic schemes. Each scheme has one or more complexes, and each complex is an inter-connected set of states with expressions for the transition rates between them. Models using the Hodgkin-Huxley gating particle description are mapped to the corresponding scheme where each gate corresponds to a two-state complex <xref ref-type="bibr" rid="pcbi.1000886-Colquhoun1">[24]</xref>. For deterministic calculations, multi-complex schemes are used directly. For stochastic calculations, multi-complex schemes are mapped to the equivalent single-complex scheme by ‚Äúmultiplying-out‚Äù <xref ref-type="bibr" rid="pcbi.1000886-Colquhoun1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Armstrong1">[71]</xref>. For a scheme with <italic>n</italic> states, the probabilities of the channel being in each of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e005" xlink:type="simple"/></inline-formula> states can be expressed by a probability density vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e006" xlink:type="simple"/></inline-formula> of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e007" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e008" xlink:type="simple"/></inline-formula> is the probability of being in state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e009" xlink:type="simple"/></inline-formula>. A channel in state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e010" xlink:type="simple"/></inline-formula> can only transition into one of the states directly connected to that state. If the classical transition rate between state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e011" xlink:type="simple"/></inline-formula> and state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e012" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e013" xlink:type="simple"/></inline-formula> then when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e014" xlink:type="simple"/></inline-formula> channels are in state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e015" xlink:type="simple"/></inline-formula>, the number of transitions per unit time between from state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e016" xlink:type="simple"/></inline-formula> to state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e017" xlink:type="simple"/></inline-formula> would be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e018" xlink:type="simple"/></inline-formula> for large <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e019" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e020" xlink:type="simple"/></inline-formula> if there is no direct connection from states <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e021" xlink:type="simple"/></inline-formula> to state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e022" xlink:type="simple"/></inline-formula>). In this case, the single channel probabilities obey a similar relation giving the rate of change of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e023" xlink:type="simple"/></inline-formula> as the difference between the total fluxes into and out of that state:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e024" xlink:type="simple"/></disp-formula></p>
<p>By gathering up the terms, this can be written in matrix form as a master equation <xref ref-type="bibr" rid="pcbi.1000886-Colquhoun2">[72]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e025" xlink:type="simple"/></disp-formula>where,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e026" xlink:type="simple"/></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e027" xlink:type="simple"/></disp-formula></p>
<p>In general, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e028" xlink:type="simple"/></inline-formula> will depend on the membrane potential <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e029" xlink:type="simple"/></inline-formula>, and could incorporate other dependencies such as calcium or other second messengers. Note that, as with the transition rates themselves, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e030" xlink:type="simple"/></inline-formula> only has non-zero elements along the diagonal and where direct transitions are possible in the channel scheme. Using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e031" xlink:type="simple"/></inline-formula> directly to update state occupancy probabilities and sample the resulting distribution to generate a stochastic simulation of the channel corresponds to the explicit method (e.g. <xref ref-type="bibr" rid="pcbi.1000886-Dudman1">[11]</xref>). If it is not necessary to follow every transition, then the simulation can be made more efficient by integrating the master equation over a time interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e032" xlink:type="simple"/></inline-formula> yielding:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e033" xlink:type="simple"/></disp-formula></p>
<p>As this integral is exact for constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e034" xlink:type="simple"/></inline-formula>, the state occupancy probabilities can be computed for any future time. In practice <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e035" xlink:type="simple"/></inline-formula> is often voltage dependent, so <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e036" xlink:type="simple"/></inline-formula> should be kept small enough that there are no significant changes in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e037" xlink:type="simple"/></inline-formula> over a single time step.</p>
<p>In calculations, significant efficiency improvements over explicit methods can be achieved by using the fixed step transition matrix, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e038" xlink:type="simple"/></inline-formula>, which allows channel to move through many briefly occupied states in a single calculation step without having to follow the dynamics of each transition. Unlike <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e039" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e040" xlink:type="simple"/></inline-formula> is typically non-zero everywhere, since there is a non-zero probability of the channel making the multiple transitions necessary to get from one state to any other state within the time step. For a deterministic calculation, the state occupancy probability vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e041" xlink:type="simple"/></inline-formula> is replaced by an occupancy density vector, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e042" xlink:type="simple"/></inline-formula>, while the rest of the derivation remains the same, so the update step for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e043" xlink:type="simple"/></inline-formula> is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e044" xlink:type="simple"/></disp-formula></p>
<p>For a stochastic calculation, the element <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e045" xlink:type="simple"/></inline-formula> is the probability that a channel currently in state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e046" xlink:type="simple"/></inline-formula> will be in state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e047" xlink:type="simple"/></inline-formula> at the end of the time-step. The update step for a single channel involves generating a uniform random number, r, between 0 and 1 and then comparing it to the elements of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e048" xlink:type="simple"/></inline-formula>'th column of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e049" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e050" xlink:type="simple"/></inline-formula> is the current state of the channel. The selected state, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e051" xlink:type="simple"/></inline-formula>, is such that:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e052" xlink:type="simple"/></disp-formula></p>
<p>That is, the elements <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e053" xlink:type="simple"/></inline-formula> act as the widths of bins and the random number is used to pick one of the destination bins according to their relative sizes.</p>
<p>For small populations, the update step is applied to each channel individually. For larger populations, significant computation time can be saved by updating only the channels that have a non-negligible probability of changing state during the step and rescaling the bins accordingly. Thus, if the total number of channels in a given state is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e054" xlink:type="simple"/></inline-formula> and the probability of any channel leaving the state in the next time step is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e055" xlink:type="simple"/></inline-formula> then the number of channels <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e056" xlink:type="simple"/></inline-formula> leaving the state in one step has a binomial distribution:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e057" xlink:type="simple"/></disp-formula>and the probability that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e058" xlink:type="simple"/></inline-formula> or more channels will leave is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e059" xlink:type="simple"/></disp-formula></p>
<p>For a statistically reliable result, we require a bound on the number of missed events, here set at 2 in 10<sup>8</sup>. This requires <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e060" xlink:type="simple"/></inline-formula> such that:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e061" xlink:type="simple"/></disp-formula></p>
<p>In general, however, finding the smallest <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e062" xlink:type="simple"/></inline-formula> that meets this condition is a computationally costly process and, since it needs to be done for each state of each channel population at each time step, these costs could wipe out any benefits of not advancing the channels individually. To avoid this problem, the following fitting formulae are used to produce a safe estimate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e063" xlink:type="simple"/></inline-formula> in terms of the probability <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e064" xlink:type="simple"/></inline-formula> of leaving the current state, and the number of channels, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e065" xlink:type="simple"/></inline-formula>, in that state:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e066" xlink:type="simple"/></disp-formula></p>
<p>The first applicable formula is used. If none of the conditions is met, all the channels are advanced individually. These formulae were arrived at by a combination of experimentation and numerical optimization to find expressions that approximate the form of the exactly computed values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e067" xlink:type="simple"/></inline-formula> as a function of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e068" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000886.e069" xlink:type="simple"/></inline-formula> over a logarithmically sampled grid. They ensure that the chance of more channels making a transition out of the current state than are considered at one step is less than 2 in 10<sup>8</sup>.</p>
<p>For ion channels the modified tau leap method removes the major cost of the next transition method <xref ref-type="bibr" rid="pcbi.1000886-Gillespie2">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Chow1">[35]</xref>, which lies in re-computing next transition times whenever the membrane potential changes significantly, even when no transition has occurred. In the tau-leap method, a different membrane potential simply requires the use of different transition probabilities for the next step. Since all the required tables can be pre-computed, then if the steps are small enough that no significant potential change occurs within a step (a condition that is easily met), the membrane potential change only adds very slightly to the computational cost. The other efficiency saving of a tau-leap style algorithm over channel-by channel calculation comes from treating a group of molecules (channels) as a single stochastic unit. On a neuron the unit size is determined by the electrical compartmentalization of the membrane. Therefore, depending on the geometry and channel distribution, clusters of up to 5000 channels may be possible. The channel update step yields conductances (assumed Ohmic) and reversal potentials for membrane currents on each compartment, which are used in the Crank-Nicolson or implicit Euler methods to compute new membrane potentials. The process is then repeated for the next step. The allocation of channels, discretization of the structure and tabulation of transition matrices is performed in a pre-processing stage written in Java. The core calculations are written in Fortran.</p>
</sec><sec id="s4c">
<title>Simulation of reconstructed neurons</title>
<p>For simulations illustrated in <xref ref-type="fig" rid="pcbi-1000886-g006">Figures 6</xref>‚Äì<xref ref-type="fig" rid="pcbi-1000886-g007"/><xref ref-type="fig" rid="pcbi-1000886-g008">8</xref> neuronal morphologies were downloaded from the Neuromorpho database (<ext-link ext-link-type="uri" xlink:href="http://www.neuromorpho.org" xlink:type="simple">www.neuromorpho.org</ext-link>). Neurons were identified in the database as follows. Layer V pyramidal cells: p18 and p22 from Dendritica; g0692P1, g0699P1 and gR002P1 from Svoboda lab. Dentate gyrus granule cells: n271, n272 and n518 from Turner lab; 428883, B106885 from Claibourne lab. Purkinje cells: alxP, e4cb3a1 and e1cb4a1 from Martone lab; p19 and p20 from Dendritica. CA1 pyramidal cells: n409 from Turner lab; NM1 from Ascoli lab; ri04 and ri06 from Spruston lab; pc4c from Gulyas lab. Substantia nigra dopaminergic neurons: Nigra2a955, Nigra11h941-1, Nigra24a953, Nigra12h945 from Dendritica. Parvalbumin interneurons: pv08e, pv22b, pv22e, pv22j and pv22m from Gulyas lab. In these simulations the densities of voltage-gated channels were based on previously published studies <xref ref-type="bibr" rid="pcbi.1000886-Mainen1">[6]</xref>. The leak conductance was modeled as voltage-independent Na<sup>+</sup> and K<sup>+</sup> channels with open probabilities of 0.7. The following channels were included: fast Na<sup>+</sup> channels (1/¬µm<sup>2</sup>); non-inactivating K<sup>+</sup> channels (0.05/¬µm<sup>2</sup>); high-voltage Ca<sup>2+</sup> channels (0.15/¬µm<sup>2</sup>); Na<sup>+</sup> and K<sup>+</sup> leak channels (0.016/¬µm<sup>2</sup>). The resting membrane potential was set by modifying the ratio of Na<sup>+</sup> to K<sup>+</sup> leak channels. In all simulations reported here this was ‚àí60 mV. We chose single-channel conductances of 20 pS for all ion channels, as this is similar to values reported for single channel recordings made from neuronal dendrites <xref ref-type="bibr" rid="pcbi.1000886-Magistretti1">[54]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Chen1">[55]</xref>. This value is intermediate for cloned mammalian ion channels, which can have single channel conductances from &lt;1 pS up to &gt;150 pS <xref ref-type="bibr" rid="pcbi.1000886-Hille1">[30]</xref>. Membrane capacitance was set to 0.75 ¬µF/cm<sup>2</sup> and axial resistivity to 150 Œ© cm <xref ref-type="bibr" rid="pcbi.1000886-Mainen1">[6]</xref>. For models of neurons that are known to have dendritic spines (all models except the parvalbumin-expressing interneurons), the dendritic membrane capacitance and the number of dendritic ion channels were doubled. For each model neuron, membrane potential was recorded at the soma and at all dendritic locations 100 ¬µm, 200 ¬µm, 300 ¬µm, etc., from the soma. All reported results were obtained from at least 3 s of simulated biological time. The simulation time step was 10 ¬µs.</p>
<p>The simulations of a detailed model of CA1 pyramidal neuron (<xref ref-type="fig" rid="pcbi-1000886-g008">Figures 8</xref> and <xref ref-type="fig" rid="pcbi-1000886-g009">9</xref>) used previously published ion channels, morphology and channel distributions <xref ref-type="bibr" rid="pcbi.1000886-Jarsky1">[44]</xref>. In this model voltage-dependent ion channels are distributed in the soma, axon and dendrites according to previous experimental measurements. The only modification to the model was the addition of <italic>I</italic><sub>h</sub> conductance and channel distribution taken from a different publication from the same group <xref ref-type="bibr" rid="pcbi.1000886-Golding1">[45]</xref> and consistent with data from other groups <xref ref-type="bibr" rid="pcbi.1000886-Magee1">[46]</xref>. The densities of Na<sup>+</sup> and K<sup>+</sup> leak channels were automatically adjusted to achieve a resting potential of approximately ‚àí70 mV throughout the cell, while maintaining a total leak conductance consistent with the original model. The single channel conductance of the delayed rectifier K<sup>+</sup> channels and voltage-dependent Na<sup>+</sup> channels were set to 20 pS, which is similar to estimates from single channel recordings <xref ref-type="bibr" rid="pcbi.1000886-Magistretti1">[54]</xref>, <xref ref-type="bibr" rid="pcbi.1000886-Chen1">[55]</xref>. For simplicity, in the reported experiments the single channel conductance of A/D type K<sup>+</sup> channels and leak channels were also set to 20 pS, which is similar to experimental measurements for D-type channels <xref ref-type="bibr" rid="pcbi.1000886-Chen1">[55]</xref>, somewhat larger than estimates for dendritic A-type channels <xref ref-type="bibr" rid="pcbi.1000886-Chen1">[55]</xref> and towards the low end of the range of single-channel conductance reported for leak channels <xref ref-type="bibr" rid="pcbi.1000886-Hille1">[30]</xref>. Thus, our simulations of models with only stochastically gating voltage-dependent Na<sup>+</sup> and delayed rectifier K<sup>+</sup> channels can be considered as fully constrained predictions given currently available data, while our simulations of the fully stochastic model likely estimate a lower limit for the consequences of stochastic ion channel gating. This is because our results from simulations when A/D type K<sup>+</sup> channels are deterministic, but voltage-dependent Na<sup>+</sup> or delayed rectifier K<sup>+</sup> channels are stochastic, nevertheless demonstrate highly probabilistic spike firing, indicating that a smaller single channel conductance for A/D type K<sup>+</sup> channels would have little impact on the results, while a possible larger single channel conductance for the leak channels would be expected to increase the impact of stochastic gating. Our simulations of A/D type stochastic gating alone should be considered as setting an upper limit for stochastic effects based on known properties of these channels, whereas the simulations of leak channels alone are less well constrained and serve as an illustrative example. Unlike other ion channels, the single channel conductance of <italic>I</italic><sub>h</sub> channels is set at 1 pS, which is consistent with noise-analysis of dendritic <italic>I</italic><sub>h</sub> recorded from cortical neurons <xref ref-type="bibr" rid="pcbi.1000886-Kole1">[13]</xref> and the absence of step-like single channel waveforms from measurements of <italic>I</italic><sub>h</sub> obtained with cell-attached recordings from CA1 pyramidal neurons <xref ref-type="bibr" rid="pcbi.1000886-Magee1">[46]</xref>. Synapses were modeled as bi-exponential conductance changes of rise time 0.2 ms, decay time 2 ms and peak conductance 0.18 nS. Synapses were distributed randomly across all dendrites &gt;30 ¬µm from the soma at an average density of 0.1/¬µm<sup>2</sup> (1502 in total). Each synapse was activated independently according to a Poisson process with a mean frequency of 5.5 Hz. For analysis dendritic spike times were calculated as upward voltage crossings above a ‚àí60 mV threshold. Visual inspection of traces confirmed that this threshold successfully isolated all-or-nothing dendritic events.</p>
<p>Additional analysis of simulation data was carried out using IGORpro (Wavemetrics). Statistical analysis used R (<ext-link ext-link-type="uri" xlink:href="http://www.r-project.org/" xlink:type="simple">http://www.r-project.org/</ext-link>). Comparisons of group data use ANOVAs. For analysis of data in <xref ref-type="fig" rid="pcbi-1000886-g008">Figures 8</xref> and <xref ref-type="fig" rid="pcbi-1000886-g009">9</xref> this was followed by Tukey Honest Significant Difference test for comparisons between individual groups. Significance values referred to in the text refer to probabilities indicated by the latter test after adjustment for multiple comparisons. Simulations with NEURON used version 7.0 (<ext-link ext-link-type="uri" xlink:href="http://www.neuron.yale.edu" xlink:type="simple">www.neuron.yale.edu</ext-link>). For comparisons between NEURON and PSICS, simulations were run on the same hardware with minimal competing activity. Although other factors such as cache size and output options may contribute to performance differences in some cases, the simulation algorithm was the main factor determining simulation time. Parallel simulations were run on multi-processor PCs, or on a cluster of servers (maximum 1456 processors) at the Edinburgh Compute and Data Facility (ECDF).</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000886.s001" mimetype="image/jpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.s001" xlink:type="simple"><label>Figure S1</label><caption>
<p>Overview of PSICS. Model specification files are listed on a green background, simulation outputs on a yellow background and new software components on a clear background.</p>
<p>(0.93 MB JPG)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1000886.s002" mimetype="image/jpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.s002" xlink:type="simple"><label>Figure S2</label><caption>
<p>Sodium channel model. (A) The sodium channel model used to illustrate ion channel simulation with PSICS has a single open state (O1) connected as shown to two closed states (C1 and C2). (B) The transitions between states of the model are governed by forward Œ± and backward Œ≤ rate constants that vary as a function of membrane potential (upper graph). The time constants (Taux) and steady-state distribution (Xinf) for each transition are plotted as a function of membrane potential (lower graph). (C) Deterministic currents (bottom) generated by the gating scheme in response to step changes in membrane potential from a holding potential of 80 mV (top). Inset shows the activation phase of the currents on an expanded time base.</p>
<p>(0.25 MB JPG)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1000886.s003" mimetype="image/jpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.s003" xlink:type="simple"><label>Figure S3</label><caption>
<p>All-or-nothing dendritic responses of a fully stochastic CA1 pyramidal neuron model to synaptic stimulation. (A‚ÄìB) Membrane potentials recordings from the soma (top) and indicated basal dendrite (bottom) from twenty consecutive trials as in <xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8</xref> and <xref ref-type="fig" rid="pcbi-1000886-g009">9</xref>, illustrating responses to synaptic input corresponding to the time points in <xref ref-type="fig" rid="pcbi-1000886-g008">Figure 8D (A) and 8E (B)</xref>. The fully propagating dendritic spike (A) and the smaller dendritic depolarizations (B) are all-or-nothing events, indicating that they result from triggering of dendritic spikes.</p>
<p>(0.24 MB TIF)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1000886.s004" mimetype="image/jpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.s004" xlink:type="simple"><label>Figure S4</label><caption>
<p>Synaptically driven spike output is modified by stochastic gating of single types of ion channel. Raster plots as in <xref ref-type="fig" rid="pcbi-1000886-g009">Figure 9</xref>, illustrating timing of action potentials generated in response to synaptic stimulation for versions of the CA1 pyramidal cell model in which the only stochastic gating ion channels are voltage-dependet Na<sup>+</sup> channels (A), delayed rectifier K<sup>+</sup> channels (B), A/D type K<sup>+</sup> channels (C) and leak channels (D).</p>
<p>(0.50 MB JPG)</p>
</caption></supplementary-material>
<supplementary-material id="pcbi.1000886.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000886.s005" xlink:type="simple"><label>Text S1</label><caption>
<p>Stochastic simulation framework; software development; estimate of the number of ion channels in a central neuron.</p>
<p>(0.05 MB PDF)</p>
</caption></supplementary-material>
</sec></body>
<back>
<ack>
<p>We thank Paul Dodson, Mike Shipston and David Wyllie for comments on a previous version of the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000886-Kitano1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kitano</surname><given-names>H</given-names></name>
</person-group>             <year>2002</year>             <article-title>Systems biology: a brief overview.</article-title>             <source>Science</source>             <volume>295</volume>             <fpage>1662</fpage>             <lpage>1664</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Milner1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Milner</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Squire</surname><given-names>LR</given-names></name>
<name name-style="western"><surname>Kandel</surname><given-names>ER</given-names></name>
</person-group>             <year>1998</year>             <article-title>Cognitive neuroscience and the study of memory.</article-title>             <source>Neuron</source>             <volume>20</volume>             <fpage>445</fpage>             <lpage>468</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Koch1"><label>3</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Koch</surname><given-names>C</given-names></name>
</person-group>             <year>1999</year>             <person-group person-group-type="editor">
<name name-style="western"><surname>Stryker</surname><given-names>M</given-names></name>
</person-group>             <source>Biophysics of computation: information processing in single neurons;</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Oxford University Press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">562</size>           </element-citation></ref>
<ref id="pcbi.1000886-Poirazi1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Poirazi</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Brannon</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Mel</surname><given-names>BW</given-names></name>
</person-group>             <year>2003</year>             <article-title>Arithmetic of subthreshold synaptic summation in a model CA1 pyramidal cell.</article-title>             <source>Neuron</source>             <volume>37</volume>             <fpage>977</fpage>             <lpage>987</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Hausser1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hausser</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Mel</surname><given-names>B</given-names></name>
</person-group>             <year>2003</year>             <article-title>Dendrites: bug or feature?</article-title>             <source>Curr Opin Neurobiol</source>             <volume>13</volume>             <fpage>372</fpage>             <lpage>383</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Mainen1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mainen</surname><given-names>ZF</given-names></name>
<name name-style="western"><surname>Sejnowski</surname><given-names>TJ</given-names></name>
</person-group>             <year>1996</year>             <article-title>Influence of dendritic structure on firing pattern in model neocortical neurons.</article-title>             <source>Nature</source>             <volume>382</volume>             <fpage>363</fpage>             <lpage>366</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Vetter1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Vetter</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Roth</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Hausser</surname><given-names>M</given-names></name>
</person-group>             <year>2001</year>             <article-title>Propagation of action potentials in dendrites depends on dendritic morphology.</article-title>             <source>J Neurophysiol</source>             <volume>85</volume>             <fpage>926</fpage>             <lpage>937</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Rall1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rall</surname><given-names>W</given-names></name>
</person-group>             <year>1962</year>             <article-title>Theory of physiological properties of dendrites.</article-title>             <source>Ann N Y Acad Sci</source>             <volume>96</volume>             <fpage>1071</fpage>             <lpage>1092</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Hines1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hines</surname><given-names>M</given-names></name>
</person-group>             <year>1984</year>             <article-title>Efficient computation of branched nerve equations.</article-title>             <source>Int J Biomed Comput</source>             <volume>15</volume>             <fpage>69</fpage>             <lpage>76</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Carelli1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Carelli</surname><given-names>PV</given-names></name>
<name name-style="western"><surname>Reyes</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Sartorelli</surname><given-names>JC</given-names></name>
<name name-style="western"><surname>Pinto</surname><given-names>RD</given-names></name>
</person-group>             <year>2005</year>             <article-title>Whole cell stochastic model reproduces the irregularities found in the membrane potential of bursting neurons.</article-title>             <source>J Neurophysiol</source>             <volume>94</volume>             <fpage>1169</fpage>             <lpage>1179</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Dudman1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dudman</surname><given-names>JT</given-names></name>
<name name-style="western"><surname>Nolan</surname><given-names>MF</given-names></name>
</person-group>             <year>2009</year>             <article-title>Stochastically gating ion channels enable patterned spike firing through activity-dependent modulation of spike probability.</article-title>             <source>PLoS Comput Biol</source>             <volume>5</volume>             <fpage>e1000290</fpage>          </element-citation></ref>
<ref id="pcbi.1000886-Faisal1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Faisal</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>White</surname><given-names>JA</given-names></name>
<name name-style="western"><surname>Laughlin</surname><given-names>SB</given-names></name>
</person-group>             <year>2005</year>             <article-title>Ion-channel noise places limits on the miniaturization of the brain's wiring.</article-title>             <source>Curr Biol</source>             <volume>15</volume>             <fpage>1143</fpage>             <lpage>1149</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Kole1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kole</surname><given-names>MH</given-names></name>
<name name-style="western"><surname>Hallermann</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Stuart</surname><given-names>GJ</given-names></name>
</person-group>             <year>2006</year>             <article-title>Single Ih channels in pyramidal neuron dendrites: properties, distribution, and impact on action potential output.</article-title>             <source>J Neurosci</source>             <volume>26</volume>             <fpage>1677</fpage>             <lpage>1687</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Saarinen1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Saarinen</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Linne</surname><given-names>ML</given-names></name>
<name name-style="western"><surname>Yli-Harja</surname><given-names>O</given-names></name>
</person-group>             <year>2008</year>             <article-title>Stochastic differential equation model for cerebellar granule cell excitability.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000004</fpage>          </element-citation></ref>
<ref id="pcbi.1000886-Schneidman1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Freedman</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Segev</surname><given-names>I</given-names></name>
</person-group>             <year>1998</year>             <article-title>Ion channel stochasticity may be critical in determining the reliability and precision of spike timing.</article-title>             <source>Neural Comput</source>             <volume>10</volume>             <fpage>1679</fpage>             <lpage>1703</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-vanRossum1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>van Rossum</surname><given-names>MC</given-names></name>
<name name-style="western"><surname>O'Brien</surname><given-names>BJ</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>RG</given-names></name>
</person-group>             <year>2003</year>             <article-title>Effects of noise on the spike timing precision of retinal ganglion cells.</article-title>             <source>J Neurophysiol</source>             <volume>89</volume>             <fpage>2406</fpage>             <lpage>2419</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-White1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>White</surname><given-names>JA</given-names></name>
<name name-style="western"><surname>Klink</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Alonso</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Kay</surname><given-names>AR</given-names></name>
</person-group>             <year>1998</year>             <article-title>Noise from voltage-gated ion channels may influence neuronal dynamics in the entorhinal cortex.</article-title>             <source>J Neurophysiol</source>             <volume>80</volume>             <fpage>262</fpage>             <lpage>269</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Anderson1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Anderson</surname><given-names>CR</given-names></name>
<name name-style="western"><surname>Stevens</surname><given-names>CF</given-names></name>
</person-group>             <year>1973</year>             <article-title>Voltage clamp analysis of acetylcholine produced end-plate current fluctuations at frog neuromuscular junction.</article-title>             <source>J Physiol</source>             <volume>235</volume>             <fpage>655</fpage>             <lpage>691</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Katz1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Katz</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Miledi</surname><given-names>R</given-names></name>
</person-group>             <year>1972</year>             <article-title>The statistical nature of the acetycholine potential and its molecular components.</article-title>             <source>J Physiol</source>             <volume>224</volume>             <fpage>665</fpage>             <lpage>699</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-White2"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>White</surname><given-names>JA</given-names></name>
<name name-style="western"><surname>Rubinstein</surname><given-names>JT</given-names></name>
<name name-style="western"><surname>Kay</surname><given-names>AR</given-names></name>
</person-group>             <year>2000</year>             <article-title>Channel noise in neurons.</article-title>             <source>Trends Neurosci</source>             <volume>23</volume>             <fpage>131</fpage>             <lpage>137</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Jack1"><label>21</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Jack</surname><given-names>JJB</given-names></name>
<name name-style="western"><surname>Noble</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Tsien</surname><given-names>RW</given-names></name>
</person-group>             <year>1975</year>             <source>Electric current flow in excitable cells</source>             <publisher-loc>Oxford</publisher-loc>             <publisher-name>Clarendon Press</publisher-name> <fpage>xvi, 502</fpage>           </element-citation></ref>
<ref id="pcbi.1000886-Mino1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mino</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Rubinstein</surname><given-names>JT</given-names></name>
<name name-style="western"><surname>White</surname><given-names>JA</given-names></name>
</person-group>             <year>2002</year>             <article-title>Comparison of algorithms for the simulation of action potentials with stochastic sodium channels.</article-title>             <source>Ann Biomed Eng</source>             <volume>30</volume>             <fpage>578</fpage>             <lpage>587</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Clay1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Clay</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>DeFelice</surname><given-names>LJ</given-names></name>
</person-group>             <year>1983</year>             <article-title>Relationship between membrane excitability and single channel open-close kinetics.</article-title>             <source>Biophys J</source>             <volume>42</volume>             <fpage>151</fpage>             <lpage>157</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Colquhoun1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Colquhoun</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Hawkes</surname><given-names>AG</given-names></name>
</person-group>             <year>1981</year>             <article-title>On the stochastic properties of single ion channels.</article-title>             <source>Proc R Soc Lond B Biol Sci</source>             <volume>211</volume>             <fpage>205</fpage>             <lpage>235</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Bhalla1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bhalla</surname><given-names>US</given-names></name>
</person-group>             <year>2004</year>             <article-title>Signaling in small subcellular volumes. II. Stochastic and diffusion effects on synaptic network properties.</article-title>             <source>Biophys J</source>             <volume>87</volume>             <fpage>745</fpage>             <lpage>753</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Kollo1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kollo</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Holderith</surname><given-names>NB</given-names></name>
<name name-style="western"><surname>Nusser</surname><given-names>Z</given-names></name>
</person-group>             <year>2006</year>             <article-title>Novel subcellular distribution pattern of A-type K+ channels on neuronal surface.</article-title>             <source>J Neurosci</source>             <volume>26</volume>             <fpage>2684</fpage>             <lpage>2691</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Lujan1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lujan</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Albasanz</surname><given-names>JL</given-names></name>
<name name-style="western"><surname>Shigemoto</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Juiz</surname><given-names>JM</given-names></name>
</person-group>             <year>2005</year>             <article-title>Preferential localization of the hyperpolarization-activated cyclic nucleotide-gated cation channel subunit HCN1 in basket cell terminals of the rat cerebellum.</article-title>             <source>Eur J Neurosci</source>             <volume>21</volume>             <fpage>2073</fpage>             <lpage>2082</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Gleeson1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gleeson</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Steuber</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Silver</surname><given-names>RA</given-names></name>
</person-group>             <year>2007</year>             <article-title>neuroConstruct: a tool for modeling networks of neurons in 3D space.</article-title>             <source>Neuron</source>             <volume>54</volume>             <fpage>219</fpage>             <lpage>235</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Stiles1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stiles</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>Van Helden</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Bartol</surname><given-names>TM</given-names><suffix>Jr</suffix></name>
<name name-style="western"><surname>Salpeter</surname><given-names>EE</given-names></name>
<name name-style="western"><surname>Salpeter</surname><given-names>MM</given-names></name>
</person-group>             <year>1996</year>             <article-title>Miniature endplate current rise times less than 100 microseconds from improved dual recordings can be modeled with passive acetylcholine diffusion from a synaptic vesicle.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>93</volume>             <fpage>5747</fpage>             <lpage>5752</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Hille1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hille</surname><given-names>B</given-names></name>
</person-group>             <year>2001</year>             <article-title>Ion channels of excitable membranes: Sinauer.</article-title>             <fpage>722</fpage>          </element-citation></ref>
<ref id="pcbi.1000886-Cannon1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cannon</surname><given-names>RC</given-names></name>
<name name-style="western"><surname>D'Alessandro</surname><given-names>G</given-names></name>
</person-group>             <year>2006</year>             <article-title>The ion channel inverse problem: neuroinformatics meets biophysics.</article-title>             <source>PLoS Comput Biol</source>             <volume>2</volume>             <fpage>e91</fpage>          </element-citation></ref>
<ref id="pcbi.1000886-Gillespie1"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name>
</person-group>             <year>2001</year>             <article-title>Approximate accelerated stochastic simulation of chemically reacting systems.</article-title>             <source>The Journal of Chemical Physics</source>             <volume>115</volume>             <fpage>1716</fpage>             <lpage>1733</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Cao1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name>
<name name-style="western"><surname>Petzold</surname><given-names>LR</given-names></name>
</person-group>             <year>2006</year>             <article-title>Efficient step size selection for the tau-leaping simulation method.</article-title>             <source>J Chem Phys</source>             <volume>124</volume>             <fpage>044109</fpage>          </element-citation></ref>
<ref id="pcbi.1000886-Gillespie2"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name>
</person-group>             <year>1977</year>             <article-title>Exact Stochastic Simulation of Coupled Chemical-Reactions.</article-title>             <source>Abstr Pap Am Chem Soc</source>             <volume>173</volume>             <fpage>128</fpage>             <lpage>128</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Chow1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chow</surname><given-names>CC</given-names></name>
<name name-style="western"><surname>White</surname><given-names>JA</given-names></name>
</person-group>             <year>1996</year>             <article-title>Spontaneous action potentials due to channel fluctuations.</article-title>             <source>Biophys J</source>             <volume>71</volume>             <fpage>3013</fpage>             <lpage>3021</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Neher1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Neher</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Stevens</surname><given-names>CF</given-names></name>
</person-group>             <year>1977</year>             <article-title>Conductance fluctuations and ionic pores in membranes.</article-title>             <source>Annu Rev Biophys Bioeng</source>             <volume>6</volume>             <fpage>345</fpage>             <lpage>381</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Sigworth1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sigworth</surname><given-names>FJ</given-names></name>
</person-group>             <year>1980</year>             <article-title>The variance of sodium current fluctuations at the node of Ranvier.</article-title>             <source>J Physiol</source>             <volume>307</volume>             <fpage>97</fpage>             <lpage>129</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Bhalla2"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bhalla</surname><given-names>US</given-names></name>
<name name-style="western"><surname>Bilitch</surname><given-names>DH</given-names></name>
<name name-style="western"><surname>Bower</surname><given-names>JM</given-names></name>
</person-group>             <year>1992</year>             <article-title>Rallpacks: a set of benchmarks for neuronal simulators.</article-title>             <source>Trends Neurosci</source>             <volume>15</volume>             <fpage>453</fpage>             <lpage>458</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Migliore1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Migliore</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hoffman</surname><given-names>DA</given-names></name>
<name name-style="western"><surname>Magee</surname><given-names>JC</given-names></name>
<name name-style="western"><surname>Johnston</surname><given-names>D</given-names></name>
</person-group>             <year>1999</year>             <article-title>Role of an A-type K+ conductance in the back-propagation of action potentials in the dendrites of hippocampal pyramidal neurons.</article-title>             <source>J Comput Neurosci</source>             <volume>7</volume>             <fpage>5</fpage>             <lpage>15</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Hines2"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hines</surname><given-names>ML</given-names></name>
<name name-style="western"><surname>Carnevale</surname><given-names>NT</given-names></name>
</person-group>             <year>1997</year>             <article-title>The NEURON simulation environment.</article-title>             <source>Neural Comput</source>             <volume>9</volume>             <fpage>1179</fpage>             <lpage>1209</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Rall2"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rall</surname><given-names>W</given-names></name>
</person-group>             <year>1959</year>             <article-title>Branching dendritic trees and motoneuron membrane resistivity.</article-title>             <source>Exp Neurol</source>             <volume>1</volume>             <fpage>491</fpage>             <lpage>527</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Ascoli1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ascoli</surname><given-names>GA</given-names></name>
<name name-style="western"><surname>Donohue</surname><given-names>DE</given-names></name>
<name name-style="western"><surname>Halavi</surname><given-names>M</given-names></name>
</person-group>             <year>2007</year>             <article-title>NeuroMorpho.Org: a central resource for neuronal morphologies.</article-title>             <source>J Neurosci</source>             <volume>27</volume>             <fpage>9247</fpage>             <lpage>9251</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Diba1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Diba</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Koch</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Segev</surname><given-names>I</given-names></name>
</person-group>             <year>2006</year>             <article-title>Spike propagation in dendrites with stochastic ion channels.</article-title>             <source>J Comput Neurosci</source>             <volume>20</volume>             <fpage>77</fpage>             <lpage>84</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Jarsky1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Jarsky</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Roxin</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Kath</surname><given-names>WL</given-names></name>
<name name-style="western"><surname>Spruston</surname><given-names>N</given-names></name>
</person-group>             <year>2005</year>             <article-title>Conditional dendritic spike propagation following distal synaptic activation of hippocampal CA1 pyramidal neurons.</article-title>             <source>Nat Neurosci</source>             <volume>8</volume>             <fpage>1667</fpage>             <lpage>1676</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Golding1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Golding</surname><given-names>NL</given-names></name>
<name name-style="western"><surname>Mickus</surname><given-names>TJ</given-names></name>
<name name-style="western"><surname>Katz</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Kath</surname><given-names>WL</given-names></name>
<name name-style="western"><surname>Spruston</surname><given-names>N</given-names></name>
</person-group>             <year>2005</year>             <article-title>Factors mediating powerful voltage attenuation along CA1 pyramidal neuron dendrites.</article-title>             <source>J Physiol</source>             <volume>568</volume>             <fpage>69</fpage>             <lpage>82</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Magee1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Magee</surname><given-names>JC</given-names></name>
</person-group>             <year>1998</year>             <article-title>Dendritic hyperpolarization-activated currents modify the integrative properties of hippocampal CA1 pyramidal neurons.</article-title>             <source>J Neurosci</source>             <volume>18</volume>             <fpage>7613</fpage>             <lpage>7624</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Lorincz1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lorincz</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Notomi</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Tamas</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Shigemoto</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Nusser</surname><given-names>Z</given-names></name>
</person-group>             <year>2002</year>             <article-title>Polarized and compartment-dependent distribution of HCN1 in pyramidal cell dendrites.</article-title>             <source>Nature Neuroscience</source>             <volume>5</volume>             <fpage>1185</fpage>             <lpage>1193</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Ahmed1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ahmed</surname><given-names>OJ</given-names></name>
<name name-style="western"><surname>Mehta</surname><given-names>MR</given-names></name>
</person-group>             <year>2009</year>             <article-title>The hippocampal rate code: anatomy, physiology and theory.</article-title>             <source>Trends Neurosci</source>             <volume>32</volume>             <fpage>329</fpage>             <lpage>338</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Gasparini1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gasparini</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Magee</surname><given-names>JC</given-names></name>
</person-group>             <year>2006</year>             <article-title>State-dependent dendritic computation in hippocampal CA1 pyramidal neurons.</article-title>             <source>J Neurosci</source>             <volume>26</volume>             <fpage>2088</fpage>             <lpage>2100</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Gasparini2"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gasparini</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Migliore</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Magee</surname><given-names>JC</given-names></name>
</person-group>             <year>2004</year>             <article-title>On the initiation and propagation of dendritic spikes in CA1 pyramidal neurons.</article-title>             <source>J Neurosci</source>             <volume>24</volume>             <fpage>11046</fpage>             <lpage>11056</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Nevian1"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nevian</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Larkum</surname><given-names>ME</given-names></name>
<name name-style="western"><surname>Polsky</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Schiller</surname><given-names>J</given-names></name>
</person-group>             <year>2007</year>             <article-title>Properties of basal dendrites of layer 5 pyramidal neurons: a direct patch-clamp recording study.</article-title>             <source>Nat Neurosci</source>             <volume>10</volume>             <fpage>206</fpage>             <lpage>214</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Neher2"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Neher</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Sakmann</surname><given-names>B</given-names></name>
</person-group>             <year>1976</year>             <article-title>Single-channel currents recorded from membrane of denervated frog muscle fibres.</article-title>             <source>Nature</source>             <volume>260</volume>             <fpage>799</fpage>             <lpage>802</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Hoffman1"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hoffman</surname><given-names>DA</given-names></name>
<name name-style="western"><surname>Magee</surname><given-names>JC</given-names></name>
<name name-style="western"><surname>Colbert</surname><given-names>CM</given-names></name>
<name name-style="western"><surname>Johnston</surname><given-names>D</given-names></name>
</person-group>             <year>1997</year>             <article-title>K+ channel regulation of signal propagation in dendrites of hippocampal pyramidal neurons.</article-title>             <source>Nature</source>             <volume>387</volume>             <fpage>869</fpage>             <lpage>875</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Magistretti1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Magistretti</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Ragsdale</surname><given-names>DS</given-names></name>
<name name-style="western"><surname>Alonso</surname><given-names>A</given-names></name>
</person-group>             <year>1999</year>             <article-title>Direct demonstration of persistent Na+ channel activity in dendritic processes of mammalian cortical neurones.</article-title>             <source>J Physiol</source>             <volume>521 Pt 3</volume>             <fpage>629</fpage>             <lpage>636</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Chen1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chen</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Johnston</surname><given-names>D</given-names></name>
</person-group>             <year>2004</year>             <article-title>Properties of single voltage-dependent K+ channels in dendrites of CA1 pyramidal neurones of rat hippocampus.</article-title>             <source>J Physiol</source>             <volume>559</volume>             <fpage>187</fpage>             <lpage>203</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Szilagyi1"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Szilagyi</surname><given-names>T</given-names></name>
<name name-style="western"><surname>De Schutter</surname><given-names>E</given-names></name>
</person-group>             <year>2004</year>             <article-title>Effects of variability in anatomical reconstruction techniques on models of synaptic integration by dendrites: a comparison of three Internet archives.</article-title>             <source>Eur J Neurosci</source>             <volume>19</volume>             <fpage>1257</fpage>             <lpage>1266</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Scorcioni1"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Scorcioni</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Lazarewicz</surname><given-names>MT</given-names></name>
<name name-style="western"><surname>Ascoli</surname><given-names>GA</given-names></name>
</person-group>             <year>2004</year>             <article-title>Quantitative morphometry of hippocampal pyramidal cells: differences between anatomical classes and reconstructing laboratories.</article-title>             <source>J Comp Neurol</source>             <volume>473</volume>             <fpage>177</fpage>             <lpage>193</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Nusser1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nusser</surname><given-names>Z</given-names></name>
</person-group>             <year>2009</year>             <article-title>Variability in the subcellular distribution of ion channels increases neuronal diversity.</article-title>             <source>Trends Neurosci</source>             <volume>32</volume>             <fpage>267</fpage>             <lpage>274</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Nolan1"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nolan</surname><given-names>MF</given-names></name>
<name name-style="western"><surname>Dudman</surname><given-names>JT</given-names></name>
<name name-style="western"><surname>Dodson</surname><given-names>PD</given-names></name>
<name name-style="western"><surname>Santoro</surname><given-names>B</given-names></name>
</person-group>             <year>2007</year>             <article-title>HCN1 channels control resting and active integrative properties of stellate cells from layer II of the entorhinal cortex.</article-title>             <source>J Neurosci</source>             <volume>27</volume>             <fpage>12440</fpage>             <lpage>12451</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Fox1"><label>60</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fox</surname><given-names>RF</given-names></name>
</person-group>             <year>1997</year>             <article-title>Stochastic versions of the Hodgkin-Huxley equations.</article-title>             <source>Biophys J</source>             <volume>72</volume>             <fpage>2068</fpage>             <lpage>2074</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-OKeefe1"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>O'Keefe</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Recce</surname><given-names>ML</given-names></name>
</person-group>             <year>1993</year>             <article-title>Phase relationship between hippocampal place units and the EEG theta rhythm.</article-title>             <source>Hippocampus</source>             <volume>3</volume>             <fpage>317</fpage>             <lpage>330</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Schreiber1"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Schreiber</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Machens</surname><given-names>CK</given-names></name>
<name name-style="western"><surname>Herz</surname><given-names>AV</given-names></name>
<name name-style="western"><surname>Laughlin</surname><given-names>SB</given-names></name>
</person-group>             <year>2002</year>             <article-title>Energy-efficient coding with discrete stochastic events.</article-title>             <source>Neural Comput</source>             <volume>14</volume>             <fpage>1323</fpage>             <lpage>1346</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Collins1"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Collins</surname><given-names>JJ</given-names></name>
<name name-style="western"><surname>Chow</surname><given-names>CC</given-names></name>
<name name-style="western"><surname>Imhoff</surname><given-names>TT</given-names></name>
</person-group>             <year>1995</year>             <article-title>Stochastic resonance without tuning.</article-title>             <source>Nature</source>             <volume>376</volume>             <fpage>236</fpage>             <lpage>238</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Douglass1"><label>64</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Douglass</surname><given-names>JK</given-names></name>
<name name-style="western"><surname>Wilkens</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Pantazelou</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Moss</surname><given-names>F</given-names></name>
</person-group>             <year>1993</year>             <article-title>Noise enhancement of information transfer in crayfish mechanoreceptors by stochastic resonance.</article-title>             <source>Nature</source>             <volume>365</volume>             <fpage>337</fpage>             <lpage>340</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Levin1"><label>65</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Levin</surname><given-names>JE</given-names></name>
<name name-style="western"><surname>Miller</surname><given-names>JP</given-names></name>
</person-group>             <year>1996</year>             <article-title>Broadband neural encoding in the cricket cercal sensory system enhanced by stochastic resonance.</article-title>             <source>Nature</source>             <volume>380</volume>             <fpage>165</fpage>             <lpage>168</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Moss1"><label>66</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Moss</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Ward</surname><given-names>LM</given-names></name>
<name name-style="western"><surname>Sannita</surname><given-names>WG</given-names></name>
</person-group>             <year>2004</year>             <article-title>Stochastic resonance and sensory information processing: a tutorial and review of application.</article-title>             <source>Clin Neurophysiol</source>             <volume>115</volume>             <fpage>267</fpage>             <lpage>281</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Mitchell1"><label>67</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mitchell</surname><given-names>SJ</given-names></name>
<name name-style="western"><surname>Silver</surname><given-names>RA</given-names></name>
</person-group>             <year>2003</year>             <article-title>Shunting inhibition modulates neuronal gain during synaptic excitation.</article-title>             <source>Neuron</source>             <volume>38</volume>             <fpage>433</fpage>             <lpage>445</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Newey1"><label>68</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Newey</surname><given-names>SE</given-names></name>
<name name-style="western"><surname>Velamoor</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Govek</surname><given-names>EE</given-names></name>
<name name-style="western"><surname>Van Aelst</surname><given-names>L</given-names></name>
</person-group>             <year>2005</year>             <article-title>Rho GTPases, dendritic structure, and mental retardation.</article-title>             <source>J Neurobiol</source>             <volume>64</volume>             <fpage>58</fpage>             <lpage>74</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Koch2"><label>69</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Koch</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Segev</surname><given-names>I</given-names></name>
</person-group>             <year>1989</year>             <article-title>Methods in Neuronal Modeling: From Synapses to Networks: MIT Press.</article-title>          </element-citation></ref>
<ref id="pcbi.1000886-Matsumoto1"><label>70</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Matsumoto</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Nishimura</surname><given-names>T</given-names></name>
</person-group>             <year>1998</year>             <article-title>Marsenne Twister: A 623-dimensionally equidistributed uniform pseudorandom number generator.</article-title>             <source>ACM Trans on Modelling and Computer Simulation</source>             <volume>8</volume>             <fpage>3</fpage>             <lpage>30</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Armstrong1"><label>71</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Armstrong</surname><given-names>CM</given-names></name>
</person-group>             <year>1969</year>             <article-title>Inactivation of the potassium conductance and related phenomena caused by quaternary ammonium ion injection in squid axons.</article-title>             <source>J Gen Physiol</source>             <volume>54</volume>             <fpage>553</fpage>             <lpage>575</lpage>          </element-citation></ref>
<ref id="pcbi.1000886-Colquhoun2"><label>72</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Colquhoun</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Hawkes</surname><given-names>AG</given-names></name>
</person-group>             <year>1977</year>             <article-title>Relaxation and fluctuations of membrane currents that flow through drug-operated channels.</article-title>             <source>Proc R Soc Lond B Biol Sci</source>             <volume>199</volume>             <fpage>231</fpage>             <lpage>262</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>