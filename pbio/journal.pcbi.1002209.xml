<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">10-PLCB-RA-2748</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002209</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Computational Biology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Computation of Steady-State Probability Distributions in Stochastic Models of Cellular Networks</article-title><alt-title alt-title-type="running-head">Steady-State Distributions</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Hallen</surname>
            <given-names>Mark</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Li</surname>
            <given-names>Bochong</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Tanouchi</surname>
            <given-names>Yu</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Tan</surname>
            <given-names>Cheemeng</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="fn" rid="fn1">
            <sup>¤</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>West</surname>
            <given-names>Mike</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>You</surname>
            <given-names>Lingchong</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
          <xref ref-type="aff" rid="aff5">
            <sup>5</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Biomedical Engineering, Duke University, Durham, North Carolina, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Structural Biology and Biophysics Program, Duke University, Durham, North Carolina, United States of America</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Department of Statistical Science, Duke University, Durham, North Carolina, United States of America</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Center for Systems Biology, Duke University, Durham, North Carolina, United States of America</addr-line>       </aff><aff id="aff5"><label>5</label><addr-line>Institute for Genome Sciences and Policy, Duke University, Durham, North Carolina, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Rao</surname>
            <given-names>Christopher V.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University of Illinois at Urbana-Champaign, United States of America</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">you@duke.edu</email></corresp>
        <fn fn-type="current-aff" id="fn1">
          <label>¤</label>
          <p>Current address: Ray and Stephanie Lane Center for Computational Biology, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: MH LY. Performed the experiments: MH BL YT CT. Analyzed the data: MH BL LY. Contributed reagents/materials/analysis tools: MH BL YT CT MW LY. Wrote the paper: MH BL LY.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>10</month>
        <year>2011</year>
      </pub-date><pub-date pub-type="epub">
        <day>13</day>
        <month>10</month>
        <year>2011</year>
      </pub-date><volume>7</volume><issue>10</issue><elocation-id>e1002209</elocation-id><history>
        <date date-type="received">
          <day>26</day>
          <month>8</month>
          <year>2010</year>
        </date>
        <date date-type="accepted">
          <day>8</day>
          <month>8</month>
          <year>2011</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2011</copyright-year><copyright-holder>Hallen et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Cellular processes are “noisy”. In each cell, concentrations of molecules are subject to random fluctuations due to the small numbers of these molecules and to environmental perturbations. While noise varies with time, it is often measured at steady state, for example by flow cytometry. When interrogating aspects of a cellular network by such steady-state measurements of network components, a key need is to develop efficient methods to simulate and compute these distributions. We describe innovations in stochastic modeling coupled with approaches to this computational challenge: first, an approach to modeling intrinsic noise via solution of the chemical master equation, and second, a convolution technique to account for contributions of extrinsic noise. We show how these techniques can be combined in a streamlined procedure for evaluation of different sources of variability in a biochemical network. Evaluation and illustrations are given in analysis of two well-characterized synthetic gene circuits, as well as a signaling network underlying the mammalian cell cycle entry.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Variability from one cell to another is a pronounced and universal trend in living organisms; much of this variability is related to varying concentrations of proteins and other chemical species across the cells. Understanding this variability is necessary if we are to fully understand cellular functions, particularly the ways in which cells differ from each other and in which cells with the same origin behave in different ways (e.g. in human development and cancer). When using a chemical model for some aspect of cellular function, one needs to consider two sources of variability: intrinsic variability, which results from the reactions proceeding as in the model but naturally varying because of the finite number of molecules in the cells and their random behavior; and extrinsic variability, which results from other kinds of variation not accounted for in the specific, deterministic model. We present new methods to model and compute both kinds of variability, to facilitate the study of cellular variability as a whole. Our methods provide advantages in speed, accuracy, and scope of mechanisms modeled, and we apply them to experimental data, demonstrating the nature of intrinsic and extrinsic noise in those systems.</p>
      </abstract><funding-group><funding-statement>This work was partially supported by a National Science Foundation Career Award (BES 0953202, L.Y.), the National Institutes of Health (1P50GM081883, R01CA118486), a DuPont Young Professorship (L.Y.), a David and Lucile Packard Fellowship (L.Y.), a Medtronic Fellowship (C.T.), and a Lane Fellowship (C.T.), and a National Defense Science and Engineering Graduate Fellowship (M.A.H). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="16"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Cellular processes are “noisy”. In each cell, concentrations of molecules (e.g., mRNAs, proteins) are subject to random fluctuations (noise) due to the small numbers of these molecules and to environmental perturbations <xref ref-type="bibr" rid="pcbi.1002209-Kaern1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Rao1">[2]</xref>. Cellular noise impacts on information transmission involved in cell signaling dynamics <xref ref-type="bibr" rid="pcbi.1002209-Tan1">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1002209-Hooshangi1">[5]</xref>, while cells may take advantage of such variability in adapting to changing environments or for cell-fate decisions <xref ref-type="bibr" rid="pcbi.1002209-Acar1">[6]</xref>–<xref ref-type="bibr" rid="pcbi.1002209-BenJacob1">[15]</xref>. Improved understanding of how noise influences and is modulated by cellular processes will greatly benefit from efficient, streamlined computational tools to quantify noise, and to use noise to probe properties of the underlying regulatory networks <xref ref-type="bibr" rid="pcbi.1002209-Cox1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1002209-Munsky1">[19]</xref>. To date, stochastic modeling of gene expression has typically relied on forward simulations of time courses, for example via Gillespie algorithms <xref ref-type="bibr" rid="pcbi.1002209-Gillespie1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Arkin1">[21]</xref> or numerical solution of stochastic differential equations (SDEs) <xref ref-type="bibr" rid="pcbi.1002209-Pedraza1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-GarciaOjalvo1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Tanouchi1">[23]</xref>.</p>
      <p>Flow cytometry and fluorescence microscopy currently allow for access to increasingly rich data on approximately steady-state distributions of gene expression. These distributions arise biologically when a set of reactions proceeds much faster than environmental changes, and observing such data provides a step towards understanding some aspects of the underlying cellular network. To assess how such data can be informative, we need to compute or simulate aspects of the steady-state distribution. Forward simulation can be time-consuming, and new approaches are needed. Approaches such as umbrella sampling <xref ref-type="bibr" rid="pcbi.1002209-Warmflash2">[24]</xref> and coupling-from-the-past <xref ref-type="bibr" rid="pcbi.1002209-Hemberg1">[25]</xref> have been introduced, but the sampling biases of the former and substantial computational expenses of the latter leave areas for improvement.</p>
      <p>Mechanistic modeling of noise is complicated by its diverse sources, which have been classified as intrinsic or extrinsic <xref ref-type="bibr" rid="pcbi.1002209-Elowitz1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Swain1">[27]</xref>. Intrinsic noise results from the stochasticity of chemical kinetics when the numbers of interacting molecules are sufficiently small; it can be described by the chemical master equation (CME). In essence, intrinsic noise represents deviation of known reactions with known rates from their results as predicted by classical chemical kinetics <xref ref-type="bibr" rid="pcbi.1002209-Samoilov1">[28]</xref>. In contrast, extrinsic noise results from other reactions and from fluctuations in rate constants, and it is often the dominant source of variability in a system <xref ref-type="bibr" rid="pcbi.1002209-Elowitz1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Raser1">[29]</xref>. Extrinsic noise may result from any process not represented in the network model itself.</p>
      <p>A direct route to model intrinsic noise is to calculate steady-state solutions to the CME, often by using an approximation. An analytical solution based on a continuous master equation describing protein production in bursts has been formulated by Friedman and colleagues <xref ref-type="bibr" rid="pcbi.1002209-Friedman1">[30]</xref>, while Fourier and colleagues <xref ref-type="bibr" rid="pcbi.1002209-Fournier1">[31]</xref> present analytical solutions for several other networks. Walczak and colleagues <xref ref-type="bibr" rid="pcbi.1002209-Walczak1">[32]</xref> investigate another solution approach based on using an eigenbasis from a simpler system to solve the massive linear equation resulting from setting the CME to steady-state. The approximation here lies in the difference between each system's eigenbases, and its suitability for a specific system needs to be determined on an <italic>ad hoc</italic> basis. More general methods have been investigated as well. The Hartree approximation <xref ref-type="bibr" rid="pcbi.1002209-Kim1">[33]</xref> assumes probabilistic independence of molecule numbers for each species; this approximation greatly reduces the dimensionality of the system, but tends to break down seriously in multimodal systems, unless the joint distribution has a mode at each combination of the one-dimensional distributions' modes (this is frequently not the case). Cao and colleagues <xref ref-type="bibr" rid="pcbi.1002209-Cao1">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Cao2">[35]</xref> investigate accurate though computationally costly numerical solution methods for the CME, such as efficient exhaustive enumeration of microstates. Munksy and Khammash <xref ref-type="bibr" rid="pcbi.1002209-Munsky2">[36]</xref>, focusing on the application of methods for solving the master equation, investigate the necessary data for obtaining reaction parameters in a system dominated by this type of noise.</p>
      <p>A related approach is to calculate an “energy landscape” for a network. Ao <xref ref-type="bibr" rid="pcbi.1002209-Ao1">[37]</xref> assumes an SDE model and derives a potential that yields the probability distribution as its Boltzmann distribution. Wang and colleagues <xref ref-type="bibr" rid="pcbi.1002209-Wang1">[38]</xref> also use an SDE model and then construct a potential landscape based on a Hodge decomposition of the flux vector in the system. Both approaches are useful for a wide range of SDEs, including the chemical Langevin equation. However, they are thus subject to the inaccuracies of that equation—most importantly, the inaccuracy at low molecule numbers—and may also lack computational tractability for complex systems. Qian and Beard <xref ref-type="bibr" rid="pcbi.1002209-Qian1">[39]</xref>, in constructing potential landscapes for non-equilibrium systems based on chemical potentials, provide an approximation for the probability distribution that follows the Hartree approximation.</p>
      <p>In contrast to intrinsic noise, extrinsic noise lacks a unique modeling framework and is often determined by empirical inference of distributions from data. One approach that accounts for some of these effects is to perturb the rate constants while modeling intrinsic fluctuations using a Gillespie algorithm-type simulation strategy <xref ref-type="bibr" rid="pcbi.1002209-Shahrezaei1">[40]</xref>. This approach may also produce extrinsic fluctuations that could be produced by other sources, such as other reactions and measurement noise. However, direct steady-state calculations can instead pool together results from many extrinsically perturbed distributions, thus preventing the need to perform calculations for many parameter sets and many time points. Analytical inclusion of extrinsic noise is also possible, and indeed the use of exponentially distributed burst sizes in modeling protein production in <xref ref-type="bibr" rid="pcbi.1002209-Friedman1">[30]</xref> amounts to this. In addition, extrinsic noise can be accounted for by addition of random noise to molecule numbers in each time step of a timecourse simulation based on a stochastic differential equation <xref ref-type="bibr" rid="pcbi.1002209-Pedraza1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Tanouchi1">[23]</xref>. Recent single-molecule fluorescent measurements have allowed experimental determination of molecule number distributions in <italic>Escherichia coli</italic>, thus measuring both intrinsic and extrinsic noise <xref ref-type="bibr" rid="pcbi.1002209-Taniguchi1">[41]</xref>.</p>
      <p>Despite these progresses, a major challenge lies in the lack of well-defined computational framework for thorough, systematic evaluation of these methods with experimental data. As a step to address these issues, we have developed an integrated framework for modeling steady-state distributions in the context of both intrinsic and extrinsic noise sources. As an illustration, we have applied these methods to the analysis of two well-characterized bistable switches and evaluated the methods against experimental data. Furthermore, we also demonstrated the applicability of these methods to a more complex signaling network, the Myc/Rb/E2F network, which underlies the control of mammalian cell cycle entry.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Overview of the Computational Framework</title>
        <p>In general, the observed distribution of molecular counts (<italic>P</italic><sub>observed</sub>) can be treated as the combination of an intrinsic component (<italic>P</italic><sub>intrinsic</sub>) and an extrinsic component (<italic>P</italic><sub>extrinsic</sub>) (<xref ref-type="fig" rid="pcbi-1002209-g001">Figure 1A</xref>). The intrinsic component is uniquely determined by the reaction mechanisms and the corresponding rate constants. Our approach (<xref ref-type="fig" rid="pcbi-1002209-g001">Figure 1B</xref>) takes a list of species, reactions with known rate information, and known extrinsic noise parameters, and at the first step calculates the steady-state distribution based on the chemical master equation. This first step accounts for intrinsic noise implicitly and can be done analytically for systems with a sufficiently small number of states. When the CME is too complicated to solve analytically, it can be solved numerically to generate the steady-state distributions, up to the size and dimension limits imposed by computational capabilities. The CME is of the form <bold>MP</bold> = 0, where <bold>M</bold> is a matrix and <bold>P</bold> is the steady-state probability vector.</p>
        <fig id="pcbi-1002209-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002209.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>A framework for combining intrinsic and extrinsic noise.</title>
            <p>(A) Distribution prediction starts with predicting distributions based on intrinsic noise only and then adds in extrinsic noise. (B) A schematic for analysis of molecule number distributions in biochemical networks. Predicted distributions based on a model can be compared to experimental data, and information about parameters can be inferred.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.g001" xlink:type="simple"/>
        </fig>
        <p>With many reacting species, as the matrix size may imply prohibitive computation cost, we can rescale the CME or sample approximately from the solution. For scaling, the dimension of the space of distributions is reduced by approximating the CME in terms of directional derivatives and then re-sampling. The scaled CME is then solved by linear algebra. Even with scaling, however, the matrix computations needed to solve the CME become prohibitive when more than a few species are present or when the distribution is complex. We address these limitations by developing a modified Gibbs sampling (MGS) method to generate the steady-state solution to the CME. Gibbs sampling provides a set of samples from a distribution by sampling one dimension of the distribution (in this case, the molecule number for a given species) at a time, using the conditional distribution for that species given the current molecule numbers of all the other species. In our MGS method, detailed balance is assumed for different sets of reactions at each iteration, generating approximate conditional distributions from which exact sampling is possible. The MGS method scales much more favorably than the direct CME solution with increased numbers of species. Its scaling property is similar to that of ordinary Gibbs sampling. Importantly, it overcomes some caveats associated with alternative approximations, especially in multimodal systems. In particular, it avoids the restrictions on the distribution space caused by the Hartree approximation. Also, it overcomes the difficulties in sampling multiple local minima that occur with the standard Gibbs sampler.</p>
        <p>The second step of our approach is to model extrinsic noise by convolution. Typically, representing extrinsic noise as perturbations to rate parameters <xref ref-type="bibr" rid="pcbi.1002209-Shahrezaei1">[40]</xref> can present significant difficulties in their application to experimental data. Sampling from a parameter sample space would lead to high computational cost because of the need to redo calculations for many different parameter sets. Methods based on adding noise at each time step similarly bring the cost of calculation at many unnecessary points in time. To this end, we have developed a convolution approach to represent extrinsic noise by averaging many effects, which allows more direct application to experimental data. It is well suited to combining analysis of the modes by a deterministic model, allowing rapid and accurate estimation of reaction parameters, with estimation of further noise parameters based on the observed distribution.</p>
      </sec>
      <sec id="s2b">
        <title>Derivations</title>
        <sec id="s2b1">
          <title>Chemical master equation (CME)</title>
          <p>The CME describes temporal evolution of the probability of a given state, as represented by a set of molecule numbers for all species in the system:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e001" xlink:type="simple"/><label>(1)</label></disp-formula>where <italic>P</italic>(<bold>x</bold>) denotes the probability of the system being in state <bold>x</bold> as a function of time, <italic>t</italic>; <italic>v<sub>j</sub></italic> denotes the change in <bold>x</bold> resulting from reaction <italic>j</italic>, and <italic>a<sub>j</sub></italic>(<bold>x</bold>) denotes the probability of reaction <italic>j</italic> per unit time given that the system is in state <bold>x</bold> (i.e. the rate in molecular units).</p>
          <p>At steady state, the time derivative is 0 for all <italic>P</italic>(<bold>x</bold>). This results in a linear system of equations for the probabilities of states: the reaction rates define a matrix, and the null vector of this matrix, normalized so its elements sum to 1, is the vector of probabilities of states.</p>
        </sec>
        <sec id="s2b2">
          <title>Synthesis and degradation of a single molecule</title>
          <p>Consider a simple system consisting of <italic>n</italic> molecules, with synthesis rate <italic>a<sub>s</sub>(n)</italic> and degradation rate <italic>a<sub>d</sub>(n)</italic>. The corresponding CME and its steady-state solution are:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e002" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e003" xlink:type="simple"/><label>(2)</label></disp-formula><italic>P</italic>(0) is chosen such that the sum of all probabilities is 1. For the constitutive expression of a single protein, <italic>a<sub>s</sub></italic>(<italic>n</italic>) = <italic>k<sub>s</sub></italic>, <italic>a<sub>d</sub></italic>(<italic>n</italic>) = <italic>k<sub>d</sub>n</italic>, where <italic>k<sub>s</sub></italic> is the synthesis rate and <italic>k<sub>d</sub></italic> is the decay rate constant. Here <italic>P</italic>(<italic>n</italic>) follows a Poisson distribution with mean <italic>k<sub>s</sub></italic>/<italic>k<sub>d</sub></italic>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e004" xlink:type="simple"/><label>(3)</label></disp-formula></p>
          <p>This distribution describes the variability resulting from intrinsic noise. To account for extrinsic noise, one approach is to draw the parameters from their own probability distributions (assuming that the stochasticity from other cellular processes is manifested in fluctuations in the rate constants), which need to be empirically determined:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e005" xlink:type="simple"/><label>(4)</label></disp-formula>where <bold>k</bold> is the vector of parameters, <italic>P</italic>(<bold>k</bold>) is its probability density function, <italic>N</italic>(<bold>k</bold>) is a normalization constant, <italic>r<sub>s</sub></italic> is the synthesis rate constant, <italic>r<sub>d</sub></italic> is the degradation rate constant, and the integral is over all values of <italic>k</italic> with nonzero probability.</p>
          <p>In the simple example above, the distribution is determined by the parameter <italic>y</italic> = <italic>k<sub>s</sub></italic>/<italic>k<sub>d</sub></italic>, so drawing <italic>y</italic> from a gamma distribution with parameters <italic>α</italic> and θ,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e006" xlink:type="simple"/><label>(5)</label></disp-formula>Here, we chose the gamma distribution because positive real values of <bold>k</bold> are needed and the gamma distribution draws values from this set and allows the integral to be performed analytically. Choosing separate distributions for <italic>k<sub>s</sub></italic> and <italic>k<sub>d</sub></italic> is not necessary here because only the corresponding distribution of <italic>y</italic> would affect the final distribution of <italic>n</italic>.</p>
        </sec>
        <sec id="s2b3">
          <title>Scaling of the CME</title>
          <p>Excessive matrix size can present a major challenge for solving the CME, both as a result of high dimensionality and of high individual molecule numbers (though not high enough for classical reaction rate equations to be used). The size of this equation may be reduced by approximating it in terms of derivatives and then resampling it,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e007" xlink:type="simple"/><label>(6)</label></disp-formula>where <italic>S</italic> (≥1) is a scale factor (<italic>S</italic> = 1 denotes no scaling) and <italic>D</italic> is a directional derivative, allowing general use of this formalism regardless of what reactions are in the system; the sums in the first and third lines are finite-difference approximations of the directional derivative in the second line.</p>
          <p>Several scales may be used for the same problem: the unscaled equation can be used for small molecule numbers while less dense sampling may be used for larger ones where the linear approximation applies better. If computer memory is a greater barrier than computation time in solving the steady-state CME, it may be appropriate to choose <italic>S</italic> as small as possible without running out of memory, since the maximum molecule numbers that need to be included in an analysis are essentially independent of scaling. A discrete, rescaled CME avoids the numerical error that would likely result from a continuous approximation. Also, it reduces exactly to the unscaled master equation when <italic>S</italic> = 1. This is useful for direct comparison of systems of different sizes. It is also useful for systems where the molecule numbers for some but not all species are large enough to require scaling.</p>
          <p>The synthesis/degradation system is a useful test case of the scaling method. Combining Eqs 2 and 6, the scaled master equation for this system is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e008" xlink:type="simple"/><label>(7)</label></disp-formula>thus completely determining <italic>P</italic>(<italic>n</italic>) up to normalization. Provided sufficiently small variation between each <italic>P</italic>(<italic>n</italic>) and <italic>P</italic>(<italic>n−S</italic>), the normalization<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e009" xlink:type="simple"/><label>(8)</label></disp-formula>may be applied.</p>
          <p>Eq. 7 gives <italic>P</italic>(<italic>n</italic>)&gt;<italic>P</italic>(<italic>n</italic>−<italic>S</italic>) if <italic>n&lt;k<sub>s</sub>/k<sub>d</sub></italic> and <italic>P</italic>(<italic>n</italic>)&lt;<italic>P</italic>(<italic>n</italic>−<italic>S</italic>) if <italic>n&gt;k<sub>s</sub>/k<sub>d</sub></italic>; thus the distribution peaks at <italic>n = k<sub>s</sub>/k<sub>d</sub></italic>, as is the case without scaling. Furthermore, for <italic>S</italic> = 1, it reduces to the ordinary CME, as is the case in general for Eq. 6.</p>
        </sec>
        <sec id="s2b4">
          <title>Modeling intrinsic noise via Gibbs sampling</title>
          <p>High dimensionality can make accurate numerical solution of CME intractable, even with scaling. One way to effectively reduce the dimensionality is to use Gibbs sampling <xref ref-type="bibr" rid="pcbi.1002209-Geman1">[42]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Casella1">[43]</xref>. Each step in Gibbs sampling requires constructing only a 1-D distribution. To sample, one cycles through the <italic>d</italic> different species, sampling a value for each molecule number <italic>x<sub>i</sub></italic> in turn from the conditional distribution <italic>P(x<sub>i</sub>|x<sub>1</sub>,…,x<sub>i−1</sub>,x<sub>i+1</sub>,…x<sub>d</sub>)</italic> of the molecule number being sampled given the other current molecule numbers. This yields a sample from the entire distribution, (<italic>x<sub>1</sub>,…,x<sub>d</sub></italic>) at the conclusion of each cycle. Gibbs sampling for the steady-state solution of the CME can be performed by assuming detailed balance for synthesis and degradation of a given species; that is:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e010" xlink:type="simple"/><label>(9)</label></disp-formula>where <italic>n</italic> is the molecule number of the species; <italic>a<sub>s</sub></italic> and <italic>a<sub>d</sub></italic> are its synthesis and degradation rates.</p>
          <p>This equation can be modified to account for reactions with different stoichiometries by simply replacing <italic>n</italic> and <italic>n+1</italic> with the states interconverted by the other reactions (e.g. one can replace <italic>n+1</italic> with <italic>n+2</italic> if molecules are synthesized and degraded two at a time).</p>
          <p>The sampling algorithm starts with an arbitrary initial value for all but one of the molecule numbers, calculates the distribution of the remaining molecule number by assuming detailed balance (Eq. 9) with the other numbers fixed. This sample is then fixed when other species are being sampled. Each complete sampling cycle yields a new sampled state. This strategy is similar to the mean-field method often used with the Hartree approximation (<xref ref-type="fig" rid="pcbi-1002209-g002">Figure 2A</xref>). However, because it samples from a distribution for one species that is correct for the current sample's (rather than the mean's) molecule numbers of the other species, it avoids the key pitfalls in the Hartree approximation when applied to multimodal distributions (<xref ref-type="fig" rid="pcbi-1002209-g002">Figure 2B</xref>).</p>
          <fig id="pcbi-1002209-g002" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002209.g002</object-id>
            <label>Figure 2</label>
            <caption>
              <title>A modified Gibbs sampling method in comparison to previous methods.</title>
              <p>(A) The Hartree approximation can distort the joint distribution for multimodal distributions by generating false peaks. (B) Gibbs sampling method: sampling of each molecule number is based on current values of the other molecule numbers rather than on mean values, to avoid this distortion. This method can result in samples being “stuck” in one peak of the probability distribution. The blue arrows in (B) and (C) indicate sampling directions, which are used sequentially. (C) A modified Gibbs sampling method based on coordinate changes can avoid the sampling bias.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.g002" xlink:type="simple"/>
          </fig>
          <p>The basic Gibbs sampling has its own caveat when applied to multimodal distributions: Once a sample is drawn from one peak of such a distribution, it is unlikely to cross over to other peaks, unless the peaks overlap in at least one dimension or if there is sufficient probability density outside the peaks for the samples to migrate between peaks. If the total probabilities of the two peaks are known, one can solve this problem by sampling separately from each peak, at the expense of additional burn-in (samples that must be discarded because they are biased by the initial values).</p>
          <p>To overcome this caveat, our modified Gibbs sampling (MGS) method changes coordinates between sampling steps (<xref ref-type="fig" rid="pcbi-1002209-g002">Figure 2C</xref>). An accurate Gibbs sampling scheme needs to accurately draw a sample <italic>x′</italic> given that the previous sample, <italic>x</italic>, is from the correct distribution; in other words it must have <italic>P</italic>(<italic>x′</italic>) = <italic>P</italic>(<italic>x</italic>). This is achieved when <italic>P</italic>(<italic>x′</italic>|<italic>x</italic>) = <italic>P</italic>(<italic>x</italic>|<italic>x′</italic>), because this condition leads to <italic>P</italic>(<italic>x′</italic>; <italic>x</italic>)/<italic>P</italic>(<italic>x</italic>) = <italic>P</italic>(<italic>x′</italic>; <italic>x</italic>)/<italic>P</italic>(<italic>x′</italic>). Changing coordinates between steps by random rotation of the coordinate system satisfies this condition. In 2-D, for example, new axes can be created with slope <italic>m</italic> (where tan<sup>−1</sup>(<italic>m</italic>) is uniformly distributed between −90° and 90°) and −1/<italic>m</italic> (note that tan<sup>−1</sup>(−1/<italic>m</italic>) and tan(<italic>m</italic>) have the same distribution); the axes pass through the previously sampled point. Since the purpose of constructing the axes is to sample from points that lie along them, integer lattice points in one coordinate system must match integer lattice points in the original coordinate system, so that each state can be represented by integer coordinates in the new system. This can be achieved by rounding. In our example, we can let <italic>x</italic> and <italic>y</italic> be the new coordinates and <italic>u</italic> and <italic>v</italic> the old ones, and then let the <italic>x</italic>-axis pass through<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e011" xlink:type="simple"/><label>(10)</label></disp-formula>for each value of <italic>u</italic> and the <italic>y</italic>-axis through<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e012" xlink:type="simple"/><label>(11)</label></disp-formula>for each value of <italic>v</italic>, where the coordinates are given in the <italic>u</italic>−<italic>v</italic> system, brackets denote rounding to the nearest integer, and (<italic>u<sub>0</sub></italic>,<italic>v<sub>0</sub></italic>) is the previously sampled point. This technique is applied to the toggle switch below.</p>
          <p>The basic Gibbs sampling algorithm may also fail in monomodal systems when the peak contains a fraction significantly less than 1 of the probability density and the remaining density is widely distributed over a much larger space than the peak occupies. For example, if the peak is at the origin in a high-dimensional state space, the sampler will remain at the origin for a very large amount of time once it is there, and likewise will take an extremely large amount of time to find the origin once it is removed from it in several dimensions (because it will take many steps for all the dimensions to reach 0 or sufficiently close to 0 randomly). Switching to a hyperspherical coordinate system will remove this problem: the sampler may move from the origin to any other state in one step.</p>
          <p>Higher accuracy in high-dimensional systems can be achieved by sampling from a 2-D rather than a 1-D distribution. Gibbs sampling can use scaling to curtail excessive molecule numbers too. Overall, MGS provides an efficient way to sample from the probability distribution associated with a steady-state CME even when many species are involved. While the detailed balance approximation introduces some error, this error is mitigated relative to that found in the Hartree approximation. The change of coordinates mitigates the error further because detailed balance for different reactions is chosen for each sample.</p>
          <p>Since each iteration of MGS is identical to an iteration of regular Gibbs sampling in the coordinate system that applies at the moment, the computational time of the algorithm is essentially the same as for regular Gibbs sampling. The cost per iteration is slightly larger because of the coordinate-selection step, but this is very fast compared to the actual sampling operation. Furthermore, convergence to the equilibrium distribution occurs on the same timescale that regular Gibbs sampling would exhibit if the latter could accurately sample the distribution. That is, the algorithms should converge similarly as long as the standard Gibbs sampling performs well.</p>
          <p>Despite this strong system-dependence, rigorous methods have been developed to evaluate convergence: see for example the convergence criteria of Zellner and Min <xref ref-type="bibr" rid="pcbi.1002209-Zellner1">[44]</xref> as well as the convergence analysis of Frigessi and colleagues <xref ref-type="bibr" rid="pcbi.1002209-Frigessi1">[45]</xref> and the burn-in analysis of Jones and Hobert <xref ref-type="bibr" rid="pcbi.1002209-Jones1">[46]</xref>. In a <italic>d</italic>-dimensional system, each sample requires <italic>d</italic> one-dimensional sampling procedures; the time required for each sampling will tend to be O(<italic>d</italic><sup>1/2</sup>) because, even measuring in the worst dimension, the width of the region of state space needing to be sampled scales roughly as <italic>d</italic><sup>1/2</sup>. We note that these estimates are somewhat ambiguous because the computational cost of the algorithm varies from system to system. Since each system has a given dimensionality, a generic comparison of computational cost for different dimensionalities must be rather approximate. In particular, the convergence time may depend more on the geometry of the distribution than on the number of species or other generic information.</p>
          <p>Furthermore, the principle behind the standard Gibbs algorithm that allows for accurate sampling from the distribution still applies. Consider a sample <bold>x</bold> = (<italic>x</italic><sub>1</sub>, <italic>x</italic><sub>2</sub>, …) from the desired distribution. One desires to provide another sample <bold>y</bold> = (<italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>,…), also from the desired distribution. This is achieved because<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e013" xlink:type="simple"/><label>(12)</label></disp-formula></p>
          <p>Sampling from the molecule number distribution rather than calculating it explicitly is advantageous when a model has many dimensions but only a few are needed in the output distribution. Since the observed convergence rate of the distribution will depend primarily on the dimensionality of the observed joint distribution rather than on the overall dimensionality of the model, this results in roughly O(<italic>d</italic><sup>1.5</sup><italic>m</italic>) computational cost for MGS, where the model has <italic>d</italic> dimensions and the output has <italic>m</italic>. This is much better than the approximately O(<italic>d</italic><sup>3</sup>) cost for solving the CME by linear algebra, e.g. by using singular value decomposition, especially if <italic>m</italic>≪<italic>d</italic>. Note that for practical applications, even with large numbers of species, one will often need the distribution of a single species or the joint distribution of a few, because of the impracticality of experimentally monitoring all the species in a complex system.</p>
        </sec>
        <sec id="s2b5">
          <title>Convolution representation of extrinsic noise</title>
          <p>Mechanistic methods of representing extrinsic noise, such as modeling perturbations in each parameter, present significant difficulties in their application to experimental data. Sampling from a parameter sample space leads to high computational cost because of the need to redo calculations for many different parameter sets; methods based on adding noise at each time step, similarly, bring the cost of calculation at many unnecessary points in time. Also, the variation in many parameters will result in an excessive number of degrees of freedom in the extrinsic noise, and still there are likely to be sources of noise unaccounted for because they are not easily represented as perturbations in reaction propensities.</p>
          <p>To address this limitation, we present a convolution representation of extrinsic noise based on averaging together many effects and modeling the distribution of extrinsic noise with a set of parameters that can be characterized experimentally. In particular, we represent the total distribution as a weighted integral of shifted intrinsic-noise-only distributions, i.e. the convolution of the intrinsic-noise-only distribution with a distribution of shifts. The rationale for this approach is that most perturbations will induce some shift in the distribution. For example, a reaction not accounted for by the model, or an increase in one of the rate parameters, may affect the concentration of some species. They may also change the shape of the distributions for these species, but this is a less important effect and furthermore will result in a distribution that is a linear combination of shifted versions of the original, intrinsic-noise-only distribution (with the main shifted distribution dominating this combination). The distribution of shifts must have the same dimensionality as the output distribution—note that this is often much less than the dimensionality of the model, thus greatly reducing the number of parameters needed relative to the parameter-variation representation, since there are almost always more reactions (and thus reaction rate parameters) than species in a biochemical network model.</p>
          <p>The following derivation shows how convolution can result from parameter-variation descriptions of extrinsic noise. Let <italic>P</italic>(<bold>x</bold>;<bold>k</bold>) denote the probability of a state vector given a parameter set <bold>k</bold>. Based on parameter perturbations as the source of extrinsic noise, the total probability <italic>P</italic>(<bold>x</bold>) of a given state vector is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e014" xlink:type="simple"/><label>(13)</label></disp-formula>where the integral is over all possible parameter sets and <italic>Q</italic>(<bold>k</bold>) denotes the probability distribution of them, centered around a value <bold>k<sub>0</sub></bold> (i.e. if trying to measure a single set of parameters for the system, one would be trying to measure <bold>k<sub>0</sub></bold>). We can let<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e015" xlink:type="simple"/><label>(14)</label></disp-formula>where <italic>W</italic> is a distribution of shifts due to a perturbation in rate parameters (which may depend on <bold>k</bold>). <italic>W</italic> will tend to be a narrow distribution, similar to δ(<bold>x′</bold>−<bold>y</bold>) for some state <bold>y</bold>: changing <bold>k<sub>0</sub></bold> to <bold>k</bold> will produce primarily a shift in state. Thus<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e016" xlink:type="simple"/><label>(15)</label></disp-formula>where <italic>S</italic>(<bold>x</bold>−<bold>x′</bold>) is a distribution of shifts, which is convolved with <italic>P</italic>(<bold>x</bold>;<bold>k</bold>) to yield <italic>P</italic>(<bold>x</bold>). <italic>S</italic> may be well approximated by a normal distribution, as it is a sum of many weakly correlated terms (corresponding to the different perturbations). In particular, values of <bold>x′</bold> near the original state vector <bold>x</bold> are likely to have more parameter sets with shift distributions <italic>W</italic> centered near <bold>x′</bold>; also <italic>Q</italic>(<bold>k</bold>) is likely to be higher for <bold>k</bold> nearer to <bold>k<sub>0</sub></bold>, which in general will correspond to <bold>x′</bold> being nearer to <bold>x</bold>. Note that the strategy used in the above derivation can be applied to perturbations beyond those in the model parameters.</p>
          <p>When measuring parameters, it is advantageous to define the extrinsic noise such that it does not induce a systematic shift in the molecule numbers (this merely represents a choice of what base parameter set <bold>k<sub>0</sub></bold> to use for a parameter distribution <italic>Q</italic>(<bold>k</bold>)); this would correspond to <italic>S</italic>(<bold>x</bold>−<bold>x′</bold>) having zero mean. Also, it might be useful, in a concrete representation of the extrinsic noise distribution, to add a background term to help make up for the approximations in the representation; let this be <italic>B</italic>(<bold>x</bold>). Thus, we may represent <italic>P</italic>(<bold>x</bold>) as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e017" xlink:type="simple"/><label>(16)</label></disp-formula>where * denotes convolution, <italic>M<sub>0</sub></italic> is a zero-mean multivariate normal distribution with the given covariance matrix, and <italic>a</italic> is a small constant.</p>
          <p><italic>M<sub>0</sub></italic> may have an altered normalization in order to still be a valid probability distribution in the necessary discrete state space (i.e. <italic>M<sub>0</sub></italic> must still sum to 1 over all states, even though the values are still proportional to what the multivariate normal distribution would ordinarily give). The covariance matrix quantifies the “spreading” of probability density in state space due to extrinsic noise. The background noise term represents the distribution of extrinsic noise far from the values predicted by intrinsic noise. Its associated parameters could be estimated from those sections of a flow cytometry data set only, reducing the number of parameters needed to fit the actual peaks. Fitting of the peaks is facilitated by the fact that their location limits the possible values of the rate parameters, allowing the spread to be used to estimate the extrinsic noise standard deviations.</p>
          <p>While convolution can be considered as another form of explicit account for parametric perturbations (with <italic>a priori</italic> specified distributions), its formulation is more general and allows representation of noise sources not well described by perturbations in rate parameters. Many kinds of perturbations can be represented as shifts in the distribution and accounted for by convolution. Because perturbations may induce different shifts in molecule numbers depending on the specific region of state space. For example, a reaction may have a minor effect on molecule numbers when the original molecule numbers are small and a more significant effect when they are large. Therefore, it may be necessary to have the covariance matrix in Eq. 16 depend on <bold>x</bold>, or more generally to have the form of <italic>S</italic> in Eq.15 depend on <bold>x</bold>. For example, different values of the extrinsic noise standard deviation σ can be used for each of the two peaks in a bimodal distribution. In other words, it is preferable to consider Eq. 16 as an empirical equation that has solid theoretic foundation but can be readily used to describe experimental data under diverse conditions.</p>
          <p>Either direct summation or (to save time) a discrete Fourier transform is appropriate for performing this convolution if the probability is known in functional form (i.e. if it was obtained by solving the CME exactly or approximately). If only a sample of <italic>n</italic> points <bold>x<sub>1</sub></bold>,…<bold>x<sub>i</sub></bold>,…,<bold>x<sub>n</sub></bold> from the intrinsic-noise-only probability distribution is known, i.e.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e018" xlink:type="simple"/><label>(17)</label></disp-formula>then we can draw <italic>n</italic> new samples <bold>y<sub>1</sub></bold>,…<bold>y<sub>i</sub></bold>,…,<bold>y<sub>n</sub></bold> using<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e019" xlink:type="simple"/><label>(18)</label></disp-formula>and these obey the convoluted distribution:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e020" xlink:type="simple"/><label>(19)</label></disp-formula></p>
          <p>Once the sample based on the convolution has been drawn in this fashion, if a background noise term in the distribution is desired, then a sample of <italic>na</italic>/(1−<italic>a</italic>) points corresponding to the background term can be drawn to complete the sample based on extrinsic noise. As in any formulation of extrinsic noise, the sources, form, and magnitude of the noise must be determined based on empirical considerations for a given system.</p>
          <p>Our convolution approach provides an intuitive relationship between the distribution of extrinsic noise and the final distribution. In principle, it is highly versatile and can account for all sources of extrinsic noise in an empirical manner. As such, determining an appropriate extrinsic–noise distribution will depend on experimental measurements of the overall distribution. Due to the exceedingly complex nature of extrinsic noise in many systems, however, a Gaussian distribution may be the best starting point. On one hand, such a simple distribution avoids overfitting experimental data. On the other, the Gaussian distribution can be thought of modeling extrinsic noise from many weakly correlated sources added together. A significant deviation from model prediction and experimental data would suggest that a large, concerted phenomenon is influencing the extrinsic noise; in that case, it would be appropriate to expand the network model to include this phenomenon explicitly. The convolution approach, as a method for calculating the steady-state distribution, is also useful in that it can model noise from processes at a variety of different timescales—whether these are similar timescales to those of the main network model or not.</p>
        </sec>
      </sec>
      <sec id="s2c">
        <title>Case Studies</title>
        <p>Combining MGS, CME rescaling, and convolution model for extrinsic noise defines an integrated framework for efficient computation of the steady-state distribution of gene expression for a given set of parameters. To illustrate their use, we consider the application of the overall framework to several examples; aspects of these have been mentioned in the previous section.</p>
        <sec id="s2c1">
          <title>Constitutive expression of a protein (<xref ref-type="fig" rid="pcbi-1002209-g003">Figure 3A</xref>)</title>
          <fig id="pcbi-1002209-g003" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002209.g003</object-id>
            <label>Figure 3</label>
            <caption>
              <title>Calculating steady-state distributions for a simple birth-death process.</title>
              <p>Calculating the steady-state distribution of a (A) simple birth-death process; A is expressed in terms of molecule number for all distributions. (B) Simulated distribution using the Gillespie algorithm (histogram) as compared with the analytical solution (blue line) from the CME, which is a Poisson distribution. (C) Final distributions from this systems with extrinsic noise were generated by taking <italic>k<sub>s</sub></italic>/<italic>k<sub>d</sub></italic>∼Γ(20,1) (green in C) or <italic>k<sub>s</sub></italic>/<italic>k<sub>d</sub></italic>∼Γ(10,2) (green in D); best-fit distributions based on convolution with a Gaussian (red; standard deviations 4.4 for C and 6.1 for D) and the intrinsic-noise-only distribution (blue) are shown as well. (The shift to lower molecule numbers arising from extrinsic noise in the parameter-distribution representation is equivalent to changing the base parameter set in the convolution representation; the “base” parameter set is less well defined in the parameter-distribution representation).</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.g003" xlink:type="simple"/>
          </fig>
          <p>Here, the intrinsic noise is described exactly by a Poisson distribution (see Eq. 3). As expected, this matches the distribution given by running the Gillespie algorithm for a sufficient length of time (<xref ref-type="fig" rid="pcbi-1002209-g003">Figure 3B</xref>). Integrating over the prior distribution of the parameters allows the analytical addition of extrinsic noise (see Eq. 4). Addition of extrinsic noise results in spreading and, ultimately, loss of the characteristic shape of the distribution (<xref ref-type="fig" rid="pcbi-1002209-g003">Figure 3C,D</xref>). Also, adding extrinsic noise by perturbing parameters or by convolution with a Gaussian produces similar results, as evident from the best-fit convolved distributions to the parameter-perturbed distributions in <xref ref-type="fig" rid="pcbi-1002209-g003">Figure 3C,D</xref>. However, the parameter-perturbation method shifts the peak of the distribution while the convolution method does not. In this sense, the two methods define the “intrinsic-noise-only” state somewhat differently, as the parameter perturbation method considers it to be at the mean value of the parameters while the convolution method (at least when using a Gaussian) maintains the mean of the molecule number distribution, giving a more intuitive description of extrinsic noise. A better match between the techniques could be obtained by matching the distributions of extrinsic noise, as opposed to using a gamma distribution for parameters and a Gaussian for convolution because of the suitability of each of these distributions for their respective methods.</p>
        </sec>
        <sec id="s2c2">
          <title>A genetic toggle switch</title>
          <p>The toggle switch <xref ref-type="bibr" rid="pcbi.1002209-Gardner1">[47]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Kobayashi1">[48]</xref> consists of two proteins that repress each other's expression (<xref ref-type="fig" rid="pcbi-1002209-g004">Figure 4A</xref>). Its reaction kinetics can be described by a highly simplified model consisting of two differential equations (Eqs. 20 and 21, Methods). These equations can then be used to construct the CME model (Eq 22) to describe the corresponding stochastic dynamics (accounting for intrinsic noise only).</p>
          <fig id="pcbi-1002209-g004" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002209.g004</object-id>
            <label>Figure 4</label>
            <caption>
              <title>Calculating steady-state distributions for a toggle switch.</title>
              <p>(A) Circuit diagram. (B) The probability distribution, based only on intrinsic noise, for parameters <italic>K<sub>u</sub></italic> = <italic>K<sub>v</sub></italic> = 1, <italic>r<sub>u</sub></italic> = <italic>r<sub>v</sub></italic> = 10, β = γ = 2, <italic>d<sub>u</sub></italic> = <italic>d<sub>v</sub></italic> = 1. This was calculated by solving the CME directly. U and V are expressed in molecule numbers for each distribution. (C) The same distribution except with extrinsic noise added (σ<sub>1</sub> = σ<sub>2</sub> = 2); peak spreading is evident. (D) The intrinsic-noise-only distribution except with <italic>r<sub>u</sub></italic> = <italic>r<sub>v</sub></italic> = 1000; calculated using scaling; peak focusing is evident. (E) A sample (10000 points) from this distribution (intrinsic noise only), using modified Gibbs sampling using the same parameters as in (B). (F) Another 10,000-point sample, generated the same way except with extrinsic noise (σ<sub>1</sub> = σ<sub>2</sub> = 1).</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.g004" xlink:type="simple"/>
          </fig>
          <p>The system is bistable given appropriate parameter values, leading to a bimodal distribution by directly solving the CME (<xref ref-type="fig" rid="pcbi-1002209-g004">Figure 4B</xref>). Addition of extrinsic noise by convolution widens the peaks (<xref ref-type="fig" rid="pcbi-1002209-g004">Figure 4C</xref>), while increasing molecule numbers (and therefore, necessarily relying on scaling of the CME to solve it) narrows them (<xref ref-type="fig" rid="pcbi-1002209-g004">Figure 4D</xref>).</p>
          <p>With this system, we also compared MGS with the exact solution of the CME. The MGS overall matches direct CME solution very well (compare <xref ref-type="fig" rid="pcbi-1002209-g004">Figure 4E and 4B</xref>); <xref ref-type="table" rid="pcbi-1002209-t001">Table 1</xref> shows a quantitative comparison. Using parameter set 1, the probability distribution obtained by directly solving the CME and two approximations based on 10,000 points each from MGS were compared using the sums of squared deviations, which were 0.0095 and 0.011 respectively. For comparison, the two approximations had a sum of squared deviations of 0.0004, and the maximum possible sum of squared deviations is 2. Overall, MGS effectively approximates the true solution of the CME with greatly reduced computational cost.</p>
          <table-wrap id="pcbi-1002209-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002209.t001</object-id><label>Table 1</label><caption>
              <title>Comparison of MGS and direct CME solution for the toggle switch.</title>
            </caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1002209-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.t001" xlink:type="simple"/><table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" colspan="1" rowspan="1">Parameter set</td>
                  <td align="left" colspan="1" rowspan="1">Species</td>
                  <td align="left" colspan="1" rowspan="1">Mean (direct)</td>
                  <td align="left" colspan="1" rowspan="1">Mean (MGS)</td>
                  <td align="left" colspan="1" rowspan="1">St. dev. (direct)</td>
                  <td align="left" colspan="1" rowspan="1">St. dev. (MGS)</td>
                  <td align="left" colspan="1" rowspan="1">ON% (direct)</td>
                  <td align="left" colspan="1" rowspan="1">ON% (MGS)</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">U</td>
                  <td align="left" colspan="1" rowspan="1">6.4314</td>
                  <td align="left" colspan="1" rowspan="1">4.0084</td>
                  <td align="left" colspan="1" rowspan="1">5.0680</td>
                  <td align="left" colspan="1" rowspan="1">4.0241</td>
                  <td align="left" colspan="1" rowspan="1">69%</td>
                  <td align="left" colspan="1" rowspan="1">55%</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">1</td>
                  <td align="left" colspan="1" rowspan="1">V</td>
                  <td align="left" colspan="1" rowspan="1">2.6319</td>
                  <td align="left" colspan="1" rowspan="1">3.0232</td>
                  <td align="left" colspan="1" rowspan="1">4.1081</td>
                  <td align="left" colspan="1" rowspan="1">3.5994</td>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">U</td>
                  <td align="left" colspan="1" rowspan="1">3.3446</td>
                  <td align="left" colspan="1" rowspan="1">3.7456</td>
                  <td align="left" colspan="1" rowspan="1">2.5215</td>
                  <td align="left" colspan="1" rowspan="1">2.6332</td>
                  <td align="left" colspan="1" rowspan="1">70%</td>
                  <td align="left" colspan="1" rowspan="1">77%</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">V</td>
                  <td align="left" colspan="1" rowspan="1">1.3271</td>
                  <td align="left" colspan="1" rowspan="1">1.0201</td>
                  <td align="left" colspan="1" rowspan="1">1.8958</td>
                  <td align="left" colspan="1" rowspan="1">1.5593</td>
                  <td align="left" colspan="1" rowspan="1"/>
                  <td align="left" colspan="1" rowspan="1"/>
                </tr>
              </tbody>
            </table></alternatives><table-wrap-foot>
              <fn id="nt101">
                <label/>
                <p>Parameter set 1 is: <italic>K<sub>u</sub></italic> = <italic>K<sub>v</sub></italic> = 1, <italic>r<sub>u</sub></italic> = 10, <italic>r<sub>v</sub></italic> = 9, β = γ = 2, <italic>d<sub>u</sub></italic> = <italic>d<sub>v</sub></italic> = 1; parameter set 2 differs in that <italic>r<sub>u</sub></italic> = <italic>r<sub>v</sub></italic> = 5 and β = 1.</p>
              </fn>
            </table-wrap-foot></table-wrap>
          <p>Addition of extrinsic noise is very quick using the convolution method, since the noise is simply added to the final samples, and the results are similar to those obtained by solving the CME directly (<xref ref-type="fig" rid="pcbi-1002209-g004">Figure 4F</xref>). Note that the effectiveness of Gibbs sampling is in spite of the violation of detailed balance for this system. The appropriateness of the detailed balance approximation may be evaluated by comparing the actual ratios of probabilities for different states to the probabilities assumed by the detailed-balance approximation (Eq. 9). For the parameter set used in <xref ref-type="fig" rid="pcbi-1002209-g004">Figure 4E</xref>, the average relative error of the detailed-balance approximation, weighted by probability, is 0.58 for protein V and 0.25 for protein U.</p>
          <p>To illustrate the use of our modeling framework to the analysis of experimental data (<xref ref-type="fig" rid="pcbi-1002209-g005">Figure 5A</xref>), we experimentally measured the switching dynamics using the toggle switch implemented by Kobayashi et al. <xref ref-type="bibr" rid="pcbi.1002209-Kobayashi1">[48]</xref>, in response to varying concentrations of the antibiotic norfloxacin (NFX). NFX causes an SOS response, which induces GFP by increasing degradation of its repressor (an additional term is added to the degradation rate constant for the repressor; see <xref ref-type="sec" rid="s4">Methods</xref> for modeling details). The method described above for predicting distributions based on known parameters can be applied to this data, generating reasonable parameter sets for the perturbation. In particular, the model accurately predicted the variation of ON fractions of the population with the concentration of antibiotic (<xref ref-type="fig" rid="pcbi-1002209-g005">Figure 5B</xref>). Parameter sets were obtained by nonlinear fitting. Random searches of parameter space, as well as previous work with similar circuits, were used in the production of initial estimates. In general, the fitting process began with estimation of reaction parameters based on the modes of distributions observed and on previous studies, followed by refinement of these parameters and estimation of others based on nonlinear fitting of the distributions. Notably, the parameter set chosen yields a distribution dominated by unexpectedly low molecule numbers, but an adequate fit was not obtained with higher molecule numbers. The obtained parameter set was <italic>K<sub>u</sub></italic> = 2.22, <italic>K<sub>v</sub></italic> = 13.69, <italic>r<sub>u</sub></italic> = 1306.4, <italic>r<sub>v</sub></italic> = 35.06, <italic>β</italic> = 5.36, <italic>γ</italic> = 1, <italic>d<sub>u</sub></italic> = 79.84, <italic>d<sub>v0</sub></italic> = 0.42, <italic>d<sub>v1</sub></italic> = 1.61, <italic>k<sub>A</sub></italic> = 36.70, σ<sub>1</sub> = 1, and σ<sub>2</sub> = 1 (see Eqs. 20–23 for parameter definitions; σ<sub>1</sub> and σ<sub>2</sub> are standard deviations of shift distributions for proteins U and V respectively). The shapes of the predicted distributions deviated somewhat from the data but were improved by using different levels of extrinsic noise for the two peaks (<xref ref-type="fig" rid="pcbi-1002209-g005">Figure 5 C,D</xref>). The plots show the distributions for 250 ng/mL NFX; the predicted distribution in <xref ref-type="fig" rid="pcbi-1002209-g005">Figure 5D</xref> uses σ = 10<sup>−5</sup> for the ON peak and σ = 1.4 for the OFF peak, where σ is the standard deviation of the Gaussian distribution describing extrinsic noise (see Eq. 16). The peak is also shifted to account for background fluorescence or synthesis: peaks in the experimental distribution are shifted away from zero.</p>
          <fig id="pcbi-1002209-g005" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002209.g005</object-id>
            <label>Figure 5</label>
            <caption>
              <title>Toggle switch: comparison with experiments.</title>
              <p>(A) A typical workflow for analyzing experimental data based on the framework for noise calculations presented in this study. Modes of the distribution(s) are determined and used with the deterministic model to estimate some reaction parameters (i.e. intrinsic noise parameters); prior knowledge may also be included in these estimates. Then, using the calculation methods (e.g. convolution for extrinsic noise) presented here, one can obtain a best fit for the full parameter set, which describes both intrinsic and extrinsic noise. (B) Theoretical (blue) and experimental (green) fraction of ON cells as a function of [NFX]. Inset shows the perturbation to the circuit. (C) Experimental distribution of GFP fluorescence in cells with 250 ng/mL NFX. (D) Predicted distribution of U molecule numbers (proportional to fluorescence) with 250 ng/mL NFX. Note that the distribution in (C) is used in (A) to illustrate the general computational procedure.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.g005" xlink:type="simple"/>
          </fig>
          <p>Results of the fitting indicate that a parameter set of this size is sufficient to describe some properties of the distribution (e.g. dependence of the fraction of ON cells on the circuit induction level). However, good fits of entire distributions, which have many more degrees of freedom, are not possible based on the mechanistic models described and on a simple form for extrinsic noise. The discrepancy likely results from the simplicity of the underlying model that generates the intrinsic variability, or the simplicity of the form of assumed extrinsic noise. In theory, any distribution can be fit to the intrinsic noise model if no constraints are imposed on the extrinsic noise distribution, but such a fit would yield no mechanistic insight without alternative methods to interpret the resulting extrinsic noise term. In principle, however, the computational framework proposed here can be used as an effective approach for comparing different mechanistic models for a given set of data. This aspect will require further in-depth analysis.</p>
        </sec>
        <sec id="s2c3">
          <title>A growth-modulating positive feedback circuit</title>
          <p>This circuit consists of a T7 RNA polymerase (T7 RNAP) activating its own transcription <xref ref-type="bibr" rid="pcbi.1002209-Tan2">[49]</xref>. It provides a useful example for analyzing a unique mode of regulation of circuit dynamics: in addition to the positive feedback, expression of T7 RNAP slows growth, and growth causes dilution of the T7 RNAP (<xref ref-type="fig" rid="pcbi-1002209-g006">Figure 6A</xref>). As with the toggle switch, the CME model (Eq 27) predicts a bimodal distribution would result for appropriate parameters (<xref ref-type="fig" rid="pcbi-1002209-g006">Figure 6B,C</xref>). This distribution is based on a constant growth rate (i.e. log-phase growth): the bimodality requires constant growth, in which the growth rate and protein synthesis rate are inversely related. In the absence of growth (e.g. during stationary phase), the system would in theory approach a single, non-trivial steady state that would result in a monomodal distribution. In an appropriate time window like exponential growth phase, however, the bimodal distribution can be considered as approximately at steady state (if needed, it can be perpetuated by periodic dilution of the culture). In other words, this reaction can only reach a true steady state if the amount of medium is increasing proportionally to the bacterial growth, allowing perpetual log-phase growth, but a “pseudo-steady-state” corresponding to the limit of slow change in growth rate compared to chemical reactions is possible and interesting. This might, for example, be relevant when there is a large supply of nutrients. These states are the same on a cellular level and are modeled here.</p>
          <fig id="pcbi-1002209-g006" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002209.g006</object-id>
            <label>Figure 6</label>
            <caption>
              <title>T7 RNAP circuit.</title>
              <p>(A) T7 RNAP enhances its own transcription. In addition, T7 RNAP expression slows down cell growth, which dilutes T7 RNAP. (B) Probability distribution with <italic>M</italic> = 10, <italic>k</italic><sub>0</sub> = 0.001, <italic>k<sub>f</sub></italic> = 0.01, <italic>k<sub>b</sub></italic> = 0.1, <italic>k</italic><sub>1</sub> = 0.01, <italic>d<sub>x0</sub></italic> = 0.003, μ = 0.01, and θ = 1; shown with (green) and without (blue) extrinsic noise (σ = 3). (C) Comparison of experiment and modeling on the perturbations to growth and T7 RNAP synthesis rates. Contours denote computed fractions of ON cells, by varying parameters <italic>k</italic><sub>1</sub> and μ. X's denote experimental data points with experimental parameters (IPTG concentration and OD) as labeled; the <italic>k</italic><sub>1</sub> and μ values for each data point were determined by fitting the fractions of ON cells.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.g006" xlink:type="simple"/>
          </fig>
          <p>According to this premise, we previously used a Gillespie algorithm to predict how the approximately steady-state distribution would be modulated by inoculum size of the bacteria, which would essentially affect the effective growth rate of the population: the larger the inoculum, the smaller the effective growth rate. The previous modeling predicted that the fraction of ON cells at the final data point would increase with the inoculum size (as controlled by the initial cell density, measured by optical density (OD)) or the circuit induction level (controlled by the concentration of IPTG). This prediction was indeed consistent with experimental measurements.</p>
          <p>In this study, we re-evaluated these data using methods presented here. We treated the distributions of the final data point as being at a pseudo-steady state. We varied parameters to match the perturbations in ON (high-T7 RNAP) and OFF (low-T7 RNAP) populations seen in experiments (<xref ref-type="fig" rid="pcbi-1002209-g006">Figure 6C</xref>). As for the toggle switch, initial guesses were obtained with the aid of random searching of parameter space, and nonlinear fitting was used to obtain the final parameter set. The base case of bacterial culture with an initial OD of 0.23 and 1000 µM IPTG exhibited 94% ON cells; this matched a parameter set of <italic>k<sub>0</sub></italic> = 0.0011, <italic>k<sub>f</sub></italic> = 0.01, <italic>k<sub>b</sub></italic> = 0.11, <italic>k</italic><sub>1</sub> = 0.0087, <italic>d<sub>x</sub></italic><sub>0</sub> = 0.003, μ = 0.007, and θ = 1 (see Eq. 24, 27). An experiment with the same IPTG level but an initial OD of 0.15, which would result in overall faster growth, exhibited 48% ON cells. We further performed a model fit to determine the decrease in growth rate corresponding to this shift to the OFF population, and the new growth rate was found to be μ = 0.013 (all other parameters were kept the same). Another experiment used OD = 0.23 but provided only 100 µM IPTG, resulting in 49% ON cells. This was modeled as a proportional decrease in <italic>k</italic><sub>0</sub> and <italic>k</italic><sub>1</sub>, which, by fitting, was a 26% decrease in each of these parameters, giving <italic>k</italic><sub>0</sub> = 0.0008, <italic>k</italic><sub>1</sub> = 0.0065, and other parameters as in the base case. For all numerical analysis, we assumed that the number of promoters to be ten.</p>
          <p>Again, here we find that aspects of the experimental data can be readily fitted to the simple model. However, an apparent caveat is that the distributions that we fitted were not genuinely at steady state. Furthermore, similar issues as in the case for the toggle switch also apply, which include the simplicity of the mechanistic model and that in the specific form of the extrinsic noise distribution.</p>
        </sec>
        <sec id="s2c4">
          <title>Myc/Rb/E2F network</title>
          <p>To illustrate general applicability of our computational framework, we applied it the Myc/Rb/E2F network, which we have analyzed extensively in recent studies (<xref ref-type="fig" rid="pcbi-1002209-g007">Figure 7A</xref>) <xref ref-type="bibr" rid="pcbi.1002209-Yao1">[50]</xref>. This network plays a critical role in regulating cell cycle progression and cell-fate decisions <xref ref-type="bibr" rid="pcbi.1002209-Yao1">[50]</xref>. Here we focus on analyzing the bistable E2F response to serum stimulation <xref ref-type="bibr" rid="pcbi.1002209-Yao1">[50]</xref>. To evaluate the methods described here, we use a well-established stochastic model that we recently developed <xref ref-type="bibr" rid="pcbi.1002209-Lee1">[51]</xref>. The stochastic model consists of a set of stochastic differential equations in the general form of Eq. 28 <xref ref-type="bibr" rid="pcbi.1002209-Lee1">[51]</xref>, <xref ref-type="bibr" rid="pcbi.1002209-Gillespie2">[52]</xref>, where extrinsic noise can be introduced as an additive term. When this term is set to 0, the model will generate fluctuations due to intrinsic noise only. These stochastic dynamics can also be fully described by the corresponding CME model (Eq. 29).</p>
          <fig id="pcbi-1002209-g007" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002209.g007</object-id>
            <label>Figure 7</label>
            <caption>
              <title>Myc/Rb/E2F network.</title>
              <p>(A) A network diagram of Myc/Rb/E2F at the G1-S cell cycle checkpoint. (B) Comparison of the MGS predicted probability distribution (red) and the SDEs predicted distribution (green) of selected molecular species of the repressed and the activated state of the network. The solid lines represent Gaussian distributions fitted over all random samples corresponding to each method. (C) Convolution of extrinsic noise and combination of the repressed and the activated modes based on empirical data derived from SDE simulations, with the variance of the shift distribution separately optimized. Shown in red are MGS predicted distributions and green are SDEs predicted distributions of E2F with either low or high level of extrinsic noise as defined in the SDE framework. The SDE model and the associated parameters are described in detail in Lee et al <xref ref-type="bibr" rid="pcbi.1002209-Lee1">[51]</xref>.</p>
            </caption>
            <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.g007" xlink:type="simple"/>
          </fig>
          <p>For this model, we note that <italic>ad hoc</italic> strategies can be employed to speed up the efficiency of Gibbs sampling. In particular, for the base model parameters, multiple rounds of numerical simulations using the SDE model, with either low or high initial E2F conditions and without the extrinsic noise term, predict a clear bimodal distribution in E2F, with the low mode (obtained with low initial E2F) corresponding to E2F in repressed state and the high mode (obtained with high initial E2F) corresponding to E2F being activated. In fact, the two stable states are so separated that stochastic transition between them by intrinsic noise alone is extremely rare (never observed during SDE simulations once the network settles in either state, data not shown). Therefore, we separately sample the repressed and the activated mode when applying the MGS. The locations of the different modes were estimated using the deterministic model <italic>a priori</italic>, with the same rate parameters.</p>
          <p>As shown in <xref ref-type="fig" rid="pcbi-1002209-g007">Figure 7B</xref>, the intrinsic-noise-only distributions of selected species of the Myc/Rb/E2F network (E2F, CYCD, and CYCE) generated by MGS (red) closely resemble those predicted by the SDE model (green). The sums of squared deviations between SDEs-predicted distributions and MGS-predicted distributions are shown besides each plot.</p>
          <p>Next, we incorporated an additive extrinsic noise into the SDEs (as described in <xref ref-type="bibr" rid="pcbi.1002209-Lee1">[51]</xref>) to simulate empirical stochastic system output, equivalent to experimental data one would expect. Again, we note that significant extrinsic noise is required for the transition between the repressed and the activated mode. As such, we performed the extrinsic noise convolution with the intrinsic noise only distribution separately for the repressed and the activated mode, each with its own best-fit variance of the shift distribution (here assumed to be Gaussian). The total probability of each mode is calculated from the ratio of durations the system resides within the distribution around the corresponding mode based on the empirical distributions (SDE simulation), assuming steady-state and ergodicity of the stochastic system with extrinsic noise. These total probabilities are then used to combine the two modes. The resemblance between the E2F distribution generated by the SDE model (green) and that by the extrinsic noise-convolved MGS (red) is evident in <xref ref-type="fig" rid="pcbi-1002209-g007">Figure 7C</xref> for two different levels of extrinsic noise (as defined for the SDEs in <xref ref-type="bibr" rid="pcbi.1002209-Lee1">[51]</xref>).</p>
        </sec>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>Two key challenges in stochastic modeling of cellular networks are computational efficiency in describing intrinsic noise and adequate description of extrinsic noise. This study provides a modular approach that makes such computations more tractable. To compute intrinsic variability, a range of approaches for predicting intrinsic noise, ranging from modified Gibbs sampling to scaled CME solution to direct CME solution in order of increasing accuracy and decreasing efficiency, is presented. Our methods provide an efficient alternative to previous time-stepping and analytical methods for modeling noise in cellular networks. These techniques can implement a model quite accurately for certain systems. However, the time-stepping method can require great computational cost, especially in its most accurate form (the Gillespie algorithm), and does not necessarily provide an accurate representation of extrinsic noise. The direct analytical approach is desirable because it accounts exactly for intrinsic noise, but it is only feasible for the simplest biological networks. In principle, our approximate methods are generally applicable to cellular networks with arbitrary complexity.</p>
      <p>Likewise, representation of extrinsic noise by convolution provides significant advantages both in its intuitive relationship to the final distribution and in its computational tractability (e.g. small number of parameters). Because extrinsic noise is a heterogeneous phenomenon with multiple sources, it is likely to have some components best modeled as variation in parameters and others best modeled in other ways. Applicability of each method can be evaluated by its ability to produce similar distributions to other methods, and more generally to account for different sources of noise. The convolution method, with its ability to mimic results from parameter perturbation methods, is useful in this regard. Also, we expect the convolution method to be highly flexible. Though it is developed in the context of analyzing steady-state distributions, it may also be applied to incorporate contributions of extrinsic noise into time-course simulations of stochastic network dynamics, for example by the Gillespie algorithm.</p>
      <p>The convolution method is also not constrained to the Gaussian form of the extrinsic noise distribution used here: if appropriate in a system, different extrinsic noise distributions with different numbers of parameters could be used. The Gaussian was used here because it was likely the best distribution with a manageably low number of parameters in these cases, but other distributions, such as mixture models, could provide more realistic final distributions at the expense of larger parameter sets. In theory, this pattern could be continued to the point of using an unconstrained function as the extrinsic noise distribution to exactly fit the observed final distribution; while, as noted above, this would compromise the mechanistic insight from the analysis, it may be useful in characterizing the system in other ways, especially if the reaction parameters are known from other measurements.</p>
      <p>Importantly, our study has defined a general, streamlined framework where one can derive unknown parameters from a distribution using fitting algorithms. For instance, our framework for extrinsic noise aids in obtaining initial estimates of reaction parameters based on the modes of the distribution, since these correspond well to the best-fit parameters. We have illustrated the basic concept of this approach through the analysis of two simple synthetic gene circuits as well as the feasibility of its application to a more complex cell cycle entry model. Due to the wide variety of perturbations that extrinsic noise can induce in all parameters and variables, however, we caution that apparent agreement with experiment could be seen for different models. To overcome this challenge, prior knowledge and alternative measurements are helpful for constraining the model, in terms of both reaction mechanisms and corresponding parameters. It is likely that this general framework is applicable for any biological network where a sufficiently mechanistic reaction mechanism is available. However, specific interpretations and applications of the fitted parameters, including those for the extrinsic noise distribution, will be context dependent. <italic>Ad hoc</italic> constraints and prior knowledge of the Markov chain describing the network dynamics, such as irreducibility, may sometimes be required, which usually demands no more mechanistic insights of the system than what's already required to carry out the actual sampling scheme.</p>
    </sec>
    <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <sec id="s4a">
        <title>Modeling a Toggle Switch</title>
        <p>The following model is adapted from that of Gardner and colleagues <xref ref-type="bibr" rid="pcbi.1002209-Gardner1">[47]</xref>. Let the two proteins be U and V with molecule numbers <italic>u</italic> and <italic>v</italic> respectively. Based on Hill kinetics for synthesis and linear kinetics for degradation, the system can be described as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e021" xlink:type="simple"/><label>(20)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e022" xlink:type="simple"/><label>(21)</label></disp-formula>A point in state space for this system is denoted (<italic>u</italic>, <italic>v</italic>). With appropriate parameters, the system can be bistable. In such a case, the deterministic steady states are at (<italic>u<sub>min</sub></italic>,<italic>v<sub>max</sub></italic>) and (<italic>u<sub>max</sub></italic>,<italic>v<sub>min</sub></italic>), where <italic>u<sub>min</sub></italic>&lt;<italic>u<sub>max</sub></italic> and <italic>v<sub>min</sub></italic>&lt;<italic>v<sub>max</sub></italic>. The number of states in this system that could potentially have nonnegligible probability is small enough that the CME at steady state can be solved analytically using linear algebra, provided the molecule numbers are small enough:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e023" xlink:type="simple"/><label>(22)</label></disp-formula>Scaling allows solutions for larger amounts of protein.</p>
        <p>The circuit can be induced by adding the antibiotic NFX.</p>
        <p>Adding antibiotic to induce protein U's high state involves initiating an SOS response, which degrades protein V <xref ref-type="bibr" rid="pcbi.1002209-Kobayashi1">[48]</xref>; thus it brings about the perturbation<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e024" xlink:type="simple"/><label>(23)</label></disp-formula>where <italic>d<sub>v0</sub></italic> is the basal degradation rate of V, <italic>d<sub>v0</sub></italic>+<italic>d<sub>v1</sub></italic> is its maximal degradation rate, <italic>A</italic> is the antibiotic concentration, and <italic>k<sub>A</sub></italic> is the half-maximal constant for the enhanced degradation.</p>
        <p>For experimental flow cytometry data, ON and OFF fractions of the data were determined by fitting the points to a mixture model consisting of two Gaussians using Mixmod 2.1.1. The theoretical data were partitioned based on which protein had a higher molecule number.</p>
      </sec>
      <sec id="s4b">
        <title>Modeling a Growth-Modulating Positive-Feedback Circuit</title>
        <p>Let <italic>n</italic> denote the number of T7 RNAP molecules in a given cell and let the cell have <italic>M</italic> promoters producing it, with <italic>m</italic> of them in an inactive state (O<sub>0</sub>) and <italic>M-m</italic> in an active state (O<sub>1</sub>). Tan <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002209-Tan2">[49]</xref> modeled this system using the Gillespie algorithm with six reactions. Five are normal chemical reactions: synthesis of a T7 RNAP molecule from O<sub>0</sub>, with propensity <italic>k<sub>0</sub> m</italic>, or from O<sub>1</sub>, with <italic>k<sub>1</sub>m</italic>; conversion of an O<sub>0</sub> and a T7 RNAP molecule to an O<sub>1</sub>, with propensity <italic>k<sub>f</sub>mn</italic>, or the reverse, with <italic>k<sub>b</sub>(M−m)</italic>; and degradation of T7 RNAP, with propensity <italic>d<sub>x0</sub>n</italic>. The sixth is cell division, which distributes the T7 RNAP molecules according to a binomial distribution and resets all the promoters to O<sub>0</sub>, and has propensity<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e025" xlink:type="simple"/><label>(24)</label></disp-formula>Where <italic>μ<sub>0</sub></italic> and <italic>θ</italic> are constants, <italic>C</italic> is the carrying capacity of the system, and <italic>N</italic> is the number of cells in it. When tracking molecule numbers in a single cell for purposes of determining steady state, one thus assumes, according to the binomial distribution, that cell division moves the molecule number from <italic>n′</italic> to <italic>n</italic> with probability<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e026" xlink:type="simple"/><label>(25)</label></disp-formula>For <italic>n′</italic>≥<italic>n</italic>.</p>
        <p>It is useful to apply a somewhat different definition of steady state for this system than in more typical reaction systems. If all the reactions are required to reach steady state, then the system must be at carrying capacity, and thus cell division can be eliminated from the analysis; this results in a monostable circuit. However, provided that the intracellular reactions are fast on the timescale of the growth curve, temporary quasi-steady states at other points along the growth curve, for example at log phase, can exhibit significant additional properties, including bistability; thus steady-state analysis at these times can replicate the features observed by the Gillespie algorithm. To do this, let<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e027" xlink:type="simple"/><label>(26)</label></disp-formula>be the effective growth rate, leading to the steady-state master equation<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e028" xlink:type="simple"/><label>(27)</label></disp-formula></p>
        <p>The network can be induced by IPTG, effectively increasing <italic>k<sub>0</sub></italic> and <italic>k<sub>1</sub></italic>. Different steady states can be investigated by examining the system at different OD levels; in each case <italic>N</italic>/<italic>C</italic> is estimated as the ratio of the current OD to the carrying-capacity OD.</p>
        <p>ON/OFF fractions for this network were found by identifying the two most prominent peaks in the histogram of the protein being monitored and then defining the bin in between those peaks with the lowest value as the border between ON and OFF. When peaks were found to blur together (a problem in the theoretical distributions), the point on a shoulder with the lowest derivative (approximated as a finite difference between points) was designated as the border between the main peak and the shoulder “peak.”</p>
      </sec>
      <sec id="s4c">
        <title>Characterization of the Toggle Switch Circuit</title>
        <p><italic>E. coli</italic>, JM2.300 was transformed with two plasmids, pTSMa and pCIRa <xref ref-type="bibr" rid="pcbi.1002209-Kobayashi1">[48]</xref>. The cells were cultured overnight at 37°C with 2 mM IPTG to ensure OFF state. The cells were then washed twice with fresh media, diluted 1000 fold, and cultured at 37°C. After three hours, cells were treated with various concentrations of NFX and further cultured at 37°C for 5 hours. Samples were then collected and subjected to flow cytometry analysis. LB medium was used throughout the experiment.</p>
      </sec>
      <sec id="s4d">
        <title>Characterization of the T7 RNAP* Circuit</title>
        <p>The construction and characterization of the T7 RNAP* positive feedback circuit were described by Tan <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1002209-Tan2">[49]</xref>. MC4100z1 cells (from Michael Elowitz) were used throughout the study.</p>
      </sec>
      <sec id="s4e">
        <title>Modeling Myc/Rb/E2F Network</title>
        <p>As an example to evaluate the feasibility of extending the proposed computational framework to a more complex model, we adopt a previously developed stochastic model for this network <xref ref-type="bibr" rid="pcbi.1002209-Lee1">[51]</xref>. It consists of a set of stochastic differential equations, which has the general form of<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e029" xlink:type="simple"/><label>(28)</label></disp-formula>where <italic>X<sub>i</sub></italic>(<italic>t</italic>) represents the number of molecules of a molecular species <italic>i</italic> (<italic>i = 1, …, N</italic>) at time <italic>t</italic>, and <bold>X</bold>(<italic>t</italic>) = (<italic>X<sub>1</sub></italic>(<italic>t</italic>), .., <italic>X<sub>N</sub></italic>(<italic>t</italic>)) is the state of the entire system at time <italic>t</italic>. <bold>X</bold>(<italic>t</italic>) evolves over time at the rate of <italic>a<sub>j</sub></italic>[<bold>X</bold>(<italic>t</italic>)] (<italic>j = 1, …, M</italic>), and the corresponding changes in the number of individual molecules are described in <italic>v<sub>ji</sub></italic>, Γ<italic><sub>j</sub></italic>(<italic>t</italic>) and ω<sub>i</sub>(<italic>t</italic>) are temporally uncorrelated, statistically independent Gaussian noises. Γ<italic><sub>j</sub></italic>(<italic>t</italic>) is the standard normal distribution with mean 0 and variance 1. ω<sub>i</sub>(<italic>t</italic>) tunes the level of empirical additive extrinsic noise <xref ref-type="bibr" rid="pcbi.1002209-Lee1">[51]</xref>.</p>
        <p>When ω<sub>i</sub>(<italic>t</italic>) is set to 0, the SDE simulation gives an approximation to the exact solution of the discrete stochastic chemical reaction system <xref ref-type="bibr" rid="pcbi.1002209-Gillespie2">[52]</xref>, against which the MGS distributions are compared. The inclusion of either low or high levels of extrinsic noise is realized by setting ω<sub>i</sub>(<italic>t</italic>) to 15 or 50, respectively. Based on the reactions involved in this system <xref ref-type="bibr" rid="pcbi.1002209-Lee1">[51]</xref>, we can write down the following CME:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002209.e030" xlink:type="simple"/><label>(29)</label></disp-formula>where • represents the state of interest for the molecular species not specified, as in ([<italic>M</italic>], [<italic>E</italic>], [<italic>CD</italic>], [<italic>CE</italic>], [<italic>R</italic>], [<italic>RP</italic>], [<italic>RE</italic>]), which represent molecular number. Refer to Lee et al <xref ref-type="bibr" rid="pcbi.1002209-Lee1">[51]</xref> for detailed description of the reaction mechanism and the corresponding rate constants.</p>
      </sec>
    </sec>
  </body>
  <back>
    <ack>
      <p>We thank Jin Wang for helpful comments, and James Collins and Hideki Kobayashi for the toggle switch constructs.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002209-Kaern1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kaern</surname><given-names>M</given-names></name><name name-style="western"><surname>Elston</surname><given-names>TC</given-names></name><name name-style="western"><surname>Blake</surname><given-names>WJ</given-names></name><name name-style="western"><surname>Collins</surname><given-names>JJ</given-names></name></person-group>             <year>2005</year>             <article-title>Stochasticity in gene expression: from theories to phenotypes.</article-title>             <source>Nat Rev Genet</source>             <volume>6</volume>             <fpage>451</fpage>             <lpage>464</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Rao1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Rao</surname><given-names>CV</given-names></name><name name-style="western"><surname>Wolf</surname><given-names>DM</given-names></name><name name-style="western"><surname>Arkin</surname><given-names>AP</given-names></name></person-group>             <year>2002</year>             <article-title>Control, exploitation and tolerance of intracellular noise.</article-title>             <source>Nature</source>             <volume>420</volume>             <fpage>231</fpage>             <lpage>237</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Tan1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tan</surname><given-names>RZ</given-names></name><name name-style="western"><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group>             <year>2010</year>             <article-title>Transcript counting in single cells reveals dynamics of rDNA transcription.</article-title>             <source>Mol Syst Biol</source>             <volume>6</volume>             <fpage>358</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Pedraza1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Pedraza</surname><given-names>JM</given-names></name><name name-style="western"><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group>             <year>2005</year>             <article-title>Noise propagation in gene networks.</article-title>             <source>Science</source>             <volume>307</volume>             <fpage>1965</fpage>             <lpage>1969</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Hooshangi1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hooshangi</surname><given-names>S</given-names></name><name name-style="western"><surname>Thiberge</surname><given-names>S</given-names></name><name name-style="western"><surname>Weiss</surname><given-names>R</given-names></name></person-group>             <year>2005</year>             <article-title>Ultrasensitivity and noise propagation in a synthetic transcriptional cascade.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>102</volume>             <fpage>3581</fpage>             <lpage>3586</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Acar1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Acar</surname><given-names>M</given-names></name><name name-style="western"><surname>Mettetal</surname><given-names>JT</given-names></name><name name-style="western"><surname>van Oudenaarden</surname><given-names>A</given-names></name></person-group>             <year>2008</year>             <article-title>Stochastic switching as a survival strategy in fluctuating environments.</article-title>             <source>Nat Genet</source>             <volume>40</volume>             <fpage>471</fpage>             <lpage>475</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Caatay1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cağatay</surname><given-names>T</given-names></name><name name-style="western"><surname>Turcotte</surname><given-names>M</given-names></name><name name-style="western"><surname>Elowitz</surname><given-names>M</given-names></name><name name-style="western"><surname>Garcia-Ojalvo</surname><given-names>J</given-names></name><name name-style="western"><surname>Süel</surname><given-names>G</given-names></name></person-group>             <year>2009</year>             <article-title>Architecture-dependent noise discriminates functionally analogous differentiation circuits.</article-title>             <source>Cell</source>             <volume>139</volume>             <fpage>512</fpage>             <lpage>522</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Kalmar1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kalmar</surname><given-names>T</given-names></name><name name-style="western"><surname>Lim</surname><given-names>C</given-names></name><name name-style="western"><surname>Hayward</surname><given-names>P</given-names></name><name name-style="western"><surname>Muñoz-Descalzo</surname><given-names>S</given-names></name><name name-style="western"><surname>Nichols</surname><given-names>J</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Regulated fluctuations in nanog expression mediate cell fate decisions in embryonic stem cells.</article-title>             <source>PLoS Biol</source>             <volume>7</volume>             <fpage>e1000149</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Fraser1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fraser</surname><given-names>D</given-names></name><name name-style="western"><surname>Kærn</surname><given-names>M</given-names></name></person-group>             <year>2009</year>             <article-title>A chance at survival: gene expression noise and phenotypic diversification strategies.</article-title>             <source>Mol Microbiol</source>             <volume>71</volume>             <fpage>1333</fpage>             <lpage>1340</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Blake1">
        <label>10</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Blake</surname><given-names>WJ</given-names></name><name name-style="western"><surname>Balázsi</surname><given-names>G</given-names></name><name name-style="western"><surname>Kohanski</surname><given-names>MA</given-names></name><name name-style="western"><surname>Isaacs</surname><given-names>FJ</given-names></name><name name-style="western"><surname>Murphy</surname><given-names>KF</given-names></name><etal/></person-group>             <year>2006</year>             <article-title>Phenotypic consequences of promoter-mediated transcriptional noise.</article-title>             <source>Mol Cell</source>             <volume>24</volume>             <fpage>853</fpage>             <lpage>865</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Schultz1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schultz</surname><given-names>D</given-names></name><name name-style="western"><surname>Ben-Jacob</surname><given-names>E</given-names></name><name name-style="western"><surname>Onuchic</surname><given-names>JN</given-names></name><name name-style="western"><surname>Wolynes</surname><given-names>PG</given-names></name></person-group>             <year>2007</year>             <article-title>Molecular level stochastic model for competence cycles in <italic>Bacillus subtilis</italic>.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>104</volume>             <fpage>17582</fpage>             <lpage>17587</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Losick1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Losick</surname><given-names>R</given-names></name><name name-style="western"><surname>Desplan</surname><given-names>C</given-names></name></person-group>             <year>2008</year>             <article-title>Stochasticity and cell fate.</article-title>             <source>Science</source>             <volume>320</volume>             <fpage>65</fpage>             <lpage>68</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Schultz2">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Schultz</surname><given-names>D</given-names></name><name name-style="western"><surname>Wolynes</surname><given-names>PG</given-names></name><name name-style="western"><surname>Ben-Jacob</surname><given-names>E</given-names></name><name name-style="western"><surname>Onuchic</surname><given-names>JN</given-names></name></person-group>             <year>2009</year>             <article-title>Deciding fate in adverse times: sporulation and competence in <italic>Bacillus subtilis</italic>.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>106</volume>             <fpage>21027</fpage>             <lpage>21034</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Kittisopikul1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kittisopikul</surname><given-names>M</given-names></name><name name-style="western"><surname>Süel</surname><given-names>GM</given-names></name></person-group>             <year>2010</year>             <article-title>Biological role of noise encoded in a genetic network motif.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>107</volume>             <fpage>13300</fpage>             <lpage>13305</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-BenJacob1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ben-Jacob</surname><given-names>E</given-names></name><name name-style="western"><surname>Schultz</surname><given-names>D</given-names></name></person-group>             <year>2010</year>             <article-title>Bacteria determine fate by playing dice with controlled odds.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>107</volume>             <fpage>13197</fpage>             <lpage>13198</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Cox1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cox</surname><given-names>CD</given-names></name><name name-style="western"><surname>McCollum</surname><given-names>JM</given-names></name><name name-style="western"><surname>Allen</surname><given-names>MS</given-names></name><name name-style="western"><surname>Dar</surname><given-names>RD</given-names></name><name name-style="western"><surname>Simpson</surname><given-names>ML</given-names></name></person-group>             <year>2008</year>             <article-title>Using noise to probe and characterize gene circuits.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105</volume>             <fpage>10809</fpage>             <lpage>10814</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Dunlop1">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Dunlop</surname><given-names>MJ</given-names></name><name name-style="western"><surname>Cox</surname><given-names>RS</given-names></name><name name-style="western"><surname>Levine</surname><given-names>JH</given-names></name><name name-style="western"><surname>Murray</surname><given-names>RM</given-names></name><name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name></person-group>             <year>2008</year>             <article-title>Regulatory activity revealed by dynamic correlations in gene expression noise.</article-title>             <source>Nat Genet</source>             <volume>40</volume>             <fpage>1493</fpage>             <lpage>1498</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Warmflash1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Warmflash</surname><given-names>A</given-names></name><name name-style="western"><surname>Dinner</surname><given-names>AR</given-names></name></person-group>             <year>2008</year>             <article-title>Signatures of combinatorial regulation in intrinsic biological noise.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>106</volume>             <fpage>17262</fpage>             <lpage>17267</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Munsky1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Munsky</surname><given-names>B</given-names></name><name name-style="western"><surname>Trinh</surname><given-names>B</given-names></name><name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name></person-group>             <year>2009</year>             <article-title>Listening to the noise: random fluctuations reveal gene network parameters.</article-title>             <source>Mol Syst Biol</source>             <volume>5</volume>             <fpage>318</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Gillespie1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name></person-group>             <year>1977</year>             <article-title>Exact stochastic simulation of coupled chemical reactions.</article-title>             <source>J Phys Chem</source>             <volume>81</volume>             <fpage>2340</fpage>             <lpage>2361</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Arkin1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Arkin</surname><given-names>A</given-names></name><name name-style="western"><surname>Ross</surname><given-names>J</given-names></name><name name-style="western"><surname>McAdams</surname><given-names>HH</given-names></name></person-group>             <year>1998</year>             <article-title>Stochastic kinetic analysis of developmental pathway bifurcation in phage lambda-infected Escherichia coli cells.</article-title>             <source>Genetics</source>             <volume>149</volume>             <fpage>1633</fpage>             <lpage>1648</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-GarciaOjalvo1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Garcia-Ojalvo</surname><given-names>J</given-names></name><name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name><name name-style="western"><surname>Strogatz</surname><given-names>SH</given-names></name></person-group>             <year>2004</year>             <article-title>Modeling a synthetic multicellular clock: repressilators coupled by quorum sensing.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>101</volume>             <fpage>10955</fpage>             <lpage>10960</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Tanouchi1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tanouchi</surname><given-names>Y</given-names></name><name name-style="western"><surname>Tu</surname><given-names>D</given-names></name><name name-style="western"><surname>Kim</surname><given-names>J</given-names></name><name name-style="western"><surname>You</surname><given-names>L</given-names></name></person-group>             <year>2008</year>             <article-title>Noise reduction by diffusional dissipation in a minimal quorum sensing motif.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000167</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Warmflash2">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Warmflash</surname><given-names>A</given-names></name><name name-style="western"><surname>Bhimalapuram</surname><given-names>P</given-names></name><name name-style="western"><surname>Dinner</surname><given-names>AR</given-names></name></person-group>             <year>2007</year>             <article-title>Umbrella sampling for nonequilibrium processes.</article-title>             <source>J Chem Phys</source>             <volume>127</volume>             <fpage>154112</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Hemberg1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hemberg</surname><given-names>M</given-names></name><name name-style="western"><surname>Barahona</surname><given-names>M</given-names></name></person-group>             <year>2007</year>             <article-title>Perfect sampling of the master equation for gene regulatory networks.</article-title>             <source>Biophys J</source>             <volume>93</volume>             <fpage>401</fpage>             <lpage>410</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Elowitz1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name><name name-style="western"><surname>Levine</surname><given-names>AJ</given-names></name><name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name><name name-style="western"><surname>Swain</surname><given-names>PS</given-names></name></person-group>             <year>2002</year>             <article-title>Stochastic gene expression in a single cell.</article-title>             <source>Science</source>             <volume>297</volume>             <fpage>1183</fpage>             <lpage>1186</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Swain1">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Swain</surname><given-names>PS</given-names></name><name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name><name name-style="western"><surname>Siggia</surname><given-names>ED</given-names></name></person-group>             <year>2002</year>             <article-title>Intrinsic and extrinsic contributions to stochasticity in gene expression.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>99</volume>             <fpage>12795</fpage>             <lpage>12800</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Samoilov1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Samoilov</surname><given-names>MS</given-names></name><name name-style="western"><surname>Arkin</surname><given-names>AP</given-names></name></person-group>             <year>2006</year>             <article-title>Deviant effects in molecular reaction pathways.</article-title>             <source>Nature Biotech</source>             <volume>24</volume>             <fpage>1235</fpage>             <lpage>1240</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Raser1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Raser</surname><given-names>JM</given-names></name><name name-style="western"><surname>O'Shea</surname><given-names>EK</given-names></name></person-group>             <year>2004</year>             <article-title>Control of stochasticity in eukaryotic gene expression.</article-title>             <source>Science</source>             <volume>304</volume>             <fpage>1811</fpage>             <lpage>1814</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Friedman1">
        <label>30</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name><name name-style="western"><surname>Cai</surname><given-names>L</given-names></name><name name-style="western"><surname>Xie</surname><given-names>XS</given-names></name></person-group>             <year>2006</year>             <article-title>Linking stochastic dynamics to population distribution: an analytical framework of gene expression.</article-title>             <source>Phys Rev Lett</source>             <volume>97</volume>             <fpage>168302</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Fournier1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fournier</surname><given-names>T</given-names></name><name name-style="western"><surname>Gabriel</surname><given-names>J-P</given-names></name><name name-style="western"><surname>Pasquier</surname><given-names>J</given-names></name><name name-style="western"><surname>Mazza</surname><given-names>C</given-names></name><name name-style="western"><surname>Galbete</surname><given-names>J</given-names></name><etal/></person-group>             <year>2009</year>             <article-title>Stochastic models and numerical algorithms for a class of regulatory gene networks.</article-title>             <source>Bull Math Biol</source>             <volume>71</volume>             <fpage>1394</fpage>             <lpage>1431</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Walczak1">
        <label>32</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Walczak</surname><given-names>AM</given-names></name><name name-style="western"><surname>Mugler</surname><given-names>A</given-names></name><name name-style="western"><surname>Wiggins</surname><given-names>CH</given-names></name></person-group>             <year>2009</year>             <article-title>A stochastic spectral analysis of transcriptional regulatory cascades.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>106</volume>             <fpage>6529</fpage>             <lpage>6534</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Kim1">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kim</surname><given-names>KY</given-names></name><name name-style="western"><surname>Wang</surname><given-names>J</given-names></name></person-group>             <year>2007</year>             <article-title>Potential energy landscape and robustness of a gene regulatory network: toggle switch.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e60</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Cao1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name><name name-style="western"><surname>Liang</surname><given-names>J</given-names></name></person-group>             <year>2008</year>             <article-title>Optimal enumeration of state space of finitely buffered stochastic molecular networks and exact computation of steady state landscape probability.</article-title>             <source>BMC Syst Biol</source>             <volume>2</volume>             <fpage>30</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Cao2">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name><name name-style="western"><surname>Lu</surname><given-names>H-M</given-names></name><name name-style="western"><surname>Liang</surname><given-names>J</given-names></name></person-group>             <year>2010</year>             <article-title>Probability landscape of heritable and robust epigenetic state of lysogeny in phage lambda.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>107</volume>             <fpage>18445</fpage>             <lpage>18450</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Munsky2">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Munsky</surname><given-names>B</given-names></name><name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name></person-group>             <year>2010</year>             <article-title>Identification from stochastic cell-to-cell variation: a genetic switch case.</article-title>             <source>IET Syst Biol</source>             <volume>4</volume>             <fpage>356</fpage>             <lpage>66</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Ao1">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ao</surname><given-names>P</given-names></name></person-group>             <year>2004</year>             <article-title>Potential in stochastic differential equations: novel construction.</article-title>             <source>J Phys A: Math Gen</source>             <volume>37</volume>             <fpage>L25</fpage>             <lpage>L30</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Wang1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wang</surname><given-names>J</given-names></name><name name-style="western"><surname>Xu</surname><given-names>L</given-names></name><name name-style="western"><surname>Wang</surname><given-names>E</given-names></name></person-group>             <year>2008</year>             <article-title>Potential landscape and flux framework of nonequilibrium networks: Robustness, dissipation, and coherence of biochemical oscillations.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105</volume>             <fpage>12271</fpage>             <lpage>12276</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Qian1">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Qian</surname><given-names>H</given-names></name><name name-style="western"><surname>Beard</surname><given-names>DA</given-names></name></person-group>             <year>2005</year>             <article-title>Thermodynamics of stoichiometric biochemical networks in living systems far from equilibrium.</article-title>             <source>Biophys Chem</source>             <volume>114</volume>             <fpage>213</fpage>             <lpage>220</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Shahrezaei1">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Shahrezaei</surname><given-names>V</given-names></name><name name-style="western"><surname>Ollivier</surname><given-names>JF</given-names></name><name name-style="western"><surname>Swain</surname><given-names>PS</given-names></name></person-group>             <year>2008</year>             <article-title>Colored extrinsic fluctuations and stochastic gene expression.</article-title>             <source>Mol Syst Biol</source>             <volume>4</volume>             <fpage>196</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Taniguchi1">
        <label>41</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Taniguchi</surname><given-names>Y</given-names></name><name name-style="western"><surname>Choi</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Li</surname><given-names>G-W</given-names></name><name name-style="western"><surname>Chen</surname><given-names>H</given-names></name><name name-style="western"><surname>Babu</surname><given-names>M</given-names></name><etal/></person-group>             <year>2010</year>             <article-title>Quantifying E. coli proteome and transcriptome with single-molecule sensitivity in single cells.</article-title>             <source>Science</source>             <volume>329</volume>             <fpage>533</fpage>             <lpage>538</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Geman1">
        <label>42</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Geman</surname><given-names>S</given-names></name><name name-style="western"><surname>Geman</surname><given-names>D</given-names></name></person-group>             <year>1984</year>             <article-title>Stochastic relaxation, Gibbs distributions, and the Bayesian restoration of images.</article-title>             <source>IEEE Trans Pattern Anal and Mach Intell</source>             <volume>PAMI-6</volume>             <fpage>721</fpage>             <lpage>741</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Casella1">
        <label>43</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Casella</surname><given-names>G</given-names></name><name name-style="western"><surname>George</surname><given-names>EI</given-names></name></person-group>             <year>1992</year>             <article-title>Explaining the Gibbs sampler.</article-title>             <source>Am Stat</source>             <volume>46</volume>             <fpage>167</fpage>             <lpage>174</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Zellner1">
        <label>44</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zellner</surname><given-names>A</given-names></name><name name-style="western"><surname>Min</surname><given-names>C-K</given-names></name></person-group>             <year>1995</year>             <article-title>Gibbs sampler convergence criteria.</article-title>             <source>J Am Stat Assoc</source>             <volume>90</volume>             <fpage>921</fpage>             <lpage>927</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Frigessi1">
        <label>45</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Frigessi</surname><given-names>A</given-names></name><name name-style="western"><surname>di Stefano</surname><given-names>P</given-names></name><name name-style="western"><surname>Hwang</surname><given-names>C-R</given-names></name><name name-style="western"><surname>Sheu</surname><given-names>S-J</given-names></name></person-group>             <year>1993</year>             <article-title>Convergence rates of the Gibbs sampler, the Metropolis algorithm and other single–site updating dynamics.</article-title>             <source>J R Stat Soc Series B Stat Methodol</source>             <volume>55</volume>             <fpage>205</fpage>             <lpage>219</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Jones1">
        <label>46</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Jones</surname><given-names>GL</given-names></name><name name-style="western"><surname>Hobert</surname><given-names>JP</given-names></name></person-group>             <year>2004</year>             <article-title>Sufficient burn-in for Gibbs samplers for a hierarchical random effects model.</article-title>             <source>Ann Stat</source>             <volume>32</volume>             <fpage>784</fpage>             <lpage>817</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Gardner1">
        <label>47</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gardner</surname><given-names>TS</given-names></name><name name-style="western"><surname>Cantor</surname><given-names>CR</given-names></name><name name-style="western"><surname>Collins</surname><given-names>JJ</given-names></name></person-group>             <year>2000</year>             <article-title>Construction of a genetic toggle switch in <italic>Escherichia coli</italic>.</article-title>             <source>Nature</source>             <volume>403</volume>             <fpage>339</fpage>             <lpage>342</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Kobayashi1">
        <label>48</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kobayashi</surname><given-names>H</given-names></name><name name-style="western"><surname>Kaern</surname><given-names>M</given-names></name><name name-style="western"><surname>Araki</surname><given-names>M</given-names></name><name name-style="western"><surname>Chung</surname><given-names>K</given-names></name><name name-style="western"><surname>Gardner</surname><given-names>TS</given-names></name><etal/></person-group>             <year>2004</year>             <article-title>Programmable cells: interfacing natural and engineered gene networks.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>101</volume>             <fpage>8414</fpage>             <lpage>8419</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Tan2">
        <label>49</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tan</surname><given-names>C</given-names></name><name name-style="western"><surname>Marguet</surname><given-names>P</given-names></name><name name-style="western"><surname>You</surname><given-names>L</given-names></name></person-group>             <year>2009</year>             <article-title>Emergent bistability by a growth-modulating positive feedback circuit.</article-title>             <source>Nat Chem Biol</source>             <volume>5</volume>             <fpage>842</fpage>             <lpage>848</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Yao1">
        <label>50</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Yao</surname><given-names>G</given-names></name><name name-style="western"><surname>Lee</surname><given-names>TJ</given-names></name><name name-style="western"><surname>Mori</surname><given-names>S</given-names></name><name name-style="western"><surname>Nevins</surname><given-names>JR</given-names></name><name name-style="western"><surname>You</surname><given-names>L</given-names></name></person-group>             <year>2008</year>             <article-title>A bistable Rb-E2F switch underlies the restriction point.</article-title>             <source>Nat Cell Biol</source>             <volume>10</volume>             <fpage>476</fpage>             <lpage>482</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Lee1">
        <label>51</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lee</surname><given-names>TJ</given-names></name><name name-style="western"><surname>Yao</surname><given-names>G</given-names></name><name name-style="western"><surname>Bennett</surname><given-names>DC</given-names></name><name name-style="western"><surname>Nevins</surname><given-names>JR</given-names></name><name name-style="western"><surname>You</surname><given-names>L</given-names></name></person-group>             <year>2010</year>             <article-title>Stochastic E2F activation and reconciliation of phenomenological cell-cycle models.</article-title>             <source>PLoS Biol</source>             <volume>8</volume>             <fpage>e1000488</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002209-Gillespie2">
        <label>52</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gillespie</surname><given-names>DT</given-names></name></person-group>             <year>2007</year>             <article-title>Stochastic simulation of chemical kinetics.</article-title>             <source>Annu Rev Phys Chem</source>             <volume>58</volume>             <fpage>35</fpage>             <lpage>55</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>