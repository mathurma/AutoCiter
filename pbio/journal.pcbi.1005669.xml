<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01486</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005669</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Neuroanatomy</subject><subj-group><subject>Neural pathways</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Neuroanatomy</subject><subj-group><subject>Neural pathways</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroanatomy</subject><subj-group><subject>Neural pathways</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kalman filter</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kalman filter</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Synaptic plasticity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Developmental neuroscience</subject><subj-group><subject>Synaptic plasticity</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Learning and executing goal-directed choices by internally generated sequences in spiking neural circuits</article-title>
<alt-title alt-title-type="running-head">Goal-directed choices by internally generated sequences</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Palmer</surname> <given-names>John</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7496-6746</contrib-id>
<name name-style="western">
<surname>Keane</surname> <given-names>Adam</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Gong</surname> <given-names>Pulin</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Physics, University of Sydney, Sydney, NSW, Australia</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Centre of Excellence for Integrative Brain Function, University of Sydney, Sydney, NSW, Australia</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Daunizeau</surname> <given-names>Jean</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Brain and Spine Institute (ICM), FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">pulin.gong@sydney.edu.au</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>7</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>31</day>
<month>7</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>7</issue>
<elocation-id>e1005669</elocation-id>
<history>
<date date-type="received">
<day>13</day>
<month>9</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>6</day>
<month>7</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Palmer et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005669"/>
<abstract>
<p>Recent neural ensemble recordings have established a link between goal-directed spatial decision making and internally generated neural sequences in the hippocampus of rats. To elucidate the synaptic mechanisms of these sequences underlying spatial decision making processes, we develop and investigate a spiking neural circuit model endowed with a combination of two synaptic plasticity mechanisms including spike-timing dependent plasticity (STDP) and synaptic scaling. In this model, the interplay of the combined synaptic plasticity mechanisms and network dynamics gives rise to neural sequences which propagate ahead of the animals’ decision point to reach goal locations. The dynamical properties of these forward-sweeping sequences and the rates of correct binary choices executed by these sequences are quantitatively consistent with experimental observations; this consistency, however, is lost in our model when only one of STDP or synaptic scaling is included. We further demonstrate that such sequence-based decision making in our network model can adaptively respond to time-varying and probabilistic associations of cues and goal locations, and that our model performs as well as an optimal Kalman filter model. Our results thus suggest that the combination of plasticity phenomena on different timescales provides a candidate mechanism for forming internally generated neural sequences and for implementing adaptive spatial decision making.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Adaptive goal-directed decision making is critical for animals, robots and humans to navigate through space. In this study, we propose a novel neural mechanism for implementing spatial decision making in cued-choice tasks. We show that in a spiking neural circuit model, the interplay of network dynamics and a combination of two synaptic plasticity rules, STDP and synaptic scaling, gives rise to neural sequences. When a model rat pauses around a decision point, these sequences propagate ahead of the animal’s current location and travel towards a goal location. The dynamical properties of these forward-sweeping sequences and the rate of correct responses made by them are consistent with experimental data. In addition, we demonstrate that STDP when complemented by slower synaptic scaling enables neural sequences to make adaptive choices under probabilistic and time-varying cue-goal associations. The adaptive performance of our sequence-based network is comparable to a mathematical model, namely the Kalman filter, which is optimal for this adaptive task. Our results thus shed new light on our understanding of neural mechanisms underlying goal-directed decision making.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000923</institution-id>
<institution>Australian Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>DP160104316 and DP160104368</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Palmer</surname> <given-names>John</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>PG was supported by Australian Research Council grants DP160104368 and CE114010000 (<ext-link ext-link-type="uri" xlink:href="http://www.arc.gov.au/" xlink:type="simple">http://www.arc.gov.au/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="23"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-08-10</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Neural sequences have been widely observed in many brain areas including the cortex [<xref ref-type="bibr" rid="pcbi.1005669.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref004">4</xref>], and the hippocampus [<xref ref-type="bibr" rid="pcbi.1005669.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref011">11</xref>]. Based on how sequences are initialized, they can be placed into two broad categories, namely externally and internally generated sequences [<xref ref-type="bibr" rid="pcbi.1005669.ref012">12</xref>]. Externally generated sequences (EGS) are those which directly reflect an ongoing behavioural sequence such as actions [<xref ref-type="bibr" rid="pcbi.1005669.ref013">13</xref>] or positions visited [<xref ref-type="bibr" rid="pcbi.1005669.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref014">14</xref>]; whilst internally generated sequences (IGS) arise either spontaneously or by being triggered by non-sequential external cues [<xref ref-type="bibr" rid="pcbi.1005669.ref012">12</xref>]. IGS have been argued to underlie predictions [<xref ref-type="bibr" rid="pcbi.1005669.ref015">15</xref>], goal-directed planning and decision making [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref017">17</xref>].</p>
<p>One area where IGS have been extensively examined is the rodent hippocampus during navigational tasks [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref015">15</xref>]. Most of these tasks follow a similar basic procedure; rodents are introduced to a maze and must navigate towards goal locations [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref015">15</xref>]. Recent experimental studies with multi-electrode array recordings have revealed that when the animals rest between goal-directed spatial navigation episodes, neural ensemble activity propagates forward towards potential goal locations [<xref ref-type="bibr" rid="pcbi.1005669.ref015">15</xref>]. Such recordings of rodents trained on spatial decision tasks have also found that when rodents paused around the decision point, forward sweeping IGS were formed [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>]. Reconstructed locations from these IGS were found predominately forward of the animal’s position, indicating that these IGS are related to representation of future paths rather than pinpointing the current location or being a replay of recent history. Furthermore, the IGS appears to be used for making a goal-related choice, as the path chosen by the animal through the T-maze was strongly correlated with the path reconstructed from the IGS. Despite the importance of IGS for goal-directed behaviours such as spatial decision making, the neural mechanism underlying the formation of these IGS and their general computational roles remain unclear.</p>
<p>To address these issues, we build a spiking neural circuit model endowed with a combination of STDP and synaptic scaling, and show that the model is able to reproduce the dynamical properties of IGS and the behavioural response of correct rates of binary choices as reported in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>]. As in previous modelling studies [<xref ref-type="bibr" rid="pcbi.1005669.ref019">19</xref>], STDP in our model can learn the paths taken by moving rodents. Synaptic scaling, however, can prevent a positive feedback loop caused by STDP, and provides a separation of temporal scales needed for adaptive choice under uncertainty. We show that STDP complemented with slower homeostatic synaptic scaling is necessary to account for the properties of forward sweeping IGS recorded in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], thus unravelling a mechanism for IGS propagation in the spatial decision making circuit.</p>
<p>To further study the general computational role of IGS in spatial decision making, we go beyond the deterministic association of cue and goal as used in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], considering cases where the association between cue and goal is stochastic and varies over time. For these cases, our results are primarily focused on correct decisions on a trial basis; we find that the correct choice made by the model based on IGS can effectively track the time-varying cue-goal association, and that this process can be described as a recursive probabilistic inference. We show that the performance of this inference process implemented by our spatial decision making neural circuit is comparable to that of a Kalman filter [<xref ref-type="bibr" rid="pcbi.1005669.ref020">20</xref>], which is optimal for the cases we consider. In our model, the interplay of spiking sequences and the combined synaptic plasticity rules lead to constant changes of synaptic strengths which are proportional to the probability of cue-goal association. These changes can serve as a posterior for test trials which can then be exploited by IGS to make a choice; the IGS, combined with plasticity mechanisms, are essential for implementing this optimal inference. Our model offers an explicit formal characterization of probabilistic inference involved in the IGS-forming spiking neural circuit, thus establishing a link between such an inference and spatial decision making [<xref ref-type="bibr" rid="pcbi.1005669.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref021">21</xref>].</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>T-maze spatial decision tasks</title>
<p>We begin by briefly describing the T-maze based decision task used in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], which we aim to reproduce in a spiking neural circuit. In this task, rats were made to run laps through a T-maze, augmented with return arms, as shown in <xref ref-type="fig" rid="pcbi.1005669.g001">Fig 1</xref>. When the rats approached the decision point of the T-maze (A in <xref ref-type="fig" rid="pcbi.1005669.g001">Fig 1</xref>), one of two sound cues was played. These two cues were differentiated by their frequencies, and provided information to the rats about the location of a reward within the T-maze. For example, when the low or high-frequency cues were applied, the reward was on the left or right arm of the T-maze, respectively. Training began with a directed pre-training phase, in which the rats were prevented from choosing the incorrect arm of the T-maze. Training then continued following a similar procedure, except that the rats were free to travel down the incorrect arm of the T-maze. The rate at which the rats correctly identified the rewarded arm corresponding to the applied cue was monitored during this second training phase, and the activity of neural ensembles from the CA3 region was recorded. Analysis of the neural activity revealed a transient, but repeatable, phenomenon: as a rat approached the decision point, the neural representation of the rat’s location swept forward, creating a sequence of neural activity. These sequences were coherent and preferentially swept ahead of the animal rather than behind, implying that they represented future choices rather than recently travelled paths [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref012">12</xref>].</p>
<fig id="pcbi.1005669.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005669.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schematic of the cued-choice task in a T-maze.</title>
<p>A rat starts at D and then travels towards the decision point, A. When it enters the region marked by the hatched rectangle, a sound cue is played. Depending on the frequency of the cue, the goal is located at either B or C, indicated with grey circles. The rat then returns to D, when the next trial starts. The decision modelled in our neural circuit occurs in the shaded rectangle.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005669.g001" xlink:type="simple"/>
</fig>
<p>We use a two-dimensional spiking neural circuit to reproduce the forward-sweeping sequences observed in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>]. In our model, we consider synaptic plasticity dynamics, which are determined by a combination of STDP and synaptic scaling. The external cues are applied by activating the cue neurons, which are randomly coupled to the other neurons in the two-dimensional network. For a full description of our neural circuit model, see <xref ref-type="sec" rid="sec010">Materials and methods</xref>. To investigate the neural mechanisms of forward-sweeping neural sequences and their functional roles in learning and implementing goal-directed choice, we apply the same task and training protocol as in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>].</p>
<p>During training, when a model rat moves along a T-maze, as in <xref ref-type="fig" rid="pcbi.1005669.g001">Fig 1</xref>, a localized activity pattern surrounding its position is initialized, corresponding to the behaviour of place fields in the hippocampus [<xref ref-type="bibr" rid="pcbi.1005669.ref022">22</xref>]. As the model rat approaches the decision point of the T-maze, one of a pair of cues is activated. The cue corresponding to the low-frequency sound signal is denoted by <italic>C</italic>1 and that for the high-frequency by <italic>C</italic>2, with <italic>C</italic>1 and <italic>C</italic>2 indicating that the goal is located on the left and right arm of the T-maze, respectively. As the model rat is restricted to move along the T-maze, we similarly restrict neurons from firing if their place fields are outside the T-maze.</p>
<p>For a training trial in our neural circuit model, as in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], one arm of the T-maze is blocked. This is implemented by fixing the potential of the neurons in one arm of the T-maze; this forces the EGS to travel down the non-blocked arm. For instance, when the cue <italic>C</italic>1 is applied, the right arm of the T-maze is blocked, i.e., the model rat can only take the left arm. On each training trial, the sequence reaches the goal location, i.e., the end of the arm. After each training trial, a test trial is run, in which neither arm of the T-maze is blocked. By running a test trial after each training trial, it is possible to monitor in detail the behaviour of the neural circuit during the training process. For a test trial, the cue is activated as the model rat approaches the decision point. Under this protocol, if a forward-sweep sequence is formed and then travels down the arm of the T-maze corresponding to the goal location associated with the applied cue, whilst not reaching the goal location associated with the other cue, a successful choice is made by the network. In our scheme, we do not model reward explicitly. <xref ref-type="fig" rid="pcbi.1005669.g002">Fig 2</xref> shows such a forward-sweeping sequence shortly after the activation of the cue <italic>C</italic>2; this sequence in not related to the sequential movement of the model rat, so it is an IGS [<xref ref-type="bibr" rid="pcbi.1005669.ref012">12</xref>]. Note that the EGS is similar to the IGS except that the EGS is achieved by forcing the sequence to travel along a specific path.</p>
<fig id="pcbi.1005669.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005669.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Forward-sweeping neural sequences at the decision point.</title>
<p>Each frame is 2 ms after the previous one during a test trial and shows a snapshot of the membrane potentials of the excitatory neurons from a region of the network near the intersection of the T-maze. These snapshots are taken from the network with synaptic scaling, although without synaptic scaling, similar behaviour is seen on successful trials, but the proportion of successful trials is reduced. Neurons are located at integer locations along both axes.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005669.g002" xlink:type="simple"/>
</fig>
<p>For the training trials, both STDP and synaptic scaling are enabled, whilst test trials are run with both synaptic rules disabled to prevent the test trials from affecting the training process. As in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], the number of trials with the goal on the left and right is equal; this is achieved by alternating between <italic>C</italic>1 and <italic>C</italic>2 on successive training trials.</p>
</sec>
<sec id="sec004">
<title>Goal directed choices executed by IGS</title>
<p>We now demonstrate that our model is able to reproduce forward-sweeping neural sequences as observed in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], and that such sequences can be used to make a correct choice of the goal location based on an external cue. In experimental studies, multiple animals were typically used to obtain average response rates [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref011">11</xref>]. In a similar way, we use multiple realizations of our neural circuit model and track average response rates during the training process. For each realization of the neural circuit, the connections between the cue neurons and the neurons with the 2D network and their coupling weights are randomly selected.</p>
<p>As shown in <xref ref-type="fig" rid="pcbi.1005669.g003">Fig 3</xref>, in our models, the proportion of correct responses increases rapidly during the initial period of the training process. It eventually saturates at a threshold which is close to, but less than 1, meaning that even after extensive training, the neural circuit does not always make a correct choice; in other words, the IGS does not always travel to the goal location associated with the cue. In experimental studies in which rats learn to navigate a maze under a similar training paradigm, the rate at which rats correctly identify the rewarded arm of a T-maze shows similar behaviour, with an initial low correct response rate which increases before saturating at a level slightly under 1 (see Figure 4 in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>]). There are three possible ways in which the neural circuit fails to makes a correct choice of the goal location. In the first failure type, the sequence fails to propagate down either arm of the T-maze; this failure occurs most commonly in the early trials because the model rat has not learned the environment, in particular the goal location. For the second failure type, there are sequences propagating down both arms of the T-maze simultaneously, indicating that the network has been unable to make a correct choice about the goal location; this failure mode only occurs rarely in our model. In [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], it was found that the place fields of cells involved in an IGS tended to belong to one arm or the other, and IGS which activated neurons corresponding to both arms was rare. Finally, the sequence may simply propagate along the wrong arm of the T-maze; in experimental studies this failure type has been reported and has been correlated with the animal choosing the non-rewarded arm of the T-maze [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>].</p>
<fig id="pcbi.1005669.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005669.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Proportion of correct choice versus trial number.</title>
<p>In this case, cue <italic>C</italic>2 is always applied as the test cue. The blue curve shows the proportion of correct choices for the spiking neural circuit model with both STDP and synaptic scaling, whilst the red curve shows the neural circuit model without synaptic scaling. The bars show the standard error of the mean. Initially, both models show similar behaviour, namely an initial proportion of correct choice rate which is very low. After continued training, the accuracy of the model without synaptic scaling then begins to decrease. This decrease is due to an increase in the proportion of neural circuits in which the propagating wave pattern splits and travels along both arms of the T-maze. This decrease in accuracy is not observed in the full model, which maintains accuracy even as training continues. The final success rate of 80% is similar to that observed in experimental studies (75% in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>]).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005669.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Formation mechanisms of IGS</title>
<p>We now consider how forward-sweeping IGS can emerge from the network and why they can generate correct responses as shown in Figs <xref ref-type="fig" rid="pcbi.1005669.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1005669.g003">3</xref>. To this end, we consider a simple case, in which a spiking sequence is evoked by a model rat moving along a straight line, as shown in <xref ref-type="fig" rid="pcbi.1005669.g004">Fig 4a</xref>; i.e. neurons <italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, …, <italic>y</italic><sub>7</sub> are activated sequentially. Without loss of generality, we use a representative neuron, <italic>y</italic><sub>4</sub>, to study the change of coupling strength to the other neurons due to the interplay between this evoked sequence and STDP. Later, we will discuss the effect of synaptic scaling. We let Δ<italic>t</italic><sub><italic>i</italic></sub> be the time between when neuron <italic>y</italic><sub><italic>i</italic></sub> spikes and when our reference neuron (<italic>y</italic><sub>4</sub>) spikes. Based on the propagation of the evoked spiking sequence, it is clear that Δ<italic>t</italic><sub>1</sub> &lt; Δ<italic>t</italic><sub>2</sub> &lt; Δ<italic>t</italic><sub>3</sub> &lt; Δ<italic>t</italic><sub>4</sub> = 0 &lt; Δ<italic>t</italic><sub>5</sub> &lt; Δ<italic>t</italic><sub>6</sub> &lt; Δ<italic>t</italic><sub>7</sub>. The change in coupling strengths, Δ<italic>W</italic><sub><italic>i</italic></sub>, from <italic>y</italic><sub>4</sub> to the other neurons can be calculated by using the STDP window function (see <xref ref-type="disp-formula" rid="pcbi.1005669.e051">Eq 22</xref> in <xref ref-type="sec" rid="sec010">Materials and methods</xref>):
<disp-formula id="pcbi.1005669.e001"><alternatives><graphic id="pcbi.1005669.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix">sgn</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>A</mml:mi> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mo>|</mml:mo> <mml:mo>Δ</mml:mo></mml:mrow> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>/</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where the sign function, sgn(<italic>x</italic>) = −1 if <italic>x</italic> &lt; 0, sgn(0) = 0 and sgn(<italic>x</italic>) = 1 if <italic>x</italic> &gt; 0. It follows that Δ<italic>W</italic><sub>5</sub> &gt; Δ<italic>W</italic><sub>6</sub> &gt; Δ<italic>W</italic><sub>7</sub> &gt; Δ<italic>W</italic><sub>4</sub> = 0 &gt; Δ<italic>W</italic><sub>1</sub> &gt; Δ<italic>W</italic><sub>2</sub> &gt; Δ<italic>W</italic><sub>3</sub>. In other words, connection strengths in the direction in which the model rat moves are increased while those in the reverse direction are decreased. Suppose then that this procedure is repeated many times, so that the path taken by the model rat is learned by the network: when neuron <italic>y</italic><sub>4</sub> is activated again, due to the directionality of the coupling strength changes, the membrane potential of neuron <italic>y</italic><sub>5</sub> will be greater than <italic>y</italic><sub>3</sub>, and so on.</p>
<fig id="pcbi.1005669.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005669.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Schematic illustration of the changes of coupling strengths caused by STDP.</title>
<p>Connection strengths from the black neuron to the neurons in blue are decreased, whilst those in red are increased. Color intensity is proportional to the magnitudes of the changes in coupling strengths. Thick arrows show the path of a neural sequence, and thin grey arrows show the connections of interest. (a) The effect of propagation of a sequence and STDP on recurrent connections. Connections in the direction of propagation of the sequence are increased, whilst those in the reverse direction are decreased. (b) The effect of training in the T-maze on recurrent connections in the T-maze. Connection strengths from the center stem to neurons along the left and right arm are increased equally due to the symmetry in the training process which has an equal number of training trials along each arm of the T-maze. (c) The effect of STDP on the connections from the external cue neuron <italic>C</italic>2 to the other neurons in the spiking neural circuit. The cue is activated when the sequence is located at neuron <italic>y</italic><sub>4</sub>. The behaviour is similar to (b); however, only connection strengths along one path are increased, breaking the symmetry in connection strengths as shown in (b).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005669.g004" xlink:type="simple"/>
</fig>
<p>Now, consider a group of neurons arranged as in the decision making task shown in Figs <xref ref-type="fig" rid="pcbi.1005669.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1005669.g004">4b</xref>: neurons <italic>y</italic><sub>1</sub>, …, <italic>y</italic><sub>4</sub> are placed along the center stem of the T-maze, while neurons <italic>y</italic><sub>5,1</sub>, <italic>y</italic><sub>6,1</sub>, <italic>y</italic><sub>7,1</sub> are along the left arm, and <italic>y</italic><sub>5,2</sub>, <italic>y</italic><sub>6,2</sub>, <italic>y</italic><sub>7,2</sub> are along the right arm. As outlined earlier, an equal number of training trials go along each arm. As a result, the connections from <italic>y</italic><sub>4</sub> to <italic>y</italic><sub>5,1</sub> and <italic>y</italic><sub>5,2</sub> must have their strengths changed in an identical way by STDP. This means that the connection strengths from neurons in the center stem to those on the left and right arm of the T-maze are equal, resulting in no preference for either path. To show that this is indeed the case in the full spiking network, we calculate the bias of connections strengths from neurons in the center stem to all other neurons (see <xref ref-type="sec" rid="sec010">Materials and methods</xref>); <xref ref-type="fig" rid="pcbi.1005669.g005">Fig 5a</xref> shows that this bias value is small for neurons in the center stem, indicating that changes in coupling strength for these neurons are symmetric. These results indicate that the changes of coupling strengths due to STDP can learn the paths of the model rat, but that these changes have not broken the symmetry between the two paths in the network.</p>
<fig id="pcbi.1005669.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005669.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Changes to connection strengths after 20 training trials in the spiking neural circuit model.</title>
<p>Coordinates of the x-axis are centered on the center stem to more clearly show the level of symmetry present in connection strength changes. We note that after 20 trials, these values are quite stable. (a) The bias (calculated using <xref ref-type="disp-formula" rid="pcbi.1005669.e057">Eq 27</xref>) in connections from neurons in the center stem to other neurons in the 2D spiking neural circuit is small. For neurons on the two arms, the values are close to the theoretical maximum value, slightly larger than 3. (b) Changes to coupling strength from the external cue neuron are not symmetric. The average change in coupling strength for connections from the external cue neuron, <italic>C</italic>2 in this case, shows a clear bias towards the right hand side of the T-maze.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005669.g005" xlink:type="simple"/>
</fig>
<p>The changes of coupling strengths between the cue neurons and the neurons within the 2D spiking neural circuit, however, are asymmetrical, with connections to one arm of the T-maze increased whilst those to the other arm are unchanged. As before, we consider a group of neurons which are activated sequentially by a moving rat, but we now examine the changes of the connection strengths from the cue neuron <italic>C</italic>2 to the neurons in the two-dimensional network (<xref ref-type="fig" rid="pcbi.1005669.g004">Fig 4c</xref>), with the cue neuron firing at the same time as the neuron <italic>y</italic><sub>4</sub>. For this case, the interplay between STDP and the evoked firing sequence changes the coupling strengths in an asymmetrical way, as shown in <xref ref-type="fig" rid="pcbi.1005669.g004">Fig 4c</xref>; this occurs because for each training trial as <italic>C</italic>2 fires, the model rat is forced to travel along the right arm of the T-maze. As a result, the connection strengths from <italic>C</italic>2 to the neurons along the right arm of the T-maze are increased, whilst connections from <italic>C</italic>2 to the neurons along the left arm are unmodified by STDP and maintain their original values.</p>
<p>Likewise, the connections from <italic>C</italic>1 to the neurons along the left arm of the T-maze will have their strengths increased, whilst connections from <italic>C</italic>1 to the neurons along the right arm of the T-maze are not changed. On each successive training trial, this symmetry breaking becomes stronger as these differences in the connection strengths to the two different paths are magnified. We have verified that this mechanism indeed results in such asymmetric changes to the coupling strengths from the external cue neurons to the neurons within the 2-D spiking neural circuit (<xref ref-type="fig" rid="pcbi.1005669.g005">Fig 5b</xref>).</p>
<p>These changes in synaptic coupling strengths due to the interactions between the sequence evoked by the moving rat and STDP can be shown to eventually result in the formation of a forward-sweep IGS when the rat approaches the decision point. Suppose that the trained model rat is at the decision point (<xref ref-type="fig" rid="pcbi.1005669.g001">Fig 1</xref>), and generates a bump of activity corresponding to this location. As we have demonstrated above, the connections from the decision point to the nearby neurons along both arms of the T-maze have had their strength increased by STDP (<xref ref-type="fig" rid="pcbi.1005669.g005">Fig 5a</xref>). When an external cue is applied, the membrane potentials of the neurons along one side of the T-maze are increased more than on the other side, because the connections from the external cue are asymmetrical, as shown in <xref ref-type="fig" rid="pcbi.1005669.g005">Fig 5b</xref>. These increased membrane potentials cause these neurons to fire before those on the other arm, therefore leading to the formation of a spiking neural sequence sweeping away from the decision point of the T-maze towards the goal location. We note that without training, the asymmetry in the connection strengths does not exist, and the rat is unable to make a decision about which goal is correct given the cue.</p>
<p>In our model without STDP, the paths of the model rat cannot be learned and as a result the IGS cannot make a correct choice. To understand the contribution of synaptic scaling to the choice made by the neural circuit shown in <xref ref-type="fig" rid="pcbi.1005669.g003">Fig 3</xref>, we now study the behaviour of the network in the absence of synaptic scaling. We find that for the first 40 trials the proportion of correct responses when <italic>C</italic>2 is applied is almost identical in the model with and without synaptic scaling, as shown in <xref ref-type="fig" rid="pcbi.1005669.g003">Fig 3</xref>. However, after 40 trials, the synaptic behaviour of the two models is no longer similar. The major difference is that in the model without scaling, it becomes increasingly common for the neural sequence to split and travel along both paths. After 80 trials, this has become the dominant response; this behaviour is inconsistent with experimental results [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>]. As described earlier, the strength of synapses along the direction of propagation of sequences are increased. As training trials occur with the goal on both the left and right arm of the T-maze, connections from neurons in the center stem to those on the left and right arm are both increased, as in <xref ref-type="fig" rid="pcbi.1005669.g004">Fig 4b</xref>. After sufficient training, the additional excitation generated from these synapses may be sufficient to cause a neuron on one of the arms of the T-maze to spike without any input from the external cue. As a result, the sequence splits and travels down both arms of the T-maze simultaneously. Synaptic scaling, however, causes coupling strengths to gradually return to their original values, effectively reducing the excitation received by neurons on the arms of the T-maze, and preventing the sequence from splitting and propagating along both arms of the T-maze. In addition, due to synaptic scaling, recent changes to synaptic strength have more impact on the current synaptic strength than those that occurred earlier in the training process. As illustrated in the later sections, this temporal property is crucial for the network to generate adaptive choices in response to time-varying and stochastic cue-goal associations.</p>
</sec>
<sec id="sec006">
<title>Recursive Bayesian inference and IGS</title>
<p>To study the general computational roles of the IGS that emerge from our spiking neural circuit model, we now consider the cases in which the cue-goal associations can be both probabilistic and time-varying. We introduce <italic>g</italic><sub><italic>n</italic></sub>, which is the probability that on trial <italic>n</italic>, the goal location is on the right arm when <italic>C</italic>2 is the supplied cue. To maintain symmetry between <italic>C</italic>1 and <italic>C</italic>2, whilst ensuring that the number of left and right trials is the same, the probability that on the <italic>n</italic>th trial the goal location is on the left arm when <italic>C</italic>1 is the supplied cue is also <italic>g</italic><sub><italic>n</italic></sub>; note that for the cue-goal association considered in the previous section, <italic>g</italic><sub><italic>n</italic></sub> = 1 for both <italic>C</italic>1 and <italic>C</italic>2.</p>
<p>We first consider a simple case of time-varying cue-goal association in which an initial association between the cue and the goal is first learned and then switched. This switch takes the form of a step-like change in <italic>g</italic><sub><italic>n</italic></sub> after a certain number of trials; in this study, we have <italic>g</italic><sub><italic>n</italic></sub> = 0 when <italic>n</italic> ≤ 100, followed by <italic>g</italic><sub><italic>n</italic></sub> = 1 for <italic>n</italic> &gt; 100. Such a switching change has been used to study the behaviour of rats in a T-maze goal-directed choice protocol [<xref ref-type="bibr" rid="pcbi.1005669.ref023">23</xref>], similar to ours. <xref ref-type="fig" rid="pcbi.1005669.g006">Fig 6</xref> shows the correct response rate (blue line) when <italic>C</italic>2 is used as the test cue under this protocol. When we compare the results from the experimental study [<xref ref-type="bibr" rid="pcbi.1005669.ref023">23</xref>] to our modelling study, we find that significant similarities exist. In particular, after the switch of the cue-goal association, in both cases the correct response rate increases quickly. This increase then slows before a saturation level is reached. In our study this takes around 60 trials, whilst in [<xref ref-type="bibr" rid="pcbi.1005669.ref023">23</xref>], 40 training trials were necessary for all rats to learn the cue-goal relationship. The similarity between the correct response rate from the neural circuit model and the experimental data provides further evidence that our IGS-based model is able to respond to the switching change in the cued-choice task. Again, we find that the model without synaptic scaling cannot respond to this change, in particular, after 200 trials, responses almost exclusively consist of the non-physiological splitting behaviour and the correct response rate is very low.</p>
<fig id="pcbi.1005669.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005669.g006</object-id>
<label>Fig 6</label>
<caption>
<title>A comparison of estimation methods in the switching task in the T-maze.</title>
<p>After 100 training trials, the association between cues and goals was switched. We note that the neural circuit adapts to this change, with rapid adaptation of the response rates to be more consistent with the new relationship between cue and goal. The neural circuit is shown by the blue curve, the simple Bayesian method (<xref ref-type="disp-formula" rid="pcbi.1005669.e003">Eq 3</xref>) shown by the red curve, and the modified Bayesian method (<xref ref-type="disp-formula" rid="pcbi.1005669.e011">Eq 7</xref>) shown by the black curve. The green curve shows the proportion of trials in which the propagating wave pattern travelled down the left arm of the T-maze, rather than the right arm.Alternatively, it follows from a simple symmetry argument that the green curve shows the proportion of trials in which the propagating wave pattern travelled down the right arm of the T-maze, but with the order training trials reversed. The fact that the green and blue curves are separated at trial 200 indicates that the neural circuit model is sensitive to the order of trials, as in both cases, 100 <italic>L</italic> and 100 <italic>R</italic> trials have occurred. For the neural circuit, error bars show the SEM, and for the Bayesian methods (Eqs <xref ref-type="disp-formula" rid="pcbi.1005669.e003">3</xref> and <xref ref-type="disp-formula" rid="pcbi.1005669.e011">7</xref>) shading shows the 95% confidence interval. We note the responses from the neural circuit are similar to that given by <xref ref-type="disp-formula" rid="pcbi.1005669.e011">Eq 7</xref>, and the estimate from <xref ref-type="disp-formula" rid="pcbi.1005669.e003">Eq 3</xref> is poor.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005669.g006" xlink:type="simple"/>
</fig>
<p>It has been proposed that goal-directed decisions and planning can be understood as an implementation of probabilistic inference [<xref ref-type="bibr" rid="pcbi.1005669.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref012">12</xref>]. We shall show how such probabilistic inference can be related to our IGS-based decision making model. In general, the problem of probabilistically estimating the value of <italic>g</italic><sub><italic>n</italic></sub> is an example of a hidden variable problem, since the variable of interest (i.e., <italic>g</italic><sub><italic>n</italic></sub>) cannot be measured directly, but instead its value is estimated based on observations. In the context of the problem we are considering, these observations come from the training trials. We label the observation obtained on the <italic>n</italic>th training trial as <italic>y</italic><sub><italic>n</italic></sub>, which may take one of two values, namely <italic>L</italic> and <italic>R</italic>, corresponding to the goal location being on the left and the right arm of the T-maze, respectively. We assume that <italic>y</italic><sub><italic>n</italic></sub> is a martingale, i.e., it is unaffected by the value of <italic>y</italic><sub>1</sub>, …, <italic>y</italic><sub><italic>n</italic>−1</sub>, so that <italic>p</italic>(<italic>y</italic><sub><italic>n</italic></sub>|<italic>y</italic><sub>1</sub>, …, <italic>y</italic><sub><italic>n</italic>−1</sub>) = <italic>p</italic>(<italic>y</italic><sub><italic>n</italic></sub>). The sequence of these observations is denoted by <italic>Y</italic><sub><italic>n</italic></sub> = <italic>y</italic><sub>1</sub>, <italic>y</italic><sub>2</sub>, …, <italic>y</italic><sub><italic>n</italic></sub>. In a Bayesian context, to solve the hidden variable problem, we need to calculate the conditional posterior distribution function (pdf) <italic>p</italic>(<italic>g</italic><sub><italic>n</italic></sub>|<italic>Y</italic><sub><italic>n</italic></sub>). We now provide a brief overview of how this calculation can be performed. Using the notation we have outlined above, the conditional pdf can be calculated in the following way [<xref ref-type="bibr" rid="pcbi.1005669.ref024">24</xref>]:
<disp-formula id="pcbi.1005669.e002"><alternatives><graphic id="pcbi.1005669.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>p</italic>(<italic>y</italic><sub><italic>n</italic></sub>|<italic>g</italic><sub><italic>n</italic></sub>) is the likelihood function, <italic>p</italic>(<italic>g</italic><sub><italic>n</italic></sub>|<italic>Y</italic><sub><italic>n</italic>−1</sub>) is the prior and <italic>p</italic>(<italic>y</italic><sub><italic>n</italic></sub>|<italic>Y</italic><sub><italic>n</italic>−1</sub>) is a normalizing factor. Calculating <italic>p</italic>(<italic>g</italic><sub><italic>n</italic></sub>|<italic>Y</italic><sub><italic>n</italic></sub>) gives the conditional probability density function for the goal being located on the right arm when <italic>C</italic>2 is applied, for the sequence of observations <italic>Y</italic><sub><italic>n</italic></sub>. Assuming that <italic>g</italic><sub><italic>n</italic></sub> is constant, i.e. <italic>g</italic><sub><italic>n</italic></sub> = <italic>g</italic><sub><italic>n</italic>−1</sub>, <xref ref-type="disp-formula" rid="pcbi.1005669.e002">Eq 2</xref> can be simplified to:
<disp-formula id="pcbi.1005669.e003"><alternatives><graphic id="pcbi.1005669.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>β</italic><sub><italic>n</italic></sub> is an appropriate normalization constant which is independent of <italic>g</italic><sub><italic>n</italic></sub>. This recursive formula for the posterior pdf treats the posterior pdf from the previous trial as a new prior, which is then updated by the observation on the current trial. To complete this formulation, we require both the initial prior and the likelihood function <italic>p</italic>(<italic>y</italic><sub><italic>n</italic></sub>|<italic>g</italic><sub><italic>n</italic></sub>). We choose <italic>p</italic>(<italic>g</italic><sub>0</sub>) = 1 as a simple uninformative prior. The likelihood function calculates the likelihood of the observation <italic>L</italic> or <italic>R</italic>, given a value of <italic>g</italic><sub><italic>n</italic></sub>. The likelihood function is then given by:
<disp-formula id="pcbi.1005669.e004"><alternatives><graphic id="pcbi.1005669.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>L</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
From this formulation, it can be shown that [<xref ref-type="bibr" rid="pcbi.1005669.ref025">25</xref>]:
<disp-formula id="pcbi.1005669.e005"><alternatives><graphic id="pcbi.1005669.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>(</mml:mo> <mml:mi>α</mml:mi> <mml:mo>+</mml:mo> <mml:mi>β</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>!</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>α</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>!</mml:mo> <mml:mo>(</mml:mo> <mml:mi>β</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>!</mml:mo></mml:mrow></mml:mfrac> <mml:msubsup><mml:mi>g</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mi>α</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>β</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>α</italic> is the number of <italic>L</italic> observations and <italic>β</italic> is the number of <italic>R</italic> observations. To make a concrete choice for the goal location, we use a maximum likelihood estimator, which gives an estimate <inline-formula id="pcbi.1005669.e006"><alternatives><graphic id="pcbi.1005669.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula> for <italic>g</italic><sub><italic>n</italic></sub> by choosing the <italic>g</italic><sub><italic>n</italic></sub> that maximizes the value of <italic>p</italic>(<italic>g</italic><sub><italic>n</italic></sub>|<italic>Y</italic><sub><italic>n</italic></sub>). For the case <italic>g</italic><sub><italic>n</italic></sub> = <italic>g</italic><sub><italic>n</italic>−1</sub>, it can be shown that
<disp-formula id="pcbi.1005669.e007"><alternatives><graphic id="pcbi.1005669.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>β</mml:mi> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>α</mml:mi> <mml:mo>+</mml:mo> <mml:mi>β</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>β</mml:mi> <mml:mo>/</mml:mo> <mml:mi>n</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
It is clear that as <italic>n</italic> increases, <inline-formula id="pcbi.1005669.e008"><alternatives><graphic id="pcbi.1005669.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula> will tend towards <italic>g</italic><sub><italic>n</italic></sub>, at least in the case where <italic>g</italic><sub><italic>n</italic></sub> is constant.</p>
<p>We now compare the choices made using IGS in our neural circuit model with a recursive Bayesian inference approach outlined above. We find that estimated values of <italic>g</italic><sub><italic>n</italic></sub> based on <xref ref-type="disp-formula" rid="pcbi.1005669.e003">Eq 3</xref> do not match the true values; for example, the prediction <inline-formula id="pcbi.1005669.e009"><alternatives><graphic id="pcbi.1005669.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>200</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> compares poorly to the true value of <italic>g</italic><sub>200</sub> = 1. However, our neural circuit generates a more accurate estimate of <italic>g</italic><sub><italic>n</italic></sub> (<xref ref-type="fig" rid="pcbi.1005669.g006">Fig 6</xref>).</p>
<p>To understand how this discrepancy between the result from this probabilistic inference and our neural circuit model occurs, we consider whether both models are sensitive to the order of the training trials. As we described in <xref ref-type="disp-formula" rid="pcbi.1005669.e007">Eq 6</xref>, the estimate <inline-formula id="pcbi.1005669.e010"><alternatives><graphic id="pcbi.1005669.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula> made by recursive Bayesian inference depends only on the total number of trials with the goal location on the left and right arm, and is independent of their temporal order. In contrast, we have found that our neural circuit model is sensitive to the order of the training trials; that is, if we reverse the order of the training trials (i.e. 100 <italic>R</italic>, which is followed by 100 <italic>L</italic>), the resulting estimate for <italic>g</italic><sub><italic>n</italic></sub> on the 200th trial is significantly different than the original case (i.e. 100 <italic>L</italic>, which is followed by 100 <italic>R</italic>), as shown in <xref ref-type="fig" rid="pcbi.1005669.g006">Fig 6</xref>. This sensitivity to the order of training trials in our spiking neural circuit happens because synaptic connection strengths learned by STDP can be gradually reset by synaptic scaling. This gradual resetting process means that more recent trials have a more significant effect on the coupling strengths than those in the distant past.</p>
<p>As accurate predictions for a changing <italic>g</italic><sub><italic>n</italic></sub> require sensitivity to the order of the training trials, we propose an extension to <xref ref-type="disp-formula" rid="pcbi.1005669.e003">Eq 3</xref>; inspired by the effect of synaptic scaling on synaptic coupling strengths, we incorporate a similar resetting mechanism to <xref ref-type="disp-formula" rid="pcbi.1005669.e003">Eq 3</xref> and obtain the following:
<disp-formula id="pcbi.1005669.e011"><alternatives><graphic id="pcbi.1005669.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>α</mml:mi></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where 0 &lt; <italic>α</italic> &lt; 1 is a parameter that controls the contribution of the previous probabilistic estimate for <italic>g</italic><sub><italic>n</italic></sub> (i.e. <italic>p</italic>(<italic>g</italic><sub><italic>n</italic></sub>|<italic>Y</italic><sub><italic>n</italic>−1</sub>)) to the new one (i.e. <italic>p</italic>(<italic>g</italic><sub><italic>n</italic></sub>|<italic>Y</italic><sub><italic>n</italic></sub>)). Expanding this formula, it becomes clear how this change is sensitive to the order of trials, similar to the effect of synaptic scaling:
<disp-formula id="pcbi.1005669.e012"><alternatives><graphic id="pcbi.1005669.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>α</mml:mi></mml:msup> <mml:mi>p</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>α</mml:mi></mml:mrow></mml:msup> <mml:mo>…</mml:mo> <mml:mi>p</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>α</mml:mi></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula> <xref ref-type="disp-formula" rid="pcbi.1005669.e012">Eq 8</xref> indicates that <italic>p</italic>(<italic>g</italic><sub><italic>n</italic></sub>|<italic>Y</italic><sub><italic>n</italic></sub>) can be viewed as a product of the likelihood functions from the previous trials i.e., <italic>p</italic>(<italic>y</italic><sub><italic>n</italic>−1</sub>|<italic>g</italic><sub><italic>n</italic></sub>)<sup><italic>α</italic></sup> for the <italic>n</italic> − 1th trial, <italic>p</italic>(<italic>y</italic><sub><italic>n</italic>−2</sub>|<italic>g</italic><sub><italic>n</italic></sub>)<sup>2<italic>α</italic></sup> for the <italic>n</italic> − 2th trial, etc. As <italic>α</italic> &lt; 1, we have <italic>p</italic>(<italic>y</italic><sub><italic>n</italic></sub>|<italic>g</italic><sub><italic>n</italic></sub>) &lt; <italic>p</italic>(<italic>y</italic><sub><italic>n</italic></sub>|<italic>g</italic><sub><italic>n</italic></sub>)<sup><italic>α</italic></sup> &lt; <italic>p</italic>(<italic>y</italic><sub><italic>n</italic></sub>|<italic>g</italic><sub><italic>n</italic></sub>)<sup>2<italic>α</italic></sup> &lt; ⋯ &lt; 1. This relationship indicates that more recent trials have a more significant contribution to the estimate of the current value of <italic>g</italic><sub><italic>n</italic></sub>; this is necessary for capturing the temporal order effect of responding to the switching change in the cued-choice task. We find that by choosing an appropriate value of <italic>α</italic> (<italic>α</italic> = 0.99 in this case), the estimated value of <italic>g</italic><sub><italic>n</italic></sub> calculated using a maximum likelihood method from the modified recursive Bayesian inference method indeed matches that generated from our spiking neural circuit and the true value of <italic>g</italic><sub><italic>n</italic></sub> (<xref ref-type="fig" rid="pcbi.1005669.g006">Fig 6</xref>).</p>
</sec>
<sec id="sec007">
<title>Adaptive spatial decision making by using IGS</title>
<p>We have shown that our neural circuit model with IGS is able to adaptively respond to a switch in the cue-goal association, and that this behaviour is well approximated by a simple approach based on probabilistic inference. Now, we demonstrate that our IGS-based model can make real-time choices when <italic>g</italic><sub><italic>n</italic></sub> changes randomly, and that the performance of our model is close to the optimal choices implemented by a Kalman filter.</p>
<p>We first describe a Kalman filter in the context of our problem and then compare its performance with that from our IGS-based model. The basic operation of the Kalman filter can be understood as follows: the Kalman filter contains some internal state which incorporates the history of past measurements, each new observation is then incorporated into this internal state and used to make a prediction of the hidden variable; for a detailed discussion see [<xref ref-type="bibr" rid="pcbi.1005669.ref024">24</xref>]. The 1-dimensional Kalman filter for estimating <italic>g</italic><sub><italic>n</italic></sub> is given by the following set of equations:
<disp-formula id="pcbi.1005669.e013"><alternatives><graphic id="pcbi.1005669.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math></alternatives> <label>(9)</label></disp-formula> <disp-formula id="pcbi.1005669.e014"><alternatives><graphic id="pcbi.1005669.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:msub><mml:mo>Σ</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mo>Σ</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>K</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>Q</mml:mi><mml:mo>+</mml:mo><mml:mi>Z</mml:mi><mml:mo>,</mml:mo></mml:math></alternatives> <label>(10)</label></disp-formula> <disp-formula id="pcbi.1005669.e015"><alternatives><graphic id="pcbi.1005669.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mi>K</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mo>Σ</mml:mo><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mo>Σ</mml:mo><mml:mi>n</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>Q</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math></alternatives> <label>(11)</label></disp-formula>
where <inline-formula id="pcbi.1005669.e016"><alternatives><graphic id="pcbi.1005669.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the estimate of the hidden variable, i.e. the estimate for the current value of <italic>g</italic><sub><italic>n</italic>+1</sub>, <italic>y</italic><sub><italic>n</italic></sub> is the <italic>n</italic>th measurement as defined above, <italic>Q</italic> is the covariance of the measurement error, <italic>Z</italic> is the covariance of the variation in <italic>g</italic><sub><italic>n</italic></sub>, <italic>Σ</italic><sub><italic>n</italic></sub> is the estimate of the covariance of <inline-formula id="pcbi.1005669.e017"><alternatives><graphic id="pcbi.1005669.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <italic>K</italic>(<italic>n</italic>) is the Kalman gain. In several cases, it can be shown that the estimate <inline-formula id="pcbi.1005669.e018"><alternatives><graphic id="pcbi.1005669.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> given by the Kalman filter is optimal. One of these cases is the Gaussian random walk, where the dynamics of the hidden variable and the measurement process are given by the following equations:
<disp-formula id="pcbi.1005669.e019"><alternatives><graphic id="pcbi.1005669.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>y</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mtd> <mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ξ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where <italic>ξ</italic><sub>1</sub>(<italic>n</italic>) and <italic>ξ</italic><sub>2</sub>(<italic>n</italic>) are independent zero-mean Gaussian noise processes, with variance <italic>Q</italic> and <italic>Z</italic>, respectively. In the Kalman filter, the Kalman gain, <italic>K</italic>(<italic>n</italic>), controls how much each individual observation, <italic>y</italic><sub><italic>n</italic></sub> affects the internal state of the Kalman filter. If each individual observation is unreliable due to noise, i.e., <italic>Z</italic> is large, the Kalman gain is small and it takes many trials for the Kalman filter to change its estimate of <italic>g</italic><sub><italic>n</italic></sub>. On the other hand, if each observation is accurate, i.e., <italic>Z</italic> is small, the Kalman gain is large and the Kalman filter will quickly change its estimate. In our study, to be consistent with the Gaussian random walk, we use <italic>g</italic><sub><italic>n</italic></sub> given by <xref ref-type="disp-formula" rid="pcbi.1005669.e019">Eq 12</xref> and <italic>g</italic><sub>0</sub> = 1/2. As our neural circuit adapts slowly to changes in <italic>g</italic><sub><italic>n</italic></sub>, it is necessary that <italic>Q</italic> is small; we have used <italic>Q</italic> = 2 × 10<sup>−5</sup>. Satisfying the condition on <italic>y</italic><sub><italic>n</italic></sub> is more complex, to this end we must verify that the measurement error, <italic>g</italic><sub><italic>n</italic></sub> − <italic>y</italic><sub><italic>n</italic></sub> has a Gaussian distribution with mean 0. Numerically, we have found that the distribution of measurement errors is well approximated by a Gaussian distribution. As a result, we have shown that when <italic>g</italic><sub><italic>n</italic></sub> is given by <xref ref-type="disp-formula" rid="pcbi.1005669.e019">Eq 12</xref>, the requirements for the Kalman filter to produce optimal estimates of <italic>g</italic><sub><italic>n</italic></sub> have been satisfied.</p>
<p>As noted earlier, the neural circuit estimates of <italic>g</italic><sub><italic>n</italic></sub> saturate at a level below 1, even when <italic>g</italic><sub><italic>n</italic></sub> = 1, as shown in <xref ref-type="fig" rid="pcbi.1005669.g003">Fig 3</xref>. To allow for a direct comparison with the Kalman filter, we thus use a linear map that scales the estimate of <italic>g</italic><sub><italic>n</italic></sub> to match the scale of the output of the Kalman filter; namely, we use <inline-formula id="pcbi.1005669.e020"><alternatives><graphic id="pcbi.1005669.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005669.e021"><alternatives><graphic id="pcbi.1005669.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the proportion of correct responses on the <italic>n</italic>th trial from our network model, with <italic>a</italic> and <italic>b</italic> chosen to minimize the mean squared difference between <italic>g</italic>(<italic>n</italic>) and <inline-formula id="pcbi.1005669.e022"><alternatives><graphic id="pcbi.1005669.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. <xref ref-type="fig" rid="pcbi.1005669.g007">Fig 7a</xref> shows the estimated values of <italic>g</italic><sub><italic>n</italic></sub> from the spiking neural circuit, the modified recursive Bayesian inference procedure described by <xref ref-type="disp-formula" rid="pcbi.1005669.e011">Eq 7</xref> and the Kalman filter. We note that the parameters of the Kalman filter must be tuned to match both the measurement noise and the noise in the random walk, as they are crucial parameters describing the behaviour of the Kalman filter. The parameters of the neural circuit, however, are identical to those used in the earlier sections. It is apparent that all methods closely follow the changes in <italic>g</italic><sub><italic>n</italic></sub> when it undergoes a Gaussian random walk.</p>
<fig id="pcbi.1005669.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005669.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Comparison of real-time decision making performance by the different models.</title>
<p>(a) Direct comparison of the models to the true values, given by <italic>g</italic><sub><italic>n</italic></sub>. To enable a direct comparison a linear map has been applied to the result from the spiking neural circuit model and the value of <italic>α</italic> used in the Bayesian model (<xref ref-type="disp-formula" rid="pcbi.1005669.e011">Eq 7</xref>) has been chosen by optimization as described in the main text. The green curve is for the true value of <italic>g</italic><sub><italic>n</italic></sub>, the light blue curve is for the output from the Kalman filter, the red curve is for the Bayesian model and the black curve is for the neural circuit model. (b) Cumulative distribution functions for the errors of the various methods, colors as in (a). The error distributions are similar for all three models, although the Kalman filter has the best performance.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005669.g007" xlink:type="simple"/>
</fig>
<p>To enable a more quantitative comparison between the models, we calculate a cumulative distribution function for the absolute error, i.e. <inline-formula id="pcbi.1005669.e023"><alternatives><graphic id="pcbi.1005669.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>; as shown in <xref ref-type="fig" rid="pcbi.1005669.g007">Fig 7b</xref>, the neural circuit model and <xref ref-type="disp-formula" rid="pcbi.1005669.e011">Eq 7</xref> have a similar accuracy to the Kalman filter, specifically, the estimate for <italic>g</italic><sub><italic>n</italic></sub> from the neural circuit was within 3% of the correct value on 50% of trials, within 5% on 80% of trials and within 6% on 90% of trials. The fact that our neural circuit model achieves accuracy comparable to the Kalman filter suggests that our neural circuit model is indeed capable of making a real time estimate of <italic>g</italic><sub><italic>n</italic></sub>.</p>
<p>It may be possible to further increase accuracy by incorporating a reward signal. For example, in [<xref ref-type="bibr" rid="pcbi.1005669.ref026">26</xref>], a synaptic update rule was obtained from the theoretical consideration of maximizing the probability of receiving a reward event, but in our study we use biologically plausible plasticity mechanisms (i.e., STDP and synaptic scaling). Additionally, in our model we study a general goal-location decision task by considering time varying cases of cue-goal association, which was not studied in [<xref ref-type="bibr" rid="pcbi.1005669.ref026">26</xref>].</p>
</sec>
<sec id="sec008">
<title>Changes of coupling strengths and time-varying cue-goal association</title>
<p>We now illustrate how the combined synaptic plasticity rules (i.e. STDP and synaptic scaling) enable the changes to coupling strengths to encode time-varying cue-goal associations; this mechanism underlies the adaptive choice results reported above.</p>
<p>In the previous sections, we showed that connections from the external cue to neurons on the left or right arms of the T-maze such as <italic>y</italic><sub>5,2</sub> (<xref ref-type="fig" rid="pcbi.1005669.g004">Fig 4c</xref>) are crucial for determining which path the neural sequence would choose to travel down. We now consider the dynamics of the synapse connecting <italic>C</italic>2 to neuron <italic>y</italic><sub>5,2</sub>, which are driven by both STDP and synaptic scaling, in order to understand the choice mechanism within our neural circuit, although our analysis does not crucially depend on the precise location of the neuron. In particular, the increase in coupling strength due to STDP in a single trial is <italic>A</italic><sub>+</sub> exp(−Δ<italic>t</italic><sub>5</sub>/<italic>τ</italic><sub>+</sub>) (<xref ref-type="disp-formula" rid="pcbi.1005669.e051">Eq 22</xref>). However, it is not necessarily true that on every training trial, the model rat travels along the right arm of the maze, where the sample neuron is located. In fact, the probability of this event is given by <italic>g</italic><sub><italic>n</italic></sub>, by its definition. It follows that the average increase in coupling strength per trial is <italic>A</italic><sub>+</sub><italic>g</italic><sub><italic>n</italic></sub> exp(−Δ<italic>t</italic><sub>5</sub>/<italic>τ</italic><sub>+</sub>).</p>
<p>As we described in the Materials and Methods section, synaptic scaling causes a gradual resetting in coupling strengths towards their initial values. It follows that over the time period of a learning trial, some fraction of the changes in coupling strength caused by STDP will be lost by this resetting process. We can find the value of this loss as follows: if at the start of the trial, the change in the connection strength from its initial value is Δ<italic>W</italic>; at the end of the trial, synaptic scaling will have reduced it to <italic>r</italic>Δ<italic>W</italic> (see <xref ref-type="sec" rid="sec010">Materials and methods</xref>). This decay occurs on every trial, regardless of whether the rat travels down the left or right arm of the T-maze. This gives a recursive equation for the change in coupling strength of the synapse from the external cue to our sample neuron after the <italic>n</italic>th trial, Δ<italic>W</italic><sub><italic>n</italic></sub>, as follows:
<disp-formula id="pcbi.1005669.e024"><alternatives><graphic id="pcbi.1005669.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mo>+</mml:mo></mml:msub> <mml:msub><mml:mi>g</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mo>+</mml:mo></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>r</mml:mi> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
Analyzing this equation directly is difficult, so we consider a simplification based on the assumption that <italic>g</italic><sub><italic>n</italic></sub> is either constant or varying slowly, as in Figs <xref ref-type="fig" rid="pcbi.1005669.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1005669.g007">7</xref>. To this end, rather than using the value of <italic>g</italic><sub><italic>n</italic></sub>, we use <inline-formula id="pcbi.1005669.e025"><alternatives><graphic id="pcbi.1005669.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:msubsup> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> where <italic>N</italic> is chosen depending on both the dynamics of <italic>g</italic><sub><italic>n</italic></sub> and the neural circuit. We have chosen a value of <italic>N</italic> = 50 based on the time it takes for the correct response rate to saturate, as shown in <xref ref-type="fig" rid="pcbi.1005669.g003">Fig 3</xref>. By setting Δ<italic>W</italic><sub><italic>n</italic></sub> = Δ<italic>W</italic><sub><italic>n</italic>−1</sub> = Δ<italic>W</italic><sub><italic>ss</italic></sub>, we can find the value of the steady state coupling strength change Δ<italic>W</italic><sub><italic>ss</italic></sub>:
<disp-formula id="pcbi.1005669.e026"><alternatives><graphic id="pcbi.1005669.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>A</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mn>5</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mo>+</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math></alternatives> <label>(14)</label></disp-formula>
This then gives an explicit description of Δ<italic>W</italic><sub><italic>ss</italic></sub>:
<disp-formula id="pcbi.1005669.e027"><alternatives><graphic id="pcbi.1005669.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub> <mml:msub><mml:mi>A</mml:mi> <mml:mo>+</mml:mo></mml:msub> <mml:mfrac><mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mo>+</mml:mo></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
As all variables other than <inline-formula id="pcbi.1005669.e028"><alternatives><graphic id="pcbi.1005669.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are fixed parameters of the model, we have:
<disp-formula id="pcbi.1005669.e029"><alternatives><graphic id="pcbi.1005669.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>F</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where <inline-formula id="pcbi.1005669.e030"><alternatives><graphic id="pcbi.1005669.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mi>F</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>A</mml:mi> <mml:mo>+</mml:mo></mml:msub> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:mo>/</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mo>+</mml:mo></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>It is clear from <xref ref-type="disp-formula" rid="pcbi.1005669.e029">Eq 16</xref> that the change in coupling strength is proportional to <inline-formula id="pcbi.1005669.e031"><alternatives><graphic id="pcbi.1005669.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula>; this point is further illustrated in <xref ref-type="fig" rid="pcbi.1005669.g008">Fig 8</xref> in which Δ<italic>W</italic><sub><italic>ss</italic></sub> and <inline-formula id="pcbi.1005669.e032"><alternatives><graphic id="pcbi.1005669.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are compared. These results thus indicate how the synaptic strengths mediated by the combination of STDP and synaptic scaling to some extent are able to adaptively trace the time-varying <italic>g</italic><sub><italic>n</italic></sub>. As the synaptic strengths are the neural basis for forming the IGS, as shown above, our model is able to respond correctly even when <italic>g</italic><sub><italic>n</italic></sub> is changing (<xref ref-type="fig" rid="pcbi.1005669.g007">Fig 7</xref>).</p>
<fig id="pcbi.1005669.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005669.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Coupling strength values closely trace <inline-formula id="pcbi.1005669.e033"><alternatives><graphic id="pcbi.1005669.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.</title>
<p>We compare Δ<italic>W</italic><sub><italic>ss</italic></sub> and <inline-formula id="pcbi.1005669.e034"><alternatives><graphic id="pcbi.1005669.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msub><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula> to verify that they follow each other closely. To enable this comparison, they are normalized so that they have identical means. All relevant parameters for both the dynamics of <italic>g</italic><sub><italic>n</italic></sub> and Δ<italic>W</italic><sub><italic>ss</italic></sub> are consistent with <xref ref-type="fig" rid="pcbi.1005669.g007">Fig 7</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005669.g008" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec009" sec-type="conclusions">
<title>Discussion</title>
<p>In this study, we have developed a spiking neural circuit to study the formation mechanisms of forward sweeping, internally generated sequences and their function in goal-directed spatial decision making. We have demonstrated that in our spiking neural circuit, the interplay between the network dynamics and the combined synaptic dynamics of STDP and synaptic scaling is essential for the formation of such neural sequences. Our model can capture the salient properties of these sequences and yields behavioural performance comparable to data obtained from behaving animals [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>]. In addition, we have demonstrated that STDP when complemented by slower synaptic scaling enables the neural sequences generated in the network model to adaptively respond to changing cue-goal associations.</p>
<p>Our model of spatial decision making shares a resemblance with other spreading-activation or propagating wave-based models for path planning [<xref ref-type="bibr" rid="pcbi.1005669.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref029">29</xref>] in that propagating sequential activity is a key feature used for making choices. However, unlike these models, but consistent with experimental data, there is no backwards diffusion of activity from the goal to the current state during the learning or planning process. Furthermore, by implementing goal directed decision making in probabilistic terms, our model also extends to the cases in which uncertainty in the cue-goal association exists, which has not been generally addressed by previous spreading activation models. Goal directed learning has previously been studied in spiking networks [<xref ref-type="bibr" rid="pcbi.1005669.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref032">32</xref>]. However in these studies, goal-directed decision making with time-varying cue-goal association has not been considered, and how this can be implemented by biologically realistic synaptic mechanisms has not been addressed.</p>
<p>As we have demonstrated, STDP causes the coupling strengths along the direction of the model animal’s movement to increase and those in the opposite direction to decrease on each training trial. Such positive feedback effects from STDP alone would eventually result in the saturation of synaptic coupling strengths, so that the formed neural sequence propagates towards all possible goals, rather than toward one goal at a time. As a result, the spiking network neither can give rise to correct choice rates as reported in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], nor make flexible, time-varying choices of goal locations. The homeostatic synaptic scaling rule, however, plays a role in preventing saturation of synaptic coupling strengths as the training process proceeds.In our model, this scaling process happens at a temporal scale which is around 350 times longer than that of STDP, therefore enabling the network to intrinsically possess distinct temporal scales. We have found that the behaviour of our model is not dependent on the precise values of the time constants chosen, as long as the timescale of STDP is shorter than that of a single learning trial and the timescale of synaptic scaling is much longer than both of these. In addition, changing the size of the neural circuit and T-maze does not significantly change our results; we have found that similar results can be found with T-mazes which are either twice or half the size of the T-maze that we have used in this study.</p>
<p>A combination of plasticity rules with separate temporal scales enables the network to maintain the trace of the moving paths of the model rat during the training process, and it provides the needed flexibility to allow the network to generate time-varying choices. Both STDP [<xref ref-type="bibr" rid="pcbi.1005669.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref035">35</xref>] and synaptic scaling [<xref ref-type="bibr" rid="pcbi.1005669.ref036">36</xref>] have been widely observed in the brain, and our model results show that the loss of either mechanism would impair the normal functions of the brain. In previous modelling studies, the combination of STDP and synaptic scaling has been mainly used to achieve specific network states, such as balanced states [<xref ref-type="bibr" rid="pcbi.1005669.ref037">37</xref>]. Our study, however, relates this combination and the resultant separation of time scales to network dynamics in terms of emergent IGS, and further to goal-directed spatial decision making. Other synaptic mechanisms such as short-term depression [<xref ref-type="bibr" rid="pcbi.1005669.ref038">38</xref>] and homeostatic synaptic plasticity described by the BCM rule [<xref ref-type="bibr" rid="pcbi.1005669.ref039">39</xref>] when combined with STDP may produce a similar behaviour, whilst also avoiding the saturation of coupling strength.</p>
<p>The IGS in our model capture the characteristic dynamics of IGS as observed in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], including their forward propagation, and propagation toward one goal at a time rather than towards all goals simultaneously. Some previous modelling studies used spreading activation or propagating wave fronts to model path planning or goal directed decision making [<xref ref-type="bibr" rid="pcbi.1005669.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref029">29</xref>]; in these models, however, neural activity propagates backwards from the goal to the current location. Importantly, by reproducing animals’ behavioural responses, i.e., the correct decision rates as measured in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>], our modeling study directly demonstrates that such forward-sweeping sequences could be the neural substrate for implementing learning and implementing goal-directed decision making. In our study, this computational role of forward-sweeping IGS has been further illustrated by extending the deterministic cued-choice task studied in [<xref ref-type="bibr" rid="pcbi.1005669.ref006">6</xref>] to tasks with time-varying and probabilistic associations between cues and goals. This extension allows us to show that IGS-implemented functionality can be generally understood in terms of probabilistic inference. The general computational role of IGS revealed in our model is consistent with the proposal that IGS can implement probabilistic inference that optimizes goal acquisition for real time choice and learning [<xref ref-type="bibr" rid="pcbi.1005669.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref021">21</xref>]. Our study thus provides a basis for further extensions considering reward learning and multiple choices.</p>
<p>In our model, when the probabilistic associations of the cues and goals undergoes a Gaussian random walk, such IGS-based decision making works in a near optimal way; the estimates are within 3% of the correct value for 50% of the time, largely comparable to those obtained by a Kalman filter that is optimal for this case. The Kalman filter has been well studied in relation to optimal decision making in prediction and motor control, however, neural representations of Kalman filters are largely unknown. By comparing our model with the working mechanism of the Kalman filter, we can understand how it is able to make accurate choices. In particular, in our IGS-based model for the spatial decision task, the interplay of spiking sequences and the combined synaptic rules lead to constant changes of synaptic coupling strengths. As we have demonstrated, these changes are proportional to the probability of cue-goal associations, as long as this probability varies slowly. Thus these changes to coupling strength can serve as the posterior for test trials, which can then be exploited by the sequences to make a choice. The ratio between the strength of STDP and synaptic scaling plays a similar role as the Kalman gain, as it controls how quickly new training trials are incorporated into the internal model. Specifically, STDP controls the strength of the trace left by the previous training trials, whilst synaptic scaling controls the speed with which they are reset to their original values. This ratio is fixed in our case, but Kalman gain is dynamical; this difference suggests that including other synaptic mechanisms such as meta-plasticity to the model may give rise to a dynamical ratio with multiple timescales [<xref ref-type="bibr" rid="pcbi.1005669.ref040">40</xref>], which may make the spiking model perform optimally like a Kalman filter. Nevertheless, our spiking neural circuit model suggests that the IGS and the combined synaptic plasticity rules are candidate neural implementations of a Kalman filter-based estimation of the changing cue-goal associations.</p>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Materials and methods</title>
<p>We consider a two dimensional, conductance-based integrate-and-fire neural network. In this 2D network, neurons are located at the integer intersections of a 200 × 200 grid, with inhibitory neurons located at points where both coordinates are even and excitatory neurons located at all other integer coordinates. The network has 30,000 excitatory neurons and 10,000 inhibitory neurons (i.e. 75% excitatory and 25% inhibitory neurons). Every neuron within the network connects with nearby neurons within 25 grid distance (arbitrary units). The 2D network has periodic boundary conditions, meaning that neurons on the edge can connect to neurons on the opposite edge to maintain an identical spatial arrangement of connectivity as the neurons in the middle of the network. There are also 2 cue neurons that connect to the neurons within the 2D network, with coupling weights chosen randomly from a distribution equivalent to the distribution of the weights within the 2D network, and with the same synaptic plasticity rules as in the 2D network. Code for this model is available at the following URL: <ext-link ext-link-type="uri" xlink:href="https://github.com/BrainDynamicsUSYD/spikegrid" xlink:type="simple">https://github.com/BrainDynamicsUSYD/spikegrid</ext-link>.</p>
<p>We denote the membrane potential of a neuron at coordinates (<italic>i</italic>, <italic>j</italic>) at time <italic>t</italic> as <italic>V</italic><sub><italic>ij</italic></sub>(<italic>t</italic>), with dynamics governed by the following equation:
<disp-formula id="pcbi.1005669.e035"><alternatives><graphic id="pcbi.1005669.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mfrac><mml:mi>d</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>E</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>E</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>I</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>I</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where the capacitance <italic>C</italic> = 1 <italic>μ</italic>Fcm<sup>−2</sup>, the leak conductance <italic>g</italic><sub><italic>L</italic></sub> = 50 <italic>μ</italic>Scm<sup>−2</sup> and the reversal potentials are <italic>V</italic><sub><italic>L</italic></sub> = −70 mV, <italic>V</italic><sub><italic>E</italic></sub> = 0 mV and <italic>V</italic><sub><italic>I</italic></sub> = −80 mV for the leak, excitatory and inhibitory conductances, respectively. When the membrane potential of a neuron reaches a threshold <italic>V</italic><sub><italic>th</italic></sub> = −55 mV, a spike is generated. Subsequently, the neuron remains at the reset potential <italic>V</italic><sub><italic>R</italic></sub> = −70 mV for a period of time corresponding to the refractory state <italic>τ</italic><sub><italic>ref</italic></sub> = 5 ms. The dynamics of a synaptic conductance <italic>g</italic><sup>λ</sup> are given by:
<disp-formula id="pcbi.1005669.e036"><alternatives><graphic id="pcbi.1005669.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>g</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>λ</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>F</mml:mi> <mml:mo>λ</mml:mo></mml:msup> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder> <mml:msubsup><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>λ</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>l</mml:mi></mml:munder> <mml:msup><mml:mi>G</mml:mi> <mml:mo>λ</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>T</mml:mi> <mml:mrow><mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mi>l</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where λ is used to denote the two types of neurons, excitatory and inhibitory, represented by <italic>E</italic> and <italic>I</italic> respectively, and <inline-formula id="pcbi.1005669.e037"><alternatives><graphic id="pcbi.1005669.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msubsup><mml:mi>T</mml:mi> <mml:mrow><mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the time of the <italic>l</italic>-th spike emitted by the afferent neuron located at (<italic>i</italic>′, <italic>j</italic>′). A constant inhibitory input is supplied to ensure that no spontaneous firing of neurons occurs. This is achieved using <italic>F</italic><sup><italic>I</italic></sup> = 15 <italic>μ</italic>Scm<sup>−2</sup> whilst <italic>F</italic><sup><italic>E</italic></sup> = 0 <italic>μ</italic>Scm<sup>−2</sup>. The time course of the post-synaptic conductance is given by
<disp-formula id="pcbi.1005669.e038"><alternatives><graphic id="pcbi.1005669.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>G</mml:mi> <mml:mo>λ</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>d</mml:mi> <mml:mo>λ</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>t</mml:mi> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>r</mml:mi> <mml:mo>λ</mml:mo></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>d</mml:mi> <mml:mo>λ</mml:mo></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>r</mml:mi> <mml:mo>λ</mml:mo></mml:msubsup></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
Here we set <inline-formula id="pcbi.1005669.e039"><alternatives><graphic id="pcbi.1005669.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>d</mml:mi> <mml:mi>I</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>d</mml:mi> <mml:mi>E</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>.</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> ms, <inline-formula id="pcbi.1005669.e040"><alternatives><graphic id="pcbi.1005669.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>r</mml:mi> <mml:mi>I</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>τ</mml:mi> <mml:mi>r</mml:mi> <mml:mi>E</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> ms,. The denominator ensures that the total post-synaptic conductance is normalized such that <inline-formula id="pcbi.1005669.e041"><alternatives><graphic id="pcbi.1005669.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:msup><mml:mi>G</mml:mi> <mml:mo>λ</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>The coupling functions <inline-formula id="pcbi.1005669.e042"><alternatives><graphic id="pcbi.1005669.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msubsup><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>λ</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> have two parts, a static component <inline-formula id="pcbi.1005669.e043"><alternatives><graphic id="pcbi.1005669.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>λ</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> and a dynamic component, Δ<italic>W</italic><sub><italic>ij</italic>,<italic>i</italic>′<italic>j</italic>′</sub>(<italic>t</italic>) governed by STDP and synaptic scaling. The static coupling strength between two neurons located at (<italic>i</italic>, <italic>j</italic>) and (<italic>i</italic>′, <italic>j</italic>′) is given by:
<disp-formula id="pcbi.1005669.e044"><alternatives><graphic id="pcbi.1005669.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>λ</mml:mo></mml:msubsup><mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>C</mml:mi><mml:mo>λ</mml:mo></mml:msup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msubsup><mml:mo>/</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>d</mml:mi><mml:mo>λ</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mtext> </mml:mtext><mml:mi>D</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>′</mml:mo><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mtext> </mml:mtext><mml:mi>D</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula>
where <italic>d</italic><sub><italic>ij</italic>,<italic>i</italic>′<italic>j</italic>′</sub> is the Euclidean distance between the neurons on a square lattice, taking into account the periodic boundary conditions (i.e., neurons near the edge of the grid are coupled to those on the opposite side of the grid), and <italic>C</italic><sup><italic>E</italic></sup> = 5 × 10<sup>−7</sup> and <italic>C</italic><sup><italic>I</italic></sup> = 2.4 × 10<sup>−7</sup>. We have chosen <inline-formula id="pcbi.1005669.e045"><alternatives><graphic id="pcbi.1005669.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msup><mml:mi>d</mml:mi> <mml:mi>E</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msqrt><mml:mn>20</mml:mn></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1005669.e046"><alternatives><graphic id="pcbi.1005669.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msup><mml:mi>d</mml:mi> <mml:mi>I</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msqrt><mml:mn>90</mml:mn></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> and <italic>D</italic> = 25. As a result, each neuron is connected to 1470 excitatory neurons and 490 inhibitory neurons. As in other models for path planning [<xref ref-type="bibr" rid="pcbi.1005669.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref019">19</xref>], in our model the position of the neuron is used as a stand-in for the position of the neuron’s place field. In this case, a localized activity pattern is present surrounding the actual position of the model rat. Such a regular arrangement of place fields, as often used in modelling studies, provides a simple way to study the mechanisms of moving-path related planning and decision making tasks. The size of place fields has the same size as the excitatory coupling range, which is 25 grid points. The T-maze environment has a width of 11 grid points, which is slightly smaller than the place field. A trip through the T-maze takes approximately 100ms, and trials are separated by 150 ms. Note that our results are not sensitive to these values; for instance, if we change the trial separation time to 200 ms, we can obtain similar results.</p>
<p>The dynamic component of coupling comes from plastic synapses modulated by STDP and synaptic scaling. We incorporate these plasticity mechanisms for all synapses. The form of the change in coupling strength is identical for excitatory and inhibitory synapses and is given by:
<disp-formula id="pcbi.1005669.e047"><alternatives><graphic id="pcbi.1005669.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mrow><mml:mo>Δ</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mi>l</mml:mi></mml:msubsup><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mi>H</mml:mi></mml:mstyle></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mi>l</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mi>S</mml:mi></mml:mstyle><mml:mo stretchy="false">(</mml:mo><mml:mo>Δ</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>≤</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>D</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula>
where <inline-formula id="pcbi.1005669.e048"><alternatives><graphic id="pcbi.1005669.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the <italic>k</italic>th firing time of the neuron located at (<italic>i</italic>, <italic>j</italic>) and <inline-formula id="pcbi.1005669.e049"><alternatives><graphic id="pcbi.1005669.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mi>l</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the <italic>l</italic>th firing time of the neuron located at (<italic>i</italic>′, <italic>j</italic>′) and <italic>S</italic>(Δ<italic>W</italic><sub><italic>ij</italic>,<italic>i</italic>′<italic>j</italic></sub>(<italic>t</italic>′)) is the contribution from synaptic scaling, which we discuss later. <inline-formula id="pcbi.1005669.e050"><alternatives><graphic id="pcbi.1005669.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:mi>H</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mi>l</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the STDP window function:
<disp-formula id="pcbi.1005669.e051"><alternatives><graphic id="pcbi.1005669.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mrow><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow><mml:mi>k</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>t</mml:mi><mml:mrow><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:msup><mml:mi>j</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mi>l</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mo>+</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mtext>exp</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mo>−</mml:mo><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mo>−</mml:mo></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if </mml:mtext><mml:mo>|</mml:mo><mml:mo>Δ</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mn>5</mml:mn><mml:mi>τ</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:math></alternatives> <label>(22)</label></disp-formula>
where <inline-formula id="pcbi.1005669.e052"><alternatives><graphic id="pcbi.1005669.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mrow><mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mi>l</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the time difference between the two spikes, <italic>τ</italic><sub>+</sub> and <italic>τ</italic><sub>−</sub> are the timescales for potentiation and depression respectively; <italic>A</italic><sub>+</sub> and <italic>A</italic><sub>−</sub> are the magnitude of potentiation and depression, respectively. In our study, <italic>τ</italic><sub>+</sub> = <italic>τ</italic><sub>−</sub> = 20 ms and <italic>A</italic><sub>+</sub> = <italic>A</italic><sub>−</sub> = 1.2 × 10<sup>−9</sup>; these values are consistent with experimental data [<xref ref-type="bibr" rid="pcbi.1005669.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref042">42</xref>].</p>
<p>Synaptic scaling has been often modelled by using a rule which changes coupling strengths by an amount Δ<italic>W</italic> such as the following [<xref ref-type="bibr" rid="pcbi.1005669.ref043">43</xref>]:
<disp-formula id="pcbi.1005669.e053"><alternatives><graphic id="pcbi.1005669.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>W</mml:mi> <mml:mo>=</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>f</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo> <mml:mi>W</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <italic>f</italic> is the current firing rate, <italic>f</italic>* is a target firing rate, <italic>W</italic> is the current synaptic coupling strength and <italic>ϵ</italic> is a constant which controls the speed with which synaptic scaling acts. We use an adaptation of this rule in our model in which the synapses are modulated by STDP and firing rates do not change significantly. Crucially we seek to maintain the ability of synaptic scaling to scale coupling strengths both up and down, as commonly observed in experimental studies [<xref ref-type="bibr" rid="pcbi.1005669.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005669.ref044">44</xref>]. We allow synaptic scaling to scale coupling strengths by making changes proportional to Δ<italic>W</italic><sub><italic>ij</italic>,<italic>i</italic>′<italic>j</italic>′</sub>(<italic>t</italic>) as follows:
<disp-formula id="pcbi.1005669.e054"><alternatives><graphic id="pcbi.1005669.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e054" xlink:type="simple"/><mml:math display="block" id="M54"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>C</mml:mi> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
where Δ<italic>W</italic><sub><italic>ij</italic>,<italic>i</italic>′<italic>j</italic>′</sub>(<italic>t</italic>), caused by plasticity (<xref ref-type="disp-formula" rid="pcbi.1005669.e047">Eq 21</xref>), can be negative or positive, so can <italic>S</italic>(Δ<italic>W</italic><sub><italic>ij</italic>,<italic>i</italic>′<italic>j</italic>′</sub>(<italic>t</italic>)). The constant <italic>C</italic> is chosen so that in the absence of any firing, coupling strengths reset toward their original values with a characteristic time scale of 7 seconds. For simulation efficiency, we only calculate <italic>S</italic> once every 100 time steps. We have found that the behaviour of our model is not dependent on the precise values of the time constants chosen, as long as the timescale of STDP is shorter than that of a single learning trial and that the timescale of synaptic scaling is much longer than both of these.</p>
<p>Even with these values chosen from experimental data, pathological behaviour can be observed, in which coupling strength changes caused by STDP can create unbounded positive feedback loops. As synaptic scaling acts over a long time scale, it does not react fast enough to prevent this from happening. In our model, as in [<xref ref-type="bibr" rid="pcbi.1005669.ref045">45</xref>], we use a hard limit on connection strengths as follows:
<disp-formula id="pcbi.1005669.e055"><alternatives><graphic id="pcbi.1005669.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mo>≤</mml:mo> <mml:mi>L</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
We set <italic>L</italic> = 0.12 which prevents connection strengths from being modified too significantly from their initial values. Using the above formulation of STDP and synaptic scaling, we can calculate the time-dependent coupling term from <xref ref-type="disp-formula" rid="pcbi.1005669.e047">Eq 21</xref> as follows:
<disp-formula id="pcbi.1005669.e056"><alternatives><graphic id="pcbi.1005669.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>λ</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>λ</mml:mo></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula></p>
<p>To incorporate external cues in our network model, without loss of generality, we let the external cue <italic>Ci</italic> have <italic>N</italic> = 40,000 synapses, with the post-synaptic neuron for each synapse chosen at random with replacement, i.e., an average of one connection per neuron in the 2D network. The initial strengths of these synapses are chosen at random so that the overall distribution of coupling strengths from the external cue is identical to the distribution of connections from a neuron in the 2D grid. Similarly, the synapses which connect the cue neurons to the neurons in the spatially extended neural circuit are mediated by both STDP and synaptic scaling, although as it is not possible for a feedback loop to form for a connection from the external cue, the limit on connection strengths given by <xref ref-type="disp-formula" rid="pcbi.1005669.e055">Eq 25</xref> is not applied.</p>
<sec id="sec011">
<title>Bias in connection strengths</title>
<p>Analyzing the overall effect of plasticity is difficult due to the large number of synaptic connections in our model. To simplify this analysis, we construct a per-neuron measure which determines the bias in connection strengths emanating from that particular neuron. In particular we are interested in the directional bias of connection strengths to understand how decisions can be made in the cued-choice task. If an excitatory neuron in the center stem is more strongly coupled to neurons on the left arm of the T-maze, the sequence will be more likely to travel along the left arm of the T-maze. We construct the following measure of the bias in connection strengths inspired by a center of mass calculation as follows:
<disp-formula id="pcbi.1005669.e057"><alternatives><graphic id="pcbi.1005669.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005669.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>|</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>W</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msup><mml:mi>j</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
This measure will be small if connections from the neuron to the left and right have similar strength, and large otherwise, allowing simple analysis of any bias present in the network.</p>
</sec>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005669.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Luczak</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Barthó</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Marguet</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>KD</given-names></name>. <article-title>Sequential structure of neocortical spontaneous activity in vivo</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2007</year>;<volume>104</volume>(<issue>1</issue>):<fpage>347</fpage>–<lpage>352</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0605643104" xlink:type="simple">10.1073/pnas.0605643104</ext-link></comment> <object-id pub-id-type="pmid">17185420</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harvey</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Coen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Tank</surname> <given-names>DW</given-names></name>. <article-title>Choice-specific sequences in parietal cortex during a virtual-navigation decision task</article-title>. <source>Nature</source>. <year>2012</year>;<volume>484</volume>(<issue>7392</issue>):<fpage>62</fpage>–<lpage>68</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10918" xlink:type="simple">10.1038/nature10918</ext-link></comment> <object-id pub-id-type="pmid">22419153</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crowe</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Chafee</surname> <given-names>MV</given-names></name>. <article-title>Rapid sequences of population activity patterns dynamically encode task-critical spatial information in parietal cortex</article-title>. <source>J Neurosci</source>. <year>2010</year>;<volume>30</volume>(<issue>35</issue>):<fpage>11640</fpage>–<lpage>11653</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0954-10.2010" xlink:type="simple">10.1523/JNEUROSCI.0954-10.2010</ext-link></comment> <object-id pub-id-type="pmid">20810885</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fujisawa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Amarasingham</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Harrison</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>. <article-title>Behavior-dependent short-term assembly dynamics in the medial prefrontal cortex</article-title>. <source>Nat Neurosci</source>. <year>2008</year>;<volume>11</volume>(<issue>7</issue>):<fpage>823</fpage>–<lpage>833</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2134" xlink:type="simple">10.1038/nn.2134</ext-link></comment> <object-id pub-id-type="pmid">18516033</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nádasdy</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Hirase</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Czurkó</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Csicsvari</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>. <article-title>Replay and time compression of recurring spike sequences in the hippocampus</article-title>. <source>J Neurosci</source>. <year>1999</year>;<volume>19</volume>(<issue>21</issue>):<fpage>9497</fpage>–<lpage>9507</lpage>. <object-id pub-id-type="pmid">10531452</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Redish</surname> <given-names>AD</given-names></name>. <article-title>Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point</article-title>. <source>J Neurosci</source>. <year>2007</year>;<volume>27</volume>(<issue>45</issue>):<fpage>12176</fpage>–<lpage>12189</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3761-07.2007" xlink:type="simple">10.1523/JNEUROSCI.3761-07.2007</ext-link></comment> <object-id pub-id-type="pmid">17989284</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Diba</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>. <article-title>Forward and reverse hippocampal place-cell sequences during ripples</article-title>. <source>Nat Neurosci</source>. <year>2007</year>;<volume>10</volume>(<issue>10</issue>):<fpage>1241</fpage>–<lpage>1242</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1961" xlink:type="simple">10.1038/nn1961</ext-link></comment> <object-id pub-id-type="pmid">17828259</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Foster</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Hippocampal theta sequences</article-title>. <source>Hippocampus</source>. <year>2007</year>;<volume>17</volume>(<issue>11</issue>):<fpage>1093</fpage>–<lpage>1099</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hipo.20345" xlink:type="simple">10.1002/hipo.20345</ext-link></comment> <object-id pub-id-type="pmid">17663452</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Louie</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Temporally structured replay of awake hippocampal ensemble activity during rapid eye movement sleep</article-title>. <source>Neuron</source>. <year>2001</year>;<volume>29</volume>(<issue>1</issue>):<fpage>145</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(01)00186-6" xlink:type="simple">10.1016/S0896-6273(01)00186-6</ext-link></comment> <object-id pub-id-type="pmid">11182087</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skaggs</surname> <given-names>WE</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Replay of neuronal firing sequences in rat hippocampus during sleep following spatial experience</article-title>. <source>Science</source>. <year>1996</year>;<volume>271</volume>(<issue>5257</issue>):<fpage>1870</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.271.5257.1870" xlink:type="simple">10.1126/science.271.5257.1870</ext-link></comment> <object-id pub-id-type="pmid">8596957</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pastalkova</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Itskov</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Amarasingham</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>. <article-title>Internally generated cell assembly sequences in the rat hippocampus</article-title>. <source>Science</source>. <year>2008</year>;<volume>321</volume>(<issue>5894</issue>):<fpage>1322</fpage>–<lpage>1327</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1159775" xlink:type="simple">10.1126/science.1159775</ext-link></comment> <object-id pub-id-type="pmid">18772431</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>van der Meer</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Lansink</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Pennartz</surname> <given-names>CM</given-names></name>. <article-title>Internally generated sequences in learning and executing goal-directed behavior</article-title>. <source>Trends Cogn Sci</source>. <year>2014</year>;<volume>18</volume>(<issue>12</issue>):<fpage>647</fpage>–<lpage>657</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2014.06.011" xlink:type="simple">10.1016/j.tics.2014.06.011</ext-link></comment> <object-id pub-id-type="pmid">25156191</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hahnloser</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Kozhevnikov</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Fee</surname> <given-names>MS</given-names></name>. <article-title>An ultra-sparse code underliesthe generation of neural sequences in a songbird</article-title>. <source>Nature</source>. <year>2002</year>;<volume>419</volume>(<issue>6902</issue>):<fpage>65</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature00974" xlink:type="simple">10.1038/nature00974</ext-link></comment> <object-id pub-id-type="pmid">12214232</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Recce</surname> <given-names>ML</given-names></name>. <article-title>Phase relationship between hippocampal place units and the EEG theta rhythm</article-title>. <source>Hippocampus</source>. <year>1993</year>;<volume>3</volume>(<issue>3</issue>):<fpage>317</fpage>–<lpage>330</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/hipo.450030307" xlink:type="simple">10.1002/hipo.450030307</ext-link></comment> <object-id pub-id-type="pmid">8353611</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pfeiffer</surname> <given-names>BE</given-names></name>, <name name-style="western"><surname>Foster</surname> <given-names>DJ</given-names></name>. <article-title>Hippocampal place-cell sequences depict future paths to remembered goals</article-title>. <source>Nature</source>. <year>2013</year>;<volume>497</volume>(<issue>7447</issue>):<fpage>74</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12112" xlink:type="simple">10.1038/nature12112</ext-link></comment> <object-id pub-id-type="pmid">23594744</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Memory, navigation and theta rhythm in the hippocampal-entorhinal system</article-title>. <source>Nat Neurosci</source>. <year>2013</year>;<volume>16</volume>(<issue>2</issue>):<fpage>130</fpage>–<lpage>138</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3304" xlink:type="simple">10.1038/nn.3304</ext-link></comment> <object-id pub-id-type="pmid">23354386</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Davidson</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Kloosterman</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>. <article-title>Hippocampal replay of extended experience</article-title>. <source>Neuron</source>. <year>2009</year>;<volume>63</volume>(<issue>4</issue>):<fpage>497</fpage>–<lpage>507</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2009.07.027" xlink:type="simple">10.1016/j.neuron.2009.07.027</ext-link></comment> <object-id pub-id-type="pmid">19709631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tort</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Kramer</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Thorn</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Kubota</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Graybiel</surname> <given-names>AM</given-names></name>, <etal>et al</etal>. <article-title>Dynamic cross-frequency couplings of local field potential oscillations in rat striatum and hippocampus during performance of a T-maze task</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2008</year>;<volume>105</volume>(<issue>51</issue>):<fpage>20517</fpage>–<lpage>20522</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0810524105" xlink:type="simple">10.1073/pnas.0810524105</ext-link></comment> <object-id pub-id-type="pmid">19074268</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abbott</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Blum</surname> <given-names>KI</given-names></name>. <article-title>Functional significance of long-term potentiation for sequence learning and prediction</article-title>. <source>Cerebral Cortex</source>. <year>1996</year>;<volume>6</volume>(<issue>3</issue>):<fpage>406</fpage>–<lpage>416</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/6.3.406" xlink:type="simple">10.1093/cercor/6.3.406</ext-link></comment> <object-id pub-id-type="pmid">8670667</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref020">
<label>20</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Anderson</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>JB</given-names></name>. <source>Optimal filtering</source>. <edition>1st ed</edition>. <publisher-loc>New York</publisher-loc>: <publisher-name>Dover Publications</publisher-name>; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005669.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Botvinick</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Toussaint</surname> <given-names>M</given-names></name>. <article-title>Planning as inference</article-title>. <source>Trends Cogn Sci</source>. <year>2012</year>;<volume>16</volume>(<issue>10</issue>):<fpage>485</fpage>–<lpage>488</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2012.08.006" xlink:type="simple">10.1016/j.tics.2012.08.006</ext-link></comment> <object-id pub-id-type="pmid">22940577</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dostrovsky</surname> <given-names>J</given-names></name>. <article-title>The hippocampus as a spatial map. Preliminary evidence from unit activity in the freely-moving rat</article-title>. <source>Brain Res</source>. <year>1971</year>;<volume>34</volume>(<issue>1</issue>):<fpage>171</fpage>–<lpage>175</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0006-8993(71)90358-1" xlink:type="simple">10.1016/0006-8993(71)90358-1</ext-link></comment> <object-id pub-id-type="pmid">5124915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hepler</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Olton</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Wenk</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Coyle</surname> <given-names>JT</given-names></name>. <article-title>Lesions in nucleus basalis magnocellularis and medial septal area of rats produce qualitatively similar memory impairments</article-title>. <source>J Neurosci</source>. <year>1985</year>;<volume>5</volume>(<issue>4</issue>):<fpage>866</fpage>–<lpage>873</lpage>. <object-id pub-id-type="pmid">4038997</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>Z</given-names></name>. <article-title>Bayesian filtering: From Kalman filters to particle filters, and beyond</article-title>. <source>Statistics</source>. <year>2003</year>;<volume>182</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/02331880309257" xlink:type="simple">10.1080/02331880309257</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref025">
<label>25</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <source>Bayesian data analysis</source>. <volume>vol. 2</volume>. <publisher-name>Chapman &amp; Hall/CRC</publisher-name> <publisher-loc>Boca Raton, FL, USA</publisher-loc>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005669.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rueckert</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kappel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tanneberg</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pecevski</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Peters</surname> <given-names>J</given-names></name>. <article-title>Recurrent spiking networks solve planning tasks</article-title>. <source>Scientific reports</source>. <year>2016</year>;<volume>6</volume>:<fpage>21142</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/srep21142" xlink:type="simple">10.1038/srep21142</ext-link></comment> <object-id pub-id-type="pmid">26888174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Martinet</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Sheynikhovich</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Benchenane</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Arleo</surname> <given-names>A</given-names></name>. <article-title>Spatial learning and action planning in a prefrontal cortical network model</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>(<issue>5</issue>):<fpage>e1002045</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002045" xlink:type="simple">10.1371/journal.pcbi.1002045</ext-link></comment> <object-id pub-id-type="pmid">21625569</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ponulak</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hopfield</surname> <given-names>JJ</given-names></name>. <article-title>Rapid, parallel path planning by propagating wavefronts of spiking neural activity</article-title>. <source>Front Comput Neurosci</source>. <year>2013</year>;<volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2013.00098" xlink:type="simple">10.3389/fncom.2013.00098</ext-link></comment> <object-id pub-id-type="pmid">23882213</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hasselmo</surname> <given-names>ME</given-names></name>. <article-title>A model of prefrontal cortical mechanisms for goal-directed behavior</article-title>. <source>J Cogn Neurosci</source>. <year>2005</year>;<volume>17</volume>(<issue>7</issue>):<fpage>1115</fpage>–<lpage>1129</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/0898929054475190" xlink:type="simple">10.1162/0898929054475190</ext-link></comment> <object-id pub-id-type="pmid">16102240</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Erdem</surname> <given-names>UM</given-names></name>, <name name-style="western"><surname>Hasselmo</surname> <given-names>M</given-names></name>. <article-title>A goal-directed spatial navigation model using forward trajectory planning based on grid cells</article-title>. <source>Eur J Neurosci</source>. <year>2012</year>;<volume>35</volume>(<issue>6</issue>):<fpage>916</fpage>–<lpage>931</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1460-9568.2012.08015.x" xlink:type="simple">10.1111/j.1460-9568.2012.08015.x</ext-link></comment> <object-id pub-id-type="pmid">22393918</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frémaux</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sprekeler</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Reinforcement learning using a continuous time actor-critic framework with spiking neurons</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>4</issue>):<fpage>e1003024</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003024" xlink:type="simple">10.1371/journal.pcbi.1003024</ext-link></comment> <object-id pub-id-type="pmid">23592970</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friedrich</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lengyel</surname> <given-names>M</given-names></name>. <article-title>Goal-directed decision making with spiking neurons</article-title>. <source>J Neurosci</source>. <year>2016</year>;<volume>36</volume>(<issue>5</issue>):<fpage>1529</fpage>–<lpage>1546</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2854-15.2016" xlink:type="simple">10.1523/JNEUROSCI.2854-15.2016</ext-link></comment> <object-id pub-id-type="pmid">26843636</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bi</surname> <given-names>Gq</given-names></name>, <name name-style="western"><surname>Poo</surname> <given-names>Mm</given-names></name>. <article-title>Synaptic modifications in cultured hippocampal neurons: dependence on spike timing, synaptic strength, and postsynaptic cell type</article-title>. <source>J Neurosci</source>. <year>1998</year>;<volume>18</volume>(<issue>24</issue>):<fpage>10464</fpage>–<lpage>10472</lpage>. <object-id pub-id-type="pmid">9852584</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Poo</surname> <given-names>Mm</given-names></name>. <article-title>Spike timing-dependent plasticity of neural circuits</article-title>. <source>Neuron</source>. <year>2004</year>;<volume>44</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2004.09.007" xlink:type="simple">10.1016/j.neuron.2004.09.007</ext-link></comment> <object-id pub-id-type="pmid">15450157</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Feldman</surname> <given-names>DE</given-names></name>. <article-title>Synaptic mechanisms for plasticity in neocortex</article-title>. <source>Ann Rev Neurosci</source>. <year>2009</year>;<volume>32</volume>:<fpage>33</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.neuro.051508.135516" xlink:type="simple">10.1146/annurev.neuro.051508.135516</ext-link></comment> <object-id pub-id-type="pmid">19400721</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Turrigiano</surname> <given-names>GG</given-names></name>. <article-title>The self-tuning neuron: synaptic scaling of excitatory synapses</article-title>. <source>Cell</source>. <year>2008</year>;<volume>135</volume>(<issue>3</issue>):<fpage>422</fpage>–<lpage>435</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2008.10.008" xlink:type="simple">10.1016/j.cell.2008.10.008</ext-link></comment> <object-id pub-id-type="pmid">18984155</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Effenberger</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Jost</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Levina</surname> <given-names>A</given-names></name>. <article-title>Self-organization in balanced state networks by STDP and homeostatic plasticity</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>9</issue>):<fpage>e1004420</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004420" xlink:type="simple">10.1371/journal.pcbi.1004420</ext-link></comment> <object-id pub-id-type="pmid">26335425</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Varela</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>S</given-names></name>. <article-title>Synaptic depression and cortical gain control</article-title>. <source>Science</source>. <year>1997</year>;<volume>275</volume>(<issue>5297</issue>):<fpage>221</fpage>–<lpage>224</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.275.5297.221" xlink:type="simple">10.1126/science.275.5297.221</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bienenstock</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Cooper</surname> <given-names>LN</given-names></name>, <name name-style="western"><surname>Munro</surname> <given-names>PW</given-names></name>. <article-title>Theory for the Development of Neuron Selectivity: Orientation Specificity and Binocular Interaction in Visual Cortex</article-title>. <source>J Neurosci</source>. <year>1982</year>;<volume>2</volume>(<issue>1</issue>):<fpage>32</fpage>–<lpage>48</lpage>. <object-id pub-id-type="pmid">7054394</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zenke</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>. <article-title>Hebbian plasticity requires compensatory processes on multiple timescales</article-title>. <source>Phil Trans R Soc Lond B Biol Sci</source>. <year>2017</year>;<volume>372</volume>(<issue>1715</issue>):<fpage>20160259</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2016.0259" xlink:type="simple">10.1098/rstb.2016.0259</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hopfield</surname> <given-names>JJ</given-names></name>. <article-title>Neurodynamics of mental exploration</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2010</year>;<volume>107</volume>(<issue>4</issue>):<fpage>1648</fpage>–<lpage>1653</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0913991107" xlink:type="simple">10.1073/pnas.0913991107</ext-link></comment> <object-id pub-id-type="pmid">20080534</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>LI</given-names></name>, <name name-style="western"><surname>Tao</surname> <given-names>HW</given-names></name>, <name name-style="western"><surname>Holt</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Poo</surname> <given-names>Mm</given-names></name>. <article-title>A critical window for cooperation and competition among developing retinotectal synapses</article-title>. <source>Nature</source>. <year>1998</year>;<volume>395</volume>(<issue>6697</issue>):<fpage>37</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/25665" xlink:type="simple">10.1038/25665</ext-link></comment> <object-id pub-id-type="pmid">9738497</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fröhlich</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Bazhenov</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>. <article-title>Pathological effect of homeostatic synaptic scaling on network dynamics in diseases of the cortex</article-title>. <source>J Neurosci</source>. <year>2008</year>;<volume>28</volume>(<issue>7</issue>):<fpage>1709</fpage>–<lpage>1720</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4263-07.2008" xlink:type="simple">10.1523/JNEUROSCI.4263-07.2008</ext-link></comment> <object-id pub-id-type="pmid">18272691</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Turrigiano</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Leslie</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Desai</surname> <given-names>NS</given-names></name>, <name name-style="western"><surname>Rutherford</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>SB</given-names></name>. <article-title>Activity-dependent scaling of quantal amplitude in neocortical neurons</article-title>. <source>Nature</source>. <year>1998</year>;<volume>391</volume>(<issue>6670</issue>):<fpage>892</fpage>–<lpage>896</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/36103" xlink:type="simple">10.1038/36103</ext-link></comment> <object-id pub-id-type="pmid">9495341</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005669.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abbott</surname> <given-names>LF</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>SB</given-names></name>. <article-title>Synaptic plasticity: taming the beast</article-title>. <source>Nat Neurosci</source>. <year>2000</year>;<volume>3</volume>(<issue>11s</issue>):<fpage>1178</fpage>–<lpage>1183</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/81453" xlink:type="simple">10.1038/81453</ext-link></comment> <object-id pub-id-type="pmid">11127835</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>