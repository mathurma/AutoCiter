<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00450</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005794</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Statistical distributions</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pharmacology</subject><subj-group><subject>Drugs</subject><subj-group><subject>Carbachol</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability density</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Fluidics</subject><subj-group><subject>Microfluidics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Signal transduction</subject><subj-group><subject>Cell signaling</subject><subj-group><subject>Paracrine signaling</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Endocrinology</subject><subj-group><subject>Endocrine physiology</subject><subj-group><subject>Paracrine signaling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Endocrine physiology</subject><subj-group><subject>Paracrine signaling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Endocrine physiology</subject><subj-group><subject>Paracrine signaling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Signal transduction</subject><subj-group><subject>Cell signaling</subject><subj-group><subject>Autocrine signaling</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Endocrinology</subject><subj-group><subject>Endocrine physiology</subject><subj-group><subject>Autocrine signaling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Endocrine physiology</subject><subj-group><subject>Autocrine signaling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Endocrine physiology</subject><subj-group><subject>Autocrine signaling</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>A Bayesian approach to modelling heterogeneous calcium responses in cell populations</article-title>
<alt-title alt-title-type="running-head">Bayesian inference and calcium oscillations</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6432-8978</contrib-id>
<name name-style="western">
<surname>Tilūnaitė</surname> <given-names>Agne</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6780-5944</contrib-id>
<name name-style="western">
<surname>Croft</surname> <given-names>Wayne</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Russell</surname> <given-names>Noah</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Bellamy</surname> <given-names>Tomas C.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Thul</surname> <given-names>Rüdiger</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Mathematical Sciences, University of Nottingham, Nottingham, England, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>School of Life Sciences, University of Nottingham, Nottingham, England, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Electrical and Electronic Engineering, University of Nottingham, Nottingham, England, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Maini</surname> <given-names>Philip K</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Oxford, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">ruediger.thul@nottingham.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>10</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>6</day>
<month>10</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>10</issue>
<elocation-id>e1005794</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>3</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>27</day>
<month>9</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Tilūnaitė et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005794"/>
<abstract>
<p>Calcium responses have been observed as spikes of the whole-cell calcium concentration in numerous cell types and are essential for translating extracellular stimuli into cellular responses. While there are several suggestions for how this encoding is achieved, we still lack a comprehensive theory. To achieve this goal it is necessary to reliably predict the temporal evolution of calcium spike sequences for a given stimulus. Here, we propose a modelling framework that allows us to quantitatively describe the timing of calcium spikes. Using a Bayesian approach, we show that Gaussian processes model calcium spike rates with high fidelity and perform better than standard tools such as peri-stimulus time histograms and kernel smoothing. We employ our modelling concept to analyse calcium spike sequences from dynamically-stimulated HEK293T cells. Under these conditions, different cells often experience diverse stimulus time courses, which is a situation likely to occur <italic>in vivo</italic>. This single cell variability and the concomitant small number of calcium spikes per cell pose a significant modelling challenge, but we demonstrate that Gaussian processes can successfully describe calcium spike rates in these circumstances. Our results therefore pave the way towards a statistical description of heterogeneous calcium oscillations in a dynamic environment.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Upon stimulation a large number of cell types respond with transient increases of the intracellular calcium concentration, which often take the form of repetitive spikes. It is therefore believed that calcium spikes play a central role in cellular signal transduction. A critical feature of these calcium spikes is that they occur randomly, which raises the question of how we can predict the timing of calcium spikes. We here show that by using Bayesian ideas and concepts from stochastic processes, we can quantitatively compute the calcium spike rate for a given stimulus. Our analysis also demonstrates that traditional methods for spike rate estimation perform less favourably compared to a Bayesian approach when small numbers of cells are investigated. To test our methodology under conditions that closely mimic those experienced <italic>in vivo</italic> we challenged cells with agonist concentrations that vary both in space and time. We find that cells that experience similar stimulus profiles are described by similar calcium spike rates. This suggests that calcium spike rates may constitute a quantitative description of whole-cell calcium spiking that reflects both the randomness and the spatiotemporal organisation of the calcium signalling machinery.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000275</institution-id>
<institution>Leverhulme Trust</institution>
</institution-wrap>
</funding-source>
<award-id>RPG-2012-628</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Bellamy</surname> <given-names>Tomas C.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000266</institution-id>
<institution>Engineering and Physical Sciences Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>EP/H022112/1</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Russell</surname> <given-names>Noah</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>AT and WC were supported by the Leverhulme Trust [<ext-link ext-link-type="uri" xlink:href="http://www.leverhulme.ac.uk" xlink:type="simple">www.leverhulme.ac.uk</ext-link>, grant number RPG-2012-628]. This work was supported by the Engineering and Physical Sciences Research Council <ext-link ext-link-type="uri" xlink:href="http://gow.epsrc.ac.uk" xlink:type="simple">http://gow.epsrc.ac.uk</ext-link>, grant number EP/H022112/1.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-10-18</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Transient changes in the intracellular calcium (Ca<sup>2+</sup>) concentration have long been associated with the activation of plasma membrane receptors [<xref ref-type="bibr" rid="pcbi.1005794.ref001">1</xref>]. Since the seminal work by Woods et al. [<xref ref-type="bibr" rid="pcbi.1005794.ref002">2</xref>] linking the frequency of cytosolic Ca<sup>2+</sup> oscillations in hepatocytes to the concentration of various hormones, both experimental and theoretical studies have provided compelling evidence for encoding extracellular stimuli into intracellular Ca<sup>2+</sup> oscillations [<xref ref-type="bibr" rid="pcbi.1005794.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1005794.ref014">14</xref>]. In whole-cell recordings, Ca<sup>2+</sup> oscillations are usually observed as sequences of spikes of the intracellular Ca<sup>2+</sup> concentration.</p>
<p>A prominent feature of Ca<sup>2+</sup> spike sequences is that they are random. Ca<sup>2+</sup> spikes only occur with some probability that generally changes over time. For example, there are distributions of inter-spike intervals (ISIs) for agonist induced Ca<sup>2+</sup> oscillations in HEK293 cells and spontaneous Ca<sup>2+</sup> oscillations in astrocytes, microglia and PLA cells instead of a single value [<xref ref-type="bibr" rid="pcbi.1005794.ref015">15</xref>]. When astrocytes are transiently stimulated with ATP three times, with a recovery period between stimuli, the observed Ca<sup>2+</sup> spikes display any number of response patterns, from no spikes to three [<xref ref-type="bibr" rid="pcbi.1005794.ref016">16</xref>]. To elucidate the principles that govern the translation of extracellular cues into changes of the intracellular Ca<sup>2+</sup> concentration therefore requires faithfully capturing the stochasticity in Ca<sup>2+</sup> spike generation.</p>
<p>To date, the main modelling approach to investigate stochastic Ca<sup>2+</sup> spike generation has been based on numerical solutions of differential equations, both ordinary and partial [<xref ref-type="bibr" rid="pcbi.1005794.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1005794.ref030">30</xref>]. In these studies, the randomness of Ca<sup>2+</sup> spikes results from the stochastic behaviour of Ca<sup>2+</sup> releasing channels, such as the inositol-1,4,5-trisphosphate (InsP<sub>3</sub>) receptor (InsP<sub>3</sub>R), and their interactions. The random dynamics of the InsP<sub>3</sub>R is then either described by coupling a Markov chain for the InsP<sub>3</sub>R to the differential equations, or by assuming a Langevin-type equation. All of these approaches require detailed models of the InsP<sub>3</sub>R (with often a considerable number of rate constants), and other assumptions such as the number of InsP<sub>3</sub>Rs per cluster and the spatial distribution of InsP<sub>3</sub>Rs, Ca<sup>2+</sup> pumps and Ca<sup>2+</sup> buffers in the case of partial differential equations. However, such mechanistic detail, which has been instrumental in advancing our understanding of Ca<sup>2+</sup> spikes, often comes at considerable computational costs.</p>
<p>It might be therefore desirable to change the perspective from the mechanistic bottom-up approach to a top-down view, in which cellular Ca<sup>2+</sup> spikes are described directly. The mathematical concept that has proven particularly useful for this endeavour is the theory of point processes [<xref ref-type="bibr" rid="pcbi.1005794.ref031">31</xref>]. Indeed, in [<xref ref-type="bibr" rid="pcbi.1005794.ref015">15</xref>] a time-dependent conditional rate for the generation of a Ca<sup>2+</sup> spike was introduced, and its two parameters (a time scale and an amplitude) were determined from experiments on four different cell types. Subsequent work [<xref ref-type="bibr" rid="pcbi.1005794.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref033">33</xref>] demonstrated in more detail that for constant stimulation, the time scale was cell type specific, while different cells of the same type could be distinguished by their amplitude.</p>
<p>These modelling approaches have not confronted the issue of the dynamic nature of cell stimulation that occurs under physiological conditions. Cells in vivo experience a complex and dynamically-changing environment, where signals frequently arrive in a time-varying manner—such as transient release of neurotransmitters or oscillations in the concentration of circulating hormones. Diffusion of messengers through tissue (such as away from a blood vessel) also introduce spatial variation in signal strength, meaning that cell populations encounter a complex spatiotemporal pattern of stimulation. An efficient mechanism for modelling Ca<sup>2+</sup> responses in such a heterogeneous population has not yet been devised. Our approach offers a solution to this issue and is based on combining point processes with Bayesian inference.</p>
<p>Bayesian concepts have been used with great success across various disciplines (see e.g. [<xref ref-type="bibr" rid="pcbi.1005794.ref034">34</xref>] for an overview). One advantage of utilising Bayesian ideas is that model parameters can be effectively constrained by observed data and can be estimated in a controlled fashion. For example, each set of parameter values comes with its own probability that informs us about how likely this set represents the observed data. In the past, the combination of Bayesian inference and point processes has been successfully applied to action potential spike trains in neurons [<xref ref-type="bibr" rid="pcbi.1005794.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref036">36</xref>], but to our knowledge, this is the first time that Ca<sup>2+</sup> spike sequences have been analysed in this way. While we can draw on these previous results, the substantial differences between action potential spike trains and Ca<sup>2+</sup> spike sequences (e.g. the number of spikes per train or the time scales of spikes) have required significant attention.</p>
<p>A particular characteristic of Ca<sup>2+</sup> spikes is that their generation depends on the cellular Ca<sup>2+</sup> spike history and hence is non-Markovian. This results from both the stochastic nature of Ca<sup>2+</sup> spike formation as well as the dynamic variation in the cellular signalling micro-environment. To model such history dependence, we follow a concept introduced in [<xref ref-type="bibr" rid="pcbi.1005794.ref037">37</xref>], which effectively turns a non-Markovian Ca<sup>2+</sup> spike sequence into a Markovian one. This is achieved with the help of a so-called intensity function <italic>x</italic>(<italic>t</italic>), for which we provide a definition and more details in the Materials and Methods section. Since the intensity function is directly inferred from individual Ca<sup>2+</sup> spike sequences, it is specific to each cell. This results from two facts. Firstly, Ca<sup>2+</sup> spikes are shaped by the cellular composition of the Ca<sup>2+</sup> signalling toolkit, i.e. the expression levels and spatial arrangement of Ca<sup>2+</sup> channels, pumps, transporters and buffers. Secondly, each cell experiences a different signalling micro-environment as illustrated above. Autocrine and paracrine signalling modify the original signal further. In addition, any time-dependence of <italic>x</italic>(<italic>t</italic>) that originates from a time varying signal is compounded by dynamic changes of the Ca<sup>2+</sup> signalling apparatus, such as Ca<sup>2+</sup> store refilling, adaptation or desensitisation.</p>
<p>In the present paper we demonstrate how to estimate <italic>x</italic>(<italic>t</italic>) in the presence of such single cell variability. This will allow us to make progress in two main directions. Firstly, one of the most highly discussed questions in computational biology is concerned with scaling dynamics from single cells to tissue. Taking into account our current understanding of intracellular Ca<sup>2+</sup> signalling, this will require the simulation of spatially extended single cells driven by fluctuating Ca<sup>2+</sup> releasing channels. The computational costs for such studies are extraordinary, and how to sample the associated high dimensional parameter space remains an open challenge. On the other hand, generating Ca<sup>2+</sup> spike sequences from an intensity function is computationally cheap and hence puts researchers in an advantageous position to obtain high quality statistical insights into tissue level dynamics. Secondly, while our approach is statistical, the Ca<sup>2+</sup> ISI distribution that we determine as part of estimating <italic>x</italic>(<italic>t</italic>) has direct mechanistic interpretations. This may further our understanding of how exactly Ca<sup>2+</sup> spikes emerge at the single cell level from the orchestrated action of the Ca<sup>2+</sup> signalling toolkit. For instance, one line of argument suggests that Ca<sup>2+</sup> spikes result from the co-ordinated interplay of a certain number of Ca<sup>2+</sup> puffs. Our statistical analysis may provide quantitative estimates for this.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>ISI statistics of Ca<sup>2+</sup> spikes</title>
<p>A main motivation for our study is the need to model the heterogeneity of Ca<sup>2+</sup> responses observed in cell populations in a computationally efficient manner. To illustrate the problem, the results in <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1</xref> show HEK293T cells challenged with a solution containing 100 <italic>μ</italic>M carbachol. <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1B</xref> illustrates the large variability of Ca<sup>2+</sup> responses observed between different cells even when the stimulus is stationary. While some cells only detect the onset of the stimulus (third trace), other cells exhibit Ca<sup>2+</sup> spikes during the entire stimulation period. However, the spike characteristics vary significantly. Some cells show irregular Ca<sup>2+</sup> spikes (first trace), while other cells settle into an almost regular pattern (fourth trace). It is also worth noting that the frequency of Ca<sup>2+</sup> spikes spans a considerable range (cf. first and second trace) and that all cells display a decrease in peak amplitude, which is indicative of adaptation. <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1C</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005794.s006">S1 Video</xref> provide further evidence for the large heterogeneity in the timing of Ca<sup>2+</sup> spikes for a constant stimulus.</p>
<fig id="pcbi.1005794.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005794.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Heterogeneous Ca<sup>2+</sup> responses.</title>
<p>Cellular Ca<sup>2+</sup> responses to a step-change in agonist concentration. (A) Cultured HEK293T cells were seeded in micro-channels, loaded with Fluo-5F AM (inset, scale bar: 10 <italic>μ</italic>M) and perfused with imaging buffer. A step-change in flow rates between solution containing carbachol (100 <italic>μ</italic>M) plus AF594 (2 nM) and buffer alone results in delivery of agonist (and AF594 indicator) to stimulate the cells. Mean (black) ± SEM (red) AF594 fluorescence from ROIs centred on cells within the microfluidics channel, showing onset of agonist exposure. (B) Normalised Fluo-5F fluorescence intensity traces show typical Ca<sup>2+</sup> responses from four representative cells. (C) Raster plot of the pattern of Ca<sup>2+</sup> spikes detected in the entire cell population. The Ca<sup>2+</sup> spike sequences follow no particular order.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.g001" xlink:type="simple"/>
</fig>
<p>The first step in developing a top-down model that reproduces this heterogeneity is to determine the probability distribution that most accurately describes recorded ISIs. Throughout this study, Ca<sup>2+</sup> spikes are treated as all-or-nothing events and any information on the width or amplitude of a Ca<sup>2+</sup> spike is excluded. The reason why we can introduce an ISI distribution and hence treat successive ISIs as independent—instead of trying to fit a time-dependent ISI distribution—comes from the introduction of the intensity function <italic>x</italic>(<italic>t</italic>). We tested three possible candidate ISI statistics (see <xref ref-type="sec" rid="sec008">Materials and methods</xref> for details): an inhomogeneous Poisson (IP), an inhomogeneous Gamma (IG) and an inhomogeneous inverse Gaussian (IIG) distribution. The IP distribution often serves as starting point for analysing spiking behaviour as it is the most basic statistical distribution. While the parsimony of the IP distribution has undoubtedly helped in establishing a large body of mathematical results, real world data often exhibit more complex statistics. The IG distribution provides a natural extension of the IP distribution, in that it contains the IP distribution as a special case: putting <italic>γ</italic> = 1 in <xref ref-type="disp-formula" rid="pcbi.1005794.e010">(5)</xref> recovers <xref ref-type="disp-formula" rid="pcbi.1005794.e018">(10)</xref>. The shape parameter <italic>γ</italic> endows the IG distribution with more flexibility, which has proven fruitful in numerous applications. Conceptually, spikes in general and Ca<sup>2+</sup> spikes in particular have been described as first passage events [<xref ref-type="bibr" rid="pcbi.1005794.ref038">38</xref>]. One of the most fundamental models, which contains positive drift and random motion only, gives rise to the IIG distribution.</p>
<p>To ascertain which ISI distribution describes the results in <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1</xref> best, we transformed the recorded ISIs using the time rescaling theorem and analysed the results in a Kolmogorov-Smirnov plot (see <xref ref-type="sec" rid="sec008">Material and methods</xref>). The Kolmogorov-Smirnov plot allows the visual inspection of whether two probability distributions are the same by plotting their respective cumulative distribution functions against one another. If the two distributions are identical, the cumulative distributions functions coincide and plotting one against the other results in a straight line with slope 1. <xref ref-type="fig" rid="pcbi.1005794.g002">Fig 2A</xref> shows results for the Kolmogorov-Smirnov plot for the data taken from <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1</xref>. Here, <italic>u</italic> corresponds to the cumulative distribution of the transformed data, which depends on the chosen ISI distribution, while <italic>s</italic> stems from a theoretical prediction based on the time rescaling theorem (see <xref ref-type="sec" rid="sec008">Materials and methods</xref>). If we have identified the correct ISI distribution, data points should cluster around a straight line with a 45° slope. Note that in our analysis, each cell was treated individually and no data amalgamation took place.</p>
<fig id="pcbi.1005794.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005794.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Determining Ca<sup>2+</sup> spike ISI statistics.</title>
<p>Kolmogorov-Smirnov plots for Ca<sup>2+</sup> spike sequences in HEK293T cells stimulated with (A) 100<italic>μ</italic>M and (B) 10<italic>μ</italic>M carbachol when the ISI statistics is assumed to be an IIG (blue), IP (red) and IG (grey) distribution. Box and whisker plots summarising the Kolmogorov-Smirnov plots for (C) 100<italic>μ</italic>M and (D) 10<italic>μ</italic>M carbachol stimulation for the IP, IIG and IG models. The results in (A) and (C) are based on the data shown in <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1</xref>. In (C) and (D), the box extends from the first quartile (Q1) to the third quartile (Q3) with the red line at the median. The lower whisker corresponds to the smallest data point that is bigger than Q1−1.5×IQR, while the upper whisker extends to the largest value that is smaller than Q3+1.5×IQR, where IQR denotes the interquartile range Q3-Q1. We used 42 cells in (A), (C) and 21 cells in (B), (D).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.g002" xlink:type="simple"/>
</fig>
<p>Results for the IP and IIG clearly deviate from a line with slope 1, while the data for the IG exhibit much less deviation. This suggests that an IG, but not an IP or IIG, better describes the ISI statistics of Ca<sup>2+</sup> spikes. The box plots in <xref ref-type="fig" rid="pcbi.1005794.g002">Fig 2C</xref> provide further quantitative evidence. They demonstrate that the slopes obtained from individual cells are concentrated close to 1 and exhibit a significantly smaller variability for the IG compared to the IP and IIG. To further corroborate these findings, we analysed data from cells exposed to a lower concentration of carbachol (10<italic>μ</italic>M). <xref ref-type="fig" rid="pcbi.1005794.g002">Fig 2B and 2D</xref> illustrate that again the IG distribution captures the ISI statistics most closely. In addition to Kolmogorov-Smirnov plots, we also tested our data with a quantile-quantile plot (see <xref ref-type="supplementary-material" rid="pcbi.1005794.s001">S1 Fig</xref> and <xref ref-type="sec" rid="sec008">Materials and methods</xref>). As with the Kolmogorov-Smirnov plot the correct ISI distribution leads to data points that accumulate around the 45° line. Panels A and B in <xref ref-type="supplementary-material" rid="pcbi.1005794.s001">S1 Fig</xref> show that this is the case for the IG, but not for the IP and IIG, hence confirming our results from the Kolmogorov-Smirnov plot. The box plots in panels C and D of <xref ref-type="supplementary-material" rid="pcbi.1005794.s001">S1 Fig</xref> show that again the slopes obtained from single cells for the IG model are much closer to one and exhibit less variability than those for the IP and IIG. Taken together, these results indicate that the patterns of Ca<sup>2+</sup> spikes observed across the population of cells can most accurately be reproduced with an IG distribution. This approach will therefore be used as the basis of our analysis.</p>
<p>It is worth noting that when testing the different ISI distributions, we also obtain an estimate for the intensity function <italic>x</italic>(<italic>t</italic>). As illustrated by <xref ref-type="disp-formula" rid="pcbi.1005794.e020">Eq (11)</xref>, the probability for a specific ISI depends on <italic>x</italic>(<italic>t</italic>). Therefore, all ISI distributions in this study have to be understood as being conditioned on <italic>x</italic>(<italic>t</italic>). In the next section, we show how to estimate <italic>x</italic>(<italic>t</italic>) from measured Ca<sup>2+</sup> spike sequences.</p>
</sec>
<sec id="sec004">
<title>Performance of Ca<sup>2+</sup> spike rate estimation</title>
<p>In addition to the ISI distribution, we also need to know the intensity function <italic>x</italic>(<italic>t</italic>) to fully describe Ca<sup>2+</sup> spike sequences. In the following, we will use three different approaches to estimate <italic>x</italic>(<italic>t</italic>): peri-stimulus time histograms (PSTHs), kernel smoothing (KS), and Gaussian processes (GPs) combined with Bayesian inference. An illustration of a GP is shown in <xref ref-type="fig" rid="pcbi.1005794.g003">Fig 3</xref>. In contrast to a deterministic curve, a GP generates infinitely many curves (3 possible candidates are shown), and the <italic>statistics</italic> of these curves is the organising principle. At each time point, the values of a GP are Gaussian distributed, and the mean and standard deviation can change over time. To guarantee a controlled comparison between PSTHs, KS and GPs, we will fix an intensity function, generate surrogate Ca<sup>2+</sup> spike sequences from it and then estimate how well the above methods recapture the original intensity function (see <xref ref-type="sec" rid="sec008">Materials and methods</xref> for details).</p>
<fig id="pcbi.1005794.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005794.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Gaussian process.</title>
<p>Three realisations of a GP (red, green, purple) around a time-dependent mean (black line). The blue area delineates the 95% confidence interval. Note the changes in width, which reflect a time-dependent standard deviation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.g003" xlink:type="simple"/>
</fig>
<p>Before proceeding it is worth noting that the intensity function that we need to estimate is identical to the Ca<sup>2+</sup> spike rate that we find from using either PSTHs or KS [<xref ref-type="bibr" rid="pcbi.1005794.ref036">36</xref>]. In other words, if we can obtain a high quality estimate for the Ca<sup>2+</sup> spike rate from either PSTHs or KS, we have a very good estimate for <italic>x</italic>(<italic>t</italic>). However, this usually requires a large number of Ca<sup>2+</sup> spike sequences, which is an issue that we will address below. Since we can identify the Ca<sup>2+</sup> spike rate with the intensity function, we will use both terms interchangeably. Note, however, that this Ca<sup>2+</sup> spike rate is different from the conditional intensity function defined in <xref ref-type="disp-formula" rid="pcbi.1005794.e029">Eq (15)</xref>, which is often used in generating spike trains.</p>
<p>A major objective of this model is to reproduce Ca<sup>2+</sup> signalling patterns during complex stimulation conditions. For example, physiological patterns of hormone or neurotransmitter release are time-varying, rather than the step-changes used in typical experiments (such as <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1</xref>). We therefore tested the performance of candidates for <italic>x</italic>(<italic>t</italic>) for reproducing dynamically-changing signals—specifically sinusoidal oscillations. As a first choice, we considered a regularly oscillating intensity function <italic>x</italic><sub>det</sub>(<italic>t</italic>) = 0.5 cos(<italic>t</italic>) + 0.5 cos(0.5<italic>t</italic>) + 1. <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4A</xref> shows Ca<sup>2+</sup> spike sequences generated from <italic>x</italic><sub>det</sub>, and <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4C</xref> reveals that both PSTH and KS capture the original intensity function very well.</p>
<fig id="pcbi.1005794.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005794.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Ca<sup>2+</sup> spike sequences.</title>
<p>(A-B) Raster plots of 40 out of 100 Ca<sup>2+</sup> spike sequences simulated from <italic>x</italic><sub>det</sub> and <italic>x</italic><sub>GP</sub>, respectively. (C-D) Estimations of <italic>x</italic><sub>det</sub> and <italic>x</italic><sub>GP</sub> from all generated Ca<sup>2+</sup> spike sequences based on a PSTH (beige) and KS (solid blue). The true values of <italic>x</italic><sub>det</sub> and <italic>x</italic><sub>GP</sub> are shown as a dashed red line. Ca<sup>2+</sup> spike sequences were generated using inverse sampling. Parameter values are (A,C) <italic>γ</italic> = 5.9 and (B,D) <italic>μ</italic> = 2.1, <italic>σ</italic><sub><italic>f</italic></sub> = 1.5, <italic>κ</italic> = 0.5 and <italic>γ</italic> = 6.2.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.g004" xlink:type="simple"/>
</fig>
<p>By using a specific functional form for <italic>x</italic>(<italic>t</italic>) as in <italic>x</italic><sub>det</sub>(<italic>t</italic>), we make strong assumptions about the intensity function. A more flexible and versatile approach is based on GPs. In <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4B</xref> we plot Ca<sup>2+</sup> spike sequences generated from one <italic>x</italic><sub>GP</sub> candidate, while <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4D</xref> depicts the estimation of <italic>x</italic><sub>GP</sub> from a PSTH and KS. As with <italic>x</italic><sub>det</sub> we find very good agreement between the original and estimated Ca<sup>2+</sup> spike rate.</p>
<p>This strategy supposes that all Ca<sup>2+</sup> spike sequences can be combined into a single large dataset, but in a physiological context this will not always be true. To be a more useful tool, the model should be able to simulate the diversity of responses expected in a more complex environment, where the stimulus varies in both space and time. Under these circumstances, the number of cells that receive an equivalent stimulus would be more limited, and so it is important to assess how the number of spike sequences available for parameter estimation affects the accuracy of predicting the Ca<sup>2+</sup> spike rate. Consequently, we randomly picked groups of 1, 2, 4 and 7 Ca<sup>2+</sup> spike sequences and computed the Ca<sup>2+</sup> spike rate based on a GP and KS.</p>
<p>In <xref ref-type="fig" rid="pcbi.1005794.g005">Fig 5</xref> we show results for <italic>x</italic><sub>GP</sub>. Since the Ca<sup>2+</sup> spike rate estimation obtained from KS depends on the bandwidths <italic>σ</italic> (see <xref ref-type="disp-formula" rid="pcbi.1005794.e035">Eq (17)</xref>), we employed different <italic>σ</italic> values. For a single Ca<sup>2+</sup> spike sequence (<xref ref-type="fig" rid="pcbi.1005794.g005">Fig 5A</xref>) the estimated Ca<sup>2+</sup> spike rates differ visibly from the theoretical one, and the smallest bandwidth leads to spurious oscillations. As we increase the number of Ca<sup>2+</sup> spike sequences the estimated Ca<sup>2+</sup> spike rates capture the true Ca<sup>2+</sup> spike rate more faithfully. The light blue area in each panel delineates the 95% confidence interval, which we obtain as a by-product from the GP optimisation. Overall, all estimates lie within this confidence interval except the one for <inline-formula id="pcbi.1005794.e001"><alternatives><graphic id="pcbi.1005794.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in <xref ref-type="fig" rid="pcbi.1005794.g005">Fig 5A</xref> (see <xref ref-type="sec" rid="sec008">Materials and methods</xref> for the definition of <inline-formula id="pcbi.1005794.e002"><alternatives><graphic id="pcbi.1005794.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>). We obtain similar results for <italic>x</italic><sub>det</sub>(<italic>t</italic>) as illustrated with <xref ref-type="supplementary-material" rid="pcbi.1005794.s002">S2 Fig</xref>.</p>
<fig id="pcbi.1005794.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005794.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Ca<sup>2+</sup> spike rate estimation.</title>
<p>Spike rate estimations for data shown in <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4B</xref> for 1 (A), 2 (B), 4 (C) and 7 (D) randomly chosen Ca<sup>2+</sup> spike sequences (black dots) using KS with <italic>σ</italic> = 35 (grey), 52 (orange), 70 (purple), and <inline-formula id="pcbi.1005794.e003"><alternatives><graphic id="pcbi.1005794.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (blue). The black line denotes results from a GP(black). The dotted red line indicates the original Ca<sup>2+</sup> spike rate. The light blue areas delineate the 95% GP estimation confidence interval.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.g005" xlink:type="simple"/>
</fig>
<p>We quantified the accuracy of predicting the Ca<sup>2+</sup> spike rate by computing the normalised <italic>L</italic><sub>2</sub> norm of the difference between the known and estimated Ca<sup>2+</sup> spike rate (see <xref ref-type="sec" rid="sec008">Materials and methods</xref>). <xref ref-type="fig" rid="pcbi.1005794.g006">Fig 6</xref> shows that for a given method, the <italic>L</italic><sub>2</sub> norm decreases as we increase the number of Ca<sup>2+</sup> spike sequences, which corresponds to better predictions. When we fix the number of Ca<sup>2+</sup> spike sequences, GPs yield a better estimate. The improvement is particularly evident when comparing the Ca<sup>2+</sup> spike rate estimation based on <inline-formula id="pcbi.1005794.e004"><alternatives><graphic id="pcbi.1005794.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> at small numbers of Ca<sup>2+</sup> spike sequences. We further tested that our results did not depend on the particular choice of Ca<sup>2+</sup> spike sequences nor on the details of the surrogate generator. For the latter, we compared three different approaches: inverse sampling, a Bernoulli process and time rescaling. We generated a number of Ca<sup>2+</sup> spike sequences with each method and then estimated the Ca<sup>2+</sup> spike rate using the same methods as in <xref ref-type="fig" rid="pcbi.1005794.g006">Fig 6</xref>, i.e. KS with different bandwidths and GPs. <xref ref-type="supplementary-material" rid="pcbi.1005794.s003">S3 Fig</xref> shows box plots of the normalised <italic>L</italic><sub>2</sub> norm between the estimated and the true Ca<sup>2+</sup> spike rate <italic>x</italic><sub>det</sub>. We find that for all three methods, the normalised <italic>L</italic><sub>2</sub> norm is generally smallest for GP estimates. To test the statistical significance of this result, we computed the corresponding <italic>p</italic>-values as shown in <xref ref-type="supplementary-material" rid="pcbi.1005794.s005">S1 Table</xref> using the non-parametric Mann-Whitney test. Based on the common assumption that a finding is statistically significant if <italic>p</italic> &lt; 0.05, estimates using GPs perform statistically better than KS since the largest <italic>p</italic> value was 0.0375. We repeated the analysis for <italic>x</italic><sub>GP</sub> and report the normalised <italic>L</italic><sub>2</sub> norm in <xref ref-type="supplementary-material" rid="pcbi.1005794.s004">S4 Fig</xref>. While the GP performs clearly better than KS with bandwidths of <inline-formula id="pcbi.1005794.e005"><alternatives><graphic id="pcbi.1005794.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and 35, the distributional results for bandwidths of 52 and 70 look similar to those of the GP. This is also confirmed by the <italic>p</italic>-values shown in <xref ref-type="supplementary-material" rid="pcbi.1005794.s005">S1 Table</xref>, where some exceed the threshold of 0.05. This indicates that KS can approach the performance of GPs. However, since there are no <italic>a priori</italic> estimates for this optimal bandwidths for a given scenario, GPs provide the more robust estimation method.</p>
<fig id="pcbi.1005794.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005794.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Comparison of Ca<sup>2+</sup> spike rate estimations.</title>
<p>Normalised <italic>L</italic><sub>2</sub> norm for the estimates of <italic>x</italic><sub>det</sub> (A) and <italic>x</italic><sub>GP</sub> (B) from the results in <xref ref-type="fig" rid="pcbi.1005794.g005">Fig 5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005794.s002">S2 Fig</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.g006" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Estimation of Ca<sup>2+</sup> spike rates in HEK293T cells</title>
<p>The results so far provide strong evidence that an intensity function derived from a GP allows accurate prediction of Ca<sup>2+</sup> spike patterns even when the estimate is based on small numbers of Ca<sup>2+</sup> spike sequences. We next applied our Bayesian approach to a more complex experimental system, designed to reproduce some of the stimulus heterogeneity expected <italic>in vivo</italic>.</p>
<p>We used a microfluidics chamber to deliver sinusoidal changes in carbachol concentration to HEK293T cells (see <xref ref-type="sec" rid="sec008">Materials and methods</xref>). The concentration of carbachol varied in both space and time. <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7A</xref> shows a complex concentration surface throughout the chamber at a fixed time point and illustrates how the sharp interface between high and low agonist concentration on the left side of the chamber widens as the flow progresses through the chamber. In <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7B</xref> we plot agonist concentration time courses sampled at four positions along the transverse direction of the microfluidics chamber, which demonstrates the stimulation heterogeneity that cells experience depending on their position within the chamber. We also include the corresponding Ca<sup>2+</sup> spike sequences, which again display significant variability. The goal of this experiment was to generate an environment in which a population of cells is exposed to agonist in a manner that varies with the cells’ distance from the stimulus source and with a dynamic mechanism of delivery (by analogy to a circulating hormone diffusing from a blood vessel to underlying cells, for example).</p>
<fig id="pcbi.1005794.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005794.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Dynamically stimulated HEK293T cells.</title>
<p>(A) Simulation of complex concentration surface generated inside the microfluidics chamber after transiently varying relative flow rates of agonist and buffer input streams (COMSOL Multiphysics, COMSOL Ltd, Cambridge, UK). (B) Agonist concentration (indicated by AF594 fluorescence; red lines) and normalised Fluo-5F fluorescence intensity traces (black lines) from ROIs centred on 4 cells across the width of the channel upon applying a single sine-wave stimulation regime. Stimulus fluorescence (C), raster plots (D) and GP Ca<sup>2+</sup> spike rate estimations (E) for each cluster in <xref ref-type="fig" rid="pcbi.1005794.g008">Fig 8</xref>. Black lines denote the mean stimulus (C) and the mean Ca<sup>2+</sup> spike rate (E) in each group, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.g007" xlink:type="simple"/>
</fig>
<p>This scenario is the context in which a Bayesian framework is most useful, as it can predict spiking Ca<sup>2+</sup> responses to a complex but physiologically meaningful stimulus profile. In <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7C–7E</xref>, we show clustered stimulus curves, the corresponding Ca<sup>2+</sup> spike sequences and the estimated intensity functions, respectively. We grouped cells that experienced similar agonist concentration profiles to allow for a meaningful comparison of the resultant intensity functions. To determine how similar stimulus traces are, we computed the weights of the three leading principal components (see <xref ref-type="sec" rid="sec008">Materials and methods</xref>). Results are shown in <xref ref-type="fig" rid="pcbi.1005794.g008">Fig 8</xref>, where we employed <italic>k</italic>-means [<xref ref-type="bibr" rid="pcbi.1005794.ref039">39</xref>] to detect possible clusters. Data points that belong to the same group are plotted in the same colour, and these colours correspond to those used in <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7C–7E</xref>. Overall, 4 distinctive groups represented the data best, containing 10, 13, 13 and 3 cells, respectively. It is worth noting that while clustering was performed on the stimuli time courses the Ca<sup>2+</sup> spike sequences show a consistent pattern in that they are generally more similar within a given group than between groups.</p>
<fig id="pcbi.1005794.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005794.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Clustering of dynamic stimuli and cell positions.</title>
<p>(A) Weights of the three leading principal components of the stimulus data for the experiment of <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7</xref>. (B) Position of cells in the microfluidics chamber are shown by a plus sign. Cells that were included in the analysis, i.e. those that spiked more than 10 times, are identified by a circle. Stimuli (and hence cell positions) belonging to the same group as identified by the <italic>k</italic>-means algorithm are coloured identically and with the same colour as in <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.g008" xlink:type="simple"/>
</fig>
<p>The black lines in <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7C and 7E</xref> denote the mean stimulus and mean intensity function, respectively. We observed that the intensity functions broadly mirror the global behaviour of the stimulus. The mean intensity function for all responses showed a single peak with a similar time course to the stimulus. The amplitude of stimulus and intensity function are also well matched. However, there are also observable differences. For example, individual cells showed intensity functions with a more complex time course than the mean (such as multiple peaks). Furthermore, while the mean stimulus was symmetrical, the mean intensity functions could exhibit notable asymmetries. For example, for weak stimuli, the rising phase of the intensity function may be markedly slower than the falling phase (<xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7C and 7E</xref>; yellow and green traces). This most likely reflects the excitable character of intracellular Ca<sup>2+</sup> signalling [<xref ref-type="bibr" rid="pcbi.1005794.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref040">40</xref>]. For weaker stimulation, it takes longer to reach the threshold for generating a Ca<sup>2+</sup> spike, hence the intensity function grows more slowly. The quicker decrease results from the stimulus dropping below the Ca<sup>2+</sup> spike generating threshold quickly after reaching its maximum, hence prohibiting further Ca<sup>2+</sup> spikes. The faster increase of the intensity function for stronger stimuli (grey traces) lends further support for this interpretation, as the Ca<sup>2+</sup> spike generating threshold is reached more quickly.</p>
<p>To illustrate the value of the mean intensity functions shown in <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7E</xref>, we generated surrogate Ca<sup>2+</sup> spike sequences from them using the IG distribution and plotted them in <xref ref-type="fig" rid="pcbi.1005794.g009">Fig 9C</xref>. For ease of comparison, we also show the measured Ca<sup>2+</sup> spike sequences in <xref ref-type="fig" rid="pcbi.1005794.g009">Fig 9B</xref>. We first note that the simulated Ca<sup>2+</sup> spike sequences resemble the measured ones. This is also confirmed by the histrograms in <xref ref-type="fig" rid="pcbi.1005794.g009">Fig 9D</xref>, which exhibit large overlaps between the experimental and theoretical Ca<sup>2+</sup> spike sequences. To quantify how similar the two histograms are, we computed the histogram distance given by
<disp-formula id="pcbi.1005794.e006"><alternatives><graphic id="pcbi.1005794.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>,</mml:mo> <mml:mi>S</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="1pt"/><mml:msub><mml:mi>R</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="1pt"/><mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where R<sub><italic>i</italic></sub> and <italic>S</italic><sub><italic>i</italic></sub> denote the histogram count in the <italic>i</italic>th bin of the recorded and simulated data, respectively. The histogram distance is bounded between 0 and 1, and the closer it is to 1 the more similar the histograms are. The histograms coincide if <italic>H</italic> = 1. We found that <italic>H</italic> = 0.86, 0.94, 0.91 and 0.89 (from top to bottom), which confirms our visual inspection that the histograms vary little between recorded and simulated Ca<sup>2+</sup> spike sequences. Moreover, Ca<sup>2+</sup> spike sequences generated from one intensity function exhibit a certain degree of heterogeneity, which is consistent with our experimental findings. Taken together, these results show that without explicitly including any information about the stimulus into the estimation of the intensity functions, our approach yields intensity functions that reflect the characteristics of the stimulus and that are consistent with experimentally recorded Ca<sup>2+</sup> spike sequences.</p>
<fig id="pcbi.1005794.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005794.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Surrogate Ca<sup>2+</sup> spike sequences from experimentally determined Ca<sup>2+</sup> spike rates.</title>
<p>(A) Mean intensity functions as shown in <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7E</xref>. The colours correspond to the ones used in <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7</xref>. (B) Raster plot of recorded Ca<sup>2+</sup> spike sequences as shown in <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7D</xref>. (C) Surrogate Ca<sup>2+</sup> spike sequences generated from the mean intensity function depicted in (A). (D) Histograms of recorded and simulated Ca<sup>2+</sup> spike sequences.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.g009" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec006" sec-type="conclusions">
<title>Discussion</title>
<p>A key task for all cell types is to faithfully respond to external stimuli. For signalling pathways that rely on the dynamics of the intracellular Ca<sup>2+</sup> concentration, sequences of Ca<sup>2+</sup> spikes have long been recognised as the likeliest encoding mechanism of extracellular cues. Detailed numerical simulations have provided a mechanistic understanding of how cells generate Ca<sup>2+</sup> spike sequences and have demonstrated the emergence of ISI fluctuations from subcellular processes such as Ca<sup>2+</sup> puffs. Conceptually, such modelling falls into the class of bottom-up approaches. In the present study, we have adopted a top-down perspective in that we have developed a modelling framework that directly describes the stochastic timing of Ca<sup>2+</sup> spikes at the cellular level. Importantly, our data-driven approach implicitly accounts for subcellular details through the introduction of the intensity function <italic>x</italic>(<italic>t</italic>).</p>
<p>Our modelling approach is based on the idea of representing Ca<sup>2+</sup> spike sequences as realisations of a point-process. In contrast to earlier applications of this concept, consecutive Ca<sup>2+</sup> spikes in the current study do not necessarily exhibit the same statistics, i.e. the ISI distribution may become time-dependent. This is a direct consequence of the time-varying stimulation. However, through appropriately transforming the times of Ca<sup>2+</sup> spikes and by using the time-dependent intensity function <italic>x</italic>(<italic>t</italic>), it is possible to describe Ca<sup>2+</sup> spike ISIs with one distribution for the entire Ca<sup>2+</sup> spike sequence.</p>
<p>We therefore began our investigation by testing different ISI distributions: inhomogeneous Poisson (IP), inhomogeneous Gamma (IG) and inhomogeneous inverse Gaussian (IIG). The IP process is a common choice as it is the simplest stochastic process and the only one for which the conditional intensity function <italic>q</italic>(<italic>t</italic>|<italic>y</italic><sub><italic>k</italic></sub>, <italic>x</italic>) coincides with the intensity function <italic>x</italic>(<italic>t</italic>) (see <xref ref-type="disp-formula" rid="pcbi.1005794.e029">Eq (15)</xref>). This greatly facilitates the mathematical analysis, which can draw on a large body of already established results. However, the IP process often fails to describe experimental spike trains, see e.g. Barbieri et al. [<xref ref-type="bibr" rid="pcbi.1005794.ref037">37</xref>]. We therefore turned to the more general IG process, which includes the IP process as a special case. In addition, we employed the IIG distribution. Our results in <xref ref-type="fig" rid="pcbi.1005794.g002">Fig 2</xref> show that the IG distribution captures experimental ISIs very well, whereas both the IP and IIG distribution poorly represent the Ca<sup>2+</sup> spike data. While these results all pertain to whole cell Ca<sup>2+</sup> spikes, they also shed further light on the details of the subcellular processes that generate these Ca<sup>2+</sup> spikes. The IG distribution with shape parameter <italic>γ</italic> results from sampling an IP process every <italic>γ</italic>th spike. In other words, the ISI distribution for an IG is the same as if one measured the ISIs for <italic>γ</italic> successive spikes generated from an IP and then added all <italic>γ</italic> ISIs up to obtain a single ISI. Interestingly, one proposed mechanism for the generation of Ca<sup>2+</sup> spikes is wave nucleation, where a critical number of Ca<sup>2+</sup> puffs has to occur [<xref ref-type="bibr" rid="pcbi.1005794.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref041">41</xref>]. Under the assumption that Ca<sup>2+</sup> puffs are described by an IP process, the above arguments entails that <italic>γ</italic> can be linked to the number of Ca<sup>2+</sup> puffs to trigger a Ca<sup>2+</sup> spike. From a more general perspective Ca<sup>2+</sup> wave nucleation can be considered as a first passage time problem, since we are interested in the first time that a critical number of Ca<sup>2+</sup> puffs occurs. Importantly, the concept of first passage times is also at the heart of Ca<sup>2+</sup> puff generation [<xref ref-type="bibr" rid="pcbi.1005794.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1005794.ref044">44</xref>]. Assuming a continuous representation for Ca<sup>2+</sup> spike generation, one of the simplest first passage time problems describes Brownian motion with positive drift to reach a fixed level for the first time [<xref ref-type="bibr" rid="pcbi.1005794.ref045">45</xref>]. The associated probability distribution is the IIG distribution, which we chose as our third candidate. The failure of the IIG distribution to capture the behaviour of Ca<sup>2+</sup> spikes may point towards more complex subcellular dynamics than random motion and positive drift.</p>
<p>We used two different tests to determine the most likely ISI distribution, a quantile-quantile plot and a Kolmogorov-Smirnov plot. If we correctly identified the ISI distribution that is consistent with experimental data, the measured ISIs can be transformed to obey an exponential ISI distribution. Both the quantile-quantile plot and the Kolmogorov-Smirnov plot interrogate how closely the transformed ISIs are described by an exponential distribution. The fact that the two tests focus on different aspects of the distribution [<xref ref-type="bibr" rid="pcbi.1005794.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref047">47</xref>] and that both identified the IG as the most plausible ISI distribution provides strong support for our findings. While our analysis suggests that the IG distribution describes the measured data best, we cannot rule out that other distributions that we have not tested, e.g. a log-normal distribution or a generalised exponential distribution, might yield equally good or even better results. If future work reveals another probability distribution than the IG distribution that is consistent with the data, the discussion will turn towards the stochastic processes that generate these distributions and how they reflect the physiology of Ca<sup>2+</sup> signalling. We will touch on this point later in the discussion.</p>
<p>Our modelling framework rests on two pillars: an ISI distribution and a Ca<sup>2+</sup> spike rate. While the ISI distribution may shine light on potential mechanisms that generate Ca<sup>2+</sup> spikes, the Ca<sup>2+</sup> spike rate encodes the speed of Ca<sup>2+</sup> spike formation. To estimate the Ca<sup>2+</sup> spike rate, we used the fact that it coincides with the intensity function <italic>x</italic>(<italic>t</italic>). Given that there are numerous ways to generally estimate intensity functions from experimental data, we tested three approaches with particular emphasis on Ca<sup>2+</sup> spikes: Bayesian inference with GPs, KS and PSTHs. As <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4</xref> illustrates, both KS and PSTHs yield excellent results when we have a large number of Ca<sup>2+</sup> spike sequences that are all generated from the same intensity function. One of the reasons for these good estimates is that by pooling all Ca<sup>2+</sup> spike sequences, the statistics become effectively Poissonian [<xref ref-type="bibr" rid="pcbi.1005794.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref048">48</xref>] and that in this case an optimal bandwidth for KS [<xref ref-type="bibr" rid="pcbi.1005794.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref050">50</xref>] and an optimal bin size for the PSTH [<xref ref-type="bibr" rid="pcbi.1005794.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref051">51</xref>] is known. However, no <italic>a priori</italic> estimates for a bandwidth or bin size exist when only a small number of Ca<sup>2+</sup> spike sequences with a few spikes each is available. As <xref ref-type="fig" rid="pcbi.1005794.g006">Fig 6</xref> shows the relative error in estimating the true Ca<sup>2+</sup> spike rate strongly depends on the bandwidth when Ca<sup>2+</sup> spikes are generated from an IG process and estimates are based on only a few Ca<sup>2+</sup> spike sequences. This severely limits the use of KS and PSTHs in estimating Ca<sup>2+</sup> spike rates from experimental recordings since firstly the ISI statistics are not Poissonian, and secondly combining Ca<sup>2+</sup> spikes from a large number of cells might not be possible as we will discuss below. We therefore turned to Bayesian inference using GPs. Importantly, the Bayesian approach already works for a single Ca<sup>2+</sup> spike sequence. By using a prior distribution <italic>p</italic>(<italic>θ</italic>) for the hyperparameters <italic>θ</italic>, i.e. the parameters that describe the shape of the ISI distribution and that control the behaviour of the GP, we explicitly represent the uncertainty associated with each hyperparameter. This alleviates the need for fixing parameter values prior to the estimation of the Ca<sup>2+</sup> spike rate as is the case for PSTHs and KS. <xref ref-type="fig" rid="pcbi.1005794.g006">Fig 6</xref> shows that GPs yield better results than KS. Moreover, we also obtain confidence intervals from the GP optimisation (<xref ref-type="fig" rid="pcbi.1005794.g005">Fig 5</xref>), which allows us to judge the quality of the Ca<sup>2+</sup> spike rate estimation <italic>a posteriori</italic>.</p>
<p>Spike rates are often estimated from pooled data. This practice is well founded if cells generate spikes with the same mechanism. When cells are stimulated, this approach also assumes that each cell experiences the same stimulus time course. For ligand-dependent signalling pathways, the last condition is usually met experimentally by exposing cells to a constant stimulus. However, this might not be the situation <italic>in vivo</italic>. We therefore used a microfluidics chamber to challenge HEK293T cells with a time-varying concentration of carbachol. As <xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7</xref> illustrates, different cells experience different concentration profiles of carbachol. Importantly, when computing the average over all stimuli time courses, not a single cell experiences this specific stimulation. To identify cells that are stimulated in a similar manner and hence can be compared with each other, we computed the weights of the three leading principal components of each stimulus time course, and then used a <italic>k</italic>-means algorithm. We then determined the most likely Ca<sup>2+</sup> spike rate for each cell and computed the mean Ca<sup>2+</sup> spike rate for cells within a given group (<xref ref-type="fig" rid="pcbi.1005794.g007">Fig 7</xref>). Overall, there is substantial variability in the Ca<sup>2+</sup> spike rates with respect to their mean. This results from the variation in the Ca<sup>2+</sup> spike sequences, which is illustrated by a comparison between the first and the third group. This variability in the Ca<sup>2+</sup> spike rates leads to intriguing questions. On the one hand, the fluctuations could arise from the intrinsic stochasticity of Ca<sup>2+</sup> spike generation. It is known that cells challenged repeatedly with the same stimulus (and allowing for recovery between successive stimulation) respond randomly (see e.g. [<xref ref-type="bibr" rid="pcbi.1005794.ref016">16</xref>]). Hence, the observed Ca<sup>2+</sup> spike sequences constitute a sample of the possible cellular responses given a particular stimulus. On the other hand, the variability could stem from the composition of the Ca<sup>2+</sup> signalling apparatus in each cell. At the subcellular level, a Ca<sup>2+</sup> spike often corresponds to a travelling Ca<sup>2+</sup> wave that is shaped by Ca<sup>2+</sup> release from intracellular storage compartments such as the endoplasmic reticulum and Ca<sup>2+</sup> sequestration by Ca<sup>2+</sup> pumps [<xref ref-type="bibr" rid="pcbi.1005794.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref052">52</xref>–<xref ref-type="bibr" rid="pcbi.1005794.ref054">54</xref>]. The spatial arrangement of Ca<sup>2+</sup> releasing channels, Ca<sup>2+</sup> pumps and Ca<sup>2+</sup> buffers strongly affects Ca<sup>2+</sup> waves and therefore Ca<sup>2+</sup> spikes [<xref ref-type="bibr" rid="pcbi.1005794.ref011">11</xref>]. Given that even genetically identical cells express different numbers of the components of the Ca<sup>2+</sup> signalling toolkit and arrange them in different spatial patterns, the variability in the Ca<sup>2+</sup> spike rates could reflect single cell variability at the molecular level. The two sources for the variability of Ca<sup>2+</sup> spike rates are not mutually exclusive, and a mixture of both is most likely to occur <italic>in vivo</italic>.</p>
<p>To bring order to such disparate Ca<sup>2+</sup> spike sequences, recent studies have shown that when cells are challenged with a constant stimulus, a linear relationship exists between the mean and the standard deviation of ISIs [<xref ref-type="bibr" rid="pcbi.1005794.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref015">15</xref>]. The slope of this relationship was shown to be robust to interventions at the molecular level (blocking Ca<sup>2+</sup> pumps, energising Ca<sup>2+</sup> release channels) as well as being cell type and agonist specific. A theoretical analysis revealed that the slope could be determined by a recovery timescale from global cellular inhibition after a Ca<sup>2+</sup> spike. Therefore, one expects that each cell type and each agonist can be characterised by this timescale. In the present study, each cell possesses its own intensity function <italic>x</italic>(<italic>t</italic>). The organising principle that will lead to a cell type and stimulation specific description of Ca<sup>2+</sup> spiking is given by the parameter values that describe the <italic>statistics</italic> of <italic>x</italic>(<italic>t</italic>), i.e. the hyperparameters of the GP. Put differently, for a given cell type stimulated with a specific agonist and application protocol, we expect <italic>one</italic> set of parameter values for the GP. Heterogeneous cell responses then originate from different realisations of the GP. To illustrate this concept, assume for the time being that the intensity function is constant. In a population, there will be a spread of Ca<sup>2+</sup> spiking behaviour, with some cells only generating a few Ca<sup>2+</sup> spikes, while others exhibit high Ca<sup>2+</sup> spiking activity. Consequently, the intensity function for slow spiking cells is low, while it is large for high frequency cells. For independent cells, as is the case in this study, it is reasonable to assume that the values of the intensity function are normally distributed. This is equivalent to saying that the intensity function of each cell is a realisation of a GP. The assumption of one set of hyperparameters for a given experiment and cell type will allow us to quantitatively compare different experiments and answer questions such as how different cell types respond to the same stimulus, or how different stimuli shape Ca<sup>2+</sup> spike sequences in a given cell type. We expect that similar responses will be mirrored in small differences between hyperparameter sets.</p>
<p>The last point raises the question of how transferable results are from one cell type to another and from one stimulation scenario to another. In addition, the ultimate goal of the modelling framework presented here is to apply it to physiologically relevant tissues. For example, gap junctional coupling between cells, or paracrine signalling, could potentially influence population heterogeneity. This would require an extension of the modelling framework towards network dynamics, which may be a formidable challenge, as predicting the network behaviour from single node dynamics is nontrivial, let alone inferring single cell dynamics from within a connected tissue.</p>
<sec id="sec007">
<title>Conclusion</title>
<p>In this work we have developed a mathematical framework to quantitatively describe the heterogeneous timing of Ca<sup>2+</sup> spikes in a cell population subject to time-varying stimulation. At the heart of this new approach is the use of Bayesian inference to determine the most likely intensity function and hence the most likely Ca<sup>2+</sup> spike rate for a given stimulus. As part of this estimation process, we found that the statistics of Ca<sup>2+</sup> ISIs are best captured by an IG distribution. Importantly, knowledge of the intensity function and the ISI statistics suffices to completely describe Ca<sup>2+</sup> spiking. Since generating Ca<sup>2+</sup> spike sequences from an ISI distribution and intensity function is computationally significantly cheaper than solving partial differential equations for cellular Ca<sup>2+</sup> transport, this approach is ideally suited for numerically studying large numbers of cells.</p>
<p>The estimation of inhomogeneous single cell behaviour also puts us in an ideal position to ascertain whether or not there is signal processing at the cell population level. Indeed, numerous examples exist where the average population behaviour is not shared by any cell (see e.g. [<xref ref-type="bibr" rid="pcbi.1005794.ref055">55</xref>]). These incongruous dynamics also warrant investigations into population invariances, where cell populations respond consistently in the same manner, albeit with completely heterogeneous single cell behaviour [<xref ref-type="bibr" rid="pcbi.1005794.ref056">56</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref057">57</xref>]. By reliably estimating single cell Ca<sup>2+</sup> dynamics, the present study provides a stepping stone towards answering these questions for intracellular Ca<sup>2+</sup> signalling.</p>
</sec>
</sec>
<sec id="sec008" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec009">
<title>Intensity function and Ca<sup>2+</sup> ISI probability distributions</title>
<p>We here follow the exposition in [<xref ref-type="bibr" rid="pcbi.1005794.ref037">37</xref>] for the definition of the intensity function. Assume that Ca<sup>2+</sup> spikes occur at times <italic>y</italic><sub>1</sub> &lt; <italic>y</italic><sub>2</sub> &lt; … &lt; <italic>y</italic><sub><italic>N</italic></sub>. Let <italic>p</italic>(<italic>v</italic>) denote the probability density for a general renewal process on <italic>v</italic> ∈ (0, ∞), i.e. <italic>p</italic>(<italic>v</italic>)d<italic>v</italic> is the probability for an event in [<italic>v</italic>, <italic>v</italic> + d<italic>v</italic>], and subsequent events are independent. For <italic>y</italic><sub><italic>a</italic></sub> &gt; 0, let <italic>y</italic> correspond to a time variable on (<italic>y</italic><sub><italic>a</italic></sub>, ∞) and <italic>X</italic> be a one-to-one mapping <italic>X</italic>(<italic>y</italic>) = <italic>v</italic> of (<italic>y</italic><sub><italic>a</italic></sub>, ∞) to (0, ∞). Conservation of probability then entails that
<disp-formula id="pcbi.1005794.e007"><alternatives><graphic id="pcbi.1005794.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>|</mml:mo> <mml:mfrac><mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>v</mml:mi></mml:mrow> <mml:mrow><mml:mi mathvariant="normal">d</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:mfrac> <mml:mo>|</mml:mo> <mml:mspace width="1pt"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>v</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>|</mml:mo> <mml:msup><mml:mi>X</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:mspace width="1pt"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
In other words, the probability density for a Ca<sup>2+</sup> spike at <italic>y</italic><sub><italic>i</italic></sub> can be computed from the renewal probability density <italic>p</italic> if we know the mapping <italic>X</italic>. A convenient form of <italic>X</italic> is
<disp-formula id="pcbi.1005794.e008"><alternatives><graphic id="pcbi.1005794.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow> <mml:mi>y</mml:mi></mml:msubsup> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>u</mml:mi> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
which satisfies the conditions above and where <italic>x</italic> is called the intensity function, which is the object that we need to estimate. <xref ref-type="disp-formula" rid="pcbi.1005794.e008">Eq (3)</xref> can be interpreted as rescaling the original time <italic>y</italic> such that Ca<sup>2+</sup> ISIs become independent and identically distributed in the new time [<xref ref-type="bibr" rid="pcbi.1005794.ref058">58</xref>]. Given two subsequent Ca<sup>2+</sup> spikes times <italic>y</italic><sub><italic>i</italic>−1</sub> and <italic>y</italic><sub><italic>i</italic></sub> in the original time, the ISI in the new time is
<disp-formula id="pcbi.1005794.e009"><alternatives><graphic id="pcbi.1005794.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msubsup> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>u</mml:mi> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
Since it is only through the introduction of the intensity function <italic>x</italic>(<italic>t</italic>) that Ca<sup>2+</sup> ISIs become Markov, we introduce the notation <italic>p</italic>(<italic>y</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic>−1</sub>|<italic>x</italic>), which corresponds to the ISI probability density given <italic>x</italic>(<italic>t</italic>). Note that formally the conditional ISI probability density is defined as the joint conditional probability density for spikes at <italic>y</italic><sub><italic>i</italic></sub> and <italic>y</italic><sub><italic>i</italic>−1</sub> (and hence no spike in [<italic>y</italic><sub><italic>i</italic>−1</sub>, <italic>y</italic><sub><italic>i</italic></sub>]) given an intensity function <italic>x</italic>(<italic>t</italic>). We will employ three different choices for the ISI probability density: an inhomogeneous Gamma distribution
<disp-formula id="pcbi.1005794.e010"><alternatives><graphic id="pcbi.1005794.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>γ</mml:mi> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>γ</mml:mi> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>γ</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mtext>e</mml:mtext> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>γ</mml:mi> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>γ</italic> &gt; 0 denotes the shape parameter and Γ is the Gamma function; an inhomogeneous inverse Gaussian distribution
<disp-formula id="pcbi.1005794.e011"><alternatives><graphic id="pcbi.1005794.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>X</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mi>α</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>α</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>X</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>α</italic> &gt; 0 is the location parameter; and an IP distribution
<disp-formula id="pcbi.1005794.e012"><alternatives><graphic id="pcbi.1005794.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula></p>
</sec>
<sec id="sec010">
<title>Bayesian inference</title>
<p>The time-dependent intensity function <italic>x</italic>(<italic>t</italic>) is modelled as a Gaussian Process (GP) [<xref ref-type="bibr" rid="pcbi.1005794.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref059">59</xref>]. A GP is uniquely defined by its mean <italic>μ</italic>(<italic>t</italic>) and covariance function Σ(<italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub>). While there are many possible choices for Σ [<xref ref-type="bibr" rid="pcbi.1005794.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref060">60</xref>], we employ the widely used squared exponential (SE) kernel
<disp-formula id="pcbi.1005794.e013"><alternatives><graphic id="pcbi.1005794.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>κ</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>κ</italic> measures the smoothness of the GP and <italic>σ</italic><sub><italic>f</italic></sub> controls its variance. The last term allows us to model additional noise sources. We originally included <inline-formula id="pcbi.1005794.e014"><alternatives><graphic id="pcbi.1005794.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> as a hyperparameter in the optimisation. However, we consistently found small values for <inline-formula id="pcbi.1005794.e015"><alternatives><graphic id="pcbi.1005794.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> and hence decided to fix it at a presentative value of <inline-formula id="pcbi.1005794.e016"><alternatives><graphic id="pcbi.1005794.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mn>10</mml:mn> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>4</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. We collect the spike times in a sequence of <italic>N</italic> Ca<sup>2+</sup> spikes in a vector <bold>y</bold> = {<italic>y</italic><sub>1</sub>, …, <italic>y</italic><sub><italic>N</italic></sub>}. For consistency, we set <italic>y</italic><sub>0</sub> = 0. Through the introduction of an intensity function <italic>x</italic>(<italic>t</italic>), the joint probability density for a spike sequence <bold>y</bold> given <italic>x</italic>(<italic>t</italic>) factorises and reads as [<xref ref-type="bibr" rid="pcbi.1005794.ref036">36</xref>]
<disp-formula id="pcbi.1005794.e017"><alternatives><graphic id="pcbi.1005794.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>p</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mspace width="1pt"/><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
Here, <italic>p</italic><sub>1</sub>(<italic>y</italic><sub>1</sub>|<italic>x</italic>) represents the conditional probability density of finding the first spike at time <italic>y</italic><sub>1</sub>. We also take into account that the observation time <italic>T</italic> usually exceeds the last spike time through the term <italic>p</italic><sub><italic>T</italic></sub>(<italic>T</italic>, <italic>y</italic><sub><italic>N</italic></sub>|<italic>x</italic>), which denotes the conditional probability that no spike occurs after <italic>y</italic><sub><italic>N</italic></sub>. The statistics for <italic>p</italic><sub>1</sub> and <italic>p</italic><sub><italic>T</italic></sub> are often based on an inhomogeneous Poisson (IP) process, i.e.
<disp-formula id="pcbi.1005794.e018"><alternatives><graphic id="pcbi.1005794.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo> <mml:mspace width="2.em"/><mml:msub><mml:mi>p</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>X</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>N</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <italic>X</italic> is given by <xref ref-type="disp-formula" rid="pcbi.1005794.e008">Eq (3)</xref>.</p>
<p>For practical purposes, we discretise time with a time step Δ such that <italic>T</italic> = <italic>n</italic>Δ [<xref ref-type="bibr" rid="pcbi.1005794.ref036">36</xref>]. When working with experimental spike trains, we set Δ equal to the inverse of the recording frame rate. A spiking time <italic>y</italic><sub><italic>i</italic></sub> can then be expressed as <italic>y</italic><sub><italic>i</italic></sub> = <italic>l</italic><sub><italic>i</italic></sub> Δ for an appropriate <inline-formula id="pcbi.1005794.e019"><alternatives><graphic id="pcbi.1005794.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mi mathvariant="double-struck">N</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. By setting <italic>x</italic><sub><italic>i</italic></sub> = <italic>x</italic>(<italic>i</italic>Δ) and using <xref ref-type="disp-formula" rid="pcbi.1005794.e017">Eq (9)</xref> with e.g <xref ref-type="disp-formula" rid="pcbi.1005794.e010">Eq (5)</xref>, we obtain the probability density for a spike sequence for the inhomogeneous Gamma distribution as
<disp-formula id="pcbi.1005794.e020"><alternatives><graphic id="pcbi.1005794.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>p</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>y</mml:mi></mml:mstyle> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:msup><mml:mtext>e</mml:mtext> <mml:mrow><mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:msup><mml:mtext>e</mml:mtext> <mml:mrow><mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mstyle displaystyle="true" mathsize="140%"><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover></mml:mstyle> <mml:mfrac><mml:mrow><mml:mi>γ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:msub><mml:mi>l</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>Γ</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>γ</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>γ</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mtext>e</mml:mtext> <mml:mrow><mml:mo>−</mml:mo> <mml:mi>γ</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
where <inline-formula id="pcbi.1005794.e021"><alternatives><graphic id="pcbi.1005794.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>X</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>l</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <italic>l</italic><sub>0</sub> = 0, <italic>l</italic><sub><italic>n</italic></sub> = <italic>n</italic>. By introducing <italic>θ</italic> on the left hand side, we make explicit the dependence of the probability density on the hyperparameters <italic>θ</italic>, which in this case are <italic>θ</italic> = {<italic>γ</italic>, <italic>κ</italic>, <italic>σ</italic><sub><italic>f</italic></sub>}.</p>
<p>The most probable intensity function <italic>x</italic>*(<italic>t</italic>) given a spike train <bold>y</bold> is determined by <italic>x</italic>* = argmax<sub><italic>x</italic>≥0</sub> <italic>p</italic>(<italic>x</italic>|<bold>y</bold>). Under the assumption that the nodal value <italic>x</italic>* is close to its mean, we have
<disp-formula id="pcbi.1005794.e022"><alternatives><graphic id="pcbi.1005794.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>≈</mml:mo> <mml:mo>∫</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>Z</mml:mi></mml:mfrac> <mml:mo>∫</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>θ</mml:mi> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where
<disp-formula id="pcbi.1005794.e023"><alternatives><graphic id="pcbi.1005794.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix">argmax</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix">argmax</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
To evaluate the first integral in <xref ref-type="disp-formula" rid="pcbi.1005794.e022">Eq (12)</xref> we note that
<disp-formula id="pcbi.1005794.e024"><alternatives><graphic id="pcbi.1005794.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>∫</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>x</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>F</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
with <inline-formula id="pcbi.1005794.e025"><alternatives><graphic id="pcbi.1005794.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msqrt><mml:mo>|</mml:mo> <mml:msup><mml:mo>Λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mo>Σ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>|</mml:mo></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005794.e026"><alternatives><graphic id="pcbi.1005794.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msup><mml:mo>Λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow> <mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo form="prefix">log</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where we used Laplace’s approximation for the integral as shown in <xref ref-type="supplementary-material" rid="pcbi.1005794.s007">S1 Appendix</xref>. We further introduced the notation <inline-formula id="pcbi.1005794.e027"><alternatives><graphic id="pcbi.1005794.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:msubsup><mml:mrow><mml:mi mathvariant="script">L</mml:mi></mml:mrow> <mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mi>f</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> to denote the Hessian of <italic>f</italic> with respect to <italic>x</italic>(<italic>t</italic>) and <inline-formula id="pcbi.1005794.e028"><alternatives><graphic id="pcbi.1005794.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mi>Z</mml:mi> <mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">y</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>θ</mml:mi> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec011">
<title>Time rescaling, quantile-quantile and Kolmogorov-Smirnov plots</title>
<p>Let <italic>q</italic>(<italic>t</italic>|<italic>y</italic><sub><italic>k</italic></sub>, <italic>x</italic>), <italic>t</italic> &gt; <italic>y</italic><sub><italic>k</italic></sub> denote the conditional intensity function, i.e. <italic>q</italic>(<italic>t</italic>|<italic>y</italic><sub><italic>k</italic></sub>, <italic>x</italic>)d<italic>t</italic> is the probability for a spike in [<italic>t</italic>, <italic>t</italic> + d<italic>t</italic>] given an intensity function <italic>x</italic>(<italic>t</italic>) and the last spike at <italic>y</italic><sub><italic>k</italic></sub>. We can express <italic>q</italic>(<italic>t</italic>|<italic>y</italic><sub><italic>k</italic></sub>, <italic>x</italic>) in terms of the ISI probability density as [<xref ref-type="bibr" rid="pcbi.1005794.ref031">31</xref>]
<disp-formula id="pcbi.1005794.e029"><alternatives><graphic id="pcbi.1005794.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:mfrac> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
The time rescaling theorem then states that the rescaled ISIs [<xref ref-type="bibr" rid="pcbi.1005794.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref061">61</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref062">62</xref>]
<disp-formula id="pcbi.1005794.e030"><alternatives><graphic id="pcbi.1005794.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:msub><mml:mi>y</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msubsup> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="normal">d</mml:mi> <mml:mi>s</mml:mi> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
are independent and identically distributed exponential random variables with mean one if <bold>y</bold> is a realisation from a point process with conditional intensity function <italic>q</italic>(<italic>t</italic>|<italic>y</italic><sub><italic>k</italic></sub>, <italic>x</italic>).</p>
<p>Suppose there are <italic>K</italic> rescaled ISIs. For a quantile-quantile plot [<xref ref-type="bibr" rid="pcbi.1005794.ref046">46</xref>], we order the <italic>τ</italic><sub><italic>k</italic></sub> in ascending order giving rise to the new ISIs <inline-formula id="pcbi.1005794.e031"><alternatives><graphic id="pcbi.1005794.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msub><mml:mover accent="true"><mml:mi>τ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. We then plot the quantiles of the distribution of the <inline-formula id="pcbi.1005794.e032"><alternatives><graphic id="pcbi.1005794.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msub><mml:mover accent="true"><mml:mi>τ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:math></alternatives></inline-formula> against the quantiles of an exponential distribution with unit rate, which are given by <inline-formula id="pcbi.1005794.e033"><alternatives><graphic id="pcbi.1005794.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>τ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo form="prefix">ln</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> with <italic>s</italic><sub><italic>n</italic></sub> = (<italic>n</italic> − 0.5)/<italic>K</italic>.</p>
<p>For the Kolmogorov-Smirnov, plot [<xref ref-type="bibr" rid="pcbi.1005794.ref062">62</xref>], we define the random variable <inline-formula id="pcbi.1005794.e034"><alternatives><graphic id="pcbi.1005794.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="normal">e</mml:mi></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> and then plot the ordered set of the <italic>u</italic><sub><italic>k</italic></sub> against the cumulative distribution function of the uniform distribution, i.e. <italic>F</italic>(<italic>x</italic>) = <italic>x</italic> for 0 ≤ <italic>x</italic> ≤ 1, sampled at <italic>s</italic><sub><italic>n</italic></sub>.</p>
</sec>
<sec id="sec012">
<title>Kernel smoothing and <italic>L</italic><sub>2</sub> norm</title>
<p>The Ca<sup>2+</sup> spike rate is estimated from <italic>m</italic> spike sequences via kernel smoothing (KS) through [<xref ref-type="bibr" rid="pcbi.1005794.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref063">63</xref>]
<disp-formula id="pcbi.1005794.e035"><alternatives><graphic id="pcbi.1005794.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>m</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:munderover> <mml:mspace width="1pt"/><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where <inline-formula id="pcbi.1005794.e036"><alternatives><graphic id="pcbi.1005794.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msubsup><mml:mi>y</mml:mi> <mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> denotes the <italic>i</italic>th spike time in the <italic>j</italic>th Ca<sup>2+</sup> spike sequence <bold>y</bold><sub><italic>j</italic></sub>, and <italic>N</italic><sub><italic>j</italic></sub> is the total number of spikes in <bold>y</bold><sub><italic>j</italic></sub>. The function <italic>f</italic> represents the kernel, and we chose a Gaussian of the form
<disp-formula id="pcbi.1005794.e037"><alternatives><graphic id="pcbi.1005794.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
The parameter <italic>σ</italic> is referred to as the bandwidth of the kernel. In case we work with a large number of independent Ca<sup>2+</sup> spike sequences <bold>y</bold><sub><italic>j</italic></sub>, we can use an optimal bandwith [<xref ref-type="bibr" rid="pcbi.1005794.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref050">50</xref>]. To evaluate how well a given method (e.g. Bayesian inference or KS) approximates the true Ca<sup>2+</sup> spike rate used to generate surrogate data, we evaluated the normalised <italic>L</italic><sub>2</sub> norm as
<disp-formula id="pcbi.1005794.e038"><alternatives><graphic id="pcbi.1005794.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mtext>d</mml:mtext> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msup> <mml:mspace width="1pt"/><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>d</mml:mtext> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
where <inline-formula id="pcbi.1005794.e039"><alternatives><graphic id="pcbi.1005794.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005794.e040"><alternatives><graphic id="pcbi.1005794.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> denote the known and estimated Ca<sup>2+</sup> spike rate, respectively.</p>
</sec>
<sec id="sec013">
<title>Principal component analysis and clustering</title>
<p>We arrange the stimuli experienced by individual cells in a matrix <italic>X</italic> such that each row corresponds to a single stimulus time course. We then compute the singular value decomposition of <italic>X</italic>, i.e. <italic>X</italic> = <italic>U</italic>Σ<italic>V</italic><sup><italic>t</italic></sup>, where <italic>t</italic> denotes transposition. The columns of <italic>V</italic> correspond to the eigenvectors of <italic>X</italic><sup><italic>t</italic></sup><italic>X</italic>, and Σ is a diagonal matrix that holds the singular values of <italic>X</italic>. The weights of the principal components of the stimuli time courses are the rows of <italic>XV</italic> = <italic>U</italic>Σ.</p>
<p>The <italic>k</italic>-means algorithm requires the number <italic>k</italic> of clusters as input and then determines the members of each cluster by minimising the error function [<xref ref-type="bibr" rid="pcbi.1005794.ref064">64</xref>]
<disp-formula id="pcbi.1005794.e041"><alternatives><graphic id="pcbi.1005794.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:munderover> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mspace width="1pt"/><mml:msup><mml:mrow><mml:mo>‖</mml:mo> <mml:mi>x</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>‖</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mspace width="0.166667em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
Here, <italic>x</italic> are the data points, <italic>C</italic><sub>1</sub>, …, <italic>C</italic><sub><italic>k</italic></sub> are the <italic>k</italic> disjoint clusters and <italic>μ</italic><sub><italic>i</italic></sub> is the centroid of the <italic>i</italic>th cluster. We varied <italic>k</italic> and visually inspected the clustering. For consistency, we also clustered the data using other algorithms such as mean shift, spectral clustering and density-based spatial clustering of applications with noise. While there were minor differences between the suggested clusters, the overall clustering structure remained the same.</p>
</sec>
<sec id="sec014">
<title>Determining Ca<sup>2+</sup> ISI distribution</title>
<p>To see which is the most likely ISI statistics, we apply the following protocol to every single cell from the experiment shown in <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1</xref>:</p>
<list list-type="order">
<list-item>
<p>Choose one of the candidate ISIs (IP, IG, IIG) and estimate the most likely intensity function <italic>x</italic>*(<italic>t</italic>) using Bayesian inference as described above.</p>
</list-item>
<list-item>
<p>Compute the conditional intensity function based on <italic>x</italic>*(<italic>t</italic>), <italic>q</italic>(<italic>t</italic>|<italic>y</italic><sub><italic>k</italic></sub>, <italic>x</italic>*), from <xref ref-type="disp-formula" rid="pcbi.1005794.e029">Eq (15)</xref>, and use it to plot the quantile-quantile and Kolmogorov-Smirnov diagrams.</p>
</list-item>
</list>
</sec>
<sec id="sec015">
<title>Performance of Ca<sup>2+</sup> spike rate estimation</title>
<p>To test the performance of Ca<sup>2+</sup> spike rate estimation, we generated surrogate data from an IG for the two different intensity functions <italic>x</italic><sub>det</sub>(<italic>t</italic>) and <italic>x</italic><sub>GP</sub>(<italic>t</italic>) using inverse sampling, a Bernoulli process based on the conditional intensity function in <xref ref-type="disp-formula" rid="pcbi.1005794.e029">Eq (15)</xref> and time rescaling [<xref ref-type="bibr" rid="pcbi.1005794.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref065">65</xref>, <xref ref-type="bibr" rid="pcbi.1005794.ref066">66</xref>].</p>
<p>A key factor in estimating Ca<sup>2+</sup> spike rates from PSTHs and KS is the choice of a bin width and bandwidth, respectively. For a large number of Ca<sup>2+</sup> spike sequences, optimal estimates exist [<xref ref-type="bibr" rid="pcbi.1005794.ref049">49</xref>–<xref ref-type="bibr" rid="pcbi.1005794.ref051">51</xref>], and we use them for <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4</xref>. In case of only a few Ca<sup>2+</sup> spike sequences with a small number of spikes per sequence, as in <xref ref-type="fig" rid="pcbi.1005794.g005">Fig 5</xref>, no estimates for a bin width or bandwidth exist. We therefore employed a bandwidth that was approximately equal to the optimal bandwidth determined in <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4</xref> as well as bandwidths 1.5 and 2 times larger than this. In addition, we used the same formal expression as for the optimal value, which resulted in the bandwidth <inline-formula id="pcbi.1005794.e042"><alternatives><graphic id="pcbi.1005794.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. Note that <inline-formula id="pcbi.1005794.e043"><alternatives><graphic id="pcbi.1005794.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> differs from the optimal bandwidth in <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4</xref>, since it explicitly depends on the number of Ca<sup>2+</sup> spike sequences.</p>
</sec>
<sec id="sec016">
<title>Calcium imaging of cells during dynamic stimulation</title>
<p>A bespoke perfusion system connected to a 3-port microfluidics device [<xref ref-type="bibr" rid="pcbi.1005794.ref067">67</xref>] was used to expose cultured HEK293T cells to varying concentrations of the muscarinic receptor agonist, carbachol. The HEK293T cell line was a gift from Dr N. Holliday, University of Nottingham, that had been frozen after passage 28 of the original stock. After thawing, cells were used for up to a further ten passages. Cells were seeded at a density of 10<sup>5</sup> cells/ml in the central micro-channel of the microfluidic devices, in DMEM D6429 growth media (Invitrogen, Paisley, UK) containing 10% fetal calf serum. Cells were loaded inside the microchannels with 1 <italic>μ</italic>M of the Ca<sup>2+</sup> indicator Fluo5F-AM for 30 min, followed by washout with imaging buffer (135 mM NaCl, 3 mM KCl, 10 mM HEPES, 15 mM D-glucose, 2 mM MgSO<sub>4</sub> and 2 mM CaCl<sub>2</sub>) for at least a further 30 min. To stimulate the cells, the flow rates of two inlet channels into the microchannel were varied, allowing the interface between the two solutions to be shifted laterally across the chamber. One inlet stream contained the agonist (100 <italic>μ</italic>M carbachol) and Alexa Fluor 594 (AF594, 2 nM; to allow monitoring of agonist concentration in proportion to AF594 fluorescence). The second inlet contained buffer alone. The interface formed between the two solutions due to laminar flow was shifted across the width of the microchannel by controlled changes in the fractional flow rates for each stream, with total flow being constant. In combination with the shifting interface position, the concentration gradient formed by diffusional collapse of the interface as the co-flow progresses through the channel length results in a spatiotemporal gradient in agonist concentration throughout the channel. This method enables the exposure of cells to pre-defined, time-varying changes in agonist concentration, from simple step-changes to complex waveforms. During dynamic stimulation with agonist, AF594 and Fluo-5F AM indicators were excited sequentially (100 ms exposure, 1 Hz frame rate) using a pE2 LED system (excitation peaks 470 nm and 565 nm; CoolLED, Andover UK). Emission was detected at 535 ± 50 nm and 565 ± 20 nm with an ORCA-R<sup>2</sup> camera (Hamamatsu, Welwyn Garden City, UK).</p>
</sec>
<sec id="sec017">
<title>Image analysis</title>
<p>A time-series analyser plugin to ImageJ (Wayne Rasband, National Institutes of Health, Bethesda, MD, available at <ext-link ext-link-type="uri" xlink:href="http://rsb.info.nih.gov/ij" xlink:type="simple">http://rsb.info.nih.gov/ij</ext-link>) was used to manually define circular regions of interest (ROI) centred on each cell. Mean Fluo-5F emission intensity of pixels falling within each ROI was quantified and expressed as the ratio of fluorescence at time t divided by mean intensity from a 25 s window prior to the first increase in stimulus concentration (F/F<sub>0</sub>). The baseline window is selected as the window with minimum standard deviation from sliding 25 s windows taken from 0 to 120 s (before increase in stimulus concentration). Fluorescence of AF594 was quantified as the mean fluorescence intensity of pixels falling within each ROI being quantified; therefore each cell has a Ca<sup>2+</sup> response measure and an associated stimulation profile.</p>
</sec>
</sec>
<sec id="sec018">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005794.s001" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Determining Ca<sup>2+</sup> spike ISI statistics.</title>
<p>Quantile-quantile plots for Ca<sup>2+</sup> spike sequences in HEK293T cells stimulated with (A) 100<italic>μ</italic>M and (B) 10<italic>μ</italic>M carbachol when the ISI statistics is assumed to be an IIG (blue), IP (red) and IG (grey) distribution. Box and whisker plots summarising the the quantile-quantile plots for (C) 100<italic>μ</italic>M and (D) 10<italic>μ</italic>M carbachol stimulation for the IP, IIG and IG models. The results in (A) and (C) are based on the data shown in <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1</xref>. The box extends from the first quartile (Q1) to the third quartile (Q3) with the red line at the median. The lower whisker corresponds to the smallest data point that is bigger than Q1−1.5×IQR, while the upper whisker extends to the largest value that is smaller than Q3+1.5×IQR, where IQR denotes the interquartile range Q3-Q1. We used 42 cells in (A), (C) and 21 cells in (B), (D).</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005794.s002" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Ca<sup>2+</sup> spike rate estimation.</title>
<p>Ca<sup>2+</sup> spike rate estimations for data shown in <xref ref-type="fig" rid="pcbi.1005794.g004">Fig 4A</xref> for 1 (A), 2 (B), 4 (C) and 7 (D) randomly chosen Ca<sup>2+</sup> spike sequences (black dots) using KS with <italic>σ</italic> = 35 (grey), 52 (orange), 70 (purple), <inline-formula id="pcbi.1005794.e044"><alternatives><graphic id="pcbi.1005794.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005794.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mover accent="true"><mml:mi>σ</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (blue) and a GP(black). The dotted red line denotes the original Ca<sup>2+</sup> spike rate. The light blue areas delineate the 95% GP estimation confidence interval.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005794.s003" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Statistical analysis of Ca<sup>2+</sup> spike rate estimation for x<sub>det</sub>.</title>
<p>Ca<sup>2+</sup> spike sequences were generated using inverse sampling (A), a Bernouilli process (B) and time rescaling (C), and we computed the <italic>L</italic><sub>2</sub> norm between the true Ca<sup>2+</sup> spike rate and the estimated Ca<sup>2+</sup> spike rate based on the methods shown along the x-axis in each panel. For details of the box plot, see <xref ref-type="fig" rid="pcbi.1005794.g002">Fig 2</xref>. <italic>N</italic> = 100 for all three panels.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005794.s004" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Statistical analysis of Ca<sup>2+</sup> spike rate estimation for x<sub>GP</sub>.</title>
<p>Ca<sup>2+</sup> spike sequences were generated using inverse sampling (A), a Bernouilli process (B) and time rescaling (C), and we computed the <italic>L</italic><sub>2</sub> norm between the true Ca<sup>2+</sup> spike rate and the estimated Ca<sup>2+</sup> spike rate based on the methods shown along the x-axis in each panel. For details of the box plot, see <xref ref-type="fig" rid="pcbi.1005794.g002">Fig 2</xref>. We generated 100 calcium spike sequences with each generator for the statistical analsysis.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005794.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.s005" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Significant test for Ca<sup>2+</sup> spike rate estimation.</title>
<p>Based on the data reported in <xref ref-type="supplementary-material" rid="pcbi.1005794.s003">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005794.s004">S4</xref> Figs, we computed <italic>p</italic> values using the non-parametric Mann-Whitney test. Significant results (<italic>p</italic> &lt; 5 × 10<sup>−2</sup>) are in bold.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005794.s006" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.s006" xlink:type="simple">
<label>S1 Video</label>
<caption>
<title>Stimulated HEK293T cells.</title>
<p>HEK293T cells cultured in microfluidics chamber and loaded with Fluo-5F AM indicator. The green channel is Fluo-5F fluorescence emission, and the red channel is AF594 fluorescence emission. Time stamp is in seconds (frame rate of movie 20 f/s). Note delivery of carbachol (in same solution as AF594) at 150 s, by displacement of solution interface during laminar flow. This cell population is the same as shown in <xref ref-type="fig" rid="pcbi.1005794.g001">Fig 1</xref> of the manuscript.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005794.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005794.s007" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Laplace’s integral approximation.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Theodore Kypraios for valuable discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005794.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berridge</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Lipp</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Bootman</surname> <given-names>MD</given-names></name>. <article-title>The versatility and universality of calcium signalling</article-title>. <source>Nature Reviews Molecular Cell Biology</source>. <year>2000</year>;<volume>1</volume>(<issue>1</issue>):<fpage>11</fpage>–<lpage>21</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35036035" xlink:type="simple">10.1038/35036035</ext-link></comment> <object-id pub-id-type="pmid">11413485</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Woods</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Cuthbertson</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Cobbold</surname> <given-names>PH</given-names></name>. <article-title>Repetitive transient rises in cytoplasmic free calcium in hormone-stimulated hepatocytes</article-title>. <source>Nature</source>. <year>1986</year>;<volume>319</volume>(<issue>6054</issue>):<fpage>600</fpage>–<lpage>602</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/319600a0" xlink:type="simple">10.1038/319600a0</ext-link></comment> <object-id pub-id-type="pmid">3945348</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Koninck</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Schulman</surname> <given-names>H</given-names></name>. <article-title>Sensitivity of CaM kinase II to the frequency of Ca<sup>2+</sup> oscillations</article-title>. <source>Science (New York, NY)</source>. <year>1998</year>;<volume>279</volume>(<issue>5348</issue>):<fpage>227</fpage>–<lpage>230</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.279.5348.227" xlink:type="simple">10.1126/science.279.5348.227</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dolmetsch</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>RS</given-names></name>. <article-title>Calcium oscillations increase the efficiency and specificity of gene expression</article-title>. <source>Nature</source>. <year>1998</year>;<volume>392</volume>(<issue>6679</issue>):<fpage>933</fpage>–<lpage>936</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/31960" xlink:type="simple">10.1038/31960</ext-link></comment> <object-id pub-id-type="pmid">9582075</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hajnóczky</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Robb-Gaspers</surname> <given-names>LD</given-names></name>, <name name-style="western"><surname>Seitz</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>AP</given-names></name>. <article-title>Decoding of cytosolic calcium oscillations in the mitochondria</article-title>. <source>Cell</source>. <year>1995</year>;<volume>82</volume>(<issue>3</issue>):<fpage>415</fpage>–<lpage>424</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0092-8674(95)90430-1" xlink:type="simple">10.1016/0092-8674(95)90430-1</ext-link></comment> <object-id pub-id-type="pmid">7634331</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liu</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Walker</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Dai</surname> <given-names>YF</given-names></name>, <name name-style="western"><surname>Arkell</surname> <given-names>RS</given-names></name>, <etal>et al</etal>. <article-title>CAPRI and RASAL impose different modes of information processing on Ras due to contrasting temporal filtering of Ca<sup>2+</sup></article-title>. <source>The Journal of Cell Biology</source>. <year>2005</year>;<volume>170</volume>(<issue>2</issue>):<fpage>183</fpage>–<lpage>190</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1083/jcb.200504167" xlink:type="simple">10.1083/jcb.200504167</ext-link></comment> <object-id pub-id-type="pmid">16009725</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meyer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stryer</surname> <given-names>L</given-names></name>. <article-title>Calcium spiking</article-title>. <source>Annual Review of Biophysics and Biophysical Chemistry</source>. <year>1991</year>;<volume>20</volume>:<fpage>153</fpage>–<lpage>174</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.bb.20.060191.001101" xlink:type="simple">10.1146/annurev.bb.20.060191.001101</ext-link></comment> <object-id pub-id-type="pmid">1867714</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Walker</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Kupzig</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bouyoucef</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Davies</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Tsuboi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bivona</surname> <given-names>TG</given-names></name>, <etal>et al</etal>. <article-title>Identification of a Ras GTPase-activating protein regulated by receptor-mediated Ca<sup>2+</sup> oscillations</article-title>. <source>EMBO Journal</source>. <year>2004</year>;<volume>23</volume>(<issue>8</issue>):<fpage>1749</fpage>–<lpage>1760</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/sj.emboj.7600197" xlink:type="simple">10.1038/sj.emboj.7600197</ext-link></comment> <object-id pub-id-type="pmid">15057271</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dolmetsch</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Lewis</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Goodnow</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Healy</surname> <given-names>JI</given-names></name>. <article-title>Differential activation of transcription factors induced by Ca<sup>2+</sup> response amplitude and duration</article-title>. <source>Nature</source>. <year>1997</year>;<volume>386</volume>(<issue>6627</issue>):<fpage>855</fpage>–<lpage>858</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/386855a0" xlink:type="simple">10.1038/386855a0</ext-link></comment> <object-id pub-id-type="pmid">9126747</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berridge</surname> <given-names>MJ</given-names></name>. <article-title>The AM and FM of calcium signalling</article-title>. <source>Nature</source>. <year>1997</year>;<volume>386</volume>(<issue>6627</issue>):<fpage>759</fpage>–<lpage>760</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/386759a0" xlink:type="simple">10.1038/386759a0</ext-link></comment> <object-id pub-id-type="pmid">9126727</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thurley</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>Derivation of Ca<sup>2+</sup> signals from puff properties reveals that pathway function is robust against cell variability but sensitive for control</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2011</year>;<volume>108</volume>(<issue>1</issue>):<fpage>427</fpage>–<lpage>432</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1008435108" xlink:type="simple">10.1073/pnas.1008435108</ext-link></comment> <object-id pub-id-type="pmid">21173273</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thurley</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Tovey</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Moenke</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Prince</surname> <given-names>VL</given-names></name>, <name name-style="western"><surname>Meena</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Reliable encoding of stimulus intensities within random sequences of intracellular Ca<sup>2+</sup> spikes</article-title>. <source>Science Signaling</source>. <year>2014</year>;<volume>7</volume>(<issue>331</issue>):<fpage>ra59</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/scisignal.2005237" xlink:type="simple">10.1126/scisignal.2005237</ext-link></comment> <object-id pub-id-type="pmid">24962706</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Pittà</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Volman</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Pioggia</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>De Rossi</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ben-Jacob</surname> <given-names>E</given-names></name>. <article-title>Coexistence of amplitude and frequency modulations in intracellular calcium dynamics</article-title>. <source>Physical Review E</source>. <year>2008</year>;<volume>77</volume>(<issue>3 Pt 1</issue>):<fpage>030903</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dupont</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Houart</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>De Koninck</surname> <given-names>P</given-names></name>. <article-title>Sensitivity of CaM kinase II to the frequency of Ca<sup>2+</sup> oscillations: a simple model</article-title>. <source>Cell Calcium</source>. <year>2003</year>;<volume>34</volume>(<issue>6</issue>):<fpage>485</fpage>–<lpage>497</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0143-4160(03)00152-0" xlink:type="simple">10.1016/S0143-4160(03)00152-0</ext-link></comment> <object-id pub-id-type="pmid">14572807</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skupin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kettenmann</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Winkler</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Wartenberg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sauer</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Tovey</surname> <given-names>SC</given-names></name>, <etal>et al</etal>. <article-title>How does intracellular Ca<sup>2+</sup> oscillate: by chance or by the clock?</article-title> <source>Biophysical Journal</source>. <year>2008</year>;<volume>94</volume>(<issue>6</issue>):<fpage>2404</fpage>–<lpage>2411</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.107.119495" xlink:type="simple">10.1529/biophysj.107.119495</ext-link></comment> <object-id pub-id-type="pmid">18065468</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Croft</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Reusch</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Tilunaite</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Russel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Thul</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bellamy</surname> <given-names>TC</given-names></name>. <article-title>Probabilistic encoding of stimulus strength in astrocyte global calcium signals</article-title>. <source>Glia</source>. <year>2016</year>;<volume>64</volume>(<fpage>537</fpage>–<lpage>552</lpage>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/glia.22947" xlink:type="simple">10.1002/glia.22947</ext-link></comment> <object-id pub-id-type="pmid">26651126</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skupin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kettenmann</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>Calcium signals driven by single channel noise</article-title>. <source>PLoS Computational Biology</source>. <year>2010</year>;<volume>6</volume>(<issue>8</issue>):<fpage>e1000870</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000870" xlink:type="simple">10.1371/journal.pcbi.1000870</ext-link></comment> <object-id pub-id-type="pmid">20700497</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thurley</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>IF</given-names></name>, <name name-style="western"><surname>Tovey</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Parker</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>Timescales of IP<sub>3</sub>-evoked Ca<sup>2+</sup> spikes emerge from Ca<sup>2+</sup> puffs only at the cellular level</article-title>. <source>Biophysical Journal</source>. <year>2011</year>;<volume>101</volume>(<issue>11</issue>):<fpage>2638</fpage>–<lpage>2644</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2011.10.030" xlink:type="simple">10.1016/j.bpj.2011.10.030</ext-link></comment> <object-id pub-id-type="pmid">22261051</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thurley</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Skupin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Thul</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>Fundamental properties of Ca<sup>2+</sup> signals</article-title>. <source>Biochimica et Biophysica Acta</source>. <year>2012</year>;<volume>1820</volume>(<issue>8</issue>):<fpage>1185</fpage>–<lpage>1194</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bbagen.2011.10.007" xlink:type="simple">10.1016/j.bbagen.2011.10.007</ext-link></comment> <object-id pub-id-type="pmid">22040723</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dupont</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Croisier</surname> <given-names>H</given-names></name>. <article-title>Spatiotemporal organization of Ca<sup>2+</sup> dynamics: a modeling-based approach</article-title>. <source>HFSP Journal</source>. <year>2010</year>;<volume>4</volume>(<issue>2</issue>):<fpage>43</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2976/1.3385660" xlink:type="simple">10.2976/1.3385660</ext-link></comment> <object-id pub-id-type="pmid">20885772</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Caluwé</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dupont</surname> <given-names>G</given-names></name>. <article-title>The progression towards Alzheimer’s disease described as a bistable switch arising from the positive loop between amyloids and Ca<sup>2+</sup></article-title>. <source>Journal of Theoretical Biology</source>. <year>2013</year>;<volume>331</volume>:<fpage>12</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2013.04.015" xlink:type="simple">10.1016/j.jtbi.2013.04.015</ext-link></comment> <object-id pub-id-type="pmid">23614875</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dupont</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Abou-Lovergne</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Combettes</surname> <given-names>L</given-names></name>. <article-title>Stochastic aspects of oscillatory Ca<sup>2+</sup> dynamics in hepatocytes</article-title>. <source>Biophysical Journal</source>. <year>2008</year>;<volume>95</volume>(<issue>5</issue>):<fpage>2193</fpage>–<lpage>2202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1529/biophysj.108.133777" xlink:type="simple">10.1529/biophysj.108.133777</ext-link></comment> <object-id pub-id-type="pmid">18515398</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shuai</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>P</given-names></name>. <article-title>Optimal intracellular calcium signaling</article-title>. <source>Physical Review Letters</source>. <year>2002</year>;<volume>88</volume>(<issue>6</issue>):<fpage>068102</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.88.068102" xlink:type="simple">10.1103/PhysRevLett.88.068102</ext-link></comment> <object-id pub-id-type="pmid">11863855</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shuai</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>P</given-names></name>. <article-title>Stochastic properties of Ca<sup>2+</sup> release of inositol 1,4,5-trisphosphate receptor clusters</article-title>. <source>Biophysical Journal</source>. <year>2002</year>;<volume>83</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>97</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(02)75151-5" xlink:type="simple">10.1016/S0006-3495(02)75151-5</ext-link></comment> <object-id pub-id-type="pmid">12080102</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shuai</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>P</given-names></name>. <article-title>Selection of intracellular calcium patterns in a model with clustered Ca<sup>2+</sup> release channels</article-title>. <source>Physical Review E</source>. <year>2003</year>;<volume>67</volume>(<issue>3 Pt 1</issue>):<fpage>031905</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.67.031905" xlink:type="simple">10.1103/PhysRevE.67.031905</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Williams</surname> <given-names>GSB</given-names></name>, <name name-style="western"><surname>Molinelli</surname> <given-names>EJ</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>GD</given-names></name>. <article-title>Modeling local and global intracellular calcium responses mediated by diffusely distributed inositol 1,4,5-trisphosphate receptors</article-title>. <source>Journal of Theoretical Biology</source>. <year>2008</year>;<volume>253</volume>(<issue>1</issue>):<fpage>170</fpage>–<lpage>188</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2008.02.040" xlink:type="simple">10.1016/j.jtbi.2008.02.040</ext-link></comment> <object-id pub-id-type="pmid">18405920</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nguyen</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Mathias</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>GD</given-names></name>. <article-title>A stochastic automata network descriptor for Markov chain models of instantaneously coupled intracellular Ca<sup>2+</sup> channels</article-title>. <source>Bulletin of Mathematical Biology</source>. <year>2005</year>;<volume>67</volume>(<issue>3</issue>):<fpage>393</fpage>–<lpage>432</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bulm.2004.08.010" xlink:type="simple">10.1016/j.bulm.2004.08.010</ext-link></comment> <object-id pub-id-type="pmid">15820736</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mazzag</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tignanelli</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>GD</given-names></name>. <article-title>The effect of residual on the stochastic gating of -regulated channel models</article-title>. <source>Journal of Theoretical Biology</source>. <year>2005</year>;<volume>235</volume>(<issue>1</issue>):<fpage>121</fpage>–<lpage>150</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jtbi.2004.12.024" xlink:type="simple">10.1016/j.jtbi.2004.12.024</ext-link></comment> <object-id pub-id-type="pmid">15833318</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>DeRemigio</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>GD</given-names></name>. <article-title>The dynamics of stochastic attrition viewed as an absorption time on a terminating Markov chain</article-title>. <source>Cell Calcium</source>. <year>2005</year>;<volume>38</volume>(<issue>2</issue>):<fpage>73</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ceca.2005.06.007" xlink:type="simple">10.1016/j.ceca.2005.06.007</ext-link></comment> <object-id pub-id-type="pmid">16099503</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref030">
<label>30</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Dupont</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kirk</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Sneyd</surname> <given-names>J</given-names></name>. <chapter-title>Models of Calcium Signalling</chapter-title>. <source>vol. 43 of Interdisciplinary Applied Mathematics</source>. <publisher-name>Springer</publisher-name>; <year>2016</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref031">
<label>31</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Daley</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Vere-Jones</surname> <given-names>D</given-names></name>. <source>An Introduction to the Theory of Point Processes</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>1988</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skupin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>From puffs to global Ca<sup>2+</sup> signals: how molecular properties shape global signals</article-title>. <source>Chaos (Woodbury, NY)</source>. <year>2009</year>;<volume>19</volume>(<issue>3</issue>):<fpage>037111</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.3184537" xlink:type="simple">10.1063/1.3184537</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Skupin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>Statistical analysis of calcium oscillations</article-title>. <source>The European Physical Journal Special Topics</source>. <year>2010</year>;<volume>187</volume>(<issue>1</issue>):<fpage>231</fpage>–<lpage>240</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1140/epjst/e2010-01288-9" xlink:type="simple">10.1140/epjst/e2010-01288-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref034">
<label>34</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rasmussen</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>CKI</given-names></name>. <source>Gaussian Processes for Machine Learning</source>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Czanner</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sarma</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>Ba</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eskandar</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Measuring the signal-to-noise ratio of a neuron</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2015</year>;<volume>112</volume>(<issue>23</issue>):<fpage>7141</fpage>–<lpage>7146</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1505545112" xlink:type="simple">10.1073/pnas.1505545112</ext-link></comment> <object-id pub-id-type="pmid">25995363</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref036">
<label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Cunningham</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Shenoy</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sahani</surname> <given-names>M</given-names></name>. <chapter-title>Inferring Neural Firing Rates from Spike Trains Using Gaussian Processes</chapter-title>. In: <name name-style="western"><surname>Platt</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Koller</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Roweis</surname> <given-names>S</given-names></name>, editors. <source>Advances in Neural Information Processing Systems</source> <volume>20</volume>. <publisher-loc>Cambridge, MA</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>2008</year>. p. <fpage>329</fpage>–<lpage>336</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barbieri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Quirk</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>Construction and analysis of non-Poisson stimulus-response models of neural spiking activity</article-title>. <source>Journal of Neuroscience Methods</source>. <year>2001</year>;<volume>105</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>37</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0165-0270(00)00344-7" xlink:type="simple">10.1016/S0165-0270(00)00344-7</ext-link></comment> <object-id pub-id-type="pmid">11166363</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref038">
<label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rieke</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Warland</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>de Ruyter von Steveninck</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name>. <source>Spikes</source>. <publisher-name>MIT Press</publisher-name>; <year>1999</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref039">
<label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Arthur D, Vassilvitskii S. k-means++: the advantages of careful seeding. In: Proceedings of the Eighteenth Annual ACM-SIAM Symposium on Discrete Algorithms. ACM, New York; 2007. p. 1027–1035.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Keizer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>YX</given-names></name>, <name name-style="western"><surname>Stojilković</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rinzel</surname> <given-names>J</given-names></name>. <article-title>InsP<sub>3</sub>-induced Ca<sup>2+</sup> excitability of the endoplasmic reticulum</article-title>. <source>Molecular Biology of the Cell</source>. <year>1995</year>;<volume>6</volume>(<issue>8</issue>):<fpage>945</fpage>–<lpage>951</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1091/mbc.6.8.945" xlink:type="simple">10.1091/mbc.6.8.945</ext-link></comment> <object-id pub-id-type="pmid">7579710</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>On the role of stochastic channel behavior in intracellular Ca<sup>2+</sup> dynamics</article-title>. <source>Biophysical Journal</source>. <year>2003</year>;<volume>84</volume>(<issue>1</issue>):<fpage>42</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(03)74831-0" xlink:type="simple">10.1016/S0006-3495(03)74831-0</ext-link></comment> <object-id pub-id-type="pmid">12524264</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thul</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>Frequency of elemental events of intracellular Ca<sup>2+</sup> dynamics</article-title>. <source>Physical Review E</source>. <year>2006</year>;<volume>73</volume>(<issue>6 Pt 1</issue>):<fpage>061923</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.73.061923" xlink:type="simple">10.1103/PhysRevE.73.061923</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thul</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>Waiting time distributions for clusters of complex molecules</article-title>. <source>Europhysics Letters</source>. <year>2007</year>;<volume>79</volume>(<issue>3</issue>):<fpage>38003</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1209/0295-5075/79/38003" xlink:type="simple">10.1209/0295-5075/79/38003</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moenke</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Thurley</surname> <given-names>K</given-names></name>. <article-title>Hierarchic Stochastic Modelling Applied to Intracellular Ca<sup>2+</sup> Signals</article-title>. <source>PloS One</source>. <year>2012</year>;<volume>7</volume>(<issue>12</issue>):–<fpage>e51178</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0051178" xlink:type="simple">10.1371/journal.pone.0051178</ext-link></comment> <object-id pub-id-type="pmid">23300536</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref045">
<label>45</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Redner</surname> <given-names>S</given-names></name>. <source>A Guide to First-Passage Processes</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2001</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilk</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Gnanadesikan</surname> <given-names>R</given-names></name>. <article-title>Probability plotting methods for the analysis of data</article-title>. <source>Biometrika</source>. <year>1968</year>;<volume>55</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>17</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/55.1.1" xlink:type="simple">10.1093/biomet/55.1.1</ext-link></comment> <object-id pub-id-type="pmid">5661047</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>, <name name-style="western"><surname>Barbieri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ventura</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>LM</given-names></name>. <article-title>The time-rescaling theorem and its application to neural spike train data analysis</article-title>. <source>Neural Computation</source>. <year>2002</year>;<volume>14</volume>(<issue>2</issue>):<fpage>325</fpage>–<lpage>346</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/08997660252741149" xlink:type="simple">10.1162/08997660252741149</ext-link></comment> <object-id pub-id-type="pmid">11802915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Ventura</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>Statistical issues in the analysis of neuronal data</article-title>. <source>Journal of Neurophysiology</source>. <year>2005</year>;<volume>94</volume>(<issue>1</issue>):<fpage>8</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00648.2004" xlink:type="simple">10.1152/jn.00648.2004</ext-link></comment> <object-id pub-id-type="pmid">15985692</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref049">
<label>49</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Shinomoto</surname> <given-names>S</given-names></name>. <chapter-title>Estimating the Firing Rate</chapter-title>. In: <name name-style="western"><surname>Grün</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>, editors. <source>Analysis of Parallel Spike Trains</source>. <publisher-loc>Boston, MA</publisher-loc>: <publisher-name>Springer US</publisher-name>; <year>2010</year>. p. <fpage>21</fpage>–<lpage>35</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shimazaki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Shinomoto</surname> <given-names>S</given-names></name>. <article-title>Kernel bandwidth optimization in spike rate estimation</article-title>. <source>Journal of Computational Neuroscience</source>. <year>2010</year>;<volume>29</volume>(<issue>1-2</issue>):<fpage>171</fpage>–<lpage>182</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-009-0180-4" xlink:type="simple">10.1007/s10827-009-0180-4</ext-link></comment> <object-id pub-id-type="pmid">19655238</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shimazaki</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Shinomoto</surname> <given-names>S</given-names></name>. <article-title>A method for selecting the bin size of a time histogram</article-title>. <source>Neural Computation</source>. <year>2007</year>;<volume>19</volume>(<issue>6</issue>):<fpage>1503</fpage>–<lpage>1527</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2007.19.6.1503" xlink:type="simple">10.1162/neco.2007.19.6.1503</ext-link></comment> <object-id pub-id-type="pmid">17444758</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Falcke</surname> <given-names>M</given-names></name>. <article-title>Reading the patterns in living cells—the physics of Ca<sup>2+</sup> signaling</article-title>. <source>Advances in Physics</source>. <year>2004</year>;<volume>53</volume>(<issue>3</issue>):<fpage>255</fpage>–<lpage>440</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/00018730410001703159" xlink:type="simple">10.1080/00018730410001703159</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thul</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bellamy</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Roderick</surname> <given-names>HL</given-names></name>, <name name-style="western"><surname>Bootman</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Coombes</surname> <given-names>S</given-names></name>. <article-title>Calcium oscillations</article-title>. <source>Advances in Experimental Medicine and Biology</source>. <year>2008</year>;<volume>641</volume>:<fpage>1</fpage>–<lpage>27</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-0-387-09794-7_1" xlink:type="simple">10.1007/978-0-387-09794-7_1</ext-link></comment> <object-id pub-id-type="pmid">18783168</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thul</surname> <given-names>R</given-names></name>. <article-title>Translating intracellular calcium signaling into models</article-title>. <source>Cold Spring Harbor Protocols</source>. <year>2014</year>;<volume>2014</volume>(<issue>5</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/pdb.top066266" xlink:type="simple">10.1101/pdb.top066266</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tay</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hughey</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Lipniacki</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Quake</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Covert</surname> <given-names>MW</given-names></name>. <article-title>Single-cell NF-<italic>κ</italic>B dynamics reveal digital activation and analogue information processing</article-title>. <source>Nature</source>. <year>2010</year>;<volume>466</volume>(<issue>7303</issue>):<fpage>267</fpage>–<lpage>271</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09145" xlink:type="simple">10.1038/nature09145</ext-link></comment> <object-id pub-id-type="pmid">20581820</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hughey</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Gutschow</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Bajar</surname> <given-names>BT</given-names></name>, <name name-style="western"><surname>Covert</surname> <given-names>MW</given-names></name>. <article-title>Single-cell variation leads to population invariance in NF-<italic>κ</italic>B signaling dynamics</article-title>. <source>Molecular Biology of the Cell</source>. <year>2015</year>;<volume>26</volume>(<issue>3</issue>):<fpage>583</fpage>–<lpage>590</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1091/mbc.E14-08-1267" xlink:type="simple">10.1091/mbc.E14-08-1267</ext-link></comment> <object-id pub-id-type="pmid">25473117</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Turner</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Paszek</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Woodcock</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Horton</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Physiological levels of TNF alpha stimulation induce stochastic dynamics of NF-kappa B responses in single living cells</article-title>. <source>Journal of Cell Science</source>. <year>2010</year>;<volume>123</volume>(<issue>16</issue>):<fpage>2834</fpage>–<lpage>2843</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1242/jcs.069641" xlink:type="simple">10.1242/jcs.069641</ext-link></comment> <object-id pub-id-type="pmid">20663918</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref058">
<label>58</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pillow</surname> <given-names>J</given-names></name>. <chapter-title>Time-rescaling methods for the estimation and assessment of non-Poisson neural encoding models</chapter-title>. In: <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Schuurmans</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lafferty</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>CKI</given-names></name>, <name name-style="western"><surname>Culotta</surname> <given-names>A</given-names></name>, editors. <source>Advances in Neural Information Processing Systems</source> <volume>22</volume>; <year>2009</year>. p. <fpage>1473</fpage>–<lpage>1481</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref059">
<label>59</label>
<mixed-citation publication-type="other" xlink:type="simple">Cunningham JP, Shenoy KV, Sahani M. Fast Gaussian process methods for point process intensity estimation. In: Proceedings of the 25th International Conference on Machine Learning. Stanford University, Palo Alto, United States; 2008. p. 192–199.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref060">
<label>60</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Mackay</surname> <given-names>DJC</given-names></name>. <chapter-title>Introduction to Gaussian Processes</chapter-title>. In: <name name-style="western"><surname>Bishop</surname> <given-names>CM</given-names></name>, editor. <source>Neural Networks and Machine Learning. NATO ASI Series F Computer and Systems Sciences</source>. <publisher-name>Springer</publisher-name>; <year>1998</year>. p. <fpage>133</fpage>–<lpage>168</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Papangelou</surname> <given-names>F</given-names></name>. <article-title>Integrability of Expected Increments of Point Processes and a Related Random Change of Scale</article-title>. <source>Transactions of the American Mathematical Society</source>. <year>1972</year>;<volume>165</volume>:<fpage>483</fpage>–<lpage>506</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1090/S0002-9947-1972-0314102-9" xlink:type="simple">10.1090/S0002-9947-1972-0314102-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ogata</surname> <given-names>Y</given-names></name>. <article-title>Statistical Models for Earthquake Occurrences and Residual Analysis for Point Processes</article-title>. <source>Journal of the American Statistical Association</source>. <year>1988</year>;<volume>83</volume>(<issue>401</issue>):<fpage>9</fpage>–<lpage>27</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1988.10478560" xlink:type="simple">10.1080/01621459.1988.10478560</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nawrot</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rotter</surname> <given-names>S</given-names></name>. <article-title>Single-trial estimation of neuronal firing rates: from single-neuron spike trains to population activity</article-title>. <source>Journal of Neuroscience Methods</source>. <year>1999</year>;<volume>94</volume>(<issue>1</issue>):<fpage>81</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0165-0270(99)00127-2" xlink:type="simple">10.1016/S0165-0270(99)00127-2</ext-link></comment> <object-id pub-id-type="pmid">10638817</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref064">
<label>64</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gan</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>J</given-names></name>. <chapter-title>Data clustering—theory, algorithms, and applications</chapter-title>. <source>SIAM</source>; <year>2007</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref065">
<label>65</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Devroye</surname> <given-names>L</given-names></name>. <source>Non-Uniform Random Variate Generation</source>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer</publisher-name>; <year>1986</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005794.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name>. <article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects</article-title>. <source>Journal of Neurophysiology</source>. <year>2005</year>;<volume>93</volume>(<issue>2</issue>):<fpage>1074</fpage>–<lpage>1089</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00697.2004" xlink:type="simple">10.1152/jn.00697.2004</ext-link></comment> <object-id pub-id-type="pmid">15356183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005794.ref067">
<label>67</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Russell</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Johnstone</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Alexander</surname> <given-names>M</given-names></name>. <chapter-title>Long-term imaging of fibroblasts in a microfluidic device</chapter-title>. In: <source>Functional Optical Imaging</source>; <year>2011</year>. p. <fpage>1</fpage>–<lpage>2</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>