<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005753</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00586</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Discrete mathematics</subject><subj-group><subject>Combinatorics</subject><subj-group><subject>Permutation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Behavior</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Behavior</subject><subj-group><subject>Habits</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical models</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Flexibility to contingency changes distinguishes habitual and goal-directed strategies in humans</article-title>
<alt-title alt-title-type="running-head">Flexibility to contingency changes distinguishes decision strategies</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7293-8538</contrib-id>
<name name-style="western">
<surname>Lee</surname>
<given-names>Julie J.</given-names>
</name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Keramati</surname>
<given-names>Mehdi</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Gatsby Computational Neuroscience Unit, University College London, London, United Kingdom</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Institute of Ophthalmology, University College London, London, United Kingdom</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Max Planck UCL Centre for Computational Psychiatry and Ageing Research, University College London, London, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Gershman</surname>
<given-names>Samuel J.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Harvard University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">julie.lee.15@ucl.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>28</day>
<month>9</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>9</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>9</issue>
<elocation-id>e1005753</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>4</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>31</day>
<month>8</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Lee, Keramati</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005753"/>
<abstract>
<p>Decision-making in the real world presents the challenge of requiring flexible yet prompt behavior, a balance that has been characterized in terms of a trade-off between a slower, prospective goal-directed model-based (MB) strategy and a fast, retrospective habitual model-free (MF) strategy. Theory predicts that flexibility to changes in both reward values and transition contingencies can determine the relative influence of the two systems in reinforcement learning, but few studies have manipulated the latter. Therefore, we developed a novel two-level contingency change task in which transition contingencies between states change every few trials; MB and MF control predict different responses following these contingency changes, allowing their relative influence to be inferred. Additionally, we manipulated the rate of contingency changes in order to determine whether contingency change volatility would play a role in shifting subjects between a MB and MF strategy. We found that human subjects employed a hybrid MB/MF strategy on the task, corroborating the parallel contribution of MB and MF systems in reinforcement learning. Further, subjects did not remain at one level of MB/MF behaviour but rather displayed a shift towards more MB behavior over the first two blocks that was not attributable to the rate of contingency changes but rather to the extent of training. We demonstrate that flexibility to contingency changes can distinguish MB and MF strategies, with human subjects utilizing a hybrid strategy that shifts towards more MB behavior over blocks, consequently corresponding to a higher payoff.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>To make good decisions, we must learn to associate actions with their true outcomes. Flexibility to changes in action/outcome relationships, therefore, is essential for optimal decision-making. For example, actions can lead to outcomes that change in value – one day, your favorite food is poorly made and thus less pleasant. Alternatively, changes can occur in terms of contingencies–ordering a dish of one kind and instead receiving another. How we respond to such changes is indicative of our decision-making strategy; habitual learners will continue to choose their favorite food even if the quality has gone down, whereas goal-directed learners will soon learn it is better to choose another dish. A popular paradigm probes the effect of value changes on decision-making, but the effect of contingency changes is still unexplored. Therefore, we developed a novel task to study the latter. We find that humans used a mixed habitual/goal-directed strategy in which they became more goal-directed over the course of the task, and also earned more rewards with increasing goal-directed behavior. This shows that flexibility to contingency changes is adaptive for learning from rewards, and indicates that flexibility to contingency changes can reveal which decision-making strategy is used.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>109004/Z/15/Z</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-7293-8538</contrib-id>
<name name-style="western">
<surname>Lee</surname>
<given-names>Julie J.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>JJL is supported by a Wellcome Trust (<ext-link ext-link-type="uri" xlink:href="https://wellcome.ac.uk/" xlink:type="simple">https://wellcome.ac.uk/</ext-link>) doctoral fellowship 109004/Z/15/Z. MK is supported by the Gatsby Charitable Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.gatsby.org.uk/" xlink:type="simple">http://www.gatsby.org.uk/</ext-link>) and Max Planck UCL Centre for Computational Psychiatry (<ext-link ext-link-type="uri" xlink:href="https://www.mps-ucl-centre.mpg.de/en" xlink:type="simple">https://www.mps-ucl-centre.mpg.de/en</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="3"/>
<table-count count="0"/>
<page-count count="15"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-10-10</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All data are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/juliejlee42/contingencychanges" xlink:type="simple">https://github.com/juliejlee42/contingencychanges</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>For optimal decision-making, animals must learn to associate the choices they make with the outcomes that arise from them. Classical learning theories suggest that this problem is addressed by habitual or goal-directed strategies for reinforcement learning [<xref ref-type="bibr" rid="pcbi.1005753.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref002">2</xref>]. These strategies differ in that habitual behavior seeks simply to reinforce responses based on environmental cues, whereas goal-directed behavior considers action-outcome relationships – that is, contingencies–in the environment. Habitual and goal-directed strategies have been implemented in model-based (MB) and model-free (MF) reinforcement learning algorithms, respectively. Both algorithms make decisions by estimating action values and choosing the actions that maximize reward in the long term [<xref ref-type="bibr" rid="pcbi.1005753.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref004">4</xref>]. The MF system achieves this retrospectively, caching past rewards using a reward prediction error signal [<xref ref-type="bibr" rid="pcbi.1005753.ref005">5</xref>] whereas the MB system achieves this prospectively, planning using a learned internal model of the state transitions and rewards in the environment [<xref ref-type="bibr" rid="pcbi.1005753.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1005753.ref007">7</xref>].</p>
<p>Recent studies have emphasized that MB and MF systems work in parallel rather than in isolation [<xref ref-type="bibr" rid="pcbi.1005753.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1005753.ref010">10</xref>]. Early studies discerned MB and MF contributions using manipulations of reward values, such as in reward devaluation paradigms, but did not seek to quantify their relative contributions [<xref ref-type="bibr" rid="pcbi.1005753.ref001">1</xref>]. A recent study [<xref ref-type="bibr" rid="pcbi.1005753.ref008">8</xref>] addressed this by developing the hallmark “two-step” task in which each trial following rare or common outcomes was informative of the MB/MF tradeoff, thereby permitting model-fitting analyses to quantify their relative influence in decision-making. Human subjects showed a hybrid MB/MF strategy in the task, a result that has been widely replicated under different manipulations [<xref ref-type="bibr" rid="pcbi.1005753.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref013">13</xref>] and extended to the non-human animal literature (Groman et al. Soc. Neurosci. Abstracts 2014, 558.19, Miranda et al. Soc. Neurosci. Abstracts 2014 756.09, Akam et al. Cosyne Abstracts 2015, II-15; Hasz &amp; Redish, Soc. Neurosci. Abstracts 2016 638.08). All these studies measured MB/MF contributions in terms of behavioral flexibility following reward updates, whereby “rare” (as opposed to “common”) observations of a rewarded or unrewarded outcome was informative to the MB system, but not the MF system, and thus these observations disclosed which system controlled participants’ choices.</p>
<p>Theory predicts that flexibility to transition contingency changes can – like flexibility to reward structure–determine the relative influence of MB and MF strategies [<xref ref-type="bibr" rid="pcbi.1005753.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref014">14</xref>]. Two studies have examined the flexibility of MB and MF systems to global contingency changes [<xref ref-type="bibr" rid="pcbi.1005753.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref016">16</xref>]. However, quantification of the MB/MF tradeoff was limited as these studies manipulated contingency and tested flexibility to the change of contingency in separate phases; at these timescales, it becomes difficult to exclude the effect of adaptation on MB/MF weights. Thus, we developed a novel two-level contingency change task containing multiple, frequent and interleaved transition contingency changes that elicit different consequent actions by the MB and MF systems. Our design, like the two-step task [<xref ref-type="bibr" rid="pcbi.1005753.ref008">8</xref>] and its variants, therefore permits model-fitting analyses to robustly determine the relative influence of the MB/MF systems. The contingency change task is structured such that actions following frequent contingency changes are distinctly attributed to either a MB or MF strategy; this then permits quantification of the degree to which each system is in control.</p>
<p>On top of a hybrid MB/MF strategy, subjects may not remain at one level of MB/MF control but instead shift their relative weight in accordance with environmental factors. In general, animals show habit formation with time, a robust effect reported since early reward devaluation studies [<xref ref-type="bibr" rid="pcbi.1005753.ref017">17</xref>] in which extensive training stamped in habits, resulting in insensitivity to reward devaluation; in contrast, limited training retained goal-directed behavior. Sensitivity to contingency degradation (the omission of a previously-learned contingency between actions and outcomes) also decreases with overtraining, likewise reflecting a trend towards habitization with time [<xref ref-type="bibr" rid="pcbi.1005753.ref018">18</xref>]. In the original two-step task, the MB/MF trade-off was designed to be stable [<xref ref-type="bibr" rid="pcbi.1005753.ref008">8</xref>], but will shift under manipulations such as limited time [<xref ref-type="bibr" rid="pcbi.1005753.ref010">10</xref>] or cognitive load [<xref ref-type="bibr" rid="pcbi.1005753.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref020">20</xref>]. However, habits are not guaranteed to form with time; even after extended training, rats can show residual flexible responding following outcome devaluation, indicating that they retained goal-directed behavior despite overtraining [<xref ref-type="bibr" rid="pcbi.1005753.ref021">21</xref>]. In another study using the two-step task [<xref ref-type="bibr" rid="pcbi.1005753.ref020">20</xref>], the level of MB/MF control in fact increased in favour of more MB control (i.e. towards less habitual behavior) over three days of training. However, general shifts in MB/MF control should be disentangled from the effects of environmental volatility, which are known to affect the MB/MF balance [<xref ref-type="bibr" rid="pcbi.1005753.ref022">22</xref>]. Thus, in this study, we examined whether the MB/MF relationship is affected by environmental stability, or whether it shifts more generally over time.</p>
<p>We found that human subjects indeed showed a hybrid strategy in reacting to contingency changes in our task, with an increased influence of MB control over the first two blocks. However, relative MB/MF control did not significantly differ across rates of contingency changes; thus, the increase in MB control may be a more global effect of “anti-habitization” over time.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>Subjects (N = 16) performed a two-level contingency change task that consisted of 600 trials (<xref ref-type="fig" rid="pcbi.1005753.g001">Fig 1</xref>). Each trial began at either the first level (S0) with 50% probability, or the second level with 50% probability – 25% for each of the two states at this level (S1 or S2). If a trial started at the first level, a two-alternative choice was possible between two abstract stimuli. Each first-level action always deterministically led to the same second-level state, i.e. A1 to S1 and A2 to S2. Critically however, transitions from the second-level states to the terminal states flipped between two contingencies every 3–14 trials. Each of the two terminal states was then associated with either high or low reward, with the exact reward values drifting across trials (see <xref ref-type="sec" rid="sec004">Methods</xref> for details). Thus, flexibility to contingency changes was essential for maximizing reward.</p>
<fig id="pcbi.1005753.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005753.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schematic of the experimental design.</title>
<p>(A) Each trial started from either the first-level state (S0), with 50% probability, or one of the two second-level states (S1 or S2), each with 25% probability. While two choices were available at S0, only a single forced choice was available at the second-level states. The transition structure from the second-level states to terminal states repeatedly flipped after a random number of trials (every 3–14), in an unsignalled fashion. One of the two terminal states (S3 or S4) was associated with a high reward outcome and the other resulted in a low reward outcome. (B) Timeline of the task for one example trial.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.g001" xlink:type="simple"/>
</fig>
<p>If a contingency change occurred, subjects always experienced the new transition structure regardless of whether they started at the first or second level, as contingency could only change between second-level and terminal states. Therefore, provided that an action was possible at the next trial (i.e. that the next trial started at the first level) the MB system would plan using the updated causal structure and thus would take the action that led under the new transition contingencies to the high reward terminal state. However, if a contingency change trial started from the second level, the MF system would not choose the optimal action on the next trial, as neither the received reward nor the new contingency would update the cached values of first-level actions, simply because no first-level action was experienced on those trials. As a result, the relative contribution of MB and MF systems can be measured by the degree of behavioral flexibility on first-level trials following contingency change trials starting from the second level.</p>
<p>To examine the effect of environmental volatility on the contribution of the two systems, the frequency of contingency changes was varied–from 3–6 trials for 200 trials, to 7–10 trials for another 200 trials, and then 11–14 trials for the final 200 trials. The order of fast and medium contingency-change blocks was counterbalanced across two subject groups (<italic>n</italic> = 8 each). Every 40 trials, assignment of the high and low reward states also flipped to prevent formation of habits over an extended state representation, which could masquerade MF as MB behavior [<xref ref-type="bibr" rid="pcbi.1005753.ref023">23</xref>].</p>
<p>Simulated choices on the task were implemented according to MB and MF reinforcement learning algorithms (see <xref ref-type="sec" rid="sec004">Methods</xref> for details). For each system, we measured a “stay probability” index that followed the logic of contingency change trials described above. This index differs from classic stay probabilities [<xref ref-type="bibr" rid="pcbi.1005753.ref008">8</xref>] as trials starting from the second level do not have any choices to “stay”. Instead, stay probability in our task was defined as the probability of choosing the first-level action that results in the same second-level state as the previous trial. Stay probability was measured for four different conditions: whether the reward received in the previous trial was “high” or “low”, and whether the transition experienced in the previous trial, relative to the trial before that, was “changed” or remained “fixed”. Our analyses of stay/switch choices were restricted to trials that started from the first level and thus allowed the participants to make a choice. Furthermore, we restricted our analyses to first level trials following trials starting at the second level, since only these could distinguish MB and MF strategies.</p>
<p>Across these conditions, MB and MF systems showed different stay probability patterns. The MF system, having no experience of the action that led to the new contingency, was more likely to stay on the action leading to the high reward state, and shift on the action leading to the low reward state, under “fixed” than “changed” conditions (<italic>p</italic> &lt; 0.01), indicating it was not flexible to changes in contingencies (<xref ref-type="fig" rid="pcbi.1005753.g002">Fig 2A</xref>). However, the MB system could immediately adapt with the correct next action, staying on the action if it would lead to the high-reward state but shifting if it would lead to the low-reward state, with a main effect of reward (<italic>p</italic> &lt; 0.01) regardless of contingency condition (<xref ref-type="fig" rid="pcbi.1005753.g002">Fig 2B</xref>). As expected, for contingency changes from the first level, MB and MF systems did not differ in stay probability patterns, as the MF system was able to update its action values accordingly, given that it directly experienced the action leading to the new contingency (<xref ref-type="supplementary-material" rid="pcbi.1005753.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005753.s002">S2</xref> Figs). In addition to pure MF and pure MB strategies, we simulated a hybrid model that linearly weights MB and MF action values according to a parameter <italic>wMB</italic>. The stay probability pattern produced by this hybrid system reflected a mixture of the effects observed for the pure MF and MB stay probabilities–that is, showing a main effect of reward (<italic>p</italic> &lt; 0.01), but also an interaction between reward and contingency (<italic>p</italic> &lt; 0.01) (<xref ref-type="fig" rid="pcbi.1005753.g002">Fig 2C</xref>).</p>
<fig id="pcbi.1005753.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005753.g002</object-id>
<label>Fig 2</label>
<caption>
<title/>
<p><bold>Stay probability patterns predicted by simulating model-free (A), model-based (B), and hybrid (C) reinforcement learning algorithms.</bold> Stay probability measures the probability of choosing the first-level action that results in the same second-level state as the previous trial. This index was measured for trials under four conditions: whether the reward received in the previous trial was “high” or “low”, and whether the transition experienced in the previous trial (relative to the trial before that) had its contingency “changed” or remained “fixed”. Stay probabilities are plotted for trials following a change trial that started at the second level, as only these distinguish model-free and model-based strategies. For the hybrid model (C), the parameter <italic>wMB</italic> was set to 0.56, the median value of the parameter inferred from participants’ behavior. * <italic>p</italic> &lt; 0.05, ** <italic>p</italic> &lt; 0.01.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.g002" xlink:type="simple"/>
</fig>
<p>Subjects showed hallmarks of both MB and MF strategies in reacting to contingency changes (<xref ref-type="fig" rid="pcbi.1005753.g003">Fig 3A</xref>), showing a main effect of reward, <italic>F</italic>(1,60) = 24.65, <italic>p</italic> &lt; 0.01, as well as a reward/contingency interaction, <italic>F</italic>(1,60) = 13.60, <italic>p</italic> &lt; 0.01. Therefore, subjects did not solely use a MB or MF strategy when reacting to contingency changes, but rather displayed a hybrid MB/MF strategy.</p>
<fig id="pcbi.1005753.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005753.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Experimental results.</title>
<p>(A) Stay probabilities from human subjects (N = 16) showed significant effects of both model-based (<italic>p</italic> &lt; 0.01) and model-free (<italic>p</italic> &lt; 0.01) strategies. * <italic>p</italic> &lt; 0.05, ** <italic>p</italic> &lt; 0.01 (B) Probability density function over the model-based weight parameter, estimated in three different blocks of the first, middle and last 200 trials (out of 600 trials). Overlaid are the individual subjects’ model-based weight parameter estimates for each block type. Error bars represent standard deviation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.g003" xlink:type="simple"/>
</fig>
<p>While stay probabilities ruled out a purely MB or purely MF strategy, this measure could not quantify the degree to which subjects used the hybrid strategy; therefore, we used a hierarchical Bayesian method to fit candidate models of behavior to the subjects’ data, to determine which model best explained subjects’ choices and to obtain parameter estimates for the MB/MF weighting used by the subjects. The models tested included a pure MB model, a pure MF model, a hybrid model with one constant weight <italic>wMB</italic> across the session, a hybrid model with three separate <italic>wMB</italic> weights for each range of contingency change rates (fast, medium, or slow), and a hybrid model with three separate wMB weights for the three experimental blocks. The last two models served to test whether the relative contribution of the two systems depended on volatility of transition structure, or instead on block order, as contingency change rates were counter-balanced across the first two blocks. Model-fitting was confirmed to be able to recover true parameter values, as simulations showed that median estimated parameter values from model-fitting (see <xref ref-type="sec" rid="sec004">Methods</xref> for details) were well-correlated to known simulated parameter values, <italic>r</italic> ≥ 0.99, <italic>p</italic> &lt; 0.01.</p>
<p>Model-fitting results supported the existence of a hybrid MB/MF strategy in our task. Candidate models were compared using two criteria – integrated Bayesian Information Criterion (iBIC) which controls for number of parameters [<xref ref-type="bibr" rid="pcbi.1005753.ref024">24</xref>] and exceedance probabilities [<xref ref-type="bibr" rid="pcbi.1005753.ref025">25</xref>] (<xref ref-type="supplementary-material" rid="pcbi.1005753.s006">S2 Table</xref>). The hybrid model with three <italic>wMB</italic> weights over blocks outperformed the other candidate models under both criteria, with the lowest iBIC and a probability of 89.4% that it was the most common of the four models across subjects. Thus, from here we only discuss the results of best-fit model, the three-block hybrid model.</p>
<p>The median fitted <italic>wMB</italic> weights in the three-block hybrid increased across the three blocks (<xref ref-type="fig" rid="pcbi.1005753.g003">Fig 3B–3D</xref>), indicating some extent of “anti-habitization” rather than habit formation. The increase of <italic>wMB</italic> from block 1 to block 2, but not the increase from block 2 to block 3, was significant according to permutation tests, <italic>p</italic> &lt; 0.01. Stay probability analyses were not conducted on the three separate blocks, as slower contingency changes meant that the later blocks had fewer samples of contingency changes for comparison. The increase in <italic>wMB</italic> across blocks was not attributable to differences in quality of fit from the model-fitting procedure, as the log-likelihood of parameter estimates did not differ significantly across blocks, <italic>F</italic>(2,45) = 1.42, <italic>p</italic> &gt; 0.05. Strength of correlations between simulated <italic>wMB</italic> weights and <italic>wMB</italic> weights recovered from simulation were also similar across blocks (block 1: <italic>r</italic> = 0.99, block 2: <italic>r</italic> = 1.00, block 3: <italic>r</italic> = 0.99; <italic>p</italic> &lt; 0.01 for all blocks). Therefore, the significant increase in <italic>wMB</italic> from the first to second block was not caused by differences in quality of model fit.</p>
<p>To confirm that the increase in model-based weight was not due to differences in the rate of contingency changes, we further analysed the fitted weights from the three-frequency hybrid model, which had a different <italic>wMB</italic> assigned to each range of contingency change rates, i.e. fast (every 3–6 trials), medium (every 7–10 trials) and slow (every 11–14 trials) contingency change blocks. The estimated <italic>wMB</italic> weights (<xref ref-type="supplementary-material" rid="pcbi.1005753.s003">S3 Fig</xref>) were not significantly different between fast vs. medium, or medium vs. slow frequency of contingency change blocks in permutation tests, <italic>p</italic> &gt; 0.05. Thus, the increase in <italic>wMB</italic> in our study seemed to be an effect of block order rather than environmental volatility from differences in contingency change rates. In summary, subjects became more model-based across the first two blocks but did not differ in MB influence between different rates of contingency changes; therefore, it seems that block order, but not contingency change volatility, affects <italic>wMB</italic> in our task.</p>
<p>As subjects became more model-based, high reward choices and consequently reward rate also increased. Choice probabilities for the high reward action differed over blocks, <italic>F</italic>(2,45) = 5.77, <italic>p</italic> &lt; 0.01, with post-hoc tests finding a significant increase between the first and third blocks (<italic>p</italic> &lt; 0.01) and the second and third blocks (<italic>p</italic> &lt; 0.05). Additionally, there was a significant difference in reward rate across blocks, <italic>F</italic>(2,45) = 3.83, <italic>p</italic> &lt; 0.05, specifically increasing between the first and third blocks (<italic>p</italic> &lt; 0.05). Mean reaction time and number of missed trials due to timeout did not significantly change across blocks, <italic>p</italic> &lt; 0.05; therefore, the increase in high reward choices over blocks was not necessarily because subjects were worse at the task to begin with. Two analyses were performed to rule out the possibility of practice effects driving the association between reward rate and model-based weight. Within each block, there was a significant correlation of each subject’s median <italic>wMB</italic> and reward rate (block 1: <italic>r</italic> = 0.66, <italic>p</italic> &lt; 0.01, block 2: <italic>r</italic> = 0.65, <italic>p</italic> &lt; 0.01, block 3: <italic>r</italic> = 0.56, <italic>p</italic> &lt; 0.05), indicating that on an individual subject basis, the extent of MB control was related to reward earned. Since these analyses were conducted within blocks, the association with reward rate could not be accounted for by block order.</p>
<p>Additionally, the hybrid model was simulated using a range of MB weights (0, 0.2, 0.4, 0.6, 0.8 and 1) using the one-weight hybrid model for simplicity. Other free parameters were set to values fitted to the participants’ data. There was a significant effect of MB weight on reward rate, (<italic>F</italic>(5,90) = 8.5, <italic>p</italic> &lt; 0.01). Therefore, MB influence in this task corresponds to a better “payoff” in terms of reward gained. However, lack of <italic>wMB</italic> adaptation to contingency-change rate suggests that using the cognitively-demanding MB system, at least in this task, is not motivated by its higher payoff. In other words, although being model-based does increase the payoff, it is not the <italic>reason</italic> for participants showing MB behavior. To further investigate this, we also computed the effect of <italic>wMB</italic> on reward rate, separately for different contingency change frequencies (fast/medium/slow) and found a significant effect of frequency on reward rate in a one-way ANOVA (<italic>F</italic>(2,45) = 5, <italic>p</italic> = 0.01). This shows that contingency change volatility did not affect <italic>wMB</italic>, despite having a significant effect on how much a MB strategy pays off. However, this absence of evidence should not be taken as evidence of absence, given the sample-size in this study. Alternatively, this absence of evidence could be because the effect of <italic>wMB</italic> on reward rate, though statistically significant, is in fact very small (<xref ref-type="supplementary-material" rid="pcbi.1005753.s004">S4 Fig</xref>). Therefore, this difference may not be apparent enough to discern or motivate a higher engagement of the MB system as contingency change frequency increases.</p>
</sec>
<sec id="sec003" sec-type="conclusions">
<title>Discussion</title>
<p>We developed a novel two-level contingency change task in which flexibility to frequently-changing transition contingencies between states could determine the extent to which subjects were using a model-based or a model-free strategy. Subjects showed a hybrid strategy when reacting to contingency changes, corroborating recent evidence of the parallel contribution of MB and MF systems in reward-guided decision-making. Importantly, this finding confirmed that changes to transition contingencies can elicit a balance of MB and MF behavior akin to changes to reward structure. Model-fitting analyses indicated that a hybrid model with three MB weights best explained subjects’ choices, with relative MB control increasing over blocks. The rate of contingency changes did not significantly shift the MB/MF balance; rather, MB control increased over the first two blocks of trials. This increase in MB control was concurrent with an increased proportion of high reward choices and consequently increased reward rate; individually, each subject’s <italic>wMB</italic> was also correlated with reward gained in the same block.</p>
<p>In all, these results illustrated that not only do subjects use a mixed MB/MF strategy, but within this hybrid strategy, the trade-off shifts towards “anti-habitization” across the first two blocks. This agrees with a previous study [<xref ref-type="bibr" rid="pcbi.1005753.ref020">20</xref>] that used the two-step task over three days, reporting that their subjects’ MB weight increased across days. One distinction between our findings is that in [<xref ref-type="bibr" rid="pcbi.1005753.ref020">20</xref>], subjects started relatively model-based (i.e. median <italic>wMB</italic> &gt; 0.5) whereas in our case, subjects began relatively model-free (i.e. median <italic>wMB</italic> &lt; 0.5). This difference in starting MB weight simply may be due to individual differences, which is evident even within our subject pool. Alternatively, differences could be accounted for by the relatively short reaction time limit in our task compared to theirs (750 ms in ours vs. 2000 ms). A shorter reaction time limit is known to provide a depth-of-planning pressure and favor more MF control [<xref ref-type="bibr" rid="pcbi.1005753.ref010">10</xref>]. Hence, our subjects may have started more model-free and only become more model-based once they mastered prospective planning of the task structure. This is supported by the lack of significant changes in reaction time across blocks, suggesting that subjects may have used the full extent of their time and eventually learned more efficient planning under time pressure, therefore showing increased MB influence over blocks.</p>
<p>These findings of an increase in MB control over blocks, however, goes against another study [<xref ref-type="bibr" rid="pcbi.1005753.ref026">26</xref>] using a similar task to the two-step task, that found an exponential decay in MB weight over the experimental session, or habit formation. This difference in findings is likely because they used a fixed rather than drifting amount of reward; in stationary environments such as these, habit formation can occur from overtraining, manifesting in an increase in MF rather than MB behavior [<xref ref-type="bibr" rid="pcbi.1005753.ref022">22</xref>]. Thus, these results point to the importance of maintaining a changing environment, as subjects can otherwise adapt to the change and become habitized.</p>
<p>Manipulations of the rate of contingency changes did not seem to affect MB/MF control. While it has been shown that environmental volatility can influence MB/MF levels in the context of common or rare updates of reward structure [<xref ref-type="bibr" rid="pcbi.1005753.ref022">22</xref>], in our case, the kind and range of contingency change volatility did not elicit a significant difference in relative MB/MF control. Further work is certainly needed to definitively rule out the possibility that environmental volatility in the form of the rates of contingency changes does not affect MB weight, but in the present study, we find that subjects did not change their use of MB control with contingency change volatility, but rather increased MB influence more generally with block order.</p>
<p>In conclusion, in a two-level contingency change task, subjects showed a hybrid MB/MF strategy, emphasizing their parallel contribution in reacting to changes in transition contingencies. The inclusion of multiple, frequent changes allowed us to perform model-fitting; by doing so, we found an increase in MB control over the first two blocks, a result not detectable in model-agnostic analyses alone. Our results build on the literature reporting the use of a hybrid MB/MF strategy in reacting to changes in information about reward structure, here demonstrating a mixture of strategies in reacting to multiple, frequent contingency changes that has yet been unexplored.</p>
<p>In addition to MB and MF systems, a third reinforcement learning algorithm known as the successor representation (SR) [<xref ref-type="bibr" rid="pcbi.1005753.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref027">27</xref>] caches transitions (i.e., the probability of occupying a state after performing an action in a previous state) in a model-free fashion, but learns reward values in a model-based fashion. The SR algorithm is therefore flexible to changes in rewards (like the MB system), but inflexible to changes in contingencies (like the MF system). As a result, the MB behavior seen in the original two-step task with non-stationary reward structure [<xref ref-type="bibr" rid="pcbi.1005753.ref008">8</xref>] could be equally explained with a SR model. In other words, <italic>wMB</italic> and <italic>wSR</italic> are conflated into <italic>wMB</italic>. Similarly, the MF behavior in our task with non-stationary transition structure could be interpreted under a SR framework, whereby <italic>wMF</italic> and <italic>wSR</italic> are conflated into <italic>wMF</italic>. In this sense, the two-step task and the task presented here complement each other in providing evidence that humans use both MB and MF strategies. This novel paradigm therefore provides another avenue for exploring the relationship between MB and MF control for future studies in neuropsychiatric disorders that may differentially implicate this balance between changes in transition contingencies and changes in reward values.</p>
</sec>
<sec id="sec004" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec005">
<title>Ethics statement</title>
<p>Sixteen subjects (nine males, mean age 24 years) took part. The study was approved by the University College London Research Ethics Committee (Project ID 3450/002). All subjects provided written informed consent.</p>
</sec>
<sec id="sec006" sec-type="materials|methods">
<title>Experimental procedure</title>
<p>Subjects performed 600 trials of three blocks (200 each) which differed in frequency of contingency changes: fast (contingency change every 3–6 trials), medium (every 7–10 trials) or slow (every 11–14 trials). Each subject was assigned to one of two groups (<italic>n</italic> = 8 each), which differed by the order of presentation of fast and medium contingency change blocks, i.e. half of the subjects had fast, medium, then slow contingency changes, and the other half started with medium, fast, then slow frequency of contingency changes.</p>
<p>To ensure subjects understood the task structure, they were first trained with practice trials (<italic>N</italic> = 35) which followed the same structure of the task but used practice stimuli. After this, a training session (55 trials) started which used the test stimuli but without reward. This phase was intended to introduce some familiarity to the transition relationships between states before participants were allowed to make reward-guided decisions. This was then followed by the test session using the same stimuli, but now rewarded, for 600 trials. Subjects were informed that contingency changes would occur, but did not know the frequency of changes nor that those rates would vary across the session.</p>
<p>At the first level, subjects had a two-alternative forced choice between two actions (pressing ‘S’ for the action available on the left side of the screen, ‘L’ for the right) with the presentation of stimuli randomized for the left/right side of the screen. To ensure that subjects recognized second-level states, they had to press ‘D’ if they encountered one of these states, and ‘K’ for the other. Both responses had a time limit of 750ms, following which the trial would end with no reward. Missed trials were not repeated.</p>
<p>Payoff at the high-reward terminal state varied according to a Gaussian random walk (<italic>N</italic>(<italic>μ</italic> = 0.5, <italic>σ</italic> = 0.2), with a drift rate of 0.15), bounded between £0 and £1. The payoff at the low-reward terminal state was £1 minus the reward of the high-reward terminal state. In practice, this resulted in an unambiguously large reward in one terminal state and an unambiguously small reward in the other terminal state. Therefore, the overall reward structure was stationary (until it flipped after every 40 trials, as noted). Subjects received a fixed proportion of their total reward gained, with payoff bounded between £5 and £25. To make the task adequately difficult and prevent formation of complex state-space representations [<xref ref-type="bibr" rid="pcbi.1005753.ref023">23</xref>], high- and low-reward assignments switched every 40 trials between the two terminal states. This change was designed never to co-occur with contingency changes.</p>
</sec>
<sec id="sec007">
<title>Model</title>
<p>Both model-free and model-based algorithms seek to estimate the values of state-action pairs in order to choose the actions which can maximize expected future rewards. The state space was modelled as having a first-level state <italic>s</italic><sub>0</sub> with two actions <italic>a</italic><sub>1</sub> and <italic>a</italic><sub>2</sub>, two possible second-level states <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>, and two possible terminal states <italic>s</italic><sub>3</sub> and <italic>s</italic><sub>4</sub>. There was only one action available on second-level and terminal states, as the subject did not have any choices at these levels.</p>
<p>The model-free algorithm updates values of state-action pairs using temporal difference Q-learning [<xref ref-type="bibr" rid="pcbi.1005753.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005753.ref028">28</xref>]. The reward <italic>r</italic><sub><italic>t</italic></sub> is used to compute a reward prediction error <italic>δ</italic><sub><italic>t</italic></sub> which updates action values for that state <italic>s</italic> and action <italic>a</italic> at time <italic>t</italic>, <italic>Q</italic><sub><italic>MF</italic></sub>(<italic>s</italic><sub><italic>t</italic></sub>,<italic>a</italic><sub><italic>t</italic></sub>). At the first level <italic>r</italic><sub><italic>t</italic></sub> is set to be 0 as there is no reward at this level.</p>
<disp-formula id="pcbi.1005753.e001">
<alternatives>
<graphic id="pcbi.1005753.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:msub><mml:mrow><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msub><mml:mo>[</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mi mathvariant="normal">′</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi mathvariant="normal">′</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005753.e002">
<alternatives>
<graphic id="pcbi.1005753.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mi>λ</mml:mi><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub>
</mml:math>
</alternatives>
</disp-formula>
<p>The reward prediction error updates existing action values according to a learning rate <italic>α</italic><sub><italic>MF</italic></sub>, and is modified by the eligibility trace λ, which governs how much credit past actions are given for outcomes. In a <italic>TD</italic>(<italic>λ</italic> = 0) algorithm, first-stage actions are updated only by the second-level action values, which in turn are updated by terminal state rewards. In contrast, in a <italic>TD</italic>(<italic>λ</italic> = 1) algorithm, first-level actions are directly updated using the reward from the terminal state reached on that trial.</p>
<p>The model-based algorithm learns both transition probabilities <italic>P</italic><sub><italic>T</italic></sub> and reward probabilities <italic>R</italic><sub><italic>T</italic></sub>. The transition probabilities track the transition contingencies <italic>P</italic><sub><italic>T</italic></sub> between states <italic>s</italic> and subsequent states <italic>s</italic>′. Upon encountering a contingency change, the model-based system always updated its knowledge of both transitions.</p>
<disp-formula id="pcbi.1005753.e003">
<alternatives>
<graphic id="pcbi.1005753.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.25em"/><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">otherwise</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005753.e004">
<alternatives>
<graphic id="pcbi.1005753.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">if</mml:mi><mml:mspace width="0.25em"/><mml:msup><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi mathvariant="normal">′</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi mathvariant="normal">otherwise</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005753.e005">
<alternatives>
<graphic id="pcbi.1005753.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1005753.e006">
<alternatives>
<graphic id="pcbi.1005753.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<p>The reward probabilities <italic>R</italic><sub><italic>T</italic></sub> use the reward <italic>r</italic><sub><italic>t</italic></sub> to update its subjective reward <italic>R</italic> for that state <italic>s</italic> and action <italic>a</italic> at time <italic>t</italic>.</p>
<disp-formula id="pcbi.1005753.e007">
<alternatives>
<graphic id="pcbi.1005753.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<p>These learned transition and reward functions are then used to update the action values for the model-based system, <italic>Q</italic><sub><italic>MB</italic></sub>.</p>
<disp-formula id="pcbi.1005753.e008">
<alternatives>
<graphic id="pcbi.1005753.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>∙</mml:mo><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>3</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mi>P</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mover accent="false"><mml:mo>→</mml:mo><mml:mrow><mml:mi>a</mml:mi></mml:mrow></mml:mover><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>∙</mml:mo><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
<p>Other parameters from the simulated models included learning rates for model-based and model-free systems, <italic>α</italic><sub><italic>MB</italic></sub> and <italic>α</italic><sub><italic>MF</italic></sub>, and a stay bias which temporarily increased the action value for the previously-selected action regardless of outcome, to quantify a perseveration bias. These additional parameters improved fit even when controlling for model complexity (<xref ref-type="supplementary-material" rid="pcbi.1005753.s007">S3 Table</xref>).</p>
<p>For both systems, values for the non-selected action were updated as well, assuming that subjects knew that the reward for the selected action and reward for the non-selected action were negatively related, according to proposals of fictive reward [<xref ref-type="bibr" rid="pcbi.1005753.ref029">29</xref>]. Action values were updated for both visited and non-visited states, with the action values of non-visited states corresponding to 1 − <italic>Q</italic>(<italic>s</italic><sub><italic>t</italic></sub>,<italic>a</italic><sub><italic>t</italic></sub>) of the visited states. The inclusion of fictive reward updates resulted in a better fit to the subjects’ choices (<xref ref-type="supplementary-material" rid="pcbi.1005753.s007">S3 Table</xref>).</p>
<p>The hybrid model weighted MB and MF action values according to a parameter <italic>wMB</italic>, with <italic>wMB</italic> = 1 indicating fully MB control:
<disp-formula id="pcbi.1005753.e009">
<alternatives>
<graphic id="pcbi.1005753.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>h</mml:mi><mml:mi>y</mml:mi><mml:mi>b</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>w</mml:mi><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mo>∙</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>w</mml:mi><mml:mi>M</mml:mi><mml:mi>B</mml:mi><mml:mo>)</mml:mo><mml:mo>∙</mml:mo><mml:msub><mml:mrow><mml:mi>Q</mml:mi></mml:mrow><mml:mrow><mml:mi>M</mml:mi><mml:mi>F</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Action selection was then determined for all models according to a “softmax” rule which computes action probabilities as proportional to the exponential of the action values.</p>
<disp-formula id="pcbi.1005753.e010">
<alternatives>
<graphic id="pcbi.1005753.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005753.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mspace width="0.25em"/><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>∙</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mspace width="0.25em"/><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>∙</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mspace width="0.25em"/><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>∙</mml:mo><mml:mi>Q</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mrow><mml:mi>a</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
</disp-formula>
<p>The inverse temperature <italic>β</italic> determined the extent to which action selection was stochastic or deterministic from action values, quantifying an exploration/exploitation trade-off.</p>
</sec>
<sec id="sec008">
<title>Simulations</title>
<p>To best replicate the subjects’ data of 600 trials for 16 subjects, each simulation was run for 16 initializations of 600 trials each. All reported simulations used fitted parameters from the three-block hybrid model for the learning rates <italic>α</italic><sub><italic>MF</italic></sub> and <italic>α</italic><sub><italic>MB</italic></sub>, inverse temperature <italic>β</italic>, eligibility trace <italic>λ</italic> and stay bias (<xref ref-type="supplementary-material" rid="pcbi.1005753.s005">S1 Table</xref>). <italic>wMB</italic> values were 1 for pure MB and 0 for pure MF models.</p>
</sec>
<sec id="sec009">
<title>Model-fitting</title>
<p>Subjects’ data were fit to the models using mixed effects hierarchical model fitting. Expectation-maximisation was used which iteratively generates group-level distributions over individual subject parameter estimates, choosing the parameters that maximizes the likelihood of the data given those estimates. In each iteration, parameters were estimated by minimizing the negative log-likelihood of parameter estimates using <italic>fminunc</italic> in Matlab (MathWorks).</p>
<p>The group-level distributions over all free parameters were assumed to be Gaussian, with no constraint. To then impose sensible constraints (0 ≤ <italic>wMB</italic> ≤ <italic>1;</italic> 0 ≤ <italic>α</italic> ≤ <italic>1; β</italic> ≥ 0), the original free parameters were passed through a logistic function (with slope parameter equal to one) for computing <italic>wMB</italic> and <italic>α</italic>, and through an exponential function for computing <italic>β</italic>. Consequently, although the original parameters were Gaussian, the resulting parameters of the models (<italic>wMB</italic>, <italic>α</italic>, <italic>β</italic>) were not necessarily Gaussian (hence the skewed distributions in <xref ref-type="fig" rid="pcbi.1005753.g003">Fig 3</xref>). This method is preferred to imposing hard constraints on parameters because it avoids parameters hitting boundary conditions and also remains loyal to the Gaussian assumption required for hierarchical Bayesian modelling.</p>
<p>To ensure the efficacy of <italic>wMB</italic> parameter estimation for the candidate model, each block <italic>wMB</italic> was simulated for 11 different parameter values: 0, 0.1, 0.2, … 1. These resulted in a total of 33 parameter settings for <italic>wMB<sub>block 1</sub></italic>, <italic>wMB<sub>block 2</sub></italic>, <italic>wMB<sub>block 3</sub></italic>, with 16 iterations per setting. All other parameters in the simulations were set constant as the median parameter estimates taken from the hybrid three-block model from model-fitting on the subjects’ data. The same model-fitting procedure was performed on the simulated data and estimated parameter values were extracted.</p>
<p>The integrated Bayesian information criterion (iBIC) [<xref ref-type="bibr" rid="pcbi.1005753.ref024">24</xref>] was used to compare the fits of candidate models to the data, with lower scores indicating better fit; this criterion penalizes more complex models. Finally, Bayesian model selection [<xref ref-type="bibr" rid="pcbi.1005753.ref025">25</xref>] was used to examine the prevalence of each model in the participant population. This quantifies an exceedance probability, the probability that each model is the most common in the subject pool.</p>
</sec>
<sec id="sec010">
<title>Permutation tests</title>
<p>Permutation tests were run to evaluate the probability that <italic>wMB</italic> could differ across blocks by chance. Subjects’ blocks were randomly permuted such that each “block” contained a mixture of true first, second and third blocks. Model-fitting was run on each permutation to extract parameter estimates of <italic>wMB</italic> for each new “block”. The probabilities <italic>p</italic>(<italic>wMB</italic><sub><italic>block 2</italic></sub> <italic>&gt; wMB</italic><sub><italic>block 1</italic></sub>), and <italic>p</italic>(<italic>wMB</italic><sub><italic>block 3</italic></sub> <italic>&gt; wMB</italic><sub><italic>block 2</italic></sub>) were then evaluated for each permutation. The occurrences of the random permutations which had a smaller <italic>p</italic>(<italic>wMB</italic><sub><italic>block 2</italic></sub> <italic>&gt; wMB</italic><sub><italic>block 1</italic></sub>), and <italic>p</italic>(<italic>wMB</italic><sub><italic>block 3</italic></sub> <italic>&gt; wMB</italic><sub><italic>block 2</italic></sub>) than the true permutation were then tallied.</p>
<p>Likewise, to evaluate the effect of frequency of contingency changes, permutation tests were run to compare <italic>wMB</italic> for fast, medium and slow contingency change blocks. Each subject was randomly assigned to one of the two groups (which differed in the order of fast and medium contingency change blocks) then <italic>wMB</italic> of each frequency block was computed for each permutation. Both the aforementioned one-tailed permutation test and a two-tailed Hellinger distance permutation test were used.</p>
</sec>
<sec id="sec011">
<title>Further analyses</title>
<p>To rule out the possibility that the effective learning rate of the MB and MF systems – rather than their fundamental differences – produced the behavior, we conducted several further analyses. A hybrid model composed of two MF systems with small (0.25) and large (0.75) learning rates could not replicate the stay probability patterns observed from subjects and the MB+MF hybrid system. Even more extreme, a hybrid model composed of two MF systems, one with a small (0.25) learning rate and no eligibility trace (λ = 0), and another with a large (0.75) learning rate and with eligibility trace (λ = 1) could not replicate those patterns. Furthermore, a hybrid model composed of two MB systems with small (0.25) and large (0.75) learning rates could not replicate the patterns either.</p>
<p>When fitted to the behavioral data, all three hybrids of MF(<italic>α</italic> = 0.25)+MF(<italic>α</italic> = 0.75), MF(<italic>α</italic> = 0.25, λ = 0)+MF(<italic>α</italic> = 0.75, λ = 1), and MB(<italic>α</italic> = 0.25)+MB(<italic>α</italic> = 0.75) performed significantly worse than the real hybrid MF+MB model, according to our measures of model comparison.</p>
<p>Together, these results rule out the possibility of just different effective learning rates of the two systems having produced the observed behavior.</p>
<p>We further fitted a hybrid MF+MB with a free learning rate parameter, <italic>αMB</italic><sub><italic>Transition</italic></sub> for updating transitions by the MB system (rather than assuming the parameter was 1). This model, in terms of model comparison, fit the data better than pure MB and MF models, and even slightly better than the hybrid MB(<italic>αMB</italic><sub><italic>Transition</italic></sub> = 1)+MF model. In all previous analyses, the non-diagonal elements of the covariance matrix were set to zero (i.e., assuming no correlation between free parameters). However, for the hybrid MB+MF with a free <italic>αMB</italic><sub><italic>Transition</italic></sub>, we observed strong correlations between parameters when the covariates were allowed to change freely. The <italic>αMB</italic><sub><italic>Transition</italic></sub> parameter was highly negatively correlated with <italic>α</italic>MF, and positively correlated with stay-bias, <italic>wMB<sub>block 1</sub></italic>, and <italic>wMB<sub>block 2</sub></italic>. We therefore decided not to rely on this model and instead, for the sake of parsimony, to use the original hybrid MB(<italic>αMB</italic><sub><italic>Transition</italic></sub> = 1)+MF model throughout the paper.</p>
</sec>
</sec>
<sec id="sec012">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005753.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title/>
<p><bold>Stay probability patterns after first-level contingency changes predicted by simulating model-based (A), model-free (B), and hybrid (C) reinforcement learning algorithms, along with experimental results (D).</bold> Stay-probability measures the probability of choosing the first-level action that results in the same second-level state as the previous trial, following a trial that started at the first level. For each system, this index was measured under four different conditions: when the reward received in the previous trial was “high” or “low”, and when the transition experienced in the previous trial (relative to the trial before that) “changed” or remained “fixed”. * <italic>p</italic> &lt; 0.05, ** <italic>p</italic> &lt; 0.01.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005753.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title/>
<p><bold>Stay probability patterns after first-level contingency changes predicted by simulating model-free (A) and model-based (B) algorithms for 1000 agents.</bold> When starting from the first level and encountering a change in the transition structure, both MB and MF systems are able to update their action values. However, the extent of this update is not equal for the two systems due to their different effective learning rates. As a result, the two systems show slightly different flexibility levels (i.e., stay-probability patterns) even when both systems were informed of the change in contingencies. Therefore, in addition to structural differences, the MB and MF algorithms that participants used in this task also have different effective learning rates. This difference is not apparent in <xref ref-type="supplementary-material" rid="pcbi.1005753.s001">S1 Fig</xref> because the models were only simulated 16 times (equal to the number of participants).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005753.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title/>
<p><bold>Model-based weights for (A) fast, (B) medium and (C) slow contingency changes.</bold> Probability density function over the model-based weight parameters estimated from model-fitting, for the blocks of fast (every 3–6 trials), medium (every 7–10 trials) and slow (every 11–14 trials) frequency of contingency changes. Overlaid are the individual subjects’ parameter estimates for each block type. Error bars represent standard deviation.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005753.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Reward rates of simulated model-based weights.</title>
<p>Choices were simulated with six different model-based weights (0, 0.2, 0.4, 0.6, 0.8, 1, with n = 16 iterations each) and the mean reward rate was computed. There was a significant difference in reward rate across different wMB values, <italic>F</italic>(5,90) = 8.5, <italic>p</italic> &lt; 0.01, however, the difference was small, which may account for the absence of a significant modulation in wMB across contingency change frequencies.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005753.s005" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.s005" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Median plus quartile group-level parameter estimates.</title>
<p>Best-fitting parameter estimates over the subjects from model-fitting.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005753.s006" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.s006" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Model comparison of candidate models.</title>
<p>Integrated Bayesian Information Criterion (iBIC) and negative log-likelihood of all candidate models from model-fitting. The models tested were: pure model-free (“MF”), pure model-based (“MB”), hybrid MB/MF (“hybrid”), hybrid MB/MF with different weights fitted for each of the three 200-trial blocks (“three-block hybrid”), and a hybrid model with different weights fitted for each frequency of contingency changes (“three-frequency hybrid”). The winning model was the three-block hybrid, highlighted in gray, according to iBIC [<xref ref-type="bibr" rid="pcbi.1005753.ref024">24</xref>] and Bayesian model selection [<xref ref-type="bibr" rid="pcbi.1005753.ref025">25</xref>].</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005753.s007" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005753.s007" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Model comparison of additional parameters.</title>
<p>Integrated Bayesian Information Criterion (iBIC) and negative log-likelihood of the winning three-block hybrid model with different weights fitted for each of the three 200-trial blocks and the same model without stay bias, with <italic>λ</italic> = 1, with <italic>λ</italic> = 0, with only one learning rate for both MF and MB systems, and without updating fictive reward. The full model fit better to the data than the same model without each of the aforementioned parameters, even when controlling for model complexity in the iBIC.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Thanks to Peter Dayan for helpful discussions and comments, and Thomas Akam for comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005753.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adams</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>A</given-names></name>. <article-title>Instrumental responding following reinforcer devaluation</article-title>. <source>The Quarterly journal of experimental psychology</source>. <year>1981</year>;<volume>33</volume>(<issue>2</issue>):<fpage>109</fpage>–<lpage>21</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dickinson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>B</given-names></name>. <article-title>Motivational control of goal-directed action</article-title>. <source>Animal Learning &amp; Behavior</source>. <year>1994</year>;<volume>22</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref003"><label>3</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Sutton</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name>. <chapter-title>Reinforcement learning: An introduction</chapter-title>: <publisher-name>MIT press Cambridge</publisher-name>; <year>1998</year>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Uncertainty-based competition between prefrontal and dorsolateral striatal systems for behavioral control</article-title>. <source>Nature Neuroscience</source>. <year>2005</year>;<volume>8</volume>:<fpage>1704</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1560" xlink:type="simple">10.1038/nn1560</ext-link></comment> <object-id pub-id-type="pmid">16286932</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schultz</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Montague</surname> <given-names>PR</given-names></name>. <article-title>A neural substrate of prediction and reward</article-title>. <source>Science</source>. <year>1997</year>;<volume>275</volume>(<issue>5306</issue>):<fpage>1593</fpage>–<lpage>9</lpage>. <object-id pub-id-type="pmid">9054347</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Model-based influences on humans' choices and striatal prediction errors</article-title>. <source>Neuron</source>, <year>2011</year>;<volume>69</volume>(<issue>6</issue>): <fpage>1204</fpage>–<lpage>1215</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2011.02.027" xlink:type="simple">10.1016/j.neuron.2011.02.027</ext-link></comment> <object-id pub-id-type="pmid">21435563</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Doll</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Duncan</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Simon</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Shohamy</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>Model-based choices involve prospective neural activity</article-title>. <source>Nature neuroscience</source>. <year>2015</year>;<volume>18</volume>(<issue>5</issue>):<fpage>767</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3981" xlink:type="simple">10.1038/nn.3981</ext-link></comment> <object-id pub-id-type="pmid">25799041</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Model-Based Influences on Humans' Choices and Striatal Prediction Errors</article-title>. <source>Neuron</source>. <year>2011</year>;<volume>69</volume>:<fpage>1204</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2011.02.027" xlink:type="simple">10.1016/j.neuron.2011.02.027</ext-link></comment> <object-id pub-id-type="pmid">21435563</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keramati</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dezfouli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Piray</surname> <given-names>P</given-names></name>. <article-title>Speed/accuracy trade-off between the habitual and the goal-directed processes</article-title>. <source>PLoS computational biology</source>. <year>2011</year>;<volume>7</volume>:<fpage>e1002055</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002055" xlink:type="simple">10.1371/journal.pcbi.1002055</ext-link>.</comment> <object-id pub-id-type="pmid">21637741</object-id>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keramati</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Smittenaar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Adaptive integration of habits into depth-limited planning defines a habitual-goal-directed spectrum</article-title>. <source>PNAS</source>. <year>2016</year>:<fpage>1</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1609094113" xlink:type="simple">10.1073/pnas.1609094113</ext-link>.</comment> <object-id pub-id-type="pmid">27791110</object-id>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Otto</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Skatova</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Madlon-Kay</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>Cognitive control predicts use of model-based reinforcement learning</article-title>. <source>Journal of cognitive neuroscience</source>. <year>2014</year>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wunderlich</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Smittenaar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Dopamine Enhances Model-Based over Model-Free Choice Behavior</article-title>. <source>Neuron</source>. <year>2012</year>;<volume>75</volume>:<fpage>418</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2012.03.042" xlink:type="simple">10.1016/j.neuron.2012.03.042</ext-link>.</comment> <object-id pub-id-type="pmid">22884326</object-id>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Shimojo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>. <article-title>Neural computations underlying arbitration between model-based and model-free learning</article-title>. <source>Neuron</source>. <year>2014</year>; <volume>81</volume>(<issue>3</issue>): <fpage>687</fpage>–<lpage>99</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.11.028" xlink:type="simple">10.1016/j.neuron.2013.11.028</ext-link></comment> <object-id pub-id-type="pmid">24507199</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>O'Doherty</surname> <given-names>JP</given-names></name>. <article-title>Human and Rodent Homologies in Action Control: Corticostriatal Determinants of Goal-Directed and Habitual Action</article-title>. <source>Neuropsychopharmacology</source>. <year>2010</year>;<volume>35</volume>:<fpage>48</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/npp.2009.131" xlink:type="simple">10.1038/npp.2009.131</ext-link></comment> <object-id pub-id-type="pmid">19776734</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Momennejad</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Russek</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Cheong</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>. <article-title>The successor representation in human reinforcement learning</article-title>. <source>Nature Human Behaviour</source>. <year>2017</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41562-017-0180-8" xlink:type="simple">10.1038/s41562-017-0180-8</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005753.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Markman</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Otto</surname> <given-names>AR</given-names></name>. <article-title>Retrospective revaluation in sequential decision making: A tale of two systems</article-title>. <source>Journal of Experimental Psychology: General</source>. <year>2014</year>;<volume>143</volume>(<issue>1</issue>):<fpage>182</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adams</surname> <given-names>CD</given-names></name>. <article-title>Variations in the sensitivity of instrumental responding to reinforcer devaluation</article-title>. <source>The Quarterly Journal of Experimental Psychology</source>. <year>1982</year>;<volume>34</volume>(<issue>2</issue>):<fpage>77</fpage>–<lpage>98</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dickinson</surname> <given-names>A</given-names></name>. <article-title>Omission learning after instrumental pretraining</article-title>. <source>The Quarterly Journal of Experimental Psychology: Section B</source>. <year>1998</year>;<volume>51</volume>(<issue>3</issue>):<fpage>271</fpage>–<lpage>86</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Otto</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Markman</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>The curse of planning: dissecting multiple reinforcement-learning systems by taxing the central executive</article-title>. <source>Psychological science</source>. <year>2013</year>;<volume>24</volume>(<issue>5</issue>):<fpage>751</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1177/0956797612463080" xlink:type="simple">10.1177/0956797612463080</ext-link></comment> <object-id pub-id-type="pmid">23558545</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Economides</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kurth-Nelson</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Lübbert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Guitart-Masip</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Model-Based Reasoning in Humans Becomes Automatic with Training</article-title>. <source>PLoS computational biology</source>. <year>2015</year>:<fpage>1</fpage>–<lpage>19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004463" xlink:type="simple">10.1371/journal.pcbi.1004463</ext-link></comment> <object-id pub-id-type="pmid">26379239</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Colwill</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Rescorla</surname> <given-names>RA</given-names></name>. <article-title>Instrumental responding remains sensitive to reinforcer devaluation after extensive training</article-title>. <source>Journal of Experimental Psychology: Animal Behavior Processes</source>. <year>1985</year>;<volume>11</volume>(<issue>4</issue>):<fpage>520</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simon</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>Environmental statistics and the trade-off between model-based and TD learning in humans</article-title>. <source>Advances in Neural Information Processing Systems (NIPS)</source>. <year>2011</year>:<fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Akam</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Simple Plans or Sophisticated Habits? State, Transition and Learning Interactions in the Two-step Task</article-title>. <source>PLoS computational biology</source>. <year>2015</year>:<fpage>021428</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/021428" xlink:type="simple">10.1101/021428</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005753.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huys</surname> <given-names>QJ</given-names></name>, <name name-style="western"><surname>Eshel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>O'Nions</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Roiser</surname> <given-names>JP</given-names></name>. <article-title>Bonsai trees in your head: how the Pavlovian system sculpts goal-directed choices by pruning decision trees</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>):<fpage>e1002410</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002410" xlink:type="simple">10.1371/journal.pcbi.1002410</ext-link></comment> <object-id pub-id-type="pmid">22412360</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moran</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <article-title>Bayesian model selection for group studies</article-title>. <source>NeuroImage</source>. <year>2009</year>;<volume>46</volume>:<fpage>1004</fpage>–<lpage>17</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuroimage.2009.03.025" xlink:type="simple">10.1016/j.neuroimage.2009.03.025</ext-link></comment> <object-id pub-id-type="pmid">19306932</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gläscher</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>Nathaniel D</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>O'Doherty</surname> <given-names>JP</given-names></name>. <article-title>States versus Rewards: Dissociable Neural Prediction Error Signals Underlying Model-Based and Model-Free Reinforcement Learning</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>66</volume>:<fpage>585</fpage>–<lpage>95</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.04.016" xlink:type="simple">10.1016/j.neuron.2010.04.016</ext-link></comment> <object-id pub-id-type="pmid">20510862</object-id></mixed-citation></ref>
<ref id="pcbi.1005753.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Improving generalization for temporal difference learning: The successor representation</article-title>. <source>Neural Computation</source>. <year>1993</year>;<volume>5</volume>(<issue>4</issue>):<fpage>613</fpage>–<lpage>24</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Watkins</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Q-learning</article-title>. <source>Machine learning</source>. <year>1992</year>;<volume>8</volume>(<issue>3–4</issue>):<fpage>279</fpage>–<lpage>92</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005753.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lohrenz</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>McCabe</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Camerer</surname> <given-names>CF</given-names></name>, <name name-style="western"><surname>Montague</surname> <given-names>PR</given-names></name>. <article-title>Neural signature of fictive learning signals in a sequential investment task</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2007</year>;<volume>104</volume>(<issue>22</issue>):<fpage>9493</fpage>–<lpage>8</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>