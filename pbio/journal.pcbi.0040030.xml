<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="allenpress-id">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0040030</article-id><article-id pub-id-type="publisher-id">07-PLCB-RA-0464R2</article-id><article-id pub-id-type="sici">plcb-04-02-10</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biochemistry</subject><subject>Cell Biology</subject><subject>Computational Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Mammals</subject></subj-group></article-categories><title-group><article-title>Stimulus Design for Model Selection and Validation in Cell Signaling</article-title><alt-title alt-title-type="running-head">Model Stimulus Design</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Apgar</surname><given-names>Joshua F</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref><xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Toettcher</surname><given-names>Jared E</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref><xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Endy</surname><given-names>Drew</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>White</surname><given-names>Forest M</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref><xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Tidor</surname><given-names>Bruce</given-names></name><xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref><xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref><xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref><xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref></contrib></contrib-group><aff id="aff1">
        <label>1</label>
        <addr-line>
				 Department of Biological Engineering, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America
			</addr-line>
      </aff><aff id="aff2">
        <label>2</label>
        <addr-line>
				 Computer Science and Artificial Intelligence Laboratory, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America
			</addr-line>
      </aff><aff id="aff3">
        <label>3</label>
        <addr-line>
				 Center for Cancer Research, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America
			</addr-line>
      </aff><aff id="aff4">
        <label>4</label>
        <addr-line>
				 Department of Electrical Engineering and Computer Science, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America
			</addr-line>
      </aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Arkin</surname><given-names>Adam P</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">Lawrence Berkeley National Laboratory, United States of America</aff><author-notes><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">tidor@mit.edu</email></corresp><fn fn-type="con" id="ack1"><p> JFA conceived and designed the experiments, performed the experiments, analyzed the data, contributed reagents/materials/analysis tools, and wrote the paper. JET contributed reagents/materials/analysis tools and wrote the paper. DE and FMW conceived and designed the experiments and wrote the paper. BT conceived and designed the experiments, analyzed the data, and wrote the paper.</p></fn><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>2</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>15</day><month>2</month><year>2008</year></pub-date><volume>4</volume><issue>2</issue><elocation-id>e30</elocation-id><history><date date-type="received"><day>2</day><month>8</month><year>2007</year></date><date date-type="accepted"><day>7</day><month>1</month><year>2008</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder> Apgar et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>Mechanism-based chemical kinetic models are increasingly being used to describe biological signaling. Such models serve to encapsulate current understanding of pathways and to enable insight into complex biological processes. One challenge in model development is that, with limited experimental data, multiple models can be consistent with known mechanisms and existing data. Here, we address the problem of model ambiguity by providing a method for designing dynamic stimuli that, in stimulus–response experiments, distinguish among parameterized models with different topologies, i.e., reaction mechanisms, in which only some of the species can be measured. We develop the approach by presenting two formulations of a model-based controller that is used to design the dynamic stimulus. In both formulations, an input signal is designed for each candidate model and parameterization so as to drive the model outputs through a target trajectory. The quality of a model is then assessed by the ability of the corresponding controller, informed by that model, to drive the experimental system. We evaluated our method on models of antibody–ligand binding, mitogen-activated protein kinase (MAPK) phosphorylation and de-phosphorylation, and larger models of the epidermal growth factor receptor (EGFR) pathway. For each of these systems, the controller informed by the correct model is the most successful at designing a stimulus to produce the desired behavior. Using these stimuli we were able to distinguish between models with subtle mechanistic differences or where input and outputs were multiple reactions removed from the model differences. An advantage of this method of model discrimination is that it does not require novel reagents, or altered measurement techniques; the only change to the experiment is the time course of stimulation. Taken together, these results provide a strong basis for using designed input stimuli as a tool for the development of cell signaling models.</p></abstract><abstract abstract-type="summary"><title>Author Summary</title><sec id="st1"><title/><p>A major focus of systems biology is the development of mechanism-based models of cell signaling pathways. These models hold the promise of encapsulating our understanding of complex biological processes while also predicting new behavior. However, as these models become more complex, it can be difficult to distinguish between model alternatives. One means of improved model discrimination involves making measurements of additional components in the biological system to provide more detailed data. Here we present an alternative, which is to apply a time-varying input while monitoring the same network components. This new method was able to discriminate among models with subtle mechanistic differences. A particular advantage is that for many cases, time-varying input stimulation is fairly easy to apply experimentally, whereas measuring additional network components can involve the creation of new reagents or measurement assays. Thus, we believe that the application of time-varying input stimulation will become a powerful tool in the field of systems biology as the community places increased emphasis on the development of quantitative, mechanistic, and predictive models of biological network behavior.</p></sec></abstract><funding-group><funding-statement> This work was partially supported by the National Institutes of Health (P50 GM58762 and U54 CA112967).</funding-statement></funding-group><counts><page-count count="10"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Apgar JF, Toettcher JE, Endy D, White FM, Tidor B (2008) Stimulus design for model selection and validation in cell signaling. PLoS Comput Biol 4(2): e30. doi:<ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0040030" xlink:type="simple">10.1371/journal.pcbi.0040030</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>One goal of systems biology is to develop detailed models of complex biological systems that quantitatively capture known mechanisms and behaviors, and also make useful predictions. Such models serve as a basis for understanding, for the design of experiments, and for the development of clinical intervention. In support of this goal, there has been a strong push to build mechanistically correct kinetic models, often based on systems of ordinary differential equations (ODEs), that are capable of recapitulating the dynamic behavior of a signaling network. These models hold the promise of connecting biological and medical research to a class of computational analysis and design tools that could revolutionize how we understand biological processes and develop clinical therapies [<xref ref-type="bibr" rid="pcbi-0040030-b001">1</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b002">2</xref>].</p><p>One type of experiment for model validation involves stimulating a system with a step change in the input (typically by adding a high concentration of ligand) and then measuring the change of network readouts (the concentrations or activities of various downstream species) as a function of time. Candidate models are fit to the data and the best model is selected based on criteria such as the quality of the fit, the simplicity of the model, and other factors. While it is tempting to select a simple model consistent with the known biochemical mechanisms that fits all available data, future experimentation may prove this choice incorrect. Rather, it may be preferable to collect “all” models consistent with known mechanisms and data, and to design follow-on experiments capable of distinguishing among the model candidates. In support of this less-biased approach, here we develop an approach for designing these follow-on experiments using dynamic stimuli.</p><p>While the step-response experiment is attractive for its ease of implementation, dynamic stimuli have the potential to uncover more subtle system dynamics and to improve model selection in the cases where step-response experiments are not sufficiently discriminating. One example that illustrates the use of a dynamic stimulus to distinguish between two models is the work by Smith-Gill and co-workers on the detailed mechanism of antibody–antigen binding [<xref ref-type="bibr" rid="pcbi-0040030-b003">3</xref>]. Initial step-response experiments were compatible with either a one-step or two-step binding mechanism, in which the ligand and antibody first come together in a loose encounter complex before forming a fully bound complex. To resolve this ambiguity, the authors applied a series of rectangular pulses of ligand concentration to their system. The resulting binding curves produced by this dynamic stimulus were inconsistent with the one-step model but were consistent with a two-step model and suggested the existence of an encounter complex, even though such a complex could not be measured directly by the assay.</p><p>These results show that time varying inputs have the potential to distinguish closely related models of biochemical systems. For the relatively simple antibody–antigen system, an appropriate dynamic input was deduced intuitively. However this sort of intuitive design is difficult, especially in the case of more complex cell signaling pathway models, which may be described by hundreds or thousands of differential equations. An automated approach that could design experiments to test these complex systems has the potential to expand the scope of model selection experiments.</p><p>Previous work in designing dynamic stimuli for the purpose of model discrimination in systems biology has focused on choosing input trajectories that maximize the expected difference in the output trajectories of competing models [<xref ref-type="bibr" rid="pcbi-0040030-b004">4</xref>–<xref ref-type="bibr" rid="pcbi-0040030-b010">10</xref>]. In addition to model discrimination, a rich literature exists on experimental design in systems biology for the purpose of estimating model parameters [<xref ref-type="bibr" rid="pcbi-0040030-b002">2</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b011">11</xref>–<xref ref-type="bibr" rid="pcbi-0040030-b013">13</xref>]. These optimization approaches for model discrimination have been applied to small biological systems, but the nonlinearity of the models combined with the presence of many local minima has thus far limited their application [<xref ref-type="bibr" rid="pcbi-0040030-b008">8</xref>].</p><p>There is a need to extend these methods to design experiments that may not be optimal but are capable of discriminating between large pathway models. Instead of trying to design an input signal that maximizes the predicted difference between two model readouts, we recast the problem as a control problem (<xref ref-type="fig" rid="pcbi-0040030-g001">Figure 1</xref>). We choose a target trajectory, and then challenge a model-based controller to drive the system to follow the target trajectory. The extent to which the controller based upon a given model is able to drive the physical system is a measure of the fitness of that model.</p><fig id="pcbi-0040030-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040030.g001</object-id><label>Figure 1</label><caption><title>Schematic of Experimental Design</title><p>(A) A feedback controller is used to solve for the stimulus <italic>u</italic>(<italic>t</italic>) that will drive the model system outputs <italic>y</italic><sub>simulation</sub>(<italic>t</italic>) to follow the design trajectory <italic>y</italic><sub>design</sub>(<italic>t</italic>). The inputs to the feedback controller are the deviation from the desired trajectory <italic>e</italic><sub>design</sub>(<italic>t</italic>) as well as the model state <italic>x</italic>(<italic>t</italic>).</p><p>(B) The designed stimulus can be applied to an unknown experimental system to assess the quality of the model. A stimulus based on a good model should be able to drive the experimental system output <italic>y</italic>(<italic>t</italic>) through the design trajectory.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.g001" xlink:type="simple"/></fig><p>We demonstrate our methodology by applying it to the epidermal growth factor receptor (EGFR) pathway. This pathway has been extensively studied and modeled [<xref ref-type="bibr" rid="pcbi-0040030-b014">14</xref>–<xref ref-type="bibr" rid="pcbi-0040030-b018">18</xref>]. EGFR and its family members (Erb2, Erb3, and Erb4) are known to mediate cell–cell interactions in organogenesis and adult tissues [<xref ref-type="bibr" rid="pcbi-0040030-b019">19</xref>]. Overexpression of EGFR family members is a marker of certain types of cancer, including head, neck, breast, bladder, and kidney [<xref ref-type="bibr" rid="pcbi-0040030-b020">20</xref>]. Because of their clinical importance, the EGFRs themselves, as well as various downstream proteins, are targets of therapeutic intervention [<xref ref-type="bibr" rid="pcbi-0040030-b021">21</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b022">22</xref>]. Despite clinical interest in the EGFR pathway and over 40 y of intense study, there is still much about the pathway that is not known. For example, in three recent studies [<xref ref-type="bibr" rid="pcbi-0040030-b023">23</xref>–<xref ref-type="bibr" rid="pcbi-0040030-b025">25</xref>], a number of proteins that changed phosphorylation state in response to EGF stimulation were found that were not previously known to be part of the pathway; in addition, many of the known pathway proteins are not part of any computational model [<xref ref-type="bibr" rid="pcbi-0040030-b026">26</xref>].</p><p>The ordinary differential equation model of Hornberg et al. is a widely used mechanistic model of EGFR signaling [<xref ref-type="bibr" rid="pcbi-0040030-b016">16</xref>]. This model is a refinement of earlier models of the pathway [<xref ref-type="bibr" rid="pcbi-0040030-b017">17</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b018">18</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b027">27</xref>]. It describes signal transduction initiated at the cell surface by EGF binding to EGFR, leading eventually to the dual phosphorylation of ERK as the most downstream outcome, which then participates in a negative feedback to the top of the pathway. The elementary molecular processes modeled include bimolecular association and dissociation, phosphorylation and de-phosphorylation, synthesis and degradation, as well as endocytosis and trafficking all described with mass-action kinetics. The model contains 103 chemical species, 148 reactions, 97 independent reaction rates, and 103 initial conditions.</p><p>We applied our computational methods initially to a small portion of the EGFR model for development and demonstration purposes, and then to the full model. In both cases, we formulated a set of closely related models that exhibit similar step-response behavior. We built a controller capable of controlling each candidate model and asked the controller to drive the system output (doubly phosphorylated ERK) to a predetermined value. Finally, by applying these designed inputs based on the reference and perturbed models, we showed that it is possible to discriminate between the various model alternatives.</p></sec><sec id="s2" sec-type="methods"><title>Methods</title><sec id="s2a"><title>Model Formulation</title><p>In this work, we consider mass-action kinetic models consisting of zeroth-, first-, and second-order reactions described by ordinary differential equations. In the equations below, <italic>k</italic> signifies a rate constant; <italic>A</italic>, <italic>B</italic>, and <italic>C</italic> represent species or concentrations of species, depending on the context; and ∅︀ is the empty set or nothing.</p><p>Zeroth-order reaction:
					<disp-formula id="pcbi-0040030-e001"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mo>&empty;</mml:mo><mml:mover><mml:mo>&rarr;</mml:mo><mml:mi>k</mml:mi></mml:mover><mml:mi>A</mml:mi><mml:mtext>&emsp;</mml:mtext><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:math> --></disp-formula>
				</p><p>First-order reaction:
					<disp-formula id="pcbi-0040030-e002"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>A</mml:mi><mml:mover><mml:mo>&rarr;</mml:mo><mml:mi>k</mml:mi></mml:mover><mml:mi>B</mml:mi><mml:mtext>&emsp;</mml:mtext><mml:mo>&minus;</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mi>k</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:math> --></disp-formula>
				</p><p>Second-order reaction:
					<disp-formula id="pcbi-0040030-e003"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>A</mml:mi><mml:mo>&plus;</mml:mo><mml:mi>B</mml:mi><mml:mover><mml:mo>&rarr;</mml:mo><mml:mi>k</mml:mi></mml:mover><mml:mi>C</mml:mi><mml:mtext>&emsp;</mml:mtext><mml:mo>&minus;</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mo>&minus;</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>B</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>C</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mi>k</mml:mi><mml:mi>A</mml:mi><mml:mi>B</mml:mi></mml:mrow></mml:math> --></disp-formula>
				</p><p>Large systems of reactions of this form can be represented compactly using <xref ref-type="disp-formula" rid="pcbi-0040030-e004">Equation 4</xref>.
					<disp-formula id="pcbi-0040030-e004"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>x</mml:mi><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>&otimes;</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>u</mml:mi><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>&otimes;</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:mi>k</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign='left'><mml:mi>y</mml:mi><mml:mo>&equals;</mml:mo><mml:mi>C</mml:mi><mml:mi>x</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>The state vector <italic>x</italic> describes the chemical species concentrations that are free to evolve in time according to the kinetics of the system. The input vector <italic>u</italic> represents the chemical species concentrations controlled by the experimenter. Matrices <italic>A</italic><sub>1</sub> and <italic>B</italic><sub>1</sub> represent first-order reactions, matrices <italic>A</italic><sub>2</sub> and <italic>B</italic><sub>2</sub> represent second-order reactions, and <italic>k</italic> represents constitutive (zeroth-order) reactions. The symbol ⊗ denotes the Kronecker product (also known as the matrix direct product) [<xref ref-type="bibr" rid="pcbi-0040030-b028">28</xref>]. For vectors, this operator generates a vector of all quadratic products.
					<disp-formula id="pcbi-0040030-e005"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>x</mml:mi><mml:mo>&otimes;</mml:mo><mml:mi>u</mml:mi><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy='true'>&lsqb;</mml:mo><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&vellip;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy='true'>&rsqb;</mml:mo></mml:mrow><mml:mo>&otimes;</mml:mo><mml:mrow><mml:mo stretchy='true'>&lsqb;</mml:mo><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&vellip;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy='true'>&rsqb;</mml:mo></mml:mrow><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy='true'>&lsqb;</mml:mo><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&vellip;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&vellip;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>x</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msub><mml:mi>u</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mtd></mml:mtr></mml:mtable><mml:mo stretchy='true'>&rsqb;</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>
				</p><p>The output of the model <italic>y</italic> is a linear combination of the state variables represented by the matrix <italic>C</italic>.</p></sec><sec id="s2b"><title>Control Formulation</title><p>A controller was developed to solve for the input signal <italic>u</italic>(<italic>t</italic>) that best achieves a particular objective in the output. We formulate this objective as a cost function <italic>G</italic>(<italic>u</italic>) that measures the distance between the model output and the desired output.
					<disp-formula id="pcbi-0040030-e006"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>G</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:mrow><mml:msubsup><mml:mo>&int;</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mo stretchy='false'>&lsqb;</mml:mo><mml:mi>y</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>u</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mtext>design</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>&rsqb;</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:math> --></disp-formula>
				</p><p>Here, <italic>G</italic>(<italic>u</italic>) is the sum of squares error between <italic>y</italic>(<italic>u</italic>,<italic>t</italic>), the model output for a given input <italic>u</italic>(<italic>t</italic>), and <italic>y</italic><sub>design</sub>(<italic>t</italic>), the target output the controller is trying to match. <italic>T</italic> is the length of time of the experiment. The control problem is then to find an input function <italic>u</italic>(<italic>t</italic>) that minimizes <italic>G</italic>(<italic>u</italic>).</p><p><xref ref-type="disp-formula" rid="pcbi-0040030-e006">Equation 6</xref> depends on models of the form of <xref ref-type="disp-formula" rid="pcbi-0040030-e004">Equation 4</xref>, which are nonlinear and potentially high order. This prevents us from solving the minimization problem directly. To address this issue, we implement two different approximations. The first is based on controlling a model formed from successive linearizations of <xref ref-type="disp-formula" rid="pcbi-0040030-e004">Equation 4</xref> (henceforth referred to as the tangent linear controller), and the second is based on a local search of the input space (henceforth referred to as the dynamic optimization controller) [<xref ref-type="bibr" rid="pcbi-0040030-b029">29</xref>].</p></sec><sec id="s2c"><title>Tangent Linear Controller</title><p>A first-order approximation to <xref ref-type="disp-formula" rid="pcbi-0040030-e004">Equation 4</xref> at time <italic>t</italic> was computed by taking the Taylor series expansion about the current value of the state and input vectors (<italic>x<sub>t</sub></italic> and <italic>u<sub>t</sub></italic>).
					<disp-formula id="pcbi-0040030-e007"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e007" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:mfrac><mml:mi>d</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mi>&Delta;</mml:mi><mml:mi>x</mml:mi><mml:mo>&ap;</mml:mo><mml:mo stretchy='false'>&lsqb;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>I</mml:mi><mml:mo>&otimes;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&otimes;</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>I</mml:mi><mml:mo>&otimes;</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>&rsqb;</mml:mo><mml:mi>&Delta;</mml:mi><mml:mi>x</mml:mi><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&otimes;</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>&Delta;</mml:mi><mml:mi>u</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign='left'><mml:mi>y</mml:mi><mml:mo>&ap;</mml:mo><mml:mi>C</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&Delta;</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>
				</p><p><xref ref-type="disp-formula" rid="pcbi-0040030-e007">Equation 7</xref> is a linear differential equation with state variable Δ<italic>x</italic> and time varying forcing term Δ<italic>u</italic>, which has both numerical and analytical solutions. However, this approximation would tend to diverge from the solution to <xref ref-type="disp-formula" rid="pcbi-0040030-e004">Equation 4</xref> with increasing Δ<italic>t</italic>, the time beyond the linearization point <italic>t</italic>, and (Δ<italic>x</italic>, Δ<italic>u</italic>), the distance from the linearization point (<italic>x<sub>t</sub></italic>,<italic>u<sub>t</sub></italic>). To mitigate this problem the true system (<xref ref-type="disp-formula" rid="pcbi-0040030-e004">Equation 4</xref>) was propagated, and successive linearizations were applied to improve the controller performance. Effectively, the linearization point is allowed to slide along with the exact simulation.</p><p>Operationally, each time step was solved in three stages. First, the current state of the nonlinear simulation was used to derive a linear approximation about the current time point. Second, the linear system was solved to get the best input Δ<italic>u</italic>. The linear system was solved numerically by discretizing the input as a series of scaled and shifted boxcar functions [<xref ref-type="bibr" rid="pcbi-0040030-b030">30</xref>] of width <italic>τ</italic>. Numerical integration with the MATLAB routine ode15s [<xref ref-type="bibr" rid="pcbi-0040030-b031">31</xref>] was used to compute the system response to a unit boxcar input. The output of a linear time invariant system can be expressed as a linear combination of scaled and shifted impulse response functions. Thus, solving for the input was achieved by computing the weights to apply to the input pulses that gave the optimal output. This was solved as a linear system of equations with box constraints on the input to limit the maximum and minimum concentration using the MATLAB routine lsqlin. Third, the computed input signal was applied to the full nonlinear system for a short time step <italic>τ</italic>. The process was then repeated for the next time interval. Effectively, each step the algorithm solves for an input signal Δ<italic>u</italic> that is piecewise constant. The width of the intervals <italic>τ</italic> as well as the number of intervals is a parameter of the optimization and should be chosen based on the accuracy of the linear system.</p></sec><sec id="s2d"><title>Dynamic Optimization Controller</title><p>In this controller formulation, rather than exactly solving the tangent linear system, we solved the full nonlinear problem iteratively using a gradient optimization method. Application of this method requires computation of the sensitivities of the least squares objective function (<xref ref-type="disp-formula" rid="pcbi-0040030-e006">Equation 6</xref>) with respect to the input parameterization <italic>p</italic>. An efficient way to compute this quantity is to first solve for the adjoint sensitivities <italic>λ</italic> [<xref ref-type="bibr" rid="pcbi-0040030-b029">29</xref>]. For the dynamical system (<xref ref-type="disp-formula" rid="pcbi-0040030-e004">Equation 4</xref>) and the objective function (<xref ref-type="disp-formula" rid="pcbi-0040030-e006">Equation 6</xref>), the adjoint equations are given by <xref ref-type="disp-formula" rid="pcbi-0040030-e008">Equation 8</xref>.
					<disp-formula id="pcbi-0040030-e008"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e008" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msup><mml:mi>&lambda;</mml:mi><mml:mo>*</mml:mo></mml:msup></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mo>&minus;</mml:mo><mml:msup><mml:mi>&lambda;</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy='false'>&lsqb;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>I</mml:mi><mml:mo>&otimes;</mml:mo><mml:mi>x</mml:mi><mml:mo>&plus;</mml:mo><mml:mi>x</mml:mi><mml:mo>&otimes;</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>I</mml:mi><mml:mo>&otimes;</mml:mo><mml:mi>u</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>&rsqb;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign='left'><mml:mo>&minus;</mml:mo><mml:mn>2</mml:mn><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>C</mml:mi><mml:mi>x</mml:mi><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mtext>design</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:msup><mml:mi>C</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign='left'><mml:msub><mml:mo>&nabla;</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mi>G</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:mrow><mml:munderover><mml:mo>&int;</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mi>&lambda;</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo stretchy='false'>&lsqb;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>&plus;</mml:mo><mml:msub><mml:mi>B</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy='false'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>&otimes;</mml:mo><mml:mi>I</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>&rsqb;</mml:mo><mml:msub><mml:mo>&nabla;</mml:mo><mml:mi>p</mml:mi></mml:msub><mml:mi>u</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>
				</p><p>Here, <italic>λ</italic>* indicates the conjugate transpose. We use piecewise linear input functions described by parameters <italic>p<sub>i</sub></italic>, which are the input function value at <italic>T<sub>i</sub></italic><sub>,</sub> <italic>u(T<sub>i</sub>)</italic>; <italic>u(t)</italic> is then linearly interpolated between the control points at <italic>T<sub>i</sub></italic>. For these piecewise linear input signals the <italic>i<sup>th</sup></italic> component of the gradient <inline-formula id="pcbi-0040030-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0040030.ex001" xlink:type="simple"/></inline-formula>
					 is given by:
					<disp-formula id="pcbi-0040030-e009"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e009" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>u</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>p</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy='true'>&lcub;</mml:mo><mml:mtable columnalign='left'><mml:mtr><mml:mtd columnalign='left'><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mi>t</mml:mi><mml:mo>&le;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mspace width="2pt"/><mml:mtext>or</mml:mtext><mml:mspace width="2pt"/><mml:mi>t</mml:mi><mml:mo>&ge;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&minus;</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>&minus;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mtd><mml:mtd><mml:msub><mml:mi>T</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi><mml:mo>&lt;</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&plus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math> --></disp-formula>
				</p><p>The adjoint equations were solved in MATLAB using ode15s [<xref ref-type="bibr" rid="pcbi-0040030-b031">31</xref>] and the optimization was implemented using fmincon configured to use Quasi-Newton [<xref ref-type="bibr" rid="pcbi-0040030-b032">32</xref>] with BFGS [<xref ref-type="bibr" rid="pcbi-0040030-b033">33</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b034">34</xref>] in the MATLAB Optimization Toolbox Version 3.1.1.</p></sec><sec id="s2e"><title>Constraining Input Signals</title><p>Thus far the input signals have been unconstrained, except by the choice of the discretization. However, in practice it may be desirable to restrict the space of input signals to those that could be feasibly achieved by a given experimental setup. For example, in many experimental setups it is easy to add material but difficult to take material away. Likewise, there may be a maximum and minimum concentration for the input signals, or a maximum rate of change for the input signal. We implemented these experimental constraints as linear inequality constraints of the form of <xref ref-type="disp-formula" rid="pcbi-0040030-e010">Equation 10</xref>.
					<disp-formula id="pcbi-0040030-e010"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e010" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>A</mml:mi><mml:mi>p</mml:mi><mml:mo>&le;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:math> --></disp-formula>The matrix <italic>A</italic> and the vector <italic>b</italic> are passed as arguments to lsqlin in the case of the tangent linear controller, or to fmincon in the case of the dynamic optimization controller. An example of a linear constraint that might be applied is that the input increase monotonically. In this case, <italic>A</italic> and <italic>b</italic> are given by <xref ref-type="disp-formula" rid="pcbi-0040030-e011">Equation 11</xref>.
					<disp-formula id="pcbi-0040030-e011"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e011" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>A</mml:mi><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy='true'>&lsqb;</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd></mml:mtd><mml:mtd><mml:mo>&drdellip;</mml:mo></mml:mtd><mml:mtd><mml:mo>&drdellip;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy='true'>&rsqb;</mml:mo></mml:mrow><mml:mspace width="1em"/><mml:mtext>and</mml:mtext><mml:mspace width="1em"/><mml:mi>b</mml:mi><mml:mo>&equals;</mml:mo><mml:mrow><mml:mo stretchy='true'>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>&vellip;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo stretchy='true'>)</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>
				</p></sec><sec id="s2f"><title>EGFR Signaling Model</title><p>We based our model of EGFR signaling on that of Hornberg et al. [<xref ref-type="bibr" rid="pcbi-0040030-b016">16</xref>], which itself is a refinement of earlier work [<xref ref-type="bibr" rid="pcbi-0040030-b017">17</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b018">18</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b027">27</xref>]. The model contains 103 chemical species, and 148 elementary reactions; these reactions are of the type given by <xref ref-type="disp-formula" rid="pcbi-0040030-e001">Equations 1</xref>, <xref ref-type="disp-formula" rid="pcbi-0040030-e002">2</xref>, and <xref ref-type="disp-formula" rid="pcbi-0040030-e003">3</xref> and may be reversible. The model is parameterized by 97 distinct reaction rate values and 103 initial conditions. The details of this model are given in <xref ref-type="supplementary-material" rid="pcbi-0040030-sd003">Dataset S3</xref>.</p><p>Here we also introduced a modified model of EGFR signaling, which contained six additional production/degradation reactions of the form of <xref ref-type="disp-formula" rid="pcbi-0040030-e012">Equation 12</xref>, where <italic>X</italic> is one of {GAP, GRB2, SOS, RAS-GDP, SHC, or GRB2-SOS}.
					<disp-formula id="pcbi-0040030-e012"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e012" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mo>&empty;</mml:mo><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>deg</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>synth</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mi>X</mml:mi></mml:mrow></mml:math> --></disp-formula>
				</p><p>The degradation rate <italic>k</italic><sub>deg</sub> was set such that the steady-state value of the species was the same as the steady-state value in the unmodified model computed using <xref ref-type="disp-formula" rid="pcbi-0040030-e013">Equation 13</xref>.
					<disp-formula id="pcbi-0040030-e013"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e013" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>deg</mml:mtext></mml:mrow></mml:msub><mml:mo>&equals;</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>synt</mml:mtext></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mtext>SS</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math> --></disp-formula>
				</p><p>In addition to the protein synthesis and degradation reactions, a GAP-catalyzed turnover of RAS-GTP was implemented.
					<disp-formula id="pcbi-0040030-e014"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e014" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtext>RAS</mml:mtext><mml:mspace width='-2.75pt'/><mml:mo>-</mml:mo><mml:mspace width='-2.5pt'/><mml:mtext>GTP</mml:mtext><mml:mo>&plus;</mml:mo><mml:mtext>GAP</mml:mtext><mml:munderover><mml:mo>&rlhar;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>off</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mtext>on</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mtext>RAS</mml:mtext><mml:mspace width='-2.75pt'/><mml:mo>-</mml:mo><mml:mspace width='-2.5pt'/><mml:mtext>GTP</mml:mtext><mml:mspace width='-2.5pt'/><mml:mo>:</mml:mo><mml:mspace width='-2.5pt'/><mml:mtext>GAP</mml:mtext><mml:mover><mml:mo>&rarr;</mml:mo><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mover><mml:mtext>RAS</mml:mtext><mml:mspace width='-2.75pt'/><mml:mo>-</mml:mo><mml:mspace width='-2.5pt'/><mml:mtext>GDP</mml:mtext><mml:mo>&plus;</mml:mo><mml:mtext>GAP</mml:mtext><mml:mo>&plus;</mml:mo><mml:msub><mml:mtext>P</mml:mtext><mml:mtext>i</mml:mtext></mml:msub></mml:math> --></disp-formula>
				</p><p>The rate constants (<italic>k</italic><sub>on</sub>, <italic>k</italic><sub>off</sub>, and <italic>k</italic><sub>cat</sub>) are 5 × 10<sup>−7</sup> cell molecules<sup>−1</sup> s<sup>−1</sup>, 0.4 s<sup>−1</sup>, and 0.023 s<sup>−1</sup>, respectively. The rate constants <italic>k</italic><sub>on</sub> and <italic>k</italic><sub>off</sub> are taken from the analogous reaction where GAP is part of the receptor complex and the <italic>k</italic><sub>cat</sub> was fit so that the half–life of RAS-GTP in the absence of EGF matched literature values [<xref ref-type="bibr" rid="pcbi-0040030-b035">35</xref>].</p><p> Finally, a first-order turnover of internalized SOS was implemented with a rate constant of 10<sup>−7</sup> s<sup>−1</sup> based on the turnover rate of EGFR.
					<disp-formula id="pcbi-0040030-e015"><graphic mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.0040030.e015" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:msub><mml:mi>S</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mover><mml:mo>&rarr;</mml:mo><mml:mi>k</mml:mi></mml:mover><mml:mi>S</mml:mi><mml:mi>O</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:math> --></disp-formula>
				</p><p>This augmented model has the additional property that if the input is removed (set to zero) it will return to its initial condition.</p></sec><sec id="s2g"><title>MAPK Signaling Model</title><p>The mitogen activated protein kinase cascade is a signaling motif found repeated throughout biology [<xref ref-type="bibr" rid="pcbi-0040030-b027">27</xref>]. In each step of the cascade a substrate is multiply phosphorylated by a kinase, which in turn is the input to the next layer in the cascade. The off signal, present in each layer, is a phosphatase that removes the phosphate groups. Despite knowing all of the species involved, the detailed mechanism of the enzymatic steps had been difficult to determine [<xref ref-type="bibr" rid="pcbi-0040030-b027">27</xref>]. In particular, it was unclear if the kinase acted in two distinct enzymatic steps, whereby it released the substrate between phosphorylation steps (distributive mechanism) or if it performed both phosphorylation steps before releasing the substrate (processive mechanism).</p><p>A MAP kinase cascade consisting or RAF, MEK, and ERK is contained in the Hornberg EGFR pathway model. We extracted a tier of this cascade consisting of a single kinase, phosphatase, and substrate. The four reversible bimolecular reactions representing the phosphorylation of ERK by doubly phosphorylated MEK (MEKpp) and the de-phosphorylation by a phosphatase were used as the basis of a new model. The model contains a distributive dual phosphorylation step catalyzed by MEKpp and a distributive dual de-phosphorylation step catalyzed by a phosphatase. MEKpp is the system input; doubly phosphorylated ERK (ERKpp) is the output.</p><p>In addition to this basic model, three alternative models were constructed that differed in their mechanism of phosphorylation and de-phosphorylation (processive or distributive). The set of four models (distributive-kinase/distributive-phosphatase, processive-kinase/distributive-phosphatase, distributive-kinase/processive-phosphatase, processive-kinase/processive-phosphatase) represents all possible combinations of processive and distributive phosphorylation and de-phosphorylation mechanisms. The alternative models, which contain some rate parameters not included in the distributive-kinase/distributive-phosphatase base model, were parameterized by fitting the parameters to the step response of the double distributive model, which included both a step-up and a step-down experiment. The details of these four models are given in <xref ref-type="supplementary-material" rid="pcbi-0040030-sd002">Dataset S2</xref>.</p></sec></sec><sec id="s3"><title>Results</title><p>We have developed a method for designing an input signal capable of controlling the output of a candidate model. In practice, these input signals are useful for distinguishing among sets of candidate models.</p><sec id="s3a"><title>Simple Antibody-Binding Models</title><p>The dynamic optimization controller was applied to design input stimuli for each of the two alternative antibody binding reactions studied by Smith-Gill and co-workers [<xref ref-type="bibr" rid="pcbi-0040030-b003">3</xref>]. For both the one-step and the two-step model (<xref ref-type="supplementary-material" rid="pcbi-0040030-sd001">Dataset S1</xref>), the objective applied was to produce a constant output of antibody–ligand complex from time zero onwards. In the experiment performed by Smith-Gill and co-workers the measurement was a change in mass due to ligand binding as measured by surface plasmon resonance. While the fully bound complex is more stable than the postulated encounter complex, both have the same mass and would produce the same output signal. Therefore, in the case of the two-step model, the output is the sum of the encounter and fully bound complexes, whereas in the one-step model it is simply the fully bound complex. The basis set for the input was a 50-point piecewise-linear function with linear spacing. In the two-step model points were distributed evenly over the entire interval. In the one-step model points were placed evenly from 500 s to 600 s to accommodate the sharp transition.</p><p>The results are shown in <xref ref-type="fig" rid="pcbi-0040030-g002">Figure 2</xref>. Both controllers designed an input signal that starts at high concentration to form complex quickly and then drops to a lower concentration to keep the complex from overshooting the desired value. However, the controller for the one-step model drops abruptly while the controller for the two-step model drops more gradually. The desired outputs were not recovered when the stimuli from the wrong models were applied. When the one-step input was applied to the two-step system, the output produced an undershoot followed by an overshoot. When the input designed for the two-step model was applied to the one-step system, the complex concentration also produced an overshoot, but one that persisted. In both cases, accounting for the presence or absence of the encounter complex was critical for controlling the output correctly.</p><fig id="pcbi-0040030-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040030.g002</object-id><label>Figure 2</label><caption><title>Analysis of Monovalent Antibody Binding</title><p>(A) Two models of monovalent antibody binding, a one-step version with no intermediate, and a two-step version with an association intermediate <italic>C</italic><sup>*</sup>.</p><p>(B) The results of six simulated experiments are shown as designed in [<xref ref-type="bibr" rid="pcbi-0040030-b003">3</xref>]. Each trace is the response of the system to a square pulse of ligand concentration. The width of the pulse varies from 400 s to 6,000 s. The pronounced elbow in the middle curves is indicative of the two-state model. The one-step model cannot have compound off kinetics.</p><p>(C) The set of experiments designed by this algorithm as well as simulated results are shown. Each pulse was designed to produce a level output when applied to the correct model (yellow boxes), which was observed, and produced a distinctly different result when applied to the other model (blue boxes). The red lines are the inputs (unbound <italic>L</italic>) the blue lines are the output (<italic>C</italic> or <italic>C</italic> + <italic>C</italic><sup>*</sup>). The smaller the gap between the blue and the black dashed line the better the model fits the real system. Looking across one row shows a pair of experiments that would be run together.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.g002" xlink:type="simple"/></fig><p>It is interesting to note that this method allows for the selection of both the more complex model (if it is correct) as well as the simpler model. This is not possible using standard a posteriori metrics, such as least squares, which will always favor the more complex model. While there are methods that try to correct for this bias [<xref ref-type="bibr" rid="pcbi-0040030-b036">36</xref>], properly accounting for model complexity in large nonlinear systems remains an open problem [<xref ref-type="bibr" rid="pcbi-0040030-b037">37</xref>]. Comparing our results to the Smith-Gill pulse method (<xref ref-type="fig" rid="pcbi-0040030-g002">Figure 2</xref>B), it is clear that both computational experiments permit the two models to be distinguished in favor of the two-step method. However, for larger and more complex cases, it is unclear whether intuitive approaches or square pulse inputs will be sufficient to design distinguishing experiments. Another feature of the simulations is that the designed pulse produces a level output that does not require fine time resolution to accurately measure. This can be a significant advantage for more complex experimental systems, such as cell signaling measurements, where limitations on experimental observations are even more severe, whether in terms of numbers of species, time points or other factors.</p></sec><sec id="s3b"><title>MAPK Signaling</title><p>Mitogen-activated protein kinase cascades have been extensively studied experimentally and modeled computationally. While many variants exist, the canonical pathway consists of three layers of kinases and phosphatases. For each layer, the kinase activates the downstream kinase by dual-phosphorylation and the phosphatase deactivates the downstream kinase by removing the phosphate groups. Knowing the general structure of this pathway, it was still difficult to determine the details of the enzymatic steps. In particular, it was unknown if the kinase acted in a processive mechanism (adding both phosphate groups in a single step), or if it acted in a distributive mechanism (adding the phosphates in two distinct enzymatic steps). The difficulty arose from the fact that, without measuring all of the phosphorylation forms, both mechanisms could fit the step response data. The issue was eventually resolved by devising an experiment that could separate all of the phosphorylation forms [<xref ref-type="bibr" rid="pcbi-0040030-b027">27</xref>]. Here we show that, in principle, the mechanisms could have been distinguished using our method, without adding additional measurements.</p><p>To address this problem we generated four candidate models of a MAPK dual phosphorylation reaction. All four models contained forward phosphorylation and reverse de-phosphorylation steps, but differed in the detailed mechanisms. For both the forward and the reverse reactions we considered a processive (one-step) and a distributive (two-step) mechanism (<xref ref-type="fig" rid="pcbi-0040030-g003">Figure 3</xref>A). Taking all combinations of distributive and processive reactions produced four models. For each model the free kinase concentration was the input variable and the concentration of doubly phosphorylated substrate was the output.</p><fig id="pcbi-0040030-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040030.g003</object-id><label>Figure 3</label><caption><title>Analysis of MAPK Mechanisms</title><p>(A) Four alternative MAPK reaction schemes are shown. These correspond to all combinations of processive and distributive kinase and phosphatase mechanisms. Model I is the canonical all-distributive mechanism. For each model the input is the concentration of activated kinase (<italic>K</italic>) and the output is the doubly phosphorylated substrate (<italic>S**</italic>).</p><p>(B) All four MAPK models respond in very similar fashion to a step increase in kinase input (<italic>u</italic> = 1).</p><p>(C) A set of 16 model-selection experiments. Each row is a different experimental system and each column is a different candidate model. Red lines are inputs (activated <italic>K</italic>), blue lines are outputs (<italic>S**</italic>), and the black dashed line is the design output trajectory. The experiments on the diagonal show that the correct model can control the system. The off-diagonal experiments show that the wrong model does a worse job. This difference can be used to select the correct model.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.g003" xlink:type="simple"/></fig><p>For each of the four models, a stimulus was developed using the tangent linear controller. The objective was to drive the output to a fixed value that remained constant with time. Each of the four designed signals was used to stimulate each of the four models, and the resulting 16 experiments are shown in <xref ref-type="fig" rid="pcbi-0040030-g003">Figure 3</xref>C. Along the diagonal, one can see that the input signal derived from the correct model was able to effectively control the system. However, looking at each off-diagonal entry shows that inputs from each wrong model did a poor job controlling each system. In any real experiment, there is only one true system, which corresponds to performing the experiments from a single row of the figure.</p><p>As with the antibody models, the algorithm was able to find a set of signals that distinguished amongst multiple models. It is worth noting that these solutions were generated automatically from the candidate models and did not require explicit user supervision.</p></sec><sec id="s3c"><title>EGFR Pathway</title><p>A popular ordinary differential equation model of the EGFR pathway is that of Hornberg and co-workers [<xref ref-type="bibr" rid="pcbi-0040030-b016">16</xref>]. This model consists of 103 differential equations and includes ligand binding, receptor dimerization and activation, adaptor protein binding, trafficking of the receptor complex, and activation of the MAPK cascade terminating with ERK dual phosphorylation (<xref ref-type="fig" rid="pcbi-0040030-g004">Figure 4</xref>). This model was built as a set of successive refinements of earlier models [<xref ref-type="bibr" rid="pcbi-0040030-b017">17</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b018">18</xref>,<xref ref-type="bibr" rid="pcbi-0040030-b027">27</xref>], with each refinement adding a new level of detail to the model. In its most recent formulation an additional negative feedback loop was added whereby activated ERK phosphorylates SOS and deactivates it. This model has been shown to agree with time course data collected in cell based assays as well as literature values for parameters measured in vitro [<xref ref-type="bibr" rid="pcbi-0040030-b018">18</xref>]. We compare the original Hornberg model to a version with additional changes. We continue this model evolution by modifying the Hornberg model so that, when the input (EGF) is removed, the model returns to its initial conditions. This reset behavior is observed experimentally. Cells cultured in media containing EGF but switched to serum and EGF free media 12 h before stimulation, are able to respond to a dose of EGF added to the media [<xref ref-type="bibr" rid="pcbi-0040030-b023">23</xref>]. This indicates that after EGF has been removed, the pathway returns to an EGF responsive state.</p><fig id="pcbi-0040030-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040030.g004</object-id><label>Figure 4</label><caption><title>Schematic of EGF-Induced Signaling</title><p>This schematic shows the major steps in EGFR signaling. At the top of the pathway ligand binds to the receptor and induces receptor dimerization and activation. The signal is then transduced through a series of adaptor proteins SHC, GRB2, and SOS, which in turn activates the MAPK cascade RAF, MEK and ERK. There are two negative feedback loops: internalization and degradation of the receptor complex, and ERK deactivation of SOS.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.g004" xlink:type="simple"/></fig><p>In the Hornberg model, the dominant mechanism for desensitization and adaptation of the pathway to EGF is endocytosis and degradation of the receptor complex. Opposing this process are constitutive production and degradation reactions for the receptor, which allow the receptor level to return back to steady state after stimulation. This same process degrades other proteins in the receptor complex GAP, GRB2, SOS, and RAS, but the current model does not contain synthesis terms for these proteins. As a result, prolonged stimulation depletes these proteins and prevents the activation of RAF, MEK, and ERK. We added production and degradation reactions analogous to the reactions for the receptor for all of the proteins in the receptor complex. Rate constants were chosen such that the steady-state levels in the absence of stimulation were the same as the initial conditions for the model and the exponential time constant for the approach to steady state was the same as for EGFR.</p><p>The second modification to the model was in the RAS-GDP/RAS-GTP cycle. In the Hornberg model, activated receptor is needed to catalyze the recycling of RAS-GTP* (a molecule of RAS-GTP that has already activated a molecule of RAF) that is waiting to be recycled to RAS-GDP. If EGF is removed, RAS can be trapped in the RAS-GTP* form, preventing the system from returning to steady state. We addressed this by adding an additional enzymatic step to recycle RAS-GTP* back to RAS-GDP catalyzed by GAP and parameterized using literature rate constants [<xref ref-type="bibr" rid="pcbi-0040030-b035">35</xref>].</p><p>With the addition of these new reactions, the modified model returns to its initial conditions after stimulation. For the remaining model parameters (the parameters shared with the original model) we fit the modified model to the original using data from a simulated step-response experiment (<xref ref-type="fig" rid="pcbi-0040030-g005">Figure 5</xref>A) constraining them to be within 10% of their original value. Despite the introduction of these new mechanisms and the tight constraints on the parameters, the step responses of the six molecular species modeling those presented in the original paper [<xref ref-type="bibr" rid="pcbi-0040030-b018">18</xref>] (<xref ref-type="fig" rid="pcbi-0040030-g005">Figure 5</xref>B) are very similar in the original model (blue curves) and the modified model (red curves). The largest difference is in the SHC* time course, which has a very similar shape and varies by at most 11%. While significant, this difference would be very difficult to detect in a standard biological experiment. As such, the modified model is a reasonable alternative to the original model, and it would be hard to reject either mechanism using the step-response data alone.</p><fig id="pcbi-0040030-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0040030.g005</object-id><label>Figure 5</label><caption><title>Comparison of Step Experiment to Designed Experiment for EGFR Pathway with Original and Modified Models</title><p>(A) Both models respond similarly but not identically to a step input in EGF over a range of concentrations. The red lines are the outputs of the modified model and the blue lines are the outputs of the standard model. Often the blue lines are not visible because they are under the red lines.</p><p>(B) Two designed dynamic stimuli were applied to two models of the EGFR pathway. The red lines show the input (EGF) concentration as a function of time. The blue lines show the output concentrations (ERKpp). The dashed black line shows the target ERKpp concentration. The controller for the standard model is unable to keep the output level high and saturates. In contrast, the modified model requires a more gradual increase in the input and can control the experiment over the entire time course. In both cases the controller based on the wrong model performs worse that the controller based on the correct model.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.g005" xlink:type="simple"/></fig><p>From this starting point we used our methodology to design an experiment that could distinguish between the current model and the modified model of the EGFR pathway. For each model we tasked the dynamic optimization controller with driving the concentration of doubly phosphorylated ERK to a constant level of 10<sup>4</sup> molecules per cell. The input basis set was 25 points linearly spaced over the interval. To model the experimental condition where it is easy to add EGF to the dish of cells but difficult to remove, we implemented a monotonicity constraint. <xref ref-type="fig" rid="pcbi-0040030-g005">Figure 5</xref>B shows the inputs designed for each of the two models applied to each system with the resulting ERKpp time courses. Due to the negative feedback loops, both models required a steadily increasing concentration of EGF to maintain a constant level of ERKpp. However, the original model was much more difficult to control; as time progressed increasingly high doses of EGFR were required to maintain a constant output. The modified model required a much gentler increase in EGF concentration to maintain its level and was able to keep the concentration of ERKpp high to the end of the time period. Trial calculations showed that this result was robust to order of magnitude changes in the new rate parameters introduced in the modified model. Applying these two signals in an experiment could be used to distinguish between these two models, as demonstrated by the simulations.</p></sec></sec><sec id="s4"><title>Discussion</title><p>The most common stimulus-response protocol involves applying a step change in one or more input concentrations and following the evolution of one or more downstream molecules. For a linear system, this type of experiment can provide enough information to fully identify the system [<xref ref-type="bibr" rid="pcbi-0040030-b038">38</xref>]. However, even simple biochemical systems are nonlinear, and as such there is no a priori reason to believe that a step-response experiment will be sufficient to uncover the relevant dynamics of the system and allow for the selection of a unique model. As a result, it is often possible, if not probable, that multiple mechanisms fit the same set of step-response data. We have shown here that using dynamic stimulation can improve stimulus-response experiments. Even in the context of complex pathways with limited numbers of inputs and outputs, experiments can be designed that are capable of distinguishing amongst alternative mechanisms. Moreover, for the EGFR pathway studied, the differences detected were in the middle of the pathway, far from the location of the stimulus or the readouts.</p><p>One possible explanation for the results presented here is that we have stimulated the systems with high-frequency signals, and it is this fact that allows for model discrimination. While the high-frequency content almost certainly plays a part, the fact that differences between models are observed at low frequency distinguishes our results from other standard test signals. For example, in linear systems it is common to use random or pseudorandom signals to discriminate among models. <xref ref-type="supplementary-material" rid="pcbi-0040030-sg001">Figure S1</xref> shows such an experiment. While the signal is discriminating, the observed differences are high frequency and would be difficult to distinguish in a standard biological assay, which is usually sampled sparsely in time.</p><p>Formulating experimental design as a control problem yielded a relatively straightforward numerical solution, which allowed us to apply our method to large pathway models. While the method does not yield optimal experiments, in the sense of maximizing the least squares error between model ouputs, the results are still of practical benefit and appear sufficient to distinguish amongst model candidates. In the systems studied here, the designed inputs were able to substantially increase the differences observed between competing models when compared to the corresponding step-response experiment. By prescribing the target output trajectory, it should be possible to tailor the experiments to the available measurement methods, thereby achieving the most benefit from existing assays. It is worth noting that in all of the examples presented here, the target function was a constant output concentration. This was chosen for simplicity rather than for any special property of these targets. The problem of the best target function is an interesting one but is beyond the scope of this work. However, in <xref ref-type="supplementary-material" rid="pcbi-0040030-sg002">Figure S2</xref> we show calculations for the antibody–ligand system using other simple target functions, lines of constant slope, and find that designed inputs based on these signals have similar discriminating power.</p><p>In each of the cases presented here, the dynamic stimuli allowed us to select the correct mechanism from a set of plausible candidates. However, it is possible that for a particular system and set of constraints, the algorithms presented here may fail to find a signal that is sufficiently discriminating. In this case a different choice of target function or a more sophisticated optimization approach may yield better results. However, it is worth noting that in the systems studied here both methods were able to find very good solutions in all cases. In general, the tangent linear controller was more computationally efficient and yielded smoother signals, whereas the dynamic optimization controller was slower but did not require tuning of parameters such as <italic>τ</italic>.</p><p>One potential limitation of our method comes from our reliance on parameterized models. The accuracy of the parameterizations will affect the quality of the predictions made by the controllers and thus the ability to distinguish between models. To demonstrate this, we generated 100 different parameterizations of the one-step and two-step antibody models and then applied the control signals designed using the nominal parameter set (<xref ref-type="supplementary-material" rid="pcbi-0040030-sg003">Figure S3</xref>). The parameter variation resulted in output trajectories that were quantitatively different from the predicted output trajectories. However, the overall shape of the output trajectories was preserved.</p><p>All of the results presented here were in simulation. In practice, experimental error and measurement noise will make it more difficult to distinguish between models. As a result, one may only be able to effectively discard some candidate models, and reduce the pool of hypotheses. However, these experimental challenges also motivate our method, as it has the potential to increase the experimental observability of model differences when compared to a more traditional experiment, such as a step response. Moreover, the fact that potential mechanisms can be evaluated without having to resort to additional inputs or outputs is especially valuable in laboratory experiments, where adding additional inputs or outputs may require significant effort, such as developing new experimental reagents.</p></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi-0040030-sd001" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.sd001" xlink:type="simple"><label>Dataset S1</label><caption><title>Models of the One-Step and Two-Step Antibody–Ligand Binding Reaction</title><p>(10 KB TAR)</p></caption></supplementary-material><supplementary-material id="pcbi-0040030-sd002" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.sd002" xlink:type="simple"><label>Dataset S2</label><caption><title>Models of the MAPK Phosphorylation and De-Phosphorylation</title><p>(10 KB TAR)</p></caption></supplementary-material><supplementary-material id="pcbi-0040030-sd003" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.sd003" xlink:type="simple"><label>Dataset S3</label><caption><title>Models of the Epidermal Growth Factor Signaling Pathway</title><p>(50 KB TAR)</p></caption></supplementary-material><supplementary-material id="pcbi-0040030-sg001" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.sg001" xlink:type="simple"><label>Figure S1</label><caption><title>Random-Pulse Experiment</title><p>This figure shows a series of pulses as input to the one-step and two-step antibody–ligand models for two different distributions of switching time. In the slower switching time (A) the input signal changes at random with a mean of 900 s, and in the faster switching time (C) the input switches at random with a mean of 90 s.</p><p>(B) The response of the two models to the slower input shows that the one-step model looks like a smoothed out version of the two-step model.</p><p>(D) The trend is similar with the faster varying signal.</p><p>(883 KB EPS)</p></caption></supplementary-material><supplementary-material id="pcbi-0040030-sg002" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.sg002" xlink:type="simple"><label>Figure S2</label><caption><title>Matching Different Target Functions</title><p>The dynamic optimization controller was used to design input signals to drive the one-step and two-step antibody–ligand models. The target functions (black dashes) are a set of lines of increasing slope. The input is the concentration of free ligand (red) and the output is the amount of complex formed (blue). The figures on the diagonal show that the controller based on the correct model is able to accurately drive the systems to follow the target functions very closely. Whereas, the figures on the off diagonal show that the inputs based on the wrong models cause either large over- or undershoots of the target function.</p><p>(1.2 MB EPS)</p></caption></supplementary-material><supplementary-material id="pcbi-0040030-sg003" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0040030.sg003" xlink:type="simple"><label>Figure S3</label><caption><title>The Effect of Parameterization Errors</title><p>A dynamic optimization controller was constructed based on a nominal parameterization of the one-step and two-step antibody models. The resulting input signal is shown in red and the output is shown in dark blue. These input stimuli were then applied to a set of 100 different parameterizations of these two models (cyan lines). The parameters were chosen from a log normal distribution with a mean centered on the nominal value and a variance of 10%.</p><p>(10.8 MB EPS)</p></caption></supplementary-material></sec></body><back><ack><p>The authors gratefully acknowledge the MIT Computational and Systems Biology community, particularly Jaydeep Bardhan, Ty Thomson, and Jacob White, for stimulating and thoughtful discussion.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>EGF</term><def><p>epidermal growth factor</p></def></def-item><def-item><term>EGFR</term><def><p>epidermal growth factor receptor</p></def></def-item><def-item><term>ERK</term><def><p>extracellular signal–related kinase</p></def></def-item><def-item><term>ERKpp</term><def><p>doubly phosphorylated ERK</p></def></def-item><def-item><term>GAP</term><def><p>GTPase activating protein</p></def></def-item><def-item><term>GRB2</term><def><p>growth factor receptor bound protein 2</p></def></def-item><def-item><term>MAPK</term><def><p>mitogen-activated protein kinase</p></def></def-item><def-item><term>MEK</term><def><p>MAP kinase/ERK kinase</p></def></def-item><def-item><term>MEKpp</term><def><p>doubly phosphorylated MEK</p></def></def-item><def-item><term>ODE</term><def><p>ordinary differential equation</p></def></def-item><def-item><term>SOS</term><def><p>son of sevenless</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0040030-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kitano</surname><given-names>H</given-names></name></person-group>
					<year>2002</year>
					<article-title>Systems biology: A brief overview.</article-title>
					<source>Science</source>
					<volume>295</volume>
					<fpage>1662</fpage>
					<lpage>1664</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kremling</surname><given-names>A</given-names></name><name name-style="western"><surname>Saez-Rodriguez</surname><given-names>J</given-names></name></person-group>
					<year>2007</year>
					<article-title>Systems biology—An engineering perspective.</article-title>
					<source>J Biotechnol</source>
					<volume>129</volume>
					<fpage>329</fpage>
					<lpage>351</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lipschultz</surname><given-names>CA</given-names></name><name name-style="western"><surname>Li</surname><given-names>Y</given-names></name><name name-style="western"><surname>Smith-Gill</surname><given-names>S</given-names></name></person-group>
					<year>2000</year>
					<article-title>Experimental design for analysis of complex kinetics using surface plasmon resonance.</article-title>
					<source>Methods</source>
					<volume>20</volume>
					<fpage>310</fpage>
					<lpage>318</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Box</surname><given-names>GEP</given-names></name><name name-style="western"><surname>Hill</surname><given-names>WJ</given-names></name></person-group>
					<year>1967</year>
					<article-title>Discrimination among mechanistic models.</article-title>
					<source>Technometrics</source>
					<volume>9</volume>
					<fpage>57</fpage>
					<lpage>71</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Asprey</surname><given-names>SP</given-names></name><name name-style="western"><surname>Macchietto</surname><given-names>S</given-names></name></person-group>
					<year>2002</year>
					<article-title>Designing robust optimal dynamic experiments.</article-title>
					<source>J Process Contr</source>
					<volume>12</volume>
					<fpage>545</fpage>
					<lpage>556</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cooney</surname><given-names>MJ</given-names></name><name name-style="western"><surname>McDonald</surname><given-names>KA</given-names></name></person-group>
					<year>1995</year>
					<article-title>Optimal dynamic experiments for bioreactor model discrimination.</article-title>
					<source>Appl Microbiol Biot</source>
					<volume>43</volume>
					<fpage>826</fpage>
					<lpage>837</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b007"><label>7</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Munack</surname><given-names>A</given-names></name></person-group>
					<year>1992</year>
					<article-title>Some improvements in the identification of bioprocesses.</article-title>
					<comment>In</comment>
					<person-group person-group-type="editor"><name name-style="western"><surname>Karim</surname><given-names>MN</given-names></name><name name-style="western"><surname>Stephanopoulos</surname><given-names>G</given-names></name></person-group>
					<source>Modeling and control of biotechnical processes</source>
					<publisher-loc>Oxford (United Kingdom)</publisher-loc>
					<publisher-name>Pergamon Press</publisher-name>
					<fpage>89</fpage>
					<lpage>94</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Brik Ternbach</surname><given-names>M</given-names></name><name name-style="western"><surname>Bollman</surname><given-names>C</given-names></name><name name-style="western"><surname>Wandrey</surname><given-names>C</given-names></name><name name-style="western"><surname>Takors</surname><given-names>R</given-names></name></person-group>
					<year>2005</year>
					<article-title>Application of model discriminating experimental design for modeling and development of a fermentative fed-batch L-valine production process.</article-title>
					<source>Biotechnol Bioeng</source>
					<volume>91</volume>
					<fpage>356</fpage>
					<lpage>368</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Chen</surname><given-names>BH</given-names></name><name name-style="western"><surname>Asprey</surname><given-names>SP</given-names></name></person-group>
					<year>2003</year>
					<article-title>On the design of optimally informative dynamic experiments for model discrimination in multiresponse nonlinear situations.</article-title>
					<source>Ind Eng Chem Res</source>
					<volume>42</volume>
					<fpage>1379</fpage>
					<lpage>1390</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kremling</surname><given-names>A</given-names></name><name name-style="western"><surname>Fischer</surname><given-names>S</given-names></name><name name-style="western"><surname>Gadkar</surname><given-names>K</given-names></name><name name-style="western"><surname>Doyle</surname><given-names>FJ</given-names></name><name name-style="western"><surname>Sauter</surname><given-names>T</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>A benchmark for methods in reverse engineering and model discrimination: Problem formulation and solutions.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>1773</fpage>
					<lpage>1785</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b011"><label>11</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jaqaman</surname><given-names>K</given-names></name><name name-style="western"><surname>Danuser</surname><given-names>G</given-names></name></person-group>
					<year>2006</year>
					<article-title>Linking data to models: Data regression.</article-title>
					<source>Nat Rev Mol Cell Biol</source>
					<volume>7</volume>
					<fpage>813</fpage>
					<lpage>819</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>van Riel</surname><given-names>NA</given-names></name></person-group>
					<year>2006</year>
					<article-title>Dynamic modelling and analysis of biochemical networks: Mechanism-based models and model-based experiments.</article-title>
					<source>Brief Bioinform</source>
					<volume>7</volume>
					<fpage>364</fpage>
					<lpage>374</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b013"><label>13</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Casey</surname><given-names>FP</given-names></name><name name-style="western"><surname>Baird</surname><given-names>D</given-names></name><name name-style="western"><surname>Feng</surname><given-names>Q</given-names></name><name name-style="western"><surname>Gutenkunst</surname><given-names>RN</given-names></name><name name-style="western"><surname>Waterfall</surname><given-names>JJ</given-names></name><etal/></person-group>
					<year>2007</year>
					<article-title>Optimal experimental design in an epidermal growth factor receptor signalling and down-regulation model.</article-title>
					<source>IET Syst Biol</source>
					<volume>1</volume>
					<fpage>190</fpage>
					<lpage>202</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Breitling</surname><given-names>R</given-names></name><name name-style="western"><surname>Hoeller</surname><given-names>D</given-names></name></person-group>
					<year>2005</year>
					<article-title>Current challenges in quantitative modeling of epidermal growth factor signaling.</article-title>
					<source>FEBS Lett</source>
					<volume>579</volume>
					<fpage>6289</fpage>
					<lpage>6294</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wiley</surname><given-names>HS</given-names></name><name name-style="western"><surname>Shvartsman</surname><given-names>SY</given-names></name><name name-style="western"><surname>Lauffenburger</surname><given-names>DA</given-names></name></person-group>
					<year>2003</year>
					<article-title>Computational modeling of the EGF-receptor system: A paradigm for systems biology.</article-title>
					<source>Trends Cell Biol</source>
					<volume>13</volume>
					<fpage>43</fpage>
					<lpage>50</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Hornberg</surname><given-names>JJ</given-names></name><name name-style="western"><surname>Binder</surname><given-names>B</given-names></name><name name-style="western"><surname>Bruggeman</surname><given-names>FJ</given-names></name><name name-style="western"><surname>Schoeberl</surname><given-names>B</given-names></name><name name-style="western"><surname>Heinrich</surname><given-names>R</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Control of MAPK signalling: From complexity to what really matters.</article-title>
					<source>Oncogene</source>
					<volume>24</volume>
					<fpage>5533</fpage>
					<lpage>5542</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kholodenko</surname><given-names>BN</given-names></name><name name-style="western"><surname>Demin</surname><given-names>OV</given-names></name><name name-style="western"><surname>Moehren</surname><given-names>G</given-names></name><name name-style="western"><surname>Hoek</surname><given-names>JB</given-names></name></person-group>
					<year>1999</year>
					<article-title>Quantification of short term signaling by the epidermal growth factor receptor.</article-title>
					<source>J Biol Chem</source>
					<volume>274</volume>
					<fpage>30169</fpage>
					<lpage>30181</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schoeberl</surname><given-names>B</given-names></name><name name-style="western"><surname>Eichler-Jonsson</surname><given-names>C</given-names></name><name name-style="western"><surname>Gilles</surname><given-names>ED</given-names></name><name name-style="western"><surname>Müller</surname><given-names>G</given-names></name></person-group>
					<year>2002</year>
					<article-title>Computational modeling of the dynamics of the MAP kinase cascade activated by surface and internalized EGF receptors.</article-title>
					<source>Nat Biotechnol</source>
					<volume>20</volume>
					<fpage>370</fpage>
					<lpage>375</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Burden</surname><given-names>S</given-names></name><name name-style="western"><surname>Yarden</surname><given-names>Y</given-names></name></person-group>
					<year>1997</year>
					<article-title>Neuregulins and their receptors: A versatile signaling module in organogenesis and oncogenesis.</article-title>
					<source>Neuron</source>
					<volume>18</volume>
					<fpage>847</fpage>
					<lpage>855</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Yarden</surname><given-names>Y</given-names></name><name name-style="western"><surname>Sliwkowski</surname><given-names>MX</given-names></name></person-group>
					<year>2001</year>
					<article-title>Untangling the ErbB signalling network.</article-title>
					<source>Nat Rev Mol Cell Biol</source>
					<volume>2</volume>
					<fpage>127</fpage>
					<lpage>137</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Mendelsohn</surname><given-names>J</given-names></name><name name-style="western"><surname>Baselga</surname><given-names>J</given-names></name></person-group>
					<year>2000</year>
					<article-title>The EGF receptor family as targets for cancer therapy.</article-title>
					<source>Oncogene</source>
					<volume>19</volume>
					<fpage>6550</fpage>
					<lpage>6565</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Eastman</surname><given-names>A</given-names></name><name name-style="western"><surname>Perez</surname><given-names>RP</given-names></name></person-group>
					<year>2006</year>
					<article-title>New targets and challenges in the molecular therapeutics of cancer.</article-title>
					<source>Br J Clin Pharmacol</source>
					<volume>62</volume>
					<fpage>5</fpage>
					<lpage>14</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Zhang</surname><given-names>Y</given-names></name><name name-style="western"><surname>Wolf-Yadlin</surname><given-names>A</given-names></name><name name-style="western"><surname>Ross</surname><given-names>PL</given-names></name><name name-style="western"><surname>Pappin</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Rush</surname><given-names>J</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Time-resolved mass spectrometry of tyrosine phosphorylation sites in the epidermal growth factor receptor signaling network reveals dynamic modules.</article-title>
					<source>Mol Cell Proteomics</source>
					<volume>4</volume>
					<fpage>1240</fpage>
					<lpage>1250</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Blagoev</surname><given-names>B</given-names></name><name name-style="western"><surname>Kratchmarova</surname><given-names>I</given-names></name><name name-style="western"><surname>Ong</surname><given-names>SE</given-names></name><name name-style="western"><surname>Nielsen</surname><given-names>M</given-names></name><name name-style="western"><surname>Foster</surname><given-names>LJ</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>A proteomics strategy to elucidate functional protein-protein interactions applied to EGF signaling.</article-title>
					<source>Nat Biotechnol</source>
					<volume>21</volume>
					<fpage>315</fpage>
					<lpage>318</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Olsen</surname><given-names>JV</given-names></name><name name-style="western"><surname>Blagoev</surname><given-names>B</given-names></name><name name-style="western"><surname>Gnad</surname><given-names>F</given-names></name><name name-style="western"><surname>Macek</surname><given-names>B</given-names></name><name name-style="western"><surname>Kumar</surname><given-names>C</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>Global, in vivo, and site-specific phosphorylation dynamics in signaling networks.</article-title>
					<source>Cell</source>
					<volume>127</volume>
					<fpage>635</fpage>
					<lpage>648</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b026"><label>26</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Oda</surname><given-names>K</given-names></name><name name-style="western"><surname>Matsuoka</surname><given-names>Y</given-names></name><name name-style="western"><surname>Funahashi</surname><given-names>A</given-names></name><name name-style="western"><surname>Kitano</surname><given-names>H</given-names></name></person-group>
					<year>2005</year>
					<article-title>A comprehensive pathway map of epidermal growth factor receptor signaling.</article-title>
					<source>Mol Syst Biol</source>
					<volume>1</volume>
					<comment>2005 0010.</comment>
				</element-citation></ref><ref id="pcbi-0040030-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ferrell</surname><given-names>JE</given-names></name><name name-style="western"><surname>Bhatt</surname><given-names>RR</given-names></name></person-group>
					<year>1997</year>
					<article-title>Mechanistic studies of the dual phosphorylation of mitogen-activated protein kinase.</article-title>
					<source>J Biol Chem</source>
					<volume>272</volume>
					<fpage>19008</fpage>
					<lpage>19016</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b028"><label>28</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Graham</surname><given-names>A</given-names></name></person-group>
					<year>1981</year>
					<source>Kronecker products and matrix calculus with applications</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Halsted Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">130</size>
				</element-citation></ref><ref id="pcbi-0040030-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Cao</surname><given-names>Y</given-names></name><name name-style="western"><surname>Li</surname><given-names>ST</given-names></name><name name-style="western"><surname>Petzold</surname><given-names>L</given-names></name><name name-style="western"><surname>Serban</surname><given-names>R</given-names></name></person-group>
					<year>2003</year>
					<article-title>Adjoint sensitivity analysis for differential-algebraic equations: The adjoint DAE system and its numerical solution.</article-title>
					<source>SIAM J Sci Comput</source>
					<volume>24</volume>
					<fpage>1076</fpage>
					<lpage>1089</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b030"><label>30</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>von Seggern</surname><given-names>DH</given-names></name></person-group>
					<year>1993</year>
					<source>CRC standard curves and surfaces</source>
					<publisher-loc>Boca Raton (Florida)</publisher-loc>
					<publisher-name>CRC Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">416</size>
				</element-citation></ref><ref id="pcbi-0040030-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Shampine</surname><given-names>LF</given-names></name><name name-style="western"><surname>Reichelt</surname><given-names>MW</given-names></name></person-group>
					<year>1997</year>
					<article-title>The MATLAB ODE suite.</article-title>
					<source>SIAM J Sci Comput</source>
					<volume>18</volume>
					<fpage>1</fpage>
					<lpage>22</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b032"><label>32</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Strang</surname><given-names>G</given-names></name></person-group>
					<year>1986</year>
					<source>Introduction to applied mathematics</source>
					<publisher-loc>Wellesley (Massachusetts)</publisher-loc>
					<publisher-name>Wellesley-Cambridge Press</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">758</size>
				</element-citation></ref><ref id="pcbi-0040030-b033"><label>33</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Nocedal</surname><given-names>J</given-names></name><name name-style="western"><surname>Wright</surname><given-names>SJ</given-names></name></person-group>
					<year>2006</year>
					<source>Numerical optimization</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>Springer</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">664</size>
				</element-citation></ref><ref id="pcbi-0040030-b034"><label>34</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bertsekas</surname><given-names>DP</given-names></name></person-group>
					<year>1999</year>
					<source>Nonlinear programming</source>
					<publisher-loc>Belmont (Massachusetts)</publisher-loc>
					<publisher-name>Athena Scientific</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">802</size>
				</element-citation></ref><ref id="pcbi-0040030-b035"><label>35</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lodish</surname><given-names>H</given-names></name><name name-style="western"><surname>Berk</surname><given-names>A</given-names></name><name name-style="western"><surname>Zipursky</surname><given-names>LS</given-names></name><name name-style="western"><surname>Matsudaira</surname><given-names>P</given-names></name><name name-style="western"><surname>Baltimore</surname><given-names>D</given-names></name><etal/></person-group>
					<year>2000</year>
					<source>Molecular cell biology</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>W. H. Freeman</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">1084</size>
				</element-citation></ref><ref id="pcbi-0040030-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bozdogan</surname><given-names>H</given-names></name></person-group>
					<year>2000</year>
					<article-title>Akaike's information criterion and recent developments in information complexity.</article-title>
					<source>J Math Psychol</source>
					<volume>44</volume>
					<fpage>62</fpage>
					<lpage>91</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b037"><label>37</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Haunschild</surname><given-names>MD</given-names></name><name name-style="western"><surname>Freisleben</surname><given-names>B</given-names></name><name name-style="western"><surname>Takors</surname><given-names>R</given-names></name><name name-style="western"><surname>Wiechert</surname><given-names>W</given-names></name></person-group>
					<year>2005</year>
					<article-title>Investigating the dynamic behavior of biochemical networks using model families.</article-title>
					<source>Bioinformatics</source>
					<volume>21</volume>
					<fpage>1617</fpage>
					<lpage>1625</lpage>
				</element-citation></ref><ref id="pcbi-0040030-b038"><label>38</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Oppenheim</surname><given-names>AV</given-names></name><name name-style="western"><surname>Willsky</surname><given-names>AS</given-names></name><name name-style="western"><surname>Nawab</surname><given-names>SH</given-names></name></person-group>
					<year>1997</year>
					<source>Signals and systems</source>
					<publisher-loc>Upper Saddle River (New Jersey)</publisher-loc>
					<publisher-name>Prentice Hall</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">957</size>
				</element-citation></ref></ref-list></back></article>