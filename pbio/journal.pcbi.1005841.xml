<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00606</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005841</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune physiology</subject><subj-group><subject>Spleen</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Immune physiology</subject><subj-group><subject>Spleen</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Blood</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Blood</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Blood</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Body fluids</subject><subj-group><subject>Blood</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Bacterial diseases</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Differential equations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Population biology</subject><subj-group><subject>Population metrics</subject><subj-group><subject>Death rates</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Statistical distributions</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Geometry</subject><subj-group><subject>Ellipses</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>An efficient moments-based inference method for within-host bacterial infection dynamics</article-title>
<alt-title alt-title-type="running-head">Efficient moments-based inference for within-host bacterial infection dynamics</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0076-3123</contrib-id>
<name name-style="western">
<surname>Price</surname> <given-names>David J.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Breuzé</surname> <given-names>Alexandre</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dybowski</surname> <given-names>Richard</given-names></name>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Mastroeni</surname> <given-names>Piero</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Restif</surname> <given-names>Olivier</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Veterinary Medicine, University of Cambridge, Cambridge, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>ENSTA-ParisTech, Palaiseau, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Alizon</surname> <given-names>Samuel</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>CNRS, FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">or226@cam.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>11</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>20</day>
<month>11</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>11</issue>
<elocation-id>e1005841</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>4</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>10</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Price et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005841"/>
<abstract>
<p>Over the last ten years, isogenic tagging (IT) has revolutionised the study of bacterial infection dynamics in laboratory animal models. However, quantitative analysis of IT data has been hindered by the piecemeal development of relevant statistical models. The most promising approach relies on stochastic Markovian models of bacterial population dynamics within and among organs. Here we present an efficient numerical method to fit such stochastic dynamic models to <italic>in vivo</italic> experimental IT data. A common approach to statistical inference with stochastic dynamic models relies on producing large numbers of simulations, but this remains a slow and inefficient method for all but simple problems, especially when tracking bacteria in multiple locations simultaneously. Instead, we derive and solve the systems of ordinary differential equations for the two lower-order moments of the stochastic variables (mean, variance and covariance). For any given model structure, and assuming linear dynamic rates, we demonstrate how the model parameters can be efficiently and accurately estimated by divergence minimisation. We then apply our method to an experimental dataset and compare the estimates and goodness-of-fit to those obtained by maximum likelihood estimation. While both sets of parameter estimates had overlapping confidence regions, the new method produced lower values for the division and death rates of bacteria: these improved the goodness-of-fit at the second time point at the expense of that of the first time point. This flexible framework can easily be applied to a range of experimental systems. Its computational efficiency paves the way for model comparison and optimal experimental design.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Recent advancements in technology have meant that microbiologists are producing vast amounts of experimental data. However, statistical methods by which we can analyse that data, draw informative inference, and test relevant hypotheses, are much needed. Here, we present a new, efficient inference tool for estimating parameters of stochastic models, with a particular focus on models of within-host bacterial dynamics. The method relies on matching the two lower-order moments of the experimental data (i.e., mean, variance and covariance), to the moments from the mathematical model. The method is verified, and particular choices justified, through a number of simulation studies. We then apply this moment-based inference method to experimental data, and compare the results with previously published maximum likelihood estimates.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000268</institution-id>
<institution>Biotechnology and Biological Sciences Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>BB/M020193/1</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Restif</surname> <given-names>Olivier</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000268</institution-id>
<institution>Biotechnology and Biological Sciences Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>BB/I002189/1</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Mastroeni</surname> <given-names>Piero</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>Biotechnology and Biological Sciences Research Council grant BB/M020193/1 awarded to OR, and to support DJP. Biotechnology and Biological Sciences Research Council grant BB/I002189/1 awarded to PM, and to support RD (<ext-link ext-link-type="uri" xlink:href="http://www.bbsrc.ac.uk/" xlink:type="simple">http://www.bbsrc.ac.uk/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="16"/>
<table-count count="0"/>
<page-count count="27"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-12-04</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The observed moments from the experimental data, and code required to produce parameter estimates, are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/orestif/SPEEDI.R" xlink:type="simple">https://github.com/orestif/SPEEDI.R</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The elucidation of basic kinetic rates governing bacterial growth during infection (such as division and death rates) has been recognised as an important challenge for over 60 years [<xref ref-type="bibr" rid="pcbi.1005841.ref001">1</xref>]. Thanks to recent technological developments in microbiology, and pushed by growing concern over antimicrobial resistance and the need for new vaccines, the last decade has witnessed rapid progress in the quantification of <italic>in vivo</italic> dynamics of bacterial infection in animal models. Two experimental approaches in particular have shown great promise across multiple pathogen species: isogenic tagging, the focus of this report, and fluorescence dilution, a term encompassing several techniques from which bacterial replication can be inferred [<xref ref-type="bibr" rid="pcbi.1005841.ref002">2</xref>]. Isogenic tagging (IT) consists in generating an arbitrary number of sub-clones of a given bacterial strain, each defined by a unique genetic tag (a predetermined nucleotide sequence) inserted in a non-coding region of the chromosome. When grown together <italic>in vitro</italic> or <italic>in vivo</italic>, every tagged strain behaves identically to the original strain. Their relative frequencies within a bacterial culture can be measured by quantitative qPCR or sequencing of the tagged region. Taken together with the absolute number of viable bacteria (e.g., by plating colonies), changes in the frequencies of the tags within the bacterial population can reveal underlying variations in the rates at which bacteria divide, die and disperse. For example, a constant number of viable bacteria accompanied by a loss of some of the tags in a closed population would indicate that a certain proportion of bacteria have died and been replaced by replication. Likewise, when monitoring tag frequencies in two or more anatomical compartments within animals, a gradual homogenisation among organs can reveal the transfer of bacteria. While some studies have stopped at qualitative interpretations of such empirical patterns [<xref ref-type="bibr" rid="pcbi.1005841.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1005841.ref006">6</xref>], it is possible to quantify underlying processes with the help of mathematical models. Two different types have been used: stochastic population dynamic models to estimate bacterial division, death and migration rates [<xref ref-type="bibr" rid="pcbi.1005841.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1005841.ref012">12</xref>], and population genetic models to estimate bottleneck sizes [<xref ref-type="bibr" rid="pcbi.1005841.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref014">14</xref>]. Our aim is to develop efficient inference methods to deal with the former type of models.</p>
<p>Stochastic birth–death–migration models (a canonical class of Markovian processes [<xref ref-type="bibr" rid="pcbi.1005841.ref015">15</xref>]) are a common choice to analyse IT experiments, and naturally lead to likelihood–based inference, using either maximum likelihood [<xref ref-type="bibr" rid="pcbi.1005841.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>] or Bayesian estimation [<xref ref-type="bibr" rid="pcbi.1005841.ref012">12</xref>]. In a given experiment, assuming that all of the <italic>A</italic> animals sampled at a given time and in given conditions are identical, and that all of the <italic>T</italic> tagged strains infecting each animal act independently of each other and are governed by identical rates, we can treat the <italic>A</italic> × <italic>T</italic> observed strain abundances as independent realisations of a stochastic birth–death–migration process, and calculate the likelihood of any model of interest accordingly. In most published IT studies, bacteria can grow at different rates in different locations within an animal, and migrate from one location to another, generating a network of subpopulations (or metapopulation). This increases the dimensions of both the state variable space (as the model must keep track of the multivariate distribution of bacterial abundance) and the parameter space. Calculating the likelihood of such a model given an experimental dataset requires solving a complex stochastic model, which will rarely be possible analytically. Even a linear birth–death process with a non–Poisson immigration process (representing the transfer of a finite inoculum dose) is sufficient to prevent a fully analytical treatment, and results in a computationally intensive estimation process [<xref ref-type="bibr" rid="pcbi.1005841.ref012">12</xref>]. Alternatively, approximate–likelihood (e.g., iterative filtering [<xref ref-type="bibr" rid="pcbi.1005841.ref016">16</xref>]) or likelihood–free (e.g., approximate Bayesian computation or ABC [<xref ref-type="bibr" rid="pcbi.1005841.ref017">17</xref>]) methods involve the generation of a large number of stochastic simulations of the model of interest, which can be equally time–consuming, even when taking advantage of parallel computation. Although this may not be a problem when fitting a single model to a single dataset, it limits our ability to compare multiple models across complex datasets (typically involving multiple experimental treatments) and, beyond that, use these inference tools for the purpose of optimising experimental design [<xref ref-type="bibr" rid="pcbi.1005841.ref018">18</xref>]. Hence, there is a need for alternative inference methods using suitable approximations to achieve greater gains in computational efficiency.</p>
<p>The dynamics of multivariate Markovian processes can be approximated using moment–closure methods [<xref ref-type="bibr" rid="pcbi.1005841.ref019">19</xref>]. Mathematically, a system of differential equations for the moments of the state variables can be derived analytically from the governing equation of any stochastic model [<xref ref-type="bibr" rid="pcbi.1005841.ref020">20</xref>]. By effectively ignoring the higher moments, a closed, small-dimension system can be derived, allowing fast numerical solution of the lower moments at any time point. Parameter estimation can then be achieved by fitting the first and second order moments of the model to the mean, variance and covariance of the corresponding variables in the data. Apart from a few proof–of–principle studies using simulated chemical reaction data [<xref ref-type="bibr" rid="pcbi.1005841.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1005841.ref023">23</xref>] that show great promise, application to statistical inference from biological data remain scarce. As a rare example, Buchholz et al. [<xref ref-type="bibr" rid="pcbi.1005841.ref024">24</xref>] implemented a moment–based method to solve a multiple T–cell differentiation pathway problem, fitting the moments of a large number of alternative stochastic models to experimental data using a <italic>χ</italic><sup>2</sup> statistic. This suggests that efficient moment–based inference methods should be made more readily available to unleash the full potential of stochastic models in experimental biology.</p>
<p>Our objective is to provide a functional and flexible computational framework to estimate the parameters of stochastic metapopulation models for the within–host dynamics of infection, and demonstrate its application and value to analyse IT studies. The model tracks the probability distribution of the number of copies of a tagged strain of bacteria across a network of anatomical compartments within an animal. The goal is to estimate the bacterial division and death rates within each organ, and migration rates between each pair of compartments. First, we present an algorithm that evaluates the first- and second-order moments of the state variables for arbitrary network structures, and assess its accuracy and speed against a gold standard for stochastic models: the exact Gillespie algorithm. We then compare the accuracy of several inference options against simulated data, and finally apply the most promising method to a likelihood-based method in order to assess the quality of inference and increased computational efficiency. The massive gain in speed compared to likelihood-based inference allows us to use parametric bootstrap to quantify parameter uncertainty and goodness-of-fit. Finally, we provide a re-analysis of a recent dataset on the dynamics of <italic>Salmonella enterica</italic> serovar Typhimurium in the blood, liver and spleen of vaccinated mice [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>]. We also demonstrate how empirically derived noise terms (e.g., caused by imprecise data collection) can be taken into account.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>2.1 Biological context</title>
<p>We consider the general case of a bacterial pathogen inoculated into an animal host where it can potentially reach <italic>n</italic> anatomical compartments—which can be distinct organs, tissues, lumens, or predefined sections thereof. All our examples are motivated by IT experiments in which a set of identical animals receive the same initial inoculum dose in one compartment (e.g., mouth, nose, blood, peritoneum, etc) at time <italic>t</italic> = 0. The inoculum is composed of an even mix of <italic>T</italic> tagged strains. At given times <italic>τ</italic><sub>1</sub>, <italic>τ</italic><sub>2</sub> etc, a subset of <italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, etc animals are chosen at random and euthanised. The abundance of each tagged strain in each of the <italic>n</italic> anatomical compartments of interest is measured. Thus, at a given time <italic>τ</italic><sub><italic>i</italic></sub>, the data consist of a matrix <bold>D</bold><sub><italic>i</italic></sub> with <italic>n</italic> rows by <italic>A</italic><sub><italic>i</italic></sub><italic>T</italic> columns, filled with observed bacterial numbers. From this matrix, we can calculate the observed moments, namely the mean and variance of strain abundance within each compartment, and the covariance between each pair of compartments.</p>
<p>Depending on the experimental procedures, these observations are usually subject to some degree of uncertainty, due to observational error. In general we assume that this error is random with a mean of zero, so that there is no systematic bias; this should be assessed by the researchers who conducted the experiments. As a result, we assume that the observed means are unbiased, but the observed (co)variances may be incorrect. In Section 2.7, we describe how known sources of error can be accounted for as part of the data processing procedure. In addition, there usually is some uncertainty about the actual inoculum dose received by each animal. Variations in the abundance of each strain should be assessed experimentally by testing several inoculum doses: this provides estimates for the initial mean and variance of the number of bacteria with each tag that are present in the target compartment at <italic>t</italic> = 0.</p>
<p>We emphasise a few key assumptions and caveats of the present study, which we review in further detail in the Discussion. First, the variable of interest from a modelling perspective is the abundance of a single tagged strain, rather than the total bacterial load per animal (as the latter can be obtained by adding up individual strains). Indeed, our model framework assumes that, over the time period considered and for a given set of initial conditions, the rates of bacterial division, death and migration <italic>per capita</italic> are independent of the total bacterial load. Second, we assume that all the bacterial cells are governed by identical rates of division, death and migration. While this excludes the case of so–called persister cells (i.e., a subset of bacteria with a much lower division rate than the rest) or similar discrete partition, it is worth noting that the model we describe below does generate stochastic variations in the generation time of bacteria, consistent with empirical distributions of bacterial replication <italic>in vivo</italic> [<xref ref-type="bibr" rid="pcbi.1005841.ref025">25</xref>].</p>
</sec>
<sec id="sec004">
<title>2.2 Stochastic model framework</title>
<p>As a function of time <italic>t</italic> since inoculation, the vector of positive integer state variables <bold><italic>N</italic></bold>(<italic>t</italic>) = {<italic>N</italic><sub>1</sub>(<italic>t</italic>), …, <italic>N</italic><sub><italic>n</italic></sub>(<italic>t</italic>)} represents the simultaneous abundance of bacteria in compartments 1 to <italic>n</italic>. In the context of IT studies, this represents a single tagged strain. Three types of stochastic events drive the bacterial dynamics: division (which adds one bacterium to a given compartment), death (which removes one bacterium from a given compartment) and migration (which moves one bacterium from one compartment to another). Assuming linear transition rates, we have a total of <italic>n</italic> division rates <italic>r</italic><sub><italic>i</italic></sub><italic>N</italic><sub><italic>i</italic></sub> and death rates <italic>k</italic><sub><italic>i</italic></sub><italic>N</italic><sub><italic>i</italic></sub> within organ <italic>i</italic>, and <italic>n</italic>(<italic>n</italic> − 1) migration rates <italic>m</italic><sub><italic>i</italic>,<italic>j</italic></sub><italic>N</italic><sub><italic>i</italic></sub> from compartment <italic>i</italic> to <italic>j</italic>. Note that specific models may assume that some of the parameters are equal to zero, for example if there is no physical connection between given pairs of compartments.</p>
<p>In particular, we consider two geometries, illustrated in <xref ref-type="fig" rid="pcbi.1005841.g001">Fig 1</xref>, corresponding to two typical anatomical topologies of relevance to bacterial infection: a radial network with a central compartment (e.g., bloodstream supplying every organ), and a linear network (e.g., digestive track).</p>
<fig id="pcbi.1005841.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Diagram illustrating the two types of network structure we consider.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>2.3 Computation of the first- and second-order moments</title>
<p>The method we propose for parameter inference relies on the first two moments of the stochastic system. That is, we use only the expected number of bacteria within each compartment, the variance of the number of bacteria within each compartment, and the pair-wise covariances. A simple approach to generating these moments for a particular stochastic system in terms of the model parameters, is given by [<xref ref-type="bibr" rid="pcbi.1005841.ref026">26</xref>]. Letting <bold>λ</bold> = {<italic>r</italic><sub>1</sub><italic>N</italic><sub>1</sub>, …, <italic>r</italic><sub><italic>n</italic></sub><italic>N</italic><sub><italic>n</italic></sub>, <italic>k</italic><sub>1</sub><italic>N</italic><sub>1</sub>, …, <italic>k</italic><sub><italic>n</italic></sub><italic>N</italic><sub><italic>n</italic></sub>, <italic>m</italic><sub>1,2</sub><italic>N</italic><sub>1</sub>, …} be the vector of transition rates, we can write the <italic>h</italic><sup><italic>th</italic></sup> non-central moment of the state of the <italic>i</italic><sup><italic>th</italic></sup> compartment as:
<disp-formula id="pcbi.1005841.e001"><alternatives><graphic id="pcbi.1005841.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>N</mml:mi> <mml:mi>i</mml:mi> <mml:mi>h</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>[</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>h</mml:mi></mml:msup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>h</mml:mi></mml:msup> <mml:mo>]</mml:mo> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>ϕ</italic><sub><italic>j</italic></sub> is a function describing the change of the state for the <italic>j</italic>th transition. In Supplementary Materials (S1.8), we show that this leads to a closed, linear system of differential equations for the first moments. Letting <inline-formula id="pcbi.1005841.e002"><alternatives><graphic id="pcbi.1005841.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>[</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>n</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> be the vector of first moments as a function of time, we can express these differential equations in matrix form as:
<disp-formula id="pcbi.1005841.e003"><alternatives><graphic id="pcbi.1005841.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mo>×</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
which leads to the solution,
<disp-formula id="pcbi.1005841.e004"><alternatives><graphic id="pcbi.1005841.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <bold><italic>M</italic></bold><sub>1</sub>(0) are the initial conditions of the system, <bold>A</bold> is a time-independent matrix containing the model parameters, and <italic>exp</italic> is the matrix exponential function.</p>
<p>Next, let <inline-formula id="pcbi.1005841.e005"><alternatives><graphic id="pcbi.1005841.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>[</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>n</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>j</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>n</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> be the vector of second moments. By applying Duhamel’s formula to the differential equations obtained from <xref ref-type="disp-formula" rid="pcbi.1005841.e001">Eq (1)</xref>, we obtain the following expression for the second-order moments:
<disp-formula id="pcbi.1005841.e006"><alternatives><graphic id="pcbi.1005841.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">C</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">C</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:mo>[</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi mathvariant="bold">C</mml:mi> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:mi mathvariant="bold">B</mml:mi> <mml:mo>×</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">A</mml:mi> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>]</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <bold>B</bold> and <bold>C</bold> are time-independent matrices containing model parameters, and <bold><italic>M</italic></bold><sub>1</sub>(0) and <bold><italic>M</italic></bold><sub>2</sub>(0) are vectors containing the initial moments. Using the numerical method for matrix exponential in [<xref ref-type="bibr" rid="pcbi.1005841.ref027">27</xref>], we can evaluate the first- and second-order moments at any time point. Remarkably, no moment-closure approach is required as the expressions for the second-order moments are independent of higher-order moments. See Supplementary Materials S1.8 for a full derivation.</p>
</sec>
<sec id="sec006">
<title>2.4 Parameter inference by divergence minimisation</title>
<p>Given a dataset consisting of one or more matrices <bold>D</bold> of bacterial counts (as per section 2.1), and a stochastic model (as per section 2.2), we now describe methods to estimate the parameter values of the model that minimise the divergence between the predicted and observed distributions of bacterial abundance, using only the lower moments of those distributions. Specifically, we evaluate the means, variances and covariances of the <italic>N</italic><sub><italic>i</italic></sub> variables at a given time <italic>t</italic>. From the corresponding matrix <bold>D</bold>, we calculate the vector of observed means <bold><italic>μ</italic></bold><sup>(<bold>D</bold>)</sup> and the matrix of observed variance-covariance <bold>V</bold><sup>(<bold>D</bold>)</sup>; and from the model’s solution given a set of parameters <bold><italic>θ</italic></bold>, we compute the vector of predicted means <bold><italic>μ</italic></bold><sup>(<italic>θ</italic>)</sup> and the matrix of predicted variances-covariances <bold>V</bold><sup>(<italic>θ</italic>)</sup> which can be derived from <bold><italic>M</italic></bold><sub>2</sub>(<italic>t</italic>). We compared four common divergence measures: a Chi-Squared metric, and normal approximations to the Mahalanobis distance, the Hellinger distance, and the Kullback-Leibler divergence.</p>
<p>Note that none of the measures below is designed to deal with the particular situation when any of the organs is reported void of bacteria (i.e., <italic>N</italic><sub><italic>i</italic></sub> = 0) in all replicates at a given time point, i.e. if all the observed moments related to that organ are equal to zero. In some experimental systems, this may occur as an artefact of the observation method, e.g., when only a small sample is measured: in this case, it is possible to “correct” the data for sampling biases (see Section 2.7). Otherwise, a simple solution would be to remove the moments relative to that organ from the inference procedure. In some cases, it may make sense to completely remove the empty organ from the model if no meaningful inference can be expected from its inclusion, as illustrated in Section 3.5.</p>
<p>The Chi-Squared metric adds up the squared pairwise-differences between each predicted moment and its corresponding observed moment, each term being scaled by the magnitude of the observed moment. As a result, all moments are effectively treated equally. The expression for this divergence is:
<disp-formula id="pcbi.1005841.e007"><alternatives><graphic id="pcbi.1005841.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mi>χ</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msubsup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>The other three divergence expressions we tested make use of the fact that our chosen statistics <bold><italic>μ</italic></bold> and <bold>V</bold> are moments of distributions. Since we do not establish complete characterisations of the distributions, we decided to borrow the expressions of well-known divergences measures for multivariate normal distributions, as these only require the knowledge of their first and second-order moments. In other words, we compute the divergence between two multivariate normal distributions with respective moments (<bold><italic>μ</italic></bold><sup>(<bold>D</bold>)</sup>, <bold>V</bold><sup>(<bold>D</bold>)</sup>) and (<bold><italic>μ</italic></bold><sup>(<bold><italic>θ</italic></bold>)</sup>, <bold>V</bold><sup>(<bold><italic>θ</italic></bold>)</sup>).</p>
<p>The Mahalanobis distance is measured between each point in the observed data, and the distribution described by the predicted moments. That is, by estimating the parameters we are trying to find the distribution that these data are most likely to have been sampled from. Specifically, each observation <bold><italic>X</italic></bold><sub><bold><italic>j</italic></bold></sub> is given by column <italic>j</italic> of the data matrix <bold>D</bold>. The divergence is obtained by summing the distances to the predicted distribution from every observation:
<disp-formula id="pcbi.1005841.e008"><alternatives><graphic id="pcbi.1005841.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mi>M</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mspace width="4pt"/><mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">X</mml:mi> <mml:mi mathvariant="bold-italic">j</mml:mi></mml:msub></mml:mrow> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>The squared Hellinger distance is given by:
<disp-formula id="pcbi.1005841.e009"><alternatives><graphic id="pcbi.1005841.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>Δ</mml:mo> <mml:mrow><mml:mi>H</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>8</mml:mn></mml:mfrac> <mml:mspace width="4pt"/><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mspace width="4pt"/><mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mspace width="4pt"/><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo form="prefix">log</mml:mo> <mml:mfrac><mml:mrow><mml:mo>|</mml:mo> <mml:mi mathvariant="bold">V</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msqrt><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
where <bold><italic>μ</italic></bold> = <bold><italic>μ</italic></bold><sup>(<italic>θ</italic>)</sup> − <bold><italic>μ</italic></bold><sup>(<bold>D</bold>)</sup> and <inline-formula id="pcbi.1005841.e010"><alternatives><graphic id="pcbi.1005841.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>The Kullback-Leibler divergence from the predicted distribution to the observed one is given by:
<disp-formula id="pcbi.1005841.e011"><alternatives><graphic id="pcbi.1005841.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>Δ</mml:mo> <mml:mi>K</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>[</mml:mo> <mml:mtext>tr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:msup> <mml:mspace width="4pt"/><mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">μ</mml:mi></mml:mrow> <mml:mi>T</mml:mi></mml:msup> <mml:mspace width="4pt"/><mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:msup> <mml:mspace width="4pt"/><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>+</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mi mathvariant="bold">V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where tr(⋅) is the trace operator. The derivations of the Hellinger and Kullback-Leibler divergences are given in Supplementary Materials S1.2.</p>
<p>Even though these expressions may not provide correct estimates of the actual “Mahalanobis distance”, “Hellinger distance” and “Kullback-Leibler divergence” between the data and the predicted distributions (as these are not normally distributed), they still provide adequate divergence measures: they all return positive values which are only equal to zero (hence are minimised) when <bold><italic>μ</italic></bold><sup>(<italic>θ</italic>)</sup> = <bold><italic>μ</italic></bold><sup>(<bold>D</bold>)</sup> and <bold>V</bold><sup>(<italic>θ</italic>)</sup> = <bold>V</bold><sup>(<bold>D</bold>)</sup>, which occurs when the data are drawn from the predicted distribution. Furthermore, we only require that the calculated divergence here is ordered in the same way as the true divergence between these distributions, so that the minimum occurs at the same parameter values. We use these properties for the purpose of parameter inference, given a dataset and a model. The set of parameter values <bold><italic>θ</italic></bold> that minimises the divergence measure is termed the “minimum divergence estimate” (MDE).</p>
<p>All code was written in R [<xref ref-type="bibr" rid="pcbi.1005841.ref028">28</xref>]. We used the <monospace>UObyQA</monospace> optimisation routine in the <monospace>powell</monospace> package [<xref ref-type="bibr" rid="pcbi.1005841.ref029">29</xref>].</p>
</sec>
<sec id="sec007">
<title>2.5 Bootstrap variance estimate</title>
<p>In order to quantify the uncertainty in our parameter estimates conditional on the dynamic model considered, we utilise the parametric bootstrap method (e.g., [<xref ref-type="bibr" rid="pcbi.1005841.ref030">30</xref>]), which can be exploited simply here due to the computational efficiency of the inference approach. Having obtained an MDE, <bold><italic>θ</italic></bold>* for a given data matrix <bold>D</bold> and a given model, we simulate <italic>B</italic> data sets from the model at these parameters (i.e., <bold><italic>x</italic></bold><sup><italic>b</italic></sup> ∼ <italic>f</italic>(<italic>x</italic> ∣ <bold><italic>θ</italic></bold>*), <italic>b</italic> = 1, …, <italic>B</italic>). For each simulation, we estimate the corresponding parameters using the MDE technique (<bold><italic>θ</italic></bold><sup><italic>b</italic></sup>, <italic>b</italic> = 1, …, <italic>B</italic>). These <italic>B</italic> estimated parameters are used to estimate the variance-covariance matrix of the parameter estimates. Subsequently, one can use this matrix to estimate confidence intervals in a number of ways [<xref ref-type="bibr" rid="pcbi.1005841.ref031">31</xref>]. For simplicity, the analysis in Section 3.5 uses the <monospace>ellipse</monospace> package in R [<xref ref-type="bibr" rid="pcbi.1005841.ref032">32</xref>] to obtain approximate 95% confidence intervals of the model parameters (that is, assuming the bootstrapped parameter estimates follow a multivariate normal distribution).</p>
</sec>
<sec id="sec008">
<title>2.6 Model goodness-of-fit</title>
<p>In order to assess the model goodness-of-fit, we once again utilise the parametric bootstrap. Concurrent to calculating the uncertainty estimates using the MDE method, the divergences corresponding to each simulated data set at their estimated parameter values are recorded. These bootstrapped divergences can thus be used to represent the null distribution of divergences for the model at the estimated parameter values—giving a representation of the divergences we should expect from the model at these values. The divergence estimated for the observed data is then compared to the null distribution to obtain a p-value for the hypothesis that the data could have been generated by the model.</p>
</sec>
<sec id="sec009">
<title>2.7 Data analysis with observational noise</title>
<p>A common source of error when fitting a model to experimental data is the observation process. In the type of microbiology experiments considered here, where the data represent bacterial loads in infected animals, there are at least two steps that affect the accuracy of the measurements: sampling (when only part of the bacterial loads are recovered) and and quantitation (the process by which the number of bacterial cells in the samples is measured). For example, in a recent IT experiment [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>], sampling error was modelled as a binomial process (as known fractions of each homogenised organ were plated) and quantitation error was modelled using a log-normal distribution which was estimated empirically using an independent control experiment (in which known numbers of bacterial colonies were processed by qPCR in the same way as bacterial samples extracted from animals in the main experiment). Although both error distributions were centred on the true bacterial numbers (i.e. the mean numbers of bacteria were not biased), the variance and covariance in the reported data would not have been accurate estimates of the variance and covariance within the animals: hence our MDE could be biased if we did not account for observational errors.</p>
<p>In our present reanalysis of those data, we integrate both error terms before performing parameter inference, using the following procedure. Our goal is to propose a simple heuristic which could be applied to any experimental dataset with known (or assumed) observational error distributions. First, we generate a large number of stochastic simulations of the model under a biologically reasonable range of parameter values (i.e. using uniform prior distributions across sensible ranges) to generate “perfect” observations (1. in <xref ref-type="fig" rid="pcbi.1005841.g002">Fig 2</xref>). We then calculate the corresponding “perfect moments” from every simulated dataset (1M. in <xref ref-type="fig" rid="pcbi.1005841.g002">Fig 2</xref>), which we cannot observe from our experimental procedure. Next, we apply the observation noise to the simulated data (2. in <xref ref-type="fig" rid="pcbi.1005841.g002">Fig 2</xref>), as is the case in the experimental procedure, and calculate the corresponding “observed moments” (2M. in <xref ref-type="fig" rid="pcbi.1005841.g002">Fig 2</xref>). We then use linear regression models to establish a relationship between each of the perfect and observed moments (with transformations where appropriate), with weights given by the simulations proximity to the actual observed moments from the experiment. This calibrated regression model is then applied to the moments of the experimental data of interest, in order to estimate the moments of the true, unobserved bacterial loads in the animals. We eventually compute MDE using these corrected moments.</p>
<fig id="pcbi.1005841.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Schematic demonstrating the experimental procedure to obtain the observed moments.</title>
<p>Ideally, we want to observe the “true” moments, however this is not possible due to the observation process. In order to understand the effect of the observation noise on the moments, we simulate the system, add noise consistent with the experimental system, and evaluate the relationship between the “true” and “observed” moments of these simulations. We can thus infer the “true” moments of the system, given our “observed” moments.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g002" xlink:type="simple"/>
</fig>
<p>We note that for some models of the observation process, it may be possible to establish analytic relationships between the “perfect” and “observed” moments using conditional expectation and variance theory (e.g., [<xref ref-type="bibr" rid="pcbi.1005841.ref033">33</xref>]). The choice of suitable correction methods for a given system will depend on both the model complexity and the level of empirical quantification of observation noise.</p>
</sec>
</sec>
<sec id="sec010" sec-type="results">
<title>Results</title>
<p>We begin by demonstrating the speed and accuracy of the computation of the first- and second-order moments for arbitrary network structures, compared to Gillespie simulations. We then assess the four previously mentioned divergence measures to validate our minimum divergence estimation procedure with each model depicted in <xref ref-type="fig" rid="pcbi.1005841.g003">Fig 3</xref>, across a range of parameter values. Finally, we apply our inference method to reanalyse a published experimental dataset, and compare the results with the previous maximum likelihood estimates.</p>
<fig id="pcbi.1005841.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Illustrations of three representative model structures.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g003" xlink:type="simple"/>
</fig>
<sec id="sec011">
<title>3.1 Moment computation</title>
<p>As a proof-of-concept, we compare our proposed computation method of the means, variances and covariances of bacterial loads, with the values derived from large numbers of Gillespie simulations, across a range of model structures and parameter values. Our results illustrate the computational effort required to obtain the same level of accuracy with each method. For each model and each parameter set, we simulated 100 experiments, each consisting of 10, 50, 100, 250, 500, or 1000 replicates (representing the product of the number of animals <italic>A</italic> by the number of tagged strains <italic>T</italic> as per section 2.1) at a given time, without observational error. The initial bacterial loads at <italic>t</italic> = 0 in each replicate experiment were drawn at random from a Poisson distribution, to mimic typical variability in inoculum doses in experiments [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>]. We considered three model structures, illustrated in <xref ref-type="fig" rid="pcbi.1005841.g003">Fig 3</xref>: (a) basic migration-birth-death model, (b) four-compartment radial network, and (c) four-compartment linear network. For each virtual experiment, we calculated the first- and second-order moments of the bacterial loads in two ways at a given time point (<italic>t</italic> = 6 for the basic migration-birth-death model, and <italic>t</italic> = 4 for the four-compartment radial and linear network).</p>
<p>We randomly drew the stated number of initial conditions (ranging from 10 to 1000), and evaluated the moments at the future time point in the following two ways. First, we used Gillespie simulations to progress each initial condition forward to the stated observation time, and then calculated the moments from the collection of simulations. Second, we took the stated number of initial conditions to estimate the moments at time zero, and used these to evaluate the moments at the observation time using Eqs <xref ref-type="disp-formula" rid="pcbi.1005841.e004">(3)</xref> and <xref ref-type="disp-formula" rid="pcbi.1005841.e006">(4)</xref>; we refer to this as the direct moment-calculation method.</p>
<p>Results are included in the Supplementary Materials. Figure S1 in <xref ref-type="supplementary-material" rid="pcbi.1005841.s001">S1 Supplementary Materials</xref> shows that there is still a greater amount of variation in the moments from 1000 Gillespie simulations, compared to the direct approach. Both methods produce more accurate estimates of the moments as experiment size increases, as a direct result of more accurate estimates of the initial distribution of bacteria. Furthermore, the computation time of the Gillespie approach increases exponentially with the number of simulations, while the direct method is consistently more efficient, independent of the size of the experiment (Figure S2 in <xref ref-type="supplementary-material" rid="pcbi.1005841.s001">S1 Supplementary Materials</xref>). Similar patterns are observed for the four-compartment linear (Figure S3 in <xref ref-type="supplementary-material" rid="pcbi.1005841.s001">S1 Supplementary Materials</xref>) and radial (Figure S4 in <xref ref-type="supplementary-material" rid="pcbi.1005841.s001">S1 Supplementary Materials</xref>) network models.</p>
</sec>
<sec id="sec012">
<title>3.2 Divergence measures: Simulation study</title>
<p>Next, we compare the accuracy of MDE among the four candidate divergence measures, using data simulated from the same three model structures as in the previous section and across a range of parameter values. For each model structure and each parameter combination, we ran 100 series of 100 Gillespie simulations from <italic>t</italic> = 0 to each of 8 observation times, representing 800 experiments (each of size 100) with “perfect” observations of the system (i.e., without experimental noise). This process was repeated for a set of different parameter values for each model to represent different scenarios—three representative values for each parameter in the basic model (3<sup>3</sup> = 27 scenarios), and five randomly generated sets of parameters for the four compartment linear and radial networks with parameters. The initial conditions for each simulation, in every scenario, were randomly generated from a Poisson distribution with mean parameter 200. The optimisation routine was initiated at randomly generated conditions each time, with each parameter values drawn independently from a Uniform(0,1) distribution.</p>
<p>From the results of each simulated experiment, we computed the MDE using each of the Chi-Squared, Mahalanobis, Hellinger, and Kullback-Leibler divergences. The performance of each divergence was measured by the mean absolute relative error (MARE). That is, under scenario <italic>s</italic>, with <italic>p</italic> target parameters <bold><italic>θ</italic></bold><sub><italic>s</italic></sub> = (<italic>θ</italic><sub>1<italic>s</italic></sub>, <italic>θ</italic><sub>2<italic>s</italic></sub>, …, <italic>θ</italic><sub><italic>ps</italic></sub>), and estimated parameters <inline-formula id="pcbi.1005841.e012"><alternatives><graphic id="pcbi.1005841.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn> <mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for the <italic>j</italic><sup><italic>th</italic></sup> simulation, the MARE is given by:
<disp-formula id="pcbi.1005841.e013"><alternatives><graphic id="pcbi.1005841.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mrow><mml:msub><mml:mtext>MARE</mml:mtext> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>p</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>p</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:msub><mml:mi>θ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:math></alternatives></disp-formula></p>
<p>
<xref ref-type="fig" rid="pcbi.1005841.g004">Fig 4</xref> displays the average error across each scenario for the four divergence measures, at a range of observation times, for each of the three models under consideration. We can see that both the Hellinger and Kullback-Leibler divergence measures perform considerably better than the Chi-Squared and Mahalanobis divergences for the Basic, Linear and Radial networks. The similar performance of the Hellinger and Kullback-Leibler divergences is not unexpected, due to their relationship. We observe a marginal advantage in favour of the Kullback-Leibler divergence for the basic and radial network, and thus we use the Kullback-Leibler divergence in analysing experimental data in Section 3.5. The results aggregated by scenario for each model are shown in Supplementary Materials S1.4.</p>
<fig id="pcbi.1005841.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The average mean absolute relative error (MARE) across a number of observation times, for the two-compartment network (top panel), the linear four-compartment network (middle panel) and the radial four-compartment network (bottom panel).</title>
<p>Each point is the average for that measure, at that observation time, with error bars representing the standard error.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g004" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1005841.g005">Fig 5</xref> further illustrates the distribution of parameter estimates for a few selected scenarios (i.e. combinations of parameter values) and time points. For each time point, the variation was generated by the stochastic birth-death-migration process, demonstrating the level of uncertainty in parameter estimates due to the biological process itself. In this case, each simulated experiment was made up of 100 simulations; fewer replicates would increase the parameter uncertainty. At each time point, the estimates of the migration rate <italic>m</italic><sub>12</sub> are much less variable than those of the killing rate <italic>k</italic><sub>2</sub> and replication rate <italic>r</italic><sub>2</sub>, reflecting properties of the particular model structure rather than the inference method itself. Indeed, in the absence of division and death in compartment 1, the number of bacteria observed in compartment 1 contains complete information on the migration rate <italic>m</italic><sub>12</sub>. Meanwhile, the net growth rate in compartment 2 is given by <italic>r</italic><sub>2</sub> − <italic>k</italic><sub>2</sub>, producing a strong positive correlation between the estimates of these two parameters (<xref ref-type="fig" rid="pcbi.1005841.g006">Fig 6</xref>).</p>
<fig id="pcbi.1005841.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Box plots of MDE corresponding to simulated data for two different choices of parameter values (Scenario 4 and 12), at a number of different observation times (1, 4 and 8) of the simple, migration-birth-death model.</title>
<p>The box plots represent 100 parameter estimates corresponding to the 100 simulations, and the red crosses denote the true parameter value.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g005" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005841.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Bivariate plot of MDE corresponding to simulated data for two different choices of parameter values (Scenario 4 and 12), at a number of different observation times (1, 4 and 8) of the simple, migration birth-death model.</title>
<p>The points represent 100 parameter estimates of <italic>r</italic><sub>2</sub> and <italic>k</italic><sub>2</sub> corresponding to the 100 simulations, and the red crosses denote the true parameter value.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g006" xlink:type="simple"/>
</fig>
<p>We also remark that the earlier observation time typically contains more information about the migration rate, whereas the later observation time better captures the replication and killing rates. This is a result of the particular dynamic we are considering, whereby bacteria begin in the first compartment, and steadily move out to the other compartment(s). For a relatively large migration rate, the first compartment is typically close to depleted at later observation times, and thus we obtain a poorer estimate (e.g., Scenario 12, <xref ref-type="fig" rid="pcbi.1005841.g005">Fig 5</xref>). For a smaller migration rate, there will be an optimal observation time that has allowed sufficient numbers of bacteria to have moved out of the first compartment, improving the parameter estimate (e.g., Scenario 4, <xref ref-type="fig" rid="pcbi.1005841.g005">Fig 5</xref>). Results of all scenarios are shown in Supplementary Materials S1.7. Figs <xref ref-type="fig" rid="pcbi.1005841.g007">7</xref> and <xref ref-type="fig" rid="pcbi.1005841.g008">8</xref> show similar results to <xref ref-type="fig" rid="pcbi.1005841.g005">Fig 5</xref>, for the linear and radial examples, respectively.</p>
<fig id="pcbi.1005841.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Box plots of MDE corresponding to simulated data for a random set of parameter values (Scenario 4), at a number of different observation times (1, 4 and 8) of the linear model.</title>
<p>The box plots represent 100 parameter estimates corresponding to the 100 simulations, and the red crosses denote the true parameter value.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g007" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005841.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Box plots of MDE corresponding to simulated data for a random set of parameter values (Scenario 4), at a number of different observation times (1, 4 and 8) of the radial model.</title>
<p>The box plots represent 100 parameter estimates corresponding to the 100 simulations, and the red crosses denote the true parameter value.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g008" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>3.3 Migration in two directions</title>
<p>Many biological systems allow for migration in both directions between any two compartments in the system (e.g., later observations of the <italic>Salmonella</italic> system in [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>] have shown that bacteria migrate back to the blood from the liver and spleen). Here, we consider a three compartment model where there is migration in both directions between two of the compartments, and we are trying to estimate the parameters, <italic>m</italic><sub>12</sub>, <italic>m</italic><sub>13</sub>, <italic>m</italic><sub>21</sub>, <italic>k</italic><sub>2</sub>, <italic>k</italic><sub>3</sub>, <italic>r</italic><sub>2</sub>, <italic>r</italic><sub>3</sub>. Note that this example can be represented as either a radial or linear network. Similar to the migration birth-death model in previous examples, we consider all combinations of two representative parameter values (0.25, 0.50), and observing the process at times <italic>t</italic> = 1, 2, …, 8. Initial conditions are drawn from a Poisson distribution with mean parameter 200, and each experiment consists of 100 replicates (i.e., <italic>A</italic> × <italic>T</italic>). For each scenario (i.e., parameter combination and observation time), 100 experiments were simulated. As we established above that the Kullback-Leibler divergence was best, we only consider parameter estimation with respect to this divergence measure. The performance of the parameter inference is evaluated using the MARE, as before. <xref ref-type="fig" rid="pcbi.1005841.g009">Fig 9</xref> shows the MARE across each observation time for the Kullback-Leibler divergence, and <xref ref-type="fig" rid="pcbi.1005841.g010">Fig 10</xref> demonstrates the parameter estimates for three randomly selected scenarios. The MARE here is consistent with the Kullback-Leibler divergence estimates in the previous example (<xref ref-type="fig" rid="pcbi.1005841.g004">Fig 4</xref>), noting the different number of parameters being estimated. The accuracy of inference on the two reciprocal migration rates (<italic>m</italic><sub>12</sub> and <italic>m</italic><sub>21</sub>) depends on the choice of observation time, as illustrated on <xref ref-type="fig" rid="pcbi.1005841.g010">Fig 10</xref> and S8: in particular, at <italic>t</italic> = 1, very few bacteria have yet migrated both ways (since they all started in compartment 1 at <italic>t</italic> = 0), and the estimation of <italic>m</italic><sub>21</sub> is very sensitive to the model’s stochasticity.</p>
<fig id="pcbi.1005841.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g009</object-id>
<label>Fig 9</label>
<caption>
<title>The average mean absolute relative error (MARE) across a number of observation times, for the three-compartment network with migration in both directions between two compartments.</title>
<p>Each point is the average for that measure, at that observation time, with error bars representing the standard error.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g009" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005841.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Box plots of MDE corresponding to simulated data for a random set of parameter values, at a number of different observation times of the three compartment model with migration in both directions between two compartments.</title>
<p>The box plots represent 100 parameter estimates corresponding to the 100 simulations, and the red crosses denote the true parameter value.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g010" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>3.4 Comparison with maximum likelihood estimation</title>
<p>In order to assess the overall quality of the inference achieved from this minimum divergence estimation technique, we compare the parameter inferences to those obtained via a Maximum Likelihood approach. The full details of the maximum likelihood estimation can be found in [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>]. Briefly, a numerical procedure is used to solve the master equation for a given set of parameter values up to the required observation time. The probability of each observed value is then used to evaluate the likelihood of the observed data. The huge size of the state space in models with two or more compartments poses computational challenges, creating a critical trade-off between computational speed and accuracy. This was addressed by implementing a Runge-Kutta integration algorithm capable of solving large systems (over a million) of simultaneous differential equations. The same optimisation routine as above (<monospace>UObyQA</monospace> optimisation routine in the <monospace>powell</monospace> package [<xref ref-type="bibr" rid="pcbi.1005841.ref029">29</xref>]) was then applied to search across the parameter space for the maximum likelihood estimates (MLE). In this section, we compare the speed and accuracy of the two estimation methods (MDE v. MLE) when applied to simulated data from the simple migration-birth-death model (<xref ref-type="fig" rid="pcbi.1005841.g003">Fig 3a</xref>), before turning to experimental data in the next section.</p>
<p>We generated multiple series of simulations corresponding to different numbers of experimental replicates (<italic>A</italic> × <italic>T</italic> = 24, 40, 80) observation times (<italic>t</italic> = 0.5, 2, 4), with various combinations of three numerical values (0.25, 0.50, 0.75), for parameters <italic>m</italic><sub>12</sub>, <italic>k</italic><sub>2</sub>, <italic>r</italic><sub>2</sub>. For each scenario (i.e., parameter values, experiment size, observation time), 30 series of simulations were produced, and initial conditions were randomly sampled from a Poisson distribution with mean parameter 50. We computed MDE and MLE separately from each simulated dataset, hence producing 30 estimates for each combination of parameters (see Supplementary Materials for complete set of results). We did not consider more complex models, due to the computational burden of the likelihood-based method.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005841.g011">Fig 11</xref> shows the difference in computation time between the moments-based method, and the likelihood-based method, across the different observation times. In particular, solving the moment equations by matrix exponentiation results in computation times independent of the duration of the simulated experiments. In contrast, the likelihood-based method requires solving a very large system of differential equation forward through time, and so the later the observation time, the longer it takes to compute the parameter estimate. Although this could be avoided in the case of the single-compartment migration-birth-death model by deriving the likelihood at the observation time through inversion of the probability generating functions [<xref ref-type="bibr" rid="pcbi.1005841.ref012">12</xref>], such semi-analytical solutions are not available for more complex models. As a result, likelihood-based methods become impractical for data collected several days after inoculation [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>].</p>
<fig id="pcbi.1005841.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Comparison of computation times to obtain MDE and MLE from simulated data.</title>
<p>Each box plot comprises of 2430 runs of each estimation procedure: 30 simulated datasets (of size either 24, 40 or 80) were generated from each of 27 combinations of parameter values (see main text for complete list of combinations). The size of the experiment does not impact the computation time for either method.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g011" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1005841.g012">Fig 12</xref> shows that, across the sets of simulated data, MDE achieves similar or greater accuracy than MLE. Unexpectedly, while the mean absolute relative error (MARE) of MDE decreases as the size of the dataset (number of simulations) increases, the improvement is much less pronounced with MLE. As is visible in <xref ref-type="fig" rid="pcbi.1005841.g012">Fig 12</xref>, there are large subsets of simulations which lead to much better accuracy by MDE than MLE, especially as the number of simulations and their duration increase. Importantly, both methods used the same optimisation routine, either to minimise the divergence or to maximise the likelihood. We should reiterate the algorithm used to compute the likelihood was designed to trade off accuracy for speed: while it should be possible to reduce the MARE discrepancy between the two methods, this could only be achieved by increasing the running time of MLE, which is already far greater than that of the MDE. It is also worth keeping in mind that, no matter how accurate each estimation method is, our aim is to apply them to experimental datasets that typically comprise of under 100 replicate observations per time point [<xref ref-type="bibr" rid="pcbi.1005841.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref012">12</xref>]. As illustrated above in <xref ref-type="fig" rid="pcbi.1005841.g005">Fig 5</xref>, multiple sets of 100 simulations vary sufficiently from each other to generate wide variance in the parameter estimates. In other words, the system’s natural stochasticity hampers the benefits of seeking greater accuracy.</p>
<fig id="pcbi.1005841.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Pairwise comparison of the mean absolute relative error (MARE) achieved by MLE (x axis) or MDE (y axis).</title>
<p>Each dot shows the MARE values for one simulated dataset, grouped by parameter values (colour scale), observation time and sample size (panels). Note that the axes are square-root transformed to improve clarity.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g012" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec015">
<title>3.5 Analysis of experimental data</title>
<sec id="sec016">
<title>Description of the system</title>
<p>Finally, we performed a re-analysis of experimental data from [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>], in which groups of mice received an intravenous dose of <italic>Salmonella enterica</italic> Typhimurium, composed of an even mixture of 8 wildtype isogenic tagged strains (WITS). Bacterial loads and WITS composition were measured in the blood, liver and spleen of 10 mice at each observation time. During the first phase of the WITS experiments (represented by the first two time points at 0.5 and 6 hours post inoculation), the only biologically relevant processes considered are: migration of bacteria from blood to liver or spleen, replication and death inside the liver and the spleen. That is, on state space <inline-formula id="pcbi.1005841.e014"><alternatives><graphic id="pcbi.1005841.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mi mathvariant="script">S</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∣</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>B</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>S</mml:mi></mml:msub> <mml:mo>≥</mml:mo> <mml:mn>0</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, we have the following transition rates:
<disp-formula id="pcbi.1005841.e015"><alternatives><graphic id="pcbi.1005841.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005841.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mrow><mml:mtable><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>c</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>B</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>L</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:msub><mml:mi>n</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>c</italic><sub><italic>L</italic></sub>, <italic>c</italic><sub><italic>S</italic></sub> are the clearance (= migration) rates from the blood into the liver and spleen respectively, <italic>r</italic><sub><italic>L</italic></sub>, <italic>r</italic><sub><italic>S</italic></sub> are the replication rates in the liver and spleen respectively, and <italic>k</italic><sub><italic>L</italic></sub>, <italic>k</italic><sub><italic>S</italic></sub> are the killing rates in the liver and spleen, respectively.</p>
<p>One purpose of the study in [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>] was to compare the effects of two vaccines on the dynamics of infection. Here, we re-analyse two of the experimental groups: an untreated group (naive) who received no vaccine, and a group who received a live-attenuated vaccine (LV). In the naive group, in addition to the clearance, replication and killing rates, we estimated the effective inoculum size <italic>i</italic><sub>0</sub> = <italic>N</italic><sub><italic>B</italic></sub>(0) to account for the possibility that some of the inoculated bacteria failed to initiate an infection process [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>]. In the vaccinated group, no bacteria were recovered from the blood at either of the two observation times, hence we were unable to estimate the corresponding migration rates. Instead we assumed that the transfer of bacteria to the organs was effectively instantaneous, and sought to estimate the effective initial loads in the liver and spleen (i.e., <italic>i</italic><sub><italic>L</italic></sub> = <italic>N</italic><sub><italic>L</italic></sub>(0) and <italic>i</italic><sub><italic>S</italic></sub> = <italic>N</italic><sub><italic>S</italic></sub>(0)), as well as the replication and killing rates. In each case, the inoculum size is assumed to be Poisson distributed.</p>
</sec>
<sec id="sec017">
<title>Parameter estimation with observation noise</title>
<p>We applied the MDE method to estimate the parameters corresponding to these systems, and compared the results to the estimates obtained via the MLE approach, presented in [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>]. Since data were recorded from independent samples at two time points (0.5 and 6h post inoculation), parameter estimation was performed by minimising the sum of the divergences between observed and predicted moments at both time points (see Supplementary Materials section S1.6 for a comparison of alternative methods). Having obtained the MDE parameter estimates, we used the bootstrap approach to calculate uncertainty intervals on the estimates, and assess the model goodness-of-fit.</p>
<p>As described in [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>], the recorded data were subject to observation noise. In particular, only a fraction of some organs were sampled (e.g., as we are not able to fully recover the total amount of blood from an individual mouse), and there was noise introduced via the qPCR. The observed moments were adjusted using the simulation-based, pre-processing procedure described in Section 2.7: we assumed that the form of the sampling was binomial, and the qPCR noise has been previously modelled using a log-Normal distribution [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>]. For example, for the naive group, we sampled 10,000 parameters (<italic>c</italic><sub><italic>L</italic></sub>, <italic>c</italic><sub><italic>S</italic></sub>, <italic>k</italic><sub><italic>L</italic></sub>, <italic>k</italic><sub><italic>S</italic></sub>, <italic>r</italic><sub><italic>L</italic></sub>, <italic>r</italic><sub><italic>S</italic></sub>) each independently from <italic>U</italic>[0, 3], and initial inoculum <italic>i</italic><sub>0</sub> ∼ Poisson(30) (the mean WITS population calculated from plating experiments [<xref ref-type="bibr" rid="pcbi.1005841.ref011">11</xref>]). “Perfect moments” were calculated from simulations of the same size as the experimental data. The corresponding observed moments were then calculated by applying the observation noise model—binomial sampling to represent the fractional sampling of organs within each mouse, and log-Normal noise to represent the qPCR noise—to each simulation, and calculating the moments. The variances were log-transformed for the purpose of the regression models to predict the corresponding perfect moments from those observed from the experiment.</p>
<p><xref ref-type="fig" rid="pcbi.1005841.g013">Fig 13</xref> provides a comparison of the MLE and MDE estimation procedures for the naive and LV experimental groups. The box plots represent the bootstrapped parameter estimates, with the MDE parameter estimate (blue dots), and MLE parameter estimates (red crosses). <xref ref-type="fig" rid="pcbi.1005841.g014">Fig 14</xref> shows the estimated replication and killing rates in both the liver and spleen, for both groups. The cross and dashed ellipse (red) represent the MLE, and the dot and solid ellipse (blue), represent the MDE (where the ellipse is calculated from 1000 bootstrap samples, represented as grey dots). As explained in the previous section, the strong positive correlation between the replication and killing rates within each organ, clearly visible on <xref ref-type="fig" rid="pcbi.1005841.g014">Fig 14</xref>, is characteristic of this system.</p>
<fig id="pcbi.1005841.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g013</object-id>
<label>Fig 13</label>
<caption>
<title/>
<p>Left: Diagram of each model illustrating the relevant compartments, initial conditions, and rates of interest. Right: MDE parameter estimate (blue dot) with box plots of the bootstrapped parameter estimates, and MLE parameter estimate (red cross) with 95% confidence interval (red bars).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g013" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005841.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g014</object-id>
<label>Fig 14</label>
<caption>
<title>Bivariate distributions of replication and killing rates in liver and spleen, for both naive and live-vaccinated groups.</title>
<p>Blue circles are the MDE values, with the blue (solid) ellipses representing the 95% confidence ellipses calculated using the 1000 bootstrap samples (grey points). The red crosses are the MLE values, with red (dashed) ellipse calculated using the hessian evaluated at the MLE.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g014" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec018">
<title>Model goodness-of-fit</title>
<p>In calculating the MDE parameter estimates for the bootstrap samples, we evaluated divergence measures for datasets simulated from the model. Thus, the collection of these divergences provide a suitable representation of the null distribution of divergences under this model. We compared the divergence for our observed data set to this null distribution in order to assess the model goodness-of-fit. <xref ref-type="fig" rid="pcbi.1005841.g015">Fig 15</xref> demonstrates the goodness-of-fit measure for the models fit to the two experimental groups.</p>
<fig id="pcbi.1005841.g015" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g015</object-id>
<label>Fig 15</label>
<caption>
<title>Figures demonstrating the goodness-of-fit of the two models to the respective data sets.</title>
<p>The histogram bars are the bootstrapped estimate of the null distribution of divergences under the model at the estimated parameter values for the respective model. The (blue) vertical dashed-line is the divergence corresponding to the observed data set.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g015" xlink:type="simple"/>
</fig>
<p>The approximate p-values associated with the goodness-of-fit tests for the naive and LV experimental groups are 0.002 and 0.882, respectively. This suggests that the model provides a suitable fit to the vaccinated experimental group; however, there is a non-negligible discrepancy between the model output for the naive group fit, and the observed data. This suggests that some of the assumptions in the original dynamic model may be erroneous; however, revisiting them goes beyond the scope of the present study.</p>
<p>As a further demonstration of the model goodness-of-fit, we compare the model output at each of the estimated parameter sets, to the observed data. <xref ref-type="fig" rid="pcbi.1005841.g016">Fig 16</xref> shows these simulations from each of the MDE and MLE approaches, at each of the 0.5h and 6h observation times, for both the naive and vaccinated experimental groups. Observational noise consistent with that in the experimental data was added to the simulated data (i.e., binomial sampling for observed counts, and log-normal noise consistent with qPCR). The plots indicate that the main source of discrepancy between data and model in the naive-mice group is the distribution of bacterial loads in the blood after 6 hours.</p>
<fig id="pcbi.1005841.g016" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005841.g016</object-id>
<label>Fig 16</label>
<caption>
<title>Observed experimental data for both naive and vaccinated groups, at both observation times, compared to simulations from the model at parameters estimated by both the MLE and MDE methods, in each of the blood (B), liver (L) and spleen (S).</title>
<p>Numbers of bacteria are the sums of eight identical WITS.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.g016" xlink:type="simple"/>
</fig>
</sec>
</sec>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>Discussion</title>
<p>We have described a functional and flexible moments-based method to estimate parameters of stochastic metapopulation models, and applied it to experimental data on within-host bacterial infection dynamics. Compared to simulation-based methods, our technique delivers accurate estimation orders of magnitude faster. Although simulation-based inference has grown in popularity in computational biology—either within likelihood-free [<xref ref-type="bibr" rid="pcbi.1005841.ref017">17</xref>] or approximate-likelihood [<xref ref-type="bibr" rid="pcbi.1005841.ref016">16</xref>] approaches— even with the increasing availability of fast, multi-core computers, algorithms can still take days to converge in multi-parameter and multi-variable problems. While this is not a major issue when fitting a single model to a single dataset, it is a hindrance for more ambitious applications: indeed there is a growing demand in biology for model selection and model-based optimal experimental design, which are much more computationally intensive tasks (e.g., [<xref ref-type="bibr" rid="pcbi.1005841.ref034">34</xref>–<xref ref-type="bibr" rid="pcbi.1005841.ref037">37</xref>]).</p>
<p>In its current form, our method can incorporate any linear, multivariate, continuous-time Markovian model, and fit it to experimental data that include multiple replicates and an arbitrary number of independent time points. These last two characteristics are typical of experimental biology, yet little attention has been given to systems of this form in recent statistical developments. Indeed, many inference methods for stochastic models (for example, driven by applications to epidemiology), target inference from a single time-series [<xref ref-type="bibr" rid="pcbi.1005841.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref038">38</xref>].</p>
<p>In addition, we have provided a worked example for how to correct for observation noise, applicable to any given experimental system. While sampling error is typically taken into account in likelihood-based inference, many inference studies either ignore experimental noise (e.g. [<xref ref-type="bibr" rid="pcbi.1005841.ref024">24</xref>]) or choose arbitrary distributions (e.g. [<xref ref-type="bibr" rid="pcbi.1005841.ref039">39</xref>]). Even if experimental error has limited impact on the mean of the observations, it will affect the variance, with implications for the precision and reliability of statistical inference. The method we demonstrated here is based on pre-processing experimental data to effect an empirical correction of the observation noise. Crucially, it is not limited by mathematical tractability when combining multiple error sources, and it does not slow down the inference computation (i.e., it only needs to be performed once before fitting the model, and the same simulations are also used to adjust the moments of the noisy-simulated data).</p>
<p>The choice of a metric to minimise for likelihood-free inference is a common issue in computational statistics, especially in the context of increasingly popular ABC methods [<xref ref-type="bibr" rid="pcbi.1005841.ref040">40</xref>]. When the data and the model output are summarised by multiple statistics, the default option is to use either euclidian distance or a chi-squared type variant. The latter was chosen, for example, in a recent study using moment-based inference to solve a systems-biology problem [<xref ref-type="bibr" rid="pcbi.1005841.ref024">24</xref>]. However, because the summary statistics of interest are the moments of statistical distributions, we hypothesised it would be more informative to use a divergence metric instead. While many divergence measures exist for the purpose of comparing mathematically defined distributions [<xref ref-type="bibr" rid="pcbi.1005841.ref041">41</xref>], we are not aware of standard methods to compute divergence between multivariate distributions generated by complex stochastic processes. Instead, we took a pragmatic approach and used mathematical expressions for the Hellinger distance or the Kullback-Liebler divergence between multivariate normal distributions, because these expressions depend on the first- and second-order moments of the distributions only. Even though the resulting divergence measures are not the actual Hellinger distance or Kullback-Liebler divergence between our observed and predicted distributions, they still outperform the chi-squared metric based on parameter inference accuracy. It is worth noting that, across the three model structures we tested, there was not a single metric that was consistently better than any other, and the differences in accuracy were often relatively small (<xref ref-type="fig" rid="pcbi.1005841.g004">Fig 4</xref>). Depending on the degree of accuracy sought, it may be worth testing these and other metrics against simulations before applying this method to a different experimental system. It is our intention to provide a flexible blueprint that can be tailored to other problems, rather than a one-size-fits-all black box which may prove unreliable as soon as the circumstances change.</p>
<p>The particular molecular technology (isogenic tagging) that motivated the development of this inference method, has become pervasive in the study of within-host dynamics of bacterial infection in the last 10 years (see reviews by [<xref ref-type="bibr" rid="pcbi.1005841.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref042">42</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref043">43</xref>]). Yet, to our knowledge, this is the first attempt to provide a general modelling and inference framework that could be applied to any of these experimental systems. Indeed, previous efforts have been tailored to specific case studies [<xref ref-type="bibr" rid="pcbi.1005841.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1005841.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1005841.ref044">44</xref>] despite asking fundamentally similar questions: how fast are bacteria replicating and dying? How much migration is taking place among organs or tissues? As soon as any two of these dynamic processes are co-occurring, it is not possible to evaluate them based solely on average bacterial loads: it is necessary to obtain reliable estimates of the variance, preferably within a single animal, by quantifying a set of independent and isogenic tags. The first known example goes back 60 years, using two naturally occurring mutants of <italic>S. enterica</italic> that could be distinguished by selective growth medium to investigate colonisation dynamics in mice. Although a wide range of bacterial tagging methods (including antibiotic markers and fluorophores) have been used since, non-coding DNA barcodes have opened new prospects as arbitrarily large numbers of truly isogenic tags can be generated and quantified by sequencing [<xref ref-type="bibr" rid="pcbi.1005841.ref014">14</xref>]. It is our hope that the inference framework presented here will contribute to the field’s extension by providing much needed analytical support to analyse and design microbiology experiments.</p>
</sec>
<sec id="sec020">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005841.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005841.s001" xlink:type="simple">
<label>S1 Supplementary Materials</label>
<caption>
<title>Supporting derivations, simulation studies, and figures.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank the many microbiologists whose collaboration has helped initiate and shape this study, including Andrew Grant, Eric Harvill, Emma Slack, Chris Coward and Duncan Maskell. We are also grateful to fellow modellers Roland Regoes, Simon Frost, Julia Gog and Joshua Ross for their technical advice.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005841.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meynell</surname> <given-names>G</given-names></name>. <article-title>Use of superinfecting phage for estimating the division rate of lysogenic bacteria in infected animals</article-title>. <source>Microbiology</source>. <year>1959</year>;<volume>21</volume>(<issue>2</issue>):<fpage>421</fpage>–<lpage>437</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crimmins</surname> <given-names>GT</given-names></name>, <name name-style="western"><surname>Isberg</surname> <given-names>RR</given-names></name>. <article-title>Analyzing microbial disease at high resolution: following the fate of the bacterium during infection</article-title>. <source>Current opinion in microbiology</source>. <year>2012</year>;<volume>15</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>27</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.mib.2011.11.005" xlink:type="simple">10.1016/j.mib.2011.11.005</ext-link></comment> <object-id pub-id-type="pmid">22143042</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barnes</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Bergman</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Mecsas</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Isberg</surname> <given-names>RR</given-names></name>. <article-title>Yersinia pseudotuberculosis disseminates directly from a replicating bacterial pool in the intestine</article-title>. <source>Journal of Experimental Medicine</source>. <year>2006</year>;<volume>203</volume>:<fpage>1591</fpage>–<lpage>1601</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1084/jem.20060905" xlink:type="simple">10.1084/jem.20060905</ext-link></comment> <object-id pub-id-type="pmid">16754724</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schwartz</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Hultgren</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Seed</surname> <given-names>PC</given-names></name>. <article-title>Population dynamics and niche distribution of uropathogenic Escherichia coli during acute and chronic urinary tract infection</article-title>. <source>Infection and immunity</source>. <year>2011</year>;<volume>79</volume>(<issue>10</issue>):<fpage>4250</fpage>–<lpage>4259</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/IAI.05339-11" xlink:type="simple">10.1128/IAI.05339-11</ext-link></comment> <object-id pub-id-type="pmid">21807904</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Walters</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Lane</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Vigil</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>SN</given-names></name>, <name name-style="western"><surname>Walk</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Mobley</surname> <given-names>HLT</given-names></name>. <article-title>Kinetics of uropathogenic <italic>Escherichia coli</italic> metapopulation movement during urinary tract infection</article-title>. <source>mBio</source>. <year>2012</year>;<volume>3</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/mBio.00303-11" xlink:type="simple">10.1128/mBio.00303-11</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lowe</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Ernst</surname> <given-names>SMC</given-names></name>, <name name-style="western"><surname>Zito</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ya</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Glomski</surname> <given-names>IJ</given-names></name>. <article-title>Bacillus anthracis has two independent bottlenecks that are dependent on the portal of entry in an intranasal model of inhalational infection</article-title>. <source>Infection and Immunity</source>. <year>2013</year>;<volume>81</volume>(<issue>12</issue>):<fpage>4408</fpage>–<lpage>4420</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/IAI.00484-13" xlink:type="simple">10.1128/IAI.00484-13</ext-link></comment> <object-id pub-id-type="pmid">24042112</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grant</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Restif</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>McKinley</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Sheppard</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Maskell</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Mastroeni</surname> <given-names>P</given-names></name>. <article-title>Modelling within-host spatiotemporal dynamics of invasive bacterial disease</article-title>. <source>PLoS Biology</source>. <year>2008</year>;<volume>6</volume>:<fpage>e74</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.0060074" xlink:type="simple">10.1371/journal.pbio.0060074</ext-link></comment> <object-id pub-id-type="pmid">18399718</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Melton-Witt</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Rafelski</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Portnoy</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Bakardjiev</surname> <given-names>AI</given-names></name>. <article-title>Oral Infection with Signature-Tagged Listeria monocytogenes Reveals Organ-Specific Growth and Dissemination Routes in Guinea Pigs</article-title>. <source>Infection and Immunity</source>. <year>2012</year>;<volume>80</volume>(<issue>2</issue>):<fpage>720</fpage>–<lpage>732</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/IAI.05958-11" xlink:type="simple">10.1128/IAI.05958-11</ext-link></comment> <object-id pub-id-type="pmid">22083714</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kaiser</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Slack</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Hardt</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>Regoes</surname> <given-names>RR</given-names></name>. <article-title>Lymph node colonization dynamics after oral salmonella typhimurium infection in mice</article-title>. <source>PLoS pathogens</source>. <year>2013</year>;<volume>9</volume>(<issue>9</issue>):<fpage>e1003532</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.1003532" xlink:type="simple">10.1371/journal.ppat.1003532</ext-link></comment> <object-id pub-id-type="pmid">24068916</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kaiser</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Regoes</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Dolowschiak</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wotzka</surname> <given-names>SY</given-names></name>, <name name-style="western"><surname>Lengefeld</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Slack</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Cecum Lymph Node Dendritic Cells Harbor Slow-Growing Bacteria Phenotypically Tolerant to Antibiotic Treatment</article-title>. <source>PLoS Biology</source>. <year>2014</year>;<volume>12</volume>(<issue>2</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.1001793" xlink:type="simple">10.1371/journal.pbio.1001793</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Coward</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Restif</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Dybowski</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Maskell</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Mastoeni</surname> <given-names>P</given-names></name>. <article-title>The Effects of Vaccination and Immunity on Bacterial Infection Dynamics <italic>In Vivo</italic></article-title>. <source>PLOS Pathogens</source>. <year>2014</year>;<volume>10</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.1004359" xlink:type="simple">10.1371/journal.ppat.1004359</ext-link></comment> <object-id pub-id-type="pmid">25233077</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dybowski</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Restif</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Goupy</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Maskell</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Mastroeni</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>AJ</given-names></name>. <article-title>Single passage in mouse organs enhances the survival and spread of Salmonella enterica</article-title>. <source>Journal of the Royal Society, Interface / the Royal Society</source>. <year>2015</year>;<volume>12</volume>(<issue>113</issue>):<fpage>20150702</fpage>–. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2015.0702" xlink:type="simple">10.1098/rsif.2015.0702</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Trzciński</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>. <article-title>Within-host selection is limited by an effective population of Streptococcus pneumoniae during nasopharyngeal colonization</article-title>. <source>Infection and immunity</source>. <year>2013</year>;<volume>81</volume>(<issue>12</issue>):<fpage>4534</fpage>–<lpage>4543</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/IAI.00527-13" xlink:type="simple">10.1128/IAI.00527-13</ext-link></comment> <object-id pub-id-type="pmid">24082074</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Abel zur Wiesch</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Waldor</surname> <given-names>MK</given-names></name>. <article-title>Sequence tag-based analysis of microbial population dynamics</article-title>. <source>Nat Methods</source>. <year>2015</year>;<volume>12</volume>(<issue>3</issue>):<fpage>223</fpage>–<lpage>6</lpage>, 3 p following 226. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3253" xlink:type="simple">10.1038/nmeth.3253</ext-link></comment> <object-id pub-id-type="pmid">25599549</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crawford</surname> <given-names>FW</given-names></name>, <name name-style="western"><surname>Suchard</surname> <given-names>Ma</given-names></name>. <article-title>Transition probabilities for general birth-death processes with applications in ecology, genetics, and evolution</article-title>. <source>Journal of mathematical biology</source>. <year>2012</year>;<volume>65</volume>(<issue>3</issue>):<fpage>553</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00285-011-0471-z" xlink:type="simple">10.1007/s00285-011-0471-z</ext-link></comment> <object-id pub-id-type="pmid">21984359</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>King</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ionides</surname> <given-names>EL</given-names></name>. <article-title>Statistical Inference for Partially Observed Markov Processes via the R Package pomp</article-title>. <source>Journal of Statistical Software</source>. <year>2015</year>;<volume>59</volume>(<issue>10</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Liepe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kirk</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Filippi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Toni</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Barnes</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>MPH</given-names></name>. <article-title>A framework for parameter estimation and model selection from experimental data in systems biology using approximate Bayesian computation</article-title>. <source>Nature protocols</source>. <year>2014</year>;<volume>9</volume>(<issue>2</issue>):<fpage>439</fpage>–<lpage>56</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nprot.2014.025" xlink:type="simple">10.1038/nprot.2014.025</ext-link></comment> <object-id pub-id-type="pmid">24457334</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ryan</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Drovandi</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Pettitt</surname> <given-names>AN</given-names></name>. <article-title>Optimal Bayesian Experimental Design for Models with Intractable Likelihoods Using Indirect Inference Applied to Biological Process Models</article-title>. <source>Bayesian Analysis</source>. <year>2016</year>;<volume>11</volume>(<issue>3</issue>):<fpage>857</fpage>–<lpage>883</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/15-BA977" xlink:type="simple">10.1214/15-BA977</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>CS</given-names></name>. <article-title>Moment-closure approximations for mass-action models</article-title>. <source>IET Systems Biology</source>. <year>2009</year>;<volume>3</volume>(<issue>1</issue>):<fpage>52</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1049/iet-syb:20070031" xlink:type="simple">10.1049/iet-syb:20070031</ext-link></comment> <object-id pub-id-type="pmid">19154084</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sotiropoulos</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kaznessis</surname> <given-names>YN</given-names></name>. <article-title>Analytical derivation of moment equations in stochastic chemical kinetics</article-title>. <source>Chemical Engineering Science</source>. <year>2011</year>;<volume>66</volume>(<issue>3</issue>):<fpage>268</fpage>–<lpage>277</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ces.2010.10.024" xlink:type="simple">10.1016/j.ces.2010.10.024</ext-link></comment> <object-id pub-id-type="pmid">21949443</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Singh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hespanha</surname> <given-names>JP</given-names></name>. <article-title>Approximate Moment Dynamics for Chemically Reacting Systems</article-title>. <source>IEEE Transactions on Automatic Control</source>. <year>2011</year>;<volume>56</volume>(<issue>2</issue>):<fpage>414</fpage>–<lpage>418</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TAC.2010.2088631" xlink:type="simple">10.1109/TAC.2010.2088631</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smadbeck</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kaznessis</surname> <given-names>YN</given-names></name>. <article-title>A closure scheme for chemical master equations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>35</issue>):<fpage>14261</fpage>–<lpage>14265</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1306481110" xlink:type="simple">10.1073/pnas.1306481110</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lakatos</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ale</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kirk</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>MP</given-names></name>. <article-title>Multivariate moment closure techniques for stochastic kinetic models</article-title>. <source>The Journal of chemical physics</source>. <year>2015</year>;<volume>143</volume>(<issue>9</issue>):<fpage>094107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.4929837" xlink:type="simple">10.1063/1.4929837</ext-link></comment> <object-id pub-id-type="pmid">26342359</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buchholz</surname> <given-names>VR</given-names></name>, <name name-style="western"><surname>Flossdorf</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hensel</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Kretschmer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Weissbrich</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gräf</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Disparate individual fates compose robust CD8+ T cell immunity</article-title>. <source>Science</source>. <year>2013</year>;<volume>340</volume>(<issue>6132</issue>):<fpage>630</fpage>–<lpage>635</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1235454" xlink:type="simple">10.1126/science.1235454</ext-link></comment> <object-id pub-id-type="pmid">23493420</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Claudi</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Spröte</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Chirkova</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Personnic</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Zankl</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schürmann</surname> <given-names>N</given-names></name>, <etal>et al</etal>. <article-title>Phenotypic variation of Salmonella in host tissues delays eradication by antimicrobial chemotherapy</article-title>. <source>Cell</source>. <year>2014</year>;<volume>158</volume>(<issue>4</issue>):<fpage>722</fpage>–<lpage>733</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2014.06.045" xlink:type="simple">10.1016/j.cell.2014.06.045</ext-link></comment> <object-id pub-id-type="pmid">25126781</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref026">
<label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Singh A, Hespanha JP. Moment Closure Techniques for Stochastic Models in Population Biology. Proceedings of the 2006 American Control Conference. 2006;.</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Van Loan</surname> <given-names>CF</given-names></name>. <article-title>Computing Integrals Involving the Matrix Exponential</article-title>. <source>IEEE Transactions on Automatic Control</source>. <year>1978</year>;<volume>23</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1109/TAC.1978.1101743" xlink:type="simple">10.1109/TAC.1978.1101743</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref028">
<label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>; <year>2016</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/" xlink:type="simple">https://www.R-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref029">
<label>29</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Powell</surname> <given-names>MJD</given-names></name>. <source>UOBYQA: unconstrained optimization by quadratic approximation</source>. <publisher-name>University of Cambridge</publisher-name>; <year>2000</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Efron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <article-title>Bootstrap Methods for Standard Errors, Confidence Intervals, and Other Measures of Statistical Accuracy</article-title>. <source>Statistical Science</source>. <year>1986</year>;<volume>1</volume>(<issue>1</issue>):<fpage>54</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/ss/1177013817" xlink:type="simple">10.1214/ss/1177013817</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hall</surname> <given-names>P</given-names></name>. <article-title>On the Bootstrap and Likelihood-Based Confidence Regions</article-title>. <source>Biometrika</source>. <year>1987</year>;<volume>74</volume>(<issue>3</issue>):<fpage>481</fpage>–<lpage>493</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/biomet/74.3.481" xlink:type="simple">10.1093/biomet/74.3.481</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref032">
<label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Murdoch D, Chow ED. ellipse: Functions for drawing ellipses and ellipse-like confidence regions; 2013. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=ellipse" xlink:type="simple">https://CRAN.R-project.org/package=ellipse</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref033">
<label>33</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Casella</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>RL</given-names></name>. <source>Statistical Inference</source>. <edition>2nd ed</edition>. <publisher-name>Duxbury</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Busetto</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Hauser</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Krummenacher</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sunnåker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dimopoulos</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ong</surname> <given-names>CS</given-names></name>, <etal>et al</etal>. <article-title>Near-optimal experimental design for model selection in systems biology</article-title>. <source>Bioinformatics</source>. <year>2013</year>;<volume>29</volume>(<issue>20</issue>):<fpage>2625</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt436" xlink:type="simple">10.1093/bioinformatics/btt436</ext-link></comment> <object-id pub-id-type="pmid">23900189</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Price</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Bean</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Ross</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Tuke</surname> <given-names>J</given-names></name>. <article-title>On the efficient determination of optimal Bayesian experimental designs using ABC: A case study in optimal observation of epidemics</article-title>. <source>Journal of Statistical Planning and Inference</source>. <year>2016</year>;<volume>172</volume>:<fpage>1</fpage>–<lpage>15</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jspi.2015.12.008" xlink:type="simple">http://dx.doi.org/10.1016/j.jspi.2015.12.008</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Overstall</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Woods</surname> <given-names>DC</given-names></name>. <article-title>Bayesian Design of Experiments using Approximate Coordinate Exchange</article-title>. <source>Technometrics</source>. <year>2016</year>;</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ryan</surname> <given-names>EG</given-names></name>, <name name-style="western"><surname>Drovandi</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>McGree</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Pettitt</surname> <given-names>AN</given-names></name>. <article-title>A Review of Modern Computational Algorithms for Bayesian Optimal Design</article-title>. <source>International Statistics Review</source>. <year>2016</year>;<volume>84</volume>(<issue>1</issue>):<fpage>128</fpage>–<lpage>154</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/insr.12107" xlink:type="simple">10.1111/insr.12107</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Toni</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Welch</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Strelkowa</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ipsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stumpf</surname> <given-names>MPH</given-names></name>. <article-title>Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2009</year>;<volume>6</volume>(<issue>31</issue>):<fpage>187</fpage>–<lpage>202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2008.0172" xlink:type="simple">10.1098/rsif.2008.0172</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>House</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ford</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bilson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Buckingham-Jeffery</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Girolami</surname> <given-names>M</given-names></name>. <article-title>Bayesian uncertainty quantification for transmissibility of influenza, norovirus and Ebola using information geometry</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2016</year>;<volume>13</volume>(<issue>121</issue>):<fpage>20160279</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2016.0279" xlink:type="simple">10.1098/rsif.2016.0279</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sunnåker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Busetto</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Numminen</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Corander</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Foll</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dessimoz</surname> <given-names>C</given-names></name>. <article-title>Approximate Bayesian Computation</article-title>. <source>PLOS Computational Biology</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref041">
<label>41</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pardo</surname> <given-names>L</given-names></name>. <source>Statistical inference based on divergence measures</source>. <publisher-name>CRC Press</publisher-name>; <year>2005</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005841.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mastroeni</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Grant</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Restif</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Maskell</surname> <given-names>DJ</given-names></name>. <article-title>A dynamic view of the spread and intracellular distribution of Salmonella enterica</article-title>. <source>Nature Reviews Microbiology</source>. <year>2009</year>;<volume>7</volume>:<fpage>73</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrmicro2034" xlink:type="simple">10.1038/nrmicro2034</ext-link></comment> <object-id pub-id-type="pmid">19079353</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Abel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Abel zur Wiesch</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Waldor</surname> <given-names>MK</given-names></name>. <article-title>Analysis of Bottlenecks in Experimental Models of Infection</article-title>. <source>PLoS Pathog</source>. <year>2015</year>;<volume>11</volume>(<issue>6</issue>):<fpage>e1004823</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.1004823" xlink:type="simple">10.1371/journal.ppat.1004823</ext-link></comment> <object-id pub-id-type="pmid">26066486</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005841.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lim</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Voedisch</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wahl</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Rouf</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Geffers</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rhen</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Independent Bottlenecks Characterize Colonization of Systemic Compartments and Gut Lymphoid Tissue by Salmonella</article-title>. <source>PLoS Pathog</source>. <year>2014</year>;<volume>10</volume>(<issue>7</issue>):<fpage>e1004270</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.ppat.1004270" xlink:type="simple">10.1371/journal.ppat.1004270</ext-link></comment> <object-id pub-id-type="pmid">25079958</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>