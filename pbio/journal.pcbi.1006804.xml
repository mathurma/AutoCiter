<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01744</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006804</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Soil science</subject><subj-group><subject>Soil perturbation</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Electromagnetic radiation</subject><subj-group><subject>Light</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Materials science</subject><subj-group><subject>Materials</subject><subj-group><subject>Crystals</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cell processes</subject><subj-group><subject>Cell cycle and cell division</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Condensed matter physics</subject><subj-group><subject>Solid state physics</subject><subj-group><subject>Crystallography</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Sensory perception</subject><subj-group><subject>Vision</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>A local measure of symmetry and orientation for individual spikes of grid cells</article-title>
<alt-title alt-title-type="running-head">Measuring local symmetry and orientation of grid cell patterns</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1169-9879</contrib-id>
<name name-style="western">
<surname>Weber</surname> <given-names>Simon N.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Sprekeler</surname> <given-names>Henning</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"/>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Modelling of Cognitive Processes, Institute of Software Engineering and Theoretical Computer Science, Technische Universität Berlin, Germany</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Battaglia</surname> <given-names>Francesco P.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Radboud Universiteit Nijmegen, NETHERLANDS</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">h.sprekeler@tu-berlin.de</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>7</day>
<month>2</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>2</issue>
<elocation-id>e1006804</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>10</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>18</day>
<month>1</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Weber, Sprekeler</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006804"/>
<abstract>
<p>Grid cells have attracted broad attention because of their highly symmetric hexagonal firing patterns. Recently, research has shifted its focus from the global symmetry of grid cell activity to local distortions both in space and time, such as drifts in orientation, local defects of the hexagonal symmetry, and the decay and reappearance of grid patterns after changes in lighting condition. Here, we introduce a method that allows to visualize and quantify such local distortions, by assigning both a local grid score and a local orientation to each individual spike of a neuronal recording. The score is inspired by a standard measure from crystallography, which has been introduced to quantify local order in crystals. By averaging over spikes recorded within arbitrary regions or time periods, we can quantify local variations in symmetry and orientation of firing patterns in both space and time.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Grid cells are neurons in mammals whose activity depends on the location of the animal in a striking way: grid cells fire spikes at multiple locations that form a symmetric lattice of repeating hexagons. Recent experiments have shown that the symmetry of these patterns is not as stable as initially thought. For example, patterns show local distortions or drifts in orientation. Here, we propose a method to visualize and quantify such local distortions directly from the recorded spike locations. Our method is inspired by an approach used in crystallography and we show that it reliably detects distortions in grid patterns. Moreover, we demonstrate that it can be used to study the stability of grid patterns not only in space, but also in time. Our method enables researchers to analyze the spatial symmetry of neuronal activity in more detail and could thus contribute to the understanding of spatial representations in mammals.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100002347</institution-id>
<institution>Bundesministerium für Bildung und Forschung</institution>
</institution-wrap>
</funding-source>
<award-id>FKZ 01GQ1201</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Sprekeler</surname> <given-names>Henning</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This study was funded by the German Ministry of Education and Research (BMBF, grant: FKZ 01GQ1201). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-02-20</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Python code of the method is available from our repository <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/simonweber/gridscore" xlink:type="simple">https://gitlab.com/simonweber/gridscore</ext-link> under the GNU General Public License v3.0. We also encourage readers to try the suggested grid score on their own data on our website: <ext-link ext-link-type="uri" xlink:href="http://gridscore.cognition.tu-berlin.de/" xlink:type="simple">http://gridscore.cognition.tu-berlin.de/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Neurons in the entorhinal cortex are often classified based on their spatial firing patterns. Grid cells, in particular, have attracted a lot of attention, because of their highly symmetric hexagonal activity [<xref ref-type="bibr" rid="pcbi.1006804.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref002">2</xref>]. To decide whether a given cell should be classified as a grid cell or a non-grid cell [<xref ref-type="bibr" rid="pcbi.1006804.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1006804.ref005">5</xref>], researchers need a grid score: a number that quantifies the degree of hexagonal spatial symmetry in the firing pattern of the cell. Since the first reports of grid cells, the community has developed and refined a standard grid score [<xref ref-type="bibr" rid="pcbi.1006804.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006804.ref009">9</xref>], which relies on the following procedure. Spike locations are transformed into a rate map. The peaks in the spatial autocorrelogram of this rate map are used to obtain measures of the grid spacing and the grid orientation. The autocorrelogram of the rate map is then cropped, rotated and correlated with its unrotated copy. A grid score is finally obtained from the resulting correlation-vs-angle function at selected angles (for details, see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref>). This procedure assumes a consistent hexagonal pattern throughout the arena and results in a single grid score for the entire firing pattern.</p>
<p>While this grid score has many benefits, it is inherently global and ignores local properties of firing patterns. Recent studies have shown, however, that the firing patterns of grid cells show interesting local effects, such as drifts in orientation [<xref ref-type="bibr" rid="pcbi.1006804.ref010">10</xref>] or local defects of the hexagonal symmetry [<xref ref-type="bibr" rid="pcbi.1006804.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref012">12</xref>]. These results call for new methods for quantifying the <italic>local symmetry</italic> and the <italic>local orientation</italic> of grids.</p>
<p>Here, we introduce a method that assigns both a grid score and an orientation to <italic>each individual spike</italic> of a neuronal recording. This spike-based score is inspired by a standard measure from crystallography [<xref ref-type="bibr" rid="pcbi.1006804.ref013">13</xref>], which has been introduced to quantify local order in crystals. By averaging over spikes recorded within arbitrary regions or time periods, we can quantify local variations in symmetry and orientation of firing patterns in both space and time. A high spatial and temporal resolution can be achieved by averaging over multiple cells.</p>
<p>To illustrate the potential of our method, we apply it to both artificially generated data and neuronal recordings from grid cells. In the following, we first introduce the method in detail. Comparing it to the conventional correlogram-based grid score [<xref ref-type="bibr" rid="pcbi.1006804.ref007">7</xref>], we show that both methods perform similarly when quantifying and classifying grid properties globally. We then illustrate the benefits of our spike-based score to analyze and visualize local properties of spike patterns in space and time.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<p>The suggested grid score relies on a measure that is used to describe symmetry in crystals [<xref ref-type="bibr" rid="pcbi.1006804.ref013">13</xref>]. Neuronal recordings differ from crystalline arrangements of atoms in several respects and therefore call for some modifications. Firstly, crystals form a symmetric arrangement of neighboring atoms, whereas grid cells show a symmetric arrangement not of spike locations, but of firing fields, each of which corresponds to many spikes. This requires a modified definition of neighborhood. Secondly, crystals consist of many atoms, which show rare deviations from a symmetric arrangement. In contrast, grid cells show relatively few firing fields in an often highly non-symmetric arrangement. This requires a modification to avoid false positives arising from other symmetries. In the following, we first describe the basic idea of the score and then introduce the modifications that are necessary to adjust it to neuronal recordings.</p>
<p><italic>Python</italic> code of the method is available from our repository <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/simonweber/gridscore" xlink:type="simple">https://gitlab.com/simonweber/gridscore</ext-link> [<xref ref-type="bibr" rid="pcbi.1006804.ref014">14</xref>] under the GNU General Public License v3.0. We also encourage readers to try the suggested grid score on their own data on our website: <ext-link ext-link-type="uri" xlink:href="http://gridscore.cognition.tu-berlin.de/" xlink:type="simple">http://gridscore.cognition.tu-berlin.de/</ext-link>.</p>
<sec id="sec003">
<title>Measuring M-fold symmetry in crystals</title>
<p>The angular symmetry of an arrangement of <italic>N</italic> neighbors around a given atom in a crystal can be quantified by a complex number [<xref ref-type="bibr" rid="pcbi.1006804.ref013">13</xref>]:
<disp-formula id="pcbi.1006804.e001"><alternatives><graphic id="pcbi.1006804.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:msup><mml:mi>ψ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>≔</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mi>M</mml:mi> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>i</italic> is the imaginary unit and <italic>ϕ</italic><sub><italic>l</italic></sub> is the angle between an arbitrary reference vector and the vector pointing from the atom in question to its <italic>l</italic>-th neighbor [<xref ref-type="bibr" rid="pcbi.1006804.ref013">13</xref>]. In the following, we will use the horizontal axis from left to right as the reference vector (<xref ref-type="fig" rid="pcbi.1006804.g001">Fig 1a</xref>). <italic>M</italic> is a natural number that characterizes the symmetry of interest. For instance, <italic>M</italic> = 6 corresponds to a hexagonal arrangement of atoms and <italic>M</italic> = 4 to a quadratic arrangement. The computation of this score can be visualized as an addition of vectors in the complex plane (<xref ref-type="fig" rid="pcbi.1006804.g001">Fig 1a</xref>).</p>
<fig id="pcbi.1006804.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006804.g001</object-id>
<label>Fig 1</label>
<caption>
<title>A spike-based grid score.</title>
<p><bold>a)</bold> Illustration of the <italic>ψ</italic> measure for 6-fold symmetry. Left: A reference ‘atom’ (black disc) with four neighbors (colored discs). Arcs show the angles, <italic>ϕ</italic><sub><italic>l</italic></sub>, to a reference axis (dashed black line) for all neighbors <italic>l</italic> ∈ {1, 2, 3, 4}. The blueish neighbors lie on the corners of a hexagon. The red neighbor is a defect to this hexagonal structure. Right: Sum of four unit vectors with directions given by 6<italic>ϕ</italic><sub><italic>l</italic></sub> (colored arcs). Vectors associated with neighbors that lie on the corners of the same hexagon (blueish colors) point in the same direction. The vector associated with the defect (red) points in a different direction. The length |<italic>ψ</italic>| of the resulting vector, normalized by the number of neighbors (black arrow), quantifies how much the reference atom is embedded in a hexagonal structure. The direction arg(<italic>ψ</italic>) of the vector—divided by 6 to reverse the previous rotation—indicates the orientation of the hexagon. <bold>b)</bold> Detection of the neighborhood shell. Locations of spikes of a grid cell and smoothed histogram of the pairwise distances between all spikes. Dashed lines indicate the automatically detected neighborhood shell. Top: Generated data. Bottom: Experimental recording kindly provided by [<xref ref-type="bibr" rid="pcbi.1006804.ref010">10</xref>]. <bold>c)</bold> Preventing false positives by discarding other symmetries. Example |<italic>ψ</italic><sup>(<italic>M</italic>)</sup>| and <inline-formula id="pcbi.1006804.e002"><alternatives><graphic id="pcbi.1006804.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow/></mml:msub></mml:math></alternatives></inline-formula> values for a spike (black) with few neighbors (blue) in six different configurations. <bold>d)</bold> Same spike maps as in b, color-coded with the spike-based grid score <inline-formula id="pcbi.1006804.e003"><alternatives><graphic id="pcbi.1006804.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (left) and the spike-based orientation <inline-formula id="pcbi.1006804.e004"><alternatives><graphic id="pcbi.1006804.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mtext>arg</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ψ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.g001" xlink:type="simple"/>
</fig>
<p>The absolute value |<italic>ψ</italic><sup>(<italic>M</italic>)</sup>| ranges from 0 to 1, and larger values indicate a more pronounced <italic>M</italic>-fold symmetry. If the <italic>N</italic> neighboring atoms lie on the corners of a regular <italic>M</italic>-polygon, the angle <inline-formula id="pcbi.1006804.e005"><alternatives><graphic id="pcbi.1006804.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>M</mml:mi></mml:mfrac><mml:mtext>arg</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>ψ</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the orientation of this polygon (<xref ref-type="fig" rid="pcbi.1006804.g001">Fig 1a</xref>). The function arg(<italic>x</italic>) maps to values between −<italic>π</italic> and <italic>π</italic> radians, so the resulting orientation is between −<italic>π</italic>/<italic>M</italic> and <italic>π</italic>/<italic>M</italic>. For hexagonal symmetry, this corresponds to values between −30 and 30 degrees.</p>
</sec>
<sec id="sec004">
<title>Defining the neighborhood of a spike</title>
<p>The <italic>ψ</italic> measure has been introduced to quantify symmetry in crystalline structures where <italic>neighborhood</italic> is clearly defined. For example, the nearest neighbors of a reference atom are all atoms within a distance of one lattice constant. For a given spike in a grid pattern, however, the nearest neighbors are most likely other spikes from the same grid field. To assess whether a given spike is part of a symmetric grid, we are hence interested not in neighboring spikes, but in spikes in neighboring grid fields, i.e., spikes that are roughly one grid spacing away from the spike in question. To identify these relevant spikes, we define a <italic>neighborhood shell</italic>—a two dimensional annulus (<xref ref-type="fig" rid="pcbi.1006804.g001">Fig 1b</xref>). We then center this neighborhood shell at the location of the spike in question and consider all spikes within the shell as its neighbors. Assuming that the grid spacing does not change drastically across the environment, we use the same shell size for all spikes.</p>
<p>To identify a suitable size of the shell, we use the histogram of pairwise distances between all spike locations. For periodic firing patterns, this histogram has pronounced peaks (<xref ref-type="fig" rid="pcbi.1006804.g001">Fig 1b</xref>). The first peak characterizes the size of the grid fields. The second peak corresponds to the grid spacing <italic>ℓ</italic>, and further peaks arise at multiples of the grid spacing. We therefore set the inner radius of the neighborhood shell to <inline-formula id="pcbi.1006804.e006"><alternatives><graphic id="pcbi.1006804.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mfrac><mml:mn>5</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mi>ℓ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and the outer radius to <inline-formula id="pcbi.1006804.e007"><alternatives><graphic id="pcbi.1006804.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mfrac><mml:mn>7</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mi>ℓ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1006804.g001">Fig 1b</xref>). To reduce the noise arising from finite numbers of spikes, we determine the peaks from a smoothed histogram, obtained by applying a Gaussian filter with a standard deviation of 1% of the maximal pairwise distance. The suggested shell width of <inline-formula id="pcbi.1006804.e008"><alternatives><graphic id="pcbi.1006804.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>3</mml:mn></mml:mfrac> <mml:mi>ℓ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is motivated by the typical size of grid fields, but the suggested grid score is robust to changes of the shell width. Scaling the shell width with the grid spacing is commensurate with the experimental finding that the ratio of grid spacing and grid field size is constant [<xref ref-type="bibr" rid="pcbi.1006804.ref015">15</xref>].</p>
<p>The detection of the correct neighborhood shell as the second peak of the histogram of pairwise distances is a crucial step in the computation of the grid score. For noisy grid patterns, the first peak of the histogram—which indicates the size of the grid fields—is sometimes hard to detect, leading to a potential misclassification of the second peak as the first, and consequently a wrong neighborhood shell. In data sets where this is the case, we use the following remedy: We define a rough cutoff distance that is larger than the grid field size and smaller than the grid spacing, and use the first peak above the cutoff to determine the shell size. For the analyzed grid patterns, taking 15% of the side length of the arena for this cutoff worked reliably. In the dataset with very noisy and elliptic grids, peak detection can fail for many cells. In this case, we exploit the fact that nearby grid cells have a similar grid spacing [<xref ref-type="bibr" rid="pcbi.1006804.ref002">2</xref>] and determine the neighborhood shell from less noisy grid cells of the same module. Whenever we use either of these remedies, we highlight it in the main text.</p>
</sec>
<sec id="sec005">
<title>Comparing to other symmetries prevents false positives</title>
<p>A large <inline-formula id="pcbi.1006804.e009"><alternatives><graphic id="pcbi.1006804.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>6</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> value indicates that the neighbors of the <italic>k</italic>-th spike are arranged on the corners of a hexagon, but it does not require that all corners of the hexagon are occupied. If, for example, the firing fields of a cell are arranged on a line, this leads to high |<italic>ψ</italic><sup>(6)</sup>| values although the structure does not resemble a grid (<xref ref-type="fig" rid="pcbi.1006804.g001">Fig 1c</xref>). This can lead to a wrongful classification of a cell as a grid cell, i.e., to false positives. To avoid high local grid scores without an actual 6-fold symmetry, we compute <inline-formula id="pcbi.1006804.e010"><alternatives><graphic id="pcbi.1006804.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mn>M</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> for a range of symmetries (<italic>M</italic> ∈ {2, …, 7}) and only assign a non-zero grid score to spike <italic>k</italic> if the hexagonal symmetry is the strongest:
<disp-formula id="pcbi.1006804.e011"><alternatives><graphic id="pcbi.1006804.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>k</mml:mi></mml:msub><mml:mi>≔</mml:mi><mml:mo>{</mml:mo><mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>|</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext><mml:mspace width="4pt"/><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>6</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>|</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msubsup><mml:mi>ψ</mml:mi><mml:mi>k</mml:mi><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>|</mml:mo></mml:mrow><mml:mspace width="1.em"/><mml:mo>∀</mml:mo><mml:mi>M</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mo>,</mml:mo><mml:mn>3</mml:mn><mml:mo>,</mml:mo><mml:mn>4</mml:mn><mml:mo>,</mml:mo><mml:mn>5</mml:mn><mml:mo>,</mml:mo><mml:mn>7</mml:mn></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
We refer to <inline-formula id="pcbi.1006804.e012"><alternatives><graphic id="pcbi.1006804.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> as the <italic>grid score of spike</italic> <italic>k</italic>. Comparing to symmetries with <italic>M</italic> &gt; 7 did not have an effect on our results, so we restricted <italic>M</italic> to a maximum of 7.</p>
<p>A global grid score <italic>Ψ</italic> and the global grid orientation Θ for a given cell is calculated by averaging over the respective properties of the individual spikes. A summary of the algorithm is shown in <xref ref-type="fig" rid="pcbi.1006804.g002">Fig 2</xref>.</p>
<fig id="pcbi.1006804.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006804.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Algorithm to compute spike-based grid scores <inline-formula id="pcbi.1006804.e013"><alternatives><graphic id="pcbi.1006804.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and orientations <italic>θ</italic><sub><italic>k</italic></sub> and their averages Ψ and Θ.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Tools to evaluate the spike-based grid score</title>
<p>In the following, we compare the suggested local grid score to a conventional correlation-based grid score. Details on the calculation of this score, on the shuffling procedure for grid cell classification, and on the generation of artificial spike data can be found in <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref>.</p>
</sec>
</sec>
<sec id="sec007" sec-type="results">
<title>Results</title>
<p>To evaluate the spike-based grid score, we apply it to generated and experimentally recorded firing patterns. We begin by contrasting the mean grid score of all spikes, <italic>Ψ</italic> (see algorithm in <xref ref-type="fig" rid="pcbi.1006804.g002">Fig 2</xref>), and the correlogram-based grid score, <italic>ρ</italic> (see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref> for how the correlogram-based score is computed), and show that they are similarly powerful for quantifying the symmetry of grid patterns and classifying grid cells. We then demonstrate how the individual spike scores, <inline-formula id="pcbi.1006804.e014"><alternatives><graphic id="pcbi.1006804.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (see algorithm in <xref ref-type="fig" rid="pcbi.1006804.g002">Fig 2</xref>), can be used to systematically analyze local distortions of gridness and orientation in space and time.</p>
<sec id="sec008">
<title>The mean of the spike-based score characterizes global grid properties</title>
<p>Grid scores are typically used for two purposes: Quantifying the hexagonality, i.e., the <italic>gridness</italic>, of the spike map and classifying a cell as a grid cell. Given that the patterns of grid cells are rarely perfectly hexagonal, a grid score should classify a cell as a grid cell even if the hexagonal pattern is weakly distorted. For example, a grid score needs to be robust against small shifts of grid field locations or elliptic distortions like shearing. At the same time, a grid score should quantify such distortions by returning lower values for stronger distortions.</p>
<sec id="sec009">
<title>Quantifying gridness</title>
<p>To study the range of values for the <italic>ρ</italic> score and the <italic>Ψ</italic> score, we generate spike locations with different degrees of perturbation by randomly shifting the locations of grid fields arranged on a perfect hexagonal grid (<xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3a and 3b</xref>, see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref> for details). The less hexagonal the arrangement of firing fields, the fewer spikes have a large <inline-formula id="pcbi.1006804.e015"><alternatives><graphic id="pcbi.1006804.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> score (<xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3a</xref>). The Ψ score, i.e., the mean over all spikes, and the correlogram-based <italic>ρ</italic> score, both decay with increasing noise on field locations (<xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3c</xref>, results from 100 random realizations of spike patterns for each noise level). <italic>Ψ</italic> scores are around 0.35 for perfect grids and decrease to zero for random field locations. <italic>ρ</italic> scores are around 1.5 for perfect grids and decrease to −0.5 for random field locations. <italic>Ψ</italic> scores close to 1 are never reached, because many spikes at the edges of grid fields have an individual grid score of <inline-formula id="pcbi.1006804.e016"><alternatives><graphic id="pcbi.1006804.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3a</xref>).</p>
<fig id="pcbi.1006804.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006804.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Quantifying the global symmetry of firing patterns.</title>
<p><bold>a)</bold> Generated spike maps in a 1m × 1m arena. Each spike <italic>k</italic> is color-coded with its grid score <inline-formula id="pcbi.1006804.e017"><alternatives><graphic id="pcbi.1006804.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>; global Ψ score shown above. Top: Perfect grid. Middle: Weakly perturbed grid field locations. Bottom: Strong perturbations. See text for description of perturbations. <bold>b)</bold> Autocorrelograms of the spike maps shown in a; <italic>ρ</italic> score shown above. <bold>c)</bold> Decay of Ψ score (top) and <italic>ρ</italic> score (bottom) with increasing noise on grid field locations. Box plot for 100 random realizations at each noise level. For details on the box plot see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref>. Noise values for the examples shown in a are indicated with markers. <bold>d)</bold> Correlation of Ψ score with <italic>ρ</italic> score and Pearson’s coefficient <italic>r</italic> for the generated data used in a, b, c. <bold>e)</bold> Same as d but with experimentally recorded data from [<xref ref-type="bibr" rid="pcbi.1006804.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref016">16</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.g003" xlink:type="simple"/>
</fig>
<p>The two scores differ in how they react to small and medium perturbations of the field locations. The median of Ψ scores decreases linearly with increasing standard deviation of the grid field locations. In contrast, the median of <italic>ρ</italic> scores is not affected by small perturbations but decays abruptly at medium-sized perturbations. This non-linear decay arises because perturbations of field locations that are much smaller than the grid spacing lead to a blurred, but almost perfectly hexagonal correlogram (<xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3b</xref>). Larger perturbations destroy the symmetry of the correlogram.</p>
<p>To study whether the two scores agree on the gridness of individual firing patterns, we correlate their values. The resulting Pearson correlation coefficients are <italic>r</italic> = 0.87 for generated data and <italic>r</italic> = 0.62 for experimentally recorded data (<xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3d and 3e</xref>; data from [<xref ref-type="bibr" rid="pcbi.1006804.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref016">16</xref>]). The lower correlation for experimental recordings results mainly from firing patterns for which either of the two scores failed in detecting the required shell (the neighborhood shell for the Ψ score and the annulus for the <italic>ρ</italic> score; see also the classification analysis below).</p>
<p>Above, we distorted grid patterns by random shifts to each node of a hexagonal grid. Experiments have shown that grid patterns are often distorted in a different way: a perfect hexagonal grid is sheared and thus elliptically deformed [<xref ref-type="bibr" rid="pcbi.1006804.ref010">10</xref>]. To study the influence of elliptic distortions on Ψ scores and <italic>ρ</italic> scores, we generate a perfect grid and apply a horizontal shearing transformation to the locations of grid fields (<xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4</xref>, see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref> for details on how the spike maps are generated). The shearing reduces the 6-fold symmetry and leads to a smooth and subtle decay of Ψ scores with increasing shearing (<xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4c</xref>). In contrast, the elliptic shape of the correlogram (<xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4b</xref>) leads to a sudden drop of <italic>ρ</italic> scores (<xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4c</xref>) at intermediate shearing strengths.</p>
<fig id="pcbi.1006804.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006804.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Quantifying the global symmetry of firing patterns in the presence of shearing distortions or background noise.</title>
<p><bold>a, b)</bold> Arrangement as in <xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3a and 3b</xref>, but for generated spike maps with different degrees of shearing. Top: No shearing. Middle: Weak shearing. Bottom: Strong shearing. <bold>c)</bold> Arrangement as in <xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3c</xref> but with increasing shearing strength on the horizontal axis. Shearing strengths for the examples shown in a are indicated with markers. <bold>d, e)</bold> Arrangement as in a, b, but for generated spike maps with different degrees of background noise. Top: No background noise. Middle: Weak background noise. Bottom: Strong background noise. <bold>f)</bold> Arrangement as in c but with increasing background noise (i.e., fraction of spikes drawn from a spatially homogeneous distribution) on the horizontal axis. Background noise levels for the examples shown in d are indicated with markers.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.g004" xlink:type="simple"/>
</fig>
<p>Another typical source of noise originates from spikes at random locations which could, for example, be artifacts of poor single cell isolation. To study the effect of such <italic>background noise</italic> on the Ψ and <italic>ρ</italic> score, we generate grid patterns with a fixed number of spikes out of which a fraction is drawn at random locations (<xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4d</xref>, see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref> for details). The Ψ score first decays linearly with the fraction of background spikes until the detection of the neighborhood shell fails, which leads to vanishing scores (<xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4f</xref>). In contrast, the <italic>ρ</italic> score stays rather constant for low and intermediate noise levels and drops suddenly at high noise levels (<xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4f</xref>). Indeed, an intermediate amount of background noise even increases <italic>ρ</italic> scores, as observed previously [<xref ref-type="bibr" rid="pcbi.1006804.ref017">17</xref>]. Note that in the scenario of background spikes, we detect the neighborhood shell from the histogram of pairwise spike distances using the first peak above a cutoff, because otherwise, the detection of the neighborhood shell would fail already at lower noise values (see <xref ref-type="sec" rid="sec002">Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006804.s001">S1 Fig</xref> for details).</p>
</sec>
<sec id="sec010">
<title>Classifying grid cells</title>
<p>When should we classify a recorded cell as a grid cell? A simple method for classification would be to call a cell a grid cell if its (<italic>ρ</italic> or Ψ) score exceeds a fixed threshold. For the <italic>ρ</italic> score, thresholds between 0 [<xref ref-type="bibr" rid="pcbi.1006804.ref006">6</xref>] and 0.75 [<xref ref-type="bibr" rid="pcbi.1006804.ref018">18</xref>] have been used. From the relation between the two scores (<xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3d and 3e</xref>), we could deduce a threshold between 0.1 and 0.15 for the Ψ score. Using such a <italic>fixed threshold</italic> for classification can be misleading, though. A firing pattern with perfect hexagonal symmetry, but many “background” spikes outside of firing fields—which might just be an artifact of the extracellular recording, rather than a property of the cell—should be classified as a grid cell, even if its grid score is low. For grid cell classification it is thus common to use a <italic>flexible threshold</italic>, i.e., an individual threshold that is computed for each cell. It is determined as follows: the spike locations are shuffled at random (see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref> for details on the shuffling procedure and a discussion of an alternative method [<xref ref-type="bibr" rid="pcbi.1006804.ref009">9</xref>]). This shuffling is done with 100 random initializations and results in 100 new spike maps. The grid score is computed for each shuffled spike map. The threshold is then defined as the 95th percentile of the grid scores obtained for the shuffled spike maps. Only if the grid score of the actual spike map exceeds this threshold, the cell is called a grid cell. This classification method can be used for either grid score.</p>
<p>For the experimental data from Sargolini et al. [<xref ref-type="bibr" rid="pcbi.1006804.ref006">6</xref>], which are publicly available [<xref ref-type="bibr" rid="pcbi.1006804.ref016">16</xref>] and contain a diverse set of spatial firing patterns, we find that the Ψ score and the <italic>ρ</italic> score lead to the same classification for more than 78% of the cells. Out of 619 cells, 196 are classified as grid cells by the Ψ score and 170 by the <italic>ρ</italic> score (<xref ref-type="fig" rid="pcbi.1006804.g005">Fig 5a</xref>). 116 cells are classified as grid cells by both scores. Cells that are classified as grid cells by a score also tend to have a high value of this score, however, sometimes very low grid scores result in a positive classification (e.g., Ψ scores below 0.05, <xref ref-type="fig" rid="pcbi.1006804.g005">Fig 5b</xref>).</p>
<fig id="pcbi.1006804.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006804.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Classifying grid cells with the spike-based and the correlogram-based grid score.</title>
<p><bold>a)</bold> Venn diagram of 619 recordings from cells in mEC. Different colors highlight areas with different classification results (classification by Ψ and/or <italic>ρ</italic> score positive/negative). See text for a description of the classification method. <bold>b)</bold> Correlation of Ψ and <italic>ρ</italic> score as in <xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3e</xref>. Markers represent the classification of the cell using the color code and the symbols from a. <bold>c, d, e, f, g)</bold> Individual recordings in different classification categories. The category is indicated by the marker on the left, using the scheme in a. From left to right: spike map with each spike <italic>k</italic> color-coded with its grid score <inline-formula id="pcbi.1006804.e018"><alternatives><graphic id="pcbi.1006804.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> (global Ψ score shown above); smoothed spike density (“rate map”), brighter values indicate higher density of spikes; autocorrelogram of the rate map (<italic>ρ</italic> score shown above); smoothed histogram of pairwise distances of all spikes, dashed orange lines show automatically detected neighborhood shells. See text for a detailed description of all examples. Experimental data recorded and made publicly available by Sargolini et al. [<xref ref-type="bibr" rid="pcbi.1006804.ref006">6</xref>] through [<xref ref-type="bibr" rid="pcbi.1006804.ref016">16</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.g005" xlink:type="simple"/>
</fig>
<p>For symmetric grid patterns with a small number of background spikes, the Ψ score and the <italic>ρ</italic> score typically both classify the cell as a grid cell (<xref ref-type="fig" rid="pcbi.1006804.g005">Fig 5c</xref>). For non-grid cells with irregular firing, the classification of both scores is typically negative (<xref ref-type="fig" rid="pcbi.1006804.g005">Fig 5d</xref>).</p>
<p>A disagreement between the two scores can have different reasons. If the grid pattern has many spikes outside of grid fields, the cell might be classified as a grid cell by one or both scores although both are low (<xref ref-type="fig" rid="pcbi.1006804.g005">Fig 5e</xref>). For strong activity outside of firing fields, the detection of the correct neighborhood shell can fail, thus leading to wrongfully low grid scores of all spikes (<xref ref-type="fig" rid="pcbi.1006804.g005">Fig 5f</xref>). In line with the observed robustness of the Ψ score to elliptic distortions (<xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4c</xref>), cells with elongated grid patterns may be classified as grid cells by the Ψ score, but not by the <italic>ρ</italic> score (<xref ref-type="fig" rid="pcbi.1006804.g005">Fig 5g</xref>).</p>
<p>In summary, the Ψ score and the <italic>ρ</italic> score perform comparably in quantifying and classifying grid cells, but the Ψ score is more robust to elliptic distortions and more sensitive to background noise. In the next section, we highlight the advantages of a spike-based grid score for the analysis of local grid properties.</p>
</sec>
</sec>
<sec id="sec011">
<title>The spike-based score detects local grid distortions</title>
<p>So far we assumed that gridness is an arena-wide property of a firing pattern. We did not consider local defects. But recent experiments have shown that grid patterns are often locally distorted. Such distortions have been observed in both asymmetric [<xref ref-type="bibr" rid="pcbi.1006804.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref012">12</xref>] and quadratic environments [<xref ref-type="bibr" rid="pcbi.1006804.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref020">20</xref>], and are presumably caused by boundary effects. Moreover, it has been shown that grid patterns recorded in two arenas separated by a wall do not form a coherent grid, but merge into a more coherent pattern when the wall is removed [<xref ref-type="bibr" rid="pcbi.1006804.ref019">19</xref>].</p>
<p>We now show that our spike-based grid score is suitable to quantify and visualize such local properties. We first illustrate this for generated spike data and then for experimental recordings.</p>
<p>To generate an example of a grid pattern with local defects, we first generated a perfect grid and then added random vectors to the field locations (cf. <xref ref-type="fig" rid="pcbi.1006804.g003">Fig 3a</xref>, see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref> for details) only in the eastern half of the arena (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6a and 6b</xref>). To analyze gridness locally, we divide the arena into partitions and compute the Ψ score within each partition, i.e., the mean over all <inline-formula id="pcbi.1006804.e019"><alternatives><graphic id="pcbi.1006804.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> scores for all spikes <italic>k</italic> within the given partition (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6c</xref>). Averaging over multiple cells highlights that the gridness decays along the west-east axis but stays stable along the south-north axis, and this trend is already visible for individual cells (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6c and 6d</xref>). Note that due to the strong noise on the east side of the arena, we detect the neighborhood shell from the histogram of pairwise spike distances, using the first peak above a cutoff (see <xref ref-type="sec" rid="sec002">Methods</xref>).</p>
<fig id="pcbi.1006804.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006804.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Visualizing and quantifying local distortions of grid patterns.</title>
<p><bold>a, b)</bold> Generated spike locations with noise on grid field locations applied only on the east side of the arena (see text for details, 2 example cells). The color of each spike location shows the <inline-formula id="pcbi.1006804.e020"><alternatives><graphic id="pcbi.1006804.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> score. Shown above: Ψ score. <bold>c)</bold> East-west (left) and south-north (right) partitioning of the arena. Black lines show partition boundaries. Colors of partitions indicate the Ψ score within the partition for the examples in a (top) and b (bottom). <bold>d)</bold> Ψ score in partitions along west-east axis (dark blue) and south-north axis (light blue). Crosses show results for 10 randomly generated spike maps with noise on field locations applied only on the east side. Filled circles indicate the mean over 10 realizations. <bold>e)</bold> Spike locations of two example cells recorded in a rat that explored the northern and southern half of a box. The two halves are separated by a wall (dashed gray line). The spikes in each half were recorded in separate sessions. Color-coding as in a. <bold>f)</bold> Spike locations of the two cells shown in e while the rat explored the entire arena after the separating wall was removed. <bold>g)</bold> Grid score in south-north partitions before wall removal (left) and after wall removal (right) for the cells in e, f. Color-coding as in c. <bold>h)</bold>Ψ scores in the south-north partitions shown in g for 11 recorded cells. Crosses denote individual cells, filled circles the mean across cells. Ψ scores before wall removal in dark blue, Ψ scores after wall removal in light blue. <bold>i)</bold>Ψ scores in west-east partitions for the cells in e, f. Arrangement as in g. <bold>j)</bold>Ψ scores in the west-east partitions shown in i. Same recordings and arrangement as in h. Data in panels e-j kindly provided by [<xref ref-type="bibr" rid="pcbi.1006804.ref019">19</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.g006" xlink:type="simple"/>
</fig>
<p>We now apply the same analysis to recent experimental data. Wernle et al. recorded grid cells from rats that explored the northern and southern half of a 2m × 2m box [<xref ref-type="bibr" rid="pcbi.1006804.ref019">19</xref>]. The two halves were initially separated by a wall. The cells fired in grid patterns independently in both halves of the arena (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6e</xref>). Then the authors removed the wall and let the rat explore the entire arena. At the southern and northern boundaries, the grid fields typically stayed at the same locations as before wall removal. Close to the former location of the wall, the grid fields moved—and sometimes even merged—to form a more coherent grid pattern (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6f</xref>). Quantifying the local increase of coherence requires a local grid score.</p>
<p>We therefore use our spike-based grid score to show that the rearrangement of grid fields after wall removal indeed leads to a local increase of gridness. Given that the firing patterns of the grid cells are noisy and strongly elliptic, it is difficult to determine the peaks in the histograms of pairwise spike distances (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6e and 6f</xref>). We thus set the central distance of the neighborhood shell manually to <italic>ℓ</italic> = 65cm—a value that we obtained by visual inspection of the histograms of pairwise spike distances of all 11 recorded cells, after wall removal. We divide the arena into three equal sized partitions. For south-north partitioning (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6g</xref>), the grid score is typically lowest in the partition that contains the separating wall (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6h</xref>). After wall removal, the grid score increases in all partitions, but the increase is most prominent in the partition that contained the separating wall (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6h</xref>). In contrast, a west-east partitioning does not lead to a single partition with predominantly low grid scores. Moreover, the increase after wall removal is similar for all west-east partitions (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6i and 6j</xref>). Our analysis thus quantifies the qualitative observation that two initially independent grids locally rearrange to form a more coherent grid. For less elliptic grid patterns, we assume our quantitative results to be even more pronounced.</p>
<p>In summary, a spike-based grid score visually highlights local grid defects. Averaging spike scores in arbitrary partitions and potentially over many cells enables a systematic analysis of grid defects on a spatial scale smaller than the grid spacing.</p>
</sec>
<sec id="sec012">
<title>The spike-based score detects shifts in grid orientation</title>
<p>Early work on grid cells has shown that the firing patterns of anatomically nearby cells typically have a similar orientation [<xref ref-type="bibr" rid="pcbi.1006804.ref002">2</xref>], which tends to align with a cardinal axis of the environment [<xref ref-type="bibr" rid="pcbi.1006804.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref011">11</xref>]. While these findings suggest a constant grid orientation, experiments from the same group have shown that the orientation can drift within the arena or exhibit local distortions [<xref ref-type="bibr" rid="pcbi.1006804.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref020">20</xref>]. To quantify these experiments, a local measure of grid orientation is needed.</p>
<p>In the following, we study local grid orientation using the angle <italic>θ</italic><sub><italic>k</italic></sub> of spike <italic>k</italic> (see the algorithm in <xref ref-type="fig" rid="pcbi.1006804.g002">Fig 2</xref> for the definition) on generated (see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref>) and recorded firing patterns that were kindly provided by Stensola et al. [<xref ref-type="bibr" rid="pcbi.1006804.ref010">10</xref>].</p>
<p>When each spike is color-coded according to its grid orientation <italic>θ</italic><sub><italic>k</italic></sub>, the spikes of firing fields have the same color for a perfect hexagonal grid—except the spikes at the edge of a grid field (<xref ref-type="fig" rid="pcbi.1006804.g007">Fig 7a</xref>). In contrast, the color-coding shows a sudden switch if the orientation is changed abruptly (<xref ref-type="fig" rid="pcbi.1006804.g007">Fig 7b</xref>) or a color gradient if the grid orientation drifts continuously across the arena, both in generated data (<xref ref-type="fig" rid="pcbi.1006804.g007">Fig 7c</xref>) and in recordings (<xref ref-type="fig" rid="pcbi.1006804.g007">Fig 7d</xref>). If the drift in orientation is along the south-north axis of the box, the gradient follows this axis (<xref ref-type="fig" rid="pcbi.1006804.g007">Fig 7c and 7d</xref>). This can be highlighted by partitioning the arena and calculating the mean value of the orientation <italic>θ</italic><sub><italic>k</italic></sub> for all spikes <italic>k</italic> within each partition (<xref ref-type="fig" rid="pcbi.1006804.g007">Fig 7c and 7d</xref>). To highlight an orientation drift recorded in multiple cells, we average over the the orientation <italic>θ</italic><sub><italic>k</italic></sub> for spikes from several cells. For the recordings of Stensola et al. [<xref ref-type="bibr" rid="pcbi.1006804.ref010">10</xref>], this shows that the orientation increases monotonically from south to north, but varies less systematically from west to east, for a set of 5 cells recorded in the same rat (<xref ref-type="fig" rid="pcbi.1006804.g007">Fig 7e and 7f</xref>). Note that changes in grid orientation distort the correlogram, which can lead to low <italic>ρ</italic> scores (<xref ref-type="fig" rid="pcbi.1006804.g007">Fig 7b and 7c</xref>), even if the grid-like structure is clearly apparent. In contrast, the Ψ score is robust to distortions in orientation because of its locality.</p>
<fig id="pcbi.1006804.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006804.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Visualizing and quantifying local changes in orientation of grid patterns.</title>
<p><bold>a, b, c, d)</bold> From left to right: spike locations; spike locations where each spike is color-coded with its <inline-formula id="pcbi.1006804.e021"><alternatives><graphic id="pcbi.1006804.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> score (global Ψ score shown above); autocorrelogram of the firing pattern (<italic>ρ</italic> score shown above); spike locations where each spike is color coded with its orientation <italic>θ</italic><sub><italic>k</italic></sub> (global orientation Θ shown above); four different spatial partitionings of the arena where black lines show partition boundaries and colors of partitions show the average orientation within each partition (mean of <italic>θ</italic><sub><italic>k</italic></sub> values) using the orientation color-code. <bold>a)</bold> Generated perfect grid pattern with orientation of 10 degrees. <bold>b)</bold> Generated grid pattern with abrupt change in orientation. <bold>c)</bold> Generated grid pattern with drifting orientation. <bold>d)</bold> Experimentally recorded grid pattern with drift in orientation. <bold>e)</bold> Four further experimental examples and the average of their spike-based orientation values in west-east and south-north partitionings. <bold>f)</bold> Orientations along west-east and south-north in the partitions shown in e. Data kindly provided by Stensola et al. [<xref ref-type="bibr" rid="pcbi.1006804.ref010">10</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.g007" xlink:type="simple"/>
</fig>
<p>In summary, a spike-based orientation measure highlights local distortions in grid orientation. Averaging spike-based orientations, using arbitrary spatial partitionings, allows to further classify the distortion.</p>
</sec>
<sec id="sec013">
<title>The spike-based score quantifies temporal fluctuations of grid patterns</title>
<p>Whether or not the spikes of a cell form a hexagonal spatial pattern can vary in time. For example, the activity of grid cells loses its periodicity when the light is turned off [<xref ref-type="bibr" rid="pcbi.1006804.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref022">22</xref>]. A decay of grid-like firing patterns can also be triggered by internal modifications, like the deactivation of hippocampal drive to the entorhinal cortex [<xref ref-type="bibr" rid="pcbi.1006804.ref023">23</xref>]. In the following, we show how the spike-based grid score can be used to study changes in grid cell activity with high temporal resolution.</p>
<p>The standard procedure for computing a grid score in a given time interval is to take the spike locations from all spikes that occurred in this interval and compute the grid score for the resulting pattern. While this can be done with both the correlogram-based score and the spike-based score, it introduces constraints on the temporal resolution, because the temporal window must contain a sufficient coverage of the arena to obtain a meaningful score.</p>
<p>This problem can be circumvented with a spike-based grid score, because for a given spike map, each spike <italic>k</italic> has a grid score <inline-formula id="pcbi.1006804.e022"><alternatives><graphic id="pcbi.1006804.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> and a time <italic>t</italic><sub><italic>k</italic></sub>. In other words, the grid score <inline-formula id="pcbi.1006804.e023"><alternatives><graphic id="pcbi.1006804.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> at time <italic>t</italic><sub><italic>k</italic></sub> quantifies the contribution of spike <italic>k</italic> to the grid pattern formed by <italic>all</italic> spikes. Just like the global grid score Ψ is calculated by averaging over the individual <inline-formula id="pcbi.1006804.e024"><alternatives><graphic id="pcbi.1006804.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> values of <italic>all</italic> spikes, a temporally local grid score can be obtained by averaging the <inline-formula id="pcbi.1006804.e025"><alternatives><graphic id="pcbi.1006804.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> values of the spikes in an arbitrary time interval. The resulting average quantifies how much the spikes in this interval contribute to the grid in the complete recording.</p>
<p>To demonstrate that the spike-based grid score can characterize temporal changes in grid patterns, we consider generated data with a sudden transition from spatially homogeneous to grid cell activity (<xref ref-type="fig" rid="pcbi.1006804.g008">Fig 8a</xref>). Plotting the individual grid scores as a function of spike time highlights the transition to the grid pattern, although the grid scores <inline-formula id="pcbi.1006804.e026"><alternatives><graphic id="pcbi.1006804.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> of the individual spikes are computed using the locations of all spikes (<xref ref-type="fig" rid="pcbi.1006804.g008">Fig 8a and 8b</xref>). The transition is emphasized by temporal smoothing (<xref ref-type="fig" rid="pcbi.1006804.g008">Fig 8c</xref>). Requirements for the smoothing filter are discussed later. Note that such an analysis first of all requires that a grid pattern can be detected in the full recording, so that a meaningful neighborhood shell can be identified. To facilitate the detection of the neighborhood shell in the presence of noise, we detect the first peak above a cutoff in the histogram of pairwise spike distances (see <xref ref-type="sec" rid="sec002">Methods</xref>).</p>
<fig id="pcbi.1006804.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006804.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Quantifying temporal disruptions of grid patterns.</title>
<p><bold>a)</bold> Generated spike locations with 2000 spikes (left). Each spike k is color-coded with its grid score <inline-formula id="pcbi.1006804.e027"><alternatives><graphic id="pcbi.1006804.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. The first 1000 spikes are drawn from a spatially uniform distribution (top right) and the last 1000 spikes are drawn from a perfect grid (bottom right), at a constant rate of 1 spike per second. <bold>b)</bold> <inline-formula id="pcbi.1006804.e028"><alternatives><graphic id="pcbi.1006804.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> scores in a as a function of spike time. Note that the score of many spikes is 0. <bold>c)</bold> The scores from b, filtered with a 100 second time window (dotted lines indicate window size). <bold>d)</bold> Two experimentally recorded spike maps, color coded with <inline-formula id="pcbi.1006804.e029"><alternatives><graphic id="pcbi.1006804.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> scores. The recordings are 52 minutes in total and contain 13 trials in light (with an illuminated cue card) and 13 trials in darkness, each of 2 minutes duration. <bold>e)</bold> The <inline-formula id="pcbi.1006804.e030"><alternatives><graphic id="pcbi.1006804.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> scores as a function of time, filtered with a 1 minute window. From top to bottom: First cell from d; second cell from d; mean over both cells. Shadings indicate light trials. Pearson’s correlation coefficients, r, between lighting condition and filtered grid scores are shown for each scenario. <bold>f)</bold> Spike maps for cell 1 and cell 2, separated into spikes fired during light trials and spikes fired during dark trials. <bold>g)</bold> Temporal evolution of grid scores after changes in lighting condition. Each 2 minute trial was separated into 12 × 10 second blocks. Each point shows the mean <inline-formula id="pcbi.1006804.e031"><alternatives><graphic id="pcbi.1006804.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> score of all spikes in a time block in light trials (light blue) and dark trials (dark blue), averaged over 73 grid cells. Grid scores are calculated in reference to all spikes during light trials (see text for details). Experimental data recorded and made publicly available by Pérez-Escobar et al. [<xref ref-type="bibr" rid="pcbi.1006804.ref021">21</xref>].</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.g008" xlink:type="simple"/>
</fig>
<p>We now use this method to analyze spike patterns from cells in mice that forage in an arena in alternating trials of darkness and light [<xref ref-type="bibr" rid="pcbi.1006804.ref021">21</xref>]. For the recorded grid cells (<xref ref-type="fig" rid="pcbi.1006804.g008">Fig 8d</xref>), the filtered time evolution of grid scores <inline-formula id="pcbi.1006804.e032"><alternatives><graphic id="pcbi.1006804.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is strongly correlated with darkness and light—grid scores tend to be higher in light trials (<xref ref-type="fig" rid="pcbi.1006804.g008">Fig 8e</xref>, see <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref> for details on the data preparation). The Pearson correlation coefficient between lighting condition and the smoothed grid scores (<italic>r</italic> = 0.57 and <italic>r</italic> = 0.53 for single cells and <italic>r</italic> = 0.69 for the average over smoothed grid scores of two cells) indicate that only few simultaneously recorded cells are necessary to reach confident conclusions about temporal variations in the quality of grid patterns or contextual influences on grid cell activity.</p>
<p>But how quickly does the grid pattern decay when the light is turned off? How rapidly does it reappear when the light is turned on again? Previously, these questions were answered with a temporal resolution of 10 seconds using <italic>map similarity</italic> [<xref ref-type="bibr" rid="pcbi.1006804.ref021">21</xref>] (see below for a discussion of map similarity). We now show that we can reach the same temporal resolution using the spike-based grid score.</p>
<p>To this end, we create a <italic>reference spike map</italic> for each recorded grid cell in the data [<xref ref-type="bibr" rid="pcbi.1006804.ref021">21</xref>], which comprises the locations of all spikes that were fired during light trials. Note that these subsets of spikes show a much clearer grid pattern than that of spikes during darkness (<xref ref-type="fig" rid="pcbi.1006804.g008">Fig 8f</xref>). We then quantify how well the spikes of a given cell fit into the grid pattern of the cell’s reference spike map, by adding every spike <italic>k</italic> <italic>individually</italic> to the reference spike map and computing its <inline-formula id="pcbi.1006804.e033"><alternatives><graphic id="pcbi.1006804.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> score as usual.</p>
<p>We then average the <inline-formula id="pcbi.1006804.e034"><alternatives><graphic id="pcbi.1006804.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> score of spikes that occur at similar times during light/dark trials. To this end, we divide each 2 minute trial into 12 × 10 second blocks. This division is done separately for light and dark trials. We then average the grid scores <inline-formula id="pcbi.1006804.e035"><alternatives><graphic id="pcbi.1006804.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> over all spikes and over 73 recorded grid cells within each 10 second block. Plotting this average as a function of time shows that grids decay within 30 seconds after the light is turned off (<xref ref-type="fig" rid="pcbi.1006804.g008">Fig 8g</xref>). Grids need a similar time to reappear after the light is turned on (<xref ref-type="fig" rid="pcbi.1006804.g008">Fig 8g</xref>).</p>
<p>In summary, the spike-based grid score readily contains temporal information which can be used to study distortions of the grid pattern in time. The time evolution of the grid score can be correlated with any other time varying variable to unravel its influence on the grid pattern, e.g., light conditions, running speed or the concentration of neuromodulators.</p>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>In summary, we have developed a method to quantify the embedding of each spike of a cell into a hexagonal neighborhood of spikes. The method yields both a local grid score and a local grid orientation. It is based on the <italic>ψ</italic><sup>(<italic>M</italic>)</sup> measure for <italic>M</italic>-fold symmetry used in solid state physics [<xref ref-type="bibr" rid="pcbi.1006804.ref013">13</xref>] and adapted to the analysis of spike locations. It requires only few and robust steps to assign a grid score to each spike. We have shown that the global average of this spike-based score is as adequate as existing correlogram-based methods to quantify and classify grid cells. Its key advantage is that it simplifies local analyses both in space (‘Where are good spikes?’) and in time (‘When are good spikes?’). The method allows a new visualization of grid cell data, showing all spike locations together with information on local grid quality and local orientation.</p>
<sec id="sec015">
<title>Averaging over multiple cells increases spatial or temporal resolution</title>
<p>We have shown spatially local grid scores in sub-partitions of the arena and temporally local grid scores in time intervals. The resulting values can be misleading if the spatial subinterval is too small or if the temporal subinterval is too short. For example, if we study the local grid score of a single cell in a partition that does not contain a grid field of that cell, the mean over all spike scores in that partition will be very low, suggesting a local defect. Such sampling biases could be mitigated by making the partition larger (or the interval longer, for temporal analyses), at the cost of resolution. For a single cell, the resolution is thus bounded by the grid spacing. However, a reduction of sampling biases without a loss of resolution can be obtained by averaging over multiple cells. It would be beneficial if these cells have different spatial phases, because this ensures the presence of a grid field in each partition and thus reduces sampling biases. Averaging over many cells thus enables a higher spatial resolution than the grid spacing and a higher temporal resolution than the time the rat needs to sample a sufficient number of grid fields in a single cell.</p>
</sec>
<sec id="sec016">
<title>Comparison with correlogram-based method in spatial subregions</title>
<p>The correlogram-based <italic>ρ</italic> score can be made more local by computing it in spatial subregions within the arena. A window can also be used to compute the sliding average of the <italic>ρ</italic> score in the entire arena [<xref ref-type="bibr" rid="pcbi.1006804.ref020">20</xref>], resulting in a spatial map of local grid scores. Selecting the size of the window is subject to a trade-off: while a small window is necessary for a high spatial resolution, the <italic>ρ</italic> score will fail to detect a grid if the window is too small—e.g., smaller then the grid spacing. In contrast, the spike-based score can be computed in arbitrary spatial partitionings (<xref ref-type="fig" rid="pcbi.1006804.g007">Fig 7</xref>) by averaging over the spikes in each partition. The side length of a partition can even be smaller than the grid spacing, in particular if multiple cells are used to compute the score in each partition (see above). The flexibility to use partitionings of an arbitrary shape, e.g., trapezoidal or triangular, can be important to study grid cells in environments with complex geometries [<xref ref-type="bibr" rid="pcbi.1006804.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref012">12</xref>].</p>
</sec>
<sec id="sec017">
<title>Comparison with map similarity for the study of time evolution</title>
<p>We have shown that a spike-based grid score enables a straightforward analysis of the temporal stability of grid patterns and illustrated this on recorded data from mice foraging through an arena in light and darkness [<xref ref-type="bibr" rid="pcbi.1006804.ref021">21</xref>]. In our analysis of the decay and reappearance of grid cell activity (<xref ref-type="fig" rid="pcbi.1006804.g008">Fig 8</xref>), we reproduced the results shown in [<xref ref-type="bibr" rid="pcbi.1006804.ref021">21</xref>], where the authors used <italic>map similarity</italic> for their analysis. In the map similarity measure, a rate map is correlated with a reference map. As a reference map, the authors used recordings during times of light. In each 10 second block, they collected all spike locations from that block in all trials (separating dark and light trials) and used these spike locations to create a rate map. If the correlation of the resulting rate map with the reference map is high, the pattern is similar, indicating that the grid has not decayed yet, and vice versa. For grid patterns without defects in field locations and with similar firing rates for different grid fields, map similarity and our measure should lead to similar results. However, our measure focuses on how much a spike is part of the <italic>grid</italic> of the reference map. In contrast, map similarity only quantifies how much spikes are part of the <italic>rate pattern</italic> of the reference map, irrespective of whether it forms a grid. If for example, the reference map has a firing field that does not belong to the hexagonal pattern, spikes that are located in this firing field will lead to low values in our measure. In contrast, map similarity assigns high values to activity within any firing field of the reference map, be it a grid field or a defect.</p>
</sec>
<sec id="sec018">
<title>Detecting grids with elliptic distortions</title>
<p>We have shown that the spike-based Ψ score is more robust to elliptic deformations of grid patterns than the correlogram-based <italic>ρ</italic> score (<xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4c</xref>). This robustness can be crucial for the detection of grid cells, because many grid patterns are of elliptic shape. Quantifying the local improvement of a grid pattern in the scenario where two grids coalesce in a contiguous environment (<xref ref-type="fig" rid="pcbi.1006804.g006">Fig 6</xref>) was only possible because grid patterns could be detected, even though they were strongly elliptic.</p>
<p>A correlogram-based grid score can also be used with elliptic grid patterns, but requires an explicit compensation of the ellipticity. To this end, the ellipticity is detected and removed from the correlogram before the grid score is computed, by compressing the correlogram along the principal axis of the elliptic distortion [<xref ref-type="bibr" rid="pcbi.1006804.ref024">24</xref>]. In principle, we could apply such a transformation to all spike locations and then compute the spike-based grid scores. We have shown, however, that such an additional step is not necessary as long as the ellipticity is not too strong.</p>
</sec>
<sec id="sec019">
<title>Non-constant grid spacing</title>
<p>If a firing pattern is grid-like, but with different grid spacings in different parts of the arena, we cannot compute the neighborhood shell from all pairwise distances. Instead, the neighborhood would need to be determined individually for each spike, using the histogram of pairwise distances only between a given spike and all other spikes. Since we are not aware of local distortions to the grid spacing, we did not consider this.</p>
</sec>
<sec id="sec020">
<title>Non-isotropic assignment of grid scores to spikes in boundary grid fields</title>
<p>For grid fields with six neighboring fields, spikes in the center of the field receive the highest grid score and grid scores decay isotropically in all direction. In contrast, in grid fields at the boundaries, spikes with high <inline-formula id="pcbi.1006804.e036"><alternatives><graphic id="pcbi.1006804.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> form a curved stripe (<xref ref-type="supplementary-material" rid="pcbi.1006804.s001">S1 Fig</xref>). The reason is the following: Being in the boundary grid field, moving towards the central neighbors perturbs the 6-fold symmetry stronger than moving tangentially to it (<xref ref-type="supplementary-material" rid="pcbi.1006804.s001">S1 Fig</xref>). Such a directional dependence is not present in grid fields that have neighboring grid fields on all sides.</p>
</sec>
<sec id="sec021">
<title>The spike-based grid score for other symmetries</title>
<p>We focused on hexagonal patterns, i.e., grids of 6-fold symmetry. Experiments suggest that there are also band-like firing patterns, i.e., 2-fold symmetry [<xref ref-type="bibr" rid="pcbi.1006804.ref003">3</xref>]—though their existence has been questioned [<xref ref-type="bibr" rid="pcbi.1006804.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref026">26</xref>]. Moreover, boundary effects in arenas of complex shape could cause grid deformations that result in other symmetries. The suggested spike-based grid score can be readily applied to any <italic>M</italic>-fold symmetry. For example, to study quadratic symmetry, we would replace <italic>M</italic> = 6 by <italic>M</italic> = 4 and compare to the remaining symmetries, now including 6 (see the algorithm in <xref ref-type="supplementary-material" rid="pcbi.1006804.s003">S1 Appendix</xref>). Depending on the symmetry, the radius of the neighborhood shell needs to be chosen differently. For example, for quadratic symmetry, results are improved if the neighborhood shell is set to 2/3<italic>ℓ</italic> instead of <italic>ℓ</italic>, to only incorporate the four nearest neighboring fields (<xref ref-type="fig" rid="pcbi.1006804.g009">Fig 9d</xref>). For band-like symmetry, the shell radius should be <italic>ℓ</italic>/2, so that the next band is not included in the shell (<xref ref-type="fig" rid="pcbi.1006804.g009">Fig 9e</xref>).</p>
<fig id="pcbi.1006804.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006804.g009</object-id>
<label>Fig 9</label>
<caption>
<title>A spike-based grid score for other symmetries.</title>
<p><bold>a)</bold> Adaptation of the <inline-formula id="pcbi.1006804.e037"><alternatives><graphic id="pcbi.1006804.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> score to 4-fold symmetry. Shown above: average over all spikes. <bold>b)</bold> Adaptation of the <inline-formula id="pcbi.1006804.e038"><alternatives><graphic id="pcbi.1006804.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> score to 2-fold symmetry. Shown above: average over all spikes. See text for details.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.g009" xlink:type="simple"/>
</fig>
<p>As the experiments on spatially tuned cells become more complex, new properties will be unveiled. A spike-based grid score could be used as a single unifying method to classify grid cells and to analyze their local and temporal characteristics. The presented method could further be useful for the analysis of grid patterns in other modalities [<xref ref-type="bibr" rid="pcbi.1006804.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006804.ref028">28</xref>] or in other contexts, e.g., in the anatomical arrangement of grid cells [<xref ref-type="bibr" rid="pcbi.1006804.ref029">29</xref>] or retinal ganglion cells [<xref ref-type="bibr" rid="pcbi.1006804.ref030">30</xref>].</p>
</sec>
</sec>
<sec id="sec022">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006804.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Explanation of non-isotropic assignment of grid scores to spikes in boundary grid fields.</title>
<p><bold>a)</bold> Generated spike locations with few firing fields. The color of each spike <italic>k</italic> indicates the <inline-formula id="pcbi.1006804.e039"><alternatives><graphic id="pcbi.1006804.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> score. Fields at the boundaries have only three neighboring fields. This leads to a stripe-like assignment of <inline-formula id="pcbi.1006804.e040"><alternatives><graphic id="pcbi.1006804.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> scores. <bold>b)</bold> Schematic of a perfect grid cell. Dots on the hexagon mark the centers of grid fields. Shaded regions show the grid field size. The dark blue dot in the upper right marks a reference spike in the center of a grid field. The dark blue circle around it indicates the neighborhood shell—much thinner than actual, for easier visualization. Connecting the reference spike to the center of the cross section of the neighborhood shell and the neighboring grid fields forms angles of 60 degrees. <bold>c)</bold> Same arrangement as in b but now the reference spike is not in the center of the grid field, but shifted along the gray circle that circumscribes the hexagon (direction indicated by arrow). Connecting the reference spike to the center of the cross section of the neighborhood shell and the neighboring grid fields still forms angles of roughly 60 degrees. Consequently, spikes along this direction have high <inline-formula id="pcbi.1006804.e041"><alternatives><graphic id="pcbi.1006804.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> scores. <bold>d)</bold> Same arrangement as in b, c but now the reference spike is shifted orthogonally to the circle that circumscribes the hexagon. Connecting the reference spike to the center of the cross section of the neighborhood shell and the neighboring grid fields does not form angles of 60 degrees. Consequently, spikes along this direction have low <inline-formula id="pcbi.1006804.e042"><alternatives><graphic id="pcbi.1006804.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006804.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msub><mml:mover accent="true"><mml:mi>ψ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> scores. For central grid fields, this effect is compensated by grid fields on opposite sides.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006804.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Decay of Ψ score with increasing background noise for different neighborhood shell detections.</title>
<p><bold>a)</bold> Same figure as <xref ref-type="fig" rid="pcbi.1006804.g004">Fig 4f</xref>. Here, the grid spacing for the neighborhood shell is determined by taking the location of the first peak in the pairwise spike distance histogram whose distance value exceeds a cutoff of 15% of the side length of the arena (see <xref ref-type="sec" rid="sec002">Methods</xref> for details). <bold>b)</bold> Same data as in a, but the neighborhood shell is determined using the second peak of the full histogram of pairwise distances between spike locations (without cutting off the first peak). Ψ scores decay to zero at lower noise levels, because the correct detection of the neighborhood shell fails at lower noise levels than in a (see <xref ref-type="sec" rid="sec002">Methods</xref> for details).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006804.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006804.s003" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Details on the methods.</title>
<p>Description of the shuffling of spike locations, the generation of spike maps, the computation of the correlogram-based grid score and how we extracted trials with specific light conditions.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Loreen Hertäg for proofreading this manuscript, Sophie Rosay for helpful discussions on correlogram-based grid scores and local grid defects, Martin Hägglund for helpful discussions on local grid defects and Tanja Wernle, Hanne and Tor Stensola and the Moser lab for generously providing their data.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006804.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Molden</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>. <article-title>Spatial representation in the entorhinal cortex</article-title>. <source>Science</source>. <year>2004</year>;<volume>305</volume>(<issue>5688</issue>):<fpage>1258</fpage>–<lpage>1264</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1099901" xlink:type="simple">10.1126/science.1099901</ext-link></comment> <object-id pub-id-type="pmid">15333832</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hafting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Molden</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Microstructure of a spatial map in the entorhinal cortex</article-title>. <source>Nature</source>. <year>2005</year>;<volume>436</volume>(<issue>7052</issue>):<fpage>801</fpage>–<lpage>806</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature03721" xlink:type="simple">10.1038/nature03721</ext-link></comment> <object-id pub-id-type="pmid">15965463</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krupic</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>. <article-title>Neural representations of location composed of spatially periodic bands</article-title>. <source>Science</source>. <year>2012</year>;<volume>337</volume>(<issue>6096</issue>):<fpage>853</fpage>–<lpage>857</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1222403" xlink:type="simple">10.1126/science.1222403</ext-link></comment> <object-id pub-id-type="pmid">22904012</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Diehl</surname> <given-names>GW</given-names></name>, <name name-style="western"><surname>Hon</surname> <given-names>OJ</given-names></name>, <name name-style="western"><surname>Leutgeb</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Leutgeb</surname> <given-names>JK</given-names></name>. <article-title>Grid and nongrid cells in medial entorhinal cortex represent spatial location and environmental features with complementary coding schemes</article-title>. <source>Neuron</source>. <year>2017</year>;<volume>94</volume>(<issue>1</issue>):<fpage>83</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2017.03.004" xlink:type="simple">10.1016/j.neuron.2017.03.004</ext-link></comment> <object-id pub-id-type="pmid">28343867</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hardcastle</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Maheswaranathan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ganguli</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Giocomo</surname> <given-names>LM</given-names></name>. <article-title>A multiplexed, heterogeneous, and adaptive code for navigation in medial entorhinal cortex</article-title>. <source>Neuron</source>. <year>2017</year>;<volume>94</volume>(<issue>2</issue>):<fpage>375</fpage>–<lpage>387</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2017.03.025" xlink:type="simple">10.1016/j.neuron.2017.03.025</ext-link></comment> <object-id pub-id-type="pmid">28392071</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sargolini</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hafting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <etal>et al</etal>. <article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title>. <source>Science</source>. <year>2006</year>;<volume>312</volume>(<issue>5774</issue>):<fpage>758</fpage>–<lpage>762</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1125572" xlink:type="simple">10.1126/science.1125572</ext-link></comment> <object-id pub-id-type="pmid">16675704</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Langston</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Ainge</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Couey</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Canto</surname> <given-names>CB</given-names></name>, <name name-style="western"><surname>Bjerknes</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <etal>et al</etal>. <article-title>Development of the spatial representation system in the rat</article-title>. <source>Science</source>. <year>2010</year>;<volume>328</volume>(<issue>5985</issue>):<fpage>1576</fpage>–<lpage>1580</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1188210" xlink:type="simple">10.1126/science.1188210</ext-link></comment> <object-id pub-id-type="pmid">20558721</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wills</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Cacucci</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>. <article-title>Development of the hippocampal cognitive map in preweanling rats</article-title>. <source>Science</source>. <year>2010</year>;<volume>328</volume>(<issue>5985</issue>):<fpage>1573</fpage>–<lpage>1576</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1188224" xlink:type="simple">10.1126/science.1188224</ext-link></comment> <object-id pub-id-type="pmid">20558720</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barry</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Burgess</surname> <given-names>N</given-names></name>. <article-title>To be a Grid Cell: Shuffling procedures for determining’Gridness’</article-title>. <source>bioRxiv</source>. <year>2017</year>; p. <fpage>230250</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006804.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stensola</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stensola</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Shearing-induced asymmetry in entorhinal grid cells</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7538</issue>):<fpage>207</fpage>–<lpage>212</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14151" xlink:type="simple">10.1038/nature14151</ext-link></comment> <object-id pub-id-type="pmid">25673414</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krupic</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bauza</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Burton</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Barry</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>. <article-title>Grid cell symmetry is shaped by environmental geometry</article-title>. <source>Nature</source>. <year>2015</year>;<volume>518</volume>(<issue>7538</issue>):<fpage>232</fpage>–<lpage>235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature14153" xlink:type="simple">10.1038/nature14153</ext-link></comment> <object-id pub-id-type="pmid">25673417</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krupic</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bauza</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Burton</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>O’Keefe</surname> <given-names>J</given-names></name>. <article-title>Local transformations of the hippocampal cognitive map</article-title>. <source>Science</source>. <year>2018</year>;<volume>359</volume>(<issue>6380</issue>):<fpage>1143</fpage>–<lpage>1146</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aao4960" xlink:type="simple">10.1126/science.aao4960</ext-link></comment> <object-id pub-id-type="pmid">29590044</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Halperin</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>DR</given-names></name>. <article-title>Theory of two-dimensional melting</article-title>. <source>Physical Review Letters</source>. <year>1978</year>;<volume>41</volume>(<issue>2</issue>):<fpage>121</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.41.121" xlink:type="simple">10.1103/PhysRevLett.41.121</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref014">
<label>14</label>
<mixed-citation publication-type="other" xlink:type="simple">Weber SN. gridscore. GitLab. 2018;<ext-link ext-link-type="uri" xlink:href="https://gitlab.com/simonweber/gridscore" xlink:type="simple">https://gitlab.com/simonweber/gridscore</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006804.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brun</surname> <given-names>VH</given-names></name>, <name name-style="western"><surname>Solstad</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kjelstrup</surname> <given-names>KB</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Witter</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>, <etal>et al</etal>. <article-title>Progressive increase in grid scale from dorsal to ventral medial entorhinal cortex</article-title>. <source>Hippocampus</source>. <year>2008</year>;<volume>18</volume>(<issue>12</issue>):<fpage>1200</fpage>–<lpage>1212</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hipo.20504" xlink:type="simple">10.1002/hipo.20504</ext-link></comment> <object-id pub-id-type="pmid">19021257</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref016">
<label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Sargolini F, Fyhn M, Hafting T, McNaughton BL, Witter MP, Moser MB, et al. <ext-link ext-link-type="uri" xlink:href="http://www.ntnu.edu/kavli/research/grid-cell-data" xlink:type="simple">http://www.ntnu.edu/kavli/research/grid-cell-data</ext-link>; 2006.</mixed-citation>
</ref>
<ref id="pcbi.1006804.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosay</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Weber</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mulas</surname> <given-names>M</given-names></name>. <article-title>Modeling grid fields instead of modeling grid cells</article-title>. <source>bioRxiv</source>. <year>2018</year>; p. <fpage>481747</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006804.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kropff</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Treves</surname> <given-names>A</given-names></name>. <article-title>The emergence of grid cells: Intelligent design or just adaptation?</article-title> <source>Hippocampus</source>. <year>2008</year>;<volume>18</volume>(<issue>12</issue>):<fpage>1256</fpage>–<lpage>1269</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/hipo.20520" xlink:type="simple">10.1002/hipo.20520</ext-link></comment> <object-id pub-id-type="pmid">19021261</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wernle</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Waaga</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Mørreaunet</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Treves</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Moser</surname> <given-names>EI</given-names></name>. <article-title>Integration of grid maps in merged environments</article-title>. <source>Nature neuroscience</source>. <year>2018</year>;<volume>21</volume>(<issue>1</issue>):<fpage>92</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41593-017-0036-6" xlink:type="simple">10.1038/s41593-017-0036-6</ext-link></comment> <object-id pub-id-type="pmid">29230051</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref020">
<label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">Hägglund M, Moser MB, Moser EI; 2018.</mixed-citation>
</ref>
<ref id="pcbi.1006804.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pérez-Escobar</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Kornienko</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Latuske</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kohler</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Allen</surname> <given-names>K</given-names></name>. <article-title>Visual landmarks sharpen grid cell metric and confer context specificity to neurons of the medial entorhinal cortex</article-title>. <source>eLife</source>. <year>2016</year>;<volume>5</volume>:<fpage>e16937</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.16937" xlink:type="simple">10.7554/eLife.16937</ext-link></comment> <object-id pub-id-type="pmid">27449281</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Manson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Cacucci</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wills</surname> <given-names>TJ</given-names></name>. <article-title>Absence of visual input results in the disruption of grid cell firing in the mouse</article-title>. <source>Current Biology</source>. <year>2016</year>;<volume>26</volume>(<issue>17</issue>):<fpage>2335</fpage>–<lpage>2342</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cub.2016.06.043" xlink:type="simple">10.1016/j.cub.2016.06.043</ext-link></comment> <object-id pub-id-type="pmid">27498565</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bonnevie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Dunn</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Fyhn</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hafting</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Derdikman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kubie</surname> <given-names>JL</given-names></name>, <etal>et al</etal>. <article-title>Grid cells require excitatory drive from the hippocampus</article-title>. <source>Nature neuroscience</source>. <year>2013</year>;<volume>16</volume>(<issue>3</issue>):<fpage>309</fpage>–<lpage>317</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3311" xlink:type="simple">10.1038/nn.3311</ext-link></comment> <object-id pub-id-type="pmid">23334581</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brandon</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Bogaard</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Libby</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Connerney</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hasselmo</surname> <given-names>ME</given-names></name>. <article-title>Reduction of theta rhythm dissociates grid cell spatial periodicity from directional tuning</article-title>. <source>Science</source>. <year>2011</year>;<volume>332</volume>(<issue>6029</issue>):<fpage>595</fpage>–<lpage>599</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1201652" xlink:type="simple">10.1126/science.1201652</ext-link></comment> <object-id pub-id-type="pmid">21527714</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Navratilova</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Godfrey</surname> <given-names>KB</given-names></name>, <name name-style="western"><surname>McNaughton</surname> <given-names>BL</given-names></name>. <article-title>Grids from bands, or bands from grids? An examination of the effects of single unit contamination on grid cell firing fields</article-title>. <source>Journal of neurophysiology</source>. <year>2016</year>;<volume>115</volume>(<issue>2</issue>):<fpage>992</fpage>–<lpage>1002</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00699.2015" xlink:type="simple">10.1152/jn.00699.2015</ext-link></comment> <object-id pub-id-type="pmid">26683071</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref026">
<label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Krupic J, Burgess N, O’Keefe J. Spatially periodic cells are neither formed from grids nor poor isolation; 2015.</mixed-citation>
</ref>
<ref id="pcbi.1006804.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Constantinescu</surname> <given-names>AO</given-names></name>, <name name-style="western"><surname>O’Reilly</surname> <given-names>JX</given-names></name>, <name name-style="western"><surname>Behrens</surname> <given-names>TE</given-names></name>. <article-title>Organizing conceptual knowledge in humans with a gridlike code</article-title>. <source>Science</source>. <year>2016</year>;<volume>352</volume>(<issue>6292</issue>):<fpage>1464</fpage>–<lpage>1468</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aaf0941" xlink:type="simple">10.1126/science.aaf0941</ext-link></comment> <object-id pub-id-type="pmid">27313047</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aronov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Nevers</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Tank</surname> <given-names>DW</given-names></name>. <article-title>Mapping of a non-spatial dimension by the hippocampal—entorhinal circuit</article-title>. <source>Nature</source>. <year>2017</year>;<volume>543</volume>(<issue>7647</issue>):<fpage>719</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature21692" xlink:type="simple">10.1038/nature21692</ext-link></comment> <object-id pub-id-type="pmid">28358077</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ray</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Naumann</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Burgalossi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Schmidt</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Brecht</surname> <given-names>M</given-names></name>. <article-title>Grid-layout and theta-modulation of layer 2 pyramidal neurons in medial entorhinal cortex</article-title>. <source>Science</source>. <year>2014</year>;<volume>343</volume>(<issue>6173</issue>):<fpage>891</fpage>–<lpage>896</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1243028" xlink:type="simple">10.1126/science.1243028</ext-link></comment> <object-id pub-id-type="pmid">24457213</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006804.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paik</surname> <given-names>SB</given-names></name>. <article-title>Interlayer repulsion of retinal ganglion cell mosaics regulates spatial organization of functional maps in the visual cortex</article-title>. <source>Journal of Neuroscience</source>. <year>2017</year>; p. <fpage>1873</fpage>–<lpage>17</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>