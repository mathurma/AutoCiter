<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
        <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00833</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1002788</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Anatomy and physiology</subject>
            <subj-group>
              <subject>Physiological processes</subject>
              <subj-group>
                <subject>Sleep</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Computational neuroscience</subject>
              <subject>Systems biology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Engineering</subject>
          <subj-group>
            <subject>Control engineering</subject>
            <subj-group>
              <subject>Control systems</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Mathematics</subject>
          <subj-group>
            <subject>Applied mathematics</subject>
            <subj-group>
              <subject>Control theory</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Nonlinear dynamics</subject>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Physiology</subject>
          <subject>Computational Biology</subject>
          <subject>Mathematics</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Reconstructing Mammalian Sleep Dynamics with Data Assimilation</article-title>
        <alt-title alt-title-type="running-head">Data Assimilation of the Sleep Regulatory Network</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Sedigh-Sarvestani</surname>
            <given-names>Madineh</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Schiff</surname>
            <given-names>Steven J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Gluckman</surname>
            <given-names>Bruce J.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>Center for Neural Engineering, Department of Engineering Science and Mechanics, The Pennsylvania State University, University Park, Pennsylvania, United States of America</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>Department of Neurosurgery, The Pennsylvania State University, University Park, Pennsylvania, United States of America</addr-line>
      </aff>
      <aff id="aff3">
        <label>3</label>
        <addr-line>Department of Physics, The Pennsylvania State University, University Park, Pennsylania, United States of America</addr-line>
      </aff>
      <aff id="aff4">
        <label>4</label>
        <addr-line>Department of Bioengineering, The Pennsylvania State University, University Park, Pennsylvania, United States of America</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Gutkin</surname>
            <given-names>Boris S.</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>École Normale Supérieure, College de France, CNRS, France</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">m.sedigh.sarvestani@gmail.com</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: MSS SJS BJG. Performed the experiments: MSS BJG. Analyzed the data: MSS SJS BJG. Wrote the paper: MSS SJS BJG.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <month>11</month>
        <year>2012</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>29</day>
        <month>11</month>
        <year>2012</year>
      </pub-date>
      <volume>8</volume>
      <issue>11</issue>
      <elocation-id>e1002788</elocation-id>
      <history>
        <date date-type="received">
          <day>21</day>
          <month>5</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>3</day>
          <month>10</month>
          <year>2012</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2012</copyright-year>
        <copyright-holder>Sedigh-Sarvestani et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>Data assimilation is a valuable tool in the study of any complex system, where measurements are incomplete, uncertain, or both. It enables the user to take advantage of all available information including experimental measurements and short-term model forecasts of a system. Although data assimilation has been used to study other biological systems, the study of the sleep-wake regulatory network has yet to benefit from this toolset. We present a data assimilation framework based on the unscented Kalman filter (UKF) for combining sparse measurements together with a relatively high-dimensional nonlinear computational model to estimate the state of a model of the sleep-wake regulatory system. We demonstrate with simulation studies that a few noisy variables can be used to accurately reconstruct the remaining hidden variables. We introduce a metric for ranking relative partial observability of computational models, within the UKF framework, that allows us to choose the optimal variables for measurement and also provides a methodology for optimizing framework parameters such as UKF covariance inflation. In addition, we demonstrate a parameter estimation method that allows us to track non-stationary model parameters and accommodate slow dynamics not included in the UKF filter model. Finally, we show that we can even use observed discretized sleep-state, which is not one of the model variables, to reconstruct model state and estimate unknown parameters. Sleep is implicated in many neurological disorders from epilepsy to schizophrenia, but simultaneous observation of the many brain components that regulate this behavior is difficult. We anticipate that this data assimilation framework will enable better understanding of the detailed interactions governing sleep and wake behavior and provide for better, more targeted, therapies.</p>
      </abstract>
      <abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Mathematical models are developed to better understand interactions between components of a system that together govern the overall behavior. Mathematical models of sleep have helped to elucidate the neuronal cell groups that are involved in promoting sleep and wake behavior and the transitions between them. However, to be able to take full advantage of these models one must be able to estimate the value of all included variables accurately. Data assimilation refers to methods that allow the user to combine noisy measurements of just a few system variables with the mathematical model of that system to estimate all variables, including those originally inaccessible for measurement. Using these techniques we show that we can reconstruct the unmeasured variables and parameters of a mathematical model of the sleep-wake network. These reconstructed estimates can then be used to better understand the underlying neuronal behavior that results in sleep and wake activity. Because sleep is implicated in a wide array of neurological disorders from epilepsy to schizophrenia, we anticipate that this framework will enable better understanding of the link between sleep and the rest of the brain and provide for better, more targeted, therapies.</p>
      </abstract>
      <funding-group>
        <funding-statement>This work was supported by NIH/NINDS Grant R01NS065096 to BJG and SJS as well as NIH/NINDS Grant FNS070545A to MSS (<ext-link ext-link-type="uri" xlink:href="http://www.ninds.nih.gov/" xlink:type="simple">http://www.ninds.nih.gov/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="15"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Great strides have been made in understanding the physiological basis for sleep regulation <xref ref-type="bibr" rid="pcbi.1002788-Saper1">[1]</xref> in terms of the interacting neuronal cell groups and their neurotransmitter mediated interactions. This physiology is now increasingly being embodied into complex mathematical models of sleep dynamics <xref ref-type="bibr" rid="pcbi.1002788-Tamakawa1">[2]</xref>–<xref ref-type="bibr" rid="pcbi.1002788-Rempe1">[6]</xref>. But the limits to which these models are either validated or otherwise utilized for insight and prediction is currently limited. Due to physical and technological constraints, simultaneous measurement of the physiology embodied in the models - such as cell group firing rates and neurotransmitter concentrations - is not feasible in freely behaving animals or people. We demonstrate here that such models of the sleep-wake regulatory system can be put into a data assimilation framework that allows for reconstruction and forecasting of unobserved dynamics from limited noisy measurements. We anticipate these tools will help shed light on core brain circuitry implicated in sleep disorders as well as sleep-related neurological disorders such as epilepsy <xref ref-type="bibr" rid="pcbi.1002788-Kothare1">[7]</xref>, bipolar disorder <xref ref-type="bibr" rid="pcbi.1002788-Coogan1">[8]</xref>, and generalized anxiety disorder <xref ref-type="bibr" rid="pcbi.1002788-Chase1">[9]</xref>.</p>
      <p>Data assimilation is an iterative process that couples and synchronizes mathematical models to observed system dynamics with the purpose of estimating both noisy observed and unobserved variables, as well as forecasting the future system state. Data assimilation algorithms for nonlinear systems often employ the ensemble Kalman filters <xref ref-type="bibr" rid="pcbi.1002788-Kalnay1">[10]</xref>. One such ensemble filter is the unscented Kalman filter (UKF), used in an iterative prediction-correction scheme in which model-generated predictions are corrected to agree with or track experimental observations <xref ref-type="bibr" rid="pcbi.1002788-Voss1">[11]</xref>.</p>
      <p>The objectives of this article are to demonstrate data assimilation applicability within the context of relatively high-dimensional nonlinear biological models of the sleep-wake regulatory system, and to investigate the observability properties of these models <xref ref-type="bibr" rid="pcbi.1002788-DinizBehn2">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1002788-Fleshner1">[12]</xref>. In the <xref ref-type="sec" rid="s2">Materials and Methods</xref> section, we introduce these models, as well as the basic mathematics of the UKF and parameter estimation algorithms. In the <xref ref-type="sec" rid="s3">Results</xref> section, we demonstrate the use of the UKF to reconstruct data generated from these models. We introduce a reconstruction quantification that allows one to gauge the relative observability of the model variables. We demonstrate how this empirical observability coefficient can be used to optimize UKF parameters such as model covariance inflation, as well as how to select the optimal variables for measurement. We then demonstrate a method for optimizing model parameters for tracking slowly varying dynamics. Finally, we demonstrate that we can use measurements of discretized sleep-state generated from the model, instead of specific model variables, to reconstruct unobserved model dynamics.</p>
    </sec>
    <sec id="s2" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <p>Data assimilation is an iterative process that couples and synchronizes mathematical models to observed system dynamics. For illustration of the data assimilation framework and validation of results, we use artificially generated data from the Diniz Behn and Booth (DB) model <xref ref-type="bibr" rid="pcbi.1002788-DinizBehn2">[4]</xref> or its extension by Fleshner, et al. (FBFD model) <xref ref-type="bibr" rid="pcbi.1002788-Fleshner1">[12]</xref>. We then select a subset of the generated variables, to which we add noise, as our measured data set. This data set, with or without the correct parameters used to generate it, is then passed to the UKF to reconstruct the unobserved states (variables) and forecast future system states. Validation is carried out by quantitatively comparing the reconstructed estimates and parameters with the known original data set. A <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e001" xlink:type="simple"/></inline-formula> order Runge-Kutta estimate with an integration time of 0.5 seconds is used for all simulations. The MATLAB code to produce each figure in the <xref ref-type="sec" rid="s3">Results</xref> section is available at ModelDB (<ext-link ext-link-type="uri" xlink:href="http://senselab.med.yale.edu/modeldb/default.asp" xlink:type="simple">http://senselab.med.yale.edu/modeldb/default.asp</ext-link>) or can be provided by the authors upon request.</p>
      <p>Within this section, we describe both the DB and FBFD models of the sleep-wake regulatory system. We then describe the main features of the UKF and parameter estimation algorithms.</p>
      <sec id="s2a">
        <title>Physiology of Sleep</title>
        <p>Recent advances in single and multi-unit recordings have contributed to the growing knowledge of the mammalian sleep-wake regulatory system. The current prevailing hypothesis includes a <italic>flip-flop</italic> switch that regulates transitions between non rapid-eye-movement sleep (NREM) and wakefulness (Wake) <xref ref-type="bibr" rid="pcbi.1002788-Saper1">[1]</xref>. Gamma-aminobutyric acid (GABA)-ergic ventrolateral preoptic nucleus (VLPO) neurons in the hypothalamus promote NREM. Monoaminergic cell groups in the brainstem, including the noradrenergic locus coeruleus (LC) and the serotonergic dorsal raphe (DR) neurons, promote Wake. Mutual inhibition between these two groups causes each to promote its own activity by inhibiting the other's. McCarley and Hobson <xref ref-type="bibr" rid="pcbi.1002788-McCarley1">[13]</xref> described transitions between NREM and rapid eye movement sleep (REM) arising from predator-prey like interactions between cholinergic cell-groups in the brainstem, including the laterodorsal tegmentum (LDT) and pedunculopontine tegmentum (PPT), and the monoaminergic cell-groups in LC and DR. For a more in-depth overview of the literature, including controversial hypotheses for REM regulation, see <xref ref-type="bibr" rid="pcbi.1002788-Fuller1">[14]</xref>.</p>
        <p>More recently, orexin and adenosine have been implicated in further regulation of the sleep-wake system. Orexin producing neurons in the lateral hypothalamus have descending projections to all aforementioned monoamergic and cholinergic cell groups and reinforce arousal, for a review see <xref ref-type="bibr" rid="pcbi.1002788-Ohno1">[15]</xref>. Extracellular adenosine has been found to increase during prolonged wakefulness in several cortical and subcortical regions <xref ref-type="bibr" rid="pcbi.1002788-PorkkaHeiskanen1">[16]</xref>, and has been proposed as a homeostatic accumulator of the need to sleep <xref ref-type="bibr" rid="pcbi.1002788-Huang1">[17]</xref>.</p>
        <p>These dynamics are further modified by the circadian drive <xref ref-type="bibr" rid="pcbi.1002788-Borbely1">[18]</xref>, regulated by the suprachiasmatic nucleus (SCN) in the hypothalamus, which sets a roughly 24-hour cycle affecting sleep and many other physiological functions. The SCN has indirect projections to the VLPO in the hypothalamus which results in inhibition of sleep during the day <xref ref-type="bibr" rid="pcbi.1002788-Deurveilher1">[19]</xref>. Here day is subjectively defined by species' dependent diurnal behavior, and refers roughly to 12-hour periods consisting mostly of active-wake behavior.</p>
        <p>The SCN clock can be modulated by afferent cortical inputs in response to a variety of external cues. Food restriction studies have shown entrainment of the circadian cycle to food availability <xref ref-type="bibr" rid="pcbi.1002788-Verwey1">[20]</xref>. Light input from the melonopsin expressing ganglion cells in the retina can also affect the SCN <xref ref-type="bibr" rid="pcbi.1002788-Hattar1">[21]</xref>. Retrograde trace studies have shown that a number of central nervous system sites innervate the SCN in the rat <xref ref-type="bibr" rid="pcbi.1002788-Krout1">[22]</xref>, though further study is needed to fully elucidate the involved circuitry. For instance, it is well known that lesions of the temporal lobe leading to epileptic seizures also affect the circadian clock <xref ref-type="bibr" rid="pcbi.1002788-Quigg1">[23]</xref>, <xref ref-type="bibr" rid="pcbi.1002788-Hofstra1">[24]</xref>, but the relevant brain circuitry has yet to be determined.</p>
      </sec>
      <sec id="s2b">
        <title>Diniz Behn and Booth (DB) Model of Sleep</title>
        <p>The DB model <xref ref-type="bibr" rid="pcbi.1002788-DinizBehn2">[4]</xref>, depicted in <xref ref-type="fig" rid="pcbi-1002788-g001">Fig. 1A</xref>, describes interactions among five distinct neuronal populations: two Wake-active groups, LC and DR; two groups in the LDT/PPT, one that is REM-active, denoted R; one active both in Wake and REM, denoted W/R; and one group active during NREM in the VLPO. As illustrated in <xref ref-type="fig" rid="pcbi-1002788-g001">Fig. 1A</xref>, these cell groups communicate through various transmitters: LC transmits norepinephrine (NE), DR transmits serotonin (5-HT), the two groups in the LDT/PPT transmit acetylcholine (ACh), and VLPO transmits GABA. Excitatory thalamic input is modeled by the variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e002" xlink:type="simple"/></inline-formula> and the brain's homeostatic sleep drive is represented by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e003" xlink:type="simple"/></inline-formula>. Sample output of this model's sleep-wake cycles, as well as mutual inhibition between Wake and sleep-active regions is shown in <xref ref-type="fig" rid="pcbi-1002788-g001">Fig. 1B</xref>.</p>
        <fig id="pcbi-1002788-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002788.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Computational models of the sleep-wake regulatory system and their outputs.</title>
            <p>A) Diniz Behn and Booth (DB) Model circuit diagram, illustrating the cell groups, their output neurotransmitters, and connections. Inhibitory connections are represented by minus and excitatory connections are represented by plus signs. Locus coeruleus (LC), dorsal raphe (DR), ventrolateral preoptic nucleus (VLPO), laterodorsal/pendunculopontine tegmentum (LDT/PPT), gamma-aminobutyric acid (GABA), seretonin (5-HT), norepinephrine (NE), acetylcholine (ACh), homeostatic sleep-drive (h), non rapid-eye-movement sleep (NREM), rapid-eye-movement sleep (REM). B) Typical output of the DB model for three of the cell group firing rates, plus the scored sleep-state plotted as a hypnogram. C) Fleshner, Booth, Forger and Diniz Behn (FBFD) Model circuit diagram, which expands on the DB model to include circadian modulation by and feedback to the suprachiasmatic nucleus (SCN), and allows for diurnal variations in behavior with light periods dominated by sleep activities and dark periods by periods of extended awake activity. Dashed lines indicate SCN additions to DB model. D) 36 hour hypnogram from the FBFD model, with 24-hour periodic CIRC input input to the SCN superimposed.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002788.g001" position="float" xlink:type="simple"/>
        </fig>
        <p>Each cell group is described by its firing rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e004" xlink:type="simple"/></inline-formula> and the concentration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e005" xlink:type="simple"/></inline-formula> of the neurotransmitter that it releases to post-synaptic populations. Cell group firing rates are a function of their input neurotransmitter concentrations, and evolve according to:<disp-formula id="pcbi.1002788.e006"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e006" xlink:type="simple"/><label>(1)</label></disp-formula>Here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e007" xlink:type="simple"/></inline-formula> is a weighted sum of neurotransmitter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e008" xlink:type="simple"/></inline-formula> into cell group firing rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e009" xlink:type="simple"/></inline-formula>, with coupling constants <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e010" xlink:type="simple"/></inline-formula>;<disp-formula id="pcbi.1002788.e011"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e011" xlink:type="simple"/><label>(2)</label></disp-formula>In addition, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e012" xlink:type="simple"/></inline-formula> is a first order process time constant. The steady state firing rate, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e013" xlink:type="simple"/></inline-formula>, a function of input neurotransmitter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e014" xlink:type="simple"/></inline-formula>, is given by maximum firing rate parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e015" xlink:type="simple"/></inline-formula>, times a sigmoidal function with midpoint <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e016" xlink:type="simple"/></inline-formula> and slope <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e017" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002788.e018"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e018" xlink:type="simple"/><label>(3)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e019" xlink:type="simple"/></inline-formula> is a constant for all cell groups except VLPO where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e020" xlink:type="simple"/></inline-formula> is proportional to the homeostatic sleep drive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e021" xlink:type="simple"/></inline-formula>. The concentration of neurotransmitter released by each cell group to the post-synaptic space also evolves according to a first order process with time constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e022" xlink:type="simple"/></inline-formula> and steady state neurotransmitter concentration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e023" xlink:type="simple"/></inline-formula> given by:<disp-formula id="pcbi.1002788.e024"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e024" xlink:type="simple"/><label>(4)</label></disp-formula><disp-formula id="pcbi.1002788.e025"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e025" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e026" xlink:type="simple"/></inline-formula> is an adjustable scale parameter.</p>
        <p>Because ACh comes from both the R and W/R cell groups, the total ACh concentration in the post-synaptic space is the sum of the ACh concentrations generated individually from these groups. Random excitatory projections from thalamocortical circuits to the Wake-active populations LC and DR are modeled as Poissonian impulses with a rate of 0.003 Hz, which through a leaky integrator form another input concentration denoted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e027" xlink:type="simple"/></inline-formula> with a decay constant of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e028" xlink:type="simple"/></inline-formula> seconds:<disp-formula id="pcbi.1002788.e029"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e029" xlink:type="simple"/><label>(6)</label></disp-formula></p>
        <p>In addition to firing rate and neurotransmitter concentration variables, the homeostatic drive variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e030" xlink:type="simple"/></inline-formula> regulates the duration of sleep and wake bouts by changing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e031" xlink:type="simple"/></inline-formula>, the threshold for firing of the NREM-active VLPO cell group. The accumulation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e032" xlink:type="simple"/></inline-formula> during Wake, and dissipation during sleep, is given by:<disp-formula id="pcbi.1002788.e033"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e033" xlink:type="simple"/><label>(7)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e034" xlink:type="simple"/></inline-formula> is the Heaviside function, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e035" xlink:type="simple"/></inline-formula> is the threshold parameter for the onset of increase or decrease in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e036" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e037" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e038" xlink:type="simple"/></inline-formula> determine the rate of accumulation and dissipation.</p>
        <p>Typical output of the DB model is shown in <xref ref-type="fig" rid="pcbi-1002788-g001">Fig. 1B</xref>. The top three traces are the time dynamics of the firing rates for the Wake-active (LC), NREM-active (VLPO), and REM-active (LDT/PPT) cell groups. Note that, following <xref ref-type="bibr" rid="pcbi.1002788-DinizBehn2">[4]</xref> we denote firing rate for the REM-active LDT/PPT cell group as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e039" xlink:type="simple"/></inline-formula>. The state of vigilance (SOV), or sleep state, shown as a hypnogram in the fourth trace, is determined by the rank-ordered comparison of these cell group activities, with LDT/PPT activity dominating the definition.</p>
      </sec>
      <sec id="s2c">
        <title>Fleshner, Booth, Forger and Diniz Behn (FBFD) Model of Sleep</title>
        <p>Fleshner, Booth, Forger and Diniz Behn <xref ref-type="bibr" rid="pcbi.1002788-Fleshner1">[12]</xref> introduced an extension of the DB model that includes the SCN as an additional cell group with GABA as its associated neurotransmitter <xref ref-type="bibr" rid="pcbi.1002788-Fleshner1">[12]</xref>, depicted in <xref ref-type="fig" rid="pcbi-1002788-g001">Fig. 1C</xref>. The firing rate of the SCN cell group follows the same dynamics as the cell groups in the DB model (<xref ref-type="disp-formula" rid="pcbi.1002788.e006">Eq. 1</xref>). The SCN has an inherent 24-hour circadian cycle (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e040" xlink:type="simple"/></inline-formula>), with higher activity during the 12-hour light phase and lower activity during the 12-hour dark phase.</p>
        <p>The projections from the sleep-wake network to the SCN provide dynamical feedback that increases the SCN's activity during both Wake and REM and decreases its activity during NREM. The SCN receives 5-HT and ACh synaptic inputs from the core sleep-wake regulatory system through the variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e041" xlink:type="simple"/></inline-formula>. This is modeled by composing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e042" xlink:type="simple"/></inline-formula> from the sum of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e043" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e044" xlink:type="simple"/></inline-formula>. Although the amplitude of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e045" xlink:type="simple"/></inline-formula> is smaller than that of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e046" xlink:type="simple"/></inline-formula>, its oscillation time-scale is faster, typically on the order of minutes.<disp-formula id="pcbi.1002788.e047"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e047" xlink:type="simple"/><label>(8)</label></disp-formula><disp-formula id="pcbi.1002788.e048"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e048" xlink:type="simple"/><label>(9)</label></disp-formula><disp-formula id="pcbi.1002788.e049"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e049" xlink:type="simple"/><label>(10)</label></disp-formula>Here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e050" xlink:type="simple"/></inline-formula> hours. We have shifted the phase of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e051" xlink:type="simple"/></inline-formula> from <xref ref-type="bibr" rid="pcbi.1002788-Fleshner1">[12]</xref> by adding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e052" xlink:type="simple"/></inline-formula> to make the light period (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e053" xlink:type="simple"/></inline-formula> high) start at 6 am. Feed-forward projections of the SCN on the sleep-wake network are mediated through GABAergic transmission, modeled by the additional neurotransmitter concentration <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e054" xlink:type="simple"/></inline-formula>, which adds into the dynamics of the LC, DR, VLPO, and R firing rates, modifying <xref ref-type="disp-formula" rid="pcbi.1002788.e011">Eq. (2)</xref> from the DB model to become:<disp-formula id="pcbi.1002788.e055"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e055" xlink:type="simple"/><label>(11)</label></disp-formula></p>
        <p>Typical output of the FBFD model on short time-scales is similar to that of the DB model. But, as is typical for real rats, on diurnal time-scales the typical duration times in different states, as well as cycle times through states, changes. The hypnogram of the output of this model is shown in <xref ref-type="fig" rid="pcbi-1002788-g001">Fig. 1D</xref> for a 36 hour period. Rats are nocturnal. In the model, REM and NREM are primarily observed during the putative light phase, while long periods of Wake are observed during the putative dark phases.</p>
      </sec>
      <sec id="s2d">
        <title>Unscented Kalman Filter</title>
        <p>The Kalman filter estimates the state of a system from noisy, sparsely measured, variables. Kalman's initial filter derivation <xref ref-type="bibr" rid="pcbi.1002788-Kalman1">[25]</xref> was for linear systems. The unscented Kalman filter is an ensemble version developed to tolerate nonlinearities without linearization <xref ref-type="bibr" rid="pcbi.1002788-Julier1">[26]</xref>.</p>
        <p>The details of the UKF algorithm can be found in many standard textbooks <xref ref-type="bibr" rid="pcbi.1002788-Schiff1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1002788-Simon1">[28]</xref>. We present here an overview, along with the key equations needed to understand details presented later in this manuscript.</p>
        <p>State estimation with the UKF is carried out recursively using a prediction-correction scheme. Each iteration starts with a best estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e056" xlink:type="simple"/></inline-formula> of the current state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e057" xlink:type="simple"/></inline-formula> at iteration time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e058" xlink:type="simple"/></inline-formula>. Included is an estimate of the current uncertainty in state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e059" xlink:type="simple"/></inline-formula>. A <italic>prediction</italic> or forecast is then generated by iterating an ensemble of points near <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e060" xlink:type="simple"/></inline-formula>, called sigma points, through the nonlinear model dynamics <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e061" xlink:type="simple"/></inline-formula>. Given a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e062" xlink:type="simple"/></inline-formula> dimensional state space for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e063" xlink:type="simple"/></inline-formula>, we choose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e064" xlink:type="simple"/></inline-formula> sigma points such that they have covariance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e065" xlink:type="simple"/></inline-formula> to represent the state uncertainty. We denote the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e066" xlink:type="simple"/></inline-formula> sigma point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e067" xlink:type="simple"/></inline-formula> prior to iteration, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e068" xlink:type="simple"/></inline-formula> after iteration. The model prediction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e069" xlink:type="simple"/></inline-formula> is then the mean of the forward iterated sigma points:<disp-formula id="pcbi.1002788.e070"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e070" xlink:type="simple"/><label>(12)</label></disp-formula>The prediction uncertainty <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e071" xlink:type="simple"/></inline-formula> is then the covariance of these points plus an additive covariance inflater matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e072" xlink:type="simple"/></inline-formula>.<disp-formula id="pcbi.1002788.e073"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e073" xlink:type="simple"/><label>(13)</label></disp-formula><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e074" xlink:type="simple"/></inline-formula> is nonzero only on the diagonal, and is added to account for underestimates of the forecast error, from the covariance of the sigma points, due to process noise and inadequacies in the filter model <xref ref-type="bibr" rid="pcbi.1002788-Miyoshi1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1002788-Anderson1">[30]</xref>. The prediction is then <italic>corrected</italic> to account for a measurement <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e075" xlink:type="simple"/></inline-formula> at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e076" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e077" xlink:type="simple"/></inline-formula> need not contain the same number of variables as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e078" xlink:type="simple"/></inline-formula>. The correction factor weights the observation and prediction according to the Kalman gain <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e079" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002788.e080"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e080" xlink:type="simple"/><label>(14)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e081" xlink:type="simple"/></inline-formula> denotes the prediction mean from the estimated sigma points for the observed variables, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e082" xlink:type="simple"/></inline-formula> :<disp-formula id="pcbi.1002788.e083"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e083" xlink:type="simple"/><label>(15)</label></disp-formula>The Kalman gain is formed from the ratio :<disp-formula id="pcbi.1002788.e084"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e084" xlink:type="simple"/><label>(16)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e085" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e086" xlink:type="simple"/></inline-formula> are formed from averages over the sigma points, either in the full dimensional space of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e087" xlink:type="simple"/></inline-formula> or in the subspace spanned by the measurements:<disp-formula id="pcbi.1002788.e088"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e088" xlink:type="simple"/><label>(17)</label></disp-formula><disp-formula id="pcbi.1002788.e089"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e089" xlink:type="simple"/><label>(18)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e090" xlink:type="simple"/></inline-formula> is the measurement uncertainty. The Kalman gain is also used to correct - and ideally collapse - the prediction uncertainty:<disp-formula id="pcbi.1002788.e091"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e091" xlink:type="simple"/><label>(19)</label></disp-formula></p>
        <p>Within this recursive scheme, the UKF synchronizes model state to measurements and thereby improves the estimate of the experimentally inaccessible variables. <italic>The limit to which this succeeds depends in part on the relative observability of the reconstructed model variables from the measured variables. We discuss below an empirical method for assessing this relative observability</italic>. We note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e092" xlink:type="simple"/></inline-formula>, the uncertainty of the measurement process usually can be estimated, using the assumption that measurement noise is normally distributed <xref ref-type="bibr" rid="pcbi.1002788-Mehra1">[31]</xref>–<xref ref-type="bibr" rid="pcbi.1002788-Wang1">[33]</xref>.</p>
        <p>On the other hand, the additive covariance inflation parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e093" xlink:type="simple"/></inline-formula> is less clearly defined. Some methods have been proposed to estimate its values under the limited case that its source is an additive process noise <xref ref-type="bibr" rid="pcbi.1002788-Korniyenko1">[34]</xref>–<xref ref-type="bibr" rid="pcbi.1002788-Rajamani1">[38]</xref>. Within our results - we demonstrate that even with identical system and model dynamics, non-zero <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e094" xlink:type="simple"/></inline-formula> improves tracking, and present a method of optimally choosing the values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e095" xlink:type="simple"/></inline-formula> for tracking and prediction.</p>
      </sec>
      <sec id="s2e">
        <title>Parameter Estimation</title>
        <p>One approach for parameter estimation within the UKF framework is to solve the dual problem of estimating parameters and states at the same time, for instance via an augmented state space approach <xref ref-type="bibr" rid="pcbi.1002788-Voss1">[11]</xref>. The alternative approach is to separate state reconstruction from parameter estimation by iteratively alternating between the two <xref ref-type="bibr" rid="pcbi.1002788-Deng1">[39]</xref>. We found that dual estimation did not work well for our high-dimensional sleep-models, likely in part due to the many degrees-of-freedom when neither parameters nor variables were fixed, and especially because in nonlinear systems the sensitivity of the dynamics to particular parameters can be highly dependent on location in state space. We therefore estimate parameters iteratively over windows of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e096" xlink:type="simple"/></inline-formula> that are longer than a typical sleep-wake cycle of the dynamics.</p>
        <p>Within our method, hidden states are first reconstructed with the UKF using a filter model with initial best-guess parameters. The full-state reconstruction over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e097" xlink:type="simple"/></inline-formula> is then used in a parameter estimation step which yields an updated parameter set. This updated parameter set is then passed to the UKF for the next iteration. This process is repeated until the parameter estimate has stabilized.</p>
        <p>The parameter estimation step is essentially an application of a multiple shooting method <xref ref-type="bibr" rid="pcbi.1002788-Voss1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002788-vanDomselaar1">[40]</xref>. Within each window, we estimate parameters by creating an average cost-function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e098" xlink:type="simple"/></inline-formula> that quantifies the divergence between short model-generated trajectories <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e099" xlink:type="simple"/></inline-formula> and the UKF-reconstructed trajectories <italic>for the measured variables</italic>. We then minimize this cost-function with respect to the parameter of interest. In order to prevent the model-generated trajectories from diverging too far from the reconstructed ones, we reinitialize <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e100" xlink:type="simple"/></inline-formula> on the reconstructed trajectories at regular intervals <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e101" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002788.e102"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e102" xlink:type="simple"/><label>(20)</label></disp-formula></p>
        <p>We then calculate a cost-function averaged over the window <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e103" xlink:type="simple"/></inline-formula> using the divergence between the model-generated trajectories <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e104" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e105" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1002788.e106"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e106" xlink:type="simple"/><label>(21)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e107" xlink:type="simple"/></inline-formula> denotes a matrix with non-zero elements on diagonal positions corresponding to measured elements. In order to properly weight the errors for each variable, the non-zero elements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e108" xlink:type="simple"/></inline-formula> are set to the inverse of the standard deviation of the associated variable. For our current implementation, we perform a minimization with respect to parameters by explicitly computing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e109" xlink:type="simple"/></inline-formula> for test parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e110" xlink:type="simple"/></inline-formula> and then choosing the one with the minimum <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e111" xlink:type="simple"/></inline-formula>. We use a constant value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e112" xlink:type="simple"/></inline-formula>, and restrict our parameter update maximally to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e113" xlink:type="simple"/></inline-formula> per iteration. Though somewhat computationally intensive, this method yields a stable approach to a local minimum in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e114" xlink:type="simple"/></inline-formula>. This also limits the resolution to which the parameter can be estimated.</p>
        <p>For estimation of non-stationary parameters, we use overlapping windows, with an update period of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e115" xlink:type="simple"/></inline-formula>. We note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e116" xlink:type="simple"/></inline-formula> should be greater than the maximal expected rate of change of the parameter of interest, to ensure that parameter dynamics are estimated with reasonable fidelity.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>Data Assimilation</title>
        <p>We can accurately reconstruct unmeasured variables of the DB model of sleep with the UKF framework. To demonstrate this, we generate data from this model, then apply a noisy observation function - the output of which is a noisy subset of the variables - to mimic experimental conditions. We then reconstruct the unobserved variables with the UKF. Finally, we validate this reconstruction by comparing to the original data set.</p>
        <p>An example of this procedure is shown in <xref ref-type="fig" rid="pcbi-1002788-g002">Fig. 2</xref>. Long multivariate time series of sleep-wake data were generated from the DB model. The observation function yielded a noisy univariate version of the firing rate of the Wake-active LC region <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e117" xlink:type="simple"/></inline-formula>. Explicitly we added random, normally-distributed, zero mean noise with variance of 4% that of the variance of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e118" xlink:type="simple"/></inline-formula> to the true values. We provided the framework the parameters used to generate the original data, and either default values (left panels) or optimized values (right panels) for the covariance inflation parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e119" xlink:type="simple"/></inline-formula>. Default values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e120" xlink:type="simple"/></inline-formula> were chosen as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e121" xlink:type="simple"/></inline-formula> times the typical variance of each variable. Additionally, the initial conditions of the model state, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e122" xlink:type="simple"/></inline-formula>, were arbitrarily chosen in each case.</p>
        <fig id="pcbi-1002788-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002788.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Reconstruction of DB Model Dynamics (A) with default values for covariance inflater <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e123" xlink:type="simple"/></inline-formula>, and (B) after optimization of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e124" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e125" xlink:type="simple"/></inline-formula>.</title>
            <p>Noisy measurements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e126" xlink:type="simple"/></inline-formula> (blue) were passed to the unscented kalman filter (UKF) framework to track and reconstruct all other variables. Shown are the firing rates for the Wake-active (LC), NREM-active (VLPO), and REM-active (LDT/PPT) cell groups, along with thalamic noise <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e127" xlink:type="simple"/></inline-formula>. The framework was given the same parameters used to generate the original data. In both A and B the same data was tracked with model initial conditions chosen randomly. After a transient period, reconstructed (red) Wake and NREM dynamics are close to true (black) dynamics. Without <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e128" xlink:type="simple"/></inline-formula> optimization the dynamics of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e129" xlink:type="simple"/></inline-formula> are essentially ignored. After <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e130" xlink:type="simple"/></inline-formula> optimization at least some of the stochastic <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e131" xlink:type="simple"/></inline-formula> dynamics - those that measurably affect the dynamics of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e132" xlink:type="simple"/></inline-formula> - are reconstructed and reconstruction of REM dynamics is improved.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002788.g002" position="float" xlink:type="simple"/>
        </fig>
        <p>Shown in <xref ref-type="fig" rid="pcbi-1002788-g002">Fig. 2</xref> are the reconstructed (red) and true (black) values of the NREM-active firing rate variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e133" xlink:type="simple"/></inline-formula>, the REM-active firing rate variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e134" xlink:type="simple"/></inline-formula> and the stochastic thalamic noise variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e135" xlink:type="simple"/></inline-formula>. In both cases of tracking, reconstruction of the observed variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e136" xlink:type="simple"/></inline-formula> is good. This can be seen from the closeness of the reconstructed traces to both the observation points, shown in blue, and the true values in black. Likewise, the reconstruction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e137" xlink:type="simple"/></inline-formula> also tracks the true state quite well.</p>
        <p>However, for the default values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e138" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e139" xlink:type="simple"/></inline-formula> is not reconstructed as well, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e140" xlink:type="simple"/></inline-formula> is not reconstructed at all. These errors extend to lower reconstruction fidelity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e141" xlink:type="simple"/></inline-formula> and even of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e142" xlink:type="simple"/></inline-formula>. On the other hand, when we use optimized <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e143" xlink:type="simple"/></inline-formula> values the reconstruction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e144" xlink:type="simple"/></inline-formula> is improved. In addition, much of the thalamic noise input through <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e145" xlink:type="simple"/></inline-formula> - which is stochastically driven and receives no input from the other variables - is now represented. For these reconstructions, we initialized the model state far from that of the true system state. Therefore, there is a transient period during which reconstruction is poor. In our experience, once the model state comes close to that of the true system, this data assimilation framework keeps the model relatively close to the system state.</p>
        <sec id="s3a1">
          <title>Quantification of reconstruction fidelity and observability</title>
          <p>Visual inspection of the similarity between the reconstructed and true dynamics is only a qualitative result. We therefore use the mean square difference between the reconstructed (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e146" xlink:type="simple"/></inline-formula>) and true (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e147" xlink:type="simple"/></inline-formula>) values for each variable to quantify the accuracy of state reconstruction. We normalize this error by the variance of each variable's dynamics to form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e148" xlink:type="simple"/></inline-formula>, a normalized mean square error for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e149" xlink:type="simple"/></inline-formula> variable :<disp-formula id="pcbi.1002788.e150"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e150" xlink:type="simple"/><label>(22)</label></disp-formula></p>
          <p>For perfect reconstruction, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e151" xlink:type="simple"/></inline-formula>. Its maximum depends on the ratio of the full range of the variable to the square root of its variance. For typical variables of the DB model this is of order 3, though for some such as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e152" xlink:type="simple"/></inline-formula> it is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e153" xlink:type="simple"/></inline-formula>. For visualization and regularization purposes, we therefore use the inverse of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e154" xlink:type="simple"/></inline-formula>, which is bounded between [0,1] as a reconstruction fidelity metric.</p>
          <p>The reconstruction fidelity of any particular variable may depend on framework parameters such as integration or reconstruction time step, covariance inflation, as well as qualities that are inherent to the model dynamics such as its observability. Observability is a structural property of a model defined as the ability to recover the model state through the observation of one or more of its outputs <xref ref-type="bibr" rid="pcbi.1002788-Kalman2">[41]</xref>. It is well known that not all variables can be used as observables to reconstruct the full dynamics. Nonetheless, information regarding the partial observability of each variable can be used to choose the optimal variable for measurement in the UKF framework.</p>
          <p>In <xref ref-type="fig" rid="pcbi-1002788-g003">Fig. 3</xref>, we show the reconstruction fidelity for each variable (down the columns) as a function of observation variable (across rows), in matrix format. We have used constant default values for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e155" xlink:type="simple"/></inline-formula>, the covariance inflation parameter, relative observation noise <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e156" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e157" xlink:type="simple"/></inline-formula> of the variable's variance, and no thalamic noise <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e158" xlink:type="simple"/></inline-formula>. In this color coded plot, red indicates good reconstruction, and blue indicates poor reconstruction.</p>
          <fig id="pcbi-1002788-g003" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002788.g003</object-id>
            <label>Figure 3</label>
            <caption>
              <title>Empirical Observability Coefficient (EOC) matrix.</title>
              <p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e159" xlink:type="simple"/></inline-formula> for the DB model with no thalamic noise and default values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e160" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e161" xlink:type="simple"/></inline-formula> is an empirical measure of how well variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e162" xlink:type="simple"/></inline-formula> is reconstructed from measurement of variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e163" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e164" xlink:type="simple"/></inline-formula> with perfect reconstruction being 1. Here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e165" xlink:type="simple"/></inline-formula> was computed using 12 hours of data. From the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e166" xlink:type="simple"/></inline-formula> matrix, we observe that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e167" xlink:type="simple"/></inline-formula> (row) is poorly observed - poorly reconstructed - from most variables, although its measurement (column) yields good reconstruction of almost all other variables.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002788.g003" position="float" xlink:type="simple"/>
          </fig>
          <p>The diagonal values in this matrix indicate how well a particular variable is reconstructed from itself. Though these tend toward the maximum, they are limited both by the noisy observation as well as the influence of the unobserved variables. Better reconstruction of the full dynamics is indicated by a column that has more red in it. To that extent the best observables for reconstruction are either <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e168" xlink:type="simple"/></inline-formula>, the firing rate of the REM-active group, or its synaptic output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e169" xlink:type="simple"/></inline-formula>. Likewise, the relative reconstruction of a variable from other variables can be gauged by the colors across its row.</p>
          <p>Given observation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e170" xlink:type="simple"/></inline-formula>, the best reconstructed variable is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e171" xlink:type="simple"/></inline-formula>, the firing rate of the Wake/REM-active cell group, although several other variables are reconstructed quite well according to high values down the column marked <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e172" xlink:type="simple"/></inline-formula>. The worst reconstructed variables are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e173" xlink:type="simple"/></inline-formula> and its synaptic output <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e174" xlink:type="simple"/></inline-formula>. We interpret this to mean that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e175" xlink:type="simple"/></inline-formula> is relatively <italic>less observable</italic> from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e176" xlink:type="simple"/></inline-formula> than is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e177" xlink:type="simple"/></inline-formula>. Furthermore, we assert that this is a useful empirical metric for gauging the partial observability of the state space from a measured variable, and name it the <italic>Empirical Observability Coefficient</italic> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e178" xlink:type="simple"/></inline-formula>):<disp-formula id="pcbi.1002788.e179"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002788.e179" xlink:type="simple"/><label>(23)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e180" xlink:type="simple"/></inline-formula> is the normalized reconstruction error for variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e181" xlink:type="simple"/></inline-formula> given measurement <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e182" xlink:type="simple"/></inline-formula>. Note for figure labels, we have left off the conditional reference to the measurements.</p>
          <p>From the fourth column of the EOC matrix shown in <xref ref-type="fig" rid="pcbi-1002788-g003">Fig. 3</xref>, we observe that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e183" xlink:type="simple"/></inline-formula> is reconstructed well only if we observe <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e184" xlink:type="simple"/></inline-formula> or <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e185" xlink:type="simple"/></inline-formula>, the concentration of ACh that this group transmits to the synaptic space. The poor reconstruction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e186" xlink:type="simple"/></inline-formula> is in part due to symmetries in its dynamics. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e187" xlink:type="simple"/></inline-formula> is summed together with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e188" xlink:type="simple"/></inline-formula>, the concentration of ACh transmitted from the Wake/REM-active cell group. As seen in <xref ref-type="disp-formula" rid="pcbi.1002788.e011">Eq. (2)</xref>, the total concentration of ACh <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e189" xlink:type="simple"/></inline-formula>, then appears as one of the input transmitters to the Wake-active, REM-active, and Wake/REM-active cell groups. For further discussion of the effect of symmetry on observability and time series reconstruction, see <xref ref-type="bibr" rid="pcbi.1002788-Letellier1">[42]</xref>.</p>
          <p>We did not include dynamics of the thalamic noise variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e190" xlink:type="simple"/></inline-formula> in the model used to generate the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e191" xlink:type="simple"/></inline-formula> to highlight patterns in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e192" xlink:type="simple"/></inline-formula> that would be obscured in the presence of this variable.</p>
          <p>We note that this empirical observability is related to the <italic>model</italic> used in the UKF framework, not the true dynamics of the system being tracked. In other words, we assess observability in the model. Assuming that the model represents some of the underlying true system dynamics, then those aspects of the true system will also be observable. The computation of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e193" xlink:type="simple"/></inline-formula> should be done from data generated from the model, not from observed data of the true system.</p>
        </sec>
      </sec>
      <sec id="s3b">
        <title>EOC Optimization of Covariance Inflation Parameter</title>
        <p>We can find optimal framework parameters, such as the UKF covariance inflation parameter matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e194" xlink:type="simple"/></inline-formula>, by maximizing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e195" xlink:type="simple"/></inline-formula> values. Although the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e196" xlink:type="simple"/></inline-formula> only has nonzero diagonal terms <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e197" xlink:type="simple"/></inline-formula>, for the full DB model including the thalamic noise output variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e198" xlink:type="simple"/></inline-formula>, there are 12 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e199" xlink:type="simple"/></inline-formula>'s. So blind simultaneous optimization is inefficient. But we can use the full <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e200" xlink:type="simple"/></inline-formula>, and the ranked partial observability, as a guide to this optimization.</p>
        <p>Note from <xref ref-type="disp-formula" rid="pcbi.1002788.e073">Eq. 13</xref> that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e201" xlink:type="simple"/></inline-formula> adds to the diagonal elements of the covariance of the sigma points. This inflation has the effect of widening the sigma points on the next iteration step, which results in an increase in the Kalman gain. Larger values for the Kalman gain bias the correction towards the measurements.</p>
        <p>Our general rule therefore is that if measurement of a variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e202" xlink:type="simple"/></inline-formula> yields poor reconstruction of other variables - i.e. low values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e203" xlink:type="simple"/></inline-formula> down a column - then we should favor measurement derived values of other variables over model derived ones, and therefore should use <italic>increased</italic> values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e204" xlink:type="simple"/></inline-formula>. On the other hand, if a variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e205" xlink:type="simple"/></inline-formula> is not reconstructed well from other variables - i.e. low values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e206" xlink:type="simple"/></inline-formula> across the row - we should favor model derived values over measurement derived values for this variable by decreasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e207" xlink:type="simple"/></inline-formula>.</p>
        <p>We iteratively compute the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e208" xlink:type="simple"/></inline-formula>, then choose the variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e209" xlink:type="simple"/></inline-formula> with the lowest scores down a row or column, and change its corresponding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e210" xlink:type="simple"/></inline-formula> appropriately. We then recompute the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e211" xlink:type="simple"/></inline-formula> and repeat. This prevents us from optimizing with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e212" xlink:type="simple"/></inline-formula>'s that have only modest impact on reconstruction fidelity.</p>
        <p>There is a finite usable range for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e213" xlink:type="simple"/></inline-formula>. As an inflater for the covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e214" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e215" xlink:type="simple"/></inline-formula> must be greater than or equal to zero. The standard deviation and range of the dynamics of variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e216" xlink:type="simple"/></inline-formula> are two natural scales that can be used to define the usable range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e217" xlink:type="simple"/></inline-formula>. We use the square of the former, multiplied by a proportionality constant, as a default starting value for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e218" xlink:type="simple"/></inline-formula>. The square of the latter forms the maximum for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e219" xlink:type="simple"/></inline-formula>.</p>
        <p>We now demonstrate this algorithm to optimize reconstructions given measurements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e220" xlink:type="simple"/></inline-formula>, as in <xref ref-type="fig" rid="pcbi-1002788-g002">Fig. 2B</xref>. The full <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e221" xlink:type="simple"/></inline-formula> for the DB model - including <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e222" xlink:type="simple"/></inline-formula> - with default <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e223" xlink:type="simple"/></inline-formula> is shown in <xref ref-type="fig" rid="pcbi-1002788-g004">Fig. 4A</xref>. From the far right column, we observed that <italic>no</italic> variables are reconstructed well from measurements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e224" xlink:type="simple"/></inline-formula>. This is understandable, since the dynamics of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e225" xlink:type="simple"/></inline-formula> receive no input from any of the other variables. Therefore we start our optimization of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e226" xlink:type="simple"/></inline-formula> by adjusting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e227" xlink:type="simple"/></inline-formula>, and explicitly expect to increase it.</p>
        <fig id="pcbi-1002788-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002788.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Optimization of Covariance Inflater <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e228" xlink:type="simple"/></inline-formula>.</title>
            <p>Although the individual EOCs are metrics of reconstruction fidelity, the ranked observability, from the full <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e229" xlink:type="simple"/></inline-formula> can be used to guide optimization of the covariance inflater <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e230" xlink:type="simple"/></inline-formula>: Poorly observed variables across their rows - low <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e231" xlink:type="simple"/></inline-formula> - should have decreased <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e232" xlink:type="simple"/></inline-formula>. Variables whose measurement yields poor reconstruction columnwise- low <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e233" xlink:type="simple"/></inline-formula> - should have increased <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e234" xlink:type="simple"/></inline-formula>. Algorithmically, we iteratively adjust <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e235" xlink:type="simple"/></inline-formula> for the variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e236" xlink:type="simple"/></inline-formula> with the overall lowest mean row or column. In A–C are shown the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e237" xlink:type="simple"/></inline-formula> matrix after each optimization iteration for the full DB model with thalamic noise. A) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e238" xlink:type="simple"/></inline-formula> computed with default values for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e239" xlink:type="simple"/></inline-formula>, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e240" xlink:type="simple"/></inline-formula>. Note that the lowest mean row/column corresponds to the measurement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e241" xlink:type="simple"/></inline-formula>, therefore we optimize <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e242" xlink:type="simple"/></inline-formula> first. B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e243" xlink:type="simple"/></inline-formula> after optimization of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e244" xlink:type="simple"/></inline-formula>. C) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e245" xlink:type="simple"/></inline-formula> after optimizing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e246" xlink:type="simple"/></inline-formula>. Shown are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e247" xlink:type="simple"/></inline-formula> as a function of D) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e248" xlink:type="simple"/></inline-formula> for optimization step between A and B and E) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e249" xlink:type="simple"/></inline-formula> for optimization steps between B and C. Optimal values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e250" xlink:type="simple"/></inline-formula> are chosen from the peaks of these plots.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002788.g004" position="float" xlink:type="simple"/>
        </fig>
        <p>Shown in <xref ref-type="fig" rid="pcbi-1002788-g004">Fig. 4D</xref> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e251" xlink:type="simple"/></inline-formula> as a function of increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e252" xlink:type="simple"/></inline-formula>. Although only the trace for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e253" xlink:type="simple"/></inline-formula> is shown, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e254" xlink:type="simple"/></inline-formula> increases for most variables as a function of increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e255" xlink:type="simple"/></inline-formula>. We pick optimal values for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e256" xlink:type="simple"/></inline-formula> based on the average peak reconstruction of all variables from measurement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e257" xlink:type="simple"/></inline-formula>, found with a value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e258" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e259" xlink:type="simple"/></inline-formula>. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e260" xlink:type="simple"/></inline-formula> matrix after this first <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e261" xlink:type="simple"/></inline-formula> optimization iteration is shown in <xref ref-type="fig" rid="pcbi-1002788-g004">Fig. 4B</xref>.</p>
        <p>Notably, although <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e262" xlink:type="simple"/></inline-formula> is the variable measured from the real system, its reconstruction improves when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e263" xlink:type="simple"/></inline-formula> is increased. This effect can be further understood by inspection of <xref ref-type="fig" rid="pcbi-1002788-g002">Fig. 2</xref>. The brief increases in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e264" xlink:type="simple"/></inline-formula> from its low value - interpreted behaviorally as brief awakenings that correlate with spikes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e265" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1002788-g002">Fig. 2</xref>, are better reconstructed with optimized <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e266" xlink:type="simple"/></inline-formula>. Indeed, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e267" xlink:type="simple"/></inline-formula> matrix values overall, shown in <xref ref-type="fig" rid="pcbi-1002788-g004">Fig. 4B</xref>, have increased with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e268" xlink:type="simple"/></inline-formula>.</p>
        <p>Now the row/column with the lowest values, on average, corresponds to reconstruction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e269" xlink:type="simple"/></inline-formula>. Therefore we expect to need to decrease <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e270" xlink:type="simple"/></inline-formula> to improve reconstruction. Reconstruction fidelity of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e271" xlink:type="simple"/></inline-formula> from measurement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e272" xlink:type="simple"/></inline-formula>, as measured by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e273" xlink:type="simple"/></inline-formula> is shown in <xref ref-type="fig" rid="pcbi-1002788-g004">Fig. 4E</xref> as a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e274" xlink:type="simple"/></inline-formula>. Reconstruction improves with decreasing values over the potential usable range. As shown by the black horizontal line, the best reconstruction is achieved using the minimum value of 0 for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e275" xlink:type="simple"/></inline-formula>, although values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e276" xlink:type="simple"/></inline-formula> smaller than the default value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e277" xlink:type="simple"/></inline-formula> result only in marginal reconstruction improvement. This second optimization step yields only marginal improvement in the overall <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e278" xlink:type="simple"/></inline-formula> matrix shown in <xref ref-type="fig" rid="pcbi-1002788-g004">Fig. 4C</xref>. In part, this lack of improvement in reconstruction is due to the poor observability of REM dynamics through other variables as apparent from the row marked <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e279" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1002788-g003">Fig. 3</xref>.</p>
      </sec>
      <sec id="s3c">
        <title>Empirical Observability and Choice of Measured Variables</title>
        <p>We investigated pairings of two or more variables with respect to their relative partial observability. We found that for the DB and FBFD models, the empirical observability of variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e280" xlink:type="simple"/></inline-formula> given measurements of variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e281" xlink:type="simple"/></inline-formula> is always at least as good as the individual <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e282" xlink:type="simple"/></inline-formula>: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e283" xlink:type="simple"/></inline-formula>. We also observed that good reconstruction of all variables requires some measurement of both Wake and REM dynamics. These states are readily observed from real biological systems from external physiological measurements such as power bands in the EEG, muscle tone, and eye movement. Therefore, for the subsequent computations, we assimilate noisy measurements of both Wake-active <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e284" xlink:type="simple"/></inline-formula> and REM-active <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e285" xlink:type="simple"/></inline-formula> dynamics, and use them to reconstruct the full system state and derive parameter values.</p>
      </sec>
      <sec id="s3d">
        <title>Parameter Fitting</title>
        <p>As applied here, the UKF framework requires both a model for the dynamics as well as the model's parameters. We have implemented a version of a multiple shooting method <xref ref-type="bibr" rid="pcbi.1002788-Voss1">[11]</xref> for optimizing the choice of parameters. The performance of this method is illustrated in <xref ref-type="fig" rid="pcbi-1002788-g005">Fig. 5</xref>.</p>
        <fig id="pcbi-1002788-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002788.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Parameter estimation with multiple shooting method for reconstruction of DB model from measurement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e286" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e287" xlink:type="simple"/></inline-formula> with unknown value for parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e288" xlink:type="simple"/></inline-formula>.</title>
            <p>Parameter estimation is performed by minimizing the divergence between the UKF reconstructed dynamics and short model-generated trajectories that originate on the reconstructed trajectories. To sample the full state space, each step of this minimization averages this divergence over time windows longer than the cycle time of the dynamics. Here we use half hour windows, with 80% overlap. A) Convergence of the estimated parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e289" xlink:type="simple"/></inline-formula> to the true value. B) Trajectories for the short model generated (magenta), reconstructed (red), and true (black) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e290" xlink:type="simple"/></inline-formula> dynamics for different periods of the convergence of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e291" xlink:type="simple"/></inline-formula>. Note that initially, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e292" xlink:type="simple"/></inline-formula> significantly different than the true value, the short trajectories diverge quickly from the reconstructed values, and the reconstructed values of of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e293" xlink:type="simple"/></inline-formula> are different from the true values. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e294" xlink:type="simple"/></inline-formula> approaches the true value, both short model-generated and reconstructed trajectories approach the true values. C) Reconstruction metric <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e295" xlink:type="simple"/></inline-formula> computed for each data assimilation window for three of the variables. As a reference point, the reconstruction metric for the original noisy observation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e296" xlink:type="simple"/></inline-formula> is shown in blue. Note that although the parameter estimation essentially optimizes short model generated forecasts, it has the effect of optimizing hidden variable reconstruction.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002788.g005" position="float" xlink:type="simple"/>
        </fig>
        <p>For illustration purposes we generated data with fixed parameters and assimilated noisy measurements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e297" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e298" xlink:type="simple"/></inline-formula> to reconstruct the dynamics. Initially, all model parameters in the UKF were set to the same values used to generate the true data set - except the parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e299" xlink:type="simple"/></inline-formula> that couples ACh into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e300" xlink:type="simple"/></inline-formula> dynamics. To this we supplied an arbitrary initial value.</p>
        <p>Parameter estimation is performed by minimizing the distance between the UKF reconstructed traces and short model-generated trajectories that originate on the reconstructed traces. For these computations, we set the length of these short trajectories at 2 minutes. This is long enough that differences in parameters result in measurable divergence between the short computed trajectories and the reconstructed dynamics. Here <italic>measurable</italic> is much larger than the measurement noise, but not so large that the distance between the computed and reconstructed trajectories becomes comparable to the range of the state space.</p>
        <p>To sample the full state space, each step of this minimization averages this divergence over time windows longer than the sleep-wake cycle time of the dynamics. As seen in <xref ref-type="fig" rid="pcbi-1002788-g005">Fig. 5A</xref>, our estimation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e301" xlink:type="simple"/></inline-formula> converges to the true value. In <xref ref-type="fig" rid="pcbi-1002788-g005">Fig. 5B</xref>, we plot trajectories for the short model-generated (magenta), reconstructed (red), and true (black) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e302" xlink:type="simple"/></inline-formula> dynamics for different periods of the convergence of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e303" xlink:type="simple"/></inline-formula>. Note that initially, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e304" xlink:type="simple"/></inline-formula> significantly different than the true value, the short trajectories diverge quickly from the reconstructed values, and the reconstructed values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e305" xlink:type="simple"/></inline-formula> are different from the true ones. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e306" xlink:type="simple"/></inline-formula> approaches the true value, both the short model-generated and reconstructed trajectories approach the true dynamics.</p>
        <p>As coded, the parameter estimation essentially optimizes short model-generated forecasts. To investigate the effect on reconstruction fidelity, we compute the normalized mean square reconstruction error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e307" xlink:type="simple"/></inline-formula> for each variable, averaged over each parameter estimation window. This is shown for variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e308" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e309" xlink:type="simple"/></inline-formula>, and the homeostatic drive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e310" xlink:type="simple"/></inline-formula>. We note that for initial values of this parameter, even reconstruction of the measured variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e311" xlink:type="simple"/></inline-formula> is quite poor - with typical errors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e312" xlink:type="simple"/></inline-formula> of its standard deviation. As a reference point, the initial measured data - a noisy version of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e313" xlink:type="simple"/></inline-formula> - has a normalized mean squared error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e314" xlink:type="simple"/></inline-formula>, shown as a horizontal blue line. As the estimated parameter converges, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e315" xlink:type="simple"/></inline-formula> falls well below <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e316" xlink:type="simple"/></inline-formula>, and the reconstruction metric improves for all variables.</p>
      </sec>
      <sec id="s3e">
        <title>Dynamical Parameter Tracking</title>
        <p>We can also estimate parameters which change slowly over time. We demonstrate this by using a slightly modified DB model, which lacks any circadian dynamics, to reconstruct dynamics observed from the expanded FBFD model which specifically includes SCN driven circadian oscillations. We use this modified DB model to assimilate noisy measurements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e317" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e318" xlink:type="simple"/></inline-formula> from the full FBFD model, and use it within the multiple shooting method to estimate the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e319" xlink:type="simple"/></inline-formula>.</p>
        <p>An example of the output is shown in <xref ref-type="fig" rid="pcbi-1002788-g006">Fig. 6</xref> for a 1.5 day period. We have skipped the initial 12 hours which includes a transient period of convergence of both the filter and the parameter estimate. The effect of the SCN is to modulate the overall sleep cycles, with frequent sleep periods that include REM in the light period and dominant, longer Wake periods in the dark period. Short example time series for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e320" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e321" xlink:type="simple"/></inline-formula> are shown in the panels in <xref ref-type="fig" rid="pcbi-1002788-g006">Fig. 6A</xref> for different phases of the circadian cycle. The filter model in the UKF, also used in parameter estimation, is missing these SCN associated variables and the fast feedback oscillations resulting from their interaction with the sleep network. However, we replace the input contribution of the SCN's feed forward GABAergic projections on to the sleep network to a single quasi-static parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e322" xlink:type="simple"/></inline-formula> that gets added to other neurotransmitter variables in <xref ref-type="disp-formula" rid="pcbi.1002788.e055">Eq. (11)</xref>. We then estimate this parameter which represents the presumed SCN drive.</p>
        <fig id="pcbi-1002788-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002788.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Parameter Tracking to accommodate circadian dynamics.</title>
            <p>Noisy measurements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e323" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e324" xlink:type="simple"/></inline-formula> from the full FBFD model were assimilated with a version of the DB model that represented input from the SCN as a quasi-static parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e325" xlink:type="simple"/></inline-formula> whose value was estimated and tracked in 80% overlapping half hour windows. SCN activity imposes circadian and light-driven dynamics that modulate sleep-wake cycles and prevalence of either sleep or wake activity. A) Short excerpts of reconstructed dynamics for various phases of the circadian cycle. B) Estimated (magenta) and true (black) value of the tracked parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e326" xlink:type="simple"/></inline-formula>. Note that the tracked value is an estimate, with inherent smoothing on the time scale of a half hour, and therefore does not reconstruct all of the detailed dynamics of the true value which oscillates due to the interplay between the core sleep-wake regulatory cell groups and the SCN. C) Normalized reconstruction error for various variables. As a reference, the reconstruction error for the noisy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e327" xlink:type="simple"/></inline-formula> measurement is shown in blue. The reconstruction of unobserved variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e328" xlink:type="simple"/></inline-formula> and homeostatic sleep drive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e329" xlink:type="simple"/></inline-formula> is quite good as indicated by small <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e330" xlink:type="simple"/></inline-formula> values.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002788.g006" position="float" xlink:type="simple"/>
        </fig>
        <p>The estimated value for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e331" xlink:type="simple"/></inline-formula> (magenta) is shown in <xref ref-type="fig" rid="pcbi-1002788-g006">Fig. 6B</xref>, along with the true input from SCN in the generating model (black). Though the reconstructed parameter is an estimate with inherent averaging over half-hour periods, and therefore does not reproduce the fast dynamics of the real SCN input, it tracks the mean value quite well. In addition, it yields good reconstruction of the model variables. Examples of the normalized reconstruction error, averaged over the fitting windows, are shown in <xref ref-type="fig" rid="pcbi-1002788-g006">Fig. 6C</xref> for sample variables. Here again, as a reference point, we plot the mean squared error for the noisy measurement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e332" xlink:type="simple"/></inline-formula> (blue line) in the top panel of <xref ref-type="fig" rid="pcbi-1002788-g006">Fig. 6C</xref>. Note that even reconstruction of the homeostatic sleep drive <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e333" xlink:type="simple"/></inline-formula>, which has no direct coupling to the observed variables, is quite good over most of the day.</p>
      </sec>
      <sec id="s3f">
        <title>Reconstruction from the Hypnogram</title>
        <p>So far, we have implemented the data assimilation framework using measurements that amount to noisy versions of the true variables. In real applications, when one uses observations from real systems, the actual system measurements might only remotely resemble variables in the tracking model. But even in this case, data assimilation methods can still be used. To this end, we demonstrate that we can use measurements of state-of-vigilance (SOV) generated from the model and illustrated in <xref ref-type="fig" rid="pcbi-1002788-g001">Fig. 1B</xref>, to reconstruct the unobserved model dynamics with reasonable fidelity.</p>
        <p>The method we have implemented is illustrated in <xref ref-type="fig" rid="pcbi-1002788-g007">Fig. 7</xref>. We sleep-score the model-generated data, also used in <xref ref-type="fig" rid="pcbi-1002788-g002">Figs. 2</xref>–<xref ref-type="fig" rid="pcbi-1002788-g003"/><xref ref-type="fig" rid="pcbi-1002788-g004"/><xref ref-type="fig" rid="pcbi-1002788-g005">5</xref>, by assigning an SOV to each point as a function of time. The SOV is determined based on relative values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e334" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e335" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e336" xlink:type="simple"/></inline-formula>. We then take the filter model, and generate example data, which we also sleep-score. From this scored filter-model data, we compute the probability distribution functions (pdf) for the variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e337" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e338" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e339" xlink:type="simple"/></inline-formula> conditioned on SOV. These are illustrated in <xref ref-type="fig" rid="pcbi-1002788-g007">Fig. 7A</xref>. Note that these state-dependent distributions are highly skewed, and have small variance around the mean.</p>
        <fig id="pcbi-1002788-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002788.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Reconstruction of DB dynamics from measured hypnogram.</title>
            <p>SOV is used along with an inferred observation function to translate an observed hypnogram into state conditioned observations for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e340" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e341" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e342" xlink:type="simple"/></inline-formula>, and their variances. We use the UKF to reconstruct the full variable state space from these observations. A) Probability distributions of firing rates for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e343" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e344" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e345" xlink:type="simple"/></inline-formula> during Wake (black), NREM (red), and REM (blue). These firing rates were generated from the filter-model. B) Hypnogram of observed SOV for a 1 hour time series, with colors to match (A). C) Reconstructed (red) and true (black) traces for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e346" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e347" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e348" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e349" xlink:type="simple"/></inline-formula>. The inferred observation for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e350" xlink:type="simple"/></inline-formula> is also shown (blue). After a transient period, the reconstruction converges to the true value, even for the homeostatic drive variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e351" xlink:type="simple"/></inline-formula> which was not observed. However, details of the dynamics that are not accounted for by the state-of-vigilance (SOV) such as brief awakenings and transitions into and out of NREM are not reconstructed well.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002788.g007" position="float" xlink:type="simple"/>
        </fig>
        <p>The observation function from the measured values - here SOV as a function of time shown in <xref ref-type="fig" rid="pcbi-1002788-g007">Fig. 7B</xref> - must provide values and error estimates of variables in the filter model to the UKF. To translate the observed SOV to inputs to the UKF, we use the state-conditioned medians from the above-generated pdfs, and then use the state-conditioned standard deviations as the measurement uncertainties. In this way, we use observations of SOV to infer observations of the model variables. We then use these observations, shown for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e352" xlink:type="simple"/></inline-formula> in blue in <xref ref-type="fig" rid="pcbi-1002788-g007">Fig. 7C</xref>, as inputs to the UKF. Note that in this case, the measurement noise estimates are time dependent. After a short transient convergence time, the reconstructed dynamics converge close to the true dynamics. However, certain details such as brief awakenings and transitions into NREM are not reconstructed well.</p>
        <p>We can likewise apply all the other tools described here to assimilation of SOV data through this inferred observation function. Shown in <xref ref-type="fig" rid="pcbi-1002788-g008">Fig. 8</xref> is the same parameter estimation procedure as shown in <xref ref-type="fig" rid="pcbi-1002788-g005">Fig. 5</xref>, with the same initial conditions for unknown parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e353" xlink:type="simple"/></inline-formula>. Although the convergence is not as good as with direct observation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e354" xlink:type="simple"/></inline-formula>, the estimated parameter does approach the parameter used to generate the data. The reconstruction error in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e355" xlink:type="simple"/></inline-formula> decreases as the parameter approaches its correct value, however neither converge all the way. This can be understood because the UKF attempts to constrain the observed variables to the median values mapped from the SOV. Likewise, the parameter estimation algorithm attempts to minimize the error between model forecasts and reconstructions for the observed variables.</p>
        <fig id="pcbi-1002788-g008" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002788.g008</object-id>
          <label>Figure 8</label>
          <caption>
            <title>Parameter estimation from observed hypnogram for reconstruction of DB model from inferred measurement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e356" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e357" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e358" xlink:type="simple"/></inline-formula> with unknown value for parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e359" xlink:type="simple"/></inline-formula>.</title>
            <p>A) Convergence of the estimated parameter(magenta) to the true value (black). B) Trajectories for the short model-generated (magenta), reconstructed (red), and true (black) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e360" xlink:type="simple"/></inline-formula> dynamics for different periods of the convergence of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e361" xlink:type="simple"/></inline-formula>. C) Reconstruction metric <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e362" xlink:type="simple"/></inline-formula> computed for each data assimilation window for three of the variables. Horizontal dashed lines correspond to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e363" xlink:type="simple"/></inline-formula> computed from the state-conditioned discrete map used to translate the SOV to model space. Note that once the parameter is optimized, the UKF reconstruction far outperforms the observation map.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002788.g008" position="float" xlink:type="simple"/>
        </fig>
        <p>As a supplemental performance metric, we also consider the reconstruction error if we simply use the median observation map for all variables as our reconstruction. These are plotted as horizontal dashed lines for each variable in <xref ref-type="fig" rid="pcbi-1002788-g008">Fig. 8C</xref>. The UKF reconstruction error for the observed variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e364" xlink:type="simple"/></inline-formula> improves beyond this reference point as parameter estimation improves. In contrast, the UKF reconstruction errors for unobserved variables such as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e365" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e366" xlink:type="simple"/></inline-formula> are overall far better.</p>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>Data assimilation is a valuable tool in the study of any complex system, where measurements are incomplete, uncertain, or both. It enables the user to take advantage of all available information including experimental measurements and short-term model forecasts of a system. Since the introduction of the UKF to neuronal dynamics by Voss et al. in 2004 <xref ref-type="bibr" rid="pcbi.1002788-Voss1">[11]</xref>, a few investigators have applied these methods to the study of biological systems <xref ref-type="bibr" rid="pcbi.1002788-Hu1">[43]</xref>–<xref ref-type="bibr" rid="pcbi.1002788-Freestone1">[48]</xref>. Other data assimilation techniques have also been successfully applied to study neuronal dynamics <xref ref-type="bibr" rid="pcbi.1002788-Toth1">[49]</xref>. Nevertheless, the sleep modeling community has yet to utilize these resources. Several important advantages of data assimilation in sleep modeling are : 1) access to unmeasured variables to create a more complete estimate of model state 2) subject-specific parameter estimation even when the parameter is associated with an unobserved variable 3) allowance for uncertainty in model structure or measurements and 4) prediction of future dynamics.</p>
      <p>Not all variables perform equally in reconstructing the state space. In biological experiments utilizing data assimilation it would be beneficial to have some insight into the relative performance of each variable so that we can choose the best one or ones for measurement. A natural metric to guide this choice is the observability of each variable. Letellier et al. showed in <xref ref-type="bibr" rid="pcbi.1002788-Letellier2">[50]</xref> that observability and ability to synchronize are related. Since the UKF is basically a synchronization scheme, it follows that reconstruction-performance by any variable should be a function of its observability. Thus we propose using observability based metrics in the study of partially observed biological systems.</p>
      <p>Analytical methods to determine observability for nonlinear systems are mathematically rigorous, require rational models, and generally do not produce graded values for partial observability. Letellier et al. <xref ref-type="bibr" rid="pcbi.1002788-Letellier3">[51]</xref>, <xref ref-type="bibr" rid="pcbi.1002788-Letellier4">[52]</xref> proposed a simple algebraic solution to rank all variables of a system according to their relative partial observability. Although their approach works well for low-dimensional systems, we found it problematic for our high-dimensional sparsely connected system, where many variables are directly coupled to just one or two other variables, and where the coupling is effectively on only in highly localized regions of state space.</p>
      <p>Inspired by their work, we developed an empirical metric, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e367" xlink:type="simple"/></inline-formula>, to rank the partial observability of each variable based on reconstructed error. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e368" xlink:type="simple"/></inline-formula> can be used to select the optimal observed variable to obtain the best estimate of a particular unobserved variable. The absolute optimal observed variable receives as input to its dynamics unambiguous invertible information about the state of the unobserved variable. Here invertible implies a one-to-one (bijectvie) relationship between the unobserved and observed variables. In complex networks, this observability is modulated by the number and relative weights of additional unobserved variables in the system that couple into the dynamics of the observed variable <xref ref-type="bibr" rid="pcbi.1002788-Letellier2">[50]</xref>–<xref ref-type="bibr" rid="pcbi.1002788-Letellier4">[52]</xref>.</p>
      <p>Because the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e369" xlink:type="simple"/></inline-formula> is a measure of reconstruction fidelity, we demonstrate that the reconstruction framework parameters can be optimized by improving it. Importantly, we described an intuitive approach to use the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e370" xlink:type="simple"/></inline-formula> to optimize the covariance inflation parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e371" xlink:type="simple"/></inline-formula>. Although some analytical methods have been proposed for this task in nonlinear systems <xref ref-type="bibr" rid="pcbi.1002788-Korniyenko1">[34]</xref>–<xref ref-type="bibr" rid="pcbi.1002788-Rajamani1">[38]</xref>, we are unaware of an observability-based metric for covariance inflation optimization.</p>
      <p>Correct parameter estimates aid the prediction of future dynamics and model selection and verification and can provide useful biological information. A common method for parameter estimation in nonlinear models utilizes a feedback-synchronization scheme, developed by <xref ref-type="bibr" rid="pcbi.1002788-Pecora1">[53]</xref> and extended by <xref ref-type="bibr" rid="pcbi.1002788-Parlitz1">[54]</xref>–<xref ref-type="bibr" rid="pcbi.1002788-Abarbanel1">[58]</xref> and many others. Within such a scheme, two identical - except for unknown parameters - systems are unidirectionally coupled, and are continuously synchronized through error feedback. The parameters of the responder are allowed to vary - often using a gradient-decent approach - to minimize a cost function based on driver-responder distance. Although these methods have been shown to work well for systems with smooth variables we found that the sharp transitions in our firing rates, and the highly variable sensitivity of the dynamics to particular parameters as a function of position in state space, resulted in unstable and inaccurate parameter estimates.</p>
      <p>We therefore adopted a multiple shooting parameter estimation method <xref ref-type="bibr" rid="pcbi.1002788-Voss1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002788-vanDomselaar1">[40]</xref> that estimates divergence of short model forecasts from the UKF reconstructed trajectories over time windows long enough to explore the state space. This estimation step involves the minimization of a least-squared error, and can therefore be cast as a maximum-likelihood step. This is done in an iterative fashion to update parameter estimates by minimizing divergence of trajectories reconstructed using previous parameter estimates. Therefore this method becomes an expectation-maximization method, with all the associated global optimization implications <xref ref-type="bibr" rid="pcbi.1002788-Vaida1">[59]</xref>, <xref ref-type="bibr" rid="pcbi.1002788-Wu1">[60]</xref>.</p>
      <p>Estimation of one or more parameters with any parameter estimation method will be inherently limited by the identifiability of the state space. Identifiability is a structural property of a model defined as the ability to identify a unique set of parameter values given error-free observations of the dynamics <xref ref-type="bibr" rid="pcbi.1002788-Jacquez1">[61]</xref>. A comparable experimental or empirical version of identifiability has also been discussed by<xref ref-type="bibr" rid="pcbi.1002788-Raue1">[62]</xref>–<xref ref-type="bibr" rid="pcbi.1002788-Margaria1">[65]</xref>. If some parameters are not structurally identifiable no parameter estimation method will prevail. Our experience and expectation is that the multiple shooting method will converge reasonably for combinations of identifiable parameters, but the convergence time increases with the number of parameters.</p>
      <p>A key advantage of using the UKF for state reconstruction is allowance for uncertainties in the model and/or measurements. As noted, the Kalman filter is an iterative prediction-correction scheme. By altering the elements of the covariance inflation parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e372" xlink:type="simple"/></inline-formula> and measurement uncertainty <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e373" xlink:type="simple"/></inline-formula>, we can guide the Kalman filter to favor either the observations or model predictions. Higher values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e374" xlink:type="simple"/></inline-formula> downgrade the model-based forecasts during the correction step. We utilized this when developing the method for optimizing choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e375" xlink:type="simple"/></inline-formula> values based on the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002788.e376" xlink:type="simple"/></inline-formula>. For those variables that are poorly observed from others, we more heavily weight prediction over measurement; for those that yield poor reconstruction of other variables, we more heavily weight measurements.</p>
      <p>Furthermore, as we showed in <xref ref-type="fig" rid="pcbi-1002788-g006">Fig. 6</xref>, inadequate models - which omit the full dynamics of certain variables - can be used to successfully assimilate experimental data and estimate unknown dynamics. In this example, we used a model that lacked any circadian dependencies to correctly estimate a 24-hour cycle and the mediated interaction with the SCN. Therefore our data assimilation framework can tolerate inadequate models and uncover dynamics outside the scope of the model's governing equations.</p>
      <p>Several issues must be considered for assimilation of biological measurements. First, initial values for the filter parameters should be estimated off-line via the iterative reconstruct state/estimate parameter approach. During this off-line learning process, non-arbitrary initial values for the covariance matrices as well as model parameters can be determined. Second, we will not have access to many of the state variables for validation. Previously, we developed a system that can automatically stage the behavioral state of a freely moving animal in real time <xref ref-type="bibr" rid="pcbi.1002788-Sunderam1">[66]</xref>, based on measurements of EEG and head acceleration with a resolution of a few seconds. This process can validate the UKF's predictions of sleep-state transitions. We can also use the scored behavioral state to infer the value of the Wake-active, NREM-active, and REM-active firing rate variables. As we have shown in <xref ref-type="fig" rid="pcbi-1002788-g007">Fig. 7</xref> and <xref ref-type="fig" rid="pcbi-1002788-g008">Fig. 8</xref>, we can then use these inferred measurements to reconstruct hidden variables and estimate unknown parameters.</p>
      <p>It is technically feasible to measure extracellular neurotransmitter concentrations using either dialysis or electrochemical sensors. Dialysis measurements do not have the temporal resolution to resolve REM dynamics, which occur on the order of one minute or less in the rodent, or the spatial specificity to localize dynamics to sleep-wake nuclei in the rodent brain. However these measurements could be used to track and validate slow systemic dynamics such as the circadian variations that modulate the sleep-wake nuclei. In contrast, off-the-shelf electrochemical sensor technology <xref ref-type="bibr" rid="pcbi.1002788-Michael1">[67]</xref> allows for highly localized measures of neurochemicals such as ACh and 5-HT with sub-second temporal resolution and sub-mm spatial resolution. Such measurements can and should be used to establish and validate models used within the data assimilation framework. In addition, they can be used to identify the subset of measurements that can be accurately reconstructed from less costly observations. An appropriate cost-function for biological data assimilation would balance the degree of reconstruction inaccuracy against the cost of obtaining risky or hard-to-access measurements.</p>
      <p>We also note that this framework could potentially be used to choose among model dynamics. Our parameter estimation methods rely on a minimization of prediction error. A similar metric or cost function could be utilized to differentiate between UKF-based tracking and prediction of system dynamics utilizing different models with such a filter framework.</p>
      <p>In conclusion, we have presented a data assimilation framework for combining sparse measurements together with a relatively high-dimensional nonlinear computational model to reconstruct unmeasured variables, and have demonstrated its use in the context of a model of the sleep-wake regulatory system. We have demonstrated with simulation studies that once the tracked state approaches the true system state, it reliably reconstructs the unobserved system state (<xref ref-type="fig" rid="pcbi-1002788-g002">Fig. 2</xref>). We have introduced a metric for ranking relative partial observability for computational models (<xref ref-type="fig" rid="pcbi-1002788-g003">Fig. 3</xref>) that allows us not only to assess reconstruction performance based on choice of measurement, which can serve as a guide to which system variables to measure, but also provides a methodology for optimizing filter framework parameters such as the covariance inflation (<xref ref-type="fig" rid="pcbi-1002788-g004">Fig. 4</xref>). In addition, we have demonstrated a parameter estimation method (<xref ref-type="fig" rid="pcbi-1002788-g005">Fig. 5</xref>) that allows us to track non-stationary model parameters and accommodate slow dynamics not included in the UKF model such as circadian-dependent input from the SCN (<xref ref-type="fig" rid="pcbi-1002788-g006">Fig. 6</xref>). Finally, we have demonstrated that we can even use observed discretized SOV, which is not one of the model variables, to successfully reconstruct model state (<xref ref-type="fig" rid="pcbi-1002788-g007">Figs. 7</xref>–<xref ref-type="fig" rid="pcbi-1002788-g008">8</xref>).</p>
      <p>These key features will aid in the transition of this framework to the experimental bench. Our long-term plan is to develop an observer-predictor system that will track and predict sleep-wake cycles as well as the underlying state of the neural cell groups and their neurochemical environment. Because these system dynamics are implicated in and interact with numerous neurological diseases from epilepsy to schizophrenia, we anticipate that these tools will enable better understanding of the detailed interactions and provide for better, more targeted, therapies.</p>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors would like to thank Cecilia Diniz Behn and Victoria Booth for extensive discussions on modeling of the sleep-wake regulatory network. We thank Bjoern Schelter for explaining the link between our parameter estimation method and expectation-maximization.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002788-Saper1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Saper</surname><given-names>CB</given-names></name>, <name name-style="western"><surname>Scammel</surname><given-names>TE</given-names></name>, <name name-style="western"><surname>Lu</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>Hypothalamic regulation of sleep and circadian rhythms</article-title>. <source>Nature</source> <volume>437</volume>: <fpage>1257</fpage>–<lpage>63</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Tamakawa1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tamakawa</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Karashima</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Koyoma</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Katayama</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Nakao</surname><given-names>M</given-names></name> (<year>2006</year>) <article-title>A quartet neural system model orchestrating sleep and wakefulness mechanisms</article-title>. <source>J Neurophysiol</source> <volume>95</volume>: <fpage>2055</fpage>–<lpage>69</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-DinizBehn1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Diniz Behn</surname><given-names>CG</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>, <name name-style="western"><surname>Scammel</surname><given-names>TE</given-names></name>, <name name-style="western"><surname>Kopell</surname><given-names>NJ</given-names></name> (<year>2007</year>) <article-title>Mathematical model of network dynamics governing mouse sleep</article-title>. <source>J Neurophysiol</source> <volume>97</volume>: <fpage>3828</fpage>–<lpage>40</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-DinizBehn2">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Diniz Behn</surname><given-names>CG</given-names></name>, <name name-style="western"><surname>Booth</surname><given-names>V</given-names></name> (<year>2010</year>) <article-title>Simulating microinjection experiments in a novel model of the rat sleep-wake regulatory network</article-title>. <source>J Neurophysiol</source> <volume>103</volume>: <fpage>1937</fpage>–<lpage>1953</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Phillips1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Phillips</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Robinson</surname><given-names>PA</given-names></name> (<year>2007</year>) <article-title>A quantitative model of sleep-wake dynamics based on the physiology of the brainstem ascending arousal system</article-title>. <source>J Biological Rhythms</source> <volume>22</volume>: <fpage>167</fpage>–<lpage>179</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Rempe1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rempe</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Best</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Terman</surname><given-names>D</given-names></name> (<year>2010</year>) <article-title>A mathematical model of the sleep/wake cycle</article-title>. <source>J Mathematical Biology</source> <volume>60</volume>: <fpage>615</fpage>–<lpage>44</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Kothare1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kothare</surname><given-names>SV</given-names></name>, <name name-style="western"><surname>Zarowski</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Sleep and epilepsy: common bedfellows</article-title>. <source>J Clinical Neurophysiol</source> <volume>28</volume>: <fpage>101</fpage>–<lpage>2</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Coogan1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Coogan</surname><given-names>AN</given-names></name>, <name name-style="western"><surname>Thome</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Chronotherapeutics and psychiatry: setting the clock to relieve the symptoms</article-title>. <source>World J Biol Psychiatry</source> <volume>12</volume>: <fpage>40</fpage>–<lpage>43</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Chase1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chase</surname><given-names>RM</given-names></name>, <name name-style="western"><surname>Pincus</surname><given-names>DB</given-names></name> (<year>2011</year>) <article-title>Sleep-related problems in children and adolescents with anxiety disorders</article-title>. <source>Behav Sleep Med</source> <volume>9</volume>: <fpage>224</fpage>–<lpage>36</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Kalnay1">
        <label>10</label>
        <mixed-citation publication-type="other" xlink:type="simple">Kalnay E (2003) Atmospheric modeling, data assimilation and predictability. UK: Cambridge University Press. 364 p.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Voss1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Voss</surname><given-names>HU</given-names></name>, <name name-style="western"><surname>Timmer</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>Nonlinear dynamical system identification from uncertain and indirect measurements</article-title>. <source>International Journal of Bifurcation and Chaos</source> <volume>14</volume>: <fpage>1905</fpage>–<lpage>1933</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Fleshner1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fleshner</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Booth</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Forger</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Diniz Behn</surname><given-names>CG</given-names></name> (<year>2011</year>) <article-title>Circadian regulation of sleep-wake behaviour in nocturnal rats requires multiple signals from suprachiasmatic nucleus</article-title>. <source>Philos Transact A Math Phys Eng Sci</source> <volume>369</volume>: <fpage>3855</fpage>–<lpage>83</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-McCarley1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McCarley</surname><given-names>RW</given-names></name>, <name name-style="western"><surname>Hobson</surname><given-names>JA</given-names></name> (<year>1975</year>) <article-title>Neuronal excitability modulation over the sleep cycle: a structural and mathematical model</article-title>. <source>Science</source> <volume>189</volume>: <fpage>58</fpage>–<lpage>60</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Fuller1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fuller</surname><given-names>PM</given-names></name>, <name name-style="western"><surname>Saper</surname><given-names>CB</given-names></name>, <name name-style="western"><surname>Lu</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>The pontine REM switch: past and present</article-title>. <source>The Journal of Physiology</source> <volume>584</volume>: <fpage>735</fpage>–<lpage>41</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Ohno1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ohno</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Sakurai</surname><given-names>T</given-names></name> (<year>2008</year>) <article-title>Orexin neuronal circuitry: Role in the regulation of sleep and wakefulness</article-title>. <source>Frontiers in Neuroendocrinology</source> <volume>29</volume>: <fpage>70</fpage>–<lpage>87</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-PorkkaHeiskanen1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Porkka-Heiskanen</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Strecke</surname><given-names>RE</given-names></name>, <name name-style="western"><surname>McCarley</surname><given-names>RW</given-names></name> (<year>2000</year>) <article-title>Brain site-specificity of extracellular adenosine concentration changes during sleep deprivation and spontaneous sleep: an in vivo microdialysis study</article-title>. <source>Neuroscience</source> <volume>99</volume>: <fpage>507</fpage>–<lpage>517</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Huang1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>ZL</given-names></name>, <name name-style="western"><surname>Urade</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Hayaishi</surname><given-names>O</given-names></name> (<year>2011</year>) <article-title>The role of adenosine in the regulation of sleep</article-title>. <source>Curr Top Med Chem</source> <volume>11</volume>: <fpage>1047</fpage>–<lpage>57</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Borbely1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Borbely</surname><given-names>AA</given-names></name> (<year>1982</year>) <article-title>A two-process model of sleep regulation</article-title>. <source>Human Neurobiology</source> <volume>1</volume>: <fpage>195</fpage>–<lpage>204</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Deurveilher1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deurveilher</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Semba</surname><given-names>K</given-names></name> (<year>2005</year>) <article-title>Indirect projections from the suprachiasmatic nucleus to major arousal-promoting cell groups in rat: Implications for the circadian control of behavioural state</article-title>. <source>Neuroscience</source> <volume>130</volume>: <fpage>165</fpage>–<lpage>183</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Verwey1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Verwey</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Amir</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Food-entrainable circadian oscillators in the brain</article-title>. <source>European Journal of Neuroscience</source> <volume>30</volume>: <fpage>1650</fpage>–<lpage>1657</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Hattar1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hattar</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Liao</surname><given-names>HW</given-names></name>, <name name-style="western"><surname>Takao</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Berson</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Yau</surname><given-names>KW</given-names></name> (<year>2002</year>) <article-title>Melanopsin-containing retinal ganglion cells: Architecture, projections, and intrinsic photosensitivity</article-title>. <source>Science</source> <volume>295</volume>: <fpage>1065</fpage>–<lpage>1070</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Krout1">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Krout</surname><given-names>KE</given-names></name>, <name name-style="western"><surname>Kawano</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Mettenleiter</surname><given-names>TC</given-names></name>, <name name-style="western"><surname>Loewy</surname><given-names>AD</given-names></name> (<year>2002</year>) <article-title>CNS inputs to the suprachiasmatic nucleus of the rat</article-title>. <source>Neuroscience</source> <volume>110</volume>: <fpage>73</fpage>–<lpage>92</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Quigg1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quigg</surname><given-names>M</given-names></name> (<year>2000</year>) <article-title>Circadian rhythms: interactions with seizures and epilepsy</article-title>. <source>Epilepsy Research</source> <volume>42</volume>: <fpage>43</fpage>–<lpage>55</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Hofstra1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hofstra</surname><given-names>WA</given-names></name>, <name name-style="western"><surname>de Weerd</surname><given-names>AW</given-names></name> (<year>2009</year>) <article-title>The circadian rhythm and its interaction with human epilepsy: A review of literature</article-title>. <source>Sleep Medicine Reviews</source> <volume>13</volume>: <fpage>413</fpage>–<lpage>420</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Kalman1">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kalman</surname><given-names>RE</given-names></name> (<year>1960</year>) <article-title>A new approach to linear filtering and prediciton problems</article-title>. <source>Transactions of the ASME Journal of Basic Engineering</source> <volume>82</volume>: <fpage>35</fpage>–<lpage>45</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Julier1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Julier</surname><given-names>SJ</given-names></name>, <name name-style="western"><surname>Uhlmann</surname><given-names>JK</given-names></name> (<year>1997</year>) <article-title>A new extension of the Kalman filter to nonlinear systems</article-title>. <source>P SPIE</source> <volume>3068</volume>: <fpage>182</fpage>–<lpage>193</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Schiff1">
        <label>27</label>
        <mixed-citation publication-type="other" xlink:type="simple">Schiff SJ (2012) Neural Control Engineering. MIT Press. 384 p.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Simon1">
        <label>28</label>
        <mixed-citation publication-type="other" xlink:type="simple">Simon D (2006) Optimal state estimation: Kalman, H [infinity] and nonlinear approaches. Hoboken, NJ: Wiley- Interscience. 552 p.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Miyoshi1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Miyoshi</surname><given-names>T</given-names></name> (<year>2011</year>) <article-title>The Gaussian approach to adaptive covariance ination and its implementation with the local ensemble transform</article-title>. <source>Monthly Weather Review</source> <volume>139</volume>: <fpage>1519</fpage>–<lpage>35</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Anderson1">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Anderson</surname><given-names>SL</given-names></name> (<year>2011</year>) <article-title>A Monte Carlo implementation of the nonlinear filtering problem to produce ensemble assimilations and forecasts</article-title>. <source>American Meterological Society</source> <volume>127</volume>: <fpage>2741</fpage>–<lpage>58</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Mehra1">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mehra</surname><given-names>R</given-names></name> (<year>1970</year>) <article-title>On the identification of variances and adaptiveKalman filtering</article-title>. <source>IEEE Transactions on Automatic Control</source> <volume>15</volume>: <fpage>175</fpage>–<lpage>184</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Mohamed1">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mohamed</surname><given-names>AH</given-names></name> (<year>1999</year>) <collab xlink:type="simple">Schwarz</collab> (<year>1999</year>) <article-title>Adaptive Kalman filtering for INS/GPS</article-title>. <source>Journal of Geodesy</source> <volume>73</volume>: <fpage>193</fpage>–<lpage>203</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Wang1">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>J</given-names></name> (<year>2000</year>) <article-title>Stochastic modeling for real-time kinematic GPS/GLONASS position</article-title>. <source>Navigation</source> <volume>46</volume>: <fpage>297</fpage>–<lpage>305</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Korniyenko1">
        <label>34</label>
        <mixed-citation publication-type="other" xlink:type="simple">Korniyenko OV, Sharawi MS, Aloi DN (2005) Neural network based approach for tuning KALMAN filter. In: Electro Information Technology, 2005 IEEE International Conference on. pp 1–5.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Odelson1">
        <label>35</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Odelson</surname><given-names>BJ</given-names></name>, <name name-style="western"><surname>Lutz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Rawlings</surname><given-names>JB</given-names></name> (<year>2006</year>) <article-title>The autocovariance least-squares method for estimating covariances: application to model-based control of chemical reactors</article-title>. <source>IEEE Transactions on Control Systems Technology</source> <volume>14</volume>: <fpage>532</fpage>–<lpage>540</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Akesson1">
        <label>36</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Akesson</surname><given-names>BM</given-names></name>, <name name-style="western"><surname>Jrgensen</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Poulsen</surname><given-names>NK</given-names></name>, <name name-style="western"><surname>Jrgensen</surname><given-names>SB</given-names></name> (<year>2008</year>) <article-title>A generalized autocovariance leastsquares method for Kalman filter tuning</article-title>. <source>Journal of Process Control</source> <volume>18</volume>: <fpage>769</fpage>–<lpage>779</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Jatoth1">
        <label>37</label>
        <mixed-citation publication-type="other" xlink:type="simple">Jatoth RK, Kumar TK (2009) Particle swarm optimization based tuning of unscented Kalman filter for bearings only tracking. In: Advances in Recent Technologies in Communication and Computing, 2009. ARTCom '09. International Conference on. pp 444–448.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Rajamani1">
        <label>38</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rajamani</surname><given-names>MR</given-names></name>, <name name-style="western"><surname>Rawlings</surname><given-names>JB</given-names></name> (<year>2009</year>) <article-title>Estimation of the disturbance structure from data using semidefinite programming and optimal weighting</article-title>. <source>Automatica</source> <volume>45</volume>: <fpage>142</fpage>–<lpage>148</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Deng1">
        <label>39</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deng</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Che</surname><given-names>Y</given-names></name> (<year>2009</year>) <article-title>A combined method to estimate parameters of neuron from a heavily noise-corrupted time series of active potential</article-title>. <source>Chaos</source> <volume>19</volume>: <fpage>015105</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-vanDomselaar1">
        <label>40</label>
        <mixed-citation publication-type="other" xlink:type="simple">van Domselaar B, Hemkar P (1975) Nonlinear parameter estimation in initial value problems. Technical report. Mathematical Centre Amsterdam.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Kalman2">
        <label>41</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kalman</surname><given-names>RE</given-names></name> (<year>1960</year>) <article-title>On the general theory of control systems</article-title>. <source>Proc IFAC 1st International Congress</source> <volume>1</volume>: <fpage>481</fpage>–<lpage>92</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Letellier1">
        <label>42</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Letellier</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Aguirre</surname><given-names>LA</given-names></name> (<year>2002</year>) <article-title>Investigating nonlinear dynamics from time series: The inuence of symmetries and the choice of observables</article-title>. <source>Chaos</source> <volume>12</volume>: <fpage>549</fpage>–<lpage>558</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Hu1">
        <label>43</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Nenov</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Bergsneider</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Glenn</surname><given-names>TC</given-names></name>, <name name-style="western"><surname>Vespa</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Estimation of hidden state variables of the intracranial system using constrained nonlinear Kalman filters</article-title>. <source>IEEE transactions on Bio-Medical Engineering</source> <volume>54</volume>: <fpage>597</fpage>–<lpage>610</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Quach1">
        <label>44</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quach</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>D'Alché-Buc</surname><given-names>F</given-names></name> (<year>2007</year>) <article-title>Estimating parameters and hidden variables in nonlinear state-space models based on ODEs for biological networks inference</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>3209</fpage>–<lpage>16</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Eberle1">
        <label>45</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eberle</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ament</surname><given-names>C</given-names></name> (<year>2010</year>) <article-title>The unscented Kalman filter estimates the plasma insulin from glucose measurement</article-title>. <source>Bio Systems</source> <volume>103</volume>: <fpage>67</fpage>–<lpage>72</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Ullah1">
        <label>46</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ullah</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Schiff</surname><given-names>SJ</given-names></name> (<year>2010</year>) <article-title>Assimilating seizure dynamics</article-title>. <source>PLoS Computational Biology</source> <volume>6</volume>: <fpage>e1000776</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Schiff2">
        <label>47</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schiff</surname><given-names>SJ</given-names></name> (<year>2010</year>) <article-title>Towards model-based control of Parkinson's disease</article-title>. <source>Philos Transact A Math Phys Eng Sci</source> <volume>368</volume>: <fpage>2269</fpage>–<lpage>308</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Freestone1">
        <label>48</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Freestone</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Aram</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Dewar</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Scerri</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Grayden</surname><given-names>DB</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>A data-driven framework for neural field modeling</article-title>. <source>Neuro Image</source> <volume>56</volume>: <fpage>1043</fpage>–<lpage>58</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Toth1">
        <label>49</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Toth</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Kostuk</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Meliza</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Margoliash</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Abarbanel</surname><given-names>H</given-names></name> (<year>2006</year>) <article-title>Dynamical estimation of neuron and network properties I: variational methods</article-title>. <source>Biological Cybernetics</source> <volume>105</volume>: <fpage>1</fpage>–<lpage>21</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Letellier2">
        <label>50</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Letellier</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Aguirre</surname><given-names>L</given-names></name> (<year>2010</year>) <article-title>Interplay between synchronization, observability, and dynamics</article-title>. <source>Phys Rev E</source> <volume>82</volume>: <fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Letellier3">
        <label>51</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Letellier</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Aguirre</surname><given-names>LA</given-names></name>, <name name-style="western"><surname>Maquet</surname><given-names>J</given-names></name> (<year>2005</year>) <article-title>Relation between observability and differential embeddings for nonlinear dynamics</article-title>. <source>Phys Rev E</source> <volume>71</volume>: <fpage>066213</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Letellier4">
        <label>52</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Letellier</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Aguirre</surname><given-names>L</given-names></name> (<year>2009</year>) <article-title>Symbolic observability coefficients for univariate and multivariate analysis</article-title>. <source>Phys Rev E</source> <volume>79</volume>: <fpage>066210</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Pecora1">
        <label>53</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pecora</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Carroll</surname><given-names>TL</given-names></name> (<year>1990</year>) <article-title>Synchronization in chaotic systems</article-title>. <source>Phys Rev Lett</source> <volume>64</volume>: <fpage>821</fpage>–<lpage>824</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Parlitz1">
        <label>54</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parlitz</surname><given-names>U</given-names></name> (<year>1996</year>) <article-title>Estimating model parameters from time series by autosynchronization</article-title>. <source>Phys Rev Lett</source> <volume>76</volume>: <fpage>1232</fpage>–<lpage>1235</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Maybhate1">
        <label>55</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maybhate</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Amritkar</surname><given-names>RE</given-names></name> (<year>1999</year>) <article-title>Use of synchronization and adaptive control in parameter estimation from a time series</article-title>. <source>Phys Rev E</source> <volume>59</volume>: <fpage>284</fpage>–<lpage>293</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Konnur1">
        <label>56</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Konnur</surname><given-names>R</given-names></name> (<year>2003</year>) <article-title>Synchronization-based approach for estimating all model parameters of chaotic systems</article-title>. <source>Phys Rev E</source> <volume>67</volume>: <fpage>027204</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Huang2">
        <label>57</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huang</surname><given-names>D</given-names></name> (<year>2004</year>) <article-title>Synchronization-based estimation of all parameters of chaotic systems from time series</article-title>. <source>Phys Rev E</source> <volume>69</volume>: <fpage>6</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Abarbanel1">
        <label>58</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Abarbanel</surname><given-names>HDI</given-names></name>, <name name-style="western"><surname>Creveling</surname><given-names>DR</given-names></name>, <name name-style="western"><surname>Jeanne</surname><given-names>JM</given-names></name> (<year>2008</year>) <article-title>Estimation of parameters in nonlinear systems using balanced synchronization</article-title>. <source>Phys Rev E</source> <volume>77</volume>: <fpage>016208</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Vaida1">
        <label>59</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vaida</surname><given-names>F</given-names></name> (<year>2005</year>) <article-title>Parameter convergence for EM and MM algorithms</article-title>. <source>Statistica Sinica</source> <volume>15</volume>: <fpage>831</fpage>–<lpage>840</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Wu1">
        <label>60</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>JCF</given-names></name> (<year>1983</year>) <article-title>On the convergence properties of theEM algorithm</article-title>. <source>The Annals of Statistics</source> <volume>11</volume>: <fpage>95</fpage>–<lpage>103</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Jacquez1">
        <label>61</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jacquez</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Greif</surname><given-names>P</given-names></name> (<year>1985</year>) <article-title>Numerical parameter identifiability and estimability: Integrating identifiability, estimability, and optimal sampling design</article-title>. <source>Mathematical Biosciences</source> <volume>77</volume>: <fpage>201</fpage>–<lpage>227</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Raue1">
        <label>62</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raue</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kreutz</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Maiwald</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Bachmann</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Schilling</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Structural and practical identifiability analysis of partially observed dynamical models by exploiting the profile likelihood</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>1923</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Raue2">
        <label>63</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raue</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Becker</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Klingmüller</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Timmer</surname><given-names>J</given-names></name> (<year>2010</year>) <article-title>Identifiability and observability analysis for experimental design in nonlinear dynamical models</article-title>. <source>Chaos</source> <volume>20</volume>: <fpage>045105</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Raue3">
        <label>64</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raue</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Kreutz</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Maiwald</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Klingmuller</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Timmer</surname><given-names>J</given-names></name> (<year>2011</year>) <article-title>Addressing parameter identifiability by model-based experimentation</article-title>. <source>IET Systems Biology</source> <volume>5</volume>: <fpage>120</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Margaria1">
        <label>65</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Margaria</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Riccomagno</surname><given-names>E</given-names></name>, <name name-style="western"><surname>White</surname><given-names>LJ</given-names></name> (<year>2004</year>) <article-title>Structural identifiability analysis of some highly structured families of statespace models using differential algebra</article-title>. <source>J Math Biol</source> <volume>49</volume>: <fpage>433</fpage>–<lpage>454</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Sunderam1">
        <label>66</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sunderam</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Chernyy</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Peixoto</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Mason</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Weinstein</surname><given-names>SL</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Improved sleep-wake and behavior discrimination using MEMS accelerometers</article-title>. <source>Journal of Neuroscience Methods</source> <volume>163</volume>: <fpage>373</fpage>–<lpage>83</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002788-Michael1">
        <label>67</label>
        <mixed-citation publication-type="other" xlink:type="simple">Michael AC, Borland LM, editors (2007) Electrochemical Methods for Neuroscience, CRC Press, chapter 19.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>