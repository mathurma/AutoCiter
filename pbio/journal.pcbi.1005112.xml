<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005112</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00603</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cytometry</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject><subj-group><subject>Cytotoxic T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject><subj-group><subject>Cytotoxic T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject><subj-group><subject>Cytotoxic T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject><subj-group><subject>Cytotoxic T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data visualization</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T helper cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T helper cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T helper cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T helper cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Spectrum analysis techniques</subject><subj-group><subject>Spectrophotometry</subject><subj-group><subject>Cytophotometry</subject><subj-group><subject>Flow cytometry</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Neck</subject><subj-group><subject>Throat</subject><subj-group><subject>Tonsils</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Neck</subject><subj-group><subject>Throat</subject><subj-group><subject>Tonsils</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>T cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Blood cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>NK cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>NK cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>NK cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune cells</subject><subj-group><subject>White blood cells</subject><subj-group><subject>NK cells</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Cytofkit: A Bioconductor Package for an Integrated Mass Cytometry Data Analysis Pipeline</article-title>
<alt-title alt-title-type="running-head">cytofkit</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-6728-4691</contrib-id>
<name name-style="western">
<surname>Chen</surname>
<given-names>Hao</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3183-7703</contrib-id>
<name name-style="western">
<surname>Lau</surname>
<given-names>Mai Chan</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Wong</surname>
<given-names>Michael Thomas</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2889-243X</contrib-id>
<name name-style="western">
<surname>Newell</surname>
<given-names>Evan W.</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1047-2277</contrib-id>
<name name-style="western">
<surname>Poidinger</surname>
<given-names>Michael</given-names>
</name>
<xref ref-type="aff" rid="aff001"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7547-6423</contrib-id>
<name name-style="western">
<surname>Chen</surname>
<given-names>Jinmiao</given-names>
</name>
<xref ref-type="corresp" rid="cor001">*</xref>
<xref ref-type="aff" rid="aff001"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>Agency for Science, Technology and Research (A*STAR), Singapore Immunology Network (SIgN), Singapore</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Schneidman</surname>
<given-names>Dina</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Hebrew University of Jerusalem, ISRAEL</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"><list-item><p><bold>Conceptualization:</bold> JC HC MP EWN.</p></list-item> <list-item><p><bold>Data curation:</bold> JC MTW EWN.</p></list-item> <list-item><p><bold>Formal analysis:</bold> HC JC.</p></list-item> <list-item><p><bold>Funding acquisition:</bold> JC.</p></list-item> <list-item><p><bold>Investigation:</bold> JC MTW EWN.</p></list-item> <list-item><p><bold>Methodology:</bold> JC HC.</p></list-item> <list-item><p><bold>Project administration:</bold> JC.</p></list-item> <list-item><p><bold>Resources:</bold> JC EN.</p></list-item> <list-item><p><bold>Software:</bold> HC JC.</p></list-item> <list-item><p><bold>Supervision:</bold> JC.</p></list-item> <list-item><p><bold>Validation:</bold> HC JC MTW.</p></list-item> <list-item><p><bold>Writing – original draft:</bold> HC JC.</p></list-item> <list-item><p><bold>Writing – review &amp; editing:</bold> HC JC MCL MP MTW EWN.</p></list-item></list></p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">chen_jinmiao@immunol.a-star.edu.sg</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>23</day>
<month>9</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>9</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>9</issue>
<elocation-id>e1005112</elocation-id>
<history>
<date date-type="received">
<day>14</day>
<month>4</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>8</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Chen et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005112"/>
<abstract>
<p>Single-cell mass cytometry significantly increases the dimensionality of cytometry analysis as compared to fluorescence flow cytometry, providing unprecedented resolution of cellular diversity in tissues. However, analysis and interpretation of these high-dimensional data poses a significant technical challenge. Here, we present cytofkit, a new Bioconductor package, which integrates both state-of-the-art bioinformatics methods and in-house novel algorithms to offer a comprehensive toolset for mass cytometry data analysis. Cytofkit provides functions for data pre-processing, data visualization through linear or non-linear dimensionality reduction, automatic identification of cell subsets, and inference of the relatedness between cell subsets. This pipeline also provides a graphical user interface (GUI) for ease of use, as well as a shiny application (APP) for interactive visualization of cell subpopulations and progression profiles of key markers. Applied to a CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset, cytofkit accurately identified different subsets of lymphocytes; applied to a human CD4<sup>+</sup> T cell dataset, cytofkit uncovered multiple subtypes of T<sub>FH</sub> cells spanning blood and tonsils. Cytofkit is implemented in R, licensed under the Artistic license 2.0, and freely available from the Bioconductor website, <ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/cytofkit/" xlink:type="simple">https://bioconductor.org/packages/cytofkit/</ext-link>. Cytofkit is also applicable for flow cytometry data analysis.</p>
</abstract>
<funding-group>
<funding-statement>This study was funded by A-STAR/SIgN core funding (JC). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="1"/>
<page-count count="17"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology Software</italic> Article.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Mass cytometry, or cytometry by time-of-flight (CyTOF), uniquely combines metal-labeling of antibodies with mass spectrometry to enable high-dimensional measurement of the characteristics of individual cells [<xref ref-type="bibr" rid="pcbi.1005112.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1005112.ref002">2</xref>]. The high purity and choice of metal isotopes overcome the limitations of spectral overlap in flow cytometry, and allow for simultaneous analysis of more than 40 markers per cell [<xref ref-type="bibr" rid="pcbi.1005112.ref003">3</xref>,<xref ref-type="bibr" rid="pcbi.1005112.ref004">4</xref>]. This technology has been successfully applied in a number of areas including mapping phenotypic heterogeneity of leukemia [<xref ref-type="bibr" rid="pcbi.1005112.ref005">5</xref>], inferring cellular progression and hierarchies [<xref ref-type="bibr" rid="pcbi.1005112.ref006">6</xref>], assessing drug effects on immune cells [<xref ref-type="bibr" rid="pcbi.1005112.ref007">7</xref>,<xref ref-type="bibr" rid="pcbi.1005112.ref008">8</xref>] and uncovering mechanisms of cellular reprogramming [<xref ref-type="bibr" rid="pcbi.1005112.ref009">9</xref>]. Despite the advantages of mass cytometry, effective analysis and interpretation of these high dimensional and large-scale datasets remain challenging. Traditional manual gating, the gold-standard method for flow cytometry data analysis, is not practical for mass cytometry due to its high dimensionality. In addition, most automated methods designed for flow cytometry data do not perform well for mass cytometry data [<xref ref-type="bibr" rid="pcbi.1005112.ref010">10</xref>].</p>
<p>Analysis of mass cytometry data has several key challenges including debarcoding [<xref ref-type="bibr" rid="pcbi.1005112.ref011">11</xref>], batch normalization [<xref ref-type="bibr" rid="pcbi.1005112.ref012">12</xref>], visualization of high-dimensional data, identification of cell subsets, inference of relatedness between cell subsets, and detection of changes in subset abundance. This manuscript focuses on addressing the following three key challenges for data that don’t display batch effect. The first challenge is efficient visualization of these high-dimensional data. A biaxial plot that displays the correlation of every two markers is a common way to visualize flow cytometry data. With the fact that <italic>m</italic>(<italic>m</italic> − 1)/2 biaxial plots are needed to fully visualize an m-dimensional dataset, this approach is impractical for mass cytometry data as the parameter m of mass cytometry is usually greater than 40. Alternative dimensionality reduction approaches have been used to transform the high-dimensional data to a low-dimensional representation, thus allowing visualization of the cells in a single plot. In Newell <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005112.ref013">13</xref>], principal component analysis (PCA) was used to visualize a 25-parameter mass cytometry panel for CD8<sup>+</sup> T cells. However, PCA is a linear transformation, and it cannot capture nonlinear relationships. To address this limitation, Amir <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1005112.ref005">5</xref>] developed a visualization tool named viSNE which utilizes the t-distributed stochastic neighbor embedding (t-SNE) algorithm. t-SNE is a nonlinear dimensionality reduction approach [<xref ref-type="bibr" rid="pcbi.1005112.ref014">14</xref>] which embeds the data from high dimensional space into a lower dimensional map based on similarities. On a t-SNE map, similar cells are placed to nearby points, while dissimilar cells are placed far apart. It has been demonstrated that t-SNE can effectively visualize cellular heterogeneity in normal and leukemic bone marrow [<xref ref-type="bibr" rid="pcbi.1005112.ref005">5</xref>].</p>
<p>The second challenge is to identify cell subpopulations. To address this challenge, the ACCENSE method has been developed to automatically identify cellular subpopulations using a density peak-finding algorithm on a t-SNE transformed 2-D map [<xref ref-type="bibr" rid="pcbi.1005112.ref015">15</xref>]. However, not all cells are assigned to a defined subpopulation in this method. DensVM extends ACCENSE by using support vector machine (SVM) to assign any unassigned cells to the subpopulations in a machine learning manner [<xref ref-type="bibr" rid="pcbi.1005112.ref016">16</xref>]. This approach has been demonstrated to precisely detect the boundaries of cell populations in murine myeloid data. DensVM has also been applied to map the numerous subtypes of follicular helper T cells derived from human blood and tonsils [<xref ref-type="bibr" rid="pcbi.1005112.ref016">16</xref>,<xref ref-type="bibr" rid="pcbi.1005112.ref017">17</xref>]. However, both ACCENSE and DensVM rely on a computationally intensive search for an optimal number of subpopulations. PhenoGraph, a graph-based partitioning method, has demonstrated efficiency in subpopulation detection [<xref ref-type="bibr" rid="pcbi.1005112.ref010">10</xref>]. PhenoGraph first constructs a nearest-neighbor graph which captures the phenotypic relatedness of the high-dimensional data, and then it applies a graph partition algorithm called Louvain [<xref ref-type="bibr" rid="pcbi.1005112.ref018">18</xref>] to dissect the nearest-neighbor graph into phenotypically coherent subpopulations. Applied to the study of acute myeloid leukemia, PhenoGraph provided a comprehensive view of the major phenotypes and elucidated intra- and inter-tumor heterogeneity. PhenoGraph has also been tested on three different mass cytometry datasets of healthy human bone marrow, and it displayed superior accuracy and robustness in immune cell type detection as compared to other methods.</p>
<p>The third challenge is to detect cellular progression. In addition to defining distinctive cell subsets, there is great interest in resolving the order of cellular differentiation to reveal their developmental relationships. For example, Bendall <italic>et al</italic>. developed a graph-based trajectory detection algorithm named Wanderlust, which orders cells into a unified trajectory that reflects the developmental path [<xref ref-type="bibr" rid="pcbi.1005112.ref019">19</xref>]. This method correctly predicted the early developmental path of human B-lymphocytes. Nevertheless, this algorithm was designed for linear and non-branching developmental path, and hence is less useful for interpreting complex single-cell data with multiple developmental lineages. Wishbone extended the ability of Wanderlust to capture bifurcating developmental trajectories through introducing waypoints and identifying branch points [<xref ref-type="bibr" rid="pcbi.1005112.ref020">20</xref>]. Wishbone is based on diffusion map, which has been demonstrated to be powerful and robust for detecting the global geometric structures from the data [<xref ref-type="bibr" rid="pcbi.1005112.ref021">21</xref>]. However, Wishbone requires the input of a starting cell. SPADE is an innovative approach designed to extract cellular hierarchy using minimum spanning tree (MST) [<xref ref-type="bibr" rid="pcbi.1005112.ref006">6</xref>]. While SPADE enables the prediction of multi-branched cell developmental pathways, the hierarchical clustering used in SPADE needs a pre-specification of the number of clusters, additionally, the MST used by SPADE is susceptible to over-fitting and is not robust for local variation [<xref ref-type="bibr" rid="pcbi.1005112.ref009">9</xref>]. Our recent novel method named Mpath constructs multi-branching cell lineages from single-cell data using neighborhood-based cell state transitions [<xref ref-type="bibr" rid="pcbi.1005112.ref022">22</xref>]. However we have only demonstrated its applications for single-cell RNA-sequencing data. We are currently testing and optimizing Mpath for mass cytometry and flow cytometry data.</p>
<p>In this report, we present an integrated analysis pipeline, named cytofkit. It is designed to analyze mass cytometry data in four main steps. In the first step, cytofkit performs data pre-processing, and enables combined analysis of multiple Flow Cytometry Standard (FCS) files. Users are allowed to customize their data merging strategy to combine the data using selectable transformation methods. The remaining three steps address respectively, each of the three challenges discussed above. Firstly, cytofkit provides state-of-the-art clustering methods including DensVM [<xref ref-type="bibr" rid="pcbi.1005112.ref016">16</xref>], FlowSOM [<xref ref-type="bibr" rid="pcbi.1005112.ref023">23</xref>] and PhenoGraph [<xref ref-type="bibr" rid="pcbi.1005112.ref010">10</xref>], as well as an in-house newly developed algorithm named ClusterX for automatic detection of cell subpopulations. Secondly, it provides functions to visualize the high-dimensional data with color-labeled cell types using either linear transformation such as PCA or non-linear dimensionality reduction such as ISOMAP [<xref ref-type="bibr" rid="pcbi.1005112.ref024">24</xref>], diffusion map or t-SNE (we use Barnes-Hut variant of t-SNE, a speed optimized implementation of t-SNE [<xref ref-type="bibr" rid="pcbi.1005112.ref025">25</xref>]). Lastly, it infers the relatedness between cell subsets using ISOMAP or diffusion map. In addition to providing an integrated analysis pipeline, cytofkit provides a user-friendly GUI and an interactive shiny APP to facilitate result exploration and interpretation. Through the application of cytofkit to a CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset, cytofkit was able to accurately identify known populations of lymphocytes including CD4<sup>+</sup>, CD8<sup>+</sup>, γδT, NK, and NKT cells, and further segregate these subsets to reveal subpopulations such as different stages of CD4<sup>+</sup> and CD8<sup>+</sup> T cell differentiation, as well as three subsets of γδT and two subsets of NK cells. Moreover, as shown in our previous publication [<xref ref-type="bibr" rid="pcbi.1005112.ref017">17</xref>], application of cytofkit for an objective comparison of human T helper (TH) cells derived from peripheral blood versus tonsils revealed numerous subtypes of follicular helper T cells (T<sub>FH</sub>) cells that followed a continuum spanning both blood and tonsils.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Design and Implementation</title>
<p>We have developed an integrated mass cytometry data analysis pipeline as an open-source R/Bioconductor package called cytofkit. As shown in <xref ref-type="fig" rid="pcbi.1005112.g001">Fig 1</xref>, the pipeline consists of four major components: (1) pre-processing, (2) cell subset detection, (3) cell subset visualization and interpretation and (4) Inference of the relatedness between cell subsets.</p>
<fig id="pcbi.1005112.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schematic view of cytofkit pipeline.</title>
<p>The cytofkit pipeline consists of four major components: (1) pre-processing, (2) cell subset detection, (3) cell subset visualization and interpretation and (4) inference of the relatedness between cell subsets.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Pre-processing</title>
<p>Pre-processing is performed on one or multiple FCS files involving three steps to generate the expression matrix. Firstly, expression values of user selected markers are extracted from each FCS file; secondly the extracted data are transformed using either negative value pruned inverse hyperbolic sine transformation (cytofAsinh) or automatic logicle transformation (autoLgcl) [<xref ref-type="bibr" rid="pcbi.1005112.ref026">26</xref>] (see details in <xref ref-type="supplementary-material" rid="pcbi.1005112.s002">S1 file</xref>); finally expression matrixes from each FCS file are combined into a single matrix using one of the four selectable strategies, including i) <italic>ceil</italic> which samples up to a user specified number of cells without replacement from each FCS file, ii) <italic>all</italic> which takes all cells from each FCS file, iii) <italic>min</italic> which samples the minimum number of cells among all the selected FCS files from each FCS file and iv) <italic>fixed</italic> which samples an user specified number of cells (with replacement when the total number of cell in the file is less than the specified number) from each FCS file. In the combined expression matrix, each cell is given a unique ID, which is the concatenation of its original FCS file name and its sequence ID in the file.</p>
</sec>
<sec id="sec004">
<title>Cell subset detection</title>
<p>The subset detection is implemented by clustering algorithms. Cytofkit provides three state-of-the-art clustering methods DensVM [<xref ref-type="bibr" rid="pcbi.1005112.ref016">16</xref>], PhenoGraph [<xref ref-type="bibr" rid="pcbi.1005112.ref010">10</xref>], FlowSOM [<xref ref-type="bibr" rid="pcbi.1005112.ref023">23</xref>] and one in-house developed clustering algorithm called ClusterX. DensVM and ClusterX are density-based clustering algorithms, which are applied to the t-SNE embedded map, whereas PhenoGraph is a graph based clustering algorithm, which works directly on the high-dimensional data.</p>
<sec id="sec005">
<title>DensVM</title>
<p>DensVM (Density-based clustering aided by support Vector Machine) is an extension of ACCENSE’s density-based clustering algorithm [<xref ref-type="bibr" rid="pcbi.1005112.ref015">15</xref>]. ACCENSE’s clustering algorithm first computes 2D probability density from the t-SNE map using the Gaussian kernel transform. A 2D peak-finding algorithm is then applied to identify local density maxima that represent the center of cellular subpopulations. For each peak k, the nearest neighboring peak is identified and distance to the nearest neighbor d<sub>k</sub> is calculated. ACCENSE then draws a circle of radius d<sub>k</sub>/2 centered at the peak k, and assign all cells within the circle to cluster k. By using this approach, a significant number of cells are located outside any circle and left unclassified, which hampers the estimation of subpopulation frequencies and downstream statistical tests. DensVM overcomes this limitation by utilizing a machine-learning algorithm called support vector machine to train a classifier that learns the patterns of cells that were assigned to ACCENSE clusters. The trained classifier then takes as an input the marker expression profiles of unclassified cells and assigns each of them to one of the ACCENSE clusters based on the assumption that cells from the same cluster should share similar patterns of marker expression (details in paper [<xref ref-type="bibr" rid="pcbi.1005112.ref016">16</xref>]). DensVM is able to objectively assign every cell to an appropriate cluster.</p>
</sec>
<sec id="sec006">
<title>PhenoGraph</title>
<p>PhenoGraph works on an m-by-N intensity matrix, which comprises m parameters of N cells. For each cell, PhenoGraph first identifies k nearest neighbors using Euclidean distance, resulting in N sets of k-neighbors. Based on the number of neighbors shared by every two cells, it calculates the similarity between cells using the Jaccard similarity coefficient and generates a cell-cell similarity matrix, which is then converted into a network. Subsequently, PhenoGraph partitions the network using the Louvain algorithm to extract communities with optimal modularity [<xref ref-type="bibr" rid="pcbi.1005112.ref018">18</xref>]. This algorithm makes no assumption about the size or number of subpopulations, which make it applicable to many different datasets. In cytofkit, we converted the original python code of PhenoGraph into R script.</p>
</sec>
<sec id="sec007">
<title>ClusterX</title>
<p>ClusterX is a clustering method improved from Clustering by fast search and find of density peaks (CFSFDP) [<xref ref-type="bibr" rid="pcbi.1005112.ref027">27</xref>]. The CFSFDP algorithm is fast and able to recognize clusters regardless of their shape. However it has two main limitations. The first limitation is that it takes a dissimilarity matrix as the input, which results in an O(n<sup>2</sup>) memory burden for a dataset of n cells. The second is that it requires manually decided cut-off values to determine density peaks, which is inefficient and subjective. ClusterX addresses the memory issue with a split-apply-combine strategy [<xref ref-type="bibr" rid="pcbi.1005112.ref028">28</xref>], and automates density peak detection using generalized (extreme Studentized deviate) ESD test [<xref ref-type="bibr" rid="pcbi.1005112.ref029">29</xref>]. When combined with t-SNE, ClusterX extends its capacity for clustering high-dimensional data. The workflow of ClusterX for mass cytometry data clustering is illustrated in <xref ref-type="fig" rid="pcbi.1005112.g002">Fig 2</xref> (see detailed description of ClusterX in <xref ref-type="supplementary-material" rid="pcbi.1005112.s002">S1 file</xref>).</p>
<fig id="pcbi.1005112.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Workflow of ClusterX for mass cytometry data clustering.</title>
<p>(a) depict the workflow of ClusterX for mass cytometry data clustering, which contains four steps: (i) t-SNE dimensionality reduction (ii) estimate the local density on the t-SNE map (iii) detect the density peaks represented as cluster centers and (iv) assign the remaining cells to clusters. (b) Explains the local density estimation method. (c) Illustrate the cluster assigning step using two peaks, peak1 and peak 2. Each point is a cell and the color intensity represents the local density of the cell. Then each cell is assigned to be the same cluster as its nearest neighbor cell which has higher density than it.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.g002" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec008">
<title>Cell subset visualization and interpretation</title>
<p>Three dimensionality reduction methods are integrated into cytofkit for visualizing the high dimensional mass cytometry data. These include one linear transformation method PCA and two non-linear transformation methods ISOMAP and t-SNE. After dimensionality reduction, cytofkit plots the transformed two-dimensional maps with point color representing the cell type detected from cluster analysis and point shape representing which sample (i.e. FCS file) the cell belongs to. The expression pattern of a specified marker can also be visualized on the dimensionality-reduced map with values represented by colors. A heat map is generated to visualize the median expression level of each marker in each cell type. This heat map facilitates the annotation of known cell types based on prior knowledge of cell type specific marker expression, as well as the detection of novel cell types with novel expression patterns. The percentage of cells in each cluster for each FCS file can also be visualized using a heat map, which helps the detection of changes in abundance of subsets among different samples. All these plots can be either saved automatically by the cytofkit package or interactively visualized with our specifically designed shiny APP (see in <bold>Pipeline Implementation</bold> section). Example t-SNE plots and heat map plots can be found in the <bold>Results and Discussion</bold> section.</p>
</sec>
<sec id="sec009">
<title>Inference of inter-subset relatedness</title>
<p>Instead of directly estimating cellular developmental path from individual cells, which is computationally challenging and error prone, cytofkit provides assistant approaches for inferring the progression based on the relationship of cell subsets. As we will demonstrate later in our <bold>Results and Discussion</bold> section, ISOMAP or diffusion map perform better for reserving the global inter-relatedness between cell subsets compared to tSNE. ISOMAP takes into account local distances between similar cells and is able to capture the global geometry between different cell types. In CD4<sup>+</sup> T cell dataset, we applied ISOMAP to detect three hypothesized progression paths spanning across blood and tonsils derived from the naïve T cells (see details in our previously published paper [<xref ref-type="bibr" rid="pcbi.1005112.ref017">17</xref>]). Diffusion map is a dimensionality reduction algorithm, which captures the non-linear structure of data as a continuum. It demonstrated considerably better performance than the other dimensionality reduction methods PCA or t-SNE for revealing the differentiation structure in single-cell data analysis [<xref ref-type="bibr" rid="pcbi.1005112.ref021">21</xref>]. In cytofkit, we combined dimensionality reduction methods including ISOMAP and diffusion map with the clustering results to infer inter-subset relatedness, which is expected to help detection of cell differentiation trajectories. Firstly, we down-sampled the number of cells in each cluster to an equal size, thus reducing cell subset density heterogeneities and removing the dominating effect of large populations in the data. Then we ran ISOMAP or diffusion map on the down-sampled dataset and overlaid the clusters onto the transformed dimensions. By checking the median position of clusters in ISOMAP or diffusion map, hypothesized paths of subset progression can be drawn and annotated. The expression profiles of selected markers can be visualized with a Tobit-family generalized linear model (GLM) [<xref ref-type="bibr" rid="pcbi.1005112.ref030">30</xref>] along the manually defined progression path to either validate the hypothesized path or detect potential progression dynamics.</p>
</sec>
<sec id="sec010">
<title>Pipeline implementation</title>
<p>We implemented the cytofkit pipeline in R, and built it as a Bioconductor package (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/cytofkit/" xlink:type="simple">https://bioconductor.org/packages/cytofkit/</ext-link>). ClusterX, as a newly developed clustering algorithm, was implemented as an R package named ClusterX and is available on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/JinmiaoChenLab/ClusterX" xlink:type="simple">https://github.com/JinmiaoChenLab/ClusterX</ext-link>). PhenoGraph is originally available as python code. We re-implemented the algorithm into an R package named Rphenograph and it is also available on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/JinmiaoChenLab/Rphenograph" xlink:type="simple">https://github.com/JinmiaoChenLab/Rphenograph</ext-link>). ClusterX and Rphenograph are both integrated into the cytofkit package. To facilitate the easy access of cytofkit package, we developed a user-friendly GUI using R tcltk package as shown in <xref ref-type="fig" rid="pcbi.1005112.g003">Fig 3</xref>. To facilitate interactive visualization of the analysis results, the cytofkit package provides a shiny APP which can be deployed locally with function cytofkitShinyAPP(). The analysis results from cytofkit will be saved as an RData object, which can be easily loaded into this shiny APP. This shiny APP provides an interactive interface to visualize and explore the analysis results as shown in <xref ref-type="fig" rid="pcbi.1005112.g004">Fig 4</xref>. In addition, an online version of the shiny APP is also publicly available at <ext-link ext-link-type="uri" xlink:href="https://chenhao.shinyapps.io/cytofkitShinyAPP/" xlink:type="simple">https://chenhao.shinyapps.io/cytofkitShinyAPP/</ext-link>. An instruction on usage of the GUI and the package can be found in <xref ref-type="supplementary-material" rid="pcbi.1005112.s003">S2 File</xref> as well online in the package vignettes (<ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_example.html" xlink:type="simple">https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_example.html</ext-link>). An instruction on the usage of the shiny APP is included in <xref ref-type="supplementary-material" rid="pcbi.1005112.s004">S3 File</xref> as well as online in the package vignette (<ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_shinyAPP.html" xlink:type="simple">https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_shinyAPP.html</ext-link>). A detailed Rmarkdown file including the analysis procedures and all the data used in the manuscript are available on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/JinmiaoChenLab/cytofkit_analysis_data_code" xlink:type="simple">https://github.com/JinmiaoChenLab/cytofkit_analysis_data_code</ext-link>) for reproducing our analysis results. Cytofkit package adds dimensionality reduction and clustering results as additional parameters to the FCS files. Users can open the modified FCS files using other software such as FlowJo to visually verify the clusters with their prior knowledge. They can also overlay manually gated populations onto the t-SNE (ISOMAP, diffusion map) plots; perform manual gating according to the t-SNE plot or clustering results.</p>
<fig id="pcbi.1005112.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.g003</object-id>
<label>Fig 3</label>
<caption>
<title>The appearance of the GUI for cytofkit.</title>
<p>The GUI provides full options of cytofkit with help buttons explaining the meaning of each parameter.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.g003" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005112.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The appearance of the shiny APP for cytofkit.</title>
<p>The shiny APP is designed to provide interactively visualization and exploration the cytofkit analysis results. It is integrated into cytofkit package and also a stand-alone online application.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.g004" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec011" sec-type="conclusions">
<title>Results and Discussion</title>
<p>We demonstrate the utility of this package using two datasets (included in <xref ref-type="supplementary-material" rid="pcbi.1005112.s001">S1 Dataset</xref>). One is a CD14<sup>−</sup>CD19<sup>− </sup>PBMCs dataset and the other is a CD4<sup>+</sup> T cell dataset combined from human blood and tonsils. In order to assess the accuracy of cytofkit, we manually gated populations of CD4<sup>+</sup>, CD8<sup>+</sup>, γδT, CD3<sup>+</sup>CD56<sup>+</sup> NKT and CD3<sup>−</sup>CD56<sup>+</sup> NK cells from the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset (gating strategy included in <xref ref-type="supplementary-material" rid="pcbi.1005112.s005">S1 Fig</xref>). Populations of naïve (CD45RA<sup>+</sup>CCR7<sup>+</sup>CD45RO<sup>-</sup>), T<sub>H</sub>1 (IFN-γ<sup>+</sup>), T<sub>H</sub>17 (IL-17A<sup>+</sup>) and T<sub>FH</sub> (CXCR5<sup>hi</sup>PD-1<sup>hi</sup>) cells are manually gated from the CD4<sup>+</sup> T cell dataset (see in [<xref ref-type="bibr" rid="pcbi.1005112.ref017">17</xref>]). More information about these two datasets is included in the <xref ref-type="supplementary-material" rid="pcbi.1005112.s002">S1 File</xref> data description section.</p>
<sec id="sec012">
<title>Comparison of dimensionality reduction methods for visualization</title>
<p>In order to assess the performance of the three dimensionality reduction methods PCA, ISOMAP and t-SNE, we applied these methods to the above two datasets. For the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset, we overlaid the gated lymphocyte and NK cell populations onto the plots of the three methods. In <xref ref-type="fig" rid="pcbi.1005112.g005">Fig 5(a)</xref>, we observed that PCA displayed a continuous U-shaped pattern of cellular clusters. ISOMAP preserved the U-shaped continuum while showing better resolution of CD4<sup>+</sup>, CD8<sup>+</sup>, γδT, CD3<sup>+</sup>CD56<sup>+</sup> NKT and CD3<sup>−</sup>CD56<sup>+</sup> NK cells. The preserved continuum shows the interrelatedness between these subsets. In contrast, t-SNE showed geometrically distinct clusters at much higher resolution and discriminated several populations within the CD4<sup>+</sup> T cell population. However, we did not observe the continuum as seen with ISOMAP. In the CD4<sup>+</sup> T cell dataset, after overlaying naïve (CD45RA<sup>+</sup>CCR7<sup>+</sup>CD45RO<sup>−</sup>), T<sub>H</sub>1 (IFN-γ<sup>+</sup>), T<sub>H</sub>17 (IL-17A<sup>+</sup>) and T<sub>FH</sub> (CXCR5<sup>hi</sup>PD-1<sup>hi</sup>) cells onto the dimensionality-reduced map, we observed that each subset occupied distinct regions in ISOMAP and t-SNE, whereas T<sub>H</sub>1 and T<sub>H</sub>17 cells overlapped in the same region for PCA, as shown in <xref ref-type="fig" rid="pcbi.1005112.g005">Fig 5(b)</xref>. Overall, these analyses of two independent datasets highlighted the advantages of non-linear approaches over linear PCA for visualizing and interpreting mass cytometry data.</p>
<fig id="pcbi.1005112.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Comparison of dimensionality reduction methods.</title>
<p>PCA, ISOMAP and t-SNE are performed on the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset and the CD4<sup>+</sup> T cell dataset, respectively. In each panel, Cells are plotted using the first two dimensions of the dimensionality-transformed data and color coded by gated populations. (a) Plot of manually gated CD4<sup>+</sup>, CD8<sup>+</sup>, γδT, CD3<sup>+</sup>CD56<sup>+</sup> NKT and CD3<sup>−</sup>CD56<sup>+</sup> NK cell populations from the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset using PCA, ISOMAP, and t-SNE. (b) Plot of manually gated naïve (CD45RA<sup>+</sup>CCR7<sup>+</sup>CD45RO<sup>-</sup>), T<sub>H</sub>1 (IFN-γ<sup>+</sup>), T<sub>H</sub>17 (IL-17A<sup>+</sup>) and T<sub>FH</sub> (CXCR5<sup>hi</sup>PD-1<sup>hi</sup>) cell populations from the CD4<sup>+</sup> T cell dataset using PCA, ISOMAP, and t-SNE.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>Comparison of clustering methods for subset detection</title>
<p>Cytofkit contains three clustering methods for automatic subset identification; they are ClusterX, DensVM and PhenoGraph. To assess the performance of these clustering methods, we quantitatively calculated the precision, recall and F-measure of each clustering method, using manually gated populations of CD4<sup>+</sup>, CD8<sup>+</sup>, γδT, NK and NKT cells from the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset as the gold standard. <xref ref-type="fig" rid="pcbi.1005112.g006">Fig 6</xref> shows that DensVM detected 13 clusters, PhenoGraph identified 14 clusters and ClusterX 15 clusters. These clusters were mapped to the manually gated populations using FlowJo. As shown in <xref ref-type="table" rid="pcbi.1005112.t001">Table 1</xref>, ClusterX produced the highest precision in this case; nevertheless, the precision score differences among these three clustering methods are quite small. The F-measures for DensVM, ClusterX and PhenoGraph are 0.886, 0.894 and 0.854 respectively, which shows that all three clustering methods can accurately identify the manually gated cellular populations.</p>
<fig id="pcbi.1005112.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Comparison of clustering methods.</title>
<p>Each panel represents one clustering results mapped on the t-SNE plot; from left to right they are (a) ClusterX, (b) DensVM and (c) PhenoGraph. Clusters were annotated by different colors and with cluster ID at the center of the cluster.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.g006" xlink:type="simple"/>
</fig>
<table-wrap id="pcbi.1005112.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.t001</object-id>
<label>Table 1</label> <caption><title>Precision, recall and F-measure of each clustering method by comparing cluster results to manually gated populations of CD4<sup>+</sup>, CD8<sup>+</sup>, γδT, NK and NKT cells from the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset.</title></caption>
<alternatives>
<graphic id="pcbi.1005112.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="left">Gated Population</th>
<th align="left">Counts</th>
<th align="left">Clusters</th>
<th align="left">Cluster Cell Counts</th>
<th align="left">True Positive</th>
<th align="left">Precesion</th>
<th align="left">Recall</th>
<th align="left">F-measure</th>
<th align="left">Average F-measure</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="5" style="background-color:#F2F2F2"><bold>ClusterX</bold></td>
<td align="left" style="background-color:#F2F2F2">CD4</td>
<td align="left" style="background-color:#F2F2F2">4097</td>
<td align="left" style="background-color:#F2F2F2">1,2,3,5,10</td>
<td align="left" style="background-color:#F2F2F2">4265</td>
<td align="left" style="background-color:#F2F2F2">4029</td>
<td align="char" char="." style="background-color:#F2F2F2">0.94</td>
<td align="char" char="." style="background-color:#F2F2F2">0.98</td>
<td align="char" char="." style="background-color:#F2F2F2">0.96</td>
<td align="char" char="." rowspan="5" style="background-color:#F2F2F2">0.894</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">CD8</td>
<td align="left" style="background-color:#F2F2F2">1897</td>
<td align="left" style="background-color:#F2F2F2">6,8,12</td>
<td align="left" style="background-color:#F2F2F2">1881</td>
<td align="left" style="background-color:#F2F2F2">1702</td>
<td align="char" char="." style="background-color:#F2F2F2">0.9</td>
<td align="char" char="." style="background-color:#F2F2F2">0.9</td>
<td align="char" char="." style="background-color:#F2F2F2">0.9</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">NK</td>
<td align="left" style="background-color:#F2F2F2">958</td>
<td align="left" style="background-color:#F2F2F2">9,13</td>
<td align="left" style="background-color:#F2F2F2">950</td>
<td align="left" style="background-color:#F2F2F2">934</td>
<td align="char" char="." style="background-color:#F2F2F2">0.98</td>
<td align="char" char="." style="background-color:#F2F2F2">0.97</td>
<td align="char" char="." style="background-color:#F2F2F2">0.97</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">NKT</td>
<td align="left" style="background-color:#F2F2F2">1302</td>
<td align="left" style="background-color:#F2F2F2">7,15</td>
<td align="left" style="background-color:#F2F2F2">1019</td>
<td align="left" style="background-color:#F2F2F2">840</td>
<td align="char" char="." style="background-color:#F2F2F2">0.82</td>
<td align="char" char="." style="background-color:#F2F2F2">0.65</td>
<td align="char" char="." style="background-color:#F2F2F2">0.73</td>
</tr>
<tr>
<td align="left" style="background-color:#F2F2F2">Vd2</td>
<td align="left" style="background-color:#F2F2F2">1034</td>
<td align="left" style="background-color:#F2F2F2">4,11,14</td>
<td align="left" style="background-color:#F2F2F2">1173</td>
<td align="left" style="background-color:#F2F2F2">1001</td>
<td align="char" char="." style="background-color:#F2F2F2">0.85</td>
<td align="char" char="." style="background-color:#F2F2F2">0.97</td>
<td align="char" char="." style="background-color:#F2F2F2">0.91</td>
</tr>
<tr>
<td align="left" rowspan="5" style="background-color:#DCE6F1"><bold>DensVM</bold></td>
<td align="left" style="background-color:#DCE6F1">CD4</td>
<td align="left" style="background-color:#DCE6F1">4097</td>
<td align="left" style="background-color:#DCE6F1">1,2,3,4</td>
<td align="left" style="background-color:#DCE6F1">4108</td>
<td align="left" style="background-color:#DCE6F1">3898</td>
<td align="char" char="." style="background-color:#DCE6F1">0.95</td>
<td align="char" char="." style="background-color:#DCE6F1">0.95</td>
<td align="char" char="." style="background-color:#DCE6F1">0.95</td>
<td align="char" char="." rowspan="5" style="background-color:#DCE6F1">0.886</td>
</tr>
<tr>
<td align="left" style="background-color:#DCE6F1">CD8</td>
<td align="left" style="background-color:#DCE6F1">1897</td>
<td align="left" style="background-color:#DCE6F1">5,7,10</td>
<td align="left" style="background-color:#DCE6F1">1992</td>
<td align="left" style="background-color:#DCE6F1">1710</td>
<td align="char" char="." style="background-color:#DCE6F1">0.86</td>
<td align="char" char="." style="background-color:#DCE6F1">0.9</td>
<td align="char" char="." style="background-color:#DCE6F1">0.88</td>
</tr>
<tr>
<td align="left" style="background-color:#DCE6F1">NK</td>
<td align="left" style="background-color:#DCE6F1">958</td>
<td align="left" style="background-color:#DCE6F1">8,11</td>
<td align="left" style="background-color:#DCE6F1">973</td>
<td align="left" style="background-color:#DCE6F1">947</td>
<td align="char" char="." style="background-color:#DCE6F1">0.97</td>
<td align="char" char="." style="background-color:#DCE6F1">0.99</td>
<td align="char" char="." style="background-color:#DCE6F1">0.98</td>
</tr>
<tr>
<td align="left" style="background-color:#DCE6F1">NKT</td>
<td align="left" style="background-color:#DCE6F1">1302</td>
<td align="left" style="background-color:#DCE6F1">6,13</td>
<td align="left" style="background-color:#DCE6F1">1037</td>
<td align="left" style="background-color:#DCE6F1">863</td>
<td align="char" char="." style="background-color:#DCE6F1">0.83</td>
<td align="char" char="." style="background-color:#DCE6F1">0.66</td>
<td align="char" char="." style="background-color:#DCE6F1">0.74</td>
</tr>
<tr>
<td align="left" style="background-color:#DCE6F1">Vd2</td>
<td align="left" style="background-color:#DCE6F1">1034</td>
<td align="left" style="background-color:#DCE6F1">9,12</td>
<td align="left" style="background-color:#DCE6F1">1178</td>
<td align="left" style="background-color:#DCE6F1">977</td>
<td align="char" char="." style="background-color:#DCE6F1">0.83</td>
<td align="char" char="." style="background-color:#DCE6F1">0.94</td>
<td align="char" char="." style="background-color:#DCE6F1">0.88</td>
</tr>
<tr>
<td align="left" rowspan="5" style="background-color:#C5D9F1"><bold>PhenoGraph</bold></td>
<td align="left" style="background-color:#C5D9F1">CD4</td>
<td align="left" style="background-color:#C5D9F1">4097</td>
<td align="left" style="background-color:#C5D9F1">1,2,3,5,10</td>
<td align="left" style="background-color:#C5D9F1">4254</td>
<td align="left" style="background-color:#C5D9F1">4034</td>
<td align="char" char="." style="background-color:#C5D9F1">0.95</td>
<td align="char" char="." style="background-color:#C5D9F1">0.98</td>
<td align="char" char="." style="background-color:#C5D9F1">0.96</td>
<td align="char" char="." rowspan="5" style="background-color:#C5D9F1">0.854</td>
</tr>
<tr>
<td align="left" style="background-color:#C5D9F1">CD8</td>
<td align="left" style="background-color:#C5D9F1">1897</td>
<td align="left" style="background-color:#C5D9F1">6,8</td>
<td align="left" style="background-color:#C5D9F1">1375</td>
<td align="left" style="background-color:#C5D9F1">1269</td>
<td align="char" char="." style="background-color:#C5D9F1">0.92</td>
<td align="char" char="." style="background-color:#C5D9F1">0.67</td>
<td align="char" char="." style="background-color:#C5D9F1">0.78</td>
</tr>
<tr>
<td align="left" style="background-color:#C5D9F1">NK</td>
<td align="left" style="background-color:#C5D9F1">958</td>
<td align="left" style="background-color:#C5D9F1">9,12</td>
<td align="left" style="background-color:#C5D9F1">953</td>
<td align="left" style="background-color:#C5D9F1">936</td>
<td align="char" char="." style="background-color:#C5D9F1">0.98</td>
<td align="char" char="." style="background-color:#C5D9F1">0.98</td>
<td align="char" char="." style="background-color:#C5D9F1">0.98</td>
</tr>
<tr>
<td align="left" style="background-color:#C5D9F1">NKT</td>
<td align="left" style="background-color:#C5D9F1">1302</td>
<td align="left" style="background-color:#C5D9F1">7,13</td>
<td align="left" style="background-color:#C5D9F1">1546</td>
<td align="left" style="background-color:#C5D9F1">917</td>
<td align="char" char="." style="background-color:#C5D9F1">0.59</td>
<td align="char" char="." style="background-color:#C5D9F1">0.7</td>
<td align="char" char="." style="background-color:#C5D9F1">0.64</td>
</tr>
<tr>
<td align="left" style="background-color:#C5D9F1">Vd2</td>
<td align="left" style="background-color:#C5D9F1">1034</td>
<td align="left" style="background-color:#C5D9F1">4,11,14</td>
<td align="left" style="background-color:#C5D9F1">1160</td>
<td align="left" style="background-color:#C5D9F1">998</td>
<td align="char" char="." style="background-color:#C5D9F1">0.86</td>
<td align="char" char="." style="background-color:#C5D9F1">0.97</td>
<td align="char" char="." style="background-color:#C5D9F1">0.91</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>We annotated the clusters detected by ClusterX based on the median expression of markers, which revealed different stages of CD4<sup>+</sup> and CD8<sup>+</sup> T cell differentiation, and three subsets of γδT, NK and NKT cells (<xref ref-type="fig" rid="pcbi.1005112.g007">Fig 7(a)</xref>). Unlike ClusterX, DensVM did not distinguish the CD8 effector population and CD4 late effector population (<xref ref-type="fig" rid="pcbi.1005112.g007">Fig 7(b)</xref>). PhenoGraph detected the ClusterX annotated CD8 effector population and the NKT population as one population (<xref ref-type="fig" rid="pcbi.1005112.g007">Fig 7(c)</xref>). It should be noted that these manually annotated cell populations need to be further validated experimentally. Without experimental validation, we could not determine if clusters 10, 12 and 15 in ClusterX represent truly distinct cell populations or are a result of over-fragmentation. Despite these small differences, all three methods were able to define cellular heterogeneity with a higher efficiency and resolution than manual gating, and we suggest users to try multiple clustering methods for their own data analysis. The clustering results for the CD4<sup>+</sup> T cell dataset can be seen in <xref ref-type="supplementary-material" rid="pcbi.1005112.s006">S2 Fig</xref>.</p>
<fig id="pcbi.1005112.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Clusters annotation with heat map.</title>
<p>Heat maps show median marker expression of clusters detected by (a) ClusterX, (b) DensVM and (c) PhenoGraph respectively. Heat map row labels represent the cluster IDs and column labels show the marker names. Clusters are annotated by its expression profile in (a).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Assess ISOMAP, diffusion map and t-SNE for inferring inter-cluster relationship</title>
<p>To investigate the performance of ISOMAP, diffusion map and t-SNE for mapping potential relationships between cell subsets, we sub-sampled 10000 cells from the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset and repeated ISOMAP, diffusion map and t-SNE analysis three times. <xref ref-type="fig" rid="pcbi.1005112.g008">Fig 8</xref> shows that the relative geometric locations of ClusterX clusters on a t-SNE map are a poor measure of between cluster similarities. This is manifested by the evident shift of the relative positions of cell clusters on the t-SNE maps of three subsamples. For example, cluster 11 and cluster 3 were close to each other in subsample 1 and subsample 3 but far apart in subsample 2. Similar changes were also observed on the positional relationships between cluster 11 and 10, or cluster 13 and 6. In contrast, ISOMAP and diffusion map were both able to consistently reproduce the structure of cluster relationship and the relative locations of these clusters remain consistent in all three subsamples.</p>
<fig id="pcbi.1005112.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Assessing ISOMAP, diffusion map and t-SNE for inference of subset relationship.</title>
<p>Three subsamples are down-sampled from the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset with equal cell number of 10000. From top to bottom row, the relationship of Cluster X clusters is visualized by t-SNE, ISOMAP and diffusion map on each of the subsample. Cells are color-coded by ClusterX clusters, and cluster IDs are added at the center of each cluster.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.g008" xlink:type="simple"/>
</fig>
<p>To remove the density heterogeneity among cell subsets, we down-sampled 500 cells from each cluster using method <italic>ceil</italic>. Then we plotted the cell subsets using the first two components calculated by ISOMAP and diffusion map (<xref ref-type="fig" rid="pcbi.1005112.g009">Fig 9</xref>). The two methods both give a U-shape like structure of the relationship of cell subsets. On one arm of the U-shape are CD4<sup>+</sup> and naïve CD8<sup>+</sup> T cells, which do not exhibit cytotoxic capabilities, as evidenced by the lack of <italic>Perforin</italic> expression (<xref ref-type="fig" rid="pcbi.1005112.g009">Fig 9(b)</xref>). On the opposite arm are γδ Vd<sup>+</sup>, γδ Vd<sup>−</sup>, CD8 Eff, NKT and NK cells, which were located in order along the second component. We found a continuous increase in the expression of <italic>Perforin</italic> and <italic>GranzymeB</italic> along the second component indicating a progression of increased cytotoxic capabilities of these subsets (<xref ref-type="fig" rid="pcbi.1005112.g009">Fig 9(c)</xref>). On another dataset which we previously published, ISOMAP was able to display three hypothesized progression paths of CD4<sup>+</sup> T cells spanning across blood and tonsils [<xref ref-type="bibr" rid="pcbi.1005112.ref017">17</xref>]. To summarize, although t-SNE better discriminates cells of distinct phenotypes, we highlight the limitation of t-SNE and suggest using ISOMAP or diffusion map for inferring relatedness between subsets.</p>
<fig id="pcbi.1005112.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005112.g009</object-id>
<label>Fig 9</label>
<caption>
<title/>
<p><bold>(a) ISOMAP and diffusion map plots of the down-sampled subsets.</bold> Cells are color-coded by ClusterX clusters. Cluster IDs are labeled at the center of each cluster (b) Plots of the expression level of marker <italic>Perforin</italic> using ISOMAP and diffusion map. Estimated progression among annotated subsets γδ Vd<sup>+</sup>, γδ Vd<sup>−</sup>, CD8 Eff, NKT and NK are added on the plots. (c) The expression profiles of marker <italic>Perforin</italic> and <italic>GranzymeB</italic> for cluster 11, 12, 13, 14 and 15 are visualized on the second component of ISOMAP and diffusion map (reversed order). The regression line estimated using the generalized linear model (GLM) is added for each marker.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.g009" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec015" sec-type="conclusions">
<title>Conclusion</title>
<p>In summary, we developed an integrated analysis pipeline for mass cytometry data, termed cytofkit. Combining state-of-the-art methods and in-house developed algorithms, we aim to provide a one-stop analysis toolkit for mass cytometry data with user-selectable options and customizable framework. Cytofkit can take commands from a user friendly GUI and performs analysis including pre-processing, cell subset detection, plots for visualization and annotation, and inference of the relatedness between cell subsets. In the end, the analysis results can be further explored in an interactive way using the specifically designed shiny APP. Our analytical pipeline provides an automated mass cytometry data analysis toolset, which can be used by bench scientists without any training.</p>
</sec>
<sec id="sec016">
<title>Availability and Future Directions</title>
<p>Cytofkit was implemented using R and has been published on Bioconductor (<ext-link ext-link-type="uri" xlink:href="https://bioconductor.org/packages/cytofkit/" xlink:type="simple">https://bioconductor.org/packages/cytofkit/</ext-link>). It is also available on github (<ext-link ext-link-type="uri" xlink:href="https://github.com/JinmiaoChenLab/cytofkit" xlink:type="simple">https://github.com/JinmiaoChenLab/cytofkit</ext-link>). Detailed documentations and demos can be found in the vignettes of the package, including cytofkit quick start (<ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_example.html" xlink:type="simple">https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_example.html</ext-link>), cytofkit workflow (<ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_workflow.html" xlink:type="simple">https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_workflow.html</ext-link>) and cytofkit shinyAPP (<ext-link ext-link-type="uri" xlink:href="https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_shinyAPP.html" xlink:type="simple">https://www.bioconductor.org/packages/release/bioc/vignettes/cytofkit/inst/doc/cytofkit_shinyAPP.html</ext-link>). Cytofkit is developed with a general framework, which makes it easily extensible to add in new methods and also applicable to other multi-parameter data types. We are continually working on new algorithms for inferring cellular progression as well as meta-clustering methods for comparative analysis between multiple batches of data. New methods will be added into cytofkit to make it more useful for automatic mass cytometry data analysis.</p>
</sec>
<sec id="sec017">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005112.s001" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.s001" xlink:type="simple">
<label>S1 Dataset</label>
<caption>
<title>Zip file containing cytofkit package source code, the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset and the CD4<sup>+</sup> T cell dataset.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005112.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.s002" xlink:type="simple">
<label>S1 File</label>
<caption>
<title>Data description, data transformation methods, detailed description of ClusterX and analysis procedure and codes.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005112.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.s003" xlink:type="simple">
<label>S2 File</label>
<caption>
<title>Instruction on the usage of the cytofkit GUI and package.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005112.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.s004" xlink:type="simple">
<label>S3 File</label>
<caption>
<title>Instruction on the usage of cytofkit shiny APP.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005112.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.s005" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Gating strategy for CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset. Five populations including CD4<sup>+</sup>, CD8<sup>+</sup>, γδT, CD3<sup>+</sup>CD56<sup>+</sup> NKT and CD3<sup>−</sup>CD56<sup>+</sup> NK cells are manually gated from the CD14<sup>−</sup>CD19<sup>−</sup> PBMCs dataset using FlowJo software.</title>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005112.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.s006" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>The comparison of clustering results for CD4<sup>+</sup> T cell dataset.</title>
<p>Each panel represents one clustering results mapped on the t-SNE plot; from left to right they are (a) clustering results of ClusterX, (b) clustering results of DensVM and (c) clustering results of PhenoGraph. Clusters were annotated by different colors and with cluster ID at the center of the cluster.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005112.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.s007" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Illustration of density peak detection in ClusterX using R15 dataset.</title>
<p>(a) Scatter plot of the D15 dataset with 15 clusters, clusters are color labeled and cluster centers are labeled by circles with crosses. (b) CFSFDP’s density peak detection method in which plots of delta against rho are generated, and users manually set a threshold point to determine the density peaks (c) ClusterX’s density peak detection method in which plots of sigma against the rank of rho are generated, and true peak points have significantly higher values of sigma. (d) ClusterX uses the generalized ESD to detect the density peaks automatically, wherein sigma is assumed to have normal distribution and peaks are regarded as anomalies that have significantly higher sigma values.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005112.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.s008" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Robustness of peak number with <italic>p</italic>-value selection in ClusterX.</title>
<p>The number of density peaks is plotted over different α values within the range from 0.001 to 0.05 on the R15 datasets.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005112.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005112.s009" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Split-apply-combine implementation in ClusterX.</title>
<p>In ClusterX, data are first split row-wisely into chunks, the distance matrix is calculated in each chunk to be restricted in a limited size; then apply the calculation function for each parameters in each chunk; Finally the parameters are combined from all chunks for post processing.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors thank the SIgN community for helpful discussion and technical support.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005112.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bandura</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Baranov</surname> <given-names>VI</given-names></name>, <name name-style="western"><surname>Ornatsky</surname> <given-names>OI</given-names></name>, <name name-style="western"><surname>Antonov</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kinach</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lou</surname> <given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Mass cytometry: Technique for real time single cell multitarget immunoassay based on inductively coupled plasma time-of-flight mass spectrometry</article-title>. <source>Anal Chem</source>. <year>2009</year>;<volume>81</volume>: <fpage>6813</fpage>–<lpage>6822</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ac901049w" xlink:type="simple">10.1021/ac901049w</ext-link></comment> <object-id pub-id-type="pmid">19601617</object-id></mixed-citation></ref>
<ref id="pcbi.1005112.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ornatsky</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Bandura</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Baranov</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Nitz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Winnik</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Tanner</surname> <given-names>S</given-names></name>. <article-title>Highly multiparametric analysis by mass cytometry</article-title>. <source>J Immunol Methods</source>. <year>2010</year>;<volume>361</volume>: <fpage>1</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jim.2010.07.002" xlink:type="simple">10.1016/j.jim.2010.07.002</ext-link></comment> <object-id pub-id-type="pmid">20655312</object-id></mixed-citation></ref>
<ref id="pcbi.1005112.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Nolan</surname> <given-names>GP</given-names></name>, <name name-style="western"><surname>Roederer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chattopadhyay</surname> <given-names>PK</given-names></name>. <article-title>A deep profiler’s guide to cytometry</article-title>. <source>Trends Immunol. Elsevier Ltd</source>; <year>2012</year>;<volume>33</volume>: <fpage>323</fpage>–<lpage>332</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.it.2012.02.010" xlink:type="simple">10.1016/j.it.2012.02.010</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Newell</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Nolan</surname> <given-names>GP</given-names></name>, <name name-style="western"><surname>Roederer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chattopadhyay</surname> <given-names>PK</given-names></name>, <etal>et al</etal>. <article-title>Beyond model antigens: high-dimensional methods for the analysis of antigen-specific T cells</article-title>. <source>Nat Biotechnol. Nature Publishing Group</source>; <year>2014</year>;<volume>32</volume>: <fpage>149</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2783" xlink:type="simple">10.1038/nbt.2783</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Amir</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Tadmor</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Simonds</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <etal>et al</etal>. <article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>. <source>Nat Biotechnol. Nature Publishing Group</source>; <year>2013</year>;<volume>31</volume>: <fpage>545</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2594" xlink:type="simple">10.1038/nbt.2594</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Qiu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Simonds</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>KD</surname> <given-names>G</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Robert</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Linderman</surname> <given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>A n a ly s i s Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</article-title>. <source>Nat Biotechnol. Nature Publishing Group</source>; <year>2011</year>;<volume>29</volume>: <fpage>886</fpage>–<lpage>891</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005112.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Simonds</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Qiu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Amir</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Krutzik</surname> <given-names>PO</given-names></name>, <name name-style="western"><surname>Finck</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Single-cell mass cytometry of differential immune and drug responses across a human hematopoietic continuum</article-title>. <source>Science</source>. <year>2011</year>;<volume>332</volume>: <fpage>687</fpage>–<lpage>696</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1198704" xlink:type="simple">10.1126/science.1198704</ext-link></comment> <object-id pub-id-type="pmid">21551058</object-id></mixed-citation></ref>
<ref id="pcbi.1005112.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Atkuri</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Stevens</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Neubert</surname> <given-names>H</given-names></name>. <article-title>Mass cytometry: a highly multiplexed single-cell technology for advancing drug development</article-title>. <source>Drug Metab Dispos</source>. <year>2015</year>;<volume>43</volume>: <fpage>227</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1124/dmd.114.060798" xlink:type="simple">10.1124/dmd.114.060798</ext-link></comment> <object-id pub-id-type="pmid">25349123</object-id></mixed-citation></ref>
<ref id="pcbi.1005112.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zunder</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Lujan</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Goltsev</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wernig</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nolan</surname> <given-names>GP</given-names></name>. <article-title>A Continuous Molecular Roadmap to iPSC Reprogramming through Progression Analysis of Single-Cell Mass Cytometry</article-title>. <source>Cell Stem Cell. Elsevier Inc.</source>; <year>2015</year>;<volume>16</volume>: <fpage>323</fpage>–<lpage>337</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.stem.2015.01.015" xlink:type="simple">10.1016/j.stem.2015.01.015</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levine</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Simonds</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Amir</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Tadmor</surname> <given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Data-Driven Phenotypic Dissection of AML Reveals Progenitor-like Cells that Correlate with Prognosis</article-title>. <source>Cell. Elsevier Inc.</source>; <year>2015</year>; <fpage>1</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2015.05.047" xlink:type="simple">10.1016/j.cell.2015.05.047</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zunder</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Finck</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Behbehani</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Amir</surname> <given-names>E-AD</given-names></name>, <name name-style="western"><surname>Krishnaswamy</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gonzalez</surname> <given-names>VD</given-names></name>, <etal>et al</etal>. <article-title>Palladium-based mass tag cell barcoding with a doublet-filtering scheme and single-cell deconvolution algorithm</article-title>. <source>Nat Protoc. Nature Publishing Group</source>; <year>2015</year>;<volume>10</volume>: <fpage>316</fpage>–<lpage>33</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nprot.2015.020" xlink:type="simple">10.1038/nprot.2015.020</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Finck</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Simonds</surname> <given-names>E</given-names></name>. <article-title>Normalization of mass cytometry data with bead standards</article-title>. <source>Cytom Part</source> …. <year>2013</year>; <fpage>483</fpage>–<lpage>494</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/cyto.a.22271" xlink:type="simple">10.1002/cyto.a.22271</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Newell</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Sigal</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Nolan</surname> <given-names>GP</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>MM</given-names></name>. <article-title>Cytometry by Time-of-Flight Shows Combinatorial Cytokine Expression and Virus-Specific Cell Niches within a Continuum of CD8 + T Cell Phenotypes</article-title>. <source>Immunity. Elsevier Inc</source>.; <year>2012</year>;<volume>36</volume>: <fpage>142</fpage>–<lpage>152</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.immuni.2012.01.002" xlink:type="simple">10.1016/j.immuni.2012.01.002</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van Der Maaten</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Visualizing Data using t-SNE</article-title>. <source>J Mach Learn Res</source>. <year>2008</year>;<volume>9</volume>: <fpage>2579</fpage>–<lpage>2605</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005112.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shekhar</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Brodin</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Chakraborty</surname> <given-names>AK</given-names></name>. <article-title>Automatic Classification of Cellular Expression by Nonlinear Stochastic Embedding (ACCENSE)</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2013</year>;<volume>111</volume>: <fpage>202</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1321405111" xlink:type="simple">10.1073/pnas.1321405111</ext-link></comment>/-/DCSupplemental.<ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/cgi/doi/10.1073/pnas.1321405111" xlink:type="simple">www.pnas.org/cgi/doi/10.1073/pnas.1321405111</ext-link> <object-id pub-id-type="pmid">24344260</object-id></mixed-citation></ref>
<ref id="pcbi.1005112.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Becher</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Schlitzer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mair</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sumatoh</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Wei</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>High-dimensional analysis of the murine myeloid cell system</article-title>. <source>Nat Immunol</source>. <year>2014</year>;<fpage>15</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005112.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wong</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Narayanan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Anicete</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kiaang</surname> <given-names>HTK</given-names></name>, <etal>et al</etal>. <article-title>Mapping the Diversity of Follicular Helper T Cells in Human Blood and Tonsils Using High-Dimensional Mass Cytometry Analysis</article-title>. <source>Cell Rep. Elsevier</source>; <year>2016</year>;<volume>11</volume>: <fpage>1822</fpage>–<lpage>1833</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.celrep.2015.05.022" xlink:type="simple">10.1016/j.celrep.2015.05.022</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blondel</surname> <given-names>VD</given-names></name>, <name name-style="western"><surname>Guillaume</surname> <given-names>J-L</given-names></name>, <name name-style="western"><surname>Lambiotte</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lefebvre</surname> <given-names>E</given-names></name>. <article-title>Fast unfolding of communities in large networks</article-title>. <source>J Stat Mech Theory Exp</source>. <year>2008</year>;<volume>10008</volume>: <fpage>6</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/1742-5468/2008/10/P10008" xlink:type="simple">10.1088/1742-5468/2008/10/P10008</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Amir</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Tadmor</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Simonds</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>TJ</given-names></name>, <etal>et al</etal>. <source>Single-Cell Trajectory Detection Uncovers Progression and Regulatory Coordination in Human B Cell Development</source>. <year>2014</year>;<volume>157</volume>: <fpage>714</fpage>–<lpage>725</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2014.04.005" xlink:type="simple">10.1016/j.cell.2014.04.005</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Setty</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tadmor</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Reich-Zeliger</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Angel</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Salame</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Kathail</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title>. <source>Nat Biotechnol. Nature Publishing Group</source>; <year>2016</year>; <fpage>1</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.3569" xlink:type="simple">10.1038/nbt.3569</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haghverdi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Buettner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>. <article-title>Diffusion maps for high-dimensional single-cell analysis of differentiation data</article-title>. <source>Bioinformatics</source>. <year>2015</year>; <fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv325" xlink:type="simple">10.1093/bioinformatics/btv325</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schlitzer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chakarov</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ginhoux</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Poidinger</surname> <given-names>M</given-names></name>. <article-title>Mpath maps multi-branching single-cell trajectories revealing progenitor cell progression during development</article-title>. <source>Nat Commun. Nature Publishing Group</source>; <year>2016</year>;<volume>7</volume>: <fpage>11988</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms11988" xlink:type="simple">10.1038/ncomms11988</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van Gassen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Callebaut</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Van Helden</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Lambrecht</surname> <given-names>BN</given-names></name>, <name name-style="western"><surname>Demeester</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dhaene</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>FlowSOM : Using Self-Organizing Maps for Visualization and Interpretation of Cytometry Data</article-title>. <source>Cytometry A</source>. <year>2015</year>; <fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/cyto.a.22625" xlink:type="simple">10.1002/cyto.a.22625</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>de Silva</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Langford</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>De Silva</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Langford</surname> <given-names>JC</given-names></name>. <article-title>A global geometric framework for nonlinear dimensionality reduction</article-title>. <source>Science. American Association for the Advancement of Science</source>; <year>2000</year>;<volume>290</volume>: <fpage>2319</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.290.5500.2319" xlink:type="simple">10.1126/science.290.5500.2319</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van Der Maaten</surname> <given-names>L</given-names></name>. <article-title>Accelerating t-SNE using Tree-Based Algorithms</article-title>. <source>J Mach Learn Res</source>. <year>2014</year>;<volume>15</volume>(<issue>Oct</issue>): <fpage>3221</fpage>–<lpage>3245</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005112.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Monaco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Poidinger</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>de Magalhaes</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Larbi</surname> <given-names>A</given-names></name>. <article-title>flowAI: automatic and interactive anomaly discerning tools for flow cytometry data</article-title>. <source>Bioinformatics</source>. <year>2016</year>; btw191–. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btw191" xlink:type="simple">10.1093/bioinformatics/btw191</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rodriguez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Laio</surname> <given-names>A</given-names></name>. <article-title>Clustering by fast search and find of density peaks</article-title>. <source>Science</source>. <year>2014</year>;<volume>344</volume>: <fpage>1492</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1242072" xlink:type="simple">10.1126/science.1242072</ext-link></comment> <object-id pub-id-type="pmid">24970081</object-id></mixed-citation></ref>
<ref id="pcbi.1005112.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wickham</surname> <given-names>H</given-names></name>. <article-title>The Split-Apply-Combine Strategy for Data</article-title>. <source>J Stat Softw</source>. <year>2011</year>;<volume>40</volume>: <fpage>1</fpage>–<lpage>29</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005112.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rosner</surname> <given-names>B</given-names></name>. <article-title>Percentage Points for a Generalized ESD Many-Outlier Procedure</article-title>. <source>Technometrics</source>. <year>1983</year>;<volume>25</volume>: <fpage>165</fpage>–<lpage>172</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/1268549" xlink:type="simple">10.2307/1268549</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005112.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cacchiarelli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Grimsby</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pokharel</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Morse</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nat Biotechnol. Nature Publishing Group</source>; <year>2014</year>;<volume>32</volume>: <fpage>381</fpage>–<lpage>386</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2859" xlink:type="simple">10.1038/nbt.2859</ext-link></comment></mixed-citation></ref>
</ref-list>
</back>
</article>