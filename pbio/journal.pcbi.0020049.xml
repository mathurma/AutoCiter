<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN"><front><journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="publisher">pcbi</journal-id><journal-id journal-id-type="flc">plcb</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher><publisher-name>Public Library of Science</publisher-name><publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta><article-meta><article-id pub-id-type="doi">10.1371/journal.pcbi.0020049</article-id><article-id pub-id-type="publisher-id">05-PLCB-RA-0306R2</article-id><article-id pub-id-type="sici">plcb-02-05-12</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject></subj-group><subj-group subj-group-type="System Taxonomy"><subject>Eukaryotes</subject></subj-group></article-categories><title-group><article-title>Transcription Factor Map Alignment of Promoter Regions</article-title><alt-title alt-title-type="running-head">TF-Map Alignment of Promoter Regions</alt-title></title-group><contrib-group><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Blanco</surname><given-names>Enrique</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Messeguer</surname><given-names>Xavier</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>Temple F</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib><contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Guigó</surname><given-names>Roderic</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib></contrib-group><aff id="aff1">
				<label>1</label><addr-line> Research Group in Biomedical Informatics, Institut Municipal d'Investigació Mèdica/Universitat Pompeu Fabra, Barcelona, Catalonia, Spain
			</addr-line></aff><aff id="aff2">
				<label>2</label><addr-line> Grup d'Algorísmica i Genètica, Departament de Llenguatges i Sistemes Informàtics, Universitat Politècnica de Catalunya, Barcelona, Catalonia, Spain
			</addr-line></aff><aff id="aff3">
				<label>3</label><addr-line> Biomolecular Engineering Research Center, Boston University, Boston, Massachusetts, United States of America
			</addr-line></aff><aff id="aff4">
				<label>4</label><addr-line> Bioinformatics and Genomics Program, Centre de Regulació Genòmica, Barcelona, Catalonia, Spain
			</addr-line></aff><contrib-group><contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Bourne</surname><given-names>Philip</given-names></name><role>Editor</role><xref ref-type="aff" rid="edit1"/></contrib></contrib-group><aff id="edit1">University of California San Diego, United States of America</aff><author-notes><fn fn-type="con" id="ack1"><p>EB, XM, TFS, and RG conceived and designed the experiments. EB performed the experiments. EB, XM, and RG analyzed the data. RG contributed reagents/materials/analysis tools. EB, XM, and RG wrote the paper.</p></fn><corresp id="cor1">* To whom correspondence should be addressed. E-mail: <email xlink:type="simple">rguigo@imim.es</email></corresp><fn fn-type="conflict" id="ack3"><p> The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="ppub"><month>5</month><year>2006</year></pub-date><pub-date pub-type="epub"><day>26</day><month>5</month><year>2006</year></pub-date><volume>2</volume><issue>5</issue><elocation-id>e49</elocation-id><history><date date-type="received"><day>31</day><month>10</month><year>2005</year></date><date date-type="accepted"><day>31</day><month>3</month><year>2006</year></date></history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2006</copyright-year><copyright-holder>Blanco et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract><p>We address the problem of comparing and characterizing the promoter regions of genes with similar expression patterns. This remains a challenging problem in sequence analysis, because often the promoter regions of co-expressed genes do not show discernible sequence conservation. In our approach, thus, we have not directly compared the nucleotide sequence of promoters. Instead, we have obtained predictions of transcription factor binding sites, annotated the predicted sites with the labels of the corresponding binding factors, and aligned the resulting sequences of labels—to which we refer here as transcription factor maps (TF-maps). To obtain the global pairwise alignment of two TF-maps, we have adapted an algorithm initially developed to align restriction enzyme maps. We have optimized the parameters of the algorithm in a small, but well-curated, collection of human–mouse orthologous gene pairs. Results in this dataset, as well as in an independent much larger dataset from the CISRED database, indicate that TF-map alignments are able to uncover conserved regulatory elements, which cannot be detected by the typical sequence alignments.</p></abstract><abstract abstract-type="synopsis"><title>Synopsis</title><p>Sequence comparisons and alignments are among the most powerful tools in research in biology. Since similar sequences play, in general, similar functions, identification of sequence conservation between two or more nucleotide or amino acid sequences is often used to infer common biological functionality. Sequence comparisons, however, have limitations; often similar functions are encoded by higher order elements which do not hold a univocal relationship to the underlying primary sequence. In consequence, similar functions are frequently encoded by diverse sequences. Promoter regions are a case in point. Often, promoter sequences of genes with similar expression patterns do not show conservation. This is because, even though their expression may be regulated by a similar arrangement of transcription factors, the binding sites for these factors may exhibit great sequence variability. To overcome this limitation, the authors obtain predictions of transcription factor binding sites on promoter sequences, and annotate the predicted sites with the labels of the corresponding transcription factors. They develop an algorithm—inspired in an early algorithm to align restriction enzyme maps—to align the resulting sequence of labels—the so-called TF-maps (transcription factor maps). They show that TF-map alignments are able to uncover conserved regulatory elements common to the promoter regions of co-regulated genes, but those regulatory elements cannot be detected by typical sequence alignments.</p></abstract><funding-group><funding-statement>This work was supported by grant BIO2003–05073 from the Spanish Ministerio de Ciencia y Tecnologia and Instituto Nacional de Bioinformática to RG.</funding-statement></funding-group><counts><page-count count="14"/></counts><!--===== Restructure custom-meta-wrap to custom-meta-group =====--><custom-meta-group><custom-meta><meta-name>citation</meta-name><meta-value>Blanco E, Messeguer X, Smith TF, Guigó R (2006) Transcription factor map alignment of promoter regions. PLoS Comput Biol 2(5): e49. DOI: <ext-link ext-link-type="doi" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.0020049" xlink:type="simple">10.1371/journal.pcbi.0020049</ext-link></meta-value></custom-meta></custom-meta-group></article-meta></front><body><sec id="s1"><title>Introduction</title><p>Sequence comparisons are among the most useful computational techniques in molecular biology. Sequences of characters in the four-letter nucleotide alphabet and in the 20-letter amino acid alphabet are extremely good symbolic representations of the underlying DNA and protein molecules, and encode substantial information on their structure, function, and history.</p><p>Primary sequence comparisons, however, have limitations. Although similar sequences do tend to play similar functions, the opposite is not necessarily true. Often similar functions are encoded in higher order sequence elements—such as, for instance, structural motifs in amino acid sequences—and the relation between these and the underlying primary sequence may not be univocal. As a result, similar functions are frequently encoded by diverse sequences.</p><p>Promoter regions controlling eukaryotic gene expression are a case in point. The information for the control of the initiation of the RNA synthesis by the RNA polymerase II is mostly contained in the gene promoter, a region usually 200 to 2,000 nucleotides long upstream of the transcription start site (TSS) of the gene. Transcription factors (TFs) interact in these regions with sequence-specific elements or motifs (the TF binding sites (TFBSs)). TFBSs are typically 5–8 nucleotides long, and one promoter region usually contains many of them to harbor different TFs [<xref ref-type="bibr" rid="pcbi-0020049-b001">1</xref>]. The interplay between these factors is not well understood, but the motifs appear to be arranged in specific configurations that confer on each gene an individualized spatial and temporal transcription program [<xref ref-type="bibr" rid="pcbi-0020049-b001">1</xref>]. It is assumed, in consequence, that genes exhibiting similar expression patterns would also share similar configurations of TFs in their promoter.</p><p>However, TFBSs associated to the same TF are known to tolerate sequence substitutions without losing functionality, and are often not conserved. Consequently, promoter regions of genes with similar expression patterns may not show sequence similarity, even though they may be regulated by similar configurations of TFs. For instance, only about 30% to 40% of the promoter regions are conserved between human and chicken orthologous genes [<xref ref-type="bibr" rid="pcbi-0020049-b002">2</xref>], and the conservation of human–mouse orthologous promoter regions is only slightly higher than that observed in intergenic regions [<xref ref-type="bibr" rid="pcbi-0020049-b003">3</xref>]. Indeed, despite the recent progress due to the development of techniques based on so-called phylogenetic footprinting [<xref ref-type="bibr" rid="pcbi-0020049-b004">4</xref>], lack of nucleotide sequence conservation between functionally related promoter regions may partially explain the still limited success of current available computational methods for promoter characterization (see [<xref ref-type="bibr" rid="pcbi-0020049-b005">5</xref>] and [<xref ref-type="bibr" rid="pcbi-0020049-b006">6</xref>] for further information).</p><p>In the approach described here, we attempt to overcome this limitation by abstracting the nucleotide sequence, and representing a promoter region by a sequence in a new alphabet in which the different symbols denote different TFs. Using an external mapping function, for instance, a look-up table or a collection of position weight matrices (PWMs) that associates each TF to the nucleotide sequence motifs the factor is known to bind, we can translate the nucleotide sequence of the promoter into a sequence in this new alphabet. These sequences can be aligned. If the scoring of the alignment takes into account not only the presence/absence of a given symbol, but its relative position on the primary nucleotide sequence, the optimal alignment between the promoter regions of two genes with similar expression patterns may reflect the underlying common configuration of TFBSs. We refer to these alignments either as meta-alignments, as they are performed between sequences in a meta-alphabet, or map alignments, since they are obtained after mapping the nucleotide sequence in a higher order alphabet.</p><p>In this paper, first we state formally the problem of mapping a nucleotide sequence into a sequence in an alphabet of TFs denoting symbols (a transcription factor map, or TF-map), and introduce the notion of pairwise alignment between two such sequences or maps. Then, based on an early algorithm to align restriction enzyme maps [<xref ref-type="bibr" rid="pcbi-0020049-b007">7</xref>], we develop an efficient algorithm to obtain the optimal global alignment between two TF-maps. We estimate the optimal parameters of the alignment in a set of well-characterized human–rodent orthologous gene promoters, using a number of different mapping functions (collections of PWMs representing TFBSs). Finally, we evaluate the ability to distinguish co-regulated from non co-regulated genes based on the comparison of promoter sequences. Our results, obtained in CISRED [<xref ref-type="bibr" rid="pcbi-0020049-b008">8</xref>], a large database of human co-regulated genes, and relying on the JASPAR collection [<xref ref-type="bibr" rid="pcbi-0020049-b009">9</xref>] to derive the TF-maps, indicate that comparisons of TF-maps are able to reveal relationships between co-regulated genes that are not detected by nucleotide sequence comparisons.</p></sec><sec id="s2"><title>Results</title><sec id="s2a"><title>The Algorithm</title><sec id="s2a1"><title>Translation of the promoter sequence into a TF-map.</title><p>In our approach, we translate the nucleotide sequence of a promoter region <italic>S</italic> = <italic>s</italic><sub>1</sub><italic>s</italic><sub>2</sub> … <italic>s</italic><sub>k</sub> into a sequence of 4-tuples <italic>A</italic> = <italic>a</italic><sub>1</sub> … <italic>a<sub>n</sub></italic> where each <inline-formula id="pcbi-0020049-ex001"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex001" xlink:type="simple"/></inline-formula>
						 denotes the match with score <inline-formula id="pcbi-0020049-ex002"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex002" xlink:type="simple"/></inline-formula>
						 of a binding site for the TF <inline-formula id="pcbi-0020049-ex003"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex003" xlink:type="simple"/></inline-formula>
						 occurring between the position <inline-formula id="pcbi-0020049-ex004"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex004" xlink:type="simple"/></inline-formula>
						 and the position <inline-formula id="pcbi-0020049-ex005"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex005" xlink:type="simple"/></inline-formula>
						 over the sequence <italic>S</italic>. In the work described in this paper, we obtain the translation from <italic>S</italic> to <italic>A</italic> by running on <italic>S</italic> a collection of PWMs representing binding motifs for TFs (such as, for instance, the collection in TRANSFAC [<xref ref-type="bibr" rid="pcbi-0020049-b010">10</xref>]). For each match over a given threshold, we register in <italic>A</italic> the positions <inline-formula id="pcbi-0020049-ex006"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex006" xlink:type="simple"/></inline-formula>
						, the score <inline-formula id="pcbi-0020049-ex007"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex007" xlink:type="simple"/></inline-formula>
						, and the label <inline-formula id="pcbi-0020049-ex008"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex008" xlink:type="simple"/></inline-formula>
						 of the TF associated to the PWM. The translation preserves the order of <italic>S</italic> in <italic>A</italic>, that is if <italic>i &lt; j</italic> in <italic>A</italic> then <inline-formula id="pcbi-0020049-ex009"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex009" xlink:type="simple"/></inline-formula>
						 (the ≤ is because matches to different TFs may occur at the same position). We will refer to the resulting sequence <italic>A</italic> as a TF-map or simply a map (see <xref ref-type="fig" rid="pcbi-0020049-g001">Figure 1</xref>). Note that other mapping functions, instead of collections of PWMs, can also be used to translate <italic>S</italic> into <italic>A</italic>.
					</p><fig id="pcbi-0020049-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020049.g001</object-id><label>Figure 1</label><caption><title>TF-Map Alignment of the Promoters of Two Hypothetical Co-Regulated Genes</title><p>(A) The sequence of a promoter is searched for occurrences of known binding motifs for TFs. Matches are annotated with the position of the match in the primary sequence, and the label of the TF. Because TFs can bind to motifs showing no sequence conservation, labels of the same TF at different positions may correspond to different underlying nucleotide sequences. We refer here to these sequences of pairs (“label,” “position”) as TF-maps. TF-maps are actually more complicated. First, we do not only register the position of each match, but also its length. Second, while in the example here, sequence motifs are associated to TFs by means of a (binary) look-up table, in our work we have instead used collections of PWMs. Matches to TFBSs are thus scored, and this score is also registered.</p><p>(B) TF-map of the promoter region of two hypothetically co-regulated genes <italic>X</italic> and <italic>Y</italic>. Each letter corresponds to a different TF. We assume that 200 nucleotides upstream of the annotated TSS have been considered, with position 1 corresponding to position −200 from the TSS.</p><p>(C) Global pairwise alignment of the two co-regulated genes <italic>X</italic> and <italic>Y</italic>. Only positions with identical labels can be aligned. Essentially, the alignment finds the longest common substring constrained to maximizing the sum of the scores (unpublished data) of the aligned positions, and minimizing the differences in the distances on the primary sequence between adjacent aligned positions.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.g001" xlink:type="simple"/></fig><p>In the implementation here, matches to PWMs are considered strandless, that is, they are annotated at a given location, irrespective of the orientation in which they occur. While biological evidence suggests that some TFBSs are functional only when present in a given strand, in other cases TF activity appears to be independent of the orientation of the binding site [<xref ref-type="bibr" rid="pcbi-0020049-b011">11</xref>]. Since in general we do not have information about the strand in which a binding site may be functional, we have not considered strand in our analysis.</p></sec><sec id="s2a2"><title>Alignment of TF-maps.</title><p>The alignment of the maps <italic>A</italic> = <italic>a</italic><sub>1</sub> … <italic>a<sub>m</sub></italic> and <italic>B</italic> = <italic>b</italic><sub>1</sub> … <italic>b<sub>n</sub></italic> is a correspondence <italic>T,</italic> maybe empty, between <italic>A</italic> and <italic>B</italic> such that: 1) <inline-formula id="pcbi-0020049-ex010"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex010" xlink:type="simple"/></inline-formula>
						 if and only if <inline-formula id="pcbi-0020049-ex011"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex011" xlink:type="simple"/></inline-formula>
						(that is, two elements are aligned if and only if they correspond to the same TF); 2) if <inline-formula id="pcbi-0020049-ex012"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex012" xlink:type="simple"/></inline-formula>
						<italic>,</italic> then there are no other elements <italic>b<sub>l</sub></italic> (<italic>l</italic> ≠ <italic>j</italic>) in <italic>B</italic> such that <inline-formula id="pcbi-0020049-ex013"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex013" xlink:type="simple"/></inline-formula>
						<italic>,</italic> nor elements <italic>a<sub>k</sub></italic> (<italic>k</italic> ≠ <italic>i</italic>) in <italic>A</italic> such that <inline-formula id="pcbi-0020049-ex014"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex014" xlink:type="simple"/></inline-formula>
						 (that is, each element in <italic>A</italic> is aligned at most to one element in <italic>B</italic>, and vice versa); 3) if <inline-formula id="pcbi-0020049-ex015"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex015" xlink:type="simple"/></inline-formula>
						 and <inline-formula id="pcbi-0020049-ex016"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex016" xlink:type="simple"/></inline-formula>
						and <italic>i</italic> &lt; <italic>k,</italic> then <italic>j</italic> &lt; <italic>l</italic> (that is, the alignment maintains the colinearity between the sequences <italic>A</italic> and <italic>B</italic>); 4) if <inline-formula id="pcbi-0020049-ex017"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex017" xlink:type="simple"/></inline-formula>
						 and <inline-formula id="pcbi-0020049-ex018"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex018" xlink:type="simple"/></inline-formula>
						with <italic>i</italic> &lt; <italic>k</italic> and <italic>j</italic> &lt; <italic>l,</italic> then <inline-formula id="pcbi-0020049-ex019"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex019" xlink:type="simple"/></inline-formula>
						 and <inline-formula id="pcbi-0020049-ex020"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex020" xlink:type="simple"/></inline-formula>
						 (that is, no overlap in the primary sequences is permitted between the sites corresponding to the aligned elements). Usually there are many possible alignments between two given <italic>A</italic> and <italic>B</italic> maps (see <xref ref-type="fig" rid="pcbi-0020049-g001">Figure 1</xref> for an example). Given an alignment <italic>T</italic>
						<disp-formula id="pcbi-0020049-e001"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.e001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>T</mml:mi><mml:mo>&equals;</mml:mo><mml:mo stretchy='true'>&lcub;</mml:mo><mml:mo stretchy='true'>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy='true'>)</mml:mo><mml:mo>,</mml:mo><mml:mo stretchy='true'>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mo stretchy='true'>)</mml:mo><mml:mo>&hellip;</mml:mo><mml:mo stretchy='true'>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo stretchy='true'>)</mml:mo><mml:mo stretchy='true'>&rcub;</mml:mo></mml:mrow></mml:math> --></disp-formula>where <inline-formula id="pcbi-0020049-ex021"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex021" xlink:type="simple"/></inline-formula>
						 is the match between the 4-tuple in position <italic>I<sub>k</sub></italic> from <italic>A</italic> and the 4-tuple in position <italic>J<sub>k</sub></italic> from <italic>B,</italic> we compute the score of the alignment <italic>s(T)</italic> in the following way:
						<disp-formula id="pcbi-0020049-e002"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.e002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mi>s</mml:mi><mml:mo stretchy='true'>(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy='true'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mi>&alpha;</mml:mi><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>&plus;</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mi>s</mml:mi></mml:msubsup><mml:mo>&minus;</mml:mo><mml:mi>&lambda;</mml:mi><mml:mo stretchy='true'>(</mml:mo><mml:mi>m</mml:mi><mml:mo>&plus;</mml:mo><mml:mi>n</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>2</mml:mn><mml:mi>t</mml:mi><mml:mo stretchy='true'>)</mml:mo></mml:math> --><!-- <mml:math display='block'><mml:mo>&minus;</mml:mo><mml:mtext>&thinsp;</mml:mtext><mml:mi>&mu;</mml:mi><mml:mstyle displaystyle='true'><mml:munderover><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:mrow><mml:mo stretchy='true'>|</mml:mo><mml:mo stretchy='true'>(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>&minus;</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy='true'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mo stretchy='true'>(</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>&minus;</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo stretchy='true'>)</mml:mo><mml:mo stretchy='true'>|</mml:mo></mml:mrow></mml:mstyle></mml:math> --></disp-formula>
					</p><p>where <italic>α, λ, μ &gt;</italic> 0<italic>.</italic> That is, the score of the alignment increases with the score of the aligned elements (<italic>α</italic>), and decreases with the number of unaligned elements (<italic>λ</italic>), and with the difference in the distance between adjacent aligned elements (<italic>μ</italic>).</p></sec><sec id="s2a3"><title>Finding the optimal alignment.</title><p>The optimal alignment between two given maps <italic>A</italic> and <italic>B</italic> is the one scoring the maximum among all possible alignments. To obtain such an alignment efficiently, we have implemented an algorithm reminiscent of that proposed by Waterman et al. [<xref ref-type="bibr" rid="pcbi-0020049-b007">7</xref>] to align and compare restriction enzyme maps. This algorithm was developed to find the distance between two homologous restriction maps in terms of minimum weighted sum of genetic events necessary to convert one restriction map into another, where the genetic events are the appearance/disappearance of restriction sites and changes in the number of bases between restriction sites. A restriction map was defined as a sequence of pairs <italic>A</italic> = <italic>a</italic><sub>1</sub> … <italic>a<sub>n</sub></italic> where each pair <inline-formula id="pcbi-0020049-ex022"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex022" xlink:type="simple"/></inline-formula>
						 denotes the restriction endonuclease <inline-formula id="pcbi-0020049-ex023"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex023" xlink:type="simple"/></inline-formula>
						 occurring at position <inline-formula id="pcbi-0020049-ex024"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex024" xlink:type="simple"/></inline-formula>
						 over a nucleotide sequence <italic>S</italic>. Then, the minimum distance <italic>D<sub>ij</sub></italic> required to convert the map <italic>A</italic> = <italic>a</italic><sub>1</sub> … <italic>a<sub>i</sub></italic> into the homologous map <italic>B</italic> = <italic>b</italic><sub>1</sub> … <italic>b<sub>j</sub>,</italic> where the site <inline-formula id="pcbi-0020049-ex025"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex025" xlink:type="simple"/></inline-formula>
						 is equal to the site <inline-formula id="pcbi-0020049-ex026"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex026" xlink:type="simple"/></inline-formula>
						<italic>,</italic> was obtained by applying the following recursion:
						<disp-formula id="pcbi-0020049-e003"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.e003" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&equiv;</mml:mo><mml:mi>D</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:msub><mml:mrow><mml:mi>min</mml:mi><mml:mo></mml:mo></mml:mrow><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:mrow><mml:mi mathsize='6pt'>i</mml:mi><mml:mo mathsize='6pt'>&#x0027;</mml:mo><mml:mo mathsize='6pt'>,</mml:mo><mml:mi mathsize='6pt'>j</mml:mi><mml:mo mathsize='6pt'>&#x0027;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn mathsize='6pt'>0</mml:mn><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:mi mathsize='6pt'>i</mml:mi><mml:mo mathsize='6pt'>&#x0027;</mml:mo><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:mi mathsize='6pt'>i</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn mathsize='6pt'>0</mml:mn><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:mi mathsize='6pt'>j</mml:mi><mml:mo mathsize='6pt'>&#x0027;</mml:mo><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:mi mathsize='6pt'>j</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:msub><mml:mo>&lcub;</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x0027;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x0027;</mml:mo></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&lambda;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x0027;</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x0027;</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:mrow></mml:math> --><!-- <mml:math display='block'><mml:mrow><mml:mo>&plus;</mml:mo><mml:mtext>&thinsp;&thinsp;</mml:mtext><mml:mi>&mu;</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mo>&minus;</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x0027;</mml:mo></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mo>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>p</mml:mi></mml:msubsup><mml:mo>&minus;</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x0027;</mml:mo></mml:mrow><mml:mi>p</mml:mi></mml:msubsup><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mo>&rcub;</mml:mo></mml:mrow></mml:math> --></disp-formula>where λ is the penalty associated with the appearance/disappearance of sites, and <italic>μ</italic> is the penalty associated with the difference in distance between consecutive aligned sites. Here, to align TF-maps <italic>A</italic> and <italic>B</italic>, we adapted the recursion in [<xref ref-type="bibr" rid="pcbi-0020049-b007">7</xref>] to optimize similarity instead. In addition, we included a term (<italic>α</italic>) into the scoring function to weight the scores of the TFBSs. We also explicitly prohibited overlap between the sites. Thus, the maximum similarity between TF-maps <italic>A</italic> = <italic>a</italic><sub>1</sub> … <italic>a<sub>i</sub></italic> and <italic>B</italic> = <italic>b</italic><sub>1</sub> … <italic>b<sub>j</sub>,</italic> where the site <inline-formula id="pcbi-0020049-ex027"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex027" xlink:type="simple"/></inline-formula>
						 is equal to the site <inline-formula id="pcbi-0020049-ex028"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex028" xlink:type="simple"/></inline-formula>
						<italic>,</italic> can be computed as:
						<disp-formula id="pcbi-0020049-e004"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.e004" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>&equiv;</mml:mo><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo>(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>s</mml:mi></mml:msubsup><mml:mo>)</mml:mo></mml:mrow></mml:math> --><!-- <mml:math display='block'><mml:mrow><mml:mo>&plus;</mml:mo></mml:mrow><mml:mtext>&thinsp;&thinsp;</mml:mtext><mml:mi>max</mml:mi><mml:mrow><mml:mtable columnalign='left'><mml:mtr><mml:mtd><mml:mrow><mml:mi mathsize='6pt'>i</mml:mi><mml:mo mathsize='6pt'>&#x0027;</mml:mo><mml:mo mathsize='6pt'>,</mml:mo><mml:mi mathsize='6pt'>j</mml:mi><mml:mo mathsize='6pt'>&#x0027;</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn mathsize='6pt'>0</mml:mn><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:mi mathsize='6pt'>i</mml:mi><mml:mo mathsize='6pt'>&#x0027;</mml:mo><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:mi mathsize='6pt'>i</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn mathsize='6pt'>0</mml:mn><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:mi mathsize='6pt'>j</mml:mi><mml:mo mathsize='6pt'>&#x0027;</mml:mo><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:mi mathsize='6pt'>j</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathsize='6pt'>a</mml:mi><mml:mrow><mml:mi mathsize='6pt'>i</mml:mi><mml:mo>&!prime;</mml:mo></mml:mrow><mml:mi mathsize='6pt'>p</mml:mi><mml:mn mathsize='6pt'>2</mml:mn></mml:msubsup><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:msubsup><mml:mi mathsize='6pt'>a</mml:mi><mml:mi mathsize='6pt'>i</mml:mi><mml:mi mathsize='6pt'>p</mml:mi><mml:mn mathsize='6pt'>1</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi mathsize='6pt'>b</mml:mi><mml:mrow><mml:mi mathsize='6pt'>j</mml:mi><mml:mo>&!prime;</mml:mo></mml:mrow><mml:mi mathsize='6pt'>p</mml:mi><mml:mn mathsize='6pt'>2</mml:mn></mml:msubsup><mml:mo mathsize='6pt'>&lt;</mml:mo><mml:msubsup><mml:mi mathsize='6pt'>b</mml:mi><mml:mi mathsize='6pt'>j</mml:mi><mml:mi mathsize='6pt'>p</mml:mi><mml:mn mathsize='6pt'>1</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>&lcub;</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x0027;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x0027;</mml:mo></mml:mrow></mml:msub><mml:mo>&plus;</mml:mo><mml:mi>&lambda;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>i</mml:mi><mml:mo>&#x0027;</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>&plus;</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>j</mml:mi><mml:mo>&#x0027;</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo></mml:math> --><!-- <mml:math display='block'><mml:mrow><mml:mo>&minus;</mml:mo><mml:mi>&mu;</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mi>i</mml:mi><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>&minus;</mml:mo><mml:msubsup><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&#x0027;</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mo>(</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mi>j</mml:mi><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>&minus;</mml:mo><mml:msubsup><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>&#x0027;</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mn>1</mml:mn></mml:msubsup><mml:mo>)</mml:mo><mml:mo>|</mml:mo><mml:mo>)</mml:mo><mml:mo>&rcub;</mml:mo></mml:mrow></mml:math> --></disp-formula>
					</p></sec><sec id="s2a4"><title>Naive implementation.</title><p>A naive implementation of the recursion above (<xref ref-type="disp-formula" rid="pcbi-0020049-e004">Equation 4</xref>
) involves the recursive filling of the cells <italic>S<sub>ij</sub></italic> in the matrix <italic>S</italic> [<xref ref-type="bibr" rid="pcbi-0020049-b007">7</xref>]. In the pseudocode below (Algorithm 1), the elements of the maps <italic>A</italic> and <italic>B</italic> are represented as structures <italic>a<sub>i</sub></italic> and <italic>b<sub>j</sub></italic>, with the functions <italic>factor, score, pos1,</italic> and <italic>pos2</italic> returning the values of the corresponding fields. The variable <italic>currentSim</italic> stores the optimal score so far computed. The resulting meta-alignment can be easily retrieved using a supplementary structure <italic>path(i,j)</italic> which points to the previous cell in the optimal path leading to cell <italic>S<sub>ij</sub></italic>. In addition, for each cell <italic>S<sub>ij</sub>,</italic> the function <italic>ComputeInitialSimilarity</italic> calculates the initial score of a hypothetical alignment that includes only <italic>a<sub>i</sub></italic> and <italic>b<sub>j</sub>.</italic> Note that to compute the optimal score at <italic>S<sub>ij</sub></italic> with this algorithm, all the cells <italic>S<sub>kl</sub></italic> (<italic>k</italic> &lt; <italic>i</italic>,<italic>l</italic> &lt; <italic>j</italic>) need to be explored. Therefore, if the lengths of the TF-maps <italic>A</italic> and <italic>B</italic> are <italic>m</italic> and <italic>n,</italic> respectively, the cost of computing <italic>S</italic>(<italic>A</italic>,<italic>B</italic>) = <italic>S</italic>(<italic>a<sub>m</sub></italic>,<italic>b<sub>n</sub></italic>) is <italic>O</italic>(<italic>mn · mn</italic>) = <italic>O</italic>(<italic>m</italic><sup>2</sup><italic>n</italic><sup>2</sup>). Under the assumption that <italic>m</italic> and <italic>n</italic> are similar lengths, the final cost function is <italic>O</italic>(<italic>n</italic><sup>4</sup>).
						<disp-formula id="pcbi-0020049-eq001"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.eq001" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd columnalign="left"><mml:mtext>Algorithm 1.</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mtext>Require:</mml:mtext><mml:mi mathvariant="italic">&thinsp;A,B:</mml:mi><mml:mtext>&thinsp;list of &lt;factor,pos1,pos2,score&gt;</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="5pt"/><mml:mo>&lcub;</mml:mo><mml:mtext>Calculating the element&thinsp;</mml:mtext><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mtext>&thinsp;in&thinsp;</mml:mtext><mml:mi>S</mml:mi><mml:mo>&rcub;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="5pt"/><mml:mtext>for&thinsp;</mml:mtext><mml:mi>i</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn><mml:mtext>&thinsp;to&thinsp;</mml:mtext><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mtext>&thinsp;do</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="10pt"/><mml:mtext>for&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn><mml:mtext>&thinsp;to&thinsp;</mml:mtext><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mtext>&thinsp;do</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="15pt"/><mml:mtext>if factor(</mml:mtext><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>) &equals;</mml:mo><mml:mtext>factor</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mtext>then</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mtext>5:</mml:mtext><mml:mspace width="12.5pt"/><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&larr;</mml:mo><mml:mtext>ComputeInitialSimilarity</mml:mtext><mml:mo>();</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="20pt"/><mml:mi>x</mml:mi><mml:mo>&larr;</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>) &plus;</mml:mo><mml:mtext>score</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>));</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="20pt"/><mml:mo>&lcub;</mml:mo><mml:mtext>Searching the best previous match in&thinsp;</mml:mtext><mml:mi>S</mml:mi><mml:mo>&rcub;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="20pt"/><mml:mtext>for&thinsp;</mml:mtext><mml:mi mathvariant="italic">i&prime;</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn><mml:mtext>&thinsp;to&thinsp;</mml:mtext><mml:mi>i</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mtext>&thinsp;do</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="25pt"/><mml:mtext>for&thinsp;</mml:mtext><mml:mi mathvariant="italic">j&prime;</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn><mml:mtext>&thinsp;to</mml:mtext><mml:mtext>&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mtext>&thinsp;</mml:mtext><mml:mtext>do</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mtext>10:</mml:mtext><mml:mspace width="18pt"/><mml:mtext>if pos</mml:mtext><mml:mn>2</mml:mn><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo></mml:mrow></mml:msub><mml:mo>) &lt;</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mtext>&thinsp;and pos</mml:mtext><mml:mn>2</mml:mn><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:mrow></mml:msub><mml:mo>) &lt;</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mtext>&thinsp;then</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="35pt"/><mml:mi>y</mml:mi><mml:mo>&larr;</mml:mo><mml:mi>&lambda;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>&minus;</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:msup><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:msup><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="35pt"/><mml:mi>z</mml:mi><mml:mo>&larr;</mml:mo><mml:mi>&mu;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo>&minus;</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:mrow></mml:msub><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>|</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="35pt"/><mml:mtext>currentSim</mml:mtext><mml:mo>&larr;</mml:mo><mml:mi>S</mml:mi><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>) &plus;</mml:mo><mml:mi>x</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>y</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>z</mml:mi><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="35pt"/><mml:mtext>if currentSim</mml:mtext><mml:mo>&gt;</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mtext>then</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mtext>15:</mml:mtext><mml:mspace width="29pt"/><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&larr;</mml:mo><mml:mtext>currentSim</mml:mtext><mml:mo>;</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula>
					</p></sec><sec id="s2a6"><title>Enhanced implementation.</title><p>Myers and Huang [<xref ref-type="bibr" rid="pcbi-0020049-b012">12</xref>] described an improved algorithm for computing in <italic>O</italic>(<italic>mn</italic>(log <italic>m</italic> + log <italic>n</italic>)) time the minimum distance between two restriction maps of length <italic>m</italic> and <italic>n,</italic> respectively, under the original framework proposed by Waterman et al. [<xref ref-type="bibr" rid="pcbi-0020049-b007">7</xref>]. The algorithm is basically a sparse dynamic programming computation in which candidate lists are used to model the future contribution of all previously computed cells in distance matrix <italic>D</italic> to those yet to be computed. The cells in the list that cannot affect the values of any cell to be computed are eliminated from the list. The key concept of this algorithm is the mapping of the original matrix <italic>D</italic> to another matrix in which each cell is indexed by the positions of the sites in the original sequences, and not by their positions in the maps. During the computation, this matrix is partitioned into intervals for which only a representative cell is used to compute the best alignment ending at each match in a given interval. Here, we cannot directly export this strategy, because in contrast to the restriction enzyme maps which are points in the sequence, TFBSs are sequence intervals (having, thus, two dimensions). In addition, different TFBSs can start at the same point, but end at different positions. Because we explicitly prohibit overlapping between TFBSs in the alignments, the assignation of a cell representative within a given interval must not be irreversible. However, we have still taken advantage of the extreme sparsity of the matrix <italic>S</italic> when aligning TF-maps.</p><p>Note that, in general, the probability of matching two elements from two sequences of characters that follow a uniform random distribution is inversely proportional to the size of the character alphabet. For instance, the probability of matching two nucleotides when comparing two random DNA sequences in the four-letter alphabet is about 0.25. In an alphabet of about 100 characters—the order of magnitude of the alphabets of symbols denoting TFs that we are considering here—such a probability would be about 0.01. When aligning sequences in alphabets of such sizes, the matrix <italic>S</italic> above, which only takes values for match positions between <italic>A</italic> and <italic>B,</italic> becomes therefore extremely sparse. Indeed, <xref ref-type="fig" rid="pcbi-0020049-g002">Figure 2</xref> displays the occupancy of the matrix <italic>S</italic> corresponding to the alignments of the TF-maps obtained on the human and mouse promoters of the <italic>skeletal muscle α-actin</italic> gene.</p><fig id="pcbi-0020049-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020049.g002</object-id><label>Figure 2</label><caption><title>Graphical Representation of the Sparse Dynamic Programming Matrix <italic>S</italic> When Obtaining the TF-Map Alignment between the Human and Mouse Promoters of the <italic>skeletal alpha-actin</italic> Gene, Using Different Collections of PWMs for TFBSs</title><p>The axes of the matrix list the TF labels of the predicted TFBSs in the human and mouse promoters. Despite the differences in the total number of predicted TFBSs depending on the collection, the occupancy of the matrix remains consistently low.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.g002" xlink:type="simple"/></fig><p>We have used three different collections of PWMs for TFBSs (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>) to obtain the TF-maps of both promoter sequences. In all cases, despite the differences in the lengths of the obtained maps, the occupancy of the matrix <italic>S</italic> is well under 5%. In the algorithm below (Algorithm 2), we substitute the two internal nested loops by a list <italic>L</italic> to register the coordinates of the match cells in the sparse matrix <italic>S</italic>. Each node of <italic>L</italic> is represented as structures <italic>p</italic> and <italic>n</italic> with the functions <italic>abscissa</italic> and <italic>ordinate</italic> returning the corresponding coordinates. Thus, to compute the optimal score at the cell <italic>S<sub>ij</sub>,</italic> only the non-empty cells in <italic>S</italic> need to be accessed. In addition, we maintain the list sorted by optimal score, so that the cell scoring the maximum value is at the beginning of the list. Scanning the list from the beginning to the end implies that, in most cases, only a few nodes will need to be accessed before a critical node is reached beyond which the optimal score cannot be improved.</p><p>While investigating the exact complexity of this algorithm is difficult—depending mostly on the size of the input maps and the sparsity of the resulting matrix <italic>S—</italic>the expected time cost analysis can be performed. The <italic>O</italic>(<italic>n</italic><sup>4</sup>) cost of the naive algorithm can be explained in terms of (a) a first quadratic term derived from the obligatory comparison between all of the TFBSs of both maps to detect the match cells and (b) a second quadratic term necessary to search for each match the best adjacent previous pair in the optimal TF-map alignment. In this enhanced algorithm, the contribution (a) is inevitable so that the lower bound of the cost function is the number of matches between both TF-maps, that is <italic>O</italic>(<italic>n</italic><sup>2</sup>). However, the substitution of the two inner loops for a list of cell matches sorted by optimal score does affect the contribution (b). Thus, such a term is now equivalent to the expected number of consulted elements of the ordered list <italic>L</italic> to compute each <italic>S<sub>ij</sub></italic> value. This expectation can be approximated to
						<disp-formula id="pcbi-0020049-e005"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.e005" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>O</mml:mi><mml:mo stretchy='true'>(</mml:mo><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>&alpha;</mml:mi><mml:mo>&isin;</mml:mo><mml:mi>A</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy='true'>(</mml:mo><mml:mi>P</mml:mi><mml:msup><mml:mrow><mml:mo stretchy='false'>(</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo stretchy='false'>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo stretchy='true'>)</mml:mo><mml:mo stretchy='true'>)</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:mrow></mml:math> --></disp-formula>where <italic>A</italic> is the set of symbols (in our case the alphabet of TFs) and <italic>P</italic>(<italic>α</italic>) is the probability to match the symbol <italic>α</italic> in a random trial (it is a particular case of the sequence comparison by hashing, see Theorem 8.1 in [<xref ref-type="bibr" rid="pcbi-0020049-b013">13</xref>]). Therefore, under the previous hypothesis of a comparison between two TF-maps in an alphabet of 100 characters that follows a uniform random distribution (<italic>P</italic>(<italic>α</italic>) = 0.01, only 1% of the matrix is occupied), the expected value of the contribution (b) is <italic>O</italic>(0.01<italic>n</italic><sup>2</sup>).
					</p><p>The empirical results obtained during the program training confirmed such analysis. On average, on the order of 200 million elements were consulted by the naive algorithm during the optimization. In contrast, the enhanced algorithm only needed to access nearly two million elements to compute the same set of alignments (see <xref ref-type="supplementary-material" rid="pcbi-0020049-sg001">Figure S1</xref>).</p><disp-formula id="pcbi-0020049-eq002"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.eq002" xlink:type="simple"/><!-- <mml:math display='block'><mml:mtable columnalign='left'><mml:mtr><mml:mtd columnalign="left"><mml:mtext>Algorithm 2.</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mtext>Require: A,B: list of &lt;factor, pos 1, pos 2, score</mml:mtext><mml:mo>&gt;,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mi>L</mml:mi><mml:mo>:</mml:mo><mml:mtext>list of</mml:mtext><mml:mo>&lt;</mml:mo><mml:mtext>abscissa, ordinate</mml:mtext><mml:mo>&gt;,</mml:mo><mml:mi>L</mml:mi><mml:mo>&equals;</mml:mo><mml:mo>&Oslash;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="10pt"/><mml:mo>&lcub;</mml:mo></mml:mtd><mml:mtd columnalign="left"><mml:mtext>Calculating the element&thinsp;</mml:mtext><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mtext>&thinsp;in&thinsp;</mml:mtext><mml:mi>S</mml:mi><mml:mo>&rcub;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="10pt"/><mml:mtext>for&thinsp;</mml:mtext><mml:mi>i</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn><mml:mtext>&thinsp;to&thinsp;</mml:mtext><mml:mo>|</mml:mo><mml:mi>A</mml:mi><mml:mo>|</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mtext>&thinsp;</mml:mtext><mml:mtext>do</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="15pt"/><mml:mtext>for&thinsp;</mml:mtext><mml:mi>j</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>0</mml:mn><mml:mtext>&thinsp;to&thinsp;</mml:mtext><mml:mo>|</mml:mo><mml:mi>B</mml:mi><mml:mo>|</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mtext>&thinsp;</mml:mtext><mml:mtext>do</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="25pt"/><mml:mtext>if factor(</mml:mtext><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mtext>factor</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mtext>&thinsp;&thinsp;then</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mtext>5:</mml:mtext><mml:mspace width="25pt"/><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&larr;</mml:mo><mml:mtext>ComputeInitialSimilarity</mml:mtext><mml:mo>();</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="32pt"/><mml:mi>x</mml:mi><mml:mo>&larr;</mml:mo><mml:mi>&alpha;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>) &plus;</mml:mo><mml:mtext>score</mml:mtext><mml:mo>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>));</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="31pt"/><mml:mo>&lcub;</mml:mo><mml:mtext>Searching the best previous match in&thinsp;</mml:mtext><mml:mi>L</mml:mi><mml:mo>&rcub;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="32pt"/><mml:mi>p</mml:mi><mml:mo>&larr;</mml:mo><mml:mtext>first</mml:mtext><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>);</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="32pt"/><mml:mi mathvariant="italic">i&prime;</mml:mi><mml:mo>&larr;</mml:mo><mml:mtext>abscissa</mml:mtext><mml:mo>(</mml:mo><mml:mi mathvariant="italic">p</mml:mi><mml:mo>);</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mtext>10:</mml:mtext><mml:mspace width="20pt"/><mml:mi mathvariant="italic">j</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>&larr;</mml:mo><mml:mtext>ordinate</mml:mtext><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>);</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="30pt"/><mml:mtext>while end</mml:mtext><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>) &equals;</mml:mo><mml:mtext>FALSE and&thinsp;&thinsp;</mml:mtext><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:mi>x</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mtext>&thinsp;do</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="38pt"/><mml:mtext>if pos</mml:mtext><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo></mml:mrow></mml:msub><mml:mo>) &lt;</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mtext>and pos</mml:mtext><mml:mn>2</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:mrow></mml:msub><mml:mo>) &lt;</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo><mml:mtext>&thinsp;then</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="48pt"/><mml:mi>y</mml:mi><mml:mo>&larr;</mml:mo><mml:mi>&lambda;</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mi>j</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>&minus;</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy='false'>)</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="48pt"/><mml:mtext>z</mml:mtext><mml:mo>&larr;</mml:mo><mml:mi mathvariant="italic">&mu;</mml:mi><mml:mo>(</mml:mo><mml:mo>|</mml:mo><mml:mo>(</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>) &minus;</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo></mml:mrow></mml:msub><mml:mo>)) &minus;</mml:mo><mml:mo stretchy='false'>(</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="64pt"/><mml:mo>&minus;</mml:mo><mml:mtext>pos</mml:mtext><mml:mn>1</mml:mn><mml:mo>(</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo></mml:mrow></mml:msub><mml:mo>)) |</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>15:</mml:mn><mml:mspace width="35pt"/><mml:mtext>currentSim</mml:mtext><mml:mo>&larr;</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo><mml:mo stretchy='false'>)</mml:mo><mml:mo>&plus;</mml:mo><mml:mi>x</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>y</mml:mi><mml:mo>&minus;</mml:mo><mml:mi>z</mml:mi><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="48pt"/><mml:mtext>if currentSim</mml:mtext><mml:mo>&gt;</mml:mo><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mtext>&thinsp;then</mml:mtext></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="57.5pt"/><mml:mi>S</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&larr;</mml:mo><mml:mtext>currentSim</mml:mtext><mml:mo>;</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="36pt"/><mml:mi>p</mml:mi><mml:mo>&larr;</mml:mo><mml:mtext>next</mml:mtext><mml:mo>(</mml:mo><mml:mi>L</mml:mi><mml:mo>);</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="36pt"/><mml:mi>i</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>&larr;</mml:mo><mml:mtext>abscissa</mml:mtext><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>);</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mn>20:</mml:mn><mml:mspace width="25pt"/><mml:mi>j</mml:mi><mml:mo>&prime;</mml:mo><mml:mo>&larr;</mml:mo><mml:mtext>ordinate</mml:mtext><mml:mo>(</mml:mo><mml:mi>p</mml:mi><mml:mo>);</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="30pt"/><mml:mi>n</mml:mi><mml:mo>&larr;</mml:mo><mml:mtext>CreateNewNode</mml:mtext><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi><mml:mo>);</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd columnalign="left"><mml:mspace width="30pt"/><mml:mtext>InsertNode</mml:mtext><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>L</mml:mi><mml:mo>);</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math> --></disp-formula></sec></sec><sec id="s2b"><title>Using TF-Map Alignments to Characterize Promoter Regions of Co-Regulated Genes in the Absence of Sequence Similarity</title><p>Training results (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>) indicate that alignments of TF-maps can contribute—together with other tools, such as primary sequence alignments—to the characterization of the promoter region of co-regulated genes. This contribution is mostly obtained through the substantial reduction of the overwhelming number of candidate TFBSs that PWMs and other pattern-based searches typically produce. The co-regulated genes in the test case of the training (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>), however, were orthologous human–mouse pairs. The promoter regions of such pairs show substantial sequence conservation [<xref ref-type="bibr" rid="pcbi-0020049-b003">3</xref>]. It can be argued that under such circumstances map alignments may not be much more informative than primary sequence alignments. Note that, in general, good alignments at the primary sequence level will inevitably result—given the low specificity of the PWM search—in good map alignments, although such map alignments may bear little relationship to the underlying conserved configurations of TFBSs.</p><p>To assess to what extent good TF-map alignments are simply a reflection of underlying sequence conservation, we have compared the meta-alignments obtained using the JASPAR<italic><sub>TOP</sub></italic><sub>50</sub> collection of matrices (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>) in the 200 nucleotides of the promoter region of the 36 gene pairs from the HR set that we used in the training (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>), with the meta-alignments obtained in fragments of 200 nucleotides from intergenic (2,000 nucleotides upstream of the TSS), 5′UTR (downstream of the TSS), coding (downstream of the translation start site and considering only coding DNA), intronic (downstream of the first intron junction), and downstream (downstream of the transcription termination site) sequences. We have computed the average score of the map alignments in each of the genomic regions and have identified, for each homologous pair, the genome regions in which the alignment produces the highest score. We have performed the same exercise using global pairwise sequence alignments (obtained with CLUSTALW, [<xref ref-type="bibr" rid="pcbi-0020049-b014">14</xref>]). Results appear in <xref ref-type="table" rid="pcbi-0020049-t001">Table 1</xref> (top). As expected, nucleotide sequence alignments score the highest in the coding regions (in 26 out of 36 cases), followed by the alignments in the promoter (five out of 36) and 5′UTR regions (four out of 36). The scores of the sequence alignments show that promoter regions are less conserved than coding regions, and have a level of conservation similar to that observed in 5′UTRs. Despite this, TF-map alignments score the highest in the promoter regions (in 25 out of 36), where the average score of map alignments is almost twice as high as that of the coding regions. Only in six out of 36 cases does the TF-map alignment score the highest in coding regions. Interestingly, while intron sequences in the orthologous human–mouse pairs are much less conserved than 5′UTRs, TF-map alignments have a similar score in both regions. In fact, in three cases, TF-map alignments have the highest score in first introns, while only in one case in 5′UTRs. This is consistent with the fact that first introns are known to often contain regulatory motifs.</p><table-wrap content-type="2col" id="pcbi-0020049-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020049.t001</object-id><label>Table 1</label><caption><p>Sequence and TF-Map Alignments of Different Genomic Regions between the Human and Mouse Orthologous Pairs in the HR Set and between the Human and Chicken Orthologous Pairs in the HC Set</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.t001" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb1col1" align="left" charoff="0" char=""/><col id="tb1col2" align="left" charoff="0" char=""/><col id="tb1col3" align="char" charoff="0" char="."/><col id="tb1col4" align="char" charoff="0" char="."/><col id="tb1col5" align="char" charoff="0" char="."/><col id="tb1col6" align="char" charoff="0" char="."/></colgroup><thead><tr><td align="left" rowspan="2"><hr/>Set</td><td rowspan="2"><hr/>Genomic Region</td><td colspan="2"><hr/>TF-Map Alignment</td><td colspan="2"><hr/>CLUSTALW</td></tr><tr><td><hr/>TOP1</td><td><hr/>Avg.Score</td><td><hr/>TOP1</td><td><hr/>Avg. Score</td></tr></thead><tbody><tr><td>HR set</td><td>Coding</td><td>6</td><td>10.86</td><td>26</td><td>1211.72</td></tr><tr><td></td><td>Promoter</td><td>25</td><td>20.45</td><td>5</td><td>979.27</td></tr><tr><td></td><td>5&prime;UTR</td><td>1</td><td>4.56</td><td>4</td><td>958.50</td></tr><tr><td></td><td>Downstream</td><td>1</td><td>2.31</td><td>1</td><td>395.38</td></tr><tr><td></td><td>Intronic</td><td>3</td><td>4.43</td><td>0</td><td>525.66</td></tr><tr><td></td><td>Intergenic</td><td>0</td><td>2.51</td><td>0</td><td>421.13</td></tr><tr><td>HC set</td><td>Coding</td><td>2</td><td>1.66</td><td>21</td><td>820.92</td></tr><tr><td></td><td>Promoter</td><td>9</td><td>2.14</td><td>1</td><td>454.52</td></tr><tr><td></td><td>5&prime;UTR</td><td>5</td><td>1.88</td><td>3</td><td>698.12</td></tr><tr><td></td><td>Downstream</td><td>6</td><td>1.63</td><td>0</td><td>358.66</td></tr><tr><td></td><td>Intronic</td><td>3</td><td>1.49</td><td>0</td><td>384.52</td></tr><tr><td></td><td>Intergenic</td><td>0</td><td>1.55</td><td>0</td><td>368.04</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt101"><p>TOP1 is the number of pairs in which the highest scoring alignment is found in a given genomic region.</p></fn></table-wrap-foot> --></table-wrap><p>To measure the ability of TF-map alignments to detect conserved regulatory elements at larger evolutionary distances—at which the degree of sequence conservation may be negligible—we have carried out the same analysis on a set of human–chicken orthologous pairs derived from the HR set. Using the RefSeq gene set as mapped into the UCSC genome browser, we have identified the chicken ortholog for 25 genes in the HR set. We refer to the resulting set of human–chicken gene pairs as the HC set. As before, we have compared promoter, intergenic, 5′UTR, coding, intronic, and downstream sequences between the orthologous human–chicken genes using both TF-map alignments based on JASPAR<italic><sub>TOP</sub></italic><sub>50</sub> and sequence alignments using CLUSTALW. Results appear in <xref ref-type="table" rid="pcbi-0020049-t001">Table 1</xref> (bottom). While, as expected, the scores of the alignments are, in both cases, clearly lower for human–chicken than for human–mouse comparisons, the same relative trends can be observed, with sequence alignments being most significant between coding regions, and TF-map alignments between promoter regions. However, while coding sequences are still distinctively conserved between human and chicken, similarity in promoter sequences degrades substantially. Indeed, in contrast to human–rodent comparisons, 5′UTRs are, for instance, clearly more conserved than the promoters between human and chicken orthologous genes. Despite this lack of sequence similarity in the human–chicken promoter pairs and the fact that we trained our algorithm specifically on human and rodent genes, the TF-maps remarkably still score the highest in these regions (in nine out of 25). Interestingly, TF-map alignments are able to score comparatively high in downstream regions even though they do not appear to exhibit sequence conservation; regulatory motifs have been occasionally reported on these regions. Overall, these results indicate that alignments of TF-maps are able to detect conservation of regulatory signals, which cannot be detected by sequence similarity alone.</p><sec id="s2b1"><title>Detection of co-expression by promoter comparisons in the CISRED database.</title><p>We expect, therefore, the map alignments to be particularly useful to characterize promoter regions of co-regulated genes in the absence of sequence conservation. In such cases, the map alignments can help to recover conserved configurations of TFBSs that primary sequence comparisons would not. It is important to stress in this regard that the match state in the alignment of TF-maps is defined based on the TF label, and not based on the label of the specific binding site. Because a given TF can be associated to different binding sites (for instance, the approximately 90 TFBSs in the HR set correspond only to about 30 TFs), an alignment of TF-maps can include the alignment of TFBSs that show no sequence conservation.</p><p>Many examples could be found in which map alignments produce a better characterization of the promoter region of co-regulated genes than that obtained through primary sequence alignments. We would like, however, to move beyond such anecdotal evidence, and have a more exhaustive evaluation of the power of TF-map alignments to characterize promoter regions of co-regulated genes in the absence of sequence similarity. Toward such a goal, we have used the set of co-regulated genes in the CISRED database [<xref ref-type="bibr" rid="pcbi-0020049-b015">15</xref>]. The CISRED database is primarily a collection of conserved regulatory sequence elements identified by a genome-scale computational system that uses pattern discovery, similarity, clustering, co-occurrence and co-expression calculations. CISRED includes, as well, a database of high-confidence co-expressed gene pairs [<xref ref-type="bibr" rid="pcbi-0020049-b008">8</xref>], obtained from cDNA microarray hybridization, SAGE, and other experiments, as well as from Gene Ontology (GO, [<xref ref-type="bibr" rid="pcbi-0020049-b016">16</xref>]) analysis. Version 1 of CISRED high confidence co-expression human set contains 60,912 co-expression gene pairs for 5,562 genes. Because of the criteria to establish co-regulation within CISRED, we do not expect strong bias toward co-expression pairs sharing strong sequence similarity in their promoter regions.</p><p>We thus performed the following experiment: we compared the promoter region of each gene <italic>x</italic> in the CISRED set with the promoter regions of the genes co-regulated with <italic>x</italic>, <italic>coreg</italic>(<italic>x</italic>), and with the promoter region of the genes not co-regulated with <italic>x</italic>, <inline-formula id="pcbi-0020049-ex029"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex029" xlink:type="simple"/></inline-formula>
						. Even though the promoter of the gene <italic>x</italic> may not show stronger sequence similarity with the promoters of the genes in <italic>coreg</italic>(<italic>x</italic>) than with the promoters of the genes in <inline-formula id="pcbi-0020049-ex030"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex030" xlink:type="simple"/></inline-formula>
						, our assumption is that it will still share some common regulatory signal (maybe very weak) with the promoters of (at least a fraction of) the genes in <italic>coreg</italic>(<italic>x</italic>), whereas no common signal will be shared between the promoter of <italic>x</italic> and the promoters of the genes in <inline-formula id="pcbi-0020049-ex031"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex031" xlink:type="simple"/></inline-formula>
						. Our hypothesis is therefore that alignments of TF-maps will be superior in detecting such signals to alignments of the primary nucleotide sequence. We proceeded in the following way: we used ENSMART [<xref ref-type="bibr" rid="pcbi-0020049-b017">17</xref>] to extract 500 nucleotides upstream of each gene in CISRED according to genome coordinates in ENSEMBL. We used 500 nucleotides upstream here, instead of 200 nucleotides as before, because of the intrinsic imprecision of ENSEMBL when annotating the coordinates of the TSS. We obtained such a sequence for 5,333 out of 5,562 CISRED genes and considered it the promoter region of the gene. For this set of 5,333 genes, 56,632 co-expression gene pairs are described in CISRED. We next used the collection of matrices in JASPAR<italic><sub>TOP</sub></italic><sub>50</sub> (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>) to obtain the TF-maps of each promoter region. Then for each gene <italic>x</italic> we obtained the optimal map alignment with each gene in <italic>coreg</italic>(<italic>x</italic>) and in <inline-formula id="pcbi-0020049-ex032"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex032" xlink:type="simple"/></inline-formula>
						. We used the enhanced algorithm described earlier, with the optimal parameters estimated in the <xref ref-type="sec" rid="s4">Material and Methods</xref> section. Finally, we determined whether the scores of the map alignments between the promoter of gene <italic>x</italic> and the promoters of the genes in <italic>coreg</italic>(<italic>x</italic>) were significantly higher than the scores of the map alignments between the promoter of gene <italic>x</italic> and the promoters of the genes in <inline-formula id="pcbi-0020049-ex033"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex033" xlink:type="simple"/></inline-formula>
						. Because the scores of the optimal TF-maps alignments follow, as optimal sequence alignments, a Gumbel or extreme-value distribution (see <xref ref-type="supplementary-material" rid="pcbi-0020049-sg002">Figure S2</xref> and <xref ref-type="supplementary-material" rid="pcbi-0020049-sg003">Figure S3</xref>), we calculated the Wilcoxon test to assess this hypothesis. We obtained 42,756 non-void <italic>coreg</italic>(<italic>x</italic>) alignments and 20,600,640 non-void <inline-formula id="pcbi-0020049-ex034"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex034" xlink:type="simple"/></inline-formula>
						 alignments. 4,784 genes in CISRED had non-void alignments for both the <italic>coreg</italic>(<italic>x</italic>) and the <inline-formula id="pcbi-0020049-ex035"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex035" xlink:type="simple"/></inline-formula>
						 sets. The average score of the <italic>coreg</italic>(<italic>x</italic>) alignments was 6.02, and the average length was 2.13 sites. For the <inline-formula id="pcbi-0020049-ex036"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex036" xlink:type="simple"/></inline-formula>
						 alignments, the values were 5.57 and 2.06, respectively. For 97 genes, the score of the <italic>coreg</italic>(<italic>x</italic>) alignments was significantly higher than that of the <inline-formula id="pcbi-0020049-ex037"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex037" xlink:type="simple"/></inline-formula>
						 alignments at a significance level of <italic>p</italic> = 0.01. At a <italic>p</italic>-value of 0.001, the number was 23. Because CISRED is partially based on microarray experiments, one could argue that cross-hybridization with recently duplicated genes may artefactually bias these results. However, no duplicated copies of genes exist in the sets of co-regulated genes with the 97 positive cases above (see <xref ref-type="supplementary-material" rid="pcbi-0020049-sd001">Dataset S1</xref>).
					</p><p>We performed the same experiment, using BLASTN [<xref ref-type="bibr" rid="pcbi-0020049-b018">18</xref>] instead to compare the promoter region of each gene <italic>x</italic> in the CISRED set with the promoters of the genes in <italic>coreg</italic>(<italic>x</italic>) and <inline-formula id="pcbi-0020049-ex038"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex038" xlink:type="simple"/></inline-formula>
						. BLASTN was used with the parameters word size 7 and expectation value 10 so that short stretches of conservation could also be retrieved. In each comparison, we identified the score of the best HSP. We obtained 981 <italic>coreg</italic>(<italic>x</italic>) alignments and 445,371 non-void <inline-formula id="pcbi-0020049-ex039"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex039" xlink:type="simple"/></inline-formula>
						 alignments. 653 genes in CISRED had BLASTN alignments in both the <italic>coreg</italic>(<italic>x</italic>) and the <inline-formula id="pcbi-0020049-ex040"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex040" xlink:type="simple"/></inline-formula>
						 sets. The average score of the <italic>coreg</italic>(<italic>x</italic>) alignments was 29.9, and the average length was 51 nucleotides. For the <inline-formula id="pcbi-0020049-ex041"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex041" xlink:type="simple"/></inline-formula>
						 alignments, the values were 24.3 and 40.5, respectively. For 11 genes, the score of the <italic>coreg</italic>(<italic>x</italic>) alignments was significantly higher than that of the <inline-formula id="pcbi-0020049-ex042"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex042" xlink:type="simple"/></inline-formula>
						 alignments at a significance level of <italic>p</italic> = 0.01; there was only one gene for which the score of the <italic>coreg</italic>(<italic>x</italic>) alignments was significantly higher than that of the <inline-formula id="pcbi-0020049-ex043"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex043" xlink:type="simple"/></inline-formula>
						 alignments, at a significance level of <italic>p</italic> = 0.001.
					</p><p>We have investigated whether differences in conservation of regulatory elements could be found between promoters associated to CpG islands (CpG+) and promoters not associated to them (CpG−). CpG− promoters have been linked to tissue-specific expression patterns [<xref ref-type="bibr" rid="pcbi-0020049-b019">19</xref>,<xref ref-type="bibr" rid="pcbi-0020049-b020">20</xref>], and therefore they could be overrepresented in the set of co-expressed genes for which we have been able to identify conserved regulatory motifs. We computed for each gene the GC content and the CpG score as defined by [<xref ref-type="bibr" rid="pcbi-0020049-b019">19</xref>]. The presence of a CpG island on a window (−100:+100) centered around the TSS of a gene is accepted when its GC content is greater than 0.5 and when its CpG score is greater than 0.6 (CpG+); otherwise it is classified as a CpG negative gene (CpG−). Genes lacking CpG islands around their TSS have been shown to have a more tissue-specific expression pattern [<xref ref-type="bibr" rid="pcbi-0020049-b019">19</xref>]. Based on these considerations, 3,844 out of the 5,333 promoters (72%) were identified as CpG+ genes, while only 1,489 (28%) were classified as CpG−. Among the 97 genes for which the score of the <italic>coreg</italic>(<italic>x</italic>) TF-map alignments was significantly higher than that of the <inline-formula id="pcbi-0020049-ex044"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex044" xlink:type="simple"/></inline-formula>
						 alignments at a significance level of <italic>p</italic> = 0.01, 63 were CpG+ (65%). At a <italic>p</italic>-value of 0.001, the number of CpG+ genes was 13, out of a total of 23 (56%). It, thus, indeed appears that genes with CpG− promoters are slightly overrepresented in the set of co-regulated genes with conserved (specific) regulatory signals.
					</p><p>As it is possible to see, despite the general poor ability of both the sequence alignments and the TF-maps to uncover relationships between the promoters of the co-regulated genes in CISRED, it is clear that TF-map alignments are able to detect more relationships than BLASTN alignments (97 versus 11 at a <italic>p</italic>-value &lt; 0.01, 23 versus one at a <italic>p</italic>-value &lt; 0.001). It can be argued that this is partially an artefact, resulting from BLASTN reporting only sequence alignments over a given threshold, while non-void TF-map alignments are always produced, provided that the maps to align share at least one common element. In fact, given the number of genes for which valid alignments are obtained, at a <italic>p</italic>-value &lt; 0.01 there are twice as many cases in which <italic>coreg</italic>(<italic>x</italic>) scores are significantly higher than <inline-formula id="pcbi-0020049-ex045"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex045" xlink:type="simple"/></inline-formula>
						 as expected if there was actually no difference in the distributions of scores, both using TF-map and sequence alignments. At a <italic>p</italic>-value &lt; 0.001, however, the number of cases in which <italic>coreg</italic>(<italic>x</italic>) scores are significantly higher than <inline-formula id="pcbi-0020049-ex046"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex046" xlink:type="simple"/></inline-formula>
						 coincides with the expected value using BLASTN, but it is five times the expected value using TF-maps. We believe that this indicates that, even after taking into account the effect of the different number of total alignments reported, the TF-map alignment algorithm is superior to BLASTN in detecting relationships between the promoter regions of co-regulated genes. Indeed, among the 445,371 total BLASTN alignments obtained, there are 981 alignments between co-regulated genes, while the 445,371 top scoring TF-map alignments obtained include 1,240 alignments between co-regulated genes. Interestingly, there are only 148 alignments in common between both approaches, indicating that they could be used to complement each other.
					</p><p>It could be argued that the superiority of the TF-map over sequence alignments has little to do with the alignments and more to do with the maps. In other words, we would have obtained similar results if we were to simply score the proportion of TF labels common to the compared promoter regions—without the need for an alignment. Therefore, we have computed such a score for each pair of genes in CISRED: if <italic>p</italic> and <italic>q</italic> are the sets of elements in the TF-maps of the promoters to be compared, we have computed | <italic>p</italic> ∩ <italic>q</italic> |<sup>2</sup> / | <italic>p</italic> | · | <italic>q</italic> |, where <italic>|p|</italic> is the size (cardinality) of the set <italic>p</italic>. Among the 445,371 top-scoring comparisons, 1,072 corresponded to co-regulated genes (with only 394 gene comparisons in common with the TF-map alignment approach), a value intermediate between that obtained with sequence and with TF-map alignments. This reflects that conservation of the relative position of the TFs along the primary sequence, and not only common presence, is indicative of gene co-regulation. Conservation of relative position can only be captured by TF-map alignments.</p><p>As an example, <xref ref-type="table" rid="pcbi-0020049-t002">Table 2</xref> summarizes the TF-map alignments obtained when aligning the promoter region of the <italic>transthyretin</italic> gene (TTR), with each one of its co-regulated genes in CISRED. TTR is a serum carrier protein expressed in liver and brain. The regulatory regions that control the TTR expression in liver have been experimentally determined [<xref ref-type="bibr" rid="pcbi-0020049-b021">21</xref>] and consist of a 100-nucleotide enhancer located at −2,000 nucleotides upstream of the TSS and a proximal promoter region between −200 and −90 nucleotides upstream of the TSS (relative to the coordinates in the ENSEMBL entry). This proximal region comprises six binding sites (coordinates relative to TSS of the <italic>transthyretin</italic> gene as in the ENSEMBL database): HNF-1 (−137,−109), HNF-3 (−140,−128 and −106,−91), HNF-4 (−151,−140), C/EBP binding (−195,−177 and −135,−112). The TATA box is located at −30. CISRED lists 105 genes co-regulated with TTR. Interestingly, while BLASTN is unable to detect any sequence similarity between the promoter of TTR and that of its co-regulated genes, TF-map alignments are obtained in 83 cases, and scored significantly (<italic>p</italic>-value &lt; 0.001). We have reconstructed the structure of the TTR promoter from the elements that appear in the TF-map alignments. A total of 35 TFBSs were initially mapped with JASPAR<italic><sub>TOP</sub></italic><sub>50</sub> in the TTR promoter. For each predicted TF, <xref ref-type="table" rid="pcbi-0020049-t002">Table 2</xref> lists the number of TF-map alignments between TTR, and its co-regulated genes in which the TF appears. Only elements appearing in at least five alignments are reported. No matrices for the detection of C/EBP and HNF-4 were included in the JASPAR<italic><sub>TOP</sub></italic><sub>50</sub> collection that was used to perform the test. However, the meta-alignments were overrepresented in the other experimentally annotated sites, HNF-1, HNF-3, and TATA, exactly in the region where promoter activity has been reported. The binding of HNF-3 to the site −140,−128 is not directly reported. The TF-map alignments, however, are highly enriched in the HFH-3 factor (HNF3/fork head homolog, [<xref ref-type="bibr" rid="pcbi-0020049-b022">22</xref>]) at this region. In fact, both share a similar consensus-binding sequence in TRANSFAC [<xref ref-type="bibr" rid="pcbi-0020049-b010">10</xref>]: TRTTTRTTT for HFH-3 and TRTTTRYTT for HNF-3.</p><table-wrap content-type="1col" id="pcbi-0020049-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020049.t002</object-id><label>Table 2</label><caption><p>Summary of the TF-Map Alignments Obtained between the Promoter of the <italic>transthyretin</italic> Gene and the Promoters of the Genes Co-Regulated with It according to the CISRED Database</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.t002" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb2col1" align="char" charoff="0" char="."/><col id="tb2col2" align="char" charoff="0" char="."/><col id="tb2col3" align="left" charoff="0" char=""/><col id="tb2col4" align="char" charoff="0" char="."/></colgroup><thead><tr><td align="left"><hr/>Begin</td><td><hr/>End</td><td><hr/>TF</td><td><hr/>Frequency</td></tr></thead><tbody><tr><td>&minus;492</td><td>&minus;477</td><td>HMG-IY</td><td>11</td></tr><tr><td>&minus;486</td><td>&minus;475</td><td>HNF-3beta</td><td>10</td></tr><tr><td>&minus;406</td><td>&minus;393</td><td>Broad-complex_1</td><td>9</td></tr><tr><td>&minus;380</td><td>&minus;367</td><td>Broad-complex_1</td><td>21</td></tr><tr><td>&minus;364</td><td>&minus;350</td><td>TBP</td><td>5</td></tr><tr><td>&minus;362</td><td>&minus;349</td><td>SQUA</td><td>9</td></tr><tr><td>&minus;362</td><td>&minus;347</td><td>HMG-IY</td><td>10</td></tr><tr><td>&minus;312</td><td>&minus;301</td><td>TEF-1</td><td>12</td></tr><tr><td>&minus;307</td><td>&minus;296</td><td>HFH-2</td><td>9</td></tr><tr><td>&minus;273</td><td>&minus;262</td><td>HNF-3beta</td><td>21</td></tr><tr><td>&minus;271</td><td>&minus;256</td><td>HMG-IY</td><td>6</td></tr><tr><td>&minus;253</td><td>&minus;238</td><td>HMG-IY</td><td>6</td></tr><tr><td>&minus;251</td><td>&minus;238</td><td>Broad-complex_1</td><td>9</td></tr><tr><td>&minus;236</td><td>&minus;225</td><td>HFH-3</td><td>9</td></tr><tr><td>&minus;203</td><td>&minus;194</td><td>RORalfa-1</td><td>18</td></tr><tr><td>&minus;141</td><td>&minus;130</td><td>HFH-3</td><td>17</td></tr><tr><td>&minus;128</td><td>&minus;115</td><td><bold>HNF-1</bold></td><td>6</td></tr><tr><td>&minus;102</td><td>&minus;91</td><td><bold>HNF-3beta</bold></td><td>22</td></tr><tr><td>&minus;30</td><td>&minus;16</td><td><bold>TBP</bold></td><td>21</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt201"><p>Predicted TFs on the promoter of <italic>transthyretin,</italic> which appear at least in five TF-map alignments with co-regulated genes.</p></fn><fn id="nt202"><p>Bold text indicates the experimentally verified sites.</p></fn></table-wrap-foot> --></table-wrap></sec></sec></sec><sec id="s3"><title>Discussion</title><p>Much of the biology of the past decades has been based on the technological advances that have accelerated our ability to sequence DNA and proteins. It is certainly in the sequence of the genome that the biological traits of organisms are encoded. While we have a relatively good understanding of some of the basic mechanisms involved in the processing of the information encoded in the DNA sequence, it is in general very difficult to predict the biological traits—even at the molecular level—from the nucleotide sequence alone. Gene promoters are a case in point: while the sequence of the promoter is likely to contain most of the information to control the expression of a gene, it is currently impossible to predict the expression pattern of a gene from the analysis of its promoter sequence alone.</p><p>While inferring function directly from sequence is thus far from trivial, it is still true that because sequence encodes function, similar sequences often encode similar functions. Sequence comparisons, therefore, are an extraordinary tool to infer functional relationships: through sequence comparisons the function of known sequences can be extrapolated to newly obtained ones, and the specific sequence motifs responsible for the common functionality of a set of sequences can be identified. But sequence comparisons have limitations: often similar functions are encoded by diverse sequences. Again, gene promoters are a case in point: many TFs bind to sequence motifs which do not show sequence conservation. Thus, while through phylogenetic footprinting, conserved regulatory motifs have been on occasion uncovered in the promoters of orthologous genes [<xref ref-type="bibr" rid="pcbi-0020049-b023">23</xref>,<xref ref-type="bibr" rid="pcbi-0020049-b024">24</xref>], searching for common patterns through the comparison of promoter sequences in sets of co-regulated genes—as, for instance, those resulting from microarray experiments—is usually a frustrating exercise.</p><p>Here, we have attempted to address this limitation implicit in sequence comparisons, by annotating the primary sequence with predicted functional domains, and comparing the resulting annotations instead of the underlying primary sequence. If functional domains are encoded by diverse sequences, the comparison and alignment of the annotation may be more revealing of the functional relationships between sequences and of the specific domains involved in the common functionality than the comparison and alignment of the primary sequence. In particular, we have attempted this strategy for the comparison and characterization of promoter regions from genes with similar expression patterns. We have annotated the sequence with predictions of TFBSs—using a variety of popular tools and databases—and identified the predicted sites with the labels of the corresponding TFs. We have then compared and aligned the resulting sequence of labels. Because TFs can bind to sites that show no sequence conservation, their labels can be aligned which correspond to domains that, while exhibiting similar functions, may not show sequence conservation.</p><p>Precedents of this approach can be found in the literature. Quandt et al. [<xref ref-type="bibr" rid="pcbi-0020049-b025">25</xref>], for instance, distinguish explicitly between first-level analysis of promoters, in which the nucleotide sequence is directly interrogated for the presence of regulatory motifs, and second-level methods, in which basic higher order patterns can be defined from a number of correlated first-level units. This approach is further developed in [<xref ref-type="bibr" rid="pcbi-0020049-b026">26</xref>] and [<xref ref-type="bibr" rid="pcbi-0020049-b027">27</xref>], where more complex composite patterns are derived capturing the functional organization of individual regulatory elements, and are then used to identify and characterize related promoter regions in absence of sequence conservation. In a related approach, Solovyev and Shamuradov [<xref ref-type="bibr" rid="pcbi-0020049-b028">28</xref>], for instance, also use higher order information to characterize orthologous promoters. Specifically, they use linear discriminant analysis to combine a number of conservation features and nucleotides sequences of promoter regions in pairs of orthologous genes.</p><p>Here, we go one step further, and infer automatically the composite patterns by explicitly aligning the sequences of labels corresponding to TFs for which binding sites have been predicted in the compared promoters (the second-level annotation). To align these sequences of labels—to which we refer as TF-maps—we have stated the problem as a restriction enzyme map alignment, and adapted a dynamic programming algorithm developed by Waterman et al. [<xref ref-type="bibr" rid="pcbi-0020049-b007">7</xref>]. This algorithm, as well as ours, belong to a larger class of map alignments algorithms (see also [<xref ref-type="bibr" rid="pcbi-0020049-b012">12</xref>,<xref ref-type="bibr" rid="pcbi-0020049-b029">29</xref>–<xref ref-type="bibr" rid="pcbi-0020049-b031">31</xref>]). In typical alignments, the sequences are of labels denoting either nucleotides or amino acids. In map alignments, the sequences are of pairs (label,integer), where the label denotes a predicted domain or site (possibly exhibiting some behavior or functionality), and the integer the position on the primary sequence where the domain or the site has been predicted. In global pairwise sequence alignments, the goal is to obtain the alignment that maximizes the sum of the scores of the aligned positions—given the score of the individual alignments of all possible pairs of labels. In contrast, in map alignments, only positions with identical labels can be aligned and the goal is to obtain the largest common subsequence constrained to minimize the differences in distances on the primary sequence between consecutive aligned positions. Sequence and map alignments can be generalized to a broader class of alignments that includes both.</p><p>Map alignments have been mostly used to align restriction enzyme maps. In this case, the label denotes a restriction enzyme, and the integer the position on the primary sequence of the site recognized by the enzyme. Waterman et al. [<xref ref-type="bibr" rid="pcbi-0020049-b007">7</xref>] first established the concept of map alignment and provided an algorithm for computing the optimal alignment of two maps. Later Myers and Huang [<xref ref-type="bibr" rid="pcbi-0020049-b012">12</xref>] described an improved algorithm to efficiently find map alignments that relies on the extreme sparsity of the dynamic programming matrix in [<xref ref-type="bibr" rid="pcbi-0020049-b007">7</xref>]—the result of the match state being defined only between identical labels. Miller et al. [<xref ref-type="bibr" rid="pcbi-0020049-b029">29</xref>,<xref ref-type="bibr" rid="pcbi-0020049-b030">30</xref>] introduced new algorithms that permitted the efficient search of a long map for the best matches to a shorter probe map. Huang and Waterman [<xref ref-type="bibr" rid="pcbi-0020049-b031">31</xref>] generalized these algorithms to deal with different map errors.</p><p>In our case, the label denotes a TF, and the integer the initial position on the primary sequence where a binding motif for the TF has been predicted. There are, however, two important differences between restriction enzyme maps and TF-maps. First, while prediction of restriction sites is deterministic, producing a binary output (“site,” “no site”), prediction of TFBSs is often probabilistic and predicted sites may have an associated score. The score can usually be related to the strength of the binding of the TF to the site [<xref ref-type="bibr" rid="pcbi-0020049-b032">32</xref>]. Because it makes sense, therefore, to prefer in TF-map alignments higher scoring sites, the score of the TFBSs needs to be taken into account when building optimal TF-map alignments. Second, enzyme restriction sites are single-nucleotide positions on the primary sequence. TFBSs, in contrast, are sequence intervals, and thus have in addition to position an associated length. Because we explicitly prohibit overlap between aligned elements, we cannot directly extrapolate the algorithm of [<xref ref-type="bibr" rid="pcbi-0020049-b012">12</xref>]. However, as in their approach, we have also taken advantage of the extreme sparsity of the dynamic programming matrix to implement an efficient algorithm that, in our experience, is comparable in efficiency. There is another important feature characteristic of our approach that, while it does not influence the algorithmic strategy, it is essential to its success. As we have already stressed, we do not label the site, but rather the function of the site. That is, we do not label the TFBSs, but we label the TFs that bind to the sites. This allows for significant functional alignments even in the absence of sequence conservation.</p><p>We have estimated the optimal parameters of the algorithm in a small, but well-annotated, set of orthologous human–mouse genes (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). We used three popular collections of PWMs for TFBSs (JASPAR 1.0 [<xref ref-type="bibr" rid="pcbi-0020049-b009">9</xref>]), PROMO 2.0 [<xref ref-type="bibr" rid="pcbi-0020049-b033">33</xref>], and TRANSFAC 6.3 [<xref ref-type="bibr" rid="pcbi-0020049-b010">10</xref>]) to obtain the TF-maps of the promoter sequences. Results on this dataset indicate that, by dramatically reducing the overwhelming number of spurious predictions of TFBSs produced using these collections, TF-map alignments are able to successfully uncover the few conserved functionally active regulatory domains (see <xref ref-type="table" rid="pcbi-0020049-t003">Table 3</xref>). Differences can be observed between the performance of the different collections of TFBSs; alignments obtained using JASPAR—and, in particular, using a subset consisting of the 50 top most informative matrices—appear to show the optimal balance between sensitivity and specificity. The dataset that we have used, however, is too small to infer general trends on the comparative behavior of these collections.</p><table-wrap content-type="2col" id="pcbi-0020049-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020049.t003</object-id><label>Table 3</label><caption><p>Results of the Estimation of the Optimal Parameters of the TF-map Alignment Algorithm in the HR Set of Orthologous Human–Mouse Promoter Sequences</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.t003" xlink:type="simple"/><!-- <table frame="hsides" rules="none"><colgroup><col id="tb3col1" align="left" charoff="0" char=""/><col id="tb3col2" align="left" charoff="0" char=""/><col id="tb3col3" align="left" charoff="0" char=""/><col id="tb3col4" align="left" charoff="0" char=""/><col id="tb3col5" align="left" charoff="0" char=""/><col id="tb3col6" align="left" charoff="0" char=""/><col id="tb3col7" align="left" charoff="0" char=""/><col id="tb3col8" align="left" charoff="0" char=""/><col id="tb3col9" align="left" charoff="0" char=""/></colgroup><thead><tr><td align="left"><hr/>Analysis Tool</td><td><hr/>Accuracy Level</td><td><hr/>Values</td><td><hr/>JASPAR</td><td><hr/>PROMO</td><td><hr/>TRANSFAC</td><td><hr/>JASPAR<italic><sub>TOP</sub></italic><sub>50</sub></td><td><hr/>BLASTN</td><td><hr/>BLASTN<italic><sub>WSIZE&equals;7</sub></italic></td></tr></thead><tbody><tr><td rowspan="1">PWMs</td><td rowspan="1"></td><td>Number of matrices</td><td>111</td><td>316</td><td>442</td><td>50</td><td></td><td></td></tr><tr><td></td><td></td><td>Number of TFs</td><td>101</td><td>181</td><td>296</td><td>47</td><td></td><td></td></tr><tr><td rowspan="1">TF-maps</td><td rowspan="1"></td><td>Number of gene pairs</td><td>29</td><td>29</td><td>29</td><td>17</td><td></td><td></td></tr><tr><td></td><td></td><td>Number of real TFBSs</td><td>93 (&times; 2)</td><td>94 (&times; 2)</td><td>94 (&times; 2)</td><td>50 (&times; 2)</td><td></td><td></td></tr><tr><td></td><td></td><td>Number of real TFBSs per gene pair</td><td>3.2 (&times; 2)</td><td>3.2 (&times; 2)</td><td>3.2 (&times; 2)</td><td>2.9 (&times; 2)</td><td></td><td></td></tr><tr><td></td><td></td><td>Number of predicted TFBSs</td><td>2683 &times; 2605</td><td>8322 &times; 8027</td><td>6644 &times; 6628</td><td>207 &times; 216</td><td></td><td></td></tr><tr><td></td><td></td><td>Number of predicted TFBSs per gene pair</td><td>93 &times; 90</td><td>287 &times; 277</td><td>229 &times; 229</td><td>12 &times; 13</td><td></td><td></td></tr><tr><td></td><td>Nucleotide</td><td>Sensitivity, specificity</td><td>0.97, 0.16</td><td>0.99, 0.14</td><td>0.99, 0.14</td><td>0.67, 0.25</td><td></td><td></td></tr><tr><td></td><td></td><td>Correlation coefficient</td><td>0.10</td><td>0.04</td><td>0.03</td><td>0.24</td><td></td><td></td></tr><tr><td></td><td></td><td>Coverage</td><td>88&percnt;</td><td>97&percnt;</td><td>98&percnt;</td><td>33&percnt;</td><td></td><td></td></tr><tr><td></td><td rowspan="1">Site</td><td>Sensitivity, specificity</td><td>1.00, 0.02</td><td>1.00, 0.00</td><td>1.00, 0.00</td><td>0.76, 0.12</td><td></td><td></td></tr><tr><td></td><td></td><td>Average</td><td>0.51</td><td>0.50</td><td>0.50</td><td>0.44</td><td></td><td></td></tr><tr><td rowspan="1">TF-map alignments</td><td rowspan="1"></td><td><italic>&alpha;</italic>, <italic>&lambda;</italic>, <italic>&mu;</italic></td><td>0.5, 0.1, 0.1</td><td>0.25, 0.1, 0.2</td><td>0.25, 0.1, 0.1</td><td>0.5, 0.1, 0.1</td><td></td><td></td></tr><tr><td></td><td></td><td>Length</td><td>12.7 (&times;2)</td><td>23.5 (&times;2)</td><td>15.2 (&times;2)</td><td>3.4 (&times;2)</td><td></td><td></td></tr><tr><td></td><td rowspan="1">Nucleotide</td><td>Sensitivity, specificity</td><td>0.76, 0.23</td><td>0.72, 0.19</td><td>0.85, 0.21</td><td>0.70, 0.40</td><td></td><td></td></tr><tr><td></td><td></td><td>Correlation coefficient</td><td>0.19</td><td>0.10</td><td>0.18</td><td>0.42</td><td></td><td></td></tr><tr><td></td><td></td><td>Coverage</td><td>51&percnt;</td><td>62&percnt;</td><td>65&percnt;</td><td>23&percnt;</td><td></td><td></td></tr><tr><td></td><td rowspan="1">Site</td><td>Sensitivity, specificity</td><td>1.00, 0.25</td><td>0.94, 0.13</td><td>0.98, 0.21</td><td>0.86, 0.73</td><td></td><td></td></tr><tr><td></td><td></td><td>Average</td><td>0.63</td><td>0.53</td><td>0.59</td><td>0.79</td><td></td><td></td></tr><tr><td></td><td rowspan="1">Site &plus; label</td><td>Sensitivity, specificity</td><td>0.57, 0.07</td><td>0.30, 0.03</td><td>0.29, 0.04</td><td>0.64, 0.28</td><td></td><td></td></tr><tr><td></td><td></td><td>Average</td><td>0.32</td><td>0.16</td><td>0.16</td><td>0.46</td><td></td><td></td></tr><tr><td rowspan="1">Sequence Alignments</td><td rowspan="1"></td><td>Sensitivity, specificity</td><td></td><td></td><td></td><td></td><td>0.70, 0.19</td><td>0.85, 0.18</td></tr><tr><td></td><td></td><td>Correlation coefficient</td><td></td><td></td><td></td><td></td><td>0.16</td><td>0.15</td></tr><tr><td></td><td></td><td>Coverage</td><td></td><td></td><td></td><td></td><td>54&percnt;</td><td>63&percnt;</td></tr></tbody></table> --><!-- <table-wrap-foot><fn id="nt301"><p>Parameters were estimated independently using three different collections of PWMs for TFBSs to obtain the TF-maps of the promoter sequences. The table has three parts: (Top), (Middle), (Bottom).</p></fn><fn id="nt302"><p>(Top) Number of matrices in each of these collections, and the number of TFs these matrices correspond to.</p></fn><fn id="nt303"><p>(Middle) Statistics of the resulting TF-maps: number of promoter pairs (out of 36) for which matches to at least one common TFBS was found in both the human and mouse orthologs (and for which, therefore, there exist a non-void TF-map alignment), total and average number of real TFBSs per promoter sequence, total and average number of predicted TFBSs per promoter sequence, and sensitivity and specificity at the nucleotide and site levels (see main text for definitions). The average sensitivity and specificity at the site level is the optimization measure when estimating the parameters of the algorithm. Coverage is the fraction of the sequence of the promoters covered by matches to TFBSs.</p></fn><fn id="nt304"><p>(Bottom) Results of the optimal TF-alignments: optimal parameters and average length (number of aligned elements in the optimal TF-map alignments), measures of sensitivity and specificity at the levels of nucleotide, site overlap, and site plus label match (see main text for definitions). Coverage is the fraction of the sequence of the promoters covered by matches to TFBSs. Results when using BLASTN to detect conservation between orthologous pairs are also shown for comparison.</p></fn></table-wrap-foot> --></table-wrap><p>Interestingly, despite the stronger sequence conservation between protein-coding regions, TF-map alignments score the highest between promoter regions in the training set of orthologous human–mouse genes (see <xref ref-type="table" rid="pcbi-0020049-t001">Table 1</xref>). This indicates that TF-map alignments are able to pick up regulatory signals that sequence alignments cannot. Results in an independent larger dataset of co-regulated genes from the CISRED database are also in support of this conclusion: we have been able to obtain more significant alignments between the TF-maps than between the nucleotide sequences of the promoters of co-regulated genes. Results in CISRED are certainly not extraordinary. Both sequence and TF-map alignments perform very poorly when detecting relationships between co-regulated genes in CISRED. Only in 97 out of 5,333 gene representatives in CISRED (1.8%) did TF-map alignments score significantly higher for co-regulated than for non co-regulated genes. Using BLASTN, this number was only 11 (0.2%). Finding relationships between the promoters of the genes co-regulated in CISRED is a challenging task, as one can imagine. The CISRED collection of high-confidence co-expressed genes is not derived from overall conservation, or from co-occurrence of motifs, in the sequence of the gene promoters. CISRED co-expression is derived instead from cDNA microarray, SAGE, and other high-throughput gene expression monitoring techniques. CISRED co-expression clusters are thus a mixture of directly and indirectly co-regulated genes, and one would then expect only a few genes within each cluster—maybe in a few subsets—to share functionally equivalent motifs in their promoter sequences. The poor performance of TF-map alignments, however, could also be reflecting the incompleteness of the current collections of TFBSs, and how little we know of the molecular rules governing the expression of human genes.</p><p>On the other hand, while building global pairwise alignments may be appropriate to compare promoter sequences of orthologous human–mouse genes, to compare sequences from multiple genes weakly co-regulated—such as those in CISRED—multiple and/or local alignments may be more effective in capturing the functional motifs underlying co-expression. Indeed, from a multiple TF-map alignment of promoters of a set of co-regulated genes, a “transcriptional regulatory superpattern” could be derived capturing those elements conferring expression specificity. Using a local alignment search algorithm, the superpattern could then be used to identify additional genes or transcripts belonging to the same expression class.</p><p>Even more appropriate to the analysis of sets of weakly co-expressed genes (that is, including genes both directly and indirectly co-regulated), such as those in the CISRED clusters, would be the extension of the unsupervised pattern recognition techniques usually applied to motif discovery in DNA sequences (in programs such as MEME [<xref ref-type="bibr" rid="pcbi-0020049-b034">34</xref>], AlignAce [<xref ref-type="bibr" rid="pcbi-0020049-b035">35</xref>], and others, see [<xref ref-type="bibr" rid="pcbi-0020049-b006">6</xref>] for a recent comparative evaluation) to motif discovery in TF-maps. This would allow for the identification within a co-expression cluster of different “transcriptional regulatory superpatterns.” These superpatterns, in turn, and the subclusters they induce, could contribute to sort out direct versus indirect co-regulation effects within the cluster. These and other extensions to the TF-map alignments (for instance, those that allow non-colinear arrangements of TFBSs, which have been indeed observed in orthologous genes [<xref ref-type="bibr" rid="pcbi-0020049-b036">36</xref>]) are all feasible, and will certainly contribute to the discriminatory power of TF-map comparisons and alignments.</p><p>In summary, our results suggest that comparisons of annotations of higher order domains can, on occasion, be more meaningful to characterize the underlying functionality of sequences than direct comparisons at the very primary sequence level. Here we have explored these strategies for the characterization of the promoter regions of co-regulated genes, and we have annotated the primary sequence of them with predictions of TFs. However, we can imagine similar strategies to address many other problems in sequence analysis. One can imagine, for instance, annotating protein sequences with PFAM domains [<xref ref-type="bibr" rid="pcbi-0020049-b037">37</xref>], and comparing the resulting annotations to detect distant functional relationships between proteins and protein families. Or annotating genome sequences with the Gene Ontology (GO, [<xref ref-type="bibr" rid="pcbi-0020049-b016">16</xref>]) labels of the genes encoded in these sequences, and aligning the GO labels to detect clusters of conserved functions across genomes. In fact, the annotation of the primary sequence with higher order domains to improve alignments has often been explored. For instance, to compare protein secondary structures, see [<xref ref-type="bibr" rid="pcbi-0020049-b038">38</xref>], as an example, or to anchor whole genome alignments, see [<xref ref-type="bibr" rid="pcbi-0020049-b039">39</xref>,<xref ref-type="bibr" rid="pcbi-0020049-b040">40</xref>], or even alignments of promoter regions, see [<xref ref-type="bibr" rid="pcbi-0020049-b041">41</xref>]. In all these cases, however, the ultimate goal is to obtain an optimal sequence alignment either between the original primary sequences, or between the 1–1 mappings of the primary sequence into a reduced alphabet (for instance, denoting secondary structure elements). We believe that, as the molecular functionality of the primary sequence becomes better understood, comparisons between higher order annotations, such as those performed here, in which the primary sequence is completely abstracted, may become increasingly relevant.</p></sec><sec id="s4"><title>Materials and Methods</title><sec id="s4a"><title>Datasets and software availability.</title><p>All of the datasets, the promoter sequences, the computational predictions, the TF-map alignments, and the results are freely distributed as flat files at <ext-link ext-link-type="uri" xlink:href="http://genome.imim.es/datasets/meta2005/index.html" xlink:type="simple">http://genome.imim.es/datasets/meta2005/index.html</ext-link>. An implementation of the enhanced algorithm has been written in C and is publicly available at <ext-link ext-link-type="uri" xlink:href="http://genome.imim.es/software/meta/index.html" xlink:type="simple">http://genome.imim.es/software/meta/index.html</ext-link>. A web server that performs the mapping and the meta-alignment of two promoter regions with such an algorithm is accessible at <ext-link ext-link-type="uri" xlink:href="http://genome.imim.es/software/meta/meta.html" xlink:type="simple">http://genome.imim.es/software/meta/meta.html</ext-link>. The input of the program consists of the two TF-maps to be aligned, each one in a separate file. The files must be in General Feature Format (GFF, <ext-link ext-link-type="uri" xlink:href="http://www.sanger.ac.uk/Software/formats/GFF/GFF_Spec.shtml" xlink:type="simple">http://www.sanger.ac.uk/Software/formats/GFF/GFF_Spec.shtml</ext-link>). Options allow to control the values of <italic>α, λ,</italic> and <italic>μ,</italic> as well as to display the results in plain format or GFF format. The output includes the score and the length of the optimal alignment, and the matches in the two input maps.</p></sec><sec id="s4b"><title>Parameter estimation.</title><p>The optimal alignment between two TF-maps is obviously dependant on the <italic>α, λ,</italic> and <italic>μ</italic> parameters. In principle, we want the optimal alignment between the maps derived from promoter sequences of two co-expressed genes to include most of the mapped TFBSs known to be involved in the regulation of the genes (high sensitivity), and few of the mapped TFBSs not known to be involved in such regulation (high specificity). The implicit assumption here is that the TFBSs in the alignment are considered predictions of TFBSs on the underlying promoter sequences. It is also important to stress that two different TFBSs can be aligned if they correspond to the same TF.</p><p>The optimal parameter configuration, however, is likely to depend on the particular problem to be addressed: the genes to be compared (orthologous genes from different species or genes co-regulated after an expression microarray experiment, for instance), and the particular protocol to map the TFBSs into the original promoter sequences. Often the optimal configuration of parameters will be specific to the pair of gene promoters to be compared.</p><p>With these caveats in mind, because our focus here is on mammalian comparisons, we have estimated the parameters that are globally optimal when aligning a set of well-annotated human–mouse orthologous promoter pairs. The underlying assumption is that these orthologous pairs are regulated in a similar way. We have estimated the optimal parameters separately in three different collections of PWMs for locating TFBSs, and in each case we have chosen the parameters such that the resulting global alignment achieved the maximum average sensitivity and specificity as defined below.</p></sec><sec id="s4c"><title>Datasets.</title><p>From several landmark papers in the field [<xref ref-type="bibr" rid="pcbi-0020049-b023">23</xref>,<xref ref-type="bibr" rid="pcbi-0020049-b024">24</xref>,<xref ref-type="bibr" rid="pcbi-0020049-b042">42</xref>–<xref ref-type="bibr" rid="pcbi-0020049-b044">44</xref>], we have gathered and manually curated a collection of 278 TFBSs (139 + 139 orthologous sites) that had been experimentally tested in 40 orthologous human and rodent genes. The TSS of each entry in the literature was compared to the RefSeq [<xref ref-type="bibr" rid="pcbi-0020049-b045">45</xref>] annotation of the corresponding genome to ensure that we were dealing with the actual proximal promoter. Because most (214 out of 278) of the annotated TFBSs are located in the 200 nucleotides immediately upstream of the TSS, we restricted to this region in our training and evaluation analysis, and considered only those cases for which the same pair of TFBSs had been annotated in this region for both species. This resulted in a collection of 202 sites (101 + 101) from 36 genes, to which we refer here as the HR set. We have estimated the optimal parameters in the HR set for the JASPAR 1.0 [<xref ref-type="bibr" rid="pcbi-0020049-b009">9</xref>], PROMO 2.0 [<xref ref-type="bibr" rid="pcbi-0020049-b033">33</xref>], and TRANSFAC 6.3 [<xref ref-type="bibr" rid="pcbi-0020049-b010">10</xref>] collections. In the three cases, the original frequency coefficients of the matrices have been converted into log-likelihood ratios using the random equiprobability distribution as a background model. The resulting matrices were used to obtain the list of TFBSs matches along the 200 bases upstream of the TSS in each of the 36 pairs of promoter sequences from the HR set. A prediction obtained with a given PWM was accepted if it had a score above 50% (JASPAR), 70% (PROMO), and 55% (TRANSFAC) of the maximum possible score for such PWM. These values correspond in the three cases to the conventional 80% threshold when considering the original frequency matrices.</p><p>Those annotated TFBSs not included in the predictions for both orthologous pairs (either because no matrix exists in the collection for such TFBSs or because the match is below the threshold) were discarded. This reduced the effective number of training gene pairs (those with at least one real predicted TFBS for both orthologous pairs) from 36 to 29 for the three collections considered here.</p><p><xref ref-type="table" rid="pcbi-0020049-t003">Table 3</xref> shows for each collection the total number of matrices, TFs to which they correspond, the number of genes for which at least one annotated TFBS is predicted on each ortholog after the search, and the number of real and predicted TFBSs (the total and the average per gene pair). As it is possible to see, slightly more than three conserved TFBSs were annotated per orthologous gene pair.</p></sec><sec id="s4d"><title>Accuracy measures.</title><p>After the maps were obtained, we aligned them within each orthologous pair using the algorithm described in the previous section with different combinations of parameters. Each parameter was allowed to independently take values between 0.0 and 1.0, in incremental steps of 0.01. In total, thus, one million parameter configurations were evaluated for each collection of PWMs. For each configuration, the resulting optimal alignments on the pairs of orthologous promoters (that is, the predicted TFBSs) were compared with the annotated TFBSs in the promoters.</p><p>Two values were computed to measure the agreement between predicted and annotated TFBSs: sensitivity and specificity. Sensitivity is the number of correctly predicted TFBSs over the number of annotated TFBSs, and specificity is the number of correctly predicted TFBSs over the number of predicted TFBSs. We used here the term specificity as in the gene finding literature. However, the value that we compute here is more generally known as Positive Predictive Value. We considered an annotated TFBS to be correctly predicted when there was a predicted TFBS that overlapped it by at least one nucleotide in both human and mouse sequences, irrespective of whether the TF label associated to the aligned TFBS matched that of the annotated TFBS. This is because TFBSs for different TFs often cluster at the same position when using PWMs (see <xref ref-type="fig" rid="pcbi-0020049-g003">Figure 3</xref>). If a similar cluster occurs in the two sequences to be aligned, our algorithm will inevitably choose to align the pair of TFBSs with the highest sum of match scores (unless the parameter <italic>α</italic> is set to zero, in which case the pair to be aligned will be chosen arbitrarily).</p><fig id="pcbi-0020049-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.0020049.g003</object-id><label>Figure 3</label><caption><title>Results of the TF-Alignment of the Human and Mouse Promoters of the <italic>phospholipase A1 member A</italic> Gene</title><p>Here, the 2,000 nucleotides upstream of the annotated TSS have been considered (with position 1 corresponding to −2,000). The TF-maps on these sequences were obtained using TRANSFAC 6.3 [<xref ref-type="bibr" rid="pcbi-0020049-b010">10</xref>]. These maps contained 676 predicted binding sites in human and 595 in mouse (threshold 85%), and they are represented graphically on the top right. Each box represents a different binding site and the color corresponds to the associated TF. The resulting TF-map alignment is also represented graphically at the bottom right. The explicit alignment (the TFs and the coordinates in the human and mouse promoter of the underlying TFBSs) is given on the left. As it is possible to see, while the region proximal to the TSS is not more dense in predicted TFBSs than other regions, most of the aligned elements cluster near the TSS. Indeed, more than half of the elements in the TF-map alignments are within 500 nucleotides of the TSS. The program GFF2PS [<xref ref-type="bibr" rid="pcbi-0020049-b048">48</xref>] has been used to obtain the graphical representation of input predictions and final alignment.</p></caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.g003" xlink:type="simple"/></fig><p>As an optimization measure, we computed the average value of sensitivity and specificity. <xref ref-type="table" rid="pcbi-0020049-t003">Table 3</xref> lists the optimal combination of parameters with regard to this measure for each of the three collections of PMWs used here. <xref ref-type="table" rid="pcbi-0020049-t003">Table 3</xref> also lists sensitivity, specificity, their average, the average length of the optimal alignments (that is, the number of predicted TFBSs after the alignment), and the fraction of the promoter region covered by the predicted (aligned) TFBSs. In addition, for each optimal configuration we have also computed the same set of accuracy measures under the strict criterion of considering an annotated TFBS to be correctly predicted only when the TF label of the prediction matched that of the overlapped annotation. We also computed sensitivity and specificity at the nucleotide level. At this level, we compute the number of nucleotides in predicted TFBSs that are also in annotated TFBSs. This number over the total number of nucleotides in annotated TFBSs is the sensitivity, and over the total number of nucleotides in predicted TFBSs is the specificity. Finally, as a summary of these two numbers, we compute the correlation coefficient (see [<xref ref-type="bibr" rid="pcbi-0020049-b046">46</xref>] for a discussion on these measures). All the accuracy measures were also computed on the initial PWM predictions, prior to the alignments.</p></sec><sec id="s4e"><title>Accuracy results.</title><p>As it is possible to see, the main effect of the meta-alignment is the dramatic reduction in the number of predicted TFBSs that typically result after a PWM-based search (see also <xref ref-type="fig" rid="pcbi-0020049-g003">Figure 3</xref>). Taking, for instance, the popular TRANSFAC collection, the average number of TFBSs predicted per promoter in our dataset using this database is about 230. The TF-map alignment reduces this number approximately 15-fold, while the predicted TFBSs still cover essentially all annotated TFBSs. This gain in specificity is not simply due to the selection of an arbitrary set of non-overlapping TFBSs, since as a result of the map alignments the proportion of the promoter region covered by predicted TFBSs drops from 98% to 65%—a number that is more consistent with the estimated occupancy by TFs of the core promoter regions [<xref ref-type="bibr" rid="pcbi-0020049-b001">1</xref>].</p><p>In this regard, we have compared the map alignments here with direct sequence alignments in their ability to identify TFBSs in the promoter regions of co-regulated genes. We have used NCBI-BLASTN [<xref ref-type="bibr" rid="pcbi-0020049-b018">18</xref>] to identify conserved blocks in the promoter region of the orthologous pairs in the HR set. We have searched for local, instead of global alignments because we expect the TFBSs to distribute discretely along the promoter region—resulting in a patch of conserved and non-conserved fragments. In addition, local alignments are insensible to the relative rearrangements in the order of the TFBSs between the promoter sequences compared. This is an advantage over the map alignments, which require colinearity of the TFBSs in the sequences to be compared. Despite this, and the fact that promoter elements are usually embedded within well-conserved sequences in human and mouse orthologous promoters, map alignments are comparable or outperform the BLASTN comparison when identifying TFBSs in them. The correlation coefficient between the sequences covered by the BLASTN alignments and the annotated TFBSs is 0.15, while the same measure when considering the sequences covered by the map alignments is 0.19 for JASPAR, 0.10 for PROMO, and 0.18 for TRANSFAC. <xref ref-type="table" rid="pcbi-0020049-t003">Table 3</xref> lists these values, as well as the values of sensitivity and specificity. To obtain these values, BLASTN was run with default parameters, but decreasing the word size to 7 (the minimum accepted value in NCBI-BLASTN). This allows for the detection of shorter and weaker alignments. The performance of BLASTN degrades if we increase the word size. We obtained similar results using the WU-BLASTN version, which allows for shorter word sizes (unpublished data).</p><p>The values in <xref ref-type="table" rid="pcbi-0020049-t003">Table 3</xref> reflect differences among the three collections of matrices when used in the context of the map alignments. In this context, JASPAR appears to show the better balance between sensitivity and specificity. This can be partially explained because there is less matrix redundancy—which in turn implies less overprediction—in JASPAR than in the other collections. To further minimize overprediction, we have computed the information content of all JASPAR matrices and selected the most informative ones. Let <italic>P</italic> be a PWM where <italic>P</italic>(<italic>x,i</italic>) denotes the probability of observing the nucleotide <italic>x</italic> in the position <italic>i</italic> of a motif of length <italic>n</italic>. The amount of information <italic>R</italic> of the matrix <italic>P</italic> is defined as [<xref ref-type="bibr" rid="pcbi-0020049-b047">47</xref>]:
					<disp-formula id="pcbi-0020049-e006"><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.e006" xlink:type="simple"/><!-- <mml:math display='block'><mml:mrow><mml:mi>R</mml:mi><mml:mo stretchy='false'>(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='false'>)</mml:mo><mml:mo>&equals;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&equals;</mml:mo><mml:mn>1</mml:mn><mml:mo>&hellip;</mml:mo><mml:mi>n</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mo stretchy='true'>(</mml:mo><mml:mn>2</mml:mn><mml:mo>&plus;</mml:mo><mml:mstyle displaystyle='true'><mml:munder><mml:mo>&sum;</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>&isin;</mml:mo><mml:mi>A</mml:mi><mml:mo>,</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo><mml:mi>G</mml:mi><mml:mo>,</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy='true'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy='true'>)</mml:mo><mml:mi>log</mml:mi><mml:mo></mml:mo><mml:mi>P</mml:mi><mml:mo stretchy='true'>(</mml:mo><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo stretchy='true'>)</mml:mo></mml:mrow></mml:mstyle><mml:mo stretchy='true'>)</mml:mo><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:math> --></disp-formula>When using the collection of the 50 JASPAR matrices with the highest <italic>R</italic> value (which we refer to as JASPAR<italic><sub>TOP</sub></italic><sub>50</sub>) to obtain the TF-maps, detection of TFBSs through map alignments improves over the entire set of JASPAR matrices: while there is some loss of sensitivity, there is a larger gain in specificity (see <xref ref-type="table" rid="pcbi-0020049-t003">Table 3</xref>). We have used JASPAR<italic><sub>TOP</sub></italic><sub>50</sub> in the experiments presented in the Results section.
				</p><p>Finally, we have also performed a complementary test to measure the specificity of the TF-map alignments. As a negative control, we have shuffled the orthologous pairing in the HR set to construct a pool of unrelated human–mouse gene pairs. Then, the corresponding TF-map alignments between these non-orthologous paired promoters were obtained using the parameters previously optimized. For the three collections of matrices, the TF-map alignments between pairs of unrelated promoters were significantly shorter with an average score about 50% smaller than TF-map alignments between “bona fide” orthologous promoters. For instance, the average length of the TF-map alignments between orthologous promoters when using the JASPAR collection was 12.7 TFBSs, with an average score of 55.2. In contrast, the length of the TF-map alignments between non-related promoters was 8.36 TFBSs, with an average score of 20.67. The sites in the alignments involving non-orthologous gene promoters may hypothetically correspond to general regulatory elements present in most core promoters. An alternative, more probable, hypothesis is that they reflect the poor specificity of most PWMs representing TFBSs. Indeed, when we perform the same test using the more informative JASPAR<italic><sub>TOP</sub></italic><sub>50</sub> collection, no TF-map alignments can be obtained between any pair of the non-related promoters.</p></sec></sec><sec id="s5"><title>Supporting Information</title><supplementary-material id="pcbi-0020049-sd001" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.sd001" xlink:type="simple"><label>Dataset S1</label><caption><title>The 97 Gene Groups in CISRED with More Significant TF-Map Alignments</title><p>This file lists the 97 genes for which the score of the <italic>coreg</italic>(<italic>x</italic>) alignments was significantly higher than that of <inline-formula id="pcbi-0020049-ex047"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex047" xlink:type="simple"/></inline-formula>
						 alignments at a significance level of <italic>p</italic> = 0.01. Each line contains the following fields: (1) the ENSEMBL gene identifier; (2) the number of CISRED genes co-regulated with this gene; (3) the average score of the <italic>coreg</italic>(<italic>x</italic>) TF-map alignments; (4) the number of CISRED genes that are not co-regulated with this gene; (5) the average score of the <inline-formula id="pcbi-0020049-ex048"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex048" xlink:type="simple"/></inline-formula>
						 TF-map alignments; (6) the ratio between the average score of the <italic>coreg</italic>(<italic>x</italic>) alignments and the average score of the <inline-formula id="pcbi-0020049-ex049"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex049" xlink:type="simple"/></inline-formula>
						 alignments; (7) the significance level <italic>p</italic> according to the Wilcoxon test.
					</p><p>(6 KB TXT)</p></caption></supplementary-material><supplementary-material id="pcbi-0020049-sg001" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.sg001" xlink:type="simple"><label>Figure S1</label><caption><title>Number of Accessions to the Matrix <italic>S</italic> during the TF-Map Alignment Training</title><p>Red, the number of accessions to the matrix <italic>S</italic> by the naive algorithm for each one of the 40 promoter pairs in the HR set.</p><p>Orange, the number of accessions of the enhanced algorithm, without sorting the list <italic>L</italic>.</p><p>Green, the number of accessions of the enhanced algorithm, sorting the list <italic>L</italic>.</p><p>(8 KB EPS)</p></caption></supplementary-material><supplementary-material id="pcbi-0020049-sg002" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.sg002" xlink:type="simple"><label>Figure S2</label><caption><title>Distribution of the <italic>coreg</italic>(<italic>x</italic>) TF-Map Alignment Scores</title><p>The scores of the optimal <italic>coreg</italic>(<italic>x</italic>) TF-maps alignments follow, as optimal sequence alignments, a Gumbel or extreme-value distribution.</p><p>(12 KB EPS)</p></caption></supplementary-material><supplementary-material id="pcbi-0020049-sg003" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.0020049.sg003" xlink:type="simple"><label>Figure S3</label><caption><title>Distribution of the <named-content content-type="inline" xlink:type="simple"><inline-formula id="pcbi-0020049-ex050"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex050" xlink:type="simple"/></inline-formula></named-content>
						TF-Map Alignment Scores
					</title><p>The scores of the optimal <named-content content-type="inline" xlink:type="simple"><inline-formula id="pcbi-0020049-ex051"><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.0020049.ex051" xlink:type="simple"/></inline-formula></named-content>
						 TF-maps alignments follow, as optimal sequence alignments, a Gumbel or extreme-value distribution.
					</p><p>(12 KB EPS)</p></caption></supplementary-material><sec id="s5a"><title>Accession Numbers</title><p>GenBank (<ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/Genbank" xlink:type="simple">http://www.ncbi.nlm.nih.gov/Genbank</ext-link>) accession numbers are: for ACTA1 (human—AF182035), (mouse—M12347); for PLA1A (human—NM_015900) (RefSeq), (mouse— NM_134102) (RefSeq).</p><p>The Ensembl (<ext-link ext-link-type="uri" xlink:href="http://ensembl.org" xlink:type="simple">http://ensembl.org</ext-link>) accession number for TTR is (human—ENSG00000118271).</p></sec></sec></body><back><ack><p>The ideas developed in this paper were first explored more than fifteen years ago, when RG was a postdoc with TS. During these years, many people have contributed directly or indirectly to the maturing of these ideas. We would like to emphasize the long discussions with James W. Fickett on transcriptional regulation, and the very constructive criticisms and useful pointers by Webb Miller.</p></ack><glossary><title>Abbreviations</title><def-list><def-item><term>PWMs</term><def><p>position weight matrices</p></def></def-item><def-item><term>TF</term><def><p>transcription factors</p></def></def-item><def-item><term>TF-maps</term><def><p>transcription factor maps</p></def></def-item><def-item><term>TFBSs</term><def><p>TF binding sites</p></def></def-item><def-item><term>TSS</term><def><p>transcription start site</p></def></def-item></def-list></glossary><ref-list><title>References</title><ref id="pcbi-0020049-b001"><label>1</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wray</surname><given-names>GA</given-names></name><name name-style="western"><surname>Hahn</surname><given-names>MW</given-names></name><name name-style="western"><surname>Abouheif</surname><given-names>E</given-names></name><name name-style="western"><surname>Balhoff</surname><given-names>JP</given-names></name><name name-style="western"><surname>Pizer</surname><given-names>M</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>The evolution of transcriptional regulation in eukaryotes.</article-title>
					<source>Mol Biol Evol</source>
					<volume>20</volume>
					<fpage>1377</fpage>
					<lpage>1419</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b002"><label>2</label><element-citation publication-type="journal" xlink:type="simple">
					<collab xlink:type="simple">International Chicken Genome Sequencing Consortium</collab>
					<year>2004</year>
					<article-title>Sequence and comparative analysis of the chicken genome provide unique perspectives on vertebrate evolution.</article-title>
					<source>Nature</source>
					<volume>432</volume>
					<fpage>695</fpage>
					<lpage>716</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b003"><label>3</label><element-citation publication-type="journal" xlink:type="simple">
					<collab xlink:type="simple">International Mouse Genome Sequencing Consortium</collab>
					<year>2002</year>
					<article-title>Initial sequencing and comparative analysis of the mouse genome.</article-title>
					<source>Nature</source>
					<volume>420</volume>
					<fpage>520</fpage>
					<lpage>562</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b004"><label>4</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name><name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name></person-group>
					<year>2004</year>
					<article-title>Applied bioinformatics for the identification of regulatory elements.</article-title>
					<source>Nat Rev Genet</source>
					<volume>5</volume>
					<fpage>276</fpage>
					<lpage>286</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b005"><label>5</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Fickett</surname><given-names>JW</given-names></name><name name-style="western"><surname>Hatzigeorgiou</surname><given-names>A</given-names></name></person-group>
					<year>1997</year>
					<article-title>Eukaryotic promoter recognition.</article-title>
					<source>Genome Res</source>
					<volume>7</volume>
					<fpage>861</fpage>
					<lpage>878</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b006"><label>6</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Tompa</surname><given-names>M</given-names></name><name name-style="western"><surname>Li</surname><given-names>N</given-names></name><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name><name name-style="western"><surname>Church</surname><given-names>GM</given-names></name><name name-style="western"><surname>De Moor</surname><given-names>B</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Assessing computational tools for the discovery of transcription factor binding sites.</article-title>
					<source>Nat Biotechnol</source>
					<volume>23</volume>
					<fpage>137</fpage>
					<lpage>144</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b007"><label>7</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name><name name-style="western"><surname>Smith</surname><given-names>TF</given-names></name><name name-style="western"><surname>Katcher</surname><given-names>HL</given-names></name></person-group>
					<year>1984</year>
					<article-title>Algorithms for restriction map comparisons.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>12</volume>
					<fpage>237</fpage>
					<lpage>242</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b008"><label>8</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Griffith</surname><given-names>OL</given-names></name><name name-style="western"><surname>Pleasance</surname><given-names>ED</given-names></name><name name-style="western"><surname>Fulton</surname><given-names>DL</given-names></name><name name-style="western"><surname>Oveisi</surname><given-names>M</given-names></name><name name-style="western"><surname>Ester</surname><given-names>M</given-names></name><etal/></person-group>
					<year>2005</year>
					<article-title>Assessment and integration of publicly available SAGE, cDNA microarray, and oligonucleotide microarray expression data for global coexpression analyses.</article-title>
					<source>Genomics</source>
					<volume>86</volume>
					<fpage>476</fpage>
					<lpage>488</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b009"><label>9</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name><name name-style="western"><surname>Alkema</surname><given-names>W</given-names></name><name name-style="western"><surname>Engstrom</surname><given-names>P</given-names></name><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name><name name-style="western"><surname>Lenhard</surname><given-names>B</given-names></name></person-group>
					<year>2004</year>
					<article-title>JASPAR: An open-access database for eukaryotic transcription factor binding profiles.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>32</volume>
					<fpage>D91</fpage>
					<lpage>D94</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b010"><label>10</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Matys</surname><given-names>V</given-names></name><name name-style="western"><surname>Fricke</surname><given-names>E</given-names></name><name name-style="western"><surname>Geffers</surname><given-names>R</given-names></name><name name-style="western"><surname>Gossling</surname><given-names>E</given-names></name><name name-style="western"><surname>Haubrock</surname><given-names>M</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>TRANSFAC: Transcriptional regulation, from patterns to profiles.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>374</fpage>
					<lpage>378</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b011"><label>11</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Strachan</surname><given-names>T</given-names></name><name name-style="western"><surname>Read</surname><given-names>A</given-names></name></person-group>
					<year>1999</year>
					<source>Human molecular genetics 2</source>
					<publisher-loc>New York</publisher-loc>
					<publisher-name>John Wiley &amp; Sons</publisher-name>
					<!--===== Restructure page-count as size[@units="page"] =====--><size units="page">576</size>
					<comment>p.</comment>
				</element-citation></ref><ref id="pcbi-0020049-b012"><label>12</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Myers</surname><given-names>E</given-names></name><name name-style="western"><surname>Huang</surname><given-names>X</given-names></name></person-group>
					<year>1992</year>
					<article-title>An O(n<sup>2</sup>logn) restriction map comparison and search algorithm.</article-title>
					<source>Bull Math Biol</source>
					<volume>54</volume>
					<fpage>599</fpage>
					<lpage>618</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b013"><label>13</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Waterman</surname><given-names>M</given-names></name></person-group>
					<year>1995</year>
					<source>Introduction to computational biology</source>
					<publisher-loc>Boca Raton (Florida)</publisher-loc>
					<publisher-name>Chapman &amp; Hall</publisher-name>
					<comment>431 pp.</comment>
				</element-citation></ref><ref id="pcbi-0020049-b014"><label>14</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Thompson</surname><given-names>JD</given-names></name><name name-style="western"><surname>Higgins</surname><given-names>DG</given-names></name><name name-style="western"><surname>Gibson</surname><given-names>TJ</given-names></name></person-group>
					<year>1994</year>
					<article-title>ClustalW: Improving the sensitivity of progressive multiple sequence alignment through sequence weighting, position-specific gap penalties and weight matrix choice.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>22</volume>
					<fpage>4673</fpage>
					<lpage>4680</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b015"><label>15</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Robertson</surname><given-names>A</given-names></name><name name-style="western"><surname>Bilenky</surname><given-names>M</given-names></name><name name-style="western"><surname>Lin</surname><given-names>K</given-names></name><name name-style="western"><surname>He</surname><given-names>A</given-names></name><name name-style="western"><surname>Yuen</surname><given-names>W</given-names></name><etal/></person-group>
					<year>2006</year>
					<article-title>cisRED: A database system for genome-scale computational discovery of regulatory elements.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>34</volume>
					<fpage>D68</fpage>
					<lpage>D73</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b016"><label>16</label><element-citation publication-type="journal" xlink:type="simple">
					<collab xlink:type="simple">The Gene Ontology Consortium</collab>
					<year>2000</year>
					<article-title>Gene ontology: Tool for the unification of biology.</article-title>
					<source>Nat Genet</source>
					<volume>25</volume>
					<fpage>25</fpage>
					<lpage>29</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b017"><label>17</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Kasprzyk</surname><given-names>A</given-names></name><name name-style="western"><surname>Keefe</surname><given-names>D</given-names></name><name name-style="western"><surname>Smedley</surname><given-names>D</given-names></name><name name-style="western"><surname>London</surname><given-names>D</given-names></name><name name-style="western"><surname>Spooner</surname><given-names>W</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>Ensmart: A generic system for fast and flexible access to biological data.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>160</fpage>
					<lpage>169</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b018"><label>18</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Altschul</surname><given-names>SF</given-names></name><name name-style="western"><surname>Gish</surname><given-names>W</given-names></name><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Myers</surname><given-names>EW</given-names></name><name name-style="western"><surname>Lipman</surname><given-names>DJ</given-names></name></person-group>
					<year>1990</year>
					<article-title>Basic local alignment search tool.</article-title>
					<source>J Mol Biol</source>
					<volume>215</volume>
					<fpage>403</fpage>
					<lpage>410</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b019"><label>19</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Yamashita</surname><given-names>R</given-names></name><name name-style="western"><surname>Suzuki</surname><given-names>Y</given-names></name><name name-style="western"><surname>Sugano</surname><given-names>S</given-names></name><name name-style="western"><surname>Nakai</surname><given-names>K</given-names></name></person-group>
					<year>2005</year>
					<article-title>Genome-wide analysis reveals strong correlation between CpG islands with nearby transcription start sites of genes and their tissue specificity.</article-title>
					<source>Gene</source>
					<volume>350</volume>
					<fpage>129</fpage>
					<lpage>136</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b020"><label>20</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Smale</surname><given-names>S</given-names></name><name name-style="western"><surname>Kadonaga</surname><given-names>J</given-names></name></person-group>
					<year>2003</year>
					<article-title>The RNA polymerase II core promoter.</article-title>
					<source>Annu Rev Biochem</source>
					<volume>72</volume>
					<fpage>449</fpage>
					<lpage>479</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b021"><label>21</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Costa</surname><given-names>RH</given-names></name><name name-style="western"><surname>Grayson</surname><given-names>DR</given-names></name><name name-style="western"><surname>Darnell</surname><given-names>JE</given-names></name></person-group>
					<year>1989</year>
					<article-title>Multiple hepatocyte-enriched nuclear factors function in the regulation of transthyretinand α1.antitrypsin genes.</article-title>
					<source>Mol Cell Biol</source>
					<volume>9</volume>
					<fpage>1415</fpage>
					<lpage>1425</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b022"><label>22</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Overdier</surname><given-names>D</given-names></name><name name-style="western"><surname>Ye</surname><given-names>H</given-names></name><name name-style="western"><surname>Peterson</surname><given-names>R</given-names></name><name name-style="western"><surname>Clevidence</surname><given-names>D</given-names></name><name name-style="western"><surname>Costa</surname><given-names>R</given-names></name></person-group>
					<year>1997</year>
					<article-title>The winged helix transcriptional activator HFH-3 is expressed in the distal tubules of embryonic and adult mouse kidney.</article-title>
					<source>J Biol Chem</source>
					<volume>23</volume>
					<fpage>13725</fpage>
					<lpage>13730</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b023"><label>23</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Blanchette</surname><given-names>M</given-names></name><name name-style="western"><surname>Tompa</surname><given-names>M</given-names></name></person-group>
					<year>2002</year>
					<article-title>Discovery of regulatory elements by a computational method for phylogenetic footprinting.</article-title>
					<source>Genome Res</source>
					<volume>12</volume>
					<fpage>739</fpage>
					<lpage>748</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b024"><label>24</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Lenhard</surname><given-names>B</given-names></name><name name-style="western"><surname>Sandelin</surname><given-names>A</given-names></name><name name-style="western"><surname>Mendoza</surname><given-names>L</given-names></name><name name-style="western"><surname>Engstrom</surname><given-names>P</given-names></name><name name-style="western"><surname>Jareborg</surname><given-names>N</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Identification of conserved regulatory elements by comparative genome analysis.</article-title>
					<source>J Biol</source>
					<volume>2</volume>
					<fpage>13</fpage>
				</element-citation></ref><ref id="pcbi-0020049-b025"><label>25</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Quandt</surname><given-names>K</given-names></name><name name-style="western"><surname>Grote</surname><given-names>K</given-names></name><name name-style="western"><surname>Werner</surname><given-names>T</given-names></name></person-group>
					<year>1996</year>
					<article-title>GenomeInspector: A new approach to detect correlation patterns of elements on genomic sequences.</article-title>
					<source>CABIOS</source>
					<volume>12</volume>
					<fpage>404</fpage>
					<lpage>413</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b026"><label>26</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Frech</surname><given-names>K</given-names></name><name name-style="western"><surname>Danescu-Mayer</surname><given-names>J</given-names></name><name name-style="western"><surname>Werner</surname><given-names>T</given-names></name></person-group>
					<year>1997</year>
					<article-title>A novel method to develop highly specific models for regulatory units detects a new LTR in genbank which contains a functional promoter.</article-title>
					<source>J Mol Biol</source>
					<volume>270</volume>
					<fpage>674</fpage>
					<lpage>687</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b027"><label>27</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Klingenhoff</surname><given-names>A</given-names></name><name name-style="western"><surname>Frech</surname><given-names>K</given-names></name><name name-style="western"><surname>Quandt</surname><given-names>K</given-names></name><name name-style="western"><surname>Werner</surname><given-names>T</given-names></name></person-group>
					<year>1999</year>
					<article-title>Functional promoter modules can be detected by formal models independent of overall nucleotide sequence similarity.</article-title>
					<source>Bioinformatics</source>
					<volume>15</volume>
					<fpage>180</fpage>
					<lpage>186</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b028"><label>28</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Solovyev</surname><given-names>V</given-names></name><name name-style="western"><surname>Shamuradov</surname><given-names>I</given-names></name></person-group>
					<year>2003</year>
					<article-title>PromH: Promoters identification using orthologous genomic sequences.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>21</volume>
					<fpage>3540</fpage>
					<lpage>3545</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b029"><label>29</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Ostell</surname><given-names>J</given-names></name><name name-style="western"><surname>Rudd</surname><given-names>K</given-names></name></person-group>
					<year>1990</year>
					<article-title>An algorithm for searching restriction maps.</article-title>
					<source>CABIOS</source>
					<volume>6</volume>
					<fpage>247</fpage>
					<lpage>252</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b030"><label>30</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Miller</surname><given-names>W</given-names></name><name name-style="western"><surname>Barr</surname><given-names>J</given-names></name><name name-style="western"><surname>Rudd</surname><given-names>K</given-names></name></person-group>
					<year>1991</year>
					<article-title>Improved algorithms for searching restriction maps.</article-title>
					<source>CABIOS</source>
					<volume>7</volume>
					<fpage>447</fpage>
					<lpage>456</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b031"><label>31</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Huang</surname><given-names>X</given-names></name><name name-style="western"><surname>Waterman</surname><given-names>MS</given-names></name></person-group>
					<year>1992</year>
					<article-title>Dynamic programming algorithms for restriction map comparison.</article-title>
					<source>Bioinformatics</source>
					<volume>8</volume>
					<fpage>511</fpage>
					<lpage>520</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b032"><label>32</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Stormo</surname><given-names>GD</given-names></name></person-group>
					<year>2000</year>
					<article-title>DNA binding sites: Representation and discovery.</article-title>
					<source>Bioinformatics</source>
					<volume>16</volume>
					<fpage>16</fpage>
					<lpage>23</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b033"><label>33</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Farre</surname><given-names>D</given-names></name><name name-style="western"><surname>Roset</surname><given-names>R</given-names></name><name name-style="western"><surname>Huerta</surname><given-names>M</given-names></name><name name-style="western"><surname>Adsuara</surname><given-names>JE</given-names></name><name name-style="western"><surname>Rosello</surname><given-names>L</given-names></name><etal/></person-group>
					<year>2003</year>
					<article-title>Identification of patterns in biological sequences at the ALGGEN server: PROMO and MALGEN.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>31</volume>
					<fpage>3651</fpage>
					<lpage>3653</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b034"><label>34</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bailey</surname><given-names>TL</given-names></name><name name-style="western"><surname>Elkan</surname><given-names>C</given-names></name></person-group>
					<year>1994</year>
					<article-title>Fitting a mixture model by expectation maximization to discover motifs in biopolymers.</article-title>
					<source>Proc ISMB</source>
					<volume>2</volume>
					<fpage>28</fpage>
					<lpage>36</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b035"><label>35</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Roth</surname><given-names>F</given-names></name><name name-style="western"><surname>Hughes</surname><given-names>J</given-names></name><name name-style="western"><surname>Estep</surname><given-names>P</given-names></name><name name-style="western"><surname>Church</surname><given-names>G</given-names></name></person-group>
					<year>1998</year>
					<article-title>Finding DNA regulatory motifs within unaligned noncoding sequences clustered by whole-genome mRNA quantitation.</article-title>
					<source>Nat Biotechnol</source>
					<volume>16</volume>
					<fpage>939</fpage>
					<lpage>945</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b036"><label>36</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Jegga</surname><given-names>AG</given-names></name><name name-style="western"><surname>Sherwood</surname><given-names>SP</given-names></name><name name-style="western"><surname>Carman</surname><given-names>JW</given-names></name><name name-style="western"><surname>Pinski</surname><given-names>AT</given-names></name><name name-style="western"><surname>Philips</surname><given-names>JL</given-names></name><etal/></person-group>
					<year>2002</year>
					<article-title>Detection and visualization of compositionally similar cis-regulatory element clusters in orthologous and coordinately controlled genes.</article-title>
					<source>Genome Res</source>
					<volume>12</volume>
					<fpage>1408</fpage>
					<lpage>1417</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b037"><label>37</label><element-citation publication-type="other" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bateman</surname><given-names>A</given-names></name><name name-style="western"><surname>Coin</surname><given-names>L</given-names></name><name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name><name name-style="western"><surname>Finn</surname><given-names>R</given-names></name><name name-style="western"><surname>Hollich</surname><given-names>V</given-names></name><etal/></person-group>
					<year>2004</year>
					<article-title>The Pfam protein families database.</article-title>
					<source>Nucleic Acids Res</source>
					<fpage>D138</fpage>
					<lpage>D141</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b038"><label>38</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name><name name-style="western"><surname>Jaroszewsky</surname><given-names>L</given-names></name><name name-style="western"><surname>Li</surname><given-names>W</given-names></name><name name-style="western"><surname>Godzik</surname><given-names>A</given-names></name></person-group>
					<year>2003</year>
					<article-title>A segment alignment approach to protein comparison.</article-title>
					<source>Bioinformatics</source>
					<volume>19</volume>
					<fpage>742</fpage>
					<lpage>749</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b039"><label>39</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Batzoglou</surname><given-names>S</given-names></name><name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name><name name-style="western"><surname>Mesirov</surname><given-names>JP</given-names></name><name name-style="western"><surname>Berger</surname><given-names>B</given-names></name><name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name></person-group>
					<year>2000</year>
					<article-title>Human and mouse gene structure: Comparative analysis and application to exon prediction.</article-title>
					<source>Genome Res</source>
					<volume>10</volume>
					<fpage>950</fpage>
					<lpage>958</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b040"><label>40</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Bray</surname><given-names>N</given-names></name><name name-style="western"><surname>Dubchak</surname><given-names>I</given-names></name><name name-style="western"><surname>Pachter</surname><given-names>L</given-names></name></person-group>
					<year>2003</year>
					<article-title>AVID: A global alignment program.</article-title>
					<source>Genome Res</source>
					<volume>13</volume>
					<fpage>97</fpage>
					<lpage>102</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b041"><label>41</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Berezikov</surname><given-names>E</given-names></name><name name-style="western"><surname>Guryev</surname><given-names>V</given-names></name><name name-style="western"><surname>Plasterk</surname><given-names>RHA</given-names></name><name name-style="western"><surname>Cuppen</surname><given-names>E</given-names></name></person-group>
					<year>2004</year>
					<article-title>Conreal: Conserved regulatory elements anchored alignment algorithm for identification of transcription factor binding sites by phylogenetic footprinting.</article-title>
					<source>Genome Res</source>
					<volume>14</volume>
					<fpage>170</fpage>
					<lpage>178</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b042"><label>42</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name><name name-style="western"><surname>Fickett</surname><given-names>JW</given-names></name></person-group>
					<year>1998</year>
					<article-title>Identification of regulatory regions which confer muscle-specific gene expression.</article-title>
					<source>Journal of Molecular Biology</source>
					<volume>278</volume>
					<fpage>167</fpage>
					<lpage>181</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b043"><label>43</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Krivan</surname><given-names>W</given-names></name><name name-style="western"><surname>Wasserman</surname><given-names>WW</given-names></name></person-group>
					<year>2001</year>
					<article-title>A predictive model for regulatory sequences detecting liver-specific transcription.</article-title>
					<source>Genome Res</source>
					<volume>11</volume>
					<fpage>1559</fpage>
					<lpage>1566</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b044"><label>44</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Dermitzakis</surname><given-names>ET</given-names></name><name name-style="western"><surname>Clark</surname><given-names>AG</given-names></name></person-group>
					<year>2002</year>
					<article-title>Evolution of transcription factor binding sites in mammalian gene regulatory regions: Conservation and turnover.</article-title>
					<source>Mol Biol Evol</source>
					<volume>7</volume>
					<fpage>1114</fpage>
					<lpage>1121</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b045"><label>45</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Pruitt</surname><given-names>K</given-names></name><name name-style="western"><surname>Tatusova</surname><given-names>T</given-names></name><name name-style="western"><surname>Maglott</surname><given-names>D</given-names></name></person-group>
					<year>2004</year>
					<article-title>NCBI Reference Sequence (RefSeq): A curated non-redundant sequence database of genomes, transcripts and proteins.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>33</volume>
					<fpage>D501</fpage>
					<lpage>D504</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b046"><label>46</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Baldi</surname><given-names>P</given-names></name><name name-style="western"><surname>Brunak</surname><given-names>S</given-names></name><name name-style="western"><surname>Chauvin</surname><given-names>Y</given-names></name><name name-style="western"><surname>Andersen</surname><given-names>C</given-names></name><name name-style="western"><surname>Nielsen</surname><given-names>H</given-names></name></person-group>
					<year>2000</year>
					<article-title>Assessing the accuracy of prediction algorithms for classification: An overview.</article-title>
					<source>Bioinformatics</source>
					<volume>16</volume>
					<fpage>412</fpage>
					<lpage>424</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b047"><label>47</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Schneider</surname><given-names>T</given-names></name><name name-style="western"><surname>Stephens</surname><given-names>R</given-names></name></person-group>
					<year>1990</year>
					<article-title>Sequence logos: A new way to display consensus sequences.</article-title>
					<source>Nucleic Acids Res</source>
					<volume>18</volume>
					<fpage>6097</fpage>
					<lpage>6100</lpage>
				</element-citation></ref><ref id="pcbi-0020049-b048"><label>48</label><element-citation publication-type="journal" xlink:type="simple">
					<person-group person-group-type="author"><name name-style="western"><surname>Abril</surname><given-names>JF</given-names></name><name name-style="western"><surname>Guigo</surname><given-names>R</given-names></name></person-group>
					<year>2000</year>
					<article-title>gff2ps: Visualizing genomic annotations.</article-title>
					<source>Bioinformatics</source>
					<volume>8</volume>
					<fpage>743</fpage>
					<lpage>744</lpage>
				</element-citation></ref></ref-list></back></article>