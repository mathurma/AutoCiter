<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01267</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006895</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Latent goal models for dynamic strategic interaction</article-title>
<alt-title alt-title-type="running-head">Latent goal models for dynamic strategic interaction</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2766-8425</contrib-id>
<name name-style="western">
<surname>Iqbal</surname> <given-names>Shariq N.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2630-6038</contrib-id>
<name name-style="western">
<surname>Yin</surname> <given-names>Lun</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8215-506X</contrib-id>
<name name-style="western">
<surname>Drucker</surname> <given-names>Caroline B.</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9402-7949</contrib-id>
<name name-style="western">
<surname>Kuang</surname> <given-names>Qian</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Gariépy</surname> <given-names>Jean-François</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3912-8821</contrib-id>
<name name-style="western">
<surname>Platt</surname> <given-names>Michael L.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9876-7837</contrib-id>
<name name-style="western">
<surname>Pearson</surname> <given-names>John M.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Duke Institute for Brain Sciences, Center for Cognitive Neuroscience, Duke University, Durham, NC, USA</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Departments of Neuroscience, Marketing, and Psychology, University of Pennsylvania, Philadelphia, PA, USA</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Biostatistics and Bioinformatics, Duke University, Durham, NC, USA</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Daunizeau</surname> <given-names>Jean</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Brain and Spine Institute (ICM), FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label>
<p>Current address: Department of Computer Science, University of Southern California, Los Angeles, CA, USA</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">john.pearson@duke.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>11</day>
<month>3</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>3</issue>
<elocation-id>e1006895</elocation-id>
<history>
<date date-type="received">
<day>20</day>
<month>7</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>20</day>
<month>2</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Iqbal et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006895"/>
<abstract>
<p>Understanding the principles by which agents interact with both complex environments and each other is a key goal of decision neuroscience. However, most previous studies have used experimental paradigms in which choices are discrete (and few), play is static, and optimal solutions are known. Yet in natural environments, interactions between agents typically involve continuous action spaces, ongoing dynamics, and no known optimal solution. Here, we seek to bridge this divide by using a “penalty shot” task in which pairs of monkeys competed against each other in a competitive, real-time video game. We modeled monkeys’ strategies as driven by stochastically evolving goals, onscreen positions that served as set points for a control model that produced observed joystick movements. We fit this goal-based dynamical system model using approximate Bayesian inference methods, using neural networks to parameterize players’ goals as a dynamic mixture of Gaussian components. Our model is conceptually simple, constructed of interpretable components, and capable of generating synthetic data that capture the complexity of real player dynamics. We further characterized players’ strategies using the number of change points on each trial. We found that this complexity varied more across sessions than within sessions, and that more complex strategies benefited offensive players but not defensive players. Together, our experimental paradigm and model offer a powerful combination of tools for the study of realistic social dynamics in the laboratory setting.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Most studies of strategic decision making make use of simple tasks in which agents choose among only a limited number of distinct options. But real-world behavior is complex, requiring ongoing adjustment of strategies. Here, we propose a new model that is capable of reproducing the rich behavior of monkeys playing against each other in a dynamic decision task. Our model quantifies players’ goals at each moment and offers a means of performing controlled experiments via simulation. This makes possible more realistic experimental paradigms for the study of strategic decision making and social interaction.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000066</institution-id>
<institution>National Institute of Environmental Health Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>K01ES025442</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9876-7837</contrib-id>
<name name-style="western">
<surname>Pearson</surname> <given-names>John M.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000025</institution-id>
<institution>National Institute of Mental Health</institution>
</institution-wrap>
</funding-source>
<award-id>MH109728</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3912-8821</contrib-id>
<name name-style="western">
<surname>Platt</surname> <given-names>Michael L.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000893</institution-id>
<institution>Simons Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>304935</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3912-8821</contrib-id>
<name name-style="western">
<surname>Platt</surname> <given-names>Michael L.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work 438 is supported by an NIH career development award to JMP (K01ES025442; <ext-link ext-link-type="uri" xlink:href="https://commonfund.nih.gov/bd2k" xlink:type="simple">https://commonfund.nih.gov/bd2k</ext-link>), NIH Grant 439 MH109728 (to MLP; <ext-link ext-link-type="uri" xlink:href="https://www.nimh.nih.gov/index.shtml" xlink:type="simple">https://www.nimh.nih.gov/index.shtml</ext-link>), and Simons Foundation Grant SFARI award #304935 (to MLP; <ext-link ext-link-type="uri" xlink:href="https://www.simonsfoundation.org/" xlink:type="simple">https://www.simonsfoundation.org/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2019-04-18</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Our data are available at the Open Science Framework (osf.org): (doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.17605/OSF.IO/HGYBR" xlink:type="simple">10.17605/OSF.IO/HGYBR</ext-link>). Code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/pearsonlab/tf-gbds" xlink:type="simple">https://github.com/pearsonlab/tf-gbds</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Humans are a social species. Our most difficult and most crucial decisions—whom to trust, whom to double-cross, with whom to rear children—are most often decisions about other agents. Indeed, it has been conjectured that group living formed the primary driving force in the evolution of human cognition [<xref ref-type="bibr" rid="pcbi.1006895.ref001">1</xref>]. Yet social decisions are also among the most complex that agents face, since the relevant costs and benefits rely not only on one’s own preferences and options, but on others’ preferences, their options, and (potentially) their assessments of one’s intentions [<xref ref-type="bibr" rid="pcbi.1006895.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref003">3</xref>].</p>
<p>Over the last decade, much neuroscientific work has attempted to understand the physiological and cognitive basis for these social decisions [<xref ref-type="bibr" rid="pcbi.1006895.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1006895.ref005">5</xref>]. Most of these studies have been performed in humans using non-invasive methods like functional MRI and EEG, though an important (and growing) strand of work has used animal models [<xref ref-type="bibr" rid="pcbi.1006895.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006895.ref014">14</xref>], which allow for direct neural recording. In both cases, the behavioral tool of choice has been game theory. Game theory offers several important benefits for the study of social decisions: models of both cooperative and competitive interaction; a rich, well-developed theory; and a clear notion of optimality, Nash equilibrium, against which subjects’ behavior can be compared. In addition, there are vast parallel literatures studying empirical game play in real agents [<xref ref-type="bibr" rid="pcbi.1006895.ref002">2</xref>], evolutions of strategies [<xref ref-type="bibr" rid="pcbi.1006895.ref015">15</xref>], and games as models for ecological behavior [<xref ref-type="bibr" rid="pcbi.1006895.ref016">16</xref>].</p>
<p>Nonetheless, such paradigms are also limited as models of real-world social decisions. For example, in typical paradigms, the choice space is discretized and low-dimensional, whereas real social decisions are embodied, requiring movement in space from multiple effectors. Moreover, because laboratory tasks often involve (repeated) single decisions among small numbers of alternatives, the space of available strategies is highly constrained, often isomorphic to the space of choices. By contrast, interaction in social settings involves feedback from other agents in real-time, with a commensurately large space of potential strategies. Unfortunately, moving beyond small numbers of discrete choices drastically complicates behavioral analysis. Optimality may no longer be well-defined, and when it is, finding a solution may yet be computationally intractable. Moreover, when the potential behavioral repertoire on each bout of play is large, it may be difficult, if not impossible, to meaningfully average physiological signals like neural activity across bouts.</p>
<p>Here we use insights from generative modeling, control theory, and inverse reinforcement learning [<xref ref-type="bibr" rid="pcbi.1006895.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref018">18</xref>] to show how it is nonetheless possible to characterize strategies in a dynamic, competitive decision at the single-trial level. Using data collected from a laboratory task in which pairs of rhesus macaques used joysticks to control onscreen avatars, we describe the avatars’ resulting trajectories in terms of time-varying latent “goals”—onscreen locations that function as set points for a control model that produces joystick movement. We use methods of scalable, approximate Bayesian inference to both infer goal trajectories at the single-trial level and generate entirely new gameplay that captures the richness of real player behavior. In the model, goals themselves are generated by a stochastic process analogous to the motion of a particle in a potential energy well, with the potential energy term capturing the interaction of each player’s goals with his opponent’s observed actions. This potential energy, flexibly parameterized by neural networks, allows us to succinctly describe player interactions apart from details of the control process, providing moment-by-moment measures of intention and decision complexity that can be correlated with neural signals. Just as importantly, though the model is developed for the case of a simple screen-based task with two players, it easily generalizes to other time series data (including &gt;2 real or artificial agents) in which observations are the result of a control process and latent goals are the underlying variables of interest.</p>
<p>In the sections below, we first describe the two-player dynamic decision task and its attendant data. We then outline our generative modeling assumptions, including the control and latent goal models. After that, we describe how to perform approximate Bayesian inference in the model using scalable Variational Bayes methods [<xref ref-type="bibr" rid="pcbi.1006895.ref019">19</xref>]. We assess the outputs of the model and compare with simpler alternatives, showing that the model not only captures the rich variation present in real game play but is capable of generating novel data of similar complexity. We then demonstrate that goals are better predictors of trial outcomes than either current velocity or players’ gaze positions and give an example of how our model can be used to perform controlled experiments via simulation of novel data. Finally, we use a simple measure of strategic complexity to consider the effect of this quantity on win rate. We conclude by discussing applications of our model to neural data analysis.</p>
</sec>
<sec id="sec002">
<title>Methods and models</title>
<sec id="sec003">
<title>Subjects, task, and data</title>
<sec id="sec004">
<title>Ethics statement</title>
<p>All protocols and procedures were approved by the Duke University Institutional Animal Care and Use Committee.</p>
</sec>
<sec id="sec005">
<title>Subjects</title>
<p>Three adult male rhesus macaques (monkeys O, Y, and E) played as shooters in the penalty shot game described below, and these three plus one other (monkey D) played as goalies. All subjects were singly housed, and were kept on a water-restricted diet to increase motivation to earn liquid reward in the experimental task.</p>
</sec>
<sec id="sec006">
<title>Task</title>
<p>Two monkeys sat in primate chairs (Crist Instruments, Damascus, MD) modified to allow access to joysticks (IP66s, CTI Electronics, Stratford, CT) affixed in a custom-built acrylic case at the front. All axes of the joystick were calibrated with a MATLAB (Natick, MA, USA) script to ensure that every direction yielded equal speed. Horizontal and vertical eye positions of the shooter were sampled at 1000 Hz by an infrared camera (Eyelink 1000, SR Research, Kanata, Ontario, Canada). The task was presented and data were collected via custom-built scripts in MATLAB using the Psychophysics and Eyelink Toolbox extensions [<xref ref-type="bibr" rid="pcbi.1006895.ref020">20</xref>] (see <ext-link ext-link-type="uri" xlink:href="http://psychtoolbox.org/" xlink:type="simple">http://psychtoolbox.org/</ext-link>). Primate chairs were oriented at a ninety-degree angle to one another such that each monkey could see the other to his left or right. Each monkey also faced his own computer monitor displaying the task; the display was the same on both screens.</p>
<p>Each trial was preceded by a 300ms period during which the monkeys each had to center their joysticks. Then a green circle, the puck, appeared at the left side of the screen, centered vertically. A long red rectangle, the goalie bar, appeared at the vertical center near the right of the screen. Further to the right, a gray line, the goal, extended from the top to the bottom of the screen. The screen was otherwise black (<xref ref-type="fig" rid="pcbi.1006895.g001">Fig 1</xref>). The “shooter” monkey’s joystick controlled the movement of the puck, which was unconstrained in all directions except that it could not go beyond the borders of the screen, and the “goalie” monkey’s joystick controlled the movement of the bar, which was similarly unconstrained vertically but did not move horizontally. The monkeys’ roles were fixed throughout an experimental session. Each trial ended when the puck reached the goal, when the puck hit the goalie bar, or when ten seconds had elapsed with no movement from the shooter. The horizontal and vertical location of the puck, as well as the vertical location of the goalie bar, were recorded throughout the trial at roughly 60 Hz. If the puck reached the goal, the shooter was considered to have won and he received a drop of juice in his mouth. If the puck hit the goalie bar, the goalie was considered to have won and he received a drop of juice in his mouth. Juice volume on each successful trial was similar for both monkeys and constant throughout the session. Following juice delivery, the screen went blank for a 1.5 s inter-trial interval before the next trial began. The speeds of the puck and goalie bar were titrated by the experimenter between gaming blocks (roughly 200 trials) to achieve a roughly 50% win rate for each player in each session. Monkeys were first trained against a computer opponent performing simple movements and subsequently confronted monkey opponents.</p>
<fig id="pcbi.1006895.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006895.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Penalty shot task and game play.</title>
<p>A: The two subjects viewed the same image on separate screens. One subject (at left here) played as the “shooter” and controlled the puck, while the other (at bottom here) played as the “goalie” and controlled the bar. B: Illustration of onscreen play for the two-player game. The puck (blue) is free to move in two dimensions, while the goalie (red) moves only up or down. Axes are x and y screen directions. Solid lines indicate player trajectories for a single trial. The goalie’s trajectory has been stretched along the x axis to indicate its movement through time. For animations of game play, see <xref ref-type="supplementary-material" rid="pcbi.1006895.s004">S1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006895.s005">S2</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006895.s006">S3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006895.s007">S4</xref> Videos.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Data</title>
<p>Data consisted of puck and goalie trajectories on each trial for <italic>N</italic> = 120 behavioral sessions (Shooter sessions: Monkey O: 59, Monkey Y: 55, Monkey E: 6) for a total of 59,884 trials. For demonstrating model fits and generated trials, we also used a smaller, more homogeneous dataset comprising 8659 trials from the last 10 sessions of the experiment (all Monkey O).</p>
<p>Each trial’s data comprised a three-dimensional vector <italic>y</italic> = (<italic>x</italic><sub>puck</sub>, <italic>y</italic><sub>puck</sub>, <italic>y</italic><sub>goalie</sub>) at each time, sampled at a rate of approximately 60 samples per second. Prior to analysis, data were preprocessed by independently normalizing the range of each coordinate in <italic>y</italic> to [−1, 1]. To accurately estimate conditions at the beginning of each trial, we smoothed data using a Gaussian kernel with length <italic>w</italic> = 41 and <italic>σ</italic> = 4. Nonetheless, this smoothing is affected by a bias-variance tradeoff. To minimize bias in the initial condition, the first <inline-formula id="pcbi.1006895.e001"><alternatives><graphic id="pcbi.1006895.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mo>⌊</mml:mo> <mml:mfrac><mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>⌋</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> time points were reflected in time and sign and prepended to the data:
<disp-formula id="pcbi.1006895.e002"><alternatives><graphic id="pcbi.1006895.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>y</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
so that <italic>y</italic><sub>1</sub> remained invariant under the smoothing. Similarly, to avoid introducing artifacts in control at the end of the trial, data were linearly extrapolated past the last time point for smoothing. Alternatives to this procedure yielded smoother trajectories at the cost of greater bias in initial conditions, including initial velocity.</p>
<p>For model fitting, data were augmented by two additional variables at each time point. The first variable encoded a linear trend that was fixed at the session level and ranged from 0 (first session of the experiment) to 1 (last session). The second variable was a binary indicator corresponding to the brain region in which electrophysiological recordings were performed for the session in which the trial took place.</p>
<p>Finally, we used gaze data collected from shooter monkeys. Data were sampled at 1kHz and reinterpolated at 900Hz, such that each behavioral time stamp corresponded to 15 gaze samples.</p>
</sec>
</sec>
<sec id="sec008">
<title>Game dynamics</title>
<p>Let <italic>y</italic><sub><italic>t</italic></sub> be the observed variables of the onscreen trajectory at time <italic>t</italic>. Similarly, let <italic>s</italic><sub><italic>t</italic></sub> be the collection of system variables. We typically consider the latter to be positions and velocities (i.e., <inline-formula id="pcbi.1006895.e003"><alternatives><graphic id="pcbi.1006895.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>), but they could additionally include accelerations, additional time points of lagged data, or variables encoding player identity or game condition. For the penalty shot task, <italic>y</italic><sub><italic>t</italic></sub> evolves according to
<disp-formula id="pcbi.1006895.e004"><alternatives><graphic id="pcbi.1006895.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mtext>max</mml:mtext></mml:msub> <mml:mo>⊙</mml:mo> <mml:msub><mml:mi>υ</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
with <italic>v</italic><sub>max</sub> a vector of maximum velocities in each dimension as determined from the data, <italic>υ</italic> ∈ [−1, 1] a joystick position, and ⊙ the Hadamard (elementwise) product. We further assume that the joystick position <italic>υ</italic> is related to a <italic>latent</italic> control signal <italic>u</italic> via <italic>υ</italic> = tanh(<italic>u</italic>). That is, the observed control, restricted by the finite joystick range, may be less than desired control.</p>
</sec>
<sec id="sec009">
<title>Control model</title>
<p>We assume that at each time <italic>t</italic>, <italic>u</italic><sub><italic>t</italic></sub> is the output of a control model attempting to minimize an error <italic>e</italic><sub><italic>t</italic></sub> ≡ <italic>g</italic><sub><italic>t</italic></sub>−<italic>y</italic><sub><italic>t</italic></sub> with <italic>g</italic><sub><italic>t</italic></sub> an instantaneous, state-dependent, set point for the controller that we will call a “goal”. These goals represent the instantaneous onscreen locations desired by each player, as evidenced by the fact that when <italic>y</italic><sub><italic>t</italic></sub> = <italic>g</italic><sub><italic>t</italic></sub>(<italic>s</italic><sub><italic>t</italic></sub>) (next goal and position are equal), we have <italic>e</italic><sub><italic>t</italic></sub> = 0 and thus no need for control. When <italic>e</italic><sub><italic>t</italic></sub> ≠ 0, however, we assume that changes in control are given by a proportional-integral-derivative (PID) controller:
<disp-formula id="pcbi.1006895.e005"><alternatives><graphic id="pcbi.1006895.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>≡</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>L</mml:mi> <mml:mo>*</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>τ</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>2</mml:mn></mml:munderover> <mml:msub><mml:mi>L</mml:mi> <mml:mi>τ</mml:mi></mml:msub> <mml:msub><mml:mi>e</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>τ</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>κ</mml:mi> <mml:mo>[</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:msub><mml:mi>T</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>T</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:msub><mml:mi>e</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
with <italic>κ</italic> the proportional control constant and <italic>T</italic><sub><italic>i</italic></sub> and <italic>T</italic><sub><italic>d</italic></sub> the integration and differentiation time constants, respectively. That is, <italic>L</italic> is a convolutional filter, determined by <italic>κ</italic>, <italic>T</italic><sub><italic>i</italic></sub>, and <italic>T</italic><sub><italic>d</italic></sub>, learned separately for each player in each dimension. Changes in control are thus convolutions over the control error. Finally, to capture our uncertainty about this relationship, we model errors in control as normally distributed with variance <italic>ϵ</italic><sup>2</sup>:
<disp-formula id="pcbi.1006895.e006"><alternatives><graphic id="pcbi.1006895.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>u</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:mo>*</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where the equation should be read as implying a separate, uncorrelated, normal distribution for each coordinate in <italic>u</italic> (with potentially distinct <italic>ϵ</italic><sub><italic>i</italic></sub> in each dimension). In practice, our onscreen observations have minimal noise, implying <italic>ϵ</italic> ≪ 1.</p>
<p>Unfortunately, <xref ref-type="disp-formula" rid="pcbi.1006895.e006">Eq 4</xref> is ambiguous, since for any sequence of controls <italic>u</italic><sub><italic>t</italic></sub> and any <italic>L</italic>, the equations for <italic>g</italic> are linear and thus in general invertible. And while this symmetry is weakly broken by our model for <italic>g</italic> (described below), which prefers some sequences of goals to others, we remove the ambiguity in practice by fixing control to be purely proportional early in training, consistent with the idea of a goal as a point toward which each player desires to move.</p>
<p>In addition, a second issue arises from the fact that joystick positions are constrained to lie in [−1, 1] along each dimension, while model-predicted control might be large. In our model, we achieve this by using a hyperbolic tangent function to link <italic>u</italic> (desired control) to <italic>υ</italic> (joystick input). However, this means that small changes in <italic>υ</italic> can result in potentially large changes in inferred <italic>u</italic> and thus <italic>g</italic>. More concretely, when joystick input is near maximal (<italic>υ</italic> ≈ ±1), this will be consistent for any goal <italic>farther</italic> than a certain distance from the player’s current location. Ideally, one would consider <italic>υ</italic> a censored version of <italic>u</italic>, a possibility we leave to future work. Here, we remedy this by imposing a penalty during model training on any goals that far exceed the visible game area.</p>
</sec>
<sec id="sec010">
<title>Goal model</title>
<p>For the goal time series, <italic>g</italic><sub><italic>t</italic></sub>, we will assume a Markov process in which new goals are probabilistically selected at each time based on both the current goal and the current state of the system. That is,
<disp-formula id="pcbi.1006895.e007"><alternatives><graphic id="pcbi.1006895.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>,</mml:mo> <mml:mi>g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>t</mml:mi></mml:munder> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula></p>
<p>More specifically, we will assume that at each time point, there exists a function <italic>V</italic>(<italic>g</italic><sub><italic>t</italic></sub>, <italic>s</italic><sub><italic>t</italic></sub>) that captures the benefit in setting a particular goal based on the current state of the system. That is, we want to increase <italic>V</italic> as often as possible. (Alternately, we could consider −<italic>V</italic> as an energy function that we wish to minimize.) However, we also assume that the goal time series is relatively smooth, which we formalize by adding a regularization term for the rate of change between successive time points. More explicitly, let
<disp-formula id="pcbi.1006895.e008"><alternatives><graphic id="pcbi.1006895.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>u</mml:mi> <mml:mo>,</mml:mo> <mml:mi>g</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>t</mml:mi></mml:munder> <mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>ϵ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mo>∥</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>u</mml:mi> <mml:mrow><mml:mo>*</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>y</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∥</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo/> <mml:mo/> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mo>∥</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>∥</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>Z</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula></p>
<p>Here, <italic>u</italic><sub>*<italic>t</italic></sub> ≡ <italic>u</italic><sub><italic>t</italic>−1</sub> + <italic>L</italic>*(<italic>g</italic><sub><italic>t</italic></sub>−<italic>y</italic><sub><italic>t</italic></sub>) is the the predicted control and <italic>ϵ</italic> and <italic>σ</italic> govern the control noise and goal diffusion, respectively. In what follows, we will also find it useful to define <italic>β</italic> ≡ <italic>σ</italic><sup>−2</sup> and <italic>U</italic>(<italic>g</italic>) ≡ − <italic>σ</italic><sup>2</sup> <italic>V</italic> in order to write log <italic>p</italic>(<italic>g</italic>) = −<italic>βE</italic>(<italic>g</italic>|<italic>s</italic>) − log <italic>Z</italic>′ with
<disp-formula id="pcbi.1006895.e009"><alternatives><graphic id="pcbi.1006895.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>|</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>t</mml:mi></mml:munder> <mml:mo>[</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>∥</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>∥</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>U</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
which results from marginalizing the <italic>u</italic><sub><italic>t</italic></sub> out of <xref ref-type="disp-formula" rid="pcbi.1006895.e008">Eq 6</xref>.</p>
<p>This formulation admits multiple interpretations: mostly simply, <italic>E</italic>(<italic>g</italic>|<italic>s</italic>) is the negative log probability of the goal time series: configurations that minimize this “energy” have higher probability. Along the same lines, the first term in <xref ref-type="disp-formula" rid="pcbi.1006895.e009">Eq 7</xref> is a penalty on large changes in <italic>g</italic> between time points, encouraging smoothness. In form, it is equivalent to a “kinetic energy” <inline-formula id="pcbi.1006895.e010"><alternatives><graphic id="pcbi.1006895.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>K</mml:mi> <mml:mo>≡</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>g</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msup> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Likewise, the second term, <italic>U</italic>(<italic>g</italic>), is a generator of changes in goal state. At each time point, goals are drawn toward regions of small <italic>U</italic>, making it analogous to a “potential energy.” Together, the probabilistic model over goal trajectories in <xref ref-type="disp-formula" rid="pcbi.1006895.e009">Eq 7</xref> is equivalent to a path integral for a particle with position <italic>g</italic><sub><italic>t</italic></sub> and energy <italic>K</italic> + <italic>U</italic>. In the limit of small <italic>V</italic>/small <italic>σ</italic>/large <italic>β</italic>, one is in either the low-temperature thermodynamic limit or the high-mass classical limit, and <italic>g</italic> is a spatially-varying perturbation of a Gaussian process. Alternately, in the limit of large <italic>σ</italic>, goals are simply chosen independently at each time point. In any case, we have made the strong assumption that dependence of <italic>g</italic><sub><italic>t</italic></sub> on <italic>g</italic><sub><italic>t</italic>−1</sub> occurs only through a momentum term, requiring that the “static” <italic>V</italic> term carries most of the weight of explanation.</p>
<p>Unfortunately, for general <italic>V</italic>(<italic>g</italic>|<italic>s</italic>), the distribution implied by <xref ref-type="disp-formula" rid="pcbi.1006895.e009">Eq 7</xref> is of the Boltzmann-Gibbs form and impossible to sample efficiently. If the goal of our inference is to model <italic>V</italic> itself, we will need a method for sampling from <italic>p</italic>(<italic>g</italic>) that still allows this partitioning.</p>
<sec id="sec011">
<title><italic>V</italic> as a mixture of Gaussians</title>
<p>From the quadratic form of <xref ref-type="disp-formula" rid="pcbi.1006895.e009">Eq 7</xref>, it is clear that one choice that leads to easy sampling is to assume that <italic>e</italic><sup><italic>V</italic></sup> is a Gaussian mixture model (GMM) at every time <italic>t</italic>:
<disp-formula id="pcbi.1006895.e011"><alternatives><graphic id="pcbi.1006895.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>∝</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>[</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>⊤</mml:mi></mml:msup> <mml:mo>·</mml:mo> <mml:msub><mml:mo>Λ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mo>·</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mo>Λ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
with <inline-formula id="pcbi.1006895.e012"><alternatives><graphic id="pcbi.1006895.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Here, we write <italic>μ</italic><sub><italic>k</italic></sub> and Λ<sub><italic>k</italic></sub> for the mean and precision matrices (inverse covariances) of the component Gaussians, and we have chosen not to absorb factors of <italic>σ</italic><sup>2</sup> into the precisions in order to have a common scale for ‖<italic>g</italic><sub><italic>t</italic></sub> − <italic>g</italic><sub><italic>t</italic>−1</sub>‖ and the eigenvalues of Λ<sup>−1</sup>. In practice we restrict ourselves to diagonal precision matrices, Λ<sub><italic>k</italic></sub> = diag(<bold>λ<sub><italic>k</italic></sub></bold>).</p>
<p>Given the assumption <xref ref-type="disp-formula" rid="pcbi.1006895.e011">Eq 8</xref>, we can then write the evolution of <italic>g</italic><sub><italic>t</italic></sub> as a mixture of <italic>K</italic> terms, each of which takes the form
<disp-formula id="pcbi.1006895.e013"><alternatives><graphic id="pcbi.1006895.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∝</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>β</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:mo>[</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msubsup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:mfrac><mml:msub><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>j</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mn>2</mml:mn></mml:mfrac> <mml:msubsup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>]</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <italic>j</italic> indexes the dimensions of <italic>g</italic>. From this, it is clear that the conditional distribution of <italic>g</italic><sub><italic>t</italic></sub> is itself a mixture of Gaussians, which suggests the following method for sampling future goals:
<disp-formula id="pcbi.1006895.e014"><alternatives><graphic id="pcbi.1006895.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>k</mml:mi></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Categorical</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">w</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>g</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mfrac><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where all multiplications and divisions by <italic>μ</italic><sub><italic>k</italic></sub> and λ<sub><italic>k</italic></sub> are elementwise. That is, conditioned on previous goal position, sampling a new goal can be done by first sampling a particular component index <italic>k</italic>, then sampling from a Gaussian that interpolates between the kinetic and potential terms of the energy.</p>
<p>Clearly, assuming that <italic>e</italic><sup><italic>V</italic></sup> is a GMM at every time requires specifying (2<italic>D</italic> + 1)<italic>KT</italic> parameters per agent for <italic>μ</italic><sub><italic>tkj</italic></sub>, λ<sub><italic>tkj</italic></sub>, and <italic>w</italic><sub><italic>tk</italic></sub>, which can easily lead to overfitting. In our model, we contrain the form of <italic>V</italic> by requiring that these parameters are the outputs of a single neural network that takes the current state as its input: (<italic>μ</italic><sub><italic>kj</italic></sub>, λ<sub><italic>kj</italic></sub>, <italic>w</italic><sub><italic>k</italic></sub>)<sub><italic>t</italic></sub> = NN(<italic>s</italic><sub><italic>t</italic></sub>). In practice, the outputs of the network are unconstrained, with the tensor entries corresponding to λ and <italic>w</italic> subsequently passed through softplus and softmax functions (respectively) to ensure λ &gt; 0 and ∑<sub><italic>k</italic></sub> <italic>w</italic><sub><italic>k</italic></sub> = 1.</p>
</sec>
</sec>
<sec id="sec012">
<title>Initial conditions</title>
<p>Let <italic>t</italic> = 1 be the time of the first observed data, <italic>y</italic><sub>1</sub>. In order to calculate <italic>y</italic><sub>2</sub> using <xref ref-type="disp-formula" rid="pcbi.1006895.e004">Eq 2</xref>, we need <italic>u</italic><sub>1</sub>, which from <xref ref-type="disp-formula" rid="pcbi.1006895.e005">Eq 3</xref> requires <italic>u</italic><sub>0</sub>, <italic>e</italic><sub>1</sub>, <italic>e</italic><sub>0</sub>, and <italic>e</italic><sub>−1</sub>. (Recall that it is the joystick position <italic>υ</italic><sub>1</sub> that is observed; <italic>u</italic><sub>1</sub> is latent).</p>
<p>We bootstrap this process by assuming the following:</p>
<list list-type="order">
<list-item>
<p><italic>y</italic><sub><italic>t</italic>≤0</sub> = <italic>y</italic><sub>init</sub>, the vector of initial positions of both players.</p>
</list-item>
<list-item>
<p>For <italic>t</italic> &lt; 0, <italic>g</italic><sub><italic>t</italic>&lt;0</sub> = <italic>y</italic><sub>0</sub>, so there was no control error (<italic>e</italic><sub><italic>t</italic>&lt;0</sub> = 0) and thus no control (<italic>u</italic><sub><italic>t</italic>&lt;0</sub> = 0).</p>
</list-item>
<list-item>
<p><italic>g</italic><sub>0</sub> ∼ GMM(<italic>K</italic><sub>0</sub>). That is, the initial goal is drawn from a Gaussian mixture model with <italic>K</italic><sub>0</sub> components. In our case, these component Gaussians, like those defining <xref ref-type="disp-formula" rid="pcbi.1006895.e011">Eq 8</xref>, have diagonal covariance.</p>
</list-item>
<list-item>
<p>From point 2 above, <italic>e</italic><sub>−2</sub> = <italic>e</italic><sub>−1</sub> = 0. Using <italic>e</italic><sub>0</sub> = <italic>g</italic><sub>0</sub>−<italic>y</italic><sub>0</sub> then gives <italic>u</italic><sub>0</sub> via <xref ref-type="disp-formula" rid="pcbi.1006895.e005">Eq 3</xref>.</p>
</list-item>
<list-item>
<p>Using <xref ref-type="disp-formula" rid="pcbi.1006895.e014">Eq 10</xref> and <italic>g</italic><sub>0</sub>, we can then draw <italic>g</italic><sub>1</sub> and calculate <italic>e</italic><sub>1</sub> = <italic>g</italic><sub>1</sub> − <italic>y</italic><sub>1</sub>. From <xref ref-type="disp-formula" rid="pcbi.1006895.e005">Eq 3</xref>, it is then possible to calculate <italic>u</italic><sub>1</sub> and thus <italic>y</italic><sub>2</sub>.</p>
</list-item>
</list>
<p>All future data points can then be calculated via the steps outlined above.</p>
</sec>
<sec id="sec013">
<title>Inference</title>
<p>Given the observed system trajectory <italic>y</italic><sub><italic>t</italic></sub>, we would like to infer the underlying goal trajectory <italic>g</italic><sub><italic>t</italic></sub>. In general, full Bayesian inference is intractable, but we employ a variational Bayes (VB) approach [<xref ref-type="bibr" rid="pcbi.1006895.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref021">21</xref>] that approximates this procedure. In brief, VB attempts to minimize the Kullback-Leibler divergence (a measure of difference between distributions) between a known generative model for which inference is intractable, <inline-formula id="pcbi.1006895.e015"><alternatives><graphic id="pcbi.1006895.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>,</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and an approximating family of posterior distributions, <italic>q</italic>(<italic>z</italic>). This is equivalent to maximizing an evidence lower bound (ELBO) given by
<disp-formula id="pcbi.1006895.e016"><alternatives><graphic id="pcbi.1006895.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>,</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi mathvariant="script">H</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
with <inline-formula id="pcbi.1006895.e017"><alternatives><graphic id="pcbi.1006895.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mi mathvariant="script">H</mml:mi> <mml:mo>[</mml:mo> <mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> the entropy of the approximating posterior. That is, inference is transformed into an optimization problem in the parameters of the approximate posterior <italic>q</italic>(<italic>z</italic>), amenable to solution by gradient ascent. In our model, we make use of so-called “black box” methods [<xref ref-type="bibr" rid="pcbi.1006895.ref022">22</xref>–<xref ref-type="bibr" rid="pcbi.1006895.ref025">25</xref>] in which the gradients of the ELBO are replaced with stochastic approximations derived by sampling from <italic>q</italic>(<italic>z</italic>), avoiding often difficult computations of the expectation in <xref ref-type="disp-formula" rid="pcbi.1006895.e016">Eq 11</xref>. Thus our only requirement for the recognition model is that we be able to sample <italic>z</italic><sub>*</sub> ∼ <italic>q</italic>(<italic>z</italic>) and to compute log <italic>q</italic>(<italic>z</italic><sub>*</sub>).</p>
<p>In our case, we begin with the generative model specified by <xref ref-type="disp-formula" rid="pcbi.1006895.e008">Eq 6</xref>. For the approximate posterior <italic>q</italic>(<italic>g</italic>|<italic>y</italic>), we use the variational latent dynamical system (VLDS) model of [<xref ref-type="bibr" rid="pcbi.1006895.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref027">27</xref>]. (We are not interested in the posterior over <italic>u</italic> and implicitly marginalize over it). The VLDS is a nonlinear generalization of the linear state space model, implying that inference in the model is a generalization of the Kalman filter. It uses neural networks to flexibly parameterize the mean and covariance of the underlying time series, which are assumed to change dynamically. As in [<xref ref-type="bibr" rid="pcbi.1006895.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref025">25</xref>], samples from this posterior are then used to update <italic>both</italic> the parameters of the generative model (<italic>L</italic>, <italic>ϵ</italic>, <italic>σ</italic>, <italic>μ</italic>, λ, <italic>w</italic>) and the parameters of the approximate posterior <italic>q</italic> via gradient ascent.</p>
<sec id="sec014">
<title>Training</title>
<p>We implemented our model in TensorFlow (<ext-link ext-link-type="uri" xlink:href="https://www.tensorflow.org" xlink:type="simple">https://www.tensorflow.org</ext-link>) using the Edward probabilistic programming framework [<xref ref-type="bibr" rid="pcbi.1006895.ref028">28</xref>] (<ext-link ext-link-type="uri" xlink:href="http://www.edwardlib.org" xlink:type="simple">http://www.edwardlib.org</ext-link>). For the generative model of each agent, we set <italic>K</italic> = <italic>K</italic><sub>0</sub> = 20 and used a feed-forward neural network consisting of two 128-unit hidden layers with ReLU (Rectified Linear Unit) activation and a 128-unit dense output layer. For the posterior of <italic>g</italic>, we used a three-layer neural network with 64 units in each layer for the mean and two networks of the same structure for Cholesky factors of the diagonal and off-diagonal blocks of covariance matrices. We initialized all the weights in neural networks with Glorot uniform initializer [<xref ref-type="bibr" rid="pcbi.1006895.ref029">29</xref>] and all the biases with zeros. We fit the model using ADAM [<xref ref-type="bibr" rid="pcbi.1006895.ref030">30</xref>] with an initial learning rate of 10<sup>−3</sup>. To avoid overfitting, we held out 15% of the data (∼1300 trials) as a test set to check model fitting and to estimate the evidence lower bound. All model comparisons were performed on this test set.</p>
<p>To deal with the fact that the deterministic part of our control model, <xref ref-type="disp-formula" rid="pcbi.1006895.e006">Eq 4</xref>, allows a solution <italic>g</italic> for any given <italic>L</italic>, and to encourage solutions near proportional control, we trained for an initial period of 30 epochs with the control parameters fixed to pure proportional control ((<italic>K</italic><sub><italic>p</italic></sub>, <italic>K</italic><sub><italic>i</italic></sub>, <italic>K</italic><sub><italic>d</italic></sub>) = (1, 0, 0)). Following this, we allowed the control parameters to vary and trained for a subsequent 500 epochs, during which the percent change in a smoothed version of the ELBO dropped below 1% and parameter values stabilized.</p>
<p>For hyperparameter training we fixed <italic>σ</italic> ∼ 10<sup>−3</sup> and regularized <italic>ϵ</italic> by including a penalty term −<italic>ρϵ</italic> with <italic>ρ</italic> = 10<sup>5</sup> (equivalent to an exponential prior) to the ELBO. As described above, when joystick inputs were near the end of their physical range, control and goal estimates could exhibit large variation due to inversion of the tanh function. We regularized this by including a hinge loss that linearly penalized modes of the GMM when they exceeded the game area by 50% in any direction. (The performance of the model without this penalty can be found in <xref ref-type="supplementary-material" rid="pcbi.1006895.s001">S1 Fig</xref>). Finally, we regularized Gaussian components of the GMM by penalizing those with very large standard deviation. That is, we added a penalty −<italic>γ</italic>/λ<sub><italic>kt</italic></sub> with <italic>γ</italic> = .1 at each time point, which is equivalent to placing an exponential prior on the variance.</p>
</sec>
</sec>
<sec id="sec015">
<title>Change point analysis</title>
<p>We used the number of change points in the puck trajectory as a rough measure of the each player’s strategic complexity. Specifically, a time point <italic>t</italic> is a change point for a player if sign(<italic>υ</italic><sub><italic>t</italic></sub>) ≠ sign(<italic>υ</italic><sub><italic>t</italic>+1</sub>), <italic>υ</italic><sub><italic>t</italic></sub>, <italic>υ</italic><sub><italic>t</italic>+1</sub> ≠ 0, and |<italic>υ</italic><sub><italic>t</italic></sub> − <italic>υ</italic><sub><italic>t</italic>+1</sub>| ≥ 10<sup>−6</sup>. That is, joystick input changes sign, is nonzero both before and after the change point, and the difference exceeds a minimal value. We studied the correlation between number of change points and game results at both the trial and session level. To avoid over-identification of change points due to frequent variation in control signals, all trials were smoothed by the same Gaussian filter described in Data section before this analysis. We also excluded the first and last five time points to minimize edge effects.</p>
</sec>
<sec id="sec016">
<title>Statistical testing</title>
<p>For testing autocorrelation functions, we applied the Ljung-Box test to the autocorrelation function calculated on each session. For initial velocities, we discarded periods of non-movement at the start of the trial, selecting instead the velocity at the first time point where the norm of the velocity exceeded 0.001. For analyzing whether outcomes of consecutive trials were correlated, we used Fisher’s Exact Test on game results (summarized by a 2 × 2 contingency table of win/loss of <italic>t</italic><sup>th</sup> and (<italic>t</italic> + 1)<sup>th</sup> trials) by session. We corrected for multiple comparisons via Bonferroni correction to ensure a family-wise false positive rate of 1%.</p>
</sec>
</sec>
<sec id="sec017" sec-type="results">
<title>Results</title>
<sec id="sec018">
<title>Player tendencies</title>
<p>While players’ behavior was highly variable across trials and sessions (<xref ref-type="fig" rid="pcbi.1006895.g002">Fig 2A</xref>), blockwise adjustments to players’ maximum velocity kept win rates similar across players (<xref ref-type="fig" rid="pcbi.1006895.g002">Fig 2B</xref>). Likewise, the likelihood of a win was independent of whether the previous trial was a win or a loss (<italic>N</italic> = 4/120 sessions significant for dependence; Fisher’s Exact Test for independence; <italic>α</italic> = 0.01), suggesting little in the way of a “win-stay, lose-shift” or “hot hand” effect (<xref ref-type="fig" rid="pcbi.1006895.g002">Fig 2C</xref>). Moreover, while players’ initial velocities tended to cluster, their final positions were more evently distributed (<xref ref-type="fig" rid="pcbi.1006895.g002">Fig 2D and 2E</xref>). That is, players appeared to mix their play effectively. We found that initial velocities and final positions were only weakly autocorrelated (<italic>v</italic><sub>0<italic>x</italic>,shooter</sub> = 4/120, <italic>v</italic><sub>0<italic>y</italic>,shooter</sub> = 17/120, <italic>y</italic><sub><italic>f</italic>,goalie</sub> = 21/120, <italic>y</italic><sub><italic>f</italic>,shooter</sub> = 31/120 sessions significant; Ljung-Box test for autocorrelation at lag 1; <italic>α</italic> = 0.01 controlled for family-wise error rate) (<xref ref-type="fig" rid="pcbi.1006895.g002">Fig 2F</xref>), indicating that there was little strategic carryover across trials. In summary, while significant complexity and variation in play is apparent, this variation was not well captured by typical metrics derived from games with discrete action spaces.</p>
<fig id="pcbi.1006895.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006895.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Variability in player behavior.</title>
<p>A: Example trajectories from a single shooter, illustrating the diversity of player movements. B: Percentage of trials won by shooter for each behavioral session. Colors indicate shooter identity. Task parameters (puck speed, goalie size) were altered on a per-session basis to balance game play between players. C: Correlations in game outcome. Scatter plot of the probability of a shooter win as a function of shooter win or loss on the previous trial. Each dot represents one behavioral session. Colors indicate shooter identity. Game outcomes did not differ markedly following wins or losses. D: Distribution of initial velocities over all shooters. Shooters tended to start by moving immediately rightward, toward the goal line, or directly downward. E: Distribution of final vertical positions. Final goalie positions were peaked around 0 and either end of the screen, while shooter final positions were more evenly distributed over the game space. F: Autocorrelation in initial movement and final position across trials. Shooters’ initial movement direction and both players’ final vertical positions exhibited weak correlation across trials, indicative of short-term patterns in strategy. Curves are averages across behavioral sessions. Colors indicate variable.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>A generative model of player behavior</title>
<p>Because play in the penalty shot task is fundamentally dynamic and interactive, it is resistant to conventional models based on either discrete action spaces or simple heuristics. Instead, we opted to model player behavior as arising from two pieces: first, a dynamic goal model that encoded each player’s desired onscreen location as a function of both players’ instantaneous positions and velocities; and second, a control model that used these goals as its set points and produced joystick movement (<xref ref-type="fig" rid="pcbi.1006895.g003">Fig 3</xref>). Goals evolved dynamically with the game. This was captured in the model by a “value function” that at each moment drew each player’s desired onscreen location toward areas of high value and away from those of low energy. (This is not the same as the value function in reinforcement learning, which sums all future rewards. Our <italic>V</italic> is more closely related to policy than expected value). For example, with the goalie at the upper edge of the screen, the energy function for the puck is expected to be low at the lower edge of the screen. However, it is important to note that energy functions for each player were separate. While both made use of explicit information from both players (positions and velocities), each player’s goals were private (i.e., independent of one another given current game state).</p>
<fig id="pcbi.1006895.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006895.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Model architecture.</title>
<p>Observable trajectories <italic>y</italic><sub><italic>t</italic></sub> are generated sequentially from control signals <italic>u</italic><sub><italic>t</italic></sub>, which in turn derive from goals <italic>g</italic><sub><italic>t</italic></sub>. In the generative model, evolution of goals is determined by a Gaussian mixture model whose parameters are given by the output of a neural network using state variables <italic>s</italic><sub><italic>t</italic></sub> as input. The recognition model takes in the lagged history of <italic>y</italic><sub><italic>t</italic></sub> and returns posterior samples of the goals.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.g003" xlink:type="simple"/>
</fig>
<p>We trained this model using all behavioral sessions of the task as input. To account for variation in play across the experiment, we included a term that increased linearly as a function of session, as well as additional variables encoding experimental conditions (see <xref ref-type="sec" rid="sec002">Methods</xref>). <xref ref-type="fig" rid="pcbi.1006895.g004">Fig 4</xref> shows results from a restricted model using only the last ten sessions of data from a single shooter. Not only is the model able to produce accurate one-step-ahead predictions of the control signal (<xref ref-type="fig" rid="pcbi.1006895.g004">Fig 4A</xref>) and its derivative (<xref ref-type="fig" rid="pcbi.1006895.g004">Fig 4B</xref>), it is able to generate synthetic data that capture the rich behavioral repertoire exhibited by real players (<xref ref-type="fig" rid="pcbi.1006895.g004">Fig 4C and 4D</xref>).</p>
<fig id="pcbi.1006895.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006895.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Model fits and generated data.</title>
<p>A: Actual control signals for both coordinates of puck (blue) and bar (red) for a single trial in the holdout set. B: Model predictions for control signals at the next time step given real data up to the current time. The fitted model’s predictions control closely track the real data. C, D: Plots of actual control derivatives and model-predicted derivatives for the same trial. On this scale, deviations become more apparent, but the model still closely fits the data. In both cases, model fits reflect the accuracy of the posterior map, not necessarily the generative model. E: Real puck trajectories (n = 500) drawn from a model fit to the last ten sessions of the experiment (only trials that last less than <inline-formula id="pcbi.1006895.e018"><alternatives><graphic id="pcbi.1006895.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mfrac><mml:mn>25</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are displayed, though longer trials were included in training). F: Puck trajectories (n = 500) generated from the model (only trials that last less than <inline-formula id="pcbi.1006895.e019"><alternatives><graphic id="pcbi.1006895.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mfrac><mml:mn>25</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are displayed). The model has accurately captured the qualitative features of real play.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.g004" xlink:type="simple"/>
</fig>
<p>To assess the utility of our inferred goals as a construct, we next asked whether these goals contained predictive information about gross strategic behavior. To do so, we used a simple linear regression of final puck vertical position against goal position at each moment of each trial and calculated the coefficient of determination (<italic>R</italic><sup>2</sup>) as a function of time in trial. <xref ref-type="fig" rid="pcbi.1006895.g005">Fig 5</xref> shows this function time-locked to both the beginning and end of trial. For comparison, we repeated the same analysis using two other predictors, the puck’s instantaneous velocity and the shooter’s eye position. We found that the shooter’s goal became more predictive than the puck’s velocity within the first 0.5s of the trial (<xref ref-type="fig" rid="pcbi.1006895.g005">Fig 5A</xref>) and remained the most predictive of the three variables until the last 0.3s of the trial, when it was overtaken by gaze (<xref ref-type="fig" rid="pcbi.1006895.g005">Fig 5B</xref>). As might be expected, gaze becomes the most predictive single variable late in trial (players attend to the location where the outcome will be determined), while variables like velocity and goal, which only influence position after a lag, become slightly less accurate. Moreover, while state, comprising both the players’ positions and velocities, is more predictive than any single variable, including gaze, adding goal information to state information does improve predictive performance (<xref ref-type="fig" rid="pcbi.1006895.g005">Fig 5C and 5D</xref>). This rough analysis is thus consistent with the idea that our inferred goals provide information not contained in state and can be treated as a latent measure of momentary player intentions.</p>
<fig id="pcbi.1006895.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006895.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Inferred goals predict game endpoints.</title>
<p>A, B: Predictive power (as measured by <italic>R</italic><sup>2</sup>) for a model predicting final puck position as a function of either shooter gaze position, instantaneous velocity, game state, or inferred goal. C, D: Predictive power for a model predicting final puck position as a function of all variables with or without inferred goals. A, C: Aligned to trial start. B, D: Aligned to trial end. Game states consistently outperform the other variables. Inferred goals are just as predictive as the velocity of movement for the first 0.4s, but become more predictive thereafter. They remain more predictive than either measure until 0.3s before trial end, when gaze becomes a better predictor. In general, including inferred goal states in the model enhances the predictive power.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec020">
<title>Model comparison</title>
<p>Our assumption of a Gaussian mixture parameterized by neural networks in <xref ref-type="disp-formula" rid="pcbi.1006895.e011">Eq 8</xref> is a highly flexible one, raising the question of whether our model simply memorizes trajectories or whether a simpler set of assumptions might do. <xref ref-type="fig" rid="pcbi.1006895.g006">Fig 6</xref> shows the results of comparing our model to two simpler variants on tests of trial generation and trial completion. The first comparison model assumes the same neural network structure but with a single Gaussian output distribution at each time <italic>t</italic>:
<disp-formula id="pcbi.1006895.e020"><alternatives><graphic id="pcbi.1006895.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>V</mml:mi> <mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>∝</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>-</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>⊤</mml:mi></mml:msup> <mml:mo>·</mml:mo> <mml:mo>Λ</mml:mo> <mml:mo>·</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>g</mml:mi> <mml:mo>-</mml:mo> <mml:mi>μ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mfrac><mml:mrow><mml:mo>|</mml:mo> <mml:mo>Λ</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula></p>
<fig id="pcbi.1006895.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006895.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Model comparison.</title>
<p>A: Difference between actual and predicted control derivatives for a trial (the one in <xref ref-type="fig" rid="pcbi.1006895.g004">Fig 4</xref>) in all three observed dimensions in the proposed model. B: Puck trajectories (n = 100) generated from the proposed model (only trials that last less than <inline-formula id="pcbi.1006895.e023"><alternatives><graphic id="pcbi.1006895.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mfrac><mml:mn>25</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are displayed). C: Completed trajectories (n = 100) by the proposed model from <inline-formula id="pcbi.1006895.e024"><alternatives><graphic id="pcbi.1006895.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mfrac><mml:mn>7</mml:mn> <mml:mn>15</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> of a trial in the holdout set (only trials that last less than <inline-formula id="pcbi.1006895.e025"><alternatives><graphic id="pcbi.1006895.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mfrac><mml:mn>25</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are displayed). D, E, F: the same figures based on the model with single Gaussian distribution. G, H, I: the same figures based on the linear model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.g006" xlink:type="simple"/>
</fig>
<p>The other comparison model uses a linear function in place of a neural network to model the dependency of goals on state:
<disp-formula id="pcbi.1006895.e021"><alternatives><graphic id="pcbi.1006895.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>λ</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mtext>softplus</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>w</mml:mi> <mml:mi>t</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mtext>softmax</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>W</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
where {(<italic>W</italic><sub>1</sub>, <italic>b</italic><sub>1</sub>), (<italic>W</italic><sub>2</sub>, <italic>b</italic><sub>2</sub>), (<italic>W</italic><sub>3</sub>, <italic>b</italic><sub>3</sub>)} are weights and biases, softplus(<italic>x</italic>) = log(1 + <italic>e</italic><sup><italic>x</italic></sup>), and <inline-formula id="pcbi.1006895.e022"><alternatives><graphic id="pcbi.1006895.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mtext>softmax</mml:mtext> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msup> <mml:mo>/</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>We trained all three models on the same dataset with the same hyperparameters and stopping criteria specified above and then compared their performances on fitting control signals and derivatives, generating new data, and completing trials. Our model outperformed the two candidates in all three aspects: the approximate posterior for our model yields the overall smallest prediction error (<xref ref-type="fig" rid="pcbi.1006895.g006">Fig 6A, 6D and 6G</xref>); the generated trajectories resemble the real ones the most closely (<xref ref-type="fig" rid="pcbi.1006895.g006">Fig 6B, 6E and 6H</xref>); and trial completion for the neural network GMM demonstrates the most diversity (<xref ref-type="fig" rid="pcbi.1006895.g006">Fig 6C, 6F and 6I</xref>). That is, the simpler models proved either insufficiently flexible to capture regularities in the data, resulted in quasi-deterministic behavioral policies, or both.</p>
</sec>
<sec id="sec021">
<title>Simulation experiments via generative modeling</title>
<p>By adopting a generative modeling approach along with a flexible class of parameterized functions (neural networks), we have shown that our model can capture the variability present in real data (<xref ref-type="fig" rid="pcbi.1006895.g004">Fig 4F</xref>). An additional benefit of such an approach is that our model can then be used as a simulator for purposes of running controlled experiments. These “counterfactual” simulations allow us to systematically vary task parameters and states to explore the responses of the trained model in configurations only sparsely covered by actual data.</p>
<p>Here, to illustrate the potential of this approach, we performed a simple experiment to explore the effects of goal states on trial outcomes. If, as we claim, goals capture players’ latent targets as a function of changing game state, then altering goals should change subsequent game play. To check this, we fixed a time point midway through a specific trial and performed a series of trial completion experiments (<xref ref-type="fig" rid="pcbi.1006895.g007">Fig 7</xref>). In one set of experiments, the goalie’s goal is fixed to the lower corner of the screen (<xref ref-type="fig" rid="pcbi.1006895.g007">Fig 7A</xref>, red X), while in the other, it is fixed in the upper corner of the screen (<xref ref-type="fig" rid="pcbi.1006895.g007">Fig 7B</xref>, red X). In both cases, the shooter’s goals are allowed to evolve normally, and the goalie’s goals are allowed to move normally after the first time point of the trial completion.</p>
<fig id="pcbi.1006895.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006895.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Effects of goal states.</title>
<p>A: Completed puck trajectories (n = 200) for the trial in <xref ref-type="fig" rid="pcbi.1006895.g006">Fig 6C</xref> with the goal state at <inline-formula id="pcbi.1006895.e026"><alternatives><graphic id="pcbi.1006895.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mfrac><mml:mn>7</mml:mn> <mml:mn>15</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> for goalie is set at the bottom of the screen (only trials that last less than <inline-formula id="pcbi.1006895.e027"><alternatives><graphic id="pcbi.1006895.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mfrac><mml:mn>25</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are displayed). B: Completed puck trajectories (n = 200) for the same trial with the goal state at <inline-formula id="pcbi.1006895.e028"><alternatives><graphic id="pcbi.1006895.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mfrac><mml:mn>7</mml:mn> <mml:mn>15</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> for goalie is set at the top of the screen (only trials that last less than <inline-formula id="pcbi.1006895.e029"><alternatives><graphic id="pcbi.1006895.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mfrac><mml:mn>25</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are displayed).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.g007" xlink:type="simple"/>
</fig>
<p>As <xref ref-type="fig" rid="pcbi.1006895.g007">Fig 7</xref> illustrates, subsequent play is a product not only of initial goals, but of players’ co-evolving control strategies. As one expects, when the goalie’s initial goal is downward, the shooter compensates by moving the puck upward; when the goalie’s initial goal is upward, the shooter steers the puck down. However, what is more interesting to note is the subsequent trial outcomes: in <xref ref-type="fig" rid="pcbi.1006895.g007">Fig 7A</xref>, more extreme puck trajectories result in losses (orange), since these more clearly signal the shooter’s intention and prompt the goalie to reverse direction more quickly. Likewise, in <xref ref-type="fig" rid="pcbi.1006895.g007">Fig 7B</xref>, earlier downturns in puck trajectory also result in losses. In both cases, the initial goal is rapidly reversed from its location at the start of the simulation, while less extreme or more ambiguous trajectories are likelier to result in wins (blue). Thus, the results of our simple experiment suggest both that the model has done more than simply memorizing trajectories and that it can be used to answer “what if” questions via simulation.</p>
</sec>
<sec id="sec022">
<title>Quantifying strategic complexity</title>
<p>Since, as we have argued, players’ inferred goals constitute a moment-by-moment representation of strategic intention, and since the evolution of these goals is governed by each player’s value function <italic>V</italic>(<italic>g</italic>, <italic>s</italic>) (<xref ref-type="disp-formula" rid="pcbi.1006895.e009">Eq 7</xref>), these components of our model are ultimately responsible for capturing the richness of players’ interactions. For instance, at a fixed time <italic>t</italic> in the trial, the structure of <italic>V</italic>(<italic>g</italic><sub><italic>t</italic></sub>, <italic>s</italic><sub><italic>t</italic></sub>) determines whether a player’s trajectories fall into groups that will split or merge, how variable the trajectories are within each group, and thus how complex the shooter’s corresponding strategy is.</p>
<p>
<xref ref-type="fig" rid="pcbi.1006895.g008">Fig 8A</xref> depicts this strategic complexity at a moment midway through the trial. With the puck moving upward, the shooter’s value function (blue) is highest at a cluster of points spread vertically to the left of the goal line, indicating that the goals are pulled in that direction. Likewise, the value function for the goalie (red) is concentrated above the current vertical position of the puck, suggesting a tendency to follow its movement. As the form of these value distributions changes, so does the variability of the resulting trajectories.</p>
<fig id="pcbi.1006895.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006895.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Number of change points as a measure of strategic complexity.</title>
<p>A: At a given game state, each player’s energy function (blue, shooter; red, goalie) captures the evolution of his goal in the next time step. Here, the goalie’s energy function is unimodal, while the shooter’s energy function consists of a tightly clustered handful of potential targets. Gray area indicates the visible screen (game area) during the task. White indicates offscreen regions. We use the number of change points in each player’s control signal as a proxy for this complexity. B, C: Histograms of change points for all trials (B) and session means (C) for both players. D: Evolution of strategic complexity across sessions. Over the course of the experiment, the average number of shooters’ change points per trial increased. E, F: Correlation of average number of change points of shooter (E) and goalie (F) with shooter’s win rates. Each dot indicates a single session. Both shooters and goalies benefited from more change points.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.g008" xlink:type="simple"/>
</fig>
<p>To quantify this strategic complexity, we considered the number of direction changes (change points) in each player’s trajectory on each trial. With this definition of complexity, we see that variation in strategic complexity exists at both the trial (<xref ref-type="fig" rid="pcbi.1006895.g008">Fig 8B</xref>) and session level (<xref ref-type="fig" rid="pcbi.1006895.g008">Fig 8C</xref>). A one-way ANOVA shows significant differences across sessions for both shooters(<italic>F</italic><sub>119,59764</sub> = 128.950, <italic>p</italic> &lt; 1.0 × 10<sup>−6</sup>) and goalies (<italic>F</italic><sub>119,59764</sub> = 216.990, <italic>p</italic> &lt; 1.0 × 10<sup>−6</sup>). Moreover, the average number of shooter change points shows a weakly increasing trend across sessions (<xref ref-type="fig" rid="pcbi.1006895.g008">Fig 8D</xref>; <italic>β</italic> = 0.00735/session, Wald test <italic>p</italic> = 4.123 × 10<sup>−8</sup>), indicating that players adopted more complex strategies over time. As one would expect, an increase in number of change points, corresponding to an increase in the variability of trajectories, translates to an increase in win rate for both shooters (<xref ref-type="fig" rid="pcbi.1006895.g008">Fig 8E</xref>; <italic>β</italic> = 4.793%/change point, Wald test <italic>p</italic> = 3.381 × 10<sup>−3</sup>) and goalies (<xref ref-type="fig" rid="pcbi.1006895.g008">Fig 8F</xref>; <italic>β</italic> = 3.695%/change point, Wald test <italic>p</italic> = 8.896 × 10<sup>−4</sup>). Thus, players’ strategic complexity, as measured by the number of change points, can serve as a useful metric for evaluating player behavior.</p>
</sec>
</sec>
<sec id="sec023" sec-type="conclusions">
<title>Discussion</title>
<p>In natural contexts, particularly social ones, decisions are made in real time and in response to continuously changing circumstances. Whereas most social tasks in neuroscience have focused on two-player games with sequential moves and small action spaces [<xref ref-type="bibr" rid="pcbi.1006895.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref031">31</xref>–<xref ref-type="bibr" rid="pcbi.1006895.ref034">34</xref>], here we have demonstrated that tasks in which opponents make decisions online, in real-time, are likewise amenable to principled computational analysis. The virtues of such tasks are many: greater ethological validity, greater involvement of sensory and motor systems typically involved in the decision process [<xref ref-type="bibr" rid="pcbi.1006895.ref035">35</xref>–<xref ref-type="bibr" rid="pcbi.1006895.ref037">37</xref>], and dynamics better aligned with the timescales of most neural circuits.</p>
<p>Nonetheless, nothing about our model presumes that the task is social (nor tests whether it is). We do not explicitly model players’ beliefs about one another, bounded rationality, or theory of mind [<xref ref-type="bibr" rid="pcbi.1006895.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref039">39</xref>]. Some of these constructs may be implicit in our estimated value function, but teasing them apart is a topic for future work. As it stands, our model is empirical and agnostic as to the degree to which players model one another. This bears some similarity to work in differential game theory, which has established conditions under which moving target pursuit tasks like ours possess optimal solutions, as well as the expected values for each player under those strategies. [<xref ref-type="bibr" rid="pcbi.1006895.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref041">41</xref>] As in that literature, we have adopted control theory as a guiding framework, with our control policies determined by <italic>V</italic>(<italic>g</italic>|<italic>s</italic>). In addition, we have made the simplifying assumption common to differential game analysis that players are coupled only through observable states <italic>s</italic>. Here, however, we limit ourselves to modeling players’ adopted strategies, without regard to whether or not these are optimal.</p>
<p>Our model is, in effect, learning a complex control policy in a six-dimensional state space. This policy differs among the individuals in the study and, as the result of a statistical fitting process, is unlikely to be successfully extrapolated to regions of state space in which no training data exist. It would be impressive if one were, for example, to omit all trials with an initial upward puck movement from the training data and later predict them from a model trained on the rest, but given the lack of symmetry along the vertical axis in the actual trials, we suspect this is simply not possible. Still, we have demonstrated that despite the richer data resulting from our task, our scalable Bayesian inference approach is sufficient to address the resulting analysis challenge. We believe our model provides a useful distillation of the data in terms of more intuitive variables, and that these variables contain some predictive and internal validity. Likewise, our choice of a probabilistic generative model for the data (as opposed to a discriminative model like a classifier) offers two key advantages: First, as a test of our model’s goodness of fit, we are able to generate synthetic data that capture much of the complexity observed in real data. So-called posterior predictive checks offer a higher level of confidence that models are detailed enough to account for variations in the data and not simply the best among poor alternatives [<xref ref-type="bibr" rid="pcbi.1006895.ref042">42</xref>]. Second, because our model uses only data from onscreen and the recent past in generating synthetic trials, it is capable of serving as an artificial opponent in future experiments. Such a model could be trained to reproduce the play of a particular opponent, allowing for an experiment in which the distinction is not between a conspecific and an unrelated computer algorithm, but between a conspecific and an algorithm with an indistinguishable style of play. Such contrasts are crucial for teasing apart differences specific to the social context [<xref ref-type="bibr" rid="pcbi.1006895.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1006895.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1006895.ref014">14</xref>].</p>
<p>Moreover, our model succeeds in separating out details of the motor execution of the task (physics model, control model) from the dynamics of latent goals that forms the core construct of interest. For neural data with high temporal resolution, instantaneous measures of such quantities as intention, expected value, and strategic complexity—likely correlated with decision difficulty or cost of control [<xref ref-type="bibr" rid="pcbi.1006895.ref043">43</xref>]—are valuable as potential correlates of local circuit activity. As we have shown, variables like these are able to differentiate between trials, sessions, and players where more coarse-grained metrics cannot.</p>
<p>Finally, while the current model is broadly applicable to any time series data that can be viewed as arising from control applied to a dynamic set point, several worthwhile extensions are possible: First, we have not adequately treated the problem of censoring of the control signal. That is, the joystick position is a truncated version of each player’s desired control signal. A more natural model would model and correct for the resulting missing data. Second, we have modeled the value function that drives changes in goal as a mixture of Gaussians at each time step. While this proved adequate for our purposes, it would be natural to consider an extension in which this function is replaced by a Hidden Markov Model (or hierarchical HMM) with Gaussian observations, so that trials are generated by goals that follow a single mode (perhaps corresponding to a substrategy) for short periods of time.</p>
<sec id="sec024">
<title>Conclusion</title>
<p>The study of complex strategic decisions, especially social decisions, demands experimental paradigms that replicate this complexity. Here, we have introduced a two-player computerized task, Penalty Shot, that requires real-time behavioral adjustment and facilitates strategic variation. Not only do pairs of rhesus macaques readily learn the game, they exhibit individual playing styles and complex patterns of interactive play. By using a generative modeling approach that leverages approximate Bayesian inference and modern gradient-based training methods, we have shown that it is possible to capture this variability and produce moment-by-moment estimates of latent intentions and strategic complexity suitable for correlation with neural data. These results open new possibilities for the analysis of dynamic behavior and its associated neural data and have implications for the study of social behavior.</p>
</sec>
</sec>
<sec id="sec025">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006895.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Without regularization, goals far exceed game area.</title>
<p>A: Difference between actual and predicted control derivatives for the same trial analyzed in the Model comparison section. B: Predicted goal states in all three observed dimensions. C: At 0.5s, both players’ energy functions (blue, shooter; red, goalie) based on this model are far off the game arena (gray).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006895.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Model comparison: Trial completion.</title>
<p>For 10 random trials in the validation data set, we completed trajectories (n = 100) using the proposed model, the single Gaussian model, and the linear model. The actual trajectories are in black, and the completed ones are in blue. Only trials that last less than <inline-formula id="pcbi.1006895.e030"><alternatives><graphic id="pcbi.1006895.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006895.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mfrac><mml:mn>25</mml:mn> <mml:mn>6</mml:mn></mml:mfrac> <mml:mtext>s</mml:mtext></mml:math></alternatives></inline-formula> are displayed except the single Gaussian model.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006895.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Generated trials matched with actual trials.</title>
<p>For 30 random trajectories generated by our model, we located and plotted the closest 20 trials (in mean-squared state space error) in the training data set. The generated trajectories are in black and the matched ones are in blue (the most similar one in orange).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006895.s004" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.s004" xlink:type="simple">
<label>S1 Video</label>
<caption>
<title>Single trial animation.</title>
<p>Animation of a real single trial played by two subjects, the same trial with goals overlaid, and a third presentation of the same trial with energy function overlaid as a heat map.</p>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006895.s005" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.s005" xlink:type="simple">
<label>S2 Video</label>
<caption>
<title>Single trial animation.</title>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006895.s006" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.s006" xlink:type="simple">
<label>S3 Video</label>
<caption>
<title>Single trial animation.</title>
<p>(MP4)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006895.s007" mimetype="video/mp4" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006895.s007" xlink:type="simple">
<label>S4 Video</label>
<caption>
<title>Single trial animation.</title>
<p>(MP4)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Kelsey McDonald, McKell Carter, and Yaoguang Jiang for discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006895.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dunbar</surname> <given-names>R</given-names></name>. <article-title>The social brain hypothesis</article-title>. <source>brain</source>. <year>1998</year>;<volume>9</volume>(<issue>10</issue>):<fpage>178</fpage>–<lpage>190</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref002">
<label>2</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Camerer</surname> <given-names>C</given-names></name>. <source>Behavioral game theory: Experiments in strategic interaction</source>. <publisher-name>Princeton University Press</publisher-name>; <year>2003</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sanfey</surname> <given-names>AG</given-names></name>. <article-title>Social decision-making: insights from game theory and neuroscience</article-title>. <source>Science</source>. <year>2007</year>;<volume>318</volume>(<issue>5850</issue>):<fpage>598</fpage>–<lpage>602</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1142996" xlink:type="simple">10.1126/science.1142996</ext-link></comment> <object-id pub-id-type="pmid">17962552</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rilling</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Sanfey</surname> <given-names>AG</given-names></name>. <article-title>The neuroscience of social decision-making</article-title>. <source>Annual review of psychology</source>. <year>2011</year>;<volume>62</volume>:<fpage>23</fpage>–<lpage>48</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev.psych.121208.131647" xlink:type="simple">10.1146/annurev.psych.121208.131647</ext-link></comment> <object-id pub-id-type="pmid">20822437</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Brent</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Klein</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Pearson</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Watson</surname> <given-names>KK</given-names></name>, <etal>et al</etal>. <article-title>Neuroethology of primate social behavior</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year>;<volume>110</volume>(<issue>Supplement 2</issue>):<fpage>10387</fpage>–<lpage>10394</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1301213110" xlink:type="simple">10.1073/pnas.1301213110</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>. <article-title>Game theory and neural basis of social decision making</article-title>. <source>Nature neuroscience</source>. <year>2008</year>;<volume>11</volume>(<issue>4</issue>):<fpage>404</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn2065" xlink:type="simple">10.1038/nn2065</ext-link></comment> <object-id pub-id-type="pmid">18368047</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rudebeck</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Bannerman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rushworth</surname> <given-names>M</given-names></name>. <article-title>The contribution of distinct subregions of the ventromedial frontal cortex to emotion, social behavior, and decision making</article-title>. <source>Cognitive, Affective, &amp; Behavioral Neuroscience</source>. <year>2008</year>;<volume>8</volume>(<issue>4</issue>):<fpage>485</fpage>–<lpage>497</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3758/CABN.8.4.485" xlink:type="simple">10.3758/CABN.8.4.485</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yoshida</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Saito</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Iriki</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Isoda</surname> <given-names>M</given-names></name>. <article-title>Representation of others’ action by neurons in monkey medial frontal cortex</article-title>. <source>Current Biology</source>. <year>2011</year>;<volume>21</volume>(<issue>3</issue>):<fpage>249</fpage>–<lpage>253</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cub.2011.01.004" xlink:type="simple">10.1016/j.cub.2011.01.004</ext-link></comment> <object-id pub-id-type="pmid">21256015</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Azzi</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Sirigu</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Duhamel</surname> <given-names>JR</given-names></name>. <article-title>Modulation of value representation by social context in the primate orbitofrontal cortex</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>6</issue>):<fpage>2126</fpage>–<lpage>2131</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1111715109" xlink:type="simple">10.1073/pnas.1111715109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yoshida</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Saito</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Iriki</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Isoda</surname> <given-names>M</given-names></name>. <article-title>Social error monitoring in macaque frontal cortex</article-title>. <source>Nature neuroscience</source>. <year>2012</year>;<volume>15</volume>(<issue>9</issue>):<fpage>1307</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3180" xlink:type="simple">10.1038/nn.3180</ext-link></comment> <object-id pub-id-type="pmid">22864610</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Gariépy</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Platt</surname> <given-names>ML</given-names></name>. <article-title>Neuronal reference frames for social decisions in primate frontal cortex</article-title>. <source>Nature neuroscience</source>. <year>2013</year>;<volume>16</volume>(<issue>2</issue>):<fpage>243</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3287" xlink:type="simple">10.1038/nn.3287</ext-link></comment> <object-id pub-id-type="pmid">23263442</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Fagan</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Toda</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Utevsky</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Pearson</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Platt</surname> <given-names>ML</given-names></name>. <article-title>Neural mechanisms of social decision-making in the primate amygdala</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>;<volume>112</volume>(<issue>52</issue>):<fpage>16012</fpage>–<lpage>16017</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1514761112" xlink:type="simple">10.1073/pnas.1514761112</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Haroush</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>ZM</given-names></name>. <article-title>Neuronal prediction of opponent’s behavior during cooperative social interchange in primates</article-title>. <source>Cell</source>. <year>2015</year>;<volume>160</volume>(<issue>6</issue>):<fpage>1233</fpage>–<lpage>1245</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2015.01.045" xlink:type="simple">10.1016/j.cell.2015.01.045</ext-link></comment> <object-id pub-id-type="pmid">25728667</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ballesta</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Duhamel</surname> <given-names>JR</given-names></name>. <article-title>Rudimentary empathy in macaques’ social decision-making</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>;<volume>112</volume>(<issue>50</issue>):<fpage>15516</fpage>–<lpage>15521</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1504454112" xlink:type="simple">10.1073/pnas.1504454112</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref015">
<label>15</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>JM</given-names></name>. <chapter-title>Evolution and the Theory of Games</chapter-title>. In: <source>Did Darwin Get It Right?</source> <publisher-name>Springer</publisher-name>; <year>1988</year>. p. <fpage>202</fpage>–<lpage>215</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref016">
<label>16</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Giraldeau</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Caraco</surname> <given-names>T</given-names></name>. <source>Social foraging theory</source>. <publisher-name>Princeton University Press</publisher-name>; <year>2000</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref017">
<label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Ng AY, Russell SJ, et al. Algorithms for inverse reinforcement learning. In: Icml; 2000. p. 663–670.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref018">
<label>18</label>
<mixed-citation publication-type="other" xlink:type="simple">Abbeel P, Ng AY. Apprenticeship learning via inverse reinforcement learning. In: Proceedings of the twenty-first international conference on Machine learning. ACM; 2004. p. 1.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wainwright</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>, <etal>et al</etal>. <article-title>Graphical models, exponential families, and variational inference</article-title>. <source>Foundations and Trends<sup>®</sup> in Machine Learning</source>. <year>2008</year>;<volume>1</volume>(<issue>1–2</issue>):<fpage>1</fpage>–<lpage>305</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kleiner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Brainard</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pelli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ingling</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Murray</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Broussard</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>What’s new in Psychtoolbox-3</article-title>. <source>Perception</source>. <year>2007</year>;<volume>36</volume>(<issue>14</issue>):<fpage>1</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref021">
<label>21</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Beal</surname> <given-names>MJ</given-names></name>. <source>Variational algorithms for approximate Bayesian inference</source>. <publisher-name>University of London</publisher-name> <publisher-loc>United Kingdom</publisher-loc>; <year>2003</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref022">
<label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Ranganath R, Gerrish S, Blei DM. Black Box Variational Inference. In: AISTATS; 2014. p. 814–822.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref023">
<label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Kucukelbir A, Ranganath R, Gelman A, Blei D. Automatic variational inference in Stan. In: Advances in neural information processing systems; 2015. p. 568–576.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref024">
<label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Rezende DJ, Mohamed S, Wierstra D. Stochastic backpropagation and approximate inference in deep generative models. arXiv preprint arXiv:14014082. 2014;.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref025">
<label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Kingma DP, Welling M. Auto-Encoding Variational Bayes. 2013;.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref026">
<label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Archer E, Park IM, Buesing L, Cunningham J, Paninski L. Black box variational inference for state space models. 2015;.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref027">
<label>27</label>
<mixed-citation publication-type="other" xlink:type="simple">Gao Y, Archer E, Paninski L, Cunningham JP. Linear dynamical neural population models through nonlinear embeddings. 2016;.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref028">
<label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Tran D, Kucukelbir A, Dieng AB, Rudolph M, Liang D, Blei DM. Edward: A library for probabilistic modeling, inference, and criticism. arXiv preprint arXiv:161009787. 2016;.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref029">
<label>29</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Goodfellow</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Bengio</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Courville</surname> <given-names>A</given-names></name>. <source>Deep Learning</source>. <publisher-name>MIT Press</publisher-name>; <year>2016</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref030">
<label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Kingma D, Ba J. Adam: A Method for Stochastic Optimization. 2014;.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barraclough</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Conroy</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>. <article-title>Prefrontal cortex and decision making in a mixed-strategy game</article-title>. <source>Nature neuroscience</source>. <year>2004</year>;<volume>7</volume>(<issue>4</issue>):<fpage>404</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1209" xlink:type="simple">10.1038/nn1209</ext-link></comment> <object-id pub-id-type="pmid">15004564</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sugrue</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Corrado</surname> <given-names>GS</given-names></name>, <name name-style="western"><surname>Newsome</surname> <given-names>WT</given-names></name>. <article-title>Matching behavior and the representation of value in the parietal cortex</article-title>. <source>science</source>. <year>2004</year>;<volume>304</volume>(<issue>5678</issue>):<fpage>1782</fpage>–<lpage>1787</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1094765" xlink:type="simple">10.1126/science.1094765</ext-link></comment> <object-id pub-id-type="pmid">15205529</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>King-Casas</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tomlin</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Anen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Camerer</surname> <given-names>CF</given-names></name>, <name name-style="western"><surname>Quartz</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Montague</surname> <given-names>PR</given-names></name>. <article-title>Getting to know you: reputation and trust in a two-person economic exchange</article-title>. <source>Science</source>. <year>2005</year>;<volume>308</volume>(<issue>5718</issue>):<fpage>78</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1108062" xlink:type="simple">10.1126/science.1108062</ext-link></comment> <object-id pub-id-type="pmid">15802598</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Mathewson</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Hsu</surname> <given-names>M</given-names></name>. <article-title>Dissociable neural representations of reinforcement and belief prediction errors underlie strategic learning</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>5</issue>):<fpage>1419</fpage>–<lpage>1424</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1116783109" xlink:type="simple">10.1073/pnas.1116783109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trommershäuser</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Maloney</surname> <given-names>LT</given-names></name>, <name name-style="western"><surname>Landy</surname> <given-names>MS</given-names></name>. <article-title>Statistical decision theory and the selection of rapid, goal-directed movements</article-title>. <source>JOSA A</source>. <year>2003</year>;<volume>20</volume>(<issue>7</issue>):<fpage>1419</fpage>–<lpage>1433</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1364/JOSAA.20.001419" xlink:type="simple">10.1364/JOSAA.20.001419</ext-link></comment> <object-id pub-id-type="pmid">12868646</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wolpert</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kawato</surname> <given-names>M</given-names></name>. <article-title>A unifying computational framework for motor control and social interaction</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>. <year>2003</year>;<volume>358</volume>(<issue>1431</issue>):<fpage>593</fpage>–<lpage>602</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2002.1238" xlink:type="simple">10.1098/rstb.2002.1238</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Resulaj</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kiani</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Wolpert</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>. <article-title>Changes of mind in decision-making</article-title>. <source>Nature</source>. <year>2009</year>;<volume>461</volume>(<issue>7261</issue>):<fpage>263</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature08275" xlink:type="simple">10.1038/nature08275</ext-link></comment> <object-id pub-id-type="pmid">19693010</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref038">
<label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gigerenzer</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Selten</surname> <given-names>R</given-names></name>. <source>Bounded rationality: The adaptive toolbox</source>. <publisher-name>MIT press</publisher-name>; <year>2002</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schaafsma</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Pfaff</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Spunt</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Adolphs</surname> <given-names>R</given-names></name>. <article-title>Deconstructing and reconstructing theory of mind</article-title>. <source>Trends in cognitive sciences</source>. <year>2015</year>;<volume>19</volume>(<issue>2</issue>):<fpage>65</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tics.2014.11.007" xlink:type="simple">10.1016/j.tics.2014.11.007</ext-link></comment> <object-id pub-id-type="pmid">25496670</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Isaacs</surname> <given-names>R</given-names></name>. <source>Differential games: a mathematical theory with applications to warfare and pursuit, control and optimization</source>. <publisher-name>Courier Corporation</publisher-name>; <year>1999</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bressan</surname> <given-names>A</given-names></name>. <article-title>Noncooperative differential games</article-title>. <source>Milan Journal of Mathematics</source>. <year>2011</year>;<volume>79</volume>(<issue>2</issue>):<fpage>357</fpage>–<lpage>427</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00032-011-0163-6" xlink:type="simple">10.1007/s00032-011-0163-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006895.ref042">
<label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Carlin</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Stern</surname> <given-names>HS</given-names></name>, <name name-style="western"><surname>Dunson</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Vehtari</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <source>Bayesian data analysis</source>. <volume>vol. 2</volume>. <publisher-name>CRC press</publisher-name> <publisher-loc>Boca Raton, FL</publisher-loc>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006895.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shenhav</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>JD</given-names></name>. <article-title>The expected value of control: an integrative theory of anterior cingulate cortex function</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>79</volume>(<issue>2</issue>):<fpage>217</fpage>–<lpage>240</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2013.07.007" xlink:type="simple">10.1016/j.neuron.2013.07.007</ext-link></comment> <object-id pub-id-type="pmid">23889930</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>