<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00734</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005681</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Brain mapping</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Diagnostic medicine</subject><subj-group><subject>Diagnostic radiology</subject><subj-group><subject>Magnetic resonance imaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Diagnostic radiology</subject><subj-group><subject>Magnetic resonance imaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Radiology and imaging</subject><subj-group><subject>Diagnostic radiology</subject><subj-group><subject>Magnetic resonance imaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Functional magnetic resonance imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Signal filtering</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive neuroscience</subject><subj-group><subject>Cognitive neurology</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive neuroscience</subject><subj-group><subject>Cognitive neurology</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Neurology</subject><subj-group><subject>Cognitive neurology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Hematology</subject><subj-group><subject>Hemodynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Self-regulation strategy, feedback timing and hemodynamic properties modulate learning in a simulated fMRI neurofeedback environment</article-title>
<alt-title alt-title-type="running-head">Simulated fMRI neurofeedback reveals principles of neural self-regulation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9487-9850</contrib-id>
<name name-style="western">
<surname>Oblak</surname> <given-names>Ethan F.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9918-465X</contrib-id>
<name name-style="western">
<surname>Lewis-Peacock</surname> <given-names>Jarrod A.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sulzer</surname> <given-names>James S.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Mechanical Engineering, The University of Texas at Austin, Austin, Texas, USA</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Psychology, The University of Texas at Austin, Austin, Texas, USA</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Institute for Neuroscience, The University of Texas at Austin, Austin, Texas, USA</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Gershman</surname> <given-names>Samuel J.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Harvard University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">eoblak@utexas.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>7</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>28</day>
<month>7</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>7</issue>
<elocation-id>e1005681</elocation-id>
<history>
<date date-type="received">
<day>9</day>
<month>5</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>7</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Oblak et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005681"/>
<abstract>
<p>Direct manipulation of brain activity can be used to investigate causal brain-behavior relationships. Current noninvasive neural stimulation techniques are too coarse to manipulate behaviors that correlate with fine-grained spatial patterns recorded by fMRI. However, these activity patterns can be manipulated by having people learn to self-regulate their own recorded neural activity. This technique, known as fMRI neurofeedback, faces challenges as many participants are unable to self-regulate. The causes of this non-responder effect are not well understood due to the cost and complexity of such investigation in the MRI scanner. Here, we investigated the temporal dynamics of the hemodynamic response measured by fMRI as a potential cause of the non-responder effect. Learning to self-regulate the hemodynamic response involves a difficult temporal credit-assignment problem because this signal is both delayed and blurred over time. Two factors critical to this problem are the prescribed self-regulation strategy (cognitive or automatic) and feedback timing (continuous or intermittent). Here, we sought to evaluate how these factors interact with the temporal dynamics of fMRI without using the MRI scanner. We first examined the role of cognitive strategies by having participants learn to regulate a simulated neurofeedback signal using a unidimensional strategy: pressing one of two buttons to rotate a visual grating that stimulates a model of visual cortex. Under these conditions, continuous feedback led to faster regulation compared to intermittent feedback. Yet, since many neurofeedback studies prescribe implicit self-regulation strategies, we created a computational model of automatic reward-based learning to examine whether this result held true for automatic processing. When feedback was delayed and blurred based on the hemodynamics of fMRI, this model learned more reliably from intermittent feedback compared to continuous feedback. These results suggest that different self-regulation mechanisms prefer different feedback timings, and that these factors can be effectively explored and optimized via simulation prior to deployment in the MRI scanner.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>By repeatedly stimulating fine-grained patterns of neural activity, it is possible to manipulate behaviors associated with these patterns. While millimeter-scale patterns cannot yet be targeted with noninvasive brain stimulation, some people can learn to self-stimulate these activity patterns if they receive real-time feedback of their own recorded brain activity through a procedure known as fMRI neurofeedback. Other ‘non-responders’ are, for reasons unknown, unable to learn how to self-regulate these patterns. Here, we investigate how the properties of the fMRI signal, feedback timing, and self-regulation strategies may lead to this non-responder effect. The signal recorded by fMRI is related to blood flow in the brain and can be delayed by up to six seconds relative to underlying neural activity, which makes it difficult to learn. Because experiments in the MRI scanner are costly and time-consuming, we created a simulated neurofeedback environment to compare continuous versus intermittent feedback timing and cognitive versus automatic self-regulation strategies. In a cognitive experiment with human participants playing a simple game with the simulated neurofeedback signal, we found continuous feedback led to faster learning. However, in a computer model of automatic reward-based learning, we found that intermittent feedback was more reliable. These results will help improve future fMRI neurofeedback experiments and treatments by improving the efficacy of neurofeedback training procedures.</p>
</abstract>
<funding-group>
<funding-statement>This work was financially supported by a U.T. BRAIN seed grant from The University of Texas System Neuroscience and Neurotechnology Research Institute, pilot funding from the National Institutes of Health National Center of Neuromodulation for Rehabilitation (NIH/NICHD Grant Number P2CHD0886844) which was awarded to the Medical University of South Carolina, and a Robert J. Kleberg, Jr. and Helen C. Kleberg Foundation Medical Research Grant. The contents are solely the responsibility of the authors and do not necessarily represent the official views of the NIH or NICHD. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="1"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-08-09</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/LewisPeacockLab/simulated-neurofeedback-data" xlink:type="simple">https://github.com/LewisPeacockLab/simulated-neurofeedback-data</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Neuroimaging studies often find correlations between behaviors and recorded neural activation. To test whether these relationships are causal, neuroscientists must find a way to manipulate the underlying neural structure and observe whether the associated behavior is affected. In human neuroscience research, we are usually limited to noninvasive methods that have minimal associated risk. Currently, safe and noninvasive neural stimulation techniques such as transcranial magnetic stimulation (TMS) and transcranial direct-current stimulation (tDCS) can only affect neural structures on the scale of centimeters [<xref ref-type="bibr" rid="pcbi.1005681.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref002">2</xref>]. These techniques are too coarse to manipulate behaviors that correlate with the millimeter-scale patterns of neural activation recorded by functional magnetic resonance imaging (fMRI). Using multi-voxel pattern analysis (MVPA [<xref ref-type="bibr" rid="pcbi.1005681.ref003">3</xref>]), we can identify neural features such as orientation tuning [<xref ref-type="bibr" rid="pcbi.1005681.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref005">5</xref>] and complex motor programs [<xref ref-type="bibr" rid="pcbi.1005681.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref007">7</xref>] which are inaccessible to other human neuroimaging analysis methods.</p>
<p>Although we cannot exogenously stimulate these patterns, it is possible for people to endogenously activate them if they are presented with visual feedback of the recorded activity pattern in a procedure known as fMRI neurofeedback [<xref ref-type="bibr" rid="pcbi.1005681.ref008">8</xref>]. In this procedure, people must learn to elicit a targeted neural activation pattern by observing a feedback signal and adjusting their strategy to maximize this signal (<xref ref-type="fig" rid="pcbi.1005681.g001">Fig 1A</xref>). This technique faces challenges as many participants are unable to self-regulate. This “non-responder effect” has been quantified in electroencephalography (EEG) neurofeedback, with 15–30% of neurofeedback participants being completely unable to self-regulate [<xref ref-type="bibr" rid="pcbi.1005681.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref010">10</xref>]. EEG researchers have correlated this effect with resting-state activity [<xref ref-type="bibr" rid="pcbi.1005681.ref011">11</xref>], white matter tract integrity [<xref ref-type="bibr" rid="pcbi.1005681.ref012">12</xref>], technological knowledge [<xref ref-type="bibr" rid="pcbi.1005681.ref013">13</xref>], and sense of agency [<xref ref-type="bibr" rid="pcbi.1005681.ref014">14</xref>].</p>
<fig id="pcbi.1005681.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005681.g001</object-id>
<label>Fig 1</label>
<caption>
<title>System model of neurofeedback.</title>
<p><bold>(A)</bold> Neurofeedback is biofeedback of neural activity, commonly presented as a visual thermometer (in green) that participants learn to control. <bold>(B)</bold> Neurofeedback is learned through either cognitive or automatic learning processes. In cognitive learning, participants try various cognitive behaviors and, through trial-and-error, must learn which behaviors result in successful regulation of the feedback signal. In automatic learning, spontaneous neural activity is held in memory, and the feedback signal reinforces this neural activity according to an internal learning rule. <bold>(C)</bold> Underlying neural activity is convolved with a physiological filter such as the hemodynamic response function (HRF) before being recorded by neuroimaging. <bold>(D)</bold> A multivariate pattern analysis (MVPA) classifier is used to convert multiple channels (or voxels) of neural activity into a single value that represents how closely the recorded neural activity matches a desired pattern. <bold>(E)</bold> We present four candidate physiological filters: an instantaneous impulse, the canonical HRF, a 6-second delay, and a 10-second moving average blur. <bold>(F)</bold> Once decoded, feedback can either be presented continuously or intermittently.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005681.g001" xlink:type="simple"/>
</fig>
<p>For fMRI neurofeedback, the causes of the non-responder effect have not been identified due to the cost and complexity of examining all possible factors in the MRI scanner. We believe that the characteristics of the hemodynamic response measured by fMRI are critical to understanding how people learn to self-regulate because the hemodynamic response is both delayed and blurred in time relative to underlying neural activation [<xref ref-type="bibr" rid="pcbi.1005681.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref016">16</xref>]. This forms a difficult credit-assignment problem, in which participants must remember which previous behavior or underlying neural activity caused the delayed and blurred feedback to change in order to learn to self-regulate. When people explore different cognitive strategies in an attempt to control the neurofeedback signal, they must remember a time history of behaviors and determine which behavior was responsible for influencing the feedback signal (<xref ref-type="fig" rid="pcbi.1005681.g001">Fig 1B</xref>, top). To “remember” past neural activity, automatic learning circuits must hold spontaneous activity in memory [<xref ref-type="bibr" rid="pcbi.1005681.ref017">17</xref>] and reinforce it using an internal learning rule that is not cognitively accessible to the participant (<xref ref-type="fig" rid="pcbi.1005681.g001">Fig 1B</xref>, bottom).</p>
<p>The difficulty of this credit-assignment task could be reduced by appropriately scheduling feedback to account for the hemodynamic signal properties. One of the controversies in fMRI neurofeedback is whether to schedule feedback continuously or intermittently (<xref ref-type="fig" rid="pcbi.1005681.g001">Fig 1F</xref>), trading off feedback frequency to account for the hemodynamic response [<xref ref-type="bibr" rid="pcbi.1005681.ref018">18</xref>]. Only two small pilot studies have been published to address this controversy. The first study compared continuous to intermittent presentation of fMRI neurofeedback of regional activation levels from the supplementary motor area, finding that intermittent feedback produced better learning [<xref ref-type="bibr" rid="pcbi.1005681.ref019">19</xref>]. The second study found mixed results in auditory cortex, with continuous feedback showing better performance over multiple sessions [<xref ref-type="bibr" rid="pcbi.1005681.ref020">20</xref>]. It is difficult to generalize these results because success may depend on other factors such as neurofeedback signal quality and self-regulation strategy. An exhaustive search of parameters within the MRI scanner is impractical due to cost. Therefore, our main goal here was to bridge the gap in understanding neurofeedback learning by testing key factors (feedback timing and self-regulation strategy) in a simulation environment outside of the MRI scanner.</p>
<p>We constructed a model of early visual cortex (V1) to use as a simulated neurofeedback testbed (<xref ref-type="fig" rid="pcbi.1005681.g002">Fig 2A</xref>). We chose V1 as our model because this is one of the most well-studied cortical areas, starting with early electrophysiological studies in animals [<xref ref-type="bibr" rid="pcbi.1005681.ref021">21</xref>] and extending to modern fMRI studies [<xref ref-type="bibr" rid="pcbi.1005681.ref022">22</xref>]. We specifically modeled the response of V1 to grating orientations because this has been extensively studied with fMRI [<xref ref-type="bibr" rid="pcbi.1005681.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref023">23</xref>]. To deliver feedback from this model, we constructed similar MVPA classifiers (<xref ref-type="fig" rid="pcbi.1005681.g002">Fig 2B</xref>) to decode grating-associated patterns during explicit presentation of stimuli [<xref ref-type="bibr" rid="pcbi.1005681.ref024">24</xref>] as well as in the absence of stimuli [<xref ref-type="bibr" rid="pcbi.1005681.ref025">25</xref>].</p>
<fig id="pcbi.1005681.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005681.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Simulated visual cortex as measured by fMRI and decoded using MVPA.</title>
<p><bold>(A)</bold> Voxels (n = 1000) in the model are either tuned to one of eight orientations (0°, 22.5°, …, 157.5°; 2.5% of voxels each), or have no orientation selectivity (80% of all voxels). All voxels have additive spontaneous activity and are convolved in time with a physiological filter such as the canonical HRF (for all candidate filters, see <xref ref-type="fig" rid="pcbi.1005681.g001">Fig 1e</xref>). <bold>(B)</bold> The pattern decoder transforms the measured pattern of simulated activity into a number indicating the likelihood that the activity matches the pattern associated with one of m target grating orientations. For cognitive experiments, m = 8 (0°, 22.5°, …, 157.5°); for automatic experiments, m = 3 (10°, 70°, 130°).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005681.g002" xlink:type="simple"/>
</fig>
<p>To model the temporal properties of the hemodynamic response, we created four different physiological filters to apply to our simulated neural signal (<xref ref-type="fig" rid="pcbi.1005681.g001">Fig 1E</xref>). The first is an impulse response, which corresponds to no delaying or blurring of the recorded signal, as if we could directly record electrophysiological activity at the spatial resolution of fMRI. Next, we simulated the fMRI blood-oxygen-level-dependent (BOLD) response, using the canonical hemodynamic response function (HRF) [<xref ref-type="bibr" rid="pcbi.1005681.ref015">15</xref>] to blur and delay the underlying neural activity. The final two filters were a 6-second delay and a 10-second moving average blur, corresponding to the delay-to-peak of the HRF and a boxcar function centered around this peak, respectively. We used these two synthetic filters to investigate the unique contribution of delay and blur to the learning of fMRI neurofeedback signals. We hypothesized that isolated delay and blur responses would be more difficult to learn than an impulse response, and that the combined delay and blur of the HRF would be the most difficult.</p>
<p>Using our model of V1 and the four candidate physiological filters, we first examined cognitive strategies as these are the most common type of strategy given in traditional fMRI neurofeedback experiments [<xref ref-type="bibr" rid="pcbi.1005681.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref018">18</xref>]. These strategies commonly take the form of mental imagery [<xref ref-type="bibr" rid="pcbi.1005681.ref026">26</xref>], which is notoriously difficult to quantify and relies on participants to self-report their strategy. To avoid this difficulty, we used a motor strategy as a proxy for mental imagery. Participants pressed one of two buttons to rotate a grating image that stimulated our V1 model. Participants had to discover a target orientation using a neurofeedback signal from our model that was filtered by one of the physiological filters. This allowed us to examine how people make cognitive decisions when faced with delayed or blurred feedback.</p>
<p>Next, we used the same model and filters to examine an alternative approach to fMRI neurofeedback: relying entirely on automatic learning circuits to elicit patterns of fMRI activity without requiring cognitive effort. This procedure, known as reinforcement learning or operant conditioning of fMRI patterns, has been successfully used to train the fMRI correlates of visual perception [<xref ref-type="bibr" rid="pcbi.1005681.ref025">25</xref>], confidence judgments [<xref ref-type="bibr" rid="pcbi.1005681.ref027">27</xref>], facial preference [<xref ref-type="bibr" rid="pcbi.1005681.ref028">28</xref>], color perception [<xref ref-type="bibr" rid="pcbi.1005681.ref029">29</xref>], and fear [<xref ref-type="bibr" rid="pcbi.1005681.ref030">30</xref>]. The mechanisms underlying this learning process are unclear. Because we had more factors to examine than would be feasible with the MRI scanner, we constructed a fully computational model to address how this process may occur. This allowed us to quickly and effectively evaluate whether continuous or intermittent feedback would more reliably elicit this type of automatic learning. Thus, we were able to use the same simulated neurofeedback environment to examine both cognitive and automatic learning mechanisms, demonstrating its efficacy as a neurofeedback research testbed.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Using cognitive strategies to activate simulated visual cortex</title>
<p>We created a real-time feedback environment where human participants made cognitive decisions to maximize a simulated neurofeedback signal. Mental imagery is the most commonly used cognitive strategy in neurofeedback [<xref ref-type="bibr" rid="pcbi.1005681.ref018">18</xref>], but is difficult to quantify, varies between subjects, and cannot be reported on a second-to-second basis. Here we used measurable overt motor output as a proxy for mental strategies. Human participants used one of two buttons to rotate a grating image clockwise or counter-clockwise (<xref ref-type="fig" rid="pcbi.1005681.g003">Fig 3A</xref>). This grating image directly stimulated our V1 model based on its orientation. During each trial, participants were instructed to find a target orientation between 0° and 180° by rotating the grating. Participants found these targets by interpreting a decoded fMRI-like feedback signal indicating the probability that the grating was aligned with the target orientation. The signal was decoded using an 8-way sparse logistic regression classifier [<xref ref-type="bibr" rid="pcbi.1005681.ref031">31</xref>] trained on simulated data from each of the eight tuned orientations of our V1 model (<xref ref-type="fig" rid="pcbi.1005681.g002">Fig 2A</xref>). In this way, we operationalized a mental imagery strategy as a simple motor decision that influenced a model of V1 neural activity. In contrast to more implicit neurofeedback learning experiments [<xref ref-type="bibr" rid="pcbi.1005681.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref029">29</xref>], the feedback received by participants was directly related to the physical properties of the grating stimulus which participants viewed. Thus, it eliminated any ambiguity about the relationship between their strategy choice and the feedback signal other than temporal delays and blurs. We address the additional complexity of implicit learning in our automatic learning simulations, which did not explicitly use the grating stimulus to generate feedback signals.</p>
<fig id="pcbi.1005681.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005681.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Cognitive learning of neurofeedback signals.</title>
<p><bold>(A)</bold> In this simulation, participants influence simulated neural activity by using a motor strategy to stimulate our model of V1. Button presses rotate a grating, which then induces activity in the V1 model. After physiological filtering, the resulting volume is decoded based on a target orientation and presented as visual feedback either continuously or intermittently. <bold>(B)</bold> For continuous feedback target searches, participants are able to continuously update the grating orientation, and the feedback signal updates every 2 seconds. <bold>(C)</bold> For intermittent feedback target searches, participants select one orientation each trial and receive summarized feedback at the end of each trial.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005681.g003" xlink:type="simple"/>
</fig>
<p>Participants were assigned into continuous and intermittent feedback timing groups (<xref ref-type="fig" rid="pcbi.1005681.g003">Fig 3B and 3C</xref>) and exposed to all of the simulated physiological filters (<xref ref-type="fig" rid="pcbi.1005681.g001">Fig 1E</xref>) to examine how these modified or impaired participants’ cognitive strategies. In addition to our hypothesis that the hemodynamic response should be more difficult to learn than isolated delay or blur responses, we also hypothesized that participants in the intermittent feedback group would find targets faster since this feedback timing makes the credit-assignment problem easier by accounting for the hemodynamic delay.</p>
</sec>
<sec id="sec004">
<title>Continuous feedback is superior to intermittent feedback for simple cognitive strategies</title>
<p>In our cognitive simulation, we were able to create a one-dimensional cognitive strategy (selection of grating orientation) that could be quickly understood by participants. In this setting we found that in contrast to our hypothesis, the continuous feedback group was able to find targets faster than the intermittent feedback group for the HRF, blur, and delay physiological filters (<xref ref-type="fig" rid="pcbi.1005681.g004">Fig 4</xref>). The largest difference was found in the blur condition (t<sub>(36)</sub> = 11.06, p&lt;0.0001), with a large difference also found in the HRF condition (t<sub>(36)</sub> = 4.564, p&lt;0.0001). The delay condition was the most similar between continuous and intermittent conditions, but continuous feedback was still significantly better (t<sub>(36)</sub> = 2.363, p = 0.0237).</p>
<fig id="pcbi.1005681.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005681.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Cognitive learning curves.</title>
<p>Learning curves were constructed by combining all target searches over all participants for each physiological filter. Plots in green show the mean classifier output (+/-s.d.) over the course of each target search. Because a new target was selected as soon as the current target was reached, all time points after success were simulated using randomly generated volumes at the target +/-5°. For means (+/-s.e.) of time to target for continuous (circles) and intermittent (diamonds) feedback, stars indicate significant differences at p&lt;0.05 (*) and p&lt;0.001 (***). In the sample strategy plots, the grating orientation for all HRF target searches from one participant (continuous: participant #3; intermittent: participant #9) are plotted relative to the target, with black circles indicating the time at which the target was reached.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005681.g004" xlink:type="simple"/>
</fig>
<p>These results show that if participants can directly influence the feedback signal through simple action choices, they are able to rapidly learn its dynamics and can perform better than those receiving intermittent feedback. This suggests that feedback of physiological responses that delay or blur the underlying neural activity can be successfully learned through cognitive means with a continuous feedback signal, as long as an effective strategy (i.e. a specific, well-defined behavior) is known to the participant. It is important to note that these conclusions may not generalize to explicit imagery tasks where many and more complex cognitive strategies could be used, when there are interdependencies between these strategies, or when the signal to noise ratio (SNR) of the neural signal is poor. For instance, in a study concluding that intermittent feedback was superior [<xref ref-type="bibr" rid="pcbi.1005681.ref019">19</xref>], the cognitive strategies employed by participants may not have been effective, and automatic processing of the intermittent feedback may have occurred in parallel to enable superior self-regulation compared to continuous feedback.</p>
</sec>
<sec id="sec005">
<title>Physiological signal properties impact neurofeedback performance</title>
<p>Physiological filters also affect learning rate within each of the continuous and intermittent feedback conditions (<xref ref-type="fig" rid="pcbi.1005681.g004">Fig 4</xref>). In the case of continuous feedback, the impulse condition was found to be significantly easier to learn than the HRF (Tukey’s HSD, p&lt;0.0001), delay (p&lt;0.0001), and blur conditions (p&lt;0.0001). The pure delay condition was significantly more difficult to learn than both blur (p&lt;0.0001) and HRF (p = 0.0305). We also found a trending, non-significant effect suggesting that blur is slightly easier than HRF (p = 0.153). For continuous feedback, an instantaneous neurofeedback signal derived from an impulse response filter was the easiest signal to learn. The HRF physiological response was also significantly more difficult to learn than the impulse response. The isolated delay and blur responses put the HRF result in context: a pure delay was even more difficult to learn than HRF or blur. The increased difficulty of the delay physiological response conflicts with our hypothesis: we expected the HRF, which is a combination of delay and blur, to be the most difficult to learn. However, these results can be explained by the amount and timing of the contingent information received with each physiological response. For the impulse, participants receive 100% of the feedback information within 2 seconds. For blur, participants receive 20% of this information within 2 seconds, with the remainder of the information accumulating over the subsequent 10 seconds. The HRF filter provides no immediate information, but instead provides smeared and sluggish information over the next 6 seconds. The delay response gives no information at all until 6 seconds after the underlying neural activity has occurred. To summarize, it appears that the sooner that any neurofeedback information (even from partial or degraded signals) reaches the participant, the sooner they are able to adjust their cognitive strategy to find the target more quickly.</p>
<p>For intermittent feedback (<xref ref-type="fig" rid="pcbi.1005681.g004">Fig 4</xref>, right), the blur condition resulted in significantly worse performance compared to HRF (Tukey’s HSD, p&lt;0.0001) and delay (p&lt;0.0001). There was no significant difference between the HRF and delay conditions in the intermittent feedback case (p = 0.672). An artefact in the intermittent feedback calculation caused this sharp drop in performance with the blur response. The 6-sec stimulus period and subsequent 6-sec feedback calculation period of the intermittent feedback paradigm are well-matched to the HRF and delay responses, but not to the 10-sec moving average of the blur response. For the same grating orientation stimulus, the blurred response resulted in a lower peak classifier output on average during the feedback calculation period. This meant that participants needed to be more accurate to reach the feedback signal success threshold. This shows that neurofeedback performance can be degraded if intermittent feedback timing and calculation are not well-matched to the physiological response properties of the signal being measured.</p>
</sec>
<sec id="sec006">
<title>Automatic neurofeedback learning: Strengthening neural patterns using reinforcement of spontaneous activity</title>
<p>While we found continuous feedback to be superior to intermittent feedback for cognitive strategies, this need not be true for all fMRI neurofeedback studies. A major drawback of our cognitive learning experiments is that they assume a static relationship between stimulus and brain activity. They effectively bypass the complexity of the brain by providing a direct pathway between stimulus and feedback signal in the form of a visually-presented grating. This is equivalent to a participant having a set of mental strategies that consistently map onto patterns of neural activity and that can be recalled as easily as pressing a button. This is clearly unrealistic if the trained neural circuit has no clear associated cognitive strategy or participants need to be kept unaware of the experimental manipulation. In these cases, implicit or automatic neurofeedback strategies must be used.</p>
<p>If no voluntary action or external stimulus influences neural activity, then we are faced with the challenge of controlling a neural signal that is driven by unconstrained cognitive states (e.g., mind-wandering) along with a contribution from spontaneous neural activity. Over time, participants should be conditioned to elicit the desired pattern of activation whenever they anticipate a neurofeedback signal or when presented a conditioned cue. We cannot examine this phenomenon with human participants unless we use a real neural signal. Instead, we constructed a computational model that started with purely random, spontaneous activity patterns and learned to elicit desired activity through reinforcement provided by an MVPA classifier that was trained to recognize a desired pattern (i.e. simulated activity patterns corresponding to a stimulus). This model of automatic learning (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5</xref>) followed a basic reinforcement learning structure [<xref ref-type="bibr" rid="pcbi.1005681.ref032">32</xref>]: changes in a feedback signal are used to reward or punish spontaneous neural activity, which is accumulated (integrated) over time.</p>
<fig id="pcbi.1005681.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005681.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Automatic learning of neurofeedback signals.</title>
<p><bold>(A)</bold> Reinforcement learning is used to shape neural activity in the absence of delay. <bold>(B)</bold> A simple two-voxel neural model is used to demonstrate how our model of automatic learning can learn a pattern of neural activity associated with a stimulus. <bold>(C)</bold> Without delays, our model is able to learn the desired pattern of neural activity. The top row shows example data from one trial, while the filled plots on the bottom row show the mean and 50% confidence interval (CI) for each signal at each time point, averaged over 1000 simulated trials. <bold>(D)</bold> If significant physiological delays exist, then an internal model must exist to hold in memory underlying neural activity before it can be reinforced by the delayed feedback signal. <bold>(E)</bold> If no internal model exists, learning of neural activity filtered by the HRF does not occur.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005681.g005" xlink:type="simple"/>
</fig>
<p>Consider a vector of activity <bold>a</bold>[<italic>n</italic>] at time point (TR) <italic>n</italic>, which is a combination of spontaneous activity <bold>a</bold><sub><italic>s</italic></sub>[<italic>n</italic>] and learned (conditioned) activity <bold>a</bold><sub><italic>c</italic></sub>[<italic>n</italic>]. Let <bold>a</bold><sub><italic>s</italic></sub>[<italic>n</italic>] = <italic>N</italic> ∼ (0, <italic>σ</italic><sub><italic>s</italic></sub>), where spontaneous activity in each voxel is independent (we will later introduce spatial correlations). Given a matrix of classifier weights <inline-formula id="pcbi.1005681.e006"><alternatives><graphic id="pcbi.1005681.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005681.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mi>W</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>v</mml:mi><mml:mi>o</mml:mi><mml:mi>x</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mi>x</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>s</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and a learning rate <italic>α</italic>, we can ‘learn’ the next conditioned activity, <bold>a</bold><sub><italic>c</italic></sub>[<italic>n</italic>+1] by observing the change in classifier output due to the current activity pattern. Defining <italic>f</italic>[<italic>n</italic>] as the classifier output for the target (feedback signal) and <italic>l</italic>[<italic>n</italic>] as the learning signal:
<disp-formula id="pcbi.1005681.e001"><alternatives><graphic id="pcbi.1005681.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005681.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">f</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>t</mml:mi> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mi mathvariant="bold">a</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">f</mml:mi> <mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>g</mml:mi> <mml:mi>e</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>l</mml:mi> <mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo> <mml:mo>-</mml:mo> <mml:mi>f</mml:mi> <mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>α</mml:mi> <mml:mo>·</mml:mo> <mml:mi>l</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">a</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>Where <italic>softmax</italic>(⋅) = <italic>e</italic><sup>(⋅)</sup>/Σ<italic>e</italic><sup>(⋅)</sup> ensures that the feedback signal represents the likelihood of the target class being observed. In this example, feedback is instantaneous to the underlying neural activity (e.g. the physiological response is an impulse), and spontaneous activity can easily be rewarded because the feedback and underlying neural activity are occurring at the same time.</p>
<p>Our next step was to test this automatic feedback learning structure in a simple simulation: a two-voxel brain with two classes of stimuli and a classifier weighting <inline-formula id="pcbi.1005681.e002"><alternatives><graphic id="pcbi.1005681.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005681.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5B</xref>). We used a learning rate <italic>α</italic> = 1 and spontaneous activity <italic>σ</italic><sub><italic>n</italic></sub> = 0.25. Using <xref ref-type="disp-formula" rid="pcbi.1005681.e001">Eq (1)</xref>, we expectedly found that given a desired activity pattern, the desired activity was elicited (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5C</xref>). However, we hypothesized that this simple learning rule would be unable to learn the underlying neural activity if the feedback signal was filtered by some sort of physiological response such as the HRF before being measured and presented as feedback (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5D</xref>). Indeed, we found that this physiological filtering impairs learning (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5E</xref>). We are aware of models that exist for automatic learning of near-instantaneous electrophysiological signals [<xref ref-type="bibr" rid="pcbi.1005681.ref033">33</xref>], but not for signals with a time delay similar to the HRF. For these longer delays, we posit that an internal model of the relationship between underlying neural activity and feedback signal must exist to solve the credit-assignment problem by holding in memory the underlying neural activity until the feedback signal can be presented (Figs <xref ref-type="fig" rid="pcbi.1005681.g005">5D</xref> and <xref ref-type="fig" rid="pcbi.1005681.g006">6A</xref>). This internal model is purely temporal and has no spatial awareness. All voxel activities are rewarded or punished equally by the feedback signal at specific time points in the past, where the weighting of time points is defined by the internal model. This is analogous to a sliding window memory of whole-brain neural activity [<xref ref-type="bibr" rid="pcbi.1005681.ref017">17</xref>] that a delayed feedback signal is able to reward or punish.</p>
<fig id="pcbi.1005681.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005681.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Automatic learning of continuous versus intermittent neurofeedback signals.</title>
<p><bold>(A)</bold> For continuous learning, a buffer of neural activity is kept in memory and filtered by the internal model. <bold>(B)</bold> In continuous learning, learning can occur when the internal model accurately matches the underlying physiological response. However, with a delay internal model, anti-learning occurs when the underlying neural activity is filtered by the HRF. <bold>(C)</bold> For intermittent learning, a cue is used to gate the conditioned activity. <bold>(D)</bold> Intermittent feedback allows trial-by-trial learning of underlying activity that is filtered by the HRF.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005681.g006" xlink:type="simple"/>
</fig>
<p>To simulate this internal model, we must augment <xref ref-type="disp-formula" rid="pcbi.1005681.e001">Eq (1)</xref> with <italic>h</italic>[<italic>n</italic>] as the delayed or blurred physiological response, <italic>m</italic>[<italic>n</italic>] as the internal memory model, and <bold>p</bold>[<italic>n</italic>] as the delayed or blurred physiological activity:
<disp-formula id="pcbi.1005681.e003"><alternatives><graphic id="pcbi.1005681.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005681.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">p</mml:mi> <mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">a</mml:mi> <mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo> <mml:mo>*</mml:mo> <mml:mi>h</mml:mi> <mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">f</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>s</mml:mi> <mml:mi>o</mml:mi> <mml:mi>f</mml:mi> <mml:mi>t</mml:mi> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>W</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mi mathvariant="bold">p</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>α</mml:mi> <mml:mo>·</mml:mo> <mml:mi>l</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">a</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>*</mml:mo> <mml:mi>m</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>If we assume a maximum length <italic>L</italic> of the physiological response and internal model, we can expand <xref ref-type="disp-formula" rid="pcbi.1005681.e003">Eq (2)</xref> as follows:
<disp-formula id="pcbi.1005681.e004"><alternatives><graphic id="pcbi.1005681.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005681.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>a</mml:mi></mml:mstyle><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>·</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>a</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>f</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>o</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>W</mml:mi><mml:mi>T</mml:mi></mml:msup><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>L</mml:mi></mml:mrow><mml:mn>0</mml:mn></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>a</mml:mi></mml:mstyle><mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow><mml:mi>h</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mo>−</mml:mo><mml:mi>n</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>Although the <italic>softmax</italic> calculation prevents further meaningful simplification of these equations, we can see from <xref ref-type="disp-formula" rid="pcbi.1005681.e004">Eq (3)</xref> that matching <italic>m</italic>[<italic>n</italic>] to <italic>h</italic>[<italic>n</italic>] should help reduce the learning problem toward a summation of impulse learning problems (e.g. those in <xref ref-type="disp-formula" rid="pcbi.1005681.e001">Eq (1)</xref>). Indeed, if we include an internal model that matches the underlying physiological response, such as an HRF internal model for the HRF physiological reponse, we see that learning can now occur (<xref ref-type="fig" rid="pcbi.1005681.g006">Fig 6B</xref>, top). However, if the internal model is not perfectly matched to the actual neural response, such as a delay internal model, we see that it is possible for anti-learning to occur: the opposite pattern of desired activity is learned (<xref ref-type="fig" rid="pcbi.1005681.g006">Fig 6B</xref>, bottom). This result is of critical importance because participants’ internal models cannot be verified and because a ‘pure delay’ model is typically one of the verbal instructions given to participants to describe the hemodynamic lag [<xref ref-type="bibr" rid="pcbi.1005681.ref018">18</xref>]. Therefore, with continuous feedback, there is risk that an incorrect internal model will be generated, leading to poor learning or even anti-learning of the neurofeedback signal.</p>
<p>So far, we have only considered the problem of continuous feedback. We initially hypothesized that intermittent feedback would be superior to continuous feedback, and although this was not the case for cognitive strategies, we will now examine intermittent feedback in the context of automatic learning. For intermittent feedback, learning during each trial <italic>k</italic> with cue period <italic>n</italic><sub><italic>c</italic>,1</sub> ≤ <italic>n</italic> ≤ <italic>n</italic><sub><italic>c</italic>,2</sub> and subsequent pre-feedback wait period <italic>n</italic><sub><italic>w</italic>,1</sub> ≤ <italic>n</italic> ≤ <italic>n</italic><sub><italic>w</italic>,2</sub> takes the following feedback structure:
<disp-formula id="pcbi.1005681.e005"><alternatives><graphic id="pcbi.1005681.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005681.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi mathvariant="bold">a</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>k</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:munderover> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>k</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:munderover> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>n</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mi>l</mml:mi> <mml:mo>[</mml:mo> <mml:mi>k</mml:mi> <mml:mo>]</mml:mo> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mo>[</mml:mo> <mml:mi>k</mml:mi> <mml:mo>]</mml:mo> <mml:mo>-</mml:mo> <mml:mi>f</mml:mi> <mml:mo>[</mml:mo> <mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>k</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>α</mml:mi> <mml:mo>·</mml:mo> <mml:mi>l</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>k</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mi mathvariant="bold">a</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>k</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>Using this intermittent feedback structure (<xref ref-type="fig" rid="pcbi.1005681.g006">Fig 6C</xref>), the learning problem in <xref ref-type="disp-formula" rid="pcbi.1005681.e005">Eq (4)</xref> is roughly reduced to the impulse learning problem of <xref ref-type="disp-formula" rid="pcbi.1005681.e001">Eq (1)</xref>, albeit on a slower time scale. Using the HRF physiological response in our automated learning simulations, a cue period of 3 TRs, and a subsequent wait period of 3 TRs, we found that intermittent feedback also led to successful learning (<xref ref-type="fig" rid="pcbi.1005681.g006">Fig 6D</xref>).</p>
</sec>
<sec id="sec007">
<title>Activating simulated visual cortex using reinforcement of spontaneous neural activity</title>
<p>Given that our automatic learning model worked to elicit a desired pattern of activity in a simple two-voxel model, our next goal was to train activation patterns in our full V1 model without directly stimulating it with grating images (i.e. a simulation of the experiment performed by Shibata et al. (2011) [<xref ref-type="bibr" rid="pcbi.1005681.ref025">25</xref>]). Using the same neural model as the cognitive experiment (which contains spatial noise correlations typical of fMRI), we constructed a 3-way sparse logistic regression classifier (<xref ref-type="fig" rid="pcbi.1005681.g007">Fig 7A</xref>) and aimed to elicit the pattern of activity associated with a grating oriented at 10°. Our comparison of continuous versus intermittent feedback was similar to the cognitive experiment, with continuous feedback provided every 2 seconds (<xref ref-type="fig" rid="pcbi.1005681.g007">Fig 7B</xref>), and a cue replacing the direct stimulus during intermittent trials (<xref ref-type="fig" rid="pcbi.1005681.g007">Fig 7C</xref>). We then aimed to test how different internal models affected automatic learning. Specifically, we addressed whether learning could occur with different delayed or blurred underlying physiological responses, and if so, how accurate did the internal model need to be? In addition to a general hypothesis that intermittent feedback would be superior, we hypothesized that for continuous feedback, matched filter-model combinations (e.g. HRF-HRF) would produce the best learning, whereas incongruent filter-model combinations (e.g. HRF-delay) would produce the least learning.</p>
<fig id="pcbi.1005681.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005681.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Automatic learning of grating patterns in simulated V1.</title>
<p><bold>(A)</bold> A 3-way sparse logistic regression classifier was used, with feedback provided from the 10° classifier output. <bold>(B)</bold> For continuous trials, feedback was provided to the learning model every 2 seconds. <bold>(C)</bold> Intermittent trials followed a cue-wait-feedback structure. <bold>(D)</bold> Learning curves were generated by averaging the classifier output at each time point over 1000 simulated participants for each condition. Filled plots indicate the mean and 50% confidence interval (CI) for each time point, which was further filtered using a 200-sec moving average filter (about 1% of the total time course) for graphical presentation purposes. Chance is indicated at 0.33. Plots are colored according to feedback success.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005681.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Automatic learning of neurofeedback signals requires an accurate internal model</title>
<p>Our automatic learning simulations show that successful learning in the absence of cognitive strategies depends on the underlying physiological response and the internal model used to interpret that temporal response (<xref ref-type="fig" rid="pcbi.1005681.g007">Fig 7D</xref>). For example, for the HRF physiological response, successful learning was found with a cue model. Moderate learning was found with HRF and blur models, with HRF leading to quicker learning than blur. No learning was found with an impulse model, and a delay model resulted in anti-learning. These results align with our simple two-voxel model (<xref ref-type="fig" rid="pcbi.1005681.g006">Fig 6</xref>). This confirms that increased dimensionality and moderate spatial noise correlation do not have an effect on the working principle of our automatic learning model.</p>
<p>Contrary to our hypothesis, we found that with a continuous feedback signal, matched filter-model combinations only led to successful learning for impulse-impulse and delay-delay combinations. The incongruent blur-impulse filter also showed successful learning and was superior to the matched blur-blur model. We believe this can be explained by the temporal dependency of the system: the learned signal is integrated over time, so successful spontaneous activity should be captured and reinforced as soon as possible. With the impulse internal model, as soon as successful activity occurs, it is captured by the blur filter and is immediately reinforced. With a blur internal model, this successful activity is only reinforced at 20% strength (averaged across the previous 5 TRs, or 10 sec of simulated neural data), and becomes lost in the noise. Another temporal relationship may also explain why a delay internal model does not result in learning of the blur filter, whereas an impulse model does. Both of these internal models sample one time point from the blur filter, and all 5 TRs (10 seconds) are weighted equally. However, our model only learns when there is a change in the feedback signal. When successful activity occurs, the change in feedback signal is immediately captured by the blur physiological response filter and reflected as a change in the feedback signal that an impulse internal model can learn from. If a delay internal model is used instead, there is no change in feedback signal at the 3 TR delay, and thus no learning occurs.</p>
<p>For intermittent feedback, we see successful learning for the HRF, delay, and blur filters. Indeed, this feedback schedule has been successful for automatic learning of fMRI acivity patterns [<xref ref-type="bibr" rid="pcbi.1005681.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref028">28</xref>]. These results suggests that the same intermittent feedback schedule can be used to learn a variety of physiological responses as long as the neural activity in the cue period is reliably recorded during the wait period.</p>
</sec>
<sec id="sec009">
<title>Automatic learning of spatial patterns depends on spontaneous activity correlations</title>
<p>While our model was able to learn to achieve a large classifier output, it is possible that this occurred simply due to activity in one or two voxels. To address this concern, we performed an additional simulation with visualizable activity patterns (<xref ref-type="fig" rid="pcbi.1005681.g008">Fig 8</xref>). The 200 tuned voxels and 3 classifier weight maps from our V1 model were randomly placed onto a 20x20 (400-voxel) surface. Conditioning was performed using the hrf-cue filter-model combination from <xref ref-type="fig" rid="pcbi.1005681.g007">Fig 7D</xref>, as is common in decoded neurofeedback experiments [<xref ref-type="bibr" rid="pcbi.1005681.ref025">25</xref>]. Over 1000 simulated participants using the same noise parameters as <xref ref-type="fig" rid="pcbi.1005681.g007">Fig 7</xref> (e.g. without spontaneous activity correlations), we found that the classifier output was indeed driven by a distributed pattern of activity. However, this activity correlated more strongly with the classifier weights associated with the target orientation (<italic>r</italic> = 0.44) than the true orientation-associated pattern (<italic>r</italic> = 0.15). This pattern of correlations was also found in the two non-target orientations: larger magnitude correlations with classifier weights (<italic>r</italic> = −0.20, −0.22) relative to the true orientation patterns (<italic>r</italic> = −0.08, −0.07). These negative correlations indicate that the patterns associated with non-target orientations are punished, which is consistent with the <italic>softmax</italic> operation of the classifier capturing information from all three classifier weight maps.</p>
<fig id="pcbi.1005681.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005681.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Conditioned patterns of activity with and without spontaneous activity correlations.</title>
<p>True orientation-associated patterns, classifier weight maps, and conditioned activity patterns were projected onto a 2D surface. Patterns of activity were distributed across voxels and were not dominated by one or two voxels. For each of the three classifier orientations (<xref ref-type="fig" rid="pcbi.1005681.g007">Fig 7A</xref>), the true underlying pattern associated with the stimulus is shown (without spontaneous activity added), as well as its corresponding classifier weight map. 1000 patterns were conditioned to purely random Gaussian noise (‘without spontaneous activity correlations’), while 1000 patterns were conditioned with a mixture of Gaussian noise and a random orientation signal (‘with spontaneous activity correlations’). Feedback was provided from the 10° classifier output for both types of conditioning. One example of each type of conditioned pattern is shown. The displayed correlations are the mean correlation across all 1000 patterns.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005681.g008" xlink:type="simple"/>
</fig>
<p>Weak correlations with the true orientation patterns are likely related to the sparsity [<xref ref-type="bibr" rid="pcbi.1005681.ref031">31</xref>] of the classifier: the classifier does not select all voxels associated with the true orientation pattern, so how could the model learn activity in these unselected voxels? True patterns of spontaneous activity in V1 are not truly random: they tend to contain information associated with visual attributes [<xref ref-type="bibr" rid="pcbi.1005681.ref034">34</xref>]. If orientation signals are present in the spontaneous activity, then our model should be able to learn activity in voxels not selected by the classifier. To test this hypothesis, we introduced a noise model that was a half-and-half mixture of random Gaussian noise and a random orientation signal between 0° and 180°. This random orientation signal ensured that while visual attributes were included in the spontaneous activity, it did not have any bias toward the target orientation. Using the same conditioning procedure as before, we found that this noise model resulted in conditioned patterns that had much stronger correlations with the true target pattern (<italic>r</italic> = 0.63) and weakened correlations with the target classifier weight map (<italic>r</italic> = 0.35) (<xref ref-type="fig" rid="pcbi.1005681.g008">Fig 8</xref>).</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>We simulated fMRI activity in visual cortex to determine how feedback timing affects learning of neurofeedback signals with different physiological responses and self-regulation strategies. Our first experiment had human participants find hidden visual targets (oriented gratings) using only simulated neural activity as a feedback learning signal. We used four physiological filters in this experiment: instantaneous feedback, the canonical HRF of fMRI, and isolated delay and blur filters. One group was exposed to continuous feedback, while another saw intermittent feedback. In a second experiment, we fully simulated the automatic learning of neurofeedback signals, examining how continuous and intermittent feedback could be used to induce a pattern of activity in simulated visual cortex without stimulus presentation. We found that continuous feedback was best for cognitive strategies, whereas intermittent feedback was better for automatic learning. For cognitive learning of neurofeedback, we found that all properties of hemodynamics impair neurofeedback learning, but the delay of the continuous feedback signal affects learning more than the blur. For automatic learning, we found that intermittent feedback was able to absorb differences in hemodynamic properties to facilitate learning, whereas a precise and accurate model of the hemodynamic response was necessary for learning with continuous feedback.</p>
<p>Our analyses isolated cognitive and automatic learning of a simulated neurofeedback signal under ideal conditions. In practice, neurofeedback experiments are often underspecified, and may rely upon some combination of both learning techniques [<xref ref-type="bibr" rid="pcbi.1005681.ref008">8</xref>]. Because of the interaction between feedback timing and learning technique, our results suggest that either cognitive or automatic learning strategies should be chosen before feedback timing is scheduled in an fMRI neurofeedback experiment. Furthermore, while the relative effects of blur and delay shown in our cognitive results apply to all neurofeedback studies with a prescribed cognitive strategy, the absolute performance we reported (e.g., time-to-target in a search for a hidden target neural activity pattern) does not apply to the majority of fMRI neurofeedback studies because of the simple, unidimensional nature of our cognitive strategy and the arbitrary SNR that was used. Increasing noise and allowing for more complex, multidimensional strategies could drastically increase time-to-target in our simulation. The static relationship between stimulus and brain activity was a further simplification that may not hold true when the ‘stimulus’ is a complex cognitive strategy chosen by a participant. Importantly, these pitfalls do not apply to automatic processing: strategy is not chosen by the participant, and noise due to spontaneous activity is displayed as useful information in the feedback signal. Therefore, unless a simple, known cognitive strategy will reliably elicit the desired neural activity, our results suggest that automatic processing is more likely to result in successful learning of fMRI neurofeedback signals.</p>
<p>Our automatic learning model answers the question: given an internal model of the temporal dynamics of the feedback signal, how is the feedback signal learned? It does not attempt to explain how this internal model may be generated or adapted over time. While the feedback/wait/cue structure of intermittent feedback is a plausible mechanism to create a stable internal model that is agnostic to the actual temporal characteristics of the underlying physiological response, it is unclear how an internal model would be created for a continuous feedback signal. For example, given verbal instructions about the blur or delay of the feedback signal, their translation into a filter applied to an internal memory buffer of neural activity is unknown. In the absence of instruction, animals effectively use a short time scale, near-impulse model to self-regulate continuous electrophysiological signals (For a detailed model involving spiking neurons, see Legenstein et al. (2008) [<xref ref-type="bibr" rid="pcbi.1005681.ref033">33</xref>]). For longer time scales, it is widely accepted that conditioning can occur as long as the delay to reinforcement is predictable [<xref ref-type="bibr" rid="pcbi.1005681.ref035">35</xref>]. However, without a predictable cue structure, a pessimistic viewpoint would argue that the impulse model is used by default for continuous feedback signals, which is ineffective for learning feedback signals that are significantly delayed or blurred.</p>
<p>There is evidence to show that a neural representation of time exists to store neural activity in memory [<xref ref-type="bibr" rid="pcbi.1005681.ref017">17</xref>]. This temporal representation becomes less accurate the longer the delay, but nevertheless provides a mechanism for a continous-time internal model. The problem is then still: which time delay does the brain choose to reinforce? The difficulty of creating an appropriate internal model may explain the inability for some participants to gain control over continuous fMRI neurofeedback signals, and could therefore underlie the “non-responder” challenge in human neurofeedback [<xref ref-type="bibr" rid="pcbi.1005681.ref010">10</xref>]. Our simulation results are inconsistent with the results of Ramot et al. (2016) [<xref ref-type="bibr" rid="pcbi.1005681.ref036">36</xref>], who used continuous feedback of the hemodynamic response to shape neural activity in the absence of awareness of the meaning of the feedback signal. It would appear that either participants were able to generate a working internal model of the temporal characteristics of the feedback signal (e.g. the blur or HRF internal models applied to the HRF physiological response in <xref ref-type="fig" rid="pcbi.1005681.g007">Fig 7D</xref>) in the absence of external cues, or these results were simply obtained by chance without any true neuromodulation due to the feedback signal. Another pitfall of using continuous feedback in automatic learning is that an incorrect internal model can result in anti-learning. For example, the impulse-HRF and HRF-delay models end up worse than chance (<xref ref-type="fig" rid="pcbi.1005681.g007">Fig 7D</xref>). Verbal instructions may help participants tune their internal models, but given that one of the common instructions (a 6-second delay internal model) resulted in anti-learning in our simulation, this seems risky compared to simply scheduling feedback intermittently.</p>
<p>Our automatic learning simulations also shed light on the debate regarding how patterns of activity can be learned in a high-dimensional voxel space [<xref ref-type="bibr" rid="pcbi.1005681.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1005681.ref038">38</xref>]. Huang (2016) argues that because participants do not have cognitive access to the voxel space, the dimensionality of this space is too large for participants to reliably discover an effective cognitive strategy to activate the desired pattern. Shibata et al. (2016) counter-argue that the dimensionality of the search space is actually much smaller than the voxel space would suggest due to correlations in V1 activity. We provide an alternative explanation to both arguments. First, cognitive access to the voxel space is not required since automatic learning circuits can reward the underlying neural activity without participant awareness. Second, a global (whole-brain) reward signal allows complex activity patterns to be conditioned, even with high-dimensional spontaneous neural activity patterns.</p>
<p>The neurofeedback simulation framework reported here is intended as a proof of concept: we started with a simplified model of V1 for clarity. Looking forward, this model has two major limitations. First, our noise model did not include any measurement noise, so all simulated activity was a result of spontaneous activity and not error in the simulated measurement. Measurement noise would almost certainly have a negative impact on learning, but the ratio of signal/spontaneous/measurement noise in fMRI is difficult to quantify [<xref ref-type="bibr" rid="pcbi.1005681.ref039">39</xref>] so we chose to simplify our model and leave open the potential to improve its specificity in future iterations. Our noise was also Gaussian with local spatial correlation. This noise model is not sophisticated enough to capture the true complexity of visual cortex: we know that correlational structures exist within spontaneous activity in V1, and that these patterns tend to correlate with basic visual attributes [<xref ref-type="bibr" rid="pcbi.1005681.ref034">34</xref>]. We also know that using neurofeedback signals that match patterns of spontaneous activity are easier to learn [<xref ref-type="bibr" rid="pcbi.1005681.ref040">40</xref>]. Therefore, adding a more realistic correlational structure to our noise model should not affect the qualitative relationship between physiological responses and internal models, but rather it should show that patterns that commonly occur spontaneously will be easier to learn through neurofeedback. Indeed, when we added random visual attributes to our spontaneous activity model (<xref ref-type="fig" rid="pcbi.1005681.g008">Fig 8</xref>), we found that conditioned activity patterns more closely matched the target orientation pattern compared to conditioning with completely random spontaneous activity. Second, our spatial capture model was based on meta-parameters from prior work [<xref ref-type="bibr" rid="pcbi.1005681.ref004">4</xref>]. An advanced spatial capture model, such as one recently developed by Kriegeskorte and Diedrichsen (2016) [<xref ref-type="bibr" rid="pcbi.1005681.ref041">41</xref>], could be used as a basis for the simulated neurofeedback signal. This capture model shows that shifts in voxel sampling over finer-grained neural activity can bias the recorded representational structure of stimuli. Such a model could help determine whether neurofeedback is feasible given a specific neuroimaging method and targeted neural pattern.</p>
<p>Overall, our model demonstrated an important contrast between cognitive and automatic neurofeedback strategies, suggesting that different self-regulation mechanisms prefer different feedback schedules. These findings have significant implications for any experiment involving the feedback of delayed or blurred signals, and have direct applications for the design of neurofeedback schedules and instructed strategies for future fMRI neurofeedback experiments. Furthermore, the simulation framework provides a basis to evaluate and optimize the design of such experiments before they are performed with real neuroimaging data.</p>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec012">
<title>Ethics statement</title>
<p>This study was approved by the University of Texas Institutional Review Board. Written informed consent was obtained from the participants.</p>
</sec>
<sec id="sec013">
<title>Participants</title>
<p>Forty-eight healthy participants (27 female; average age 20.34 years, SD = 3.08) were recruited for the experiment. Participants were randomly assigned into 2 groups: 24 received continuous feedback and 24 received intermittent feedback.</p>
</sec>
<sec id="sec014">
<title>Apparatus</title>
<p>Participants were seated at a computer (21.5” iMac) and used the arrow keys on a standard keyboard to perform the experiment. Data were sampled and displayed at 60 Hz using Matlab and Psychtoolbox 3 on Mac OS X. No neuroimaging apparatus was required.</p>
</sec>
<sec id="sec015">
<title>Model parameters: Voxel-based V1 captured by simulated fMRI</title>
<p>Our model of V1 (<xref ref-type="fig" rid="pcbi.1005681.g002">Fig 2a</xref>) is based on meta-parameters extracted from Kamitani and Tong (2005) [<xref ref-type="bibr" rid="pcbi.1005681.ref004">4</xref>]: a 1000-voxel cube of 3x3x3mm voxels, with 20% of voxels tuned to grating orientation (2.5% to each of 8 orientations) and 80% of voxels untuned. The tuning curve for each voxel is a decaying exponential, with full output (arbitrary units) at the tuned orientation, decaying to 1/16 output at the orthogonal orientation. Underlying neural activity is generated according to the orientation of the stimulus and the corresponding voxel tunings. Spatially correlated spontaneous activity (Gaussian random field with 5mm kernel) is added to this tuned activity and the result is convolved in time with a physiological response filter.</p>
<p>The four physiological responses (<xref ref-type="fig" rid="pcbi.1005681.g001">Fig 1E</xref>) are sampled at 0.5Hz, corresponding to the 2 second time repetition (TR) of standard fMRI capture. Therefore, the impulse samples one TR of activity with no delay, the delay samples one TR of activity with a 3-TR delay, and the blur averages over the previous 5 TRs. The HRF filter is a weighted average of the previous 15 TRs of activity, according to the canonical fMRI BOLD response. All filters were normalized such that the sum of their weights equalled one.</p>
</sec>
<sec id="sec016">
<title>Model parameters: Cognitive learning</title>
<p>The classifier used to decode cognitively-elicited simulated fMRI patterns in real-time (<xref ref-type="fig" rid="pcbi.1005681.g002">Fig 2B</xref>) used a sparse logistic regression classifier [<xref ref-type="bibr" rid="pcbi.1005681.ref031">31</xref>] because this technique has been successfully applied to fMRI data from V1 [<xref ref-type="bibr" rid="pcbi.1005681.ref024">24</xref>]. To train the classifier, we simulated 800 training examples (100 each of the 8 tuned orientations: 0°, 22.5°, …, 157.5°) using a voxelwise signal-to-noise ratio (SNR) of 2 (tuning curve peak = 1; spontaneous activity <italic>σ</italic><sub><italic>n</italic></sub> = 0.5). These parameters were chosen to approximate the results from a two-hour-long pattern localizer experiment [<xref ref-type="bibr" rid="pcbi.1005681.ref004">4</xref>].</p>
<p>We generated simulated brain activity online using the predetermined grating orientation-voxel activation relationship. For each time repetition (TR = 2 seconds), the mean grating orientation during that period was input to the model. Through piloting, we found that with a realistic SNR of 2, participants often reached targets by chance rather than through interpretation of the feedback signal. We therefore increased the SNR of all voxels (tuned and untuned) to 10 (spontaneous activity <italic>σ</italic><sub><italic>n</italic></sub> = 0.1). This increased the reliability of the feedback signal for participants so that we could more readily examine the temporal characteristics of the physiological signals.</p>
<p>The simulated neurofeedback signal was calculated using a weighting of the eight decoded orientation probabilities from the classifier. Specifically, the feedback signal was calculated by the dot product of the vector of classifier probabilities and a tuning curve, where the tuning curve was a decaying exponential circularly shifted to align its peak with the target orientation. This resulted in a smooth, gradually increasing feedback signal throughout the stimulus orientation range, instead of one that remained low and then peaked sharply at the target orientation. For example, if the classifier was 100% confident that the grating was 22.5° away from the target, the classifier would output a 0% probability for the target orientation, even though the participant was near the target. By using the dot product of the tuning curve and the raw classifier output for all orientations, the simulated neurofeedback signal for a grating 22.5° away from the target is 50% (instead of 0% if only the classifier output for the target orientation was used). If the classifier was 100% confident the grating was 45° away from the target, this dot product would instead output 25%, and so on. Importantly, the scalar output of this dot product always lies between 0 and 1, so it can easily be displayed on a thermometer without additional scaling.</p>
<p>To determine whether participants had reached the target, a threshold of 85% classifier output at the target was selected because this corresponded to roughly 5–10 degrees of grating orientation error from the target (depending on noise) and was feasible for participants to reach during piloting of the experiment. If the average classifier output over 3 consecutive TRs preceeding a feedback period exceeded this threshold, the trial was considered successful and a new trial began.</p>
</sec>
<sec id="sec017">
<title>Procedure: Visual display</title>
<p>We used a square-wave grating, 50% contrast, 0.5 cycles/degree, visible from 4–20° of visual angle. A black fixation circle was centered with a diameter of 0.5°. The green feedback circle was linearly mapped from 0–100% classifier output to 0.6–3.5°. A grey circle was displayed at 85% (3.065°) to indicate the success threshold. On training trials, the target was shown to participants so that they could learn how the feedback signal behaved. On these trials, a target orientation grating was shown (square-wave, 50% contrast, 0.5 cycles/degree, 4.5°), appearing underneath the feedback circle but on top of the stimulus grating, slightly covering it.</p>
</sec>
<sec id="sec018">
<title>Procedure: Continuous feedback</title>
<p>Continuous target search timings are summarized in <xref ref-type="fig" rid="pcbi.1005681.g003">Fig 3B</xref>. Each continuous target search began with the grating oriented horizontally (0°). Participants rotated the grating image using either the left (counter-clockwise) or right (clockwise) arrow keys (<xref ref-type="fig" rid="pcbi.1005681.g003">Fig 3A</xref>). While either key was depressed, the grating rotated at a constant rate of 45°/second. The grating did not rotate if neither or both keys were pressed. The V1 model was updated every two seconds based on the mean grating orientation over the previous two seconds. At each update period, the feedback circle expanded or contracted over 500ms from the previous value to the updated value to ensure a smooth visual display. If the average feedback signal exceeded the success threshold circle for three consecutive TRs, the target was considered reached and participants saw their grating orientation in grey overlaid with the true target orientation in green (<xref ref-type="fig" rid="pcbi.1005681.g003">Fig 3B</xref>).</p>
<p>Continuous target searches were organized into four blocks, with each block using one of the four candidate physiological filters. The first block was always the impulse condition, because this was the easiest condition and served as familiarization for participants. The next three blocks were the three other physiological filters: HRF, blur, and delay. Ordering of these three blocks was counterbalanced across participants. Each block began with three visible training targets at 45°, 90°, and 135°, so that participants could familiarize themselves with the feedback signal dynamics. This was followed by 14 hidden targets, randomly located at 0°, 22.5°, …, 157.5°, with two targets per orientation. A self-paced rest period was provided between each block, with an indication that the feedback signal behavior was about to change. Each block lasted about 10 to 20 minutes, depending on participant ability and the difficulty of each physiological filter.</p>
</sec>
<sec id="sec019">
<title>Procedure: Intermittent feedback</title>
<p>Intermittent trial timings are summarized in <xref ref-type="table" rid="pcbi.1005681.t001">Table 1</xref>, with non-accelerated timings illustrated in <xref ref-type="fig" rid="pcbi.1005681.g003">Fig 3C</xref>. Each intermittent target began with the grating oriented horizontally (0°), and participants had three seconds to select an initial orientation. During this orientation selection period, the grating was greyed out (25% contrast) and rotated at a constant rate of 60°/second according to participants’ button presses. Rotation speed was increased relative to continuous feedback to allow for a full 180° of rotation during the 3 second adjustment period. Next, the stimulus was displayed at full contrast (50%) for a stimulus period whose duration depended on the feedback acceleration factor. Following a variable-length delay period (depending on feedback acceleration), feedback associated with the stimulus was presented for two seconds. The feedback signal was calculated by stimulating the V1 model with the selected orientation for 3 TRs (6 seconds), then averaging the feedback signal recorded in the following 3 TRs to account for the physiological delay. If the feedback signal exceeded the success threshold, participants saw their selected grating orientation in grey overlaid with the true target orientation in green (<xref ref-type="fig" rid="pcbi.1005681.g003">Fig 3C</xref>). If the feedback score did not reach the success threshold, a new trial with the same target began after a brief (depending on feedback acceleration) wait period. Starting from the second trial for a given target, the feedback display period began with a smooth 500ms update from the previous trial’s feedback value. Intermittent trials were organized into seven blocks with nine targets each. Targets were randomly located at 0°, 22.5°, …, 157.5°, with nine targets per orientation. The first three targets of the first block had the target visible to familizarize participants. All remaining targets were hidden. A self-paced rest period was provided between each block.</p>
<table-wrap id="pcbi.1005681.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005681.t001</object-id>
<label>Table 1</label>
<caption>
<title>Intermittent trial timings.</title>
</caption>
<alternatives>
<graphic id="pcbi.1005681.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005681.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Acceleration</th>
<th align="center">Select</th>
<th align="center">Stimulus</th>
<th align="center">Delay</th>
<th align="center">Feedback</th>
<th align="center">Wait</th>
<th align="center">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Real-time</td>
<td align="center">3 sec</td>
<td align="center">6 sec</td>
<td align="center">6 sec</td>
<td align="center">2 sec</td>
<td align="center">3 sec</td>
<td align="center">20 sec</td>
</tr>
<tr>
<td align="center">2x</td>
<td align="center">3 sec</td>
<td align="center">3 sec</td>
<td align="center">3 sec</td>
<td align="center">2 sec</td>
<td align="center">2 sec</td>
<td align="center">13 sec</td>
</tr>
<tr>
<td align="center">6x</td>
<td align="center">3 sec</td>
<td align="center">1 sec</td>
<td align="center">1 sec</td>
<td align="center">2 sec</td>
<td align="center">1 sec</td>
<td align="center">8 sec</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec020">
<title>Procedure: Accelerated intermittent feedback</title>
<p>We introduced and validated an accelerated intermittent feedback protocol to reduce experimental duration while preserving the trial-by-trial intermittent feedback signal characteristics. Accelerated intermittent trial timings are summarized in <xref ref-type="table" rid="pcbi.1005681.t001">Table 1</xref>. Our validation used only the HRF physiological response filter. Targets were randomly and evenly assigned one of three trial timings: real-time, 2x accelerated, and 6x accelerated. The real-time timing corresponded to the required timing if a real physiological signal were measured: 6 seconds of stimulus, 6 seconds of waiting for the physiological signal to catch up, and 6 seconds between the end of feedback and the beginning of the next stimulus to allow the physiological signal to return to baseline. The 2x and 6x acceleration factor trials had the stimulus and subsequent wait period sped up accordingly. While these resulted in shorter trials (13s and 8s respectively), the trial-by-trial feedback signal was still simulated according to the real-time protocol, meaning that there was no difference in the trial-by-trial information observed by participants. This allowed us to investigate whether performance was affected by delays between stimulus and feedback. Participants (n = 10) were not informed about the different acceleration factors, which changed on a target-by-target basis but were constant for all trials on a given target. We constructed a linear mixed effects model of trials to target using feedback acceleration as a fixed effect and participant as a random effect. There was no significant effect of acceleration factor (F = 0.239, p = 0.788). Thus, all remaining intermittent feedback participants (n = 14) were exposed to the 6x acceleration factor.</p>
</sec>
<sec id="sec021">
<title>Procedure: Intermittent feedback with different physiological responses</title>
<p>In this intermittent feedback protocol, the HRF, delay, and blur physiological filters were used. The impulse filter was not used because this signal is not captured by our intermittent feedback calculation and participants cannot achieve an above-chance classifier output to reach the target. Targets were randomly and evenly assigned one of the three physiological filters. Unlike the continuous feedback condition, participants were not informed about the different filters because the feedback timing was identical between conditions, although signal quality did vary based on the physiological filter used.</p>
<p>Because we found that accelerating feedback did not significantly affect performance at the task, all trials in the intermittent feedback condition used the 6x acceleration factor, allowing us to record more trials in less time. When calculating the time that participants took to reach targets, we always used the non-accelerated time (20s per trial), because this is representative of how long the experiment would actually take if it were conducted inside the MRI scanner.</p>
</sec>
<sec id="sec022">
<title>Statistical analysis: Cognitive neurofeedback performance</title>
<p>Our outcome measure for performance on each trial was the amount of time needed to find the hidden target. For continuous and intermittent feedback, we constructed separate linear mixed effects models to predict time-to-target using physiological response as a fixed effect and participant as a random effect. Tukey’s post-hoc test (<italic>α</italic> &lt;0.05) was used to determine the differences between each condition. For intermittent feedback, we could not directly measure time-to-target as in the continuous condition because of the feedback acceleration factor. Instead, we calculated this performance metric by counting the number of trials needed to reach the target and multiplying this by 20 seconds (the ‘real-time’ cost of each trial), and subtracting 5 seconds of time cost because there is no wait period at the beginning of the first trial (3 seconds) and success occurs as soon as the calculated feedback score exceeds the threshold (2 seconds from the final feedback period). To compare continuous and intermittent feedback, we performed two sample t-tests for each physiological response filter, comparing between the continuous and intermittent feedback groups.</p>
</sec>
<sec id="sec023">
<title>Model parameters: Automatic learning</title>
<p>We constructed a new 3-way classifier to emulate Shibata et al. (2011) [<xref ref-type="bibr" rid="pcbi.1005681.ref025">25</xref>], which used three target orientations: 10°, 70°, and 130° (<xref ref-type="fig" rid="pcbi.1005681.g002">Fig 2C</xref>). We used only 3 orientations because our learning model was unable to learn the non-convex objective function associated with the 8-way classifier used in our cognitive experiment. For training our pattern decoder, we simulated 210 training examples (70 of each orientation) with an SNR of 2, using the same V1 model described earlier (tuned to 8 orientations). For our real-time simulation, we also used an SNR of 2 (<italic>σ</italic><sub><italic>n</italic></sub> = 0.5). Unlike our cognitive simulation, where spontaneous activity corrupted the feedback signal and was treated as noise, here we leveraged this ‘noise’ whenever it spontaneously matched the desired pattern of activity. Therefore, we did not have to increase the SNR as we did in the cognitive experiment in order to make the signal learnable. Also unlike our cognitive experiment, we did not apply a tuning curve to the classifier outputs because we wanted to match the feedback signal presented by Shibata et al. (2011) [<xref ref-type="bibr" rid="pcbi.1005681.ref025">25</xref>].</p>
</sec>
<sec id="sec024">
<title>Procedure: Automatic learning simulation</title>
<p>We simulated five hours of neurofeedback training per simulated participant with a learning rate of 1% per 20 seconds, roughly matching the time scale of learning found by Shibata et al. (2011) [<xref ref-type="bibr" rid="pcbi.1005681.ref025">25</xref>]. For intermittent feedback simulations, this corresponded to a rate of 1% per trial; for continuous simulations, this corresponded to a rate of 0.1% per 2 second TR.</p>
<p>All four physiological filters from the cognitive experiment (<xref ref-type="fig" rid="pcbi.1005681.g001">Fig 1E</xref>) were used in the automatic simulation. We also had five possibilities for internal models (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5A</xref>). For continuous feedback trials (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5B</xref>), we used the four physiological filters for our four possible internal models: each matched filter should capture the time series of neural activity that resulted in the continuous feedback signal. For example, if the true physiological filter is an HRF, an internal model of HRF would apply the feedback to a memory trace of the preceding neural activity that gave rise to the feedback signal (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5D</xref>). For intermittent feedback trials (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5C</xref>), we used a single internal model generated by the cue-wait-feedback trial structure: activity during the 6-sec cue period is kept in memory and reinforced each trial based on the change in the delayed feedback signal. The cue structure also ensured that conditioned activity was only elicited during the cue period (<xref ref-type="fig" rid="pcbi.1005681.g005">Fig 5E</xref>). The intermittent feedback signal was calculated using an average of the recorded response during the wait period, similar to cognitive intermittent trials. Therefore, there were 20 total conditions simulated: 16 for continuous feedback with four physiological filters and four possible internal models, and 4 for intermittent feedback with only one internal model (cue). Because the simulated time series was non-deterministic due to spontaneous activity, we simulated each condition 1000 times to determine the distribution of responses at each time point over the course of learning.</p>
</sec>
<sec id="sec025">
<title>Statistical analysis: Automatic learning</title>
<p>The learning quality for each condition (combination of physiological filter and internal model) was evaluated based on the mean and the 50% confidence interval (CI) of the classifier output at each time point, combined across all simulated participants (1000 per condition). Over the course of 5 hours of simulated neurofeedback training, simulated participants were categorized into four categories: successful learning, trending learning, no learning, and anti-learning. Successful learning curves had a 50% CI ending well above chance. Trending learning curves increased over time, but at a much slower rate than than successful curves, and had a 50% CI that extended into chance at the end of training. Curves with no learning were flat. Anti-learning curves had a 50% CI that ended below chance. Because these classifications were arbitrary, we further ranked internal models for each physiological filter by the average final value of the classifier at the end of training. Pearson’s <italic>r</italic> was used to assess correlations between conditioned patterns, desired activity patterns, and classifier weight maps. Mean correlations with conditioned patterns were calculated by taking the correlation across 1000 examples and taking the mean of these correlations (e.g. not a single correlation with the mean conditioned pattern).</p>
</sec>
</sec>
</body>
<back>
<ack>
<p>We thank Dr. Robbe Goris for his helpful comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005681.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Walsh</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Cowey</surname> <given-names>A</given-names></name>. <article-title>Transcranial magnetic stimulation and cognitive neuroscience</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2000</year>;<volume>1</volume>(<issue>1</issue>):<fpage>73</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35036239" xlink:type="simple">10.1038/35036239</ext-link></comment> <object-id pub-id-type="pmid">11252771</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brunoni</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Nitsche</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Bolognini</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bikson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wagner</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Merabet</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Clinical research with transcranial direct current stimulation (tDCS): challenges and future directions</article-title>. <source>Brain stimulation</source>. <year>2012</year>;<volume>5</volume>(<issue>3</issue>):<fpage>175</fpage>–<lpage>195</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.brs.2011.03.002" xlink:type="simple">10.1016/j.brs.2011.03.002</ext-link></comment> <object-id pub-id-type="pmid">22037126</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Norman</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Polyn</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Detre</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Haxby</surname> <given-names>JV</given-names></name>. <article-title>Beyond mind-reading: multi-voxel pattern analysis of fMRI data</article-title>. <source>Trends in cognitive sciences</source>. <year>2006</year>;<volume>10</volume>(<issue>9</issue>):<fpage>424</fpage>–<lpage>430</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tics.2006.07.005" xlink:type="simple">10.1016/j.tics.2006.07.005</ext-link></comment> <object-id pub-id-type="pmid">16899397</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kamitani</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tong</surname> <given-names>F</given-names></name>. <article-title>Decoding the visual and subjective contents of the human brain</article-title>. <source>Nature neuroscience</source>. <year>2005</year>;<volume>8</volume>(<issue>5</issue>):<fpage>679</fpage>–<lpage>685</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1444" xlink:type="simple">10.1038/nn1444</ext-link></comment> <object-id pub-id-type="pmid">15852014</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Haynes</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Rees</surname> <given-names>G</given-names></name>. <article-title>Predicting the orientation of invisible stimuli from activity in human primary visual cortex</article-title>. <source>Nature neuroscience</source>. <year>2005</year>;<volume>8</volume>(<issue>5</issue>):<fpage>686</fpage>–<lpage>691</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn1445" xlink:type="simple">10.1038/nn1445</ext-link></comment> <object-id pub-id-type="pmid">15852013</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wiestler</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Diedrichsen</surname> <given-names>J</given-names></name>. <article-title>Skill learning strengthens cortical representations of motor sequences</article-title>. <source>Elife</source>. <year>2013</year>;<volume>2</volume>:<fpage>e00801</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.7554/eLife.00801" xlink:type="simple">10.7554/eLife.00801</ext-link></comment> <object-id pub-id-type="pmid">23853714</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kornysheva</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Diedrichsen</surname> <given-names>J</given-names></name>. <article-title>Human premotor areas parse sequences into their spatial and temporal features</article-title>. <source>Elife</source>. <year>2014</year>;<volume>3</volume>:<fpage>e03043</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.7554/eLife.03043" xlink:type="simple">10.7554/eLife.03043</ext-link></comment> <object-id pub-id-type="pmid">25117541</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sitaram</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Ros</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stoeckel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Haller</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Scharnowski</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Lewis-Peacock</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Closed-loop brain training: the science of neurofeedback</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2017</year>;<volume>18</volume>(<issue>2</issue>):<fpage>86</fpage>–<lpage>100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn.2016.164" xlink:type="simple">10.1038/nrn.2016.164</ext-link></comment> <object-id pub-id-type="pmid">28003656</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref009">
<label>9</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Allison</surname> <given-names>BZ</given-names></name>, <name name-style="western"><surname>Neuper</surname> <given-names>C</given-names></name>. <chapter-title>Could anyone use a BCI?</chapter-title> In: <source>Brain-computer interfaces</source>. <publisher-name>Springer</publisher-name>; <year>2010</year>. p. <fpage>35</fpage>–<lpage>54</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005681.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hammer</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Halder</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Blankertz</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sannelli</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Dickhaus</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kleih</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Psychological predictors of SMR-BCI performance</article-title>. <source>Biological psychology</source>. <year>2012</year>;<volume>89</volume>(<issue>1</issue>):<fpage>80</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.biopsycho.2011.09.006" xlink:type="simple">10.1016/j.biopsycho.2011.09.006</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Blankertz</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sannelli</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Halder</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hammer</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Kübler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Müller</surname> <given-names>KR</given-names></name>, <etal>et al</etal>. <article-title>Neurophysiological predictor of SMR-based BCI performance</article-title>. <source>Neuroimage</source>. <year>2010</year>;<volume>51</volume>(<issue>4</issue>):<fpage>1303</fpage>–<lpage>1309</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2010.03.022" xlink:type="simple">10.1016/j.neuroimage.2010.03.022</ext-link></comment> <object-id pub-id-type="pmid">20303409</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Halder</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Varkuti</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bogdan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kübler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rosenstiel</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Sitaram</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Prediction of brain-computer interface aptitude from individual brain structure</article-title>. <source>Frontiers in human neuroscience</source>. <year>2013</year>;<volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnhum.2013.00105" xlink:type="simple">10.3389/fnhum.2013.00105</ext-link></comment> <object-id pub-id-type="pmid">23565083</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Witte</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kober</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Ninaus</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Neuper</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wood</surname> <given-names>G</given-names></name>. <article-title>Control beliefs can predict the ability to up-regulate sensorimotor rhythm during neurofeedback training</article-title>. <source>Frontiers in human neuroscience</source>. <year>2013</year>;<volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnhum.2013.00478" xlink:type="simple">10.3389/fnhum.2013.00478</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Evans</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gale</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schurger</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Blanke</surname> <given-names>O</given-names></name>. <article-title>Visual feedback dominates the sense of agency for brain-machine actions</article-title>. <source>PloS one</source>. <year>2015</year>;<volume>10</volume>(<issue>6</issue>):<fpage>e0130019</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0130019" xlink:type="simple">10.1371/journal.pone.0130019</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Boynton</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Engel</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Glover</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Heeger</surname> <given-names>DJ</given-names></name>. <article-title>Linear systems analysis of functional magnetic resonance imaging in human V1</article-title>. <source>The Journal of Neuroscience</source>. <year>1996</year>;<volume>16</volume>(<issue>13</issue>):<fpage>4207</fpage>–<lpage>4221</lpage>. <object-id pub-id-type="pmid">8753882</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Glover</surname> <given-names>GH</given-names></name>. <article-title>Deconvolution of impulse response in event-related bold fMRI</article-title>. <source>Neuroimage</source>. <year>1999</year>;<volume>9</volume>(<issue>4</issue>):<fpage>416</fpage>–<lpage>429</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/nimg.1998.0419" xlink:type="simple">10.1006/nimg.1998.0419</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shankar</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Howard</surname> <given-names>MW</given-names></name>. <article-title>A scale-invariant internal representation of time</article-title>. <source>Neural Computation</source>. <year>2012</year>;<volume>24</volume>(<issue>1</issue>):<fpage>134</fpage>–<lpage>193</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00212" xlink:type="simple">10.1162/NECO_a_00212</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sulzer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Haller</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Scharnowski</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Weiskopf</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Birbaumer</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Blefari</surname> <given-names>ML</given-names></name>, <etal>et al</etal>. <article-title>Real-time fMRI neurofeedback: progress and challenges</article-title>. <source>Neuroimage</source>. <year>2013</year>;<volume>76</volume>:<fpage>386</fpage>–<lpage>399</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2013.03.033" xlink:type="simple">10.1016/j.neuroimage.2013.03.033</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johnson</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Hartwell</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>LeMatty</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Borckardt</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Morgan</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Govindarajan</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Intermittent “Real-time” fMRI feedback is superior to continuous presentation for a motor imagery task: a pilot study</article-title>. <source>Journal of Neuroimaging</source>. <year>2012</year>;<volume>22</volume>(<issue>1</issue>):<fpage>58</fpage>–<lpage>66</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1552-6569.2010.00529.x" xlink:type="simple">10.1111/j.1552-6569.2010.00529.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Emmert</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kopel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Koush</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Maire</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Senn</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Van De Ville</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Continuous vs. intermittent neurofeedback to regulate auditory cortex activity of tinnitus patients using real-time fMRI-A pilot study</article-title>. <source>NeuroImage: Clinical</source>. <year>2017</year>;<volume>14</volume>:<fpage>97</fpage>–<lpage>104</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.nicl.2016.12.023" xlink:type="simple">10.1016/j.nicl.2016.12.023</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hubel</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Wiesel</surname> <given-names>TN</given-names></name>. <article-title>Receptive fields and functional architecture of monkey striate cortex</article-title>. <source>The Journal of physiology</source>. <year>1968</year>;<volume>195</volume>(<issue>1</issue>):<fpage>215</fpage>–<lpage>243</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.1968.sp008455" xlink:type="simple">10.1113/jphysiol.1968.sp008455</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tong</surname> <given-names>F</given-names></name>. <article-title>Primary visual cortex and visual awareness</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2003</year>;<volume>4</volume>(<issue>3</issue>):<fpage>219</fpage>–<lpage>229</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn1055" xlink:type="simple">10.1038/nrn1055</ext-link></comment> <object-id pub-id-type="pmid">12612634</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alink</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Krugliak</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Walther</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>. <article-title>fMRI orientation decoding in V1 does not require global maps or globally coherent orientation stimuli</article-title>. <source>Frontiers in Psychology</source>. <year>2013</year>;<volume>4</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fpsyg.2013.00493" xlink:type="simple">10.3389/fpsyg.2013.00493</ext-link></comment> <object-id pub-id-type="pmid">23964251</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yamashita</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Sato</surname> <given-names>Ma</given-names></name>, <name name-style="western"><surname>Yoshioka</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tong</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kamitani</surname> <given-names>Y</given-names></name>. <article-title>Sparse estimation automatically selects voxels relevant for the decoding of fMRI activity patterns</article-title>. <source>NeuroImage</source>. <year>2008</year>;<volume>42</volume>(<issue>4</issue>):<fpage>1414</fpage>–<lpage>1429</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2008.05.050" xlink:type="simple">10.1016/j.neuroimage.2008.05.050</ext-link></comment> <object-id pub-id-type="pmid">18598768</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shibata</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sasaki</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Kawato</surname> <given-names>M</given-names></name>. <article-title>Perceptual learning incepted by decoded fMRI neurofeedback without stimulus presentation</article-title>. <source>Science</source>. <year>2011</year>;<volume>334</volume>(<issue>6061</issue>):<fpage>1413</fpage>–<lpage>1415</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1212003" xlink:type="simple">10.1126/science.1212003</ext-link></comment> <object-id pub-id-type="pmid">22158821</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>deCharms</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Maeda</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Glover</surname> <given-names>GH</given-names></name>, <name name-style="western"><surname>Ludlow</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pauly</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Soneji</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Control over brain activation and pain learned by using real-time functional MRI</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2005</year>;<volume>102</volume>(<issue>51</issue>):<fpage>18626</fpage>–<lpage>18631</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0505210102" xlink:type="simple">10.1073/pnas.0505210102</ext-link></comment> <object-id pub-id-type="pmid">16352728</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cortese</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Amano</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Koizumi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kawato</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>H</given-names></name>. <article-title>Multivoxel neurofeedback selectively modulates confidence without changing perceptual performance</article-title>. <source>Nature Communications</source>. <year>2016</year>;<volume>7</volume>:<fpage>13669</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ncomms13669" xlink:type="simple">10.1038/ncomms13669</ext-link></comment> <object-id pub-id-type="pmid">27976739</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shibata</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kawato</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sasaki</surname> <given-names>Y</given-names></name>. <article-title>Differential activation patterns in the same brain region led to opposite emotional states</article-title>. <source>PLoS biology</source>. <year>2016</year>;<volume>14</volume>(<issue>9</issue>):<fpage>e1002546</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1002546" xlink:type="simple">10.1371/journal.pbio.1002546</ext-link></comment> <object-id pub-id-type="pmid">27608359</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Amano</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shibata</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kawato</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sasaki</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>T</given-names></name>. <article-title>Learning to associate orientation with color in early visual areas by associative decoded fMRI neurofeedback</article-title>. <source>Current Biology</source>. <year>2016</year>;<volume>26</volume>(<issue>14</issue>):<fpage>1861</fpage>–<lpage>1866</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cub.2016.05.014" xlink:type="simple">10.1016/j.cub.2016.05.014</ext-link></comment> <object-id pub-id-type="pmid">27374335</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koizumi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Amano</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Cortese</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shibata</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Yoshida</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Fear reduction without fear through reinforcement of neural activity that bypasses conscious exposure</article-title>. <source>Nature Human Behaviour</source>. <year>2016</year>;<volume>1</volume>(<issue>6</issue>).</mixed-citation>
</ref>
<ref id="pcbi.1005681.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Krishnapuram</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Carin</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Figueiredo</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Hartemink</surname> <given-names>AJ</given-names></name>. <article-title>Sparse multinomial logistic regression: Fast algorithms and generalization bounds</article-title>. <source>IEEE transactions on pattern analysis and machine intelligence</source>. <year>2005</year>;<volume>27</volume>(<issue>6</issue>):<fpage>957</fpage>–<lpage>968</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TPAMI.2005.127" xlink:type="simple">10.1109/TPAMI.2005.127</ext-link></comment> <object-id pub-id-type="pmid">15943426</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref032">
<label>32</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Sutton</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name>. <source>Reinforcement learning: An introduction</source>. <volume>1</volume>. <publisher-name>MIT press</publisher-name> <publisher-loc>Cambridge</publisher-loc>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005681.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Legenstein</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pecevski</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Maass</surname> <given-names>W</given-names></name>. <article-title>A learning theory for reward-modulated spike-timing-dependent plasticity with application to biofeedback</article-title>. <source>PLoS Comput Biol</source>. <year>2008</year>;<volume>4</volume>(<issue>10</issue>):<fpage>e1000180</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000180" xlink:type="simple">10.1371/journal.pcbi.1000180</ext-link></comment> <object-id pub-id-type="pmid">18846203</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kenet</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bibitchkov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tsodyks</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grinvald</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Arieli</surname> <given-names>A</given-names></name>. <article-title>Spontaneously emerging cortical representations of visual attributes</article-title>. <source>Nature</source>. <year>2003</year>;<volume>425</volume>(<issue>6961</issue>):<fpage>954</fpage>–<lpage>956</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature02078" xlink:type="simple">10.1038/nature02078</ext-link></comment> <object-id pub-id-type="pmid">14586468</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gallistel</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Gibbon</surname> <given-names>J</given-names></name>. <article-title>Time, rate, and conditioning</article-title>. <source>Psychological review</source>. <year>2000</year>;<volume>107</volume>(<issue>2</issue>):<fpage>289</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1037/0033-295X.107.2.289" xlink:type="simple">10.1037/0033-295X.107.2.289</ext-link></comment> <object-id pub-id-type="pmid">10789198</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ramot</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grossman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Malach</surname> <given-names>R</given-names></name>. <article-title>Covert neurofeedback without awareness shapes cortical network spontaneous connectivity</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>;<volume>113</volume>(<issue>17</issue>):<fpage>E2413</fpage>–<lpage>E2420</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1516857113" xlink:type="simple">10.1073/pnas.1516857113</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huang</surname> <given-names>TR</given-names></name>. <article-title>Hebbian Plasticity for Improving Perceptual Decisions</article-title>. <source>arXiv preprint arXiv:161203270</source>. <year>2016</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005681.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shibata</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sasaki</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Watanabe</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kawato</surname> <given-names>M</given-names></name>. <article-title>Response to Comment on’Perceptual Learning Incepted by Decoded fMRI Neurofeedback Without Stimulus Presentation’; How can a decoded neurofeedback method (DecNef) lead to successful reinforcement and visual perceptual learning?</article-title> <source>arXiv preprint arXiv:161204234</source>. <year>2016</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005681.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Welvaert</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rosseel</surname> <given-names>Y</given-names></name>. <article-title>On the definition of signal-to-noise ratio and contrast-to-noise ratio for fMRI data</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>11</issue>):<fpage>e77089</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0077089" xlink:type="simple">10.1371/journal.pone.0077089</ext-link></comment> <object-id pub-id-type="pmid">24223118</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sadtler</surname> <given-names>PT</given-names></name>, <name name-style="western"><surname>Quick</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Golub</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Chase</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Ryu</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Tyler-Kabara</surname> <given-names>EC</given-names></name>, <etal>et al</etal>. <article-title>Neural constraints on learning</article-title>. <source>Nature</source>. <year>2014</year>;<volume>512</volume>(<issue>7515</issue>):<fpage>423</fpage>–<lpage>426</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature13665" xlink:type="simple">10.1038/nature13665</ext-link></comment> <object-id pub-id-type="pmid">25164754</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005681.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kriegeskorte</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Diedrichsen</surname> <given-names>J</given-names></name>. <article-title>Inferring brain-computational mechanisms with models of activity measurements</article-title>. <source>Phil Trans R Soc B</source>. <year>2016</year>;<volume>371</volume> (<issue>1705</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2016.0278" xlink:type="simple">10.1098/rstb.2016.0278</ext-link></comment> <object-id pub-id-type="pmid">27574316</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>