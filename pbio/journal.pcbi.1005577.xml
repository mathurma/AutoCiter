<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005577</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01446</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Enzymology</subject><subj-group><subject>Enzyme chemistry</subject><subj-group><subject>Enzyme metabolism</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Metabolic networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolomics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Pharmacology</subject><subj-group><subject>Pharmacokinetics</subject><subj-group><subject>Drug metabolism</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Enzymology</subject><subj-group><subject>Enzyme chemistry</subject><subj-group><subject>Enzyme regulation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Cell labeling</subject><subj-group><subject>Metabolic labeling</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Cell labeling</subject><subj-group><subject>Metabolic labeling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Enzymology</subject><subj-group><subject>Enzymes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Enzymes</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Metabolites</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Metabolic network segmentation: A probabilistic graphical modeling approach to identify the sites and sequential order of metabolic regulation from non-targeted metabolomics data</article-title>
<alt-title alt-title-type="running-head">Inference of metabolic regulation by metabolomics and network segmentation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kuehne</surname>
<given-names>Andreas</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-9842-5776</contrib-id>
<name name-style="western">
<surname>Mayr</surname>
<given-names>Urs</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sévin</surname>
<given-names>Daniel C.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Claassen</surname>
<given-names>Manfred</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1271-1021</contrib-id>
<name name-style="western">
<surname>Zamboni</surname>
<given-names>Nicola</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Institute of Molecular Systems Biology, ETH Zurich, Switzerland</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>PhD Program Systems Biology, Life Science Zurich Graduate School, Zurich, Switzerland</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ouzounis</surname>
<given-names>Christos A.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Centre for Research and Technology-Hellas, GREECE</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"> <list-item>
<p><bold>Conceptualization:</bold> AK MC NZ.</p></list-item> <list-item>
<p><bold>Formal analysis:</bold> AK.</p></list-item> <list-item>
<p><bold>Funding acquisition:</bold> MC NZ.</p></list-item> <list-item>
<p><bold>Investigation:</bold> AK UM DCS.</p></list-item> <list-item>
<p><bold>Methodology:</bold> AK MC NZ.</p></list-item> <list-item>
<p><bold>Resources:</bold> NZ.</p></list-item> <list-item>
<p><bold>Software:</bold> AK.</p></list-item> <list-item>
<p><bold>Supervision:</bold> MC NZ.</p></list-item> <list-item>
<p><bold>Validation:</bold> AK UM DCS.</p></list-item> <list-item>
<p><bold>Visualization:</bold> AK.</p></list-item> <list-item>
<p><bold>Writing – original draft:</bold> AK MC NZ.</p></list-item> <list-item>
<p><bold>Writing – review &amp; editing:</bold> AK MC NZ.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">claassen@imsb.biol.ethz.ch</email> (MC); <email xlink:type="simple">zamboni@imsb.biol.ethz.ch</email> (NZ)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>9</day>
<month>6</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>6</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>6</issue>
<elocation-id>e1005577</elocation-id>
<history>
<date date-type="received">
<day>6</day>
<month>9</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>16</day>
<month>5</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Kuehne et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005577"/>
<abstract>
<p>In recent years, the number of large-scale metabolomics studies on various cellular processes in different organisms has increased drastically. However, it remains a major challenge to perform a systematic identification of mechanistic regulatory events that mediate the observed changes in metabolite levels, due to complex interdependencies within metabolic networks. We present the metabolic network segmentation (MNS) algorithm, a probabilistic graphical modeling approach that enables genome-scale, automated prediction of regulated metabolic reactions from differential or serial metabolomics data. The algorithm sections the metabolic network into modules of metabolites with consistent changes. Metabolic reactions that connect different modules are the most likely sites of metabolic regulation. In contrast to most state-of-the-art methods, the MNS algorithm is independent of arbitrary pathway definitions, and its probabilistic nature facilitates assessments of noisy and incomplete measurements. With serial (i.e., time-resolved) data, the MNS algorithm also indicates the sequential order of metabolic regulation. We demonstrated the power and flexibility of the MNS algorithm with three, realistic case studies with bacterial and human cells. Thus, this approach enables the identification of mechanistic regulatory events from large-scale metabolomics data, and contributes to the understanding of metabolic processes and their interplay with cellular signaling and regulation processes.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Reciprocal crosstalk between metabolism and cellular signaling pathways plays a crucial role in cellular decision-making. In recent years, this premise has motivated several metabolomics studies that aimed to gain a mechanistic understanding of metabolic phenotypes. However, due to complex interactions within metabolic networks, it remains a challenge to infer mechanisms that underlie metabolome changes. We present the metabolic network segmentation approach, a novel method that aimed to identify the sites and sequential order of metabolic regulatory events, based merely on steady state or dynamic metabolomics data. This method employs probabilistic graphical models to partition the entire metabolic network into modules with correlated metabolites. It identifies fractures between modules (i.e., reactions that connect non-correlated metabolites) as sites of regulation. We performed validation and benchmark analyses in hundreds of <italic>E</italic>. <italic>coli</italic> knockout mutants deficient in enzymes and transcription factors. Moreover, we verified the capability of our method for identifying the sequential order of metabolic regulatory events by testing it on fibroblasts exposed to oxidative stress. Our metabolic network segmentation algorithm is widely applicable, and thus, it will enhance our mechanistic understanding of metabolic phenotypes and their connections to cellular signaling and regulatory processes.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>SystemsX.ch</institution>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Kuehne</surname>
<given-names>Andreas</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was partially funded by SystemsX.ch (IPhD grant to AK; <ext-link ext-link-type="uri" xlink:href="http://www.systemsx.ch/" xlink:type="simple">http://www.systemsx.ch/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="1"/>
<page-count count="26"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-06-23</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The MNS toolbox is available at <ext-link ext-link-type="uri" xlink:href="http://www.imsb.ethz.ch/research/zamboni/resources.html" xlink:type="simple">http://www.imsb.ethz.ch/research/zamboni/resources.html</ext-link> or <ext-link ext-link-type="uri" xlink:href="https://github.com/kuehnean/MNS_toolbox/" xlink:type="simple">https://github.com/kuehnean/MNS_toolbox/</ext-link> under GPLv3 license. Source data and code to reproduce the analyses included in the paper are available at <ext-link ext-link-type="uri" xlink:href="http://www.imsb.ethz.ch/research/zamboni/resources.html" xlink:type="simple">http://www.imsb.ethz.ch/research/zamboni/resources.html</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a PLoS Computational Biology Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The consolidated notion that metabolites can provide feedback to cellular signaling and alter metabolism is a hallmark of several diseases. This notion has boosted interest in gaining a mechanistic and quantitative understanding of metabolic phenotypes [<xref ref-type="bibr" rid="pcbi.1005577.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005577.ref003">3</xref>]. Consequently, researchers in the field of metabolomics have established a battery of methods for large-scale analyses of metabolite levels in all sample types [<xref ref-type="bibr" rid="pcbi.1005577.ref004">4</xref>]. Continual advances in instrumentation and protocols for metabolomics have led to an exponential production of high-quality data on the metabolome. The quality of the data is reflected in the high number of detectable metabolites and the high experimental reproducibility. Due to these advances, it has become common that every study discovers multiple significant metabolite changes. This positive trend, however, has exacerbated the problem of interpreting metabolome changes.</p>
<p>In the context of systems or cellular biology, interpretations of metabolome data aim to generate testable hypotheses about the molecular events that might have led to the observed metabolome pattern. The quest for mechanisms underlying metabolome changes is complicated by the complex relationship between metabolite levels, enzyme properties, and metabolic fluxes [<xref ref-type="bibr" rid="pcbi.1005577.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref006">6</xref>]; by the dozens of pathways connected to key metabolites; and by our partial understanding of cellular regulation [<xref ref-type="bibr" rid="pcbi.1005577.ref007">7</xref>]. This complexity is a non-trivial problem that cannot be addressed with traditional uni- and multivariate statistical techniques, which are generally used to identify markers or classify samples [<xref ref-type="bibr" rid="pcbi.1005577.ref007">7</xref>]. Instead, prior knowledge of the metabolic or regulatory networks must be embedded into the analysis for an efficient inference of the links that gave rise to the observed metabolome changes.</p>
<p>Mechanistic model-based approaches enable to model the dynamics of the metabolic network and its interactions at molecular level. Therefore these modelling approaches have been commonly considered the methods of choice for inferring mechanisms and regulatory events [<xref ref-type="bibr" rid="pcbi.1005577.ref008">8</xref>]. However, such an in depth mechanistic description of metabolism requires detailed knowledge of the model structure and the kinetic parameters, which in many cases limits model size and applicability (reviewed in [<xref ref-type="bibr" rid="pcbi.1005577.ref008">8</xref>]). Recent ensemble modelling approaches employed high dimensional fluxomics datasets to generate large-scale kinetic metabolic models of the well-studied model organism <italic>Escherichia coli</italic>. These approaches have been successful in, for example, estimating flux changes and metabolite yields metabolism of <italic>Escherichia coli</italic>, predicting metabolite yields in engineered <italic>E</italic>. <italic>coli</italic> enzyme mutant <italic>strains</italic> [<xref ref-type="bibr" rid="pcbi.1005577.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref010">10</xref>]. Yet in many studies only metabolite levels and not metabolic fluxes are available. Therefore mechanistic modelling approaches for exclusively metabolomics data have been limited to well-defined, small metabolic models with known reaction stoichiometry and only a few dozen reactions and metabolites. Nevertheless, these models were highly successfully applied for example to identify regulations from absolutely quantified metabolomics data and dynamic modeling [<xref ref-type="bibr" rid="pcbi.1005577.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005577.ref013">13</xref>]. However, modern, large-scale metabolomics tools enable one to profile hundreds to thousands of metabolites throughout the metabolic network [<xref ref-type="bibr" rid="pcbi.1005577.ref014">14</xref>]. For such large metabolomics datasets, in most cases only less well-defined models with at least ten-fold more features, reactions, and parameters are available; thus, current mechanistic-based approaches are prone to failure.</p>
<p>Consequently, an ongoing effort to develop alternative, simpler computational tools has capitalized on current knowledge of metabolic networks to facilitate detailed interpretations of large-scale metabolomics data. These tools include metabolic pathway enrichment analyses and visualizations of metabolite changes on maps of metabolic networks (Reviewed in [<xref ref-type="bibr" rid="pcbi.1005577.ref007">7</xref>]). These approaches can simplify the analysis and interpretation of metabolomics data, but they can also be limited by their reliance on fixed significance cutoffs for grouping metabolites, fixed pathway definitions, and highly user-biased interpretations. These limitations can preclude discovery of unexpected regulatory events. Two approaches, namely reporter reactions and mass action ratios, were developed to make automatic predictions of regulatory sites, based on metabolomics data [<xref ref-type="bibr" rid="pcbi.1005577.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref016">16</xref>]. Both these approaches are based on the assumption that a given metabolic perturbation, such as inhibiting a metabolic enzyme, will induce the strongest, most significant metabolic alterations in the levels of substrates and products. To date, these approaches have been solely applied to small metabolic subnetworks with a few dozen metabolites, of which almost all were measured. However, these methods tend to give misleading results in regions that are sparsely covered in an analytical metabolome, like peripheral pathways. Thus, randomly sampled data would have to replace undetected metabolites, and presumably, model performance would decline [<xref ref-type="bibr" rid="pcbi.1005577.ref016">16</xref>].</p>
<p>To overcome this issue, we developed the metabolic network segmentation (MNS) algorithm. This generalized approach aimed to identify the regulated metabolic reactions responsible for the end point or dynamics of large-scale metabolomics experiments. In contrast to other approaches, which aim to reconstruct networks based on correlations between metabolites [<xref ref-type="bibr" rid="pcbi.1005577.ref017">17</xref>–<xref ref-type="bibr" rid="pcbi.1005577.ref019">19</xref>], we sought to identify reactions in the metabolic network that exhibited broken symmetry; i.e., metabolic changes, where substrates and products were not correlated. Our algorithm partitioned the metabolic network into regions of neighboring metabolites with consistent changes, and it identified reactions between two regions—so called fractures—as potential sites of metabolic regulation (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1a</xref>).</p>
<fig id="pcbi.1005577.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005577.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Design and implementation of the metabolic network segmentation algorithm, a probabilistic graphical modelling approach to identify sites of metabolic regulation.</title>
<p>(a) Principle of the algorithm to identify sites of metabolic regulation using metabolomics data and metabolic network reconstructions. The algorithm segments the metabolic network into modules of highly similar changes. To deal with sparse and noisy metabolite measurements, it considers dependencies between neighboring metabolites to extend the modules. Fractures between two modules are potential sites of metabolic regulation. (b) Structure of the Markov random field model. The discrete hidden variables <italic>y</italic> represent the modules to which a metabolite belongs, the observed variables <italic>x</italic> integrate the metabolite measurements. The factor potential functions introduce probabilistic dependencies between neighboring hidden states (<italic>ψ</italic><sub><italic>N</italic></sub>) and between measurements and the hidden states (<italic>ψ</italic><sub><italic>O</italic></sub>). (c) Example of neighborhood and observation factor potential functions. The neighborhood factor potentials are module label dependent exponential decay functions. The influence of the metabolic neighborhood is controlled by <italic>λ</italic><sub>1</sub>. Observation potential functions link hidden state/module labels to metabolic observations by hidden state dependent Gaussian distributions. (d) Algorithm workflow of the scan mode implementation to automatically identify sites of metabolic regulation. Details in <xref ref-type="supplementary-material" rid="pcbi.1005577.s001">S1 Fig</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.g001" xlink:type="simple"/>
</fig>
<p>Our algorithm is based on the undirected subclass of probabilistic graphical models, known as Markov random fields (MRFs), which were introduced by Lenz and Ising in the 1920’s to describe ferromagnetic materials [<xref ref-type="bibr" rid="pcbi.1005577.ref020">20</xref>]. MRFs consist of nodes that represent random variables and arcs that describe the probabilistic dependencies between connected random variables [<xref ref-type="bibr" rid="pcbi.1005577.ref021">21</xref>]. Therefore, MRFs have been successfully applied in diverse machine learning tasks that include noisy and incomplete data with underlying sequential or spatial structure [<xref ref-type="bibr" rid="pcbi.1005577.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref022">22</xref>]. For example, in computer vision, these models are used for image segmentation or image reconstruction, where they employ dependency assumptions between neighboring pixels [<xref ref-type="bibr" rid="pcbi.1005577.ref022">22</xref>]. Likewise, the metabolic network defines an underlying spatial structure, where the substrates and products of a reaction are dependent. For example, given an unperturbed reaction, one would assume that changes in substrate and product levels should correlate. Given the structured nature of metabolism, MRFs are an ideal approach for pattern recognition in biochemical networks.</p>
<p>Here, we demonstrate that our approach outperformed current state-of-the-art algorithms in the identification of known regulatory sites and the prediction of novel regulatory sites. Moreover, we extended the algorithm for metabolomics data with serial structure, such as time courses. This unique extension enabled the model both to identify sites and also to determine the sequential order of events, i.e., the timing of metabolic regulatory steps.</p>
</sec>
<sec id="sec002">
<title>Design and implementation of the MNS algorithm</title>
<sec id="sec003">
<title>Inference of metabolic regulation sites from univariate metabolomics data</title>
<p>The goal of our approach was to predict sites of metabolic regulation, such as activated or inhibited enzymes, from differential metabolomics data. These data were obtained from a univariate comparison of metabolite levels across conditions. Supported by experimental data [<xref ref-type="bibr" rid="pcbi.1005577.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref016">16</xref>], we designed the MNS algorithm based on the assumption that the strongest metabolic changes occur in close proximity of a perturbed enzyme (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1a</xref>). For example, when a flux-carrying enzyme is inhibited by a drug, we expected that the substrate and its precursors would accumulate, and the product levels would decrease. In contrast to existing methods, we did not focus solely on the direct substrate and products for the inference; instead, we aimed to segment the entire metabolic network into regions of consistent metabolite changes, so-called metabolic modules, where fractures between two modules are potential sites of metabolic regulation (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1a</xref>). To deal with sparse and noisy metabolite measurements, our algorithm considered interdependencies between neighboring metabolites for predictions; i.e., we assumed that reactant levels of an unperturbed reaction would correlate.</p>
<p>Our algorithm was designed to build on organism-specific, genome-wide, metabolic network reconstructions. It employs main reactant-pair models, obtained from the KEGG database with a modified version of the MetaboNetworks toolbox [<xref ref-type="bibr" rid="pcbi.1005577.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref024">24</xref>]. For each metabolite in the network, we introduced a discrete hidden variable, y<sub>i</sub> ∈ <bold>y</bold>, into a MRF model (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1b</xref>). The discrete values of the hidden variables represented the labels of the metabolic modules to which a certain metabolite belonged. Specifically, metabolites with similarly decreasing, increasing, or constant metabolite levels were likely to have the same label. The module labels of the hidden variables were not known <italic>a priori</italic> (hidden), but they were inferred by the algorithm through optimization of the conditional likelihood.</p>
<p>To account for network structure and proximity, we defined probabilistic dependencies between hidden variables that represented the reactants of the main reactant pairs (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1b</xref>). Assuming that, in an unperturbed system, neighboring metabolites should be in the same module, we enforced a local homogeneity between neighboring hidden variables by introducing for each maximal clique (c<sub>j</sub>) in the hidden layer, a neighborhood factor potential, ψ<sub>N,j</sub>(c<sub>j</sub>). The maximal clique was defined as a maximal subset of nodes (i.e., metabolites), which were all connected to each other. The neighborhood factor potential ψ<sub>N,j</sub>(c<sub>j</sub>) was a hidden state, label dependent, exponential decay function, defined by:
<disp-formula id="pcbi.1005577.e001">
<alternatives>
<graphic id="pcbi.1005577.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where the <italic>unique(c</italic><sub><italic>j</italic></sub><italic>)</italic> equals the number of different labels of hidden variables involved in a maximal clique, <italic>c</italic><sub><italic>j</italic></sub>; the <italic>size</italic>(<italic>c</italic><sub><italic>j</italic></sub>) is the number of hidden variables in the <italic>c</italic><sub><italic>j</italic></sub>; and <italic>λ</italic><sub><italic>1</italic></sub> is a weighting factor that controls the strength of the neighborhood influence (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1c</xref>).</p>
<p>Because the states of the hidden variables were required to be dependent on the metabolite data, for each detected metabolite of a given dataset, we introduced a continuous observed variable, x<sub>i</sub> ∈ <bold>x</bold>, which represented the metabolic change, based on a univariate comparison, e.g., the log<sub>2</sub>(fold-change) or the z-scores (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1b</xref>). The dependency between hidden and observed states was described by an observation factor potential, ψ<sub>O,i</sub>(x<sub>i</sub>,y<sub>i</sub>), which described their relationship with hidden state-dependent Gaussian distributions, as follows
<disp-formula id="pcbi.1005577.e002">
<alternatives>
<graphic id="pcbi.1005577.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mrow><mml:mi>O</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>σ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>μ(y</italic><sub><italic>i</italic></sub><italic>)</italic> and <italic>σ(y</italic><sub><italic>i</italic></sub><italic>)</italic> are the hidden state-dependent mean values and standard deviations, respectively (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1c</xref>). The hidden state-dependent mean values were defined as either the mean values of the clusters obtained from a k-means clustering (k-means) analysis, or as the values equally distributed between the 0.001 and 0.999 quantiles of the complete dataset (quantile, <xref ref-type="supplementary-material" rid="pcbi.1005577.s011">S1 Table</xref>). The standard deviations can be set to a constant user-defined value (fixed); or they can be individually obtained from the standard deviations of the k-means clusters (k-means); or they can be set to the standard deviation of the complete dataset (all data, <xref ref-type="supplementary-material" rid="pcbi.1005577.s011">S1 Table</xref>). Together, the neighborhood and observation factor potentials of all metabolites, i ∈ M, and all maximal cliques, j ∈ C, describe the conditional likelihood of the MRF model, defined as
<disp-formula id="pcbi.1005577.e003">
<alternatives>
<graphic id="pcbi.1005577.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:munderover><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>σ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>By maximizing the conditional likelihood, the optimal hidden state label distribution, <inline-formula id="pcbi.1005577.e004"><alternatives><graphic id="pcbi.1005577.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, can now be determined as follows:
<disp-formula id="pcbi.1005577.e005">
<alternatives>
<graphic id="pcbi.1005577.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi></mml:munder><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Due to the complexity of our network, we employed an approximation algorithm called LazyFlipper, available in the OpenGM toolbox, to infer the best hidden states [<xref ref-type="bibr" rid="pcbi.1005577.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref026">26</xref>].</p>
<p>To infer regulatory sites, our algorithm repetitively segmented the metabolic network by estimating the most likely hidden states, <inline-formula id="pcbi.1005577.e006"><alternatives><graphic id="pcbi.1005577.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, with increasing neighborhood influence, λ<sub>1</sub> (<xref ref-type="supplementary-material" rid="pcbi.1005577.s001">S1 Fig</xref>). The fractures between individual modules represented potential regulatory sites. This procedure was inspired by the watershed algorithm for image segmentation [<xref ref-type="bibr" rid="pcbi.1005577.ref027">27</xref>]; it assumes that the fractures identified at a high neighborhood influence, λ<sub>1</sub>, are most likely biologically meaningful. Sequential scanning through λ<sub>1</sub> values was performed in a two-step process. In the initial step, λ<sub>1</sub> was exponentially increased until all metabolites were assigned to the same module, and no more fractures were found. Then, in the second step, an extensive search within a linear range of λ<sub>1</sub> was performed, which resulted in a list of fractures for each given λ<sub>1</sub>. The likelihood that each fracture represented a site of metabolic regulation was quantified with two entities. One entity was the fracture counts (#fractures), i.e., for how many values of λ<sub>1</sub> can a given reaction be identified as a fracture between two modules? The second entity was the maximum λ<sub>1</sub> value (max(λ<sub>1</sub>)) at which a reaction remained classified as a fracture (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1d</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005577.s002">S2</xref> Figs). The significance of the fractures could then be determined with a permutation test, by comparing the real outcome with the outcome from 1000 repetitions of the analysis performed with permuted metabolite labels (<xref ref-type="supplementary-material" rid="pcbi.1005577.s001">S1 Fig</xref>). The p-value for each reaction, with max(λ<sub>1</sub>) = λ* and #fractures = n, can then be calculated as follows:
<disp-formula id="pcbi.1005577.e007">
<alternatives>
<graphic id="pcbi.1005577.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>λ</mml:mi><mml:mtext>*</mml:mtext></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>≥</mml:mo><mml:msup><mml:mi>λ</mml:mi><mml:mtext>*</mml:mtext></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
and
<disp-formula id="pcbi.1005577.e008">
<alternatives>
<graphic id="pcbi.1005577.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mo>#</mml:mo><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>n</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>#</mml:mo><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi><mml:mo>≥</mml:mo><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>#</mml:mo><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>m</mml:mi><mml:mi>u</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>To combine the inference results of individual predictors with different parameterizations, the max(λ<sub>1</sub>) and #fracture rankings were integrated with the rank product. The most likely regulated reactions were ordered by ascending rank products. Significance for the rank products was calculated, as described previously [<xref ref-type="bibr" rid="pcbi.1005577.ref028">28</xref>].</p>
</sec>
<sec id="sec004">
<title>Identification of the sequential order of metabolic regulation steps from dynamic metabolomics data</title>
<p>Metabolism provides the molecular building blocks, energy, and redox equivalents to fulfill the physiological needs of a cell. Therefore, a given metabolic perturbation must be compensated by other metabolic branches to sustain the cell’s physiological requirements. This means that a metabolic perturbation can cause primary regulation events, i.e., the enzymatic target of a perturbation, and secondary regulation events, i.e., the metabolic regulation events required to compensate for the effects of the perturbation. Thus, in metabolomics research, it is often crucial to know which enzymes are regulated, and in addition, the causal order of these regulation events. Differences in the sequence of regulation events given dynamic data, called sequential order from here, can give a first indication for causal regulatory interactions For example, the timing of regulations can distinguish between primary and secondary effects of a drug. However, to date, no method is available that can automatically infer the sequence of regulation events. To enable such analyses, we extended our approach for identifying sites to include identifications of the sequential order of metabolic regulation steps, based on dynamic metabolomics data, such as time courses or compound dilution series (<xref ref-type="fig" rid="pcbi.1005577.g002">Fig 2a</xref>). Specifically, the sequential data was split into individual frames, and each frame was represented by a MRF model for univariate data, as described previously (Figs <xref ref-type="fig" rid="pcbi.1005577.g001">1b</xref> and <xref ref-type="fig" rid="pcbi.1005577.g002">2b</xref>). We assumed that, without perturbation, the levels of a given metabolite at two consecutive data points were invariant. Therefore, we introduced a dependency on sequential data points with a sequence factor potential function ψ<sub>S</sub>(y<sub>i,s-1</sub>,y<sub>i,s</sub>), which connected hidden variables of neighboring frames (<xref ref-type="fig" rid="pcbi.1005577.g002">Fig 2b</xref>), as follows:
<disp-formula id="pcbi.1005577.e009">
<alternatives>
<graphic id="pcbi.1005577.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:mrow><mml:msub><mml:mi>ψ</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mtext> </mml:mtext><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi>i</mml:mi><mml:mi>f</mml:mi><mml:mtext> </mml:mtext><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>≠</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where λ<sub>2</sub> is a weighting factor that quantifies the influences of neighboring sequence frames on each other. Given this sequence dependency, the conditional likelihood was defined as:
<disp-formula id="pcbi.1005577.e010">
<alternatives>
<graphic id="pcbi.1005577.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e010" xlink:type="simple"/>
<mml:math display="block" id="M10">
<mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>Z</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>C</mml:mi></mml:munderover><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>σ</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∏</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mi>e</mml:mi><mml:mi>x</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where S is the total number of sequence frames, y<sub>i,s</sub> and x<sub>i,s</sub> are the hidden and observed variables, respectively, and c<sub>j,s</sub> is the maximal neighborhood clique for each sequence frame, s. Similar to the univariate approach, we aimed to enable automatic identifications of sequences and neighborhood fractures with a scanning process (<xref ref-type="supplementary-material" rid="pcbi.1005577.s003">S3 Fig</xref>). First, the ranges of the neighborhood and the sequence weights, λ<sub>1</sub> and λ<sub>2</sub>, were defined individually by exponentially increasing λ<sub>1</sub> with constant λ<sub>2</sub> = 0, until no more neighborhood fractures were identifiable, and by exponentially increasing λ<sub>2</sub> with constant λ<sub>1</sub> = 0 until no more fractures were found. Second, the neighborhood and sequence fractures were extracted by inference of the hidden state labels for every parameter combination, during a scan through all combinations of the defined ranges of λ<sub>1</sub> and λ<sub>2</sub>.</p>
<fig id="pcbi.1005577.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005577.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Principle of the algorithm to identify sites and sequential order of metabolic regulations from sequential metabolomics data.</title>
<p>a) Principle of the algorithm to identify sites and sequential order of regulations from metabolomics data with sequential structure. The metabolomics data gets split into individual frames, for which the regulated reactions get identified through metabolic network segmentation. (b) Structure of the Markov random field model for sequential data. For each frame of a sequential dataset a Markov random field model for univariate comparison is introduced (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1b</xref>). To enforce a probabilistic dependency between hidden variables of neighboring sequence frames, the model includes additional sequence factor potential (<italic>ψ</italic><sub><italic>s</italic></sub>) connecting adjacent hidden variables.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.g002" xlink:type="simple"/>
</fig>
<p>Similar to the identification of the sites of metabolic regulation, we expected sequence fractures to be more relevant when they persisted with high sequential influence (i.e., high values of λ<sub>2</sub>). In the identification of significant fractures, we balanced the interdependency of the neighborhood, observation, and sequence factor potential functions, with a score function:
<disp-formula id="pcbi.1005577.e011">
<alternatives>
<graphic id="pcbi.1005577.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e011" xlink:type="simple"/>
<mml:math display="block" id="M11">
<mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:munderover><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:msub><mml:mi>ψ</mml:mi><mml:mi>O</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>#</mml:mo><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:msub><mml:mfrac><mml:mrow><mml:mo>#</mml:mo><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mtext>max</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>#</mml:mo><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <inline-formula id="pcbi.1005577.e012"><alternatives><graphic id="pcbi.1005577.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> was the optimal module label distribution derived by inference, given λ<sub>1</sub>, λ<sub>2</sub>; and the observations <bold>x</bold>, <inline-formula id="pcbi.1005577.e013"><alternatives><graphic id="pcbi.1005577.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mo>#</mml:mo><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mi>e</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>c</mml:mi><mml:mi>e</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1005577.e014"><alternatives><graphic id="pcbi.1005577.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mo>#</mml:mo><mml:mi>f</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>u</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>b</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>h</mml:mi><mml:mi>o</mml:mi><mml:mi>o</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, were the sequence and neighborhood fracture counts, respectively; given the inference solution, <inline-formula id="pcbi.1005577.e015"><alternatives><graphic id="pcbi.1005577.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, the max(#fractures<sub><italic>sequence</italic></sub>) and max(#fractures<sub><italic>neighborhood</italic></sub>), represented the total counts of possible fractures, given the model structure; moreover, w<sub>s</sub> and w<sub>n</sub> were the weights that determined the influence of the numbers of sequence and neighborhood fractures in the score function. This score function served to balance the fracture frequency, to ensure that it was comparable between different experiments. By maximizing the score function, the best combination, <inline-formula id="pcbi.1005577.e016"><alternatives><graphic id="pcbi.1005577.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, could be derived as follows:
<disp-formula id="pcbi.1005577.e017">
<alternatives>
<graphic id="pcbi.1005577.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005577.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>λ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold-italic">x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Parameterizations were excluded from the maximization, when they gave a zero value for either the observation potential or the number of fractures. Thus, the sites and the sequential order (i.e., timing or sensitivity) of metabolic regulation steps that were represented by the most stable sequence and neighborhood fractures could be extracted by scanning through the increasing weights, w<sub>s</sub> and w<sub>n</sub>.</p>
</sec>
</sec>
<sec id="sec005" sec-type="results">
<title>Results</title>
<sec id="sec006">
<title>Parameter optimization for automatic identification of sites of metabolic regulation</title>
<p>We first optimized the parameters used by the MNS algorithm (<xref ref-type="supplementary-material" rid="pcbi.1005577.s011">S1 Table</xref>), based on a non-targeted metabolomics dataset of 62 <italic>Escherichia coli</italic> single enzyme knockout and overexpression mutants, which exhibited a wide variety of metabolome phenotypes (<xref ref-type="supplementary-material" rid="pcbi.1005577.s012">S2 Table</xref>, details in <xref ref-type="supplementary-material" rid="pcbi.1005577.s015">S1 Text</xref>). The optimization results demonstrated that, for most parameter combinations, the MNS algorithm achieved inferences of regulatory sites that were comparable to those achieved by an expert scientist that manually identified the perturbed enzymes (<xref ref-type="supplementary-material" rid="pcbi.1005577.s013">S3 Table</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s004">S4 Fig</xref>). Furthermore, we evaluated whether the algorithm could provide a significantly better prediction of which enzyme was perturbed compared to a random guess with a permutation test. The results demonstrated that the MNS algorithm with the best parameterization (P3, <xref ref-type="supplementary-material" rid="pcbi.1005577.s011">S1 Table</xref>) identified 11 (maximum λ<sub>1</sub>) and 13 (#fractures) of the 62 perturbed enzymes, significantly better than the permutation test (<xref ref-type="fig" rid="pcbi.1005577.g003">Fig 3a</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s013">S3 Table</xref>).</p>
<fig id="pcbi.1005577.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005577.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Parameter optimization for the accurate identification of experimentally perturbed reactions from metabolomics data.</title>
<p>(a) Number of significantly identified reactions (p &lt; 0.05) for each parameter combination for the reaction ranking based on maximum λ<sub>1</sub> or total numbers of identified fractures (Details see <xref ref-type="supplementary-material" rid="pcbi.1005577.s015">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005577.s016">S2</xref> Text, <xref ref-type="supplementary-material" rid="pcbi.1005577.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005577.s002">S2</xref> Figs). Significantly identified reactions were classified into “exact” if the experimentally perturbed reaction was inferred by the algorithm or as “first neighbor” if one of the first neighbor reactions of the perturbed reaction was inferred. P-values are calculated by a permutation test of the reaction labels with 1000 permutations. (b) Influence of the models parameter settings on the significance of the inference of individually perturbed enzymes. Black box marks the best single parameter combination (3 hidden states, mean type: k-means, std type: all data). Certain perturbed enzyme knock-outs (e.g. shdB, aldA) cannot be identified with the best parameter combination but with others (e.g. 3 hidden states, mean type: quantile, std type: all data). (c) Number of significantly identified reactions (p &lt; 0.05) for rank product combinations of different parameter settings. Three combinations of two predictors with different model parameterizations (black boxes) improve the significantly inferred enzymes to 14. P-values are calculated by a permutation test of the reaction labels with 1000 permutations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.g003" xlink:type="simple"/>
</fig>
<p>Interestingly, when we performed a comparison of the performance of our approach with different individual parameter combinations, we found that, for some enzymatic perturbations (e.g., the <italic>sdhC</italic> knockout), a different parameter set was preferable (<xref ref-type="fig" rid="pcbi.1005577.g003">Fig 3b</xref>). Inspired by the notion that a combination of multiple predictors might improve the prediction results [<xref ref-type="bibr" rid="pcbi.1005577.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1005577.ref032">32</xref>], we combined independent predictions obtained with different parameters, by integrating them with the rank product. When we tested the performance of these pairwise combinations, we found that three individual combinations of the parameterizations slightly improved the prediction results, and 14 (22.6%) reactions were identified significantly better with the MNS algorithm than with the permutation test (p &lt;0.05, permutation test; <xref ref-type="fig" rid="pcbi.1005577.g003">Fig 3c</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s013">S3 Table</xref>).</p>
</sec>
<sec id="sec007">
<title>Performance evaluation and comparison to existing methods</title>
<p>We compared the performance of the MNS algorithm with optimized parameters against two state-of-the-art, but conceptually simpler, methods: reporter reactions [<xref ref-type="bibr" rid="pcbi.1005577.ref016">16</xref>] and mass-action ratios [<xref ref-type="bibr" rid="pcbi.1005577.ref015">15</xref>]. These comparisons employed independent metabolomics data from a genome-wide screen of 647 <italic>E</italic>. <italic>coli</italic> single enzyme knockout mutants [<xref ref-type="bibr" rid="pcbi.1005577.ref033">33</xref>]. We evaluated the prediction performance, based on the rankings of exact identifications of the perturbed reactions and of near misses, i.e., a prediction of the first-neighbor reaction. To evaluate significance, we performed a permutation test. The reporter reaction algorithm predicted 48 (7.4%) knocked-out enzymes significantly, and thereby surpassed the mass-action ratio algorithm, which identified 31 (4.8%) knocked-out enzymes significantly (p &lt;0.05, permutation test; <xref ref-type="table" rid="pcbi.1005577.t001">Table 1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s005">S5 Fig</xref>). With the best single set of parameters derived from the previous optimization (P3), our MNS algorithm predicted 55 (8.5%) of the perturbed enzymes significantly; moreover, with the best combined parameterization (P2/P3/#fractures), our algorithm identified 74 (11.4%) of the knocked-out enzymes significantly (p &lt;0.05, permutation test; <xref ref-type="table" rid="pcbi.1005577.t001">Table 1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s005">S5 Fig</xref>). Thus, our method showed a more than 50% improvement in prediction performance compared to current state-of-the-art-methods (<xref ref-type="table" rid="pcbi.1005577.t001">Table 1</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s005">S5 Fig</xref>).</p>
<table-wrap id="pcbi.1005577.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005577.t001</object-id>
<label>Table 1</label> <caption><title>Comparison of algorithms in the identification of the experimentally perturbed reactions in 647 <italic>E</italic>. <italic>coli</italic> enzyme knockout mutants.</title> <p>Significantly identified reactions were determined by a permutation test of the reaction labels with 1000 permutations and a p-value cutoff of 0.05.</p></caption>
<alternatives>
<graphic id="pcbi.1005577.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" rowspan="2">Algorithm</th>
<th align="center" colspan="2">Genes found in TOP10 Ranks [%]</th>
<th align="center" colspan="2">#Significantly identified reactions</th>
<th align="center" colspan="2">Significantly identified reactions [%]</th>
</tr>
<tr>
<th align="center">Exact</th>
<th align="center">Total</th>
<th align="center">Exact</th>
<th align="center">Total</th>
<th align="center">Exact</th>
<th align="center">Total</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">MNS—P3—max(λ1)</td>
<td align="char" char=".">4.0</td>
<td align="char" char=".">38.6</td>
<td align="center">48</td>
<td align="center">55</td>
<td align="char" char=".">7.4</td>
<td align="char" char=".">8.5</td>
</tr>
<tr>
<td align="left">MNS—P3—#fractures</td>
<td align="char" char=".">4.2</td>
<td align="char" char=".">38.8</td>
<td align="center">48</td>
<td align="center">55</td>
<td align="char" char=".">7.4</td>
<td align="char" char=".">8.5</td>
</tr>
<tr>
<td align="left">MNS—P2 &amp; P11—max(λ1)</td>
<td align="char" char=".">4.3</td>
<td align="char" char=".">38.9</td>
<td align="center">66</td>
<td align="center">71</td>
<td align="char" char=".">10.2</td>
<td align="char" char=".">11.0</td>
</tr>
<tr>
<td align="left">MNS—P5 &amp; P8—max(λ1)</td>
<td align="char" char=".">3.6</td>
<td align="char" char=".">28.4</td>
<td align="center">62</td>
<td align="center">67</td>
<td align="char" char=".">9.6</td>
<td align="char" char=".">10.4</td>
</tr>
<tr>
<td align="left">MNS—P2 &amp; P3—#fractures</td>
<td align="char" char=".">5.6</td>
<td align="char" char=".">42.2</td>
<td align="center">69</td>
<td align="center">74</td>
<td align="char" char=".">10.7</td>
<td align="char" char=".">11.4</td>
</tr>
<tr>
<td align="left">reporter reactions</td>
<td align="char" char=".">2.8</td>
<td align="char" char=".">43.6</td>
<td align="center">37</td>
<td align="center">48</td>
<td align="char" char=".">5.7</td>
<td align="char" char=".">7.4</td>
</tr>
<tr>
<td align="left">mass action ratio</td>
<td align="char" char=".">1.5</td>
<td align="char" char=".">38.5</td>
<td align="center">26</td>
<td align="center">31</td>
<td align="char" char=".">4.0</td>
<td align="char" char=".">4.8</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec008">
<title>Inference of regulatory sites in <italic>E</italic>. <italic>coli</italic> transcription factor knock-out mutants</title>
<p>To illustrate further the potential of the MNS approach, we applied it to three cases with widespread, complex metabolome changes, namely the <italic>E</italic>. <italic>coli</italic> transcription factor knockout mutants, Crp, MetR, and ArgR. For Crp, the reactant pairs predicted by the algorithm significantly overlapped with known targets of transcription factors (38% overlap, p = 0.023, hypergeometric test, <xref ref-type="supplementary-material" rid="pcbi.1005577.s006">S6 Fig</xref>) [<xref ref-type="bibr" rid="pcbi.1005577.ref034">34</xref>]. In contrast, for ArgR and MetR, no overlap was detected between the predicted and known targets (<xref ref-type="supplementary-material" rid="pcbi.1005577.s006">S6 Fig</xref>). The ArgR knockout should induce active arginine biosynthesis, even when arginine was present in the media [<xref ref-type="bibr" rid="pcbi.1005577.ref035">35</xref>]; however, we did not expect a significant overlap between known and predicted targets in MetR mutants, because methionine in the medium could inhibit MetR activity in wild-type <italic>E</italic>. <italic>coli</italic> [<xref ref-type="bibr" rid="pcbi.1005577.ref036">36</xref>].</p>
<p>Surprisingly, results for the <italic>metR</italic> knockout mutant repeatedly identified <italic>cyaA</italic> and <italic>cpdB</italic> among the top predicted genes regulated (<xref ref-type="supplementary-material" rid="pcbi.1005577.s014">S4 Table</xref>). Both the CyaA and CpdB enzymes are involved in the homeostasis of cyclic nucleotide monophosphates (cNMPs), and they are known to be regulated by Crp, but not by MetR [<xref ref-type="bibr" rid="pcbi.1005577.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref038">38</xref>]. Consistent with MNS predictions, the raw metabolite data revealed increased metabolite levels of all cNMPs and nucleotide monophosphates (NMPs), but nucleotide triphosphate (NTP) levels remained constant, and nucleoside levels declined (<xref ref-type="fig" rid="pcbi.1005577.g004">Fig 4a</xref>). This pattern suggested an activation of the adenylate cyclase, CyaA, or the inhibition of the 2',3'-cyclic-nucleotide 2'-phosphodiesterase/3'-nucleotidase, CpdB, by MetR. A non-specific effect on cNMP production rates could be excluded (<xref ref-type="supplementary-material" rid="pcbi.1005577.s007">S7a Fig</xref>). To verify the predicted regulation of CyaA and CpdB activity by MetR, we performed CyaA and CpdB enzyme assays in crude protein extracts of <italic>E</italic>. <italic>coli metR</italic> knockout and overexpression mutants. In extracts from <italic>E</italic>. <italic>coli</italic> with <italic>metR</italic> gene knockouts, we found elevated CyaA activity and unaltered CpdB activity (<xref ref-type="fig" rid="pcbi.1005577.g004">Fig 4b</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s007">S7b and S7c Fig</xref>). In <italic>metR</italic> overexpressing strains, we also found no significant change in enzymatic CpdB activity, but a strong reduction in enzymatic CyaA activity. These results confirmed that MetR directly or indirectly negatively regulated CyaA activity. In contrast, the predicted regulation of CpdB could not be confirmed. We speculated that either the prediction of CpdB could be considered a near miss in CyaA regulation or that <italic>in vivo</italic> regulation of CpdB activity could not be reproduced with <italic>in vitro</italic> enzyme assays. This latter possibility could occur, for example, when the regulation is mediated by allosteric interactions or post-translational modifications. Nevertheless, in summary, this example also demonstrated that novel sites of metabolic regulation could be identified by MNS, even in complex situations, like transcription factor knock-out mutants.</p>
<fig id="pcbi.1005577.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005577.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Identification of novel regulatory events in nucleotide metabolism mediated by MetR.</title>
<p>(a) Change in nucleotide triphosphate (NTP), cyclic nucleotide monophosphates (cNMP), nucleotide monophosphates (NMP) and nucleoside metabolite levels comparing Δ<italic>metR</italic> knockout and wildtype <italic>E</italic>. <italic>coli</italic>. (b) Results of CyaA enzyme assays with 10 mM ATP as substrate in crude extracts of Δ<italic>metR</italic> knockout, <italic>metR</italic> overexpression and wildtype <italic>E</italic>. <italic>coli</italic>. (c) Known and potentially new interactions involved in the regulation of nucleotide metabolism. Our study suggests that MetR inhibits CyaA. This could be mediated through direct inhibition or indirect feedback for example to CRP, the known regulator of CyaA expression.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Identification of the sequential order of oxidative stress-induced metabolic regulation in human fibroblasts treated with increasing concentrations of H<sub>2</sub>O<sub>2</sub></title>
<p>As mentioned before, it is often crucial that, in addition to identifying sites, a model can also determine the sequential order of metabolic regulatory steps. For example, it is often important to distinguish between the primary targets and the secondary effects of a metabolic drug. Therefore, we investigated the potential of our MNS algorithm in predicting both the sites and sequential order of metabolic regulation, based on dynamic metabolite data. We applied the algorithm to a previously published metabolomics dataset from fibroblasts treated with increasing concentrations of H<sub>2</sub>O<sub>2</sub> [<xref ref-type="bibr" rid="pcbi.1005577.ref039">39</xref>]. We ran the algorithm with three clusters that had fixed mean values (μ<sub>1</sub> = -0.1, μ<sub>2</sub> = 0, μ<sub>3</sub> = 0.1), with data-dependent standard deviation values for the observation function, and with a fixed scanning range, for λ<sub>1</sub> and λ<sub>2</sub>, which was determined with a prior, automatic coarse-grained scan through the parameters (<xref ref-type="supplementary-material" rid="pcbi.1005577.s016">S2 Text</xref>). The score distributions, which depended on sequence and neighborhood weights, w<sub>s</sub> and w<sub>n</sub>, indicated that the influence of the metabolic neighborhood, λ<sub>1</sub>, and of the sequential hidden variables, λ<sub>2</sub>, could be balanced to filter out equal degrees of non-significant neighborhood and sequence fractures (<xref ref-type="supplementary-material" rid="pcbi.1005577.s008">S8 Fig</xref>). The application of the algorithm smoothed the heterogeneous module label distributions with increasing neighborhood and sequential influences (λ<sub>1</sub> and λ<sub>2</sub>), which resulted in a continuous reduction of sequence and neighborhood fractures, and a focus on a small subset of metabolites and reactions (<xref ref-type="supplementary-material" rid="pcbi.1005577.s008">S8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s009">S9</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005577.s010">S10</xref> Figs). For certain ranges of the neighborhood and sequential weights, the analysis resulted in a pseudo steady-state distribution of the module labels and fractures (grey area, <xref ref-type="supplementary-material" rid="pcbi.1005577.s008">S8b Fig</xref>). We expected that these pseudo steady-states would be of special interest, because they represented module label configurations with a certain stability, and thus, they might be biologically meaningful.</p>
<p>Next, we further investigated the biological relevance of the inferred metabolic regulatory steps. At an intermediate level of neighborhood and sequential influence, we identified oxidative stress-induced regulatory steps in the citric acid cycle, glycolysis, and pentose phosphate pathway (<xref ref-type="fig" rid="pcbi.1005577.g005">Fig 5b</xref>). Most predicted enzymes in the citric acid cycle, including succinate, α-ketoglutarate, and malate dehydrogenase, were previously reported to be sensitive to oxidative stress [<xref ref-type="bibr" rid="pcbi.1005577.ref040">40</xref>–<xref ref-type="bibr" rid="pcbi.1005577.ref042">42</xref>]. Isocitrate dehydrogenase was not previously reported to be influenced by oxidative stress, but the upstream enzyme, aconitase, was known to be inhibited by oxidation [<xref ref-type="bibr" rid="pcbi.1005577.ref040">40</xref>]; however, our algorithm did not predict that aconitase was regulated. We hypothesized that this discrepancy was due to the inability of the non-targeted metabolomics method to distinguish between isomers like citrate and isocitrate, which are the substrate and product, respectively, in the aconitase-catalyzed reaction [<xref ref-type="bibr" rid="pcbi.1005577.ref043">43</xref>]. To test this hypothesis, further follow up analysis must be performed with targeted mass spectrometry methods that enable a distinction between the two isomers.</p>
<fig id="pcbi.1005577.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005577.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Identification of sequential order of oxidative stress induced metabolic regulations in fibroblasts.</title>
<p>Application of MNS algorithm for sequential data on metabolomics data from fibroblasts treated with increasing concentrations of H<sub>2</sub>O<sub>2</sub>. The figure shows segmentation results with increasing incluence of the neighborhood and sequential dependency: (a) sequence weight w<sub>s</sub> = 0, neighborhood weight w<sub>n</sub> = 0, (b) w<sub>s</sub> = 0.15, w<sub>n</sub> = 0.15, (c) w<sub>s</sub> = 0.24, w<sub>n</sub> = 0.24. In each time profile inset, the black line reports the log2 of the fold-change relative to the first time point (frame). With increasing dependency to the neighborhood and sequence, only the major known regulators involved in the metabolic reponse to oxidative stress remain as inferred regulatory sites. Furthermore, the algorithm correctly infers the sequential order of an initial activation of G6PD and inhibition of glycolytic flux (GAPDH) which is followed by a rerouting of flux into P5P, S7P, and E4P via PGD and back to upper glycolysis via TK and TA [<xref ref-type="bibr" rid="pcbi.1005577.ref039">39</xref>]. Abbreviations: Hexose P: hexose phosphates, GL6P: gluconolactone 6-phosphate, 6PG: 6-phospho gluconic acid, FBP: fructose bisphosphate, E4P: erythrose 4-phosphate, S7P: sedoheptulose 7-phosphate, P5P: pentose 5-phosphates, GAP/DHAP: glyceraldehyde 3-phosphate/dihydroxyacetone phosphate, 3-PGP: 3-phosphoglyceroyl phosphate, xPG: 2/3-Phosphoglyceric acid, PEP: phosphoenolpyruvate, LAC: lactic acid, CIT: citric acid, cAco: cis-aconitic acid, ICIT: isocitric acid, aKG: α-ketoglutaric acid, SUC: succinic acid, FUM: fumaric acid, MAL: Malic acid, OXA: oxaloacetic acid, G6PD: glucose-6-phosphate dehydrogenase, PGLS: 6-phosphogluconolactonase, PGD: phosphogluconate dehydrogenase, TK: transketolase, TA: transaldolase, PFK: phosphofructokinase, ALDO: aldolase, GAPDH: glyceraldehyde 3-phosphate dehydrogenase, PGK: phosphoglycerate kinase, ENO: enolase, PK: pyruvate kinase, LDH lactate dehydrogenase, CS: citrate synthetase, ACO: aconitase, IDH: isocitrate dehydrogenase, αKGDH: α- ketoglutarate dehydrogenase, SDH: succinate dehydrogenase, FH: fumarate hydratase, MDH: malate dehydrogenase.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.g005" xlink:type="simple"/>
</fig>
<p>At high sequential and neighborhood influences, the only inferred metabolic regulations were the major, known regulators of the metabolic response to oxidative stress in upper glycolysis and the pentose phosphate pathway (<xref ref-type="fig" rid="pcbi.1005577.g005">Fig 5c</xref>, <xref ref-type="supplementary-material" rid="pcbi.1005577.s009">S9</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005577.s010">S10</xref> Figs). These inferred regulations included oxidative stress-mediated activation of glucose 6-phosphate dehydrogenase [<xref ref-type="bibr" rid="pcbi.1005577.ref039">39</xref>], inhibition of glycolytic flux by oxidation of glyceraldehyde-3-phosphate dehydrogenase [<xref ref-type="bibr" rid="pcbi.1005577.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref044">44</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref045">45</xref>], and changes in the directions of net fluxes for transketolase and transaldolase [<xref ref-type="bibr" rid="pcbi.1005577.ref039">39</xref>]. Importantly, our algorithm revealed that the activation of glucose 6-phosphate dehydrogenase and the inhibition of glycolytic flux occurred at equally low H<sub>2</sub>O<sub>2</sub> concentrations, and that the accumulation of non-oxidative pentose phosphate pathway metabolites was observed only at high H<sub>2</sub>O<sub>2</sub> concentrations (<xref ref-type="fig" rid="pcbi.1005577.g005">Fig 5c</xref>). Because the accumulation of pentose phosphates is a consequence of increased glucose 6-phosphate dehydrogenase flux [<xref ref-type="bibr" rid="pcbi.1005577.ref039">39</xref>], our method correctly identified the sequential order of these regulatory events.</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>Here, we presented the MNS algorithm, a novel computational method that employs probabilistic graphical models to infer the sites and sequential order of metabolic regulatory events, based on relative metabolomics data and metabolic network topology (<xref ref-type="fig" rid="pcbi.1005577.g006">Fig 6</xref>). Exploiting probabilistic dependencies specified by the metabolic model, our approach successfully coped with large-scale, noisy, and sparse datasets. In addition, our approach outperformed existing methods, like reporter reactions [<xref ref-type="bibr" rid="pcbi.1005577.ref016">16</xref>] and mass-action ratios [<xref ref-type="bibr" rid="pcbi.1005577.ref015">15</xref>], in the identification of regulatory sites. Furthermore, it could infer the sequential order of regulatory events, which is often essential for identifying direct and indirect metabolic regulatory events.</p>
<fig id="pcbi.1005577.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005577.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Overview of the MNS toolbox.</title>
<p>The MNS algorithm enables to predict sites and the sequential order of metabolic regulations from metabolomics data.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.g006" xlink:type="simple"/>
</fig>
<sec id="sec011">
<title>Constraints on the application of the method</title>
<p>In the parameter optimization and method comparison sections, we demonstrated that, although the MNS algorithm inferred many genetically perturbed enzymes correctly, a significant portion of perturbed enzymes were not identified. However, the algorithm’s prediction performance was comparable to a manual analysis by an expert. A low prediction performance might be due the fact that some genetic perturbations of enzymes have little effect on metabolism. For example, inhibition of an enzyme that carries no metabolic flux will not influence the metabolic phenotype. Likewise, when a flux-carrying enzyme is perturbed, concomitant regulation of the involved isoenzyme can maintain the flux of the perturbed reaction. In both cases, the metabolite data will not indicate any changes, and the perturbed reaction will not be identifiable.</p>
<p>Moreover, the perturbation of a single metabolic enzyme can cause global rearrangements in metabolism. This is due to the fact that metabolism supplies the cell with the molecular building blocks, energy, and redox equivalents it needs to meet the cell’s physiological requirements. Therefore, perturbations of required enzymes can induce secondary regulation to stimulate other metabolic branches that can compensate for the changed flux. Given steady state data, these secondary regulation events might not be distinguishable from the regulation of the experimentally perturbed enzyme, or in some cases, secondary events might occlude the perturbation. Therefore, it is highly important to identify the causal chain of regulatory events that occur after a metabolic perturbation. The extended version of the metabolic network segmentation algorithm, for sequential metabolomics data enables to identify differences in the sequence of regulations, e.g. a temporal delay in time course experiments. These differences in the sequential order of regulations can be causal, but also result from secondary effects. For example, a drug can perturb the activity of several enzymes in parallel, but due to differences in turnover rates of the enzymes the regulations might be observed with time delays. Therefore, the sequential order would indicate that there are secondary effects although the enzymes are regulated directly by the drug. Therefore additional analysis are required to increase certainty about causality in the chain of regulations. For example, dynamic simulations of detailed mechanistic models of biological subnetworks can indicate if the predicted dependencies amongst regulations can explain the observed data. Furthermore, additional experiments with enzyme knockouts enable to investigate the dependency of potential secondary regulations on primary ones in enzyme knockout experiments.</p>
<p>Moreover, it is necessary to ensure that the sequential samples, for example dilution steps in a drug dilution series or the sampling frequency in time course experiments, have sufficient resolution to distinguish the regulatory events. Notably, modern sampling approaches reach a sampling frequency in the range of seconds. Although some metabolic regulations can occur even with delay times below seconds, these approaches meet the requirements for distinguishing the sequence of most metabolic regulatory events [<xref ref-type="bibr" rid="pcbi.1005577.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref046">46</xref>].</p>
</sec>
<sec id="sec012">
<title>Plans for further development of the algorithm</title>
<p>Due to the modularity of the underlying MRF models, the presented MNS algorithm can be extended and used for other applications. One problem in metabolomics research is the annotation of metabolites in non-targeted datasets. Recently, different network-based approaches have demonstrated that information on the metabolic environment improved the annotation of metabolites [<xref ref-type="bibr" rid="pcbi.1005577.ref018">18</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref047">47</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref048">48</xref>]. We think that our method might also be extended to include uncertainty in metabolite annotation. This extension would require that we add to the MRF models a third node-type, which represents the raw data features. The raw-data nodes would be connected to potential metabolites with a given probability, which would describe how likely the connection was between the raw-data feature and the metabolite. During the segmentation process, this probability could be continuously optimized to identify sites of regulation steps and to identify likely connections between metabolites and raw-data features.</p>
<p>Furthermore, we are currently working on methods for focusing on the extraction of co-regulated enzyme-metabolite modules from integrated ‘omics’ data. Recently, different subgraph extraction approaches have achieved great success in identifying areas in the metabolic network that showed changing activity [<xref ref-type="bibr" rid="pcbi.1005577.ref049">49</xref>–<xref ref-type="bibr" rid="pcbi.1005577.ref051">51</xref>]. These subgraphs have simplified the complex data structure, which has enabled manual interpretations within a network context. We aim to design an algorithm that can identify co-regulated metabolite-enzyme modules in metabolomics data integrated into metabolic models, together with multiple other ‘omics’ layers that might influence enzymatic activity; for example, data from transcriptomics, proteomics, or post-translational modification analyses. This new algorithm would provide a means to make direct inferences from the extracted modules to determine which type of regulation was most likely to cause changes in metabolic activity.</p>
<p>One further promising extension we are planning to implement is a multidimensional clustering approach for multivariate datasets. This approach would aim to form clusters of metabolite levels, datasets, and the metabolic network, in parallel. In contrast to current approaches (e.g., correlation networks [<xref ref-type="bibr" rid="pcbi.1005577.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref052">52</xref>]), this algorithm would enable the identification metabolic modules of metabolites and their corresponding datasets, simultaneously. Due to the high metabolic heterogeneity in cancers [<xref ref-type="bibr" rid="pcbi.1005577.ref053">53</xref>–<xref ref-type="bibr" rid="pcbi.1005577.ref055">55</xref>], such a method would be highly advantageous for identifying similarly regulated metabolic branches in different cancer cell lines or tumor samples. This could facilitate tumor categorizations and improve the development of tumor-specific treatments that target the metabolism.</p>
</sec>
<sec id="sec013">
<title>Conclusion</title>
<p>In its current state, the MNS method is broadly applicable to different metabolic setups, where it can facilitate automated interpretations of large-scale metabolomics data. Moreover, due to the modularity of the underlying MRF models, more advanced metabolomics data analysis approaches can be developed, based on the MNS algorithm. Thus, the presented MNS approach will enhance our understanding of metabolism and its interactions with cellular signaling and regulatory processes.</p>
</sec>
</sec>
<sec id="sec014">
<title>Materials and methods</title>
<sec id="sec015">
<title>Manual identification of perturbed reactions in <italic>E</italic>. <italic>coli</italic> enzyme mutants using visual integration</title>
<p>To get a gold standard how well the perturbed reactions given the metabolomics data of <italic>E</italic>. <italic>coli</italic> enzyme knockout and overexpression mutants can be identified by experts, we extract for each mutant a local network comprising metabolites and reactions with a maximal distance of three reactions around the perturbed reaction and visualized the log<sub>2</sub>(fold-changes) comparing metabolome data from knockout and wildtype strains on the individual metabolites using Cytoscape v3.0 [<xref ref-type="bibr" rid="pcbi.1005577.ref056">56</xref>]. Based on this subnetwork, two individual experts guessed by eye which of the reactions was perturbed without knowing the enzyme and metabolite names. The datasets were then classified into three classes based on the distance between the manual guess and the genetically perturbed enzyme. The classes are exact (distance = 0), first neighbor (distance = 1) and not identifiable (distance &gt; 1).</p>
</sec>
<sec id="sec016">
<title>Parameter settings of the univariate MRF model for the parameter optimization for the identification of sites of metabolic regulation</title>
<p>In the parameter optimization for the automatic inference of sites of metabolic regulations, we optimized three parameters, the number of hidden state labels, the mean values and the standard deviations of the observation potential functions. The hidden state labels were varied between 3, 4 and 5. The hidden state label dependent mean values were either set to the mean values of the clusters derived k-means clustering with Euclidean distance (k-means) or set to values equally distributed between the 0.001 and 0.999 percentile of the input data to guarantee homogenously distributed centers of the observation potential functions (quantile). The hidden state label dependent standard deviations was set identical for each hidden state label either to 1 (fix), to the average standard deviation of the k-means clusters (k-means), or to the standard deviation of the complete data set. This resulted in total in 18 parameter combinations (<xref ref-type="supplementary-material" rid="pcbi.1005577.s011">S1 Table</xref>).</p>
<p>To identify the best Markov random field model parameterization, we inferred for each parameter combination 62 known regulatory sites using metabolomics data from 62 <italic>E</italic>. <italic>coli</italic> enzyme knock-out and overexpression mutants. We determined significantly identified reactions by comparing the real inferred rank of the perturbed reaction and its first neighbors with the rank distribution of the perturbed reaction and its first neighbors given 1000 permutations of the reaction labels resulting in p-values for each perturbed reaction and each method. Thereby we identified how many known perturbed reactions were identified correct.</p>
</sec>
<sec id="sec017">
<title>Method comparison for the inference of sites of metabolic regulation</title>
<p>We compared the potential of our algorithm to identify sites of metabolic regulation with reporter reactions [<xref ref-type="bibr" rid="pcbi.1005577.ref016">16</xref>] and mass-action ratio [<xref ref-type="bibr" rid="pcbi.1005577.ref015">15</xref>]. We implemented the reporter reaction and the mass-action ratio as described previously, considered only the direct substrates and products of a reaction and replaced undetected metabolites by random sampling of not annotated peaks [<xref ref-type="bibr" rid="pcbi.1005577.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref016">16</xref>]. For both methods all reactions in the model were ranked according to descending absolute z-scores (reporter reactions) or descending absolute mass-action ratio. For all methods including ours we determined significantly identified reactions by comparing the real rank of the perturbed reaction and its first neighbor reactions with the rank distribution of the perturbed reaction and its first neighbors given permutations of the reaction labels resulting in p-values for each perturbed reaction and each method. The p-values for reactions identified exactly or to the first neighbor were calculated individually. A reaction was considered significantly identified for p-values &lt; 0.05 of the exact and/or first neighbor identification.</p>
</sec>
<sec id="sec018">
<title>Strains and overnight pre-culture preparation</title>
<p>All used <italic>E</italic>. <italic>coli</italic> knock-out strains were part of the KEIO knock-out library [<xref ref-type="bibr" rid="pcbi.1005577.ref057">57</xref>] and all used overexpression strains were part of the ASKA overexpression library [<xref ref-type="bibr" rid="pcbi.1005577.ref058">58</xref>]. KEIO strains were compared against <italic>E</italic>. <italic>coli</italic> K12 BW25113, denoted as KEIO WT. Induced ASKA strains were compared against non-induced ASKA strains, denoted as ASKA WT or against the average over all induced ASKA strains per plate, denoted as others. For overnight precultures, strains were inoculated from LB rich medium agar plates (10 g/L Bacto peptone, 5 g/L Bacto yeast extract, 5 g/L NaCl, with additional 15 g/L agar-agar for solidification) into 5 mL of LB liquid medium in 15 mL culture tubes and incubated for 16 h at 37°C and 300 rpm. LB medium for KEIO strains was supplemented with 50 μg/mL kanamycin as resistance marker. KEIO WT was cultured in pure LB medium. ASKA strains were supplemented with 20 μg/mL chloramphenicol as resistance marker. Overexpression in ASKA strains was induced by adding of 100 μg/mL IPTG. Overnight preculture preparation was conducted identical for all experiments.</p>
</sec>
<sec id="sec019">
<title>Growth phenotyping of enzyme mutant strains</title>
<p>To define optical density at 600 nm (OD) values corresponding to mid-log phase for KEIO and ASKA strains, growth experiment were conducted. KEIO and ASKA strains were inoculated at OD 0.05 from overnight precultures and subsequently cultured in 1 mL M9 medium (7.52 g Na<sub>2</sub>HPO<sub>4</sub>·2H<sub>2</sub>O, 3 g KH<sub>2</sub>PO<sub>4</sub>, 0.5 g NaCl, 2.5 g (NH<sub>4</sub>)<sub>2</sub>SO<sub>4</sub>, 14.7 mg CaCl<sub>2</sub>·2H<sub>2</sub>O, 246.5 mg MgSO<sub>4</sub>·7H<sub>2</sub>O, 16.2 mg Fe(III)Cl<sub>3</sub>·6H<sub>2</sub>O, 180 μg ZnSO<sub>4</sub>·7H<sub>2</sub>O, 120 μg CuCl<sub>2</sub>·2H<sub>2</sub>O, 120 μg MnSO<sub>4</sub>·H<sub>2</sub>O, 180 μg CoCl<sub>2</sub>·6H<sub>2</sub>O, 1 mg thiamine hydrochloride per liter of deionized water) supplemented with 4 g/L glucose and 2 g/L N-Z casein hydrolysate in 96-deep-well plates at 37°C and 300 rpm. To induce overexpression in ASKA strains, the medium was supplemented with 100 μg/mL IPTG, all other strains were cultured in unsupplemented medium. For each mutant, four technical replicates were used. OD was measured in intervals of 45 min for a total of 10 time points using a TECAN sunrise spectrophotometer. Based on the observed growth rates, strains for metabolomics experiments were selected (<xref ref-type="supplementary-material" rid="pcbi.1005577.s012">S2 Table</xref>).</p>
</sec>
<sec id="sec020">
<title>Extraction of the <italic>E</italic>. <italic>coli</italic> enzyme knockout and overexpression metabolome</title>
<p>Strains for metabolomics measurements were prepared identical as described for growth experiment of enzyme mutant strains. In total, 42 KEIO enzyme knockout strains, plus one KEIO WT per plate and 20 ASKA strains plus three non-induced ASKA WT strains per plate were inoculated. Each strain was grown to mid-exponential phase, i.e. OD 1.60 for KEIO strains and OD of 0.80 for ASKA strains. Harvested cells were centrifuged at 4000 rpm for 10 min at 0°C. Cell pellets were immediately extracted with 150 μL preheated ddH<sub>2</sub>0 for 10 min at 80°C. The extraction broth was centrifuged for 10 min with 4000 rpm at 0°C. The supernatants were diluted 1:5 in ddH<sub>2</sub>0 for non-targeted metabolomics.</p>
</sec>
<sec id="sec021">
<title>Generation of crude protein extracts for enzyme assays</title>
<p>For the generation of crude protein extracts ASKA MetR induced and non-induced strains were inoculated in 1:25 dilutions and KEIO WT and <italic>metR</italic> KO strains in 1:50 dilutions in M9 medium with N-Z casein plus 2 g/L, for induced strains additionally supplemented with 100 μg/mL IPTG, and grown to a final OD of 0.6 (ASKA) or 1.2 (KEIO). The cell suspensions were transferred into 50 mL falcon tubes and centrifuged at 4000 rpm for 10 min at 0°C. For protein extraction, supernatants were removed and pellets resuspended in 3.5 mL ice-cold Tris-HCI buffer (pH 7.5, 5 mM MgCl<sub>2</sub>, 2 mM DTT and 4 mM PMSF). Cells were subsequently lysed by a French press to obtain crude cell lysates. Enzyme concentrations were normalized by a colorimetric Bradford assay [<xref ref-type="bibr" rid="pcbi.1005577.ref059">59</xref>]. Total protein concentrations of extracts from KEIO strains were normalized to a protein concentration of 2.69 mg/mL and from ASKA strains to a total protein concentration of 1.47 mg/mL.</p>
</sec>
<sec id="sec022">
<title>CyaA and CpdB enzyme assays</title>
<p>To determine the enzyme activity of CyaA and CpdB in dependence of MetR activity, enzyme assays for the protein crude extracts were conducted with a final concentration of 1 mM or 10 mM of AMP, cAMP or ATP as substrates. Enzyme assays were conducted at 37°C with two biological replicates. For the enzyme assays 100 μL of pre-warmed crude cell extract were incubated with 50 μL of substrate. To study the enzymatic reaction dynamics 10 μL samples were taken at various time points (15 s, 45 s, 75 s, 120 s, 180 s, 300 s, 450 s, 600 s, 900 s, 1500 s, 2100 s, 2700 s) and immediately quenched in ice cold 100% methanol. To remove precipitated protein samples were centrifuged at 4000 rpm at 0°C for 10 min, and reactant concentrations in supernatants were measured by non-targeted metabolomics using a previously published method [<xref ref-type="bibr" rid="pcbi.1005577.ref043">43</xref>].</p>
</sec>
<sec id="sec023">
<title>Non-targeted metabolomics by flow injection—Time of flight mass spectrometry</title>
<p>Non-targeted analysis of metabolite extracts was performed by flow injection—time of flight mass spectrometry on a Agilent 6550 ion funnel QTOF instrument (Agilent, Santa Clara, CA) in negative mode 4 GHz, high resolution in a m/z range of 50–1000 as described previously [<xref ref-type="bibr" rid="pcbi.1005577.ref043">43</xref>]. A 60:40 mixture of isopropanol:water supplemented with NH<sub>4</sub>F at pH 9.0, as well as 10 nM hexakis(1H, 1H, 3H-tetrafluoropropoxy)phosphazine and 80 nM taurocholic acid for online mass calibration. Ions were annotated to metabolites based on exact mass considering [M-H]<sup>-</sup> and [M+F]<sup>-</sup> and 0.001 Da mass accuracy using the KEGG eco database [<xref ref-type="bibr" rid="pcbi.1005577.ref024">24</xref>]. All metabolomics data analysis was performed using Matlab 2014b (The Mathworks, Natick, MA).</p>
</sec>
</sec>
<sec id="sec024">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005577.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Workflow of the metabolic network segmentation (MNS) algorithm for univariate data to automatically identify sites of metabolic regulation.</title>
<p>The algorithm integrates large-scale metabolomics data and metabolic models employing Markov random fields. The Markov random field model consist of a network of discrete hidden variables and of continuous observed variables for each detected metabolite. The (module) labels or states of the hidden variables describe to which module, i.e. a group of neighboring metabolites with similar metabolite changes, a certain metabolite belongs to. Observation potentials enforce a dependency between observations and the label of the hidden variables and neighborhood potentials enforce homogeneity of the module labels of neighboring metabolites, which is weighted by λ<sub>1</sub>. Given the metabolic observations and a certain model parameterization, the hidden state label distribution is inferred using the LazyFlipper algorithm from the OpenGM toolbox [<xref ref-type="bibr" rid="pcbi.1005577.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005577.ref026">26</xref>]. The hidden state-label distribution is used to identify modules of similarly changing metabolites and the fractures between them, which we assume to represent sites of metabolic regulation. We infer the most relevant regulatory sites in a sequential scanning process with increasing influence of the neighborhood λ<sub>1</sub>. Since we assume that the most stable reactions represent biological meaningful regulations, we rank the reactions according to maximum λ<sub>1</sub> at which a reaction is classified as fracture and according to the frequency of how often a reaction is classified as fracture. In case of combinations of multiple predictors with different parameterizations, the ranking is determined through rank products. Significance for a single predictor is assessed using a permutation test and for combination of predictors using significance test’s for rank products [<xref ref-type="bibr" rid="pcbi.1005577.ref028">28</xref>].</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Example application of the metabolic network segmentation algorithm for univariate comparison to identify sites of metabolic regulation in H<sub>2</sub>O<sub>2</sub> treated fibroblasts with transketolase knockdown (TKT KD) compared to wildtype.</title>
<p>(a) Raw Data of the univariate comparison comparing metabolomics data from TKT KD treated with H<sub>2</sub>O<sub>2</sub> to wildtype treated with H<sub>2</sub>O<sub>2</sub>. Data from [<xref ref-type="bibr" rid="pcbi.1005577.ref039">39</xref>]. (b) MNS inference results of module labels with increasing neighborhood influence λ<sub>1</sub>. With increasing λ<sub>1</sub> only the perturbed reaction (TKT) and G6PD remain as inferred regulatory sites. (c,d) Overview of the (c) metabolite module labels and the (d) fractures. Arrows in (d) indicate how individual reactions are ranked #fractures and max λ<sub>1</sub> to automatically infer regulatory sites (<xref ref-type="supplementary-material" rid="pcbi.1005577.s001">S1 Fig</xref>). Abbreviations: G6P: glucose 6-phosphates, F6P: fructose 6-phosphate, GL6P: gluconolactone 6-phosphate, 6PG: 6-phospho gluconic acid, FBP: fructose bisphosphate, E4P: erythrose 4-phosphate, S7P: sedoheptulose 7-phosphate, R5P: ribose 5-phosphate, Ru5-P: ribulose 5-phosphate, X5P: xylulose 5-phosphate, GAP/DHAP: glyceraldehyde 3-phosphate/dihydroxyacetone phosphate, BPG: Bisphosphoglyceric acid, 2/3PG: 2/3-Phosphoglyceric acid, PEP: phosphoenolpyruvate, PYR: Pyruvate, LAC: lactic acid, A-CoA: acetyl-CoA, GPI: glucose phosphate isomerase, G6PD: glucose-6-phosphate dehydrogenase, PGLS: 6-phosphogluconolactonase, PGD: phosphogluconate dehydrogenase, TKT: transketolase, TALDO: transaldolase, PFK: phosphofructokinase, ALDO: aldolase, TPI1: triosephosphate isomerase 1, GAPDH: glyceraldehyde 3-phosphate dehydrogenase, PGK: phosphoglycerate kinase, ENO: enolase, PK: pyruvate kinase, LDH lactate dehydrogenase, PGAM: phosphoglycerate mutase, RPIA: ribose 5-phosphate isomerase, RPE: ribulose 5-phosphate epimerase.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Workflow of the metabolic network segmentation algorithm to identify sites and sequential order of metabolic regulations from sequential data.</title>
<p>The algorithm splits sequential metabolomics data into individual frames and introduces for each frame a Markov random field model for univariate data (<xref ref-type="fig" rid="pcbi.1005577.g001">Fig 1b</xref>). The hidden states between neighboring sequential frames are connected by a sequence factor potential, which is weighted by λ<sub>1</sub>, to enforce a dependency between sequential data points. Similar to the MNS model for univariate data, we infer the most relevant regulatory sites and their sequential order in a step-wise scanning process with increasing influence of the neighborhood λ<sub>1</sub> and sequential frames λ<sub>2</sub> (<xref ref-type="supplementary-material" rid="pcbi.1005577.s001">S1 Fig</xref>).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>(a) Principle and (b) results of the visual inspection of the metabolomics data of 62 <italic>E</italic>. <italic>coli</italic> enzyme knockout and overexpression strains.</title>
<p>(a) Given the metabolite data mapped on a subnetwork around the perturbed reaction (maximal three reaction steps), two individual users inferred the perturbed reaction by visual inspection. Reactions are categorized into “exact” if the users identified the experimentally perturbed reaction (e.g. tktA KO), “first neighbor” if the users inferred one of the first neighbor reactions of the perturbed reaction (e.g. fumC KO) or “&gt; first neighbor” if the inferred reaction was more than one reaction step away from the perturbed enzyme or was not identifiable at all (e.g. carA OE). (b) Only about 5% of the perturbed reactions were identified exactly, about 60% one of the first neighbor reactions was inferred, and more than 30% of the reactions were not identifiable.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Comparison of multiple algorithms for (a) the number of significantly identified reactions and (b) the number of exactly identified reactions versus their rank.</title>
<p>Independent of the parameterization the MNS algorithm outperforms current state-of-the-art methods in the identification of perturbed enzymes.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Identification of regulatory sites in 3 <italic>E</italic>. <italic>coli</italic> transcription factor knockout mutants using MNS algorithm.</title>
<p>(a) Number of significantly identified reaction pairs (p &lt; 0.01). Analysis was performed using a combination of the predictors with parameterization 2 and 3 (<xref ref-type="supplementary-material" rid="pcbi.1005577.s011">S1 Table</xref>). (b) Overlap between identified reaction pairs and reaction pairs that are known transcription factor targets. Ratio is determined comparing overlap and number of significantly predicted reaction pairs. p-value for Crp is calculated using a hypergeometric test.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>(a) Growth and (b,c) enzyme assays of <italic>metR</italic> knockout and overexpression (MetR-OE) mutants.</title>
<p>(a) Each bar represents mean values and standard deviation of doubling times at exponential growth phase of 4 individual biological replicates. There is no difference in doubling time comparing wild type E. coli and <italic>ΔmetR</italic> knockout mutants. (b,c) Enzyme assays with (b) 10 mM cAMP and (c) 10 mM AMP as substrate. Data shown represents mean values of 2 biological (except overexpression assays in c) and 2 technical replicates.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Detailed analysis of influence of neighborhood and sequential weights on fractures, observation potential and scores of the MNS model for sequential data.</title>
<p>(a) Neighborhood and sequential influence λ<sub>1</sub> and λ<sub>2</sub> dependent distribution of sum neighborhood fractures, frame fracture and observation potential. (b) Total number of neighborhood and frame fracture with increasing penalization of fractures w<sub>s</sub> and w<sub>n</sub>. Shaded areas indicate pseudo-steady states of the fracture frequency, i.e. the number of fractures is not increasing for a certain range of weights. These are can be considered as module label distributions with a certain stability. Dashed lines indicate the weight values used for further analysis. (c) Influence of increasing penalization of sequence and neighborhood fractures on score (score = Sum of observation factor potential—w<sub>s</sub>*sum of sequence fractures—w<sub>n</sub>*sum of neighborhood fractures). White stars in (c) indicate the maximal score for the setting of w<sub>s</sub> an w<sub>n</sub>. With increasing penalization of fractures the optimal balance between number of fractures and the summed observation factor potential, i.e. how well do the model and the hidden module labels describe the data, can be determined. Score is normalized to a range between 0 and 1.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>(a) Module labels and (b) sequence fractures of metabolites for increasing weights w<sub>s</sub> and w<sub>n</sub>.</title>
<p>With increasing influence from metabolic neighborhood w<sub>n</sub> and sequential frames w<sub>s</sub> the (a) module label distribution gets homogenized and only the most important (b) sequence fractures remain. Weight values were determined in <xref ref-type="supplementary-material" rid="pcbi.1005577.s008">S8b Fig</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s010" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Neighborhood fractures of reactions at different frames for increasing weights w<sub>s</sub> and w<sub>n</sub>.</title>
<p>With increasing influence from metabolic neighborhood w<sub>n</sub> and sequential frames w<sub>s</sub> the neighborhood fracture distribution gets homogenized and only the most important fractures remain. Weight values were determined in <xref ref-type="supplementary-material" rid="pcbi.1005577.s008">S8b Fig</xref>.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s011" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Model parameterizations for the optimization of the MNS method.</title>
<p>Description: No. of hidden states represents the number of different modules. Mean Type describes how the mean values of the observation potential function are derived (k-means: μ derived from the k-means clustering results; quantile: μ equally distributed between the 0.001 and 0.999 quantile of the data). Standard deviation type describes how the individual standard deviations of of the observation potential functions are determined (fix: fix standard deviation value for all hidden states <bold>σ</bold> = 1, k-means: individual σ for each hidden state equal to the standard deviation of the data points in a k-means cluster, all data: σ of all hidden states equal to standard deviation of the complete data).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s012" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Overview of <italic>E</italic>. <italic>coli</italic> enzyme overexpression and knockout mutants used to test the performance of the MNS approach for univariate data to identify known sites of metabolic regulation.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s013" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Results of the identification of known regulatory sites from <italic>E</italic>. <italic>coli</italic> enzyme knockout and overexpression.</title>
<p>Significantly identified reactions were determined by a permutation test of the reaction labels with 1000 permutations and a p-value cutoff of 0.05.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s014" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>Top predictions of MetR regulated reactions by the MNS algorithm.</title>
<p>The analysis was performed with a combination of two parameterizations (<xref ref-type="supplementary-material" rid="pcbi.1005577.s011">S1 Table</xref>, P2 &amp; P3).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s015" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Details on the parameter optimization.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005577.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005577.s016" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Details on the determination of λ<sub>1</sub> and λ<sub>2</sub> scanning ranges for the application of the MNS model for sequential data on hydrogen peroxide treated fibroblasts.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Tobias Fuhrer for providing the metabolomics data for the KEIO knock-out library.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005577.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hsu</surname> <given-names>PP</given-names></name>, <name name-style="western"><surname>Sabatini</surname> <given-names>DM</given-names></name>. <article-title>Cancer cell metabolism: Warburg and beyond</article-title>. <source>Cell</source>. <year>2008</year>;<volume>134</volume>(<issue>5</issue>):<fpage>703</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2008.08.021" xlink:type="simple">10.1016/j.cell.2008.08.021</ext-link></comment> <object-id pub-id-type="pmid">18775299</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DeBerardinis</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Thompson</surname> <given-names>CB</given-names></name>. <article-title>Cellular metabolism and disease: what do metabolic outliers teach us?</article-title> <source>Cell</source>. <year>2012</year>;<volume>148</volume>(<issue>6</issue>):<fpage>1132</fpage>–<lpage>44</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2012.02.032" xlink:type="simple">10.1016/j.cell.2012.02.032</ext-link></comment> <object-id pub-id-type="pmid">22424225</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McKnight</surname> <given-names>SL</given-names></name>. <article-title>On getting there from here</article-title>. <source>Science(Washington)</source>. <year>2010</year>;<volume>330</volume>(<issue>6009</issue>):<fpage>1338</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005577.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patti</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Yanes</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Siuzdak</surname> <given-names>G</given-names></name>. <article-title>Innovation: Metabolomics: the apogee of the omics trilogy</article-title>. <source>Nature reviews Molecular cell biology</source>. <year>2012</year>;<volume>13</volume>(<issue>4</issue>):<fpage>263</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrm3314" xlink:type="simple">10.1038/nrm3314</ext-link></comment> <object-id pub-id-type="pmid">22436749</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerosa</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sauer</surname> <given-names>U</given-names></name>. <article-title>Regulation and control of metabolic fluxes in microbes</article-title>. <source>Curr Opin Biotechnol</source>. <year>2011</year>;<volume>22</volume>(<issue>4</issue>):<fpage>566</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.copbio.2011.04.016" xlink:type="simple">10.1016/j.copbio.2011.04.016</ext-link></comment> <object-id pub-id-type="pmid">21600757</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sauer</surname> <given-names>U</given-names></name>. <article-title>Metabolic networks in motion: 13C-based flux analysis</article-title>. <source>Molecular systems biology</source>. <year>2006</year>;<volume>2</volume>:<fpage>62</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/msb4100109" xlink:type="simple">10.1038/msb4100109</ext-link></comment> <object-id pub-id-type="pmid">17102807</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Booth</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Weljie</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Turner</surname> <given-names>RJ</given-names></name>. <article-title>Computational tools for the secondary analysis of metabolomics experiments</article-title>. <source>Computational and structural biotechnology journal</source>. <year>2013</year>;<volume>4</volume>:<fpage>e201301003</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5936/csbj.201301003" xlink:type="simple">10.5936/csbj.201301003</ext-link></comment> <object-id pub-id-type="pmid">24688685</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Link</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Christodoulou</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sauer</surname> <given-names>U</given-names></name>. <article-title>Advancing metabolic models with kinetic information</article-title>. <source>Current opinion in biotechnology</source>. <year>2014</year>;<volume>29</volume>:<fpage>8</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.copbio.2014.01.015" xlink:type="simple">10.1016/j.copbio.2014.01.015</ext-link></comment> <object-id pub-id-type="pmid">24534671</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khodayari</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zomorrodi</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Liao</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Maranas</surname> <given-names>CD</given-names></name>. <article-title>A kinetic model of Escherichia coli core metabolism satisfying multiple sets of mutant flux data</article-title>. <source>Metabolic engineering</source>. <year>2014</year>;<volume>25</volume>:<fpage>50</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ymben.2014.05.014" xlink:type="simple">10.1016/j.ymben.2014.05.014</ext-link></comment> <object-id pub-id-type="pmid">24928774</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khodayari</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Maranas</surname> <given-names>CD</given-names></name>. <article-title>A genome-scale Escherichia coli kinetic metabolic model k-ecoli457 satisfying flux data for multiple mutant strains</article-title>. <source>Nat Commun</source>. <year>2016</year>;<volume>7</volume>:<fpage>13806</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms13806" xlink:type="simple">10.1038/ncomms13806</ext-link></comment> <object-id pub-id-type="pmid">27996047</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Link</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kochanowski</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sauer</surname> <given-names>U</given-names></name>. <article-title>Systematic identification of allosteric protein-metabolite interactions that control enzyme activity in vivo</article-title>. <source>Nature biotechnology</source>. <year>2013</year>;<volume>31</volume>(<issue>4</issue>):<fpage>357</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.2489" xlink:type="simple">10.1038/nbt.2489</ext-link></comment> <object-id pub-id-type="pmid">23455438</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zampar</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Kümmel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ewald</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jol</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Niebel</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Picotti</surname> <given-names>P</given-names></name>, <etal>et al</etal>. <article-title>Temporal system‐level organization of the switch from glycolytic to gluconeogenic operation in yeast</article-title>. <source>Molecular systems biology</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>651</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005577.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Noguchi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kubota</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Yugi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Toyoshima</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Komori</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Soga</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>The selective control of glycolysis, gluconeogenesis and glycogenesis by temporal insulin patterns</article-title>. <source>Molecular systems biology</source>. <year>2013</year>;<volume>9</volume>(<issue>1</issue>):<fpage>664</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005577.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fuhrer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zamboni</surname> <given-names>N</given-names></name>. <article-title>High-throughput discovery metabolomics</article-title>. <source>Curr Opin Biotechnol</source>. <year>2015</year>;<volume>31</volume>:<fpage>73</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.copbio.2014.08.006" xlink:type="simple">10.1016/j.copbio.2014.08.006</ext-link></comment> <object-id pub-id-type="pmid">25197792</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ewald</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Matt</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zamboni</surname> <given-names>N</given-names></name>. <article-title>The integrated response of primary metabolites to gene deletions and the environment</article-title>. <source>Mol Biosyst</source>. <year>2013</year>;<volume>9</volume>(<issue>3</issue>):<fpage>440</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1039/c2mb25423a" xlink:type="simple">10.1039/c2mb25423a</ext-link></comment> <object-id pub-id-type="pmid">23340584</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cakir</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Patil</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Onsan</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Ulgen</surname> <given-names>KO</given-names></name>, <name name-style="western"><surname>Kirdar</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Nielsen</surname> <given-names>J</given-names></name>. <article-title>Integration of metabolome data with metabolic networks reveals reporter reactions</article-title>. <source>Molecular systems biology</source>. <year>2006</year>;<volume>2</volume>:<fpage>50</fpage>. Epub 2006/10/04. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/msb4100085" xlink:type="simple">10.1038/msb4100085</ext-link></comment> <object-id pub-id-type="pmid">17016516</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Steuer</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kurths</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fiehn</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Weckwerth</surname> <given-names>W</given-names></name>. <article-title>Observing and interpreting correlations in metabolomic networks</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>8</issue>):<fpage>1019</fpage>–<lpage>26</lpage>. <object-id pub-id-type="pmid">12761066</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Duraisingham</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Strobel</surname> <given-names>FH</given-names></name>, <name name-style="western"><surname>Khan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Soltow</surname> <given-names>QA</given-names></name>, <etal>et al</etal>. <article-title>Predicting network activity from high throughput metabolomics</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>(<issue>7</issue>):<fpage>e1003123</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003123" xlink:type="simple">10.1371/journal.pcbi.1003123</ext-link></comment> <object-id pub-id-type="pmid">23861661</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kotze</surname> <given-names>HL</given-names></name>, <name name-style="western"><surname>Armitage</surname> <given-names>EG</given-names></name>, <name name-style="western"><surname>Sharkey</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Allwood</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Dunn</surname> <given-names>WB</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>KJ</given-names></name>, <etal>et al</etal>. <article-title>A novel untargeted metabolomics correlation-based network analysis incorporating human metabolic reconstructions</article-title>. <source>BMC systems biology</source>. <year>2013</year>;<volume>7</volume>:<fpage>107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-7-107" xlink:type="simple">10.1186/1752-0509-7-107</ext-link></comment> <object-id pub-id-type="pmid">24153255</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brush</surname> <given-names>SG</given-names></name>. <article-title>History of the Lenz-Ising model</article-title>. <source>Reviews of modern physics</source>. <year>1967</year>;<volume>39</volume>(<issue>4</issue>):<fpage>883</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005577.ref021"><label>21</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Bishop</surname> <given-names>CM</given-names></name>. <chapter-title>Graphical Models</chapter-title>. <source>Pattern Recognition and Machine Learning</source>: <publisher-name>Springer</publisher-name>; <year>2006</year>.</mixed-citation></ref>
<ref id="pcbi.1005577.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sutton</surname> <given-names>C</given-names></name>. <article-title>An Introduction to Conditional Random Fields</article-title>. <source>Foundations and Trends<sup>®</sup> in Machine Learning</source>. <year>2012</year>;<volume>4</volume>(<issue>4</issue>):<fpage>267</fpage>–<lpage>373</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1561/2200000013" xlink:type="simple">10.1561/2200000013</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005577.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Posma</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Robinette</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Nicholson</surname> <given-names>JK</given-names></name>. <article-title>MetaboNetworks, an interactive Matlab-based toolbox for creating, customizing and exploring sub-networks from KEGG</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>6</issue>):<fpage>893</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btt612" xlink:type="simple">10.1093/bioinformatics/btt612</ext-link></comment> <object-id pub-id-type="pmid">24177720</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>. <article-title>KEGG: kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic acids research</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>30</lpage>. <object-id pub-id-type="pmid">10592173</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andres</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Koethe</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Kroeger</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Helmstaedter</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Briggman</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Denk</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>3D segmentation of SBFSEM images of neuropil by a graphical model over supervoxel boundaries</article-title>. <source>Med Image Anal</source>. <year>2012</year>;<volume>16</volume>(<issue>4</issue>):<fpage>796</fpage>–<lpage>805</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.media.2011.11.004" xlink:type="simple">10.1016/j.media.2011.11.004</ext-link></comment> <object-id pub-id-type="pmid">22374536</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andres</surname> <given-names>BaBTaK</given-names></name>, <name name-style="western"><surname>J.H.</surname></name> <article-title>OpenGM: A C++ Library for Discrete Graphical Models</article-title>. <source>ArXiv e-prints</source>. <year>2012</year>;1206.0111.</mixed-citation></ref>
<ref id="pcbi.1005577.ref027"><label>27</label><mixed-citation publication-type="other" xlink:type="simple">Beucher S, Lantuéjoul C, editors. Use of watersheds in contour detection. International workshop on image processing, real-time edge and motion detection; 1979.</mixed-citation></ref>
<ref id="pcbi.1005577.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heskes</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Eisinga</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Breitling</surname> <given-names>R</given-names></name>. <article-title>A fast algorithm for determining bounds and accurate approximate p-values of the rank product statistic for replicate experiments</article-title>. <source>BMC bioinformatics</source>. <year>2014</year>;<volume>15</volume>:<fpage>367</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12859-014-0367-1" xlink:type="simple">10.1186/s12859-014-0367-1</ext-link></comment> <object-id pub-id-type="pmid">25413493</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eduati</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mangravite</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bare</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Prediction of human population responses to toxic compounds by a collaborative competition</article-title>. <source>Nature biotechnology</source>. <year>2015</year>;<volume>33</volume>(<issue>9</issue>):<fpage>933</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.3299" xlink:type="simple">10.1038/nbt.3299</ext-link></comment> <object-id pub-id-type="pmid">26258538</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Costello</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Heiser</surname> <given-names>LM</given-names></name>, <name name-style="western"><surname>Georgii</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gonen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Menden</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>NJ</given-names></name>, <etal>et al</etal>. <article-title>A community effort to assess and improve drug sensitivity prediction algorithms</article-title>. <source>Nature biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>12</issue>):<fpage>1202</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.2877" xlink:type="simple">10.1038/nbt.2877</ext-link></comment> <object-id pub-id-type="pmid">24880487</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marbach</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Costello</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Kuffner</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vega</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Prill</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Camacho</surname> <given-names>DM</given-names></name>, <etal>et al</etal>. <article-title>Wisdom of crowds for robust gene network inference</article-title>. <source>Nat Methods</source>. <year>2012</year>;<volume>9</volume>(<issue>8</issue>):<fpage>796</fpage>–<lpage>804</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.2016" xlink:type="simple">10.1038/nmeth.2016</ext-link></comment> <object-id pub-id-type="pmid">22796662</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Meyer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cokelaer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Chandran</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Loh</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Tucker</surname> <given-names>G</given-names></name>, <etal>et al</etal>. <article-title>Network topology and parameter estimation: from experimental design methods to gene regulatory network kinetics using a community based approach</article-title>. <source>BMC systems biology</source>. <year>2014</year>;<volume>8</volume>:<fpage>13</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-8-13" xlink:type="simple">10.1186/1752-0509-8-13</ext-link></comment> <object-id pub-id-type="pmid">24507381</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fuhrer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Zampieri</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sévin</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Sauer</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Zamboni</surname> <given-names>N</given-names></name>. <source>Genome-wide landscape of gene-metabolome associations in Escherichia coli</source>. <year>2016</year>.</mixed-citation></ref>
<ref id="pcbi.1005577.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gama-Castro</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Salgado</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Peralta-Gil</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Santos-Zavaleta</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Muniz-Rascado</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Solano-Lira</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>RegulonDB version 7.0: transcriptional regulation of Escherichia coli K-12 integrated within genetic sensory response units (Gensor Units)</article-title>. <source>Nucleic acids research</source>. <year>2011</year>;<volume>39</volume>(<issue>Database issue</issue>):<fpage>D98</fpage>–<lpage>105</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkq1110" xlink:type="simple">10.1093/nar/gkq1110</ext-link></comment> <object-id pub-id-type="pmid">21051347</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maas</surname> <given-names>WK</given-names></name>. <article-title>The arginine repressor of Escherichia coli</article-title>. <source>Microbiological reviews</source>. <year>1994</year>;<volume>58</volume>(<issue>4</issue>):<fpage>631</fpage>–<lpage>40</lpage>. <object-id pub-id-type="pmid">7854250</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cai</surname> <given-names>XY</given-names></name>, <name name-style="western"><surname>Maxon</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Redfield</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Glass</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Brot</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Weissbach</surname> <given-names>H</given-names></name>. <article-title>Methionine synthesis in Escherichia coli: effect of the MetR protein on metE and metH expression</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>1989</year>;<volume>86</volume>(<issue>12</issue>):<fpage>4407</fpage>–<lpage>11</lpage>. <object-id pub-id-type="pmid">2543976</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Beacham</surname> <given-names>IR</given-names></name>. <article-title>Transcription and regulation of the cpdB gene in Escherichia coli K12 and Salmonella typhimurium LT2: evidence for modulation of constitutive promoters by cyclic AMP-CRP complex</article-title>. <source>Molecular &amp; general genetics: MGG</source>. <year>1990</year>;<volume>222</volume>(<issue>1</issue>):<fpage>161</fpage>–<lpage>5</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005577.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mori</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Aiba</surname> <given-names>H</given-names></name>. <article-title>Evidence for negative control of cya transcription by cAMP and cAMP receptor protein in intact Escherichia coli cells</article-title>. <source>The Journal of biological chemistry</source>. <year>1985</year>;<volume>260</volume>(<issue>27</issue>):<fpage>14838</fpage>–<lpage>43</lpage>. <object-id pub-id-type="pmid">2414300</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuehne</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Emmert</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Soehle</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Winnefeld</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fischer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wenck</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Acute Activation of Oxidative Pentose Phosphate Pathway as First-Line Response to Oxidative Stress in Human Skin Cells</article-title>. <source>Mol Cell</source>. <year>2015</year>;<volume>59</volume>(<issue>3</issue>):<fpage>359</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.molcel.2015.06.017" xlink:type="simple">10.1016/j.molcel.2015.06.017</ext-link></comment> <object-id pub-id-type="pmid">26190262</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tretter</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Adam-Vizi</surname> <given-names>V</given-names></name>. <article-title>Inhibition of Krebs cycle enzymes by hydrogen peroxide: A key role of [alpha]-ketoglutarate dehydrogenase in limiting NADH production under oxidative stress</article-title>. <source>The Journal of neuroscience: the official journal of the Society for Neuroscience</source>. <year>2000</year>;<volume>20</volume>(<issue>24</issue>):<fpage>8972</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005577.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tretter</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Adam-Vizi</surname> <given-names>V</given-names></name>. <article-title>Alpha-ketoglutarate dehydrogenase: a target and generator of oxidative stress</article-title>. <source>Philosophical transactions of the Royal Society of London Series B, Biological sciences</source>. <year>2005</year>;<volume>360</volume>(<issue>1464</issue>):<fpage>2335</fpage>–<lpage>45</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2005.1764" xlink:type="simple">10.1098/rstb.2005.1764</ext-link></comment> <object-id pub-id-type="pmid">16321804</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shi</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>GE</given-names></name>. <article-title>Up-regulation of the mitochondrial malate dehydrogenase by oxidative stress is mediated by miR-743a</article-title>. <source>Journal of neurochemistry</source>. <year>2011</year>;<volume>118</volume>(<issue>3</issue>):<fpage>440</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1471-4159.2011.07333.x" xlink:type="simple">10.1111/j.1471-4159.2011.07333.x</ext-link></comment> <object-id pub-id-type="pmid">21623795</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fuhrer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Heer</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Begemann</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Zamboni</surname> <given-names>N</given-names></name>. <article-title>High-throughput, accurate mass metabolome profiling of cellular extracts by flow injection-time-of-flight mass spectrometry</article-title>. <source>Analytical chemistry</source>. <year>2011</year>;<volume>83</volume>(<issue>18</issue>):<fpage>7074</fpage>–<lpage>80</lpage>. Epub 2011/08/13. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/ac201267k" xlink:type="simple">10.1021/ac201267k</ext-link></comment> <object-id pub-id-type="pmid">21830798</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ralser</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wamelink</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Kowald</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gerisch</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Heeren</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Struys</surname> <given-names>EA</given-names></name>, <etal>et al</etal>. <article-title>Dynamic rerouting of the carbohydrate flux is key to counteracting oxidative stress</article-title>. <source>J Biol</source>. <year>2007</year>;<volume>6</volume>(<issue>4</issue>):<fpage>10</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/jbiol61" xlink:type="simple">10.1186/jbiol61</ext-link></comment> <object-id pub-id-type="pmid">18154684</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ralser</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wamelink</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Latkolik</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jansen</surname> <given-names>EE</given-names></name>, <name name-style="western"><surname>Lehrach</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Jakobs</surname> <given-names>C</given-names></name>. <article-title>Metabolic reconfiguration precedes transcriptional regulation in the antioxidant response</article-title>. <source>Nat Biotechnol</source>. <year>2009</year>;<volume>27</volume>(<issue>7</issue>):<fpage>604</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt0709-604" xlink:type="simple">10.1038/nbt0709-604</ext-link></comment> <object-id pub-id-type="pmid">19587661</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Link</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Fuhrer</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gerosa</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zamboni</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sauer</surname> <given-names>U</given-names></name>. <article-title>Real-time metabolome profiling of the metabolic switch between starvation and growth</article-title>. <source>Nature Methods</source>. <year>2015</year>.</mixed-citation></ref>
<ref id="pcbi.1005577.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pirhaji</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Milani</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Leidl</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Curran</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Avila-Pacheco</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Clish</surname> <given-names>CB</given-names></name>, <etal>et al</etal>. <article-title>Revealing disease-associated pathways by network integration of untargeted metabolomics</article-title>. <source>Nat Methods</source>. <year>2016</year>;<volume>13</volume>(<issue>9</issue>):<fpage>770</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nmeth.3940" xlink:type="simple">10.1038/nmeth.3940</ext-link></comment> <object-id pub-id-type="pmid">27479327</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Krumsiek</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Suhre</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Mitchell</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Mohney</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Milburn</surname> <given-names>MV</given-names></name>, <etal>et al</etal>. <article-title>Mining the unknown: a systems approach to metabolite identification combining genetic and metabolic information</article-title>. <source>PLoS Genet</source>. <year>2012</year>;<volume>8</volume>(<issue>10</issue>):<fpage>e1003005</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pgen.1003005" xlink:type="simple">10.1371/journal.pgen.1003005</ext-link></comment> <object-id pub-id-type="pmid">23093944</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jha</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Sergushichev</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lampropoulou</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ivanova</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Loginicheva</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Network integration of parallel metabolic and transcriptional data reveals metabolic modules that regulate macrophage polarization</article-title>. <source>Immunity</source>. <year>2015</year>;<volume>42</volume>(<issue>3</issue>):<fpage>419</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.immuni.2015.02.005" xlink:type="simple">10.1016/j.immuni.2015.02.005</ext-link></comment> <object-id pub-id-type="pmid">25786174</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beisser</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Grohme</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Kopka</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Frohme</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Schill</surname> <given-names>RO</given-names></name>, <name name-style="western"><surname>Hengherr</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Integrated pathway modules using time-course metabolic profiles and EST data from Milnesium tardigradum</article-title>. <source>BMC Syst Biol</source>. <year>2012</year>;<volume>6</volume>:<fpage>72</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-6-72" xlink:type="simple">10.1186/1752-0509-6-72</ext-link></comment> <object-id pub-id-type="pmid">22713133</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sova</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Dombek</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>EY</given-names></name>, <name name-style="western"><surname>Vu</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Stitching together multiple data dimensions reveals interacting metabolomic and transcriptomic networks that modulate cell regulation</article-title>. <source>PLoS Biol</source>. <year>2012</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1001301</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.1001301" xlink:type="simple">10.1371/journal.pbio.1001301</ext-link></comment> <object-id pub-id-type="pmid">22509135</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bartel</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Krumsiek</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>. <article-title>Statistical methods for the analysis of high-throughput metabolomics data</article-title>. <source>Comput Struct Biotechnol J</source>. <year>2013</year>;<volume>4</volume>:<fpage>e201301009</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5936/csbj.201301009" xlink:type="simple">10.5936/csbj.201301009</ext-link></comment> <object-id pub-id-type="pmid">24688690</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hensley</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Faubert</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Yuan</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Lev-Cohain</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Metabolic Heterogeneity in Human Lung Tumors</article-title>. <source>Cell</source>. <year>2016</year>;<volume>164</volume>(<issue>4</issue>):<fpage>681</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2015.12.034" xlink:type="simple">10.1016/j.cell.2015.12.034</ext-link></comment> <object-id pub-id-type="pmid">26853473</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robertson-Tessi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gillies</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Gatenby</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>AR</given-names></name>. <article-title>Impact of metabolic heterogeneity on tumor growth, invasion, and treatment outcomes</article-title>. <source>Cancer Res</source>. <year>2015</year>;<volume>75</volume>(<issue>8</issue>):<fpage>1567</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1158/0008-5472.CAN-14-1428" xlink:type="simple">10.1158/0008-5472.CAN-14-1428</ext-link></comment> <object-id pub-id-type="pmid">25878146</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sengupta</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pratx</surname> <given-names>G</given-names></name>. <article-title>Imaging metabolic heterogeneity in cancer</article-title>. <source>Mol Cancer</source>. <year>2016</year>;<volume>15</volume>(<issue>1</issue>):<fpage>4</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12943-015-0481-3" xlink:type="simple">10.1186/s12943-015-0481-3</ext-link></comment> <object-id pub-id-type="pmid">26739333</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lopes</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Franz</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kazi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Donaldson</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Morris</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Bader</surname> <given-names>GD</given-names></name>. <article-title>Cytoscape Web: an interactive web-based network browser</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>18</issue>):<fpage>2347</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq430" xlink:type="simple">10.1093/bioinformatics/btq430</ext-link></comment> <object-id pub-id-type="pmid">20656902</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baba</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ara</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hasegawa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Takai</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Okumura</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Baba</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Construction of Escherichia coli K-12 in-frame, single-gene knockout mutants: the Keio collection</article-title>. <source>Molecular systems biology</source>. <year>2006</year>;<volume>2</volume>:<fpage>2006 0008</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/msb4100050" xlink:type="simple">10.1038/msb4100050</ext-link></comment> <object-id pub-id-type="pmid">16738554</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kitagawa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ara</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Arifuzzaman</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ioka-Nakamichi</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Inamoto</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Toyonaga</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Complete set of ORF clones of Escherichia coli ASKA library (a complete set of E. coli K-12 ORF archive): unique resources for biological research</article-title>. <source>DNA research: an international journal for rapid publication of reports on genes and genomes</source>. <year>2005</year>;<volume>12</volume>(<issue>5</issue>):<fpage>291</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/dnares/dsi012" xlink:type="simple">10.1093/dnares/dsi012</ext-link></comment> <object-id pub-id-type="pmid">16769691</object-id></mixed-citation></ref>
<ref id="pcbi.1005577.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bradford</surname> <given-names>MM</given-names></name>. <article-title>A rapid and sensitive method for the quantitation of microgram quantities of protein utilizing the principle of protein-dye binding</article-title>. <source>Analytical biochemistry</source>. <year>1976</year>;<volume>72</volume>:<fpage>248</fpage>–<lpage>54</lpage>. <object-id pub-id-type="pmid">942051</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>