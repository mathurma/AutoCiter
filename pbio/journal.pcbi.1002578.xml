<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00189</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002578</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Neuroscience</subject>
            <subj-group>
              <subject>Computational neuroscience</subject>
              <subj-group>
                <subject>Coding mechanisms</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Motor systems</subject>
              <subject>Neurophysiology</subject>
              <subject>Sensory systems</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Control engineering</subject>
            <subj-group>
              <subject>Control systems</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Engineering</subject>
          <subj-group>
            <subject>Bioengineering</subject>
            <subj-group>
              <subject>Biological systems engineering</subject>
              <subject>Biomedical engineering</subject>
              <subject>Bionics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Biotechnology</subject>
          <subject>Neuroscience</subject>
          <subject>Computer Science</subject>
        </subj-group>
      </article-categories><title-group><article-title>Shaping the Dynamics of a Bidirectional Neural Interface</article-title><alt-title alt-title-type="running-head">Shaping the Dynamics of a Neural Interface</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Vato</surname>
            <given-names>Alessandro</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Semprini</surname>
            <given-names>Marianna</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Maggiolini</surname>
            <given-names>Emma</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Szymanski</surname>
            <given-names>Francois D.</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Fadiga</surname>
            <given-names>Luciano</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Panzeri</surname>
            <given-names>Stefano</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="aff" rid="aff4">
            <sup>4</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Mussa-Ivaldi</surname>
            <given-names>Ferdinando A.</given-names>
          </name>
          <xref ref-type="aff" rid="aff5">
            <sup>5</sup>
          </xref>
          <xref ref-type="aff" rid="aff6">
            <sup>6</sup>
          </xref>
          <xref ref-type="aff" rid="aff7">
            <sup>7</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group><aff id="aff1"><label>1</label><addr-line>Department of Robotics, Brain and Cognitive Sciences, Istituto Italiano di Tecnologia, Genova, Italy</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Human Physiology, University of Ferrara, Ferrara, Italy</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Center for Neuroscience and Cognitive Systems, Istituto Italiano di Tecnologia, Rovereto, Italy</addr-line>       </aff><aff id="aff4"><label>4</label><addr-line>Institute of Neuroscience and Psychology, University of Glasgow, Glasgow, United Kingdom</addr-line>       </aff><aff id="aff5"><label>5</label><addr-line>Department of Physiology, Northwestern University, Chicago, Illinois, United States of America</addr-line>       </aff><aff id="aff6"><label>6</label><addr-line>Department of Biomedical Engineering, Northwestern University, Evanston, Illinois, United States of America</addr-line>       </aff><aff id="aff7"><label>7</label><addr-line>Sensory Motor Performance Program, Rehabilitation Institute of Chicago, Chicago, Illinois, United States of America</addr-line>       </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Diedrichsen</surname>
            <given-names>Jörn</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">University College London, United Kingdom</aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">sandro@northwestern.edu</email></corresp>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: AV MS LF SP FAMI. Performed the experiments: AV MS EM. Analyzed the data: AV MS FDS SP FAMI. Wrote the paper: AV MS EM SP FAMI.</p>
        </fn>
      <fn fn-type="conflict">
        <p>The authors have declared that no competing interests exist.</p>
      </fn></author-notes><pub-date pub-type="collection">
        <month>7</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>19</day>
        <month>7</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>7</issue><elocation-id>e1002578</elocation-id><history>
        <date date-type="received">
          <day>1</day>
          <month>2</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>9</day>
          <month>5</month>
          <year>2012</year>
        </date>
      </history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2012</copyright-year><copyright-holder>Vato et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
        <p>Progress in decoding neural signals has enabled the development of interfaces that translate cortical brain activities into commands for operating robotic arms and other devices. The electrical stimulation of sensory areas provides a means to create artificial sensory information about the state of a device. Taken together, neural activity recording and microstimulation techniques allow us to embed a portion of the central nervous system within a closed-loop system, whose behavior emerges from the combined dynamical properties of its neural and artificial components. In this study we asked if it is possible to concurrently regulate this bidirectional brain-machine interaction so as to shape a desired dynamical behavior of the combined system. To this end, we followed a well-known biological pathway. In vertebrates, the communications between brain and limb mechanics are mediated by the spinal cord, which combines brain instructions with sensory information and organizes coordinated patterns of muscle forces driving the limbs along dynamically stable trajectories. We report the creation and testing of the first neural interface that emulates this sensory-motor interaction. The interface organizes a bidirectional communication between sensory and motor areas of the brain of anaesthetized rats and an external dynamical object with programmable properties. The system includes (a) a motor interface decoding signals from a motor cortical area, and (b) a sensory interface encoding the state of the external object into electrical stimuli to a somatosensory area. The interactions between brain activities and the state of the external object generate a family of trajectories converging upon a selected equilibrium point from arbitrary starting locations. Thus, the bidirectional interface establishes the possibility to specify not only a particular movement trajectory but an entire family of motions, which includes the prescribed reactions to unexpected perturbations.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Brain-machine interfaces establish new communication channels between the brain and the external world with the goal of restoring sensory and motor functions for people with severe paralysis or sensory impairments. Current methodologies are based on decoding the motor intent from the recorded neural activity and transforming the extracted information into motor commands to control external devices as robotic arms. We developed a novel computational approach, based on the concept of programming dynamical behaviors trough the bi-directional sensory-motor interaction between the brain and the connected external device. This approach is based on the emulation of some control features of a biological interface, the spinal cord. The first prototype of our interface controls the state of motion of a simulated point mass in a viscous medium. The position of the point mass is encoded into a stimulus to the somatosensory cortex of an anesthetized rat. The evoked activity of a population of motor cortical neurons is decoded into a force vector applied to the point mass. The parameters of the encoder and of the decoder are set to approximate a desired force field. In the first test of the interface, we obtained a family of trajectories that converged upon a stable attractor.</p>
      </abstract><funding-group><funding-statement>This work was supported by the BMI and the Neural Computation projects of the Robotics, Brain and Cognitive Sciences Department, Italian Institute of Technology Italy and NINDS grants NS048845 and 1R21HD053608 to FAM-I. We acknowledge the financial support of the SI-CODE project of the Future and Emerging Technologies (FET) programme within the Seventh Framework Programme for Research of the European Commission, under FET-Open grant number: FP7-284553. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts>
        <page-count count="15"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>In a recent demonstration <xref ref-type="bibr" rid="pcbi.1002578-Velliste1">[1]</xref>, Schwartz and coworkers decoded neural activities from the motor area of a monkey's cerebral cortex to control the movement of a robotic arm. The monkey learned to activate the recorded neurons and to guide the arm for transporting food to the mouth. This is an undisputed milestone in Neural Engineering, highlighting the potential of neural interfaces (NIs) as a means to restore a connection with the world for people with severe paralysis. In addition to their clinical impact, NIs have the potential to revolutionize our ways to study the nervous system, by connecting live neural populations with external devices, both physical and simulated. This constitutes a leap forward with respect to current paradigms, in which physiological experiments and computational analyses are carried out separately.</p>
      <p>Both the clinical and the basic science applications of NIs call for the possibility to close the sensory-motor loop, by combining a decoding interface – mapping neural activities into inputs to the external device – with an encoding interface – mapping the state of the device into a direct input to the brain, such as an electrical stimulus. In this study we addressed the challenge to create a coordinated bidirectional brain-machine interaction by concurrently setting up a decoding and an encoding interface, which combined generate a dynamic control policy in the form of a force field. In this approach, we aimed at emulating the operation of the spinal cord, as the prime biological interface between the brain and the musculoskeletal apparatus.</p>
      <p>Ascending tracts of the spinal cord inform the brain about the state of motion of the limbs and about physical properties of the environment. Descending tracts distribute motor commands across groups of muscles both by direct connections with the motoneuronal pools and by connections with spinal interneurons that activate multiple muscles spanning one or more joints <xref ref-type="bibr" rid="pcbi.1002578-Cheney1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Fetz1">[3]</xref>. Earlier studies in frogs <xref ref-type="bibr" rid="pcbi.1002578-Bizzi1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-MussaIvaldi1">[6]</xref>, rats <xref ref-type="bibr" rid="pcbi.1002578-Tresch1">[7]</xref>, and cats <xref ref-type="bibr" rid="pcbi.1002578-Lemay1">[8]</xref> have revealed that the electrical stimulation of the grey matter in the lumbar spinal cord results in a field of forces acting on the ipsilateral hind limb. This finding has a simple biomechanical basis. The force generated by a muscle varies depending on the state of motion of the muscle – i.e. its instantaneous length and shortening rate. In addition, variety of other factors, such as fatigue and hysteresis, and environmental variable, such as temperature, affect muscle force. While the detailed analysis of these factors is beyond the scope of this work, we may simply state that when the spinal cord activates an ensemble of muscles in response to a cortical command, the net mechanical outcome is a spatial pattern of forces – a force field – that sets the limb in motion. The above mentioned studies have highlighted the presence of convergent patterns of forces, but evidence from other investigations <xref ref-type="bibr" rid="pcbi.1002578-Grillner1">[9]</xref> have suggested more complex spatio-temporal structures of the underlying force fields.</p>
      <p>Our study aimed at reproducing in an artificial interface this basic control mechanism. We considered the problem of generating by function approximation a force field that converges to a central equilibrium point. This is a very particular instantiation out of a much larger repertoire of possible mechanical behaviors, which may be represented as a functional map from the state of motion of a limb, i.e. its position and velocity, and the ensuing force generated by the musculoskeletal apparatus.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>General scheme of the dynamic Neural Interface</title>
        <p>In the language of control theory, the spinal cord establishes a policy <xref ref-type="bibr" rid="pcbi.1002578-Sutton1">[10]</xref> by specifying the forces to be generated throughout the reachable space in response to unexpected perturbations. We have adopted this perspective for developing a new type of neural interface called dynamic Neural Interface (dNI), which borrows a local portion of cortical tissue to emulate the generation of force fields by the spinal cord <xref ref-type="bibr" rid="pcbi.1002578-Bizzi1">[4]</xref>.</p>
        <p>The dNI has 4 components, as illustrated in <xref ref-type="fig" rid="pcbi-1002578-g001">Figure 1</xref>. We performed all tests on anesthetized Long-Evans rats. The rats' brain interacted with a dynamical system through a sensory interface and a motor interface. On the brain side, one microwire array delivered the microstimulation to the vibrissal representation of primary somatosensory cortex (S1) and a second microwire array recorded the neural signals from vibrissal motor cortex (M1). On the other side of the interface there was a simple and well-understood dynamical system: a simulated point mass moving over a horizontal plane within a viscous medium.</p>
        <fig id="pcbi-1002578-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002578.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>Experimental setup of the dynamic neural interface.</title>
            <p>We placed two 16-channel microwire arrays (<italic>recording</italic> and <italic>stimulating</italic> arrays) in the vibrissa motor (M1) and sensory areas (S1) of a rat brain cortex. (A) In this example 4 electrical stimulation patterns are set by specifying the pair of electrodes in the 16-channel microwire stimulating array placed in area S1. (B) The activity of a small population of single neurons (11 in this illustration) of area M1 is recorded in response to each electrical stimulation pattern. The activity of each neuron is plotted on a row over a rectangular frame, whose color indicates the correspondence with a stimulation pattern. (C) The motor interface generates a force vector from the first two principal components of the response of the M1 neurons. (D) The obtained force vector is applied to a simulated point-mass moving in a viscous medium. The interaction with such dynamical system aims to emulate a reaching movement creating a convergent force field similar to the force fields observed during microstimulation of the spinal gray matter. (E) The sensory interface maps each point in the field into the corresponding stimulation pattern.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.g001" xlink:type="simple"/>
        </fig>
        <p>We began each experiment by collecting a “training” set of neural population responses to repeated presentations of different electrical stimulation patterns. We used these training data to implement a calibration procedure for establishing concurrently the encoding function of the sensory interface and the decoding function of the motor interface. Following the calibration procedure, we tested the competence of the interface (<italic>test phase</italic>) to drive the simulated point mass towards a goal location, which was defined by the central equilibrium point of a radial force field.</p>
      </sec>
      <sec id="s2b">
        <title>Sensory-motor mapping</title>
        <p>The purpose of the sensory-motor mapping is to set the parameters of the sensory and motor interfaces so as to approximate the desired force field. While force fields are continuous maps from position to force, the interface has a finite number of stimuli. Therefore, the mapping procedure must construct an approximation of the desired field with only a small number of vectors. To this end, we construct a cascade of three mappings: 1) a mapping from the position of the external device to one of selected stimuli; 2) a mapping from each stimulus to the evoked neural activity, and 3) a mapping from the evoked neural activity to the force acting on the external device. The first and last mappings are established by the interface software (i.e. sensory and motor interfaces), the second mapping is established by the properties of the neural structures that connect the stimulation and recording arrays.</p>
        <p>In this first implementation, the sensory interface established a map from the position of the point mass to one of 4 stimulation electrodes (<xref ref-type="fig" rid="pcbi-1002578-g001">Figure 1A</xref>). The sensory mapping procedure (as detailed below) divided the workspace into 4 contiguous regions corresponding to a small “vocabulary” of 4 stimuli. At each iteration step, the interface algorithm selected the stimulus based on the region in which the point mass was located. The electrode delivered a train of 10 biphasic pulses (150 µA, 100 µs/phase) at 333 Hz <xref ref-type="bibr" rid="pcbi.1002578-Butovas1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Donoghue1">[12]</xref>. Larger vocabularies of stimuli can be generated by using a greater number of electrodes and by including electrode combinations. With a greater number of distinct stimuli, the workspace would be divided into smaller and denser regions, thus increasing the quality of the approximation of the desired continuous field. In a physiological system, the region of space that can activate a sensory neuron is called a “receptive field”. Here, the workspace of the sensory interface is divided into regions that are analogous to receptive fields: the mechanical system triggers an electrode when it passes by the region corresponding to that electrode.</p>
        <p>The motor interface transformed recorded neural activities into force vectors applied to the simulated point mass (<xref ref-type="fig" rid="pcbi-1002578-g001">Figure 1B–D</xref>). A commercial spike-sorting algorithm (Rasputin, Plexon Inc.) decomposed the recorded neural signals into single-unit activities. We sorted 5–20 single units in each session from a 16 channel microwire array (average ± SEM across sessions was 13.69±0.48 units). The single trial responses of each neuron to the stimulation pattern consisted of a time series of spike counts computed in time bins of size Δt over a window of duration T·Δt, starting from the end of the stimulus. The neural population response was quantified as an array of such binned spike sequences. We found that post-stimulus windows of duration in the range between 100 and 600 ms binned at a resolution of Δt = 5 ms led to best performance of the interface (see below). Unless otherwise stated, in the following we present results obtained by running the interface using Δt = 5 ms and T·Δt = 600 ms. In this case, the input to the motor interface was a matrix with N rows and 120 (i.e. 600/5) columns (<xref ref-type="fig" rid="pcbi-1002578-g001">Figure 1B</xref>). During the test phase, the single-trial neural population response matrix was linearly mapped into the two components of a planar force vector.</p>
      </sec>
      <sec id="s2c">
        <title>Dynamic shaping algorithm</title>
        <p>In the following we describe the “dynamic shaping” algorithm for the concurrent calibration of the sensory and motor maps. The algorithm is defined by a set of 4 key parameters:</p>
        <list list-type="bullet">
          <list-item>
            <p>N: number of recorded neurons as established by spike sorting</p>
          </list-item>
          <list-item>
            <p>T: number of time-intervals (bins) recorded on each neuron</p>
          </list-item>
          <list-item>
            <p>S: number of stimulation patterns (the stimulus vocabulary)</p>
          </list-item>
          <list-item>
            <p>R: number of repetitions of each stimulus pattern during the calibration procedure.</p>
          </list-item>
        </list>
        <p>During the calibration each stimulation patterns was repeated R times and, accordingly, R×N neural responses were recorded. Each response was an array of T values: the number of spikes in each bin. The calibration responses were then represented as S×R N-dimensional vector functions:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e001" xlink:type="simple"/><label>(1)</label></disp-formula>From these calibration responses, we averaged the responses obtained from the repetitions of each stimulus, to extract S mean responses<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e002" xlink:type="simple"/><label>(2)</label></disp-formula>Following the same notation, a neural response vector is an N-dimensional vector function<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e003" xlink:type="simple"/><label>(3)</label></disp-formula>The inner product of two neural responses is defined by extension over time bins and units of the Euclidean inner product:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e004" xlink:type="simple"/><label>(4)</label></disp-formula>The S mean calibration responses form a set of basis fields – a direct extension of the concept of basis vectors – that were used to approximate all recorded neural responses. In particular, each calibration response was approximated as a sum of mean responses:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e005" xlink:type="simple"/><label>(5)</label></disp-formula>To derive the combination coefficients <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e006" xlink:type="simple"/></inline-formula>, one takes the inner product of each side of Equation (5) with each basis function. This leads to S vector/matrix equations<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e007" xlink:type="simple"/><label>(6)</label></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e008" xlink:type="simple"/><label>(7)</label></disp-formula>Equation (7) can be solved for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e009" xlink:type="simple"/></inline-formula> provided that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e010" xlink:type="simple"/></inline-formula> (if the projection matrix is singular, one can use a pseudo-inverse. But this does not seem to be a likely situation and was not encountered with any of our datasets).</p>
        <p>With this, each calibration response was mapped respectively into an S-dimensional vector<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e011" xlink:type="simple"/><label>(8)</label></disp-formula>Each response corresponds to a d-vector and vice-versa, each d-vector corresponds to a unique approximation of the response (the likelihood that two distinct signals map onto the same d-vector is vanishingly small). Therefore, we took the S-dimensional <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e012" xlink:type="simple"/></inline-formula> vectors as representations of the individual neural responses obtained after applying each stimulus.</p>
      </sec>
      <sec id="s2d">
        <title>Motor interface</title>
        <p>To calibrate the motor interface, we used principal component analysis (PCA) and extracted the two principal components that capture the greatest amount of variance in the set of the S×R calibration vectors, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e013" xlink:type="simple"/></inline-formula>. These two components are two S-dimensional arrays that form the rows of the 2×S projection matrix<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e014" xlink:type="simple"/><label>(9)</label></disp-formula>This operator defines the two-dimensional plane with maximum variance over the set of S stimuli. The next step of the calibration procedure involved stretching the matrix so as to match the range of variation of the x and y components of the force vectors over the desired force field domain:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e015" xlink:type="simple"/><label>(10)</label></disp-formula>The gain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e016" xlink:type="simple"/></inline-formula> is a 2×2 diagonal matrix that scales the two-dimensional projections of the calibration recordings to cover the range of the desired force field, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e017" xlink:type="simple"/></inline-formula>. The field establishes a correspondence between the position, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e018" xlink:type="simple"/></inline-formula>, of the controlled object – in this first implementation a point mass – and a resulting force <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e019" xlink:type="simple"/></inline-formula>. Here, we make the additional hypothesis that this field is invertible, which means that there is a function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e020" xlink:type="simple"/></inline-formula> mapping force vectors to corresponding positions. This is obviously the case if the field is linear, as in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e021" xlink:type="simple"/></inline-formula> and the “stiffness” matrix is non-singular. The requirement of invertibility can be relaxed to a local and continuous form.</p>
        <p>The two projection matrices, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e022" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e023" xlink:type="simple"/></inline-formula>, and the mean calibration responses, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e024" xlink:type="simple"/></inline-formula>, to all the stimuli generate a map from the data collected during the experiment to a corresponding two-dimensional force vector<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e025" xlink:type="simple"/><label>(11)</label></disp-formula>This is a linear filter that operates in real time.</p>
      </sec>
      <sec id="s2e">
        <title>Sensory interface</title>
        <p>The sensory interface maps the instantaneous position of the controlled object onto one of the stimulation patterns in the calibration vocabulary.</p>
        <p>This sensory interface performs a look-up operation:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e026" xlink:type="simple"/><label>(12)</label></disp-formula>that picks up the stimulus, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e027" xlink:type="simple"/></inline-formula>, corresponding to the “calibration site” <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e028" xlink:type="simple"/></inline-formula> that is closest to the current position <italic>ρ</italic> of the controlled object. The calibration sites <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e029" xlink:type="simple"/></inline-formula>are the S locations:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e030" xlink:type="simple"/><label>(13)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e031" xlink:type="simple"/></inline-formula> is the force derived by Equation (11) from the average response, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e032" xlink:type="simple"/></inline-formula>, to the i-th stimulus in the vocabulary.</p>
        <p>In this first implementation, there were 4 distinct electrical stimuli, s<sub>1</sub>, s<sub>2</sub>, s<sub>3</sub> and s<sub>4</sub> and 4 mean corresponding neural responses, r<sub>1</sub>, r<sub>2</sub> r<sub>3</sub> and r<sub>4</sub> (<xref ref-type="fig" rid="pcbi-1002578-g002">Figure 2A</xref>). Each mean neural response was a high-dimensional collection of spiking activities, which was reduced by the motor interface to the two coordinates of a force vector. Principal component analysis (PCA) performed this dimensionality reduction by extracting from each of the 4 mean neural responses recorded during the calibration phase the two principal components that capture the highest amount of signal variance. We scaled these two components so as to span the variance of the force vectors over the desired force field. This process resulted in a simple linear mapping, i.e. a gain matrix and an offset vector that, when applied to the neural response produced a force vector (Equation 11). In particular, the 4 mean responses collected during the calibration mapped to 4 template force vectors F<sub>1</sub>, F<sub>2</sub>, F<sub>3</sub>, and F<sub>4</sub> (<xref ref-type="fig" rid="pcbi-1002578-g002">Figure 2B</xref>). The desired force field established a relationship between these template force vectors and 4 positions, x<sub>1</sub>, x<sub>2</sub>, x<sub>3</sub> and x<sub>4</sub> (<xref ref-type="fig" rid="pcbi-1002578-g002">Figure 2C</xref>). These 4 positions partitioned the space of the external device into 4 contiguous regions, A<sub>1</sub>, A<sub>2</sub>, A<sub>3</sub> and A<sub>4</sub>, based on a nearest-neighbor map: a generic point x was associated to the region A<sub>i</sub> if x<sub>i</sub> was the nearest calibration position (<xref ref-type="fig" rid="pcbi-1002578-g002">Figure 2D</xref>). In this case, the sensory interface triggered the stimulus s<sub>i</sub>. It is straightforward to extend this procedure to an arbitrary number of stimuli for generating denser approximations of the desired force field.</p>
        <fig id="pcbi-1002578-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002578.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Calibration procedure scheme.</title>
            <p>The purpose of the calibration procedure is to set the parameters of the neural interface. The calibration consists of 4 steps. (A) <italic>Recording a training set</italic>. The calibration procedure is performed upon a <italic>training set</italic> (r<sub>1</sub>…r<sub>n</sub>) built by recording the neural activities evoked over multiple presentations (usually 100) of each of the <italic>n</italic> stimulation patterns (s<sub>1</sub>…s<sub>n</sub> with n = 4 in this example). (B) <italic>Motor Map</italic>. The training set is also used to set the motor map. The spike trains from multiple neurons are reduced by PCA to two coordinates of a force vector. In this example the result of this operation is a set of 4 <italic>template vectors</italic>, each corresponding to a stimulation pattern. (C) <italic>Desired force field map</italic>. The chosen desired force field to be approximated (e.g. a continuous radial force field converging towards a central equilibrium point) establishes a relationship between the <italic>n template vectors</italic> and the <italic>n</italic> positions in the two-dimensional space. (D) <italic>Sensory Map</italic>. The <italic>n</italic> positions are used to partition the external device space by using a space partition algorithm (e.g. in this case a nearest neighbor map) and, as a consequence, <italic>n</italic> sensory regions (A<sub>1</sub>…A<sub>n</sub>) are defined. A look-up table connects each sensory region to a corresponding stimulation pattern. As a result, the sensory map converts each position of the space into a stimulation pattern.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.g002" xlink:type="simple"/>
        </fig>
      </sec>
      <sec id="s2f">
        <title>The dynamic neural interface generates an approximation of the desired force field</title>
        <p>The concurrent operation of the sensory and the motor interfaces resulted in the realization of a force field that approximated a desired radial force field converging towards a central equilibrium point (<xref ref-type="fig" rid="pcbi-1002578-g002">Figure 2C</xref>). If one might assume that the recorded neural activity elicited by each stimulus remained invariant through time, then the field generated by the interface would be a piecewise constant approximation of the desired field. However, the inherent variability of neural activities observed after each repetition of an electrical stimulation pattern violated this assumption. This variability was mostly caused by background activities that interacted with the activities induced by the stimulus. In the anesthetized preparation, the background activities can be considered as random noise. In the alert animal, these activities may also contain a voluntary component. In this way the actual field is an additive superposition of the field approximation established by the interface with a random component induced by background neural noise. Extracting as much information about the stimulus as possible from the recorded signals is a key technical challenge for generating a controlled desired dynamical behavior with the bidirectional interface.</p>
      </sec>
      <sec id="s2g">
        <title>The dynamic neural interface is able to drive a point mass to a target location</title>
        <p>During the test phase, we probed the ability of the dNI to drive the simulated point mass towards a goal location, corresponding by design to the central equilibrium point of the <italic>desired force field</italic>. This is a simplified representation of a reaching movement, where the interface emulates the generation of a convergent force field similar to those observed after microstimulation of the spinal grey matter <xref ref-type="bibr" rid="pcbi.1002578-Bizzi1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-MussaIvaldi1">[6]</xref>.</p>
        <p>The dNI generated a movement of the simulated point mass (<xref ref-type="fig" rid="pcbi-1002578-g003">Figure 3D</xref>) by the following procedure:</p>
        <fig id="pcbi-1002578-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002578.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>An example of motor and sensory interfaces and on-line closed-loop trajectories generated by evoked activity of a population of neurons.</title>
            <p>(A) The output of the motor interface during the test phase is represented as the force vectors (black arrows) generated during 100 “test set” repetitions of each stimulation pattern. The spread of the distribution of the single trial vectors represents neural variability at fixed stimulus. The small discrepancies between the angles of the template vectors computed during calibration (blue arrows) and the trial-averaged vector observed for each stimulus during the test phase (red arrows) originates from differences between training and test dataset due to neural variability and limited sampling. (B) A graphical representation of 4 sensory regions generated by the sensory interface. Each position of the point-mass is mapped onto a stimulation pattern and is color coded. (C) Spike rasters and Post Stimulus Time Histograms (PSTH) of a single neuron evoked by 4 different stimulation patterns, using the same color code as in panel B to distinguish responses to different stimuli. (D) Trajectories of the point-mass (dotted black line) generated on-line starting from 4 different initial points (yellow circles). For each trajectory, the force vector applied step by step by the motor interface to the simulated point-mass is indicated with a color code representing the stimulation pattern chosen by the sensory interface. In this example the forces were applied with an interval of 1 s and the point mass reached the target respectively in 6, 16, 25 and 29 s.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.g003" xlink:type="simple"/>
        </fig>
        <list list-type="order">
          <list-item>
            <p>The experimenter places the point mass at a starting initial state (position and velocity).</p>
          </list-item>
          <list-item>
            <p>The sensory interface determines the stimulus to be delivered at that position, based on the nearest calibration site (see Equation 12). The stimulus is delivered.</p>
          </list-item>
          <list-item>
            <p>The motor interface decodes the ensuing neural activity and derives the force vector to be applied to the point mass (see Equation 11).</p>
          </list-item>
          <list-item>
            <p>The next position is computed by integrating the equation of motion of the point mass in a viscous medium (see Equation 15) for a short time (typically 1s).</p>
          </list-item>
          <list-item>
            <p>The process is repeated from step 2 until the point mass reaches the region of equilibrium.</p>
          </list-item>
        </list>
        <p>Because of the cortico-cortical pathways between stimulated and recorded populations <xref ref-type="bibr" rid="pcbi.1002578-Chakrabarti1">[13]</xref>, the neural population responses were clearly modulated by the stimuli (<xref ref-type="fig" rid="pcbi-1002578-g003">Figure 3C</xref>). However, the actual behavior of the interface contained a stochastic component due to the fact that each stimulation pattern, when repeated over different trials, caused a variable response in the recorded motor cortex. Part of the response variability in our anaesthetized preparation likely arose from trial to trial fluctuations in ongoing internal activity unrelated to the stimuli <xref ref-type="bibr" rid="pcbi.1002578-Ferezou1">[14]</xref>. These trial to trial response variations resulted in a random time-varying component of the force field.</p>
      </sec>
      <sec id="s2h">
        <title>Evaluation and optimization of the dynamic neural interface using information theoretic metrics and trajectory based metrics</title>
        <p>The performance of the dNI likely depends upon information that the neurons make available for communication with the dynamical system, which in turn likely depends upon the temporal precision at which spike trains are considered <xref ref-type="bibr" rid="pcbi.1002578-deRuytervanSteveninck1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Panzeri1">[16]</xref>. In particular, previous studies of neural encoding suggest that more information may be extracted from neural responses if they are examined with a relatively fine precision of the order of few to few tens of ms <xref ref-type="bibr" rid="pcbi.1002578-Panzeri2">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Victor1">[18]</xref> and that the optimal precision to extract information from neural activity may vary depending on the specific task or condition <xref ref-type="bibr" rid="pcbi.1002578-Butts1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Kayser1">[20]</xref>.</p>
        <p>In this study we therefore determined empirically the range of response parameters that maximized some measures of the quality by which the neurons can communicate with the rest of the system. The neural response r following the electrical stimulation was quantified as a time series of spike counts for each of the N neurons computed in T small time intervals of size Δt post-stimulation. The size of the bins Δt (corresponding to the temporal precision used to evaluate neural responses) and the parameters defining the time window duration (the number of time bins T and the offset of the post-stimulus window) are all arbitrary parameters that we attempted to set optimal according to some quantitative criterion. To study systematically how the performance of the dNI depends on the temporal parameters defining the neural response, we generated a set of “off-line” trajectories according to the following simulation procedure. At each step of the simulation, the position of the point mass was paired with the stimulation pattern associated with its nearest neighbor, as in the actual on-line experiment. Then, a recorded pattern was randomly drawn from an additional collection of neural responses to the 4 electrical stimulation patterns stored in the sensory interface.</p>
        <p>Using the off-line trajectories, we estimated the amount of information that the neural population makes available to communicate with the dynamical system. This information was evaluated as the Mutual Information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e033" xlink:type="simple"/></inline-formula> between the force vector expected to be generated by the electrical stimulation in a given trial (a template force vector corresponding to the mean force vector established during the calibration trials in response to the considered electrical stimulation, <xref ref-type="fig" rid="pcbi-1002578-g003">Figure 3A</xref> blue arrows) and the actual force vector obtained from the neural response in that trial.</p>
        <p>We found that the really critical response parameter was the temporal precision Δt at which spikes are sampled (<xref ref-type="fig" rid="pcbi-1002578-g004">Figures 4C and 4D</xref>). A fine temporal precision Δt≈5–10 ms was needed to obtain high Information values. Using coarser temporal precisions of 50 or 100 ms led to dramatic decreases of the Information values (<xref ref-type="fig" rid="pcbi-1002578-g005">Figure 5A</xref>). <xref ref-type="fig" rid="pcbi-1002578-g005">Figure 5B</xref> reports the results of how the Information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e034" xlink:type="simple"/></inline-formula>, averaged over all sessions and calculated using a sampling precision Δt = 5 ms, depended upon the windows duration T·Δt and upon the offset value defining the response window. Information was very stable in the range T·Δt≈25–600 ms. The fact that the interface performs well also for decoding windows as short as few tens of ms encourages us to believe that it will be possible to push the dNI technology towards implementing feedback which is rapid enough to control real life motor tasks.</p>
        <fig id="pcbi-1002578-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002578.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Off-line analysis of dependence of the dNI performances on the temporal parameters defining the neural response.</title>
            <p>(A) A closed-loop trajectory recorded on-line (green line) compared to 100 trajectories generated off-line (blue dotted line indicates the mean trajectory and shaded areas represent the p = 0.05 confidence region of trajectory). (B) We compared 70 converging on-line trajectories selected from 13 rats with 70 corresponding off-line trajectories using different parameters such as the root mean square error (RMSE) from the ideal trajectory, the mean integrated distance to target (MIDT) and the number of steps to convergence. Setting the time interval of 1 s between two consecutive steps, these values (mean±SEM: online = 18.2±1.6 and offline = 19.9±1.8) indicate also how long it took for this particular point mass to reach the target. Off-line and on-line behaviors were not significantly different (p&gt;0.1; paired t-test), indicating that off-line simulated trajectories are representative of on-line behavior. (C) Mean convergence rate (CR) subtracted by the mean convergence rate obtained from a random choice of the stimulation patterns, calculated using different sizes for Δt. (D) Mean CR of the dNI calculated using Δt = 5 ms. The CR of the off-line trajectories is used to evaluate the performances of the interface, which is found to be maximal for small temporal resolutions (Δt≈5–10 ms). In particular, by using a bin size of 5 ms the mean CR is 6 times higher than the CR randomly built. The Mutual Information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e035" xlink:type="simple"/></inline-formula> between the expected force vector and the actual force vector is highly correlated both to the CR (E) and to the inverse of the mean number of steps to convergence (F) calculated for all the simulated off-line trajectories.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.g004" xlink:type="simple"/>
        </fig>
        <fig id="pcbi-1002578-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002578.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Role of recording parameters on Mutual Information measures of the performance of the dNI and dependence of performances on number of recorded single units.</title>
            <p>(A) Dependence of the Mutual Information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e036" xlink:type="simple"/></inline-formula> between the expected force vector and the actual force vector upon the temporal bin size Δt. Results were calculated using data computed in the response window with zero offset and 600 ms duration and are reported as average±SEM over all experimental sessions. Information was maximal for small bin sizes, such as Δt = 5–10 ms, meaning that the best performance of the dNI is obtained when recording neural activity with fine temporal precision. (B) Dependence of the Mutual Information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e037" xlink:type="simple"/></inline-formula>, calculated with temporal resolution of Δt = 5 ms, upon duration (T·Δt) and offset defining the response window. Results are reported as average over all experimental sessions. (C) Convergence rate vs. population size. We compared the convergence rates when using all the neurons of each datasets with those using only half or one quarter of the units (subtracted by the mean convergence rate of trajectories randomly generated). Data are represented as box plots: red lines are the medians, lower and higher borders of the boxes indicate respectively the 25th and 75th percentiles, while the whiskers indicate the minimum and maximum value of each group. ANOVA test revealed that only the quarter case is statistically different from the other two (p = 3.3552e-006).</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.g005" xlink:type="simple"/>
        </fig>
        <p>Moreover, there was a highly significant correlation (p&lt;10e-9) between the Information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e038" xlink:type="simple"/></inline-formula> and both the convergence rate (the percentage of trajectories that converge into the target) and the inverse of the mean number of steps to convergence of the off-line dNI trajectories (<xref ref-type="fig" rid="pcbi-1002578-g004">Figure 4E–F</xref>). As a result, the performance of the dNI was maximal for fine temporal precisions: the convergence rate peaked for Δt≈5–10 ms (<xref ref-type="fig" rid="pcbi-1002578-g004">Figure 4C</xref>). At Δt = 5 ms, the convergence rate of the dNI was on average 6 times higher than the convergence rate obtained with a purely random choice of the electrical stimulus to be applied (<xref ref-type="fig" rid="pcbi-1002578-g004">Figure 4D</xref>), demonstrating that the neural information had a sizeable impact on the dNI dynamics. These results suggest that precise spike timing is not only crucial for communication within the nervous system <xref ref-type="bibr" rid="pcbi.1002578-Panzeri1">[16]</xref>, but it is also important for bidirectional communication between external effectors and the nervous systems.</p>
        <p>The impact of the Mutual Information provided by the neurons participating in the dNI upon the performance of the dNI was further investigated by studying the relationship between<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e039" xlink:type="simple"/></inline-formula> and the convergence speed of the dNI on the off-line simulated trajectories. For each set of possible response parameter and experimental session, we computed the mean number of steps needed for the trajectory to converge and the probability of reaching convergence to the center of the force field (averaged over 100 off-line-generated trajectories) with these response parameters and we correlated it with the Information computed in the same conditions. In sum, the empirical finding was that higher Information values corresponded to faster and more reliable convergence of the dynamical behavior and all measures pointed to the same range of neural response parameters being optimally efficient for dNI operation.</p>
        <p>We also evaluated how the performance of the interface depended upon the population size by comparing the convergence rates when using all the neurons of each datasets with those using only half or one quarter of the units. The average number of recorded neurons during each experimental session was 13.69±0.48 (mean±SEM over all sessions). For each dataset, we randomly selected (out of <italic>nA</italic> recorded units) <italic>nH</italic> and <italic>nQ</italic> units for the calculation of the performance with half and one quarter units, with <italic>nH</italic> and <italic>nQ</italic> being the approximation to the closest integer of <italic>nA/2</italic> and <italic>nA/4</italic>, respectively. For each selection of the subpopulation, we subtracted the obtained convergence rate by that obtained from a random choice of the stimulation patterns (as we did when analyzing the performance of the entire population). <xref ref-type="fig" rid="pcbi-1002578-g005">Figure 5C</xref> shows that a decrease in performance is observed only when reducing the population size to one quarter of the recorded one. Convergence rates with one quarter neurons are statistically different from the rates in the other two cases (p = 3.3552e-006, ANOVA), while the performances with all and half neurons were not statistically different (p&gt;0.1, ANOVA). This suggests that using multi electrode recording arrays is useful for the performance of the system.</p>
        <p>Finally we used different performance metrics to compare on-line trajectories with off-line simulated trajectories to evaluate if the off-line dataset could be used to simulate and study in more detail on-line behavior. To perform this comparison we selected 70 converging on-line trajectories selected from 13 rats and 70 corresponding off-line trajectories. In particular we calculated the root mean square error (RMSE), the mean integrated distance to target (MIDT) and the number of steps to convergence. For the calculation of RMSE, we first computed for each trial i the ideal trajectory <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e040" xlink:type="simple"/></inline-formula> as the one sharing the initial point with the actual trajectory, but evolving with a force <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e041" xlink:type="simple"/></inline-formula>. Then, for each trial i we computed the root mean square error as <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e042" xlink:type="simple"/></inline-formula> with T being the maximum duration of the trial and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e043" xlink:type="simple"/></inline-formula> the actual position of the point-mass at time t. We computed MIDT as the average distance from the target. For each trial i, being <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e044" xlink:type="simple"/></inline-formula> the position of the point mass at time t and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e045" xlink:type="simple"/></inline-formula> the position of the target we define: <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e046" xlink:type="simple"/></inline-formula>. Because the target corresponds to the origin of the plane, MIDT is simply the length of the trajectory normalized by its converging time.</p>
        <p>As reported in <xref ref-type="fig" rid="pcbi-1002578-g004">Figure 4B</xref>, we found no significant differences in the computation of RMSE, MIDT or number of steps to convergence between on-line and off-line data (t-test, with p = 0.17 for RMSE, p = 0.41 for MIDT, p = 0.5 for number of steps). The consistency between the off-line open-loop simulated trajectories and the actual closed-loop trajectories recorded on-line during the experiment suggests that the parameters set optimally by generating offline simulated trajectories from calibration data will be optimal also for running the same interface online. In this respect Mutual Information is an advantageous optimization metrics during calibration, because the corresponding evaluation of the inverse number of steps requires running a larger number of simulated trajectories and would thus be computationally slower.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>With few notable exceptions <xref ref-type="bibr" rid="pcbi.1002578-ODoherty1">[21]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-Zelenin1">[25]</xref>, the development of neural interfaces has proceeded along two separate tracks. There are sensory interfaces, such as the cochlear implants <xref ref-type="bibr" rid="pcbi.1002578-Loeb1">[26]</xref> that transform external physical events into neural stimuli for the brain and there are motor interfaces that decode activities from cortical regions to generate commands for external devices <xref ref-type="bibr" rid="pcbi.1002578-Velliste1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Donoghue2">[27]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-Wessberg1">[29]</xref>. However, the efficiency of biological motor behavior rests upon the seamless integration of sensory information and motor commands. This integration occurs both in our deliberate and conscious responses to external stimuli and in hardwired reflex responses organized by the neural circuitry of the spinal cord. In fact, the voluntary motor commands originating from the highest brain centers operate upon the world by modulating the activities and the response properties of the spinal networks. Here, we have taken a first step towards the design of a brain-machine interface that emulates the same basic principle: the interface has a sensory and a motor component whose direct interaction generates a system of automatic responses, which are to be modulated by volitional activities. In this sense, our proposed architecture draws inspiration from the natural “neural interface” that all vertebrates are endowed with: the spinal cord.</p>
      <p>Unlike its biological counterpart however, the proposed interface is not connected to a musculoskeletal system, but can act over a broader family of dynamical systems. In this example, we chose a simulated point-mass moving within a viscous fluid. The interface generates position-dependent forces converging to a stable equilibrium point. This simple framework highlights an important issue in the design of brain-machine interface: the boundary between neural and artificial control. The parameters of the external system – in this case the viscous and inertial matrices – may result from a combination of passive physical elements and feedback control components. There is therefore an important role of the engineering design in establishing the dynamical properties of the external device, as it is seen by the neural system through the interface.</p>
      <sec id="s3a">
        <title>Force fields in motor behavior</title>
        <p>The concept that force fields afford a representation of the motor output in the spinal cord was first expressed in the aforementioned stimulation studies <xref ref-type="bibr" rid="pcbi.1002578-Bizzi1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-Lemay1">[8]</xref>. However, the mechanistic concept behind this representation can equally well characterize a variety of other observations, including some of the most classical ones. The stretch reflex first described by Sherrington <xref ref-type="bibr" rid="pcbi.1002578-Sherrington1">[30]</xref> is one the clearest examples. Another example is spinal pattern generators that produce a different type of field, a field inducing a cyclical motion of the limbs. Grillner and coworkers <xref ref-type="bibr" rid="pcbi.1002578-Grillner1">[9]</xref> offered a compelling model of locomotion pattern in the lamprey, and in both cases the rhythmic activity is sustained by a phase-shift between the state of motion and the consequent forces. While the experimental tests in the current paper have been focused on the enforcement of equilibrium-seeking behavior, different behaviors are programmable through the approximation of different force-fields.</p>
        <p>The description of the bidirectional neural interface as a force-field has a conceptual rationale in the causality of mechanical interactions between a control system and its environment <xref ref-type="bibr" rid="pcbi.1002578-Hogan1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Karnopp1">[32]</xref>. At the interface with the environment, a control system may act either as a generalized admittance, determining a state of motion in response to an applied force, or as a generalized impedance, determining a force in response to an applied state. Considerations about neuromuscular mechanics suggest the second case as more appropriate, because the mapping from state (position and velocity) to force is typically well defined but not invertible. In this sense too, the architecture of the interface reflects the organization of the biological motor system. However the extent of the similarity may vary depending on the structure that is being controlled. The dynamical parameters – for example the mass and viscosity – may be characteristics of the physical system that is been controlled by the interface. But they also may be – at least partially – introduced in the interface algorithms to shape a desired behavior. For example a virtual mass and a virtual viscosity can be added in parallel to the physical system to increase stability and modify the resulting trajectories.</p>
        <p>Intelligent and purposeful motor behavior involves the ability to react to unexpected perturbations and to change planning goals. In this respect, the study presented in this report represents a preliminary step towards the development of an interface that facilitates exploration and adaptation providing its users with the possibility to modulate a field of forces. Even if the concept of controlling a limb by shifting its equilibrium position is not new <xref ref-type="bibr" rid="pcbi.1002578-Arimoto1">[33]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-Gribble1">[35]</xref>, in the context of BMIs this is a radically new platform compared to current approaches based on decoding – instant by instant – the desired state of motion of the connected device, such as, for example, a robotic arm. Consider a reaching movement with a prosthetic hand. As the hand moves towards the target an obstacle is encountered that triggers a correction. The standard decoding method requires recreating an entire path that circumvents the obstacle and reaches the final target. In contrast, a field-based approach, reprogramming the path may be limited to shifting the hand position to a point that is clear of the obstacle and then let the field guide the hand towards the target without further reprogramming.</p>
      </sec>
      <sec id="s3b">
        <title>Somatosensory perception</title>
        <p>While early BMI studies were mostly focused on decoding motor cortical activities <xref ref-type="bibr" rid="pcbi.1002578-Wessberg1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Chapin1">[36]</xref>, more recently there has been a growing interest for evoking somatosensory perception by electrical stimulation. For example Weber and co-workers are pursuing the stimulation of dorsal root ganglia, recreating patterns of evoked responses in somatosensory-area <xref ref-type="bibr" rid="pcbi.1002578-Weber1">[37]</xref>. Recently, Venkatraman and Carmena <xref ref-type="bibr" rid="pcbi.1002578-Venkatraman1">[38]</xref> were able to stimulate neurons in the rat barrel cortex and to produce the sensation of an object being swiped by the whiskers. More recently yet, Nicolelis and coworkers were able to integrate in BMI motor cortical decoding with artificial tactile sensing elicited by microstimulation of S1 <xref ref-type="bibr" rid="pcbi.1002578-ODoherty1">[21]</xref>. These results are consistent with earlier observations by Romo and coworkers who demonstrated the possibility to induce tactile sensation analogous to finger touch in monkeys <xref ref-type="bibr" rid="pcbi.1002578-Romo1">[39]</xref>. Based on the available evidences, we expect the electrical stimuli generated by our interface to be adequate to induce somatosensory perception in the alert animal. Since we are stimulating in the barrel cortex, we predict – after Venkatraman and Carmena <xref ref-type="bibr" rid="pcbi.1002578-Venkatraman1">[38]</xref> – that the stimuli would induce perceptions analogous to whisking an object. However, in a brain-machine interface the ultimate goal would be to produce sensations corresponding to the state of an artificial device, such as a food feeder, whose structure may or may not resemble that of a biological limb. Understanding how the somatosensory system may adapt the perceptual correlate of electrical stimuli is a future research goal, beyond the scope and reach of the present study. Here, we focused on the production of automatic responses in the form of preprogrammed force fields, in the perspective that these responses may be both accessible and modifiable by volitional commands. Studies of current interfaces provide ample evidence demonstrating the ability of the mammalian brain to modulate the activities of populations of cortical neurons in different brain areas <xref ref-type="bibr" rid="pcbi.1002578-Donoghue2">[27]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-Wessberg1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Carmena1">[40]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Fetz2">[41]</xref>. To the extent that this circuitry can be accessed and purposefully modulated by voluntary neural commands, the dNI will offer its user with the possibility to achieve motor goals in a stable manner and without the need for constant on-line supervision. At this time, however, the possibility that the force field produced by the interface may be accessible to volitional control remains to be demonstrated by additional experiments with alert animals. In particular, it will be critical establishing what field parameters may be modified by volitional inputs converging upon the neural structures that determine the output of the interface. We need to stress that the particular case of a convergent field is not the only that can be implemented and that has functional relevance. For example, a force field can be programmed to have rotational structure so as to induce cyclical motions of the controlled objects. Parallel pattern of forces, on the other hand, may approximate the control of a contact force. The simple case of the viscoelastic force field in our task provides the mathematical basis for generating stable trajectories – i.e. trajectories that converge to a nominal path in exponential time if displaced by an unexpected perturbation. In addition to expanding the behavioral repertoire of NIs, the bidirectional interface establishes a new venue for investigating the mechanisms of neural plasticity through a controlled exchange between cortical structures and a virtually unlimited repertoire of dynamical systems implemented either in hardware or by computer simulation.</p>
      </sec>
    </sec>
    <sec id="s4" sec-type="methods">
      <title>Methods</title>
      <sec id="s4a">
        <title>Ethics statement</title>
        <p>This study was carried out in strict accordance with the Italian law regarding the care and use of experimental animals (DL116/92) and approved by the institutional review board of the University of Ferrara and by the Italian Ministry of Health (73/2008-B). For all experimental procedures, rats were anaesthetized with a mixture of Zoletil (30 mg/kg) and Xylazine (5 mg/kg) delivered intraperitoneally and all efforts were made to minimize suffering.</p>
      </sec>
      <sec id="s4b">
        <title>Neurophysiological procedures and experimental set-up</title>
        <p>The experiments were carried out on 13 male Long-Evans rats, weighting 350–400 g and for the entire duration of the experiment, anesthesia was maintained with supplementary doses of anesthetic (intra-peritoneal or intra-muscular) such that a long-latency, sluggish hind limb withdrawal was sometimes achieved only with severe pinching of the hind foot. The anesthetized animal was placed in a stereotaxic apparatus (Myneurolab). A craniotomy was made, using a micro drill, over the primary somatosensory cortex (S1) and primary motor cortex (M1) whisker representations of the same hemisphere. To place the stimulation array, a small craniotomy (2×2 mm) was made in the parietal bone to expose the barrel cortex, which was identified according to vascular landmarks and stereotaxic coordinates <xref ref-type="bibr" rid="pcbi.1002578-Chapin2">[42]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-Paxinos1">[44]</xref>. The dura mater was not removed because the electrodes were sufficiently rigid to pass through it. The placement of the electrodes was tested and confirmed by recording the neuronal responses to manual whisker stimulation. The arrays were lowered perpendicular through the cortical surface using a hydraulic microdrive (2650, Kopf) at depth between 500 and 900 µm from the pia (granular layer) <xref ref-type="bibr" rid="pcbi.1002578-Brumberg1">[45]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-Woolsey1">[47]</xref>.</p>
        <p>To insert the recording array, the frontal cortex was uncovered at 0.5 mm rostral and 0.5 mm lateral to bregma, and the vibrissal representation was exposed, at coordinates consistent with previous maps of the M1 whisker representations <xref ref-type="bibr" rid="pcbi.1002578-Donoghue1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Hall1">[43]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-Franchi1">[48]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-Neafsey1">[50]</xref>. In preliminary experiments, we conducted intracortical microstimulation (monophasic cathodal pulses, 30 ms train duration at 300 Hz, 200 µs pulse duration with a minimum interval of 2.5 s) to evoke whisker twitches, at high threshold intensities, between 1.5–1.8 mm below the cortical surface. This depth was found to correspond to the layer V of granular cortex. The microwire array was lowered perpendicularly into the cortex to layer V at sites ranging from 1.0 to 2.5 mm lateral and 1.0 to 3.0 mm rostral to bregma. Also in this case the dura was not removed and was kept moist with a 0.9% saline solution. The effectiveness of the placement of stimulation and recording arrays was verified by computing peri-stimulus time histograms of neural responses to the different stimulation patterns (see <xref ref-type="fig" rid="pcbi-1002578-g006">Figure 6A–D</xref> for an example).</p>
        <fig id="pcbi-1002578-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002578.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Recorded neural activities in M1 evoked by electrical stimulation in S1.</title>
            <p>At the beginning of each experimental session a series of electrical stimulation patterns is delivered and a sorting procedure is performed on the raw neural signal to identify both the stimulation artifacts and the single unit activities. Panels (A) and (B) show a portion of a raw signal close to a stimulation event. The sorting procedure is able of identifying the stimulus artifacts (red lines) and the spike occurrences (green lines). Panel (C) shows the unit templates used by the sorting algorithm (left) and a representation of the sorted data onto the first two principal components plane (right). (D) Post Stimulus Time Histograms (PSTH) of neural evoked responses of a subset of three neurons selected from three experiments. The color code represents different stimulation patterns. (E) Scatter plot of variance vs. mean of spike counts (computed in sliding 20 ms long post-stimulus windows) of all pooled data points across units and sessions. This measure is a relatively standard measure of cortical response variability. The best-fit power law curve (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e047" xlink:type="simple"/></inline-formula> with α = 0.7 and β = 0.93) is plotted with the best fit parameters. These data are at the most reliable end of the range of response variability reported in the cortical literature. (F) CO stained section (AP = −3.3 mm from bregma) of the rat brain with microelectrode track. The black dotted line indicates the boundary of the barrel. The perpendicular length from the tip of the electrodes (the center of the hole) to the cortical surface measured 730 µm.</p>
          </caption>
          <graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.g006" xlink:type="simple"/>
        </fig>
        <p>For both recording and stimulation procedure we used 16 polyimide-insulated tungsten electrodes microwire arrays (50 µm wire diameter, Tucker-Davis Technologies), configured in two rows of 8 electrodes each (250 µm electrode spacing and 375 µm rows separation) and placed over the primary somatosensory cortex (S1) and primary motor cortex (M1) whisker representations of the same hemisphere. Placement of electrodes was later confirmed by histological section.</p>
        <p>The intracortical microstimulation (ICMS) consisted of trains of 10 biphasic pulses, each phase lasting 100 µs, delivered at 333 Hz with amplitude of 150 µA. Each stimulation train was delivered throughout two adjacent electrodes of the stimulation array using a programmable 8 channel stimulus generator (Stg4008, Multichannel Systems) built with a stimulus isolation unit for each output channel. Software-generated TTL triggers were used both to start the stimulation pattern and to store the stimulus timing in the recorded neural signals.</p>
        <p>The recording microwire array was lowered perpendicularly into the cortex using a hydraulic microdrive (2650, Kopf) and extracellular neuronal discharges were recorded using a multichannel recording system (Map system, Plexon Inc.) with a sampling frequency of 40 KHz per channel.</p>
        <p>During the experimental sessions an on-line PCA-based sorting procedure (illustrated in <xref ref-type="fig" rid="pcbi-1002578-g006">Figure 6C</xref>) was performed using commercially available software (Rasputin, Plexon Inc.). Time stamps of identified units were sent in real-time via local LAN to custom-made software developed in Matlab (Mathworks®) to translate the input neural signal into output stimulation triggers according to the behavior of the simulated controlled system.</p>
        <p>We ensured that the neural responses used to guide the interface did not contain a component which reflected an electrical stimulation artifact rather than true neural response by the following steps: (i) we used only responses collected after the stimulation artifact had ended (i.e. the onset of neural response activity in each calibration trial and test trial started after the stimulation artifact ended) (ii) the templates of the on-line spike sorting procedure were established without including data collected during electrical stimulation (iii) we further verified by visual inspection that spikes identified near the onset had the same amplitude and shape of that identified far from the electrical stimulation (<xref ref-type="fig" rid="pcbi-1002578-g006">Figure 6A–C</xref>).</p>
      </sec>
      <sec id="s4c">
        <title>Histology</title>
        <p>At the end of electrophysiological session, DC of 5 µA for 10 s was passed through electrodes placed both at the beginning and at the end of the array, to mark its position. The current produced a lesion that was easily seen in cytochrome oxidase-stained histological sections. When the acute experimental phase was completed, the animals were deeply anesthetized with Isoflurane and transcardially perfused with 500 ml of 0.1 M-phosphate buffered saline (PBS) with 0.9% NaCl at 37°C followed by a 1l cold buffered solution of 2.0% paraformaldehyde, 1.25% glutaraldehyde and 2.0% sucrose (pH 7.4). The brains were removed from their skulls, coronally transected at the level of bregma and then postfixed overnight at 4°C. The caudal portion, including S1, was saturated in 20% sucrose, then 30% sucrose until it sank. Coronal sections of frozen brain (60 µm thick) were cut on a sliding microtome (SM2000R, Leica) to determine the depth of microelectrodes tip. The sections were processed for cytochrome oxidase (CO) according to previous reports <xref ref-type="bibr" rid="pcbi.1002578-Land1">[51]</xref>, <xref ref-type="bibr" rid="pcbi.1002578-WongRiley1">[52]</xref> to identify layer IV. Sections were washed three times in a 0.1 M PB solution and then incubated at 37°C in a cytochrome-C oxidase staining solution containing 4% sucrose, 0.05% DAB, and 0.05% cytochrome C (Sigma Laboratories), until barrels were clearly delineated. Then sections were washed in PBS and mounted on slides. Mounted sections were dehydrated in a series of alcohols, defatted in xylene and coverslipped.</p>
        <p>CO stained sections were observed under brightfield illumination with Olympus BX51 microscope (Olympus) interfaced with a color video camera (CX-9000) and with a NeuroLucida system (MicroBrightField) (<xref ref-type="fig" rid="pcbi-1002578-g006">Figure 6F</xref>). Using a 10× objective, live color images of the histological material were displayed on a high-resolution video monitor. The boundaries of the barrels were drawn using the image on the screen and the depth of the electrolytic lesions was measured by the Neurolucida software.</p>
      </sec>
      <sec id="s4d">
        <title>Simulations of the dynamic system interacting with neural activity</title>
        <p>In this implementation, the device interacting bidirectionally with neural activity is a simulated point mass in a viscous medium. Typical values for the mass (M) and viscosity (B) were 10 Kg and 15 N•s/m. A linear force field <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e048" xlink:type="simple"/></inline-formula> results in the linear differential equation<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e049" xlink:type="simple"/><label>(14)</label></disp-formula>with an isotropic stiffness (K) of 4 N/m, the ideal system driven by the noiseless linear field was slightly over-damped (damping ratio <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e050" xlink:type="simple"/></inline-formula>). While the choice of these parameters is arbitrary, in a practical implementation, the parameters of the viscoelastic field (here, <italic>K</italic> and <italic>B</italic>) should be selected based on the desired time constant of the payload's motion. As the interface implements a piecewise constant approximation of the linear field, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e051" xlink:type="simple"/></inline-formula>, corrupted by random background activity, the stability properties afforded by the desired continuous field can only be considered as an optimal limit. This first realization of the interface has some notable limitations. One is that the control law generates an output force in response to a position input. In a more complete system, the input should convey not only position, but state information, that is position and velocity. Here, the derivative component of the controller is a fixed property, expressed by the term <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e052" xlink:type="simple"/></inline-formula> in the dynamics equation. Another obvious simplification is in the choice of a point mass (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e053" xlink:type="simple"/></inline-formula>) for controlled object. A mechanical arm is generally characterized by a non-linear differential equation. However, the second order linear ordinary differential equation (Equation 14) is used in robotics to represent the error dynamics of non-linear systems controlled by proportional-derivative (PD) methods <xref ref-type="bibr" rid="pcbi.1002578-Spong1">[53]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e054" xlink:type="simple"/><label>(15)</label></disp-formula>with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e055" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e056" xlink:type="simple"/></inline-formula> is a desired trajectory). In our framework, this PD control law can be reformulated as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e057" xlink:type="simple"/><label>(16)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e058" xlink:type="simple"/></inline-formula> is a time varying function to be supplied by the voluntary input to the interface. In this case, the dNI would provide stability to a desired movement in a way analogous to the combined influence on limb movements of muscle mechanics and feedback mechanisms of the spinal cord. Therefore, while the form of Equation 14 is quite simple, it also expresses a fundamental mathematical representation for control.</p>
        <p>By tuning the sensory and motor interfaces to approximate a predetermined force field, the dNI establishes an automatic behavior. The neural connections between the stimulated and the recorded populations determine the force to be generated at each position in the field. However, the recorded activities are also affected by inputs from other brain areas. In the alert brain, these additional inputs provide a pathway for the volitional commands to modulate the dynamics of the interface. To see this, suppose that the output of the interface is the programmed force field, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e059" xlink:type="simple"/></inline-formula> (where <italic>ρ</italic> indicates the radial distance from the origin of the plane upon which the point mass moves) plus a force component, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e060" xlink:type="simple"/></inline-formula> generated by a volitional command. The net force is then<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e061" xlink:type="simple"/><label>(17)</label></disp-formula>This can be re-written as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e062" xlink:type="simple"/><label>(18)</label></disp-formula>where<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e063" xlink:type="simple"/><label>(19)</label></disp-formula>is a time-varying equilibrium point. Thus, the dNI architecture provides a way to integrate voluntary commands with preprogrammed automatic responses so as to generate dynamically stable movements. A computer simulation study of the relationship between Information in neural activity, the mechanical parameters of the dynamical system and the performance of the neural interface is reported in <xref ref-type="bibr" rid="pcbi.1002578-Szymanski1">[54]</xref>.</p>
      </sec>
      <sec id="s4e">
        <title>Calculation of Mutual Information between expected and actual force vectors</title>
        <p>As explained in <xref ref-type="sec" rid="s2">Results</xref>, we considered the Mutual Information that the recorded neurons provide to guide the dynamic system. The latter was evaluated as the Mutual Information <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e064" xlink:type="simple"/></inline-formula> between the force vector expected to be generated by the electrical stimulation in a given trial (corresponding to the template force vector established during the calibration trials in response to the considered electrical stimulation) and the actual force vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e065" xlink:type="simple"/></inline-formula> obtained from the neural response using the algorithm described in the above Section:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e066" xlink:type="simple"/><label>(20)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e067" xlink:type="simple"/></inline-formula> is the probability of presenting an electrical stimulation that leads to an expected force <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e068" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e069" xlink:type="simple"/></inline-formula> is the probability of obtaining in a given trial a force vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e070" xlink:type="simple"/></inline-formula> when presenting an electrical stimulation that leads to an expected force <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e071" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e072" xlink:type="simple"/></inline-formula> is the probability of obtaining in a given trial a force vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e073" xlink:type="simple"/></inline-formula> unconditional to the type of electrical stimulation applied. High (respectively low) values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e074" xlink:type="simple"/></inline-formula> indicate instead a near-deterministic (respectively near-random) relationship between the force provided by the neurons and the one needed for guiding the dynamic system.</p>
        <p><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e075" xlink:type="simple"/></inline-formula> was computed from the data as follows. Since there is a one-to-one correspondence between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e076" xlink:type="simple"/></inline-formula> and the type of electrical stimulation pattern, and since Mutual Information is invariant to monotonic transformations or relabeling of the variables, the patterns <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e077" xlink:type="simple"/></inline-formula> were labeled with the same index s (s = 1, …S) that indexes the electrical stimulation patterns. Then, the conditional probabilities of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e078" xlink:type="simple"/></inline-formula> to each stimulation pattern s were computed as frequency-of-occurrence histograms from the trials to stimulus s. The values of the components <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e079" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e080" xlink:type="simple"/></inline-formula> of the force <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e081" xlink:type="simple"/></inline-formula> were discretized into five equipopulated bins in order to facilitate the sampling of the empirical probability histograms. Then, the probability histograms were plugged into the above equation for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e082" xlink:type="simple"/></inline-formula> and its value was computed numerically. It is well known that, because the empirical probabilities are estimated from a limited number of trials, these empirically obtained Information measures still suffer from an upward systematic error (bias) due to limited sampling <xref ref-type="bibr" rid="pcbi.1002578-Panzeri3">[55]</xref>. We corrected for this bias as follows. First, we used a simple analytical procedure <xref ref-type="bibr" rid="pcbi.1002578-Panzeri4">[56]</xref> to estimate and subtract out the bias of each Information quantity. We then applied the “shuffling procedure” described in <xref ref-type="bibr" rid="pcbi.1002578-Panzeri3">[55]</xref>–<xref ref-type="bibr" rid="pcbi.1002578-Montemurro1">[57]</xref>, which greatly reduces the bias of multidimensional Information estimates. We then checked for residual bias by a “bootstrap procedure”: stimuli and responses were paired at random, and the Information for these random pairings was computed. Because in this random case the Information should be zero, the resulting value is an indication of a residual error. In this study we found (data not shown) that the bootstrap estimate of this residual error was very small and much smaller than the Information values obtained for optimal neural response parameters, indicating that our estimates of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002578.e083" xlink:type="simple"/></inline-formula> were reliable.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002578.s001" mimetype="video/x-ms-wmv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002578.s001" xlink:type="simple">
        <label>Video S1</label>
        <caption>
          <p>The video clip describes the calibration procedure and the operation of the dynamic neural interface.</p>
          <p>(WMV)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We are deeply grateful to Emilio Bizzi, Konrad Kording, Pietro Morasso and Giulio Sandini for reading earlier versions of the manuscript and offering insightful comments and criticism.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002578-Velliste1">
        <label>1</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Velliste</surname><given-names>M</given-names></name><name name-style="western"><surname>Perel</surname><given-names>S</given-names></name><name name-style="western"><surname>Spalding</surname><given-names>MC</given-names></name><name name-style="western"><surname>Whitford</surname><given-names>AS</given-names></name><name name-style="western"><surname>Schwartz</surname><given-names>AB</given-names></name></person-group>             <year>2008</year>             <article-title>Cortical control of a prosthetic arm for self-feeding.</article-title>             <source>Nature</source>             <volume>453</volume>             <fpage>1098</fpage>             <lpage>1101</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Cheney1">
        <label>2</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Cheney</surname><given-names>PD</given-names></name><name name-style="western"><surname>Fetz</surname><given-names>EE</given-names></name></person-group>             <year>1980</year>             <article-title>Functional classes of primate corticomotoneuronal cells and their relation to active force.</article-title>             <source>J Neurophysiol</source>             <volume>44</volume>             <fpage>773</fpage>             <lpage>791</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Fetz1">
        <label>3</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fetz</surname><given-names>EE</given-names></name><name name-style="western"><surname>Perlmutter</surname><given-names>SI</given-names></name><name name-style="western"><surname>Prut</surname><given-names>Y</given-names></name></person-group>             <year>2000</year>             <article-title>Functions of mammalian spinal interneurons during movement.</article-title>             <source>Curr Opin Neurobiol</source>             <volume>10</volume>             <fpage>699</fpage>             <lpage>707</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Bizzi1">
        <label>4</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name><name name-style="western"><surname>Giszter</surname><given-names>S</given-names></name></person-group>             <year>1991</year>             <article-title>Computations underlying the execution of movement: a biological perspective.</article-title>             <source>Science</source>             <volume>253</volume>             <fpage>287</fpage>             <lpage>291</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Giszter1">
        <label>5</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Giszter</surname><given-names>SF</given-names></name><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name><name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name></person-group>             <year>1993</year>             <article-title>Convergent force fields organized in the frog's spinal cord.</article-title>             <source>J Neurosci</source>             <volume>13</volume>             <fpage>467</fpage>             <lpage>491</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-MussaIvaldi1">
        <label>6</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name><name name-style="western"><surname>Giszter</surname><given-names>SF</given-names></name><name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name></person-group>             <year>1994</year>             <article-title>Linear combinations of primitives in vertebrate motor control.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>91</volume>             <fpage>7534</fpage>             <lpage>7538</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Tresch1">
        <label>7</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Tresch</surname><given-names>MC</given-names></name><name name-style="western"><surname>Bizzi</surname><given-names>E</given-names></name></person-group>             <year>1999</year>             <article-title>Responses to spinal microstimulation in the chronically spinalized rat and their relationship to spinal systems activated by low threshold cutaneous stimulation.</article-title>             <source>Exp Brain Res</source>             <volume>129</volume>             <fpage>401</fpage>             <lpage>416</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Lemay1">
        <label>8</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Lemay</surname><given-names>MA</given-names></name><name name-style="western"><surname>Grill</surname><given-names>WM</given-names></name></person-group>             <year>2004</year>             <article-title>Modularity of motor output evoked by intraspinal microstimulation in cats.</article-title>             <source>J Neurophysiol</source>             <volume>91</volume>             <fpage>502</fpage>             <lpage>514</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Grillner1">
        <label>9</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Grillner</surname><given-names>S</given-names></name><name name-style="western"><surname>Matsushima</surname><given-names>T</given-names></name></person-group>             <year>1991</year>             <article-title>The neural network underlying locomotion in lamprey–synaptic and cellular mechanisms.</article-title>             <source>Neuron</source>             <volume>7</volume>             <fpage>1</fpage>             <lpage>15</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Sutton1">
        <label>10</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sutton</surname><given-names>R</given-names></name><name name-style="western"><surname>Barto</surname><given-names>A</given-names></name></person-group>             <year>1998</year>             <source>Reinforcement learning: An introduction</source>             <publisher-loc>Cambridge, MA</publisher-loc>             <publisher-name>MIT Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Butovas1">
        <label>11</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Butovas</surname><given-names>S</given-names></name><name name-style="western"><surname>Schwarz</surname><given-names>C</given-names></name></person-group>             <year>2003</year>             <article-title>Spatiotemporal effects of microstimulation in rat neocortex: a parametric study using multielectrode recordings.</article-title>             <source>J Neurophysiol</source>             <volume>90</volume>             <fpage>3024</fpage>             <lpage>3039</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Donoghue1">
        <label>12</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name><name name-style="western"><surname>Wise</surname><given-names>SP</given-names></name></person-group>             <year>1982</year>             <article-title>The motor cortex of the rat: cytoarchitecture and microstimulation mapping.</article-title>             <source>J Comp Neurol</source>             <volume>212</volume>             <fpage>76</fpage>             <lpage>88</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Chakrabarti1">
        <label>13</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chakrabarti</surname><given-names>S</given-names></name><name name-style="western"><surname>Zhang</surname><given-names>M</given-names></name><name name-style="western"><surname>Alloway</surname><given-names>KD</given-names></name></person-group>             <year>2008</year>             <article-title>MI neuronal responses to peripheral whisker stimulation: relationship to neuronal activity in si barrels and septa.</article-title>             <source>J Neurophysiol</source>             <volume>100</volume>             <fpage>50</fpage>             <lpage>63</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Ferezou1">
        <label>14</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Ferezou</surname><given-names>I</given-names></name><name name-style="western"><surname>Haiss</surname><given-names>F</given-names></name><name name-style="western"><surname>Gentet</surname><given-names>LJ</given-names></name><name name-style="western"><surname>Aronoff</surname><given-names>R</given-names></name><name name-style="western"><surname>Weber</surname><given-names>B</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Spatiotemporal dynamics of cortical sensorimotor integration in behaving mice.</article-title>             <source>Neuron</source>             <volume>56</volume>             <fpage>907</fpage>             <lpage>923</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-deRuytervanSteveninck1">
        <label>15</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>de Ruyter van Steveninck</surname><given-names>RR</given-names></name><name name-style="western"><surname>Lewen</surname><given-names>GD</given-names></name><name name-style="western"><surname>Strong</surname><given-names>SP</given-names></name><name name-style="western"><surname>Koberle</surname><given-names>R</given-names></name><name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name></person-group>             <year>1997</year>             <article-title>Reproducibility and variability in neural spike trains.</article-title>             <source>Science</source>             <volume>275</volume>             <fpage>1805</fpage>             <lpage>1808</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Panzeri1">
        <label>16</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name><name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name><name name-style="western"><surname>Logothetis</surname><given-names>NK</given-names></name><name name-style="western"><surname>Kayser</surname><given-names>C</given-names></name></person-group>             <year>2010</year>             <article-title>Sensory neural codes using multiplexed temporal scales.</article-title>             <source>Trends Neurosci</source>             <volume>33</volume>             <fpage>111</fpage>             <lpage>120</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Panzeri2">
        <label>17</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name><name name-style="western"><surname>Petersen</surname><given-names>RS</given-names></name><name name-style="western"><surname>Schultz</surname><given-names>SR</given-names></name><name name-style="western"><surname>Lebedev</surname><given-names>M</given-names></name><name name-style="western"><surname>Diamond</surname><given-names>ME</given-names></name></person-group>             <year>2001</year>             <article-title>The role of spike timing in the coding of stimulus location in rat somatosensory cortex.</article-title>             <source>Neuron</source>             <volume>29</volume>             <fpage>769</fpage>             <lpage>777</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Victor1">
        <label>18</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Victor</surname><given-names>JD</given-names></name></person-group>             <year>2000</year>             <article-title>How the brain uses time to represent and process visual information(1).</article-title>             <source>Brain Res</source>             <volume>886</volume>             <fpage>33</fpage>             <lpage>46</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Butts1">
        <label>19</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Butts</surname><given-names>DA</given-names></name><name name-style="western"><surname>Weng</surname><given-names>C</given-names></name><name name-style="western"><surname>Jin</surname><given-names>J</given-names></name><name name-style="western"><surname>Yeh</surname><given-names>CI</given-names></name><name name-style="western"><surname>Lesica</surname><given-names>NA</given-names></name><etal/></person-group>             <year>2007</year>             <article-title>Temporal precision in the neural code and the timescales of natural vision.</article-title>             <source>Nature</source>             <volume>449</volume>             <fpage>92</fpage>             <lpage>95</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Kayser1">
        <label>20</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Kayser</surname><given-names>C</given-names></name><name name-style="western"><surname>Logothetis</surname><given-names>NK</given-names></name><name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name></person-group>             <year>2010</year>             <article-title>Millisecond encoding precision of auditory cortex neurons.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>107</volume>             <fpage>16976</fpage>             <lpage>16981</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-ODoherty1">
        <label>21</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>O'Doherty</surname><given-names>JE</given-names></name><name name-style="western"><surname>Lebedev</surname><given-names>MA</given-names></name><name name-style="western"><surname>Ifft</surname><given-names>PJ</given-names></name><name name-style="western"><surname>Zhuang</surname><given-names>KZ</given-names></name><name name-style="western"><surname>Shokur</surname><given-names>S</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Active tactile exploration using a brain-machine-brain interface.</article-title>             <source>Nature</source>             <volume>479</volume>             <fpage>228</fpage>             <lpage>231</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Reger1">
        <label>22</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Reger</surname><given-names>BD</given-names></name><name name-style="western"><surname>Fleming</surname><given-names>KM</given-names></name><name name-style="western"><surname>Sanguineti</surname><given-names>V</given-names></name><name name-style="western"><surname>Alford</surname><given-names>S</given-names></name><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name></person-group>             <year>2000</year>             <article-title>Connecting brains to robots: an artificial body for studying the computational properties of neural tissues.</article-title>             <source>Artif Life</source>             <volume>6</volume>             <fpage>307</fpage>             <lpage>324</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Sorensen1">
        <label>23</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sorensen</surname><given-names>M</given-names></name><name name-style="western"><surname>DeWeerth</surname><given-names>S</given-names></name><name name-style="western"><surname>Cymbalyuk</surname><given-names>G</given-names></name><name name-style="western"><surname>Calabrese</surname><given-names>RL</given-names></name></person-group>             <year>2004</year>             <article-title>Using a hybrid neural system to reveal regulation of neuronal network activity by an intrinsic current.</article-title>             <source>J Neurosci</source>             <volume>24</volume>             <fpage>5427</fpage>             <lpage>5438</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Talwar1">
        <label>24</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Talwar</surname><given-names>SK</given-names></name><name name-style="western"><surname>Xu</surname><given-names>S</given-names></name><name name-style="western"><surname>Hawley</surname><given-names>ES</given-names></name><name name-style="western"><surname>Weiss</surname><given-names>SA</given-names></name><name name-style="western"><surname>Moxon</surname><given-names>KA</given-names></name><etal/></person-group>             <year>2002</year>             <article-title>Rat navigation guided by remote control.</article-title>             <source>Nature</source>             <volume>417</volume>             <fpage>37</fpage>             <lpage>38</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Zelenin1">
        <label>25</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Zelenin</surname><given-names>PV</given-names></name><name name-style="western"><surname>Deliagina</surname><given-names>TG</given-names></name><name name-style="western"><surname>Grillner</surname><given-names>S</given-names></name><name name-style="western"><surname>Orlovsky</surname><given-names>GN</given-names></name></person-group>             <year>2000</year>             <article-title>Postural control in the lamprey: A study with a neuro-mechanical model.</article-title>             <source>J Neurophysiol</source>             <volume>84</volume>             <fpage>2880</fpage>             <lpage>2887</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Loeb1">
        <label>26</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Loeb</surname><given-names>GE</given-names></name></person-group>             <year>1990</year>             <article-title>Cochlear prosthetics.</article-title>             <source>Annu Rev Neurosci</source>             <volume>13</volume>             <fpage>357</fpage>             <lpage>371</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Donoghue2">
        <label>27</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name></person-group>             <year>2002</year>             <article-title>Connecting cortex to machines: recent advances in brain interfaces.</article-title>             <source>Nat Neurosci</source>             <volume>5</volume>             <supplement>Suppl</supplement>             <fpage>1085</fpage>             <lpage>1088</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Musallam1">
        <label>28</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Musallam</surname><given-names>S</given-names></name><name name-style="western"><surname>Corneil</surname><given-names>BD</given-names></name><name name-style="western"><surname>Greger</surname><given-names>B</given-names></name><name name-style="western"><surname>Scherberger</surname><given-names>H</given-names></name><name name-style="western"><surname>Andersen</surname><given-names>RA</given-names></name></person-group>             <year>2004</year>             <article-title>Cognitive control signals for neural prosthetics.</article-title>             <source>Science</source>             <volume>305</volume>             <fpage>258</fpage>             <lpage>262</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Wessberg1">
        <label>29</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wessberg</surname><given-names>J</given-names></name><name name-style="western"><surname>Stambaugh</surname><given-names>CR</given-names></name><name name-style="western"><surname>Kralik</surname><given-names>JD</given-names></name><name name-style="western"><surname>Beck</surname><given-names>PD</given-names></name><name name-style="western"><surname>Laubach</surname><given-names>M</given-names></name><etal/></person-group>             <year>2000</year>             <article-title>Real-time prediction of hand trajectory by ensembles of cortical neurons in primates.</article-title>             <source>Nature</source>             <volume>408</volume>             <fpage>361</fpage>             <lpage>365</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Sherrington1">
        <label>30</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Sherrington</surname><given-names>C</given-names></name></person-group>             <year>1961</year>             <source>The integrative action of the nervous system</source>             <publisher-loc>New Haven</publisher-loc>             <publisher-name>Yale University Press</publisher-name>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Hogan1">
        <label>31</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hogan</surname><given-names>N</given-names></name></person-group>             <year>1985</year>             <article-title>Impedance Control: An Approach to Manipulation: Part illApplications.</article-title>             <source>Journal of dynamic systems, measurement, and control</source>             <volume>107</volume>             <fpage>17</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Karnopp1">
        <label>32</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Karnopp</surname><given-names>DC</given-names></name><name name-style="western"><surname>Margolis</surname><given-names>DL</given-names></name><name name-style="western"><surname>Rosenberg</surname><given-names>RC</given-names></name></person-group>             <year>1990</year>             <source>System dynamics: a unified approach</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>John Wiley &amp; Sons, Inc</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">528</size>           </element-citation>
      </ref>
      <ref id="pcbi.1002578-Arimoto1">
        <label>33</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Arimoto</surname><given-names>S</given-names></name><name name-style="western"><surname>Sekimoto</surname><given-names>M</given-names></name><name name-style="western"><surname>Hashiguchi</surname><given-names>H</given-names></name><name name-style="western"><surname>Ozawa</surname><given-names>R</given-names></name></person-group>             <year>2005</year>             <article-title>Natural resolution of ill-posedness of inverse kinematics for redundant robots: a challenge to Bernstein's degrees-of-freedom problem.</article-title>             <source>Adv Robotics</source>             <volume>19</volume>             <fpage>401</fpage>             <lpage>434</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Feldman1">
        <label>34</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Feldman</surname><given-names>AG</given-names></name></person-group>             <year>1986</year>             <article-title>Once more on the equilibrium-point hypothesis (lambda model) for motor control.</article-title>             <source>J Mot Behav</source>             <volume>18</volume>             <fpage>17</fpage>             <lpage>54</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Gribble1">
        <label>35</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Gribble</surname><given-names>PL</given-names></name><name name-style="western"><surname>Ostry</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Sanguineti</surname><given-names>V</given-names></name><name name-style="western"><surname>Laboissiere</surname><given-names>R</given-names></name></person-group>             <year>1998</year>             <article-title>Are complex control signals required for human arm movement?</article-title>             <source>J Neurophysiol</source>             <volume>79</volume>             <fpage>1409</fpage>             <lpage>1424</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Chapin1">
        <label>36</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chapin</surname><given-names>JK</given-names></name><name name-style="western"><surname>Moxon</surname><given-names>KA</given-names></name><name name-style="western"><surname>Markowitz</surname><given-names>RS</given-names></name><name name-style="western"><surname>Nicolelis</surname><given-names>MA</given-names></name></person-group>             <year>1999</year>             <article-title>Real-time control of a robot arm using simultaneously recorded neurons in the motor cortex.</article-title>             <source>Nat Neurosci</source>             <volume>2</volume>             <fpage>664</fpage>             <lpage>670</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Weber1">
        <label>37</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Weber</surname><given-names>DJ</given-names></name><name name-style="western"><surname>London</surname><given-names>BM</given-names></name><name name-style="western"><surname>Hokanson</surname><given-names>JA</given-names></name><name name-style="western"><surname>Ayers</surname><given-names>CA</given-names></name><name name-style="western"><surname>Gaunt</surname><given-names>RA</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Limb-state information encoded by peripheral and central somatosensory neurons: implications for an afferent interface.</article-title>             <source>IEEE Trans Neural Syst Rehabil Eng</source>             <volume>19</volume>             <fpage>501</fpage>             <lpage>513</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Venkatraman1">
        <label>38</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Venkatraman</surname><given-names>S</given-names></name><name name-style="western"><surname>Carmena</surname><given-names>JM</given-names></name></person-group>             <year>2011</year>             <article-title>Active sensing of target location encoded by cortical microstimulation.</article-title>             <source>IEEE Trans Neural Syst Rehabil Eng</source>             <volume>19</volume>             <fpage>317</fpage>             <lpage>324</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Romo1">
        <label>39</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Romo</surname><given-names>R</given-names></name><name name-style="western"><surname>Hernandez</surname><given-names>A</given-names></name><name name-style="western"><surname>Zainos</surname><given-names>A</given-names></name><name name-style="western"><surname>Brody</surname><given-names>CD</given-names></name><name name-style="western"><surname>Lemus</surname><given-names>L</given-names></name></person-group>             <year>2000</year>             <article-title>Sensing without touching: psychophysical performance based on cortical microstimulation.</article-title>             <source>Neuron</source>             <volume>26</volume>             <fpage>273</fpage>             <lpage>278</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Carmena1">
        <label>40</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Carmena</surname><given-names>JM</given-names></name><name name-style="western"><surname>Lebedev</surname><given-names>MA</given-names></name><name name-style="western"><surname>Crist</surname><given-names>RE</given-names></name><name name-style="western"><surname>O'Doherty</surname><given-names>JE</given-names></name><name name-style="western"><surname>Santucci</surname><given-names>DM</given-names></name><etal/></person-group>             <year>2003</year>             <article-title>Learning to control a brain-machine interface for reaching and grasping by primates.</article-title>             <source>PLoS Biol</source>             <volume>1</volume>             <fpage>E42</fpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Fetz2">
        <label>41</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Fetz</surname><given-names>EE</given-names></name></person-group>             <year>2007</year>             <article-title>Volitional control of neural activity: implications for brain-computer interfaces.</article-title>             <source>J Physiol</source>             <volume>579</volume>             <fpage>571</fpage>             <lpage>579</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Chapin2">
        <label>42</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Chapin</surname><given-names>JK</given-names></name><name name-style="western"><surname>Lin</surname><given-names>CS</given-names></name></person-group>             <year>1984</year>             <article-title>Mapping the body representation in the SI cortex of anesthetized and awake rats.</article-title>             <source>J Comp Neurol</source>             <volume>229</volume>             <fpage>199</fpage>             <lpage>213</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Hall1">
        <label>43</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hall</surname><given-names>RD</given-names></name><name name-style="western"><surname>Lindholm</surname><given-names>EP</given-names></name></person-group>             <year>1974</year>             <article-title>Organization of motor and somatosensory neocortex in the albino rat.</article-title>             <source>Brain Res</source>             <volume>66</volume>             <fpage>23</fpage>             <lpage>38</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Paxinos1">
        <label>44</label>
        <element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Paxinos</surname><given-names>G</given-names></name><name name-style="western"><surname>Watson</surname><given-names>C</given-names></name></person-group>             <year>2007</year>             <source>The rat brain in stereotaxic coordinates</source>             <publisher-name>Academic press</publisher-name> <!--===== Restructure page-count as size[@units="page"] =====--><size units="page">456</size>           </element-citation>
      </ref>
      <ref id="pcbi.1002578-Brumberg1">
        <label>45</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Brumberg</surname><given-names>JC</given-names></name><name name-style="western"><surname>Pinto</surname><given-names>DJ</given-names></name><name name-style="western"><surname>Simons</surname><given-names>DJ</given-names></name></person-group>             <year>1999</year>             <article-title>Cortical columnar processing in the rat whisker-to-barrel system.</article-title>             <source>J Neurophysiol</source>             <volume>82</volume>             <fpage>1808</fpage>             <lpage>1817</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Simons1">
        <label>46</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Simons</surname><given-names>DJ</given-names></name></person-group>             <year>1978</year>             <article-title>Response properties of vibrissa units in rat SI somatosensory neocortex.</article-title>             <source>J Neurophysiol</source>             <volume>41</volume>             <fpage>798</fpage>             <lpage>820</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Woolsey1">
        <label>47</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Woolsey</surname><given-names>TA</given-names></name><name name-style="western"><surname>Van der Loos</surname><given-names>H</given-names></name></person-group>             <year>1970</year>             <article-title>The structural organization of layer IV in the somatosensory region (SI) of mouse cerebral cortex. The description of a cortical field composed of discrete cytoarchitectonic units.</article-title>             <source>Brain Res</source>             <volume>17</volume>             <fpage>205</fpage>             <lpage>242</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Franchi1">
        <label>48</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Franchi</surname><given-names>G</given-names></name></person-group>             <year>2000</year>             <article-title>Reorganization of vibrissal motor representation following severing and repair of the facial nerve in adult rats.</article-title>             <source>Exp Brain Res</source>             <volume>131</volume>             <fpage>33</fpage>             <lpage>43</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Hoffer1">
        <label>49</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Hoffer</surname><given-names>ZS</given-names></name><name name-style="western"><surname>Alloway</surname><given-names>KD</given-names></name></person-group>             <year>2001</year>             <article-title>Organization of corticostriatal projections from the vibrissal representations in the primary motor and somatosensory cortical areas of rodents.</article-title>             <source>J Comp Neurol</source>             <volume>439</volume>             <fpage>87</fpage>             <lpage>103</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Neafsey1">
        <label>50</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Neafsey</surname><given-names>EJ</given-names></name><name name-style="western"><surname>Bold</surname><given-names>EL</given-names></name><name name-style="western"><surname>Haas</surname><given-names>G</given-names></name><name name-style="western"><surname>Hurley-Gius</surname><given-names>KM</given-names></name><name name-style="western"><surname>Quirk</surname><given-names>G</given-names></name><etal/></person-group>             <year>1986</year>             <article-title>The organization of the rat motor cortex: a microstimulation mapping study.</article-title>             <source>Brain Res</source>             <volume>396</volume>             <fpage>77</fpage>             <lpage>96</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Land1">
        <label>51</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Land</surname><given-names>PW</given-names></name><name name-style="western"><surname>Simons</surname><given-names>DJ</given-names></name></person-group>             <year>1985</year>             <article-title>Cytochrome oxidase staining in the rat SmI barrel cortex.</article-title>             <source>J Comp Neurol</source>             <volume>238</volume>             <fpage>225</fpage>             <lpage>235</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-WongRiley1">
        <label>52</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Wong-Riley</surname><given-names>M</given-names></name></person-group>             <year>1979</year>             <article-title>Changes in the visual system of monocularly sutured or enucleated cats demonstrable with cytochrome oxidase histochemistry.</article-title>             <source>Brain Res</source>             <volume>171</volume>             <fpage>11</fpage>             <lpage>28</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Spong1">
        <label>53</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Spong</surname><given-names>MW</given-names></name><name name-style="western"><surname>Hutchinson</surname><given-names>S</given-names></name><name name-style="western"><surname>Vidyasagar</surname><given-names>M</given-names></name></person-group>             <year>2006</year>             <article-title>Robot Modeling and Control.</article-title>             <source>Ind Robot</source>             <volume>33</volume>             <fpage>403</fpage>             <lpage>403</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Szymanski1">
        <label>54</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Szymanski</surname><given-names>FD</given-names></name><name name-style="western"><surname>Semprini</surname><given-names>M</given-names></name><name name-style="western"><surname>Mussa-Ivaldi</surname><given-names>FA</given-names></name><name name-style="western"><surname>Fadiga</surname><given-names>L</given-names></name><name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name><etal/></person-group>             <year>2011</year>             <article-title>Dynamic brain-machine interface: A novel paradigm for bidirectional interaction between brains and dynamical systems.</article-title>             <source>Conf Proc IEEE Eng Med Biol Soc</source>             <volume>2011</volume>             <fpage>4592</fpage>             <lpage>4595</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Panzeri3">
        <label>55</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name><name name-style="western"><surname>Senatore</surname><given-names>R</given-names></name><name name-style="western"><surname>Montemurro</surname><given-names>MA</given-names></name><name name-style="western"><surname>Petersen</surname><given-names>RS</given-names></name></person-group>             <year>2007</year>             <article-title>Correcting for the sampling bias problem in spike train information measures.</article-title>             <source>J Neurophysiol</source>             <volume>98</volume>             <fpage>1064</fpage>             <lpage>1072</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Panzeri4">
        <label>56</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name><name name-style="western"><surname>Treves</surname><given-names>A</given-names></name></person-group>             <year>1996</year>             <article-title>Analytical estimates of limited sampling biases in different information measures.</article-title>             <source>Network-Comp Neural</source>             <volume>7</volume>             <fpage>87</fpage>             <lpage>108</lpage>          </element-citation>
      </ref>
      <ref id="pcbi.1002578-Montemurro1">
        <label>57</label>
        <element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author"><name name-style="western"><surname>Montemurro</surname><given-names>MA</given-names></name><name name-style="western"><surname>Senatore</surname><given-names>R</given-names></name><name name-style="western"><surname>Panzeri</surname><given-names>S</given-names></name></person-group>             <year>2007</year>             <article-title>Tight data-robust bounds to mutual information combining shuffling and model selection techniques.</article-title>             <source>Neural Comput</source>             <volume>19</volume>             <fpage>2913</fpage>             <lpage>2957</lpage>          </element-citation>
      </ref>
    </ref-list>
    
  </back>
</article>