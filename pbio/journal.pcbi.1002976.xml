<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
        <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00887</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1002976</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Biophysics</subject>
            <subj-group>
              <subject>Macromolecular assemblies</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Neuroscience</subject>
            <subj-group>
              <subject>Neurophysiology</subject>
              <subj-group>
                <subject>Synapses</subject>
              </subj-group>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Proteomics</subject>
            <subj-group>
              <subject>Protein abundance</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Biophysics</subject>
          <subject>Neuroscience</subject>
          <subject>Biochemistry</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>Automated Analysis of a Diverse Synapse Population</article-title>
        <alt-title alt-title-type="running-head">Automated Analysis of a Diverse Synapse Population</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Busse</surname>
            <given-names>Brad</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Smith</surname>
            <given-names>Stephen</given-names>
          </name>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>Biophysics Program, Stanford University, Stanford, California, United States of America</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>Program in Physical Biology, Eunice Kennedy Shriver National Institute of Child Health and Human Development, National Institutes of Health, Bethesda, Maryland, United States of America</addr-line>
      </aff>
      <aff id="aff3">
        <label>3</label>
        <addr-line>Department of Molecular and Cellular Physiology, Stanford University, Stanford, California, United States of America</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Hawrylycz</surname>
            <given-names>Michael</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>Allen Institute for Brain Science, United States of America</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">bbusse@gmail.com</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: BB SS. Performed the experiments: BB. Analyzed the data: BB. Contributed reagents/materials/analysis tools: BB. Wrote the paper: BB SS.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <month>3</month>
        <year>2013</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>28</day>
        <month>3</month>
        <year>2013</year>
      </pub-date>
      <volume>9</volume>
      <issue>3</issue>
      <elocation-id>e1002976</elocation-id>
      <history>
        <date date-type="received">
          <day>1</day>
          <month>6</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>21</day>
          <month>1</month>
          <year>2013</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2013</copyright-year>
        <license xlink:type="simple">
          <license-p>This is an open-access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the Creative Commons CC0 public domain dedication.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>Synapses of the mammalian central nervous system are highly diverse in function and molecular composition. Synapse diversity <italic>per se</italic> may be critical to brain function, since memory and homeostatic mechanisms are thought to be rooted primarily in activity-dependent plastic changes in specific subsets of individual synapses. Unfortunately, the measurement of synapse diversity has been restricted by the limitations of methods capable of measuring synapse properties at the level of individual synapses. Array tomography is a new high-resolution, high-throughput proteomic imaging method that has the potential to advance the measurement of unit-level synapse diversity across large and diverse synapse populations. Here we present an automated feature extraction and classification algorithm designed to quantify synapses from high-dimensional array tomographic data too voluminous for manual analysis. We demonstrate the use of this method to quantify laminar distributions of synapses in mouse somatosensory cortex and validate the classification process by detecting the presence of known but uncommon proteomic profiles. Such classification and quantification will be highly useful in identifying specific subpopulations of synapses exhibiting plasticity in response to perturbations from the environment or the sensory periphery.</p>
      </abstract>
      <abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Synaptic connections are fundamental to every aspect of brain function. There is growing recognition that individual synapses are the key sites of the functional plasticity that allows brain circuits to store and retrieve memories and to adapt to changing demands and environments. There is also a growing consensus that many neurological, psychiatric, neurodevelopmental and neurodegenerative disorders may be best understood at the level of specific, proteomically-defined synapse subsets. Here, we introduce and validate computational analysis tools designed to complement array tomography, a new high-resolution proteomic imaging method, to enable the analysis of diverse synapse populations of unprecedentedly large size at the single-synapse level. We expect these new single-synapse classification and analysis tools to substantially advance the search for the specific physical traces, or engrams, of specific memories in the brains synaptic circuits. We also expect these same tools to be useful for identifying the specific subsets of synapses that are impacted by the various synaptically-rooted afflictions of the brain.</p>
      </abstract>
      <funding-group>
        <funding-statement>This work was supported by grants R01NS075252 and R01NS077601 from the NIH/NINDS, a Collaborative Innovation Award (#43667) from the Howard Hughes Medical Institute, and grants from the Gatsby Charitable Trust and the Mathers Foundation. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="14"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Synapses are fundamental to every aspect of brain function. They are recognized today as being highly complex structures and highly diverse in both function and molecular composition. At the structural level, individual synapses of the mammalian central nervous system are thought to comprise hundreds of distinct protein species <xref ref-type="bibr" rid="pcbi.1002976-Grant1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1002976-SassoPognetto1">[3]</xref>, and genomic and gene expression data available implies very strongly that there are multiple isoforms of many of these proteins and that their expression is differentially patterned across the brains diverse cell types <xref ref-type="bibr" rid="pcbi.1002976-Lein1">[4]</xref>. It thus seems inescapable that synapses of the brain, even within traditional transmitter-defined synapse categories (e.g., glutamatergic, GABAergic, cholinergic, etc.), must be highly diverse in protein composition <xref ref-type="bibr" rid="pcbi.1002976-ORourke1">[5]</xref>. This conclusion is consistent with the available functional data, where physiological studies report wide differences in synaptic transmission as different brain regions and pathways are examined (again, even when results are compared only within traditional neurotransmitter categories). Moreover, the well-known functional plasticity of both synapse structure and synapse function in response to electrical activity implies directly that even an otherwise homogeneous synapse population must become heterogeneous or diverse after individual synapses experience differential activity. In this light, it seems likely that synapse diversity per se may be critical to the proper function of neural circuitry. For instance, there is now widely believed that the plasticity (and therefore resulting diversity) of individual synapses is fundamental to memory storage and retrieval and to many other aspects of neural circuit adaptation to environmental change <xref ref-type="bibr" rid="pcbi.1002976-Turrigiano1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002976-Citri1">[7]</xref>.</p>
      <p>Unfortunately, the measurement of synapse diversity has been restricted by the limitations of available methods capable of resolving individual synapses. Array tomography (AT) is a new high-resolution, high-throughput proteomic imaging method that has the potential to very substantially advance the measurement of unit-level synapse diversity across large and diverse synapse populations. AT uses multiple cycles of immunohistochemical labeling on thin sections of resin-embedded tissue to image the proteomic composition of synapse-sized structures in a depth-invariant manner. We have applied AT to freshly-fixed mouse cerebral cortex, where our volumes have typical sizes of thousands to millions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e001" xlink:type="simple"/></inline-formula> of tissue, contain millions of individually-resolved synapses, and label over a dozen multiplexed proteomic markers.</p>
      <p>With proper analysis, the informational density of array tomographic volumes has numerous potential applications. Synapse-level resolution of large volumes of tissue is an ideal tool for addressing interesting hypotheses concerning principles like synaptic scaling <xref ref-type="bibr" rid="pcbi.1002976-Turrigiano1">[6]</xref>, structural arrangement <xref ref-type="bibr" rid="pcbi.1002976-Garner1">[8]</xref>, and novel synapse types <xref ref-type="bibr" rid="pcbi.1002976-Hioki1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002976-Gutirrez1">[10]</xref>. Combined with connectomic data <xref ref-type="bibr" rid="pcbi.1002976-Briggman1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1002976-Anderson1">[12]</xref>, genetic models <xref ref-type="bibr" rid="pcbi.1002976-Li1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1002976-Kuhlman1">[14]</xref> or dye filling techniques <xref ref-type="bibr" rid="pcbi.1002976-Katz1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1002976-Davie1">[16]</xref>, array tomography can also address questions regarding proteomic distributions in specific subsets of cells. We are interested in investigations of this nature and others in the mouse cerebral cortex, where the anatomical distribution of synapses, aside from cortical layer cytoarchitectonics, is currently largely unexplored.</p>
      <sec id="s1a">
        <title>Developing a Method of Synapse Quantification</title>
        <p>Utilizing array tomography to its fullest extent requires the development of new synapse detection and classification capabilities. Simple analysis, using repeated human observation of a fraction of the channels available in the full volume, may be acceptable for analyzing fragmentary subsets of a few hundred synapses but cannot scale beyond that. We have developed tools and methods to assist in handling the high proteomic dimensionality of array tomographic volumes (<xref ref-type="fig" rid="pcbi-1002976-g001">Figure 1</xref>), principally the synaptogram <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>; a means of visualizing small pieces of highly multiplexed data by splaying out the 3-D volume surrounding a region of interest (ostensibly a single synapse) into a larger 2-D image.</p>
        <fig id="pcbi-1002976-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002976.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>The synaptogram as a tool for high-dimensional proteomic visualization.</title>
            <p>(A) A maximum projected volume of Synapsin I labeling. 41 slices, 70 nm per slice, total thickness of 2.87 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e002" xlink:type="simple"/></inline-formula>. (B) Randomly-colored segmentation of individual synapsin puncta. (C) Rendering of a single punctum from the volume showing synapsin (white), imaged together with VGluT1 (red), PSD95 (green), GluR2 (blue), GAD (magenta) and VGAT (magenta). From top to bottom: all proteomic markers, glutamatergic presynaptic labels, glutamatergic postsynaptic labels, GABAergic labels. This appears to be a glutamatergic synapse. (D) The synaptogram derived from the same synapse. Synapsin, top row, is repeated in red for the rest to provide spatial context. Not shown, sixteen other colors and two redundant labels (synapsin and VGluT1). Scale bar: 5 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e003" xlink:type="simple"/></inline-formula>, size of synaptogram/render volume, 1100 nm × 1100 nm × 630 nm.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002976.g001" position="float" xlink:type="simple"/>
        </fig>
        <p>An example of a synaptogram in action can be seen in <xref ref-type="fig" rid="pcbi-1002976-g001">Figure 1-C,D</xref>, both of which visualize the same synaptic volume. 1-C attempts to render the volume in three dimensions, assigning a different color to each channel, and running out of easily separable colors in the process, even for this one example. It also falls prone to the usual pitfalls of obscuration and optical confusion common to snapshots of rendered scenes, such that splitting the image into multiple ones displaying subsets of colors helps visualization considerably. Contrast this with a synaptogram of the same synapse in <xref ref-type="fig" rid="pcbi-1002976-g001">Figure 1-D</xref>. Each row of thumbnails displays a different channel (plus synapsin, included to serve as a reference channel), each column shows a different z-section; left is below, right is above. Unlike the render, position and depth relationships are presented clearly, and the synaptogram can be extended to include an arbitrarily large number of simultaneous imaging channels by appending new rows vertically.</p>
        <p>With only a bit of exposure to synaptograms, human experts can use them to tell at a glance exactly what they're seeing. This eases the difficulty of per-synapse manual classification such that the effort of classifying a set of few hundred synapses is no longer excessive, but no matter how convenient they are to analyze individually, the sheer number of synapses makes manual analysis of the entire data set effectively impractical.</p>
        <p>Given that just a few hundred analyzed examples can be obtained with a reasonable expenditure of effort, there are two approaches to consider. The first is to use those examples as a representative sample, in a manner similar to stereology. That may work well for some questions, but not others. Rare or novel synapse types and cortical laminar distributions would be especially difficult to study. An alternative, which this paper will present, is to take that sample of accurately classified synapses and extrapolate its decision-making information to the much larger population of unclassified individuals.</p>
      </sec>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Identifying Putative Synaptic Loci</title>
        <p>The first necessary step in our classification process is to locate the sites which may contain synapses. Despite their appreciable proteomic diversity <xref ref-type="bibr" rid="pcbi.1002976-Bays1">[18]</xref>, cortical synapses are small: from the ostensible midpoint of the synapse, all relevant synaptic protein labeling can fit within a 500 nanometer radius for mouse cortex <xref ref-type="bibr" rid="pcbi.1002976-Dani1">[19]</xref>. Given a reliable method of locating synapses, all information needed to verify and type those synapses can be measured from the local volume surrounding them, greatly reducing the spatial analysis needed per synapse. To avoid confusion with actual synapses, we refer to these sorts of putative synapse locations as “synaptic loci.” They are specific places which might be synaptic.</p>
        <p>In order to find putative synapses to help limit the necessary search space, we are using an antibody targeting Synapsin I. Synapsin is a scaffolding protein reportedly found in all cortical synapses <xref ref-type="bibr" rid="pcbi.1002976-DeCamilli1">[20]</xref>, and labeled antibodies targeting synapsin have previously been used on their own to estimate synapse counts <xref ref-type="bibr" rid="pcbi.1002976-Evans1">[21]</xref>. A Millipore Rabbit anti-Synapsin I antibody (Millipore AB1543P) demonstrates robust and reliable labeling, and is likely to be colocalized with all relevant synaptic markers <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>. For these reasons the core of our analysis uses Synapsin I labeling to derive a list of locations likely to contain synapses from which to begin small volumetric searches for confirmation. Our approach is to use the brightest point of each Synapsin I punctum as the site of a possible synapse to designate a local volume for further analysis, without attempting to explicitly determine the punctum boundaries.</p>
        <p>We prefer our local maxima-based approach over thresholding-based segmentation because the latter has a number of issues arising from AT's largely anisotropic resolution (∼200nm × ∼200nm × 70nm). This anisotropy, combined with (often unknown) epitope density and labeling variance means that any segmented punctum boundary is at best an estimate. An approach using local maxima, paired with a voxel-based rotation-invariant feature set, is not affected by the exact boundaries of the puncta of interest, but by the puncta themselves.</p>
        <p>While our approach to synapse discovery sidesteps segmentation, it does so at the cost of introducing potential false positives: background local maxima which segmentation would have discarded, but whose peak brightness rises over our low threshold for consideration. However, it is possible to filter those out in later classification. Conversely, this method is ideal for teasing apart “clumps” of synaptic labeling, where multiple synapses exist in close proximity but can be resolved by the Rayleigh criterion and thus having separate local maxima.</p>
      </sec>
      <sec id="s2b">
        <title>Manual Classification</title>
        <sec id="s2b1">
          <title>Using human experts</title>
          <p>It has been demonstrated that the fluorescently labeled markers used in AT corroborate well with their identification from EM ultrastructure, despite the deleterious effects of glutaraldehyde fixation on tissue antigenicity <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>. It then follows that a process by which synapses can be reliably identified via their component markers imaged in light microscopy alone will inherit the corroboration and can be said to be faithful representations of synapse populations.</p>
          <p>Humans can visually identify the synaptic category of a given locus via the use of synaptograms (<xref ref-type="fig" rid="pcbi-1002976-g001">Figure 1</xref>), using the spatial juxtaposition of a number of relevant synaptic molecules for classification <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>. Glutamatergic synapses, for example, will by definition have at least one vesicular glutamate transport protein and at least one post synaptic density scaffolding protein present. Similarly, GABAergic synapses can be identified by the presence of glutamic acid decarboxylase (GAD) and a vesicular GABA transport protein.</p>
          <p>This process of human synapse identification is the best and most reliable method of synapse identification available to us. It relies on the perception and expertise of the human viewer to apply the visual segmentation which defines the “presence” of necessary labels. This task incorporates a great deal of <italic>a priori</italic> knowledge concerning the stearic and functional relationships between the different molecular labels, the variance in labeling of each particular antibody, and the particular conditions under which that tissue had been fixed, embedded, labeled, imaged, relabeled, etc.</p>
          <p>Although manual classification of fluorescence data is orders of magnitude faster than EM stereology, it is still orders of magnitude slower than needed to keep up with the synaptic output rate of AT volumes. For that, we decided to use human-generated classifications as training data, then liberally applied a number of clustering and supervised learning methods to quantitatively mimic the human decision making process. Assuming the machine learning algorithm thus trained could perform on par with a human expert it can then be used in place of the human, though to avoid “garbage-in, garbage-out” scenarios, this does not obviate the need for error estimation when faced with novel problems.</p>
        </sec>
      </sec>
      <sec id="s2c">
        <title>Machine Learning</title>
        <p>Machine learning methods come in two broad categories. Supervised learning algorithms, trained using a sufficient number of human rated synapses, are capable of producing numerical descriptions of human judgment as it is applied to synapse classification, as well as extrapolating that judgment to the hundreds of thousands of synapses which comprise an average data set. Unsupervised clustering, on the other hand, when applied to raw synaptic loci or already classified synapses is a great approach to the discovery of marginal classes or subtle subtypes.</p>
        <sec id="s2c1">
          <title>Feature extraction</title>
          <p>The first step in constructing a computational framework for either form of synapse classification is to find a set of explicit measurements which span the feature space that human raters implicitly search. We are using a small set of ad hoc, channel-independent, rotationally invariant features to measure the spatial distribution of each channel's fluorescence about the synaptic locus. These features are calculated per voxel, without relying on segmentation, combinatorial information or <italic>a priori</italic> geometrical information, in keeping with the rationale behind finding the loci in a similarly parameter-independent manner. The equations used to calculate the four features are given below.</p>
          <p>For every voxel <italic>i</italic> in the local 11×11×11 voxel window <italic>V</italic> with brightness <italic>b</italic> and pixelwise distance from the synaptic locus <italic>d</italic>:<disp-formula id="pcbi.1002976.e004"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002976.e004" xlink:type="simple"/><label>(1)</label></disp-formula><disp-formula id="pcbi.1002976.e005"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002976.e005" xlink:type="simple"/><label>(2)</label></disp-formula><disp-formula id="pcbi.1002976.e006"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002976.e006" xlink:type="simple"/><label>(3)</label></disp-formula><disp-formula id="pcbi.1002976.e007"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002976.e007" xlink:type="simple"/><label>(4)</label></disp-formula>Of these features, the Integrated Brightness is the simplest to describe, as it is the sum of all the pixel values within 5 pixels. Local Brightness is also the sum of all values within 5 pixels, but the contribution of each pixel is reduced by the square of its distance from the locus. It can be used as a metric for estimating the volume of the punctum without segmentation because nearby pixels (more likely to be part of the punctum) contribute much more heavily than distant ones (more likely to be noise or neighbors). To test this assumption, we compared scores produced by this feature to that of a simple connected component analysis measuring size directly, and found a high degree of correlation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e008" xlink:type="simple"/></inline-formula> = 0.829). The remaining features, Center of Mass and Moment of Inertia, treat the puncta brightness as if it is a mass distribution in a synaptogram-sized object, and respectively compute the distance to the center of that object and its angular inertia for a rotation about the locus. The combination of all four features effectively describe the fluorescence distribution in a synaptogram.</p>
          <p>The result of this feature extraction, when performed on a multidimensional image of <italic>c</italic> channels, is a 4<italic>c</italic>-long numerical vector of proteomic measurements describing the putative synapse. This analysis is repeated for each of <italic>p</italic> synaptic loci in the data set, giving us a <italic>p </italic>× 4<italic>c</italic> matrix of measurements to be further analyzed. To enhance consistency between data sets, which may well have different imaging conditions, we normalize each of the extracted features by dividing by the population's mean score.</p>
        </sec>
      </sec>
      <sec id="s2d">
        <title>Clustering</title>
        <p>Although visual analysis is the traditional and preferred method of examining biological data, long strings of numbers such as our feature vectors are difficult for humans to visualize. In response, high-dimensional numerical measurements have often been approached using some form of dimensionality reduction as a first step in numerical analysis. Simply put, reducing a long string of numbers to a short string of numbers makes them easier graphically display and understand. Principal Component Analysis (PCA) is a venerable method of dimensionality reduction which has seen use in similar applications <xref ref-type="bibr" rid="pcbi.1002976-Jackson1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1002976-BelkacemBoussaid1">[23]</xref>, and has proven useful in ours as well.</p>
        <p>Our PCA result, illustrated in <xref ref-type="fig" rid="pcbi-1002976-g002">Figure 2</xref>, identifies some synaptic populations but does not separate them sufficiently for classification. The loci tend to aggregate in clusters which correspond to a few of the broader synaptic categorizations, namely GABAergic and two common subtypes of glutamatergic synapses. We identified the clusters using multivariate regression, that is, taking a few of the more distant examples and inferring the contribution of channels which brought them from the mean. The PCA demonstrates the existence of separate populations corresponding to each class, but in the reduced dimensionality of PCA, simple thresholds are insufficient for proper class discrimination. The two components plotted explain 50.4% of the variance between them. An additional 20.9% of the variance is present in the second principal component (not shown), which appeared to represent synapse size.</p>
        <fig id="pcbi-1002976-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002976.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Clustering of synapsin I imaged with array tomography.</title>
            <p>When the first and third principal components of the local brightness feature eq 1 are plotted against each other, they form clusters identifiable as known synaptic subtypes, and explain 50.4% of the variance in the data.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002976.g002" position="float" xlink:type="simple"/>
        </fig>
        <p>Ideally, the dimensionality reduction accomplished by the above methods would have proven amenable to simple thresholding. If that where the case, multivariate regression might have led to identification and, combined with a measure of the statistical significance of cluster separation, classification of unknown synapses based solely on where they fell in the unsupervised plot. Since our clusters were not so cleanly separable, we resorted to a more subtle stratagem involving supervised learning.</p>
      </sec>
      <sec id="s2e">
        <title>Classification</title>
        <p>The “supervision” of supervised learning refers to the supervised training set, a random or semi-random collection of human-rated examples from which the machine learning algorithm (MLA) infers the rules for classification to extrapolate onto novel synapses. To generate each item of the set, we presented a synaptogram to a human trainer, who rated the synaptogram in one or more binary categories representing the presence or absence of channels relevant to synapse classes of interest. We could then associate those categorizations with the already-derived feature vectors of those examples, compiling them into a library of “correct” classifications for training.</p>
        <sec id="s2e1">
          <title>MLA selection</title>
          <p>Another necessary choice in supervised learning is that of the MLA used as a classifier. In an early training experiment, we created a training set of 200 examples classified into glutamatergic/non-glutamatergic and GABAergic/non-GABAergic categories. We fed these results into an assortment of MLAs with minimal parameter optimization. The error rates of the various MLAs are presented in <xref ref-type="table" rid="pcbi-1002976-t001">Table 1</xref>. Although many of these algorithms performed well, combined with the posterior metrics detailed below, the random forest ensemble <xref ref-type="bibr" rid="pcbi.1002976-Breiman1">[24]</xref> slightly edged out the competition and earned its place as our classifier of choice. One observation worth mentioning: all classifiers performed better when detecting GABAergic synapses, as compared to glutamatergic. At the time this comparison was conducted, we had presumed the systematic error to stem from the reduced background staining of our GABAergic channels. However, after conducting our channel-based classification comparison (below), we currently suspect it has more to do with the comparatively higher classification error of PSD95.</p>
          <table-wrap id="pcbi-1002976-t001" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002976.t001</object-id>
            <label>Table 1</label>
            <caption>
              <title>Machine Learning Algorithm comparison.</title>
            </caption>
            <alternatives>
              <graphic id="pcbi-1002976-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002976.t001" xlink:type="simple"/>
              <table>
                <colgroup span="1">
                  <col align="left" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                  <col align="center" span="1"/>
                </colgroup>
                <thead>
                  <tr>
                    <td align="left" rowspan="1" colspan="1"/>
                    <td align="left" rowspan="1" colspan="1">LDA</td>
                    <td align="left" rowspan="1" colspan="1">QDA</td>
                    <td align="left" rowspan="1" colspan="1">NB</td>
                    <td align="left" rowspan="1" colspan="1">NBkd</td>
                    <td align="left" rowspan="1" colspan="1">RFE</td>
                    <td align="left" rowspan="1" colspan="1">kNN</td>
                    <td align="left" rowspan="1" colspan="1">SVM</td>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">Glut</td>
                    <td align="left" rowspan="1" colspan="1">0.128</td>
                    <td align="left" rowspan="1" colspan="1">0.114</td>
                    <td align="left" rowspan="1" colspan="1">0.110</td>
                    <td align="left" rowspan="1" colspan="1">0.104</td>
                    <td align="left" rowspan="1" colspan="1">0.084</td>
                    <td align="left" rowspan="1" colspan="1">0.176</td>
                    <td align="left" rowspan="1" colspan="1">0.222</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">GABA</td>
                    <td align="left" rowspan="1" colspan="1">0.044</td>
                    <td align="left" rowspan="1" colspan="1">0.036</td>
                    <td align="left" rowspan="1" colspan="1">0.062</td>
                    <td align="left" rowspan="1" colspan="1">0.052</td>
                    <td align="left" rowspan="1" colspan="1">0.036</td>
                    <td align="left" rowspan="1" colspan="1">0.070</td>
                    <td align="left" rowspan="1" colspan="1">0.178</td>
                  </tr>
                </tbody>
              </table>
            </alternatives>
            <table-wrap-foot>
              <fn id="nt101">
                <label/>
                <p>Comparison of various supervised machine learning algorithms. A small training set was used to compare the error rates of multiple MLAs when classifying glutamatergic and GABAergic synapses in an early data set. From left to right: Linear Discriminant Analysis (LDA); Quadratic Discriminant Analysis (QDA); Naive Bayesian filter, gaussian distribution assumption (NB); Naive Bayesian filter, normalized kernel distribution assumption (NBkd); Random Forest Ensemble (RFE); k-means clustering (kNN); Support Vector Machine (SVN). k-means clustering, an unsupervised clustering method, was included for comparison's sake.</p>
              </fn>
            </table-wrap-foot>
          </table-wrap>
        </sec>
        <sec id="s2e2">
          <title>Global feature importance</title>
          <p>An additional point in favor of the random forest ensemble was the useful posterior metrics which can be simply derived as a byproduct of its algorithmic structure. Posterior metrics are methods of analyzing the process of classification after classification. Their primary purpose is to relate information about why a given locus was classified one way or another, and meta-information such as the relationship between classes and the features which proved more important than others during classification.</p>
          <p>Each decision tree in a random forest is a series of optimal feature threshold branches with decisions for leaves. By keeping track of which feature was used for each branch point, along with the confidence that branch point engenders, we could gauge the importance of the various features relative to each other. Overall, our local brightness feature proved most useful, with the rest decreasing in performance. Normalized to the local brightness importance, feature values were 0.76, 1.00, 0.59 and 0.55 for the integrated brightness, local brightness, center of mass and moment of inertia features, respectively. Though the local brightness feature may have outshone the others, all proved useful in classification.</p>
        </sec>
        <sec id="s2e3">
          <title>Channel-based classification</title>
          <p>For our preliminary analyses, including the MLA choice analysis and the human agreement test, we classified synapses based on specific synapse classes: a synaptic locus was marked positive if and only if its synaptogram included all the requisite markers for a synapse of the class in question. Iterated over an entire data set, a human expert looking for this synaptic class (or an algorithm trained to do the same) should be able to identify all such synapses. While this approach adroitly combined the tasks of synapse identification and classification for this particular type of synapse, it could not serve as a general method for synapse identification. Novel synapse types with unexpected channel combinations were likely to be discarded as noise, if missing a critical channel, or else lumped in with existing synapse types.</p>
          <p>In order to facilitate the discovery of novel synapse populations, we decided to split the classification of loci into multiple parallel classification steps. Rather than train one MLA per synapse class to detect the combination of all relevant channels, we trained one MLA per channel to detect the “presence” of that channel at each locus, and allowed the combination of their predictions to identify synapses of that class. For example, rather than training a glutamatergic synapse classifier to detect glutamatergic synapses, we used individual classifiers for the relevant channels (VGluT1, VGluT2, PSD95), and then combined their outputs in the same logical way ((VGluT1 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e009" xlink:type="simple"/></inline-formula> VGluT2) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e010" xlink:type="simple"/></inline-formula> PSD95) to identify glutamatergic synapses.</p>
          <p>Approaching the problem of synapse classification in this manner imparts several benefits to our process. Principally, it facilitates the identification of novel synapse types by allowing us to quickly recombine classified channels. For example, if for some reason we suspected the existence of VGAT-positive glutamatergic synapses, it would be simple to add a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e011" xlink:type="simple"/></inline-formula> VGAT term to the above logical condition for glutamatergic synapses, and see if the resulting population occurs significantly above chance.</p>
          <p>An additional but perhaps more fundamental benefit of our channel-based approach is its greater resemblance to the method by which AT labeling can be validated with EM <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>. If desired, the output of a channel-classifier can be compared directly to the EM with a single immunolabel, as opposed to the three or so needed to verify the output of a full synapse classifier.</p>
        </sec>
        <sec id="s2e4">
          <title>Active learning and rare classes</title>
          <p>In most supervised learning models, training set examples are sampled entirely at random in order for the training set to have the same statistical properties of the full data set. This can be inefficient for us in the of case of uncommon channels. The less common a given channel is, the more negative results a human has to sort through before reaching a usable number of positive results. For example, VGluT3 positive loci can be identified in much the same manner as VGluT1 or VGluT2 loci, but due to their paucity in the cortex (we see roughly 1.2 VGluT3+ loci per one thousand negative loci), human raters would have to classify excessive numbers of negative loci for each positive locus in the training set.</p>
          <p>In order to address this possibility, our classification process is a two-phased nonrandom selection of training examples. It is described in detail in the methods section but, briefly, functions by actively using the classifier it is training to select examples that help ensure a diverse training set, and presents each example's predicted class to the user. The net effect of the training modification is to focus the human role more on verification and correction than strict instruction. Aside from accomplishing the goal of efficiently training classifiers for rare classes, we find that the active version seems to be much less of a strain on human patience than <italic>de novo</italic> training, even that aided by synaptograms. It also reduces the necessary training set size to roughly twice the number of requisite positive synapses in the training set, despite the rarity of the class in question.</p>
          <p>Once the human raters are satisfied with their training sets, we pass the entire data volume through the classifiers for identification, and collate the results into a combinatorial set of vectors.</p>
        </sec>
      </sec>
      <sec id="s2f">
        <title>Post-Classification Analysis</title>
        <p>After classification, the predicted presence of each channel for a given locus can be derived from the percentage of decision trees in the random forest ensemble which attest to its presence. This effectively serves as a confidence metric for the entire ensemble, and is generally referred to as the “posterior probability.” An instance with a posterior probability of 1.0 is unequivocally positive for the class in question, one of 0.0 is undeniably negative. In this manner, we reduce the 4<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e012" xlink:type="simple"/></inline-formula>-long numeric feature vector to a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e013" xlink:type="simple"/></inline-formula>-long numeric posterior vector, representing the presence or absence of all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e014" xlink:type="simple"/></inline-formula> relevant channels. We can then use these vectors in a combinatorial fashion to recreate synaptic classes. Glutamatergic VGluT1-expressing synapses, for example, should at a minimum be positive (posterior probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e015" xlink:type="simple"/></inline-formula>0.5) for VGluT1 and PSD95.</p>
        <sec id="s2f1">
          <title>Per-channel feature importance</title>
          <p>Since our labeled channels occupy a number of spatial niches in the canonical synapse, we were interested in determining which features contributed most to which channel classifier, in case that reflected the differential distribution. The results are shown in <xref ref-type="fig" rid="pcbi-1002976-g003">Figure 3</xref>. The channels which differ from the norm (<xref ref-type="fig" rid="pcbi-1002976-g003">Figure 3-A</xref>) in selecting the center of mass or moment of inertia features as their most important included VGluT2, VGluT3 and VAChT. These channels are all presynaptic, which eliminates spatial differentiation as a cause, but interestingly they are all uncommon to rare. TH, also rare, did not display this behavior, and also differs from the rest in that “neighboring” puncta were deemed acceptable for positive classification. This may suggest that for rare classes where neighbor discrimination is important, determining whether a discovered punctum is part of the synapse in question or a close neighbor plays a bigger role in the accuracy rate than discovering the punctum in the first place.</p>
          <fig id="pcbi-1002976-g003" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002976.g003</object-id>
            <label>Figure 3</label>
            <caption>
              <title>Relative feature importance for different molecular labels.</title>
              <p>When all classes were averaged (top left), our local brightness feature (ii) saw the most use, followed by integrated brightness (i), center of mass (iii) and moment of inertia (iv). GAD, VGAT, PV, VGluT3, VGluT2, VGluT1, PSD95, VAChT, and TH each make slightly different use of the feature set. VGluT3, VGluT2, and VAChT are notable in that they rely most heavily on features other than local brightness.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002976.g003" position="float" xlink:type="simple"/>
          </fig>
        </sec>
        <sec id="s2f2">
          <title>OOB error as cross-validation step</title>
          <p>The training process of the random forest classification itself provides a reliable approximation of its error rate. During training, each tree in a random forest excludes a random fraction of examples from its construction, which can later be used in the manner of cross-validation testing to gauge the accuracy of that tree. More precisely, each training example can function as withheld data for a sub-random forest ensemble composed of the fraction of decision trees to have excluded it during training, and, taken in aggregate, are an estimate of the performance of the full forest. This is called the “out-of-bag error” <xref ref-type="bibr" rid="pcbi.1002976-Breiman1">[24]</xref>. OOB performance for the classes we are interested in can be found in <xref ref-type="table" rid="pcbi-1002976-t002">Table 2</xref>. The OOB error can be interpreted as a self-estimation of the classifier's true error rate. Of note is PSD95, with an error rate as high as the rarer classes, probably due to its postsynaptic location whereas all other markers are presynaptic.</p>
          <table-wrap id="pcbi-1002976-t002" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002976.t002</object-id>
            <label>Table 2</label>
            <caption>
              <title>MLA training comparison.</title>
            </caption>
            <alternatives>
              <graphic id="pcbi-1002976-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002976.t002" xlink:type="simple"/>
              <table>
                <colgroup span="1">
                  <col align="left" span="1"/>
                  <col align="center" span="1"/>
                </colgroup>
                <thead>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">Channel</td>
                    <td align="left" rowspan="1" colspan="1">OOB Error</td>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">GAD</td>
                    <td align="left" rowspan="1" colspan="1">0.0400</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">VGAT</td>
                    <td align="left" rowspan="1" colspan="1">0.0767</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">PV</td>
                    <td align="left" rowspan="1" colspan="1">0.0814</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">VGluT3</td>
                    <td align="left" rowspan="1" colspan="1">0.1146</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">VGluT2</td>
                    <td align="left" rowspan="1" colspan="1">0.0716</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">VGluT1</td>
                    <td align="left" rowspan="1" colspan="1">0.0690</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">PSD95</td>
                    <td align="left" rowspan="1" colspan="1">0.1215</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">VAChT</td>
                    <td align="left" rowspan="1" colspan="1">0.1394</td>
                  </tr>
                  <tr>
                    <td align="left" rowspan="1" colspan="1">TH</td>
                    <td align="left" rowspan="1" colspan="1">0.0333</td>
                  </tr>
                </tbody>
              </table>
            </alternatives>
            <table-wrap-foot>
              <fn id="nt102">
                <label/>
                <p>Out-of-bag (OOB) error rate estimates for various classified markers. Order of markers is the same as in <xref ref-type="fig" rid="pcbi-1002976-g006">Figure 6</xref>. Each classifier had a minimum training set size of one hundred examples.</p>
              </fn>
            </table-wrap-foot>
          </table-wrap>
        </sec>
        <sec id="s2f3">
          <title>Comparison to human rating</title>
          <p>To quantitatively examine this system's performance when applied to real synapse classification, we ran our human accuracy test set through the VGluT1 and PSD95 classifiers, then compared the combined output (VGluT1 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e016" xlink:type="simple"/></inline-formula> PSD95) loci with that given by humans. Although these two channels had the worst OOB performance, the intersection of the two was about as accurate as the best human raters. We performed a receiver operating characteristics analysis to describe the classifier performance in a more detailed fashion; it is shown in <xref ref-type="fig" rid="pcbi-1002976-g004">Figure 4B</xref>. The fact that the worst OOB error is still equal to the agreement of human raters implies the output of the classifiers should be usable with the same degree of confidence as that of human raters.</p>
          <fig id="pcbi-1002976-g004" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002976.g004</object-id>
            <label>Figure 4</label>
            <caption>
              <title>Comparison of human rating to machine learning.</title>
              <p>(A) Accuracy rates. <bold>i-vi</bold> - When compared against the average decisions of their peers in a VGluT1 synapse discrimination task, humans performed at different accuracy levels based on their stringency of classification. <bold>vii</bold> - The random forest ensemble, (VGluT1 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e017" xlink:type="simple"/></inline-formula> PSD95), trained by human rater i, performed comparably to the humans. (B) Rater agreement histogram. 100 individually-classified synaptic loci are scored according to the number of “yes” votes received among the five humans composing the gold standard consensus. Situations with unanimous agreement (0,5) make up half of the set (49 loci), with an additional 37 examples having only one dissenting opinion (1,4). (C) Receiver operating characteristics (ROC) curve, for VGluT1 and PSD95 classifications on human-rated data. The ROC curve describes the tradeoff between reducing false positives (left side of the curve) and maximizing true positives (right side of the curve). The displayed diagonal line represents chance, with better classifiers occupying large areas between the diagonal and their own curves.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002976.g004" position="float" xlink:type="simple"/>
          </fig>
        </sec>
      </sec>
      <sec id="s2g">
        <title>Classification Application</title>
        <sec id="s2g1">
          <title>Synapse class definition</title>
          <p>The use of a channel-based classification process allows us somewhat greater flexibility in the definition of synaptic classes. Our lab has years of experience in recognizing VGluT1-glutamatergic, VGluT2-glutamatergic and GABAergic synapses <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>, which compose the majority of synapses in the cortex, and all are defined by the presence of at least two specific markers, in addition to Synapsin I. For this paper we have also included a number of labels targeting synaptic populations for which we haven't found a robust label for a ubiquitous second protein. This includes VGluT3-positive synapses, cholinergic (vesicular acetylcholine transporter [VAChT]) and dopaminergic/noradrenergic (tyrosine hydroxylase [TH] positive) synapses. It is our intention to find such corroborating labels before these channels are used in a full experiment. Additionally, dopaminergic synapses have been reported not to express much of the Synapsin I/II isoforms, if they express them at all <xref ref-type="bibr" rid="pcbi.1002976-Bogen1">[25]</xref>. Since we are using a Synapsin I marker to discover putative synapse loci, those which are positive for TH may actually be identifying simple synaptic complexes - dopaminergic synapses adjoining those of another class.</p>
        </sec>
        <sec id="s2g2">
          <title>Cortical depth analysis</title>
          <p>One straightforward application of synapse-classified array tomography can be had via cytoarchitectonics, as seen in <xref ref-type="fig" rid="pcbi-1002976-g005">Figure 5</xref>. We first segregated the data into a number of synaptic classes, then subdivided those into 10 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e018" xlink:type="simple"/></inline-formula> bins stretching from the pial surface of the cortex to the striatum. We calculated the density of each bin's population, and averaged the Synapsin I local brightness feature to estimate the mean synapse size. Overall, the synaptic densities were nearly twice as high as expected in the literature <xref ref-type="bibr" rid="pcbi.1002976-Schz1">[26]</xref>, likely due to tissue shrinkage during dehydration and LR White embedding <xref ref-type="bibr" rid="pcbi.1002976-Lawton1">[27]</xref>. To be certain, we used erythrocyte diameter measurements to estimate the tissue shrinkage of this block at 56% (<xref ref-type="supplementary-material" rid="pcbi.1002976.s001">Figure S1</xref>).</p>
          <fig id="pcbi-1002976-g005" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002976.g005</object-id>
            <label>Figure 5</label>
            <caption>
              <title>Density and size of synapse classes as a function of depth through the cortex.</title>
              <p>(A) Synapse density through the cortex. * - VGluT2 synapse density peaks in layer IV. PV-positive GABAergic synapse density is slightly decreased in layer I, and significantly lacking in layer VI. (B) Synapse size estimated using the synapsin local brightness measurement. ** - VGluT1 size peaks in layer Va (p<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e019" xlink:type="simple"/></inline-formula>0.05).</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002976.g005" position="float" xlink:type="simple"/>
          </fig>
          <p>Although larger samples and higher sample sizes will be necessary for statistical certainty of novel phenomena, there are a few interesting known observations which help to validate the method used here. First, there is an increase in VGluT2-positive synapse density in layer IV, which we expected given the laminar characterization of VGluT2-expressing synapses <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>. Second, we notice a decrease in the density of parvalbumin-positive GABAergic synapses in layers I and VI, similar to <xref ref-type="bibr" rid="pcbi.1002976-Gonchar1">[28]</xref>. Finally, we find that VGluT1-positive synapses in layer 5a, though not more dense than elsewhere in the cortex, are somewhat larger.</p>
          <p>In order to gauge the repeatability of this analysis method we confirmed the most prominent of these effects, the spike in VGluT2-positive synapse density in layer IV, using data taken from a mouse whisker barrel (courtesy of Nicholas Weiler, unpublished). This is presented in <xref ref-type="supplementary-material" rid="pcbi.1002976.s002">Figure S2</xref>.</p>
        </sec>
        <sec id="s2g3">
          <title>Pairwise proteomic analysis</title>
          <p>Another promising possibility is the use of data sets classified in our per-channel fashion to search for unexpected proteomic combinations which may correspond to novel synaptic subsets, particularly of rare classes. In any volume, some background noise is to be expected: given the spatial distribution of synapses, it is inevitable that some synapses will have asynaptic puncta, or those belonging to nearby synapses, expressed in the region of analysis. Assuming that two classified markers have independent distributions, the expected number of loci in a volume which will be classified positive for both is the product of their probabilities, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e020" xlink:type="simple"/></inline-formula>. We can compare this with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e021" xlink:type="simple"/></inline-formula>, the number of colocalized loci actually found in the data set, and use a two-tailed binomial test to check for significance and reject stochastic noise as an explanation.</p>
          <p>For example, VGluT3 has previously been intimated to be present in a very small subset of cortical GABAergic synapses <xref ref-type="bibr" rid="pcbi.1002976-Fremeau1">[29]</xref>. Since we have labeled both GABAergic synapses and VGluT3 puncta in the course of classifying their respective categories, we can simply retain those GABAergic synapses which classed VGluT3-positive. A two-tailed binomial test can tell if the overlap we observe (82 synapses) is significantly different from that we would expect by multiplying the two class probabilities together (43 synapses). Those are small numbers in a data set of nearly a million classified synapses, but the difference between them is significant (p<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e022" xlink:type="simple"/></inline-formula>0.001).</p>
          <p>Using the nine classified channels in our present analysis, we ran binomial tests to calculate the normalized pairwise relationship between each of them. Our results are presented in <xref ref-type="fig" rid="pcbi-1002976-g006">Figure 6</xref>. The significant results match our expected relationships for the most part - GAD, VGAT, parvalbumin all colocalize, as do VGluT1/PSD95 and VGluT2/PSD95, and all three categories are mutually exclusionary. There are a few points of interest - as mentioned, VGluT3 colocalizes with all GABAergic channels and excludes itself from PSD95, corroborating the literature's suggestion of VGluT3 as a supporting neurotransmitter and not a primary glutamatergic synapse class on its own <xref ref-type="bibr" rid="pcbi.1002976-Fremeau2">[30]</xref>. Additionally, TH generally avoids both VGluT1 and VAChT, but shows positive copresence with VGluT2 (though this relationship disappears in the striatum).</p>
          <fig id="pcbi-1002976-g006" position="float">
            <object-id pub-id-type="doi">10.1371/journal.pcbi.1002976.g006</object-id>
            <label>Figure 6</label>
            <caption>
              <title>Positive and negative pairwise channel copresence.</title>
              <p>Symbols denote interesting comparisons with statistical significance of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e023" xlink:type="simple"/></inline-formula>. Red squares represent label pairs which are copresent more than expected, blue squares less than expected by chance. <bold>*</bold> - GABAergic markers are copresent with each other, but avoid glutamatergic and TH markers. <bold> ?</bold> - VGluT1/2 are copresent with PSD95, but not with each other. <bold>#</bold> - VGluT3 is present with all three GABAergic markers, but avoids VGluT1 and PSD95. &amp; - VGluT2 shows some presence with TH. <bold>∼</bold> - TH tends to avoid VAChT.</p>
            </caption>
            <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002976.g006" position="float" xlink:type="simple"/>
          </fig>
        </sec>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <sec id="s3a">
        <title>Synapse Class Discovery</title>
        <p>When we began the class discovery process as shown in <xref ref-type="fig" rid="pcbi-1002976-g006">Figure 6</xref>, we expected relationships based on our preconceived notions of a few synapse classes: that GAD, VGAT and parvalbumin should all be copresent to some extent <xref ref-type="bibr" rid="pcbi.1002976-Gonchar1">[28]</xref>, and that VGluT1 and VGluT2 should each colocalize with PSD95, but not with each other <xref ref-type="bibr" rid="pcbi.1002976-Fremeau3">[31]</xref>. Since the algorithm was partially developed with these relationships in mind, it is unsurprising that we found them.</p>
        <p>The other channels we examined, VGluT3, VAChT and TH, had fewer performance expectations, largely due to their paucity in the data set. Of the three, VGluT3 displayed the most interestingly unexpected behavior, avoiding the common glutamatergic markers and colocalizing instead with all GABAergic synaptic markers. This is most likely a rare but suspected role of VGluT3 in the cortex <xref ref-type="bibr" rid="pcbi.1002976-Fremeau2">[30]</xref>, co-expressed with GAD in a minor population of excitatory interneurons. If so, a followup experiment with larger volumes may be able to more effectively study this sparse population, but its detection given even a small number of examples lends us a degree of confidence that our analysis returns usable results sufficient to detect novel synaptic phenomena.</p>
        <p>Another interesting result with even fewer candidate synapses is a cortex-only localization of VGluT2 and TH. Dopaminergic (TH) neurons have been reported to express VGluT2 in rat cultures <xref ref-type="bibr" rid="pcbi.1002976-DalBo1">[32]</xref>, midbrain and hypothalamus <xref ref-type="bibr" rid="pcbi.1002976-Kawano1">[33]</xref>. It is possible that these are afferent projections from subthalamic nuclei, in which case their localization within the cortex and further proteomic differentiation would be interesting to examine in more detail. However, with current volume sizes we only find a dozen of these appositions, so at this time it would be problematic to assert certain confirmation of their existence, much less their distribution.</p>
      </sec>
      <sec id="s3b">
        <title>Human Consensus Formation</title>
        <p>The variance of human raters raises a few interesting questions to look into in the future. Two of the six raters (#2 and #6) self-reported using a stricter standard of classification than the rest: when an example was at all doubtful, they classified it as being negative. Effectively, these raters elected to position themselves on the left side of the ROC curve, trading an increase in false negatives for reduced false positives. Depending on the application, stricter classification may be preferable. We tested an example of this sort of premeditated error ourselves by training a number of MLAs with various classification criteria, and comparing their output. These results are presented in <xref ref-type="table" rid="pcbi-1002976-t003">Table 3</xref>. As one might expect, we found that a bit of bias in the training process could go a long way to reducing either Type I or II errors, at the cost of increasing the other, and that this effect is exaggerated when processing examples human raters find difficult.</p>
        <table-wrap id="pcbi-1002976-t003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002976.t003</object-id>
          <label>Table 3</label>
          <caption>
            <title>Estimated error rates for different training models.</title>
          </caption>
          <alternatives>
            <graphic id="pcbi-1002976-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002976.t003" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td colspan="3" align="left" rowspan="1">All Examples</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Strategy</td>
                  <td align="left" rowspan="1" colspan="1">False Positive</td>
                  <td align="left" rowspan="1" colspan="1">False Negative</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Normal</td>
                  <td align="left" rowspan="1" colspan="1">0.006</td>
                  <td align="left" rowspan="1" colspan="1">0.003</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Gullible</td>
                  <td align="left" rowspan="1" colspan="1">0.142</td>
                  <td align="left" rowspan="1" colspan="1">&lt;0.001</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Cynical</td>
                  <td align="left" rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="left" rowspan="1" colspan="1">0.212</td>
                </tr>
              </tbody>
            </table>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td colspan="3" align="left" rowspan="1">Easy Examples</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Strategy</td>
                  <td align="left" rowspan="1" colspan="1">False Positive</td>
                  <td align="left" rowspan="1" colspan="1">False Negative</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Normal</td>
                  <td align="left" rowspan="1" colspan="1">0.007</td>
                  <td align="left" rowspan="1" colspan="1">0.004</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Gullible</td>
                  <td align="left" rowspan="1" colspan="1">0.104</td>
                  <td align="left" rowspan="1" colspan="1">&lt;0.001</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Cynical</td>
                  <td align="left" rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="left" rowspan="1" colspan="1">0.146</td>
                </tr>
              </tbody>
            </table>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td colspan="3" align="left" rowspan="1">Hard Examples</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Strategy</td>
                  <td align="left" rowspan="1" colspan="1">False Positive</td>
                  <td align="left" rowspan="1" colspan="1">False Negative</td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Normal</td>
                  <td align="left" rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="left" rowspan="1" colspan="1">0.001</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Gullible</td>
                  <td align="left" rowspan="1" colspan="1">0.250</td>
                  <td align="left" rowspan="1" colspan="1">&lt;0.001</td>
                </tr>
                <tr>
                  <td align="left" rowspan="1" colspan="1">Cynical</td>
                  <td align="left" rowspan="1" colspan="1">&lt;0.001</td>
                  <td align="left" rowspan="1" colspan="1">0.398</td>
                </tr>
              </tbody>
            </table>
          </alternatives>
          <table-wrap-foot>
            <fn id="nt103">
              <label/>
              <p>Type I and II error breakdown for various training regimes. (Top) Classifiers trained with varying approaches to handling ambiguous cases can be effectively positioned along their ROC curve. (Bottom) When data is further broken into easy and hard cases, easy examples see moderately increased agreement and hard examples see more disagreement, resembling the human agreement histogram of <xref ref-type="fig" rid="pcbi-1002976-g004">Figure 4</xref>.</p>
            </fn>
          </table-wrap-foot>
        </table-wrap>
        <p>Based on our experiences, we would recommend taking time to discuss questionable examples and reasons for rating them one way or another. Such conversations are rather illuminating and very effective at getting everyone to agree on a common standard of classification.</p>
      </sec>
      <sec id="s3c">
        <title>Limitations and Future Work</title>
        <p>There are two significant limitations to the questions which can be asked using this method. The first and strictest: an array tomography volume is a decidedly terminal snapshot of a piece of tissue. This precludes experiments which would watch a particular cell or dendrite change over time, or in response to learning <xref ref-type="bibr" rid="pcbi.1002976-Fu1">[34]</xref>, except in animal models which are stereotyped enough for different animals to have equivalent nervous systems, namely C. Elegans <xref ref-type="bibr" rid="pcbi.1002976-White1">[35]</xref> and Drosophila <xref ref-type="bibr" rid="pcbi.1002976-Cardona1">[36]</xref>. Synapse populations are assumed to be fairly invariant between individual mice (and presumably humans), however, which allows us to study changes to synaptic classes as a whole in response to plasticity or disease.</p>
        <p>The second limitation is more easily rectified. Our analysis partially depends on limiting the scope of the problem to that required to identify synapses at locations already suspected to contain a synapse. For common synapse classes this is easy. They all express Synapsin I, so wherever we find our Synapsin I marker, there may be a synapse. As mentioned, we have already begun to abut the usefulness of Synapsin I, which may not be expressed in dopaminergic synapses <xref ref-type="bibr" rid="pcbi.1002976-Bogen1">[25]</xref>. Using a pan-Synapsin antibody would be a straightforward solution to catching all dopaminergic synapses, but it is fully possible that other, more exotic synapse types may not express Synapsin at all, instead relying on some currently unknown mechanism to perform the same function.</p>
        <p>Establishing a robust system for synapse classification in array tomographic volumes opens up a number of avenues for addressing biological questions. It allows us to conduct single-synapse analyses in large regions of tissue, which lets us study rare or spatially-segregated populations. It helps us discover new synaptic populations and novel variations on known synapse types, and gives us an unprecedented level of control over the proteomic complexity we can bring to bear.</p>
      </sec>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>Acquisition of Array Tomographic Volume</title>
        <p>All procedures related to the care and treatment of animals were approved by the Administrative Panel on Laboratory Animal Care at Stanford University. All volumes were acquired from mouse cortex, line C57BL/6J, using the methodology given in <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>.</p>
        <p>One adult mouse was used for this study. The animal was anesthetized by halothane inhalation and its brain quickly removed and placed in 4% formaldehyde and 2.5% sucrose in phosphate-buffered saline (PBS) at room temperature. Its cerebral hemisphere was sliced coronally into three pieces and fixed and embedded using rapid microwave irradiation (PELCO 3451 laboratory microwave system with ColdSpot; Ted Pella, Redding CA) as described in <xref ref-type="bibr" rid="pcbi.1002976-Micheva2">[37]</xref>. The tissue was dehydrated up to 70% ethanol.</p>
        <p>Ribbons of serial ultrathin (70 nm) sections were cut with an ultramicrotome (EM UC6, Leica Microsystems, Wetzlar, Germany) as described in <xref ref-type="bibr" rid="pcbi.1002976-Micheva2">[37]</xref>. The ribbons were mounted on subbed coverslips (coated with 0.5% gelatin and 0.05% chromium potassium sulfate) and placed on a hot plate (60 C) for 30 min. For SEM imaging, the subbed coverslips were also carbon coated using a Denton Bench Top Turbo Carbon Evaporator (Denton Vacuum, Moorestown, NJ). Subbed and carbon coated coverslips were also prepared for mounting ribbons of sections to be used for multiple immunostaining rounds (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e024" xlink:type="simple"/></inline-formula>6).</p>
        <p>Staining was performed as described in <xref ref-type="bibr" rid="pcbi.1002976-Micheva2">[37]</xref>. The coverslips with sections were mounted using SlowFade Gold antifade with DAPI (Invitrogen, Carlsbad CA). To elute the applied antibodies, the mounting medium was washed away with dH2O and a solution of 0.2 M NaOH and 0.02% SDS in distilled water was applied for 20 min. After an extensive wash with Tris buffer and distilled water, the coverslips were dried and placed on a hot plate (60C) for 30 min.</p>
        <p>The primary antibodies and their dilutions are listed in <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>, <xref ref-type="table" rid="pcbi-1002976-t001">Table 1</xref>. Only well characterized commercial antibodies were used and they were evaluated specifically for AT as described in the Supplemental Experimental Procedures of <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>. For immunofluorescence, Alexa Fluor 488, 594, and 647 secondary antibodies of the appropriate species, highly preadsorbed (Invitrogen, Carlsbad CA) were used at a dilution 1∶150. The sequence of antibody application in the multiround staining is presented in <xref ref-type="bibr" rid="pcbi.1002976-Micheva1">[17]</xref>, Table S1.</p>
        <p>Sections were imaged on a Zeiss Axio Imager.Z1 Upright Fluorescence Microscope with motorized stage and Axiocam HR Digital Camera as described in <xref ref-type="bibr" rid="pcbi.1002976-Micheva2">[37]</xref>. Briefly, a tiled image of the entire ribbon of sections on a coverslip was obtained using a 10 objective and the MosaiX feature of the software. The region of interest was then identified on each section with custom-made software and imaged at a higher magnification with a Zeiss 63/1.4 NA Plan Apochromat objective, using the image-based automatic focus capability of the software. The resulting stack of images was exported to ImageJ, aligned using the MultiStackReg plugin and imported back into the Axiovision software to generate a volume rendering. When a ribbon was stained and imaged multiple times, the MultiStackReg plugin was used to register the stacks generated from each successive imaging session with the first session stacks based on the DAPI channel, then a second within-stack alignment was applied to all the stacks. Since DAPI was stained in all imaging sessions it made an ideal candidate for alignment, and the alignment transformation of each imaging session's DAPI channel was propagated to the other members of that session to bring the entire channel set into the same coordinate space.</p>
        <p>To reconstruct the larger volume of tissue used in this study, we first used Zeiss Axiovision software to stitch together individual high-magnification image tiles and produce a single mosaic image of each antibody stain for each serial section in the ribbon, creating a z stack of mosaic images for each fluorescence channel instead of a single field of view stack. To coarsely align the image stacks, we used the MultiStackReg plugin with the DAPI channel, as described above and in <xref ref-type="bibr" rid="pcbi.1002976-Micheva2">[37]</xref>.</p>
        <p>To analyze synapse-level structures an additional alignment step was needed to remove a minor non-linear physical warping introduced into the ribbons by the sectioning process. We used a second ImageJ plugin, autobUnwarpJ (available at <ext-link ext-link-type="uri" xlink:href="http://www.stanford.edu/~nweiler" xlink:type="simple">http://www.stanford.edu/~nweiler</ext-link>), which adapts an algorithm for elastic image registration using vector-spline regularization <xref ref-type="bibr" rid="pcbi.1002976-ArgandaCarreras1">[38]</xref>. As before, we aligned only a single channel, Synapsin, and propagated the generated transformation to the other channels. Synapsin proved ideal for this purpose because it is a dense, high-frequency channel whose labeled objects are still considerably thicker than a single section, creating good fiducial markers for the alignment process.</p>
        <p>Finally, data used for <xref ref-type="table" rid="pcbi-1002976-t003">Table 3</xref> and <xref ref-type="supplementary-material" rid="pcbi.1002976.s002">Figure S2</xref> were processed after imaging using a method of deconvolution recently published by our lab <xref ref-type="bibr" rid="pcbi.1002976-Wang1">[39]</xref>. This does not seem to affect MLA performance, but the smaller, more discrete puncta do cause an increase in the number of synapsin local maxima, and therefore generates more extracted synapsin loci. Future work using deconvolved volumes may benefit from incorporating an additional filtering step in the extraction process to either smooth the data before finding local maxima or segment puncta more directly.</p>
      </sec>
      <sec id="s4b">
        <title>Normalization and Background Subtraction of Volumetric Data</title>
        <p>Before analyzing imaged volumes, we subtracted the background from each fluorescent channel using a 10×10 pixel (1 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e025" xlink:type="simple"/></inline-formula>) rolling ball filter to remove systematic non-punctate background fluorescence, then normalized each slice of the stack without saturating any pixels, such that the brightness histogram of each section was stretched as much as possible without loss of information. No other image processing, including removal of fluorescence due to foreign material, nonspecific staining, etc, was performed before analysis.</p>
      </sec>
      <sec id="s4c">
        <title>Extraction of Synaptic Loci</title>
        <p>To extract a list of putative synapse locations from raw volume data, we first identified individual synapsin puncta by convolving the synapsin channel with a 3×3×3 local maxima filter; retaining all voxels with a brightness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e026" xlink:type="simple"/></inline-formula> those of its 26-voxel neighborhood. Then, we passed the synapsin maxima through a connected component filter to reduce peak voxel clumps (caused by discretization of the fluorescence data) to centroids, and discarded those below a deliberately low threshold (10% of the total brightness range) as being too dim to represent a real synapse. What remained was a list of putative synapse locations, or “synaptic loci,” so named for their central role in later classification steps.</p>
      </sec>
      <sec id="s4d">
        <title>Estimating Human Rater Agreement</title>
        <p>In order to gauge the reliability of any single human expert's rating, we performed a qualitative test of the consistency of human classification. We presented a set of one hundred randomly-selected synaptograms to a group of six human raters who were familiar with the task of interpreting synaptograms, and instructed them to classify the set based on whether or not the synaptogram was centered on a glutamatergic synapse. Once collated, we considered the true classification of a given synaptogram to be that of a simple majority vote of the first five raters (to prevent ties). When we compared each rater's performance relative to the average, we found an average accuracy rate of 77.7%, with a standard deviation of 10.1% (<xref ref-type="fig" rid="pcbi-1002976-g004">Figure 4</xref>). The largest source of variance arose from the self-reported stringency of the raters, in how much ambiguity they found acceptable when classifying a locus as positive.</p>
      </sec>
      <sec id="s4e">
        <title>Estimating MLA Agreement</title>
        <p>To test the influence that training stringency and classification difficulty have on MLA performance, we repeated the above test with three classifiers trained by rater 1. In addition to the classifier trained with the default strategy, classifiers that would attempt to guess “yes” or “no” in ambiguous cases were trained and their mutual performance compared, using their average agreement to establish a gold standard as was the case for the humans. We also subdivided the data set further into “easy” versus “hard” cases through the use of a fourth MLA, and compared those conditions as well.</p>
      </sec>
      <sec id="s4f">
        <title>PCA Image Treatment</title>
        <p>The color of each point in the PCA figure was determined by taking the extreme outliers of the three clusters, determining their feature composition via multivariate regression, taking the dot product of the feature weight vectors with the feature vector of each locus, and assigning that to red, green or blue for the VGluT1, VGluT2, and GABA clusters respectively. Colors were manually normalized to be of approximately equal intensity, and synaptic loci not strongly represented in any of the three colors were removed to better visualize cluster relationship.</p>
      </sec>
      <sec id="s4g">
        <title>MLA Training Strategy</title>
        <p>The training of our machine learning algorithm differs from standard supervised learning, in which training examples are chosen at random, by instead selecting examples which together compose a varied training set. We also added a preprocessing step to facilitate the training of very rare classes, on our case VAchT and VGluT3. Thus the training set generation occurs in two phases. The first phase is to “prime” the training set data for rare classes by choosing one of each class's requisite presynaptic channels and randomly sampling a subset from the loci for which the channel's local brightness is more than two standard deviations above the mean. A number of class subsets generated in this manner are collated, each class contributing to the negative examples of the rest. The second phase is an “active” training process in which a human rater and the MLA being trained work in tandem to speed training, a technique known as active learning <xref ref-type="bibr" rid="pcbi.1002976-Cohn1">[40]</xref>, <xref ref-type="bibr" rid="pcbi.1002976-Settles1">[41]</xref>. At each step, the half-trained classifier selects a few examples, half of which it thinks are positive and half negative, to present to the rater for verification and feedback.</p>
        <p>In pseudocode, the training proceeds according to the following algorithm:</p>
        <p><bold>while</bold> Human wishes to train <bold>do</bold></p>
        <p> Load training synaptogram population, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e027" xlink:type="simple"/></inline-formula></p>
        <p> Human selects a synaptic category</p>
        <p> Train RFE using partially classified training set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e028" xlink:type="simple"/></inline-formula>, display predicted error rate</p>
        <p> <bold>while</bold> Human wishes to add training examples <bold>do</bold></p>
        <p>  Randomly choose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e029" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e030" xlink:type="simple"/></inline-formula></p>
        <p>  Randomly choose a synaptogram <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e031" xlink:type="simple"/></inline-formula> from subpopulation <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e032" xlink:type="simple"/></inline-formula>, the elements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e033" xlink:type="simple"/></inline-formula> classified as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e034" xlink:type="simple"/></inline-formula></p>
        <p>  Display <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e035" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e036" xlink:type="simple"/></inline-formula> to human for verification</p>
        <p>  Add/Update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e037" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e038" xlink:type="simple"/></inline-formula> to reflect human input</p>
        <p>
          <bold>end while</bold>
        </p>
        <p>
          <bold>end while</bold>
        </p>
      </sec>
      <sec id="s4h">
        <title>Normalization of Pairwise Channel Data</title>
        <p>To produce the pairwise channel copresence map, for each marker pair <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e039" xlink:type="simple"/></inline-formula> we calculated the probability of co-occurrence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e040" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e041" xlink:type="simple"/></inline-formula> is the number of loci found to be positive for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e042" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e043" xlink:type="simple"/></inline-formula> is the number of total loci in the population. Multiplying by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e044" xlink:type="simple"/></inline-formula> gives us the expected population, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e045" xlink:type="simple"/></inline-formula>. We compared this number with the observed population <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e046" xlink:type="simple"/></inline-formula> using difference over sum normalization to find the normalized pairwise relationship <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e047" xlink:type="simple"/></inline-formula>. These relationships made pairwise comparisons easy to interpret, with one minor counter-intuitive exception: markers which comprised a substantial proportion of the synaptic loci population (VGluT1 and PSD95) had reduced values, even with themselves, owing to their high <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e048" xlink:type="simple"/></inline-formula>. To bring those into the same reference frame as the rest, we normalized again using the reciprocal of the sum of the relationship identity reciprocals, that is, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e049" xlink:type="simple"/></inline-formula>. Finally, since the previous step disrupted negative relationship scaling such that the most negative pairs (VGluT1 vs GABAergic markers) reached nearly −3.0, we multiplied the positive ratings by 3 to match once more.</p>
      </sec>
      <sec id="s4i">
        <title>Perpendicularization of Cortical Data</title>
        <p>To simplify the calculation of the cortical depth-dependent metrics used in <xref ref-type="fig" rid="pcbi-1002976-g005">Figure 5</xref>, such that any given Y-value represented tissue at the same cortical depth, we needed to correct a minor slant in the raw volume. We measured the degree of tissue slope using the pial surface and the white matter/striatum boundary, and imposed an affine transformation on the loci, linearly interpolating them to be level. The underlying data and the features used to classify the loci were not changed as a result of this process.</p>
      </sec>
      <sec id="s4j">
        <title>Software Packages Used</title>
        <p>Image normalization, locus discovery and feature extraction were implemented and performed using Fiji (<ext-link ext-link-type="uri" xlink:href="http://fiji.sc/" xlink:type="simple">http://fiji.sc/</ext-link>). Training set generation was implemented as a browser-based application, coded in Python, to permit our experts to work at their leisure. We used R for interactive classification for its ease of Python integration, but the final random forest classifiers, trained on the complete training set alone, used MATLAB (the TreeBagger class). Imaris was used to render the data for visualization of <xref ref-type="fig" rid="pcbi-1002976-g001">Figure 1</xref>.</p>
        <p>All implemented code used in this analysis is available at <ext-link ext-link-type="uri" xlink:href="http://code.google.com/p/smithlabsoftware/" xlink:type="simple">http://code.google.com/p/smithlabsoftware/</ext-link> under a GPL v3 license.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002976.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002976.s001" position="float" xlink:type="simple">
        <label>Figure S1</label>
        <caption>
          <p><bold>Erythrocyte diameter as indicator of tissue shrinkage.</bold> (A) A single 200 nm section from the same block of prepared tissue as the full cortical depth analysis, displaying autofluorescent red blood cells with a maximum diameter of 4.6 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e050" xlink:type="simple"/></inline-formula> (arrows). (B) Fresh erythrocytes have a diameter of 6 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e051" xlink:type="simple"/></inline-formula> (arrows), indicating a linear shrinkage of 23% and a volumetric shrinkage of 54% as a side effect of tissue dehydration. Scale bar 2 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e052" xlink:type="simple"/></inline-formula>.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002976.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1002976.s002" position="float" xlink:type="simple">
        <label>Figure S2</label>
        <caption>
          <p><bold>Layer 3/4 VGluT2+ synapse distribution.</bold> Processed in the same manner as the full depth analysis of <xref ref-type="fig" rid="pcbi-1002976-g005">Figure 5</xref>, VgluT2+ synapses display a similar peak density at the boundary between layer 3 and 4. The two populations, shown here separately for clarity, were taken from adjacent fields of view with an approximately 10% overlap. Each bin represents 10 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002976.e053" xlink:type="simple"/></inline-formula> of cortical depth.</p>
          <p>(TIF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>We would like to acknowledge Kristina Micheva and Nancy O'Rourke for their technical support and aid in manuscript drafting, Kristina Micheva again for erythrocyte imaging, Nicolas Weiler for providing data used for revisions, and also Gordon Wang, Rachel Nosheny and Nafisa Ghouri for their advice and classification assistance.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002976-Grant1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grant</surname><given-names>S</given-names></name> (<year>2007</year>) <article-title>Toward a molecular catalogue of synapses</article-title>. <source>Brain research reviews</source> <volume>55</volume>: <fpage>445</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Sheng1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sheng</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hoogenraad</surname><given-names>C</given-names></name> (<year>2007</year>) <article-title>The postsynaptic architecture of excitatory synapses: a more quantitative view</article-title>. <source>Annual review of biochemistry</source> <volume>76</volume>: <fpage>823</fpage>–<lpage>47</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-SassoPognetto1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sassoè-Pognetto</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Frola</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Pregno</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Briatore</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Patrizi</surname><given-names>A</given-names></name> (<year>2011</year>) <article-title>Understanding the molecular diversity of gabaergic synapses</article-title>. <source>Frontiers in cellular neuroscience</source> <volume>5</volume>: <fpage>4</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Lein1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lein</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Hawrylycz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ao</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Ayres</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bensinger</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Genome-wide atlas of gene expression in the adult mouse brain</article-title>. <source>Nature</source> <volume>445</volume>: <fpage>168</fpage>–<lpage>76</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-ORourke1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O'Rourke</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Weiler</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Micheva</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>SJ</given-names></name> (<year>2012</year>) <article-title>Deep molecular diversity of mammalian synapses: why it matters and how to measure it</article-title>. <source>Nature Reviews Neuroscience</source> <volume>13</volume>: <fpage>365</fpage>–<lpage>79</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Turrigiano1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turrigiano</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Nelson</surname><given-names>S</given-names></name> (<year>2004</year>) <article-title>Homeostatic plasticity in the developing nervous system</article-title>. <source>Nature reviews Neuroscience</source> <volume>5</volume>: <fpage>97</fpage>–<lpage>107</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Citri1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Citri</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Malenka</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Synaptic plasticity: multiple forms, functions, and mechanisms</article-title>. <source>Neuropsychopharmacology: official publication of the American College of Neuropsychopharmacology</source> <volume>33</volume>: <fpage>18</fpage>–<lpage>41</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Garner1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garner</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Zhai</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gundelfinger</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Ziv</surname><given-names>N</given-names></name> (<year>2002</year>) <article-title>Molecular mechanisms of cns synaptogenesis</article-title>. <source>Trends in neurosciences</source> <volume>25</volume>: <fpage>243</fpage>–<lpage>51</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Hioki1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hioki</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Fujiyama</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Nakamura</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Matsuda</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Chemically specific circuit composed of vesicular glutamate transporter 3- and preprotachykinin b-producing interneurons in the rat neocortex</article-title>. <source>Cerebral cortex (New York, NY : 1991)</source> <volume>14</volume>: <fpage>1266</fpage>–<lpage>75</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Gutirrez1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gutiérrez</surname><given-names>R</given-names></name> (<year>2005</year>) <article-title>The dual glutamatergic-gabaergic phenotype of hippocampal granule cells</article-title>. <source>Trends in neurosciences</source> <volume>28</volume>: <fpage>297</fpage>–<lpage>303</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Briggman1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Briggman</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Helmstaedter</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Denk</surname><given-names>W</given-names></name> (<year>2011</year>) <article-title>Wiring specificity in the direction-selectivity circuit of the retina</article-title>. <source>Nature</source> <volume>471</volume>: <fpage>183</fpage>–<lpage>8</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Anderson1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Watt</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Shaw</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Exploring the retinal connectome</article-title>. <source>Molecular vision</source> <volume>17</volume>: <fpage>355</fpage>–<lpage>79</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Li1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Tasic</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Micheva</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Ivanov</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Spletter</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Visualizing the distribution of synapses from individual neurons in the mouse brain</article-title>. <source>PloS one</source> <volume>5</volume>: <fpage>e11503</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Kuhlman1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kuhlman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>Z</given-names></name> (<year>2008</year>) <article-title>High-resolution labeling and functional manipulation of specific neuron types in mouse brain by cre-activated viral gene expression</article-title>. <source>PloS one</source> <volume>3</volume>: <fpage>e2005</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Katz1">
        <label>15</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katz</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Menon</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Nicholson</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Geinisman</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Kath</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Synapse distribution suggests a two-stage model of dendritic integration in ca1 pyramidal neurons</article-title>. <source>Neuron</source> <volume>63</volume>: <fpage>171</fpage>–<lpage>7</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Davie1">
        <label>16</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Davie</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Clark</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Husser</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>The origin of the complex spike in cerebellar purkinje cells</article-title>. <source>The Journal of neuroscience : the official journal of the Society for Neuroscience</source> <volume>28</volume>: <fpage>7599</fpage>–<lpage>609</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Micheva1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Micheva</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Busse</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Weiler</surname><given-names>N</given-names></name>, <name name-style="western"><surname>O'Rourke</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Single-synapse analysis of a diverse synapse population: proteomic imaging methods and markers</article-title>. <source>Neuron</source> <volume>68</volume>: <fpage>639</fpage>–<lpage>53</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Bays1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bayés</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Grant</surname><given-names>S</given-names></name> (<year>2009</year>) <article-title>Neuroproteomics: understanding the molecular organization and complexity of the brain</article-title>. <source>Nature reviews Neuroscience</source> <volume>10</volume>: <fpage>635</fpage>–<lpage>46</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Dani1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dani</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Bergan</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Dulac</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Zhuang</surname><given-names>X</given-names></name> (<year>2010</year>) <article-title>Superresolution imaging of chemical synapses in the brain</article-title>. <source>Neuron</source> <volume>68</volume>: <fpage>843</fpage>–<lpage>56</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-DeCamilli1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>De Camilli</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Cameron</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Greengard</surname><given-names>P</given-names></name> (<year>1983</year>) <article-title>Synapsin 1 (protein 1), a nerve terminal-specific phosphoprotein</article-title>. <source>Journal of Cell Biology</source> <volume>96</volume>: <fpage>1337</fpage>–<lpage>1354</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Evans1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Evans</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Facci</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Owen</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Soden</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Burbidge</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Abeta(1–42) reduces synapse number and inhibits neurite outgrowth in primary cortical and hippocampal neurons: a quantitative analysis</article-title>. <source>Journal of neuroscience methods</source> <volume>175</volume>: <fpage>96</fpage>–<lpage>103</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Jackson1">
        <label>22</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jackson</surname><given-names>JE</given-names></name> (<year>1991</year>) <article-title>A User's Guide to Principal Components</article-title>. <source>John Wiley and Sons</source></mixed-citation>
      </ref>
      <ref id="pcbi.1002976-BelkacemBoussaid1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Belkacem-Boussaid</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Pennell</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lozanski</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Shana'ah</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Gurcan</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Computer-aided classification of centroblast cells in follicular lymphoma</article-title>. <source>Analytical and quantitative cytology and histology/the International Academy of Cytology [and] American Society of Cytology</source> <volume>32</volume>: <fpage>254</fpage>–<lpage>260</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Breiman1">
        <label>24</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Breiman</surname><given-names>L</given-names></name> (<year>2001</year>) <article-title>Random forests</article-title>. <source>Machine Learning</source> <volume>45</volume>: <fpage>5</fpage>–<lpage>3-2</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Bogen1">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bogen</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Boulland</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Mariussen</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Wright</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Fonnum</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Absence of synapsin I and ii is accompanied by decreases in vesicular transport of specific neurotransmitters</article-title>. <source>Journal of neurochemistry</source> <volume>96</volume>: <fpage>1458</fpage>–<lpage>66</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Schz1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schüz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Palm</surname><given-names>G</given-names></name> (<year>1989</year>) <article-title>Density of neurons and synapses in the cerebral cortex of the mouse</article-title>. <source>The Journal of comparative neurology</source> <volume>286</volume>: <fpage>442</fpage>–<lpage>55</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Lawton1">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lawton</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Oswald</surname><given-names>W</given-names></name>, <name name-style="western"><surname>McClure</surname><given-names>J</given-names></name> (<year>1995</year>) <article-title>The biological reality of the interlacunar network in the embryonic, cartilaginous, skeleton: a thiazine dye/absolute ethanol/lr white resin protocol for visualizing the network with minimal tissue shrinkage</article-title>. <source>Journal of microscopy</source> <volume>178</volume>: <fpage>66</fpage>–<lpage>85</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Gonchar1">
        <label>28</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gonchar</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Burkhalter</surname><given-names>A</given-names></name> (<year>2007</year>) <article-title>Multiple distinct subtypes of gabaergic neurons in mouse visual cortex identified by triple immunostaining</article-title>. <source>Frontiers in neuroanatomy</source> <volume>1</volume>: <fpage>3</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Fremeau1">
        <label>29</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fremeau</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Burman</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Qureshi</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Tran</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Proctor</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>The identification of vesicular glutamate transporter 3 suggests novel modes of signaling by glutamate</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>99</volume>: <fpage>14488</fpage>–<lpage>93</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Fremeau2">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fremeau</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Voglmaier</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Seal</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Edwards</surname><given-names>R</given-names></name> (<year>2004</year>) <article-title>Vgluts define subsets of excitatory neurons and suggest novel roles for glutamate</article-title>. <source>Trends in neurosciences</source> <volume>27</volume>: <fpage>98</fpage>–<lpage>103</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Fremeau3">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fremeau</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kam</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Qureshi</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Copenhagen</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Vesicular glutamate transporters 1 and 2 target to functionally distinct synaptic release sites</article-title>. <source>Science (New York, NY)</source> <volume>304</volume>: <fpage>1815</fpage>–<lpage>9</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-DalBo1">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dal Bo</surname><given-names>G</given-names></name>, <name name-style="western"><surname>St-Gelais</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Danik</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Cotton</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Dopamine neurons in culture express vglut2 explaining their capacity to release glutamate at synapses in addition to dopamine</article-title>. <source>Journal of neurochemistry</source> <volume>88</volume>: <fpage>1398</fpage>–<lpage>405</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Kawano1">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kawano</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kawasaki</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sakata-Haga</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Fukui</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Kawano</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Particular subpopulations of midbrain and hypothalamic dopamine neurons express vesicular glutamate transporter 2 in the rat brain</article-title>. <source>The Journal of comparative neurology</source> <volume>498</volume>: <fpage>581</fpage>–<lpage>92</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Fu1">
        <label>34</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Zuo</surname><given-names>Y</given-names></name> (<year>2011</year>) <article-title>Experience-dependent structural plasticity in the cortex</article-title>. <source>Trends in neurosciences</source> <volume>34</volume>: <fpage>177</fpage>–<lpage>87</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-White1">
        <label>35</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Southgate</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Thomson</surname><given-names>JN</given-names></name>, <name name-style="western"><surname>Brenner</surname><given-names>S</given-names></name> (<year>1986</year>) <article-title>The structure of the nervous system of the nematode caenorhabditis elegans</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>314</volume>: <fpage>1</fpage>–<lpage>340</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Cardona1">
        <label>36</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cardona</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Saalfeld</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Arganda</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Pereanu</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Schindelin</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Identifying neuronal lineages of drosophila by sequence analysis of axon tracts</article-title>. <source>The Journal of neuroscience: the official journal of the Society for Neuroscience</source> <volume>30</volume>: <fpage>7538</fpage>–<lpage>53</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Micheva2">
        <label>37</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Micheva</surname><given-names>K</given-names></name>, <name name-style="western"><surname>O'Rourke</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Busse</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Array tomography: high-resolution threedimensional immunouorescence</article-title>. <source>Cold Spring Harbor protocols</source> <volume>2010</volume>: <fpage>pdb.top89</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-ArgandaCarreras1">
        <label>38</label>
        <mixed-citation publication-type="other" xlink:type="simple">Arganda-Carreras I, Sorzano C, Marabini R, Carazo J, Ortiz-de Solorzano C, <etal>et al</etal>.. (2006) Consistent and elastic registration of histological sections using vector-spline regularization. Springer. 85–95 pp.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Wang1">
        <label>39</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>S</given-names></name> (<year>2012</year>) <article-title>Sub-diffraction limit localization of proteins in volumetric space using bayesian restoration of uorescence images from ultrathin specimens</article-title>. <source>PLoS computational biology</source> <volume>8</volume>: <fpage>e1002671</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Cohn1">
        <label>40</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cohn</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ghahramani</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Jordan</surname><given-names>M</given-names></name> (<year>1996</year>) <article-title>Active learning with statistical models</article-title>. <source>Journal of Artificial Intelligence</source> <volume>4</volume>: <fpage>129</fpage>–<lpage>145</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002976-Settles1">
        <label>41</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Settles</surname><given-names>B</given-names></name> (<year>2009</year>) <article-title>Active learning literature survey. Computer Sciences Technical Report 1648</article-title>. <source>University of Wisconsin–Madison</source></mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>