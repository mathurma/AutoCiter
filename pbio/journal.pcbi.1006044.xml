<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01733</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006044</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Flight (biology)</subject><subj-group><subject>Bird flight</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Flight (biology)</subject><subj-group><subject>Bird flight</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Zoology</subject><subj-group><subject>Ornithology</subject><subj-group><subject>Bird flight</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Zoology</subject><subj-group><subject>Animal anatomy</subject><subj-group><subject>Wings</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Community ecology</subject><subj-group><subject>Trophic interactions</subject><subj-group><subject>Predation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Community ecology</subject><subj-group><subject>Trophic interactions</subject><subj-group><subject>Predation</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Acceleration</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Flight (biology)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Biological locomotion</subject><subj-group><subject>Flight (biology)</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Birds</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Eukaryota</subject><subj-group><subject>Animals</subject><subj-group><subject>Vertebrates</subject><subj-group><subject>Amniotes</subject><subj-group><subject>Birds</subject><subj-group><subject>Starlings</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Classical mechanics</subject><subj-group><subject>Dynamics</subject><subj-group><subject>Aerodynamics</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Physics-based simulations of aerial attacks by peregrine falcons reveal that stooping at high speed maximizes catch success against agile prey</article-title>
<alt-title alt-title-type="running-head">Stooping by peregrine falcons: A physics-based simulation</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4457-2855</contrib-id>
<name name-style="western">
<surname>Mills</surname> <given-names>Robin</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hildenbrandt</surname> <given-names>Hanno</given-names></name>
<role content-type="http://credit.casrai.org/">Software</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Taylor</surname> <given-names>Graham K.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Hemelrijk</surname> <given-names>Charlotte K.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Groningen Institute for Evolutionary Life Sciences, University of Groningen, Groningen, Groningen, Netherlands</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Zoology, University of Oxford, Oxford, Oxfordshire, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Ayers</surname> <given-names>Joseph</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Northeastern University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">r.mills@rug.nl</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>12</day>
<month>4</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>4</issue>
<elocation-id>e1006044</elocation-id>
<history>
<date date-type="received">
<day>17</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>15</day>
<month>2</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Mills et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006044"/>
<abstract>
<p>The peregrine falcon <italic>Falco peregrinus</italic> is renowned for attacking its prey from high altitude in a fast controlled dive called a stoop. Many other raptors employ a similar mode of attack, but the functional benefits of stooping remain obscure. Here we investigate whether, when, and why stooping promotes catch success, using a three-dimensional, agent-based modeling approach to simulate attacks of falcons on aerial prey. We simulate avian flapping and gliding flight using an analytical quasi-steady model of the aerodynamic forces and moments, parametrized by empirical measurements of flight morphology. The model-birds’ flight control inputs are commanded by their guidance system, comprising a phenomenological model of its vision, guidance, and control. To intercept its prey, model-falcons use the same guidance law as missiles (pure proportional navigation); this assumption is corroborated by empirical data on peregrine falcons hunting lures. We parametrically vary the falcon’s starting position relative to its prey, together with the feedback gain of its guidance loop, under differing assumptions regarding its errors and delay in vision and control, and for three different patterns of prey motion. We find that, when the prey maneuvers erratically, high-altitude stoops increase catch success compared to low-altitude attacks, but only if the falcon’s guidance law is appropriately tuned, and only given a high degree of precision in vision and control. Remarkably, the optimal tuning of the guidance law in our simulations coincides closely with what has been observed empirically in peregrines. High-altitude stoops are shown to be beneficial because their high airspeed enables production of higher aerodynamic forces for maneuvering, and facilitates higher roll agility as the wings are tucked, each of which is essential to catching maneuvering prey at realistic response delays.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Peregrine falcons are famed for their high-speed, high-altitude stoops. Hunting prey at perhaps the highest speed of any animal places a stooping falcon under extraordinary physical, physiological, and cognitive demands, yet it remains unknown how this behavioural strategy promotes catch success. Because the behavioral aspects of stooping are intimately related to its biomechanical constraints, we address this question through an embodied cognition approach. We model the falcon’s cognition using guidance laws inspired by theory and experiment, and embody this in a physics-based simulation of predator and prey flight. Stooping maximizes catch success against agile prey by minimizing roll inertia and maximizing the aerodynamic forces available for maneuvering, but requires a tightly tuned guidance law, and exquisitely precise vision and control.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100010663</institution-id>
<institution>H2020 European Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>682501</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Taylor</surname> <given-names>Graham Keith</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003246</institution-id>
<institution>Nederlandse Organisatie voor Wetenschappelijk Onderzoek</institution>
</institution-wrap>
</funding-source>
<award-id>823.01.017</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Hemelrijk</surname> <given-names>Charlotte K</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>Dr. J.L. Dobberke Foundation</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4457-2855</contrib-id>
<name name-style="western">
<surname>Mills</surname> <given-names>Robin</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>The project grant for the PhD position of Robin Mills was provided by Nederlandse Organisatie voor Wetenschappelijk Onderzoek (NWO; file 823.01.017) to CKH. This project has received funding from the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (grant agreement No 682501) to GKT. Funding for research exchange has been provided by the Dobberke foundation. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="5"/>
<page-count count="38"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Data, code, and analysis scripts are available publicly via: <ext-link ext-link-type="uri" xlink:href="https://gitlab.com/BirdFlightSimulator/BirdFlightSimulation.git" xlink:type="simple">https://gitlab.com/BirdFlightSimulator/BirdFlightSimulation.git</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The stoop is a remarkable attack strategy used by peregrine falcons <italic>Falco peregrinus</italic>, and a range of other raptors [<xref ref-type="bibr" rid="pcbi.1006044.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006044.ref004">4</xref>]. It involves a steep, controlled dive in which the attacker strikes its prey at high-speed with a massive blow in mid-air [<xref ref-type="bibr" rid="pcbi.1006044.ref001">1</xref>]. The high momentum of the attacker places it at obvious risk of harm, especially when diving into flocks of birds [<xref ref-type="bibr" rid="pcbi.1006044.ref001">1</xref>] or when pulling out only meters from the ground [<xref ref-type="bibr" rid="pcbi.1006044.ref003">3</xref>]. Arguably, for the stoop to evolve as an habitual attack strategy, these risks must be outweighed by certain survival advantages, and stooping has therefore been proposed either to save energy [<xref ref-type="bibr" rid="pcbi.1006044.ref005">5</xref>], or to enhance catch success [<xref ref-type="bibr" rid="pcbi.1006044.ref006">6</xref>]. These hypothetical advantages remain unproven, however, because it is challenging to compare the success rates of different attack strategies empirically. Success rates are confounded by a variety of factors, including the experience [<xref ref-type="bibr" rid="pcbi.1006044.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref005">5</xref>] and reproductive status [<xref ref-type="bibr" rid="pcbi.1006044.ref007">7</xref>] of the attacker, the season of the attack [<xref ref-type="bibr" rid="pcbi.1006044.ref008">8</xref>], and the species of prey [<xref ref-type="bibr" rid="pcbi.1006044.ref006">6</xref>]. Even the seriousness of the attacker’s behavior may be an important source of variation: falcons seem to not always focus on achieving a high success rate, and appear sometimes to be practising or playing with their prey [<xref ref-type="bibr" rid="pcbi.1006044.ref009">9</xref>]. Moreover, the outcome of the stoop is often difficult to observe due to its high speed [<xref ref-type="bibr" rid="pcbi.1006044.ref006">6</xref>].</p>
<p>There presumably exists a trade-off between different factors influencing catch success in a stoop. On the one hand, it has been proposed that the high speed of the attack provides an element of surprise, leaving little time for the prey to evade [<xref ref-type="bibr" rid="pcbi.1006044.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref010">10</xref>]. On the other hand, it is possible that the high speed of the attack decreases the precision of interception [<xref ref-type="bibr" rid="pcbi.1006044.ref002">2</xref>], and makes it harder for the attacker to follow the prey if it turns sharply [<xref ref-type="bibr" rid="pcbi.1006044.ref011">11</xref>]. Such trade-offs are difficult to investigate empirically, and we therefore turn to modeling and simulation. Because physical and physiological constraints influence catch success, we use an embodied cognition approach [<xref ref-type="bibr" rid="pcbi.1006044.ref012">12</xref>]. We investigate the success of different attack strategies by incorporating in a physics-based simulation model the aerodynamics, flight mechanics, guidance, and control. Such detailed simulations have already proven useful in work on missile guidance: the increasing demand for better performing missiles forces the inclusion of the detailed dynamics of the missile and its target when comparing the effectiveness of different guidance systems [<xref ref-type="bibr" rid="pcbi.1006044.ref013">13</xref>]. The nonlinear nature of these dynamics restricts the use of analytic methods, such as linear-quadratic optimal control, and the effectiveness of different mechanisms must therefore be examined through parametric variation of the system between repeated simulations of interception. Here, we study the general intercept problem under the particular dynamics of flapping and gliding bird flight. Interception in this biological context differs from that of missiles in that gravity plays a pivotal role in determining the best attack strategy: in missiles, the speed and acceleration are so high that the effects of gravity are marginal, but in birds, the acceleration due to gravity dominates the dynamics.</p>
<p>The flight performance of the model-birds in our simulations depends on their flight morphology, and differs considerably between predator and prey. To maneuver, model-birds flap, glide, and vary their wing span. We use the model to study attacks by peregrine falcons on a habitual prey species, the common starling <italic>Sturnus vulgaris</italic>. We simulate three different patterns of flight by the prey—straight flight, smooth turning, and non-smooth turning (see <xref ref-type="fig" rid="pcbi.1006044.g001">Fig 1</xref>). This approach to varying the target motion is standard in simulations of missile guidance systems, and broadly summarizes the main options for the target to maneuver [<xref ref-type="bibr" rid="pcbi.1006044.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref014">14</xref>]. It also captures the range of different prey behaviors found in nature. For instance, if a bird is caught by surprise while commuting, then typically it will be flying in a straight line. Conversely, when turning, birds usually maneuver smoothly, but they will also fly erratically if a threat is detected, in a kind of non-smooth maneuvering flight known as jinking. Here we investigate whether, when, and why stooping increases catch success in each of these three situations (see <xref ref-type="supplementary-material" rid="pcbi.1006044.s006">S1</xref>–<xref ref-type="supplementary-material" rid="pcbi.1006044.s010">S5</xref> Videos for a visualization of attacks in each scenario).</p>
<fig id="pcbi.1006044.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Examples of prey motion in the no maneuver, smooth maneuver and non-smooth maneuver condition.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.g001" xlink:type="simple"/>
</fig>
<p>Because falcons often attack in wide, open spaces at high altitude, there are no objects or boundaries in our simulation space. We parametrically vary the falcon’s initial position relative to its prey to simulate a continuum of possible attack strategies (e.g. stoops versus level chases). Predator and prey are each free to move with 6 degrees of freedom in translation and rotation, and are subject to gravitational and aerodynamic forces, which they manipulate by controlling their wings (<xref ref-type="fig" rid="pcbi.1006044.g002">Fig 2</xref>). The model-bird’s flight controller determines the changes in wing shape and motion that best meet the accelerations commanded by its guidance system, under a quasi-steady blade element model of the aerodynamics. In model-falcons, the guidance system commands turning toward the prey in closed-loop, whereas in model-starlings the guidance system is a forcing function that is set to ensure that the prey remain within approximately ±20 m of their starting altitude. Because we assume that birds maximize their flight speed during escape and pursuit, model-birds always generate the maximum possible forward acceleration given their instantaneous velocity and orientation, subject to the constraint that they must simultaneously meet, as closely as possible, the acceleration demanded normal to their flight direction by their guidance system.</p>
<fig id="pcbi.1006044.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Block diagram of the feedback-loop in model-falcons.</title>
<p>This diagram is intended to communicate the general structure of the model. A detailed explanation of the model equations is provided in Materials and methods. The boxes denote transfer functions, and additional parameters of the functions are noted in between brackets. Most of the feedback loop is generic, except for the detailed implementation of flapping flight contained in the black box labelled “dynamics and control”. A brief summary of the feedback loop now follows, in which we walk through each of the different segments of the feedback loop summarised as “Vision”, “Guidance”, “Dynamics and Control”, “Kinematics”, and “Vector Geometry”. Vision: to determine how it should turn, the falcon first extracts the line-of-sight angle λ, which is measured subject to visual error <italic>ξ</italic>. The measured line-of-sight angle λ<sub><italic>ξ</italic></sub> is subsequently transformed into an angular velocity vector <inline-formula id="pcbi.1006044.e001"><alternatives><graphic id="pcbi.1006044.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">λ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>ξ</mml:mi></mml:msub></mml:math></alternatives></inline-formula> that denotes the estimated rate of change in the line-of-sight. The resulting signal from the visual system is fed to the guidance function every time interval <italic>τ</italic>, as denoted by the block labelled “sample … and hold”. Note that we also test an alternative implementation of visual processing delay in the model (continuous and delayed, instead of in discrete update intervals), as little is known about the nature of delay in birds. Results using either form of delay are highly similar (see <xref ref-type="supplementary-material" rid="pcbi.1006044.s001">S1 Fig</xref>). Guidance: the falcon’s guidance system multiplies the estimated line-of-sight rate <inline-formula id="pcbi.1006044.e002"><alternatives><graphic id="pcbi.1006044.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="normal">λ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>ξ</mml:mi></mml:msub></mml:math></alternatives></inline-formula> by the navigation constant <italic>N</italic> to obtain the commanded change in the angle of the falcon’s velocity <inline-formula id="pcbi.1006044.e003"><alternatives><graphic id="pcbi.1006044.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mi>γ</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1006044.e005">Eq 1</xref>), and the cross product is taken with the velocity of the falcon to obtain the commanded acceleration <inline-formula id="pcbi.1006044.e004"><alternatives><graphic id="pcbi.1006044.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mover accent="true"><mml:mi>α</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. The dynamics and control function depends on the morphological parameters <italic>μ</italic><sub>1</sub>, … <italic>μ</italic><sub><italic>n</italic></sub> and manipulates the wing shape and motion to produce an acceleration <italic>α</italic> which maximizes the forward acceleration whilst meeting the commanded acceleration as closely as possible (see <xref ref-type="sec" rid="sec010">Materials and methods</xref> section D.2 and E for detailed model equations). Kinematics and Vector Geometry: the acceleration of the falcon <italic>α</italic> is integrated in the kinematics section and fed back to the visual system through the medium of the vector geometry needed to relate the line-of-sight angle to the updated positions of the model-falcon and model-starling. Note that the segment of the block diagram labeled “Vector Geometry” operates outside of the model-falcon, so we do not imply that the falcon cognitively represents either its own position or that of its target. In particular, the falcon has no knowledge of—and no need to know—the distance to its target; all that the falcon needs to know is the direction of its target as measured visually by the line-of-sight angle, and its own velocity, which is needed to determine the commanded acceleration from the commanded turn rate. Model-starlings have a similar control-loop, in which the segments of the feedback loop labelled “Vision” and “Guidance” are replaced by a forcing function <italic>ζ</italic>(<italic>t</italic>) that determines their (desired) trajectory (see <xref ref-type="sec" rid="sec010">Materials and methods</xref> section C).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.g002" xlink:type="simple"/>
</fig>
<p>The falcon’s closed-loop guidance is essential in commanding the changes in velocity that are needed to intercept prey, whether maneuvering or not, and to deal with the effects of steering error. Our model-falcons use a guidance law called pure proportional navigation, which has been shown to fit the empirically measured attack trajectories of peregrine falcons closely [<xref ref-type="bibr" rid="pcbi.1006044.ref015">15</xref>]. Proportional navigation is also favored as a guidance law in missiles, because it provides a simple way of implementing the geometric rule known as parallel navigation or constant absolute target direction (CATD), according to which the attacker holds the geographic direction of the line-of-sight to target constant through time [<xref ref-type="bibr" rid="pcbi.1006044.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref016">16</xref>–<xref ref-type="bibr" rid="pcbi.1006044.ref018">18</xref>]. This geometry guarantees interception if the attacker is closing range, because at every instant it is set on a collision course with its target (i.e. would hit its target if both continued flying at constant velocity thereafter). Under pure proportional navigation, the attacker turns at an angular rate proportional to the angular rate of the line-of-sight to target. Although this guidance law can be written in three-dimensional vector form, it is more intuitively explained in the two-dimensional case, for which:
<disp-formula id="pcbi.1006044.e005"><alternatives><graphic id="pcbi.1006044.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>γ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mi mathvariant="normal">λ</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>γ</italic> denotes the bearing of the attacker’s velocity vector and λ denotes the bearing of the line-of-sight to target, both measured in an inertial reference frame; the dot notation denotes the time derivative, and <italic>N</italic> is called the navigation constant. The numerical value of <italic>N</italic> determines the rate of convergence to a parallel navigation (CATD) course: in missiles, low values of <italic>N</italic> result in slow convergence, whilst high values can cause overshoot, leading to control instability [<xref ref-type="bibr" rid="pcbi.1006044.ref014">14</xref>]. Partly for these reasons, intermediate values of <italic>N</italic> between 3 and 5 are typical in most missile applications.</p>
<p>The overall objective of our simulations is to identify the attack strategy that maximizes the catch success of the falcon for a given prey motion, a range of assumptions regarding the delay in the falcon’s response, and the error in its vision and control (see <xref ref-type="sec" rid="sec010">Materials and methods</xref>). Here, an attack strategy is defined as some particular combination of the predator’s navigation constant <italic>N</italic>, and its initial vertical and horizontal distance from the prey. The optimization was conducted via parametric variation of the attack strategy, in combination with Generalized Additive Modeling (GAM), which we used to interpolate between the 10<sup>6</sup> randomly chosen attack strategies that we simulated in each optimization [<xref ref-type="bibr" rid="pcbi.1006044.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref020">20</xref>]. We hypothesise that stooping maximizes catch success, and that it does so as a direct consequence of the flight physics in our simulation model. We test this by asking whether a model-falcon’s catch success is maximized by attacking from a high altitude, which couples into a high flight speed in our simulations. Remarkably, we find that the optimality of stooping depends not only on the motion of the prey, but also on the tuning of the underlying guidance law. Specifically, we show that stooping is only expected to evolve in conjunction with the same low values of the navigation constant <italic>N</italic> that have been identified empirically in peregrine falcons [<xref ref-type="bibr" rid="pcbi.1006044.ref015">15</xref>].</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Starlings outmaneuver falcons in slow flight</title>
<p>Flight performance is expected to be a key determinant of catch success in a chase. Clearly, any prey species that can fly faster than a falcon will be able to outrun its attacker in straight flight. In practice, peregrine falcons fly much faster than starlings, and our aerodynamic model predicts that they hold a considerable speed advantage in both level flight (maximum speed: 29 <italic>versus</italic> 23 ms<sup>−1</sup>; <xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3a</xref>) and vertical dives (terminal speed: 123 <italic>versus</italic> 52 ms<sup>−1</sup>; <xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3b</xref>; see section K for a comparison between flight performance in the model and empirical measurements). Even so, escape is possible if the prey species can outmaneuver its attacker. For instance, if at a given flight speed the prey can produce a higher aerodynamic force relative to body weight than its attacker (i.e. produce a higher load factor), then it may escape by turning more tightly than its attacker in a smooth maneuver called a turning gambit [<xref ref-type="bibr" rid="pcbi.1006044.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref022">22</xref>]. Our aerodynamic model shows that starlings can indeed sustain higher load factors than peregrine falcons flying at the same speed (<xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3c</xref>), and that although falcons can achieve even higher load factors by flying faster (<xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3c</xref>), the net effect is such that a starling will always be able to turn on a tighter radius than a faster-flying falcon (<xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3e</xref>). Similarly, if the prey can achieve a higher roll acceleration than the falcon, then it will be able to redirect its lift faster, and hence outmaneuver its attacker in a non-smooth jinking maneuver. Our aerodynamic model predicts that a starling can indeed produce a higher roll acceleration than a falcon flying at the same speed (<xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3d</xref>). So great is a model-starling’s advantage in this respect that a model-falcon can only be expected to match a model-starling’s maximum roll acceleration by diving at close to terminal velocity (i.e. at close to its maximum speed). Hence, model-starlings may often escape model-falcons in our simulations, even though their maneuvers are not implemented as an evasive response to the falcon. In summary, a starling can always outmaneuver a falcon that is flying at a similar speed, but a falcon can always beat the load factor and roll acceleration of a starling by diving at a sufficiently higher speed. Whether this strategy enhances catch success will presumably depend on the flight pattern of the prey, and the complex ways in which the predator’s flight speed, response delay, and errors in vision and control interact to affect its guidance. We explore the outcome of these complex interactions in the simulations presented below.</p>
<fig id="pcbi.1006044.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Flight performance graphs in the flight simulator for the peregrine falcon (dark blue) and the common starling (light blue).</title>
<p>The double arrows denote the direction of acceleration displayed in the graph. The starling is able to outmaneuver the falcon at a given airspeed, if there exists a region under the curve of the starling that is not overlapping with that of the falcon. (a) Level acceleration versus air speed: level flight with the requirement that lift equals weight. Dashed lines denote the speed wherein torque forces constrain the maximum acceleration (mechanical constraints). Top level flight speed is reached at the point where level acceleration is zero. (b) Vertical dive acceleration (including gravity) versus air speed. At the end of the dashed lines, flapping is substituted by gliding with retracted wings in order to maximize vertical acceleration. (c) Load factor versus air speed. The load factor is defined as lift divided by weight. The maximum load factor does not scale quadratically with forward speed due to constraints in torque forces [<xref ref-type="bibr" rid="pcbi.1006044.ref011">11</xref>]. Instead, wings are retracted optimally to increase maximum load. (d) Roll acceleration versus air speed. Roll acceleration determines the speed with which the bird can redirect its lift and is calculated by estimating the whole-body inertia around the roll-axis and the maximum net torque production [<xref ref-type="bibr" rid="pcbi.1006044.ref011">11</xref>]. (e) Turning radius is calculated as the square of air speed divided by the maximum normal acceleration.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Stooping maximizes catch success if the prey maneuvers</title>
<p>The catch success of model-falcons was always maximized by entering a steep dive, but the optimal starting altitude varied greatly between the three different flight patterns of the prey (<xref ref-type="table" rid="pcbi.1006044.t001">Table 1</xref>; see asterisked points in <xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4</xref>). Catch success in attacks on straight-flying prey (<xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4a</xref>) was maximized by stooping from a low altitude (&lt; 200m), leading to a low flight speed at the point of intercept (35 − 45ms<sup>−1</sup>). Optimal stoop altitude was somewhat higher (<italic>c</italic>. 350m) when prey maneuvered smoothly (<xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4b</xref>), leading to a moderate intercept speed (50 − 55ms<sup>−1</sup>). Catch success with non-smoothly maneuvering prey (<xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4c</xref>) was maximized by stooping from a very high altitude (<italic>c</italic>. 1500m), leading to a very high intercept speed (&gt; 100ms<sup>−1</sup>) approaching the terminal velocity of the model-falcon (see <xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3</xref>). Interestingly, catch success barely declined when the model-falcon attacked from a higher altitude than the optimum (<xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4</xref>), but was greatly reduced if the model-falcon attacked from a lower starting position (<xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4</xref>), so stooping from a high altitude is never a bad strategy provided that the guidance system is appropriately tuned (see below).</p>
<table-wrap id="pcbi.1006044.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.t001</object-id>
<label>Table 1</label>
<caption>
<title>Attack strategies with maximum catch success.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006044.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">prey motion</th>
<th align="left">navigation constant <italic>N</italic></th>
<th align="left">altitude (m)</th>
<th align="left">horizontal distance (m)</th>
<th align="left">speed at interception (ms<sup>−1</sup>)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">no maneuvers</td>
<td align="left">1–6</td>
<td align="left">150–200</td>
<td align="left">70–90</td>
<td align="left">35–45 (Low-speed)</td>
</tr>
<tr>
<td align="left">smooth maneuvers</td>
<td align="left">5.6</td>
<td align="left">350</td>
<td align="left">0–200</td>
<td align="left">50–55 (moderate-speed)</td>
</tr>
<tr>
<td align="left">non-smooth maneuvers</td>
<td align="left">2.8</td>
<td align="left">1500</td>
<td align="left">641</td>
<td align="left">&gt;105 (high-speed)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1006044.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Catch success mapped onto initial altitude and horizontal distance from the prey for non-maneuvering, smooth maneuvering and non-smooth maneuvering prey, and for 4 values of the navigation constant <italic>N</italic>: A low extreme (<italic>N</italic> = 1), the optimal value for catching non-smooth maneuvering prey (<italic>N</italic> = 2.8), the optimal value for catching smooth maneuvering prey (<italic>N</italic> = 5.6), and a high extreme (<italic>N</italic> = 15).</title>
<p>The yellow asterisks depict the global optima with respect to attack position and <italic>N</italic>, showing the attack strategy which uniquely maximizes catch success for a given prey motion. The yellow crosses denote local optima for a given <italic>N</italic> and prey motion. The approximate intercept speed corresponding to the initial altitude is shown on the right of the graph. This is only an approximate relationship because the exact intercept speed depends on many factors within each hunt.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec005">
<title>Optimization of the navigation constant for stooping</title>
<p>The attack strategy of a model-falcon encompasses both its initial position relative to the prey, and the setting of its navigation constant <italic>N</italic>. The global optima that we have so far discussed (asterisked points in <xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4</xref>) assume joint optimization of the predator’s initial attack position and its navigation constant <italic>N</italic>, and the optima for both parameters depend on the motion of the prey (see also <xref ref-type="table" rid="pcbi.1006044.t001">Table 1</xref>). Selection on <italic>N</italic> is expected to be strongest when prey execute non-smooth maneuvers, for which high catch success is achieved over only a narrow range of <italic>N</italic> (compare width of dark blue area denoting high catch success in <xref ref-type="fig" rid="pcbi.1006044.g005">Fig 5c</xref> with the equivalent areas in <xref ref-type="fig" rid="pcbi.1006044.g005">Fig 5a and 5b</xref>). Interestingly, for all three types of prey motion, the optimal setting of <italic>N</italic> tends to be lower the faster the stoop (see dashed lines in <xref ref-type="fig" rid="pcbi.1006044.g005">Fig 5</xref> plotting the optimal setting of <italic>N</italic> conditional upon the speed at intercept). Conversely, for a given setting of <italic>N</italic>, the optimal intercept speed becomes lower the higher the value of <italic>N</italic> (see solid lines in <xref ref-type="fig" rid="pcbi.1006044.g005">Fig 5</xref> plotting the optimal speed at intercept conditional upon the setting of <italic>N</italic>). Thus, for any given type of prey motion, high-speed, high-altitude stoops <italic>only</italic> maximize catch success over a small range of comparatively low values of <italic>N</italic>. At higher values of <italic>N</italic>, catch success is maximized by using a low-speed (<xref ref-type="fig" rid="pcbi.1006044.g005">Fig 5</xref>), low-altitude (<xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4</xref>) attack, but this is generally less successful than a high-speed, high-altitude attack at a lower value of <italic>N</italic>.</p>
<fig id="pcbi.1006044.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Catch success mapped onto intercept speed and navigation constant <italic>N</italic> for (a) non maneuvering, (b) smooth maneuvering and (c) non-smooth maneuvering prey.</title>
<p>The solid line denotes the optimal interception speed for a given <italic>N</italic> and the dashed line denotes the optimal <italic>N</italic> for a given interception speed. The asterisks denote the global optimum with respect to intercept speed and <italic>N</italic> for a given prey motion.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.g005" xlink:type="simple"/>
</fig>
<p>In summary, it turns out to be essential for our model-falcons to set their navigation constant appropriately: if a sub-optimal value of <italic>N</italic> were used, then stooping might no longer be the best attack strategy, because of poor catch success. For instance, if a model-falcon were to use the optimal value of <italic>N</italic> for smoothly maneuvering prey (<italic>N</italic> = 5.6) against prey executing non-smooth maneuvers, then a high-altitude stoop would be unlikely to result in prey capture (third panel of <xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4c</xref>). This does not necessarily mean that a falcon must actively adjust <italic>N</italic> to match the maneuverability of its prey: the best attack strategy of a model-falcon against the best defensive flight pattern of a model-starling (i.e. non-smooth) involves entering a high-speed, high-altitude stoop at <italic>N</italic> ≈ 3. This minimax strategy not only yields maximal catch success against non-smoothly maneuvering prey, but also yields near-maximal catch success against prey that are flying straight or maneuvering smoothly (second row of <xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4</xref>). Hence, subject to the assumptions of our model, we expect falcons to adopt a general strategy of stooping from high-altitude at <italic>N</italic> ≈ 3, because this strategy is effective against all of the different patterns of prey flight that we have tested here.</p>
<p>Some interesting flight trajectories emerge at <italic>N</italic> &lt; 2 (see <xref ref-type="supplementary-material" rid="pcbi.1006044.s002">S2 Fig</xref>). In this case, the model-falcon exerts most of its acceleration towards the end of its attack (see also [<xref ref-type="bibr" rid="pcbi.1006044.ref014">14</xref>]), often diving below its prey before looping upward to intercept. This upward-curved trajectory is regularly observed in nature [<xref ref-type="bibr" rid="pcbi.1006044.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref023">23</xref>], and has previously been suggested to be a strategy of a falcon to fly into the blind spot of its prey’s vision [<xref ref-type="bibr" rid="pcbi.1006044.ref009">9</xref>]. Our model provides a more parsimonious explanation for these flight paths, which can emerge naturally from the dynamics of the underlying feedback law.</p>
</sec>
<sec id="sec006">
<title>Response delays and errors in vision and control drive the need to stoop</title>
<p>The most important factor that causes the reduction in catch success observed at high values of the navigation constant <italic>N</italic> is the response delay of the model-falcon. A robustness analysis (<xref ref-type="fig" rid="pcbi.1006044.g006">Fig 6a</xref>) shows that high values of <italic>N</italic> are no longer associated with a low catch success if the reactions of the falcon are effectively instantaneous (compare catch success as a function of <italic>N</italic> at <italic>τ</italic> = 0.1ms delay with the equivalent line for the default <italic>τ</italic> = 50ms delay used in our baseline model; see <xref ref-type="sec" rid="sec010">Materials and methods</xref>). Conversely, if the falcon’s actual response delay is greater than the default assumed in our baseline model, then the optimal value of <italic>N</italic> is driven towards an even lower value (<xref ref-type="fig" rid="pcbi.1006044.g006">Fig 6a</xref>). Visual error also affects the optimal value of <italic>N</italic> in our simulations: if the falcon is subject to greater visual error than the default value assumed in our model, then the navigation constant is again driven towards an even lower value of <italic>N</italic> (<xref ref-type="fig" rid="pcbi.1006044.g006">Fig 6b</xref>). This reflects the fact that the propagation of this visual error into the commanded acceleration is directly proportional to <italic>N</italic> (see <xref ref-type="fig" rid="pcbi.1006044.g002">Fig 2</xref>). In contrast, the optimal value of <italic>N</italic> is robust to the error assumed in the control system itself (<xref ref-type="fig" rid="pcbi.1006044.g006">Fig 6b</xref>).</p>
<fig id="pcbi.1006044.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Relationship between catch success and various model parameters.</title>
<p>Graphs depict results for non-smooth maneuvering prey, because in this condition the high-speed stoop with a low <italic>N</italic> shows the most marked increase in catch success for the falcon. The upper bounds in values for reaction times and errors in vision and control are chosen such that they are different enough to show substantial variation in simulation results, but remain low enough to allow for capture. (a) Maximum catch success as a function of <italic>N</italic> in the baseline model, for smaller (<italic>τ</italic> = 0.1<italic>ms</italic> &amp; 25<italic>ms</italic>) or larger (<italic>τ</italic> = 100<italic>ms</italic> &amp; 150<italic>ms</italic>) response delays, assuming the optimal attack position. The margins depict the 95% confidence intervals of the GAM. The asterisks denote the global optimum with respect to the x-axis. (b) Maximum catch success as a function of <italic>N</italic> for different visual (<italic>ξ</italic>) and control error (<italic>χ</italic>). (c) Maximum catch success as a function of altitude, for the baseline and for increased error in vision. (d) Maximum catch success as a function of altitude for various values of control error. (e) Maximum catch success as a function of altitude, for various values of response delay <italic>τ</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.g006" xlink:type="simple"/>
</fig>
<p>How do response delays, or errors in vision and control, impact the success of a given attack strategy? As expected, catch success declines as each of these quantities increases (<xref ref-type="fig" rid="pcbi.1006044.g002">Fig 2</xref>). Remarkably, however, the optimal starting altitude becomes lower when the visual error or control error is increased (<xref ref-type="fig" rid="pcbi.1006044.g006">Fig 6c and 6d</xref>). Thus, a high-speed, high-altitude stoop only maximizes catch success if the falcon is accurate in both vision and control. A high-speed stoop maximizes catch success for all of the response delays that we tested, noting that any much longer delay would have resulted in very low catch success (<xref ref-type="fig" rid="pcbi.1006044.g006">Fig 6e</xref>). On the other hand, if the falcon’s response is effectively instantaneous (<italic>τ</italic> = 0.1ms), then 100% catch success is attained even in a low-altitude dive from &lt; 200m. This implies that the falcon’s flight performance is sufficient to catch a starling in a low-level stoop, but that delays in the model-falcon’s response hamper its ability to catch prey. The lower catch success that results from having a slower response can be ameliorated by diving from higher altitudes at lower <italic>N</italic>.</p>
</sec>
<sec id="sec007">
<title>What mechanisms underlie the increased catch success in a stoop?</title>
<p>When a falcon stoops from high altitude, its attack is characterized by both a very high flight speed, and a very steep descent angle—either of which could promote catch success. To investigate the effect of steepness of the descent, we altered the initial conditions of the simulations so as to model a horizontal attack at very high initial speed (112 ms<sup>−1</sup>). This effectively simulates the final approach of a falcon that stoops from a very high altitude to gain speed before levelling off to intercept. Remarkably, the maximum catch success of these model-falcons is only 3% lower than for those intercepting their prey at the same speed in a steep dive (61 vs 64%). This implies that the steep descent angle is not directly responsible for the overwhelming success of a stoop, and hence that the key reason for starting from a very high altitude is to gain airspeed by converting potential energy to kinetic energy.</p>
<p>The very high airspeed attained in a stoop enables model-falcons to exceed the model-starlings’ maximal load factor and roll acceleration (<xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3</xref>). To test which of these two dimensions of flight performance causes an increase in catch success in a stoop, we artificially capped the maximal load factor or maximal roll acceleration of our model-falcons. We thus investigated the catch success of a bird flying at the same high speed achieved in a high-altitude stoop (&gt; 100ms<sup>−1</sup>), but with the lower maximal acceleration associated with sustained level flight (30ms<sup>−1</sup>). Limiting either component of the model-falcon’s flight performance resulted in a substantial drop in catch success (51% when limiting roll acceleration and 42% when limiting load factor). This suggests that the high speed that a falcon attains in a stoop is important partly because of the higher load factors and higher roll accelerations that can be achieved in high-speed flight. Interestingly though, model-falcons flying at high speed still performed considerably better than model-falcons in sustained level flight (31% vs 26%) even though the maximal load factor and roll acceleration was made the same, and even when these fast falcons levelled off before interception. This implies that a high flight speed is beneficial in and of itself, independent of the higher acceleration performance that is usually also associated with fast flight.</p>
<p>This result might seem surprising, because model-falcons fly faster than model-starlings even in sustained level flight (<xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3a</xref>), and the most obvious consequence of increasing the falcon’s flight speed further is to increase its turning radius, potentially causing it to overshoot when attacking sharply turning prey. However, the flight speed of a falcon varies continuously in our model, on account of its varying acceleration demand, and work on missile guidance and control has shown that the accelerations commanded in response to variations in speed are lower when the angle between the current line-of-sight and the expected point of intercept is smaller. The faster the falcon, the smaller this angle, which reduces the risk of control saturation, and thereby decreases the probability of missing the target.</p>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>Previous authors have suggested that falcons stoop at high-speed to add an element of surprise to their attack, thereby preventing escape maneuvers by the prey. Our simulations suggest that there are many other, previously unrecognized advantages to stooping: for example, a high-speed stoop still provides a clear advantage over an attack from lower altitudes even if the prey individuals fly erratically, which models how real prey behave when alerted to the presence of a predator. This is because fast-flying falcons can obtain a higher load factor, can roll faster into a turn, and can slow down less when increasing their load factor to maneuver—each of which increases the falcon’s catch success. Moreover, the steep angle of the stoop, and the details of the attack geometry of a fast-flying falcon further enhance catch success. The functional reasons for stooping are therefore far richer than considered previously, and are closely related to the physical constraints upon the problem (see [<xref ref-type="bibr" rid="pcbi.1006044.ref024">24</xref>] for a wider discussion of the operation of natural selection in relation to biomechanical constraint).</p>
<p>In order to intercept prey successfully at high speed, our model-falcons required a suitably optimized guidance law. Informed by a recent empirical study [<xref ref-type="bibr" rid="pcbi.1006044.ref015">15</xref>], our model-falcons used a pure proportional navigation guidance law, but we identified the optimal value of the navigation constant <italic>N</italic> post hoc through Monte Carlo simulation. A range of different values of <italic>N</italic> can be used successfully in low-speed flight, or when attacking non-maneuvering and smoothly-maneuvering prey, so the tightly-defined optimum of <italic>N</italic> ≈ 3 that applies in a high-speed stoop works well under all of the conditions that we tested (<xref ref-type="fig" rid="pcbi.1006044.g004">Fig 4</xref>). This most broadly effective value of the navigation constant coincides closely with the median value of <italic>N</italic> = 2.6 that has been found empirically in captive-bred peregrine falcons attacking artificial targets [<xref ref-type="bibr" rid="pcbi.1006044.ref015">15</xref>]. It also coincides with a classical result of linear-quadratic optimal guidance theory, which shows that proportional navigation with an effective navigation constant <italic>N</italic>′ = 3 minimizes the control effort needed to intercept a non-maneuvering target [<xref ref-type="bibr" rid="pcbi.1006044.ref014">14</xref>] (the effective navigation constant is defined as <italic>N</italic>′ = <italic>N</italic>(<italic>v</italic> cos <italic>δ</italic>)/<italic>v</italic><sub><italic>c</italic></sub> for pure proportional navigation, where <italic>v</italic> is the attacker’s speed relative to the ground, <italic>v</italic><sub><italic>c</italic></sub> its closing speed relative to the target, and <italic>δ</italic> the deviation angle between the attacker’s velocity vector and its line-of-sight to target [<xref ref-type="bibr" rid="pcbi.1006044.ref014">14</xref>]). The fact that a navigation constant of <italic>N</italic> ≈ 3 is found to be optimal or near-optimal in so wide a range of circumstances—and in so wide a range of systems, from birds to missiles—strongly indicates the robustness of our analysis and conclusions.</p>
<p>The results of our simulations also offer insight into the variability that is intrinsic to the attack behavior of real falcons. Captive-bred falcons have been shown to use a range of navigation constants around the median value of <italic>N</italic> = 2.6 that is comparable to the range of values of <italic>N</italic> that are optimal under the various conditions simulated in our model [<xref ref-type="bibr" rid="pcbi.1006044.ref015">15</xref>]. Whereas these real falcons seem to maintain an approximately constant value of <italic>N</italic> during a single interception attempt, they also vary it appreciably between attacks. It is currently unknown what drives this variability in the tuning of the navigation constant. Our model suggests that the details of the prey’s motion, and the details of the falcon’s flight speed, response delay, and precision in vision and control are all important determinants of the optimal tuning of <italic>N</italic>, and might therefore explain any adaptive variation in <italic>N</italic>.</p>
<p>Surprisingly, attacking at high speed does not require a faster response from the falcon than attacking at low speed (<xref ref-type="fig" rid="pcbi.1006044.g006">Fig 6e</xref>). By increasing the falcon’s flight performance, the stoop compensates for the decrease in catch success that would otherwise result from a slow response. In contrast, the need for accuracy in vision and control is especially acute when flying at high speed, and stooping is only optimal if the falcon has reasonably low error in both (<xref ref-type="fig" rid="pcbi.1006044.g006">Fig 6</xref>). Hence, we assume that selection for high visual acuity will be especially strong in species that use high-speed attacks. It follows that stooping should be considered a specialist hunting technique, because only accurate falcons with optimized guidance will be able to increase catch success by stooping. This arguably poses an exploration-exploitation dilemma for a falcon learning to catch prey: either it may seek to optimize its current catch success by adopting the easy strategy of a low-speed attack, for which the details of the parameter tuning are not critical; or, it may explore the more difficult strategy of a high-speed stoop, which could decrease catch success at first in an unskilled falcon, but can be expected to increase catch success in the long-run. The playful attacks by falcons in which they do not seriously attempt to kill their prey [<xref ref-type="bibr" rid="pcbi.1006044.ref006">6</xref>], may be necessary for acquiring sufficient skill in stooping.</p>
<sec id="sec009">
<title>Limitations and wider implications</title>
<p>Although our physics-based model is realistic enough for its intended purpose, there are obviously further constraints in nature that we have not modelled here, including the effects of unsteady aerodynamics, the dynamics of pitch and yaw instability, and the mechanics of catching or knocking the prey with the talons at intercept. There are also other complicating factors that we have not modelled, including the effects of explicit evasive maneuvers by the prey, or the impact of intra- and inter-specific variation in flight morphology and physiology, and hence variation in the flight performance of predator or prey. These factors can be studied through extensions of the model and through parametric variation of the model between simulations, and will be considered elsewhere. Nevertheless, our approach to studying the dynamics of aerial predation is unique among behavioral studies of complex systems in combining guidance and control laws inspired by missile theory [<xref ref-type="bibr" rid="pcbi.1006044.ref014">14</xref>] with a detailed simulation model of the biology and physics of animal flight. The underlying feedback laws are well-founded in the theory of optimal guidance [<xref ref-type="bibr" rid="pcbi.1006044.ref014">14</xref>], and their validity as a phenomenological model of guidance and control in peregrine falcons has already been verified in nature [<xref ref-type="bibr" rid="pcbi.1006044.ref015">15</xref>]. Furthermore, the simulation approach that we have used proves necessary because of the complexity of the flight dynamics, which precludes an analytical approach [<xref ref-type="bibr" rid="pcbi.1006044.ref013">13</xref>]. Even setting aside the aerodynamic complexities that we have handled using a blade-element model of flapping flight, the mere fact that the birds must reorient their body to redirect their lift vector generates dynamics that are known to have no analytical solution in the most-closely analogous case of bank-to-turn missiles [<xref ref-type="bibr" rid="pcbi.1006044.ref025">25</xref>]. Our modeling therefore follows an embodiment approach, which states that behavior emerges through feedback-loops between the brain, the body, and the world. Aspects of cognition, such as the guidance laws used to intercept prey, are shaped by properties of the body and therefore bodily traits need to be considered to fully understand behavior [<xref ref-type="bibr" rid="pcbi.1006044.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref026">26</xref>]. In summary, our agent-based simulation approach provides insights into the optimization of attack strategies by an aerial predator that could not have been reached in any other way, and thereby paves the way for a new generation of studies into the optimization of complex multi-agent flight behaviors.</p>
</sec>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec011">
<title>Summary of simulation procedure</title>
<p>In our simulations, model-birds fly with six degrees of freedom through an open three-dimensional space without objects or boundaries. In each simulation run, a model-falcon aims to intercept a lone model-starling in mid-air, using a pure proportional navigation guidance law (<xref ref-type="disp-formula" rid="pcbi.1006044.e005">Eq 1</xref>). In model-starlings, the guidance command is a forcing function that ensures that they either fly linearly, or execute smooth or non-smooth maneuvers, always keeping within ±20m of their initial altitude. Model-birds are subject to gravitational and aerodynamic forces, and flap, glide and retract their wings to manipulate the aerodynamic forces. Model-birds maximize their forward acceleration at a given speed and orientation, subject to the constraint that they meet the normal acceleration commanded by their guidance system. A flight controller determines the changes in wing shape and motion that best meet the desired acceleration. When the commanded normal acceleration cannot be met, model-birds simply exert the maximum attainable lift force.</p>
<p>At the start of an attack, the model-starling is located at the origin of the global coordinate system, with its body coordinate system oriented randomly. This variation in initial orientation ensures sufficient randomization to avoid artificial results due to coupling of highly specific initial conditions of the falcon and starling. The model starling begins flying at an initial speed of 11 ms<sup>−1</sup>, calculated as the airspeed at which the cost of transport is minimized under the model. The model-falcon initially flies at a speed of 16 ms<sup>−1</sup>, with its longitudinal body axis pointing directly towards the starling, and its lateral body axis horizontal. We parametrically vary the falcon’s initial position relative to the prey, and vary the navigation constant <italic>N</italic> (i.e. the one free parameter of the falcon’s guidance law; see below) to simulate a continuum of different attack strategies. For each attack, we sample at random from a uniform distribution, sampling the navigation constant <italic>N</italic> between 1 and 20, the falcon’s initial altitude above the prey between −200 and 1500 m, and the initial horizontal distance to the prey between 0 and 800 m. The simulation ends when the falcon either intercepts the starling or is unsuccessful in its attempt to intercept, according to the criteria defined below. For a visualization of the simulations, see SI videos.</p>
</sec>
<sec id="sec012">
<title>Analysis</title>
<p>Every simulation ends in either the success or failure of the model-falcon to catch the model-starling. A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling. Failure occurs if either the falcon has not caught the starling within 40 s, or if it experiences a near-miss from which it cannot recover. A near-miss occurs when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45° behind the bird) such that the falcon would effectively need to begin a new engagement in order to re-acquire its target. In order to analyze how the model parameters affect catch success, we apply Generalized Additive Modeling (GAM; [<xref ref-type="bibr" rid="pcbi.1006044.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref020">20</xref>]). This is a nonlinear regression method which places no assumptions on the shape of the relationship between predictor and outcome. The estimation of the smoothing functions is conducted by automated cross-validation procedures (quadratic penalized likelihood), which reduce the likelihood of over-fitting and therefore ensure that our (conditional) maxima are not spurious. We applied GAMs with a logit link function, with catch success as the outcome variable and with the navigation constant <italic>N</italic>, <italic>initial-altitude</italic> and <italic>horizontal-distance</italic> as the independent variables. We built separate models for each combination of prey motion, response delay, and error. No constraints on the effective degrees of freedom were applied.</p>
</sec>
<sec id="sec013">
<title>Software</title>
<p>Model simulations were programmed in C++, using openGL for graphics rendering. Hildenbrandt’s StarDisplay model [<xref ref-type="bibr" rid="pcbi.1006044.ref027">27</xref>] was used as the framework for graphical display. Optimization studies of the blade-element model were conducted in MATLAB 2014a, and the <italic>mgcv</italic> package [<xref ref-type="bibr" rid="pcbi.1006044.ref028">28</xref>] of R statistics [<xref ref-type="bibr" rid="pcbi.1006044.ref029">29</xref>] was used for GAM regression.</p>
</sec>
<sec id="sec014">
<title>Detailed description of the bird-flight simulator</title>
<p>Here we explain the detail of our simulation model, using the block structure depicted in <xref ref-type="fig" rid="pcbi.1006044.g002">Fig 2</xref>, and discussing each of the following four segments of the block diagram in turn: A. Kinematics, B. Vision, C. Guidance, D. Control and E. Aerodynamics. We justify each variable and mechanism by parameterization to empirical data, and justify mathematical argument in terms of physics or optimality. For symbol meanings, see <xref ref-type="table" rid="pcbi.1006044.t002">Table 2</xref>.</p>
<table-wrap id="pcbi.1006044.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.t002</object-id>
<label>Table 2</label>
<caption>
<title>Symbol meanings.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006044.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.t002" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">symbol</th>
<th align="left">explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>α</italic></td>
<td align="left">angle of attack</td>
</tr>
<tr>
<td align="left"><italic>β</italic></td>
<td align="left">dive angle (negated elevation angle)</td>
</tr>
<tr>
<td align="left"><italic>ϵ</italic></td>
<td align="left">visual error vector</td>
</tr>
<tr>
<td align="left"><italic>θ</italic></td>
<td align="left">wing-beat angular amplitude</td>
</tr>
<tr>
<td align="left"><italic>κ</italic></td>
<td align="left">altitude relative to preferred altitude</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e006"><alternatives><graphic id="pcbi.1006044.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mover accent="true"><mml:mover accent="true"><mml:mi mathvariant="normal">λ</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula></td>
<td align="left">angular velocity vector of the line-of-sight</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e007"><alternatives><graphic id="pcbi.1006044.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mover accent="true"><mml:mi>μ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula></td>
<td align="left">vector of morphological properties</td>
</tr>
<tr>
<td align="left"><italic>μ</italic></td>
<td align="left">dynamic viscosity of air</td>
</tr>
<tr>
<td align="left"><italic>ξ</italic></td>
<td align="left">limit of the distribution of visual error</td>
</tr>
<tr>
<td align="left"><italic>ρ</italic></td>
<td align="left">air density</td>
</tr>
<tr>
<td align="left"><italic>τ</italic></td>
<td align="left">response delay, differencing time of visual input and update interval</td>
</tr>
<tr>
<td align="left"><italic>ϕ</italic></td>
<td align="left">fraction of wing retraction</td>
</tr>
<tr>
<td align="left"><italic>ω</italic></td>
<td align="left">roll (angular) velocity</td>
</tr>
<tr>
<td align="left">Ω</td>
<td align="left">roll angle</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e008"><alternatives><graphic id="pcbi.1006044.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula></td>
<td align="left">translational acceleration vector</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e009"><alternatives><graphic id="pcbi.1006044.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>s</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></td>
<td align="left">commanded acceleration vector</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e010"><alternatives><graphic id="pcbi.1006044.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>p</mml:mi><mml:mi>r</mml:mi><mml:mi>o</mml:mi><mml:mi>j</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></td>
<td align="left">acceleration vector outputted by the weight support controller</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e011"><alternatives><graphic id="pcbi.1006044.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mi>A</mml:mi><mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td>
<td align="left">aspect ratio</td>
</tr>
<tr>
<td align="left"><italic>B</italic></td>
<td align="left">body coordinate system</td>
</tr>
<tr>
<td align="left"><italic>b</italic></td>
<td align="left">wing span</td>
</tr>
<tr>
<td align="left"><italic>b</italic><sub><italic>min</italic></sub></td>
<td align="left">minimum wing span</td>
</tr>
<tr>
<td align="left"><italic>b</italic><sub><italic>max</italic></sub></td>
<td align="left">maximum wing span</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub><italic>n</italic></sub></td>
<td align="left">various constants in equations</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub><italic>l</italic></sub></td>
<td align="left">lift coefficient</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub><italic>l</italic>.<italic>max</italic></sub></td>
<td align="left">maximum lift coefficient</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub><italic>torque</italic></sub></td>
<td align="left">decrement in thrust due to torque</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub><italic>d</italic>.<italic>fric</italic></sub></td>
<td align="left">friction drag coefficient</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub><italic>d</italic>.<italic>body</italic></sub></td>
<td align="left">body drag coefficient</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub><italic>d</italic>.<italic>induced</italic></sub></td>
<td align="left">induced drag coefficient</td>
</tr>
<tr>
<td align="left"><italic>dt</italic></td>
<td align="left">model time-step</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e012"><alternatives><graphic id="pcbi.1006044.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mover accent="true"><mml:mi>F</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>f</mml:mi><mml:mi>l</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></td>
<td align="left">total translational force</td>
</tr>
<tr>
<td align="left"><italic>f</italic></td>
<td align="left">wing-beat frequency</td>
</tr>
<tr>
<td align="left"><italic>g</italic></td>
<td align="left">gravitational acceleration</td>
</tr>
<tr>
<td align="left"><italic>I</italic><sub><italic>x</italic>′</sub></td>
<td align="left">total moment of inertia about the roll axis</td>
</tr>
<tr>
<td align="left"><italic>I</italic><sub><italic>b</italic></sub></td>
<td align="left">body inertia around the roll axis</td>
</tr>
<tr>
<td align="left"><italic>I</italic><sub><italic>b</italic>0</sub></td>
<td align="left">body inertia for body width of 1m and body mass of 1kg</td>
</tr>
<tr>
<td align="left"><italic>I</italic><sub><italic>wing</italic></sub></td>
<td align="left">wing inertia around the shoulder</td>
</tr>
<tr>
<td align="left"><italic>I</italic><sub><italic>wing</italic>.<italic>center</italic></sub></td>
<td align="left">wing inertia around the center of gravity of the bird</td>
</tr>
<tr>
<td align="left"><italic>J</italic></td>
<td align="left">sum of mass times distance to center of gravity</td>
</tr>
<tr>
<td align="left"><italic>L</italic></td>
<td align="left">lift</td>
</tr>
<tr>
<td align="left"><italic>L</italic><sub>0</sub></td>
<td align="left">maximum lift at maximum wing span</td>
</tr>
<tr>
<td align="left"><italic>L</italic><sub><italic>max</italic></sub></td>
<td align="left">maximum attainable lift</td>
</tr>
<tr>
<td align="left"><italic>l</italic><sub><italic>w</italic></sub></td>
<td align="left">wing length</td>
</tr>
<tr>
<td align="left"><italic>M</italic><sub><italic>x</italic>′</sub></td>
<td align="left">net torque around the roll axis</td>
</tr>
<tr>
<td align="left"><italic>M</italic><sub><italic>wing</italic></sub></td>
<td align="left">net torque around the roll axis of one wing</td>
</tr>
<tr>
<td align="left"><italic>m</italic></td>
<td align="left">total mass</td>
</tr>
<tr>
<td align="left"><italic>m</italic><sub><italic>w</italic></sub></td>
<td align="left">wing mass</td>
</tr>
<tr>
<td align="left"><italic>m</italic><sub><italic>b</italic></sub></td>
<td align="left">body mass</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e013"><alternatives><graphic id="pcbi.1006044.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mover accent="true"><mml:mi>q</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula></td>
<td align="left">random unit vector</td>
</tr>
<tr>
<td align="left"><italic>Q</italic></td>
<td align="left">random unit vector</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e014"><alternatives><graphic id="pcbi.1006044.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula></td>
<td align="left">position vector</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e015"><alternatives><graphic id="pcbi.1006044.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>→</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math></alternatives></inline-formula></td>
<td align="left">estimated position of the starling relative to the falcon</td>
</tr>
<tr>
<td align="left"><italic>Re</italic></td>
<td align="left">Reynolds number</td>
</tr>
<tr>
<td align="left"><italic>S</italic><sub><italic>w</italic></sub></td>
<td align="left">wing area</td>
</tr>
<tr>
<td align="left"><italic>S</italic><sub><italic>b</italic></sub></td>
<td align="left">frontal projected body area</td>
</tr>
<tr>
<td align="left"><italic>t</italic></td>
<td align="left">time</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e016"><alternatives><graphic id="pcbi.1006044.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:mtext>T</mml:mtext><mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td>
<td align="left">magnitude of thrust—drag</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e017"><alternatives><graphic id="pcbi.1006044.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mtext>T</mml:mtext><mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi><mml:mi>f</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></td>
<td align="left">magnitude of thrust—drag when flapping</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e018"><alternatives><graphic id="pcbi.1006044.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mtext>T</mml:mtext><mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi><mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula></td>
<td align="left">magnitude of thrust—drag when gliding</td>
</tr>
<tr>
<td align="left"><italic>U</italic></td>
<td align="left">airspeed relative to wing motion</td>
</tr>
<tr>
<td align="left"><italic>U</italic><sub><italic>a</italic></sub></td>
<td align="left">airspeed</td>
</tr>
<tr>
<td align="left"><italic>U</italic><sub><italic>w</italic></sub></td>
<td align="left">speed of a single wing-blade</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e019"><alternatives><graphic id="pcbi.1006044.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula></td>
<td align="left">velocity vector</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e020"><alternatives><graphic id="pcbi.1006044.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msub><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>f</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>c</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula></td>
<td align="left">velocity vector of falcon</td>
</tr>
<tr>
<td align="left"><inline-formula id="pcbi.1006044.e021"><alternatives><graphic id="pcbi.1006044.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>v</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>→</mml:mo></mml:mover><mml:mi>d</mml:mi></mml:msub></mml:math></alternatives></inline-formula></td>
<td align="left">estimated velocity of the starling relative to the falcon</td>
</tr>
<tr>
<td align="left"><italic>v</italic><sub><italic>thresh</italic></sub></td>
<td align="left">threshold speed for torque constraints</td>
</tr>
<tr>
<td align="left"><italic>w</italic><sub><italic>b</italic></sub></td>
<td align="left">body width</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<sec id="sec015">
<title>A Kinematics</title>
<p>From a flight dynamics perspective, birds are implemented in the model as rigid bodies with six degrees of freedom. Model birds bank to turn, so as a simplification we take account only of their roll moment of inertia in modelling the rotational dynamics. The position vector <inline-formula id="pcbi.1006044.e022"><alternatives><graphic id="pcbi.1006044.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> determines the position of the bird in a right-handed inertial axis system (<italic>x</italic>, <italic>y</italic>, <italic>z</italic>) in which <inline-formula id="pcbi.1006044.e023"><alternatives><graphic id="pcbi.1006044.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>x</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006044.e024"><alternatives><graphic id="pcbi.1006044.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>y</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006044.e025"><alternatives><graphic id="pcbi.1006044.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>z</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are unit vectors defining the inertial axes, where <inline-formula id="pcbi.1006044.e026"><alternatives><graphic id="pcbi.1006044.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>z</mml:mi></mml:msub></mml:math></alternatives></inline-formula> points upward and therefore defines the bird’s altitude. The orientation of the bird is described by a rotating right-handed body-fixed axis system (<italic>x</italic>′, <italic>y</italic>′, <italic>z</italic>′), in which <inline-formula id="pcbi.1006044.e027"><alternatives><graphic id="pcbi.1006044.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006044.e028"><alternatives><graphic id="pcbi.1006044.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>y</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006044.e029"><alternatives><graphic id="pcbi.1006044.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>z</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula> are unit vectors directed along the principal axes of the bird, and called the roll, pitch, and yaw axes, respectively. The roll axis <inline-formula id="pcbi.1006044.e030"><alternatives><graphic id="pcbi.1006044.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula> is assumed to be aligned instantaneously with the bird’s forward velocity <inline-formula id="pcbi.1006044.e031"><alternatives><graphic id="pcbi.1006044.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, which amounts to assuming perfect pitch and yaw stability, and together with the yaw axis <inline-formula id="pcbi.1006044.e032"><alternatives><graphic id="pcbi.1006044.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>z</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula> is assumed to define the bird’s plane of bilateral symmetry.</p>
<p>The kinematics of the model are governed by Newton’s laws of motion. Numerical Verlet integration is used to solve the translational motion of the bird according to the following differential equations:
<disp-formula id="pcbi.1006044.e033"><alternatives><graphic id="pcbi.1006044.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
<disp-formula id="pcbi.1006044.e034"><alternatives><graphic id="pcbi.1006044.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
<disp-formula id="pcbi.1006044.e035"><alternatives><graphic id="pcbi.1006044.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <inline-formula id="pcbi.1006044.e036"><alternatives><graphic id="pcbi.1006044.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the position, <inline-formula id="pcbi.1006044.e037"><alternatives><graphic id="pcbi.1006044.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the velocity, <inline-formula id="pcbi.1006044.e038"><alternatives><graphic id="pcbi.1006044.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the acceleration, and <italic>m</italic> is the mass of the bird. The update time <italic>dt</italic> is the time step of the model at which both the numerical integration scheme and the flight forces are updated, and is set at 1 × 10<sup>−4</sup> s (see section L for convergence tests). The flight force <inline-formula id="pcbi.1006044.e039"><alternatives><graphic id="pcbi.1006044.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is composed as follows:
<disp-formula id="pcbi.1006044.e040"><alternatives><graphic id="pcbi.1006044.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>F</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>+</mml:mo> <mml:mi>L</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>z</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>-</mml:mo> <mml:mi>m</mml:mi> <mml:mi>g</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <inline-formula id="pcbi.1006044.e041"><alternatives><graphic id="pcbi.1006044.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the net thrust minus drag force, <italic>L</italic> the lift force, and <italic>g</italic> the gravitational acceleration. The time-varying aerodynamic forces <inline-formula id="pcbi.1006044.e042"><alternatives><graphic id="pcbi.1006044.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and <italic>L</italic> are outputted by the lift controller described in Section D.2. Model-birds respond to their normal acceleration command by reorienting their lift vector in a banked turn, applying lift asymmetrically so as to generate a net roll torque. To simplify the model, it is assumed that the exerted roll does not affect lift, thrust and drag. Wing retraction is assumed to be symmetric, so that asymmetric lift forces are produced only by angle of attack asymmetries, and the roll moment of inertia depends appropriately on the retraction of the wings. The rotation of the body about its roll axis is updated as follows:
<disp-formula id="pcbi.1006044.e043"><alternatives><graphic id="pcbi.1006044.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="normal">Ω</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi mathvariant="normal">Ω</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>ω</mml:mi> <mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
<disp-formula id="pcbi.1006044.e044"><alternatives><graphic id="pcbi.1006044.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ω</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ω</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
<disp-formula id="pcbi.1006044.e045"><alternatives><graphic id="pcbi.1006044.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>M</mml:mi> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:msub><mml:mi>I</mml:mi> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
where Ω is the roll angle, <italic>ω</italic> is the roll angular velocity, <italic>I</italic><sub><italic>x</italic>′</sub> is the total moment of inertia of the bird about its roll axis <inline-formula id="pcbi.1006044.e046"><alternatives><graphic id="pcbi.1006044.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula>, and <italic>M</italic><sub><italic>x</italic>′</sub> is the roll torque. The time-varying roll inertia <italic>I</italic><sub><italic>x</italic>′</sub> and roll torque <italic>M</italic><sub><italic>x</italic>′</sub> are outputted by the roll controller described in Section D.3. <xref ref-type="disp-formula" rid="pcbi.1006044.e045">Eq 8</xref> assumes that the body axes (<italic>x</italic>′, <italic>y</italic>′, <italic>z</italic>′) are principal axes, and that no inertial coupling occurs.</p>
</sec>
<sec id="sec016">
<title>B Vision</title>
<p>The model-falcon is assumed to apply a pure proportional navigation (PPN) guidance law, such that the function of its visual system is to estimate the angular rate of change <inline-formula id="pcbi.1006044.e047"><alternatives><graphic id="pcbi.1006044.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mover accent="true"><mml:mover accent="true"><mml:mi mathvariant="normal">λ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> in the line-of-sight to target <inline-formula id="pcbi.1006044.e048"><alternatives><graphic id="pcbi.1006044.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>f</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006044.e049"><alternatives><graphic id="pcbi.1006044.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>f</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the position of the falcon and <inline-formula id="pcbi.1006044.e050"><alternatives><graphic id="pcbi.1006044.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>p</mml:mi></mml:msub></mml:math></alternatives></inline-formula> the position of its prey. In other words, the function of the visual system is to estimate the angular rate of change in the line drawn from the model-falcon to the model-starling, which, importantly, is independent of gaze direction. Mathematically, the line-of-sight rate is calculated as:
<disp-formula id="pcbi.1006044.e051"><alternatives><graphic id="pcbi.1006044.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e051" xlink:type="simple"/><mml:math display="block" id="M51"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mover accent="true"><mml:mi mathvariant="normal">λ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mo>×</mml:mo> <mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
where <inline-formula id="pcbi.1006044.e052"><alternatives><graphic id="pcbi.1006044.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the line-of-sight vector measured with error, and where <inline-formula id="pcbi.1006044.e053"><alternatives><graphic id="pcbi.1006044.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the corresponding velocity of the falcon relative to its prey. Although we assume that the falcon holds an explicit representation of the line-of-sight rate <inline-formula id="pcbi.1006044.e054"><alternatives><graphic id="pcbi.1006044.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mover accent="true"><mml:mover accent="true"><mml:mi mathvariant="normal">λ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, it is important to note that our use of <xref ref-type="disp-formula" rid="pcbi.1006044.e051">Eq 9</xref> does not imply that the bird must necessarily hold an explicit representation of its own position and velocity relative to its prey. For example, the line-of-sight rate on the lefthand side of <xref ref-type="disp-formula" rid="pcbi.1006044.e051">Eq 9</xref> could be estimated directly from the retinal coordinates of the target, provided that the falcon is able to subtract from this the apparent motion of the target due to rotation of its retinal coordinate system. Rather, <xref ref-type="disp-formula" rid="pcbi.1006044.e051">Eq 9</xref> should be thought of as providing a convenient way of computing the line-of-sight rate in the simulation, which simultaneously allows us to model the effects of error in the falcon’s visual system phenomenologically.</p>
<p>We incorporate this visual error by defining a random error vector <inline-formula id="pcbi.1006044.e055"><alternatives><graphic id="pcbi.1006044.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> whose magnitude is drawn from the uniform distribution from 0 to <italic>ξ</italic> (see Section F for explanation and justification of the magnitude of <italic>ξ</italic>), and whose direction is drawn from the uniform circular distribution around the true line-of-sight vector <inline-formula id="pcbi.1006044.e056"><alternatives><graphic id="pcbi.1006044.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub></mml:math></alternatives></inline-formula>. This visual error vector <inline-formula id="pcbi.1006044.e057"><alternatives><graphic id="pcbi.1006044.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> explicitly models the effects of angular error in the estimation of the direction of the line-of-sight vector <inline-formula id="pcbi.1006044.e058"><alternatives><graphic id="pcbi.1006044.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, and is therefore scaled by the target range <inline-formula id="pcbi.1006044.e059"><alternatives><graphic id="pcbi.1006044.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> when computing the estimate of the line-of-sight vector required by <xref ref-type="disp-formula" rid="pcbi.1006044.e051">Eq 9</xref>:
<disp-formula id="pcbi.1006044.e060"><alternatives><graphic id="pcbi.1006044.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e060" xlink:type="simple"/><mml:math display="block" id="M60"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula></p>
<p>We calculate the corresponding relative velocity as:
<disp-formula id="pcbi.1006044.e061"><alternatives><graphic id="pcbi.1006044.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e061" xlink:type="simple"/><mml:math display="block" id="M61"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mi>d</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>τ</mml:mi></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
where <italic>τ</italic> is the differencing time, which we also take to represent the sampling rate from vision to guidance in the falcon.</p>
</sec>
<sec id="sec017">
<title>C Guidance</title>
<p>Changes in the model-falcon’s velocity are commanded by a pure proportional navigation (PPN) guidance law. The input to this guidance law is the estimated line-of-sight rate <inline-formula id="pcbi.1006044.e062"><alternatives><graphic id="pcbi.1006044.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mover accent="true"><mml:mover accent="true"><mml:mi mathvariant="normal">λ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> from <xref ref-type="disp-formula" rid="pcbi.1006044.e051">Eq 9</xref>, whilst the output from the guidance system to the controller is the commanded acceleration <inline-formula id="pcbi.1006044.e063"><alternatives><graphic id="pcbi.1006044.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula>. In three dimensions, the PPN guidance law is defined as:
<disp-formula id="pcbi.1006044.e064"><alternatives><graphic id="pcbi.1006044.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e064" xlink:type="simple"/><mml:math display="block" id="M64"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>N</mml:mi> <mml:mover accent="true"><mml:mover accent="true"><mml:mi mathvariant="normal">λ</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>→</mml:mo></mml:mover> <mml:mo>×</mml:mo> <mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where <inline-formula id="pcbi.1006044.e065"><alternatives><graphic id="pcbi.1006044.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the falcon’s velocity and <italic>N</italic> is a constant of proportionality called the navigation constant. The form of this equation is such that the acceleration <inline-formula id="pcbi.1006044.e066"><alternatives><graphic id="pcbi.1006044.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> commanded under PPN guidance is always perpendicular to the falcon’s velocity vector <inline-formula id="pcbi.1006044.e067"><alternatives><graphic id="pcbi.1006044.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mover accent="true"><mml:mi>v</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p>
<p>The guidance system of the model-starlings is described by one of three different kinds of forcing-function: straight flight, smooth maneuvers, and non-smooth maneuvers (see also <xref ref-type="fig" rid="pcbi.1006044.g001">Fig 1</xref>).</p>
<p><italic>C.1 Straight flight.</italic> In straight flight, acceleration is commanded on a constant heading drawn at random from a uniform circular distribution, and at a constant elevation drawn at random from a uniform distribution between ±2.5°. In combination with its random initial orientation, this forcing function causes the model-starling to turn towards an almost horizontal flight direction within 1 or 2 s of the start of the simulation, after which it flies in a straight line whilst maximizing its forward acceleration. The magnitude of the commanded acceleration <inline-formula id="pcbi.1006044.e068"><alternatives><graphic id="pcbi.1006044.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup></mml:math></alternatives></inline-formula> is such that its combination with gravitational acceleration does not exceed the starling’s maximum normal acceleration as calculated in Section D.1.</p>
<p><italic>C.2 Smooth maneuvers.</italic> In smooth turning, centripetal acceleration is commanded to the bird’s left or right, with oscillations in the magnitude of the commanded acceleration specified according to a harmonic forcing function. This smooth forcing function is described by the following equation:
<disp-formula id="pcbi.1006044.e069"><alternatives><graphic id="pcbi.1006044.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e069" xlink:type="simple"/><mml:math display="block" id="M69"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mtext>sin</mml:mtext> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mi>t</mml:mi></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mn>3</mml:mn></mml:msub></mml:msup> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>4</mml:mn></mml:msub> <mml:mi>κ</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
where <italic>t</italic> is the time in seconds, and <italic>κ</italic> is the difference between the current and initial altitude of the starling. The last term in this equation ensures that the starling always remains close to its starting altitude. The unit vector <inline-formula id="pcbi.1006044.e070"><alternatives><graphic id="pcbi.1006044.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is perpendicular to the model-starling’s velocity vector and is directed horizontally:
<disp-formula id="pcbi.1006044.e071"><alternatives><graphic id="pcbi.1006044.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e071" xlink:type="simple"/><mml:math display="block" id="M71"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>h</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mover accent="true"><mml:msub><mml:mi>e</mml:mi> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>→</mml:mo></mml:mover> <mml:mo>×</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>z</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mover accent="true"><mml:msub><mml:mi>e</mml:mi> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>→</mml:mo></mml:mover> <mml:mo>×</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>z</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula></p>
<p>The terms <italic>c</italic><sub>1</sub>, …, <italic>c</italic><sub>4</sub> in <xref ref-type="disp-formula" rid="pcbi.1006044.e069">Eq 13</xref> were optimized by varying them parametrically (see <xref ref-type="table" rid="pcbi.1006044.t003">Table 3</xref> for optimized settings) so as to maximize the mean magnitude of the normal acceleration, subject to the constraints that: 1. the mean roll rate remains below 30 rad s<sup>−2</sup>; 2. the starling exerts accelerations equivalently in all directions (see <xref ref-type="supplementary-material" rid="pcbi.1006044.s001">S1 Fig</xref>); 3. the starling flies within bounds of ±20 m of its initial altitude. The starling does not exert maximal normal acceleration at each time step, because it slows down when maneuvering, thereby decreasing the maximum normal acceleration in a future time step. The optimized smooth forcing function results in high load factors (mean load factor: 3.4) and low roll accelerations (mean roll acceleration magnitude: 27 rad s<sup>−2</sup>).</p>
<table-wrap id="pcbi.1006044.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.t003</object-id>
<label>Table 3</label>
<caption>
<title>Model settings.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006044.t003g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.t003" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">parameter</th>
<th align="left">setting</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><italic>dt</italic></td>
<td align="left">0.0001</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>1</sub></td>
<td align="left">0.7</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>2</sub></td>
<td align="left">3.5</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>3</sub></td>
<td align="left">0.13</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>4</sub></td>
<td align="left">1.5</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>5</sub></td>
<td align="left">0.008</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>6</sub></td>
<td align="left">0.99</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>7</sub></td>
<td align="left">1.6</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>8</sub></td>
<td align="left">0.1</td>
</tr>
<tr>
<td align="left"><italic>c</italic><sub>9</sub></td>
<td align="left">20</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p><italic>C.3 Non-smooth maneuvers.</italic> In non-smooth turning, acceleration of approximately constant magnitude is commanded in a stepwise fashion in a randomly varying direction close to the horizontal. The non-smooth function has the following equation:
<disp-formula id="pcbi.1006044.e072"><alternatives><graphic id="pcbi.1006044.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e072" xlink:type="simple"/><mml:math display="block" id="M72"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>q</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msub><mml:mi>c</mml:mi> <mml:mn>6</mml:mn></mml:msub> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>7</mml:mn></mml:msub> <mml:mi>κ</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
where <inline-formula id="pcbi.1006044.e073"><alternatives><graphic id="pcbi.1006044.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mover accent="true"><mml:mi>q</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a random unit vector that is updated by the following equation:
<disp-formula id="pcbi.1006044.e074"><alternatives><graphic id="pcbi.1006044.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e074" xlink:type="simple"/><mml:math display="block" id="M74"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mover accent="true"><mml:mi>q</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>i</mml:mi> <mml:mo>∼</mml:mo> <mml:mi>U</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>8</mml:mn></mml:msub> <mml:mover accent="true"><mml:mi>q</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>8</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mtext>otherwise</mml:mtext></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where <italic>U</italic> denotes sampling from a uniform distribution, and where <inline-formula id="pcbi.1006044.e075"><alternatives><graphic id="pcbi.1006044.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e075" xlink:type="simple"/><mml:math display="inline" id="M75"><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a unit vector pointing towards a random azimuth angle and elevation between −<italic>c</italic><sub>9</sub> and <italic>c</italic><sub>9</sub> degrees. The parameters <italic>c</italic><sub>5</sub>, ‥, <italic>c</italic><sub>9</sub> are optimized as for the smooth forcing function (see <xref ref-type="table" rid="pcbi.1006044.t003">Table 3</xref>), with the modification that the non-smooth forcing function also aims to maximize roll acceleration. The non-smooth forcing function results in similarly high load factors to the smooth forcing function (mean load factor: 3.4), but involves much higher roll accelerations (mean roll acceleration magnitude: 2012 rad s<sup>−2</sup>).</p>
</sec>
<sec id="sec018">
<title>D Control</title>
<p>The bird’s flight controller ensures that the acceleration commanded by the guidance law is achieved or approximated by making the appropriate adjustments to the wing motion and shape. The bird’s flight controller is subdivided into three subsystems determining weight support, lift control, and roll control, which we now discuss in turn.</p>
<p><italic>D.1 Weight support.</italic> To achieve a change in velocity with the magnitude and direction of the commanded acceleration, gravitational acceleration needs to be considered at each time point. Specifically, the sum of the centripetal acceleration due to lift and the component of gravitational acceleration that is perpendicular to the bird’s velocity should equate the commanded centripetal acceleration. Hence, to determine the required magnitude and direction of the lift force, gravitational acceleration is first subtracted from the commanded acceleration:
<disp-formula id="pcbi.1006044.e076"><alternatives><graphic id="pcbi.1006044.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e076" xlink:type="simple"/><mml:math display="block" id="M76"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>e</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>*</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mi>g</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
then projected onto the plane defined by the bird’s transverse and dorsoventral axes, <inline-formula id="pcbi.1006044.e077"><alternatives><graphic id="pcbi.1006044.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>y</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006044.e078"><alternatives><graphic id="pcbi.1006044.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>z</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1006044.e079"><alternatives><graphic id="pcbi.1006044.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e079" xlink:type="simple"/><mml:math display="block" id="M79"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>r</mml:mi> <mml:mi>o</mml:mi> <mml:mi>j</mml:mi> <mml:mi>e</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mspace width="4pt"/><mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>e</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>y</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>e</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>·</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>z</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula></p>
<p>The magnitude of the resulting acceleration <inline-formula id="pcbi.1006044.e080"><alternatives><graphic id="pcbi.1006044.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>r</mml:mi> <mml:mi>o</mml:mi> <mml:mi>j</mml:mi> <mml:mi>e</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is then signalled to the lift controller (described in Section D.2), whilst its direction is signalled to the roll controller (described in Section D.3).</p>
<p><italic>D.2 Lift control.</italic> Lift control is governed by the acceleration objective described in section E: maximize forward acceleration given current airspeed and body orientation, subject to the constraint that the lift needed to meet the guidance commands is exerted. This objective could be achieved in multiple ways, whether by varying the wingbeat kinematics when flapping, or by retracting the wings to reduce drag when gliding. In this section, the wing-beat averaged equations that determine which of these flight modes is selected (see section E for a derivation of these equations).</p>
<p>The magnitude of the desired lift <italic>L</italic>* is <inline-formula id="pcbi.1006044.e081"><alternatives><graphic id="pcbi.1006044.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:mrow><mml:mrow><mml:mi>m</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>r</mml:mi> <mml:mi>o</mml:mi> <mml:mi>j</mml:mi> <mml:mi>e</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Constraints on the achievable lift arise physiologically due to due to constraints on the torque forces that the flight muscles can sustain, and aerodynamically due to wing stall, where <italic>c</italic><sub><italic>l</italic>.<italic>max</italic></sub> is the lift coefficient at the stall limit. To calculate the maximum achievable lift for which the muscle torque constraints are not exceeded, we use the allometric scaling rule <italic>L</italic><sub>0</sub> = 1.7<italic>mg</italic>, where <italic>L</italic><sub>0</sub> is the maximum lift at maximum wing span [<xref ref-type="bibr" rid="pcbi.1006044.ref011">11</xref>] (see section G for a justification of the mechanical constraints in our model). In flapping flight, we assume no wing retraction, and thus <italic>L</italic><sub><italic>max</italic></sub> = <italic>L</italic><sub>0</sub> is the upper limit. In gliding flight, model-birds retract their wings, and the maximum achievable lift <italic>L</italic><sub><italic>max</italic></sub> is found by [<xref ref-type="bibr" rid="pcbi.1006044.ref011">11</xref>]:
<disp-formula id="pcbi.1006044.e082"><alternatives><graphic id="pcbi.1006044.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e082" xlink:type="simple"/><mml:math display="block" id="M82"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>S</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mo>.</mml:mo><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mi>ρ</mml:mi><mml:msup><mml:mi>v</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msub><mml:mi>b</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
<disp-formula id="pcbi.1006044.e083"><alternatives><graphic id="pcbi.1006044.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e083" xlink:type="simple"/><mml:math display="block" id="M83"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
<disp-formula id="pcbi.1006044.e084"><alternatives><graphic id="pcbi.1006044.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e084" xlink:type="simple"/><mml:math display="block" id="M84"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>l</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where <italic>b</italic><sub><italic>ml</italic></sub> is the wing span that maximizes lift, <italic>b</italic><sub><italic>max</italic></sub> and <italic>b</italic><sub><italic>min</italic></sub> are the minimum and maximum wing span respectively, <italic>S</italic><sub><italic>w</italic>.<italic>max</italic></sub> is the wing area at maximum span, and <italic>S</italic><sub><italic>w</italic>.<italic>ml</italic></sub> is the wing area that maximizes lift, <italic>ρ</italic> is the air density, and <italic>v</italic> is the airspeed. The achievable lift <italic>L</italic> is the lower value of the desired lift <italic>L</italic>* and the maximum achievable lift <italic>L</italic><sub><italic>max</italic></sub>. The following equations relate the achievable lift <italic>L</italic> to the maximum net thrust (or minimum drag):
<disp-formula id="pcbi.1006044.e085"><alternatives><graphic id="pcbi.1006044.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e085" xlink:type="simple"/><mml:math display="block" id="M85"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:mi>L</mml:mi></mml:mrow> <mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
<disp-formula id="pcbi.1006044.e086"><alternatives><graphic id="pcbi.1006044.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e086" xlink:type="simple"/><mml:math display="block" id="M86"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>)</mml:mo> <mml:mfrac><mml:msup><mml:mi>π</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mn>16</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msup><mml:mtext>sin</mml:mtext> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>l</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>o</mml:mi> <mml:mi>r</mml:mi> <mml:mi>q</mml:mi> <mml:mi>u</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>b</mml:mi> <mml:mi>o</mml:mi> <mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>f</mml:mi> <mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msub><mml:mi>S</mml:mi> <mml:mi>w</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <italic>c</italic><sub><italic>l</italic></sub> is the wingbeat-averaged lift coefficient, <italic>c</italic><sub><italic>l</italic>.<italic>max</italic></sub> is the maximum achievable wingbeat-averaged lift coefficient, <italic>c</italic><sub><italic>d</italic>.<italic>fric</italic></sub> is the friction drag coefficient on the wing, <italic>c</italic><sub><italic>d</italic>.<italic>body</italic></sub> is the total drag coefficient of the body, <italic>S</italic><sub><italic>w</italic></sub> is the maximum projected wing area, and <italic>S</italic><sub><italic>b</italic></sub> is the frontally projected body area, <inline-formula id="pcbi.1006044.e087"><alternatives><graphic id="pcbi.1006044.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e087" xlink:type="simple"/><mml:math display="inline" id="M87"><mml:mrow><mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the wing aspect-ratio, <italic>b</italic> is the actual wing span, <italic>θ</italic> is the stroke angle from the highest point of the wing-beat to the lowest point, <italic>f</italic> is the wingbeat frequency, and <italic>l</italic><sub><italic>w</italic></sub> is the wing length. The coefficient <italic>c</italic><sub><italic>torque</italic></sub> accounts for the constraints in torque forces that the flight muscles can sustain. The torque forces increase linearly with airspeed <italic>v</italic>, for a given wing-beat frequency and optimal wing-twist, and exceed the sustainable threshold at a point <italic>v</italic><sub><italic>thresh</italic></sub> which is determined through simulation of the blade-element model described in section E (note that this expression is almost equivalent to stating that the maximum available power for flight is constant across values of airspeed). The coefficient <italic>c</italic><sub><italic>torque</italic></sub> is calculated as:
<disp-formula id="pcbi.1006044.e088"><alternatives><graphic id="pcbi.1006044.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e088" xlink:type="simple"/><mml:math display="block" id="M88"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>o</mml:mi> <mml:mi>r</mml:mi> <mml:mi>q</mml:mi> <mml:mi>u</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mfrac><mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mi>h</mml:mi> <mml:mi>r</mml:mi> <mml:mi>e</mml:mi> <mml:mi>s</mml:mi> <mml:mi>h</mml:mi></mml:mrow></mml:msub> <mml:mi>v</mml:mi></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula></p>
<p>It is important to note that the wingbeat-averaged lift coefficient <italic>c</italic><sub><italic>l</italic></sub> can differ substantially from the local lift coefficient at a particular section of the wing at a particular time point in the wingbeat. For instance, when the downstroke delivers an upward lift force, and the upstroke a downward lift force of equal magnitude, <italic>c</italic><sub><italic>l</italic></sub> will be zero. When the bird is flapping, <italic>f</italic> is set to the maximum observed wingbeat frequency for the species, jointly with a stroke amplitude derived using allometric scaling rules (see <xref ref-type="table" rid="pcbi.1006044.t004">Table 4</xref>). When the bird glides, <italic>f</italic> = 0 by definition, and the wing span <italic>b</italic> is optimized to achieve <italic>L</italic> with the lowest amount of drag. The wing span <italic>b</italic> determines the wing area according to the relationship:
<disp-formula id="pcbi.1006044.e089"><alternatives><graphic id="pcbi.1006044.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e089" xlink:type="simple"/><mml:math display="block" id="M89"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
and determines the aspect ratio as:
<disp-formula id="pcbi.1006044.e090"><alternatives><graphic id="pcbi.1006044.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e090" xlink:type="simple"/><mml:math display="block" id="M90"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mi>S</mml:mi> <mml:mi>w</mml:mi></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula></p>
<table-wrap id="pcbi.1006044.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.t004</object-id>
<label>Table 4</label>
<caption>
<title>Morphological parameters of the bird species in the model.</title>
</caption>
<alternatives>
<graphic id="pcbi.1006044.t004g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.t004" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">parameter</th>
<th align="left">symbol</th>
<th align="left">peregrine falcon</th>
<th align="left"/>
<th align="left">common starling</th>
<th align="left"/>
</tr>
</thead>
<tbody>
<tr>
<td align="left">wingbeat frequency (hz)</td>
<td align="left">f</td>
<td align="left">5.1</td>
<td align="left"><xref ref-type="table-fn" rid="t004fn001"><sup>a</sup></xref> [<xref ref-type="bibr" rid="pcbi.1006044.ref051">51</xref>]</td>
<td align="left">10.5</td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref052">52</xref>]</td>
</tr>
<tr>
<td align="left">wing length (m)</td>
<td align="left"><italic>l</italic><sub><italic>w</italic></sub></td>
<td align="left">0.284</td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref051">51</xref>]</td>
<td align="left">0.185</td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref043">43</xref>]</td>
</tr>
<tr>
<td align="left">wing span (m)</td>
<td align="left">b</td>
<td align="left">0.873</td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref051">51</xref>]</td>
<td align="left">0.39</td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref043">43</xref>]</td>
</tr>
<tr>
<td align="left">body mass (kg)</td>
<td align="left"><italic>m</italic><sub><italic>b</italic></sub></td>
<td align="left">528 ⋅ 10<sup>−3</sup></td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref051">51</xref>]</td>
<td align="left">70 ⋅ 10<sup>−3</sup></td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref043">43</xref>]</td>
</tr>
<tr>
<td align="left">wing mass (kg)</td>
<td align="left"><italic>m</italic><sub><italic>w</italic></sub></td>
<td align="left">32 ⋅ 10<sup>−3</sup></td>
<td align="left"><xref ref-type="table-fn" rid="t004fn002"><sup>b</sup></xref> [<xref ref-type="bibr" rid="pcbi.1006044.ref043">43</xref>]</td>
<td align="left">3.7 ⋅ 10<sup>−3</sup></td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref043">43</xref>]</td>
</tr>
<tr>
<td align="left">body inertia (kg m<sup>2</sup>)</td>
<td align="left"><italic>I</italic><sub><italic>b</italic></sub></td>
<td align="left">448.0 ⋅ 10<sup>−6</sup></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn003"><sup>c</sup></xref></td>
<td align="left">15.65 ⋅ 10<sup>−6</sup></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn003"><sup>c</sup></xref></td>
</tr>
<tr>
<td align="left">extended wing inertia (<italic>kg</italic> <italic>m</italic><sup>2</sup>)</td>
<td align="left"><italic>I</italic><sub><italic>wing</italic></sub></td>
<td align="left">296.6 ⋅ 10<sup>−6</sup></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn004"><sup>d</sup></xref></td>
<td align="left">14.55 ⋅ 10<sup>−6</sup></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn004"><sup>d</sup></xref></td>
</tr>
<tr>
<td align="left">wing summation term <xref ref-type="disp-formula" rid="pcbi.1006044.e097">Eq 32</xref></td>
<td align="left">J</td>
<td align="left">2501.3 ⋅ 10<sup>−6</sup></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn004"><sup>d</sup></xref></td>
<td align="left">152.8 ⋅ 10<sup>−6</sup></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn004"><sup>d</sup></xref></td>
</tr>
<tr>
<td align="left">wing area (m<sup>2</sup>)</td>
<td align="left"><italic>S</italic><sub><italic>w</italic></sub></td>
<td align="left">89.7 ⋅ 10<sup>−3</sup></td>
<td align="left"/>
<td align="left">24.14 ⋅ 10<sup>−3</sup></td>
<td align="left"/>
</tr>
<tr>
<td align="left">wing aspect ratio</td>
<td align="left"><inline-formula id="pcbi.1006044.e191"><alternatives><graphic id="pcbi.1006044.e191g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e191" xlink:type="simple"/><mml:math display="inline" id="M191"><mml:mrow><mml:mi>A</mml:mi><mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula></td>
<td align="left">8.49</td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref051">51</xref>]</td>
<td align="left">6.40</td>
<td align="left"/>
</tr>
<tr>
<td align="left">angular flapping amplitude (rad)</td>
<td align="left"><italic>θ</italic></td>
<td align="left">0.4<italic>π</italic></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn005"><sup>e</sup></xref></td>
<td align="left">0.47<italic>π</italic></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn007"><sup>g</sup></xref></td>
</tr>
<tr>
<td align="left">body area (m<sup>2</sup>)</td>
<td align="left"><italic>S</italic><sub><italic>b</italic></sub></td>
<td align="left">4.275 ⋅ 10<sup>−3</sup></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn006"><sup>f</sup></xref></td>
<td align="left">2.1 ⋅ 10<sup>−3</sup></td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref053">53</xref>]</td>
</tr>
<tr>
<td align="left">body drag coefficient</td>
<td align="left"><italic>c</italic><sub><italic>body</italic></sub></td>
<td align="left">0.14</td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref044">44</xref>]</td>
<td align="left">0.24</td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn008"><sup>h</sup></xref> [<xref ref-type="bibr" rid="pcbi.1006044.ref053">53</xref>]</td>
</tr>
<tr>
<td align="left">wing friction drag coefficient</td>
<td align="left"><italic>c</italic><sub><italic>fric</italic></sub></td>
<td align="left">14 ⋅ 10<sup>−3</sup></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn009"><sup>i</sup></xref></td>
<td align="left">9.35 ⋅ 10<sup>−3</sup></td>
<td align="left">
<xref ref-type="table-fn" rid="t004fn009"><sup>i</sup></xref></td>
</tr>
<tr>
<td align="left">speed at which torque constrains thrust (ms<sup>−1</sup>)</td>
<td align="left"><italic>v</italic><sub><italic>thresh</italic></sub></td>
<td align="left">16.5</td>
<td align="left"/>
<td align="left">11.62</td>
<td align="left"/>
</tr>
<tr>
<td align="left">maximum steady lift coefficient</td>
<td align="left"><italic>c</italic><sub><italic>l</italic>.<italic>max</italic></sub></td>
<td align="left">1.6</td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref044">44</xref>]</td>
<td align="left">1.6</td>
<td align="left">[<xref ref-type="bibr" rid="pcbi.1006044.ref044">44</xref>]</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t004fn001">
<p><sup>a</sup> maximum from range in Table 5 of [<xref ref-type="bibr" rid="pcbi.1006044.ref051">51</xref>]</p>
</fn>
<fn id="t004fn002">
<p><sup>b</sup> estimated from [<xref ref-type="bibr" rid="pcbi.1006044.ref043">43</xref>] by interpolating between allometrically similar birds</p>
</fn>
<fn id="t004fn003">
<p><sup>c</sup> see <xref ref-type="disp-formula" rid="pcbi.1006044.e172">Eq 82</xref> for the allometric scaling law applied</p>
</fn>
<fn id="t004fn004">
<p><sup>d</sup> recalculated for a peregrine falcon and common starling, assuming mass distrubitions along the wing as in [<xref ref-type="bibr" rid="pcbi.1006044.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref041">41</xref>]</p>
</fn>
<fn id="t004fn005">
<p><sup>e</sup> estimated by analyzing slow-motion videos of peregrine falcons</p>
</fn>
<fn id="t004fn006">
<p><sup>f</sup> allometric scaling law in <xref ref-type="disp-formula" rid="pcbi.1006044.e170">Eq 80</xref></p>
</fn>
<fn id="t004fn007">
<p><sup>g</sup> log<sub>10</sub> (<italic>θ</italic>/180) = 1.83–0.24 log<sub>10</sub> (<italic>b</italic>) [<xref ref-type="bibr" rid="pcbi.1006044.ref054">54</xref>]</p>
</fn>
<fn id="t004fn008">
<p><sup>h</sup> Literature estimates range from 0.2 to 0.35 and depend strongly on the measurement of the frontally projected area. We have taken the measurements of both variables from the same paper [<xref ref-type="bibr" rid="pcbi.1006044.ref053">53</xref>].</p>
</fn>
<fn id="t004fn009">
<p><sup>i</sup> Friction drag depends on the Reynolds number (see section J).</p>
</fn>
</table-wrap-foot>
</table-wrap>
<p>To find the optimal wing span <italic>b</italic>* that achieves a given lift <italic>L</italic> with the least amount of drag, the following steps are applied. First <italic>b</italic>* is calculated by:
<disp-formula id="pcbi.1006044.e091"><alternatives><graphic id="pcbi.1006044.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e091" xlink:type="simple"/><mml:math display="block" id="M91"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>b</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mroot><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>8</mml:mn> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>L</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:mi>π</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>f</mml:mi> <mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mn>3</mml:mn></mml:mroot></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
(see Section J for derivation), and then <italic>b</italic>* is truncated if required to fall within the closed interval [<italic>b</italic><sub><italic>min</italic></sub>, <italic>b</italic><sub><italic>max</italic></sub>]. An additional upper bound on <italic>b</italic>* is the wingspan <italic>b</italic> at which the torque constraint is exceeded when exerting <italic>L</italic>:
<disp-formula id="pcbi.1006044.e092"><alternatives><graphic id="pcbi.1006044.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e092" xlink:type="simple"/><mml:math display="block" id="M92"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>b</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>b</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:mi>L</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
<italic>c</italic><sub><italic>l</italic></sub> is subsequently calculated by <xref ref-type="disp-formula" rid="pcbi.1006044.e085">Eq 22</xref>. Again, <italic>c</italic><sub><italic>l</italic></sub> is truncated not to exceed <italic>c</italic><sub><italic>l</italic>.<italic>max</italic></sub> and if truncated, <italic>b</italic>* is recalculated as:
<disp-formula id="pcbi.1006044.e093"><alternatives><graphic id="pcbi.1006044.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e093" xlink:type="simple"/><mml:math display="block" id="M93"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>b</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(29)</label></disp-formula>
and <italic>b</italic>* is truncated again to fall within the closed interval [<italic>b</italic><sub><italic>min</italic></sub>, <italic>b</italic><sub><italic>max</italic></sub>]. The bird chooses either to flap or to glide according to which mode of flight achieves or most closely approximates <italic>L</italic>* with the largest net thrust (or least drag).</p>
<p><italic>D.3 Roll control.</italic> The roll controller determines the roll acceleration used to reach the desired bank angle. The desired direction of roll by the bird is determined by calculating the angle between <italic>a</italic><sub><italic>projected</italic></sub> and <inline-formula id="pcbi.1006044.e094"><alternatives><graphic id="pcbi.1006044.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e094" xlink:type="simple"/><mml:math display="inline" id="M94"><mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>z</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1006044.e095"><alternatives><graphic id="pcbi.1006044.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e095" xlink:type="simple"/><mml:math display="block" id="M95"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>γ</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>r</mml:mi> <mml:mi>o</mml:mi> <mml:mi>j</mml:mi> <mml:mi>e</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>×</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>e</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mi>z</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>r</mml:mi> <mml:mi>o</mml:mi> <mml:mi>j</mml:mi> <mml:mi>e</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(30)</label></disp-formula></p>
<p>To roll in this direction, the bird must apply the appropriate roll acceleration. As <xref ref-type="disp-formula" rid="pcbi.1006044.e045">Eq 8</xref> implies, roll acceleration is determined by the the aerodynamic roll torque <italic>M</italic><sub><italic>x</italic>′</sub> and the roll moment of inertia <italic>I</italic><sub><italic>x</italic>′</sub>. The inertia is dependent on the wing span <italic>b</italic>, whilst the net torque depends on the differential lift exertion between left and right wings, together with the wing span. Therefore, the goal of the roll controller is to find the optimal wing span and lift exertion to reach the desired bank angle in the minimum amount of time. We assume that on average the lift force acts at half the wing length, thus the total torque <italic>M</italic> generated by one wing is:
<disp-formula id="pcbi.1006044.e096"><alternatives><graphic id="pcbi.1006044.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e096" xlink:type="simple"/><mml:math display="block" id="M96"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mi>b</mml:mi> <mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(31)</label></disp-formula></p>
<p>The roll moment of inertia is calculated as:
<disp-formula id="pcbi.1006044.e097"><alternatives><graphic id="pcbi.1006044.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e097" xlink:type="simple"/><mml:math display="block" id="M97"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi>ϕ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mo>.</mml:mo> <mml:mn>4</mml:mn> <mml:mo>·</mml:mo> <mml:msup><mml:mn>10</mml:mn> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:msup> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>70</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>098</mml:mn> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>35</mml:mn></mml:mrow></mml:msubsup> <mml:mi>J</mml:mi> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(32)</label></disp-formula>
(see section H for justification), where <italic>I</italic><sub><italic>x</italic>′</sub> is the total moment of inertia about the roll axis, <italic>I</italic><sub><italic>b</italic></sub> is the body inertia, <italic>I</italic><sub><italic>wing</italic></sub> the inertia of one wing around the shoulder, <italic>ϕ</italic> the proportion of wing retraction, <italic>m</italic><sub><italic>w</italic></sub> the mass of the wing, <italic>m</italic><sub><italic>b</italic></sub> the body mass, and <italic>J</italic> = ∑<sub><italic>i</italic></sub> <italic>m</italic><sub><italic>i</italic></sub> <italic>r</italic><sub><italic>i</italic></sub>, where <italic>r</italic> denotes the distance from the bird’s shoulder when the wing is fully extended and where <italic>m</italic><sub><italic>i</italic></sub> denotes the mass of a blade element of the wing at that point.</p>
<p>To obey the guidance law, the bird must roll until it reaches the desired bank angle, as dictated by the guidance algorithm, and must then stop rolling. The faster the bird reaches the desired bank angle, the more accurately it obeys its guidance law. The fastest way to reach a given bank angle is to accelerate maximally until some point <italic>q</italic>, and then decelerate maximally (called Bang-Bang control). The highest roll acceleration is achieved at the wing span that maximizes lift production (see section I for a proof). Given this maximal acceleration, the bird must know this point <italic>q</italic> in the roll at which it should start to decelerate in order to reach a roll velocity of zero at the desired bank angle. We calculate <italic>q</italic> as follows. Let <italic>ω</italic> be the roll (angular) velocity and <italic>γ</italic> (see <xref ref-type="disp-formula" rid="pcbi.1006044.e095">Eq 30</xref>) be the angular position relative to the desired bank angle. The angular acceleration <inline-formula id="pcbi.1006044.e098"><alternatives><graphic id="pcbi.1006044.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is either the positive or negative maximal angular acceleration. The angular velocity is
<disp-formula id="pcbi.1006044.e099"><alternatives><graphic id="pcbi.1006044.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e099" xlink:type="simple"/><mml:math display="block" id="M99"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ω</mml:mi> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(33)</label></disp-formula>
<disp-formula id="pcbi.1006044.e100"><alternatives><graphic id="pcbi.1006044.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e100" xlink:type="simple"/><mml:math display="block" id="M100"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>γ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:msup><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>+</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mi>t</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(34)</label></disp-formula>
where <italic>ω</italic><sub>0</sub> is the angular velocity at the current time step. We calculate the time <italic>t</italic> it takes to reach <italic>γ</italic> by solving
<disp-formula id="pcbi.1006044.e101"><alternatives><graphic id="pcbi.1006044.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e101" xlink:type="simple"/><mml:math display="block" id="M101"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>±</mml:mo> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>γ</mml:mi></mml:mrow></mml:msqrt></mml:mrow> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(35)</label></disp-formula>
where the minimum positive <italic>t</italic> is the answer. If <italic>q</italic> (the point at which the bird should start to decelerate) is exceeded, there are 2 positive solutions for <xref ref-type="disp-formula" rid="pcbi.1006044.e101">Eq 35</xref>, according to whether <italic>a</italic> has the opposite or same sign as <italic>γ</italic> (which is the case when turning towards the desired bank angle and decelerating). If the bird has not yet reached <italic>q</italic>, then there are no real solutions. These equations have no real solutions when:
<disp-formula id="pcbi.1006044.e102"><alternatives><graphic id="pcbi.1006044.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e102" xlink:type="simple"/><mml:math display="block" id="M102"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>γ</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(36)</label></disp-formula></p>
<p>Thus the following rule obeys Bang-Bang control: <inline-formula id="pcbi.1006044.e103"><alternatives><graphic id="pcbi.1006044.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> should have the same sign as <italic>γ</italic>, unless both <italic>ω</italic> has the same sign as <italic>γ</italic> and <inline-formula id="pcbi.1006044.e104"><alternatives><graphic id="pcbi.1006044.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mn>2</mml:mn> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>γ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, in which case <inline-formula id="pcbi.1006044.e105"><alternatives><graphic id="pcbi.1006044.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover></mml:math></alternatives></inline-formula> should have the opposite sign. When <inline-formula id="pcbi.1006044.e106"><alternatives><graphic id="pcbi.1006044.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mn>0</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mn>2</mml:mn> <mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mi>γ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, the equations have real and positive solutions when decelerating, which means that <italic>γ</italic> is reached within a positive time. The first moment in time when this is the case must be closest to the point <italic>q</italic>. Finally, the output of the controllers is fed to the kinematics, which completes the feedback loop.</p>
</sec>
<sec id="sec019">
<title>E Aerodynamics</title>
<p>We used a multistage modeling approach to model the aerodynamic forces on the birds. First, we constructed a blade-element model of flapping and gliding flight, assuming sinusoidal wingtip kinematics and quasi-steady flow [<xref ref-type="bibr" rid="pcbi.1006044.ref030">30</xref>–<xref ref-type="bibr" rid="pcbi.1006044.ref036">36</xref>]. Since our model-birds mostly flew at low Strouhal numbers (St &lt; 0.22), this quasi-steady analysis provides sufficient accuracy for our modeling objectives [<xref ref-type="bibr" rid="pcbi.1006044.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref037">37</xref>]. We assumed that the relation between the lift coefficient and induced drag coefficient was that of an elliptical wing under classical lifting-line theory [<xref ref-type="bibr" rid="pcbi.1006044.ref038">38</xref>], and incorporated realistic physical constraints on the maximum aerodynamic torque, to account for the limits of sustained force production by the pectoralis and supracoracoideus [<xref ref-type="bibr" rid="pcbi.1006044.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref040">40</xref>]. All of the morphological parameters needed to model body, friction, and induced drag, as well as lift and thrust were derived from empirical estimates [<xref ref-type="bibr" rid="pcbi.1006044.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref041">41</xref>–<xref ref-type="bibr" rid="pcbi.1006044.ref045">45</xref>], or estimated using allometric scaling laws. We then used a combination of regression statistics and analytic methods to derive a set of equations relating the maximum forward acceleration over a wingbeat to the bird’s load factor (i.e. lift divided by body weight) and airspeed (<xref ref-type="fig" rid="pcbi.1006044.g007">Fig 7a</xref>). To determine the maximum forward acceleration for a given load factor and airspeed, we optimized the time-varying wing twist and mean angle of attack, as well as the stroke plane, and whether the bird should flap at the maximum wingbeat frequency or glide and retract its wings. To account for errors in control, we modified the load factor by a multiplicative error term (<italic>χ</italic>) proportional to the rate of change in the lift coefficient, setting <italic>χ</italic> = 0 in our baseline model. Here, we present a derivation of the time-averaged equation (<xref ref-type="disp-formula" rid="pcbi.1006044.e086">Eq 23</xref>) that we used in section D.</p>
<fig id="pcbi.1006044.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.g007</object-id>
<label>Fig 7</label>
<caption>
<title/>
<p>(a) Look-up table for the accelerations due to the aerodynamic forces acting on the falcon. At each model time-step, the falcon maximizes forward acceleration (minimizes deceleration), given its forward speed and with the constraint that load factor is set to achieve the net commanded acceleration by the guidance law. If this constraint cannot be met (i.e. if it is unfeasible due to aerodynamics or high resulting torque forces), the closest approximation of the load factor is chosen. In the blade-element model, the falcon optimizes the wing twist, the wing’s angle-of-attack, the wingbeat frequency and the wing retraction. Inside the trapezoidal contour, the falcon flaps at maximal wingbeat frequency, and outside it the falcon glides. Above the contour, flapping results in too high torque forces on the wing. Gravity is excluded from the accelerations in the figure. (b) The partial derivative of forward aerodynamic acceleration with respect to load factor, termed the “aerodynamic deceleration penalty”.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.g007" xlink:type="simple"/>
</fig>
<p>The goal is to come up with a simple approximate function
<disp-formula id="pcbi.1006044.e107"><alternatives><graphic id="pcbi.1006044.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e107" xlink:type="simple"/><mml:math display="block" id="M107"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi> <mml:mo>=</mml:mo> <mml:mi>f</mml:mi> <mml:mo>(</mml:mo> <mml:mi>L</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>μ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(37)</label></disp-formula>
Where <inline-formula id="pcbi.1006044.e108"><alternatives><graphic id="pcbi.1006044.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is the time-averaged maximum thrust minus drag, <italic>L</italic> is the lift, <italic>v</italic> the airspeed, and <inline-formula id="pcbi.1006044.e109"><alternatives><graphic id="pcbi.1006044.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e109" xlink:type="simple"/><mml:math display="inline" id="M109"><mml:mover accent="true"><mml:mi>μ</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is a vector of morphological parameters that can be gathered empirically.</p>
<p><italic>E.1 Assumptions.</italic> We assume the following aerodynamic and kinematic properties. For each blade-element the equations for lift and drag are:
<disp-formula id="pcbi.1006044.e110"><alternatives><graphic id="pcbi.1006044.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e110" xlink:type="simple"/><mml:math display="block" id="M110"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>U</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(38)</label></disp-formula>
<disp-formula id="pcbi.1006044.e111"><alternatives><graphic id="pcbi.1006044.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e111" xlink:type="simple"/><mml:math display="block" id="M111"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>D</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mi>S</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>U</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(39)</label></disp-formula>
Where <italic>S</italic>(<italic>i</italic>) denotes the total area of the element <italic>i</italic>, and <italic>U</italic>(<italic>i</italic>, <italic>p</italic>) is the speed of air relative to the (moving) blade at point <italic>p</italic> of the wing-beat cycle. <inline-formula id="pcbi.1006044.e112"><alternatives><graphic id="pcbi.1006044.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:mrow><mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is defined to be perpendicular to <inline-formula id="pcbi.1006044.e113"><alternatives><graphic id="pcbi.1006044.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> in the plane spanned by the blade, while <inline-formula id="pcbi.1006044.e114"><alternatives><graphic id="pcbi.1006044.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:mrow><mml:mover accent="true"><mml:mi>D</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is parallel to <inline-formula id="pcbi.1006044.e115"><alternatives><graphic id="pcbi.1006044.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mrow><mml:mover accent="true"><mml:mi>U</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and has the opposite sign. The drag coefficient <italic>c</italic><sub><italic>d</italic></sub> is composed of the body, induced and wing-friction drag coefficients:
<disp-formula id="pcbi.1006044.e116"><alternatives><graphic id="pcbi.1006044.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e116" xlink:type="simple"/><mml:math display="block" id="M116"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>d</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>b</mml:mi> <mml:mi>o</mml:mi> <mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi> <mml:mi>c</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>f</mml:mi> <mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(40)</label></disp-formula>
where the body drag coefficient <italic>c</italic><sub><italic>d</italic>.<italic>body</italic></sub> is referenced to the body’s frontal projected area <italic>S</italic><sub><italic>b</italic></sub>. The induced drag coefficient <italic>c</italic><sub><italic>d</italic>.<italic>induced</italic></sub> is related to <italic>c</italic><sub><italic>l</italic></sub> by [<xref ref-type="bibr" rid="pcbi.1006044.ref046">46</xref>]:
<disp-formula id="pcbi.1006044.e117"><alternatives><graphic id="pcbi.1006044.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e117" xlink:type="simple"/><mml:math display="block" id="M117"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>d</mml:mi> <mml:mi>u</mml:mi> <mml:mi>c</mml:mi> <mml:mi>e</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(41)</label></disp-formula>
which is the classical limit from lifting line theory for a wing with an elliptical lift distribution, and we apply Blasius’ solution for laminar boundary layer of a flat plate [<xref ref-type="bibr" rid="pcbi.1006044.ref047">47</xref>] to obtain the friction drag coefficient:
<disp-formula id="pcbi.1006044.e118"><alternatives><graphic id="pcbi.1006044.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e118" xlink:type="simple"/><mml:math display="block" id="M118"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>f</mml:mi> <mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi> <mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mi>o</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>328</mml:mn></mml:mrow> <mml:msqrt><mml:mrow><mml:mi>R</mml:mi> <mml:mi>e</mml:mi></mml:mrow></mml:msqrt></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(42)</label></disp-formula>
where <italic>Re</italic> denotes the Reynolds number, which is calculated as
<disp-formula id="pcbi.1006044.e119"><alternatives><graphic id="pcbi.1006044.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e119" xlink:type="simple"/><mml:math display="block" id="M119"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>R</mml:mi> <mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>ρ</mml:mi> <mml:mi>U</mml:mi></mml:mrow> <mml:mi>μ</mml:mi></mml:mfrac> <mml:msqrt><mml:mfrac><mml:mi>S</mml:mi> <mml:mrow><mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac></mml:msqrt></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(43)</label></disp-formula>
with <italic>μ</italic> the dynamic viscosity of the air. Furthermore, the lift coefficient <italic>c</italic><sub><italic>l</italic></sub> is related to the angle of attack <italic>α</italic> by the higher-order lifting line theory [<xref ref-type="bibr" rid="pcbi.1006044.ref024">24</xref>]:
<disp-formula id="pcbi.1006044.e120"><alternatives><graphic id="pcbi.1006044.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e120" xlink:type="simple"/><mml:math display="block" id="M120"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>α</mml:mi></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mo>/</mml:mo> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi> <mml:mo>+</mml:mo> <mml:mn>16</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow> <mml:mo>-</mml:mo> <mml:mn>9</mml:mn> <mml:mo>/</mml:mo> <mml:mn>8</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(44)</label></disp-formula></p>
<p>We further assume that the wing shape is elliptical, that there is no side-slip, that the airfoil is symmetric and that the wing-motion is sinusoidal.</p>
<p><italic>E.2 Optimization problem.</italic> Our aim is to find the function <inline-formula id="pcbi.1006044.e121"><alternatives><graphic id="pcbi.1006044.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> that maximizes <inline-formula id="pcbi.1006044.e122"><alternatives><graphic id="pcbi.1006044.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> under several constraints. Because the friction drag and body drag are independent of <italic>c</italic><sub><italic>l</italic></sub>, we maximize <inline-formula id="pcbi.1006044.e123"><alternatives><graphic id="pcbi.1006044.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e123" xlink:type="simple"/><mml:math display="inline" id="M123"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, which is thrust minus induced drag. The objective function is a double integral over the wing length <italic>i</italic> and wing-beat cycle <italic>p</italic>:
<disp-formula id="pcbi.1006044.e124"><alternatives><graphic id="pcbi.1006044.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e124" xlink:type="simple"/><mml:math display="block" id="M124"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msubsup> <mml:mn>2</mml:mn> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>w</mml:mi></mml:msub></mml:msubsup> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>i</mml:mi> <mml:mi>d</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(45)</label></disp-formula>
with the equality constraint that lift equals the desired lift:
<disp-formula id="pcbi.1006044.e125"><alternatives><graphic id="pcbi.1006044.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e125" xlink:type="simple"/><mml:math display="block" id="M125"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>*</mml:mo> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:msubsup> <mml:mn>2</mml:mn> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>w</mml:mi></mml:msub></mml:msubsup> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>4</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>i</mml:mi> <mml:mi>d</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(46)</label></disp-formula>
and the inequality constraints
<disp-formula id="pcbi.1006044.e126"><alternatives><graphic id="pcbi.1006044.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e126" xlink:type="simple"/><mml:math display="block" id="M126"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>∀</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>:</mml:mo> <mml:mi>p</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(47)</label></disp-formula>
<disp-formula id="pcbi.1006044.e127"><alternatives><graphic id="pcbi.1006044.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e127" xlink:type="simple"/><mml:math display="block" id="M127"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>w</mml:mi></mml:msub></mml:msubsup> <mml:mrow><mml:mi>i</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>i</mml:mi> <mml:msub><mml:mi>c</mml:mi> <mml:mn>4</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>i</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mo>∀</mml:mo> <mml:mi>p</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(48)</label></disp-formula>
where <italic>c</italic><sub><italic>l</italic>.<italic>max</italic></sub> is the lift coefficient at the stall limit, <italic>t</italic><sub><italic>max</italic></sub> is the maximum torque that the flight muscles can sustain, and where
<disp-formula id="pcbi.1006044.e128"><alternatives><graphic id="pcbi.1006044.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e128" xlink:type="simple"/><mml:math display="block" id="M128"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msqrt><mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>U</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(49)</label></disp-formula>
<disp-formula id="pcbi.1006044.e129"><alternatives><graphic id="pcbi.1006044.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e129" xlink:type="simple"/><mml:math display="block" id="M129"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mn>2</mml:mn> <mml:msqrt><mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt> <mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>U</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(50)</label></disp-formula>
<disp-formula id="pcbi.1006044.e130"><alternatives><graphic id="pcbi.1006044.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e130" xlink:type="simple"/><mml:math display="block" id="M130"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>3</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mn>2</mml:mn> <mml:msqrt><mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>U</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(51)</label></disp-formula>
<disp-formula id="pcbi.1006044.e131"><alternatives><graphic id="pcbi.1006044.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e131" xlink:type="simple"/><mml:math display="block" id="M131"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>4</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msqrt><mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt> <mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>U</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(52)</label></disp-formula>
where <italic>U</italic><sub><italic>w</italic></sub>(<italic>i</italic>, <italic>p</italic>) is the speed of blade-element <italic>i</italic> in section <italic>p</italic> of the wing-beat cycle, <italic>U</italic><sub><italic>a</italic></sub> is the airspeed and <inline-formula id="pcbi.1006044.e132"><alternatives><graphic id="pcbi.1006044.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:mrow><mml:msup><mml:mi>U</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. To start solving this objective function, we make a few observations. First, the unconstrained optimal <inline-formula id="pcbi.1006044.e133"><alternatives><graphic id="pcbi.1006044.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e133" xlink:type="simple"/><mml:math display="inline" id="M133"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> can be written as
<disp-formula id="pcbi.1006044.e134"><alternatives><graphic id="pcbi.1006044.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e134" xlink:type="simple"/><mml:math display="block" id="M134"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(53)</label></disp-formula>
and when <italic>U</italic><sub><italic>a</italic></sub> ≫ <italic>U</italic><sub><italic>w</italic></sub>(<italic>i</italic>, <italic>p</italic>), the value of the unconstrained objective function remains constant with respect to changes in airspeed and <inline-formula id="pcbi.1006044.e135"><alternatives><graphic id="pcbi.1006044.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e135" xlink:type="simple"/><mml:math display="inline" id="M135"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> converges to zero. Also, because the wings are symmetric, the maximum of the unconstrained <inline-formula id="pcbi.1006044.e136"><alternatives><graphic id="pcbi.1006044.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> always corresponds to <italic>L</italic> = 0. Therefore, to get the maximum value of the unconstrained <inline-formula id="pcbi.1006044.e137"><alternatives><graphic id="pcbi.1006044.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e137" xlink:type="simple"/><mml:math display="inline" id="M137"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, we solve for <inline-formula id="pcbi.1006044.e138"><alternatives><graphic id="pcbi.1006044.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:mrow><mml:msub><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>→</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:msub> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. First, we rewrite the equation:
<disp-formula id="pcbi.1006044.e139"><alternatives><graphic id="pcbi.1006044.e139g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e139" xlink:type="simple"/><mml:math display="block" id="M139"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mfrac><mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mfrac><mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mfrac> <mml:mfrac><mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:msup><mml:mn>2</mml:mn> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mfrac> <mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(54)</label></disp-formula>
where <inline-formula id="pcbi.1006044.e140"><alternatives><graphic id="pcbi.1006044.e140g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e140" xlink:type="simple"/><mml:math display="inline" id="M140"><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Removing all brackets:
<disp-formula id="pcbi.1006044.e141"><alternatives><graphic id="pcbi.1006044.e141g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e141" xlink:type="simple"/><mml:math display="block" id="M141"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>4</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>4</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>3</mml:mn></mml:msubsup> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mrow><mml:mn>4</mml:mn> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(55)</label></disp-formula></p>
<p>We can note that:
<disp-formula id="pcbi.1006044.e142"><alternatives><graphic id="pcbi.1006044.e142g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e142" xlink:type="simple"/><mml:math display="block" id="M142"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>→</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(56)</label></disp-formula>
and
<disp-formula id="pcbi.1006044.e143"><alternatives><graphic id="pcbi.1006044.e143g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e143" xlink:type="simple"/><mml:math display="block" id="M143"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>→</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:munder> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msqrt><mml:mrow><mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:msqrt> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>a</mml:mi> <mml:mn>3</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(57)</label></disp-formula></p>
<p>Therefore
<disp-formula id="pcbi.1006044.e144"><alternatives><graphic id="pcbi.1006044.e144g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e144" xlink:type="simple"/><mml:math display="block" id="M144"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">lim</mml:mo> <mml:mrow><mml:msub><mml:mi>U</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>→</mml:mo> <mml:mi>∞</mml:mi></mml:mrow></mml:munder> <mml:mi>T</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>4</mml:mn></mml:mfrac> <mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>4</mml:mn></mml:mfrac> <mml:msub><mml:mi>c</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mn>5</mml:mn></mml:msub> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(58)</label></disp-formula></p>
<p>Thus
<disp-formula id="pcbi.1006044.e145"><alternatives><graphic id="pcbi.1006044.e145g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e145" xlink:type="simple"/><mml:math display="block" id="M145"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>π</mml:mi> <mml:mn>8</mml:mn></mml:mfrac> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi> <mml:mi>ρ</mml:mi> <mml:mi>S</mml:mi> <mml:msubsup><mml:mi>U</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(59)</label></disp-formula>
which is
<disp-formula id="pcbi.1006044.e146"><alternatives><graphic id="pcbi.1006044.e146g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e146" xlink:type="simple"/><mml:math display="block" id="M146"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>π</mml:mi> <mml:mn>8</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(60)</label></disp-formula>
where <italic>n</italic>(<italic>i</italic>) is the fraction of the total wing area. Next, numerical simulations show that, despite the non-linearities caused by the inequality constraints, we can accurately fit a quadratic model of the form:
<disp-formula id="pcbi.1006044.e147"><alternatives><graphic id="pcbi.1006044.e147g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e147" xlink:type="simple"/><mml:math display="block" id="M147"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:msup><mml:mi>L</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(61)</label></disp-formula></p>
<p>Also, our numerical simulations show that, when <italic>L</italic> is maximized, <inline-formula id="pcbi.1006044.e148"><alternatives><graphic id="pcbi.1006044.e148g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e148" xlink:type="simple"/><mml:math display="inline" id="M148"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> by flapping converges to <inline-formula id="pcbi.1006044.e149"><alternatives><graphic id="pcbi.1006044.e149g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e149" xlink:type="simple"/><mml:math display="inline" id="M149"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> by gliding. Therefore, we know two properties of the quadratic function:
<disp-formula id="pcbi.1006044.e150"><alternatives><graphic id="pcbi.1006044.e150g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e150" xlink:type="simple"/><mml:math display="block" id="M150"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>μ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>μ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(62)</label></disp-formula>
<disp-formula id="pcbi.1006044.e151"><alternatives><graphic id="pcbi.1006044.e151g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e151" xlink:type="simple"/><mml:math display="block" id="M151"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>v</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>μ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>,</mml:mo> <mml:mover accent="true"><mml:mi>μ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(63)</label></disp-formula></p>
<p>Because <inline-formula id="pcbi.1006044.e152"><alternatives><graphic id="pcbi.1006044.e152g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e152" xlink:type="simple"/><mml:math display="inline" id="M152"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> when <italic>L</italic> = 0, we know that <inline-formula id="pcbi.1006044.e153"><alternatives><graphic id="pcbi.1006044.e153g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e153" xlink:type="simple"/><mml:math display="inline" id="M153"><mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. From <xref ref-type="disp-formula" rid="pcbi.1006044.e150">Eq 62</xref> we know that:
<disp-formula id="pcbi.1006044.e154"><alternatives><graphic id="pcbi.1006044.e154g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e154" xlink:type="simple"/><mml:math display="block" id="M154"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:msup><mml:mi>L</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(64)</label></disp-formula></p>
<p>Therefore <italic>a</italic> is:
<disp-formula id="pcbi.1006044.e155"><alternatives><graphic id="pcbi.1006044.e155g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e155" xlink:type="simple"/><mml:math display="block" id="M155"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>a</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(65)</label></disp-formula></p>
<p>The relation between thrust and lift becomes:
<disp-formula id="pcbi.1006044.e156"><alternatives><graphic id="pcbi.1006044.e156g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e156" xlink:type="simple"/><mml:math display="block" id="M156"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mrow><mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mfrac> <mml:mo>)</mml:mo> <mml:msup><mml:mi>L</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(66)</label></disp-formula>
which can also be written as:
<disp-formula id="pcbi.1006044.e157"><alternatives><graphic id="pcbi.1006044.e157g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e157" xlink:type="simple"/><mml:math display="block" id="M157"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mi>c</mml:mi> <mml:msup><mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mi>c</mml:mi> <mml:msup><mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>)</mml:mo> <mml:mfrac><mml:mi>π</mml:mi> <mml:mn>8</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(67)</label></disp-formula></p>
<p>All that is left to do is to compute the double integral over the wing span and wing-beat cycle:
<disp-formula id="pcbi.1006044.e158"><alternatives><graphic id="pcbi.1006044.e158g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e158" xlink:type="simple"/><mml:math display="block" id="M158"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>i</mml:mi> <mml:mi>d</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(68)</label></disp-formula></p>
<p>Assuming sinusoidal flapping, the position (height) of the wing section <italic>i</italic> in time is determined by
<disp-formula id="pcbi.1006044.e159"><alternatives><graphic id="pcbi.1006044.e159g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e159" xlink:type="simple"/><mml:math display="block" id="M159"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>f</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mi>i</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(69)</label></disp-formula>
where <italic>t</italic> denotes the time. Differentiating this with respect to <italic>t</italic>, we get the speed of the wing section over time
<disp-formula id="pcbi.1006044.e160"><alternatives><graphic id="pcbi.1006044.e160g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e160" xlink:type="simple"/><mml:math display="block" id="M160"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>cos</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>f</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mi>i</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(70)</label></disp-formula></p>
<p>Assuming an elliptical wing, the double integral is:
<disp-formula id="pcbi.1006044.e161"><alternatives><graphic id="pcbi.1006044.e161g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e161" xlink:type="simple"/><mml:math display="block" id="M161"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mfrac><mml:mn>1</mml:mn><mml:mi>π</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mtext>sin</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>cos</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="10em"/><mml:mi>π</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>l</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi>f</mml:mi><mml:mn>2</mml:mn><mml:mtext>sin</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:msup><mml:mrow><mml:mtext>cos</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>p</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>i</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mi>d</mml:mi><mml:mi>i</mml:mi><mml:mi>d</mml:mi><mml:mi>p</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(71)</label></disp-formula></p>
<p>We first compute the inner integral:
<disp-formula id="pcbi.1006044.e162"><alternatives><graphic id="pcbi.1006044.e162g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e162" xlink:type="simple"/><mml:math display="block" id="M162"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:msqrt><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>-</mml:mo> <mml:msqrt><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:msqrt> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>-</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(72)</label></disp-formula>
and evaluated at <italic>x</italic> = 1, we get:
<disp-formula id="pcbi.1006044.e163"><alternatives><graphic id="pcbi.1006044.e163g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e163" xlink:type="simple"/><mml:math display="block" id="M163"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mi>π</mml:mi> <mml:mn>4</mml:mn></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(73)</label></disp-formula></p>
<p>We thus need to solve
<disp-formula id="pcbi.1006044.e164"><alternatives><graphic id="pcbi.1006044.e164g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e164" xlink:type="simple"/><mml:math display="block" id="M164"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mi>π</mml:mi> <mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mn>1</mml:mn></mml:msubsup> <mml:msup><mml:mtext>cos</mml:mtext> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(74)</label></disp-formula></p>
<p>The solution of the integral is
<disp-formula id="pcbi.1006044.e165"><alternatives><graphic id="pcbi.1006044.e165g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e165" xlink:type="simple"/><mml:math display="block" id="M165"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mn>1</mml:mn></mml:msubsup> <mml:msup><mml:mtext>cos</mml:mtext> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>p</mml:mi> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>sin</mml:mtext> <mml:mo>(</mml:mo> <mml:mn>4</mml:mn> <mml:mi>π</mml:mi> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>42</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(75)</label></disp-formula></p>
<p>And evaluated at 1 and 0, we get:
<disp-formula id="pcbi.1006044.e166"><alternatives><graphic id="pcbi.1006044.e166g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e166" xlink:type="simple"/><mml:math display="block" id="M166"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>sin</mml:mtext> <mml:mo>(</mml:mo> <mml:mn>4</mml:mn> <mml:mi>π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>8</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>8</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(76)</label></disp-formula></p>
<p>Thus the solution of the double integral is
<disp-formula id="pcbi.1006044.e167"><alternatives><graphic id="pcbi.1006044.e167g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e167" xlink:type="simple"/><mml:math display="block" id="M167"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mi>π</mml:mi> <mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>sin</mml:mtext> <mml:mo>(</mml:mo> <mml:mn>4</mml:mn> <mml:mi>π</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>8</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>8</mml:mn> <mml:mi>π</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(77)</label></disp-formula></p>
<p>Of which by far the most significant factor is the first term. Keeping only the first term, we get
<disp-formula id="pcbi.1006044.e168"><alternatives><graphic id="pcbi.1006044.e168g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e168" xlink:type="simple"/><mml:math display="block" id="M168"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mn>1</mml:mn></mml:msubsup> <mml:mrow><mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>U</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>i</mml:mi> <mml:mi>d</mml:mi> <mml:mi>p</mml:mi> <mml:mo>≈</mml:mo> <mml:mfrac><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mn>4</mml:mn></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>f</mml:mi> <mml:mi>π</mml:mi> <mml:mtext>sin</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>l</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(78)</label></disp-formula></p>
<p>Thus the final thrust becomes:
<disp-formula id="pcbi.1006044.e169"><alternatives><graphic id="pcbi.1006044.e169g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e169" xlink:type="simple"/><mml:math display="block" id="M169"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mi>S</mml:mi> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msubsup><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mfrac><mml:msup><mml:mi>π</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mn>16</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msup><mml:mtext>sin</mml:mtext> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>f</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>l</mml:mi> <mml:mi>w</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(79)</label></disp-formula></p>
<p>Subsequently, the coefficient for the decrement in thrust due to torque is added, as well as the friction and body drag, to produce <xref ref-type="disp-formula" rid="pcbi.1006044.e086">Eq 23</xref>.</p>
</sec>
<sec id="sec020">
<title>F Justification of the bounds on visual error</title>
<p>In the absence of any detailed information on visual processing in falcons, we estimate the magnitude of visual error by the falcon in the following way. Hodos <italic>et al</italic> [<xref ref-type="bibr" rid="pcbi.1006044.ref048">48</xref>] found that the minimum retinal image velocity for the detection of motion in pigeons is about 8°s<sup>−1</sup>. We assume that this detection threshold corresponds to the point at which the apparent motion due to target motion exceeds the apparent motion due to random noise. We further assume that the differentiation time of the falcon is 50ms and that the apparent motion due to target motion must exceed the apparent motion due to random noise in this short time frame. Therefore, the retinal image must move at least 0.007 rads per 50ms to be perceived. We thus take this value as the bound <italic>ξ</italic> on the visual error (see Section B). We acknowledge that this method is somewhat arbitrary, but consider that stating it in this way helps to provided confidence that the assumed numerical bound on the visual error is likely to be of about the right order of magnitude.</p>
</sec>
<sec id="sec021">
<title>G Justification of the mechanical constraints</title>
<p>Whether a bird is flapping or gliding, aerodynamic loads place strain on the muscles, ligaments, and bones, in particular when the bird is performing maneuvers. In our simulations, the constraints on the production of aerodynamic forces are such that the muscles, ligaments and bones would not break or tear in real birds, and that the power required to produce these forces would not exceed the muscle power available to counter the resulting torque. Here, we justify that we only need to consider the constraint on the torque that arises around the shoulder due to lift production, as this constraint is likely to be exceeded before any other constraint.</p>
<p>The torque around the shoulder needs to be countered by the flight musculature, including in particular the pectoralis and supracoracoideus muscles. Bayer <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006044.ref039">39</xref>], provide detailed measurements of the forces and constraints on these muscles in gliding flight of the domestic pigeon <italic>Columba livia</italic>. We use their measurements to verify Pennycuick’s [<xref ref-type="bibr" rid="pcbi.1006044.ref040">40</xref>] and Tucker’s [<xref ref-type="bibr" rid="pcbi.1006044.ref011">11</xref>] proposal for a general allometric scaling law for maximum lift production in birds. In horizontal gliding flight, lift balances weight (<italic>mg</italic>). Therefore, each wing carries half the body weight, which we assume to be applied at half the total wing length (<italic>l</italic><sub><italic>w</italic></sub>) in producing a torque around the shoulder joint. Because the lever arm of the pectoralis is much shorter than this, it needs to act with a force of 7<italic>mg</italic>, where <italic>m</italic> is mass and <italic>g</italic> is gravitational acceleration. The maximum force that can be sustained by the pectoralis is roughly 3 to 4 times the maximum load that the muscle is required to take in gliding flight [<xref ref-type="bibr" rid="pcbi.1006044.ref039">39</xref>]. With the wings fully outstretched, this would imply a maximum acceleration of 3<italic>g</italic> to 4<italic>g</italic>, corresponding to an aerodynamic load of 1.5<italic>mg</italic> to 2<italic>mg</italic> on each wing, and hence to an aerodynamic moment of 0.75<italic>mgl</italic><sub><italic>w</italic></sub> to 1<italic>mgl</italic><sub><italic>w</italic></sub>. Pennycuick and Tucker propose the scaling law of a maximum lift of 1.7<italic>mg</italic> for fully stretched wings, which corresponds to a torque force of 0.85<italic>mgl</italic><sub><italic>w</italic></sub> per wing, exactly in the middle of the measurements by Bayer <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006044.ref039">39</xref>]. When a bird retracts its wings, the moment arm decreases. Hence the wing’s maximum load increases. Tucker’s model reveals that peregrine falcons, with appropriately retracted wings, may experience forces of over 18mg during a pull-out of the stoop, resulting in 9mg per wing.</p>
<p>Aerodynamic loads also place pressure on the ligaments and bones. Pennycuick [<xref ref-type="bibr" rid="pcbi.1006044.ref049">49</xref>] extensively examined the strength of pigeons’ (<italic>Columba livia</italic>) wing bones. He investigated the breaking points in bending and twisting of the humeri and the radio-ulna. Under simple assumptions of the lift distribution on the wing during gliding flight and with fully stretched wings, the lift would need to exceed 16.8 N before torsional or bending pressures would break the bones. As the weight of his pigeons was on average 0.393 kg, this would imply that the wings could hold up to 8 or 9 times the body weight, roughly equivalent to the maximum load that the falcon’s pectoralis can hold when it stoops at high speed. Therefore, the constraint on torque implicitly contains the constraint on aerodynamic loads due to breaking of bones. Further evidence that the peregrine falcon is well adapted to cope with the large aerodynamic forces that arise during maneuvers in a high-speed stoop is provided by Schmitz <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006044.ref050">50</xref>]. These authors investigated the mechanical properties of the feathers of four species, including the peregrine falcon, and found that the feathers of the falcon had larger cross-sections and protrusions than the other species, resulting in a greater bending stiffness, thereby allowing greater aerodynamic loads.</p>
</sec>
<sec id="sec022">
<title>H Justification of the inertia equation in the model</title>
<p>Here, we derive <xref ref-type="disp-formula" rid="pcbi.1006044.e097">Eq 32</xref> that determines the whole body inertia in the model for a given wing retraction. The total roll moment of inertia <italic>I</italic><sub><italic>x</italic>′</sub> is the sum of the inertia of the body <italic>I</italic><sub><italic>b</italic></sub> and the inertia of the wings <italic>I</italic><sub><italic>wing</italic></sub>.</p>
<p><italic>H.1 Body moment of inertia.</italic> The body inertia about the roll axis is only available for one species (the rose breasted cockatoo; Table 2 of [<xref ref-type="bibr" rid="pcbi.1006044.ref041">41</xref>]). We apply several allometric scaling laws to determine the inertia of other species based on these data. According to Nudds and Rayner [<xref ref-type="bibr" rid="pcbi.1006044.ref042">42</xref>], we can adopt the body frontal area and mass relation:
<disp-formula id="pcbi.1006044.e170"><alternatives><graphic id="pcbi.1006044.e170g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e170" xlink:type="simple"/><mml:math display="block" id="M170"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>0066</mml:mn> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>68</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(80)</label></disp-formula></p>
<p>The scaling of the body width has the relation
<disp-formula id="pcbi.1006044.e171"><alternatives><graphic id="pcbi.1006044.e171g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e171" xlink:type="simple"/><mml:math display="block" id="M171"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>098</mml:mn> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>35</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(81)</label></disp-formula></p>
<p>Because these approximately preserve relationships in scaling, the inertia of the body in the roll direction scales as follows:
<disp-formula id="pcbi.1006044.e172"><alternatives><graphic id="pcbi.1006044.e172g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e172" xlink:type="simple"/><mml:math display="block" id="M172"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:msubsup><mml:mi>w</mml:mi> <mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:msub><mml:mi>m</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mn>0</mml:mn></mml:mrow></mml:msub> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>098</mml:mn> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mn>70</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(82)</label></disp-formula>
Where <italic>I</italic><sub><italic>b</italic>0</sub> is the inertia for a width of 1m and a mass of 1kg. The rose breasted cockatoo weighs 0.293 kg with <italic>I</italic><sub><italic>b</italic></sub> = 1685.5 ⋅ 10<sup>−7</sup> kg m<sup>2</sup>. Therefore, we estimate <italic>I</italic><sub><italic>b</italic>0</sub> to be 0.1346717. With <italic>I</italic><sub><italic>b</italic>0</sub>, we can now estimate the body inertia for other birds. For instance, using these equations, the <italic>I</italic><sub><italic>b</italic></sub> of a male Peregrine falcon is estimated to be 448.0 ⋅ 10<sup>−6</sup> kg m<sup>2</sup>.</p>
<p><italic>H.2 Wing moment of inertia.</italic> The wing inertia has been calculated for many species by Rayner and Van Den Berg [<xref ref-type="bibr" rid="pcbi.1006044.ref043">43</xref>]. Their calculations determine the moment of inertia about the attachment site of the wing to the body (i.e. the shoulder joint), whereas we are interested in calculating the moment of inertia of the wings about the center of mass of the bird. There can, of course, be a considerable difference between these two quantities (see Table 2 of [<xref ref-type="bibr" rid="pcbi.1006044.ref041">41</xref>]), but they are easily inter-converted as follows. The moment of inertia about the center of mass is given by:
<disp-formula id="pcbi.1006044.e173"><alternatives><graphic id="pcbi.1006044.e173g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e173" xlink:type="simple"/><mml:math display="block" id="M173"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi> <mml:mo>.</mml:mo> <mml:mi>c</mml:mi> <mml:mi>e</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>+</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mn>2</mml:mn> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mi>x</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(83)</label></disp-formula>
where <italic>m</italic><sub><italic>i</italic></sub> is the mass of the <italic>i</italic>th blade element of the wing, <italic>r</italic><sub><italic>i</italic></sub> its distance from the shoulder joint, and <italic>x</italic> the distance from the shoulder joint to the center of gravity. We may restate this equation in terms of the total mass of the wing <italic>m</italic><sub><italic>wing</italic></sub> and its total moment of inertia about the shoulder joint <italic>I</italic><sub><italic>wing</italic></sub> as follows:
<disp-formula id="pcbi.1006044.e174"><alternatives><graphic id="pcbi.1006044.e174g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e174" xlink:type="simple"/><mml:math display="block" id="M174"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi> <mml:mo>.</mml:mo> <mml:mi>c</mml:mi> <mml:mi>e</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mi>x</mml:mi> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:munderover> <mml:mrow><mml:msub><mml:mi>m</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(84)</label></disp-formula>
where the summation may be calculated using data from Rayner &amp; Van den Berg [<xref ref-type="bibr" rid="pcbi.1006044.ref043">43</xref>] and Hedrick &amp; Biewener [<xref ref-type="bibr" rid="pcbi.1006044.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref041">41</xref>] regarding the mass distribution of the wing. We assume that the distance <italic>x</italic> from the shoulder to the center of mass is half the body width. Empirically, if we do not know the wing length, but do know the body mass, then we can approximate the wing inertia as follows:
<disp-formula id="pcbi.1006044.e175"><alternatives><graphic id="pcbi.1006044.e175g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e175" xlink:type="simple"/><mml:math display="block" id="M175"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi> <mml:mo>.</mml:mo> <mml:mi>c</mml:mi> <mml:mi>e</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>4</mml:mn></mml:mfrac> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>098</mml:mn> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>70</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>098</mml:mn> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>35</mml:mn></mml:mrow></mml:msubsup> <mml:mi>J</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(85)</label></disp-formula>
where <italic>J</italic> is the summation term of <xref ref-type="disp-formula" rid="pcbi.1006044.e097">Eq 32</xref>. And, with a decreased wing span, we calculate:
<disp-formula id="pcbi.1006044.e176"><alternatives><graphic id="pcbi.1006044.e176g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e176" xlink:type="simple"/><mml:math display="block" id="M176"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi> <mml:mo>.</mml:mo> <mml:mi>c</mml:mi> <mml:mi>e</mml:mi> <mml:mi>n</mml:mi> <mml:mi>t</mml:mi> <mml:mi>e</mml:mi> <mml:mi>r</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi>ϕ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>4</mml:mn></mml:mfrac> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>098</mml:mn> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>70</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>098</mml:mn> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>35</mml:mn></mml:mrow></mml:msubsup> <mml:mi>J</mml:mi> <mml:mi>ϕ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(86)</label></disp-formula>
where <italic>l</italic><sub><italic>wing</italic></sub> is the wing length and where <italic>ϕ</italic> is the fraction of wing retraction defined as:
<disp-formula id="pcbi.1006044.e177"><alternatives><graphic id="pcbi.1006044.e177g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e177" xlink:type="simple"/><mml:math display="block" id="M177"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>ϕ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>l</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(87)</label></disp-formula></p>
<p>Thus the total roll moment of inertia at a given point in time (assuming wing retraction is symmetrical such that the center of gravity does not change) is:
<disp-formula id="pcbi.1006044.e178"><alternatives><graphic id="pcbi.1006044.e178g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e178" xlink:type="simple"/><mml:math display="block" id="M178"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi>ϕ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>4</mml:mn></mml:mfrac> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:msup><mml:mn>098</mml:mn> <mml:mn>2</mml:mn></mml:msup> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>70</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>m</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>098</mml:mn> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>35</mml:mn></mml:mrow></mml:msubsup> <mml:mi>J</mml:mi> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(88)</label></disp-formula></p>
</sec>
<sec id="sec023">
<title>I Proof that the wing span that maximizes lift also maximizes roll acceleration</title>
<p>Here, we explain why <xref ref-type="disp-formula" rid="pcbi.1006044.e082">Eq 19</xref> maximizes the roll acceleration with respect to wing span. Let us call this maximizing wing span <italic>b</italic>*. Roll acceleration is maximized when one wing produces the largest positive lift, and the other wing the largest negative lift. The roll acceleration depends on the wing span in the following way:
<disp-formula id="pcbi.1006044.e179"><alternatives><graphic id="pcbi.1006044.e179g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e179" xlink:type="simple"/><mml:math display="block" id="M179"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>ω</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>M</mml:mi> <mml:mi>I</mml:mi></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mfrac><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mn>4</mml:mn></mml:mfrac> <mml:msup><mml:mi>ϕ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>w</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi>ϕ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>098</mml:mn> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>b</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>35</mml:mn></mml:mrow></mml:msubsup> <mml:mi>J</mml:mi> <mml:mi>ϕ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(89)</label></disp-formula>
with the constraint that <italic>M</italic> ≤ <italic>M</italic><sub><italic>max</italic></sub>. When <italic>b</italic> &gt; <italic>b</italic>* the torque will not change, but the inertia will increase, so the roll acceleration is less. When <italic>b</italic> &lt; <italic>b</italic>*, the torque declines by <italic>ϕ</italic><sup>2</sup>, while the inertia declines less than <italic>ϕ</italic><sup>2</sup>. Therefore, <italic>b</italic>* maximizes the roll acceleration.</p>
</sec>
<sec id="sec024">
<title>J Derivation of optimal wing retraction</title>
<p>The object of optimizing wing retraction is to maximize the net thrust minus drag, given a desired lift <italic>L</italic>*. We assume a simple relation between wing retraction, aspect ratio and wing area, as proposed by Tucker [<xref ref-type="bibr" rid="pcbi.1006044.ref011">11</xref>]:
<disp-formula id="pcbi.1006044.e180"><alternatives><graphic id="pcbi.1006044.e180g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e180" xlink:type="simple"/><mml:math display="block" id="M180"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(90)</label></disp-formula>
<disp-formula id="pcbi.1006044.e181"><alternatives><graphic id="pcbi.1006044.e181g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e181" xlink:type="simple"/><mml:math display="block" id="M181"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>S</mml:mi></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(91)</label></disp-formula></p>
<p>Assuming this relation, the total induced drag becomes:
<disp-formula id="pcbi.1006044.e182"><alternatives><graphic id="pcbi.1006044.e182g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e182" xlink:type="simple"/><mml:math display="block" id="M182"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>D</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mi>π</mml:mi> <mml:mi>A</mml:mi> <mml:mspace width="-3.5pt"/><mml:mi>R</mml:mi></mml:mrow></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>S</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(92)</label></disp-formula>
and the total thrust minus drag is
<disp-formula id="pcbi.1006044.e183"><alternatives><graphic id="pcbi.1006044.e183g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e183" xlink:type="simple"/><mml:math display="block" id="M183"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:msubsup><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>f</mml:mi> <mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>-</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>o</mml:mi> <mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>m</mml:mi> <mml:mi>g</mml:mi> <mml:mtext>cos</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>β</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(93)</label></disp-formula>
where <italic>β</italic> is the dive angle (i.e. the negative of the elevation angle). The optimization becomes:
<disp-formula id="pcbi.1006044.e184"><alternatives><graphic id="pcbi.1006044.e184g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e184" xlink:type="simple"/><mml:math display="block" id="M184"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi></mml:mrow></mml:munder> <mml:mrow><mml:mo>{</mml:mo> <mml:mtext>T</mml:mtext> <mml:mspace width="-3.5pt"/><mml:mi>D</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(94)</label></disp-formula>
with the equality constraint that lift equals some desired value:
<disp-formula id="pcbi.1006044.e185"><alternatives><graphic id="pcbi.1006044.e185g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e185" xlink:type="simple"/><mml:math display="block" id="M185"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>*</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mi>ρ</mml:mi> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mrow><mml:mi>b</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(95)</label></disp-formula>
and the inequality constraints:
<disp-formula id="pcbi.1006044.e186"><alternatives><graphic id="pcbi.1006044.e186g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e186" xlink:type="simple"/><mml:math display="block" id="M186"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mi>l</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>.</mml:mo> <mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>b</mml:mi> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(96)</label></disp-formula></p>
<p>The optimization problem turns out to have a simple solution. Namely, we calculate the partial derivative with respect to <italic>b</italic>
<disp-formula id="pcbi.1006044.e187"><alternatives><graphic id="pcbi.1006044.e187g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e187" xlink:type="simple"/><mml:math display="block" id="M187"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd><mml:mrow><mml:mfrac><mml:mi>∂</mml:mi> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:mfrac> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>L</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msup><mml:mi>b</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>f</mml:mi> <mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:mi>m</mml:mi> <mml:mi>g</mml:mi><mml:mspace width="4pt"/><mml:mtext>cos</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>β</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>b</mml:mi> <mml:mi>o</mml:mi> <mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mspace width="21em"/><mml:mrow><mml:mo>+</mml:mo> <mml:mfrac><mml:mi>∂</mml:mi> <mml:mrow><mml:mi>∂</mml:mi> <mml:mi>b</mml:mi></mml:mrow></mml:mfrac> <mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>f</mml:mi> <mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mfrac><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(97)</label></disp-formula>
then set it to zero
<disp-formula id="pcbi.1006044.e188"><alternatives><graphic id="pcbi.1006044.e188g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e188" xlink:type="simple"/><mml:math display="block" id="M188"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:mn>4</mml:mn> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>L</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:msup><mml:mi>b</mml:mi> <mml:mn>3</mml:mn></mml:msup> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>f</mml:mi> <mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>(</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(98)</label></disp-formula>
and solve for <italic>b</italic>:
<disp-formula id="pcbi.1006044.e189"><alternatives><graphic id="pcbi.1006044.e189g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e189" xlink:type="simple"/><mml:math display="block" id="M189"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:mroot><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>8</mml:mn> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>L</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mrow><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>d</mml:mi> <mml:mo>.</mml:mo> <mml:mi>f</mml:mi> <mml:mi>r</mml:mi> <mml:mi>i</mml:mi> <mml:mi>c</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>a</mml:mi> <mml:mi>x</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>ρ</mml:mi> <mml:msup><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac> <mml:mn>3</mml:mn></mml:mroot></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(99)</label></disp-formula></p>
<p>When <italic>b</italic> is less than <italic>b</italic><sub><italic>min</italic></sub>, b is set to <italic>b</italic><sub><italic>min</italic></sub>. This new value of <italic>b</italic> may cause <italic>c</italic><sub><italic>l</italic></sub> to exceed the constraint. Therefore, we set <italic>c</italic><sub><italic>l</italic></sub> to <italic>c</italic><sub><italic>l</italic>.<italic>max</italic></sub>, and solve for the corresponding <italic>b</italic>. If <italic>b</italic> is greater than <italic>b</italic><sub><italic>max</italic></sub>, we set it to <italic>b</italic><sub><italic>max</italic></sub> and solve for <italic>c</italic><sub><italic>l</italic></sub>.</p>
</sec>
<sec id="sec025">
<title>K Comparison between flight performance in the model and empirical measurements</title>
<p>In order for the model results to be relevant for our understanding of real falcons, the flight performance of model-birds should approximate empirical measurements in falcons and starlings, as flight performance is expected to be a key determinant of catch success in a chase. However, very little is known about the peak flight performance of birds. Most of the flight performance mentioned elsewhere is derived using modeling, and we have mentioned how our modeling relates to previous models throughout the section A-J. Here, we present the few coarse comparisons that are currently possible. First, minimum sustained flight speeds (the minimum speed of the model-starling is 4.5ms<sup>−1</sup> and that of the falcon 7.3ms<sup>−1</sup>; defined as the minimum airspeed where acceleration &gt; 0 in <xref ref-type="fig" rid="pcbi.1006044.g003">Fig 3a</xref>) correspond closely with the minimum speeds at which birds fly in wind tunnel experiments (starlings are not reported to fly below 6ms<sup>−2</sup> [<xref ref-type="bibr" rid="pcbi.1006044.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1006044.ref056">56</xref>]). Warrick [<xref ref-type="bibr" rid="pcbi.1006044.ref057">57</xref>] reports that the linear acceleration of a starling is approximately 5.8ms<sup>−2</sup> when released to fly through a 2x2x5 tunnel, and our model-starlings linearly accelerate 4.8ms<sup>−2</sup>. The top horizontal speed of peregrine falcons has been found to be 27.6ms<sup>−1</sup> [<xref ref-type="bibr" rid="pcbi.1006044.ref058">58</xref>], which is very close to the speed of 28.4ms<sup>−1</sup> in the model. Starlings have been reported to occasionally fly at 22ms<sup>−1</sup> during migration [<xref ref-type="bibr" rid="pcbi.1006044.ref059">59</xref>], so the top speed of 24ms<sup>−1</sup> in the model also seems appropriate. The maximum dive speed of the falcon is 122ms<sup>−1</sup> and resembles the speed of 108ms<sup>−1</sup> achieved by a peregrine falcon in an unpublished study by National Geographic (to date, no peer-reviewed articles include measures of the peak performance of falcons in a stoop). The maximum load factors attained in the model are considerably higher than those measured experimentally. Ponitz <italic>et al</italic>. [<xref ref-type="bibr" rid="pcbi.1006044.ref003">3</xref>] report that the load factor of their peregrine falcon during pull out was 1.15 (including gravity) at a speed of 20–22ms<sup>−1</sup>. Model-falcons are able to generate a load factor of 2.5 at that speed (excluding gravity), but it is reasonable to assume that a real falcon will generally pull out with a load factor below maximum, to maintain stability throughout its flight. Lastly, the high roll accelerations of our model birds are of the same order of magnitude as the roll accelerations measured in pigeons (<italic>columba livia</italic>) [<xref ref-type="bibr" rid="pcbi.1006044.ref060">60</xref>]: pigeons had an average whole body angular acceleration of 601 rad s<sup>−2</sup> flying 3–6 ms<sup>−1</sup>. At that speed, a model-starling exerts ∼1200 rad s<sup>−2</sup> and a model-falcon ∼400 rad s<sup>−2</sup>.</p>
</sec>
<sec id="sec026">
<title>L Tests of convergence of numerical integration</title>
<p>In our simulations, we discretized time and constructed a set of ordinary difference equations to numerically solve the initial value problem of the original differential equations (see Eqs <xref ref-type="disp-formula" rid="pcbi.1006044.e033">2</xref>, <xref ref-type="disp-formula" rid="pcbi.1006044.e034">3</xref>, <xref ref-type="disp-formula" rid="pcbi.1006044.e035">4</xref>, <xref ref-type="disp-formula" rid="pcbi.1006044.e043">6</xref> and <xref ref-type="disp-formula" rid="pcbi.1006044.e044">7</xref>). Here we test the convergence of the position, speed and acceleration of predator and prey, as well as the falcon’s catch success. As we do not have access to the algebraic solutions, we tested the convergence as follows. The time step of integration in the simulations was reduced iteratively in orders of magnitude until an acceptable discrepancy with next step size of integration was obtained, where we define the discrepancy as:
<disp-formula id="pcbi.1006044.e190"><alternatives><graphic id="pcbi.1006044.e190g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006044.e190" xlink:type="simple"/><mml:math display="block" id="M190"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>k</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>‖</mml:mo> <mml:mrow><mml:mi>f</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>/</mml:mo><mml:mn>10</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>10</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>n</mml:mi></mml:msup></mml:mrow> <mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(100)</label></disp-formula>
where <italic>e</italic><sub><italic>dt</italic></sub> is the discrepancy, <italic>k</italic> the number of model time steps, <italic>f</italic>(<italic>dt</italic>) the difference equation describing the value of interest, where <italic>dt</italic> is the applied time step. We simulated trajectories of stooping falcons (800m altitude and 600m horizontal distance) against erratically or circularly moving prey, where the initial seeding of random variables was the same for each applied time step <italic>dt</italic> and <italic>k</italic> was chosen such that the falcon intercepted the starling in simulations using one of the time step sizes, and thus for no <italic>dt</italic> sizes the simulation continued beyond interception. An acceptable discrepancy was achieved for <italic>dt</italic> = 1 ⋅ 10<sup>−4</sup> <italic>s</italic> (see <xref ref-type="table" rid="pcbi.1006044.t005">Table 5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006044.s004">S4 Fig</xref>). Between <italic>dt</italic> = 1 ⋅ 10<sup>−4</sup> <italic>s</italic> and <italic>dt</italic> = 1 ⋅ 10<sup>−5</sup> <italic>s</italic> the catch success varied only 0.13% which is much lower than the minimum difference in main results between tested conditions (2%). Beyond <italic>dt</italic> = 1 ⋅ 10<sup>−6</sup> <italic>s</italic>, <italic>e</italic><sub><italic>dt</italic></sub> increases due to floating point imprecision.</p>
<table-wrap id="pcbi.1006044.t005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006044.t005</object-id>
<label>Table 5</label>
<caption>
<title>Test of convergence.</title>
<p>Falcons stoop from 800m altitude and 600m horizontal distance from the prey. The prey flies erratically. See <xref ref-type="disp-formula" rid="pcbi.1006044.e190">Eq 100</xref> for a definition of <italic>e</italic><sub><italic>dt</italic></sub>.</p>
</caption>
<alternatives>
<graphic id="pcbi.1006044.t005g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.t005" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left">measure</th>
<th align="left"><italic>e</italic><sub>10<sup>−1</sup></sub></th>
<th align="left"><italic>e</italic><sub>10<sup>−2</sup></sub></th>
<th align="left"><italic>e</italic><sub>10<sup>−3</sup></sub></th>
<th align="left"><italic>e</italic><sub>10<sup>−4</sup></sub></th>
<th align="left"><italic>e</italic><sub>10<sup>−5</sup></sub></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">distance predator to prey (m)</td>
<td align="char" char=".">246.4</td>
<td align="char" char=".">11.2</td>
<td align="char" char=".">1.1</td>
<td align="char" char=".">0.12</td>
<td align="char" char=".">4.3</td>
</tr>
<tr>
<td align="left">speed predator (ms<sup>−1</sup>)</td>
<td align="char" char=".">23.1</td>
<td align="char" char=".">1.1</td>
<td align="char" char=".">0.1</td>
<td align="char" char=".">0.03</td>
<td align="char" char=".">0.9</td>
</tr>
<tr>
<td align="left">acceleration predator (ms<sup>−2</sup>)</td>
<td align="char" char=".">53.2</td>
<td align="char" char=".">8.1</td>
<td align="char" char=".">0.3</td>
<td align="char" char=".">0.02</td>
<td align="char" char=".">20.2</td>
</tr>
<tr>
<td align="left">speed prey (ms<sup>−1</sup>)</td>
<td align="char" char=".">12.7</td>
<td align="char" char=".">2.6</td>
<td align="char" char=".">0.4</td>
<td align="char" char=".">0.02</td>
<td align="char" char=".">1.0</td>
</tr>
<tr>
<td align="left">acceleration prey (ms<sup>−2</sup>)</td>
<td align="char" char=".">22.8</td>
<td align="char" char=".">1.9</td>
<td align="char" char=".">0.2</td>
<td align="char" char=".">0.03</td>
<td align="char" char=".">1.0</td>
</tr>
<tr>
<td align="left">catch success (%)</td>
<td align="char" char=".">63.2</td>
<td align="char" char=".">1.2</td>
<td align="char" char=".">0.22</td>
<td align="char" char=".">0.13</td>
<td align="char" char=".">0.14</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>Additionally, we have tested the convergence and stability of the numerical integration of <xref ref-type="disp-formula" rid="pcbi.1006044.e043">Eq 6</xref>, in a scenario where convergence is expected to be weak on theoretical grounds. Namely, when the birds exert large roll accelerations, oscillations around the equilibrium bank angle may arise at larger <italic>dt</italic>. <xref ref-type="supplementary-material" rid="pcbi.1006044.s005">S5 Fig</xref> shows the bank angle change over time of a falcon stooping at 100ms<sup>−1</sup>, and exerting a roll acceleration of 5000 rad s<sup>−2</sup> using Bang-Bang control to turn <italic>pi</italic> rad. The maximum absolute error of a <italic>dt</italic> = 1 ⋅ 10<sup>−4</sup> <italic>s</italic> with respect to <italic>dt</italic> = 1 ⋅ 10<sup>−5</sup> <italic>s</italic> is only 0.007 rad, which is unlikely to affect the model outcome. We note that, although the model equations are nonlinear, they are inherently stabilizing (i.e. robust to perturbations due to the numerical scheme), as aerodynamic drag ensures that the speed converges towards an equilibrium point, and the guidance law ensures that the falcon is attracted to the prey (see the smooth variation of catch success with respect to variation in initial conditions in Figs <xref ref-type="fig" rid="pcbi.1006044.g004">4</xref> and <xref ref-type="fig" rid="pcbi.1006044.g006">6</xref>).</p>
</sec>
</sec>
</sec>
<sec id="sec027">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006044.s001" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Prey accelerations.</title>
<p>The figure portrays the distribution of prey accelerations along the x, y and z axes of the inertial axis system, for smooth and non-smooth maneuvering prey.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006044.s002" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Flight trajectories.</title>
<p>Examples of flight trajectories of the falcon when hunting non-smooth maneuvering prey, and when the navigation constant <italic>N</italic> of the falcon is low (<italic>N</italic> &lt; 2). In some curved flight paths, the peregrine falcon drops below the prey; a phenomenon also observed in nature.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006044.s003" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Alternative delay implementation.</title>
<p>In our model, a parameter <italic>τ</italic> affects both the differencing time of the line-of-sight, as well as the sample rate from vision to guidance. Here, we show that our results are not implementation specific. When we implement a continuous delay function with analytic differentiation, the same qualitative patterns are found: (a) a peak success at an <italic>N</italic> value of around 3–4, (b) and an increase in success when the falcon dives from a high-altitude.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006044.s004" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Example of a trajectory using a time step size 10<sup>−4</sup>s or 10<sup>−5</sup>s.</title>
<p>The differences of the trajectories of the prey and predator between step sizes is marginal (i.e. the trajectories converge), and we thus use the larger step size such that run-time of the simulations is minimized.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006044.s005" mimetype="application/eps" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Change in bank angle over time for different step sizes.</title>
<p>It portrays the bank angle change over time of a falcon stooping at 100ms<sup>−1</sup>, and exerting a roll acceleration of 5000 rad s<sup>−2</sup> using Bang-Bang control to turn π rad.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006044.s006" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s006" xlink:type="simple">
<label>S1 Video</label>
<caption>
<title>Video of simulated attacks by peregrine falcons in level flight on starlings in smooth maneuvering flight.</title>
<p>The camera is set up to follow the falcon from below at a fixed position, mimicking how a human observer would view the spectacle. The falcon misses the starling three times and catches it once. A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling. A near-miss occurs (“MISS!” appears on the screen in the video) when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45° behind the bird).</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006044.s007" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s007" xlink:type="simple">
<label>S2 Video</label>
<caption>
<title>Video of simulated attacks by peregrine falcons in level flight on starlings in straight flight.</title>
<p>The starling is caught by the falcon in the two attacks of the video, where a catch occurs when the falcon comes within 20cm of the starling. Colored ribbons behind the birds show their recent trajectories, and follow the motion of the wings; the white marker at fixed time intervals of 0.5s is used to show the speed of the birds along their trajectories. The wingbeat averaged aerodynamic forces due to flapping are analytically derived and act at every time step of the model; there is no explicit model of the tail dynamics. We assume that the lift contribution of the tail is negligible, and that it contributes to the overall body drag measured empirically.</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006044.s008" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s008" xlink:type="simple">
<label>S3 Video</label>
<caption>
<title>Video of simulated attacks by peregrine falcons in level flight on starlings in smooth maneuvering flight.</title>
<p>The falcon misses in the first two attacks and catches the starling in the third. A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling. A near-miss occurs (“MISS!” appears on the screen in the video) when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45° behind the bird). Colored ribbons behind the birds show their recent trajectories, and follow the motion of the wings; the white marker at fixed time intervals of 0.5s is used to show the speed of the birds along their trajectories. The wingbeat averaged aerodynamic forces due to flapping are analytically derived and act at every time step of the model; there is no explicit model of the tail dynamics. We assume that the lift contribution of the tail is negligible, and that it contributes to the overall body drag measured empirically.</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006044.s009" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s009" xlink:type="simple">
<label>S4 Video</label>
<caption>
<title>Video of simulated attacks by peregrine falcons in level flight on starlings in non-smooth maneuvering flight.</title>
<p>The falcon misses the starling three times and catches it once. A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling. A near-miss occurs (“MISS!” appears on the screen in the video) when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45° behind the bird). Colored ribbons behind the birds show their recent trajectories, and follow the motion of the wings; the white marker at fixed time intervals of 0.5s is used to show the speed of the birds along their trajectories. The wingbeat averaged aerodynamic forces due to flapping are analytically derived and act at every time step of the model; there is no explicit model of the tail dynamics. We assume that the lift contribution of the tail is negligible, and that it contributes to the overall body drag measured empirically.</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006044.s010" mimetype="video/x-msvideo" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006044.s010" xlink:type="simple">
<label>S5 Video</label>
<caption>
<title>Video of simulated attacks by peregrine falcons in stooping flight on starlings in non-smooth maneuvering flight.</title>
<p>The falcon catches the starling three times and misses it once. A catch is defined as occurring when the model-falcon comes within 0.2m of the model-starling. A near-miss occurs (“MISS!” appears on the screen in the video) when the model-falcon comes within 5.0 m of the model-starling, but subsequently finds itself further than this from the model-starling and with the model-starling in the blind zone of the model-falcon (a cone of 45° behind the bird). Colored ribbons behind the birds show their recent trajectories, and follow the motion of the wings; the white marker at fixed time intervals of 0.5s is used to show the speed of the birds along their trajectories. The wingbeat averaged aerodynamic forces due to flapping are analytically derived and act at every time step of the model; there is no explicit model of the tail dynamics. We assume that the lift contribution of the tail is negligible, and that it contributes to the overall body drag measured empirically.</p>
<p>(AVI)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006044.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rudebeck</surname> <given-names>G</given-names></name>. <article-title>The Choice of Prey and Modes of Hunting of Predatory Birds with Special Reference to Their Selective Effect</article-title>. <source>Oikos</source>. <year>1950</year>;<volume>2</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/3564663" xlink:type="simple">10.2307/3564663</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alerstam</surname> <given-names>T</given-names></name>. <article-title>Radar observations of the stoop of the Peregrine Falcon <italic>Falco peregrinus</italic> and the Goshawk <italic>Accipiter gentilis</italic></article-title>. <source>Ibis</source>. <year>2008</year>;<volume>129</volume>:<fpage>267</fpage>–<lpage>273</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1474-919X.1987.tb03207.x" xlink:type="simple">10.1111/j.1474-919X.1987.tb03207.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ponitz</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Schmitz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fischer</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bleckmann</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Brücker</surname> <given-names>C</given-names></name>. <article-title>Diving-flight aerodynamics of a Peregrine Falcon (Falco peregrinus)</article-title>. <source>PLoS ONE</source>. <year>2014</year>;<volume>9</volume>(<issue>2</issue>):<fpage>e86506</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0086506" xlink:type="simple">10.1371/journal.pone.0086506</ext-link></comment> <object-id pub-id-type="pmid">24505258</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buchanan</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Herman</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Johnson</surname> <given-names>TM</given-names></name>. <article-title>Success rates of the peregrine falcon (Falco peregrinus) hunting dunlin (Calidris alpina) during winter</article-title>. <source>Journal of Raptor Research</source>. <year>1986</year>;<volume>20</volume>:<fpage>130</fpage>–<lpage>131</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dekker</surname> <given-names>D</given-names></name>. <article-title>Peregrine falcon and merlin predation on small shorebirds and passerines in Alberta</article-title>. <source>Canadian Journal of Zoology</source>. <year>1988</year>;<volume>66</volume>(<issue>4</issue>):<fpage>925</fpage>–<lpage>928</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1139/z88-136" xlink:type="simple">10.1139/z88-136</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref006">
<label>6</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Dekker</surname> <given-names>D</given-names></name>. <source>Hunting tactics of Peregrines and other falcons</source>. <publisher-name>Hancock House</publisher-name>; <year>2009</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roalkvam</surname> <given-names>R</given-names></name>. <article-title>How effective are hunting peregrines?</article-title> <source>Raptor Research</source> <year>1985</year>;<volume>19</volume>:<fpage>27</fpage>–<lpage>29</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cresswell</surname> <given-names>W</given-names></name>. <article-title>Surprise as a winter hunting strategy in Sparrowhawks, Accipiter nisus, Peregrines Falco peregrinus and Merlins F. columbarius</article-title>. <source>Ibis</source>. <year>1996</year>;<volume>138</volume>(<issue>4</issue>):<fpage>684</fpage>–<lpage>692</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1474-919X.1996.tb04770.x" xlink:type="simple">10.1111/j.1474-919X.1996.tb04770.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref009">
<label>9</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ratcliffe</surname> <given-names>D</given-names></name>. <source>The peregrine falcon</source>. <publisher-name>A&amp;C Black</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref010">
<label>10</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Enderson</surname> <given-names>JH</given-names></name>. <source>Peregrine falcon: stories of the blue meanie</source>. <publisher-name>University of Texas Press</publisher-name>; <year>2013</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tucker</surname> <given-names>V</given-names></name>. <article-title>Gliding flight: speed and acceleration of ideal falcons during diving and pull out</article-title>. <source>The Journal of Experimental Biology</source>. <year>1998</year>;<volume>414</volume>:<fpage>403</fpage>–<lpage>414</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref012">
<label>12</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pfeifer</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bongard</surname> <given-names>J</given-names></name>. <source>How the body shapes the way we think: a new view of intelligence</source>. <publisher-name>MIT press</publisher-name>; <year>2006</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Palumbo</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Blauwkamp</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Lloyd</surname> <given-names>JM</given-names></name>. <article-title>Modern homing missile guidance theory and techniques</article-title>. <source>Johns Hopkins APL Technical Digest (Applied Physics Laboratory)</source>. <year>2010</year>;<volume>29</volume>(<issue>1</issue>):<fpage>42</fpage>–<lpage>59</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref014">
<label>14</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Shneydor</surname> <given-names>N</given-names></name>. <source>Missile Guidance and Pursuit: Kinematics, Dynamics and Control</source>. <publisher-name>Elsevier</publisher-name>; <year>1998</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brighton</surname> <given-names>CH</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>GK</given-names></name>. <article-title>Terminal attack trajectories of peregrine falcons are described by the proportional navigation guidance law of missiles</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2017</year>;<volume>114</volume>(<issue>51</issue>) <fpage>13495</fpage>–<lpage>13500</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ghose</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Horiuchi</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Krishnaprasad</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Moss</surname> <given-names>CF</given-names></name>. <article-title>Echolocating bats use a nearly time-optimal strategy to intercept prey</article-title>. <source>PLoS Biology</source>. <year>2006</year>;<volume>4</volume>(<issue>5</issue>):<fpage>e108</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.0040108" xlink:type="simple">10.1371/journal.pbio.0040108</ext-link></comment> <object-id pub-id-type="pmid">16605303</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wei</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Justh</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Krishnaprasad</surname> <given-names>PS</given-names></name>. <article-title>Pursuit and an evolutionary game</article-title>. <source>Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences</source>. <year>2009</year>;<volume>465</volume>(<issue>2105</issue>):<fpage>1539</fpage>–<lpage>1559</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspa.2008.0480" xlink:type="simple">10.1098/rspa.2008.0480</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kane</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Zamani</surname> <given-names>M</given-names></name>. <article-title>Falcons pursue prey using visual motion cues: new perspectives from animal-borne cameras</article-title>. <source>The Journal of Experimental Biology</source>. <year>2014</year>;<volume>217</volume>(<issue>2</issue>):<fpage>225</fpage>–<lpage>34</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.092403" xlink:type="simple">10.1242/jeb.092403</ext-link></comment> <object-id pub-id-type="pmid">24431144</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hastie</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>RJ</given-names></name>. <chapter-title>Generalized additive models</chapter-title>. <source>Monographs on Statistics and Applied Probability</source> <volume>vol. 43</volume>. <publisher-name>CRC Press</publisher-name>; <year>1990</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lin</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>D</given-names></name>. <article-title>Inference in generalized additive mixed models by using smoothing splines</article-title>. <source>Journal of the royal statistical society: Series b (statistical methodology)</source>. <year>1999</year>;<volume>61</volume>(<issue>2</issue>):<fpage>381</fpage>–<lpage>400</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/1467-9868.00183" xlink:type="simple">10.1111/1467-9868.00183</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Howland</surname> <given-names>HC</given-names></name>. <article-title>Optimal strategies for predator avoidance: The relative importance of speed and manoeuvrability</article-title>. <source>Journal of Theoretical Biology</source>. <year>1974</year>;<volume>47</volume>(<issue>2</issue>):<fpage>333</fpage>–<lpage>350</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0022-5193(74)90202-1" xlink:type="simple">10.1016/0022-5193(74)90202-1</ext-link></comment> <object-id pub-id-type="pmid">4437191</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hedenström</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rosén</surname> <given-names>M</given-names></name>. <article-title>Predator versus prey: on aerial hunting and escape strategies in birds</article-title>. <source>Behavioral Ecology</source>. <year>2001</year>;<volume>12</volume>(<issue>2</issue>):<fpage>150</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/beheco/12.2.150" xlink:type="simple">10.1093/beheco/12.2.150</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rudebeck</surname> <given-names>G</given-names></name>. <article-title>The choice of prey and modes of hunting of predatory birds with special reference to their selective effect</article-title>. <source>Oikos</source>. <year>1951</year>;<volume>3</volume>(<issue>2</issue>):<fpage>200</fpage>–<lpage>231</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/3565185" xlink:type="simple">10.2307/3565185</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref024">
<label>24</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>A</given-names></name>. <source>Evolutionary biomechanics: selection, phylogeny, and constraint</source>. <publisher-name>Oxford University Press</publisher-name>; <year>2014</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref025">
<label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Riedel FW. Bank-to-turn control technology survey for homing missiles. NASA Contractor Report 3325. 1980; p. 1–43.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref026">
<label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Barrett</surname> <given-names>L</given-names></name>. <source>Beyond the brain: How body and environment shape animal and human minds</source>. <publisher-name>Princeton University Press</publisher-name>; <year>2011</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hildenbrandt</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Carere</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Hemelrijk</surname> <given-names>CK</given-names></name>. <article-title>Self-organized aerial displays of thousands of starlings: a model</article-title>. <source>Behavioral Ecology</source>. <year>2010</year>;<volume>21</volume>(<issue>6</issue>):<fpage>1349</fpage>–<lpage>1359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/beheco/arq149" xlink:type="simple">10.1093/beheco/arq149</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wood</surname> <given-names>SN</given-names></name>. <article-title>Fast stable restricted maximum likelihood and marginal likelihood estimation of semiparametric generalized linear models</article-title>. <source>Journal of the Royal Statistical Society: Series B (Statistical Methodology)</source>. <year>2011</year>;<volume>73</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>36</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-9868.2010.00749.x" xlink:type="simple">10.1111/j.1467-9868.2010.00749.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref029">
<label>29</label>
<mixed-citation publication-type="other" xlink:type="simple">R Core Team. R: A Language and Environment for Statistical Computing; 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/" xlink:type="simple">https://www.R-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hedrick</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Usherwood</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Biewener</surname> <given-names>AA</given-names></name>. <article-title>Low speed maneuvering flight of the rose-breasted cockatoo (<italic>Eolophus roseicapillus</italic>). II. Inertial and aerodynamic reorientation</article-title>. <source>The Journal of Experimental Biology</source>. <year>2007</year>;<volume>210</volume>(<issue>11</issue>):<fpage>1912</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.002055" xlink:type="simple">10.1242/jeb.002055</ext-link></comment> <object-id pub-id-type="pmid">17515417</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref031">
<label>31</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Shyy</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Aono</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>H</given-names></name>. <source>An Introduction to Flapping Wing Aerodynamics</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2013</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref032">
<label>32</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Lentink</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Jongerius</surname> <given-names>SR</given-names></name>, <name name-style="western"><surname>Bradshaw</surname> <given-names>NL</given-names></name>. <chapter-title>The Scalable Design of Flapping Micro-Air Vehicles Inspired by Insect Flight</chapter-title>. In: <source>Flying Insects and Robots</source>. (Eds. <name name-style="western"><surname>Floreano</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zuffery</surname> <given-names>J-C</given-names></name>, <name name-style="western"><surname>Srinivasan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ellington</surname> <given-names>CP</given-names></name>) <year>2010</year>; p. <fpage>185</fpage>–<lpage>205</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hedenström</surname> <given-names>A</given-names></name>. <article-title>Aerodynamics, evolution and ecology of avian flight</article-title>. <source>Trends in Ecology and Evolution</source>. <year>2002</year>;<volume>17</volume>(<issue>9</issue>):<fpage>415</fpage>–<lpage>422</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Crandell</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Tobalske</surname> <given-names>BW</given-names></name>. <article-title>Aerodynamics of tip-reversal upstroke in a revolving pigeon wing</article-title>. <source>The Journal of Experimental Biology</source>. <year>2011</year>;<volume>214</volume>(<issue>11</issue>):<fpage>1867</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.051342" xlink:type="simple">10.1242/jeb.051342</ext-link></comment> <object-id pub-id-type="pmid">21562173</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Taylor</surname> <given-names>GK</given-names></name>. <article-title>Mechanics and aerodynamics of insect flight control</article-title>. <source>Biological reviews of the Cambridge Philosophical Society</source>. <year>2001</year>;<volume>76</volume>(<issue>4</issue>):<fpage>449</fpage>–<lpage>71</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1017/S1464793101005759" xlink:type="simple">10.1017/S1464793101005759</ext-link></comment> <object-id pub-id-type="pmid">11762490</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ellington</surname> <given-names>C</given-names></name>. <article-title>The aerodynamics of hovering insect flight. I. The quasi-steady analysis</article-title>. <source>Philosophical Transactions of the Royal Society of London Series B: Biological Sciences</source>. <year>1984</year>;<volume>305</volume>(<issue>1122</issue>):<fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.1984.0051" xlink:type="simple">10.1098/rstb.1984.0051</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref037">
<label>37</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Swartz</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Iriarte-Díaz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Riskin</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Breuer</surname> <given-names>KS</given-names></name>. <chapter-title>A bird? A plane? No, it’s a bat: an introduction to the biomechanics of bat flight</chapter-title>. In: <source>Evolutionary History of Bats: Fossils, Molecules and Morphology</source> (Eds. <name name-style="western"><surname>Gunnell</surname> <given-names>GF</given-names></name>,  <name name-style="western"><surname>Simmons</surname> <given-names>NB</given-names></name>).; <year>2012</year>. p. <fpage>317</fpage>–<lpage>352</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref038">
<label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Küchemann</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Weber</surname> <given-names>J</given-names></name>. <chapter-title>Aerodynamics of propulsion</chapter-title>. <source>Principles of Guided Missile Design</source> <volume>vol. 2</volume>. <publisher-name>McGraw-Hill</publisher-name>; <year>1953</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Baier</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Gatesy</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Jenkins</surname> <given-names>Fa</given-names></name>. <article-title>A critical ligamentous mechanism in the evolution of avian flight</article-title>. <source>Nature</source>. <year>2007</year>;<volume>445</volume>(<issue>7125</issue>):<fpage>307</fpage>–<lpage>310</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature05435" xlink:type="simple">10.1038/nature05435</ext-link></comment> <object-id pub-id-type="pmid">17173029</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pennycuick</surname> <given-names>CJ</given-names></name>. <source>Bird Flight Performance: A Practical Calculation Manual</source>. <publisher-name>Oxford University Press</publisher-name>, <publisher-loc>Oxford</publisher-loc>; <year>1989</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hedrick</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Biewener</surname> <given-names>AA</given-names></name>. <article-title>Low speed maneuvering flight of the rose-breasted cockatoo (<italic>Eolophus roseicapillus</italic>). I. Kinematic and neuromuscular control of turning</article-title>. <source>The Journal of Experimental Biology</source>. <year>2007</year>;<volume>210</volume>(<issue>11</issue>):<fpage>1897</fpage>–<lpage>911</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.002055" xlink:type="simple">10.1242/jeb.002055</ext-link></comment> <object-id pub-id-type="pmid">17515416</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nudds</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Rayner</surname> <given-names>JMV</given-names></name>. <article-title>Scaling of body frontal area and body width in birds</article-title>. <source>Journal of Morphology</source>. <year>2006</year>;<volume>267</volume>(<issue>3</issue>):<fpage>341</fpage>–<lpage>346</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jmor.10409" xlink:type="simple">10.1002/jmor.10409</ext-link></comment> <object-id pub-id-type="pmid">16342078</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Berg</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rayner</surname> <given-names>J</given-names></name>. <article-title>The moment of inertia of bird wings and the inertial power requirement for flapping flight</article-title>. <source>The Journal of Experimental Biology</source>. <year>1995</year>;<volume>198</volume>(<issue>8</issue>):<fpage>1655</fpage>–<lpage>64</lpage>. <object-id pub-id-type="pmid">9319563</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tucker</surname> <given-names>VA</given-names></name>, <name name-style="western"><surname>Tucker</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Akers</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Enderson</surname> <given-names>JH</given-names></name>. <article-title>Curved flight paths and sideways vision in peregrine falcons (<italic>Falco peregrinus</italic>)</article-title>. <source>The Journal of Experimental Biology</source>. <year>2000</year>;<volume>203</volume>(<issue>24</issue>):<fpage>3755</fpage>–<lpage>63</lpage>. <object-id pub-id-type="pmid">11076739</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jenkins</surname> <given-names>AR</given-names></name>. <article-title>Morphometrics and flight performance of southern African Peregrine and Lanner Falcons</article-title>. <source>Journal of avian biology</source>. <year>1995</year>; p. <fpage>49</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/3677212" xlink:type="simple">10.2307/3677212</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref046">
<label>46</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Van Dyke</surname> <given-names>M</given-names></name>. <source>Perturbation methods in fluid mechanics</source>. <publisher-name>Parabolic Press</publisher-name>, Incorporated; <year>1975</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Blasius</surname> <given-names>H</given-names></name>. <source>Grenzschichten in Flüssigkeiten mit kleiner Reibung</source>. <publisher-name>Druck von BG Teubner</publisher-name>; <year>1907</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hodos</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bonbright</surname> <given-names>JC</given-names></name>. <article-title>Detection of the velocity of movement of visual stimuli by pigeons</article-title>. <source>Journal of the Experimental Analysis of Behavior</source>. <year>1976</year>;<volume>25</volume>(<issue>2</issue>):<fpage>143</fpage>–<lpage>156</lpage>. <object-id pub-id-type="pmid">932616</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pennycuick</surname> <given-names>C</given-names></name>. <article-title>The strength of the pigeon’s wing bones in relation to their function</article-title>. <source>Journal of Experimental Biology</source>. <year>1967</year>;<volume>46</volume>:<fpage>219</fpage>–<lpage>233</lpage>. <object-id pub-id-type="pmid">6033991</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schmitz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ponitz</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Brücker</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Schmitz</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Herweg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bleckmann</surname> <given-names>H</given-names></name>. <article-title>Morphological properties of the last primaries, the tail feathers, and the alulae of Accipiter nisus, Columba livia, Falco peregrinus, and Falco tinnunculus</article-title>. <source>Journal of morphology</source>. <year>2015</year>;<volume>276</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/jmor.20317" xlink:type="simple">10.1002/jmor.20317</ext-link></comment> <object-id pub-id-type="pmid">25130288</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jenkins</surname> <given-names>AR</given-names></name>. <article-title>Morphometrics and flight performance of southern African Peregrine and Lanner Falcons</article-title>. <source>Journal of Avian Biology</source>. <year>1995</year>;<volume>26</volume>(<issue>1</issue>):<fpage>49</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/3677212" xlink:type="simple">10.2307/3677212</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ward</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Möller</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Rayner</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Nachtigall</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Speakman</surname> <given-names>J</given-names></name>. <article-title>Metabolic power of European starlings Sturnus vulgaris during flight in a wind tunnel, estimated from heat transfer modelling, doubly labelled water and mask respirometry</article-title>. <source>Journal of Experimental Biology</source>. <year>2004</year>;<volume>207</volume>(<issue>24</issue>):<fpage>4291</fpage>–<lpage>4298</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/jeb.01281" xlink:type="simple">10.1242/jeb.01281</ext-link></comment> <object-id pub-id-type="pmid">15531650</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ward</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Möller</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Rayner</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bilo</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Nachtigall</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Metabolic power, mechanical power and efficiency during wind tunnel flight by the European starling Sturnus vulgaris</article-title>. <source>Journal of Experimental Biology</source>. <year>2001</year>;<volume>204</volume>(<issue>19</issue>):<fpage>3311</fpage>–<lpage>3322</lpage>. <object-id pub-id-type="pmid">11606605</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nudds</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>ALR</given-names></name>. <article-title>Tuning of Strouhal number for high propulsive efficiency accurately predicts how wingbeat frequency and stroke amplitude relate and scale with size and flight speed in birds</article-title>. <source>Proceedings of the Royal Society of London. Series B</source> <year>2004</year>;<volume>271</volume>(<issue>1552</issue>):<fpage>2071</fpage>–<lpage>2076</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rspb.2004.2838" xlink:type="simple">10.1098/rspb.2004.2838</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Torre-Bueno</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Larochelle</surname> <given-names>J</given-names></name>. <article-title>The metabolic cost of flight in unrestrained birds</article-title>. <source>Journal of Experimental Biology</source>. <year>1978</year>;<volume>75</volume>(<issue>1</issue>):<fpage>223</fpage>–<lpage>229</lpage>. <object-id pub-id-type="pmid">702041</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pennycuick</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Klaassen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kvist</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lindström</surname> <given-names>Å</given-names></name>. <article-title>Wingbeat frequency and the body drag anomaly: wind-tunnel observations on a thrush nightingale (Luscinia luscinia) and a teal (Anas crecca)</article-title>. <source>Journal of Experimental Biology</source>. <year>1996</year>;<volume>199</volume>(<issue>12</issue>):<fpage>2757</fpage>–<lpage>2765</lpage>. <object-id pub-id-type="pmid">9320660</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Warrick</surname> <given-names>D</given-names></name>. <article-title>The turning-and linear-maneuvering performance of birds: the cost of efficiency for coursing insectivores</article-title>. <source>Canadian Journal of Zoology</source>. <year>1998</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1139/z98-044" xlink:type="simple">10.1139/z98-044</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cooke</surname> <given-names>MT</given-names></name>. <article-title>Speed of bird flight</article-title>. <source>The Auk</source>. <year>1933</year>;<volume>50</volume>(<issue>3</issue>):<fpage>309</fpage>–<lpage>316</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/4076639" xlink:type="simple">10.2307/4076639</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006044.ref059">
<label>59</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Feare</surname> <given-names>C</given-names></name>. <chapter-title>The starling</chapter-title>. <source>Shire Natural History</source> <year>1984</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1006044.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Warrick</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dial</surname> <given-names>K</given-names></name>. <article-title>Kinematic, aerodynamic and anatomical mechanisms in the slow, maneuvering flight of pigeons</article-title>. <source>The Journal of Experimental Biology</source>. <year>1998</year>;<volume>201</volume>(<issue>12</issue>):<fpage>655</fpage>–<lpage>72</lpage>. <object-id pub-id-type="pmid">9450975</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>