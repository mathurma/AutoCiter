<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006054</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00997</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Signal transduction</subject><subj-group><subject>Cell signaling</subject><subj-group><subject>Calcium signaling</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Imaging techniques</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Calcium imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuroimaging</subject><subj-group><subject>Calcium imaging</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Engineering and technology</subject><subj-group><subject>Signal processing</subject><subj-group><subject>Signal to noise ratio</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject><subj-group><subject>Bone and mineral metabolism</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Mathematical functions</subject><subj-group><subject>Wavelet transforms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject><subj-group><subject>Neurites</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject><subj-group><subject>Neuronal dendrites</subject><subj-group><subject>Neurites</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>An open source tool for automatic spatiotemporal assessment of calcium transients and local ‘signal-close-to-noise’ activity in calcium imaging data</article-title>
<alt-title alt-title-type="running-head">Computation of local and signal-close-to-noise calcium activity</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Prada</surname>
<given-names>Juan</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Sasi</surname>
<given-names>Manju</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Martin</surname>
<given-names>Corinna</given-names>
</name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Jablonka</surname>
<given-names>Sibylle</given-names>
</name>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1886-7625</contrib-id>
<name name-style="western">
<surname>Dandekar</surname>
<given-names>Thomas</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5270-3854</contrib-id>
<name name-style="western">
<surname>Blum</surname>
<given-names>Robert</given-names>
</name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Bioinformatics, University of Würzburg, Würzburg, Germany</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Institute of Clinical Neurobiology, University Hospital Würzburg, Würzburg, Germany</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Schneidman</surname>
<given-names>Dina</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Hebrew University of Jerusalem, ISRAEL</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="other" id="econtrib001">
<p>‡ TD and RB also contributed equally to this work.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">dandekar@biozentrum.uni-wuerzburg.de</email> (TD); <email xlink:type="simple">Blum_R@UKW.de</email> (RB)</corresp>
</author-notes>
<pub-date pub-type="epub">
<day>30</day>
<month>3</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="collection">
<month>3</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>3</issue>
<elocation-id>e1006054</elocation-id>
<history>
<date date-type="received">
<day>19</day>
<month>6</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>22</day>
<month>2</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Prada et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006054"/>
<abstract>
<p>Local and spontaneous calcium signals play important roles in neurons and neuronal networks. Spontaneous or cell-autonomous calcium signals may be difficult to assess because they appear in an unpredictable spatiotemporal pattern and in very small neuronal loci of axons or dendrites. We developed an open source bioinformatics tool for an unbiased assessment of calcium signals in x,y-t imaging series. The tool bases its algorithm on a continuous wavelet transform-guided peak detection to identify calcium signal candidates. The highly sensitive calcium event definition is based on identification of peaks in 1D data through analysis of a 2D wavelet transform surface. For spatial analysis, the tool uses a grid to separate the x,y-image field in independently analyzed grid windows. A document containing a graphical summary of the data is automatically created and displays the loci of activity for a wide range of signal intensities. Furthermore, the number of activity events is summed up to create an estimated total activity value, which can be used to compare different experimental situations, such as calcium activity before or after an experimental treatment. All traces and data of active loci become documented. The tool can also compute the signal variance in a sliding window to visualize activity-dependent signal fluctuations. We applied the calcium signal detector to monitor activity states of cultured mouse neurons. Our data show that both the total activity value and the variance area created by a sliding window can distinguish experimental manipulations of neuronal activity states. Notably, the tool is powerful enough to compute local calcium events and ‘signal-close-to-noise’ activity in small loci of distal neurites of neurons, which remain during pharmacological blockade of neuronal activity with inhibitors such as tetrodotoxin, to block action potential firing, or inhibitors of ionotropic glutamate receptors. The tool can also offer information about local homeostatic calcium activity events in neurites.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Calcium imaging has become a standard tool to investigate local, spontaneous, or cell-autonomous calcium signals in neurons. Some of these calcium signals are fast and ‘small’, thus making it difficult to identify real signaling events due to an unavoidable signal noise. Therefore, it is difficult to assess the spatiotemporal activity footprint of individual neurons or a neuronal network. We developed this open source tool to automatically extract, count, and localize calcium signals from the whole x,y-t image series. As demonstrated here, the tool is useful for an unbiased comparison of activity states of neurons, helps to assess local calcium transients, and even visualizes local homeostatic calcium activity. The tool is powerful enough to visualize signal-close-to-noise calcium activity.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>BL567/3-2</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5270-3854</contrib-id>
<name name-style="western">
<surname>Blum</surname>
<given-names>Robert</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>IZKF Würzburg</institution>
</funding-source>
<award-id>N-261</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-5270-3854</contrib-id>
<name name-style="western">
<surname>Blum</surname>
<given-names>Robert</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution>Graduate School of Life Sciences Würzburg</institution>
</funding-source>
<award-id>Fellowship</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Prada</surname>
<given-names>Juan</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution>Graduate School of Life Sciences Würzburg</institution>
</funding-source>
<award-id>Fellowship</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Sasi</surname>
<given-names>Manju</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>SFB688/A2</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1886-7625</contrib-id>
<name name-style="western">
<surname>Dandekar</surname>
<given-names>Thomas</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100001659</institution-id>
<institution>Deutsche Forschungsgemeinschaft</institution>
</institution-wrap>
</funding-source>
<award-id>JA1823/3-1</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Jablonka</surname>
<given-names>Sibylle</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>JP and MS were supported by fellowships of the Graduate School of Life Sciences (GSLS) Würzburg. RB was supported by the Deutsche Forschungsgemeinschaft (DFG) BL567/3-2, and IZKF N-261 to RB, H. Rittner, and B. Oehler, Department of Anesthesiology Würzburg. TD was supported by DFG (SFB688/A2) and SJ was supported by DFG (JA1823/3-1). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="1"/>
<page-count count="34"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-04-11</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files. The open source tool is available on GitHub, a development platform: <ext-link ext-link-type="uri" xlink:href="https://github.com/jpits30/NeuronActivityTool" xlink:type="simple">https://github.com/jpits30/NeuronActivityTool</ext-link>. Application examples and further developments of the computational tool will be available at the tool's GitHub page or mentioned at <ext-link ext-link-type="uri" xlink:href="https://www.biozentrum.uni-wuerzburg.de/bioinfo/computing/neuralactivitycubic/" xlink:type="simple">https://www.biozentrum.uni-wuerzburg.de/bioinfo/computing/neuralactivitycubic/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Software paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Calcium ions mediate fast signaling to regulate neuronal development, synaptic transmission, and synaptic plasticity [<xref ref-type="bibr" rid="pcbi.1006054.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1006054.ref005">5</xref>]. Calcium imaging has become a standard technique for mapping neuronal activity in neurons <italic>in vitro</italic> and <italic>in vivo</italic> [<xref ref-type="bibr" rid="pcbi.1006054.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref007">7</xref>]. Although calcium signaling of neurons is well investigated, calcium-dependent mechanisms underlying spontaneous or cell-autonomous excitability are not well understood [<xref ref-type="bibr" rid="pcbi.1006054.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1006054.ref011">11</xref>]. Investigating the molecular mechanisms underlying spontaneous calcium influx revealed two principle mechanisms of how spontaneous excitation is initiated. Either spontaneous excitation is ligand-dependent and caused by the non-synaptic release of transmitters such as glutamate or GABA [<xref ref-type="bibr" rid="pcbi.1006054.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref013">13</xref>]. Alternatively, excitability is part of a developmental program and is triggered by the neuron itself, meaning by cell-autonomous excitation using subthreshold active ion channels, or is caused by self-enhancement of intrinsic excitability through autocrine signaling [<xref ref-type="bibr" rid="pcbi.1006054.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref014">14</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref015">15</xref>]. Furthermore, homeostatic calcium fluxes are cell-autonomously controlled and occur in cellular subdomains [<xref ref-type="bibr" rid="pcbi.1006054.ref016">16</xref>]. Three major explanations of why signaling of spontaneous or cell-autonomous excitability is not well investigated can be proposed: (1) Calcium transients can appear at very local places, and their spatiotemporal footprint is not predictable. (2) Proteins involved in neuronal excitation show a high functional diversity, depending on their locus of action. (3) Neuronal signals can be very fast and ‘small’, thus making it difficult to identify real signaling events due to the unavoidable measurement noise.</p>
<p>Techniques to extract calcium signals from imaging data are commonly region of interest (ROI) analyses. ROIs are typically selected manually or in a semi-automated manner [<xref ref-type="bibr" rid="pcbi.1006054.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>]. This approach is time-consuming in assessing the spatiotemporal activity pattern of neurons. Moreover, the selection of ROIs and the criteria to define activity events is rather heuristic and largely user-dependent [<xref ref-type="bibr" rid="pcbi.1006054.ref017">17</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>]. Signal identification, not only in calcium imaging data, but also in mass spectrometric data, is often performed using noise filtering and peak identification algorithms. However, this strategy creates a high false-positive rate, especially when low amplitude peaks are analyzed [<xref ref-type="bibr" rid="pcbi.1006054.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>]. Calcium signal identification and signal source separation are two separate problems in calcium signal analysis. To support the analysis of imaging data many helpful automated or semi-automated computational tools have been developed [<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1006054.ref028">28</xref>]. Therefore, advanced computational tools are helpful to localize, extract and sort cellular signals to detect neuronal calcium activity [<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>] or to strengthen the detection of calcium activity by signal demixing and denoising [<xref ref-type="bibr" rid="pcbi.1006054.ref022">22</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref026">26</xref>]. Multiple arithmetical strategies to read out calcium signals from raw data exist, and each of these methods has its advantages [<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref029">29</xref>]. However, strategies to identify local activity close to the noise level with high sensitivity are not well developed. There is a certain risk that activity events, which are not spike-like, or are very close to the measurement noise, may be ignored by computational tools using denoising, or feature-dependent methods for calcium time series analysis. This can be of advantage, as this strategy creates robust data to describe spike-like activity in neurons. However, those strategies might ignore activity below the spike threshold, or activity that is local and not synchronous with the firing pattern, or not triggered by voltage-dependent mechanisms. Another problem is that local calcium transients are commonly not shaped as calcium spikes (fast onset followed by a slower decay of the signal) and are filtered out by algorithms that expect a calcium spike or are filtered out because of computational strategies that define noise levels or noise signals [<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref027">27</xref>].</p>
<p>Many biologically relevant calcium signals are very small and close to the measurement noise. Here, we tackle the problem of computing “signal-close-to-noise” activity, which is a calcium signal under pharmacological blockade of neuronal activity, in the absence of any exogenous stimulation or treatment. Here we define an activity event (signal) as a calcium event carrying information, while a computed noise event does not carry biological information. Therefore, we assume that homeostatic calcium fluxes of resting neurons [<xref ref-type="bibr" rid="pcbi.1006054.ref030">30</xref>] should create calcium events.</p>
<p>In certain research questions, the analysis of local calcium transients offers important functional information. Local calcium activity regulates functions such as neurotransmitter specification, neurite extension, growth cone dynamics, activity-dependent axon growth, network wiring, as well as synaptic scaling [<xref ref-type="bibr" rid="pcbi.1006054.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref031">31</xref>–<xref ref-type="bibr" rid="pcbi.1006054.ref036">36</xref>]. While we know much about functions of local calcium signaling, the molecules triggering local or spontaneous activity are not well understood.</p>
<p>Here, we introduce an intuitive computational approach to assess the activity state of neurons and to visualize signal-close-to-noise activity. The motivation was to create this tool for an unbiased computing of local activity in neurites, to monitor local excitability events, and to visualize homeostatic calcium activity. The bioinformatical tool is a refined Continuous Wavelet Transform (CWT)-based algorithm which identifies peak candidates in calcium activity signals occurring in the x,y-t imaging data set. As local calcium transients are hardly predictable or regularly shaped, we create a grid-based activity pattern over the x,y-field of the raw image data. CWT-guided peak detection was used to compute calcium signals, because we found that it targets critical problems in signal-close-to-noise computing: (1.) Baseline removal and signal smoothing is not needed and even small signals are accurately computed. (2.) The algorithm can be directly applied to raw data. (3.) Low amplitude peaks can still be real, and peak detection through local signal-to-noise ratio computation above a heuristic threshold may become an insufficient criterion to detect small signals, or to discriminate real signals from high amplitudes of noise signals. Therefore, instead of directly detecting peaks in the calcium signal, the algorithm identifies ridges in a CWT coefficient matrix and utilizes these coefficients to create an effective SNR for peak identification. These coefficients effectively guide the search for peaks that correspond to real calcium activity on the neurons. This improves the robustness of peak detection and keeps the false positive rate low [<xref ref-type="bibr" rid="pcbi.1006054.ref020">20</xref>].</p>
<p>Here we confirm that our strategy enables the identification of calcium activity events independent of segmentation parameters and shape parameters. The tool is easy to handle, powerful over the complete intensity value range, and ignores baseline shifts. More importantly, the computation identifies local activity events, even under pharmacological blockade of neuronal activity, and gives new information on calcium activity close to the signal noise. The tool is an open source tool.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Design and implementation</title>
<p>Basic principles of the computational tool are explained in the methods section. We first explain the basic concept of our activity analysis approach and illustrate its performance based on calcium imaging data. Then we compare the tool’s features to alternative approaches. This is followed by detailed evaluation of the bioinformatics approach with calcium imaging data. Next, we map signal-close-to noise activity in neurites in the presence of inhibitors of neuronal activity in order to visualize and localize spontaneous and local neuronal activity events. Finally, we confirm signal-close-to-noise activity induced by homeostatic calcium fluxes.</p>
<p>To test our computational approach, we started with standard calcium imaging of cultured motoneurons. Motoneurons show spontaneous calcium transients commonly categorized as ‘global’ or ‘local’ activity [<xref ref-type="bibr" rid="pcbi.1006054.ref013">13</xref>]. In mouse motoneurons, this kind of activity has been shown to be cell-autonomous and to mediate activity-dependent axon growth [<xref ref-type="bibr" rid="pcbi.1006054.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref014">14</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref032">32</xref>]. We used the motoneuron system to see whether the computational tool is able to describe spontaneous shifts from a low activity state to a high activity state. In the low activity state, motoneurons show almost no spontaneous activity, before they change their activity state and show more than ten calcium transients per minute [<xref ref-type="bibr" rid="pcbi.1006054.ref010">10</xref>]. This experiment is used to explain the workflow of the calcium activity detector tool. We call the open source tool ‘<italic>Neural Activity</italic><sup><italic>3</italic></sup>(<italic>NA</italic><sup><italic>3</italic></sup>) (<xref ref-type="fig" rid="pcbi.1006054.g001">Fig 1</xref>).</p>
<fig id="pcbi.1006054.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Overview of image analysis by NA<sup>3</sup>.</title>
<p><bold>a</bold>, Motoneuron loaded with a fluorescent calcium indicator. Average intensity projection of 1000 images to show the neuronal morphology. The neuron shifts spontaneously from a low activity state to a high activity state. Rainbow pseudocolor shows low intensity values in blue and high intensity values in red. <bold>b</bold>, Workflow for the analysis of calcium imaging raw data. After threshold determination according to a rule, the user defines the window size for x,y-grid, and chooses a signal-to-noise ratio value to tune the stringency of the tool. Two computations are started: (1) the signal intensity calculation, (2) the wavelet transform. A result pdf is automatically created. <bold>c</bold>, The signal-to-noise ratio (SNR) defines the stringency of the computation. The signal average threshold (SAT) can be used to set a signal threshold. The SAT can be close to the black level without having a strong impact on the computation result. <bold>d</bold>, The documentation pdf defines activity events, marks them, and counts them. All traces showing one or more activity events are given and used to count the total activity. An overview image is created that shows the grid over the first image of the movie, red circles to visualize the activity state of a grid window, and the total activity value, which is a computed value to describe the overall activity state of the neurons. The number of counted activity events per grid window events is shown in a text fil in the results folder. <bold>e</bold>, Overview of the NA<sup>3</sup> workflow. The tool combines functions in ImageJ with “R”. Video processing and signal extraction occurs in ImageJ, before the signals are automatically transferred to “R”. In “R”, the event computing takes place. The result is created in “R” and exported as a pdf-file. The results are also transferred back to ImageJ to allow an interactive access to the data for image processing, ROI selection, or data evaluation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g001" xlink:type="simple"/>
</fig>
<sec id="sec003">
<title>Basic concept and operation of the neuronal activity detection tool</title>
<p>Imaging can be performed with any imaging system that creates intensity values. Here, we used a CCD camera (8-bit) at 2.5 Hz (motoneurons), or 10–20 Hz (hippocampal neurons) (<xref ref-type="fig" rid="pcbi.1006054.g001">Fig 1a</xref>). Next, the image series is uploaded to the activity detector tool. After opening the image series, the program asks for three tuning parameters: the grid <bold>window size (WS)</bold>, the <bold>signal-to-noise ratio (SNR)</bold> and the <bold>signal average threshold (SAT)</bold> (<xref ref-type="fig" rid="pcbi.1006054.g001">Fig 1b and 1c</xref>; see <xref ref-type="supplementary-material" rid="pcbi.1006054.s010">S1 Manual</xref>). The window size (WS) will create a grid of ROIs with a defined size (e.g. 8x8 pixel, <xref ref-type="fig" rid="pcbi.1006054.g001">Fig 1d</xref>). The grid is used to localize activity events. The signal-to-noise ratio (SNR) is the most important value and defines the stringency of the calcium event detector. SNR values of 1.5 to 4 (or even 1.3) provide robust results on typical datasets acquired with the help of fluorescent calcium indicators. In our experience, computing of high signal-to-noise datasets, such as those obtained with modern genetically encoded calcium indicators [<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref037">37</xref>], can be performed with much higher SNR values. The signal average threshold (SAT) can be used to threshold the signals or to remove background signals. The threshold is a mean fluorescence value in a selected ROI, which can be taken either from the cell-free background or from any low-activity area in the x,y-image series. The SAT can be determined by a simple rule; SAT is the rounded threshold value. Note that the SAT can be set close to the black level. The reason is that the tool works with a CWT-based detection algorithm [<xref ref-type="bibr" rid="pcbi.1006054.ref020">20</xref>] and therefore background removal with the help of a threshold value has only a minor influence on the final result. Calcium activity event identification is then performed by two operations: (1) <bold><italic>Process image stack</italic></bold> to read out the signal intensity values in each grid window; (2) <bold><italic>Detect activity</italic></bold> to perform a wavelet transformation and to detect activity peaks.</p>
<p>A pdf-document is automatically generated and put into the result folder of the activity tool (<xref ref-type="supplementary-material" rid="pcbi.1006054.s001">S1 Fig</xref>; computing WS8, SNR2, SAT7, MAC1). This document shows on page 1 an image of the time series, the grid, and loci of calcium activity indicated by red circles within the grid window. The diameter of the circles is bigger when the tool finds more activity events. All activity events are summed up to give a computed value, the ‘total activity’ value (<xref ref-type="fig" rid="pcbi.1006054.g001">Fig 1d</xref>). This value represents all calcium events in the whole x,y-t images series. The value represents the activity state under a specific experimental condition. Furthermore, the resulting pdf document shows all traces in which a calcium activity event was found, thus enabling fast access to the raw data and the interpretation of activity events by the tool. Activity events are marked and counted (<xref ref-type="fig" rid="pcbi.1006054.g001">Fig 1c and 1d</xref>). Finally, a txt-file is generated that shows the calculated numbers of activity per grid window in a x,y-table structure (<xref ref-type="supplementary-material" rid="pcbi.1006054.s002">S2 Fig</xref>). We also offer the possibility to increase the stringency of the tool. The user can select to count only those signal traces with more than one activity event (<bold><italic>Minimum activity counts</italic>; MAC</bold>). Furthermore, the tool is able to analyze signal fluctuations (<bold><italic>Include variance</italic></bold>). With this function, the tool offers a value called variance area. The idea is that signal fluctuations are bigger, when, for instance, homeostatic calcium fluxes are pronounced. This is very useful to experimentally test whether fast fluctuations in a calcium signal trace are activity-dependent or not. The tool also offers the possibility to estimate a point of change in the general behavior of the signal in order to compute states of long-lasting activity, for instance after stimulation of neurons with an agonist. This feature of the tool is based on a confidence test that recursively searches for the point in the signal where the biggest change in variance and average occurs. We also implemented a ROI tool, which allows the re-analysis of loci of interest. ROIs can be selected with the help of a ROI manager, an ImageJ function, and can be analyzed as described above. ROI information can also be imported to the ROI manager.</p>
<p>Calculation of 1300 images needed just about 60 seconds with the help of a standard desktop computer (Windows X64 Intel core i-5 machine with 4 Gigabyte of RAM memory). This short computing time allows fast testing of user-dependent tuning parameters, for instance to compute the same signals with different SNR values.</p>
<p>The tool processes the calcium imaging videos in ImageJ [<xref ref-type="bibr" rid="pcbi.1006054.ref038">38</xref>] for signal extraction. The data are automatically transferred to ‘R’ (<ext-link ext-link-type="uri" xlink:href="https://www.r-project.org/" xlink:type="simple">https://www.r-project.org/</ext-link>) for the statistical computing (<xref ref-type="fig" rid="pcbi.1006054.g001">Fig 1e</xref>; details are explained in the methods section). For some applications, pre-processing of the videos might be necessary. For this purpose, it is of advantage that the presented tool is embedded in ImageJ, which gives the user access to a wide range of image processing tools and interactive access to the data.</p>
<p>In <xref ref-type="table" rid="pcbi.1006054.t001">Table 1</xref> the application features of our tool are compared to alternative approaches, delineating the areas where we find that our tool is used advantageously.</p>
<table-wrap id="pcbi.1006054.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.t001</object-id>
<label>Table 1</label> <caption><title>Feature comparison.</title></caption>
<alternatives>
<graphic id="pcbi.1006054.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center">Study</th>
<th align="center">Features and advantages</th>
<th align="center">Implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Romano et al., 2017</td>
<td align="left">Toolbox including algorithms and interactive tools for image pre-processing and segmentation, estimation and labeling of significant single-neuron signals, mapping of neuronal responses, and detection of activity-correlated neuronal clusters. Automatic somatic ROI or hexagonal grid of ROIs for signal extraction and other ROI tools. Signal candidates are labeled in the trace.</td>
<td align="center">Matlab</td>
</tr>
<tr>
<td align="center">Pnevmatikakis et al., 2016</td>
<td align="left">Cell detection or component segmentation with CNMF and signal extraction after spike detection with a spike model. Signal denoising and signal deconvolution implemented. Potent in demixing of overlapping signals, advanced framework for analysis of calcium activity of neurons. The tool is very powerful in extracting signals as a component.</td>
<td align="center">Matlab Python</td>
</tr>
<tr>
<td align="center">Patel et al., 2015</td>
<td align="left">Analysis package (FluoroSNNAP) for semiautomatic cell detection with stCA, knowledge-based signal identification and extraction based on a user-defined calcium event waveform library. Spike and connectivity analysis are integrated. It uses signal templates to identify and label signal candidates at the onset point of the signal. The tool can also be used with a deconvolution strategy.</td>
<td align="center">Matlab</td>
</tr>
<tr>
<td align="center">Maruyama et al., 2014</td>
<td align="left">Cell detection or component segmentation with plain NMF for demixing of slow and fast signal components in a x,y-field.</td>
<td align="center">Matlab</td>
</tr>
<tr>
<td align="center">Janicek et al., 2013</td>
<td align="left">Spike-feature analysis based on a spike model.</td>
<td align="center">Matlab</td>
</tr>
<tr>
<td align="center">Mukamel et al., 2009</td>
<td align="left">Cell detection or component segmentation with PCA/stICA; signal extraction, deconvolution, and spike detection, advanced for identification of calcium spikes and to extract individual signals.</td>
<td align="center">Matlab</td>
</tr>
<tr>
<td align="center">This study</td>
<td align="left">Unbiased pixelwise x,y-grid, counts activity events, event identification by CWT-guided peak detection, uses a pruning strategy to value signal candidates, estimates signal variance to define activity-based signal fluctuations. Developed for local, spontaneous event detection in the whole x,y-field. Creates two natural numbers for activity state comparison: the total activity value and the variance area for signal fluctuation. Offers an activity image of the neurons and is useful to identify loci of activity in neurites or in the neuropil. The user can also use ROI information with the help of the ImageJ ROI manager.</td>
<td align="center">ImageJ / R in BIO7 (open source,no software license required)</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="sec004" sec-type="results">
<title>Results</title>
<sec id="sec005">
<title>Computation of high versus low activity in motoneurons</title>
<p>Firstly, we asked whether the tuning parameters (SAT and SNR; <xref ref-type="fig" rid="pcbi.1006054.g001">Fig 1b</xref>) are robust enough to assess the activity state of a motoneuron. For convenience, this is again explained based on the single motoneuron (<xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2</xref>). The movie was split into a low activity state (frame 1–1300) and a high activity state (frame 1301–2600). We compared the low activity state with the high activity state of this globally firing motoneuron over a wide range of SNR values between 1.5 and 4 (<xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2b</xref>). Increasing the SNR increased the stringency of the tool, meaning that the tool preferentially identified stronger changes in fluorescence, or spike-like activity events (<xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2b</xref>). The SAT can be determined according to a rule, but little changes in the SAT only have a minor influence on the total number of activity events (<xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2b</xref>). As the calculation time is relatively short, the user can easily find a SNR, which fits best to the individual experimental condition or experimental setup. In this example, the high activity state of the motoneuron is defined by the total activity value of 613 (WS: 8; SNR: 2; SAT: 6; MAC: 1; <xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2c</xref>). The low activity state is represented by a total activity value of 102 (<xref ref-type="supplementary-material" rid="pcbi.1006054.s003">S3 Fig</xref>). Although the underlying intensity signals within the grid windows are based on an almost 10-fold difference in the intensity values between the soma and the growth cone, the tool is able to compute relevant changes in signal intensity in the grid windows that superimpose the motoneuron (<xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2d</xref>).</p>
<fig id="pcbi.1006054.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Calcium activity assessment with the activity detector tool.</title>
<p><bold>a</bold>, Principle of calcium activity event detection. Activity event identification is shown for a representative grid window (per se representing a ROI) on a single motoneuron. This motoneuron (shown in the inlet, and in <xref ref-type="fig" rid="pcbi.1006054.g001">Fig 1</xref>) shows global calcium transients. 2600 images (frames; x-axis) were analyzed. The grey trace shows the raw mean intensity values of a representative grid window. After extraction of the image signal in a grid window, all local maxima of the intensity signal are identified at several scales (y-axis) and signal candidates are selected and marked (blue dots). Details are explained in the methods: <italic>Strategy for calcium event (peak) identification</italic>. <bold>b</bold>, Effect of tuning parameters on calcium activity event detection. The total number of computed activity events (y-axis) in relation to changes in the user-dependent signal-to-noise ratio (SNR). Two activity stages of the motoneuron are compared. The low activity state (<italic>in a</italic>, frame 1–1300) and the high activity state (frame 1301–2600). Discrimination of the high activity state and the low activity state is very effective over a broad range of SNR values from 1.5 to 4. The signal average threshold was set to an intensity value of 6 (up-rounded mean intensity value seen in the background). A conservative SAT value was selected and modified at a SNR of 2 (blue square; SAT = 5 a.u.; purple circle; SAT = 6 a.u.). <bold>c</bold>, Data documentation 1: x,y-t summary. The image shows the distribution and number of calcium activity events raised by a spontaneously active motoneuron. Such an image is automatically generated by the program. The user-dependent tuning parameters for this analysis are given. The image field 142 x 130 pixel was automatically split in a grid of 8 x 8 pixel (WS 8 px). Magenta circles indicate areas with calcium events. The smaller the diameter, the less activity is found in the corresponding grid window. All detected calcium activity events are summed up to offer the value ‘total activity’. <bold>d</bold>, Data documentation 2: the individual traces represent changes in fluorescence in one grid window. The tool automatically generates traces (black line) representing a grid window and shows raw bit values (y-axis) over the frame number (x-axis). Calcium activity events detected by the tool are labeled with a little red square at the peak point. The upper panel describes the graph in grid 5/14 (x/y-axis) in the somatic region of the motoneuron. Here raw bit values ranged from about 65 to 110. In the lower panel a region in the growth cone of the motoneuron was analyzed (grid 13/4; x/y-axis). Here, raw mean bit values in the grid range from 6 to 10. Note the robust detection of global activity despite an almost 10-fold difference in the mean intensity values in the corresponding grid window.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Tool performance</title>
<p>To test the performance and reliability of our computation, we performed simultaneous whole-cell patch clamp recording and calcium imaging. First, we offered the calcium indicator dye with the intracellular patch clamp solution (<xref ref-type="fig" rid="pcbi.1006054.g003">Fig 3a</xref>) and stimulated the cells by twelve current injections for 10, 100, 200, or 500 ms to induce action potentials (AP) and AP-induced calcium transients. We extracted the calcium signals and determined whether the AP-induced calcium transients can be detected by our computation. Our computational strategy detected the AP-induced calcium event (true positive response, TPR) with high precision (<xref ref-type="fig" rid="pcbi.1006054.g003">Fig 3b and 3c</xref>). On average, at an imaging speed of one image per 50 ms, the time between the AP and the time point of computed AP-induced calcium peaks was 320 ms ± 65 ms (n = 192 events from 4 cells, mean value ± variance). False-positive events (FPR) were a minor problem under these circumstances. Other event detection methods also provided reliable results (<xref ref-type="fig" rid="pcbi.1006054.g003">Fig 3b</xref>). While a deconvolution method marked several false-positive events, template-matching strategy and a strategy to extract significant signals above a computed baseline [<xref ref-type="bibr" rid="pcbi.1006054.ref027">27</xref>] labelled the AP-induced calcium signal with high precision [<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>].</p>
<fig id="pcbi.1006054.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Computation of action potential-induced calcium events.</title>
<p>a, Experimental approach. Whole-cell patch clamp recording and parallel calcium imaging of single cells. Here, the calcium indicator was applied with the help of the patch clamp pipette. <bold>b,c</bold>, Analysis of true-positive responses (TPR) and false-positive responses (FPR) based on parallel calcium imaging and patch clamp recording. Action potentials were induced by current injection (12 times, 200 pA, interstimulus interval: 5 s) for different times (10–500 ms). Current injection of 200 pA for 10 ms (upper panel in c) or 100 ms (lower panel in c) induced single action potentials (indicated by the blue label and vertical line. Calcium imaging was performed at 20 Hz. Calcium event labeling by four computational approaches. Four computational strategies for calcium event definition were applied; our CWT-approach, deconvolution, template-matching, and definition of significant signals above a computed baseline (‘Romano toolbox’). <bold>d</bold>, Experimental approach. Hippocampal neurons were cultured for 24 days in vitro. At this age, neurons develop glutamatergic synapses with mature hallmarks [<xref ref-type="bibr" rid="pcbi.1006054.ref039">39</xref>] and become spontaneously active. Cells were loaded with OGB1-AM and investigated with patch clamp recording and calcium imaging at 20 Hz. <bold>e, f</bold>, Electrophysiological recording of action potentials induced by spontaneous activity. In this trace, twelve action potentials are marked and correlate with AP-induced calcium spikes. All twelve calcium events (ROI, cell soma in a) were labeled by the CWT computation under these low SNR conditions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g003" xlink:type="simple"/>
</fig>
<p>Next, we asked whether our computation could also detect spontaneous activity in long-term cultured hippocampal neurons (DIV 24) (<xref ref-type="fig" rid="pcbi.1006054.g003">Fig 3d–3f</xref>). APs generated by spontaneous activity were inducing typical calcium spikes, and these calcium events were detected by our computational approach (<xref ref-type="fig" rid="pcbi.1006054.g003">Fig 3f</xref>). <xref ref-type="supplementary-material" rid="pcbi.1006054.s004">S4 Fig</xref> shows how our tool and other computations identify or count activity events in a calibration dataset showing simultaneous imaging with loose-seal cell-attached recording in four GCaMP expressing neurons [<xref ref-type="bibr" rid="pcbi.1006054.ref037">37</xref>] (data taken from: <ext-link ext-link-type="uri" xlink:href="https://crcns.org/data-sets/methods/cai-1/about-cai-1" xlink:type="simple">https://crcns.org/data-sets/methods/cai-1/about-cai-1</ext-link>).</p>
</sec>
<sec id="sec007">
<title>Computing of calcium spikes (high SNR conditions)</title>
<p>To see how the tool behaves under high signal-to-noise ratio conditions, we re-computed a recent dataset of typical calcium spikes generated by synchronously active neurons (<xref ref-type="fig" rid="pcbi.1006054.g004">Fig 4a</xref>) [<xref ref-type="bibr" rid="pcbi.1006054.ref040">40</xref>]. In this example, calcium signals of glia-derived neurons were investigated by confocal calcium imaging [<xref ref-type="bibr" rid="pcbi.1006054.ref040">40</xref>]. Under continuous perfusion, neurons were treated with 10 μM bicuculline to block gamma-aminobutyric acid (GABA)<sub>A</sub> receptors and to induce calcium spikes (<xref ref-type="fig" rid="pcbi.1006054.g004">Fig 4a</xref>) [<xref ref-type="bibr" rid="pcbi.1006054.ref040">40</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref041">41</xref>]. By using high stringency settings, the tool automatically extracts the spike signal (<xref ref-type="fig" rid="pcbi.1006054.g004">Fig 4a</xref>, average of all computed loci) and marks the grid windows in which the neurons show spike behavior (<xref ref-type="fig" rid="pcbi.1006054.g004">Fig 4a</xref>, computed loci). Note that under these imaging conditions, calcium spikes are preferentially observed in the neuronal somata. Next, we computed spontaneously spiking primary hippocampal neurons (<xref ref-type="fig" rid="pcbi.1006054.g004">Fig 4b</xref>). Here, the bioinformatics tool is powerful enough to automatically mark typical calcium spikes and to count 790 activity events (<xref ref-type="fig" rid="pcbi.1006054.g004">Fig 4b</xref>, middle). Acute blockade of the calcium spikes with the inhibitors tetrodotoxin (TTX) to inhibit TTX-sensitive voltage-gated sodium channels, and CNQX (6-cyano-7-nitroquinoxaline-2,3-dione) to inhibit ionotropic glutamate receptors, blocked the generation of calcium spikes. A more than 10-fold lower total activity value and a much lower number of active loci illustrate the change in activity (<xref ref-type="fig" rid="pcbi.1006054.g004">Fig 4b</xref>, right). The decline in the cytosolic calcium signal after activity blockade may be due to the low activity of voltage-gated calcium channels and the inability of neurons to maintain high calcium in the ER and cytosol [<xref ref-type="bibr" rid="pcbi.1006054.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref030">30</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref042">42</xref>]. The experiment shows that the activity detector is powerful enough to identify global spike-activity over a broad range of intensity signals.</p>
<fig id="pcbi.1006054.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Calcium spike-detection under stringent computing conditions.</title>
<p><bold>a</bold>, Confocal imaging of synchronously spiking glia-derived neurons (re-computing of earlier data; [<xref ref-type="bibr" rid="pcbi.1006054.ref040">40</xref>]. Cells were loaded with calcium indicator OGB1 to label glial cells and neurons. Spontaneous activity was induced by inhibition of GABAergic signaling with bicuculline to induce the spiking behavior in the neural network. A magenta arrow labels all neurons. Computed loci are shown. The average signal trace representing all computed loci is shown. <bold>b</bold>, Imaging was performed under low-light conditions. The raw image represents this imaging situation. Loci of computed activity events are shown on a brightness-contrast corrected image of the neurons. Under control conditions, spontaneous spiking is observed on the somata, but also in the periphery of the neurons. Spike blockade (TTX, CNQX) correlates with a reduced number of computed activity events. Graph: Raw intensity values are plotted against the frame number. The calcium spikes are efficiently blocked by TTX and CNQX. Scale bar in a: 100μm; in b: 50 μm.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g004" xlink:type="simple"/>
</fig>
<p>Next we asked how the tool behaves under more complex experimental conditions such as chemical LTP induction.</p>
</sec>
<sec id="sec008">
<title>Assessment of activity states in hippocampal neurons</title>
<p>Next, we performed calcium imaging with hippocampal neurons at a speed of 20 Hz and acquired thousands of images (up to 10,000) per experiment under continuous perfusion. To induce increased activity, neurons were stimulated with an extracellular solution for chemical LTP induction (<xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5</xref>). Two situations are compared; the control image sequence shows the time window before stimulation (<xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5b and 5c</xref>, left panel), while the cLTP stimulation phase is an equally long image series to describe the acute stimulation (<xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5b and 5c</xref>, right panel). Under control conditions, regions of high activity were preferentially identified in the neuronal periphery over neurites (<xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5b</xref>). Many of the computed signals were very small and showed no typical shape of a classic calcium spike (<xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5c</xref>; <xref ref-type="supplementary-material" rid="pcbi.1006054.s005">S5 Fig</xref>; WS8, SAT11, SNR 2.5; MAC2). Local activity with typical synchronous calcium spikes showed up at multiple positions of the x,y-field (<xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5d</xref>, yellow and blue marks). A look at the underlying raw image data showed that this spiking activity is caused by multiple varicosities of an axon-like structure. During chemical LTP induction, neurons showed increased spike-like activity (<xref ref-type="supplementary-material" rid="pcbi.1006054.s006">S6 Fig</xref>; WS8, SAT11, SNR 2.5; MAC2), and even developed global synchronous activity over cell somata and neurites (<xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5b</xref>). The increase in activity is described by the total activity values (2135 activity events versus 4785 activity events). The tool marked many activity events with a noise-like character (<xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5c</xref>, example traces on the left side). During stimulation with the cLTP-inducing solution, the same neuronal structures increase their cytosolic calcium levels, some oscillated in their calcium signal, and also developed typical calcium spikes (<xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5c</xref>, example traces on the right side), and the tool calculated an increased number of activity events.</p>
<fig id="pcbi.1006054.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Activity profile of cultured hippocampal neurons before and after activity induction.</title>
<p><bold>a</bold>, Average intensity: Hippocampal neurons loaded with a fluorescent calcium indicator. Control; neurons at a low activity state. cLTP; neurons in a global activity state after treatment with a chemical LTP induction solution. <bold>b</bold>, Activity distribution under control conditions. Calcium imaging was performed for 55 seconds with a speed of 20 Hz. Virtual total activity number (WS8, SNR 2.5, SAT 11, MAC 2): 2135 activity events. Note that regions of high activity are indicated by circles with a larger diameter (Fig 5d). Under cLTP treatment, neurons increase their total activity number to 4785 events. Yellow marks point to grid windows shown in c. <bold>c</bold>, Under control conditions, activity events close to the baseline trace are found at some positions. After cLTP treatment local and global calcium signals (global: red arrow) are detected. Calcium spikes and local calcium transients are marked. <bold>d</bold>, Calcium spikes in loci of synchronous activity. (left) Spontaneous activity profile of hippocampal neurons under control conditions. Neuronal somata do not exhibit a spiking behavior. Calcium spikes are identified in the periphery in indicated grid windows. Yellow squares point to grid windows, which are shown on the right with the corresponding signal trace and the activity marks. Blue arrows point to other grid windows with this synchronous activity pattern. Out-of-synchronicity events are also detected (Red arrow on the right). Some obvious calcium spikes were overseen by the computation due to the stringency parameters used for this analysis (purple arrows). In <xref ref-type="fig" rid="pcbi.1006054.g006">Fig 6e</xref> we show that the spikes are detected when the same data are analyzed at SNR values of 2.0 and 1.5.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Camera noise and false negative event computation</title>
<p>The stringency of the tool depends on the wavelet algorithm and the chosen SNR. In <xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5d</xref>, five signal traces are marked and show synchronous activity in the periphery. Purple arrows point to calcium spikes which were not counted by the activity detector, while the red arrow points to a local event that is only present in this trace (grid window 20/32). To show how the tool operates real noise in relation to noise-like activity, we compared the camera signal with real imaging data (<xref ref-type="fig" rid="pcbi.1006054.g006">Fig 6</xref>). For simplicity, this is explained based on the data in <xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5</xref>. We selected 12 grids and the underlying signal traces showing synchronous activity (as in <xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5d</xref>). In these traces, 23 calcium spikes can be identified in all of these grid windows. Grid windows of four representative loci are marked in <xref ref-type="fig" rid="pcbi.1006054.g006">Fig 6a</xref>, corresponding signal traces in <xref ref-type="fig" rid="pcbi.1006054.g006">Fig 6c</xref>. We put the SAT close to the black level to include all grid windows in the analysis. Next we determined the spike detection precision under different SNR values (SNR 1.5 –SNR 3.0) (<xref ref-type="fig" rid="pcbi.1006054.g006">Fig 6e</xref>). The tool computed all 23 events with a SNR of 1.5, but finds fewer events with an SNR of 3.0, which reflects the small change in signal intensity in these regions. For instance, in <xref ref-type="fig" rid="pcbi.1006054.g006">Fig 6c</xref>, grid window 22/23 shows a high sensitivity to high SNR values (‘worst case’). Here, the mean intensity signal lies between 12–14.5 arbitrary units (<italic>de facto</italic> reflecting the mean of the raw bit values), and therefore high SNR values ignore some calcium spikes. However, in the best case, in grid window 1/13, the spike detection precision is constant over a wide range of SNR values, because the signal is very clear. Here, the mean raw values of the signal shifts from about 10–16 arbitrary units during a calcium spike. An auto-correction removes border effects caused by the calculation itself. The missing calcium events in <xref ref-type="fig" rid="pcbi.1006054.g005">Fig 5d</xref> (purple arrows) were excluded because of a too stringent definition of the SNR. Furthermore, it shows that it can be useful to analyze signal traces of the same video under different SNR conditions in order to describe different experimental conditions, as, for instance, before or after activity blockade.</p>
<fig id="pcbi.1006054.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Wavelet-based activity detection in noise signals and spike-detection precision in a spontaneous active hippocampal neuron.</title>
<p><bold>a</bold> Activity distribution under control conditions (movie as in <xref ref-type="fig" rid="pcbi.1006054.g004">Fig 4b</xref>, left panel). Here, analysis was performed with the following parameters: WS8, SNR 2.5, SAT 2, MAC 1). 4092 activity events were computed. <bold>b</bold>, Noise video analysis. A homogenous fluorescence signal was imaged (identical camera settings). Analysis was performed with the following parameters: WS8, SNR 2.5, SAT 2, MAC 1). 53 noise events were computed. Some signals are camera-based (graph 31/21). <bold>c</bold>, Calcium spikes in loci of synchronous activity. Loci are marked in (a). All cell soma ROI (magenta) was computed with the ROI tool in NA<sup>3</sup>.<bold>d</bold>, Typical signal traces found in the noise video. Grid windows are indicated in (b). <bold>e</bold>, Spike-detection precision. Areas showing 23 synchronous spikes (1/13–41/23) are compared with a subthreshold SAT value, at different SNR values. The graph shows the underestimation in the number of spikes in the y-axis. <bold>f</bold>, Comparison of computed events in the noise video (in b) compared to spontaneous active neurons (in a). Settings were: WS8, SNR variable, SAT 2, MAC 1. All SNR values allow the discrimination between the noise state and the active state. The higher the SNR, the better is the stringency of the tool. Small activity events are underestimated under high SNR conditions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g006" xlink:type="simple"/>
</fig>
<p>Next, we asked whether the tool computes too much noise. We imaged a homogenous light source, a fluorescent paper, with identical camera settings (<xref ref-type="fig" rid="pcbi.1006054.g006">Fig 6b</xref>) and computed the noise signal with different SNR values. The SAT was again set at 2, meaning close to the black level, while the mean intensity value in the image field was 13. All activity events were counted (MAC of 1). Representative signal traces are shown in <xref ref-type="fig" rid="pcbi.1006054.g006">Fig 6d</xref>. With a SNR of 1.5, 5524 events were computed in the noise video, while 11145 events were found in with neurons (<xref ref-type="fig" rid="pcbi.1006054.g006">Fig 6f</xref>). However, with an SNR of 2.5, the noise signals (53) were in a good balance compared to the signals found in neurons (4092). One has to consider that the program was computing 1452 grid windows of 1030 images. For this specific setting and imaging situation, this indicates that about 1.3% of the computed neuronal activity events reflected camera noise. Furthermore, this indicates that even with an SNR of 1.5, more than 5500 activity events in the whole x,y-t imaging raw data might be regarded as neural activity. The camera noise alone cannot be responsible for the high number of signal-close-to-noise activity events detected by the algorithm.</p>
<p>However, this experiment does not prove whether very small signals identified by the algorithm reflect a biological phenomenon or not. To target this question, we performed the following experiments. First, we imaged hippocampal neurons in presence of specific inhibitors of neuronal activity (<xref ref-type="fig" rid="pcbi.1006054.g007">Fig 7</xref>). Furthermore, we investigated activity events and signal fluctuations of homeostatic calcium fluxes during acute withdrawal and re-addition of extracellular calcium under activity blockade [<xref ref-type="bibr" rid="pcbi.1006054.ref030">30</xref>].</p>
<fig id="pcbi.1006054.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Activity profile of hippocampal neurons after calcium spike blockade.</title>
<p><bold>a</bold>, Average intensity: Hippocampal neurons loaded with a fluorescent calcium indicator. Pseudocolor images: neurons before a spike, during a calcium spike (seen in the lower left cell), and after spike blockade. 3000 images, acquired at 20Hz are analyzed (WS8, SAT7, SNR 3). <bold>b</bold>, Under control conditions, one neuron (the lower, left) shows a high spiking activity, as indicated by the activity pattern (red circles in the grid windows). After acute treatment with an inhibitor cocktail (TTX, CNQX, APV), spiking behavior is blocked (yellow squares; traces in c), non-spike-like activity events become visible on the soma and in the periphery. Shape and number of residual activity signals are quite diverse (bright blue squares; traces in c). <bold>c</bold>; Grid window-specific signal traces with the corresponding activity marks (red) as indicated in b. <bold>d</bold>, Activity hotspot in the periphery, in a varicosity-like structure. The activity hotspot is indicated by a contrast-enhanced average intensity projection. Image 496 shows the low activity state, while image 2124 indicates the high activity state. The corresponding grid window is indicated in (b).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec010">
<title>Computing of activity events under calcium spike-block conditions</title>
<p>To prove whether the activity detector marks too many false-positive events, we tested the tool on imaging data of spontaneously firing neurons, and blocked activity and excitatory neurotransmission with TTX, a powerful inhibitor of action potential firing, CNQX, and APV (D-2-amino-5-phosphonovalerate), to inhibit ionotropic glutamate receptors. Before activity blockade, the activity detection tool could well monitor the calcium-spike activity of a neuron (<xref ref-type="fig" rid="pcbi.1006054.g007">Fig 7</xref>), but also found many small and non-spike like activity events (<xref ref-type="fig" rid="pcbi.1006054.g007">Fig 7c</xref>, grid 28/9). Here, for simplicity, we use the term calcium spike to describe the typical waveform of AP-induced calcium spikes, with a fast onset and a slower decay of the signal. Acute perfusion with the activity inhibitor cocktail stopped the appearance of the classical calcium spike (<xref ref-type="fig" rid="pcbi.1006054.g007">Fig 7c</xref>), hence, less activity events were computed. However, many small activity signals were found in the neuronal periphery. This non-spiking activity was typically local, meaning not a global calcium signal, or signal component of the complete neuron. Many of these signals were not shaped like typical calcium spikes with a fast onset and a slow decay, and were not uniformly shaped (<xref ref-type="fig" rid="pcbi.1006054.g007">Fig 7d</xref>, purple rectangle to indicate a local activity hot spot).</p>
</sec>
<sec id="sec011">
<title>Detection of neuronal activity events close to the measurement noise</title>
<p>Next, we asked whether activity events close to the baseline are random fluctuations in the signal, or whether these small activity events reflect calcium fluxes or activity close to the baseline. Theoretically, when a neuron shows fluctuations in the calcium signal and many small calcium transients, but no typical calcium spikes, then the variance of the signal should be bigger than under conditions when activity is blocked. We again imaged hippocampal neurons (DIV10; 10.000 images, 20Hz), and compared neuronal activity under control conditions and after acute activity blockade with TTX and CNQX (<xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8</xref>). Typical calcium spikes were detected (<xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8a and 8b</xref>; left trace) and the pharmacological treatment was sufficient to block the typical calcium spikes with a fast onset followed by a decaying transient (<xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8b</xref>, right trace). Then we calculated the variability of each signal using a sliding window of 30 frames and determined the variance and the mean of the signal (computed with the tool: WS8, SAT7, SNR 3; Include variance: 30). Finally, we determined the area of the variance around the mean in the signal trace (yellow band in <xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8c–8e</xref>) and determined the number of activity events in the same traces with the activity detection tool. We call this value VA<sub>30</sub>, for variance area in a sliding window of 30 frames (<xref ref-type="supplementary-material" rid="pcbi.1006054.s007">S7 Fig</xref>, shortened example, 12 of 289 pages). In grid windows with a low number of activity events (none to two), the variance area value VA<sub>30</sub> was almost identical between control conditions (<xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8c</xref>, left trace, VA<sub>30</sub> = 294, 2 events) and after TTX/CNQX block of neuronal activity (<xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8c</xref>, right trace; VA<sub>30</sub> = 297, 1 event). However, in another grid window (<xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8d</xref>), the variance area shifted during activity blockade from VA<sub>30</sub> = 532 to VA<sub>30</sub> = 370, and activity events were reduced from 11 to 1, showing that many of the small activity events in the control condition (left trace) are sensitive against inhibitors of neural activity, and might be real calcium signal events. In <xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8e</xref>, a high variance area value (VA<sub>30</sub> = 1208) correlated with a high number of activity events (20 activity events). Activity blockade with TTX and CNQX reduced the variance area to VA<sub>30</sub> = 559, indicating reduced calcium fluxes after activity blockade. However, despite the strong reduction in signal fluctuation, the activity detector identified a local (not global) TTX/CNQX-independent, long-lasting transient with 9 activity events (<xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8e</xref>, lower trace, frames 1100–1700). This shows that the computational assay is able to describe small loci of activity with two different values, the activity event number and the variance area. We controlled that our protocols, meaning imaging over several minutes and blocking of typical calcium spike behavior is reversible and that calcium spike activity recovers upon wash out of the corresponding inhibitors (exemplarily shown in <xref ref-type="supplementary-material" rid="pcbi.1006054.s008">S8 Fig</xref>).</p>
<fig id="pcbi.1006054.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Parallel computing of activity events and variance area.</title>
<p><bold>a</bold>, Activity map of spontaneous activity of hippocampal neurons (DIV 10) before and after acute activity blockade. <bold>b</bold>, Calcium spike formation (left trace) is blocked by the inhibitor cocktail (right trace). <bold>c—e</bold>, Raw traces representing typical calcium signals in non-spiking areas (black trace). The yellow band indicates the variance area in a sliding window of 30 images. Activity marks are indicated as red dots. The activity state of the grid windows is described with two parameters, the variance area, and the number of activity events. <bold>c</bold>, Signal trace with one or two computed activity events. The variance area is almost identical before and after spike block. <bold>d</bold>, Signal fluctuations, represented by the variance area, become smaller under spike block conditions. Furthermore, the activity inhibitor cocktail reduces the number of activity events. <bold>e</bold>, This grid window over a neuritic element shows high signal fluctuation, which correlates with a higher number of activity events. Spike-blockade reduces the variance area and the number of activity events. However, a local activity event is not blocked by the inhibitor cocktail. Structural elements of local activity on the basis of this analysis are shown in <xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g008" xlink:type="simple"/>
</fig>
<p>Zooming in on corresponding loci (<xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9</xref>) shows that growth cone-like structures (<xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9c</xref>, trace 1–3), neuritic elements (<xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9c</xref>, trace 4), or varicosity-like structures (<xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9c</xref>, trace 5) form these local activity hotspots. Computed local activity events exhibit either a calcium spike-like shape (<xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9c</xref>, trace 1, 2), or reflect a phase of increased fluctuations (e.g. <xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9c</xref>, trace 4: images 1000–2000), or a sudden jump in the activity state (<xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9c</xref>, trace 5: image 2300–3000). The local activity events with the shape of a ‘broad’ or ‘elongated’ calcium spike are reminiscent of typical cell-autonomous local calcium spikes in motoneurons, which are mediated by local activity of voltage-gated calcium channels. In motoneurons, these local calcium events are triggered by local activity of TTX-insensitive voltage-gated sodium channels and are mediated by the local activation of high-voltage activated calcium channels [<xref ref-type="bibr" rid="pcbi.1006054.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref014">14</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref032">32</xref>]. The data confirm that many ‘small’ activity events in an active locus of a neuron are not solely a misinterpretation of the measurement noise. We term these events in calcium imaging data as ‘signals-close-to-noise’ activity.</p>
<fig id="pcbi.1006054.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Structures with high rates of local activity after calcium spike blockade.</title>
<p><bold>a</bold>, Average intensity image of hippocampal neurons loaded with the calcium indicator. Grid windows with high rates of local activity are shown in yellow (see c). <bold>b</bold>, Activity map (see also <xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8</xref>). <bold>c</bold>, Five regions of interest are indicated (trace 1 –trace 5). The upper three represent growth cone-like structures, the lower two traces represent hotspots on neurites. Note the variability and the diverse character of the calcium signal patterns detected by the computational approach.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g009" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>‘Signal-close-to-noise’ activity events are a biological phenomenon</title>
<p>While some activity events under blockade of neuronal activity with TTX, CNQX, and APV can easily be regarded as real activity events (e.g. in <xref ref-type="fig" rid="pcbi.1006054.g008">Fig 8d</xref> or <xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9e</xref>), many computed signals cannot easily been distinguished from noise. We asked whether statistical computing of activity events could be used to describe the biological phenomenon of homeostatic calcium fluxes in resting neurons [<xref ref-type="bibr" rid="pcbi.1006054.ref030">30</xref>]. Under conditions of activity blockade (TTX, CNQX, APV, 50 μM NiCl<sub>2</sub>), resting neurons show pronounced homeostatic calcium fluxes between the endoplasmic reticulum and the extracellular space, as recently shown by direct ER calcium imaging [<xref ref-type="bibr" rid="pcbi.1006054.ref030">30</xref>]. To compensate unavoidable loss of ER calcium over the plasma membrane, resting neurons balance ER calcium levels through a continuous calcium influx mechanism with properties of store-operated calcium entry (SOCE) [<xref ref-type="bibr" rid="pcbi.1006054.ref030">30</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref042">42</xref>–<xref ref-type="bibr" rid="pcbi.1006054.ref044">44</xref>]. To compute this calcium activity, we imaged calcium fluxes in resting hippocampal neurons and acquired 6600 images at a frequency of 10 Hz (<xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10a</xref>). After one minute under steady-state conditions, neuronal activity was blocked with a high amount of TTX (500 nM), CNQX and APV (each 20 μM). Then extracellular calcium was withdrawn for more than three minutes, before extracellular calcium was re-added to stimulate neuronal SOCE. Computational analysis was then performed under medial stringency conditions (SAT 2, SNR 2.5, MAC2). As shown in the signal traces in <xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10b and 10c</xref>, removal of extracellular calcium led to a brief decline in the cytosolic calcium signal (from bit value 7 to bit value 3), which was accompanied by a decline in computed activity events (<xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10d and 10e</xref>). This was observed for individual grid windows (for instance <xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10b</xref>, yellow ROI in a), or the whole image plane (<xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10c</xref>, magenta ROI). Re-addition of extracellular calcium also restored the intensity of cytosolic calcium signals and more activity events were computed (<xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10f</xref>).</p>
<fig id="pcbi.1006054.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006054.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Computing of signals close to the noise level.</title>
<p><bold>a</bold>, Typical hippocampal neuron, loaded with calcium indicator. Two ROIs are indicated. <bold>b,c</bold>, Calcium traces representing the yellow and magenta ROI in a. Removal of extracellular calcium causes a decline in the calcium indicator signal. This correlates with a reduced number of computed activity events (red dots). <bold>d-e</bold>, Number of computed activity events are shown on the x,y-grid. Under calcium-free conditions (cyan), a low number of activity events was found in the signal trace. In the presence of extracellular calcium, more activity events are computed by the algorithm. Regions of activity are found in the soma, but also on distal neurites. <bold>g,h</bold>, Summary graphs for computed activity events and variance area. The virtual activity value has a strong discriminative power to describe the experimental situation (calcium-free versus calcium present). n = 164 ROIs, mean ± SEM; one way ANOVA (Kruskal-Wallis) followed by Dunn’s multiple comparison test; p-values: ** &lt; 0.001; **** &lt; 0.0001. <bold>i</bold>, Representative signal analysis (yellow ROI in a) with deconvolution (blue dots), template-matching (green dots), and our CWT-approach. Phases of homeostatic activity in presence of extracellular calcium are best described with help of template-matching and CWT-computation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.g010" xlink:type="simple"/>
</fig>
<p>We asked then whether the number of activity events or the change in the variance area is best suited to describe the changes in signal-close-to noise activity. We summed up the activity events (<xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10g</xref>) and the computed VA<sub>30</sub> area (<xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10h</xref>) of all computed grid windows. The computed activity event value was well suited to distinguish signal-close-to-noise activity in the presence or absence of extracellular calcium. The tool identifies the calcium activity when the power of the signal is high enough in comparison to the intensity values in the neighborhood. Signal traces showing a decrease in cytosolic calcium concentration, as it happens to neurons under low calcium conditions (see <xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10b</xref>, frames 2000–4000), will affect the CWT computation of the trace. Nevertheless, this has a minor influence in the activity event detection, because the algorithm constructs the ridges according to local maxima and estimates the power of an activity peak according to its close vicinity. The variance area value could also statistically distinguish between the two activity states, albeit with much less discriminatory power. The example shown here is representative of 15 imaging series performed with five independent neuron preparations. These results suggest that signal-close-to-noise activity can be regarded as a biological phenomenon, here triggered by homeostatic calcium fluxes [<xref ref-type="bibr" rid="pcbi.1006054.ref030">30</xref>], and can be visualized in an unbiased way with the bioinformatics tool described here and both computed values, the total activity value and the variance area.</p>
<p>Our tool identified a region of high activity in the neurites of the neuron. We used this ROI information (yellow ROI in <xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10a</xref>) to show how other calcium event identification strategies analyze the signal (<xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10i</xref>). A deconvolution strategy offered many events under calcium withdrawal conditions, suggesting that these signals may be false positive. Notably, template-matching [<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>] (green labels in <xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10i</xref>) and our CWT/pruning strategy found signal events before calcium withdrawal and after re-addition of calcium, indicating that both computational approaches can be used to define phases of homeostatic calcium activity in neurites. Signal extraction with the help of the ‘Romano toolbox’ [<xref ref-type="bibr" rid="pcbi.1006054.ref027">27</xref>] failed to extract and define a significant signal above a computed background noise signal in phases of higher homeostatic activity in the presence of calcium and is therefore not marked in <xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10i</xref>. Finally, we analyzed this calcium movie with a tool for component segmentation and signal extraction [<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>]. This tool extracted five signal components from the movie (<xref ref-type="supplementary-material" rid="pcbi.1006054.s009">S9 Fig</xref>). The typical signal pattern of calcium withdrawal and calcium re-addition was mirrored in four of five components. Notably, the computation indicates that the phase of calcium withdrawal is a phase of low activity (indicated by a straight line in the signal components 1, 3, 4; <xref ref-type="supplementary-material" rid="pcbi.1006054.s009">S9 Fig</xref>). This suggests that the computation underlying this signal demixing strategy is useful to extract and interpret homeostatic activity from neurites. However, tens of loci of local homeostatic calcium activity were overseen and not identified as a signal component (compare <xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10d–10f</xref> with <xref ref-type="supplementary-material" rid="pcbi.1006054.s009">S9 Fig</xref>). Furthermore, the calcium withdrawal effect appears in the background signal and is erroneously considered to be a noise signal (<xref ref-type="supplementary-material" rid="pcbi.1006054.s009">S9 Fig</xref>). Here, we assume that an unbiased grid strategy might help to offer an initial segmentation of the image data, before signals are extracted and demixed from the corresponding structures in the grid.</p>
<p>In summary, CWT-based computation and signal pruning is suited to identify calcium activity components in loci of homeostatic calcium activity and the data can be used to count activity events for comparison of activity states. After minimal parameter tuning, two other strategies, template matching according to Patel et al. [<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>] and signal component analysis according to Pnevmatikakis et al. [<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>] would also be suited to compute signal-close-to-noise calcium signals. Here, some computational adaptations and tuning parameters might be computed and tested in the future. We found that counting of activity events in grid windows is useful to describe, in consideration of the pros and cons, local homeostatic calcium activity.</p>
</sec>
</sec>
<sec id="sec013" sec-type="conclusions">
<title>Discussion</title>
<p>We developed and tested an open source bioinformatics tool to identify local calcium transients and ‘signal-close-to-noise’ activity from x,y-t imaging raw data. The tool is designed for an unbiased comparison of activity states of neurons to identify loci of activity in the whole x,y-t image material. Its good performance for this research question was meticulously tested (Figs <xref ref-type="fig" rid="pcbi.1006054.g006">6</xref>–<xref ref-type="fig" rid="pcbi.1006054.g010">10</xref>), yielding unique features (<xref ref-type="table" rid="pcbi.1006054.t001">Table 1</xref>) fruitful for high and low activity detection in motoneurons, activity state assessment in neurites of hippocampal neurons and monitoring local neuronal activity events close to the measurement noise.</p>
<p>After discussing performance and optimal parameter tuning, we explain choosing regions of interests and practical considerations. We believe that our tool is quite powerful and will even allow shifting the focus of neuronal activity detection to new biological questions, such as the contribution of subthreshold active ion channels in local neuronal excitation, or the contribution of local store-operated calcium homeostasis in neuronal excitability.</p>
<p>The tool can be used as a calcium spike detector, but is, in our opinion, more powerful in evaluating and computing calcium signaling events which are small, irregularly shaped, close to the measurement noise, and in the periphery of the neuron. Different strategies are already used to describe calcium activity automatically and each of the methods has specific advantages [<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref025">25</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref045">45</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref046">46</xref>]. However, the individual essential requirements on an automated calcium signal detector are quite different, and therefore an all-purpose tool does not exist. We searched for a strategy powerful enough to create an overall census of calcium activity in a wider x,y-field. The tool described here looks highly sensitive for local, specific activity and rejects in each peak given the null hypothesis “all is just noise” after automatic testing. Our tool accepts that a signal trace is never smooth. Pre-processing of raw data is not needed and all information from a grid window is included. If there are ‘inactive’ pixels in a grid, then they do not significantly contribute to the signal. It is a strong feature of our strategy that it works close to the signal noise level and therefore sees signals even if there is an inactive pixel close to an active pixel. On the one hand our strategy sounds risky, as it is prone to overestimate activity events close to the measurement noise [<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref025">25</xref>] under small SNR values. On the other hand, it does not ignore local activity close to the measurement noise. The tool is not based on simple peak candidate filtering above an arbitrary noise threshold. It is based on continuous wavelet transform-based guided peak detection with a second derivative Gaussian as mother wavelet. This mother wavelet is appropriate for peak detection, as it enhances the peak and diminishes the neighboring signal values. For this reason, our tool is able to identify signal-close-to-noise calcium activity.</p>
<sec id="sec014">
<title>Tuning parameters to change the stringency of activity detection</title>
<p>Specific parameter settings were important to achieve optimal performance; examples are given in the results (Figs <xref ref-type="fig" rid="pcbi.1006054.g001">1</xref>, <xref ref-type="fig" rid="pcbi.1006054.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1006054.g005">5</xref>). Here we discuss this more in general. To find a balance between two extremes, namely overestimation of activity through the computation of signals within noise, and disregarding of real activity close to the noise, we included simple tuning parameters. These tuning parameters, the signal-average threshold, the signal-to-noise ratio, the minimal activity count number, and the window size to define an x,y-grid of ROIs, enable robust, transparent, and quantitative results on individual, comparative data sets. The most important tuning parameter is the signal-to-noise-ratio (SNR). The SNR defines the stringency of the detection tool. Analysis of our imaging data on cultured neurons with synthetic fluorescent calcium indicators (OGB1) shows that an SNR of 1.5 to 2.5 is useful in finding activity events close to the noise level. SNR values of 3 to 4 focus on calcium transients with higher amplitude, and tend to discard ‘smaller’ transient-like signals. The quite short computing time in combination with the flexibility of the tool makes it easy to adapt the parameters for personal use.</p>
</sec>
<sec id="sec015">
<title>Signal fluctuations and activity detection</title>
<p>When we analyzed calcium imaging data from neurites of hippocampal neurons, it was obvious that some traces exhibited more and higher signal variations than other neuronal loci. For simplicity, we term this common phenomenon as signal fluctuation. To describe signal fluctuations, we calculated the variance in a sliding window of 30 frames, and found that fluctuations in the calcium signal became smaller when we blocked calcium spikes. The tool can be tuned to use longer or shorter sliding windows. In loci with intensive signal fluctuations, the wavelet analysis found a certain number of activity events. We therefore suggest using two signal trace features to compare neuronal activity mediated by signals close to the noise level: (1.) the number of total activity events in a grid window, and (2.) the variance area in a sliding window of a calcium trace. As shown in <xref ref-type="fig" rid="pcbi.1006054.g010">Fig 10</xref>, even activity caused by homeostatic calcium fluxes can be described by the computed activity number and variance area in a signal trace. Both values are ideally taken from a dataset before and after pharmacological treatment, or from a wildtype neuron in comparison to genetically modified neurons, or can be determined in comparison to a control region in the same image series.</p>
</sec>
<sec id="sec016">
<title>ROI definition versus a grid of ROIs</title>
<p>Powerful strategies to extract cellular calcium signals are based on multiplication of two matrices to encode the spatial and temporal signal information [<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref047">47</xref>]. A critical problem with this is to identify the spatial footprint of activity loci, meaning how to select the region of interest (ROI) or image segment for the subsequent calcium signal analysis. Independent component analysis (ICA) for matrix factorization [<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>], non-negative matrix factorization (NMF) [<xref ref-type="bibr" rid="pcbi.1006054.ref047">47</xref>], and constrained non-negative matrix factorization (CNMF) are powerful methods for extracting cells’ location and automated signal extraction. To target the problem of overlapping loci of activity, CNMF was shown to be eminently powerful [<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>]. While these strategies are all excellent in defining somatic calcium events and global activity of neurons, the tools may disregard small and local calcium events, which happen outside of the computed image component or ROI or have different time signatures. Furthermore, to better define calcium spikes, the true calcium signal traces are commonly ‘smoothed’ and therefore activity events close to the measurement noise may be ignored, or defined as noise [<xref ref-type="bibr" rid="pcbi.1006054.ref018">18</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>]. We found that CNMF can be powerful to extract homeostatic signals from neuronal segments (<xref ref-type="supplementary-material" rid="pcbi.1006054.s009">S9 Fig</xref>). However, new tuning criteria may be needed for improved separation of local activity from background signals. Maybe a grid strategy would be useful to support this analysis, thus simply separating a neuron in unbiased subcompartments. Furthermore, an event definition and a counter would be helpful to offer a natural number representing calcium activity.</p>
<p>In our approach here, we intended to go one step back and to pattern the x,y-field with a pixel-wise grid, to avoid trace smoothing, and to paint an activity pattern over the x,y-grid field, thus making the activity detection independent of a user- or computation-based ROI definition. The user gets an idea of how activity is distributed over the image field and gets new information about local calcium activity events. Theoretically, it is a disadvantage that the locus of analysis is not drawn by the underlying neuronal morphology and therefore only partially fits the underlying structure. It is also a fact that the SNR of the extracted signal in the grid is not ideal, since the temporal traces are extracted not only from pixels belonging to one compartment, but also from pixels from another structure in the same grid window. The grid idea also causes that the same activity event, e.g. a spike, is counted in many grid windows if the activity spreads over a region bigger than the grid size. However, for this tool and our research question it is a powerful and robust strategy to identify activity loci and to count a computed activity event. This is because spontaneous activity is astonishingly diverse, occurs at very small loci, and shows signals which do not appear in the close neighborhood. These events reflect microdomain activity. The grid concept is a simple way to compute total activity patterns of all loci. The output image creates an activity image, which rebuilds the gross structure of the underlying activity centers (e.g. Figs <xref ref-type="fig" rid="pcbi.1006054.g003">3</xref>, <xref ref-type="fig" rid="pcbi.1006054.g004">4</xref> and <xref ref-type="fig" rid="pcbi.1006054.g009">9</xref>). The implemented ROI tool and the window size parameters allow pixel-wise re-analysis of image segments. The simplistic concept makes the tool user-friendly and robust.</p>
<p>Calcium transient identification can be computed with different algorithms and wavelet-based detection methods are useful for peak detection, even though variants of the algorithm produce a high false positive rate and introduce small phase-shifts [<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>], while other algorithms are well suited to reduce the false-positive rate [<xref ref-type="bibr" rid="pcbi.1006054.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref048">48</xref>]. We show by analyzing real data that the computing is quite precise when the tool is well tuned. Knowledge-based activity event detection (template-matching) uses a database of calcium signal waveforms or synthetic datasets and proves whether there is a similarity between a waveform and the more noisy true calcium signal trace [<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref025">25</xref>]. We avoided knowledge-based strategies on the basis of pre-defined calcium signal waveforms, as we cannot easily create knowledge-based masks for the non-spiking activity observed in calcium imaging data of spontaneously active neurons or in the homeostatic situation. At the same time our data suggest that template-matching [<xref ref-type="bibr" rid="pcbi.1006054.ref021">21</xref>] is suited to detect signal-close-to-noise activity by homeostatic calcium fluxes. Future tools might include both strategies and the CWT computing might support the creation of templates for template-matching.</p>
<p>One cannot easily decide whether computed calcium signals close to the noise are ‘real’ signals, or wrongly identified signals. Our tool accepts this problem and decides that it is better to label event candidates, than to ignore them. As already mentioned above, the tool tries to find calcium activity events. It is important to notice that the wavelet transform provides a set of point candidates that could be possibly labeled as activity peaks. However, this labeling depends on the pruning done to the tree formed with the set of candidates. This pruning process is done following the branches on the activity tree and such branches are formed according to the ridges of the wavelet transform. The pruning consists in discarding such points which are not present in more than one scale (meaning that they are just local maxima) and those points that do not have the minimally required SNR level. At the end of the pruning, all the remaining points are tagged as activity peaks.</p>
<p>For the CWT computation, we used a symmetric kernel. For this reason, the asymmetry of spike-induced calcium transients is a disadvantageous condition for our algorithm, not because of the wavelet transform algorithm itself, but because of the selection of the symmetric second derivative Gaussian as the mother wavelet. However, the second derivative Gaussian has the important property that it has an almost zero phase shift. This allows us to mark the point in time of the detected peak. Our results in Figs <xref ref-type="fig" rid="pcbi.1006054.g003">3</xref>–<xref ref-type="fig" rid="pcbi.1006054.g005">5</xref> confirm that the symmetric mother wavelet is suited to compute spike-induced calcium signals with high precision.</p>
</sec>
<sec id="sec017">
<title>Practical considerations</title>
<p>The tool is an open source tool, based on ImageJ and ‘R’, and does not need any commercial, license-protected computing environment. The tool is easily operated. A user manual is available (<xref ref-type="supplementary-material" rid="pcbi.1006054.s010">S1 Manual</xref>).</p>
<p>Based on our imaging data, we defined a minimum distance between peaks, which is a distance of five data points. When neurons show high activity rates, one can either increase the speed of image acquisition, or one can test beneficial properties of a specific calcium indicator to improve the temporal resolution or the signal-to-noise ratio [<xref ref-type="bibr" rid="pcbi.1006054.ref006">6</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref049">49</xref>]. In the manual we show how the tool can be tuned to better label higher event frequencies (<xref ref-type="supplementary-material" rid="pcbi.1006054.s010">S1 Manual</xref>, Chapter VIII). To compare different experimental conditions, we recommend starting with a bigger grid window, the SAT according to the provided thresholding rule, or close to the black level (see above) and an SNR of 2.5 as the default setting. The grid window and the SNR affect the computing time and for a first assessment of raw data these default settings worked very well in our hands with synthetic high affinity calcium indicators. For instance, using a standard desktop computer, 3,000 images (348 x 260 pixel) are computed for one minute to process the image stack, and for another three minutes to complete the wavelet transform and the generation of the documentation pdf. One thousand images are computed in less than two minutes.</p>
<p>Initially, we normally check the data with an SNR of 2, 2.5, and 3, and a grid window size that is small enough to cover the neurites. A second computation with another SNR value, e.g. to separate high SNR signals and low SNR signals, needs just the resetting of the computed values, the change in the SNR value and the restart of the “<bold><italic>Detect activity</italic></bold>” computing, to get the next signal documentation. This needs some seconds. After a first assessment, it is easy to tune the parameters for the final analysis or a specific image acquisition setup. Small grid windows will offer an intuitive image of the neuronal loci where activity events took place, but at the cost of a longer computing time.</p>
</sec>
<sec id="sec018">
<title>Typical biological questions for use of the activity detector NA<sup>3</sup></title>
<p>This tool shifts the focus from spike analysis of cell bodies to local signal-close-to-noise analysis in any area of a neuron. Small and local calcium signals mediate important biological functions [<xref ref-type="bibr" rid="pcbi.1006054.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref012">12</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref032">32</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref050">50</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref051">51</xref>] and may be caused by a multiplicity of signaling mechanisms [<xref ref-type="bibr" rid="pcbi.1006054.ref001">1</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref002">2</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref004">4</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref052">52</xref>]. The molecules underlying local calcium signals are not well described, but are relevant target factors for potential protective and functionally restorative treatments in psychiatric and neurological disorders. One example is the identification of target factors to treat motoneuron diseases [<xref ref-type="bibr" rid="pcbi.1006054.ref053">53</xref>–<xref ref-type="bibr" rid="pcbi.1006054.ref055">55</xref>]. Motoneurons show cell-autonomous spontaneous calcium transients, which appear in an unpredictable spatiotemporal on-off, and high versus low frequency pattern [<xref ref-type="bibr" rid="pcbi.1006054.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref014">14</xref>]. By using calcium imaging and subsequent assessment of spontaneous calcium events, disease-relevant molecular factors have been identified. For instance, the local excitability pattern of motoneurons is triggered by a subthreshold active ion channel, the sodium channel Na<sub>V</sub>1.9 [<xref ref-type="bibr" rid="pcbi.1006054.ref032">32</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref056">56</xref>], and mediated by the N-type calcium channel Ca<sub>V</sub>2.2 [<xref ref-type="bibr" rid="pcbi.1006054.ref014">14</xref>]. This excitability signal cascade is disturbed in motoneurons from mouse models for spinal muscular atrophy [<xref ref-type="bibr" rid="pcbi.1006054.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref014">14</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref032">32</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref054">54</xref>], the most common genetic cause for infant mortality [<xref ref-type="bibr" rid="pcbi.1006054.ref057">57</xref>]. Screening-like approaches based on calcium imaging and automated excitability analysis with bioinformatics may offer new information on the role of these genetic factors in motoneurons and patient-derived induced neurons.</p>
<p>Furthermore, not much is known about the role of the excitability factors in neurons of the brain or within neural networks, which are triggering neural network oscillations [<xref ref-type="bibr" rid="pcbi.1006054.ref058">58</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref059">59</xref>]. Locally acting signaling factors such as neuropeptides, neurotrophins, or the contribution of subthreshold voltage changes on excitability are not well integrated in a functional concept of synaptic communication [<xref ref-type="bibr" rid="pcbi.1006054.ref060">60</xref>]. Furthermore, local tuning and scaling of excitability by calcium-dependent pathways plays an important role in synaptic development [<xref ref-type="bibr" rid="pcbi.1006054.ref009">9</xref>], and one has to consider that the neuronal excitability is also affected by homeostatic calcium fluxes at rest, which are maintained by a store-operated calcium entry mechanism [<xref ref-type="bibr" rid="pcbi.1006054.ref030">30</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref043">43</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref044">44</xref>].</p>
</sec>
<sec id="sec019">
<title>Conclusion</title>
<p>The software tool presented here operates on a wide range of neuronal activity detection tasks including very different signal intensities and assesses a broad visual field. It is able to offer an unbiased analysis of spontaneous and local neuronal activity. As it is not focused on calcium spikes or a computed ROI, it is able to offer initial insights into the total calcium activity pattern under different experimental conditions. The idea is to use an unbiased x,y-grid, to include all pixels in a imaging video and to offer an activity map. The tool avoids a preferential look at one activity mode of a neuron, e.g. the spiking behavior of neuronal somata, but instead tries to find any activity by detecting signals-close-to-noise.</p>
</sec>
</sec>
<sec id="sec020" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec021">
<title>Primary hippocampal neurons</title>
<p>The animal welfare committee of the University of Würzburg, in accordance with European Union guidelines, approved all experimental procedures. Hippocampal neurons were prepared from CD1 mice of either sex, as described earlier [<xref ref-type="bibr" rid="pcbi.1006054.ref039">39</xref>]. Hippocampi of newborn mice were collected in Hank’s buffered saline solution (HBSS). Trypsin (Worthington) was added to a final concentration of 0.1% and the tissue incubated for 15 min at 37°C. The protease digestion was stopped with 0.1% Trypsin inhibitor (Sigma). After four steps of trituration in Neurobasal/B27 medium (Life Technologies), cells were plated on poly-L-lysine-coated glass coverslips in Neurobasal, 1× B27, 0.5% penicillin/streptomycin, 1% Glutamax, and 1× N2 supplement (all Life Technologies) and cultured at 37°C under an atmosphere of 5% CO<sub>2</sub>. Calcium imaging experiments were performed after indicated days in vitro (DIV).</p>
</sec>
<sec id="sec022">
<title>Primary motoneurons</title>
<p>Primary motoneurons were prepared from spinal cord [<xref ref-type="bibr" rid="pcbi.1006054.ref061">61</xref>]. The lumbar spinal cord of mouse embryos was dissected at embryonic day 13 or 14. Motoneurons were enriched by affinity-panning with antibodies against the p75<sup>NTR</sup> receptor, and plated at a density of 1,000–2,000 cells on 10mm glass coverslips coated with polyornithine and laminin-1. Motoneurons were grown in Neurobasal/B27 medium (Life Technologies), 2% horse serum, 10 nM β-mercaptoethanol, and 1x GlutaMax. The neurotrophic factors BDNF and CNTF were added at a concentration of 5ng/ml. One day after motoneuron isolation, 40% of the medium was replaced. Calcium imaging was performed at DIV 3.</p>
</sec>
<sec id="sec023">
<title>Calcium imaging</title>
<p>Calcium indicator dye loading and Ca<sup>2+</sup> imaging was performed in artificial cerebral spinal fluid (ACSF). For motoneuron imaging ACSF contained (in mM): 127 NaCl, 3 KCl, 2.5 NaH<sub>2</sub>PO<sub>4</sub>, 2 CaCl<sub>2</sub>, 1 MgCl<sub>2</sub>, 23 NaHCO<sub>3</sub> and 25 D-glucose, bubbled with 95% O<sub>2</sub>/5% CO<sub>2</sub>. Hippocampal neurons were imaged under continuous perfusion with (in mM): 135 NaCl, 6 KCl, 1 MgCl<sub>2</sub>, 2 CaCl<sub>2</sub>, 5.5 D-glucose, 10 HEPES). For chemical LTP stimulation the following buffer composition was used: 128 NaCl, 13 KCl, 3 CaCl2, 5.5 D-glucose, 10 HEPES, 0.1 glycine (in mM). Calcium-free ACSF contained 0.1 mM EGTA. The calcium indicator Oregon Green 488 BAPTA-1, AM (OGB; Invitrogen) was prepared as 5mM stock solution in 20% Pluronic F-127 / DMSO (Invitrogen). For dye loading, 0.5μl of the OGB/Pluronic mixture was mixed in 500μl of ACSF and neurons were labeled for 15 minutes at 37°C and 5% CO<sub>2</sub>. Changes in OGB/calcium-fluorescence were monitored with the help of an upright microscope (BXWI, Olympus, objective: Olympus 40x LUMPlanFI/IR, 0.8 W), in a heated imaging chamber (Luigs &amp; Neumann). Imaging was performed under continuous perfusion with ACSF. Images (8-bit) were captured at the indicated speed in a streaming approach, with a Rolera-XR camera (Qimaging) and StreamPix 4 software (Norpix) under continuous illumination with a 470nm LED light source (Visitron Systems). Fluorescence filters with the following parameters were used: excitation: 482 ± 35 nm; dichroic filter 506nm, emission filter 536 ± 40nm. The health status of the neurons is routinely tested by patch-clamp techniques, control stimuli, and washout controls.</p>
</sec>
<sec id="sec024">
<title>Simultaneous whole-cell patch clamp recordings and calcium imaging</title>
<p>Current clamp recordings were performed in <italic>whole-cell</italic> configuration. Pipettes with 2.5–5 MΩ resistances were pulled from borosilicate glass (GB 150-8P, Science Products) with a P-97 micropipette puller (Sutter Instruments). Data were acquired using a HEKA EPC-10 USB patch-clamp amplifier controlled by the PatchMaster software (HEKA Electronic) at 25°C. Raw data were continuously sampled at a frequency of 5 kHz and filtered at 2.9 kHz. Electrophysiological experiments with hippocampal neurons were performed with calcium imaging buffer as an external solution. For a steady flow of the external solution, a Minipuls 3 Peristaltic Pump (Gilson) was used. The internal solution contained 148 mM potassium gluconate, 10 mM HEPES, 10 mM NaCl, 0.5 mM MgCl<sub>2</sub>, 4 mM Mg-ATP, 0.4 mM Na<sub>3</sub>-GTP (pH 7.3 with KOH) and Oregon Green<sup>™</sup> 488 BAPTA-1 hexa potassium salt (2 μM). In <italic>whole-cell</italic> configuration, 200 pA current injections were given for either 500 ms, 200 ms, 100 ms or 10 ms for 12 times at intervals of 10 s. Calcium imaging and patch clamp recording was synchronized via TTL (transistor-transistor-logic) signals and controlled with the help of a TTL-induced 10 ms light pulse (Thorlabs, T-cube LED driver LEDD1B). The light signal became visible in a single frame of the image series. Spontaneous activity was measured in the whole-cell current clamp configuration. Parallel calcium imaging was performed with a sample rate of 10 Hz. In some experiments, the calcium indicator loading was done with estered OGB, as described above.</p>
</sec>
<sec id="sec025">
<title>Neuronal activity detection tool</title>
<p>To compute calcium transients from raw image material the method was split into two stages. Signal extraction was computed on ImageJ [<xref ref-type="bibr" rid="pcbi.1006054.ref038">38</xref>] and activity events were calculated on ‘R’ (<ext-link ext-link-type="uri" xlink:href="https://www.r-project.org" xlink:type="simple">https://www.r-project.org</ext-link>). Both computations were embedded in the Bio7 environment, an open platform (<ext-link ext-link-type="uri" xlink:href="http://bio7.org/" xlink:type="simple">http://bio7.org/</ext-link>). We call the presented application <bold>NA</bold><sup><bold>3</bold></sup> (spoken: NA cubic). It is a powerful software tool, combining different routines and languages for optimal neuronal activity detection. The open source tool consists of around 800 lines of code and the core functionality is about 140 lines long. The application was developed on a Windows X64 Intel core i-7 machine with 16 Gigabyte of RAM memory. For time series analysis, a Windows X64 Intel core i-5 machine with 4 Gigabyte of RAM memory was used. The tool is available on: <ext-link ext-link-type="uri" xlink:href="https://github.com/jpits30/NeuronActivityTool" xlink:type="simple">https://github.com/jpits30/NeuronActivityTool</ext-link>. The tool containing the ROI feature is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/jpits30/NeuronActivityTool_ROI" xlink:type="simple">https://github.com/jpits30/NeuronActivityTool_ROI</ext-link>.</p>
</sec>
<sec id="sec026">
<title>Wavelet transform algorithm</title>
<p>The intensity signals are analyzed in order to detect the peaks that correspond to neuronal activity. The event detection uses a modified wavelet transform algorithm for peak detection [<xref ref-type="bibr" rid="pcbi.1006054.ref020">20</xref>,<xref ref-type="bibr" rid="pcbi.1006054.ref048">48</xref>]. For a more detailed explanation refer to this reference [<xref ref-type="bibr" rid="pcbi.1006054.ref062">62</xref>]. One advantage of the wavelet transform over other spectral analysis techniques, like the Fourier analysis, is its multiscale feature. The mother wavelet is scaled. Therefore, it can fit peaks of different sizes. Our algorithm sums the information obtained from matching the calcium activity peak with several scaled versions of the mother wavelet and decides based on that whether that part of the trace contains a peak of activity or not.</p>
<p>The wavelet transform constructs a signal representation that changes with time and space. In order to construct such representation the signal is convolved with a pattern signal called mother wavelet. The mother wavelet is normalized such that ∥Ψ∥ = 1. Using the mother wavelet Ψ, the wavelet transformation of a one dimensional function <italic>x</italic>(<italic>t</italic>) is defined in the equation (<xref ref-type="disp-formula" rid="pcbi.1006054.e001">Eq 1</xref>).
<disp-formula id="pcbi.1006054.e001">
<alternatives>
<graphic id="pcbi.1006054.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006054.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi>X</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mi>a</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mo>Ψ</mml:mo><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
<italic>a</italic> denotes the scale parameter of the wavelet, <italic>b</italic> is the time shift parameter. The wavelet transformation can be understood as a matching procedure between the original signal and the mother wavelet, so with the objective of peak detection, the mother wavelet must be a signal with a clear peak and approximate symmetry. This computation uses a second derivative Gaussian as mother wavelet. This mother wavelet is appropriate for peak detection, as it enhances the peak and diminishes the neighboring signal values. The wavelet transform was chosen because the shifting and scaling of the basic function results in the time resolution property for peak detection within a noisy intensity signal, being able to recognize not only spiking neurons but also smaller peaks of calcium activity. The wavelet transformation maps the peak search into a search of ridges on the time-scale space, this space is smoother and easier to characterize. The wavelet transformation also enables that removal of the base line is not required because it is done intrinsically.</p>
<p>We suppose, with respect to earlier studies [<xref ref-type="bibr" rid="pcbi.1006054.ref020">20</xref>], that the calcium trace in the vicinity of a peak is composed of three components, the peak (p(t)), the base line (b(t)) and the noise (N) as shown in equation (<xref ref-type="disp-formula" rid="pcbi.1006054.e002">Eq 2</xref>)
<disp-formula id="pcbi.1006054.e002">
<alternatives>
<graphic id="pcbi.1006054.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006054.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:msub><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>+</mml:mo><mml:mi>N</mml:mi>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>Then the wavelet transform of such signals would be (<xref ref-type="disp-formula" rid="pcbi.1006054.e003">Eq 3</xref>)
<disp-formula id="pcbi.1006054.e003">
<alternatives>
<graphic id="pcbi.1006054.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006054.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:mi>X</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msqrt><mml:mi>a</mml:mi></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mo>Ψ</mml:mo><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mo>Ψ</mml:mo><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mo>Ψ</mml:mo><mml:mo>*</mml:mo></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>N</mml:mi><mml:mspace width="4.pt"/><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula></p>
<p>The second and third integrals will be approximately zero because of the symmetry of the mother wavelet and because of the low level of matching between the base line and a mother wavelet such as the second derivative Gaussian. That means that the only term left is the convolution between the peak and the mother wavelet.</p>
</sec>
<sec id="sec027">
<title>Strategy for calcium event (peak) identification</title>
<p>As mentioned before, once the original calcium trace is transformed, the peak search problem turns into a problem of finding the ridges of the wavelet transformation and determining which of those ridges corresponds to peaks of interest for us. A ridge is conform with a subset of local maxima, which are nearby in time and belong to consecutive scales [<xref ref-type="bibr" rid="pcbi.1006054.ref063">63</xref>]. <xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2a</xref> shows how the computation extracts a set of signal peaks to define calcium transient candidates. The wavelet transform has a set of ridges, which are used to construct a tree. Using that tree, the computation detects the peaks in the signal. In the coefficient space of a wavelet transform (<xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2a</xref>), a group of local maxima can be identified. In <xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2a</xref>, the ridges are the brighter yellow areas (almost white in some points) under the blue vertical lines (branches).</p>
<p>The branches of the tree are assembled as follows. Starting at the highest scale (top of <xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2a</xref>), a local maximum within the coefficients is defined. This coefficient is set to be the starting point of a branch of a tree. This branch is elongated by adding it to the rest of the coefficients in the same ridge. This procedure is repeated, starting from the second largest scale and is then repeated until all the local maximum values in the wavelet transform were considered. Some scales need to be evaluated several times, because they contain several local maximum values. This procedure is done by using the <italic>wavCWTTree</italic> function from the <italic>wmtsa</italic> package in R [<xref ref-type="bibr" rid="pcbi.1006054.ref064">64</xref>]. At the end of this procedure, we have a set of branches, which are further pruned according to the length of the branch.</p>
<p>The pruning of the branches is efficient and is performed as follows. Each branch (the blue vertical lines) extends over some scale values and has a particular length. Some of the branches are discarded if they do not meet certain criteria for their length. If a branch extends over less than one octave of the scale range, then it is discarded. The rest of the branches (those long enough) form the tree that we use to search for the peaks. In our experiments, we used one octave as the threshold. In the user manual, Chapter VIII (<xref ref-type="supplementary-material" rid="pcbi.1006054.s010">S1 Manual</xref>), we show how this pruning can be modified by the user.</p>
<p>Next, the tool searches each branch of the tree to find out whether it contains a peak. This search occurs according to two conditions. The first is the signal-to-noise ratio of the peak candidate and the second is whether the peak candidate lies on a scale higher than a certain value. The first condition, the SNR, is the most important and it is used in our algorithm as a tuning parameter. The signal-to-noise ratio is estimated with the help of the coefficients of the wavelet transform. The wavelet coefficients of the lowest scale near the branch are used to estimate the noise power. Similarly, the highest coefficient in the branch represents the power of the peak. Hence, the signal-to-noise ratio of the peak is simply the ratio of the power of the signal to the power of the noise. This signal-to-noise ratio has to be higher than the user-defined SNR; otherwise, the peak is discarded. This can be observed in <xref ref-type="fig" rid="pcbi.1006054.g002">Fig 2a</xref>, where some of the branches end up with an activity event (peak), while other branches are not considered as an activity event. The tool has a border effect of three to five images, where it cannot find activity.</p>
</sec>
<sec id="sec028">
<title>Variance area calculation</title>
<p>To describe signal fluctuations in a signal trace, the mean of the signal with the corresponding variance is calculated in a sliding window. The number of window frames can be selected by the user. The variance window is visualized as a yellow band (<xref ref-type="fig" rid="pcbi.1006054.g007">Fig 7</xref>), whereas the yellow area is the variance area, describing the mean +/- of the variance, centered on the mean. This variance area is a virtual value to describe changes in signal fluctuations. The variance area value is used to compare two experimental conditions, for instance, the variance of the mean of a calcium imaging signal in a grid window before and after pharmacological treatments.</p>
</sec>
<sec id="sec029">
<title>General tendency change estimation</title>
<p>The tool also offers the possibility to estimate a change in the general tendency of the signal. Such estimation is done with the help of the <italic>changepoint</italic> package in R. The estimated point of change in the general tendency is the point that splits the signal in the two parts with the most significant statistical difference in average and variance. It means that the signal before the point and after the point are the two most different parts of the signal which can be found, no other cut on the signal would produce a more different pair of signals. This tendency change estimation proves useful, for example when the researcher wants to see the time of action that an inhibitor needs to affect the behavior of cultures neurons.</p>
</sec>
</sec>
<sec id="sec030">
<title>Availability and future directions</title>
<p>The application <bold>NA</bold><sup><bold>3</bold></sup> (NA cubic) is an open source software tool and is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/jpits30/NeuronActivityTool" xlink:type="simple">https://github.com/jpits30/NeuronActivityTool</ext-link>. The tool containing an additional ROI feature is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/jpits30/NeuronActivityTool_ROI" xlink:type="simple">https://github.com/jpits30/NeuronActivityTool_ROI</ext-link>. Updates and further information will be released at GitHub. Additional information, test data and raw data can be found at: <ext-link ext-link-type="uri" xlink:href="https://www.biozentrum.uni-wuerzburg.de/bioinfo/computing/neuralactivitycubic/" xlink:type="simple">https://www.biozentrum.uni-wuerzburg.de/bioinfo/computing/neuralactivitycubic/</ext-link>. The primary data are useful as standardization data to compute global and local calcium activity, signal-close-to-noise activity, signal components, or can be used to create signal templates for local activity events.</p>
<sec id="sec031">
<title>Outlook and future</title>
<p>We will test the option for automated constrained non-negative matrix factorization (CNMF) to see whether such algorithms will help to better define the signal source. Furthermore, we will test optional asymmetric kernels for CWT computation and, depending on the data, which combination of symmetric and asymmetric kernels is optimal. Numerous other options are available to further develop our tool and new applications will be investigated. Users and developers are invited to develop and test new options for NA<sup>3</sup> and use our test data and code.</p>
</sec>
</sec>
<sec id="sec032">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006054.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Output dataset.</title>
<p>Computation of a spontaneously active motoneuron; trace and activity counts.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006054.s002" mimetype="text/plain" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Output dataset.</title>
<p>Computation of a spontaneously active motoneuron; text-file with the grid-specific activity counts.</p>
<p>(TXT)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006054.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Output dataset.</title>
<p>Computation of a motoneuron in the low activity phase.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006054.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Tool comparison.</title>
<p>Comparison of CWT (our tool, red rhombus), deconvolution (blue dots), template-matching (green dots) and signal significance computation (“Romano toolbox”; magenta line) in a calibration dataset showing simultaneous imaging with loose-seal cell-attached recording in four GCaMP expressing neurons [<xref ref-type="bibr" rid="pcbi.1006054.ref037">37</xref>]. Black line: Calcium signal trace (raw data), blue vertical lines: spike information. The TIFF format image stacks were taken from: <ext-link ext-link-type="uri" xlink:href="https://crcns.org/data-sets/methods/cai-1/about-cai-1" xlink:type="simple">https://crcns.org/data-sets/methods/cai-1/about-cai-1</ext-link> [<xref ref-type="bibr" rid="pcbi.1006054.ref037">37</xref>]. This dataset contains raw data information showing the signal behavior of GCamp5k-expressing neurons. The spike-data were extracted from <ext-link ext-link-type="uri" xlink:href="http://spikefinder.codeneuro.org/" xlink:type="simple">http://spikefinder.codeneuro.org/</ext-link>, dataset 06 [<xref ref-type="bibr" rid="pcbi.1006054.ref028">28</xref>]. We analyzed four videos (called cells 0, 1, 5, and 8 in the spikefinder training data). The names of the underlying image stack raw data are: cell1005, cell2002, cell1002, and cell4003. Please note that the original dataset contains 24.000 images acquired in two color channels (green and red). The calcium signal is only present in the green channel. Therefore every second image was removed for the computation.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006054.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Output dataset.</title>
<p>Computation of spontaneously active hippocampal neurons, traces and activity counts.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006054.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Output dataset.</title>
<p>Computation of hippocampal neurons during stimulation with a solution to induce chemical LTP; traces and activity counts.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006054.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Output dataset.</title>
<p>Computation of spontaneously active hippocampal neurons; traces, activity counts, variance area. Shown are 12 of 289 pages of data summary.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006054.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Washout control.</title>
<p><bold>a</bold>, Hippocampal neurons loaded with OGB1-AM, average intensity projection, brightness and contrast adjusted. <bold>b-d</bold>, Three spontaneous active neurons (ROI 1–3) show typical calcium spike-behavior (fast onset, slower decaying of the signal). The neuronal activity inhibitors for glutamatergic transmission (CNQX, APV) were acutely applied to abruptly inhibit the calcium spiking behavior (upper trace in b–d). Upon washout of the inhibitors, cells recover from activity blockade and show again typical calcium spikes (lower traces in b–d).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006054.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Analysis of homeostatic calcium fluxes.</title>
<p>Here, we show the performance of a tool that decomposes the spatiotemporal activity of a neuron into a spatial component to show the local neural structure and temporal components that model the local calcium dynamics [<xref ref-type="bibr" rid="pcbi.1006054.ref023">23</xref>]. This tool identified ten signal components from the movie (<xref ref-type="fig" rid="pcbi.1006054.g009">Fig 9</xref>) and computed five of these components.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006054.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006054.s010" xlink:type="simple">
<label>S1 Manual</label>
<caption>
<title>Installing instructions and user manual.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Michaela Kessler and Regine Sendtner for excellent technical assistance and Jennifer Heilig for native speaker corrections.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006054.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clapham</surname> <given-names>DE</given-names></name> (<year>2007</year>) <article-title>Calcium signaling</article-title>. <source>Cell</source> <volume>131</volume>: <fpage>1047</fpage>–<lpage>1058</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2007.11.028" xlink:type="simple">10.1016/j.cell.2007.11.028</ext-link></comment> <object-id pub-id-type="pmid">18083096</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Berridge</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Bootman</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Roderick</surname> <given-names>HL</given-names></name> (<year>2003</year>) <article-title>Calcium signalling: dynamics, homeostasis and remodelling</article-title>. <source>Nat Rev Mol Cell Biol</source> <volume>4</volume>: <fpage>517</fpage>–<lpage>529</lpage>. <object-id pub-id-type="pmid">12838335</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neher</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sakaba</surname> <given-names>T</given-names></name> (<year>2008</year>) <article-title>Multiple roles of calcium ions in the regulation of neurotransmitter release</article-title>. <source>Neuron</source> <volume>59</volume>: <fpage>861</fpage>–<lpage>872</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2008.08.019" xlink:type="simple">10.1016/j.neuron.2008.08.019</ext-link></comment> <object-id pub-id-type="pmid">18817727</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Soboloff</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rothberg</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Madesh</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gill</surname> <given-names>DL</given-names></name> (<year>2012</year>) <article-title>STIM proteins: dynamic calcium signal transducers</article-title>. <source>Nat Rev Mol Cell Biol</source> <volume>13</volume>: <fpage>549</fpage>–<lpage>565</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrm3414" xlink:type="simple">10.1038/nrm3414</ext-link></comment> <object-id pub-id-type="pmid">22914293</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>De Stefani</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Rizzuto</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pozzan</surname> <given-names>T</given-names></name> (<year>2016</year>) <article-title>Enjoy the Trip: Calcium in Mitochondria Back and Forth</article-title>. <source>Annu Rev Biochem</source> <volume>85</volume>: <fpage>161</fpage>–<lpage>192</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1146/annurev-biochem-060614-034216" xlink:type="simple">10.1146/annurev-biochem-060614-034216</ext-link></comment> <object-id pub-id-type="pmid">27145841</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Grienberger</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Konnerth</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>Imaging calcium in neurons</article-title>. <source>Neuron</source> <volume>73</volume>: <fpage>862</fpage>–<lpage>885</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2012.02.011" xlink:type="simple">10.1016/j.neuron.2012.02.011</ext-link></comment> <object-id pub-id-type="pmid">22405199</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tsien</surname> <given-names>RY</given-names></name> (<year>1981</year>) <article-title>A non-disruptive technique for loading calcium buffers and indicators into cells</article-title>. <source>Nature</source> <volume>290</volume>: <fpage>527</fpage>–<lpage>528</lpage>. <object-id pub-id-type="pmid">7219539</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brini</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Cali</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ottolini</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Carafoli</surname> <given-names>E</given-names></name> (<year>2014</year>) <article-title>Neuronal calcium signaling: function and dysfunction</article-title>. <source>Cell Mol Life Sci</source> <volume>71</volume>: <fpage>2787</fpage>–<lpage>2814</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00018-013-1550-7" xlink:type="simple">10.1007/s00018-013-1550-7</ext-link></comment> <object-id pub-id-type="pmid">24442513</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turrigiano</surname> <given-names>G</given-names></name> (<year>2012</year>) <article-title>Homeostatic synaptic plasticity: local and global mechanisms for stabilizing neuronal function</article-title>. <source>Cold Spring Harb Perspect Biol</source> <volume>4</volume>: <fpage>a005736</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/cshperspect.a005736" xlink:type="simple">10.1101/cshperspect.a005736</ext-link></comment> <object-id pub-id-type="pmid">22086977</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wetzel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jablonka</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Blum</surname> <given-names>R</given-names></name> (<year>2013</year>) <article-title>Cell-autonomous axon growth of young motoneurons is triggered by a voltage-gated sodium channel</article-title>. <source>Channels (Austin)</source> <volume>7</volume>: <fpage>51</fpage>–<lpage>56</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006054.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gantz</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Bean</surname> <given-names>BP</given-names></name> (<year>2017</year>) <article-title>Cell-Autonomous Excitation of Midbrain Dopamine Neurons by Endocannabinoid-Dependent Lipid Signaling</article-title>. <source>Neuron</source> <volume>93</volume>: <fpage>1375</fpage>–<lpage>1387.e1372</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2017.02.025" xlink:type="simple">10.1016/j.neuron.2017.02.025</ext-link></comment> <object-id pub-id-type="pmid">28262417</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spitzer</surname> <given-names>NC</given-names></name> (<year>2006</year>) <article-title>Electrical activity in early neuronal development</article-title>. <source>Nature</source> <volume>444</volume>: <fpage>707</fpage>–<lpage>712</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature05300" xlink:type="simple">10.1038/nature05300</ext-link></comment> <object-id pub-id-type="pmid">17151658</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Spitzer</surname> <given-names>NC</given-names></name> (<year>1995</year>) <article-title>Distinct aspects of neuronal differentiation encoded by frequency of spontaneous Ca2+ transients</article-title>. <source>Nature</source> <volume>375</volume>: <fpage>784</fpage>–<lpage>787</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/375784a0" xlink:type="simple">10.1038/375784a0</ext-link></comment> <object-id pub-id-type="pmid">7596410</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jablonka</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Beck</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lechner</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Mayer</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sendtner</surname> <given-names>M</given-names></name> (<year>2007</year>) <article-title>Defective Ca<sup>2+</sup> channel clustering in axon terminals disturbs excitability in motoneurons in spinal muscular atrophy</article-title>. <source>J Cell Biol</source> <volume>179</volume>: <fpage>139</fpage>–<lpage>149</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1083/jcb.200703187" xlink:type="simple">10.1083/jcb.200703187</ext-link></comment> <object-id pub-id-type="pmid">17923533</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rodriguez-Prados</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rojo-Ruiz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Aulestia</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Garcia-Sancho</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Alonso</surname> <given-names>MT</given-names></name> (<year>2015</year>) <article-title>A new low-Ca(2+) affinity GAP indicator to monitor high Ca(2+) in organelles by luminescence</article-title>. <source>Cell Calcium</source> <volume>58</volume>: <fpage>558</fpage>–<lpage>564</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ceca.2015.09.002" xlink:type="simple">10.1016/j.ceca.2015.09.002</ext-link></comment> <object-id pub-id-type="pmid">26412347</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hogan</surname> <given-names>PG</given-names></name> (<year>2015</year>) <article-title>The STIM1-ORAI1 microdomain</article-title>. <source>Cell Calcium</source> <volume>58</volume>: <fpage>357</fpage>–<lpage>367</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ceca.2015.07.001" xlink:type="simple">10.1016/j.ceca.2015.07.001</ext-link></comment> <object-id pub-id-type="pmid">26215475</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gobel</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name> (<year>2007</year>) <article-title>In vivo calcium imaging of neural network function</article-title>. <source>Physiology (Bethesda)</source> <volume>22</volume>: <fpage>358</fpage>–<lpage>365</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006054.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bouton</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Todd</surname> <given-names>TP</given-names></name> (<year>2014</year>) <article-title>A fundamental role for context in instrumental learning and extinction</article-title>. <source>Behav Processes</source> <volume>104</volume>: <fpage>13</fpage>–<lpage>19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.beproc.2014.02.012" xlink:type="simple">10.1016/j.beproc.2014.02.012</ext-link></comment> <object-id pub-id-type="pmid">24576702</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hilario</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kalousis</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Pellegrini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Muller</surname> <given-names>M</given-names></name> (<year>2006</year>) <article-title>Processing and classification of protein mass spectra</article-title>. <source>Mass Spectrom Rev</source> <volume>25</volume>: <fpage>409</fpage>–<lpage>449</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/mas.20072" xlink:type="simple">10.1002/mas.20072</ext-link></comment> <object-id pub-id-type="pmid">16463283</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Du</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kibbe</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>SM</given-names></name> (<year>2006</year>) <article-title>Improved peak detection in mass spectrum by incorporating continuous wavelet transform-based pattern matching</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>2059</fpage>–<lpage>2065</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btl355" xlink:type="simple">10.1093/bioinformatics/btl355</ext-link></comment> <object-id pub-id-type="pmid">16820428</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Patel</surname> <given-names>TP</given-names></name>, <name name-style="western"><surname>Man</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Firestein</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Meaney</surname> <given-names>DF</given-names></name> (<year>2015</year>) <article-title>Automated quantification of neuronal networks and single-cell calcium dynamics using calcium imaging</article-title>. <source>J Neurosci Methods</source> <volume>243</volume>: <fpage>26</fpage>–<lpage>38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jneumeth.2015.01.020" xlink:type="simple">10.1016/j.jneumeth.2015.01.020</ext-link></comment> <object-id pub-id-type="pmid">25629800</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pnevmatikakis</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Kelleher</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Saggau</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Josic</surname> <given-names>K</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Fast spatiotemporal smoothing of calcium measurements in dendritic trees</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002569</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002569" xlink:type="simple">10.1371/journal.pcbi.1002569</ext-link></comment> <object-id pub-id-type="pmid">22787437</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pnevmatikakis</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Soudry</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Machado</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Merel</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2016</year>) <article-title>Simultaneous Denoising, Deconvolution, and Demixing of Calcium Imaging Data</article-title>. <source>Neuron</source> <volume>89</volume>: <fpage>285</fpage>–<lpage>299</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2015.11.037" xlink:type="simple">10.1016/j.neuron.2015.11.037</ext-link></comment> <object-id pub-id-type="pmid">26774160</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sasaki</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Matsuki</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ikegaya</surname> <given-names>Y</given-names></name> (<year>2008</year>) <article-title>Fast and accurate detection of action potentials from somatic calcium fluctuations</article-title>. <source>J Neurophysiol</source> <volume>100</volume>: <fpage>1668</fpage>–<lpage>1676</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1152/jn.00084.2008" xlink:type="simple">10.1152/jn.00084.2008</ext-link></comment> <object-id pub-id-type="pmid">18596182</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Janicek</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hotka</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zahradnikova</surname> <given-names>A</given-names> <suffix>Jr.</suffix></name>, <name name-style="western"><surname>Zahradnikova</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zahradnik</surname> <given-names>I</given-names></name> (<year>2013</year>) <article-title>Quantitative analysis of calcium spikes in noisy fluorescent background</article-title>. <source>PLoS One</source> <volume>8</volume>: <fpage>e64394</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0064394" xlink:type="simple">10.1371/journal.pone.0064394</ext-link></comment> <object-id pub-id-type="pmid">23741324</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Malik</surname> <given-names>WQ</given-names></name>, <name name-style="western"><surname>Schummers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sur</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name> (<year>2011</year>) <article-title>Denoising two-photon calcium imaging data</article-title>. <source>PLoS One</source> <volume>6</volume>: <fpage>e20490</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0020490" xlink:type="simple">10.1371/journal.pone.0020490</ext-link></comment> <object-id pub-id-type="pmid">21687727</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Romano</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Perez-Schuster</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Jouary</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Boulanger-Weill</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Candeo</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2017</year>) <article-title>An integrated calcium imaging processing toolbox for the analysis of neuronal population dynamics</article-title>. <source>PLoS Comput Biol</source> <volume>13</volume>: <fpage>e1005526</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005526" xlink:type="simple">10.1371/journal.pcbi.1005526</ext-link></comment> <object-id pub-id-type="pmid">28591182</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Theis</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Froudarakis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Reimer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roman Roson</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2016</year>) <article-title>Benchmarking Spike Rate Inference in Population Calcium Imaging</article-title>. <source>Neuron</source> <volume>90</volume>: <fpage>471</fpage>–<lpage>482</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2016.04.014" xlink:type="simple">10.1016/j.neuron.2016.04.014</ext-link></comment> <object-id pub-id-type="pmid">27151639</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rahmati</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Kirmse</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Markovic</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Holthoff</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kiebel</surname> <given-names>SJ</given-names></name> (<year>2016</year>) <article-title>Inferring Neuronal Dynamics from Calcium Imaging Data Using Biophysical Models and Bayesian Inference</article-title>. <source>PLoS Comput Biol</source> <volume>12</volume>: <fpage>e1004736</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004736" xlink:type="simple">10.1371/journal.pcbi.1004736</ext-link></comment> <object-id pub-id-type="pmid">26894748</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Samtleben</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wachter</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Blum</surname> <given-names>R</given-names></name> (<year>2015</year>) <article-title>Store-operated calcium entry compensates fast ER calcium loss in resting hippocampal neurons</article-title>. <source>Cell Calcium</source> <volume>58</volume>: <fpage>147</fpage>–<lpage>159</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ceca.2015.04.002" xlink:type="simple">10.1016/j.ceca.2015.04.002</ext-link></comment> <object-id pub-id-type="pmid">25957620</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Borodinsky</surname> <given-names>LN</given-names></name>, <name name-style="western"><surname>Root</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Cronin</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Sann</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Gu</surname> <given-names>X</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Activity-dependent homeostatic specification of transmitter expression in embryonic neurons</article-title>. <source>Nature</source> <volume>429</volume>: <fpage>523</fpage>–<lpage>530</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature02518" xlink:type="simple">10.1038/nature02518</ext-link></comment> <object-id pub-id-type="pmid">15175743</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Subramanian</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Wetzel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dombert</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Yadav</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Havlicek</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Role of Na(v)1.9 in activity-dependent axon growth in motoneurons</article-title>. <source>Hum Mol Genet</source> <volume>21</volume>: <fpage>3655</fpage>–<lpage>3667</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/hmg/dds195" xlink:type="simple">10.1093/hmg/dds195</ext-link></comment> <object-id pub-id-type="pmid">22641814</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lohmann</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Finski</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bonhoeffer</surname> <given-names>T</given-names></name> (<year>2005</year>) <article-title>Local calcium transients regulate the spontaneous motility of dendritic filopodia</article-title>. <source>Nat Neurosci</source> <volume>8</volume>: <fpage>305</fpage>–<lpage>312</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn1406" xlink:type="simple">10.1038/nn1406</ext-link></comment> <object-id pub-id-type="pmid">15711541</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Winnubst</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cheyne</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Niculescu</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lohmann</surname> <given-names>C</given-names></name> (<year>2015</year>) <article-title>Spontaneous Activity Drives Local Synaptic Plasticity In Vivo</article-title>. <source>Neuron</source> <volume>87</volume>: <fpage>399</fpage>–<lpage>410</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2015.06.029" xlink:type="simple">10.1016/j.neuron.2015.06.029</ext-link></comment> <object-id pub-id-type="pmid">26182421</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>GX</given-names></name>, <name name-style="western"><surname>Poo</surname> <given-names>MM</given-names></name> (<year>2005</year>) <article-title>Requirement of TRPC channels in netrin-1-induced chemotropic turning of nerve growth cones</article-title>. <source>Nature</source> <volume>434</volume>: <fpage>898</fpage>–<lpage>904</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature03478" xlink:type="simple">10.1038/nature03478</ext-link></comment> <object-id pub-id-type="pmid">15758951</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Turrigiano</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Leslie</surname> <given-names>KR</given-names></name>, <name name-style="western"><surname>Desai</surname> <given-names>NS</given-names></name>, <name name-style="western"><surname>Rutherford</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>SB</given-names></name> (<year>1998</year>) <article-title>Activity-dependent scaling of quantal amplitude in neocortical neurons</article-title> [see comments]. <source>Nature</source> <volume>391</volume>: <fpage>892</fpage>–<lpage>896</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/36103" xlink:type="simple">10.1038/36103</ext-link></comment> <object-id pub-id-type="pmid">9495341</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Akerboom</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Wardill</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Tian</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Marvin</surname> <given-names>JS</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Optimization of a GCaMP calcium indicator for neural activity imaging</article-title>. <source>J Neurosci</source> <volume>32</volume>: <fpage>13819</fpage>–<lpage>13840</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.2601-12.2012" xlink:type="simple">10.1523/JNEUROSCI.2601-12.2012</ext-link></comment> <object-id pub-id-type="pmid">23035093</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schindelin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rueden</surname> <given-names>CT</given-names></name>, <name name-style="western"><surname>Hiner</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Eliceiri</surname> <given-names>KW</given-names></name> (<year>2015</year>) <article-title>The ImageJ ecosystem: An open platform for biomedical image analysis</article-title>. <source>Mol Reprod Dev</source> <volume>82</volume>: <fpage>518</fpage>–<lpage>529</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/mrd.22489" xlink:type="simple">10.1002/mrd.22489</ext-link></comment> <object-id pub-id-type="pmid">26153368</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Andreska</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Aufmkolk</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sauer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Blum</surname> <given-names>R</given-names></name> (<year>2014</year>) <article-title>High abundance of BDNF within glutamatergic presynapses of cultured hippocampal neurons</article-title>. <source>Front Cell Neurosci</source> <volume>8</volume>: <fpage>107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncel.2014.00107" xlink:type="simple">10.3389/fncel.2014.00107</ext-link></comment> <object-id pub-id-type="pmid">24782711</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blum</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Heinrich</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Sanchez</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lepier</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gundelfinger</surname> <given-names>ED</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Neuronal network formation from reprogrammed early postnatal rat cortical glial cells</article-title>. <source>Cereb Cortex</source> <volume>21</volume>: <fpage>413</fpage>–<lpage>424</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/bhq107" xlink:type="simple">10.1093/cercor/bhq107</ext-link></comment> <object-id pub-id-type="pmid">20562320</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hardingham</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Arnold</surname> <given-names>FJ</given-names></name>, <name name-style="western"><surname>Bading</surname> <given-names>H</given-names></name> (<year>2001</year>) <article-title>Nuclear calcium signaling controls CREB-mediated gene expression triggered by synaptic activity</article-title>. <source>Nat Neurosci</source> <volume>4</volume>: <fpage>261</fpage>–<lpage>267</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/85109" xlink:type="simple">10.1038/85109</ext-link></comment> <object-id pub-id-type="pmid">11224542</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hooper</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rothberg</surname> <given-names>BS</given-names></name>, <name name-style="western"><surname>Soboloff</surname> <given-names>J</given-names></name> (<year>2014</year>) <article-title>Neuronal STIMulation at rest</article-title>. <source>Sci Signal</source> <volume>7</volume>: <fpage>pe18</fpage>.</mixed-citation></ref>
<ref id="pcbi.1006054.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lalonde</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Saia</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gill</surname> <given-names>G</given-names></name> (<year>2014</year>) <article-title>Store-operated calcium entry promotes the degradation of the transcription factor Sp4 in resting neurons</article-title>. <source>Sci Signal</source> <volume>7</volume>: <fpage>ra51</fpage>.</mixed-citation></ref>
<ref id="pcbi.1006054.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hartmann</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karl</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Alexander</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Adelsberger</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Brill</surname> <given-names>MS</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>STIM1 controls neuronal Ca(2)(+) signaling, mGluR1-dependent synaptic transmission, and cerebellar motor behavior</article-title>. <source>Neuron</source> <volume>82</volume>: <fpage>635</fpage>–<lpage>644</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2014.03.027" xlink:type="simple">10.1016/j.neuron.2014.03.027</ext-link></comment> <object-id pub-id-type="pmid">24811382</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>v Wegner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Both</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fink</surname> <given-names>RH</given-names></name> (<year>2006</year>) <article-title>Automated detection of elementary calcium release events using the a trous wavelet transform</article-title>. <source>Biophys J</source> <volume>90</volume>: <fpage>2151</fpage>–<lpage>2163</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1529/biophysj.105.069930" xlink:type="simple">10.1529/biophysj.105.069930</ext-link></comment> <object-id pub-id-type="pmid">16387777</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ellefsen</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Settle</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Parker</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>IF</given-names></name> (<year>2014</year>) <article-title>An algorithm for automated detection, localization and measurement of local calcium signals from camera-based imaging</article-title>. <source>Cell Calcium</source> <volume>56</volume>: <fpage>147</fpage>–<lpage>156</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ceca.2014.06.003" xlink:type="simple">10.1016/j.ceca.2014.06.003</ext-link></comment> <object-id pub-id-type="pmid">25047761</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maruyama</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Maeda</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Moroda</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kato</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Inoue</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Detecting cells using non-negative matrix factorization on calcium imaging data</article-title>. <source>Neural Netw</source> <volume>55</volume>: <fpage>11</fpage>–<lpage>19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neunet.2014.03.007" xlink:type="simple">10.1016/j.neunet.2014.03.007</ext-link></comment> <object-id pub-id-type="pmid">24705544</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bouton</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Westbrook</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Corcoran</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Maren</surname> <given-names>S</given-names></name> (<year>2006</year>) <article-title>Contextual and temporal modulation of extinction: behavioral and biological mechanisms</article-title>. <source>Biol Psychiatry</source> <volume>60</volume>: <fpage>352</fpage>–<lpage>360</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.biopsych.2005.12.015" xlink:type="simple">10.1016/j.biopsych.2005.12.015</ext-link></comment> <object-id pub-id-type="pmid">16616731</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lock</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Parker</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>IF</given-names></name> (<year>2015</year>) <article-title>A comparison of fluorescent Ca(2)(+) indicators for imaging local Ca(2)(+) signals in cultured cells</article-title>. <source>Cell Calcium</source> <volume>58</volume>: <fpage>638</fpage>–<lpage>648</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ceca.2015.10.003" xlink:type="simple">10.1016/j.ceca.2015.10.003</ext-link></comment> <object-id pub-id-type="pmid">26572560</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Spitzer</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Lautermilch</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Gomez</surname> <given-names>TM</given-names></name> (<year>2000</year>) <article-title>Coding of neuronal differentiation by calcium transients</article-title>. <source>Bioessays</source> <volume>22</volume>: <fpage>811</fpage>–<lpage>817</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/1521-1878(200009)22:9&lt;811::AID-BIES6&gt;3.0.CO;2-G" xlink:type="simple">10.1002/1521-1878(200009)22:9&lt;811::AID-BIES6&gt;3.0.CO;2-G</ext-link></comment> <object-id pub-id-type="pmid">10944583</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Valnegri</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Puram</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>Bonni</surname> <given-names>A</given-names></name> (<year>2015</year>) <article-title>Regulation of dendrite morphogenesis by extrinsic cues</article-title>. <source>Trends Neurosci</source> <volume>38</volume>: <fpage>439</fpage>–<lpage>447</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tins.2015.05.003" xlink:type="simple">10.1016/j.tins.2015.05.003</ext-link></comment> <object-id pub-id-type="pmid">26100142</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Augustine</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Santamaria</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Tanaka</surname> <given-names>K</given-names></name> (<year>2003</year>) <article-title>Local calcium signaling in neurons</article-title>. <source>Neuron</source> <volume>40</volume>: <fpage>331</fpage>–<lpage>346</lpage>. <object-id pub-id-type="pmid">14556712</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Iascone</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Henderson</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>JC</given-names></name> (<year>2015</year>) <article-title>Spinal muscular atrophy: from tissue specificity to therapeutic strategies</article-title>. <source>F1000Prime Rep</source> <volume>7</volume>: <fpage>04</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.12703/P7-04" xlink:type="simple">10.12703/P7-04</ext-link></comment> <object-id pub-id-type="pmid">25705387</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sendtner</surname> <given-names>M</given-names></name> (<year>2010</year>) <article-title>Therapy development in spinal muscular atrophy</article-title>. <source>Nat Neurosci</source> <volume>13</volume>: <fpage>795</fpage>–<lpage>799</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.2565" xlink:type="simple">10.1038/nn.2565</ext-link></comment> <object-id pub-id-type="pmid">20581815</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Renton</surname> <given-names>AE</given-names></name>, <name name-style="western"><surname>Chio</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Traynor</surname> <given-names>BJ</given-names></name> (<year>2014</year>) <article-title>State of play in amyotrophic lateral sclerosis genetics</article-title>. <source>Nat Neurosci</source> <volume>17</volume>: <fpage>17</fpage>–<lpage>23</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.3584" xlink:type="simple">10.1038/nn.3584</ext-link></comment> <object-id pub-id-type="pmid">24369373</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leipold</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Liebmann</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Korenke</surname> <given-names>GC</given-names></name>, <name name-style="western"><surname>Heinrich</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Giesselmann</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>A de novo gain-of-function mutation in SCN11A causes loss of pain perception</article-title>. <source>Nat Genet</source> <volume>45</volume>: <fpage>1399</fpage>–<lpage>1404</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ng.2767" xlink:type="simple">10.1038/ng.2767</ext-link></comment> <object-id pub-id-type="pmid">24036948</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Monani</surname> <given-names>UR</given-names></name> (<year>2005</year>) <article-title>Spinal muscular atrophy: a deficiency in a ubiquitous protein; a motor neuron-specific disease</article-title>. <source>Neuron</source> <volume>48</volume>: <fpage>885</fpage>–<lpage>896</lpage>. <object-id pub-id-type="pmid">16364894</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Draguhn</surname> <given-names>A</given-names></name> (<year>2004</year>) <article-title>Neuronal oscillations in cortical networks</article-title>. <source>Science</source> <volume>304</volume>: <fpage>1926</fpage>–<lpage>1929</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1099745" xlink:type="simple">10.1126/science.1099745</ext-link></comment> <object-id pub-id-type="pmid">15218136</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Draguhn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Reichinnek</surname> <given-names>S</given-names></name> (<year>2014</year>) <article-title>Coordinated network activity in the hippocampus</article-title>. <source>Front Neurol Neurosci</source> <volume>34</volume>: <fpage>26</fpage>–<lpage>35</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1159/000357026" xlink:type="simple">10.1159/000357026</ext-link></comment> <object-id pub-id-type="pmid">24777128</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sasi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vignoli</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Canossa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Blum</surname> <given-names>R</given-names></name> (<year>2017</year>) <article-title>Neurobiology of local and intercellular BDNF signaling</article-title>. <source>Pflugers Arch</source> <volume>469</volume>: <fpage>593</fpage>–<lpage>610</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00424-017-1964-4" xlink:type="simple">10.1007/s00424-017-1964-4</ext-link></comment> <object-id pub-id-type="pmid">28280960</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wiese</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Herrmann</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Drepper</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Jablonka</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Funk</surname> <given-names>N</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Isolation and enrichment of embryonic mouse motoneurons from the lumbar spinal cord of individual mouse embryos</article-title>. <source>Nat Protoc</source> <volume>5</volume>: <fpage>31</fpage>–<lpage>38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nprot.2009.193" xlink:type="simple">10.1038/nprot.2009.193</ext-link></comment> <object-id pub-id-type="pmid">20057379</object-id></mixed-citation></ref>
<ref id="pcbi.1006054.ref062"><label>62</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Percival</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Walden</surname> <given-names>AT</given-names></name> (<year>2000</year>) <source>Wavelet methods for time series analysis</source>. <publisher-loc>Cambridge; New York</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>. <volume>xxv</volume>, <fpage>594</fpage> p. p.</mixed-citation></ref>
<ref id="pcbi.1006054.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lilly</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Olhede</surname> <given-names>SC</given-names></name> (<year>2010</year>) <article-title>On the Analytic Wavelet Transform</article-title>. <source>IEEE Transactions on Information Theory</source> <volume>56</volume>: <fpage>4135</fpage>–<lpage>4156</lpage>.</mixed-citation></ref>
<ref id="pcbi.1006054.ref064"><label>64</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Percival</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Walden</surname> <given-names>AT</given-names></name> (<year>2000</year>) <chapter-title>Cambridge Series in Statistical and Probabilistic Mathematics</chapter-title>. <source>Software to book Wavelet Methods for Time Series Analysis</source>. <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation></ref>
</ref-list>
</back>
</article>