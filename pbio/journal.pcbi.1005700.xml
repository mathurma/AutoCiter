<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00221</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005700</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene identification and analysis</subject><subj-group><subject>Genetic screens</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Meta-analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Meta-analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene identification and analysis</subject><subj-group><subject>Genetic networks</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Genetic networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Human genetics</subject><subj-group><subject>Genome-wide association studies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune response</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Immune response</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein interactions</subject><subj-group><subject>Protein-protein interactions</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Extracting replicable associations across multiple studies: Empirical Bayes algorithms for controlling the false discovery rate</article-title>
<alt-title alt-title-type="running-head">Replicability analysis of multiple studies: Algorithms for controlling the fdr</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Amar</surname> <given-names>David</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1889-9870</contrib-id>
<name name-style="western">
<surname>Shamir</surname> <given-names>Ron</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Yekutieli</surname> <given-names>Daniel</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>The Blavatnik School of Computer Science, Tel Aviv University, Tel Aviv, Israel</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Statistics and OR, Tel Aviv University, Tel Aviv, Israel</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Keinan</surname> <given-names>Alon</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Cornell University, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">rshamir@tau.ac.il</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>18</day>
<month>8</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>8</issue>
<elocation-id>e1005700</elocation-id>
<history>
<date date-type="received">
<day>9</day>
<month>2</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>7</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Amar et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005700"/>
<abstract>
<p>In almost every field in genomics, large-scale biomedical datasets are used to report associations. Extracting associations that recur across multiple studies while controlling the false discovery rate is a fundamental challenge. Here, we propose a new method to allow joint analysis of multiple studies. Given a set of p-values obtained from each study, the goal is to identify associations that recur in at least <italic>k</italic> &gt; 1 studies while controlling the false discovery rate. We propose several new algorithms that differ in how the study dependencies are modeled, and compare them and extant methods under various simulated scenarios. The top algorithm, SCREEN (Scalable Cluster-based REplicability ENhancement), is our new algorithm that works in three stages: (1) clustering an estimated correlation network of the studies, (2) learning replicability (e.g., of genes) within clusters, and (3) merging the results across the clusters. When we applied SCREEN to two real datasets it greatly outperformed the results obtained via standard meta-analysis. First, on a collection of 29 case-control gene expression cancer studies, we detected a large set of consistently up-regulated genes related to proliferation and cell cycle regulation. These genes are both consistently up-regulated across many cancer studies, and are well connected in known gene networks. Second, on a recent pan-cancer study that examined the expression profiles of patients with and without mutations in the HLA complex, we detected a large active module of up-regulated genes that are both related to immune responses and are well connected in known gene networks. This module covers thrice more genes as compared to the original study at a similar false discovery rate, demonstrating the high power of SCREEN. An implementation of SCREEN is available in the supplement.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>When analyzing results from multiple studies, extracting replicated associations is the first step towards making new discoveries. The standard approach for this task is to use meta-analysis methods, which usually make an underlying null hypothesis that a gene has no effect in all studies. On the other hand, in replicability analysis we explicitly require that the gene will manifest a recurring pattern of effects. In this study we develop new algorithms for replicability analysis that are both scalable (i.e., can handle many studies) and allow controlling the false discovery rate. We show that our main algorithm called SCREEN (Scalable Cluster-based REplicability ENhancement) outperforms the other methods in simulated scenarios. Moreover, when applied to real datasets, SCREEN greatly extended the results of the meta-analysis, and can even facilitate detection of new biological results.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003977</institution-id>
<institution>Israel Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>1049/16</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Yekutieli</surname> <given-names>Daniel</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>Israeli Center of Research Excellence</institution>
</funding-source>
<award-id>41/11</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1889-9870</contrib-id>
<name name-style="western">
<surname>Shamir</surname> <given-names>Ron</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100003977</institution-id>
<institution>Israel Science Foundation</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1889-9870</contrib-id>
<name name-style="western">
<surname>Shamir</surname> <given-names>Ron</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution>Raymond and Beverly Sackler Chair in Bioinformatics</institution>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1889-9870</contrib-id>
<name name-style="western">
<surname>Shamir</surname> <given-names>Ron</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This research was supported in part by the Israel Science Foundation as part of the ISF-NSFC joint program, by the Raymond and Beverly Sackler Chair in Bioinformatics, and by the Israeli Center of Research Excellence (I-CORE), Gene Regulation in Complex Human Disease, Center No 41/11. Part of the work was done while DA and RS were visiting the Simons Institute for the Theory of Computing. The work of DY was supported by ISF grant 1049/16. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="0"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-08-30</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The datasets and an implementation of SCREEN are available in supporting information file S1 Data. In addition, the sources for the data are referenced in the manuscript.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Confidence in reported findings is a prerequisite for advancing any scientific field. Such confidence is achieved by showing replication of discoveries in new studies [<xref ref-type="bibr" rid="pcbi.1005700.ref001">1</xref>]. In recent years studies have shown low reproducibility of results in several domains, including economics [<xref ref-type="bibr" rid="pcbi.1005700.ref002">2</xref>], psychology [<xref ref-type="bibr" rid="pcbi.1005700.ref003">3</xref>], medicine [<xref ref-type="bibr" rid="pcbi.1005700.ref004">4</xref>], and biology [<xref ref-type="bibr" rid="pcbi.1005700.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005700.ref007">7</xref>]. A new methodology called replicability analysis was recently suggested as a way to statistically pinpoint replicated discoveries across studies while controlling for the false discovery rate (FDR) [<xref ref-type="bibr" rid="pcbi.1005700.ref008">8</xref>]. This type of analysis is essential when trying to detect new hypotheses by integration of existing data from multiple high-throughput experiments.</p>
<p>The practical importance of replicability analysis is twofold. First, it quantifies the reliability of reported results. Second, collated information from multiple studies can identify scientific results that are beyond the reach of each single study. Indeed, in Genome Wide Association Studies (GWAS) replicability analysis allowed detection of new results that were not identified in meta-analysis, demonstrating that the two approaches are complementary [<xref ref-type="bibr" rid="pcbi.1005700.ref009">9</xref>].</p>
<p>Meta-analyses are widely applied and have been extensively studied in statistics [<xref ref-type="bibr" rid="pcbi.1005700.ref010">10</xref>] and in computational biology [<xref ref-type="bibr" rid="pcbi.1005700.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1005700.ref012">12</xref>]. However, in recent years the changes in the scale and scope of public high-throughput biomedical data have posed new methodological challenges. The first, and more obvious, is accounting for inflation in the number of false discoveries due to the multiplicity of outcomes, as hundreds of thousands and even millions of hypotheses are tested (see Zeggini et al. [<xref ref-type="bibr" rid="pcbi.1005700.ref013">13</xref>] for example). The second challenge is directly assessing consistency of results, which is not addressed by the classic null hypothesis of meta-analysis that the effect size is 0 in all the studies. Third, there is a need to distinguish between true effects that are specific to a single study and true effects that represent general discoveries and thus are replicable. For example, Kraft et al. [<xref ref-type="bibr" rid="pcbi.1005700.ref014">14</xref>] suggested that the effect of common genetic variants on the phenotype may correlate with population biases in a specific GWAS. While these are real discoveries in the sense that similar estimated effects are expected to be observed if the experiment could be replicated on the same cohort, their scientific importance is limited because they are specific to that cohort. For this reason, the authors argue that it is important to identify the association in additional studies conducted using a similar, but not identical, study base.</p>
<p>In recent years several frequentist approaches were suggested for the problem. Benjamini and Heller [<xref ref-type="bibr" rid="pcbi.1005700.ref015">15</xref>] introduced an inferential framework for replicability that is based on tests of partial conjunction null hypotheses. For meta-analysis of <italic>n</italic> studies of the same <italic>m</italic> outcomes and <italic>u</italic> = 1…<italic>n</italic>, the partial conjunction <italic>H</italic><sup><italic>u</italic>/<italic>n</italic></sup>(<italic>g</italic>) is that outcome <italic>g</italic> has a non-null effect in less than <italic>u</italic> studies. Thus <italic>H</italic><sup>1/<italic>n</italic></sup>(<italic>g</italic>) is the standard meta-analysis null hypothesis that outcome <italic>g</italic> has a null effect in all <italic>n</italic> studies. The authors introduced p-values for testing <italic>H</italic><sup><italic>u</italic>/<italic>n</italic></sup>(<italic>g</italic>) for each outcome. Benjamini, Heller and Yekutieli [<xref ref-type="bibr" rid="pcbi.1005700.ref008">8</xref>] applied the Benjamini-Hochberg FDR procedure [<xref ref-type="bibr" rid="pcbi.1005700.ref016">16</xref>] (BH) to the partial conjunction hypotheses p-values, and suggested setting <italic>u</italic> = 2 in order to assess replicability. Heller et al. [<xref ref-type="bibr" rid="pcbi.1005700.ref017">17</xref>] developed an approach for checking if a follow-up study corroborates the results reported in the original study. Song and Tseng [<xref ref-type="bibr" rid="pcbi.1005700.ref018">18</xref>] proposed a method to evaluate the proportion of non-null effects of a gene. However, they used the standard meta-analysis null hypothesis and their method cannot handle composite hypotheses, which are partial conjunctions <italic>H</italic><sup><italic>u</italic>/<italic>n</italic></sup> with <italic>u</italic> &gt; 1.</p>
<p>Bayesian methods handle these shortcomings and offer a powerful framework for replicability analysis. For analyzing results from a single study, Efron introduced an empirical Bayes framework called the two-groups model [<xref ref-type="bibr" rid="pcbi.1005700.ref019">19</xref>]. It allows explicit analysis of the distribution of the statistic (e.g., p-values) of the underlying null and non-null groups. This clustering-based structure is then used to quantify the FDR of a rejection rule, and to compute a single point statistic, which is referred to as local Bayes FDR, or simply <italic>fdr</italic>. Heller and Yekutieli [<xref ref-type="bibr" rid="pcbi.1005700.ref009">9</xref>] introduced a method called repfdr, which extends the two-groups model for testing the partial conjunction hypotheses to the multi-study case. Formally, the problem is as follows: given an <italic>n</italic> × <italic>m</italic> matrix <italic>Z</italic>, where <italic>Z</italic><sub><italic>i</italic>,<italic>j</italic></sub> is the p-value (or z-score) of object (e.g., gene) <italic>i</italic> in study <italic>j</italic>, our goal is to identify the objects that are k-replicable (i.e., significant in <italic>k</italic> or more studies) while controlling the fdr.</p>
<p>Repfdr estimates the posterior probabilities of the various configurations of outcome effect status (null or non-null) across studies, and computes the fdr for each partial conjunction null by summing the posterior probabilities for the relevant configurations. The authors showed that their approach controls the FDR and offers more power than the frequentist methods. However, repfdr is not scalable and can only handle a few datasets. In addition, it was particularly designed for GWAS datasets in which the number of tested objects (e.g., SNPs) is very large (i.e., &gt; 100k).</p>
<p>In this study, we propose ways to overcome the limitations of repfdr. Our focus is on allowing efficient computation when <italic>m</italic> is large and <italic>n</italic> is limited, such as in gene expression datasets (i.e., <italic>n</italic> ∼ 20k). To reach this goal we make three simplifying assumptions: (1) we ignore the effect size, (2) we ignore the direction of the statistic, and (3) we assume that the studies originate from independent clusters. In addition, to handle larger values of <italic>m</italic> we compute an upper bound for the <italic>fdr</italic>, cutting the running time substantially. Our main algorithm is called SCREEN (Scalable Cluster-based REplicability ENhancement). It first detects the study clusters, then uses Expectation-Maximization (EM) to model each cluster, and finally merges the clusters using dynamic programming. Other algorithms that we propose here include two variants of SCREEN that differ in the way the studies are clustered: <italic>SCREEN</italic>–<italic>ind</italic> assumes independence and treats each study as a single cluster, and repfdr-UB puts all studies in one cluster. We compared SCREEN to other algorithms using various simulated scenarios and showed that only SCREEN had consistently low empirical false discovery proportions, and very high detection power.</p>
<p>We applied SCREEN to two cancer datasets, where each is a collection of case-control gene expression experiments. In both cases SCREEN greatly improved the results obtained by standard meta-analysis, and provided new biological insights. The first dataset is a collection of 29 case-control gene expression cancer studies from different tissues. Here, SCREEN detected a large set of genes that are consistently up-regulated, highly enriched for cell proliferation and cell cycle regulation functions, and are well connected in known gene networks, indicating their functional coherence. The second dataset is a recent pan-cancer study that examined the expression profiles of patients with and without mutations in the HLA complex across 11 cancer types [<xref ref-type="bibr" rid="pcbi.1005700.ref020">20</xref>]. SCREEN detected a large set of up-regulated genes that are related to immune responses. Importantly, SCREEN reported many more immune response genes than the original study thanks to our ability to quantify the fdr, and allowed detection of prominent genes and pathways that were not reported previously.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>Outline: After introducing some background and notation, we present a dynamic programming algorithm for calculating the fdr under the assumption that the studies are independent. Second, we discuss EM-based algorithms for dealing with dependence. We then show that given the prior probability of only a subset of all configurations an upper-bound for the <italic>fdr</italic> can be computed. This leads us to a much faster algorithm that can handle many studies. Third, we extend the dynamic programming algorithm to handle independent clusters of studies. This will lead us to the complete SCREEN algorithm, which is based on EM-based dependency modeling within study clusters and merging the results using dynamic programming. Finally, we discuss experimental results on simulated and real datasets.</p>
<sec id="sec003">
<title>Preliminaries and notations</title>
<p>We start with a brief introduction to the single-study model. For a full description and background see [<xref ref-type="bibr" rid="pcbi.1005700.ref019">19</xref>]. Given a large set of <italic>N</italic> hypotheses tested in a large-scale study, the two-groups model provides a simple Bayesian framework for multiple testing: each of the <italic>N</italic> cases (e.g., genes in a gene expression study) are either null or non-null with prior probability <italic>π</italic><sub>0</sub> and <italic>π</italic><sub>1</sub> = 1 − <italic>π</italic><sub>0</sub>, and with z-scores (or p-values) having density either <italic>f</italic><sub>0</sub>(<italic>z</italic>) or <italic>f</italic><sub>1</sub>(<italic>z</italic>). When the assumptions of the statistical test are valid, we know that the <italic>f</italic><sub>0</sub> distribution is a standard normal (or a uniform distribution for p-values), and we call it the theoretical null. The mixture density and probability distributions are:
<disp-formula id="pcbi.1005700.e001"><alternatives><graphic id="pcbi.1005700.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>f</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>f</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>F</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>z</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
For a rejection area <inline-formula id="pcbi.1005700.e002"><alternatives><graphic id="pcbi.1005700.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mstyle mathvariant="italic"><mml:mi mathvariant="script">Ƶ</mml:mi></mml:mstyle> <mml:mi>y</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mi>∞</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, using Bayes rule we get:
<disp-formula id="pcbi.1005700.e003"><alternatives><graphic id="pcbi.1005700.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi> <mml:mi>d</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mstyle mathvariant="italic"><mml:mi mathvariant="script">Ƶ</mml:mi></mml:mstyle> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≡</mml:mo> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>{</mml:mo> <mml:mi>n</mml:mi> <mml:mi>u</mml:mi> <mml:mi>l</mml:mi> <mml:mi>l</mml:mi> <mml:mo>|</mml:mo> <mml:mi>z</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mstyle mathvariant="italic"><mml:mi mathvariant="script">Ƶ</mml:mi></mml:mstyle> <mml:mi>y</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:msub><mml:mi>F</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mi>F</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We call <italic>Fdr</italic> the (Bayes) false discovery rate for <inline-formula id="pcbi.1005700.e004"><alternatives><graphic id="pcbi.1005700.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mstyle mathvariant="italic"><mml:mi mathvariant="script">Ƶ</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula>: this is the probability we would make a false discovery if we report <inline-formula id="pcbi.1005700.e005"><alternatives><graphic id="pcbi.1005700.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mstyle mathvariant="italic"><mml:mi mathvariant="script">Ƶ</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula> as non-null. If <inline-formula id="pcbi.1005700.e006"><alternatives><graphic id="pcbi.1005700.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mstyle mathvariant="italic"><mml:mi mathvariant="script">Ƶ</mml:mi></mml:mstyle></mml:math></alternatives></inline-formula> is a single point <italic>z</italic><sub>0</sub> we define the local (Bayes) false discovery rate as:
<disp-formula id="pcbi.1005700.e007">
<alternatives>
<graphic id="pcbi.1005700.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>f</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>r</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>≡</mml:mo>
<mml:mi>P</mml:mi>
<mml:mi>r</mml:mi>
<mml:mrow>
<mml:mo>{</mml:mo>
<mml:mi>n</mml:mi>
<mml:mi>u</mml:mi>
<mml:mi>l</mml:mi>
<mml:mi>l</mml:mi>
<mml:mo>|</mml:mo>
<mml:mi>z</mml:mi>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>}</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:msub>
<mml:mi>π</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:msub>
<mml:mi>f</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>/</mml:mo>
<mml:mi>f</mml:mi>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>z</mml:mi>
<mml:mn>0</mml:mn>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Previous work have shown that: (1) the Bayes Fdr is tightly related to false discovery control in the frequentist sense, and (2) using a threshold on the local fdr for defining discoveries is equivalent to the optimal Bayes rule in terms of classification between nulls and non-nulls. Moreover, a threshold of 0.2 on the local fdr was suggested [<xref ref-type="bibr" rid="pcbi.1005700.ref019">19</xref>, <xref ref-type="bibr" rid="pcbi.1005700.ref021">21</xref>]. Note that in our Bayesian setting computing the local fdr of a gene is an estimation problem. Within the context of our study we incorporated and tested two established methods for two-groups estimation studies: locfdr [<xref ref-type="bibr" rid="pcbi.1005700.ref022">22</xref>] and estimation based on mixture of Gaussians, which we call normix, see <xref ref-type="sec" rid="sec020">Materials and methods</xref> for details.</p>
<p>Consider an extension of the two group model to analysis of <italic>n</italic> genes over <italic>m</italic> &gt; 1 studies. The data for gene <italic>i</italic> are a vector of m statistics <italic>Z</italic><sub><italic>i</italic>,⋅</sub> = (<italic>Z</italic><sub><italic>i</italic>,1</sub>, ⋯, <italic>Z</italic><sub><italic>i</italic>,<italic>m</italic></sub>) that are all either z-scores or p-values. For simplicity, from now on we assume that these data are z-scores. The unknown parameter for gene <italic>i</italic> = 1, ⋯, <italic>n</italic> is a binary configuration vector <italic>H</italic><sub><italic>i</italic>,⋅</sub> = (<italic>H</italic><sub><italic>i</italic>,1</sub>, ⋯, <italic>H</italic><sub><italic>i</italic>,<italic>m</italic></sub>), with <italic>H</italic><sub><italic>i</italic>,<italic>j</italic></sub> ∈ {0, 1}. If <italic>H</italic><sub><italic>i</italic>,<italic>j</italic></sub> = 0 then gene <italic>i</italic> is a <italic>null</italic> realization in study <italic>j</italic>, and it is a <italic>non</italic>–<italic>null</italic> realization otherwise.</p>
<p>We assume that in each study <italic>j</italic> the parameters of the two-groups model <inline-formula id="pcbi.1005700.e008"><alternatives><graphic id="pcbi.1005700.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>:</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>f</mml:mi> <mml:mn>1</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>f</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are fixed and focus on replicability analysis. Generally, unless mentioned otherwise, we assume that the genes are independent. However, note that estimation of <italic>θ</italic><sub><italic>j</italic></sub> can account for gene dependence within study <italic>j</italic> [<xref ref-type="bibr" rid="pcbi.1005700.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005700.ref024">24</xref>]. Finally, we also assume that the z-scores of a gene are independent given its configuration. That is,
<disp-formula id="pcbi.1005700.e009">
<alternatives>
<graphic id="pcbi.1005700.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover></mml:mstyle> <mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover></mml:mstyle> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>f</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>f</mml:mi> <mml:mn>1</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math>
</alternatives>
</disp-formula></p>
<p>Next, we use <italic>h</italic> ∈ {0, 1}<sup><italic>m</italic></sup> to denote an arbitrary configuration vector, and <italic>π</italic>(<italic>h</italic>) to denote a probability assigned to the parameter space. We assume that the researcher has a set of configurations <inline-formula id="pcbi.1005700.e010"><alternatives><graphic id="pcbi.1005700.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>⊆</mml:mo> <mml:msup><mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow> <mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> that represents the desired rejected genes. Here we will assume that <inline-formula id="pcbi.1005700.e011"><alternatives><graphic id="pcbi.1005700.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:math></alternatives></inline-formula> corresponds to genes that are non-null in at least <italic>k</italic> studies: <inline-formula id="pcbi.1005700.e012"><alternatives><graphic id="pcbi.1005700.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>≥</mml:mo> <mml:mi>k</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1005700.e013"><alternatives><graphic id="pcbi.1005700.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>As a note, selection of <italic>k</italic> depends on the research question at hand. For example, Heller and Yekutieli used <italic>k</italic> = 2 to detect minimal replicability of SNPs in a GWAS [<xref ref-type="bibr" rid="pcbi.1005700.ref009">9</xref>]. Low <italic>k</italic> values can also be reasonable if the <italic>m</italic> studies represent different biological questions that are related, such as differential expression experiments from different cancer subtypes. On the other hand, if the <italic>m</italic> studies represent tightly related experiments such as biological replicates then larger k (e.g., <italic>m</italic>/2) seems more reasonable.</p>
<p>The local false discovery rate (fdr) of a gene <italic>i</italic> can be formulated as:
<disp-formula id="pcbi.1005700.e014"><alternatives><graphic id="pcbi.1005700.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mi>d</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>¯</mml:mo></mml:mover> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∉</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∉</mml:mo> <mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>For a given <italic>k</italic> and <inline-formula id="pcbi.1005700.e015"><alternatives><graphic id="pcbi.1005700.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msub><mml:mi mathvariant="script">H</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>≥</mml:mo> <mml:mi>k</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> we get:
<disp-formula id="pcbi.1005700.e016"><alternatives><graphic id="pcbi.1005700.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mi>d</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:munder> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</sec>
<sec id="sec004">
<title>An <italic>O</italic>(<italic>mnk</italic>) algorithm when studies are independent</title>
<p>We first address the case where studies are independent.</p>
<p><bold>Lemma.</bold> If the studies are independent (in the parameter space) then:
<disp-formula id="pcbi.1005700.e017"><alternatives><graphic id="pcbi.1005700.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mi>d</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:munder> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>f</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p><italic>Proof.</italic> First, note that under the independence assumption <inline-formula id="pcbi.1005700.e018"><alternatives><graphic id="pcbi.1005700.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Second, as the z-scores are independent given the configuration vector <italic>h</italic> we get that:
<disp-formula id="pcbi.1005700.e019"><alternatives><graphic id="pcbi.1005700.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mi>h</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>h</mml:mi></mml:munder> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>+</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p><bold>Proposition:</bold> If the studies are independent then <italic>fdr</italic><sub><italic>k</italic></sub> can be computed in <italic>O</italic>(<italic>mnk</italic>).</p>
<p><italic>Proof</italic>. By the lemma, the <italic>fdr</italic> of a gene is based on the product of the two-group model densities in each study. Therefore:
<disp-formula id="pcbi.1005700.e020">
<alternatives>
<graphic id="pcbi.1005700.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e020" xlink:type="simple"/>
<mml:math display="block" id="M20">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:mi>f</mml:mi>
<mml:mi>d</mml:mi>
<mml:msubsup>
<mml:mi>r</mml:mi>
<mml:mi>k</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mi>n</mml:mi>
<mml:mi>d</mml:mi>
<mml:mi>e</mml:mi>
<mml:mi>p</mml:mi>
</mml:mrow>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mo>·</mml:mo>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mrow>
<mml:mi>h</mml:mi>
<mml:mo>:</mml:mo>
<mml:mo>|</mml:mo>
<mml:mi>h</mml:mi>
<mml:mo>|</mml:mo>
<mml:mo>&lt;</mml:mo>
<mml:mi>k</mml:mi>
</mml:mrow>
</mml:munder>
<mml:mspace width="4pt"/>
<mml:munderover>
<mml:mo>∏</mml:mo>
<mml:mrow>
<mml:mi>j</mml:mi>
<mml:mo>=</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>m</mml:mi>
</mml:munderover>
<mml:mfrac>
<mml:mrow>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msubsup>
<mml:mi>π</mml:mi>
<mml:mn>0</mml:mn>
<mml:mi>j</mml:mi>
</mml:msubsup>
<mml:msubsup>
<mml:mi>f</mml:mi>
<mml:mn>0</mml:mn>
<mml:mi>j</mml:mi>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:mn>1</mml:mn>
<mml:mo>-</mml:mo>
<mml:msub>
<mml:mi>h</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
</mml:mrow>
</mml:msup>
<mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>-</mml:mo>
<mml:msubsup>
<mml:mi>π</mml:mi>
<mml:mn>0</mml:mn>
<mml:mi>j</mml:mi>
</mml:msubsup>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msubsup>
<mml:mi>f</mml:mi>
<mml:mn>1</mml:mn>
<mml:mi>j</mml:mi>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:msub>
<mml:mi>h</mml:mi>
<mml:mi>j</mml:mi>
</mml:msub>
</mml:msup>
</mml:mrow>
<mml:mrow>
<mml:msup>
<mml:mi>f</mml:mi>
<mml:mi>j</mml:mi>
</mml:msup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:msub>
<mml:mi>Z</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>j</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>)</mml:mo>
</mml:mrow>
</mml:mrow>
</mml:mfrac>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
</disp-formula></p>
<p>We use dynamic programming to calculate <italic>fdr</italic><sub><italic>k</italic></sub>(<italic>z</italic><sub><italic>i</italic></sub>) as follows. Define:
<disp-formula id="pcbi.1005700.e021"><alternatives><graphic id="pcbi.1005700.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>U</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>=</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:munder> <mml:mspace width="4pt"/><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>f</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mi>f</mml:mi> <mml:mn>1</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>h</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow> <mml:mrow><mml:msup><mml:mi>f</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
These values can be calculated (for each gene <italic>i</italic>) by updating a table of <italic>m</italic> × (<italic>k</italic> + 1) values. The base cases are:
<disp-formula id="pcbi.1005700.e022"><alternatives><graphic id="pcbi.1005700.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>U</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>f</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>f</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The recursive formulas are:
<disp-formula id="pcbi.1005700.e023"><alternatives><graphic id="pcbi.1005700.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>U</mml:mi> <mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>]</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:msubsup><mml:mi>f</mml:mi> <mml:mn>0</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>f</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mi>U</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>j</mml:mi></mml:msup> <mml:msubsup><mml:mi>f</mml:mi> <mml:mn>1</mml:mn> <mml:mi>j</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mi>f</mml:mi> <mml:mi>j</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mi>U</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Finally, to obtain the <italic>fdr</italic> of a gene we sum over the values in the last column:
<disp-formula id="pcbi.1005700.e024"><alternatives><graphic id="pcbi.1005700.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mi>d</mml:mi> <mml:msubsup><mml:mi>r</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mi>d</mml:mi> <mml:mi>e</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover> <mml:mi>U</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The running time for analyzing each gene is <italic>O</italic>(<italic>mk</italic>) and the total running time is <italic>O</italic>(<italic>nmk</italic>).</p>
</sec>
<sec id="sec005">
<title>Schemes for handling dependencies</title>
<p>The empirical Bayes method of [<xref ref-type="bibr" rid="pcbi.1005700.ref009">9</xref>] estimates the prior distribution <italic>π</italic>(<italic>h</italic>) directly from the data. This approach has two drawbacks. First, the EM algorithm explicitly keeps a value for each possible configuration, which makes the algorithm intractable when <italic>m</italic> is large. Second, the estimation for rare configurations might be inaccurate, unless <italic>n</italic> &gt;&gt;2<sup><italic>m</italic></sup>. As an alternative, we develop an algorithm that keeps in memory only a small set of high probability configurations. We then use these estimates to obtain an upper bound for the <italic>fdr</italic> of a gene.</p>
</sec>
<sec id="sec006">
<title>The unrestricted EM algorithm</title>
<p>We first describe the EM in the full configuration space, and then modify it for the constrained case. That is, the EM is guaranteed to improve the solution and converge. The unrestricted EM formulation is based on repfdr [<xref ref-type="bibr" rid="pcbi.1005700.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1005700.ref025">25</xref>], as follows:</p>
<p>The E-step:
<disp-formula id="pcbi.1005700.e025"><alternatives><graphic id="pcbi.1005700.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:msup><mml:mi>h</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msup><mml:mi>h</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>h</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>The M-step:
<disp-formula id="pcbi.1005700.e026"><alternatives><graphic id="pcbi.1005700.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:mfrac><mml:mrow><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:msup><mml:mi>h</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msup><mml:mi>h</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>h</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>This process guarantees convergence to a local optimum. Our goal is to limit the search space.</p>
<p><bold>Lemma.</bold> The EM algorithm above can be used to find a local optimum estimator under the constraint <inline-formula id="pcbi.1005700.e027"><alternatives><graphic id="pcbi.1005700.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mo>∀</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∉</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup> <mml:mspace width="4pt"/><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, for any non-empty configuration set <inline-formula id="pcbi.1005700.e028"><alternatives><graphic id="pcbi.1005700.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:msup><mml:mrow><mml:mi mathvariant="script">H</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msup></mml:math></alternatives></inline-formula>.</p>
<p><italic>Proof</italic>. Note that during the EM iterations, if at some time point <italic>t</italic> <italic>π</italic><sup>(<italic>t</italic>)</sup>(<italic>h</italic>) = 0 then ∀<italic>t</italic>* &gt; <italic>t</italic> <italic>π</italic><sup>(<italic>t</italic>*)</sup>(<italic>h</italic>) = 0. Therefore, setting the starting point of the EM such that <inline-formula id="pcbi.1005700.e029"><alternatives><graphic id="pcbi.1005700.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mo>∀</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∉</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mtext> </mml:mtext> <mml:msup><mml:mi>π</mml:mi> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> satisfies the constraint and ensures convergence.</p>
</sec>
<sec id="sec007">
<title>The restricted EM</title>
<p>In this section we present a restricted version of the EM above, which we call repfdr-UB. To describe it, we need additional notation. Given a configuration vector <italic>h</italic> ∈ {0, 1}<sup><italic>m</italic></sup>, let <italic>h</italic>[<italic>l</italic>] be the vector containing the first <italic>l</italic> entries of <italic>h</italic>. Given a real valued vector <italic>v</italic>, let <italic>v</italic><sub>(<italic>i</italic>)</sub> denote the i’th smallest element of <italic>v</italic>.</p>
<p>Our algorithm is based on the simple observation that if <italic>π</italic>(<italic>h</italic>[<italic>l</italic>]) ≤ <italic>ϵ</italic> then any extension of <italic>h</italic>[<italic>l</italic>] cannot exceed <italic>ϵ</italic>. That is, <italic>π</italic>(<italic>h</italic>[<italic>l</italic> + 1]) ≤ <italic>ϵ</italic> regardless of the new value in study <italic>l</italic> + 1. Our algorithm works as follows. The user specifies a limit to the number configurations kept in the memory—<italic>n</italic><sub><italic>H</italic></sub>. For simplicity we assume that <italic>n</italic><sub><italic>H</italic></sub> is a power of 2. We first run the unrestricted EM algorithm on the first <italic>log</italic><sub>2</sub>(<italic>n</italic><sub><italic>H</italic></sub>) − 1 studies. Each subsequent iteration adds a new study. In each iteration <italic>l</italic> we keep four parameters: (1) <inline-formula id="pcbi.1005700.e030"><alternatives><graphic id="pcbi.1005700.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup></mml:math></alternatives></inline-formula>—the set of the top <italic>n</italic><sub><italic>H</italic></sub> probability configurations, (2) <inline-formula id="pcbi.1005700.e031"><alternatives><graphic id="pcbi.1005700.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msup><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup></mml:math></alternatives></inline-formula>—the vector of their assigned probabilities, (3) <inline-formula id="pcbi.1005700.e032"><alternatives><graphic id="pcbi.1005700.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msup><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup></mml:math></alternatives></inline-formula>—an estimation of <inline-formula id="pcbi.1005700.e033"><alternatives><graphic id="pcbi.1005700.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup></mml:mrow></mml:msub> <mml:msup><mml:mi>π</mml:mi> <mml:mi>l</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and (4) <inline-formula id="pcbi.1005700.e034"><alternatives><graphic id="pcbi.1005700.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msup><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup></mml:math></alternatives></inline-formula>—an estimation of the maximal probability among the excluded configurations.</p>
<p>Initially, <italic>l</italic> = <italic>log</italic><sub>2</sub>(<italic>n</italic><sub><italic>H</italic></sub>) − 1 and <inline-formula id="pcbi.1005700.e035"><alternatives><graphic id="pcbi.1005700.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup></mml:math></alternatives></inline-formula> contains all possible configurations of the first <italic>l</italic> studies. In addition <inline-formula id="pcbi.1005700.e036"><alternatives><graphic id="pcbi.1005700.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1005700.e037"><alternatives><graphic id="pcbi.1005700.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. In iteration <italic>l</italic> + 1 we run the restricted EM algorithm on all possible extensions of <inline-formula id="pcbi.1005700.e038"><alternatives><graphic id="pcbi.1005700.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup></mml:math></alternatives></inline-formula>. That is, the input configuration set for the EM is a result of adding either 1 or 0 at the <italic>l</italic> + 1 position of each configuration in <inline-formula id="pcbi.1005700.e039"><alternatives><graphic id="pcbi.1005700.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup></mml:math></alternatives></inline-formula>. The EM run produces initial estimations for our parameters, on which the following ordered updates are applied:
<disp-formula id="pcbi.1005700.e040"><alternatives><graphic id="pcbi.1005700.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup> <mml:msup><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula> <disp-formula id="pcbi.1005700.e041"><alternatives><graphic id="pcbi.1005700.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>{</mml:mo> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>;</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≥</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula> <disp-formula id="pcbi.1005700.e042"><alternatives><graphic id="pcbi.1005700.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>∈</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:munder> <mml:msup><mml:mi>π</mml:mi> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula> <disp-formula id="pcbi.1005700.e043"><alternatives><graphic id="pcbi.1005700.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msup><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mtd> <mml:mtd><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>l</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>∉</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
Note that in step <xref ref-type="disp-formula" rid="pcbi.1005700.e041">Eq (2)</xref> above we keep the top <italic>n</italic><sub><italic>H</italic></sub>/2 configurations in <inline-formula id="pcbi.1005700.e044"><alternatives><graphic id="pcbi.1005700.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>l</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:math></alternatives></inline-formula>. This set is then used as input to the EM run in the next iteration. We repeat the process above until <italic>l</italic> = <italic>m</italic>. The output of the algorithm is <inline-formula id="pcbi.1005700.e045"><alternatives><graphic id="pcbi.1005700.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>H</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>ξ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<sec id="sec008">
<title>A fast algorithm for an upper bound for the fdr</title>
<p>We now show that the restricted algorithm provides an upper bound for the <italic>fdr</italic><sub><italic>k</italic></sub> of a gene in running time <italic>O</italic>(<italic>m</italic>(<italic>k</italic> + <italic>n</italic><sub><italic>H</italic></sub>)) for each gene.</p>
<p><bold>Theorem.</bold> Given the prior probability <italic>π</italic>(<italic>h</italic>) of each configuration <italic>h</italic> in <inline-formula id="pcbi.1005700.e046"><alternatives><graphic id="pcbi.1005700.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>⊆</mml:mo> <mml:mi mathvariant="script">H</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, and an upper bound <italic>ϵ</italic> for the probability of all excluded configurations, the following inequality holds:
<disp-formula id="pcbi.1005700.e047"><alternatives><graphic id="pcbi.1005700.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e047" xlink:type="simple"/><mml:math display="block" id="M47"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mi>d</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>∧</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula> <italic>Proof</italic>. Given that for each <inline-formula id="pcbi.1005700.e048"><alternatives><graphic id="pcbi.1005700.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:mi>h</mml:mi> <mml:mo>∉</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mtext> </mml:mtext> <mml:mi>π</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>h</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>≤</mml:mo> <mml:mi>ϵ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, we get:
<disp-formula id="pcbi.1005700.e049"><alternatives><graphic id="pcbi.1005700.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi> <mml:mi>d</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∧</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder></mml:mstyle> <mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∧</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∉</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder></mml:mstyle> <mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>≤</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∧</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder></mml:mstyle> <mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∧</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∉</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Thus:
<disp-formula id="pcbi.1005700.e050"><alternatives><graphic id="pcbi.1005700.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi> <mml:mi>d</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∧</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∧</mml:mo> <mml:mi>H</mml:mi> <mml:mo>∉</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi> <mml:mo>∧</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mi>ϵ</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mi>h</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Finally, since <inline-formula id="pcbi.1005700.e051"><alternatives><graphic id="pcbi.1005700.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>h</mml:mi></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≥</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, we obtain:
<disp-formula id="pcbi.1005700.e052"><alternatives><graphic id="pcbi.1005700.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>f</mml:mi> <mml:mi>d</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>∧</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p><bold>Corollary.</bold> The restricted algorithm provides an upper bound for the <italic>fdr</italic><sub><italic>k</italic></sub> of a gene in running time <italic>O</italic>(<italic>m</italic>(<italic>k</italic> + <italic>n</italic><sub><italic>H</italic></sub>)) for each gene.</p>
<p><italic>Proof</italic>. The final term in the proof above can be calculated in <italic>O</italic>(<italic>m</italic>(<italic>n</italic><sub><italic>H</italic></sub> + <italic>k</italic>)). First, the terms <inline-formula id="pcbi.1005700.e053"><alternatives><graphic id="pcbi.1005700.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>∧</mml:mo> <mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>ϵ</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005700.e054"><alternatives><graphic id="pcbi.1005700.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="script">H</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are calculated directly using the output of our EM-like algorithm in <italic>O</italic>(<italic>mn</italic><sub><italic>H</italic></sub>). Then, <italic>ϵ</italic>∑<sub><italic>h</italic>:|<italic>h</italic>|&lt;<italic>k</italic></sub> <italic>P</italic>(<italic>Z</italic><sub><italic>i</italic>,⋅</sub>|<italic>h</italic>) can be calculated using dynamic programming in a similar fashion to our algorithm for calculating <italic>fdr</italic><sub><italic>k</italic></sub> under independence assumption. Thus, the total running time for all genes, given the output of the EM, is <italic>O</italic>(<italic>mn</italic>(<italic>n</italic><sub><italic>H</italic></sub> + <italic>k</italic>)).</p>
</sec>
</sec>
<sec id="sec009">
<title>Replicability across independent study clusters</title>
<p>In this section we apply the ideas from the previous sections to obtain an algorithm for calculating the <italic>fdr</italic> under the assumption that the studies originate from independent clusters. We call this algorithm SCREEN (Scalable Cluster-based REplicability ENhancement, see <xref ref-type="supplementary-material" rid="pcbi.1005700.s010">S1 Text</xref> for an overview of the method). Briefly, our algorithm has three stages. First, we use the EM-process on each study pair to create a network of study correlations. We then cluster the network to obtain a set of study clusters that are likely to be independent, see <xref ref-type="sec" rid="sec020">Materials and methods</xref> for the full description of this step. Second, we run the EM on each cluster separately. Finally, we merge the results from the different clusters using dynamic programming. Note that this algorithm is a heuristic as it uses EM within each cluster.</p>
<sec id="sec010">
<title>A fast algorithm for combining study clusters</title>
<p>Assume for now that we are given a clustering of the studies into <italic>M</italic> independent clusters <italic>C</italic><sub>1</sub>, ⋯, <italic>C</italic><sub><italic>M</italic></sub>. Thus:
<disp-formula id="pcbi.1005700.e055"><alternatives><graphic id="pcbi.1005700.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>π</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1005700.e056"><alternatives><graphic id="pcbi.1005700.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msub><mml:mi>h</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> denotes the subvector of <italic>h</italic> confined to the studies in the cluster <italic>C</italic><sub><italic>j</italic></sub>. Let <inline-formula id="pcbi.1005700.e057"><alternatives><graphic id="pcbi.1005700.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> be the z-scores of gene <italic>i</italic> in the studies of cluster <italic>C</italic><sub><italic>j</italic></sub>, then <italic>fdr</italic><sub><italic>k</italic></sub> has the following form:
<disp-formula id="pcbi.1005700.e058"><alternatives><graphic id="pcbi.1005700.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>h</mml:mi> <mml:mo>:</mml:mo> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mo>|</mml:mo> <mml:mo>&lt;</mml:mo> <mml:mi>k</mml:mi></mml:mrow></mml:munder> <mml:mspace width="4pt"/><mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>This form is a generalization of the formulation under indepepndence assumption, which implies that the dynamic programming approach can be used to merge data across clusters. We now describe the full method.</p>
<p>We apply our EM approach to each cluster separately, and calculate the probability that gene <italic>i</italic> has exactly <italic>k</italic>* non-null realizations in cluster <italic>C</italic><sub><italic>j</italic></sub>:
<disp-formula id="pcbi.1005700.e059"><alternatives><graphic id="pcbi.1005700.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msub> <mml:mo>:</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msub> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Let <italic>V</italic>[<italic>i</italic>, <italic>j</italic>, <italic>k</italic>*] be the probability that gene <italic>i</italic> has <italic>k</italic>* − 1 non-null realizations over clusters 1, ⋯, <italic>j</italic>. Then:
<disp-formula id="pcbi.1005700.e060"><alternatives><graphic id="pcbi.1005700.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e060" xlink:type="simple"/><mml:math display="block" id="M60"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>V</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mtext>if </mml:mtext> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>&lt;</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd> <mml:mtd><mml:mrow><mml:mtext>otherwise</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>V</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>m</mml:mi> <mml:mi>i</mml:mi> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munderover></mml:mstyle> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>−</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>f</mml:mi> <mml:mi>d</mml:mi> <mml:msub><mml:mi>r</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mo>·</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mo>=</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:munderover></mml:mstyle> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
The table <italic>V</italic> above has <italic>M</italic> × <italic>k</italic> entries for each gene <italic>i</italic>, and the update rule takes <italic>O</italic>(<italic>k</italic>). Thus, given the EM results in each cluster, the running time of this algorithm is <italic>O</italic>(<italic>k</italic><sup>2</sup><italic>M</italic>) for each gene.</p>
</sec>
</sec>
<sec id="sec011">
<title>Experimental results</title>
<sec id="sec012">
<title>Simulations</title>
<p>Compared methods: We evaluated six different approaches for replicability. (1) Fisher: Fisher’s meta-analysis for each gene with BH correction. (2) BH-count: the number of q-values ≤ 0.1 for each gene after applying BH in each study. (3) Exp-count: an estimator for the expected number of non-nulls. See <xref ref-type="sec" rid="sec020">Materials and methods</xref> for details on 1-3; (4) Our algorithm for calculating <italic>fdr</italic><sub><italic>k</italic></sub> exactly under independence assumption, which we call SCREEN-ind, (5) repfdr-UB, which computes an upper bound for <italic>fdr</italic><sub><italic>k</italic></sub> in order to handle many possibly dependent studies, and (6) SCREEN, which evaluates replicability across study clusters. For 3-6, we tested two methods for two-groups estimation within studies: locfdr [<xref ref-type="bibr" rid="pcbi.1005700.ref022">22</xref>] and estimation based on mixture of Gaussians, which we call normix, see <xref ref-type="sec" rid="sec020">Materials and methods</xref> for details.</p>
<p>Simulation overview: We simulated scenarios of independent and dependent studies as explained later. In each of the scenarios below we started by creating a pair of matrices, <italic>P</italic>, and <italic>H</italic><sup><italic>P</italic></sup>. The number of genes <italic>n</italic> was 5000 and the number of studies <italic>m</italic> varied (in all scenarios <italic>m</italic> ≥ 20). <italic>P</italic> is a matrix of p-values, and <inline-formula id="pcbi.1005700.e061"><alternatives><graphic id="pcbi.1005700.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>P</mml:mi></mml:msubsup> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> denotes whether the p-value of gene <italic>i</italic> in study <italic>j</italic> is from the null group (<inline-formula id="pcbi.1005700.e062"><alternatives><graphic id="pcbi.1005700.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>P</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>) or the non-null group (<inline-formula id="pcbi.1005700.e063"><alternatives><graphic id="pcbi.1005700.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>P</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>). We first generated <italic>H</italic><sup><italic>P</italic></sup>, and then determined <italic>P</italic> given the gene configurations in <italic>H</italic><sup><italic>P</italic></sup> as follows. For each <italic>i</italic>, <italic>j</italic> where <inline-formula id="pcbi.1005700.e064"><alternatives><graphic id="pcbi.1005700.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>P</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> the value <italic>P</italic><sub><italic>i</italic>,<italic>j</italic></sub> was randomly selected from a uniform distribution. For each cell <italic>i</italic>, <italic>j</italic> for which <inline-formula id="pcbi.1005700.e065"><alternatives><graphic id="pcbi.1005700.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>P</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> the p-value was drawn with probability 0.5 from <italic>β</italic>(1, <italic>x</italic>) (i.e., low p-values), and otherwise from <italic>β</italic>(<italic>x</italic>, 1) (i.e., high p-values). We tested <italic>x</italic> = 10, 100, and 1000, corresponding to distributions with 0.1, 0.01, and 0.001 mean p-values, respectively. In addition to the non-null distributions we also varied other parameters in the creation of <italic>H</italic><sup><italic>P</italic></sup>: the number of non-nulls, and the correlation among the studies (i.e., the columns of <italic>H</italic><sup><italic>P</italic></sup>).</p>
<p>Performance evaluation: We tested the ability of the methods to detect genes that are non-null in two or more studies. Here, the unknown parameter of a gene was the number <italic>k</italic> of 1 values in its row in <italic>H</italic><sup><italic>P</italic></sup>. For each <italic>k</italic> between 2 and 5 we ran all algorithms above. For repfdr-UB we set the number of configurations <italic>n</italic><sub><italic>H</italic></sub> to 512. In methods that are based on calculating the local fdr we used a threshold of 0.2 for selecting the genes. For methods that are based on counting we used <italic>k</italic> as a threshold. For Fisher’s meta-analysis we used <italic>q</italic> ≤ 0.1 as a threshold. For every <italic>k</italic> we compared the genes identified by each algorithm to the set of genes with at least <italic>k</italic> non-null realizations (given in <italic>H</italic><sup><italic>P</italic></sup>). In each of the cases below we calculated the empirical false discovery proportion (FDP; i.e., the proportion of erroneously declared non-nulls). For methods that had <italic>FDP</italic> &lt; 0.2 across all tested <italic>k</italic> values we also calculated the Jaccard score in order to quantify the overall agreement between the output and the known solution. Thus, only methods that consistently performed well in terms of FDP are evaluated in their detection power.</p>
</sec>
<sec id="sec013">
<title>Scenario 1: Independent studies</title>
<p>Here, a random set of 300 genes were selected to be non-nulls independently in each study. In addition, we selected 50 genes to have non-null <italic>β</italic>(1, <italic>x</italic>) p-values in 5 additional studies. These genes were added to ensure presence of a large set of replicable genes with high <italic>k</italic> values (such a set could arise e.g., from up regulation of a pathway).</p>
<p>
<xref ref-type="fig" rid="pcbi.1005700.g001">Fig 1A</xref> shows the results for <italic>x</italic> = 100 using normix. Fisher’s method and repfdr-UB had high FDP for <italic>k</italic> ≥ 3. Exp-count had better Jaccard than SCREEN and SCREEN-ind, but at the expense of a higher FDP (which reached almost 0.15). For all tested <italic>x</italic> values the results using locfdr and normix were very similar, and SCREEN was very similar to SCREEN-ind as it tended to correctly cluster each study separately (see <xref ref-type="fig" rid="pcbi.1005700.g001">Fig 1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005700.s001">S1</xref>–<xref ref-type="supplementary-material" rid="pcbi.1005700.s003">S3</xref> Figs). For <italic>x</italic> = 1000 (<xref ref-type="supplementary-material" rid="pcbi.1005700.s001">S1 Fig</xref>) SCREEN and SCREEN-ind had the best Jaccard for almost every <italic>k</italic> and <italic>FDP</italic> ≤ 0.1. In contrast, Fisher’s method had very high FDP (≥ 0.25), again illustrating why standard meta-analysis is not suitable for our goal. For <italic>x</italic> = 10 the <italic>FDP</italic> scores of repfdr-UB were high (e.g., ≥ 0.25) for each <italic>k</italic> as well as the FDP scores of <italic>SCREEN</italic> for <italic>k</italic> = 2 using the normix method. All other FDP scores were very close to zero, and when the FDP values of SCREEN were high, very few genes where reported(≤ 4), see <xref ref-type="supplementary-material" rid="pcbi.1005700.s003">S3 Fig</xref>.</p>
<fig id="pcbi.1005700.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005700.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Simulation results: Independent and dependent studies.</title>
<p>A) 20 independent studies. B) Four clusters of 10 studies each with a low correlation within each cluster. C) Four clusters of 10 studies each with a high correlation within each cluster. The non-null distribution in each case was Beta(1,100). Two-groups estimation was done using normix. The left column shows the empirical FDP (values above 0.4 are not shown). The right column shows the Jaccard scores only for methods that had consistently low FDP values (&lt; 0.2) for all <italic>k</italic> values. BH-count, SCREEN and SCREEN-ind (SCRN-ind for short) are the only methods that had <italic>FDP</italic> ≤ 0.2 in all cases. BH-count had very low FDP but also very low Jaccard scores. Except for <italic>k</italic> = 2, SCREEN had similar or better performance compared to SCREEN-ind.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Scenario 2: Dependent studies</title>
<p>We simulated data with <italic>M</italic> = 4 clusters of ten studies each. Here, the matrix <italic>H</italic><sup><italic>P</italic></sup> was generated by first creating an auxiliary matrix <italic>A</italic> of the same dimensions as <italic>H</italic><sup><italic>P</italic></sup>. The rows of <italic>A</italic> were drawn independently from a multivariate normal distribution <inline-formula id="pcbi.1005700.e066"><alternatives><graphic id="pcbi.1005700.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>Σ</mml:mi> <mml:mi>M</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>Σ</italic><sub><italic>M</italic></sub> specified a correlation structure of <italic>M</italic> independent study clusters. Within each cluster the correlation was <italic>r</italic> = 0.8, or <italic>r</italic> = 0.4. <italic>H</italic><sup><italic>P</italic></sup> was created from <italic>A</italic> by setting a threshold such that the expected number of non-nulls in each study was 300. That is, <inline-formula id="pcbi.1005700.e067"><alternatives><graphic id="pcbi.1005700.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow> <mml:mi>P</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> if and only if <italic>A</italic><sub><italic>i</italic>,<italic>j</italic></sub> ≥ <italic>τ</italic><sup><italic>j</italic></sup>, where <italic>τ</italic><sup><italic>j</italic></sup> is the 0.94-th quantile of the normal distribution of column <italic>j</italic> of <italic>A</italic>. Given <italic>H</italic><sup><italic>P</italic></sup>, <italic>P</italic> was created as in Scenario 1 with <italic>x</italic> = 100.</p>
<p>The results using normix are summarized in <xref ref-type="fig" rid="pcbi.1005700.g001">Fig 1B and 1C</xref>. In terms of <italic>FDP</italic>, all algorithms except for Fisher’s method and Exp-count performed well. In terms of the Jaccard score SCREEN achieved top performance for <italic>k</italic> ≥ 4, and SCREEN-ind achieved top performance for <italic>k</italic> ≤ 3. As in the previous scenario, normix and locfdr gave similar results, see <xref ref-type="supplementary-material" rid="pcbi.1005700.s002">S2 Fig</xref>. <xref ref-type="fig" rid="pcbi.1005700.g002">Fig 2A</xref> shows the <italic>fdr</italic> values of SCREEN compared to the real fdr values for different <italic>k</italic> values (<italic>r</italic> = 0.8). For <italic>k</italic> = 4 show that our estimations are highly correlated with the real values. <xref ref-type="fig" rid="pcbi.1005700.g002">Fig 2B</xref> shows that the estimated fdr values decrease with the real number of non-nulls. In addition, most of SCREEN’s errors are made for genes with 3 or 4 non-null realizations, and the real fdr values will not necessarily capture these genes at <italic>fdr</italic><sub><italic>k</italic></sub> ≤ 0.2. On the other hand, a greater fdr threshold can be used (e.g., 0.4) to cover additional true negatives at the expense of a few false positives.</p>
<fig id="pcbi.1005700.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005700.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Simulation of dependent studies (4 clusters of 10 studies each).</title>
<p>The figures show SCREEN’s estimations vs. real fdr values for different <italic>k</italic> values. The number of study clusters is 4 and the correlation within the clusters is set using <italic>r</italic> = 0.8. The non-null distribution within each study is <italic>Beta</italic>(1,100). A) Real vs. estimated fdr values for <italic>k</italic> = 2 and <italic>k</italic> = 4. Each dot corresponds for a gene. For <italic>k</italic> = 2 the estimated <italic>fdr</italic> values are higher, demonstrating stringent FDR control. For <italic>k</italic> = 4 the real and estimated values are highly correlated. B) fdr distributions as a function of the real number of non-nulls (y-axis is the fdr value). Top: real fdrs, bottom: estimated fdr. Each boxplot represents a different set of genes whose real number of non-nulls is given in the x-axis label (except for 10, which means at least 10 non-nulls).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.g002" xlink:type="simple"/>
</fig>
<p>In summary, our simulations show that out of the <italic>fdr</italic><sub><italic>k</italic></sub>-based methods, SCREEN-ind and SCREEN had consistently low FDP values, while achieving the highest Jaccard scores. SCREEN-ind had a slight advantage in low <italic>k</italic> values, whereas SCREEN was better in higher <italic>k</italic> values.</p>
</sec>
<sec id="sec015">
<title>Scenario 3: Dense effects</title>
<p>In our simulations above the gene effects were sparse. That is, in all scenarios the non-null prior probability was relatively low. When we analyzed real datasets (see below) we observed that while some studies were in line with these classic assumptions, others were not, see <xref ref-type="supplementary-material" rid="pcbi.1005700.s004">S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005700.s005">S5</xref> Figs. To cope with these cases of dense effects we performed extensive additional analysis on both simulated and real data, see <xref ref-type="supplementary-material" rid="pcbi.1005700.s010">S1 Text</xref>. Our main findings are as follows: (1) locfdr often fails to model these cases, (2) locfdr and normix with empirical null estimation overestimate the null prior probability, and (3) as reported in the previous section, using SCREEN with normix and a fixed theoretical null achieved very high Jaccard scores and low FDP on simulated data. We therefore use the latter approach to analyze the datasets in the subsequent sections.</p>
</sec>
</sec>
<sec id="sec016">
<title>Analysis of cancer datasets</title>
<p>We analyzed two real datasets. The first, which we call Cancer DEG, is a collection of gene expression studies that compared cancer to non-cancer tissues. The second, called HLA, is from [<xref ref-type="bibr" rid="pcbi.1005700.ref020">20</xref>], where Shukla et al. tested differential expression between cancer samples with and without somatic mutations in the HLA complex across 11 TCGA cancer subtypes.</p>
<sec id="sec017">
<title>The cancer DEG dataset</title>
<p>This dataset contains 29 microarray gene expression studies that compared cancer to non-cancer tissues. It was selected from our previously published compendium [<xref ref-type="bibr" rid="pcbi.1005700.ref026">26</xref>] by taking all studies that had at least 10 cancer and 10 non-cancer samples (one study was excluded since its gene set was too small). For each dataset genes were assigned p-values for distinguishing between the cancer and non-cancer classes using the NCBI GEO2R web tool [<xref ref-type="bibr" rid="pcbi.1005700.ref027">27</xref>], where the p-values were calculated using a two-tailed t-test for differential expression. The resulting p-value matrix had 11540 rows (genes) and 29 columns. <xref ref-type="supplementary-material" rid="pcbi.1005700.s006">S6 Fig</xref> shows the estimated pairwise correlations between studies. SCREEN identified eight clusters: a single large cluster of 19 studies and 7 clusters with one or more studies.</p>
<p>
<xref ref-type="fig" rid="pcbi.1005700.g003">Fig 3A</xref> shows the number of selected genes identified by SCREEN and SCREEN-ind (at <italic>fdr</italic> 0.2), as a function of <italic>k</italic>, the minimum number of studies on which a gene must be detected. For <italic>k</italic> &lt; 10 the majority of the genes had low <italic>fdr</italic>, suggesting that most genes were differentially expressed in <italic>k</italic> or more studies. For <italic>k</italic> ≤ 17, SCREEN-ind reported more genes than SCREEN. However, SCREEN reported many more genes for higher <italic>k</italic> values. For example, for <italic>k</italic> = 20 SCREEN-ind detected 59 genes, whereas SCREEN detected 147. In addition, for each <italic>k</italic> we compared the output of each algorithm to Fisher’s meta-analysis. Here, we used Spearman correlation to compare the gene ranking obtained by the methods. <xref ref-type="fig" rid="pcbi.1005700.g003">Fig 3B</xref> shows the results as a function of <italic>k</italic>. The correlation for low <italic>k</italic> is near perfect (close to 1 for <italic>k</italic> = 2) and decreases with <italic>k</italic>. <xref ref-type="fig" rid="pcbi.1005700.g003">Fig 3C</xref> depicts three examples of genes with different ranks: TOP2A, ATP6V1D, and GNPDA1. For each gene the plot shows its −<italic>log</italic><sub>10</sub> p-value in each study, as well as the rank of the gene according to each of the methods. TOP2A was the top ranked gene in Fisher’s meta-anlaysis, but had much lower ranks in SCREEN-ind and SCREEN. ATP6V1D and GNPDA1, which were the top two genes of SCREEN and SCREEN-ind, respectively, had much lower ranks in Fisher’s meta-analysis. A comparison of the p-value patterns shows that ATP6V1D and GNPDA1 acheived higher rankings even though TOP2A had more extremely low p-values (e.g., &lt;10<sup>−20</sup>). These examples show that SCREEN highlighted genes that were differential consistently across many studies, whereas meta-analysis (as expected) was more sensitive to extremely low p-values. Moreover, the rank-based comparison to Fisher’s method shows that selection of genes in such datasets is not only a question of adjusting a threshold, as the gene ranks are very different.</p>
<fig id="pcbi.1005700.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005700.g003</object-id>
<label>Fig 3</label>
<caption>
<title>DEG dataset analysis.</title>
<p>A) The number of reported genes at 0.2 <italic>fdr</italic> by SCREEN and SCREEN-ind as a function of <italic>k</italic>. B) The Spearman correlation between gene ranking of SCREEN and SCREEN-ind and of Fisher’s meta-analysis as a function of <italic>k</italic>. C) The top ranked genes and their p-values. Top: the p-values of TOP2A, ATP6V1D, and GNPDA1 in each study. Bottom: the rank of these genes according to each of the methods (with k = 20 for SCREEN and SCREEN-ind). ATP6V1D has a very low rank according to Fisher’s meta-analysis even though it has consistently low p-values. D) Network analysis of the 147 genes reported by SCREEN with <italic>k</italic> = 20. Nodes are genes, and edges are either protein-protein interactions or known pathway interactions. The largest connected component is shown in detail, and the rest of the genes and their interactions are shown at the bottom left. For each gene we calculated the number of up- and down-regulated t-statistics with a p-value ≤ 0.01. Genes for which the ratio between the up- and down events was ≥ 3 (≤ 1/3) were considered consistently up-regulated (down-regulated) in cancer (red and green nodes, 99 and 18 genes, respectively). All other genes were considered as mixed (blue nodes, 30 genes). Oval nodes represent genes ranked among the top 200 genes according to Fisher’s meta-analysis (note that even at 10<sup>−5</sup> Bonferroni correction, more than 10,000 genes were selected in the meta-analysis, We therefore compared to the topmost genes, choosing the number 200 arbitrarily). Rectangular nodes are genes detected only by SCREEN.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.g003" xlink:type="simple"/>
</fig>
<p>Our discoveries above were based on genes with consistently low p-values in cancer studies. However, the analysis did not use the direction of the differential expression. To shed more light on the directionality we analyzed the 147 genes detected by SCREEN for <italic>k</italic> = 20. For each gene, we compared the times the reported t-statistic was negative and positive (corresponding to down- and up-regulation, respectively). Genes for which the number of negative values was at least thrice (respectively, at most one third of) the number of positive values were denoted as down-regulated (up-regulated). In total, there were 18 down-regulated and 99 up-regulated genes. The remaining 30 genes were denoted as mixed (see <xref ref-type="supplementary-material" rid="pcbi.1005700.s008">S8B Fig</xref>).</p>
<p>Using a network of protein-protein interactions and pathway interactions we plotted the subgraph induced by our 147 genes, see <xref ref-type="fig" rid="pcbi.1005700.g003">Fig 3D</xref>. Interestingly, the largest connected component was composed of 52 up-regulated genes and only a single down-regulated gene (KAT2B). Also, 88 out of 94 edges in the network connected up-regulated genes. Many of the genes in this “active” module were not ranked among the top 200 meta-analysis genes obtained using Fisher’s method, including genes that are well known to play major roles in cancer formation and progression. For example. CDK1 is a master regulator of cell division, and CKAP5 is important for cytoplasmic microtubule elongation and is known to be over-expressed in colonic and hepatic tumors [<xref ref-type="bibr" rid="pcbi.1005700.ref028">28</xref>–<xref ref-type="bibr" rid="pcbi.1005700.ref030">30</xref>]. Other important detected genes that were not among the top 200 meta-analysis genes were CDK1, MCM3, and MCM5. The most enriched GO term in the up-regulated gene set was mitotic cell cycle (38 genes, <italic>q</italic> &lt; 10<sup>−28</sup>) and the most enriched term in the active module was spindle organization (10 genes, <italic>q</italic> = 5.7 ⋅ 10<sup>−11</sup>).</p>
<p>In summary, our results show that SCREEN revealed a large gene set of consistently up-regulated genes in cancer that are highly relevant in function. On the other hand, while the results of the meta-analysis were also informative they are very sensitive to genes that achieve extreme p-values in one or a few studies and thus may down-weigh consistency. SCREEN was instrumental for separating the main up-regulated cancer genes that were consistent across most cancers, from other genes that manifested few tissue-specific strong effects.</p>
</sec>
<sec id="sec018">
<title>The HLA dataset</title>
<p>Shukla et al. [<xref ref-type="bibr" rid="pcbi.1005700.ref020">20</xref>] used RNA-seq data to perform differential expression analysis between cancer samples with somatic mutations in the HLA complex and samples without such mutations. The analysis was carried across 11 different TCGA studies, each of a different cancer subtype. The p-value matrix, taken from [<xref ref-type="bibr" rid="pcbi.1005700.ref020">20</xref>], had 18,128 rows (genes) and 11 columns. Similar to the Cancer DEG dataset, the p-values were based on a one-tail test for differential expression: p-values near zero represent up-regulation, and p-values near 1 represent down-regulation. Fisher’s method was used to assess the overall significance of a gene, and a total of 119 genes were selected using a p-value cutoff of 10<sup>−10</sup>.</p>
<p>We applied both SCREEN and SCREEN-ind on these data. Similarly to the DEG dataset, for <italic>k</italic> ≤ 3 more than 5000 genes had low <italic>fdr</italic>. However, here the number of genes decreased rapidly with <italic>k</italic> so that a few hundred were found for <italic>k</italic> = 4, and only a single gene was reported by SCREEN only for <italic>k</italic> ≥ 5 (<xref ref-type="supplementary-material" rid="pcbi.1005700.s007">S7 Fig</xref>). Unlike the DEG dataset, the overall correlation with Fisher’s meta-analysis was lower but the top ranked genes of SCREEN (TNNC2 and IFNG) had also very high ranks in Fisher’s method, see <xref ref-type="supplementary-material" rid="pcbi.1005700.s007">S7 Fig</xref>.</p>
<p>For <italic>k</italic> = 4 SCREEN reported many more genes than SCREEN-ind (405 vs. 135) genes, and both methods reported more genes than the original analysis (<xref ref-type="supplementary-material" rid="pcbi.1005700.s007">S7D Fig</xref>). When performing functional analysis of the 405 genes detected by SCREEN most genes were consistently up- (154) or down-regulated (199), and only 52 genes were mixed. In pathway enrichment analysis our detected gene sets obtained similar results to the original publication and extended them, see <xref ref-type="supplementary-material" rid="pcbi.1005700.s011">S1 Table</xref>. Importantly, we recapitulated the main discovery in [<xref ref-type="bibr" rid="pcbi.1005700.ref020">20</xref>] of up-regulation of multiple immune related processes. Unlike the original publication, our analysis detected enrichment for cancer related pathways in the down-regulated gene sets of SCREEN, including Wnt signaling (<italic>q</italic> = 0.02) and axon guidance (<italic>q</italic> = 0.04).</p>
<p>
<xref ref-type="fig" rid="pcbi.1005700.g004">Fig 4</xref> shows the largest connected component in the network induced by the up-regulated gene set. The network contains a few genes reported in the original study and many newly reported genes, which connect them into a single component. Unlike the DEG dataset, the main connected component contains both up-, down-, and mixed-regulation patterns, but the up-regulated genes form the backbone of the component and are responsible to most of the connecting links. By focusing on the up-regulated genes we detected an active module of genes involved in activation of immune response, anti-tumor activity, and T-cell activation. Many high degree nodes in the module, such as JAK2, were not reported in the original study. In summary, our results provide a comprehensive picture of the molecular response in patients with HLA mutations. SCREEN recapitulated the main findings obtained in the original study and revealed novel ones.</p>
<fig id="pcbi.1005700.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005700.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The largest connected component produced by the 405 genes reported by SCREEN in the HLA dataset.</title>
<p>Nodes are genes, and edges are either protein-protein interactions or known pathway interactions. Left: all genes in the component, including up-, down-regulated, and mixed genes. Right: the up-regulated genes only. This subnetwork suggests high activity of immune response (which was identified in the original study). Two central genes in the immune response are INFG and JAK2. Our analysis detected both, whereas the original study detected only IFNG. Moreover, the connectivity of the network is established by our newly detected genes.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.g004" xlink:type="simple"/>
</fig>
</sec>
</sec>
</sec>
<sec id="sec019" sec-type="conclusions">
<title>Discussion</title>
<p>We presented here several novel algorithms for detecting replicated associations using an empirical Bayes approach. Our main algorithm, called SCREEN, outperformed other approaches in many scenarios and had consistently low false discovery proportion and high true discovery rates in all simulations.</p>
<p>SCREEN works in three stages. First, it clusters the studies based on their pairwise correlations, which are learned via EM. Second, it performs replicability analysis within each cluster using our restricted EM approach. This method goes beyond previous studies by restricting the possible number of study configurations that are kept in memory. As a result, the method can analyze large study clusters, by computing an upper bound for the <italic>fdr</italic> instead of an exact estimation. Finally, the results of the replicability analyses of the clusters are merged using dynamic programming. For a given <italic>k</italic>, the output of SCREEN is the <italic>fdr</italic><sub><italic>k</italic></sub> value for each gene, which can be used to detect genes that are non-null in at least <italic>k</italic> studies.</p>
<p>We have shown that SCREEN performs well on various simulated scenarios, as well as on real datasets. Specifically, we analyzed two collections of cancer-related gene expression studies. In both cases the discovered gene sets highlighted active gene modules with pertinent functions.Such modules are revealed by the projection of the discovered genes on an interaction network and focusing on well-connected subnetworks. Notably, standard meta-analysis does not reveal many of the genes and generates more fragmented and less coherent subnetworks. For example, in the cancer DEG datasets, some of these genes are central in the network and are known master regulators of cell cycle (e.g., CDK1). In summary, we demonstrated replicability analysis as a standard tool for analyzing a large collection of studies, and provided novel algorithms that are accurate and scalable.</p>
<p>While the current version of SCREEN does not model the direction of the statistic directly (i.e., up- or down-regulation), we addressed this point empirically in our examples and showed that most genes were consistent in their direction. For the sake of functional analysis we required a gene to have the same direction in at least 75% of the studies. This threshold reflects a reasonable selection between the number of reported genes and the consistency requirement (see <xref ref-type="supplementary-material" rid="pcbi.1005700.s008">S8 Fig</xref>). Of course, users can change this threshold to require a higher (or lower) consistency in direction in specific applications. Also, note that detection of “mixed sign” genes is an important feature of our analysis: the causality of such genes is questioned as they likely represent downstream effects.</p>
<p>The strategy of SCREEN can be extended to a more complex definition of replicability across study clusters. For example, a researcher may seek genes that are replicable across one or more study clusters, where a gene is replicable in a cluster only if it is non-null in at least some predefined percentage of the studies in that cluster. See <xref ref-type="supplementary-material" rid="pcbi.1005700.s010">S1 Text</xref> for a discussion on this topic.</p>
<p>A variety of methods for integration of different studies have been developed in GWAS but their goals are different from SCREEN’s. These methods typically assume a standard meta-analysis null hypothesis that the effect size is zero across all studies [<xref ref-type="bibr" rid="pcbi.1005700.ref031">31</xref>]. As such, they do not address the question of replication directly even if a clustering of the studies is considered [<xref ref-type="bibr" rid="pcbi.1005700.ref032">32</xref>]. Moreover, some of the Bayesian approaches that were developed for GWAS utilize a subjective prior and do not estimate it form the data [<xref ref-type="bibr" rid="pcbi.1005700.ref033">33</xref>]. Finally, as we have shown, SCREEN outperforms repfdr, which was originally developed for GWAS data [<xref ref-type="bibr" rid="pcbi.1005700.ref009">9</xref>].</p>
<p>Our study has some limitations that can be addressed in future research. First, we assumed that genes are independent. This assumption is usually made by state of the art methods, but is often incorrect. In our case, it was used to obtain tractable algorithms (both the dynamic programming and the EM). Second, while our algorithms report <italic>fdr</italic><sub><italic>k</italic></sub> values of genes, we currently do not estimate their variance. Third, selection of <italic>k</italic> was done manually on real datasets based on the specific biological question and the number of reported genes (e.g., <xref ref-type="fig" rid="pcbi.1005700.g003">Fig 3A</xref>).</p>
<p>Fourth, our restricted EM approach to analyze study clusters is a heuristic that only guarantees convergence into a local optimum. Thus, while our algorithm has a deterministic starting point for the EM, setting starting points at random may change the obtained upper bounds for the <italic>fdr</italic>. Indeed, when we tried using random starting points, the set of reported genes in the cancer DEG dataset changed (by up to 50 genes, but still leaving over 80 genes from the original results), and no change was observed in the HLA dataset. Another important aspect of the heuristic is the number of allowed gene configurations. As an example, SCREEN with <italic>n</italic><sub><italic>H</italic></sub> = 10000 configurations on the cancer DEG dataset finds more than 100 additional genes for k = 20, whereas the <italic>fdr</italic> of the genes reported in our original analysis (<xref ref-type="fig" rid="pcbi.1005700.g004">Fig 4</xref>) is kept low, illustrating that the results are consistent (see <xref ref-type="supplementary-material" rid="pcbi.1005700.s009">S9 Fig</xref>).</p>
<p>Fifth, while our simple Exp-count approach to estimate the expected number of non-null realizations of a gene performed reasonably well in some simulated scenarios, it is only partially justified theoretically (see <xref ref-type="supplementary-material" rid="pcbi.1005700.s010">S1 Text</xref>). Finally, our methods rely on fixed estimates of the two-groups model of each study. Future methods could go a step further and estimate all parameters (i.e., both the study parameters and the gene configuration probabilities) in a single flow.</p>
</sec>
<sec id="sec020" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec021">
<title>Learning a two-groups model in each study</title>
<p>We tried two implementations of two-groups estimation algorithms. The first <italic>locfdr</italic> [<xref ref-type="bibr" rid="pcbi.1005700.ref022">22</xref>], provides two options to learn the empirical null: maximum likelihood and central matching. By default, we used the maximum likelihood estimator. However, in practice this algorithm might converge to a solution in which <inline-formula id="pcbi.1005700.e068"><alternatives><graphic id="pcbi.1005700.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e068" xlink:type="simple"/><mml:math display="inline" id="M68"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. Whenever this occured, we tried the central matching approach instead. If the new estimator also had <inline-formula id="pcbi.1005700.e069"><alternatives><graphic id="pcbi.1005700.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>π</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>0</mml:mn></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> we used the theoretical null.</p>
<p>The second approach was based on two previous methods: <italic>Znormix</italic> [<xref ref-type="bibr" rid="pcbi.1005700.ref034">34</xref>] and <italic>fdrtool</italic> [<xref ref-type="bibr" rid="pcbi.1005700.ref035">35</xref>]. Znormix uses EM to learn a mixture of Gaussians, whereas <italic>fdrtool</italic> assumes that the null distribution is a half normal distribution. Here, we applied an EM approach to the absolute values of the z-scores. We extended these methods by learning a mixture of a half normal with <italic>σ</italic> ≥ 1 for the null distribution, and a normal distribution with <italic>μ</italic> &gt; 0 for the non-nulls. We call this approach <italic>normix</italic>.</p>
<p>In practice, we discovered that our EM algorithm is sensitive to high values in the estimation of <italic>f</italic><sub>1</sub>. In addition, the methods above do not exploit additional information that could be obtained from the two-groups model: an estimation for the power of a study [<xref ref-type="bibr" rid="pcbi.1005700.ref019">19</xref>]. That is, this is a measure of how separated the two groups are. In our analyses, we took a very stringent approach: in each study we multiply <italic>f</italic><sub>1</sub>(<italic>z</italic>) by the estimated power of that study. The effect is a shrinkage in the <italic>f</italic><sub>1</sub>(<italic>z</italic>) values that is proportional to the estimated quality of the study.</p>
</sec>
<sec id="sec022">
<title>Clustering the studies</title>
<p>SCREEN relies on a known partition of the studies into clusters. In this section we use an empirical Bayes approach to obtain the clusters. Our analysis has two main parts: learning a network, and clustering.</p>
<p>First, we create a correlation network among the studies. For each study <italic>i</italic>, let <italic>a</italic><sub><italic>i</italic></sub> = <italic>P</italic>(<italic>h</italic><sub><italic>i</italic></sub> = 1) be the marginal non-null probability in that study. For studies <italic>i</italic>, <italic>j</italic> let <italic>a</italic><sub><italic>i</italic>,<italic>j</italic></sub> = <italic>P</italic>(<italic>h</italic><sub><italic>i</italic></sub> = 1 ∧ <italic>h</italic><sub><italic>j</italic></sub> = 1) be the shared non-null probability of the two studies. We estimate these parameters as follows: <italic>a</italic><sub><italic>i</italic></sub> and <italic>a</italic><sub><italic>j</italic></sub> are taken from the two-groups model of each study, and <italic>a</italic><sub><italic>i</italic>,<italic>j</italic></sub> is estimated by running our EM approach on the data of these two studies. The correlation of the studies is then estimated by:
<disp-formula id="pcbi.1005700.e070"><alternatives><graphic id="pcbi.1005700.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e070" xlink:type="simple"/><mml:math display="block" id="M70"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:msqrt><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We obtain a robust estimation of <italic>r</italic><sub><italic>i</italic>,<italic>j</italic></sub> by taking the mean of 100 bootstrap runs of the procedure above. That is, in each run we reestimate <italic>a</italic><sub><italic>i</italic>,<italic>j</italic></sub> by running the EM on a bootstrap sample of the genes (<italic>n</italic>/2 genes out of <italic>n</italic>, sampled with replacement).</p>
<p>Next, we cluster the network using the infomap algorithm [<xref ref-type="bibr" rid="pcbi.1005700.ref036">36</xref>]. Here, communities are detected using random walks in the underlying graph. As the input for this algorithm is an unweighted network, we used a threshold of 0.1 for the absolute correlation of study pairs to determine edge presence. This threshold is relatively low for general clustering tasks as it does not guarantee high homogeneity within clusters. However, it guarantees that the clusters discovered by SCREEN will be well-separated. In practice, our clustering approach found the correct clustering of studies in all simulations performed.</p>
</sec>
<sec id="sec023">
<title>Other multi-study analyses</title>
<p>In order to evaluate our <italic>fdr</italic> approaches we compared them to several extant methods for multi-study analysis. Here we outline them briefly.</p>
<sec id="sec024">
<title>Fisher’s meta-analysis</title>
<p>We used Fisher’s meta-analysis to merge the p-values of each gene into a single p-value. We then applied the BH FDR algorithm to account for multiple testing. Note that Fisher’s meta-analysis is not meant for replicability analysis and it does not take <italic>k</italic> as input. Nevertheless, we added it to the comparison due to its use in recent publications (e.g., [<xref ref-type="bibr" rid="pcbi.1005700.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1005700.ref037">37</xref>, <xref ref-type="bibr" rid="pcbi.1005700.ref038">38</xref>]).</p>
</sec>
<sec id="sec025">
<title>Counting-based BH analysis</title>
<p>Here we run the BH multiple testing correction algorithm in each study separately. For each gene we count the number of q-values lower than some predefined threshold. In this study we used a threshold of 0.1. We call this method BH-count.</p>
</sec>
<sec id="sec026">
<title>Counting-based tdr analysis</title>
<p>In this analysis, for each gene, we use the local true discovery rates (tdr) values obtained from the marginal two-groups model for each study. We then sum over these rates for the gene:
<disp-formula id="pcbi.1005700.e071"><alternatives><graphic id="pcbi.1005700.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005700.e071" xlink:type="simple"/><mml:math display="block" id="M71"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:munderover> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>h</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>|</mml:mo> <mml:msub><mml:mi>Z</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
This statistic can be interpreted as a biased estimator for the expected number of non-null realizations of gene <italic>i</italic>. See the <xref ref-type="supplementary-material" rid="pcbi.1005700.s010">S1 Text</xref> for more details. We call this method Exp-count.</p>
</sec>
</sec>
<sec id="sec027">
<title>Enrichment and network analysis</title>
<p>Network analysis and visualization was done in Cytoscape [<xref ref-type="bibr" rid="pcbi.1005700.ref039">39</xref>]. The GeneMANIA Cytoscape app [<xref ref-type="bibr" rid="pcbi.1005700.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1005700.ref041">41</xref>] was used to create the gene networks of the selected gene sets. GO enrichment analysis was performed using Expander [<xref ref-type="bibr" rid="pcbi.1005700.ref042">42</xref>].</p>
</sec>
<sec id="sec028">
<title>Availability</title>
<p>The datasets and an implementation of SCREEN are available in <xref ref-type="supplementary-material" rid="pcbi.1005700.s012">S1 Data</xref>.</p>
</sec>
</sec>
<sec id="sec029">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005700.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Simulation results: 20 independent studies with <italic>β</italic>(1,1000) non-null p-values.</title>
<p>A) locfdr, B) normix. The left column shows the empirical FDP. The right column shows the Jaccard scores only for methods that had a consistently low FDP values (&lt; 0.2) in each case and for all <italic>k</italic> values. These scores are calculated by comparing the output gene set of each method for each <italic>k</italic> to the set of genes for which the real number of non-nulls was at least <italic>k</italic>. SCREEN and SCREEN-ind (SCRN-ind) have identical results and achieve the top or almost top Jaccard for <italic>k</italic> ≤ 4.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Simulation results using locfdr and non-null distribution of <italic>β</italic>(1,100).</title>
<p>A) 20 independent studies. B) Four clusters of 10 studies each with a relatively low correlation within each cluster. C) Four clusters of 10 studies each with a relatively high correlation within each cluster. The left column shows the empirical FDP. The right column shows the Jaccard scores only for methods that had a consistently low FDP values (&lt; 0.2) in each case and for all <italic>k</italic> values. BH-count, SCREEN and SCREEN-ind (SCRN-ind for short) are the only methods that are shown on the right in all cases. BH-count had very low Jaccard scores. In A) SCREEN-ind had superior results. In B-C) Except for <italic>k</italic> = 2, SCREEN had similar or better performance compared to SCREEN-ind.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Simulation results: 20 independent studies with <italic>β</italic>(1,10) non-null p-values.</title>
<p>A) locfdr, B) normix. The left column shows the empirical FDP. The right column shows the Jaccard scores only for methods that had a consistently low FDP values (&lt; 0.2) in each case and for all <italic>k</italic> values. These scores are calculated by comparing the output gene set of each method for each <italic>k</italic> to the set of genes for which the real number of non-nulls was at least <italic>k</italic>. The Jaccard scores here are always very low, and the FDP scores of SCREEN and repfdr-UB might be high. However, when the FDP scores are high, very few genes are reported by SCREEN (≤ 4), whereas repfdr-UB might report ≥ 10 genes. Note that the scale of the Jaccard plots was cleaved to show the very low values.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>P-value histograms of all studies in the cancer DEG dataset.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>P-value histograms of all studies in the HLA dataset.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Inferred correlation networks among the DEG and HLA studies.</title>
<p>Left: inferred correlations. Right: binary correlation. Each point represents correlation with absolute value ≥ 0.1. Study names are colored by their cluster assignment.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s007" mimetype="image/jpeg" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>HLA dataset analysis.</title>
<p>A) The number of reported genes at 0.2 <italic>fdr</italic> by SCREEN and SCREEN-ind as a function of <italic>k</italic>. B) The Spearman correlation between gene ranking of SCREEN and SCREEN-ind and of Fisher’s meta-analysis as a function of <italic>k</italic>. C) The top ranked genes and their p-value in each study. Top: the p-values of TNNC2 and IFNG. Bottom: the rank of these genes according to each of the methods (with k = 4 for SCREEN and SCREEN-ind). Both genes are highly ranked by all methods. D) The number of genes reported by each method.</p>
<p>(JPG)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Differential expression direction analysis of the reported genes.</title>
<p>For each reported gene the fraction of datasets with a positive t-statistic is shown (out of the studies with <italic>p</italic> &lt; 0.01). Genes are ordered by the fraction. Red: genes up-regulated in 75% of the studies. Green: genes down-regulated in 75% of the studies. Blue: all other genes. A) HLA dataset, <italic>k</italic> = 4. B) Cancer DEG dataset, <italic>k</italic> = 20.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Effect of increasing the number of allowed configurations within SCREEN.</title>
<p>SCREEN was run with <italic>n</italic><sub><italic>H</italic></sub> = 10000 allowed configurations. The number of detected genes for <italic>k</italic> = 20 more than doubled. While new genes are detected, the genes reported using <italic>n</italic><sub><italic>H</italic></sub> = 1024 only (as in the main text) remain significant (except for 5 genes). The figure shows the distribution of local fdr values for all genes discovered on the cancer DEG dataset with <italic>n</italic><sub><italic>H</italic></sub> = 10000, split into those that were also significant using <italic>n</italic><sub><italic>H</italic></sub> = 1024 and the rest.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s010" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title/>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s011" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>The studies of the cancer DEG dataset.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005700.s012" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005700.s012" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>A zip file with the code of all methods and the matrices of the real datasets.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Part of the work was done while DA and RS were visiting the Simons Institute for the Theory of Computing.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005700.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McNutt</surname> <given-names>M</given-names></name>. <article-title>Reproducibility</article-title>. <source>Science (New York, NY)</source>. <year>2014</year>;<volume>343</volume>(<issue>6168</issue>):<fpage>229</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1250475" xlink:type="simple">10.1126/science.1250475</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Camerer</surname> <given-names>CF</given-names></name>, <name name-style="western"><surname>Dreber</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Forsell</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ho</surname> <given-names>Th</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kirchler</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Evaluating replicability of laboratory experiments in economics</article-title>. <source>Science</source>. <year>2016</year>;<volume>351</volume>:<fpage>1433</fpage>–<lpage>1436</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.aaf0918" xlink:type="simple">10.1126/science.aaf0918</ext-link></comment> <object-id pub-id-type="pmid">26940865</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Braver</surname> <given-names>S</given-names></name>. <article-title>Continuously cumulating meta-analysis and replicability</article-title>. <source>Perspectives on Psychological Science on Psychological Science</source>. <year>2014</year>;<volume>9</volume>(<issue>3</issue>):<fpage>333</fpage>–<lpage>342</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/1745691614529796" xlink:type="simple">10.1177/1745691614529796</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ioannidis</surname> <given-names>JPA</given-names></name>. <article-title>Why most published research findings are false</article-title>. <source>PLoS Medicine</source>. <year>2005</year>;<volume>2</volume>:<fpage>696</fpage>–<lpage>701</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pmed.0020124" xlink:type="simple">10.1371/journal.pmed.0020124</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wirapati</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sotiriou</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kunkel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Farmer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Pradervand</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Haibe-Kains</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Meta-analysis of gene expression profiles in breast cancer: Toward a unified understanding of breast cancer subtyping and prognosis signatures</article-title>. <source>Breast Cancer Research: BCR</source>. <year>2008</year>;<volume>10</volume>(<issue>4</issue>):<fpage>R65</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/bcr2124" xlink:type="simple">10.1186/bcr2124</ext-link></comment> <object-id pub-id-type="pmid">18662380</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Laas</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Mallon</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Duhoux</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Hamidouche</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rouzier</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Reyal</surname> <given-names>F</given-names></name>. <article-title>Low concordance between gene expression signatures in ER positive HER2 negative breast carcinoma could impair their clinical application</article-title>. <source>PLoS ONE</source>. <year>2016</year>;<volume>11</volume>(<issue>2</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0148957" xlink:type="simple">10.1371/journal.pone.0148957</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Verleyen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Ballouz</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gillis</surname> <given-names>J</given-names></name>. <article-title>Positive and negative forms of replicability in gene network analysis</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>32</volume>:<fpage>1065</fpage>–<lpage>1073</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv734" xlink:type="simple">10.1093/bioinformatics/btv734</ext-link></comment> <object-id pub-id-type="pmid">26668004</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Heller</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yekutieli</surname> <given-names>D</given-names></name>. <article-title>Selective inference in complex research</article-title>. <source>Philosophical transactions Series A, Mathematical, physical, and engineering sciences</source>. <year>2009</year>;<volume>367</volume>:<fpage>4255</fpage>–<lpage>4271</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rsta.2009.0127" xlink:type="simple">10.1098/rsta.2009.0127</ext-link></comment> <object-id pub-id-type="pmid">19805444</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Heller</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Yekutieli</surname> <given-names>D</given-names></name>. <article-title>Replicability analysis for genome-wide association studies</article-title>. <source>Ann Appl Stat</source>. <year>2014</year>;<volume>8</volume>(<issue>1</issue>):<fpage>481</fpage>–<lpage>498</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/13-AOAS697" xlink:type="simple">10.1214/13-AOAS697</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hedges</surname> <given-names>LV</given-names></name>, <name name-style="western"><surname>Olkin</surname> <given-names>I</given-names></name>. <article-title>Statistical methods for meta-analysis</article-title>. <source>Journal of Educational Statistics</source>. <volume>20</volume>(<issue>1</issue>); <year>1985</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005700.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chang</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Sibille</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Tseng</surname> <given-names>GC</given-names></name>. <article-title>Meta-analysis methods for combining multiple expression profiles: comparisons, statistical characterization and an application guideline</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>368</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-14-368" xlink:type="simple">10.1186/1471-2105-14-368</ext-link></comment> <object-id pub-id-type="pmid">24359104</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Ghosh</surname> <given-names>D</given-names></name>. <article-title>Meta-analysis based on weighted ordered P-values for genomic data with heterogeneity</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>(<issue>1</issue>):<fpage>226</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-15-226" xlink:type="simple">10.1186/1471-2105-15-226</ext-link></comment> <object-id pub-id-type="pmid">24972803</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zeggini</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Weedon</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Lindgren</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Frayling</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Elliott</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Lango</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Replication of genome-wide association signals in UK samples reveals risk loci for type 2 diabetes</article-title>. <source>Science (New York, NY)</source>. <year>2007</year>;<volume>316</volume>(<issue>5829</issue>):<fpage>1336</fpage>–<lpage>41</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1142364" xlink:type="simple">10.1126/science.1142364</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kraft</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Zeggini</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ioannidis</surname> <given-names>JPa</given-names></name>. <article-title>Replication in Genome-Wide Association Studies</article-title>. <source>Statistical Science</source>. <year>2009</year>;<volume>24</volume>(<issue>4</issue>):<fpage>561</fpage>–<lpage>573</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/09-STS290" xlink:type="simple">10.1214/09-STS290</ext-link></comment> <object-id pub-id-type="pmid">20454541</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Heller</surname> <given-names>R</given-names></name>. <article-title>Screening for partial conjunction hypotheses</article-title>. <source>Biometrics</source>. <year>2008</year>;<volume>64</volume>(<issue>4</issue>):<fpage>1215</fpage>–<lpage>1222</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1541-0420.2007.00984.x" xlink:type="simple">10.1111/j.1541-0420.2007.00984.x</ext-link></comment> <object-id pub-id-type="pmid">18261164</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Hochberg</surname> <given-names>Y</given-names></name>. <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>Journal of the Royal Statistical Society B</source>. <year>1995</year>;<volume>57</volume>(<issue>1</issue>):<fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005700.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Heller</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bogomolov</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>. <article-title>Deciding whether follow-up studies have replicated findings in a preliminary large-scale omics study</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2014</year>;<volume>111</volume>:<fpage>16262</fpage>–<lpage>16267</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1314814111" xlink:type="simple">10.1073/pnas.1314814111</ext-link></comment> <object-id pub-id-type="pmid">25368172</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Song</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tseng</surname> <given-names>GC</given-names></name>. <article-title>Hypothesis setting and order statistic for robust genomic meta-analysis</article-title>. <source>Annals of Applied Statistics</source>. <year>2014</year>;<volume>8</volume>(<issue>2</issue>):<fpage>777</fpage>–<lpage>800</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/13-AOAS683" xlink:type="simple">10.1214/13-AOAS683</ext-link></comment> <object-id pub-id-type="pmid">25383132</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Efron</surname> <given-names>B</given-names></name>. <source>Large-scale inference: Empirical Bayes methods for estimation, testing, and prediction</source>. <publisher-name>Institute of Mathematical Statistics monographs</publisher-name>. <publisher-loc>Cambridge</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>; <year>2010</year>.</mixed-citation>
</ref>
<ref id="pcbi.1005700.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shukla</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Rooney</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Rajasagi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tiao</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Dixon</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>MS</given-names></name>, <etal>et al</etal>. <article-title>Comprehensive analysis of cancer-associated somatic mutations in class I HLA genes</article-title>. <source>Nature Biotechnology</source>. <year>2015</year>;<volume>33</volume>:<fpage>1152</fpage>–<lpage>1158</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.3344" xlink:type="simple">10.1038/nbt.3344</ext-link></comment> <object-id pub-id-type="pmid">26372948</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>. <article-title>The optimal discovery procedure: A new approach to simultaneous significance testing</article-title>. <source>Journal of the Royal Statistical Society. Series B: Statistical Methodology</source>. <year>2007</year>;<volume>69</volume>:<fpage>347</fpage>–<lpage>368</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-9868.2007.005592.x" xlink:type="simple">10.1111/j.1467-9868.2007.005592.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Efron</surname> <given-names>B</given-names></name>. <article-title>Large-scale simultaneous hypothesis testing: The choice of a null hypothesis</article-title>. <source>Journal of the American Statistical Association</source>. <year>2004</year>;<volume>99</volume>(<issue>465</issue>):<fpage>96</fpage>–<lpage>104</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/016214504000000089" xlink:type="simple">10.1198/016214504000000089</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Efron</surname> <given-names>B</given-names></name>. <article-title>Correlation and large-scale simultaneous significance testing</article-title>. <source>Journal of the American Statistical Association</source>. <year>2007</year>;<volume>102</volume>(<issue>477</issue>):<fpage>93</fpage>–<lpage>103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/016214506000001211" xlink:type="simple">10.1198/016214506000001211</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Efron</surname> <given-names>B</given-names></name>. <article-title>Empirical Bayes estimates for large-scale prediction problems</article-title>. <source>Journal of the American Statistical Association</source>. <year>2009</year>;<volume>104</volume>(<issue>487</issue>):<fpage>1015</fpage>–<lpage>1028</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/jasa.2009.tm08523" xlink:type="simple">10.1198/jasa.2009.tm08523</ext-link></comment> <object-id pub-id-type="pmid">20333278</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yekutieli</surname> <given-names>D</given-names></name>. <article-title>repfdr: a tool for replicability analysis for genome-wide association studies</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2014</year>;<volume>30</volume>:<fpage>2971</fpage>–<lpage>2972</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu434" xlink:type="simple">10.1093/bioinformatics/btu434</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Amar</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hait</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Izraeli</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Shamir</surname> <given-names>R</given-names></name>. <article-title>Integrated analysis of numerous heterogeneous gene expression profiles for detecting robust disease-specific biomarkers and proposing drug targets</article-title>. <source>Nucleic Acids Research</source>. <year>2015</year>;<volume>43</volume>(<issue>16</issue>):<fpage>7779</fpage>–<lpage>7789</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkv810" xlink:type="simple">10.1093/nar/gkv810</ext-link></comment> <object-id pub-id-type="pmid">26261215</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barrett</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Wilhite</surname> <given-names>SE</given-names></name>, <name name-style="western"><surname>Ledoux</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Evangelista</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>IF</given-names></name>, <name name-style="western"><surname>Tomashevsky</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>NCBI GEO: Archive for functional genomics data sets—Update</article-title>. <source>Nucleic Acids Research</source>. <year>2013</year>;<volume>41</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gks1193" xlink:type="simple">10.1093/nar/gks1193</ext-link></comment> <object-id pub-id-type="pmid">23193258</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Charrasse</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mazel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Taviaux</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Berta</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Larroque</surname> <given-names>C</given-names></name>. <article-title>Characterization of the cDNA and pattern of expression of a new gene over-expressed in human hepatomas and colonic tumors</article-title>. <source>European Journal of Biochemistry / FEBS</source>. <year>1995</year>;<volume>234</volume>:<fpage>406</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1432-1033.1995.406_b.x" xlink:type="simple">10.1111/j.1432-1033.1995.406_b.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Enserink</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Kolodner</surname> <given-names>RD</given-names></name>. <article-title>An overview of Cdk1-controlled targets and processes</article-title>. <source>Cell Division</source>. <year>2010</year>;<volume>5</volume>:<fpage>11</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1747-1028-5-11" xlink:type="simple">10.1186/1747-1028-5-11</ext-link></comment> <object-id pub-id-type="pmid">20465793</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Royle</surname> <given-names>SJ</given-names></name>. <article-title>The role of clathrin in mitotic spindle organisation</article-title>. <source>Journal of Cell Science</source>. <year>2012</year>;<volume>125</volume>:<fpage>19</fpage>–<lpage>28</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1242/jcs.094607" xlink:type="simple">10.1242/jcs.094607</ext-link></comment> <object-id pub-id-type="pmid">22294613</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Evangelou</surname> <given-names>E</given-names></name>, and <name name-style="western"><surname>Ioannidis</surname> <given-names>J P A</given-names></name>. <article-title>Meta-analysis methods for genome-wide association studies and beyond</article-title>. <source>Nature Reviews Genetics</source>. <year>2013</year>;<volume>14</volume>:<fpage>379</fpage>–<lpage>389</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg3472" xlink:type="simple">10.1038/nrg3472</ext-link></comment> <object-id pub-id-type="pmid">23657481</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Morris</surname> <given-names>AP</given-names></name>. <article-title>Transethnic meta-analysis of genomewide association studies</article-title>. <source>Genetic Epidemiology</source>. <year>2011</year>;<volume>35</volume>:<fpage>809</fpage>–<lpage>822</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/gepi.20630" xlink:type="simple">10.1002/gepi.20630</ext-link></comment> <object-id pub-id-type="pmid">22125221</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>J</given-names></name>, and <name name-style="western"><surname>Lee</surname> <given-names>SH</given-names></name>, <name name-style="western"><surname>Goddard</surname> <given-names>ME</given-names></name>, and <name name-style="western"><surname>Visscher</surname> <given-names>PM</given-names></name>. <article-title>GCTA: A tool for genome-wide complex trait analysis</article-title>. <source>American Journal of Human Genetics</source>. <year>2011</year>;<volume>88</volume>:<fpage>76</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.ajhg.2010.11.011" xlink:type="simple">10.1016/j.ajhg.2010.11.011</ext-link></comment> <object-id pub-id-type="pmid">21167468</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McLachlan</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Bean</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Jones</surname> <given-names>LBT</given-names></name>. <article-title>A simple implementation of a normal mixture approach to differential gene expression in multiclass microarrays</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>13</issue>):<fpage>1608</fpage>–<lpage>1615</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl148" xlink:type="simple">10.1093/bioinformatics/btl148</ext-link></comment> <object-id pub-id-type="pmid">16632494</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Strimmer</surname> <given-names>K</given-names></name>. <article-title>A unified approach to false discovery rate estimation</article-title>. <source>BMC Bioinformatics</source>. <year>2008</year>;<volume>9</volume>(<issue>1</issue>):<fpage>303</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-9-303" xlink:type="simple">10.1186/1471-2105-9-303</ext-link></comment> <object-id pub-id-type="pmid">18613966</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosvall</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bergstrom</surname> <given-names>CT</given-names></name>. <article-title>An information-theoretic framework for resolving community structure in complex networks</article-title>. <source>PNAS</source>. <year>2007</year>;<volume>104</volume>:<fpage>7327</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0611034104" xlink:type="simple">10.1073/pnas.0611034104</ext-link></comment> <object-id pub-id-type="pmid">17452639</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schunkert</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>König</surname> <given-names>IR</given-names></name>, <name name-style="western"><surname>Kathiresan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Reilly</surname> <given-names>MP</given-names></name>, <name name-style="western"><surname>Assimes</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Holm</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Large-scale association analysis identifies 13 new susceptibility loci for coronary artery disease</article-title>. <source>Nature Genetics</source>. <year>2011</year>;<volume>43</volume>:<fpage>333</fpage>–<lpage>338</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ng.784" xlink:type="simple">10.1038/ng.784</ext-link></comment> <object-id pub-id-type="pmid">21378990</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kaever</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Landesfeind</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Feussner</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Morgenstern</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Feussner</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Meinicke</surname> <given-names>P</given-names></name>. <article-title>Meta-analysis of pathway enrichment: Combining independent and dependent omics data sets</article-title>. <source>PLoS ONE</source>. <year>2014</year>;<volume>9</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0089297" xlink:type="simple">10.1371/journal.pone.0089297</ext-link></comment> <object-id pub-id-type="pmid">24586671</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shannon</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Markiel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ozier</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Baliga</surname> <given-names>NS</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Ramage</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Cytoscape: A software environment for integrated models of biomolecular interaction networks</article-title>. <source>Genome Research</source>. <year>2003</year>;<volume>13</volume>(<issue>11</issue>):<fpage>2498</fpage>–<lpage>2504</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.1239303" xlink:type="simple">10.1101/gr.1239303</ext-link></comment> <object-id pub-id-type="pmid">14597658</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Montojo</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zuberi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kazi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Donaldson</surname> <given-names>SL</given-names></name>, <etal>et al</etal>. <article-title>GeneMANIA cytoscape plugin: Fast gene function predictions on the desktop</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>:<fpage>2927</fpage>–<lpage>2928</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btq562" xlink:type="simple">10.1093/bioinformatics/btq562</ext-link></comment> <object-id pub-id-type="pmid">20926419</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005700.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vlasblom</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zuberi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Arnold</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gagarinova</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Deineko</surname> <given-names>V</given-names></name>, <etal>et al</etal>. <article-title>Novel function discovery with GeneMANIA: a new integrated resource for gene function prediction in Escherichia coli</article-title>. <source>Bioinformatics (Oxford, England)</source>. <year>2014</year>; p. <fpage>1</fpage>–<lpage>5</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005700.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ulitsky</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Maron-Katz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shavit</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sagir</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Linhart</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Elkon</surname> <given-names>R</given-names></name>, <etal>et al</etal>. <article-title>Expander: from expression microarrays to networks and functions</article-title>. <source>Nature Protocols</source>. <year>2010</year>;<volume>5</volume>:<fpage>303</fpage>–<lpage>322</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nprot.2009.230" xlink:type="simple">10.1038/nprot.2009.230</ext-link></comment> <object-id pub-id-type="pmid">20134430</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>