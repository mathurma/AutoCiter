<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-18-01753</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1007043</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Neurology</subject><subj-group><subject>Neurodegenerative diseases</subject><subj-group><subject>Movement disorders</subject><subj-group><subject>Parkinson disease</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Statistical distributions</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject><subj-group><subject>Normal distribution</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kalman filter</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kalman filter</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Decision making</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Hierarchical Bayesian inference for concurrent model fitting and comparison for group studies</article-title>
<alt-title alt-title-type="running-head">Hierarchical Bayesian inference</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8100-6628</contrib-id>
<name name-style="western">
<surname>Piray</surname> <given-names>Payam</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dezfouli</surname> <given-names>Amir</given-names></name>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3398-5235</contrib-id>
<name name-style="western">
<surname>Heskes</surname> <given-names>Tom</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Frank</surname> <given-names>Michael J.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5029-1430</contrib-id>
<name name-style="western">
<surname>Daw</surname> <given-names>Nathaniel D.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Princeton Neuroscience Institute, Princeton University, Princeton, New Jersey, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Data61, CSIRO, Sydney, Australia</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Institute for Computing and Information Sciences, Radboud University, the Netherlands</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Department of Cognitive, Linguistics, and Psychological Sciences, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Berry</surname> <given-names>Hugues</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Inria, FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>NO authors have competing interests.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">ppiray@princeton.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>6</month>
<year>2019</year>
</pub-date>
<pub-date pub-type="epub">
<day>18</day>
<month>6</month>
<year>2019</year>
</pub-date>
<volume>15</volume>
<issue>6</issue>
<elocation-id>e1007043</elocation-id>
<history>
<date date-type="received">
<day>16</day>
<month>10</month>
<year>2018</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>4</month>
<year>2019</year>
</date>
</history>
<permissions>
<copyright-year>2019</copyright-year>
<copyright-holder>Piray et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1007043"/>
<abstract>
<p>Computational modeling plays an important role in modern neuroscience research. Much previous research has relied on statistical methods, separately, to address two problems that are actually interdependent. First, given a particular computational model, Bayesian hierarchical techniques have been used to estimate individual variation in parameters over a population of subjects, leveraging their population-level distributions. Second, candidate models are themselves compared, and individual variation in the expressed model estimated, according to the fits of the models to each subject. The interdependence between these two problems arises because the relevant population for estimating parameters of a model depends on which other subjects express the model. Here, we propose a hierarchical Bayesian inference (HBI) framework for concurrent model comparison, parameter estimation and inference at the population level, combining previous approaches. We show that this framework has important advantages for both parameter estimation and model comparison theoretically and experimentally. The parameters estimated by the HBI show smaller errors compared to other methods. Model comparison by HBI is robust against outliers and is not biased towards overly simplistic models. Furthermore, the fully Bayesian approach of our theory enables researchers to make inference on group-level parameters by performing HBI t-test.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Computational modeling of brain and behavior plays an important role in modern neuroscience research. By deconstructing mechanisms of behavior and quantifying parameters of interest, computational modeling helps researchers to study brain-behavior mechanisms. In neuroscience studies, a dataset includes a number of samples, and often the question of interest is to characterize parameters of interest in a population: Do patients with attention-deficit hyperactive disorders exhibit lower learning rate than the general population? Do cognitive enhancers, such as Ritalin, enhance parameters influencing decision making? The success of these efforts heavily depends on statistical methods making inference about validity and robustness of estimated parameters, as well as generalizability of computational models. In this work, we present a novel method, hierarchical Bayesian inference, for concurrent model comparison, parameter estimation and inference at the population level. We show, both theoretically and experimentally, that our approach has important advantages over previous methods. The proposed method has implications for computational modeling research in group studies across many areas of psychology, neuroscience, and psychiatry.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000026</institution-id>
<institution>National Institute on Drug Abuse</institution>
</institution-wrap>
</funding-source>
<award-id>1R01DA038891</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5029-1430</contrib-id>
<name name-style="western">
<surname>Daw</surname> <given-names>Nathaniel D.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>We acknowledge support from NIDA through grant R01DA038891, part of the CRCNS program (N.D.D). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="14"/>
<table-count count="0"/>
<page-count count="34"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The method described in this paper is freely available online as part of the computational/behavioral modeling (cbm) toolbox: <ext-link ext-link-type="uri" xlink:href="https://payampiray.github.io/cbm" xlink:type="simple">https://payampiray.github.io/cbm</ext-link>. Simulation analysis codes and data are available here: <ext-link ext-link-type="uri" xlink:href="https://github.com/payampiray/piray_etal_2019_ploscb" xlink:type="simple">https://github.com/payampiray/piray_etal_2019_ploscb</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Across different areas of neuroscience, researchers increasingly employ computational models for experimental data analysis. For example, decision neuroscientists use reinforcement learning (RL) and economic models of choice to analyze behavioral and brain imaging data in reward learning and decision-making tasks [<xref ref-type="bibr" rid="pcbi.1007043.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref002">2</xref>]. The field of computational psychiatry uses these models to characterize patients and people at the risk of brain disorders [<xref ref-type="bibr" rid="pcbi.1007043.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1007043.ref006">6</xref>]. Neuroimaging studies use models of neural interaction, such as dynamic causal modeling [<xref ref-type="bibr" rid="pcbi.1007043.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref008">8</xref>], as well as abstract models to analyze brain signals [<xref ref-type="bibr" rid="pcbi.1007043.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref009">9</xref>]. The success of these efforts heavily depends on statistical methods making inference about validity and robustness of estimated parameters across individuals, as well as making inference on validity and generalizability of computational models. A key theoretical and practical issue has been capturing individual variation both in a model’s parameters and additionally in which of several candidate models a subject expresses, which may also vary from subject to subject.</p>
<p>Computational models usually rely on free parameters, such as learning rate in RL models, which often capture quantities of scientific interest but typically vary across individuals and must be estimated from data. A dataset includes a number of subjects, and often the question of interest is to characterize parameters in a population: Is choice consistency altered in patients with attention-deficit hyperactive disorders? Do cognitive enhancers, such as Ritalin, enhance the learning rate at the population level? These questions are most naturally framed in terms of hierarchical models, which characterize both the population distributions over a model’s parameters and also each individual subject’s parameters given the population distribution. Since these two levels are mutually interrelated, they are often estimated simultaneously, using methods like expectation maximization or sampling (MCMC). For example, the hierarchical parameter estimation (HPE) procedure [<xref ref-type="bibr" rid="pcbi.1007043.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref011">11</xref>] regularizes individual estimates according to group statistics, producing better individual estimates and permitting reliable group-level tests. Because subjects typically share underlying structure, hierarchical Bayesian approaches can leverage this structure to yield better individual estimates and to provide better predictions for unseen data, compared to approaches that fit each subject separately [<xref ref-type="bibr" rid="pcbi.1007043.ref012">12</xref>].</p>
<p>A second, and seemingly logically prior, question is which of several candidate models provides the best explanation for the data. This is important both for providing the setting within which to do parameter estimation, and also for investigating questions of scientific interest. Are rodents’ reaction times best explained by independent or competing accumulators? Do compulsive gamblers rely more on model-free RL compared to controls? Importantly, in principle (and apparently in practice) the model expressed might also vary from subject to subject; thus modern model comparison techniques rely on estimating which of several models obtains for each subject [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>]. Estimating such variation is important since the prior assumption that the same model obtains across all individuals (treating model identity as a fixed effect) is a very strong (and in most cases potentially unwarranted) assumption, which makes model comparison very sensitive to outliers [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>]. To estimate this variation, in turn, depends on the likelihood of each subject’s data given each model (and, thus, on each subject’s parameters for each model).</p>
<p>Intuitively, evaluating whether a model is a good model for a subject’s data precedes estimation of its specific parameter values; and indeed, previous research has used separate tools to solve these two problems. But statistically, the two questions are actually interconnected, because individual parameters and hence individual fit depend on which subjects belong to the population that expresses the model. Here, we address this challenge from a fully Bayesian viewpoint. This work addresses issues of statistical inference over both parameters and models, which have remained elusive with the previous hierarchical methods.</p>
<p>Notably, although it is accepted (for the reasons discussed above) that the best-fitting model may vary from subject to subject, hierarchical parameter estimation (conducted separately) has typically assumed that the given model is expressed over all subjects, i.e. that it is a fixed effect (and if multiple models are compared, these are each fit to the entire population). This assumption biases parameter estimation, at both individual and group levels, because it entails that the estimated parameters for each individual subject equally affect group-level estimates, even though some members of the population may be better understood as expressing altogether different models. This same bias, in turn, affects the estimation of which subjects are best fit by each model.</p>
<p>In this work, we introduce a hierarchical and Bayesian inference method, which solves these problems by addressing both model fitting and model comparison within the same framework using variational techniques. Furthermore, our fully Bayesian approach enables us to assess uncertainty and provide a rigorous statistical test, HBI t-test, for making inference about parameters of a model at the population level, an issue that has not been addressed in some previous hierarchical models. This paper is structured as follows. First, we highlight the main theoretical advances in our approach. A full formal treatment is given in <xref ref-type="sec" rid="sec018">Materials and methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1007043.s004">S1 Appendix</xref>. We then apply the proposed method to synthetic choice datasets as well as empirical datasets to demonstrate its advantages over previous methods.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Theoretical results</title>
<p>Consider a typical computational modeling study in which data of a group of subjects have been measured and a set of candidate models are considered as possible underlying computational mechanisms generating those data. Such studies have generally two main goals: 1) to compare model evidence across competing models; 2) to estimate free parameters of models for each individual and their group-level distributions. All this is typically characterized in terms of inference in a hierarchically structured model of the data, which captures how each subject’s observations depend on their parameters and the individual parameters on their group distribution.</p>
<p>The HPE procedure [<xref ref-type="bibr" rid="pcbi.1007043.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref011">11</xref>] employs a hierarchical approach to define the priors based on statistics of the group. This method typically assumes that for a particular model <italic>k</italic>, all individual parameters are normally distributed,
<disp-formula id="pcbi.1007043.e001"><alternatives><graphic id="pcbi.1007043.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold">V</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <bold>h</bold><sub><italic>kn</italic></sub> is a vector of the free parameters of the <italic>k</italic>th model for subject <italic>n</italic>, <italic><bold>μ</bold></italic><sub><italic>k</italic></sub> and <bold>V</bold><sub><italic>k</italic></sub> are the mean and variance parameters, respectively, indicating the prior distribution over <bold>h</bold><sub><italic>kn</italic></sub>.</p>
<p>It is important to distinguish the statistical model itself from the algorithms or approximations used to estimate it. HPE uses the expectation-maximization algorithm [<xref ref-type="bibr" rid="pcbi.1007043.ref014">14</xref>], a well-known iterative procedure, for obtaining estimating group parameters <italic><bold>μ</bold></italic><sub><italic>k</italic></sub> and <bold>V</bold><sub><italic>k</italic></sub> and individual parameters <bold>h</bold><sub><italic>kn</italic></sub>. Every iteration of this algorithm alternates two steps: 1) an expectation step in which the individual parameters are estimated in light of the group-level distribution; and 2) a maximization step in which the group parameters, <italic><bold>μ</bold></italic><sub><italic>k</italic></sub> and <bold>V</bold><sub><italic>k</italic></sub>, are updated given the current estimates of the individual parameters. Importantly, reflecting the assumption that all subjects express model <italic>k</italic>, this update weights the individual subjects’ estimates equally; for instance, the update for <italic><bold>μ</bold></italic><sub><italic>k</italic></sub> is given by the average of subject level mean estimates (denoted <italic><bold>θ</bold></italic><sub><italic>kn</italic></sub>) across all subjects:
<disp-formula id="pcbi.1007043.e002"><alternatives><graphic id="pcbi.1007043.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>N</mml:mi></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>N</italic> is the number of subjects.</p>
<p>Although HPE characterizes variation across subjects in the model parameters <bold>h</bold><sub><italic>kn</italic></sub> (that is, it treats those parameters as random effects), a critical assumption of the procedure is that the parameters for model <italic>k</italic> are estimated assuming that the same model is responsible for generating data in all subjects. That is, the model identity is taken as a fixed effect, in contrast to the random effects approach that assumes different models might be responsible for generating data in different subjects. The fixed effects assumption has two important implications: 1) for parameter estimation, group parameters, the group mean <italic><bold>μ</bold></italic><sub><italic>k</italic></sub> and variance <bold>V</bold><sub><italic>k</italic></sub>, are influenced equally by all subjects, even those who would be better fit by some other candidate model <italic>j</italic> ≠ <italic>k</italic>; 2) for model comparison, the straightforward procedure (e.g. iBIC from [<xref ref-type="bibr" rid="pcbi.1007043.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref011">11</xref>]) is to compare models according to the sum of individual model evidences over all subjects, i.e. again treating the model identity as a fixed effect. Note that while it is possible to submit individual model evidence values (per subject and model) derived from HPE to a separate model comparison procedure that treats model identity as a random effect (such as random effects model selection [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>]), these will be biased both from having been fit under the fixed effects assumption and also due to the optimization of the free group-level parameters. For this reason, HPE has typically been accompanied by fixed-effects model comparison [<xref ref-type="bibr" rid="pcbi.1007043.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref015">15</xref>], whereas attempts to study subject-subject variation in model identity [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>] have typically been conducted using a different, non-hierarchical parameter estimation procedure. Altogether, violations of the fixed effects assumption can adversely influence both parameter estimation and model comparison.</p>
<p>Here, we extend HPE’s generative model with another level of the hierarchy, specifying for each subject which model generated their data. This is governed by a subject-specific multinomial random variable, itself drawn from a distribution controlling the proportion of each model in the population. This, in effect, merges the Bayesian model selection model from Stephan et al. [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>] with HPE. To accomplish inference in this model, we then lay out a procedure for joint inference over model identities and parameters, including quantifying the probability that each model is responsible for generating data for each subject. To achieve this goal, we adopt a fully Bayesian framework in which the group parameters for each model, <italic><bold>μ</bold></italic><sub><italic>k</italic></sub> and <bold>V</bold><sub><italic>k</italic></sub>, are also random variables. This also gives us a straightforward way to quantify the level of certainty in group-level estimations. We use mean-field variational Bayes [<xref ref-type="bibr" rid="pcbi.1007043.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref017">17</xref>], an extension of expectation-maximization [<xref ref-type="bibr" rid="pcbi.1007043.ref018">18</xref>], which is able to deal with multiple latent variables in a probabilistic model. Since HBI is a mean-field variational framework, the resulting algorithm (see <xref ref-type="sec" rid="sec018">Materials and methods</xref>) is an iterative algorithm. On every iteration, the HBI performs 4 steps: calculates the summary statistics, updates its estimates of the posterior over group parameters, updates its estimate of the posterior over each individual parameter and finally updates its estimates of responsibility of each model in generating each individual data. The algorithm and other important mathematical issues are given in <xref ref-type="sec" rid="sec018">Materials and methods</xref>. Here, we highlight three main results. The mathematical proofs are given in <xref ref-type="supplementary-material" rid="pcbi.1007043.s004">S1 Appendix</xref>.</p>
<p>As noted above, the HBI method estimates the probability of each subject’s dataset being generated by each model, or the responsibility of model <italic>k</italic> for generating data for subject <italic>n</italic>, <italic>r</italic><sub><italic>kn</italic></sub>, which is expressed as (expected) probability. Larger values of <italic>r</italic><sub><italic>kn</italic></sub> (i.e. close to 1) indicate that model <italic>k</italic> is likely to be the true underlying model of the <italic>n</italic>th subject. In contrast, smaller values of <italic>r</italic><sub><italic>kn</italic></sub> (close to 0) indicate that model <italic>k</italic> is unlikely to be the underlying model for the <italic>n</italic>th subject. Based on the responsibilities, it is then possible to estimate the number of subjects explained by each model, <inline-formula id="pcbi.1007043.e003"><alternatives><graphic id="pcbi.1007043.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1007043.e004"><alternatives><graphic id="pcbi.1007043.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mspace width="1.111pt"/><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="1.111pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>N</mml:mi></mml:munderover> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Thus <inline-formula id="pcbi.1007043.e005"><alternatives><graphic id="pcbi.1007043.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is always less than the number of subjects and indexes the predominance of model <italic>k</italic> in the population. Furthermore, the fraction <inline-formula id="pcbi.1007043.e006"><alternatives><graphic id="pcbi.1007043.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub> <mml:mo>/</mml:mo> <mml:mi>N</mml:mi></mml:math></alternatives></inline-formula> is called model frequency, which always lies between 0 and 1 and is a useful and intuitive metric for model comparison.</p>
<p>In practice, in many situations, researchers are interested in selecting a single best model (rather than relative comparisons among several) even in the face of variation in model identity across subjects. One way to accomplish this goal is to compute the exceedance probability of each candidate model, a metric commonly used for model selection [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>]. Exceedance probability is the probability that model <italic>k</italic> is more commonly expressed than any other model in the model space. Furthermore, the random effects approach enables us to quantify how likely the observed differences in model evidence is simply due to chance [<xref ref-type="bibr" rid="pcbi.1007043.ref019">19</xref>]. In this case, model selection is not statistically supported, as there is no meaningful difference between models. A metric called protected exceedance probability [<xref ref-type="bibr" rid="pcbi.1007043.ref019">19</xref>], which typically is more conservative than the exceedance probability, takes into account this possibility (see <xref ref-type="sec" rid="sec018">Materials and methods</xref>). Altogether, the random effects approach results in a more robust model comparison and model selection, one less driven by outliers than fixed-effects methods. Note that previous attempts to do model selection at group level using exceedance probability assumed no hierarchy for parameter estimation, thus did not deal with the issue that parameter estimation was not properly conditionalized by group distributions based on model identity.</p>
<p>We noted above that an issue with the HPE is that the influence of subjects on the group parameters is equal, due to the assumption that the model is a fixed effect. However, by virtue of its random effects structure, the comparable parameter in our approach, the mean of posterior distribution over <italic><bold>μ</bold></italic><sub><italic>k</italic></sub>, denoted by <bold>a</bold><sub><italic>k</italic></sub>, shows an important property: Algorithmically, a subject’s effect on this parameter depends on the degree to which the model is estimated to be the underlying model for that subject. Specifically, this parameter, <bold>a</bold><sub><italic>k</italic></sub>, is updated at each iteration as:
<disp-formula id="pcbi.1007043.e007"><alternatives><graphic id="pcbi.1007043.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mspace width="1.111pt"/><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="1.111pt"/><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic><bold>θ</bold></italic><sub><italic>kn</italic></sub> is the mean of the individual posterior and <bold>a</bold><sub>0</sub> is the prior mean over <italic><bold>μ</bold></italic><sub><italic>k</italic></sub>. The important point in this equation is that <bold>a</bold><sub><italic>k</italic></sub> is a weighted average of individual parameters, in which the weights are the corresponding responsibilities, <italic>r</italic><sub><italic>kn</italic></sub>. This is not specific to the group mean, but it is rather a general feature of our approach: contribution of model <italic>k</italic> to group parameters is weighted according to the responsibility of model <italic>k</italic> in generating data in the <italic>n</italic>th subject, <italic>r</italic><sub><italic>kn</italic></sub>.</p>
<p>As mentioned above, another issue that has been incompletely treated in HPE is related to inference on parameters of a fitted model at the population level. Statistically, one needs the uncertainty of the estimated group mean, <italic><bold>μ</bold></italic><sub><italic>k</italic></sub>, to be able to make inference on the corresponding parameter at the group level. Since parameters fitted by the HPE are not independent but instead regularized according to the variance given by data, one cannot employ regular statistical tests, such as t-test, to test whether a specific model parameter is “significantly” different from zero. Using those tests on such parameters is biased in favor of generating a significant p-value (more false positives). The HBI framework solves this problem by quantifying the uncertainty of the posterior over the group parameter, resulting in a statistical test similar to the t-test, which we call it HBI t-test. Specifically, it is possible to show that the posterior over the <italic>i</italic>th group parameter in model <italic>k</italic>, <italic>μ</italic><sub><italic>ki</italic></sub>, takes the form of standard Student’s t-distribution centered at the corresponding group mean, <italic>a</italic><sub><italic>ki</italic></sub>, with <inline-formula id="pcbi.1007043.e008"><alternatives><graphic id="pcbi.1007043.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mspace width="1.111pt"/><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> as degrees of freedom. The resulting t-value takes an intuitive form:
<disp-formula id="pcbi.1007043.e009"><alternatives><graphic id="pcbi.1007043.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>s</italic><sub><italic>ki</italic></sub> is the empirical deviance statistics for the <italic>i</italic>th parameter of model <italic>k</italic>. Therefore, <inline-formula id="pcbi.1007043.e010"><alternatives><graphic id="pcbi.1007043.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> plays the role of standard error, which we call it hierarchical error. Note that the degrees of freedom of the test depend on the number of subjects (i.e. evidence) in favor of model <italic>k</italic> given by <inline-formula id="pcbi.1007043.e011"><alternatives><graphic id="pcbi.1007043.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, not the total number of subjects. Other group statistics, <italic>a</italic><sub><italic>ki</italic></sub> and <italic>s</italic><sub><italic>ki</italic></sub>, are also weighted according to the responsibilities of model <italic>k</italic> in generating data of each subject (as formally obtained in <xref ref-type="sec" rid="sec018">Materials and methods</xref>). Using this marginal distribution for population-level group parameters, the HBI t-test enables researchers to determine whether a parameter is significantly different from an arbitrary value, notably 0. For example, the parameter is significantly different from 0 at <italic>P</italic> &lt; 0.05 if 0 does not fall within the 95% credible interval.</p>
</sec>
<sec id="sec004">
<title>HBI for model comparison and parameter estimation</title>
<p>In this section, we apply the proposed HBI method to synthetic datasets and compare its performance with that of HPE, as well as with a non-hierarchical inference (NHI) method estimating parameters for each subject independently according to some fixed, a priori Gaussian priors [<xref ref-type="bibr" rid="pcbi.1007043.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1007043.ref023">23</xref>]. Importantly, these methods differ in their statistical assumptions about the generative process of data. The NHI assumes no hierarchy in parameter estimation. We then used the individual-level evidence approximated by the NHI (<xref ref-type="supplementary-material" rid="pcbi.1007043.s001">S1 Text</xref>) to subsequently perform random effects model comparison using the procedure introduced by Stephan et al. [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref019">19</xref>]. This means that whereas the NHI procedure assumes no hierarchy across parameters, it does (via the Stephan procedure [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>]) allow for a hierarchical structure over model identity. In contrast, the HPE procedure, as introduced by Huys et al. [<xref ref-type="bibr" rid="pcbi.1007043.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref011">11</xref>], assumes a hierarchy over parameters, but no hierarchy over model identity: we accordingly, use it with a fixed-effects model comparison procedure. The HBI assumes that both parameters and model identities are generated hierarchically in turn. Note that related approximations, as similar as possible, have been used for making inference in these methods, which allows for a fair comparison (<xref ref-type="supplementary-material" rid="pcbi.1007043.s001">S1 Text</xref>) since our main points concern the statistical structure of the methods, not the estimation techniques. In particular, HPE builds upon NHI’s Bayesian inference of per-subject parameters to condition these on additional group level parameters, by using expectation-maximization [<xref ref-type="bibr" rid="pcbi.1007043.ref014">14</xref>]; and HBI extends that algorithm to condition these on an additional level of model identity variables, by using variational Bayes [<xref ref-type="bibr" rid="pcbi.1007043.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref017">17</xref>]. We also use the same (Laplace) approximation to marginalize the subject-level variables in all three methods. The HBI algorithm has been given in Materials and methods and details of implementing the NHI and HPE have been given in <xref ref-type="supplementary-material" rid="pcbi.1007043.s001">S1 Text</xref>. The details of simulation analyses and parameters used in simulations have also been given in <xref ref-type="supplementary-material" rid="pcbi.1007043.s001">S1 Text</xref>.</p>
<p>The HBI is general and could be applied to any type of data, such as choice data, reaction times, physiological signals and neural data. Since we are primarily interested in models of choice data, we focus on decision-making experiments.</p>
<sec id="sec005">
<title>Model comparison and parameter estimation for models with the same number of parameters</title>
<p>First, we considered a relatively easy problem in which the number of parameters in models is the same. We simulated a dataset including 40 artificial datasets using two different learning models and a randomly generated reward sequence (binarized Gaussian random-walk). Both models maintain a value for each of the two possible actions and calculate a prediction error signal representing the difference between the seen reward and predicted value. On every trial, the action value gets updated according to the product of the prediction error and a learning rate. The first model is an RL model, in which the learning rate is a constant free parameter, <italic>α</italic>. The second model is a Kalman filter model in which the learning rate gradually decreases on every trial. The decreasing rate depends on a positive free parameter (representing observational noise), <italic>ω</italic>. Both models employ a softmax function together with an inverse-temperature parameter, <italic>β</italic>, to calculate the probability of each action according to corresponding expected values. Therefore, both models contain two free parameters and neither of them is nested within the other one. The RL and Kalman filter models were then used to simulate 10 and 30 artificial datasets, respectively. Parameters of these models were drawn randomly from normal distributions. Since parameters of these models have theoretical constraints, we used appropriate functions (sigmoid or exponential) to transform these randomly generated parameters. Using this procedure, we constructed a dataset of 40 artificial subjects, in which the true underlying model is known. We applied the HBI to this dataset to estimate parameters and model evidence given the sequence of actions. Simulations were repeated 20 times.</p>
<p>
<xref ref-type="fig" rid="pcbi.1007043.g001">Fig 1</xref> shows the results of applying the HBI on this dataset. We first reported protected exceedance probability (<xref ref-type="fig" rid="pcbi.1007043.g001">Fig 1A</xref>), a metric commonly used for Bayesian model selection [<xref ref-type="bibr" rid="pcbi.1007043.ref019">19</xref>], which is the probability that each model is the most likely model across all subjects taking into account the null possibility that differences in model evidence are due to chance. This analysis revealed that the HBI has correctly identified the Kalman filter as the most likely model across the artificial datasets in all simulations with probability close to 1. Next, we looked into model frequency, which represents the ratio of subjects assigned to each model. As plotted in <xref ref-type="fig" rid="pcbi.1007043.g001">Fig 1B</xref>, model frequencies estimated by the HBI is close to true frequencies, 0.25 and 0.75 for the RL and Kalman filter models, respectively (<xref ref-type="fig" rid="pcbi.1007043.g001">Fig 1B</xref>). We then examined the HBI performance in model attribution at the individual level (<xref ref-type="fig" rid="pcbi.1007043.g001">Fig 1C</xref>). The HBI attributes models to each individual by quantifying responsibility parameters, which is the probability that that model is the true underlying model for that individual. First, we verified that the HBI has assigned the correct model to about 90% of all subjects (<xref ref-type="fig" rid="pcbi.1007043.g001">Fig 1C</xref>, inset). We then looked into the average of responsibilities for true attribution (those cases whose model was correctly identified) and for false attribution (those cases whose model was erroneously assigned) (<xref ref-type="fig" rid="pcbi.1007043.g001">Fig 1C</xref>). We found that the average of responsibilities estimated by HBI is about one for true attributions and it is closer to chance-level (than one) for false attributions. This means that the HBI method was quite certain when it was successful in identifying the true model and uncertain in cases in which it failed to recognize the true model. Later, we will examine HBI performance in model attribution more thoroughly.</p>
<fig id="pcbi.1007043.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Performance of the HBI in a synthetic dataset.</title>
<p>10 and 30 artificial subjects were generated according to the RL (RL) and Kalman filter (KF) models, respectively. A) Model selection by HBI using protected exceedance probabilities (PXP); B) Model frequencies estimated by the HBI. C) Model attribution at the individual level by the HBI; Responsibility estimates are plotted for true attributions (TA), in which the true model has been attributed, and for false attributions (FA), in which the incorrect model is attributed. The HBI shows lower levels of responsibility for FA. Inset: percentage of correct assignment of the model by the HBI at the individual level. D) Comparison of accuracy of model selection with HPE and NHI; E, F) Error in estimating individual parameters of the RL (E) and the Kalman filter model (F). The estimation error is defined as the absolute difference between estimated parameters and the true parameters. In all plots, error-bars are standard errors of the mean obtained across 20 simulations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g001" xlink:type="simple"/>
</fig>
<p>We then compared the performance of the HBI with the HPE and NHI. Note that NHI depends on Gaussian priors over parameters. Across all simulations and models, we used the same Gaussian prior (with mean 0, and variance 6.25, similar to our previous works [<xref ref-type="bibr" rid="pcbi.1007043.ref024">24</xref>]). This value for the prior variance ensures that parameters can vary in a wide range with no substantial effects of prior (see <xref ref-type="supplementary-material" rid="pcbi.1007043.s001">S1 Text</xref> for a formal derivation). The hierarchical methods, in contrast, replace NHI’s fixed prior over individual-level parameters with additional group-level parameters that are themselves estimated from the data.</p>
<p>In this set of simulations, all methods performed well in recognizing the most likely model (i.e. the Kalman filter) across all samples (<xref ref-type="fig" rid="pcbi.1007043.g001">Fig 1D</xref>) at the liberal threshold of 50%, although the HPE performed worse than the other two models (failing 15% of simulations). In the next section, we examine the limitations of HPE for model comparison more thoroughly.</p>
<p>We then investigated the performance of these methods in parameter estimation. We quantified individual-level estimation error, which is defined as the absolute difference between estimated individual-level parameters using that method and true individual-level parameters used for generating data. For both models and all parameters, the average error in parameter estimation by HBI was smaller than those by HPE and NHI (<xref ref-type="fig" rid="pcbi.1007043.g001">Fig 1E and 1F</xref>). Furthermore, HPE performed better than NHI in estimation across all parameters. These results were indeed theoretically expected. Unlike NHI, both HPE and HBI use group statistics to regularize parameter estimation for each individual. However, while HPE uses all subjects equally to regularize group parameters of a model, HBI weights individuals according to its responsibility (i.e. its belief that that model is responsible for generating each individual dataset).</p>
</sec>
<sec id="sec006">
<title>Robustness of model comparison to outliers</title>
<p>We noted before that fixed effects model comparison using HPE is very sensitive to outliers. This is because fixed effects approaches sum up evidence across all subjects. If a few outlier subjects show large evidence in favor of a model, those usually impact model comparison adversely. In contrast, the HBI takes a random-effects approach, in which the contribution of every subject in favor of each model is normalized according to the corresponding responsibility, which is a relative evidence measure with a maximum of one. In this section, we show a simulation analysis to demonstrate this point.</p>
<p>We took the same datasets generated in the previous simulations by the RL and Kalman filter models. We then identified one outlier subject in that dataset that showed the largest evidence in favor of the RL model. From all 200 subjects generated using the RL model across all 20 simulations in the previous analysis, the subject with maximum relative log-likelihood in favor of the RL model (under the HPE parameters) was selected as the outlier subject in evidence space (the relative log-likelihood for this subject was 4 times more than average relative log-likelihood). This outlier subject was then used to create datasets with 1, 2 or 3 outliers by copying it 1, 2 or 3 times, respectively, and adding those copies to the original dataset.</p>
<p>We then compared the performance of NHI, HPE, and HBI. Note that while NHI and HBI perform random effects model comparison, HPE performs a fixed effects model comparison. As shown in <xref ref-type="fig" rid="pcbi.1007043.g002">Fig 2</xref>, whereas the performance of HPE is very sensitive to outliers, the random effects model comparison of NHI and HBI are robust. Note that although NHI performs well in the model selection here, we will demonstrate its limitations for model comparison in the next section. It is also important to note that the outlier here is in the space of model evidence (i.e., a subject displaying abnormally large evidence for one model over another). We will examine the effects of outliers in parameter space later.</p>
<fig id="pcbi.1007043.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Robustness of model selection to outliers.</title>
<p>The same 20 datasets simulated in the previous section were used as the base datasets (i.e. 0 outliers) and the effects of adding 1, 2 or 3 outliers to each dataset were examined. The HPE shows severe sensitivity to outliers, while the other two (random effects) methods are robust.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Model comparison and parameter estimation in models with different number of parameters</title>
<p>We then considered a challenging problem in which the number of free parameters in two models is different and one model is a special case of the other one. Such problems are ubiquitous in studies using computational models and inference using hierarchical approaches is typically even more advantageous in this setting, as the variance explained by such models are more likely to overlap.</p>
<p>The first model was again assumed to be an RL model with a constant learning rate parameter, <italic>α</italic>. The second model, however, was assumed to contain two different learning rates depending on whether the prediction error is positive or negative (dual-<italic>α</italic> RL), commonly used to assess asymmetries in learning from positive vs negative prediction errors [<xref ref-type="bibr" rid="pcbi.1007043.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref026">26</xref>]. Both models use the same choice function, i.e., a softmax function with an inverse-temperature parameter, <italic>β</italic>. The RL and the dual-<italic>α</italic> RL models were then used to simulate 10 and 30 artificial datasets, respectively. Note that the RL model is a nested case of the dual-<italic>α</italic> RL, in which <italic>α</italic><sup>+</sup> = <italic>α</italic><sup>−</sup>.</p>
<p>As <xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3</xref> shows, the HBI method was successful in model selection (i.e. recognizing the most likely model, <xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3A</xref>). Model frequencies estimated by the HBI are close to true frequencies, 0.25 and 0.75 for the RL and dual-<italic>α</italic> RL models, respectively (<xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3B</xref>). At the individual level, HBI assigned the correct model to each individual in 95% of all subjects and was also quite certain when it was successful in selecting the right model (<xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3C</xref>). In contrast, in those rare cases in which HBI failed to recognize the correct underlying model (false attributions), it assigned responsibility that was only slightly above chance.</p>
<fig id="pcbi.1007043.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Performance of the HBI in a synthetic dataset including models with the different number of parameters.</title>
<p>10 and 30 artificial subjects were generated according to the RL and dual-<italic>α</italic> RL models, respectively. A) Model selection by HBI using protected exceedance probabilities (PXP); B) Model frequencies estimated by the HBI. C) Model attribution at the individual level by the HBI. Responsibility estimates are plotted for true attributions (TA) and for false attributions (FA). The HBI shows lower levels of responsibility for FA. Inset: percentage of correct assignment of the model by the HBI at the individual level. D) Model selection performance of NHI, HPE, and HBI; E, F) Error in estimating individual parameters of the RL (E) and the dual-<italic>α</italic> RL model (F). The estimation error is defined as the absolute difference between estimated parameters and the true parameters. In all plots, error-bars are standard errors of the mean obtained across 20 simulations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g003" xlink:type="simple"/>
</fig>
<p>Next, we compared the performance of the HBI with that of NHI and HPE. Here, NHI fails to choose correctly the most likely model in 75% of simulations (<xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3D</xref>). This is likely because non-hierarchical methods penalize more complex models more harshly than do their hierarchical counterparts because they neglect the structure of the data. In particular, the issue is that a model with one additional parameter adds one independent free parameter per subject in the non-hierarchical case, which carries an excessive overfitting penalty, whereas these parameters are pooled by being drawn from a common distribution in the hierarchical setting, ensuring less overfitting and a more moderate complexity penalty. Note that reducing the variance of the prior of the NHI decreases the complexity penalty and somewhat improves model selection performance slightly in this scenario, but it also worsens parameter estimation (<xref ref-type="supplementary-material" rid="pcbi.1007043.s002">S1 Fig</xref>). This poor parameter estimation has negative consequences also for model selection in other situations in which the RL should be favored (<xref ref-type="supplementary-material" rid="pcbi.1007043.s002">S1 Fig</xref>). Therefore, in general, the NHI is not flexible enough to capture the true model in different situations.</p>
<p>We can also consider why the estimation errors of HBI are much smaller than those of HPE. Consider, for example, the learning rate parameter of the RL model, <italic>α</italic> (<xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3E</xref>). In generating the datasets for this analysis, <italic>α</italic> was assumed to be smaller than the learning rate parameters of the dual-<italic>α</italic> RL model. This structure was designed to exercise a situation in which the HBI excels, and the HPE has trouble: when the parameters systematically differ across models, and therefore failing to take into account which subjects exemplify which model confuses the parameter estimates. In particular, since the HPE uses average statistics across all subjects (even those generated by the dual-<italic>α</italic> model) to constrain parameters, the group average estimate of <italic>α</italic> by HPE was much larger than the true average. Therefore, the individual estimates of <italic>α</italic> by HPE are also tended to be larger than the true parameters, resulting in larger estimation error. The HBI does not have this problem because the group statistics are estimated using a weighted average, in which the weights are the corresponding responsibilities of models. Note that for a different set of learning rate parameters, in which the learning rate of the RL is in the middle of those of dual-<italic>α</italic> RL model, and the consequences of estimating parameters across all subjects thus less problematic, the difference between the HPE and HBI might not be so pronounced (<xref ref-type="supplementary-material" rid="pcbi.1007043.s003">S2 Fig</xref>).</p>
<p>So far, we conducted model selection using a liberal threshold (50%). Often researchers are interested to perform model selection using higher thresholds of exceedance probabilities. With higher thresholds, we expect that none of the models get selected in situations in which there are equal numbers of subjects expressing each model. As both HBI and NHI (but not HPE) compute exceedance probabilities and model frequencies, we compared their performance in model selection. Here, we considered different ratios of subjects expressing each model. In particular, in addition to the previous simulation in which the RL model was less frequent, we considered two other situations in which the ratio of subjects expressing each model was equal or was more in favor of the RL model (<xref ref-type="fig" rid="pcbi.1007043.g004">Fig 4</xref>). These analyses showed that HBI is superior to the NHI, as its protected exceedance probabilities are closer to one when one of the models is actually more frequent. The HBI model frequency is closer to the true frequencies than the NHI. Furthermore, the HBI selects the most likely model with higher exceedance probabilities. It is important to note that NHI overestimates model frequencies in favor of the RL model in all simulations, probably again due to additional overfitting (and correspondingly higher penalties for the additional parameter) in the non-hierarchical setting.</p>
<fig id="pcbi.1007043.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparison of HBI with NHI in model selection and model attribution.</title>
<p>We compared the performance of HBI and NHI in three simulation analyses with different ratio of subjects expressing each model. The first simulation includes 10 subjects expressing RL and 30 subjects expressing dual-<italic>α</italic> RL model (10/30). The second one includes 20 subjects per model (20/20) and the third one includes 30 subjects expressing RL and 10 dual-<italic>α</italic> RL (30/10). A) Mean protected exceedance probabilities (PXP) estimated by the HBI and NHI; B) Mean model frequency of RL across all simulations (true frequencies are also plotted). C-D) Model selection performance at PXP&gt;0.5 (C) and PXP&gt;0.95 (D). For the 20/20 simulations, 50% of each model should be selected at the chance level, i.e. PXP&gt;0.5, and none of the models should be selected at PXP&gt;0.95. E) Model attribution performance, at the individual level, using responsibility (<italic>r</italic>) parameters at 0.95 thresholds across all three simulations. The HBI is more accurate than the NHI in model attribution and shows more true attributions (TA) and less false attributions (FA). E) ROC curves, across all three simulations, for HBI and NHI, which illustrate model attribution performance at various threshold settings. Inset: area under the curve (AUC) of the ROC, as a metric for model attribution performance. The HBI shows better performance than the NHI according to this metric. In A-B, error-bars are standard errors of the mean obtained across 20 simulations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g004" xlink:type="simple"/>
</fig>
<p>We then examined the performance of HBI and NHI in model attribution at the individual level (<xref ref-type="fig" rid="pcbi.1007043.g004">Fig 4E</xref>). The HBI computes responsibility parameters for every subject and model, which is the posterior probability that that model generated the data for that subject. Similar parameters can be estimated using evidence approximated by the NHI. Using the threshold of 0.95 for responsibilities (<italic>r</italic> &gt;0.95), we observed that the HBI is more accurate than the NHI in model attribution. This is mainly because the NHI shows a higher false attribution rate due to its bias to attribute individuals to the simpler model. Note that it is possible to compute true attribution and false attribution rate using different thresholds for responsibilities here. In machine learning, it is common to illustrate attribution performance of a binary classification machine using plots called receiver operating characteristic (ROC) curves, which are obtained by plotting the true attribution rate against the false attribution rate at various thresholds. In ROC curves, the upper left corner point (i.e. 0 false attribution rate, 1 true attribution rate) represents perfect classification. The diagonal line, on the other hand, represents classification at the chance level. The area under the curve in this plot is, therefore, a good metric for classification performance. This metric shows that the overall model attribution performance of the HBI is better than that of NHI (<xref ref-type="fig" rid="pcbi.1007043.g004">Fig 4F</xref>).</p>
</sec>
<sec id="sec008">
<title>Effects of number of trials</title>
<p>It is also important to note that all these methods are sensitive to the amount of within-subject data (i.e. the number of trials). Importantly, HBI is even more useful when there are a limited number of trials (<xref ref-type="fig" rid="pcbi.1007043.g005">Fig 5</xref>). In this case, non-hierarchical methods, such as NHI, over-penalize complex models even more, as there are fewer data-points per subject to justify additional parameters. Furthermore, in this case, the HPE model selection performance is even more sensitive to outliers, as outliers are more likely when data per subject is limited. Therefore, the HBI performs better than the other two methods in model selection when there is limited within-subject power (<xref ref-type="fig" rid="pcbi.1007043.g005">Fig 5A</xref>). Hierarchical methods are also more powerful in parameter estimation in this case, although the HBI performs better than the HPE across a different number of trials (<xref ref-type="fig" rid="pcbi.1007043.g005">Fig 5B</xref>).</p>
<fig id="pcbi.1007043.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Performance of the HBI as a function of the number of trials.</title>
<p>10 and 30 artificial subjects were generated according to the RL and dual-<italic>α</italic> RL models, respectively. These simulations were performed with a different number of trials (T) per subject. A) The accuracy of model selection by NHI, HPE, and HBI for T = 50, T = 100, and T = 200 trials; B) Mean error in estimating individual parameters across both models and parameters. Note that the estimation errors here are computed on the normally distributed parameters. The estimation error is defined as the absolute difference between estimated parameters and the true parameters. In all plots, error-bars are standard errors of the mean obtained across simulations 20 times.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Effects of number of participants</title>
<p>Hierarchical methods are also sensitive to the amount of between-subject data (i.e. the number of subjects expressing each model). Moreover, model selection can be particularly unstable with a small number of subjects. Therefore, we did another simulation analysis with a smaller number of subjects and tested the performance of HBI in model selection. We performed a simulation analysis with the RL and dual-<italic>α</italic> RL models, in which we manipulated the number of subjects. We repeated simulations 1000 times, in which in half of the simulations, the ratio of RL model was three times more likely than the dual-<italic>α</italic> RL, and vice versa in the other half (<xref ref-type="fig" rid="pcbi.1007043.g006">Fig 6</xref>). These simulation analyses showed that the HBI selects the more frequent model with a high protected exceedance probability. The model selection performance of the HBI improved with a higher number of subjects. Across all simulations, the NHI estimates protected exceedance probabilities that are only slightly above chance and it fails to select the more frequent model.</p>
<fig id="pcbi.1007043.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Performance of the HBI as a function of the number of subjects.</title>
<p>In this analysis, simulations were repeated 1000 times, in which in half of the simulations, the ratio of the RL model was three times more than the dual-<italic>α</italic> RL, and vice versa in the other half. A) Protected exceedance probabilities (PXP) of the most frequent model estimated by the HBI and NHI; B) Model frequency of the most frequent model across all simulations. The black line indicates the true frequency (0.75). C-D) Model selection performance by the HBI and NHI at PXP&gt;0.5 and PXP&gt;0.95, respectively. The NHI almost never selects the most frequent model at PXP&gt;0.95. E) Model selection performance using area under the ROC curve. Higher values indicate better performance (one corresponds to perfect model selection). The HBI performance improves by increasing the number of subjects. F) Error in estimating individual parameters across both models and parameters. Estimation errors are computed on the normally distributed parameters. The estimation error is defined as the absolute difference between estimated parameters and the true parameters. In A, B, and F, median across 1000 simulations is plotted and error-bars represent the first and third quantile.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g006" xlink:type="simple"/>
</fig>
<p>Next, we compared model selection performance of all three methods using the area under the ROC curves for a different number of subjects (<xref ref-type="fig" rid="pcbi.1007043.g006">Fig 6E</xref>). Here, model selection of NHI and HBI was performed using protected exceedance probabilities. For HPE, the normalized evidence (i.e. normalized Bayes factor) was used for model selection. The HBI performed better than the other two methods with a higher area under the curve. Finally, we compared the parameter estimation performance of these methods (<xref ref-type="fig" rid="pcbi.1007043.g006">Fig 6F</xref>). Across all parameters and subjects, the average estimation error in individual-level parameters was quantified. The analyses showed that the HBI exhibits lower estimation error than the other methods and its performance improves when there is a higher number of subjects.</p>
</sec>
<sec id="sec010">
<title>Robustness of parameter estimation to outliers</title>
<p>All model fitting methods are sensitive to outliers whose parameters are dramatically different from other subjects. Although HBI is more robust than HPE against outliers in evidence space, there is no theoretical reason that HBI is more robust against outliers in parameter space. Indeed, both HPE and HBI make the distributional assumption that subjects’ parameters vary according to a Gaussian distribution, and outliers (or indeed other non-Gaussian structures) violate this assumption. However, since the HBI takes into account multiple models during fitting, it is possible to reduce the effects of outliers on estimated group parameters in another way, by including additional simple models in the model space to “soak up” these subjects. Defining such a simple model depends on the nature of data and task. For example, in learning tasks, outliers typically show no learning effect (resulting in a decision noise parameter of about zero) or simple strategies such as switching decisions according to the most recent outcome (value is always equal to the most recent outcome). A simple model that captures both those situations is a softmax that translates the most recent outcome to probabilities according to a decision noise parameter. If the decision noise parameter is zero, this model captures outliers that outcomes have no effect on their choices.</p>
<p>We considered two scenarios to demonstrate this point experimentally (<xref ref-type="fig" rid="pcbi.1007043.g007">Fig 7</xref>). In the first scenario, 30 subjects were generated according to the RL model and a number of outliers that were generated by using the same model with the same learning rate but a small decision noise. We then used the HBI with a model space including an RL model and the simple model described above. We found that the estimation error for capturing the group mean was smaller for the HBI than the NHI and HPE methods. In the second scenario, we considered a more realistic situation in which outliers were generated based on a small learning rate and a small decision noise. Similar to the previous simulation, HBI exhibited less estimation error for group parameters compared with other methods.</p>
<fig id="pcbi.1007043.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g007</object-id>
<label>Fig 7</label>
<caption>
<title>The sensitivity of parameter estimation to outliers.</title>
<p>30 subjects are simulated using the RL model. A) In scenario 1, a number of outliers are also simulated with the same learning rate but small decision noise parameter. B) In scenario 2, outliers are simulated with small learning rate and small decision noise parameter. Errors in recovering the group-level parameters are plotted (for the learning rate, and decision noise,). HBI performs better than alternatives. The estimation error is defined as the absolute difference between estimated group-level parameters and the true parameters. In all plots, error-bars are standard errors of the mean obtained across simulations 20 times.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec011">
<title>HBI for model spaces with more than two models</title>
<p>So far, we have examined the performance of the HBI in relatively small model spaces. Next, we considered another situation in which 60 subjects are generated according to four different learning models. In addition to the RL, the dual-<italic>α</italic> RL and the Kalman filter model used in previous simulations, here we also considered an actor-critic RL model, which is a class of RL models in which different modules are responsible for learning (critic) and action selection (actor). We considered four scenarios in which 30 subjects were generated according to one of the models and 10 subjects were generated according to each of the other three models (<xref ref-type="fig" rid="pcbi.1007043.g008">Fig 8</xref>). These simulations revealed that protected exceedance probability of the most frequent model computed by the HBI is close to 1. Moreover, the HBI estimate of model frequencies matches well with true frequencies. For reasons detailed in previous analyses, unlike the HBI, the HPE and NHI fail to select the true model in three and one sets, respectively. Furthermore, HBI shows smaller errors in parameter estimation than the other two methods.</p>
<fig id="pcbi.1007043.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Performance of the HBI in a large model space.</title>
<p>HBI was tested in a large model space including RL, dual-<italic>α</italic> (DA) RL, Kalman filter (KF) and actor-critic (AC) models in four scenarios. In each scenario, one model (the dominant model) was used to generate 30 subjects. Other models were used to generate 10 subjects. A) Model selection by HBI using protected exceedance probabilities (PXP). B) Model frequencies estimated by the HBI. Note that in each scenario, the model frequency of the dominant model is 0.5 and it is about 0.17 for the other models. C) Model selection performance (at 50%) of NHI, HPE, and HBI. D) Error in estimating individual parameters across both models and parameters. Estimation errors are computed on the normally distributed parameters, defined as the absolute difference between estimated parameters and the true parameters. In all plots, error-bars are standard errors of the mean obtained across 20 simulations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g008" xlink:type="simple"/>
</fig>
<p>Finally, we tested the HBI in a more complicated task by considering the two-step Markov decision task introduced by Daw et al. [<xref ref-type="bibr" rid="pcbi.1007043.ref027">27</xref>]. This task is a well-known paradigm to distinguish two behavioral modes, model-based and model-free learning. Daw et al. [<xref ref-type="bibr" rid="pcbi.1007043.ref027">27</xref>] have proposed three RL accounts, a model-based, a model-free and their hybrid (which nests the other two and combines their estimates according to a weight parameter), to disentangle the contribution of these two behavioral modes on choices. Here, we skip the details of the models and focus on the application of the HBI to a model space consisting of model-free, model-based and hybrid agents. We generated 30, 10 and 10 artificial subjects according to the hybrid, the model-based and model-free models, respectively (<xref ref-type="fig" rid="pcbi.1007043.g009">Fig 9</xref>). This simulation analysis showed that the HBI performs well in model selection and estimation of model frequencies given true frequencies. Importantly, the HBI recovers the parameters of the models better than alternative methods. In particular, the critical weight parameter of the hybrid model, which determines the degree of balance between the model-based and model-free strategies, was significantly better recovered by the HBI than the other methods (in all 20 simulations, HBI did better than both HPE and NHI).</p>
<fig id="pcbi.1007043.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Performance of the HBI in the two-step Markov decision task.</title>
<p>30, 10 and 10 artificial subjects have been generated using the hybrid, the model-based (MB) and the model-free (MF) models, respectively. A) Model selection by HBI using protected exceedance probabilities (PXP). B) Model frequencies estimated by the HBI. C) Model selection performance (at 50%) of NHI, HPE, and HBI. D) Error in estimating the critical weight parameter of the hybrid model at the individual level. HBI shows less error than other methods in all simulations. In all plots, error-bars are standard errors of the mean obtained across 20 simulations.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g009" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec012">
<title>HBI t-test for inference at the group-level</title>
<sec id="sec013">
<title>Sensitivity and specificity of HBI t-test</title>
<p>We then tested the performance of the HBI t-test introduced above (<xref ref-type="fig" rid="pcbi.1007043.g010">Fig 10</xref>, see <xref ref-type="sec" rid="sec018">Materials and methods</xref> for full derivation). In these simulation analyses, we focused on an example that represents a typical inference problem at the population level for parameters of a computational model.</p>
<fig id="pcbi.1007043.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Performance of the HBI t-test for making inference at the population level.</title>
<p>RL agents with a bias parameter were generated according to different mean (effect size) values in two simulations where A) there is only one model in the model-space (scenario 1); or B) there are two models in the model-space (scenario 2). The HBI makes inference using the HBI t-test, the NHI makes inference by performing a t-test on its estimated parameters and the HPE makes inference by comparing the full fit and null fit (in which the group-level prior mean for the bias parameter is fixed). The sensitivity (or power) of the tests in detecting true effects at <italic>P</italic> &lt;0.05 for a number of different effect sizes is plotted (i.e. true positive rate). For the HPE, log-evidence of at least 3 was considered as significant. The HPE shows lower sensitivity than the other methods in both scenarios. Moreover, the HBI shows higher sensitivity than the NHI in scenario 2.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g010" xlink:type="simple"/>
</fig>
<p>Consider a situation in which subjects should learn stimulus-action-outcome contingencies. The subject’s task is to either to make a go-response by approaching the stimulus or to do nothing (i.e. no-go response). Furthermore, assume that the stimulus is either emotionally appetitive or aversive (e.g. a happy or an angry face cue), but the outcome value is independent of the emotional content of the stimulus. A question of interest is whether the emotional content (happy versus angry) of stimuli induces opposite biases in making a go response, regardless of action values (a form of Pavlovian to instrumental transfer). This is easy to test using an RL model with one additional bias parameter, <italic>b</italic> (we call this model biased RL). The bias is assumed to be +<italic>b</italic> for the emotionally appetitive stimulus and −<italic>b</italic> for the emotionally aversive stimulus. Thus, for larger values of <italic>b</italic>, the subject has a tendency to choose a go response after seeing the emotionally appetitive stimulus and a no-go response after seeing the emotionally aversive stimulus. The bias parameter <italic>b</italic> varies from subject to subject; we are interested here in testing the null hypothesis that its group-level mean is zero.</p>
<p>We simulated a dataset including 20 artificial subjects using this model and a randomly generated reward sequence (binarized Gaussian random-walk). We tested the sensitivity or power of the methods to detect true effects (i.e., nonzero <italic>b</italic>, when present). We repeated this analysis for different effect sizes, in which the bias parameter, <italic>b</italic>, was drawn from a normal distribution with different nonzero effect sizes as its mean, and a variance of 1. A collection of 500 simulations per effect size was simulated. We then compared the performance of HBI in making inference about effects at the group level with that of NHI and HPE. The HBI t-test is very similar to the classical t-test, in which degrees of freedom of the test depends on estimated model frequencies. For NHI, the inference can be done using a classical t-test, as unlike HBI and HPE, samples are treated independently by the NHI. For HPE, one can make inference using Bayesian model selection between a full HPE fit, in which all individual parameters are fitted according to the group level statistics, and a null HPE fit in which the group-level mean and variance for the bias parameter are fixed at their prior value. Note that the group mean of the bias parameter in the null HPE was fixed at zero.</p>
<p>For each simulation analysis, we then quantified accuracy using the HBI t-test at <italic>P</italic> &lt;0.05. Similarly, we quantified the sensitivity of the NHI at <italic>P</italic> &lt;0.05. For the HPE, the log-evidence of at least 3 in favor of the full HPE was defined as a significant effect (which means evidence in favor of the null hypothesis is about 0.05 times less than the alternative hypothesis). These analyses showed that both the HBI and NHI performed quite well in detecting group effects (<xref ref-type="fig" rid="pcbi.1007043.g010">Fig 10A</xref>). The HPE, however, showed low sensitivity. This is because the HPE uses Bayesian information criterion (BIC) to penalize parameters at the group level, which is known to be a conservative metric [<xref ref-type="bibr" rid="pcbi.1007043.ref023">23</xref>]. Therefore, the full fit HPE loses against the null fit in this stimulation.</p>
<p>We found similar results in another scenario in which samples were generated according to two different models (<xref ref-type="fig" rid="pcbi.1007043.g010">Fig 10B</xref>). Here, the HBI first infers model frequency and then quantifies hierarchical errors and degrees of freedom according to those frequencies. Therefore, we considered the same stimulus-action-outcome learning experiment as above and simulated a dataset including 40 artificial subjects. Data for half of the subjects were generated using the same biased RL model and data for the other half were generated using the dual- RL model explained in previous simulations. Using the same procedure as above, we compared the performance of the HBI, NHI and HPE and found very similar results.</p>
</sec>
<sec id="sec014">
<title>HBI t-test under the null hypothesis</title>
<p>Next, we conducted a complementary test of how the HBI t-test performs at avoiding false positives when there are no true effects to be found. Specifically, we tested the performance of HBI t-test for data generated under the null hypothesis, i.e. when the group level mean for the parameter is zero. Note that individual subjects still show a positive or negative bias. Under the null, the p-value generated by the HBI t-test should be uniformly distributed. For example, if null is true, the probability that the p-value falls under 0.05 (the false positive rate) should be 0.05 and the probability that the p-value falls under 0.1 should be 0.1.</p>
<p>We tested the HBI t-test using the same biased RL model as in previous analyses (<xref ref-type="fig" rid="pcbi.1007043.g011">Fig 11</xref>). The null hypothesis was true here, which means that the individual bias parameters were drawn from a normal distribution with zero mean and variance of 1. We performed 2000 simulations, which allows us to estimate the distribution of p-values generated by the HBI t-test. We found that those p-values are very close to the theoretical uniform distribution (<xref ref-type="fig" rid="pcbi.1007043.g011">Fig 11A</xref>).</p>
<fig id="pcbi.1007043.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Performance of the HBI t-test under the null.</title>
<p>A bias parameter was generated under the null (effect size is 0) in two simulations where A) there is only one model in the model-space (scenario 1); or B) there are two models in the model-space (scenario 2). The probability distribution of P-value is obtained by repeating the simulation 2000 times. Note that under the null hypothesis, the resulting P-value is theoretically expected to have a uniform distribution. The error-bars are 95% confidence intervals for the binomial distribution.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g011" xlink:type="simple"/>
</fig>
<p>We then considered a more difficult scenario in which there are two models in the model space (as above, the biased RL model alongside the dual RL model; <xref ref-type="fig" rid="pcbi.1007043.g011">Fig 11B</xref>). Here, the p-value computed by the HBI t-test depends on the estimated model frequency and even a tiny bias towards one model deteriorates the HBI t-test. Although the performance of the HBI t-test slightly dropped in this scenario, the distribution of p-values was still reasonably good.</p>
</sec>
<sec id="sec015">
<title>HBI t-test for skewed samples</title>
<p>It is well known that the classical t-test is biased when data is generated by a skewed distribution rather than a normal distribution. Since the HBI t-test developed here is also based on a normality assumption, we examined to what extent its performance drops when samples are drawn from a skewed distribution (<xref ref-type="fig" rid="pcbi.1007043.g012">Fig 12</xref>).</p>
<fig id="pcbi.1007043.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Performance of the HBI t-test when samples are drawn from a skewed distribution.</title>
<p>A) The skewed distribution (skewness of −0.5). The mean, variance and kurtosis of the distributions are 0, 1 and 3 (i.e. kurtosis of the normal distribution), respectively. This distribution was used to generate the bias parameter, which was then used to generate 20 (A) and 50 (B) subjects according to the biased RL model. B-C) Inference at <italic>P</italic> &lt;0.05 for the HBI t-test on estimated parameters and t-test on true parameters, as a benchmark, when there is no effect (under the null). Note that this is an unrealistic benchmark because it is based on true parameters that the HBI does not have access to. D-E) Probability of P-value is obtained under the null hypothesis by repeating simulations 2000 times. Under the null hypothesis, the resulting P-value is theoretically expected to have a uniform distribution. Increasing the number of subjects improves the performance of the HBI t-test. The error-bars are 95% confidence intervals for the binomial distribution.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g012" xlink:type="simple"/>
</fig>
<p>We considered the same scenario as in previous simulations, testing false positives in which 20 subjects are generated with the biased RL model. Here, the bias parameter was drawn under the null hypothesis (in the sense that parameter had zero mean, and 1 variance, across subjects), but distributed according to a skewed distribution (with a skewness of –0.5) (<xref ref-type="fig" rid="pcbi.1007043.g012">Fig 12A</xref>). This simulation was repeated 2000 times. First, we compared the probability of finding a significant effect (<italic>P</italic> &lt;0.05) under the null and compared it with the benchmark t-test on true parameters (<xref ref-type="fig" rid="pcbi.1007043.g012">Fig 12B</xref>). Note that this is an unrealistic benchmark as it sees the true parameters. Nevertheless, we found that both tests show statistical biases (as expected theoretically). In particular, both tests showed elevated false positive rates for tests nominally at <italic>P</italic> &lt;.05: false positives occurred for the benchmark test on true parameters was 0.054 and for the HBI t-test on estimated parameters was 0.079. Importantly, increasing the number of samples substantially improves the performance of the HBI t-test as it improves parameter estimation. To investigate this point experimentally, we repeated the same simulation analysis with 50 samples in each dataset. In this simulation, the false positive rate for the benchmark test and the HBI t-test was 0.053 and 0.055, respectively (<xref ref-type="fig" rid="pcbi.1007043.g012">Fig 12C</xref>). Next, we considered the full probability distribution of the p-values under the null hypothesis. As <xref ref-type="fig" rid="pcbi.1007043.g012">Fig 12D and 12E</xref> shows, the mismatch between the estimated and theoretical probabilities reduced by increasing the number of samples.</p>
</sec>
</sec>
<sec id="sec016">
<title>Applying HBI to empirical data</title>
<p>We then applied the HBI method to an empirical choice dataset from 31 subjects performing the two-step Markov decision task. The data used for this analysis have been reported elsewhere [<xref ref-type="bibr" rid="pcbi.1007043.ref028">28</xref>]. In <xref ref-type="fig" rid="pcbi.1007043.g013">Fig 13</xref>, we have plotted protected exceedance probabilities of each model, model frequencies and estimated group means and corresponding hierarchical errors. According to this analysis, the hybrid model is the most likely model across the group.</p>
<fig id="pcbi.1007043.g013" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g013</object-id>
<label>Fig 13</label>
<caption>
<title>Using HBI for making inference on empirical datasets.</title>
<p>A) HBI has been applied to a dataset of the two-step Markov decision task. The model space consisted of the hybrid, the model-based (MB) and the model-free (MF) models. Protected exceedance probabilities (PXP), model frequencies and estimated parameters of the winning model (the hybrid) are plotted. The error-bars are obtained by applying the corresponding transformation function on the hierarchical errors and, therefore, are not necessarily symmetric.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g013" xlink:type="simple"/>
</fig>
<p>We also performed further analysis testing whether individual differences found by the HBI generalize to individual differences in conceptually related, yet independent, data. We reasoned that subjects showing a hybrid strategy might be slower in their choice, as the hybrid model requires combining of model-based and model-free values (which in some trials might be in conflict). Therefore, we looked at the median of response time across all first-level choices for each subject and tested whether there is a difference in response times between those subjects who (according to the separate analysis of choices) employed a hybrid strategy vs. those who employed a model-based strategy as estimated by the HBI. The subgroup attributed to the hybrid model by the HBI showed slower response time compared to those subjects attributed to the model-based account (P = 0.03, Wilcoxon test). These results suggest that HBI reveals meaningful individual differences generalizing to unseen data.</p>
<p>We applied the HBI to another choice dataset of Parkinson’s disease (PD) patients (N = 31), who performed a probabilistic reward and punishment learning task with binary choices (160 trials), which has been used previously for studying maladaptive learning in PD patients. All patients tested on medication. The dataset used here has been reported elsewhere [<xref ref-type="bibr" rid="pcbi.1007043.ref015">15</xref>].</p>
<p>Previous studies proposed that positive and negative prediction errors might be communicated through different dopaminergic receptors or striatal pathways [<xref ref-type="bibr" rid="pcbi.1007043.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref029">29</xref>], and thus the PD patients might have different learning rate parameters for learning from positive and negative prediction errors [<xref ref-type="bibr" rid="pcbi.1007043.ref029">29</xref>]. Therefore, we considered a model space including the RL model, the dual- RL model and a simple strategy that selects actions based on the most recent outcome. In both RL models, we also included a perseveration parameter, which models the tendency to repeat or avoid the same choice regardless of the value [<xref ref-type="bibr" rid="pcbi.1007043.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref030">30</xref>]. This analysis showed that the dual-<italic>α</italic> RL model was more likely across the group. Protected exceedance probabilities, model frequencies and estimated group means and corresponding hierarchical errors are plotted in <xref ref-type="fig" rid="pcbi.1007043.g014">Fig 14A</xref>. We then considered data from matched control participants (N = 20), who performed the same task. The analysis with the HBI showed that the RL model is more likely for the control group (<xref ref-type="fig" rid="pcbi.1007043.g014">Fig 14B</xref>), suggesting that PD (or dopaminergic medication in PD) increases the discrepancy between the learning rates for positive and negative prediction errors. We finally performed a permutation test to formally test the significance of this difference (1000 permutations). For each permutation, all participants were randomly divided into control and PD groups with the same size as the real control and PD groups. The HBI was then used to fit the same model space to each random group. The relative model frequency statistics (RL vs. dual-<italic>α</italic> RL) was quantified for each permutation. This permutation test confirmed that the dual-<italic>α</italic> RL was significantly more likely than the RL model in PD patients compared with controls (<italic>P</italic> &lt;0.001).</p>
<fig id="pcbi.1007043.g014" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1007043.g014</object-id>
<label>Fig 14</label>
<caption>
<title>Using HBI for making inference on Parkinson’s patients data.</title>
<p>A) HBI has been applied to a dataset of 31 PD patients performing a probabilistic reward and punishment learning task. The model space consisted of a null non-learning (NL) model, RL, and the dual-<italic>α</italic> RL. Protected exceedance probabilities (PXP), model frequencies and estimated parameters of the winning model (the dual-<italic>α</italic> RL) are plotted. The HBI revealed that the dual-<italic>α</italic> RL is more likely across PD patients. B) The same model space was fitted to a dataset of 20 healthy control subjects performing the same task. In contrast to PD patients, the RL model is more likely across the control group. In addition to the decision noise, <italic>β</italic>, and learning rate parameters, both RL models also modeled tendency to repeat or avoid the previous choice regardless of outcomes using a perseveration parameter, <italic>p</italic>. A permutation test revealed that the dual-<italic>α</italic> model is more likely than the RL model in PD compared with the controls. The error-bars are obtained by applying the corresponding transformation function on the hierarchical errors and, therefore, are not necessarily symmetric.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.g014" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec017" sec-type="conclusions">
<title>Discussion</title>
<p>In this work, we have introduced a novel method, a hierarchical and Bayesian inference framework, for parameter estimation and model comparison. The HBI framework is hierarchical in the sense that parameters at the individual level are regularized by statistics across all individuals in the group. The HBI framework is Bayesian in the sense that all uncertainties at both individual and group levels are represented by probability distributions. The HBI framework has major theoretical advantages over current state-of-the-art methods, mainly because it combines, in a single hierarchical structure, two sorts of inference (about model identity and model parameters), which are interdependent but have previously been treated separately. Our simulation results demonstrated these advantages experimentally.</p>
<p>In this work, we took an empirical Bayes approach [<xref ref-type="bibr" rid="pcbi.1007043.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref032">32</xref>], in which priors are constructed based on data. In other words, parameters at the individual level are regularized by statistics across all individuals in the group. Furthermore, we took a so-called random effects approach to model identity [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>], which indicates that different models might underlie data in different subjects. This is in contrast to previous hierarchical methods for model fitting, which assume the same model underlie data in all subjects (fixed effects assumption [<xref ref-type="bibr" rid="pcbi.1007043.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref011">11</xref>]). The random effects approach to hierarchical inference has important consequences for both parameter estimation and model comparison. Moreover, we took a fully Bayesian approach by quantifying uncertainty at the group level, which enabled us to develop statistical tests about group parameters and to quantify corresponding statistical errors.</p>
<p>Empirical Bayes methods play an increasing role in modern statistics. These methods essentially take a hierarchical approach, by assuming that individual data are generated based on the probabilistic properties of the population. This hierarchical approach has important consequences. The most important consequence is that they provide a promising solution to the classical problem of priors in Bayesian statistics by providing informative, yet objective, priors at the individual level. Furthermore, by partly sharing parameters across subjects, they reduce overfitting relative to non-hierarchical models, which in turn allows them to confidently fit more complex models with a smaller penalty for overfitting. This is because non-hierarchical methods assume that the extra parameters of a complex model are independent. For example, consider a model space in which the more complex model has one extra free parameter and there are 40 subjects in the dataset. Fitting the dataset with the complex model using non-hierarchical methods introduces 40 additional independent free parameters, driving the danger of overfitting, and accordingly an excessive penalty to account for this possibility in assessing the evidence for the model. The hierarchical approach, however, assumes that the individual parameters are dependent, as they are all generated according to the same distribution, sharing a single mean parameter and smaller deviations from it. Modeling this hierarchical dependency enables those methods to avoid penalizing complex models as excessively. Our simulation results demonstrate this point experimentally (<xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3D</xref>). While the non-hierarchical method failed to select the correct model with one additional parameter, evidently because the overfitting penalty was too extreme, the HBI was successful in selecting the correct model (<xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3D</xref>).</p>
<p>The HBI method introduced in this paper is built based on the random effects view that different models might underlie data in different subjects. Taking this view enabled us to address problems caused by taking the model identity as a fixed effect in some hierarchical parameter estimation procedures. For parameter estimation, the fixed effects assumption biases the group parameters because it assumes that all subjects contribute equally to the group parameters. The proposed HBI framework solves this problem by weighting contribution of each subject to group statistics by the degree to which that model is likely to be the true underlying model for that subject (Figs <xref ref-type="fig" rid="pcbi.1007043.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1007043.g003">3</xref>). For model comparison, the fixed effects assumption leads to oversensitivity to outliers as the evidence across the group is driven by the sum of individual evidence. Our simulation results (<xref ref-type="fig" rid="pcbi.1007043.g002">Fig 2</xref>) showed that only a few outliers lead to incorrect model selection inference made by the fixed effects assumption. The proposed HBI method solves this problem by normalizing individual evidence across all candidate models. Specifically, the HBI framework quantifies the responsibility of each model <italic>k</italic> in generating each subject data, a metric lying between 0 and 1. For every subject, the responsibility sums up to 1 across all candidate models as it partitions probability space among those models (see [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref019">19</xref>] for a similar non-hierarchical approach). It is then easy to compare models by enumerating responsibilities across the group in favor of each model or by estimating the most likely model.</p>
<p>Another major contribution of this paper is to provide a statistical test, HBI t-test, to the inference problem at the group level using hierarchically fitted parameters. For models fitted by a non-hierarchical method, such as maximum likelihood or Laplace approximation, it is statistically valid to use classical statistical tests on fitted parameters to make inference at the group level. However, for datasets fitted by a hierarchical method in which the individual fits are regularized according to statistics of the group data, conventional statistical tests are not valid, because the parameter estimates are non-independent from subject to subject. Our fully Bayesian approach enabled us to address this issue. Our method provides an intuitive solution to this problem in the form of a t-statistic, in which all the group statistics are computed according to the estimated responsibilities of the corresponding model in generating each individual data. Thus, the HBI quantifies the uncertainty of the group parameters and thereby the corresponding hierarchical errors. Our analysis showed that the HBI performed better than both the NHI and HPE in detecting true effects and also that it was well calibrated, displaying the appropriate number of false positives when effects were absent. Therefore, the HBI framework enables researchers to make statistical claims about parameters at the group level.</p>
<p>It is important, however, to note that the foundation of the HBI t-test is completely different from the classical t-test, as it is a Bayesian (in contrast to frequentist) test using posterior probabilities. In particular, this test is based on the posterior distribution of the statistics of interest (i.e. group mean) marginalized over all other parameters (e.g. group variance), which is given by a Student’s t-distribution (<xref ref-type="disp-formula" rid="pcbi.1007043.e052">Eq 24</xref>). Statistically, the precise claim of the HBI t-test is that whether a specific point is outside of a credible interval, which is the interval that the group parameter value falls with a particular subjective probability. For example, if the HBI t-test indicates that a parameter is significantly different from 0 at <italic>P</italic> &lt;0.05, it means that 0 does not fall within the 95% credible interval. One important difference between Bayesian credible intervals and classical (frequentist) confidence intervals (used in classical Student’s t-test) is that Bayesian credible intervals depend on priors. However, since we used minimally-informative priors (statistically proper priors with very little effects on posteriors, see <xref ref-type="sec" rid="sec018">Materials and methods</xref>), the HBI t-test almost entirely depends on data. In fact, that is the reason that under the null, the HBI t-test generates p-values uniformly as shown by simulations (<xref ref-type="fig" rid="pcbi.1007043.g011">Fig 11</xref>). Notably, the same Student distribution can also be used to accept the null hypothesis for example using a “region of practical equivalence” procedure described by Kruschke [<xref ref-type="bibr" rid="pcbi.1007043.ref033">33</xref>]. It is also possible to employ the more common way and make inference in favor of the null hypothesis using model selection. In this case, one needs to perform a model selection between a model in which the group-level mean of the parameter of interest is fixed at the null value (null model) and compare that with a full HBI with no restriction (alternative model) using Bayes factor (i.e. difference log model evidence).</p>
<p>In addition to model comparison, the HBI framework can also be used for model selection in situations where the goal is to select one of the models as the best model across the group. Exceedance probability is a metric proposed [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>] to perform model selection using a random effects approach. An important revision of this metric called protected exceedance probability [<xref ref-type="bibr" rid="pcbi.1007043.ref019">19</xref>] also takes into account the null possibility that none of the models in model space is supported sufficiently by data, i.e. the differences in model evidence are due to chance. As the HBI framework treats model identity as a random effect, it is possible to compute exceedance and protected exceedance probabilities (Eqs <xref ref-type="disp-formula" rid="pcbi.1007043.e073">26</xref>–<xref ref-type="disp-formula" rid="pcbi.1007043.e012">28</xref>). Note that if this procedure indicates that models’ ability to explain data are not different (i.e. their difference is likely to be due to chance), one cannot rely on estimated parameters, as those are also dependent on estimated model frequencies. In this situation, we recommend to obtain parameters by fitting models separately to data using the HBI, which makes sense as there is no evidence that models are differently expressed across subjects. In our analysis with simulated and empirical data, however, we never encountered this situation as probability of the null (<italic>P</italic><sub>0</sub> in <xref ref-type="disp-formula" rid="pcbi.1007043.e012">Eq 28</xref>) was always very small.</p>
<p>In this study, we compared the performance of the HBI with two alternative methods with different statistical assumptions about the generative process of data. The NHI assumes a hierarchy in model identity for generating individual data. The HPE assumes that parameters are generated in a hierarchical fashion, but assumes no hierarchy regarding model identities. The HBI assumes that both model identity and parameters are generated hierarchically. Importantly, the inference procedure for all these methods is very similar, which allows a fair comparison of them largely based on their statistical assumptions. In particular, the three methods all employ Laplace approximation for making a quadratic approximation of individual-level posteriors. Furthermore, the HBI is based on variational Bayes, which is an extension to the case of multiple latent variables of the expectation-maximization procedure used previously for implementing the HPE [<xref ref-type="bibr" rid="pcbi.1007043.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref011">11</xref>] (see also [<xref ref-type="bibr" rid="pcbi.1007043.ref034">34</xref>] for a variational implementation), which itself extends the one-level Bayesian inference of NHI. There are other ways to make an inference, for example using Markov chain Monte Carlo methods. Future studies should investigate the pros and cons of those methods, compared with the variational Bayes used here, for making inference in HBI.</p>
<p>There are increasing efforts to exploit advances in computational modeling for understanding mental disorders [<xref ref-type="bibr" rid="pcbi.1007043.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1007043.ref006">6</xref>]. Recent works, however, have started to tackle challenges related to quantifying uncertainty in diagnosis and also in the evaluation of treatment effects. For example, hierarchical unsupervised generative modeling, have used Monte-Carlo and variational methods to identify a cluster of subjects showing similar patterns of neural connectivity [<xref ref-type="bibr" rid="pcbi.1007043.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref036">36</xref>]. HBI also offers a promising solution by quantifying uncertainty in model attribution to individuals. Our simulation analyses showed that the HBI performs better than other alternatives in model attribution. This can help us to move towards better diagnosis and precise evaluation of different treatments [<xref ref-type="bibr" rid="pcbi.1007043.ref037">37</xref>].</p>
<p>In summary, the HBI framework proposed in this work rests on a hierarchical view of both hypothesis testing (i.e. model comparison) and parameter estimation for multi-subject studies and thus provides a generic framework for statistical inference. Moreover, the HBI framework runs fully automatically and it does not rely on hand tuning of parameters. Therefore, we expect this method to be useful for a wide range of studies testing different hypotheses in a multi-subject setting. This includes not only computational models of learning and decision making but also any statistical models of brain or behavior.</p>
</sec>
<sec id="sec018" sec-type="materials|methods">
<title>Materials and methods</title>
<p>Here, we give a formal treatment of the HBI framework in seven sections, in which we 1) define the probabilistic model underlying HBI; 2) lay out the basis of our variational approach for making inference (the full proof is given in <xref ref-type="supplementary-material" rid="pcbi.1007043.s004">S1 Appendix</xref>); 3) present the HBI algorithm; 4) derive the HBI t-test; 5) show how HBI can be used for making inference about a new subject; 6) define important practical points, in particular prior parameters, initialization and convergence criteria; 7) give a formal definition of the exceedance and protected exceedance probability. The HBI and its manual are freely available online as part of computational and behavioral modeling (cbm) toolbox: <ext-link ext-link-type="uri" xlink:href="https://payampiray.github.io/cbm.html" xlink:type="simple">https://payampiray.github.io/cbm.html</ext-link>.</p>
<sec id="sec019">
<title>Probabilistic model</title>
<p>We begin by describing the probabilistic model of the HBI. Consider an observed dataset <bold>X</bold> = {<bold>x</bold><sub>1</sub>, …, <bold>x</bold><sub><italic>N</italic></sub>} where <bold>x</bold><sub><italic>n</italic></sub> is the dataset (e.g. choices) of <italic>n</italic>th subject and <italic>N</italic> indicates the number of subjects and a model-space including <italic>K</italic> candidate models, <italic>M</italic><sub>1</sub>…<italic>M</italic><sub><italic>K</italic></sub>. Moreover, suppose that the prior probability of each model in the population is given by <bold>m</bold> = {<italic>m</italic><sub>1</sub>, …, <italic>m</italic><sub><italic>K</italic></sub>}. For each dataset, <bold>x</bold><sub><italic>n</italic></sub>, we assume that there is a latent variable <bold>z</bold><sub><italic>n</italic></sub> comprising a 1-of-K binary random vector, in which <italic>z</italic><sub><italic>kn</italic></sub> is one if <bold>x</bold><sub><italic>n</italic></sub> generated is by the <italic>k</italic>th model. Thus, the probability of the latent variable across all subjects, <bold>Z</bold> = {<bold>z</bold><sub>1</sub>, …, <bold>z</bold><sub><italic>N</italic></sub>}, is assumed to have a multinomial distribution,
<disp-formula id="pcbi.1007043.e013"><alternatives><graphic id="pcbi.1007043.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e013" xlink:type="simple"/><mml:math display="block" id="M13"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>k</mml:mi> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula></p>
<p>Each model <italic>M</italic><sub><italic>k</italic></sub> in the model-space is supposed to compute the probability of a given dataset (e.g. a set of choices) given a set of parameters, <bold>h</bold><sub><italic>kn</italic></sub>. For example, the reinforcement learning model computes the probability of choices using two parameters: a learning rate and a decision noise parameter. The number of models and their structures depend on specific scientific questions. Here, we take a general approach by making no specific assumption about the number of models, <italic>K</italic>. Thus, the <italic>k</italic>th model in the model-space, <italic>M</italic><sub><italic>k</italic></sub>, computes the probability of dataset <bold>x</bold><sub><italic>n</italic></sub> given the parameter vector <bold>h</bold><sub><italic>kn</italic></sub>, which is denoted by <italic>p</italic>(<bold>x</bold><sub><italic>n</italic></sub>|<bold>h</bold><sub><italic>kn</italic></sub>, <italic>M</italic><sub><italic>k</italic></sub>). Note that the number of parameters in model <italic>k</italic>, denoted by <italic>D</italic><sub><italic>k</italic></sub>, might be different across models. Since data for each subject is generated by one of the models, which is denoted in the binary vector <bold>z</bold><sub><italic>n</italic></sub>, the probability of the observed dataset given the model-space is
<disp-formula id="pcbi.1007043.e014"><alternatives><graphic id="pcbi.1007043.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">H</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:mi>p</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <bold>H</bold> denotes all the parameters across all participants and models. The parameters of <italic>k</italic>th model are assumed to have a multivariate normal distribution with mean <italic><bold>μ</bold></italic><sub><italic>k</italic></sub> and precision matrix <bold>T</bold><sub><italic>k</italic></sub>,
<disp-formula id="pcbi.1007043.e015"><alternatives><graphic id="pcbi.1007043.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">H</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:mi mathvariant="script">N</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">T</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <bold>T</bold><sub><italic>k</italic></sub> is a diagonal matrix with positive elements.</p>
<p>We also introduce a distribution over model frequencies, <bold>m</bold>. We use the Dirichlet distribution, which forms the conjugate prior for the multinomial distribution, as the prior:
<disp-formula id="pcbi.1007043.e016"><alternatives><graphic id="pcbi.1007043.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>Dir</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>α</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>C</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msubsup><mml:mi>m</mml:mi> <mml:mi>k</mml:mi> <mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <italic>C</italic>(<italic>α</italic><sub>0</sub>) is the normalizing constant for the Dirichlet distribution.</p>
<p>We also take group parameters <italic><bold>μ</bold></italic> and <bold>T</bold> as random variables, which allows us to evaluate their posterior distribution given data. We introduce conjugate priors for these variables, a Gaussian-Gamma prior in which the distribution over <italic><bold>μ</bold></italic><sub><italic>k</italic></sub> depends on <bold>T</bold><sub><italic>k</italic></sub>:
<disp-formula id="pcbi.1007043.e017"><alternatives><graphic id="pcbi.1007043.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mi mathvariant="bold">T</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007043.e018"><alternatives><graphic id="pcbi.1007043.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">T</mml:mi> <mml:mo>)</mml:mo></mml:mrow><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mi mathvariant="script">G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>v</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1007043.e019"><alternatives><graphic id="pcbi.1007043.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:mi mathvariant="script">G</mml:mi> <mml:mo>(</mml:mo> <mml:mo>.</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> denotes Gamma distribution. Here, <italic>τ</italic><sub><italic>ki</italic></sub> is the <italic>i</italic>th diagonal element of <bold>T</bold><sub><italic>k</italic></sub>. Assuming that <italic><bold>τ</bold></italic><sub><italic>k</italic></sub> is a vector containing <italic>τ</italic><sub><italic>ki</italic></sub>, by defining <bold>T</bold><sub><italic>k</italic></sub> = diag(<italic><bold>τ</bold></italic><sub><italic>k</italic></sub>), in which diag(.) is an operator outputting a diagonal matrix with elements given by <italic><bold>τ</bold></italic><sub><italic>k</italic></sub>, we can write these two equations in a compact form:
<disp-formula id="pcbi.1007043.e020"><alternatives><graphic id="pcbi.1007043.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mtext>diag</mml:mtext> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where we have defined:
<disp-formula id="pcbi.1007043.e021"><alternatives><graphic id="pcbi.1007043.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi mathvariant="script">G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>v</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:munderover> <mml:mi mathvariant="script">G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>τ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi>v</mml:mi> <mml:mo>,</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
in which <italic>v</italic> is a scalar and <bold>s</bold> is a vector with <italic>D</italic><sub><italic>k</italic></sub> elements all equal to <italic>s</italic>. The full probabilistic model is given by,
<disp-formula id="pcbi.1007043.e022"><alternatives><graphic id="pcbi.1007043.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">H</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">H</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>)</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">H</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>)</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mo>)</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>)</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>)</mml:mo> <mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula></p>
</sec>
<sec id="sec020">
<title>Variational inference</title>
<p>The task of Bayesian inference is to compute the posterior probabilities of latent variables given data, <italic>p</italic>(<bold>H</bold>, <bold>Z</bold>, <italic><bold>μ</bold></italic>, <italic><bold>τ</bold></italic>, <bold>m</bold>|<bold>X</bold>). Since the inference is intractable for the probabilistic model outlined in the previous section, we employ variational inference to compute approximate posteriors. We take a so-called mean-field approach [<xref ref-type="bibr" rid="pcbi.1007043.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref017">17</xref>] by assuming that the posterior is partially factorized as follows:
<disp-formula id="pcbi.1007043.e023"><alternatives><graphic id="pcbi.1007043.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e023" xlink:type="simple"/><mml:math display="block" id="M23"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">H</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mo>)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold">H</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>)</mml:mo> <mml:mi>q</mml:mi> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
Note that we force no factorization in the posterior between latent variables, <bold>Z</bold> and <bold>H</bold>. Using a quadratic approximation of the conditional posterior, <italic>q</italic>(<bold>H</bold>|<bold>Z</bold>), we prove in <xref ref-type="supplementary-material" rid="pcbi.1007043.s004">S1 Appendix</xref> that these posteriors are given by,
<disp-formula id="pcbi.1007043.e024"><alternatives><graphic id="pcbi.1007043.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e024" xlink:type="simple"/><mml:math display="block" id="M24"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">H</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msubsup><mml:mi>r</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:msubsup> <mml:mi mathvariant="script">N</mml:mi> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">A</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:msup></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
<disp-formula id="pcbi.1007043.e025"><alternatives><graphic id="pcbi.1007043.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>Dir</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">m</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
<disp-formula id="pcbi.1007043.e026"><alternatives><graphic id="pcbi.1007043.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mtext>diag</mml:mtext> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where 0 ≤ <italic>r</italic><sub><italic>kn</italic></sub> ≤ 1 is the responsibility of model <italic>k</italic> for <italic>n</italic>th subject, <italic><bold>θ</bold></italic><sub><italic>kn</italic></sub> and <bold>A</bold><sub><italic>kn</italic></sub> are the subject-level mean and precision, <italic>ν</italic><sub><italic>k</italic></sub> and <italic>β</italic><sub><italic>k</italic></sub> are scalars and <italic><bold>σ</bold></italic><sub><italic>k</italic></sub> is a vector with the same size as <italic><bold>τ</bold></italic><sub><italic>k</italic></sub>. In the next section, we provide the HBI algorithm, which iteratively updates the parameters of these distributions, <italic>r</italic><sub><italic>kn</italic></sub>, <italic><bold>θ</bold></italic><sub><italic>kn</italic></sub>, <bold>A</bold><sub><italic>kn</italic></sub>, <italic><bold>α</bold></italic>, <bold>a</bold><sub><italic>k</italic></sub>, <italic>ν</italic><sub><italic>k</italic></sub>, <italic>β</italic><sub><italic>k</italic></sub>, and <italic><bold>σ</bold></italic><sub><italic>k</italic></sub>.</p>
</sec>
<sec id="sec021">
<title>HBI algorithm</title>
<p>After initializing the individual parameter estimates, <italic><bold>θ</bold></italic><sub><italic>kn</italic></sub> and <bold>A</bold><sub><italic>kn</italic></sub> and responsibilities <italic>r</italic><sub><italic>kn</italic></sub> for all subjects and models, as well as setting prior parameters <bold>a</bold><sub>0</sub>, <italic>b</italic>, <italic>s</italic>, <italic>v</italic> and <italic>α</italic><sub>0</sub> (which will be defined later), the HBI algorithm performs these steps:
<list list-type="order">
<list-item><p>Calculate the summary statistics:
<disp-formula id="pcbi.1007043.e027"><alternatives><graphic id="pcbi.1007043.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="1.111pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
<disp-formula id="pcbi.1007043.e028"><alternatives><graphic id="pcbi.1007043.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mspace width="0.27771pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.27771pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
<disp-formula id="pcbi.1007043.e029"><alternatives><graphic id="pcbi.1007043.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mspace width="0.55542pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.55542pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>n</mml:mi></mml:munder> <mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>⊤</mml:mo></mml:msubsup> <mml:mo>−</mml:mo> <mml:mspace width="0.27771pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.27771pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mspace width="0.27771pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msubsup><mml:mspace width="0.27771pt"/><mml:mi>k</mml:mi> <mml:mo>⊤</mml:mo></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">A</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p></list-item>
<list-item><p>Update parameters of <italic>q</italic>(<italic><bold>μ</bold></italic>, <italic><bold>τ</bold></italic>, <bold>m</bold>) for all models:
<disp-formula id="pcbi.1007043.e030"><alternatives><graphic id="pcbi.1007043.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="1.111pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub> <mml:mspace width="0.27771pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.27771pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
<disp-formula id="pcbi.1007043.e031"><alternatives><graphic id="pcbi.1007043.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>β</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
<disp-formula id="pcbi.1007043.e032"><alternatives><graphic id="pcbi.1007043.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">s</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mtext>diag</mml:mtext> <mml:mo>(</mml:mo> <mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="1.111pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mspace width="0.55542pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.55542pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:mi>b</mml:mi> <mml:mspace width="1.111pt"/><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="1.111pt"/><mml:mi>k</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>b</mml:mi> <mml:mo>+</mml:mo> <mml:mspace width="1.111pt"/><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="1.111pt"/><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>(</mml:mo> <mml:mspace width="0.27771pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.27771pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mspace width="0.27771pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.27771pt"/><mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⊤</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
<disp-formula id="pcbi.1007043.e033"><alternatives><graphic id="pcbi.1007043.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>v</mml:mi> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
<disp-formula id="pcbi.1007043.e034"><alternatives><graphic id="pcbi.1007043.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula></p></list-item>
<list-item><p>Update the individual posterior parameters <italic><bold>θ</bold></italic><sub><italic>kn</italic></sub>, <bold>A</bold><sub><italic>kn</italic></sub> and <italic>f</italic><sub><italic>kn</italic></sub>, by obtaining a quadratic approximation of the function, <italic>ℓ</italic><sub><italic>kn</italic></sub>(<bold>h</bold>), with respect to <bold>h</bold>:
<disp-formula id="pcbi.1007043.e035"><alternatives><graphic id="pcbi.1007043.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi mathvariant="bold">T</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
where <inline-formula id="pcbi.1007043.e036"><alternatives><graphic id="pcbi.1007043.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007043.e037"><alternatives><graphic id="pcbi.1007043.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mi mathvariant="bold">T</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfrac> <mml:mtext>diag</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. This approximation can be written as
<disp-formula id="pcbi.1007043.e038"><alternatives><graphic id="pcbi.1007043.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≃</mml:mo> <mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo form="prefix">exp</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⊤</mml:mo></mml:msup> <mml:msub><mml:mi mathvariant="bold">A</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">h</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
Note that any quadratic approximation can be used here. For example, using a Laplace quadratic approximation (which is a very common approximation for analyzing behavioral and neural data [<xref ref-type="bibr" rid="pcbi.1007043.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref023">23</xref>]), <italic><bold>θ</bold></italic><sub><italic>kn</italic></sub>, <bold>A</bold><sub><italic>kn</italic></sub> and <italic>f</italic><sub><italic>kn</italic></sub> are given by the mode, Hessian of log <italic>ℓ</italic><sub><italic>kn</italic></sub> and the maximum value of <italic>ℓ</italic><sub><italic>kn</italic></sub>, respectively:
<disp-formula id="pcbi.1007043.e039"><alternatives><graphic id="pcbi.1007043.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo form="prefix">arg</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi mathvariant="bold">h</mml:mi></mml:munder><mml:mtext>log</mml:mtext><mml:msub><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007043.e040"><alternatives><graphic id="pcbi.1007043.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:mo>∇</mml:mo> <mml:mo>∇</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
<disp-formula id="pcbi.1007043.e041"><alternatives><graphic id="pcbi.1007043.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e041" xlink:type="simple"/><mml:math display="block" id="M41"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ℓ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p></list-item>
<list-item><p>Update responsibilities,
<disp-formula id="pcbi.1007043.e042"><alternatives><graphic id="pcbi.1007043.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>r</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:msubsup> <mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where
<disp-formula id="pcbi.1007043.e043"><alternatives><graphic id="pcbi.1007043.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub><mml:mspace width="2pt"/><mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:mrow><mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">A</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
<disp-formula id="pcbi.1007043.e044"><alternatives><graphic id="pcbi.1007043.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mo>λ</mml:mo> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mn>2</mml:mn></mml:mfrac> <mml:mo>(</mml:mo> <mml:mi>ψ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>ν</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>β</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
<disp-formula id="pcbi.1007043.e045"><alternatives><graphic id="pcbi.1007043.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e045" xlink:type="simple"/><mml:math display="block" id="M45"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="2pt"/><mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ψ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mi>ψ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi>α</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
in which <italic>ψ</italic>(.) is the digamma function.</p></list-item>
<list-item><p>Terminate if stopping criteria are met, otherwise go to 1.</p></list-item>
</list></p>
</sec>
<sec id="sec022">
<title>Statistical tests for group parameters</title>
<p>An important goal of computational modeling studies is to compute the distribution of parameters given data across the whole population. From a Bayesian viewpoint, this is given by the marginal posterior over the mean of group parameters, <italic><bold>μ</bold></italic><sub><italic>k</italic></sub>, which reads
<disp-formula id="pcbi.1007043.e046"><alternatives><graphic id="pcbi.1007043.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>≃</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>q</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">G</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mi>t</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1007043.e047"><alternatives><graphic id="pcbi.1007043.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>2</mml:mn> <mml:mi>v</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the number of degrees of freedom of the Student distribution and <inline-formula id="pcbi.1007043.e048"><alternatives><graphic id="pcbi.1007043.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mi>β</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msubsup><mml:mi mathvariant="bold-italic">σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the inverse-scale parameter. Therefore, the random variable <inline-formula id="pcbi.1007043.e049"><alternatives><graphic id="pcbi.1007043.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:mi mathvariant="bold">t</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi mathvariant="bold-italic">η</mml:mi> <mml:mi>k</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> takes a form of standard Student distribution with <italic>n</italic><sub><italic>k</italic></sub> degrees of freedom. By defining <inline-formula id="pcbi.1007043.e050"><alternatives><graphic id="pcbi.1007043.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>2</mml:mn> <mml:msub><mml:mi>β</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfrac> <mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, in which <inline-formula id="pcbi.1007043.e051"><alternatives><graphic id="pcbi.1007043.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msubsup><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> corresponds to empirical variance (c.f. <xref ref-type="disp-formula" rid="pcbi.1007043.e032">Eq (16)</xref>), we can write this result in an intuitive form,
<disp-formula id="pcbi.1007043.e052"><alternatives><graphic id="pcbi.1007043.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e052" xlink:type="simple"/><mml:math display="block" id="M52"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">S</mml:mi> <mml:mi>t</mml:mi> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:mfrac> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
Noting the similarity between <inline-formula id="pcbi.1007043.e053"><alternatives><graphic id="pcbi.1007043.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> and the standard error of the mean, we called <inline-formula id="pcbi.1007043.e054"><alternatives><graphic id="pcbi.1007043.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msqrt><mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> the hierarchical error. Note that if we assume <italic>v</italic> = 0.5 (which is reasonable as explained later), we obtain <inline-formula id="pcbi.1007043.e055"><alternatives><graphic id="pcbi.1007043.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec023">
<title>Predictive distribution for a new subject</title>
<p>In many situations, researchers are interested to fit a new dataset to a particular model and find corresponding parameters. In Bayesian statistics, this is called the predictive distribution and it is given by marginalizing over group parameters. Suppose that <bold>x</bold>* and <inline-formula id="pcbi.1007043.e056"><alternatives><graphic id="pcbi.1007043.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> denote the new dataset and its corresponding parameters for model <italic>k</italic>. The marginal distribution <inline-formula id="pcbi.1007043.e057"><alternatives><graphic id="pcbi.1007043.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>z</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the predictive distribution given the observed dataset <bold>X</bold> assuming that the new data is generated by the <italic>k</italic>th model. This distribution is given by:
<disp-formula id="pcbi.1007043.e058"><alternatives><graphic id="pcbi.1007043.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>z</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>∫</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>z</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:msub><mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mi>d</mml:mi> <mml:msub><mml:mi mathvariant="bold-italic">τ</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">S</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msub><mml:mi mathvariant="bold-italic">η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic><bold>η</bold></italic><sub><italic>k</italic></sub> and <italic>n</italic><sub><italic>k</italic></sub> have been defined in the previous section. This distribution can also be written in terms of standard Student distribution with <italic>n</italic><sub><italic>k</italic></sub> degrees of freedom. Furthermore, if we assume that <italic>b</italic> = 2<italic>v</italic>, which is a reasonable assumption (see the next section), this distribution is given by
<disp-formula id="pcbi.1007043.e059"><alternatives><graphic id="pcbi.1007043.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi>z</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">S</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>diag</mml:mtext> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <bold>s</bold><sub><italic>k</italic></sub> is a vector of corresponding empirical deviance parameters, defined in the previous section. Using this joint distribution, one can use sampling methods to obtain the posterior over parameters, <inline-formula id="pcbi.1007043.e060"><alternatives><graphic id="pcbi.1007043.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:mi>p</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi mathvariant="bold">h</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>|</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold">X</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, or to obtain the maximum-a-posteriori parameters, <inline-formula id="pcbi.1007043.e061"><alternatives><graphic id="pcbi.1007043.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msubsup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, given by
<disp-formula id="pcbi.1007043.e062"><alternatives><graphic id="pcbi.1007043.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e062" xlink:type="simple"/><mml:math display="block" id="M62"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold-italic">θ</mml:mi> <mml:mi>k</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo form="prefix">arg</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi mathvariant="bold">h</mml:mi></mml:munder><mml:mtext>log</mml:mtext><mml:mi>p</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi mathvariant="bold">x</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi mathvariant="script">S</mml:mi> <mml:mi>t</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>diag</mml:mtext> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi mathvariant="bold">s</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold">h</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold">a</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>|</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
Note that for many degrees of freedom due to large values of <inline-formula id="pcbi.1007043.e063"><alternatives><graphic id="pcbi.1007043.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, the Student distribution tends to a Gaussian with mean <bold>a</bold><sub><italic>k</italic></sub> and deviance matrix diag(<bold>s</bold><sub><italic>k</italic></sub>). However, small values of <inline-formula id="pcbi.1007043.e064"><alternatives><graphic id="pcbi.1007043.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:msub><mml:mrow><mml:mover><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mo>¯</mml:mo></mml:mover></mml:mrow> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula> lead to a small number of degrees of freedom and heavier tailed distributions than Gaussians, which are more robust against outliers.</p>
</sec>
<sec id="sec024">
<title>Parameters, initialization and convergence criteria</title>
<p>As the mean-field variational inference is an iterative framework, it also depends on the initialization of the parameters. In this section, we provide priors that do not bias the final solution and also provide some intuitive criteria for the initialization.</p>
<p>We initialize the parameters <italic><bold>θ</bold></italic><sub><italic>kn</italic></sub> and <bold>A</bold><sub><italic>kn</italic></sub> by fitting all models separately to all participants (with some initial Gaussian prior), i.e., assuming as if <italic>z</italic><sub><italic>kn</italic></sub> = 1. These values are then used to calculate summary statistics according to Eqs <xref ref-type="disp-formula" rid="pcbi.1007043.e027">(11)</xref>–<xref ref-type="disp-formula" rid="pcbi.1007043.e029">(13)</xref>.</p>
<p>Furthermore, we need to define prior parameters. The free parameter <italic>α</italic><sub>0</sub> indicates prior frequency of each model. We take uninformative priors on frequency of models, which is given by <italic>α</italic><sub>0</sub> = 1 for all models. The prior mean, <bold>a</bold><sub>0<italic>k</italic></sub>, is assumed to be zero. Given <xref ref-type="disp-formula" rid="pcbi.1007043.e031">Eq (15)</xref>, we see that <italic>b</italic> can be interpreted as the effective number of prior samples associated with models. Also, given <xref ref-type="disp-formula" rid="pcbi.1007043.e033">Eq (17)</xref>, <italic>v</italic> could be interpreted as the half of the effective number of prior samples associated with models. Assuming that the priors account for one sample, which is a common assumption in Bayesian statistics, we take <italic>b</italic> = 1 and <inline-formula id="pcbi.1007043.e065"><alternatives><graphic id="pcbi.1007043.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:mi>v</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. Finally, since <italic>s</italic> has always an additive effect on <italic><bold>σ</bold></italic><sub><italic>k</italic></sub> according to <xref ref-type="disp-formula" rid="pcbi.1007043.e032">Eq (16)</xref>, we assume a small positive value for <italic>s</italic>, allowing that <italic><bold>σ</bold></italic><sub><italic>k</italic></sub> to be driven dominantly by data. In all our analyses, we assumed <italic>s</italic> = 0.01. It is also important to note that by choosing a small value for <italic>s</italic>, we ensure that if a model loses entirely (takes no responsibility), its corresponding parameters at the individual level converge to the prior mean, <bold>a</bold><sub>0<italic>k</italic></sub>, with a very small variance.</p>
<p>Finally, the HBI algorithm presented above requires stopping criteria. In our analyses, we terminated the algorithm if the change in normalized value of parameters between two consecutive iterations, <italic>j</italic> − 1 and <italic>j</italic>, defined as
<disp-formula id="pcbi.1007043.e066"><alternatives><graphic id="pcbi.1007043.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e066" xlink:type="simple"/><mml:math display="block" id="M66"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mover accent="true"><mml:mi>d</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:msqrt><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>K</mml:mi></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>k</mml:mi></mml:munder> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>D</mml:mi> <mml:mi>k</mml:mi></mml:msub></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>−</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:msqrt> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
was smaller than 0.01. Here, <inline-formula id="pcbi.1007043.e067"><alternatives><graphic id="pcbi.1007043.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is defined according to summary statistics of parameters on the <italic>j</italic>th iteration:
<disp-formula id="pcbi.1007043.e068"><alternatives><graphic id="pcbi.1007043.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e068" xlink:type="simple"/><mml:math display="block" id="M68"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>j</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mspace width="0.27771pt"/><mml:mover><mml:mrow><mml:mi>θ</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.27771pt"/><mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:mspace width="0.55542pt"/><mml:mover><mml:mrow><mml:mi>V</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msubsup><mml:mspace width="0.55542pt"/><mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1007043.e069"><alternatives><graphic id="pcbi.1007043.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:mrow><mml:mspace width="0.27771pt"/><mml:mover><mml:mrow><mml:mi>θ</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.27771pt"/><mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007043.e070"><alternatives><graphic id="pcbi.1007043.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e070" xlink:type="simple"/><mml:math display="inline" id="M70"><mml:mrow><mml:mspace width="0.55542pt"/><mml:mover><mml:mrow><mml:mi>V</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.55542pt"/><mml:mrow><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> are the <italic>i</italic>th element of <inline-formula id="pcbi.1007043.e071"><alternatives><graphic id="pcbi.1007043.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e071" xlink:type="simple"/><mml:math display="inline" id="M71"><mml:mrow><mml:mspace width="0.27771pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold-italic">θ</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.27771pt"/><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1007043.e072"><alternatives><graphic id="pcbi.1007043.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:mspace width="0.55542pt"/><mml:mover><mml:mrow><mml:mi mathvariant="bold">V</mml:mi></mml:mrow> <mml:mo>¯</mml:mo></mml:mover> <mml:msub><mml:mspace width="0.55542pt"/><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> defined in (<xref ref-type="disp-formula" rid="pcbi.1007043.e028">12</xref> and <xref ref-type="disp-formula" rid="pcbi.1007043.e029">13</xref>), respectively. In our analyses, we also set 50 as the maximum number of iterations, although almost always the algorithm stopped before hitting this number.</p>
</sec>
<sec id="sec025">
<title>Exceedance probability and protected exceedance probability</title>
<p>Using the posterior over <bold>m</bold>, one can also derive the so-called exceedance probability and protected exceedance probability, as defined in previous works [<xref ref-type="bibr" rid="pcbi.1007043.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1007043.ref019">19</xref>]. We reproduce the equations here for completeness.</p>
<p>The exceedance probability of <italic>k</italic>th model, <italic>ϕ</italic><sub><italic>k</italic></sub>, is defined as the probability that model <italic>M</italic><sub><italic>k</italic></sub> is more likely than any other model in the model-space and it is given by
<disp-formula id="pcbi.1007043.e073"><alternatives><graphic id="pcbi.1007043.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e073" xlink:type="simple"/><mml:math display="block" id="M73"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mtext>Prob</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>m</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">α</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:mo>∀</mml:mo> <mml:mi>j</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>k</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
Computing protected exceedance probabilities, as defined in [<xref ref-type="bibr" rid="pcbi.1007043.ref019">19</xref>], also requires to run the HBI under the (prior) null hypothesis, <italic>H</italic><sub>0</sub>, that there is no difference between models (i.e. <italic>α</italic><sub>0</sub> → ∞). The alternative hypothesis, <italic>H</italic><sub>1</sub>, is the original case, in which <italic>α</italic><sub>0</sub> = 1. If we define <italic>L</italic> and <italic>L</italic><sub>0</sub> as the log-likelihood (actually the variational lower bound as its approximation) of all data given the model-space under <italic>H</italic><sub>1</sub> and <italic>H</italic><sub>0</sub>, respectively, then the protected exceedance probability of <italic>k</italic>th model, <inline-formula id="pcbi.1007043.e074"><alternatives><graphic id="pcbi.1007043.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub></mml:math></alternatives></inline-formula>, is defined as:
<disp-formula id="pcbi.1007043.e075"><alternatives><graphic id="pcbi.1007043.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e075" xlink:type="simple"/><mml:math display="block" id="M75"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>K</mml:mi></mml:mfrac> <mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula>
where
<disp-formula id="pcbi.1007043.e012"><alternatives><graphic id="pcbi.1007043.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1007043.e012" xlink:type="simple"/><mml:math display="block" id="M12"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mi>L</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi>L</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
Note that if <italic>P</italic><sub>0</sub> is close to 1, then model frequencies should be ignored, as the difference between models in the model space is due to chance. Furthermore, if data does not support any model, i.e. <italic>P</italic><sub>0</sub> is close to 1, then parameters should be estimated by fitting each model separately using the HBI.</p>
</sec>
</sec>
<sec id="sec026">
<title>Supporting information</title>
<supplementary-material id="pcbi.1007043.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary methods.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007043.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>A control analysis assessing the effects of prior variance on NHI performance.</title>
<p>In scenario 1, similar to the analysis presented in the main text (<xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3</xref>), 10 and 30 subjects generated with the RL and dual-<italic>α</italic> RL models, respectively. Conversely, in scenario 2, the RL model is more likely (30 subjects) than the dual-<italic>α</italic> RL model (10 subjects). In A and C, protected exceedance probability (PXP) as a function of prior variance is plotted in scenario 1 and 2, respectively. In B and D, estimation error for the learning rate parameter of RL is plotted in scenarios 1 and 2, respectively. The simulations show in general that no single prior is flexible enough to capture the different scenarios. In particular, while narrowing the prior reduces the complexity penalty (and thus somewhat improves model selection in scenario 1, when the more complex model should be favored), it also worsens parameter estimation in both scenarios. This is because the learning rates for the two models are, generatively, different, and a narrow prior cannot support both at once. Here, the true value of the RL learning rate was 0.1, which was quite away from the prior mean (i.e. 0.5), making it difficult for a narrower variance to capture it. Finally, this poor parameter estimation for the RL model has negative consequences also for model selection in scenario 2 (where the RL model should be favored, but the evidence for it is hampered by poor fit to the learning rate with smaller prior variance). The parameters used in this simulation are the same as those used in the original simulation analyses (Figs <xref ref-type="fig" rid="pcbi.1007043.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1007043.g004">4</xref>). Median across 100 simulations is plotted. Errorbars indicate the first and third quantiles. The prior variance in all simulation analyses of the main text is 6.25.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007043.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>A control simulation analysis extending that from <xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3</xref>, with different settings of learning rates for simulating data.</title>
<p>The same parameters as in <xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3</xref> were used for simulations here, with the only difference that the learning rate parameter for the RL model was different here. In particular, the true learning rate of the RL was in the middle of those for the dual-<italic>α</italic> RL (for RL: <italic>α</italic> = 0.6; for dual-<italic>α</italic> RL: <italic>α</italic><sup>+</sup> = 0.8, <italic>α</italic><sup>−</sup> = 0.4). The difference between parameter estimation performance of the HPE and HBI is not as pronounced as in <xref ref-type="fig" rid="pcbi.1007043.g003">Fig 3</xref>, which is expected theoretically.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1007043.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1007043.s004" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Formal derivations of the HBI algorithm.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1007043.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Hampton</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>H</given-names></name>. <source>Model-Based fMRI and Its Application to Reward Learning and Decision Making</source>;<volume>1104</volume>:<fpage>35</fpage>–<lpage>53</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>. <source>The Computational Neurobiology of Learning and Reward</source>;<volume>16</volume>(<issue>2</issue>):<fpage>199</fpage>–<lpage>204</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Maia</surname> <given-names>TV</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>. <source>From Reinforcement Learning Models to Psychiatric and Neurological Disorders</source>;<volume>14</volume>(<issue>2</issue>):<fpage>154</fpage>–<lpage>162</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Montague</surname> <given-names>PR</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <source>Computational Psychiatry</source>;<volume>16</volume>(<issue>1</issue>):<fpage>72</fpage>–<lpage>80</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Montague</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <source>Computational Psychiatry: The Brain as a Phantastic Organ</source>;<volume>1</volume>(<issue>2</issue>):<fpage>148</fpage>–<lpage>158</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huys</surname> <given-names>QJM</given-names></name>, <name name-style="western"><surname>Maia</surname> <given-names>TV</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>. <source>Computational Psychiatry as a Bridge from Neuroscience to Clinical Applications</source>;<volume>19</volume>(<issue>3</issue>):<fpage>404</fpage>–<lpage>413</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Harrison</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>W</given-names></name>. <source>Dynamic Causal Modelling</source>;<volume>19</volume>(<issue>4</issue>):<fpage>1273</fpage>–<lpage>1302</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>Moran</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>den Ouden</surname> <given-names>HEM</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <source>Ten Simple Rules for Dynamic Causal Modeling</source>;<volume>49</volume>(<issue>4</issue>):<fpage>3099</fpage>–<lpage>3109</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohen</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Engelhardt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hasson</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <source>Computational Approaches to fMRI Analysis</source>;<volume>20</volume>(<issue>3</issue>):<fpage>304</fpage>–<lpage>313</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huys</surname> <given-names>QJM</given-names></name>, <name name-style="western"><surname>Cools</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gölzer</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Friedel</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Heinz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>, <etal>et al</etal>. <source>Disentangling the Roles of Approach, Activation and Valence in Instrumental and Pavlovian Responding</source>;<volume>7</volume>(<issue>4</issue>):<fpage>e1002028</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huys</surname> <given-names>QJM</given-names></name>, <name name-style="western"><surname>Eshel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>O’Nions</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Roiser</surname> <given-names>JP</given-names></name>. <source>Bonsai Trees in Your Head: How the Pavlovian System Sculpts Goal-Directed Choices by Pruning Decision Trees</source>;<volume>8</volume>(<issue>3</issue>):<fpage>e1002410</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wiecki</surname> <given-names>TV</given-names></name>, <name name-style="western"><surname>Sofer</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>. <source>HDDM: Hierarchical Bayesian Estimation of the Drift-Diffusion Model in Python</source>;<volume>7</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moran</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <source>Bayesian Model Selection for Group Studies</source>;<volume>46</volume>(<issue>4</issue>):<fpage>1004</fpage>–<lpage>1017</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dempster</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Laird</surname> <given-names>NM</given-names></name>, <name name-style="western"><surname>Rubin</surname> <given-names>DB</given-names></name>. <source>Maximum Likelihood from Incomplete Data via the EM Algorithm</source>;<volume>39</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Piray</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Zeighami</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bahrami</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Eissa</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Hewedi</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Moustafa</surname> <given-names>AA</given-names></name>. <source>Impulse Control Disorders in Parkinson’s Disease Are Associated with Dysfunction in Stimulus Valuation but Not Action Valuation</source>;<volume>34</volume>(<issue>23</issue>):<fpage>7814</fpage>–<lpage>7824</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.4063-13.2014" xlink:type="simple">10.1523/JNEUROSCI.4063-13.2014</ext-link></comment> <object-id pub-id-type="pmid">24899705</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007043.ref016">
<label>16</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Ghahramani</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Jaakkola</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Saul</surname> <given-names>LK</given-names></name>. <chapter-title>An Introduction to Variational Methods for Graphical Models</chapter-title>. In: <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>, editor. <source>Learning in Graphical Models. NATO ASI Series</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>Dordrecht</publisher-loc>;. p. <fpage>105</fpage>–<lpage>161</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://link.springer.com/chapter/10.1007/978-94-011-5014-9_5" xlink:type="simple">https://link.springer.com/chapter/10.1007/978-94-011-5014-9_5</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref017">
<label>17</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bishop</surname> <given-names>CM</given-names></name>. <source>Pattern Recognition and Machine Learning</source>. <publisher-name>Springer</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref018">
<label>18</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Neal</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>. <chapter-title>A View of the Em Algorithm That Justifies Incremental, Sparse, and Other Variants</chapter-title>. In: <name name-style="western"><surname>Jordan</surname> <given-names>MI</given-names></name>, editor. <source>Learning in Graphical Models. NATO ASI Series</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>Dordrecht</publisher-loc>;. p. <fpage>355</fpage>–<lpage>368</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="https://link.springer.com/chapter/10.1007/978-94-011-5014-9_12" xlink:type="simple">https://link.springer.com/chapter/10.1007/978-94-011-5014-9_12</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rigoux</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>. <source>Bayesian Model Selection for Group Studies—Revisited</source>;<volume>84</volume>:<fpage>971</fpage>–<lpage>985</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friston</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Mattout</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Trujillo-Barreto</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ashburner</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Penny</surname> <given-names>W</given-names></name>. <source>Variational Free Energy and the Laplace Approximation</source>;<volume>34</volume>(<issue>1</issue>):<fpage>220</fpage>–<lpage>234</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>den Ouden</surname> <given-names>HEM</given-names></name>, <name name-style="western"><surname>Pessiglione</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kiebel</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <source>Observing the Observer (I): Meta-Bayesian Models of Learning and Decision-Making</source>;<volume>5</volume>(<issue>12</issue>):<fpage>e15554</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Daunizeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Adam</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Rigoux</surname> <given-names>L</given-names></name>. <source>VBA: A Probabilistic Treatment of Nonlinear Models for Neurobiological and Behavioural Data</source>;<volume>10</volume>(<issue>1</issue>):<fpage>e1003441</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref023">
<label>23</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <chapter-title>Trial-by-Trial Data Analysis Using Computational Models</chapter-title>. In: <name name-style="western"><surname>Delgado</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Phelps</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Robbins</surname> <given-names>TW</given-names></name>, editors. <source>Decision Making, Affect, and Learning: Attention and Performance XXIII</source>. <publisher-name>Oxford University Press</publisher-name>;. p. <fpage>3</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Piray</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ly</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Roelofs</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Cools</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Toni</surname> <given-names>I</given-names></name>. <source>Emotionally Aversive Cues Suppress Neural Systems Underlying Optimal Learning in Socially Anxious Individuals</source>;<volume>39</volume>(<issue>8</issue>):<fpage>1445</fpage>–<lpage>1456</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Moustafa</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Haughey</surname> <given-names>HM</given-names></name>, <name name-style="western"><surname>Curran</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Hutchison</surname> <given-names>KE</given-names></name>. <source>Genetic Triple Dissociation Reveals Multiple Roles for Dopamine in Reinforcement Learning</source>;<volume>104</volume>(<issue>41</issue>):<fpage>16311</fpage>–<lpage>16316</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Piray</surname> <given-names>P</given-names></name>. <source>The Role of Dorsal Striatal D2-like Receptors in Reversal Learning: A Reinforcement Learning Viewpoint</source>;<volume>31</volume>(<issue>40</issue>):<fpage>14049</fpage>–<lpage>14050</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <source>Model-Based Influences on Humans’ Choices and Striatal Prediction Errors</source>;<volume>69</volume>(<issue>6</issue>):<fpage>1204</fpage>–<lpage>1215</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Piray</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Toni</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Cools</surname> <given-names>R</given-names></name>. <source>Human Choice Strategy Varies with Anatomical Projections from Ventromedial Prefrontal Cortex to Medial Striatum</source>;<volume>36</volume>(<issue>10</issue>):<fpage>2857</fpage>–<lpage>2867</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Seeberger</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>O’reilly</surname> <given-names>RC</given-names></name>. <source>By Carrot or by Stick: Cognitive Reinforcement Learning in Parkinsonism</source>;<volume>306</volume>(<issue>5703</issue>):<fpage>1940</fpage>–<lpage>1943</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1102941" xlink:type="simple">10.1126/science.1102941</ext-link></comment> <object-id pub-id-type="pmid">15528409</object-id></mixed-citation>
</ref>
<ref id="pcbi.1007043.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rutledge</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Lazzaro</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Lau</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Myers</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Gluck</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Glimcher</surname> <given-names>PW</given-names></name>. <source>Dopaminergic Drugs Modulate Learning Rates and Perseveration in Parkinson’s Patients in a Dynamic Foraging Task</source>;<volume>29</volume>(<issue>48</issue>):<fpage>15104</fpage>–<lpage>15114</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref031">
<label>31</label>
<mixed-citation publication-type="other" xlink:type="simple">Robbins H. An Empirical Bayes Approach to Statistics. The Regents of the University of California;. Available from: <ext-link ext-link-type="uri" xlink:href="https://projecteuclid.org/euclid.bsmsp/1200501653" xlink:type="simple">https://projecteuclid.org/euclid.bsmsp/1200501653</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Casella</surname> <given-names>G</given-names></name>. <source>An Introduction to Empirical Bayes Data Analysis</source>;<volume>39</volume>(<issue>2</issue>):<fpage>83</fpage>–<lpage>87</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kruschke</surname> <given-names>JK</given-names></name>. <source>Bayesian Estimation Supersedes the t Test</source>;<volume>142</volume>(<issue>2</issue>):<fpage>573</fpage>–<lpage>603</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref034">
<label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Daunizeau J. Variational Bayesian Modelling of Mixed-Effects.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Raman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Deserno</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Schlagenhauf</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>. <source>A Hierarchical Model for Integrating Unsupervised Generative Embedding and Empirical Bayes</source>;<volume>269</volume>:<fpage>6</fpage>–<lpage>20</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yao</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Raman</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Schiek</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Leff</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Frässle</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>. <source>Variational Bayesian Inversion for Hierarchical Unsupervised Generative Embedding (HUGE)</source>;<volume>179</volume>:<fpage>604</fpage>–<lpage>619</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1007043.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stephan</surname> <given-names>KE</given-names></name>, <name name-style="western"><surname>Schlagenhauf</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Huys</surname> <given-names>QJM</given-names></name>, <name name-style="western"><surname>Raman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Aponte</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Brodersen</surname> <given-names>KH</given-names></name>, <etal>et al</etal>. <source>Computational Neuroimaging Strategies for Single Patient Predictions</source>;<volume>145</volume>:<fpage>180</fpage>–<lpage>199</lpage>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>