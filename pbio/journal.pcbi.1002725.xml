<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta>
      <journal-id journal-id-type="publisher-id">plos</journal-id>
      <journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
      <journal-id journal-id-type="pmc">ploscomp</journal-id>
      <journal-title-group>
        <journal-title>PLoS Computational Biology</journal-title>
      </journal-title-group>
      <issn pub-type="ppub">1553-734X</issn>
      <issn pub-type="epub">1553-7358</issn>
      <publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher>
    </journal-meta>
    <article-meta>
      <article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00556</article-id>
      <article-id pub-id-type="doi">10.1371/journal.pcbi.1002725</article-id>
      <article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Biology</subject>
          <subj-group>
            <subject>Computational biology</subject>
            <subj-group>
              <subject>Genomics</subject>
              <subj-group>
                <subject>Genome analysis tools</subject>
                <subj-group>
                  <subject>Genetic networks</subject>
                </subj-group>
              </subj-group>
              <subj-group>
                <subject>Functional genomics</subject>
              </subj-group>
            </subj-group>
            <subj-group>
              <subject>Regulatory networks</subject>
            </subj-group>
          </subj-group>
          <subj-group>
            <subject>Genomics</subject>
            <subj-group>
              <subject>Functional genomics</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Computer science</subject>
          <subj-group>
            <subject>Algorithms</subject>
          </subj-group>
          <subj-group>
            <subject>Computing methods</subject>
            <subj-group>
              <subject>Computer inferencing</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Genetics and Genomics</subject>
          <subject>Computational Biology</subject>
          <subject>Computer Science</subject>
        </subj-group>
      </article-categories>
      <title-group>
        <article-title>A Graphical Modelling Approach to the Dissection of Highly Correlated Transcription Factor Binding Site Profiles</article-title>
        <alt-title alt-title-type="running-head">Dissection of TF Binding Site Profiles</alt-title>
      </title-group>
      <contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Stojnic</surname>
            <given-names>Robert</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Fu</surname>
            <given-names>Audrey Qiuyan</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff3">
            <sup>3</sup>
          </xref>
          <xref ref-type="fn" rid="fn1">
            <sup>¤</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Adryan</surname>
            <given-names>Boris</given-names>
          </name>
          <xref ref-type="aff" rid="aff1">
            <sup>1</sup>
          </xref>
          <xref ref-type="aff" rid="aff2">
            <sup>2</sup>
          </xref>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
      </contrib-group>
      <aff id="aff1">
        <label>1</label>
        <addr-line>Cambridge Systems Biology Centre, University of Cambridge, Cambridge, United Kingdom</addr-line>
      </aff>
      <aff id="aff2">
        <label>2</label>
        <addr-line>Department of Genetics, University of Cambridge, Cambridge, United Kingdom</addr-line>
      </aff>
      <aff id="aff3">
        <label>3</label>
        <addr-line>Department of Physiology, Development and Neuroscience, University of Cambridge, Cambridge, United Kingdom</addr-line>
      </aff>
      <contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Noble</surname>
            <given-names>William Stafford</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group>
      <aff id="edit1">
        <addr-line>University of Washington, United States of America</addr-line>
      </aff>
      <author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">adryan@sysbiol.cam.ac.uk</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: RS AQF BA. Performed the experiments: RS AQF. Analyzed the data: RS AQF BA. Wrote the paper: RS AQF BA.</p>
        </fn>
        <fn id="fn1" fn-type="current-aff">
          <label>¤</label>
          <p>Current address: Department of Human Genetics, University of Chicago, Chicago, Illinois, United States of America.</p>
        </fn>
      </author-notes>
      <pub-date pub-type="collection">
        <month>11</month>
        <year>2012</year>
      </pub-date>
      <pub-date pub-type="epub">
        <day>8</day>
        <month>11</month>
        <year>2012</year>
      </pub-date>
      <volume>8</volume>
      <issue>11</issue>
      <elocation-id>e1002725</elocation-id>
      <history>
        <date date-type="received">
          <day>5</day>
          <month>4</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>1</day>
          <month>8</month>
          <year>2012</year>
        </date>
      </history>
      <permissions>
        <copyright-year>2012</copyright-year>
        <copyright-holder>Stojnic et al</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions>
      <abstract>
        <p>Inferring the combinatorial regulatory code of transcription factors (TFs) from genome-wide TF binding profiles is challenging. A major reason is that TF binding profiles significantly overlap and are therefore highly correlated. Clustered occurrence of multiple TFs at genomic sites may arise from chromatin accessibility and local cooperation between TFs, or binding sites may simply appear clustered if the profiles are generated from diverse cell populations. Overlaps in TF binding profiles may also result from measurements taken at closely related time intervals. It is thus of great interest to distinguish TFs that <italic>directly</italic> regulate gene expression from those that are <italic>indirectly</italic> associated with gene expression. Graphical models, in particular Bayesian networks, provide a powerful mathematical framework to infer different types of dependencies. However, existing methods do not perform well when the features (here: TF binding profiles) are highly correlated, when their association with the biological outcome is weak, and when the sample size is small. Here, we develop a novel computational method, the Neighbourhood Consistent PC (NCPC) algorithms, which deal with these scenarios much more effectively than existing methods do. We further present a novel graphical representation, the Direct Dependence Graph (DDGraph), to better display the complex interactions among variables. NCPC and DDGraph can also be applied to other problems involving highly correlated biological features. Both methods are implemented in the R package <italic>ddgraph</italic>, available as part of Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.11/bioc/html/ddgraph.html" xlink:type="simple">http://bioconductor.org/packages/2.11/bioc/html/ddgraph.html</ext-link>). Applied to real data, our method identified TFs that specify different classes of cis-regulatory modules (CRMs) in Drosophila mesoderm differentiation. Our analysis also found depletion of the early transcription factor Twist binding at the CRMs regulating expression in visceral and somatic muscle cells at later stages, which suggests a CRM-specific repression mechanism that so far has not been characterised for this class of mesodermal CRMs.</p>
      </abstract>
      <abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>Transcription factors (TFs) are proteins that bind to DNA and regulate gene expression. Recent technological advances make it possible to map TF binding patterns across the whole genome. Multiple single-gene studies showed that combinatorial binding of multiple transcription factors determines the gene transcriptional output. A common naive assumption is that correlated binding profiles may indicate combinatorial binding. However, it has been found that many TFs bind to distinct hotspots whose role is currently unclear. It is thus of great interest to find transcription factor combinations whose correlated binding is causally most immediate to gene expression. Building upon theories of statistical dependence and causality, we develop novel graphical modelbased algorithms that handle highly correlated transcription factor binding profiles more efficiently and reliably than existing algorithms do. These algorithms can also be applied to other biological areas involving highly correlated variables, such as the analysis of high-throughput gene knock-down experiments.</p>
      </abstract>
      <funding-group>
        <funding-statement>RS is supported by a Cambridge International PhD Scholarship and BA is a Royal Society University Research Fellow. This work is supported in part by a Wellcome Trust project grant to BA. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group>
      <counts>
        <page-count count="13"/>
      </counts>
    </article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>A major area in genome research is understanding how the regulatory information is encoded. Work over the past few decades has resulted in the notion of a combinatorial regulatory code: the concerted binding of a context-specific set of transcription factors (TFs) to regulatory sequences, which is crucial for proper gene expression. Studies of a handful of single genes and their few well-characterised enhancers prevailed in the early days (see <xref ref-type="bibr" rid="pcbi.1002725-Davidson1">[1]</xref> for review). The traditionally experimental dissection of enhancers allowed the placing of TFs within a regulatory hierarchy. A canonical example of this traditional dissection is the identification of the various stripe enhancers of the <italic>Drosophila</italic> even-skipped gene that respond to different TFs involved in early patterning (see <xref ref-type="bibr" rid="pcbi.1002725-Akam1">[2]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Ingham1">[3]</xref> for review). With the advent of genome-wide detection methods, hundreds of genome-wide TF binding and histone modification profiles have been generated <xref ref-type="bibr" rid="pcbi.1002725-ENCODE1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1002725-Consortium1">[6]</xref> with the aim of deciphering the combinatorial regulatory code at the global level. Whereas the inference of the regulatory code may greatly benefit from having additional data, such as the expression patterns of the genes of interest under mutant conditions, it is often difficult to collect at the genome level. In the absence of such additional data, a typical strategy is to assume that correlation in TF binding indicates functional interaction between TFs, and to perform correlation-based analyses, such as enrichment analysis (see <xref ref-type="bibr" rid="pcbi.1002725-Fu1">[7]</xref> for a review of strategies in analysing multiple TF binding profiles). However, recent studies provide evidence for so-called “hotspots” to which many interacting or non-interacting TFs may bind <xref ref-type="bibr" rid="pcbi.1002725-Consortium1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Moorman1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-MacArthur1">[9]</xref>, which leads to high correlations among binding profiles of both functionally “relevant” and functionally “irrelevant” TFs. It remains a significant challenge to distinguish relevant and important TFs from the others in the understanding of the combinatorial regulatory code.</p>
      <p>Similar to the gene regulation problem described above, many other biological problems involve highly-correlated features and high correlation does not necessarily indicate functional relevance. Machine learning approaches, especially classification methods, have been developed to use the measurements of these features (or “explanatory variables”) to predict biological outcomes (or “target variables”), e.g. using core promoter DNA motifs to predict transcription start site locations <xref ref-type="bibr" rid="pcbi.1002725-Ohler1">[10]</xref> or using DNA motifs and transcript structures to predict splicing patterns <xref ref-type="bibr" rid="pcbi.1002725-Barash1">[11]</xref>. Although these approaches may produce robust predictions, they do not distinguish which features directly or indirectly influence the biological outcome. Other machine-learning approaches such as standard feature selection methods (see <xref ref-type="bibr" rid="pcbi.1002725-Saeys1">[12]</xref> for review) are also not appropriate for this kind of inference in the general case <xref ref-type="bibr" rid="pcbi.1002725-Aliferis1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Aliferis2">[14]</xref>.</p>
      <p>In contrast, graphical models (GM) <xref ref-type="bibr" rid="pcbi.1002725-Spirtes1">[15]</xref> encompass a broad class of tools that infer the joint probability distribution of the variables in the network (or graph), and distinguish direct from indirect interactions under broad assumptions. Graphical models achieve this distinction through the notion of conditional independence, which is explained in the <xref ref-type="sec" rid="s2">Results</xref> section. Bayesian networks, also known as Directed Acyclic Graphs (DAGs), are a type of graphical model that further permit the interpretation of causality of the inferred interactions.</p>
      <p>Two concepts are particularly important in the theory of Bayesian networks: the causal neighbourhood and the Markov blanket. Specifically, if there is a directed edge from variable A to the target variable T in the network, then variable A is defined as the causal parent of T. If the directed edge goes from T to A, then A is the causal child of T. The causal neighbourhood of the target variable consists of the causal parents and causal children of the target variable. It is thus the set of variables that are most “causally immediate” for the target variable. The Markov blanket of the target variable T contains its causal neighbourhood as well as other causal parents of T's causal children (these other causal parents are T's causal spouses). From the information-theoretical perspective, the Markov blanket contains all the information about the target variable <xref ref-type="bibr" rid="pcbi.1002725-Spirtes1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Koller1">[16]</xref>.</p>
      <p>In terms of statistical inference, existing algorithms for inferring Bayesian networks can be broadly classified into constraint-based, score-based and hybrid algorithms <xref ref-type="bibr" rid="pcbi.1002725-Scutari1">[17]</xref>. Constraint-based algorithms perform statistical tests for conditional independence, whereas score-based algorithms estimate the most (or highly) likely joint distribution of the variables in the network. Hybrid algorithms are a combination of the other two, initialising a score-based search with a network inferred by a constraint-based algorithm.</p>
      <p>In this paper we develop a novel constraint-based graphical model method, the Neighbourhood Consistent PC (NCPC) algorithms, to infer the causal neighbourhood and the Markov blanket of a target variable. Through synthetic data, we demonstrate that our algorithm has superior performance to existing algorithms when the variables are highly correlated, the data of the target variable is sparse, and the coupling of the target variable and other variables is weak.</p>
      <p>We also develop a novel graphical representation, the Direct Dependence Graph (DDGraph), which can represent the dependence patterns inferred from the NCPC algorithms. This representation is broader than the common representation in DAGs, and is useful for exploratory analyses of NCPC results. In particular, the DDGraph shows the conditional independencies in the data even if the underlying network is cyclic or non-faithful to a DAG. Both NCPC and DDGraph are implemented in the R package ddgraph, which is part of Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.11/bioc/html/ddgraph.html" xlink:type="simple">http://bioconductor.org/packages/2.11/bioc/html/ddgraph.html</ext-link>).</p>
      <p>Applying our algorithm to genome-wide TF profiles and expression profiles of cis-regulatory modules (CRMs) published in <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref> provides novel insight into the transcriptional regulation during mesoderm differentiation in Drosophila embryonic development. We identify not only known TFs that are relevant for specific CRM classes, but also a potentially CRM-specific repression mechanism that has not been suggested before. Although we focus on gene regulation in our paper, our algorithm is applicable to other scenarios discussed earlier that involve highly correlated biological features.</p>
    </sec>
    <sec id="s2">
      <title>Results</title>
      <sec id="s2a">
        <title>Direct and indirect dependencies</title>
        <p>We illustrate the concepts of direct and indirect dependencies in terms of the combinatorial binding code of transcription factors. Our aim is to identify transcription factors that <italic>directly</italic> influence the regulatory output of a set of CRMs. Consider the following example. Transcription factor A binds to the CRM of a number of genes and thus directly regulates these target genes, whereas transcription factor B binds to several CRMs where A also binds (perhaps because of chromatin structure), but does not regulate the target genes of A. Therefore, A and B have overlapping binding profiles, and both appear to be associated with gene expression changes. However, the apparent effect of B can be explained away by the effect of A. This means that, if we divide the CRMs into those bound by A and those not bound by A, the binding of B is not associated with gene expression changes in either group. Mathematically speaking, B and the genes are <italic>conditionally independent</italic> given A, suggesting that the effect of B is at most indirect. In contrast, if we divide the CRMs into those bound by B and those not bound by B, the binding of A is still associated with gene expression changes in either or both groups. Mathematically speaking, A and the genes are <italic>dependent given</italic> B, suggesting that the effect of A is direct. Detecting conditional independence is thus central in separating direct from indirect effect <xref ref-type="bibr" rid="pcbi.1002725-Spirtes1">[15]</xref>. Incidentally, when we consider all the CRMs together, both A and B can be associated with (or equivalently, <italic>marginally dependent</italic> with) the genes.</p>
        <p>Below we formally define the types of statistical dependencies our NCPC algorithm and its extension detect. We use <italic>X<sub>i</sub></italic>, a binary vector, to represent the binding states of the <italic>i</italic>-th TF at a set of CRMs. We use <italic>T</italic>, also a binary vector, to represent the expression states of the genes with which the CRMs are associated. We denote the set of all <italic>m</italic> TF binding profiles as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e001" xlink:type="simple"/></inline-formula>, such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e002" xlink:type="simple"/></inline-formula>. As mentioned in <xref ref-type="sec" rid="s1">Introduction</xref>, <italic>T</italic> is the target variable or outcome, and the <italic>X</italic>s are the explanatory variables or features. Consistent with standard notation, we use symbol <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e012" xlink:type="simple"/></inline-formula> to represent “marginally independent”, and symbol <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e013" xlink:type="simple"/></inline-formula> to represent “marginally dependent”. We also use symbol | to represent “conditioning on”. Bold capital letter <bold>S</bold> indicates a subset of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e003" xlink:type="simple"/></inline-formula>, whereas <bold>S</bold>(<italic>X<sub>i</sub></italic>) indicates a subset of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e004" xlink:type="simple"/></inline-formula> that does not include <italic>X<sub>i</sub></italic>, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e005" xlink:type="simple"/></inline-formula>.</p>
        <sec id="s2a1">
          <title>Definition 1</title>
          <p><italic>Variables X<sub>i</sub> and T are </italic><bold><italic>directly</italic></bold><italic> dependent if X<sub>i</sub> and T are marginally dependent (i.e., X<sub>i</sub></italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e014" xlink:type="simple"/></inline-formula> <italic>T)</italic> as well as <italic>dependent when conditioning on any subset</italic> <bold>S</bold>(<italic>X<sub>i</sub></italic>) <italic>of</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e006" xlink:type="simple"/></inline-formula> <italic>that does not include X<sub>i</sub>. That is, it holds that X<sub>i</sub></italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e015" xlink:type="simple"/></inline-formula> <italic>T</italic> | <bold>S</bold>(<italic>X<sub>i</sub></italic>).</p>
        </sec>
        <sec id="s2a2">
          <title>Definition 2</title>
          <p><italic>Variables X<sub>i</sub> and T are </italic><bold><italic>conditionally</italic></bold><italic> dependent if X<sub>i</sub> and T are marginally independent (i.e., X<sub>i</sub></italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e016" xlink:type="simple"/></inline-formula><italic>T), but there exists at least one non-empty subset</italic> <bold>S</bold>(<italic>X<sub>i</sub></italic>) <italic>such that X<sub>i</sub></italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e017" xlink:type="simple"/></inline-formula> <italic>T</italic> | <bold>S</bold>(<italic>X<sub>i</sub></italic>).</p>
        </sec>
        <sec id="s2a3">
          <title>Definition 3</title>
          <p><italic>Variable X<sub>i</sub> and T are </italic><bold><italic>indirectly</italic></bold><italic> dependent if X<sub>i</sub></italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e018" xlink:type="simple"/></inline-formula><italic>T, but for at least one non-empty subset</italic> <bold>S</bold>(<italic>X<sub>i</sub></italic>), <italic>it holds that X<sub>i</sub></italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e019" xlink:type="simple"/></inline-formula> <italic>T</italic> | <bold>S</bold>(<italic>X<sub>i</sub></italic>).</p>
          <p>Note that, in the example above, A and T are directly dependent, whereas B and T are indirectly dependent. When many TFs are involved, often several TFs have similar types of dependence with T. Such collections of TFs are of interest in understanding the complex transcriptional regulatory network and are related to the causal neighbourhood and Markov blanket introduced in the previous section and formally defined below.</p>
        </sec>
        <sec id="s2a4">
          <title>Definition 4</title>
          <p><italic>A subset</italic> <bold>S</bold> <italic>of</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e007" xlink:type="simple"/></inline-formula> <italic>is a</italic> causal neighbourhood <italic>of T if every variable X<sub>i</sub> in</italic> <bold>S</bold> <italic>is directly (Definition 1) dependent with T.</italic></p>
        </sec>
        <sec id="s2a5">
          <title>Definition 5</title>
          <p><italic>A subset</italic> <bold>S</bold> <italic>of</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e008" xlink:type="simple"/></inline-formula> <italic>is a</italic> Markov blanket <italic>of T if every variable X<sub>i</sub> in</italic> <bold>S</bold> <italic>is either directly (Definition 1) or conditionally (Definition 2) dependent with T.</italic></p>
          <p>As mentioned in the <xref ref-type="sec" rid="s1">Introduction</xref>, whereas the Markov blanket of <italic>T</italic> is the minimal set of explanatory variables that provide all the information about <italic>T</italic>, the causal neighbourhood a subset of the Markov Blanket - contains the main players that have a direct, causal connection with <italic>T</italic>. Note that we aim to identify the causal neighbourhood and do not identify whether the causal neighbourhood is the cause of <italic>T</italic>, or <italic>T</italic> is the cause of the variables in the causal neighbourhood (see <xref ref-type="sec" rid="s3">Discussion</xref>). It means that binding of the TFs in the causal neighbourhood may induce or inhibit certain genes; alternatively, they may be the outcome of the induction or inhibition of certain genes.</p>
        </sec>
      </sec>
      <sec id="s2b">
        <title>Neighbourhood Consistent PC algorithms</title>
        <p>Here we present two versions of the Neighbourhood Consistent PC (NCPC) algorithm, which are based on the PC algorithm <xref ref-type="bibr" rid="pcbi.1002725-Spirtes1">[15]</xref>. Similar to the PC algorithm (see Supplementary Text), our algorithms perform a series of statistical tests on each explanatory variable to select variables in direct, conditional and indirect dependencies to target <italic>T</italic>. More importantly, our algorithms detect these dependencies even when the explanatory variables <italic>X</italic> are highly correlated among themselves. For example, consider the case where two highly correlated variables <italic>X<sub>i</sub></italic> and <italic>X<sub>j</sub></italic> both have direct or conditional dependence with the target variable <italic>T</italic>. However, when testing the null hypothesis of <italic>X<sub>i</sub></italic> (or <italic>X<sub>j</sub></italic>) and <italic>T</italic> being independent given <italic>X<sub>j</sub></italic> (or <italic>X<sub>i</sub></italic>) for data with a finite sample size, we may not reject this null hypothesis for a given confidence level. Thus, both <italic>X<sub>i</sub></italic> and <italic>X<sub>j</sub></italic> may be discarded during the selection procedure. Indeed, the original PC algorithm discards such variables, leading to a low accuracy rate in these scenarios (see Section “Comparison with other algorithms on synthetic data”). To account for potential correlation among variables <italic>X</italic>, our NCPC algorithms specifically check for and retain pairs of variables with the two patterns described below. These patterns depend on the type I error rate <italic>α</italic> of the statistical test used in the algorithm.</p>
        <sec id="s2b1">
          <title>Candidate pattern 1</title>
          <p><italic>Variables X<sub>i</sub> and X<sub>j</sub> have a </italic><bold><italic>joint dependency pattern</italic></bold><italic> if at level α, (i) they each are</italic> marginally dependent <italic>with T; (ii) X<sub>i</sub> and T are conditionally independent given X<sub>j</sub> and</italic> <bold>S</bold>, <italic>and (iii) X<sub>j</sub> and T are conditionally independent given X<sub>i</sub> and</italic> <bold>S</bold>, <italic>where</italic> <bold>S</bold> <italic>is any (possibly empty) subset of</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e009" xlink:type="simple"/></inline-formula>, <italic>excluding X<sub>i</sub> and X<sub>j</sub>. X<sub>i</sub> and X<sub>j</sub> in this pattern are candidates for having direct dependency with T.</italic></p>
        </sec>
        <sec id="s2b2">
          <title>Candidate pattern 2</title>
          <p><italic>Variables X<sub>i</sub> and X<sub>j</sub> have a </italic><bold><italic>conditional joint dependency pattern</italic></bold><italic> if, at level α, (i) they each have</italic> conditional dependency <italic>with T, (ii) X<sub>i</sub> and T are conditionally independent given X<sub>j</sub> and</italic> <bold>S</bold>, <italic>and (iii) X<sub>j</sub> and T are conditionally independent given X<sub>i</sub> and</italic> <bold>S</bold>, <italic>where</italic> <bold>S</bold> <italic>is a subset of</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e010" xlink:type="simple"/></inline-formula> <italic>including the variables X<sub>i</sub>, X<sub>j</sub> are conditional on, and possibly other variables (excluding X<sub>i</sub> and X<sub>j</sub>). X<sub>i</sub> and X<sub>j</sub> in this pattern are candidates for having conditional dependency with T.</italic></p>
          <p>Although these candidate patterns are mathematically inconsistent (see proof in Supplementary Text), we show in the subsequent section on synthetic data that these patterns can arise in applications with highly correlated variables, and thus should not be discarded.</p>
          <p>Between the two versions, the basic NCPC algorithm, shown in <xref ref-type="sec" rid="pcbi-1002725-box001">Box 1</xref>, infers only the causal neighbourhood, retaining variables possibly in direct and indirect dependence with <italic>T</italic>, as well as those in the joint dependency pattern. The NCPC* algorithm, which is the extended version, infers the Markov blanket, retaining in addition variables possibly in conditional dependence and those in the conditional joint dependency pattern. The differences between the two versions will be explained below. See details of the two versions in Supplementary Text.</p>
          <boxed-text id="pcbi-1002725-box001" position="float">
            <sec id="s2b2a1">
              <title>Box 1. NCPC Algorithm</title>
              <p>Input:</p>
              <list list-type="bullet">
                <list-item>
                  <p>Matrix <italic>X</italic> with columns representing different variables (<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>, …<italic>X<sub>m</sub></italic>) and rows representing observations.</p>
                </list-item>
                <list-item>
                  <p>Column vector <italic>T</italic> of target variable values, with observations corresponding to those of <italic>X</italic>.</p>
                </list-item>
                <list-item>
                  <p>Conditional independence test appropriate for the dataset</p>
                </list-item>
              </list>
              <p>Algorithm:</p>
              <list list-type="order">
                <list-item>
                  <p>Initialise a set of direct dependence candidates <bold>C</bold> with all <italic>X<sub>i</sub></italic> marginally dependent with <italic>T</italic></p>
                </list-item>
                <list-item>
                  <p>Let <italic>n</italic> = 1</p>
                </list-item>
                <list-item>
                  <p>Repeat:</p>
                  <list list-type="alpha-lower">
                    <list-item>
                      <p>Enumerate all subsets <bold>S</bold> of size <italic>n</italic> from candidate set <bold>C</bold></p>
                    </list-item>
                    <list-item>
                      <p>For every <italic>X<sub>i</sub></italic>, if <italic>X<sub>i</sub></italic> is conditionally independent of <italic>T</italic> given any of the subsets <bold>S</bold>, remove it from the set of candidates</p>
                    </list-item>
                    <list-item>
                      <p>Set <italic>n</italic> = <italic>n</italic>+1</p>
                    </list-item>
                    <list-item>
                      <p>Break out of the loop if <italic>n</italic> is greater than number of candidates <bold>C</bold>, or, stopping criterion is met</p>
                    </list-item>
                  </list>
                </list-item>
                <list-item>
                  <p>Label candidates <bold>C</bold> as having <italic>direct</italic> dependence</p>
                </list-item>
                <list-item>
                  <p>Systematically check for joint pattern of dependence in tests performed in Step 3</p>
                </list-item>
                <list-item>
                  <p>If <italic>X<sub>i</sub></italic> is conditionally independent of <italic>T</italic> only in a joint pattern, label as having <italic>joint</italic> dependence</p>
                </list-item>
                <list-item>
                  <p>Label all variables removed in Step 3 not having joint dependence as having <italic>indirect</italic> dependence</p>
                </list-item>
                <list-item>
                  <p>Label all remaining variables as having <italic>no</italic> dependence</p>
                </list-item>
                <list-item>
                  <p>Return calls for each of the variables in <italic>X</italic></p>
                </list-item>
              </list>
            </sec>
          </boxed-text>
          <p>The NCPC* algorithm differs from the NCPC algorithm in two main ways. Firstly, during the initialisation step, in addition to the candidate set <italic>C</italic> of <italic>X</italic>s marginally dependent with <italic>T</italic>, NCPC* also includes <italic>X</italic>s that are dependent with <italic>T</italic> given variables in <italic>C</italic>. Secondly, NCPC* checks for conditional dependence for individual <italic>X</italic>s as well as conditional joint dependency patterns for pairs of <italic>X</italic>s.</p>
          <p>The NCPC and NCPC* algorithms have similar computational complexity to the PC algorithm. That is, in the worst case, the number of required tests increases exponentially with the size of the causal neighbourhood (NCPC) or that of the Markov blanket (NCPC*), although in real life applications, the size of the causal neighbourhood and that of the Markov blanket of <italic>T</italic> are often small. Multiple testing correction <xref ref-type="bibr" rid="pcbi.1002725-Benjamini1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Benjamini2">[20]</xref> can be used as suggested for the PC algorithm <xref ref-type="bibr" rid="pcbi.1002725-Li1">[21]</xref> (see Supplementary Text for details).</p>
          <p>As local network reconstruction algorithms our NCPC algorithms assume that there are no hidden variables or directed cycles (i.e., feedback loops) in the Markov blanket of <italic>T</italic>, although hidden variables or directed cycles may exist in other parts of the system. In <xref ref-type="sec" rid="s3">Discussion</xref>, we examine the impact of deviations from these assumptions.</p>
          <p>Assuming an infinite sample size, a perfect statistical test (“conditional independence oracle”) and a dependence structure faithful to a DAG without hidden (i.e. unmeasured) variables, the NCPC* algorithm can correctly label all the variables in the network; that is, this algorithm is asymptotically correct for a distribution faithful to a DAG (see <xref ref-type="bibr" rid="pcbi.1002725-Spirtes1">[15]</xref> and <xref ref-type="bibr" rid="pcbi.1002725-Ramsey1">[22]</xref> for similar discussions on asymptotic correctness). This is because all the causal spouses of the target variable <italic>T</italic> enter the candidate list in Steps 1 and 2, such that the set of candidates contains the whole Markov blanket of <italic>T</italic>. Conditional on the whole Markov blanket, all the remaining variables can then be correctly labelled as in indirect dependence. In contrast, the NCPC algorithm is not asymptotically correct, except when there are no variables with conditional dependence, such that the Markov blanket of <italic>T</italic> is identical to its causal neighbourhood. In general the NCPC algorithm may falsely identify indirect dependence as direct dependence. However, as we show in Section “Comparison with other algorithms on synthetic data”, the NCPC algorithm may be empirically more stable than the NCPC* algorithm and thus lead to better results in practice.</p>
        </sec>
      </sec>
      <sec id="s2c">
        <title>The Direct Dependence Graph</title>
        <p>NCPC and NCPC* output labels for the explanatory variables <italic>X</italic>. These labels are the inferred types of dependence, namely “direct”, “indirect” and “joint”, as defined in Definitions 1–3, and the candidate dependency patterns, namely “conditional” and “conditional joint”, as described in Candidate Patterns 1–2. To visualise the inferred dependencies between multiple explanatory variables and the target variable, and especially to represent Candidate Patterns 1–2, we develop a novel graphical representation: the Direct Dependence Graph (DDGraph).</p>
        <p>DDGraphs use both directed edges (ending in dots) and undirected edges to capture a multitude of dependency patterns with respect to the target variable <italic>T</italic> (see <xref ref-type="fig" rid="pcbi-1002725-g001">Figure 1</xref> for the graphical vocabulary). For example, directed edge <italic>X<sub>i</sub></italic> –• <italic>X<sub>j</sub></italic> represents that <italic>X<sub>j</sub></italic> is conditionally independent of <italic>T</italic> given <italic>X<sub>i</sub></italic>. Solid undirected edge <italic>X<sub>i</sub></italic>–<italic>X<sub>j</sub></italic> represents that <italic>X<sub>i</sub></italic> and <italic>X<sub>j</sub></italic> are both dependent given <italic>T</italic> and marginally dependent. Dashed undirected edge <italic>X<sub>i</sub></italic> - - <italic>X<sub>j</sub></italic> represents that <italic>X<sub>i</sub></italic> and <italic>X<sub>j</sub></italic> are conditionally independent given <italic>T</italic>. Additionally, black edges indicate dependence patterns that are mathematically consistent, and grey edges indicate the dependence patterns that are inconsistent (e.g. edges in Candidate Patterns 1 and 2).</p>
        <fig id="pcbi-1002725-g001" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002725.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>The graphical vocabulary of the DDGraph.</title>
            <p>The vocabulary consists of five types of nodes and two types of edges. For the edges, directed edges ending with dots indicate conditional independences between <italic>X<sub>k</sub></italic> and the target variable <italic>T</italic> given <italic>X<sub>i</sub></italic>. Undirected edges indicate dependencies, which involve <italic>T</italic> in different ways, and for conditional independencies between <italic>X<sub>i</sub></italic> and <italic>X<sub>j</sub></italic> given <italic>T</italic>. Consider a case of non-faithful distribution where <italic>T</italic> is an XOR function of <italic>X</italic>1 and <italic>X</italic>2 with carefully set parameters so that from data it looks like <italic>X</italic>1 and <italic>X</italic>2 are marginally independent of <italic>T</italic>. In this case, <italic>X</italic>1 and <italic>X</italic>2 would be conditionally dependent when conditioning on each other. This distribution would be represented as two dotted nodes with a dotted line between them, but disconnected from <italic>T</italic>. This kind of graph signals a non-faithful distribution where the neighbourhood and Markov blanket are not defined by transversing undirected edges from <italic>T</italic>.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002725.g001" position="float" xlink:type="simple"/>
        </fig>
        <p>A DDGraph and a DAG with the same dependence patterns around the target variable <italic>T</italic> is shown in <xref ref-type="fig" rid="pcbi-1002725-g002">Figure 2A</xref>. In a DDGraph, variables connected to the target variable <italic>T</italic> with an undirected edge are in the causal neighbourhood of <italic>T</italic>, and variables reachable from <italic>T</italic> by traversing only undirected edges are in the Markov blanket of <italic>T</italic> (<xref ref-type="fig" rid="pcbi-1002725-g002">Figure 2A</xref>). These variables are also easily recognizable with their oval shapes, whereas variables in indirect dependence with <italic>T</italic> have a rectangular shape. By contrast, the causal neighborhood and Markov blanket in a DAG have to be inferred from the direction of the edges (<xref ref-type="fig" rid="pcbi-1002725-g002">Figure 2A</xref>).</p>
        <fig id="pcbi-1002725-g002" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002725.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Comparison of DDGraphs and DAGs.</title>
            <p>(<bold>A</bold>) The causal neighbourhood of the target variable T consists of variables X1 and X2, while T's Markov blanket consists of X1, X2, X4 (in ovals). The remaining variables X3 and X5 have indirect dependence (in rectangles). The DDGraph (left) and the DAG (right) represent the same conditional dependencies. The causal neighbourhood/the Markov blanket and the variable in indirect dependence are distinguishable by the variable shapes in the DDGraph, but have to be inferred in the DAG by following the edges. (<bold>B</bold>) joint dependency patterns representable in the DDGraph (left) cannot be represented by DAGs (right). The DAG shown here represents the conditional independencies between X1 (or X2) and T given X2 (or X1), but it does not represent the marginal dependency between X1 (or X2) and T. Neither this DAG or any other DAG can represent the entire joint dependency pattern.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002725.g002" position="float" xlink:type="simple"/>
        </fig>
        <p>A DDGraph also represents joint and conditional joint dependency patterns, which are mathematically inconsistent and thus impossible to represent with DAGs (<xref ref-type="fig" rid="pcbi-1002725-g002">Figure 2B</xref>). Indeed, DAGs, as well as other factorization-based graphs, such as factor graphs <xref ref-type="bibr" rid="pcbi.1002725-Kschischang1">[23]</xref>, that represent a factorization of a joint probability distribution cannot represent these inconsistent dependency patterns.</p>
      </sec>
      <sec id="s2d">
        <title>Comparison with other algorithms on synthetic data</title>
        <p>We generated synthetic data based on the 15 correlated TF binding profiles in <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref>. See <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details on data generation. The target variable <italic>T</italic>, which is a binary vector that contains the expression states of a set of CRMs, is sparse: similar to the real data, only around 10% of CRMs show class-specific expression. We generated data for three sample sizes: 300, 500 and 1000; the sample size in the data of <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref> is 310. In addition, we simulated a causal neighborhood of two variables (<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>) for <italic>T</italic>, and these causal neighbors are weakly correlated with <italic>T</italic> (correlation 0.17–0.25). We simulated data with four levels of correlation between the two causal neighbors: no correlation (0), weak correlation (0.25), strong correlation (0.50; similar to the average correlation of 0.46 we found in the data from <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref>), and very strong correlation (0.75).</p>
        <p>We further introduced a third variable (<italic>X</italic><sub>3</sub>) as the confounding variable in the network and generated correlated data for two realistic scenarios:</p>
        <list list-type="bullet">
          <list-item>
            <p>Time - The two causal neighbours (<italic>X</italic><sub>1</sub>, <italic>X</italic><sub>2</sub>) and the third variable (<italic>X</italic><sub>3</sub>) represent the binding profiles of the same TF at three times, such that <italic>X</italic><sub>1</sub>→<italic>X</italic><sub>2</sub>→<italic>X</italic><sub>3</sub>, in which the correlation between <italic>X</italic><sub>1</sub> and <italic>X</italic><sub>3</sub> is smaller than that between <italic>X</italic><sub>1</sub> and <italic>X</italic><sub>2</sub> and between <italic>X</italic><sub>2</sub> and <italic>X</italic><sub>3</sub> (<xref ref-type="fig" rid="pcbi-1002725-g003">Figure 3A</xref>).</p>
          </list-item>
          <list-item>
            <p>Hidden - The three variables are correlated with a common unobserved cause, e.g., the chromatin and/or cell population structure (represented by <italic>H</italic> in <xref ref-type="fig" rid="pcbi-1002725-g003">Figure 3B</xref>). We set the correlation between any pairs of these three variables to be the same.</p>
          </list-item>
        </list>
        <fig id="pcbi-1002725-g003" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002725.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Two scenarios for generating the synthetic data with correlated variables.</title>
            <p>While the synthetic data were generated for a network of 15 explanatory variables, only variables X1 and X2 have direct dependence with the target variable T, and therefore constitute the causal neighborhood of <italic>T</italic>. Variable X3 is included as the confounding variable. (<bold>A</bold>) The “Time” scenario in which X1, X2 and X3 correspond to three time points with stronger correlation between X1 and X2 and between X2 and X3 than between X1 and X3. (<bold>B</bold>) The “Hidden” scenario in which X1, X2 and X3 are correlated due to a common cause <italic>H</italic> in the network. This common cause is used in data generation, but is not available to algorithms.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002725.g003" position="float" xlink:type="simple"/>
        </fig>
        <p>With these synthetic data, we focus on the performance of separating direct from indirect dependence and detecting the causal neighbourhood. We applied our NCPC and NCPC* algorithms, at an <italic>α</italic> level of 0.05, to these data. Of the constraint-based algorithms, multiple testing correction has been mathematically and empirically demonstrated only for the PC algorithm <xref ref-type="bibr" rid="pcbi.1002725-Li1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Pea1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Tsamardinos1">[25]</xref>, therefore, for fair comparison we applied all algorithms, including NCPC/NCPC*, without any multiple testing correction. To investigate the effectiveness of identifying pairs of variables in Candidate Patterns 1 and 2 (see Section “Neighbourhood Consistent PC algorithms”), we applied the NCPC algorithm in two ways: detecting variables only in direct dependence with the target variable, and in addition detecting pairs of variables in joint dependence (Candidate Pattern 1). Similarly, we applied the NCPC* algorithm in two ways: detecting variables only in direct and conditional dependence with the target variable as well as pairs of variables in joint dependence, and detecting, in addition, pairs of variables in conditional joint dependence (Candidate Pattern 2). For comparison, we also applied the following algorithms to the synthetic data: the original PC algorithm <xref ref-type="bibr" rid="pcbi.1002725-Spirtes1">[15]</xref>; score-based algorithms that infer the whole network, such as Hill-climbing with BIC penalization <xref ref-type="bibr" rid="pcbi.1002725-Lam1">[26]</xref> or with a Dirichlet prior (BDe penalization <xref ref-type="bibr" rid="pcbi.1002725-Heckerman1">[27]</xref>); other constraint-based algorithms that infer the local structure, such as IAMB <xref ref-type="bibr" rid="pcbi.1002725-Tsamardinos2">[28]</xref>, FastIAMB <xref ref-type="bibr" rid="pcbi.1002725-Yaramakala1">[29]</xref>, InterIAMB <xref ref-type="bibr" rid="pcbi.1002725-Yaramakala1">[29]</xref> and MMPC <xref ref-type="bibr" rid="pcbi.1002725-Tsamardinos3">[30]</xref>; as well as a hybrid algorithm MMHC <xref ref-type="bibr" rid="pcbi.1002725-Tsamardinos3">[30]</xref>.</p>
        <p>We measured the proportion of correct predictions from these algorithms over 1000 data sets generated for each combination of the sample size and correlation in either of the two scenarios. A prediction is correct when only the two causal neighbors and no other variables are identified. These prediction rates for the “Time” scenario are summarized in <xref ref-type="fig" rid="pcbi-1002725-g004">Figure 4</xref>. The prediction rates for the “Hidden” scenario are similar and are summarized in Supplementary Figure S1 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>.</p>
        <fig id="pcbi-1002725-g004" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002725.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Proportion of correct predictions for the “Time” scenario.</title>
            <p>Each cell shows the mean proportion of correct predictions (with 95% confidence intervals) averaged over 1000 data sets generated in each case. Highest prediction proportions accounting for variation in the data (pairwise T-tests with a cut-off of 0.001 for the P values) are shown in bold. See <xref ref-type="sec" rid="s4">Materials and Methods</xref> for the generation of the synthetic data and for the calculation of the correct prediction proportion.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002725.g004" position="float" xlink:type="simple"/>
        </fig>
        <p>Identifying variables in direct dependence and in joint dependence, the NCPC algorithm (“NCPC dir+jnt”), has the highest (accounting for variation in simulated data) rate of correct predictions amongst all the algorithms in all the cases examined here, except in the biggest dataset with 0 correlation. This superior performance is particularly notable when the correlation between the variables is high and the dataset is small. By including the variable pairs in joint dependence, “NCPC dir+jnt” achieves better performance “NCPC dir” because this inclusion drastically improves recall (corresponding to low false negative rates), especially when the sample size is not large, although the inclusion lowers precision (corresponding to high false positive rates) slightly (see rates of precision and recall defined in <xref ref-type="sec" rid="s4">Materials and Methods</xref> and computed in Supplementary Figures S2 and S3 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>). The comparison of the two implementations of the NCPC algorithm provides some empirical evidence for including pairs of variables at least in Candidate Pattern 1 as candidates for direct dependence. With the sample size as large as 1000, the data are informative enough for “NCPC dir” to perform similarly or even slightly better than “NCPC dir+jnt”. The performance of the two implementations of the NCPC* algorithm, however, is worse than the NCPC algorithm in most cases. This is likely because in order to identify the Markov blanket, which is larger than the causal neighbourhood, the NCPC* algorithm sacrifices the false positive rates more to gain even lower false negative rates. At different levels of correlation, the NCPC and NCPC* algorithms both have more stable precision and recall rates than other algorithms (Supplementary Figures S2 and S3 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>). This may explain why the NCPC and NCPC* algorithms (four implementations) perform better than all the other algorithms.</p>
        <p>Increasing the sample size improves the prediction for most algorithms, as we expected. However, when the correlation in the data is 0.75, the NCPC and NCPC* algorithms have lower rates of correct predictions for data with a sample size of 500 than for data with a sample size of 300. This may be due to the <italic>α</italic> level chosen for the statistical test before running the algorithm, especially when the P-values obtained by the NCPC and NCPC* algorithms are close to the value of <italic>α</italic>. A more stringent <italic>α</italic> level such as 0.01 leads to improved performance (Supplementary Figures S4 and S5 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>). This highlights the importance of choosing an appropriate <italic>α</italic> value, and suggests re-running the algorithm with a different <italic>α</italic> level if the P-values obtained are close to the initial <italic>α</italic> value. We recommend the user to inspect the P-values of key conditional independence tests that give rise to the DDGraph and to change the <italic>α</italic> value accordingly.</p>
      </sec>
      <sec id="s2e">
        <title>Application of NCPC and NCPC* to fly mesoderm development</title>
        <p>Zinzen et al. <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref> published an in vivo ChIP-chip temporal binding profiles of key transcription factors that are involved in mesoderm development in fly embryos, as well as the CRM Activity Database (CAD), the largest such database thus far, which contains tissue-specific temporal expression patterns driven by these CRMs. The five key TFs, Twist (Twi), Myocyte enhancer factor 2 (Mef2), Tinman (Tin), Bagpipe (Bap), and Biniou (Bin), were each measured in some or all of five developmental stages, producing 15 correlated TF binding profiles (<xref ref-type="fig" rid="pcbi-1002725-g005">Figure 5</xref>). Zinzen et al. further focused on 310 CRMs from the CAD that have both TF binding and expression data, and classified these CRMs into five classes based on their tissue-specific expression patterns: mesodermal (Meso), mesodermal and somatic muscle (Meso&amp;SM), visceral muscle (VM), visceral and somatic muscle (VM&amp;SM) and somatic muscle (SM).</p>
        <fig id="pcbi-1002725-g005" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002725.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Clustered pairwise correlation matrix of the 15 transcription factor binding profiles over all 310 CRMs.</title>
            <p>Note that the cluster that consists of Mef2 8–12 h and Bin 6–12 h (lower left corner of the matrix) is anti-correlated with early Twi 2–4 h binding.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002725.g005" position="float" xlink:type="simple"/>
        </fig>
        <p>Here we applied the NCPC and NCPC* algorithms to the same 310 CRMs with the 15 TF binding profiles. The advantage of this dataset is that any computational predictions can be benchmarked against a wealth of previously established biological results. At an <italic>α</italic> level of 0.05, we identified expression class-specific causal neighbourhoods using NCPC (<xref ref-type="fig" rid="pcbi-1002725-g006">Figure 6</xref> and Supplementary Figure S6 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>). The Markov blankets identified by applying NCPC* (Supplementary Figure S7 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>) are similar to their corresponding causal neighbourhoods. We discusss the biological implications of our inference in the next section.</p>
        <fig id="pcbi-1002725-g006" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002725.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>DDGraphs for the 5 CRM classes inferred by the NCPC algorithm at <italic>α</italic> = 0.05.</title>
            <p>Variables in green circles are target variables. Variables in ovals are inferred causal neighbours. Variables in rectangles are inferred to have indirect dependence with the target. Values on the edges are (unadjusted) P-values from conditional independence tests. The same NCPC algorithm with no multiple testing correction was used as in the synthetic data benchmark. See <xref ref-type="fig" rid="pcbi-1002725-g001">Figure 1</xref> for the graphical vocabulary.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002725.g006" position="float" xlink:type="simple"/>
        </fig>
        <p>We also applied other algorithms benchmarked in the previous section to this data set. Hill-climbing with BIC identified a smaller but overlapping set of variables (Supplementary Figure S8 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>), consistent with our results on synthetic data that this algorithm has higher precision but a lower recall rate than our NCPC algorithms. Hillclimbing with BDe identified a bigger but overlapping set of variables (Supplementary Figure S9 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>), also consistent with our results on synthetic data that this algorithm has lower precision than but a similar recall rate to our NCPC algorithms. The IAMB family of methods found either a smaller but overlapping set of variables, or no variables (Supplementary Figures S10, S11 and S12 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>). The original PC algorithm performed similarly to the IAMB methods (Supplementary Figure S13 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>). MMHC produced similar results to those from the ordinary hill-climbing method (Supplementary Figures S14 and S15 in <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref>).</p>
      </sec>
      <sec id="s2f">
        <title>TF combinatorial code of fly mesoderm development</title>
        <p>We applied our method on the dataset of early mesoderm development in the Drosophila embryo <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref>. The five transcription factors Twi, Tin, Mef2, Bin and Bap have been previously implicated in mesoderm development of the fly. Among the five TFs we analysed here, Twi, together with another TF Snail, is the earliest marker of mesoderm and is required for mesoderm formation <xref ref-type="bibr" rid="pcbi.1002725-Leptin1">[31]</xref>. Tin, a direct target of Twi, is crucial for the differentiation of heart, somatic and visceral mesoderm and is present also in dorsal somatic muscle precursor cells <xref ref-type="bibr" rid="pcbi.1002725-Yin1">[32]</xref>. Mef2, crucial for early muscle differentiation, is present in both visceral and somatic muscle <xref ref-type="bibr" rid="pcbi.1002725-Lilly1">[33]</xref>–<xref ref-type="bibr" rid="pcbi.1002725-Taylor1">[35]</xref>. Activated by Tin, Bap specifies cells that become the visceral muscle <xref ref-type="bibr" rid="pcbi.1002725-Azpiazu1">[36]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Lee1">[37]</xref>. Finally, Bin is expressed only in visceral muscle cells and is crucial for their differentiation <xref ref-type="bibr" rid="pcbi.1002725-Zaffran1">[38]</xref>.</p>
        <p>After identifying the causal neighbourhood, we further examined which specific TF combinations are enriched or depleted in each of the five expression classes, compared with the rest of the 310 CRMs analysed here (<xref ref-type="fig" rid="pcbi-1002725-g007">Figure 7</xref>). Most of these TF combinations have been established in single-gene studies:</p>
        <list list-type="bullet">
          <list-item>
            <p><bold>Meso</bold> - these CRMs are active only in the early mesoderm (2–6 h). For these we find that Twi 2–4 h binding alone activates these CRMs (<xref ref-type="fig" rid="pcbi-1002725-g006">Figure 6</xref>). This result is not surprising, as Twi is the key regulator of mesoderm development. Note also that Twi 2–4 h is negatively correlated with binding profiles from later stages (<xref ref-type="fig" rid="pcbi-1002725-g005">Figure 5</xref>), perhaps due to changes in the chromatin structure during development, such that the set of early CRMs bound by Twi at 2–4 h are not accessible at later stages.</p>
          </list-item>
          <list-item>
            <p><bold>Meso&amp;SM</bold> - these CRMs are active in both early mesoderm (2–6 h) and somatic muscle precursor cells (after 6 h). This CRM class contains only 9 active CRMs, the fewest among the five classes. Tin at 2–4 h and 4–6 h and Mef2 from the same time intervals all have joint dependence with the CRM class activity (<xref ref-type="fig" rid="pcbi-1002725-g006">Figure 6</xref>). Furthermore, the presence of both TFs at both stages are significantly enriched in this CRM class (<xref ref-type="fig" rid="pcbi-1002725-g007">Figure 7</xref>), suggesting that this class of CRMs have a different TF combinatorial code from that for the CRMs active only in early mesoderm (“Meso”). However, Mef2 is not significantly bound after 6 h, and no data is available for Tin after 6 h. Thus, it is unclear which TFs contribute to the somatic activity later on.</p>
          </list-item>
          <list-item>
            <p><bold>SM</bold> - these CRMs are active in somatic muscles after 6 h or later in development. This CRM class was difficult to predict with a Support Vector Machine, the approach <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref> used. Here we found only Mef2 at 10–12 h to be directly associated with the CRM class activity (<xref ref-type="fig" rid="pcbi-1002725-g006">Figure 6</xref>), although Mef2 at 6–8 h has a P-value just above the <italic>α</italic> level of 0.05 and could have been inferred to pair up with Mef2 at 10–12 h to form the joint dependence pattern. It is likely that for this class of CRMs we are missing some of the key TFs.</p>
          </list-item>
          <list-item>
            <p><bold>VM</bold> - these CRMs are active in visceral muscle after 6 h of development. TFs Bin and Bap are known to express only in visceral muscle and are crucial for its development. Thus we would expect both of them to constitute the combinatorial code. We found that Bin at 6–8 h and at 8–10 h are in joint dependence with this CRM class (<xref ref-type="fig" rid="pcbi-1002725-g006">Figure 6</xref>), and that Bin binding at both stages is indeed significantly enriched (<xref ref-type="fig" rid="pcbi-1002725-g007">Figure 7</xref>). These observations together indicate that persistent binding of Bin alone activates this CRM class. Note we did not recover Bap as part of the combinatorial code. By examining the DDGraph we note that Bap is found to have indirect dependence with a P-value just above the threshold (0.06). Furthermore, to our knowledge, the only CRM where Bap binding has been directly proven is the betaTub60D enhancers <xref ref-type="bibr" rid="pcbi.1002725-Zaffran2">[39]</xref>, however the CRM containing this binding site (CRM ID 1443) was annotated with VM&amp;SM activity. Thus, annotation bias might explain why Bap is missing from the combinatorial code at <italic>α</italic> = 0.05.</p>
          </list-item>
        </list>
        <fig id="pcbi-1002725-g007" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002725.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Combinatorial patterns of TFs in inferred causal neighbourhoods.</title>
            <p>For each combinatorial pattern we show the number of CRMs with this pattern in the CRM class and that in the rest of CRMs (percentages are given in parenthesis). The difference in the two frequencies (CRM class vs rest) and the corresponding P-value are given in the last two columns. P-values were computed from Fisher's exact test for each combination and adjusted for multiple testing using the Benjamini-Hochberg method. See <xref ref-type="sec" rid="s4">Materials and Methods</xref> for details. Frequency differences are colour-coded: blue for decrease in the CRM class, and orange for increase in the CRM class.</p>
          </caption>
          <graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1002725.g007" position="float" xlink:type="simple"/>
        </fig>
        <p>In addition to previously established regulatory principles outlined above, the genome-wide statistics also suggest a thus far uncharacterized mechanism of prevention of early Twi binding at 2–4 h of embryogenesis for the class of CRMs active in visceral and somatic muscle (VM&amp;SM) at 8–12 h of development. This suggests that these CRMs are selectively shut off during early embryogensis, but are bound later on by tissue-specific transcription factors:</p>
        <list list-type="bullet">
          <list-item>
            <p><bold>VM&amp;SM</bold> - these CRMs are active in visceral and somatic muscle after 8 h of development. It is known that at this stage Mef2 is expressed in both visceral and somatic muscles, while Bin is expressed only in visceral muscles <xref ref-type="bibr" rid="pcbi.1002725-Lilly1">[33]</xref>–<xref ref-type="bibr" rid="pcbi.1002725-Taylor1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Zaffran1">[38]</xref>. We identified that Bin and Mef2 binding at 10–12 h are in joint and direct dependence, respectively, with this CRM class (<xref ref-type="fig" rid="pcbi-1002725-g006">Figure 6</xref>). This is consistent with the important role previously established for these TFs in visceral and somatic muscle development <xref ref-type="bibr" rid="pcbi.1002725-Lilly1">[33]</xref>–<xref ref-type="bibr" rid="pcbi.1002725-Taylor1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Zaffran1">[38]</xref>. Earlier Mef2 binding at 8–10 h has been found to be indirect, but with a P-value barely above the 0.05 threshold (P-value of 0.051). Thus, it is possible that Mef2 binding at 8–10 h is also part of the combinatorial code. In addition, Mef2 binding at 10–12 h alone is significantly associated with activity of this CRM class (<xref ref-type="fig" rid="pcbi-1002725-g007">Figure 7</xref>), we find that although the pattern when both Mef2 and Bin are co-bound is most highly enriched, only a minority of CRMs have this pattern. Instead, most either have only Mef2 binding, or only Bin binding. In fact, the binding of Mef2 and Bin at 10–12 h seems largely independent (<xref ref-type="fig" rid="pcbi-1002725-g006">Figure 6</xref>), suggesting that these TFs may not interact much with each other during visceral and somatic muscle development. We also identified, rather surprisingly, that Twi 2–4 h is in direct dependence with this CRM class, which may suggest a repression mechanism that has not been characterised yet. See further discussion below.</p>
          </list-item>
        </list>
        <p>Twi 2–4 h is identified to also have direct dependence with this VM&amp;SM CRM class (<xref ref-type="fig" rid="pcbi-1002725-g006">Figure 6</xref>), and, interestingly, it is the lack of Twi binding at 2–4 h that is significantly associated with the activity of this CRM class. Note that this observation is consistent with the negative correlations between the binding profiles (over all 310 CRMs) of Twi 2–4 h and both Bin and Mef2 at later stages (<xref ref-type="fig" rid="pcbi-1002725-g005">Figure 5</xref>). However, it is unclear how depletion of Twi at an earlier stage leads to activity of these CRMs several hours later. One plausible biological explanation is that these CRMs may be silenced during early embryogenesis (for example, the chromatin they are located in is inaccessible during this stage), and be bound by tissue-specific TFs, such as Bin and Mef2, later. Activation of the CRMs in this class may require concerted efforts, which may be specific to this CRM class, and which may involve remodelling of chromatin or inhibition of early Twi binding. It is also unclear whether additional transcription factors or chromatin remodelling factors are involved in the activation of this CRM class.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Discussion</title>
      <p>In this paper we present a novel graphical model-based method that distinguishes direct from indirect dependencies between explanatory variables (or features) and the target variable. Our NCPC and NCPC* algorithms work particularly well in cases of highly correlated features and of sparse or weak signals, as seen in comparison with other algorithms on synthetic data.</p>
      <p>We applied our algorithms to data published in <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref>, which consist of the 15 transcription-factor binding profiles over 310 CRMs in Drosophila during mesoderm development. Our analysis identified known combinations of TFs associated with expression of different CRM classes. Our analysis also suggests an uncharacterized repression mechanism: depletion of Twist binding at 2–4 h plus presence of tissue-specific factors Mef2 and Bin indicates activity of the CRMs in the visceral and somatic muscle development, through CRM silencing in early embryogenesis and/or chromatin remodelling. Additional TFs may be involved in mesodermal development, and our algorithms can be easily applied to newly available data <xref ref-type="bibr" rid="pcbi.1002725-Junion1">[40]</xref> to improve the local network structures we identified here.</p>
      <p>Our NCPC algorithms assume no hidden variables in the Markov blanket of the target variable. This assumption is frequently not met in reality; for example, in the case of the transcriptional regulation, a number of relevant TFs might not have been measured. In that case, a seemingly irrelevant TF might be inferred as a causal neighbour if it is correlated with the unmeasured relevant TF (e.g. due to open chromatin structure). Such a TF would be a “proxy” for the binding of the relevant TF.</p>
      <p>Our NCPC algorithms also assume no feedback loops in the Markov blanket of the target variable. This may not be the case in a real biological system. However, if time course data are available and informative enough such that the underlying Markov blanket is acyclic at each time point, then our NCPC algorithms can still be applied (similar to the way we re-analysed the fly mesoderm development data) to identify causal neighbours. Transcriptional responses are typically slow (on the order of minutes <xref ref-type="bibr" rid="pcbi.1002725-Rosenfeld1">[41]</xref>) which allows for the data to be collected as time series so that the next time point is a product of the previous time point and thus the dynamics made acyclic in time.</p>
      <p>The statistical tests our algorithms perform for the variables in these systems tend to be highly dependent. It is still a challenge to control the false discovery rate for highly dependent tests. We implemented the multiple testing procedure of <xref ref-type="bibr" rid="pcbi.1002725-Li1">[21]</xref> for controlling the false discovery rate (see Supplementary Text for detail). However, we found that this procedure can be overly conservative and can lead to loss of statistical power, for example even at 0.3 FDR the somatic muscle (SM) class has no causal neighbours (data not shown) although <italic>in-vivo</italic> validation found a weak but predictive signal <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref>. Further development in controlling the FDR for dependent tests in network inference is needed.</p>
      <p>The NCPC algorithms infer the causal neighbourhood and do not optimise the prediction accuracy of the target variable. Hence, we do not expect these algorithms to be an optimal feature selection procedure for classification. Nonetheless, the NCPC algorithms may in principle be used for feature selection to improve prediction accuracy, for example, by using cross-validation to choose a P-value threshold that minimises the cross-validation error. Directly incorporating the dependence structure in a classifier is still challenging, since it is difficult to robustly estimate higher-order conditional probabilities from small datasets (a Naive Bayesian Classifier has been used in practice; see <xref ref-type="bibr" rid="pcbi.1002725-Friedman1">[42]</xref>).</p>
      <p>A wealth of genome-wide data have been and are currently produced, featuring binding sites of transcription factors, chromatin marks and RNA levels <xref ref-type="bibr" rid="pcbi.1002725-Consortium1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-MacArthur1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Kharchenko1">[43]</xref>. Our NCPC algorithms can be applied to tackle more effectively the high correlations that have been noted among these features <xref ref-type="bibr" rid="pcbi.1002725-Negre1">[44]</xref> and uncover the underlying combinatorial code specific to a set of regulatory sequences of interest. However, before the NCPC algorithm can be used on genomewide data, technical artefacts (e.g. systematic biases in reporter assays or tested enhancers) need to removed and biases in the data accounted or corrected for, otherwise they might lead to spurious associations <xref ref-type="bibr" rid="pcbi.1002725-Blyth1">[45]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Spirtes2">[46]</xref>.</p>
      <p>Although we have focused on TF binding and CRM activity in this paper, our NCPC algorithms are applicable to other biological problems involving possible highly correlated features. For instance, high-throughput imaging of knock-down strains can produce large sets of highly correlated visual features describing cell shape <xref ref-type="bibr" rid="pcbi.1002725-Conrad1">[47]</xref>–<xref ref-type="bibr" rid="pcbi.1002725-Bakal1">[49]</xref>. Our NCPC algorithms can be applied to explore the relationships between these visual features and the genes knocked down, or between these features and characteristics (e.g., elongation) of the cells involved. Similarly, genome-wide RNAi screens with multiple classes of phenotypic readout <xref ref-type="bibr" rid="pcbi.1002725-MummeryWidmer1">[50]</xref>, <xref ref-type="bibr" rid="pcbi.1002725-Schnorrer1">[51]</xref> might produce features (phenotypes) that are highly correlated, in addition to features of gene functional and spatial/temporal annotation. In the ideal case, we can find out if a phenotype is a consequence of another phenotype or any of the gene features. Dissecting direct and indirect effects in these highly correlated datasets would provide further valuable insight into the underlying biological mechanisms.</p>
      <p>A unified interface to all causal neighbourhood/Markov blanket methods benchmarked in this paper, including the NCPC/NCPC* algorithms and the DDGraph representation, is available as the R package ddgraph, which is part of Bioconductor (<ext-link ext-link-type="uri" xlink:href="http://bioconductor.org/packages/2.11/bioc/html/ddgraph.html" xlink:type="simple">http://bioconductor.org/packages/2.11/bioc/html/ddgraph.html</ext-link>).</p>
    </sec>
    <sec id="s4" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s4a">
        <title>TF binding and CRM activity data</title>
        <p>We used the data from Supplementary Figure 8 of <xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref>. These data include 5 TFs previously implicated in development of mesoderm during <italic>D. melanogaster</italic> embryogenesis: Twist (Twi), Tinman (Tin), Myocite enhancing factor 2 (Mef2), Biniou (Bin) and Bagpipe (Bap). Their binary occupancy at 310 CRMs were measured in some or all of 5 stages, leading to 15 binding profiles. Their pairwise correlations are displayed in <xref ref-type="fig" rid="pcbi-1002725-g005">Figure 5</xref>. The data also contain the in vivo-tested expression patterns of the 310 CRMs. Most of these (210) did not show expression in the mesoderm, but showed expression in other tissues during embryogenesis. Out of the 100 that did show mesodermal expression, they were classified in 6 broad categories based on expression in specific tissues: Mesodermal (Meso), Mesodermal and Somatic Muscle (Meso&amp;SM), Visceral Muscle (VM), Visceral and Somatic Muscle (VM&amp;SM), Somatic Muscle (SM) and Cardiac Muscle (CM). We focused on the first five in our analysis, like in the original paper.</p>
      </sec>
      <sec id="s4b">
        <title>Synthetic dataset</title>
        <p>To construct the synthetic dataset we used Hill-climbing with BIC to infer a Bayesian network from the real biological dataset (<xref ref-type="bibr" rid="pcbi.1002725-Zinzen1">[18]</xref>; see the previous section). We estimated the mean number of causal parents per node to be roughly 1.5 and the maximum to be 2. We therefore assumed a binomial distribution for the number of causal parents. We used a beta distribution to generate the probabilities in the conditional probability table associated with each node. With these distributions we generated a network structure that had both marginal probabilities and pairwise correlations similar to the real data. We used this network structure to generate binary data for 15 nodes in the network, which is the number of TF binding profiles in the real data. The target variable is generated separately using a noisy AND function.</p>
        <p>To generate the CRM class target variables we considered a causal neighbourhood of size 2 and used a noisy AND function, representing the simplest combinatorial code of 2 TFs. The noise in the AND function is incorporated into both the inputs and the output of the function. The noise in the inputs models the activity of other TFs, which might, for example, inhibit the CRM activity in the presence of the TF, or activate the CRM in the absence of the TF. The noise in the output models the noise in the reporter assay used to find the activity of a CRM. Let <italic>F</italic>(<italic>R<sub>A</sub></italic>, <italic>R<sub>B</sub></italic>) be a boolean AND function with two inputs. Thus <italic>F</italic>(<italic>R<sub>A</sub></italic>, <italic>R<sub>B</sub></italic>) = 1 only if <italic>R<sub>A</sub></italic> = <italic>R<sub>B</sub></italic> = 1. Further, let <italic>A</italic> and <italic>B</italic> denote the real functional binding profiles of two TFs that constitute the combinatorial code. The noise at the input of the boolean AND function can be modelled by “readout” probabilities: <italic>output</italic> = <italic>F</italic>(<italic>R<sub>A</sub></italic>, <italic>R<sub>B</sub></italic>) · <italic>P</italic>(<italic>R<sub>A</sub></italic>|<italic>A</italic>) · <italic>P</italic>(<italic>R<sub>B</sub></italic>|<italic>B</italic>). If we assume that the conditional probabilities have the same distribution for <italic>A</italic> and <italic>B</italic>: <italic>P</italic>(<italic>R<sub>A</sub></italic>|<italic>A</italic>) = <italic>P</italic>(<italic>R<sub>B</sub></italic>|<italic>B</italic>), then we just need to specify two readout probabilities. We set these to be <italic>P</italic>(<italic>R<sub>A</sub></italic> = 1|<italic>A</italic> = 1) = 0.5 and <italic>P</italic>(<italic>R<sub>A</sub></italic> = 1|<italic>A</italic> = 0) = 0.1. At the output of boolean AND function, we use a false positive rate of 0.01 and false negative rate of 0.2. This parameter setting results in 10% of the CRMs being active, similar to the Zinzen et al. data. Furthermore, the data generated for these CRMs from the noisy AND function is weakly correlated (correlation between 0.17 and 0.25) with <italic>A</italic> and <italic>B</italic>. This level of correlation is also similar to the observed correlations between the CRM classes and TF binding profiles in the real data.</p>
        <p>To incorporate the two scenarios “Time” and “Hidden” described in the main text, we randomly chose three variables in each simulated network. We then rewired these three variables to match each scenario. For the “Time” scenario we allowed for the first variable to have causal parents as in the unmodified network, while variables two and three have causal parents only from the scenario. However, they retained the original causal children of the unmodified network. This ensured that we can fully control the correlation between these three variables, but also leave it as much as possible in the context of rest of the network. In the “Hidden” scenario, we generated an additional hidden variable and made it a causal parent for the three variables in the scenario. Now the three variables only retained their original causal children, but not their causal parents. To generate the binary profile of the target variable, we applied the noisy AND function as before.</p>
        <p>The hill-climbing and IAMB algorithms were applied using the bnlearn R package, and PC algorithm was applied using the pcalg R package. Both can be accessed using a unified interface in our R package ddgraph.</p>
      </sec>
      <sec id="s4c">
        <title>Applying NCPC and other algorithms and assessing their performance</title>
        <p>For NCPC and NCPC* we used the Monte-Carlo chi-square test, while for the IAMB algorithms we used the Mutual Information test recommended by the authors <xref ref-type="bibr" rid="pcbi.1002725-Tsamardinos2">[28]</xref>, but with Monte Carlo-calculated P-values due to small sample sizes. We compared these two tests in a simple case of two variables and found that the Monte-Carlo chisquare test was slightly better than the Monte-Carlo Mutual Information test. However, their differences were not noticeable when applied to our synthetic data. For MMHC we use the default constraint-based algorithm (MMPC).</p>
        <p>To assess the performance of the algorithms, we defined a prediction as correct if there are no false positive and no false negatives. The accuracy was measured by the prediction rate, which was the proportion of correct predictions over all the synthetic networks. We also defined precision as TP/(TP+FP), where TP is the number of true positives, and FP is the number of false positives. Additionally, we defined recall as TP/(TP+FN) where FN is the number of false negatives. Rates of precision and recall were also averaged over all the synthetic networks.</p>
      </sec>
      <sec id="s4d">
        <title>Controlling the power of conditional independence tests in the NCPC algorithms</title>
        <p>As the size of the conditioning set increases, the power of the test decreases. To increase power, we limited the total count <italic>l</italic> of datapoints per conditioning set to 10. Our NCPC and NCPC* algorithms performed the test if this requirement was met and considered the variables to be dependent otherwise.</p>
        <p>Alternatively, one may constrain the size of the conditioning set. Since our data are binary, we set the maximal size of the conditioning set <italic>k</italic> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002725.e011" xlink:type="simple"/></inline-formula>, where <italic>T<sub>min</sub></italic> is the smaller of the number of ones and the number of zeros in <italic>T</italic>. We found that these two rules performed similarly on our binary data. The second rule, however, may also be applied to continuous features with a binary target variable.</p>
      </sec>
      <sec id="s4e">
        <title>Testing enrichment of TF combinations</title>
        <p>For <italic>n</italic> TFs, each of which is either present or not at a CRM, we performed Fisher's exact test to test whether a combination of presence and absence of these TFs is statistically significantly associated with a CRM class. This test essentially compares the frequencies of the combination within this CRM class and across the other four classes. We applied the Benjamini-Hochberg correction <xref ref-type="bibr" rid="pcbi.1002725-Benjamini1">[19]</xref>, which adjusts the P-values to control the False Discovery Rate (FDR), and retained those combinations with adjusted P-values smaller than 0.15.</p>
      </sec>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002725.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1002725.s001" position="float" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p><bold>Supplementary information.</bold> Contains Supplementary  and Supplementary Figures S1–15. The Supplementary <xref ref-type="supplementary-material" rid="pcbi.1002725.s001">Text S1</xref> contains a proof of mathematical inconsistency of the joint and conditional joint dependence patterns, the description of the PC algorithm and a detailed pseudo-code of the NCPC algorithms.</p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ack>
      <p>The authors wish to thank David Molnar and Rob Foy for valuable discussion.</p>
    </ack>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002725-Davidson1">
        <label>1</label>
        <mixed-citation publication-type="other" xlink:type="simple">Davidson EH (2006) The regulatory genome: gene regulatory networks in development and evolution. Academic Press.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Akam1">
        <label>2</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Akam</surname><given-names>M</given-names></name> (<year>1987</year>) <article-title>The molecular basis for metameric pattern in the drosophila embryo</article-title>. <source>Development</source> <volume>101</volume>: <fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Ingham1">
        <label>3</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ingham</surname><given-names>PW</given-names></name> (<year>1988</year>) <article-title>The molecular genetics of embryonic pattern formation in drosophila</article-title>. <source>Nature</source> <volume>335</volume>: <fpage>25</fpage>–<lpage>34</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-ENCODE1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>ENCODE</surname><given-names>C</given-names></name> (<year>2007</year>) <article-title>Identification and analysis of functional elements in 1% of the human genome by the ENCODE pilot project</article-title>. <source>Nature</source> <volume>447</volume>: <fpage>799</fpage>–<lpage>816</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Zhang1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zhang</surname><given-names>ZD</given-names></name>, <name name-style="western"><surname>Paccanaro</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Fu</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Weissman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Weng</surname><given-names>Z</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Statistical analysis of the genomic distribution and correlation of regulatory elements in the ENCODE regions</article-title>. <source>Genome Res</source> <volume>17</volume>: <fpage>787</fpage>–<lpage>797</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Consortium1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Consortium</surname><given-names>Tm</given-names></name>, <name name-style="western"><surname>Roy</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ernst</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kharchenko</surname><given-names>PV</given-names></name>, <name name-style="western"><surname>Kheradpour</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Identification of functional elements and regulatory circuits by drosophila modENCODE</article-title>. <source>Science</source> <volume>330</volume>: <fpage>1787</fpage>–<lpage>1797</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Fu1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fu</surname><given-names>AQ</given-names></name>, <name name-style="western"><surname>Adryan</surname><given-names>B</given-names></name> (<year>2009</year>) <article-title>Scoring overlapping and adjacent signals from genome-wide ChIP and DamID assays</article-title>. <source>Mol Biosyst</source> <volume>5</volume>: <fpage>1429</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Moorman1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moorman</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>J</given-names></name>, <name name-style="western"><surname>De Wit</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Talhout</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Hotspots of transcription factor colocalization in the genome of drosophila melanogaster</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>103</volume>: <fpage>12027</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-MacArthur1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>MacArthur</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Chu</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Developmental roles of 21 drosophila transcription factors are determined by quantitative differences in binding to an overlapping set of thousands of genomic regions</article-title>. <source>Genome Biol</source> <volume>10</volume>: <fpage>R80</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Ohler1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ohler</surname><given-names>U</given-names></name> (<year>2006</year>) <article-title>Identification of core promoter modules in drosophila and their application in accurate transcription start site prediction</article-title>. <source>Nucleic Acids Res</source> <volume>34</volume>: <fpage>5943</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Barash1">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barash</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Calarco</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Gao</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Pan</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>X</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Deciphering the splicing code</article-title>. <source>Nature</source> <volume>465</volume>: <fpage>53</fpage>–<lpage>59</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Saeys1">
        <label>12</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Saeys</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Inza</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Larraaga</surname><given-names>P</given-names></name> (<year>2007</year>) <article-title>A review of feature selection techniques in bioinformatics</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>2507</fpage>–<lpage>2517</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Aliferis1">
        <label>13</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aliferis</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Statnikov</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Tsamardinos</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Mani</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Koutsoukos</surname><given-names>X</given-names></name> (<year>2010</year>) <article-title>Local causal and markov blanket induction for causal discovery and feature selection for classification part i: Algorithms and empirical evaluation</article-title>. <source>The Journal of Machine Learning Research</source> <volume>11</volume>: <fpage>171</fpage>–<lpage>234</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Aliferis2">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aliferis</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Statnikov</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Tsamardinos</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Mani</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Koutsoukos</surname><given-names>X</given-names></name> (<year>2010</year>) <article-title>Local causal and markov blanket induction for causal discovery and feature selection for classification part ii: analysis and extensions</article-title>. <source>The Journal of Machine Learning Research</source> <volume>11</volume>: <fpage>235</fpage>–<lpage>284</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Spirtes1">
        <label>15</label>
        <mixed-citation publication-type="other" xlink:type="simple">Spirtes P, Glymour CN, Scheines R (2000) Causation, prediction, and search. MIT Press.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Koller1">
        <label>16</label>
        <mixed-citation publication-type="other" xlink:type="simple">Koller D, Sahami M (1996) Toward optimal feature selection. In: International Conference on Machine Learning. Citeseer. pp. 284–292.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Scutari1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Scutari</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Learning bayesian networks with the bnlearn r package</article-title>. <source>Journal of Statistical Software</source> <volume>35</volume>: <fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Zinzen1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zinzen</surname><given-names>RP</given-names></name>, <name name-style="western"><surname>Girardot</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gagneur</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Braun</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Furlong</surname><given-names>EEM</given-names></name> (<year>2009</year>) <article-title>Combinatorial binding predicts spatiotemporal cis-regulatory activity</article-title>. <source>Nature</source> <volume>462</volume>: <fpage>65</fpage>–<lpage>70</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Benjamini1">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Hochberg</surname><given-names>Y</given-names></name> (<year>1995</year>) <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source> <volume>57</volume>: <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Benjamini2">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yekutieli</surname><given-names>D</given-names></name> (<year>2001</year>) <article-title>The control of the false discovery rate in multiple testing under dependency</article-title>. <source>Annals of Statistics</source> <volume>4</volume>: <fpage>1165</fpage>–<lpage>1188</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Li1">
        <label>21</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>Z</given-names></name> (<year>2009</year>) <article-title>Controlling the false discovery rate of the association/causality structure learned with the pc algorithm</article-title>. <source>The Journal of Machine Learning Research</source> <volume>10</volume>: <fpage>475</fpage>–<lpage>514</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Ramsey1">
        <label>22</label>
        <mixed-citation publication-type="other" xlink:type="simple">Ramsey J, Spirtes P, Zhang J (2006) Adjacency-faithfulness and conservative causal inference. In: Proceedings of the 22nd Conference on Uncertainty in Artificial Intelligence. pp. 401–408.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Kschischang1">
        <label>23</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kschischang</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Frey</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Loeliger</surname><given-names>H</given-names></name> (<year>2001</year>) <article-title>Factor graphs and the sum-product algorithm</article-title>. <source>IEEE Transactions on Information Theory</source> <volume>47</volume>: <fpage>498</fpage>–<lpage>519</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Pea1">
        <label>24</label>
        <mixed-citation publication-type="other" xlink:type="simple">Peña J (2008) Learning gaussian graphical models of gene networks with false discovery rate control. In: Evolutionary Computation, Machine Learning and Data Mining in Bioinformatics. Spring Verlag Berlin, Heidelberg. pp. 165–176.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Tsamardinos1">
        <label>25</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tsamardinos</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>L</given-names></name> (<year>2008</year>) <article-title>Bounding the false discovery rate in local bayesian network learning</article-title>. <source>In: Proceedings of the 23rd national conference on Artificial intelligence</source> <volume>2</volume>: <fpage>1100</fpage>–<lpage>1105</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Lam1">
        <label>26</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lam</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Bacchus</surname><given-names>F</given-names></name> (<year>1994</year>) <article-title>Learning bayesian belief networks: An approach based on the mdl principle</article-title>. <source>Computational Intelligence</source> <volume>10</volume>: <fpage>269</fpage>–<lpage>293</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Heckerman1">
        <label>27</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heckerman</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Geiger</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Chickering</surname><given-names>D</given-names></name> (<year>1995</year>) <article-title>Learning bayesian networks: The combination of knowledge and statistical data</article-title>. <source>Machine Learning</source> <volume>20</volume>: <fpage>197</fpage>–<lpage>243</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Tsamardinos2">
        <label>28</label>
        <mixed-citation publication-type="other" xlink:type="simple">Tsamardinos I, Aliferis CF, Statnikov A (2003) Algorithms for large scale markov blanket discovery. In: Proceedings of the Sixteenth International Florida Artificial Intelligence Research Society Conference. p. 376380.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Yaramakala1">
        <label>29</label>
        <mixed-citation publication-type="other" xlink:type="simple">Yaramakala S, Margaritis D (2005) Speculative markov blanket discovery for optimal feature selection. In: IEEE International Conference on Data Mining. Los Alamitos, CA, USA: IEEE Computer Society, volume 0, pp. 809–812.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Tsamardinos3">
        <label>30</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tsamardinos</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Aliferis</surname><given-names>C</given-names></name> (<year>2006</year>) <article-title>The max-min hill-climbing bayesian network structure learning algorithm</article-title>. <source>Machine Learning</source> <volume>65</volume>: <fpage>31</fpage>–<lpage>78</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Leptin1">
        <label>31</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Leptin</surname><given-names>M</given-names></name> (<year>1991</year>) <article-title>Twist and snail as positive and negative regulators during drosophila mesoderm development</article-title>. <source>Genes Dev</source> <volume>5</volume>: <fpage>1568</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Yin1">
        <label>32</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yin</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Frasch</surname><given-names>M</given-names></name> (<year>1998</year>) <article-title>Regulation and function of tinman during dorsal mesoderm induction and heart specification in drosophila</article-title>. <source>Dev Genet</source> <volume>22</volume>: <fpage>187</fpage>–<lpage>200</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Lilly1">
        <label>33</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lilly</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Galewsky</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Firulli</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Schulz</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Olson</surname><given-names>EN</given-names></name> (<year>1994</year>) <article-title>D-MEF2: a MADS box transcription factor expressed in differentiating mesoderm and muscle cell lineages during drosophila embryogenesis</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>91</volume>: <fpage>5662</fpage>–<lpage>5666</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Nguyen1">
        <label>34</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nguyen</surname><given-names>HT</given-names></name>, <name name-style="western"><surname>Bodmer</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Abmayr</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>McDermott</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Spoerel</surname><given-names>NA</given-names></name> (<year>1994</year>) <article-title>D-mef2: A drosophila Mesoderm-Specific MADS Box-Containing gene with a biphasic expression profile during embryogenesis</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>91</volume>: <fpage>7520</fpage>–<lpage>7524</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Taylor1">
        <label>35</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Taylor</surname><given-names>MV</given-names></name>, <name name-style="western"><surname>Beatty</surname><given-names>KE</given-names></name>, <name name-style="western"><surname>Hunter</surname><given-names>HK</given-names></name>, <name name-style="western"><surname>Baylies</surname><given-names>MK</given-names></name> (<year>1995</year>) <article-title>Drosophila MEF2 is regulated by twist and is expressed in both the primordia and differentiated cells of the embryonic somatic, visceral and heart musculature</article-title>. <source>Mech Dev</source> <volume>50</volume>: <fpage>29</fpage>–<lpage>41</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Azpiazu1">
        <label>36</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Azpiazu</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Frasch</surname><given-names>M</given-names></name> (<year>1993</year>) <article-title>tinman and bagpipe: two homeo box genes that determine cell fates in the dorsal mesoderm of drosophila</article-title>. <source>Genes Dev</source> <volume>7</volume>: <fpage>1325</fpage>–<lpage>1340</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Lee1">
        <label>37</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Frasch</surname><given-names>M</given-names></name> (<year>2005</year>) <article-title>Nuclear integration of positive dpp signals, antagonistic wg inputs and mesodermal competence factors during drosophila visceral mesoderm induction</article-title>. <source>Development</source> <volume>132</volume>: <fpage>1429</fpage>–<lpage>1442</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Zaffran1">
        <label>38</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zaffran</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kchler</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Frasch</surname><given-names>M</given-names></name> (<year>2001</year>) <article-title>biniou (FoxF), a central component in a regulatory network controlling visceral mesoderm development and midgut morphogenesis in drosophila</article-title>. <source>Genes Dev</source> <volume>15</volume>: <fpage>2900</fpage>–<lpage>2915</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Zaffran2">
        <label>39</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zaffran</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Frasch</surname><given-names>M</given-names></name> (<year>2002</year>) <article-title>The beta 3 tubulin gene is a direct target of bagpipe and biniou in the visceral mesoderm of drosophila</article-title>. <source>Mech Dev</source> <volume>114</volume>: <fpage>85</fpage>–<lpage>93</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Junion1">
        <label>40</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Junion</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Spivakov</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Girardot</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Braun</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gustafson</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A transcription factor collective defines cardiac cell fate and reflects lineage history</article-title>. <source>Cell</source> <volume>148</volume>: <fpage>473</fpage>–<lpage>486</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Rosenfeld1">
        <label>41</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rosenfeld</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Elowitz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Alon</surname><given-names>U</given-names></name> (<year>2002</year>) <article-title>Negative autoregulation speeds the response times of transcription networks</article-title>. <source>J Mol Biol</source> <volume>323</volume>: <fpage>785</fpage>–<lpage>793</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Friedman1">
        <label>42</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Geiger</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Goldszmidt</surname><given-names>M</given-names></name> (<year>1997</year>) <article-title>Bayesian network classifiers</article-title>. <source>Machine Learning</source> <volume>29</volume>: <fpage>131</fpage>–<lpage>163</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Kharchenko1">
        <label>43</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kharchenko</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Alekseyenko</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Schwartz</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Minoda</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Riddle</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Comprehensive analysis of the chromatin landscape in drosophila melanogaster</article-title>. <source>Nature</source> <volume>471</volume>: <fpage>480</fpage>–<lpage>5</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Negre1">
        <label>44</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Negre</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Ma</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bristow</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>SW</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>A cis-regulatory map of the drosophila genome</article-title>. <source>Nature</source> <volume>471</volume>: <fpage>527</fpage>–<lpage>531</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Blyth1">
        <label>45</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blyth</surname><given-names>C</given-names></name> (<year>1972</year>) <article-title>On simpson's paradox and the sure-thing principle</article-title>. <source>Journal of the American Statistical Association</source> <volume>338</volume>: <fpage>364</fpage>–<lpage>366</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Spirtes2">
        <label>46</label>
        <mixed-citation publication-type="other" xlink:type="simple">Spirtes P, Meek C, Richardson T (1995) Causal inference in the presence of latent variables and selection bias. In: Proceedings of the Eleventh Conference on Uncertainty in Artificial Intelligence. San Mateo, CA. Morgan Kaufmann Publishers, Inc. pp. 499–506.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Conrad1">
        <label>47</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Conrad</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Erfle</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Warnat</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Daigle</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Lörch</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Automatic identification of subcellular phenotypes on human cell arrays</article-title>. <source>Genome Res</source> <volume>14</volume>: <fpage>1130</fpage>–<lpage>1136</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Pepperkok1">
        <label>48</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pepperkok</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Ellenberg</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>High-throughput fluorescence microscopy for systems biology</article-title>. <source>Nat Rev Mol Cell Biol</source> <volume>7</volume>: <fpage>690</fpage>–<lpage>696</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Bakal1">
        <label>49</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bakal</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Aach</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Church</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Perrimon</surname><given-names>N</given-names></name> (<year>2007</year>) <article-title>Quantitative morphological signatures define local signaling networks regulating cell morphology</article-title>. <source>Science</source> <volume>316</volume>: <fpage>1753</fpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-MummeryWidmer1">
        <label>50</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mummery-Widmer</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Yamazaki</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Stoeger</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Novatchkova</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bhalerao</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Genome-wide analysis of notch signalling in drosophila by transgenic rnai</article-title>. <source>Nature</source> <volume>458</volume>: <fpage>987</fpage>–<lpage>992</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002725-Schnorrer1">
        <label>51</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schnorrer</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Schönbauer</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Langer</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Dietzl</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Novatchkova</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Systematic genetic analysis of muscle morphogenesis and function in drosophila</article-title>. <source>Nature</source> <volume>464</volume>: <fpage>287</fpage>–<lpage>291</lpage>.</mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>