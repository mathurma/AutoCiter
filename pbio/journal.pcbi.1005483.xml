<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005483</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00957</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neuronal tuning</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular types</subject><subj-group><subject>Animal cells</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cellular neuroscience</subject><subj-group><subject>Neurons</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Molecular neuroscience</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Research design</subject><subj-group><subject>Experimental design</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Membrane potential</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Action potentials</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Nucleotide-time alignment for molecular recorders</article-title>
<alt-title alt-title-type="running-head">Nucleotide-time alignment for molecular recorders</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0613-7617</contrib-id>
<name name-style="western">
<surname>Cybulski</surname>
<given-names>Thaddeus R.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Boyden</surname>
<given-names>Edward S.</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Church</surname>
<given-names>George M.</given-names>
</name>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="aff" rid="aff007"><sup>7</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2342-0687</contrib-id>
<name name-style="western">
<surname>Tyo</surname>
<given-names>Keith E. J.</given-names>
</name>
<xref ref-type="aff" rid="aff008"><sup>8</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Kording</surname>
<given-names>Konrad P.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff009"><sup>9</sup></xref>
<xref ref-type="aff" rid="aff010"><sup>10</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Department of Physical Medicine and Rehabilitation, Rehabilitation Institute of Chicago, Northwestern University, Chicago, Illinois, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Media Lab, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Department of Biological Engineering, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>McGovern Institute, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff005"><label>5</label> <addr-line>Biophysics Program, Harvard University, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff006"><label>6</label> <addr-line>Wyss Institute, Harvard University, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff007"><label>7</label> <addr-line>Department of Genetics, Harvard Medical School, Harvard University, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff008"><label>8</label> <addr-line>Department of Chemical and Biological Engineering, Northwestern University, Evanston, Illinois, United States of America</addr-line></aff>
<aff id="aff009"><label>9</label> <addr-line>Department of Physiology, Northwestern University, Chicago, Illinois, United States of America</addr-line></aff>
<aff id="aff010"><label>10</label> <addr-line>Department of Applied Mathematics, Northwestern University, Evanston, Illinois, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Kosakovsky Pond</surname>
<given-names>Sergei L.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Temple University, UNITED STATES</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"> <list-item>
<p><bold>Conceived and designed the experiments:</bold> TRC ESB GMC KEJT KPK.</p></list-item> <list-item>
<p><bold>Performed the experiments:</bold> TRC.</p></list-item> <list-item>
<p><bold>Analyzed the data:</bold> TRC KPK.</p></list-item> <list-item>
<p><bold>Wrote the paper:</bold> TRC ESB GMC KEJT KPK.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">cyb@northwestern.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>1</day>
<month>5</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="collection">
<month>5</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>5</issue>
<elocation-id>e1005483</elocation-id>
<history>
<date date-type="received">
<day>14</day>
<month>6</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>3</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Cybulski et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005483"/>
<abstract>
<p>Using a DNA polymerase to record intracellular calcium levels has been proposed as a novel neural recording technique, promising massive-scale, single-cell resolution monitoring of large portions of the brain. This technique relies on local storage of neural activity in strands of DNA, followed by offline analysis of that DNA. In simple implementations of this scheme, the time when each nucleotide was written cannot be determined directly by <italic>post-hoc</italic> DNA sequencing; the timing data must be estimated instead. Here, we use a Dynamic Time Warping-based algorithm to perform this estimation, exploiting correlations between neural activity and observed experimental variables to translate DNA-based signals to an estimate of neural activity over time. This algorithm improves the parallelizability of traditional Dynamic Time Warping, allowing several-fold increases in computation speed. The algorithm also provides a solution to several critical problems with the molecular recording paradigm: determining recording start times and coping with DNA polymerase pausing. The algorithm can generally locate DNA-based records to within &lt;10% of a recording window, allowing for the estimation of unobserved incorporation times and latent neural tunings. We apply our technique to an <italic>in silico</italic> motor control neuroscience experiment, using the algorithm to estimate both timings of DNA-based data and the directional tuning of motor cortical cells during a center-out reaching task. We also use this algorithm to explore the impact of polymerase characteristics on system performance, determining the precision of a molecular recorder as a function of its kinetic and error-generating properties. We find useful ranges of properties for DNA polymerase-based recorders, providing guidance for future protein engineering attempts. This work demonstrates a useful general extension to dynamic alignment algorithms, as well as direct applications of that extension toward the development of molecular recorders, providing a necessary stepping stone for future biological work.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>This work demonstrates a necessary computational tool for the development and implementation of molecular recorders, a promising potential technique for massive-scale neuroscience. Molecular recorders use proteins to encode levels of a substance we want to measure (e.g. calcium in neural applications) as detectable changes in a linear cellular structure, e.g. misincorporations in a strand of DNA, or fluorescent proteins traveling down a microtubule. This encoding represents levels of the measured substance over time, much like a ticker tape represents information linearly on a strip of paper. The unique intracellular nature of this approach promises a significant scaling advantage over current techniques. The molecular recording approach suffers a particular drawback involving timing: unlike most methods of recording signals, in simple molecular recording systems we do not observe when each data point was recorded. This timing information is almost always required in order to make associations between our recorded data and the rest of the experiment. In this work, we propose a method to estimate the timing of these data points using easily-observable experimental measurements. We demonstrate the application of this method in a simulated neuroscience paradigm, investigate the effect of experimental design on this method, and determine protein properties that would be desirable in molecular recorders. These findings are useful both as a computational proof-of-concept, and as guidelines for current efforts to engineer proteins for molecular recording.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000052</institution-id>
<institution>NIH Office of the Director</institution>
</institution-wrap>
</funding-source>
<award-id>1R01MH103910-01</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Kording</surname>
<given-names>Konrad P.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported by NIH Director's Transformative Research Award 1R01MH103910 (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov" xlink:type="simple">www.nih.gov</ext-link>). ESB was supported by NIH Director's Pioneer Award 1DP1NS087724 and the New York Stem Cell Foundation-Robertson Award (<ext-link ext-link-type="uri" xlink:href="http://nyscf.org/" xlink:type="simple">http://nyscf.org/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="2"/>
<page-count count="22"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-05-15</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Electrophysiological and behavioral data underlying these analyses can be found in the DREAM database at crcns.org (<ext-link ext-link-type="uri" xlink:href="https://portal.nersc.gov/project/crcns/download/dream" xlink:type="simple">https://portal.nersc.gov/project/crcns/download/dream</ext-link>). All other data is contained within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>As we seek to understand complex questions in neuroscience, we are increasingly interested in the feasibility of massive-scale methods for neural recording [<xref ref-type="bibr" rid="pcbi.1005483.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005483.ref005">5</xref>]. One such proposed method is molecular recording, which uses engineered DNA polymerases (DNAPs) to encode information about neural activity onto a newly synthesized DNA strand, such that the position in the DNA sequence corresponds to the order and approximate timing of recorded events [<xref ref-type="bibr" rid="pcbi.1005483.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1005483.ref008">8</xref>]. Rather than reading out neural activity from an electrode or photodiode during an experiment, molecular recorders would store neural activity intracellularly. This information would not be read out in real-time, but <italic>post-hoc</italic> using high-throughput DNA sequencing. The recording DNAPs could be genetically encoded and selectively expressed in neurons, allowing us to obtain activity records from large populations of cells. DNAP-based recording techniques promise an inherently ultrahigh-scale neural recording technique, building off of advances in biotechnology and computational power. However, significant hurdles remain in realizing such a technology.</p>
<p>While molecular recorders promise massive-scale neural recording, they do not inherently provide all the data obtained using current recording techniques. With current techniques, e.g. electrical or optical recording, data about the timing of each sample is recorded alongside the desired recording. With DNAP-based recorders, we sample data using DNA sequencing, which occurs after an experiment has concluded. That is, without any inherent clocking mechanisms, the output from molecular recorders lacks any explicit timing information about what it recorded. Without timing information, recorded neural activity cannot be interpreted in the context of other signals observed during experiments, e.g. movement or delivered stimulus. The central problem here is that we do not know which nucleotides were written at which times, i.e. we cannot link our representation of neural activity to things we observe in the outside world. Thus, the timing of data from molecular recorders must be inferred or estimated before it can be useful to understand the brain.</p>
<p>Due to the stochasticity inherent in DNAP activity (or that of any protein), it is difficult to predict when a nucleotide was incorporated <italic>de novo</italic>. Uncertainty in timing estimates result in uncertainty about the underlying signal; without timing information, signal estimates become highly inaccurate, providing at most a few seconds of reliable recording under common conditions [<xref ref-type="bibr" rid="pcbi.1005483.ref007">7</xref>]. However, if we observe experimental data that should be correlated with neural activity during our experiments, we can generate predictions of what possible patterns of neural activity we might observe given that data. This, in turn, can provide some information about the timing of nucleotide incorporations: if we see a particular pattern of activity in our DNA-based record, the DNA was likely written by a neuron whose tuning would generate a similar activity pattern in response to the experimental variables we observe, and at a time where the neuron would have generated that pattern. If we enumerate the ways in which we believe a neuron could respond to the observed experimental variables in question, we can search for the most-likely response given the DNA-based record we observe. It is worth stating that this type of approach is not model-free, and there are many situations where this assumption of a tuning model is inappropriate, i.e. in areas of the nervous system that we either model poorly or do not know what form a model would take. However, in areas where we have reliable modeling approaches or seek to evaluate particular models, a model-based approach may be able to provide considerable insight.</p>
<p>One way to utilize these models to estimate timing is the one we use here: generate predictions of neural activity with known timing using observed experimental variables, then find the globally most-similar alignment between those predictions and our recorded data. This class of alignment problems is frequently found in the time series analysis domain, e.g. in speech or signature recognition [<xref ref-type="bibr" rid="pcbi.1005483.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1005483.ref011">11</xref>]. Dynamic time warping (DTW) is an efficient solution to this class of alignment problems, determining the optimal alignment between the template and signal using dynamic programming principles. With a probabilistic interpretation, DTW allows us to infer the most likely timing of a signal with respect to a given template, as well as determining the most likely template from a set of possible templates [<xref ref-type="bibr" rid="pcbi.1005483.ref012">12</xref>]. These properties make DTW-class algorithms uniquely suited for the determination of signal timings for molecular recorders.</p>
<p>Given that we are interested in applying this algorithm to massive-scale datasets, we are immediately interested in algorithms that can efficiently harness large-scale computing resources. As DTW is a dynamic algorithm, with successive steps depending on previous calculations, it is difficult to apply asynchronous computing approaches, at least on an algorithm level. Thus many, though not all, parallel approaches to DTW have largely focused on task-level parallelism rather than parallelizing cost computation [<xref ref-type="bibr" rid="pcbi.1005483.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1005483.ref018">18</xref>]. As a result, for computationally-intensive individual alignments, it tends to be difficult to fully utilize the massively parallel computing resources that are becoming more common. A highly-parallelized dynamic alignment algorithm would be useful for a number of reasons.</p>
<p>Here we describe a parallelized step-pattern variant of DTW with applications to the analysis of molecular recorder output. We demonstrate the algorithm’s ability to accurately determine incorporation times for single DNA strands generated by a simulated molecular recorder, compensating for the timing issues inherent in protein-based molecular recorders. We demonstrate the utility of this algorithm in practice through simulated neuroscience applications, and use simple simulated experiments to explore how DNAP parameters such as speed and error rate affect the accuracy of our timing estimates. Through proposal and application of this algorithm, we present findings relevant for current biological research into molecular recording.</p>
<sec id="sec002">
<title>Algorithm and experimental overview</title>
<p>Our algorithm solves a problem central to interpreting molecular recorder output in the context of neural recording: it aligns a single DNA-based record to an estimate of neural activity. We evaluate the local likelihood of each nucleotide being written at any time within some recording window given some assumed neural and DNAP properties. Then, using a dynamic programming-based technique, we attempt to find a global alignment given the local likelihoods and a prior defined by the DNAP kinetics. This algorithm is similar in structure to Dynamic Time Warping, utilizing a modified step pattern that reflects certain biological realities (See Algorithm Methods,<xref ref-type="supplementary-material" rid="pcbi.1005483.s001">S1 Fig</xref>). The step pattern limits the possible search space by enforcing these constraints: 1) nucleotides cannot be aligned to the same time point, 2) nucleotides can only be aligned to one time point, and 3) there can be a variable amount of time between incorporation of two adjacent nucleotides. We weight the potential options from this step pattern so that alignments made more likely by DNAP kinetics are favored. Notably, this approach enables significant algorithm parallelism, emerging from the constraint that nucleotides can only be aligned to one time point. As there are no dependencies between possible alignments of a given nucleotide, we can calculate the costs of all possible alignments of a given nucleotide concurrently.</p>
<p>In order to demonstrate the utility of this algorithm, we apply our technique to simulated output of molecular recorders (<xref ref-type="fig" rid="pcbi.1005483.g001">Fig 1A</xref>), demonstrating various aspects of algorithm performance as well as exploring the ability of DNAPs to encode neural information. The general experimental pipeline consists of four parts: (1) simulation of a molecular recording experiment (<xref ref-type="fig" rid="pcbi.1005483.g001">Fig 1B and 1C</xref>), (2) alignment of single recorder outputs to a set of time-indexed expected DNAP error rates, which represent potential neural tunings to observed experimental covariates, (3) selection of a template that best matches the molecular recorder output (<xref ref-type="fig" rid="pcbi.1005483.g001">Fig 1D</xref>), and (4) inference of neural parameters using time-aligned DNA-based signals (see <xref ref-type="sec" rid="sec014">Methods</xref>).</p>
<fig id="pcbi.1005483.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005483.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Procedural overview.</title>
<p>A) Molecular recording overview. A DNAP (green) copies a template DNA strand of known sequence. It can incorporate the correct Watson-Crick paired nucleotide (blue) or make an error and incorporate a non-paired nucleotide (orange). These incorporations and misincorporations can be read out via DNA sequencing. The time τ between these nucleotide incorporations is variable and a function of DNAP kinetics. While these nucleotides have regular DNA-based indexing, they have irregular indexing with respect to time. B) Examples of nucleotide-time mappings, simulated as described in Methods. Stochastic DNAP kinetics produce non-linear nucleotide-time mappings. Further, diffusion and other biological processes can lead to non-uniform recording start times. C) Generative model for DNA-based error signals. Neural spikes lead to elevated calcium levels in the neuron. These changes in calcium alter the instantaneous error rate of a molecular recorder. These changes in error rate are only recorded when nucleotides are incorporated into a DNA strand, causing the resulting DNA-based record to be a function of cellular calcium and DNAP kinetics. D) Overview of alignment and inference. We begin with a set of potential neural tunings and a time-varying stimulus. The stimulus is transformed by the neuron to neural activity, which is then recorded as errors in a DNA strand by a molecular recorder. In parallel, we use the set of potential neural tunings in combination with the observed stimulus to generate estimates of neural calcium and the resulting instantaneous DNAP error rate. We use our algorithm to align the DNA-based errors to each of the estimated error-rate traces, then select the maximum-likelihood alignment. Dashed box indicate biological processes that are simulated in parts of these analyses.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.g001" xlink:type="simple"/>
</fig>
<p>We simulate a biologically-inspired generative model with several parts: (1) an explicit parameterized model of how neural activity either depends on a stimulus or results in observed behavior (Neural Tuning), (2) how this neural activity modulates DNAP error rate, via Ca<sup>2+</sup> concentration or other mechanisms (DNAP Tuning), and (3) a probabilistic description of DNAP kinetic properties, e.g. incorporation rate and pausing (DNAP Kinetics). This generative model can be parametrized using existing knowledge about neural and polymerase properties where known. In this paper, we use DNAPs with optimistic DNAP error tuning, i.e. maximum error rates higher than many DNAPs with incorporation rates suitable for recording, but with otherwise-realistic properties [<xref ref-type="bibr" rid="pcbi.1005483.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1005483.ref021">21</xref>]. We also assume knowledge of these system characteristics (apart from neural tuning) in order to parametrize the alignment algorithm.</p>
<p>Given simulated DNA output and a time-varying input to the system, we iterate over potential neural tunings to find a tuning that provides an alignment most consistent with the observed DNA-based signal. We then use this <italic>maximum a posteriori</italic> alignment to generate a time-indexed DNA signal, and use this signal to infer neural parameters. We evaluate algorithm performance both by accuracy of timing estimation, i.e. how many seconds estimated incorporation times differ from true incorporation times on average, and accuracy of inferred neural tuning parameters, i.e. how the estimated behavior of a neuron differs from the true neural behavior. Specifically, to evaluate accuracy of timing estimates, we examine the root-mean square deviation (RMSD) between the estimated timings and the true incorporation times for a given alignment.</p>
<p>There is a highly non-linear relationship between alignment “success” and timing accuracy, as nearby alignments do not necessarily have similar likelihoods. Thus, we provide both a mean and median value for timing accuracy when those values differ by a large amount. To evaluate tuning accuracy, we estimate tuning parameters from the aligned DNA data and examine the distance between the algorithm-estimated parameters and those derived directly from the recorded neural data, which we treat as ground-truth for these studies.</p>
</sec>
</sec>
<sec id="sec003" sec-type="results">
<title>Results</title>
<sec id="sec004">
<title>Performance comparison to traditional DTW</title>
<p>Before exploring algorithm applications, it is worth exploring the performance implications of this approach. It bears mentioning again that, while they do not calculate the same cost function, our algorithm and traditional DTW are closely related; both are dynamic programming algorithms with effective worst-case complexity of <italic>O</italic>(<italic>NT</italic>) where N and T are the lengths of the two inputs being aligned. As we have mentioned, our algorithm has significant differences in implementation that allow it to be substantially parallelized; this allows for substantial performance increases using modern computing devices (See Algorithm Methods). While a naïve implementation of our algorithm performs more slowly than traditional DTW for a given set of inputs, parallelized implementations substantially outperform traditional DTW (<xref ref-type="supplementary-material" rid="pcbi.1005483.s001">S1 Fig</xref>). We observe up to a 16x speedup over traditional DTW when using a GPU-based implementation of our algorithm on a personal computer, and up to a 5x speedup when using a CPU-based implementation.</p>
</sec>
<sec id="sec005">
<title>Acceptable parameters for DNAP-based recorders</title>
<p>The feasibility of a “ticker tape” DNA-based recording scheme depends heavily on the properties of the DNAP used. For instance, the length of records (in base pairs) influences how much information is contained about neural activity, and thus impacts algorithm performance. Similarly, the speed, pausing, and fidelity properties of the DNAP used influence the information about neural activity contained in a DNA-based record [<xref ref-type="bibr" rid="pcbi.1005483.ref007">7</xref>]. Here, we look to determine the effect of these properties on the accuracy of our algorithm, and thus the expected performance of a molecular recording setup. Determining these effects allow us to form guidelines as to what kinds of DNAPs would be required for successful recording and alignment.</p>
<p>We use an entirely-simulated experiment here, i.e. we fully know the tuning linking stimulus to neural activity. This allows us to isolate the effects of DNAP properties on alignment from the effects of inaccurate neural activity estimates. We simulate a neuron with a linear response to an artificial stimulus; we deliver random levels of stimulus in 5s blocks over the course of 2000s (~30 minute recording window), and simulate the neuron’s spiking activity and intracellular calcium. We then simulate the output of a molecular recording system during that time period. We then align the molecular recorder output to the true stimulus signal. Using this simulation, we can focus on error induced by the DNAP and alignment algorithm in isolation.</p>
<p>We aim to estimate nucleotide incorporation timings, as well as the strength of the neuron’s tuning to the stimulus, i.e. the slope of the neuron’s tuning curve. The best alignments possible under this scheme have timing error up to the size of the stimulus features (5s); alignments with timing error less than this are generally considered to be accurate. Error with respect to tuning parameter is presented as a proportion of the true parameter. Except for the DNAP parameter being varied, the simulated DNAPs are identical (~100 Hz, mean pause duration of 2s; see <xref ref-type="sec" rid="sec014">Methods</xref>).</p>
<p>As record length increases, finding a randomly generated pattern that resembles the record becomes less likely, and alignment to a unique site should become easier. However, from a biological perspective, generating longer sequences may be more difficult, requiring polymerases with specialized properties, e.g. high processivity, high activity, or strand-displacement activity. Thus, it is useful to know minimal record lengths for successful alignment. When we increase record length in our simulations, we indeed find a resulting decreasing timing error. Generally, we find that records with length longer than 2.5K basepairs align with &lt;5s median timing error (<xref ref-type="fig" rid="pcbi.1005483.g002">Fig 2A and 2B</xref>). Interestingly, we find that slope estimation is relatively constant regardless of record length, suggesting that, while record length is crucial to timing estimation, information about neural tuning in the record is not necessarily absent in shorter records (<xref ref-type="fig" rid="pcbi.1005483.g002">Fig 2C</xref>).</p>
<fig id="pcbi.1005483.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005483.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Effect of DNAP parameters on alignment and tuning estimation.</title>
<p>Examining alignment performance using simulated DNAPs with varying parameters. Bootstrapped 95% confidence intervals of displayed values are indicated by blue silhouettes. <bold>A,B)</bold> The mean and median timing RMSD of alignments for DNA-based records of increasing length. <bold>C)</bold> Error in slope estimation for DNA-based records of increasing length. <bold>D,E)</bold> The mean and median timing RMSD of alignments for DNAPs with decreasing nucleotide incorporation rates. <bold>F)</bold> Error in slope estimation for DNAPs with decreasing nucleotide incorporation rates. <bold>G,H)</bold> Mean and median timing RMSD of alignments for DNAPs with increasing sensitivity to [Ca<sup>2+</sup>]. <bold>I)</bold> Error in slope estimation for DNAPs with increasing sensitivity to [Ca<sup>2+</sup>]. <bold>J,K)</bold> The mean and median timing RMSD of alignments for DNAPs of increasing maximum error rate. <bold>L)</bold> Error in slope estimation for DNAPs with increasing maximum error rate.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.g002" xlink:type="simple"/>
</fig>
<p>DNAP speed effectively changes the sampling rate of our system; if we have a slow DNAP, we can record for longer periods of time for a given strand length, but also record less information about any given interval. If we are interested in longer time-scale phenomena (e.g. environmental sensing, medical diagnostics) [<xref ref-type="bibr" rid="pcbi.1005483.ref022">22</xref>], we may wish to use slow DNAPs. However, due to the low sampling rate, we may not be able to recover useful information about timing and tuning in a neural paradigm. In our simulated stimulation paradigm, we find that slower DNAPs in fact increase timing accuracy (<xref ref-type="fig" rid="pcbi.1005483.g002">Fig 2D</xref>). However, median timing error stays relatively constant as speed decreases, implying that slow DNAPs simply decrease the amount of extreme timing errors we observe (<xref ref-type="fig" rid="pcbi.1005483.g002">Fig 2E</xref>). This runs parallel to our observations about record length; aligning to a longer time-indexed template is easier than aligning to a short one. However, our accuracy in determining tuning parameters decreases as we use slower DNAPs (<xref ref-type="fig" rid="pcbi.1005483.g002">Fig 2F</xref>). This indicates that we should, in general, be using fast DNAPs if we are interested in recovering tunings [<xref ref-type="bibr" rid="pcbi.1005483.ref019">19</xref>]. Meanwhile, slower DNAPs can provide longer records for a given strand length at the expense of diluting the information they carry about underlying phenomena.</p>
<p>Another property of DNAPs that can affect the quality of recordings is the transfer function relating analyte (e.g. calcium) concentration to error rate, <italic>f</italic>(·). We have modeled <italic>f</italic>(·) as a sigmoid with three parameters:
<disp-formula id="pcbi.1005483.e001">
<alternatives>
<graphic id="pcbi.1005483.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e001" xlink:type="simple"/>
<mml:math display="block" id="M1">
<mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>C</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(1.1)</label>
</disp-formula>
where <italic>C</italic><sub>0</sub> denotes the [Ca<sup>2+</sup>] that leads to half-maximum error rate, <italic>b</italic> denotes the steepness of the response curve, and <italic>R</italic><sub><italic>max</italic></sub> denotes the maximum error rate of the DNAP. When selecting (or engineering) DNAPs to record with, we will need to optimize over these parameters. Here, we analyze DNAPs with varying transfer function slopes <italic>b</italic>, i.e. varying sensitivities to [Ca<sup>2+</sup>], ranging from step-like DNAPs to DNAPs with a wide dynamic range. We find that DNAPs with moderate sensitivities to [Ca<sup>2+</sup>] provide the most accurate timings, while both step-like and overly shallow transfer functions decrease alignment accuracy (<xref ref-type="fig" rid="pcbi.1005483.g002">Fig 2G and 2H</xref>). We find similar results for parameter estimation (<xref ref-type="fig" rid="pcbi.1005483.g002">Fig 2I</xref>), where appropriately-sloped DNAP tunings provide better estimates of neural parameters than DNAPs that are either too insensitive (low |<italic>b</italic>|) or too step-like (high |<italic>b</italic>|) with respect to [Ca<sup>2+</sup>]. This adds evidence to an assumption many investigating molecular recording techniques have been working under: DNAPs will have to be tailored in order to achieve optimal recording of even simple signals.</p>
<p>We are also interested in how the maximum error rate <italic>R</italic><sub><italic>max</italic></sub> affects alignment accuracy. This is of particular interest from a biological perspective: many natural DNAPs with incorporation rates suitable for high-resolution recording have low error rates. It is useful to understand what minimal error rates would be feasible for molecular recorders, as well as examine system performance as <italic>R</italic><sub><italic>max</italic></sub> scales. Here, we consider DNAPs that have near-zero error rates at low [Ca<sup>2+</sup>], and increase to some maximum error rate <italic>R</italic><sub><italic>max</italic></sub> under high [Ca<sup>2+</sup>] conditions. We find that alignment accuracy increases as maximum error rate increases (<xref ref-type="fig" rid="pcbi.1005483.g002">Fig 2J and 2K</xref>), as expected. Interestingly, we find that parameter estimation is relatively insensitive to <italic>R</italic><sub><italic>max</italic></sub>. Again, this seems to suggest that while timing accuracy tends to degrade with unfavorable DNAP parameters, molecular recorder output tends to retain information about underlying neural tuning.</p>
</sec>
<sec id="sec006">
<title>Application to a center-out reaching task</title>
<p>Here, we demonstrate the feasibility of molecular recorders in a conventional neuroscience experimental paradigm. We analyze single-unit neural data recorded from M1 and pre-motor cortex during a center-out reaching task in a rhesus macaque, estimating the preferred movement directions of recorded neurons (data obtained from the DREAM reaching experiment database, see Flint 2012 for details [<xref ref-type="bibr" rid="pcbi.1005483.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1005483.ref025">25</xref>]). We use the recorded spikes as the basis for simulated calcium transients and molecular recorder output. We also generate a set of estimates of neural activity from the kinematic data recorded during the task, with estimates representing velocity-tuned neurons with preferred directions distributed uniformly on [0, 2<italic>π</italic>]. Here, we use eight activity estimates as alignment templates. We apply our alignment algorithm to this data, aligning the molecular recorder output to each of the estimates, then selecting the maximum-likelihood alignment. The result, an estimated mapping of nucleotides to time, allows us to generate tuning curves for the recorded neurons. From this, we can estimate neural tuning parameters and infer how neural activity is modulated with respect to the recorded kinematics (details in <xref ref-type="sec" rid="sec014">Methods</xref>). The alignments here encounter alignment- and DNAP-based error, as in the previous section, but also encounter biology-based error when estimating neural activity from kinematic data. Thus, these experiments serve as an estimate of molecular recorder performance in a real-world scenario.</p>
<p>Using a plausible set of DNAP parameters (~100 Hz incorporation rate, mean pause duration of 2s, ~17% of time spent paused; see <xref ref-type="sec" rid="sec014">Methods</xref> for further details), we find that we are generally able to recover rough timing estimates and accurate tuning parameters from the simulated molecular recording experiment. As an initial demonstration, we examine several neurons that exhibit high firing rates and significant directional tuning (<xref ref-type="fig" rid="pcbi.1005483.g003">Fig 3A</xref>). Under these conditions, we are able to estimate nucleotide timings to within an average of ~15s (95% confidence intervals for average trial RMSD: [10.0,16.5], [12.1,20.3], and [14.8,22.5] seconds, <xref ref-type="fig" rid="pcbi.1005483.g003">Fig 3B</xref>). While timing accuracy is lower than desired, particularly for experiments that require sub-second precision using current techniques, these alignments still allow us to generate the estimated neural tuning direction <italic>θ</italic>* with error of ~10% (average errors of 0.5, 0.3, and 0.3 radians, <xref ref-type="fig" rid="pcbi.1005483.g003">Fig 3C</xref>). Median timings are substantially better than average timings across the board (95% confidence intervals for median trial RMSD: [3.8,7.2], [3.1,8.7], and [6.5,13.7] seconds).</p>
<fig id="pcbi.1005483.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005483.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Determination of tuning parameters in neurons.</title>
<p>Data for each of the three analyzed neurons are displayed as columns. <bold>A)</bold> Neural activity plotted as a function of cursor velocity in 3 selected neurons from the Flint 2012 dataset. Points represent neural spikes, locations indicate hand velocity during the spike time. <bold>B)</bold> Timing error (RMSD) as a function of alignment likelihood for model-derived timings in 3 selected neurons. Each point represents the most-likely alignment of the DNA-based record to one of eight activity estimates. Each point represents one of 100 trials. <bold>C)</bold> Estimated neural preferred direction as a function of alignment likelihood for the 3 selected neurons. Each point represents the preferred reach direction generated from the best alignment of the DNA-based record. Dashed lines indicate the preferred direction of the neuron, estimated from neural activity data. Each point represents one of 100 trials.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.g003" xlink:type="simple"/>
</fig>
<p>Some of the error we encounter when generating alignment estimates may stem from our discrete parametrization of neural tunings. That is, we may not provide an estimate of neural activity similar enough to the true activity in order to generate accurate alignments. We can examine the contributions of this effect to algorithm accuracy by supplying a neural activity estimate generated using the neural tuning estimated from electrophysiology data, the best possible estimate we can provide given a particular model. Indeed, if we supply a neural activity estimate generated using the ground-truth neural preferred direction in our motor control experiment (rather than the 8 naïve preferred directions), we substantially reduce both timing error and error in <italic>θ</italic>* (<xref ref-type="supplementary-material" rid="pcbi.1005483.s002">S2 Fig</xref>). While we do not know the true preferred direction <italic>a priori</italic> and this kind of analysis could not be performed in practice, this suggests that a large portion of observed error can be attributed to the discrete parametrization of the search space. Increasing the resolution of the search space should improve alignment accuracy at the expense of execution time.</p>
<p>We apply our algorithm to each neuron in the dataset, examining aggregate performance over a population of recorded neurons. We find that the technique has middling performance on the whole dataset, only able to estimate timings to within 24s for 12% of neurons recorded (<xref ref-type="supplementary-material" rid="pcbi.1005483.s003">S3 Fig</xref>). If we limit the set of analyzed neurons to those that have substantial reach-modulated activity (model pseudo-R<sup>2</sup> &gt; 0.05, firing rate <italic>λ</italic> &gt; 20 spikes/s), this improves to 47%. We are able to estimate preferred direction to within ±0.2π (±36°) for 39% of the dataset; this improves to 59% of the reach-modulated neurons (<xref ref-type="supplementary-material" rid="pcbi.1005483.s003">S3 Fig</xref>). While this filtering does not explain all observed error, it is useful when reconciling the results for individual neurons in <xref ref-type="fig" rid="pcbi.1005483.g003">Fig 3</xref> with the larger dataset. This improvement upon filtering for active, well-modeled neurons demonstrates two things: 1) this method performs poorly on sparse-firing neurons, and 2) this method performs poorly on neurons that are not well-described by the set of models we consider. Both of these shortcomings are as expected given the algorithm. The former can be addressed by evaluating average neural activity represented by a DNA-based record, which can be done in a naïve, model-free manner. The latter, an inability to align signals that we cannot already model accurately, remains a shortcoming of this approach when attempting the interpretation of molecular recorder output.</p>
<p>We also analyze recording systems with a hypothetical DNAP that exhibits no pausing, but is otherwise identical to the previous DNAPs (see <xref ref-type="sec" rid="sec014">Methods</xref>). When examining the same neurons as above, we find drastically decreased timing errors (RMSD 95% CIs of [0.17,0.18], [0.31,0.39], and [0.47,3.0] seconds) and parameter estimation errors (average errors of 0.1, 0.2, and -0.04 radians, <xref ref-type="supplementary-material" rid="pcbi.1005483.s004">S4 Fig</xref>). Using these highly optimized DNAPs, we approach the timing resolution that would seem to be useful for high-precision neuroscience experiments, and retain high-accuracy prediction of neural tunings. A conclusion from this analysis is that much of the error we observe with our technique resolves when DNAPs behave more regularly. These results are of particular interest to us because of their biological implications: DNAP pausing generally has both DNAP-based and sequence-dependent components, and can be ablated using sequence context, chemical, or temperature-based means [<xref ref-type="bibr" rid="pcbi.1005483.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005483.ref026">26</xref>,<xref ref-type="bibr" rid="pcbi.1005483.ref027">27</xref>]. This significant improvement in both timing accuracy and parameter estimation suggest that decreasing DNAP pausing through these or other methods could be a useful approach to improve the accuracy of molecular recording systems.</p>
</sec>
<sec id="sec007">
<title>Influence of experimental design on algorithm performance</title>
<p>We observe that errors in tuning parameter estimation in our simulated reaching experiments are not always normally distributed; rather, in a number of neurons, there appear to be several preferred directions that alignments converge upon, including peaks at a neuron’s anti-tuned direction (<xref ref-type="fig" rid="pcbi.1005483.g003">Fig 3C</xref>). This effect persists, although less prominently, when using a non-pausing DNAP (<xref ref-type="supplementary-material" rid="pcbi.1005483.s004">S4 Fig</xref>). This is useful to consider given the underlying center-out task in our experiment, where subjects reach in a direction then immediately make a reach back to the center, i.e. the opposite direction of the initial reach. It seemed possible that pathologic alignments could arise from this repetitive temporal structure, where alignments to tuned and anti-tuned templates are effectively identical save for a time-lag. Disrupting this structure through appropriate experimental design could lead to improved accuracy.</p>
<p>We generated a dataset composed of shuffled 2-second-long patches of neural and kinetics data such that the temporal structure of the original dataset was disrupted. We find that shuffling the data can both reduce selection of anti-tuned preferred directions (<xref ref-type="fig" rid="pcbi.1005483.g004">Fig 4A and 4B</xref>), as well as decrease overall tuning estimation error (<xref ref-type="fig" rid="pcbi.1005483.g004">Fig 4C</xref>). However, it is important to note that the shuffling scheme we describe here does not improve alignment for all neurons, and can even disrupt alignment of neurons that are otherwise predicted correctly (<xref ref-type="supplementary-material" rid="pcbi.1005483.s005">S5 Fig</xref>). While this argues against naïve shuffling as a universal strategy, it further demonstrates the effect of an experiment’s temporal structure on alignment accuracy. These findings suggest that experimental design cognizant of alignment-based analysis can improve robustness to pathologic alignments, and thus the feasibility of molecular recording-type experiments.</p>
<fig id="pcbi.1005483.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005483.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Effects of shuffled dataset on alignment accuracy.</title>
<p>Evaluation of synthetic shuffled dataset on alignment performance. Preferred directions were determined using the best alignment to a set of 8 estimates of neural activity. True neural preferred directions were determined using a generalized linear model trained on x- and y-direction hand velocity. <bold>A)</bold> Histograms of algorithm-determined preferred directions of 4 selected neurons using the original dataset. Histograms represent relative frequencies over 100 simulated DNA-based records. Dashed line indicates true neural preferred direction. <bold>B)</bold> Histograms of algorithm-determined preferred directions of 4 selected neurons using a dataset consisting of random 2-second patches of the original dataset. Histograms represent relative frequencies over 100 simulated DNA-based records. Dashed line indicates true neural preferred direction. <bold>C)</bold> Average absolute error in estimating the preferred directions of 4 selected neurons using either the original or shuffled dataset. Error bars represent bootstrapped 95% confidence intervals over 100 trials.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.g004" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec008" sec-type="conclusions">
<title>Discussion</title>
<p>We describe an algorithm that generates estimates of nucleotide incorporation times for a molecular recording system, along with estimates of parameters that characterize the underlying recorded system. We improve upon <italic>naïve</italic> estimates of these values by incorporating observed experimental data along with a probabilistic description of recorder properties. We apply the algorithm to simulated neuroscience experiments, demonstrating the viability of this algorithm (and the general molecular recording scheme) in a number of scenarios. Our findings suggest that single-strand molecular recording is statistically feasible in neuroscience contexts. Further, by introducing experimental information into our estimation techniques, we improve upon previously-understood limits on the technique. Single-strand recording promises to be a useful technique in neuroscience and biology in general for a number of reasons; establishing a statistical framework for the interpretation of those signals is an important step towards the realization of this technology.</p>
<p>This algorithm is computationally novel, as it incorporates dynamic programming, probabilistic inference, and biologic constraints into a single framework. We modify existing DTW approaches to signal alignment, constraining our action space to physiologically possible actions (e.g. two nucleotides cannot be incorporated at the same time), as well as incorporating beliefs about DNAP kinetics. These constraints have a convenient property in that they restrict our action space to a set that can largely be calculated independently, allowing for parallelization of a dynamic algorithm. While the algorithm maintains the same approximate time complexity of traditional DTW (worst-case of <italic>O</italic>(<italic>NT</italic>)), its inherent parallelism can lead to dramatically decreased runtime.</p>
<p>Further, while not discussed at length here, if recording start or end times are known, variance of incorporation times scale with <inline-formula id="pcbi.1005483.e002"><alternatives><graphic id="pcbi.1005483.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msqrt><mml:mi>N</mml:mi></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> assuming a Poisson-like DNAP. Path-constraint techniques could take advantage of this property, reducing effective worst-case time complexity to <inline-formula id="pcbi.1005483.e003"><alternatives><graphic id="pcbi.1005483.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>O</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and allowing further speed increases [<xref ref-type="bibr" rid="pcbi.1005483.ref010">10</xref>,<xref ref-type="bibr" rid="pcbi.1005483.ref028">28</xref>]. These speed improvements are of particular importance due to the inherently large scale of molecular recording: if we want to record from hundreds-of-thousands to millions of neurons, the computational techniques necessary to interpret these signals should scale well.</p>
<p>To this end, there are a number of different biological methods that could be used to explicitly mark the start or end of molecular recorder output, e.g. by delivered analyte pulses or by optogenetic manipulation. These methods could also be used to provide time-coding throughout an experiment, making timing inference substantially easier. Similarly, designing behavioral tasks to modulate neural activity at levels significant enough to be detected, but low enough not to alter behavior, e.g. temporally modulating the brightness of visual stimuli, could be used as an implicit time-coding technique. These experimental methods for encoding timing information into molecular records can work alongside algorithmic alignment methods to improve both timing and parameter inference.</p>
<p>This work also has implications on current work in the biological space. It is useful to understand the effects of DNAPs with different behaviors (e.g. speed, error rate) on the ability to record information, both for our application to molecular recorders, as well as for other approaches that aim to record continuous signals intracellularly. Understanding the general space where recorders work (or fail) is useful not only for determining what kinds of DNAPs we need to find or design, but also for determining which kinds of phenomena might be amenable to study using molecular recorders.</p>
<sec id="sec009">
<title>Biological feasibility and implementation</title>
<p>There are many ways in which existing DNAPs already satisfy the requirements necessary for a single-strand biological recorder, e.g. processivity, speed, calcium-sensitive error rates, and pausing kinetics [<xref ref-type="bibr" rid="pcbi.1005483.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005483.ref026">26</xref>,<xref ref-type="bibr" rid="pcbi.1005483.ref029">29</xref>]. The one property that we have not observed in DNAPs is a calcium-sensitive error rate at physiological concentrations [<xref ref-type="bibr" rid="pcbi.1005483.ref020">20</xref>]. Further, natural DNAPs tend to be either fast or error-prone, but not generally both; the highest error rates we see in high-incorporation-rate DNAPs are at the low end of what we simulate here [<xref ref-type="bibr" rid="pcbi.1005483.ref021">21</xref>,<xref ref-type="bibr" rid="pcbi.1005483.ref030">30</xref>]. In order to develop practical molecular recorders, we will both need to understand how to substantially increase DNAP error rates in processive, high-speed DNAPs, as well as develop a scheme to make DNAP error rates calcium-sensitive at physiologically relevant scales. Alternatively, schemes that do not rely on calcium-tuned error rates, but rather modulate other DNAP properties via calcium, may provide an easier way forward.</p>
</sec>
<sec id="sec010">
<title>Caveats</title>
<sec id="sec011">
<title>Need for good predictive models</title>
<p>The success of alignment approaches in this context is dependent on having estimates of neural activity that span the classes of neurons we are interested in recording. That is, we generally have to know the class of phenomenon we are looking for before we are able to look for it. For the recording of more well-characterized brain areas, e.g. V1 or M1, we have at least a general knowledge of the neural response to stimulus or behavior. In these systems, molecular recording would allow for characterization of large populations of neurons based on existing models of neural behavior. Further, ongoing refinement of these models promises to more accurately model neural activity in more areas of the brain, which in turn will increase the applicability of these model-based alignment approaches. For less-well understood tasks however, we run the risk of biasing our recordings toward currently understood neuronal behaviors. While our approach is useful in neuroscience paradigms where we are seeking to classify neurons according to known models or learn their tunings under an assumed model, it does not obviate the need for prior-free exploration of unknown behaviors. This technique will not necessarily allow us to discover unheard-of neural behaviors; rather, it allows us to sense neural activity from neurons we already somewhat understand while greatly increasing the scale at which we study them.</p>
</sec>
<sec id="sec012">
<title>Need for tailored experimental design</title>
<p>We have also shown that the success of temporal alignment for molecular recording relies heavily on experimental design. That is, many experimental paradigms may need to be reworked in order to be compatible with this type of analysis, and some may be entirely incompatible with these techniques. Our work provides some general guidelines for experimental design for experiments that utilize molecular recorders. In particular, it suggests that experiments can be manipulated to create unique signatures in their resulting records, given some set of likely neural tunings. As a quality control mechanism, stimulus delivery (or subject activity) should be designed so as not to induce oscillation or other regularities. In addition to designing experiments to avoid pathologic sequences, these experiments could be actively designed to provide unique patterns or time-codes in order to intentionally improve alignment accuracy. Through engineering input data in this way, we can increase the accuracy of this type of alignment algorithm, allowing for more accurate experiments using molecular recorders.</p>
</sec>
</sec>
<sec id="sec013">
<title>Implications of work</title>
<p>While many caveats apply to this work, and to the prospect of molecular recorders in general, the results described here are helpful on a number of fronts. On a technical side, we describe a DTW-class algorithm that applies generally to point processes with variable temporal indexing. The algorithm is designed to allow probabilistic interpretation of its output, and can be used to find <italic>maximum a posteriori</italic> alignments to a set of known templates. We provide a highly-parallelized implementation of this algorithm which leverages advances in asynchronous computing techniques. With respect to molecular recorders, we provide a framework for interpretation of recorder output in the face of uncertain recording times. We also provide guidance to the ongoing research that looks to engineer DNAPs for this kind of recording. Perhaps most importantly, we have shown that, should a DNAP with certain properties be developed, we can provide temporal indexing to its output and capture neural behaviors using a molecular recording approach. While this is purely a simulation study, our work sets constraints and goals for the development of DNAPs for massive-scale neural data recording, and outlines experimental scenarios for their successful use.</p>
</sec>
</sec>
<sec id="sec014" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec015">
<title>Algorithm methods</title>
<p>This technique is intended to align a DNA-based recording with no temporal indexing to a longer, time-indexed estimation of calcium activity, a template. It assumes the DNA sequence as a binary “error”/”no error” code, then assesses the similarity of that sequence to a discrete-time continuously-valued estimate of neural activity, the template, via alignment. We use a novel DTW-class algorithm to perform this alignment, incorporating beliefs about DNAP kinetics to limit the space of potential actions.</p>
<sec id="sec016">
<title>Generative model</title>
<p>We assume some unknown discrete calcium signal, <bold>C</bold> = <italic>c</italic><sub>1</sub>,…,<italic>c</italic><sub><italic>T</italic></sub>, where <italic>c</italic><sub><italic>t</italic></sub> ∈ [<italic>c</italic><sub><italic>min</italic></sub>, <italic>c</italic><sub><italic>max</italic></sub>] is the local calcium concentration at some time <italic>t</italic>, and <italic>T</italic> is the number of time-indexed samples included in the recording window. We also have a sequence of correctly- and incorrectly-copied nucleotides, <bold>D</bold> = <italic>d</italic><sub>1</sub>,…,<italic>d</italic><sub><italic>N</italic></sub>, <italic>d</italic><sub><italic>n</italic></sub> ∈ {0,1}, where <italic>N</italic> is the number of nucleotides, <italic>d</italic><sub><italic>n</italic></sub> = 1 denotes a mismatch (error) at position <italic>n</italic>, and <italic>d</italic><sub><italic>n</italic></sub> = 0 denotes a nucleotide with a correct Watson-Crick basepair.</p>
<p>The individual elements of <bold>D</bold> have incorporation times <bold>T</bold> = <italic>τ</italic><sub>1</sub>,…,<italic>τ</italic><sub><italic>N</italic></sub> where <italic>τ</italic><sub><italic>n</italic></sub> ∈ {1,…,<italic>T</italic>} and <italic>τ</italic><sub><italic>n</italic></sub> &lt; <italic>τ</italic><sub><italic>n</italic>+1</sub> (<xref ref-type="fig" rid="pcbi.1005483.g005">Fig 5A</xref>). We can impose a prior over recording start times <italic>P</italic>(<italic>τ</italic><sub>1</sub> = <italic>t</italic>) = <italic>π</italic><sub><italic>t</italic></sub>; we use a uniform prior over an interval <inline-formula id="pcbi.1005483.e004"><alternatives><graphic id="pcbi.1005483.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mfrac><mml:mi>T</mml:mi><mml:mn>4</mml:mn></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> here to generate data. For 1 &lt; <italic>n</italic> ≤ <italic>N</italic>, <italic>τ</italic><sub><italic>n</italic></sub> = <italic>τ</italic><sub><italic>n</italic>-1</sub> + <italic>U</italic>, where <italic>U</italic> is drawn from a distribution representative of polymerase kinetics. That is, the distribution of <italic>U</italic> is the distribution of times between nucleotide incorporations. <italic>d</italic><sub><italic>n</italic></sub> is then drawn from a distribution <inline-formula id="pcbi.1005483.e005"><alternatives><graphic id="pcbi.1005483.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>f</italic>(·) is the calcium-dependent error function of the polymerase, and <inline-formula id="pcbi.1005483.e006"><alternatives><graphic id="pcbi.1005483.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mi>c</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the calcium concentration at incorporation time <italic>τ</italic><sub><italic>n</italic></sub> (<xref ref-type="fig" rid="pcbi.1005483.g005">Fig 5B</xref>).</p>
<fig id="pcbi.1005483.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005483.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Overview of data generative model.</title>
<p><bold>A)</bold> Stochastic generation of <bold>T</bold>. The incorporation time of a nucleotide, <italic>τ</italic><sub><italic>n</italic></sub>, is defined as <italic>τ</italic><sub><italic>n</italic>-1</sub> + <italic>U</italic> where <italic>U</italic> is a random variable with a distribution that describes the kinetics of the DNAP being used. <bold>B)</bold> Stochastic generation of errors. At each incorporation time <italic>τ</italic><sub><italic>n</italic></sub>, an error is generated with probability <inline-formula id="pcbi.1005483.e007"><alternatives><graphic id="pcbi.1005483.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Errors in the nucleotide strand are represented by blue regions, correct incorporations are represented by orange regions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.g005" xlink:type="simple"/>
</fig>
<p>Of <bold>C</bold>, <bold>D</bold>, and <bold>T</bold>, we only observe <bold>D</bold>. We wish to infer <bold>C</bold> and <bold>T</bold> using the strand <bold>D</bold> and observed experimental data. To do this, we generate an approximation of <bold>C</bold>, <inline-formula id="pcbi.1005483.e008"><alternatives><graphic id="pcbi.1005483.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mo>*</mml:mo></mml:mstyle></mml:msup><mml:mo>=</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mn>1</mml:mn><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, using a model of neural activity that estimates neural calcium response from observed experimental data. We use <bold>C</bold>* as a template for the alignment of <bold>D</bold>. This alignment allows us to estimate the temporal indexing <bold>T</bold>, which can be used to estimate <bold>C</bold> along with underlying system parameters.</p>
</sec>
<sec id="sec017">
<title>Creation of similarity matrix</title>
<p>We generate a similarity matrix <bold>A</bold> between <bold>C</bold>* and <bold>D</bold> such that <inline-formula id="pcbi.1005483.e009"><alternatives><graphic id="pcbi.1005483.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>A</mml:mi></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. That is, <bold>A</bold><sub><italic>n</italic>,<italic>t</italic></sub> is the log-likelihood of <italic>d</italic><sub><italic>n</italic></sub> being written at time <italic>t</italic> given the estimated calcium concentration <inline-formula id="pcbi.1005483.e010"><alternatives><graphic id="pcbi.1005483.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and DNAP error tuning <italic>f</italic>(·). Thus, <bold>A</bold> represents local similarity between each element of <bold>D</bold> and <bold>C</bold>*.</p>
</sec>
<sec id="sec018">
<title>Matrix traversal</title>
<p>After we have generated a local similarity matrix <bold>A</bold>, we then want to find the path <bold>T</bold>*, an estimate of <bold>T</bold>. To generate this estimate, we find a <bold>T</bold>* which traverses <bold>A</bold> with maximum likelihood, visiting each <italic>n</italic> ∈ {1,…,<italic>N</italic>} only once, given <bold>A</bold> and the distribution of <bold><italic>U</italic></bold>. We utilize a dynamic programming approach to estimate the likelihoods of paths through <bold>A</bold>, utilizing the physical requirement <italic>τ</italic><sub><italic>n</italic></sub> &lt; <italic>τ</italic><sub><italic>n</italic>+1</sub> to constrain our step pattern, i.e. a nucleotide cannot be incorporated earlier in time than its predecessor on the strand, and the Markov assumption <italic>P</italic>(<italic>τ</italic><sub><italic>n</italic></sub>|<italic>τ</italic><sub><italic>n</italic>−1</sub>,…,<italic>τ</italic><sub>1</sub>) = <italic>P</italic>(<italic>τ</italic><sub><italic>n</italic></sub>|<italic>τ</italic><sub><italic>n</italic>−1</sub>). This approach, similar to other dynamic time warping algorithms, determines the most-likely path from some starting point to position <bold>A</bold><sub><italic>n</italic>,<italic>t</italic></sub> by calculating the most-likely paths to some set of penultimate positions <bold>A</bold><sub><italic>n</italic>−1,…</sub> and the accumulated likelihood of those paths, then selecting the path from <bold>A</bold><sub><italic>n</italic>−1,…</sub> to <bold>A</bold><sub><italic>n</italic>,<italic>t</italic></sub> that gives the highest accumulated likelihood [<xref ref-type="bibr" rid="pcbi.1005483.ref009">9</xref>,<xref ref-type="bibr" rid="pcbi.1005483.ref031">31</xref>].</p>
<p>We initialize with log <italic>P</italic>(<italic>τ</italic><sub>1</sub> = <italic>t</italic>) = <bold>A</bold><sub>1,<italic>t</italic></sub>. At this step, a prior representing knowledge of when reactions likely begin can be incorporated, but is not used here. We then evaluate a likelihood function of some sequence <italic>τ</italic><sub>1</sub>,…,<italic>τ</italic><sub><italic>n</italic></sub> that resembles traditional dynamic alignment cost functions such that:
<disp-formula id="pcbi.1005483.e011">
<alternatives>
<graphic id="pcbi.1005483.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e011" xlink:type="simple"/>
<mml:math display="block" id="M11">
<mml:mrow><mml:mtext>ln</mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>A</mml:mi></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>ln</mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ω</mml:mi><mml:mo>⋅</mml:mo><mml:mtext>ln</mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1.2)</label>
</disp-formula>
<disp-formula id="pcbi.1005483.e012">
<alternatives>
<graphic id="pcbi.1005483.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:msub><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:msup><mml:mi>τ</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ω</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>ln</mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ω</mml:mi><mml:mo>⋅</mml:mo><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>U</mml:mi><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>τ</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1.3)</label>
</disp-formula>
where <inline-formula id="pcbi.1005483.e013"><alternatives><graphic id="pcbi.1005483.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> is the most likely time <italic>d</italic><sub><italic>n</italic>−1</sub> was written given <italic>τ</italic><sub><italic>n</italic></sub> = <italic>t</italic>, <italic>ω</italic> is a parameter that adjusts the relative strength of local similarity, previous similarity, and polymerase kinetics on likelihood, and <italic>k</italic> defines how “far back” we choose to look for the best previous step. Effectively, for any (<italic>n</italic>, <italic>τ</italic><sub><italic>n</italic></sub>), we calculate the most likely <inline-formula id="pcbi.1005483.e014"><alternatives><graphic id="pcbi.1005483.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We evaluate <italic>P</italic>(<italic>τ</italic><sub><italic>n</italic></sub> = <italic>t</italic>) for all pairs (<italic>n</italic>, <italic>τ</italic><sub><italic>n</italic></sub>), <italic>n</italic> ∈ {1,…,<italic>N</italic>} and <italic>τ</italic><sub><italic>n</italic></sub> ∈ {1,…,<italic>T</italic>}. For each possible (<italic>n</italic>,<italic>t</italic>), we store <italic>P</italic>(<italic>τ</italic><sub><italic>n</italic></sub> = <italic>t</italic>) and <inline-formula id="pcbi.1005483.e015"><alternatives><graphic id="pcbi.1005483.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Once <italic>P</italic>(<italic>τ</italic><sub><italic>n</italic></sub> = <italic>t</italic>) has been calculated for each (<italic>n</italic>,<italic>t</italic>), we can reconstruct the most likely alignment <bold>T</bold>*. We find the most likely end point <italic>τ</italic><sub><italic>N</italic></sub> = argmax<sub><italic>t</italic>∈0,…,<italic>T</italic></sub> <italic>P</italic>(<italic>τ</italic><sub><italic>N</italic></sub> = <italic>t</italic>), i.e. we select the path <bold>T</bold>* that ends at the most likely <italic>τ</italic><sub><italic>N</italic></sub>. We then set <inline-formula id="pcbi.1005483.e016"><alternatives><graphic id="pcbi.1005483.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msubsup><mml:mi>τ</mml:mi><mml:mrow><mml:mi>N</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and so on for <italic>τ</italic><sub><italic>N</italic>−2</sub>,…,<italic>τ</italic><sub>1</sub>. This algorithm is implemented in pseudocode in <xref ref-type="fig" rid="pcbi.1005483.g006">Fig 6</xref>.</p>
<fig id="pcbi.1005483.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005483.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Pseudocode for alignment algorithm.</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.g006" xlink:type="simple"/>
</fig>
<p>It is useful to note here a structural relationship between our algorithm and a DTW step-pattern variant proposed by Itakura [<xref ref-type="bibr" rid="pcbi.1005483.ref032">32</xref>,<xref ref-type="bibr" rid="pcbi.1005483.ref033">33</xref>]. Both algorithms only use data from <bold>A</bold><sub><italic>n</italic>−1,1…<italic>T</italic></sub> to calculate <bold>A</bold><sub><italic>n</italic>,<italic>t</italic></sub>, which implies that the calculations for any two elements in a row are independent; we extend the Itakura action space and remove several other restrictions from potential paths. The Itakura step pattern is intended as a path-bounding scheme; while we do not implement bounding explicitly here, it is performed implicitly with our choice of <italic>k</italic>. Thus, the algorithm as described is an approximation of the true <italic>maximum a posteriori</italic> solution, as we do not evaluate the entire solution space. We also inherit several attractive attributes with respect to parallelism from Itakura, which we discuss later.</p>
</sec>
<sec id="sec019">
<title>Parallelization of alignment algorithm</title>
<p>We have described an algorithm with worst-case time complexity <italic>O</italic>(<italic>NTk</italic>) and <italic>k</italic> threads that can be operated on concurrently, i.e. all operations in the vector addition (1 − <italic>ω</italic>)<bold>p</bold> + <italic>ω</italic><bold>q</bold> can be performed independently. In comparison, traditional DTW is worst-case time complexity <italic>O</italic>(<italic>NT</italic>) for our purposes, and has 3 threads that can be operated on concurrently. To calculate an element <bold>S</bold><sub><italic>n</italic>,<italic>t</italic></sub> using our algorithm, we only require values from row <italic>n</italic> − 1, indicating that the computations for <bold>S</bold><sub><italic>n</italic>,<italic>t</italic></sub>, <italic>t</italic> ∊ 1,…, <italic>T</italic> are independent. It follows that that we actually have <italic>Tk</italic> threads that can be operated on concurrently, i.e. the operation (1 − <italic>ω</italic>)<bold>p</bold> + <italic>ω</italic><bold>q</bold> for each <bold>S</bold><sub><italic>n</italic>,<italic>t</italic></sub>, rather than k. To implement this, we pre-generate <bold>q</bold> and <bold>p</bold> for each <italic>t</italic> ∊ 1,…, <italic>T</italic>; the algorithm can then be carried out for each <italic>t</italic> concurrently for a given <italic>n</italic>. While algorithm complexity does not change, we improve runtime by a factor of up to <italic>T</italic> via parallelization.</p>
</sec>
<sec id="sec020">
<title>Maximum-likelihood template selection</title>
<p>In order to generate an accurate estimate <bold>C</bold>*, we need to know how a neuron is tuned to its inputs. As we do not know this <italic>a priori</italic>, we instead generate multiple candidates <inline-formula id="pcbi.1005483.e017"><alternatives><graphic id="pcbi.1005483.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>m</mml:mi><mml:mo>†</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> from some set of possible neural tunings and let <bold>C</bold>* be the estimate <inline-formula id="pcbi.1005483.e018"><alternatives><graphic id="pcbi.1005483.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>m</mml:mi><mml:mo>†</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with the most-likely alignment to the data <bold>D</bold>. There are time-indexed experimental variables <bold>X</bold> = <bold>x</bold><sub><bold>1</bold></sub>, …, <bold>x</bold><sub><bold>T</bold></sub>, and a set of tunings Θ = {<italic>g</italic><sub>1</sub>(·), …, <italic>g</italic><sub><italic>M</italic></sub>(·)}, where <inline-formula id="pcbi.1005483.e019"><alternatives><graphic id="pcbi.1005483.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>m</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mo>†</mml:mo></mml:mstyle></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Simply, Θ enumerates the possible ways we believe a neuron transforms experimental covariates (e.g. movement, delivered stimuli) into activity. We now select the tuning <italic>g</italic><sub><italic>m</italic></sub>(·) that provides the most likely alignment to our observed data <bold>D</bold>. We do this by aligning the observed <bold>D</bold> with each <inline-formula id="pcbi.1005483.e020"><alternatives><graphic id="pcbi.1005483.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>m</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mo>†</mml:mo></mml:mstyle></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, selecting <inline-formula id="pcbi.1005483.e021"><alternatives><graphic id="pcbi.1005483.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mo>*</mml:mo></mml:mstyle></mml:msup><mml:mo>=</mml:mo><mml:mtext>arg</mml:mtext><mml:msub><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mo>†</mml:mo></mml:mstyle></mml:msup><mml:mo>∈</mml:mo><mml:mo>{</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mn>…</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>g</mml:mi><mml:mi>M</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>X</mml:mi></mml:mstyle><mml:mo stretchy="false">)</mml:mo><mml:mo>}</mml:mo></mml:mrow></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>Τ</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup><mml:mo>|</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>D</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mo>†</mml:mo></mml:mstyle></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>
, the intuition being that <bold>D</bold> should most closely resemble the signal that generated it. Once we have selected a most-likely tuning from the ensemble Θ and alignment <bold>T</bold>*, we then estimate actual neural tuning directly from aligned DNA.</p>
</sec>
<sec id="sec021">
<title>Approximations</title>
<p>We significantly reduce the computational requirements of the algorithm by using downsampled approximations of <bold>D</bold> and <inline-formula id="pcbi.1005483.e022"><alternatives><graphic id="pcbi.1005483.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>m</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mo>†</mml:mo></mml:mstyle></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. To abstract our data, we first decimate <bold>C</bold><sup><bold>†</bold></sup>, effectively taking a binned average with bin size <italic>L</italic><sub><italic>C</italic></sub>. We then bin <bold>D</bold> into bins of size <italic>L</italic><sub><italic>D</italic></sub>, letting <inline-formula id="pcbi.1005483.e023"><alternatives><graphic id="pcbi.1005483.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mi>D</mml:mi><mml:mi>i</mml:mi></mml:mrow><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>i</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula> be the total number of errors in bin <italic>n</italic>′.</p>
<p>We then align the downsampled <inline-formula id="pcbi.1005483.e024"><alternatives><graphic id="pcbi.1005483.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>m</mml:mi></mml:mstyle><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mo>†</mml:mo></mml:mstyle></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <bold>D</bold> using the algorithm described above, altering the cost-function for <bold>A</bold><sub><italic>n</italic>,<italic>t</italic></sub>:
<disp-formula id="pcbi.1005483.e025">
<alternatives>
<graphic id="pcbi.1005483.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e025" xlink:type="simple"/>
<mml:math display="block" id="M25">
<mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>A</mml:mi></mml:mstyle><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mtext>log</mml:mtext><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>†</mml:mo></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>τ</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(1.4)</label>
</disp-formula>
where <inline-formula id="pcbi.1005483.e026"><alternatives><graphic id="pcbi.1005483.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>′</mml:mo></mml:mrow></mml:msub><mml:mo> </mml:mo><mml:mo>~</mml:mo><mml:mtext>Binomial</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>L</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>c</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:mrow><mml:mo>†</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Through this, we generate an approximate most-likely alignment <inline-formula id="pcbi.1005483.e027"><alternatives><graphic id="pcbi.1005483.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mtext>T</mml:mtext></mml:mstyle><mml:mi>a</mml:mi><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. <bold>T</bold><sub><bold>a</bold></sub> is a low-resolution alignment; we recover a full-nucleotide alignment <bold>T</bold>′ by interpolating between points on <inline-formula id="pcbi.1005483.e028"><alternatives><graphic id="pcbi.1005483.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mtext>T</mml:mtext></mml:mstyle><mml:mi>a</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
</sec>
<sec id="sec022">
<title>Experimental methods</title>
<sec id="sec023">
<title>DNAP parameter evaluation</title>
<p>We generated an initial stimulation trace <bold>I</bold> by concatenating 400 periods of stimulation, length 5s with intensity <italic>I</italic><sub><italic>e</italic></sub> ~ Uniform(0, 1). We then simulate neural firing rate <bold>λ</bold>, <italic>λ</italic><sub><italic>t</italic></sub> = <italic>mI</italic><sub><italic>t</italic></sub> + <italic>λ</italic><sub><italic>min</italic></sub>, with <italic>m</italic> = 0.05 spikes · ms<sup>−1</sup> · unit of stim<sup>−1</sup> and <italic>λ</italic><sub><italic>min</italic></sub> = 0 spikes · ms<sup>−1</sup>, and generated spiking activity <italic>s</italic><sub><italic>t</italic></sub> ~ Bernoulli(<italic>λ</italic><sub><italic>t</italic></sub>). We then generate a calcium trace <bold>C</bold> by convolving spikes with an exponential filter with decay <italic>τ</italic> = 200 ms. We can then calculate the effective relationship <bold>C</bold> ∝ <italic>m</italic><sub><italic>ca</italic></sub><bold>I</bold>. We also generate an accurate estimate of calcium, <bold>C</bold>*, by convolving <bold>λ</bold> with the same exponential filter.</p>
<p>DNAP kinetic parameters were chosen to reflect DNAP extension and pausing behavior used to generate the data. These parameters, other than calcium response, are generally reflective of known DNAPs [<xref ref-type="bibr" rid="pcbi.1005483.ref019">19</xref>,<xref ref-type="bibr" rid="pcbi.1005483.ref034">34</xref>]. We generate a DNA-based record <bold>D</bold> from <bold>C</bold> as above, using the “Base Parameter Evaluation DNAP” in <xref ref-type="table" rid="pcbi.1005483.t001">Table 1</xref>. We then align <bold>D</bold> to <bold>C</bold>* using the algorithm parameters for “Parameter Evaluation Experiments” in <xref ref-type="table" rid="pcbi.1005483.t002">Table 2</xref>. Timing accuracy for each alignment is evaluated as above. Slope accuracy is evaluated by first calculating the error-tuning curve over the range of <bold>C</bold>, transforming the error-tuning curve with <italic>f</italic><sup>−1</sup>(·), then calculating the slope of the resulting calcium-tuning curve, <inline-formula id="pcbi.1005483.e029"><alternatives><graphic id="pcbi.1005483.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. We report the ratio <inline-formula id="pcbi.1005483.e030"><alternatives><graphic id="pcbi.1005483.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>m</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>. 95% confidence intervals were generated by bootstrapping over alignment results for 50 DNA strands at each reported point.</p>
<table-wrap id="pcbi.1005483.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005483.t001</object-id>
<label>Table 1</label> <caption><title>DNAP simulation parameters.</title></caption>
<alternatives>
<graphic id="pcbi.1005483.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.t001" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="left"/>
<th align="center"/>
<th align="center">Center-Out DNAP</th>
<th align="center">“Optimized” Center-Out DNAP</th>
<th align="center">Base Parameter Evaluation DNAP</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" rowspan="4">Error function and parameters</td>
<td align="center"><italic>f</italic>(·)</td>
<td align="center"><inline-formula id="pcbi.1005483.e031"><alternatives><graphic id="pcbi.1005483.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula></td>
<td align="center"><inline-formula id="pcbi.1005483.e032"><alternatives><graphic id="pcbi.1005483.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula></td>
<td align="center"><inline-formula id="pcbi.1005483.e033"><alternatives><graphic id="pcbi.1005483.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>C</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>C</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula></td>
</tr>
<tr>
<td align="center"><italic>R</italic><sub><italic>max</italic></sub></td>
<td align="center">0.5</td>
<td align="center">0.5</td>
<td align="center">0.5</td>
</tr>
<tr>
<td align="center">b</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center"><italic>C</italic><sub>0</sub></td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr>
<td align="center" rowspan="7">Kinetic distribution and parameters</td>
<td align="center">U (Distribution)</td>
<td align="center">pause· Exp(<italic>λ</italic><sub><italic>p</italic></sub>) + (1 − pause) Gamma(<italic>α</italic>, <italic>β</italic>)</td>
<td align="center">Gamma(<italic>α</italic>, <italic>β</italic>)</td>
<td align="center">pause· Exp(<italic>λ</italic><sub><italic>p</italic></sub>) + (1 − pause) Gamma(<italic>α</italic>, <italic>β</italic>)</td>
</tr>
<tr>
<td align="center">Pause (Distribution)</td>
<td align="center">Binomial(<italic>p</italic><sub><italic>pause</italic></sub>)</td>
<td align="center">N/A</td>
<td align="center">Binomial(<italic>p</italic><sub><italic>pause</italic></sub>)</td>
</tr>
<tr>
<td align="center"><italic>λ</italic><sub><italic>p</italic></sub></td>
<td align="center">2s</td>
<td align="center">N/A</td>
<td align="center">2s</td>
</tr>
<tr>
<td align="center">α</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">β</td>
<td align="center">10ms</td>
<td align="center">10ms</td>
<td align="center">10ms</td>
</tr>
<tr>
<td align="center"><italic>p</italic><sub><italic>pause</italic></sub></td>
<td align="center">0.001</td>
<td align="center">N/A</td>
<td align="center">0.01</td>
</tr>
<tr>
<td align="center"># of basepairs</td>
<td align="center">12,000</td>
<td align="center">12,000</td>
<td align="center">10,000</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="pcbi.1005483.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005483.t002</object-id>
<label>Table 2</label> <caption><title>Default alignment parameters.</title></caption>
<alternatives>
<graphic id="pcbi.1005483.t002g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.t002" xlink:type="simple"/>
<table>
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center"/>
<th align="center"><italic>k</italic> (ms)</th>
<th align="center"><italic>ω</italic></th>
<th align="center">Ca<sup>2+</sup> downsample rate (ms/sample)</th>
<th align="center">DNA downsample rate (nt/sample)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Parameter Evaluation Experiments</td>
<td align="center">2000</td>
<td align="center"><inline-formula id="pcbi.1005483.e034"><alternatives><graphic id="pcbi.1005483.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>100</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula></td>
<td align="center">50</td>
<td align="center">100</td>
</tr>
<tr>
<td align="center">Center-Out Experiments</td>
<td align="center">2000</td>
<td align="center"><inline-formula id="pcbi.1005483.e035"><alternatives><graphic id="pcbi.1005483.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>240</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula></td>
<td align="center">50</td>
<td align="center">25</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec024">
<title>Center-Out reaching experiments</title>
<p>We obtained kinetic and neural activity records from Flint 2012 via the DREAM database, using data from Subject 1 [<xref ref-type="bibr" rid="pcbi.1005483.ref025">25</xref>]. We preprocess the data by concatenating all 194 trials, discarding data where hand velocity either exceeded 0.4 m/s or fell below 0.05 m/s, and truncating traces to 260 seconds. We generated a calcium trace <bold>C</bold> by convolving spikes with an exponential filter with decay <italic>τ</italic> = 200 ms. To generate DNA-based signals, we first determine incorporation times <bold>T</bold> by drawing nucleotide incorporation times from distribution <italic>U</italic> as described in <xref ref-type="table" rid="pcbi.1005483.t001">Table 1</xref>, using either the “Center-Out” or “Optimized Center-Out” parameters. We then determine whether each nucleotide was a correct or incorrect incorporation as <inline-formula id="pcbi.1005483.e036"><alternatives><graphic id="pcbi.1005483.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo> </mml:mo><mml:mo>~</mml:mo><mml:mtext mathvariant="normal">Bernoulli</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:msub><mml:mi>τ</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, using the <italic>f</italic>(·) described in <xref ref-type="table" rid="pcbi.1005483.t001">Table 1</xref>.</p>
<p>We select 8 candidate preferred directions, evenly spaced on [0, 2<italic>π</italic>], as the parametrization Θ for our estimates of neural activity. We calculate expected firing rates <inline-formula id="pcbi.1005483.e037"><alternatives><graphic id="pcbi.1005483.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:mrow><mml:msubsup><mml:mo mathvariant="bold">λ</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for each of these candidate preferred directions, using recorded hand velocities and a cosine-tuning model, setting minimum and maximum firing rates to values representative of the recorded population; we set <italic>λ</italic><sub><italic>min</italic></sub> = 10 spikes · s<sup>−1</sup> and <italic>λ</italic><sub><italic>max</italic></sub> = 150 spikes · s<sup>−1</sup>, which generally represents the observed neural population. We convolve <inline-formula id="pcbi.1005483.e038"><alternatives><graphic id="pcbi.1005483.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msubsup><mml:mo mathvariant="bold">λ</mml:mo><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> with an exponential kernel described above to generate estimated calcium <inline-formula id="pcbi.1005483.e039"><alternatives><graphic id="pcbi.1005483.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>m</mml:mi><mml:mo>†</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>The generated DNA strand <bold>D</bold> is aligned to each estimated calcium trace <inline-formula id="pcbi.1005483.e040"><alternatives><graphic id="pcbi.1005483.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:msubsup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>C</mml:mi></mml:mstyle><mml:mi>m</mml:mi><mml:mo>†</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, using algorithm parameters (ω, k, and downsample rates) as described in <xref ref-type="table" rid="pcbi.1005483.t002">Table 2</xref>. The most likely alignment from these is selected for analysis. We calculate RMSD for a given alignment as <inline-formula id="pcbi.1005483.e041"><alternatives><graphic id="pcbi.1005483.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005483.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Τ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Τ</mml:mi><mml:mi>n</mml:mi><mml:mo>*</mml:mo></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. We evaluate the preferred reach direction of the neuron directly from neural data using standard generalized linear modeling techniques, fitting x- and y-components of reach velocity to 1ms-binned spike counts. We use this direct preferred direction as a ground truth for evaluating algorithm performance. For the aligned DNA-based records, we evaluate the estimated preferred direction of the neuron using a generalized linear model, fitting reach instantaneous velocity to error counts at each nucleotide incorporation time.</p>
<p>For each analyzed neuron, we generate 100 DNA-based records, align each record to each estimated calcium trace, and evaluate timing and parameter estimates using the maximum-likelihood alignment for each record. Confidence intervals for error estimates are generated by bootstrap.</p>
<p>For all-neuron analysis, 100 strands were generated and aligned as above. Neurons were filtered based on average firing rate &gt; 20 spikes/s and a McFadden’s pseudo-R<sup>2</sup> &gt; 0.05, calculated for a Poisson generalized linear model fitting x- and y- hand velocities to spike rate.</p>
</sec>
<sec id="sec025">
<title>Timing data</title>
<p>For each trial, a strand of given length is aligned to a 2,000s calcium trace without downsampling. The total time elapsed for each alignment was recorded. 10 trials were performed for each data point, averages are presented. Algorithms were implemented in MATLAB (MathWorks Inc.), and evaluated on an Intel i7-3520M 2.9GHz CPU and an NVidia NVS 5200M discrete graphics card.</p>
</sec>
</sec>
</sec>
<sec id="sec026">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005483.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Relative algorithm performance.</title>
<p><bold>A)</bold> Schematic of considered algorithms. Dark purple elements indicate the current element being calculated, light purple elements are elements still to be computed. Grey elements represent previously computed results needed to evaluate the current element. Traditional DTW consists of element-wise computation of an accumulated cost function, iterated over both dimensions of the cost matrix. The looped version of our algorithm implements element-wise computation of our modified accumulated cost function, also iterated over both dimensions of the cost matrix. Our vectorized algorithm calculates the accumulated cost functions of all elements along a given dimension, and iterates over the other dimension. <bold>B)</bold> Computational speed of the GPU-implemented algorithm relative to other implementations. We compare to a looped implementation of our algorithm, an implementation of traditional DTW, and our optimized algorithm using on a single CPU core. We evaluate computation time during the alignment of a single DNA input of a given length to a constant-length (2,000 second) template; values plotted represent average over ten trials. Dashed line indicates GPU-implemented performance.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005483.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Using optimal templates for alignment.</title>
<p>Timing and neural parameter estimation when using either the best alignment from a set of 8 templates generated from potential neural preferred directions on [0,2π] (blue), or from a template generated using the true neural preferred direction (orange). Results are shown for each of the three individual neurons analyzed in the main text. Histograms represent distribution over 100 trials. <bold>A)</bold> Distribution of timing errors for DNA-based records when aligned to the indicated template. B) Distribution of estimated neural preferred directions when aligned to the indicated template. Dashed lines indicate the true neural preferred direction, estimated from neural data.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005483.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Alignment accuracy over a neural population.</title>
<p>Cumulative fractions of the neural population that have alignment statistics at or below a given cutoff. Traces are provided for both the entire dataset (blue) and a subset of neurons with average firing rate greater than 20 spikes/s and a model McFadden’s pseudo-R<sup>2</sup> &gt; 0.05 (purple). <bold>A)</bold> Proportion of population with average trial RMSD less than indicated value. <bold>B)</bold> Proportion of population with median trial RMSD less than indicated value. <bold>C)</bold> Proportion of population with absolute error in estimated preferred direction |<italic>θ</italic> − <italic>θ</italic>*| less than indicated value.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005483.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Plausible vs. optimal DNAPs in alignment.</title>
<p>Timing and neural parameter estimation when using “natural” (blue) or “optimized” (orange) pausing DNAPs (see <xref ref-type="sec" rid="sec014">Methods</xref>). Results are shown for each of the three individual neurons analyzed in the main text. DNA-based records were generated using the indicated DNAP and aligned to a set of 8 templates generated from potential neural preferred directions on [0,2π]; most-likely alignments were used to generate timing and tuning error. Histograms represent distribution of values over 100 trials. <bold>A)</bold> Distribution of timing errors for DNA-based records generated using the indicated DNAP. <bold>B)</bold> Distribution of estimated neural preferred direction for DNA-based records generated using the indicated DNAP. Dashed lines indicate the true neural preferred direction, estimated directly from neural data.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005483.s005" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005483.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Shuffled datasets offer heterogeneous effects for alignment accuracy.</title>
<p>Evaluation of synthetic shuffled dataset on alignment performance for a set of neurons that do not exhibit improvement using a shuffled dataset. Preferred directions were determined using the best alignment to a set of 8 estimates of neural activity. True neural preferred directions were determined using a generalized linear model trained on x- and y-direction hand velocity. <bold>A)</bold> Histograms of algorithm-determined preferred directions of 5 selected neurons using the original dataset. Histograms represent relative frequencies over 100 simulated DNA-based records. Dashed line indicates true neural preferred direction. <bold>B)</bold> Histograms of algorithm-determined preferred directions of 5 selected neurons using a dataset consisting of random 2-second patches of the original dataset. Histograms represent relative frequencies over 100 simulated DNA-based records. Dashed line indicates true neural preferred direction. <bold>C)</bold> Absolute error in estimating the preferred directions of 5 selected neurons using either the original or shuffled dataset. Error bars represent bootstrapped 95% confidence intervals.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to acknowledge Joshua Glaser, Patrick Lawlor, Adam Marblestone, and Mukta Vaidya for helpful comments and discussion.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005483.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alivisatos</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Chun</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Church</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Greenspan</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Roukes</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>. <article-title>The brain activity map project and the challenge of functional connectomics</article-title>. <source>Neuron. Elsevier Inc.</source>; <year>2012</year>;<volume>74</volume>: <fpage>970</fpage>–<lpage>4</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005483.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ahrens</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Orger</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Robson</surname> <given-names>DN</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>PJ</given-names></name>. <article-title>Whole-brain functional imaging at cellular resolution using light-sheet microscopy</article-title>. <source>Nat Methods</source>. <year>2013</year>;<volume>10</volume>: <fpage>413</fpage>–<lpage>20</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2434" xlink:type="simple">10.1038/nmeth.2434</ext-link></comment> <object-id pub-id-type="pmid">23524393</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref003"><label>3</label><mixed-citation publication-type="other" xlink:type="simple">Dean T, Ahanonu B, Chowdhury M, Datta A. On the Technology Prospects and Investment Opportunities for Scalable Neuroscience. stanford.edu. 2013; <ext-link ext-link-type="uri" xlink:href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.353.3648&amp;rep=rep1&amp;type=pdf" xlink:type="simple">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.353.3648&amp;rep=rep1&amp;type=pdf</ext-link></mixed-citation></ref>
<ref id="pcbi.1005483.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marblestone</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Zamft</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Maguire</surname> <given-names>YG</given-names></name>, <name name-style="western"><surname>Shapiro</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Cybulski</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Glaser</surname> <given-names>JI</given-names></name>, <etal>et al</etal>. <article-title>Physical principles for scalable neural recording</article-title>. <source>Front Comput Neurosci</source>. <year>2013</year>;<volume>7</volume>: <fpage>137</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2013.00137" xlink:type="simple">10.3389/fncom.2013.00137</ext-link></comment> <object-id pub-id-type="pmid">24187539</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cybulski</surname> <given-names>TR</given-names></name>, <name name-style="western"><surname>Glaser</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Marblestone</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Zamft</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Boyden</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Church</surname> <given-names>GM</given-names></name>, <etal>et al</etal>. <article-title>Spatial information in large-scale neural recordings</article-title>. <source>Front Comput Neurosci</source>. <year>2015</year>;<volume>8</volume>: <fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005483.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kording</surname> <given-names>KP</given-names></name>. <article-title>Of toasters and molecular ticker tapes</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>: <fpage>e1002291</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002291" xlink:type="simple">10.1371/journal.pcbi.1002291</ext-link></comment> <object-id pub-id-type="pmid">22219716</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Glaser</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Zamft</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Marblestone</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Moffitt</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Tyo</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Boyden</surname> <given-names>ES</given-names></name>, <etal>et al</etal>. <article-title>Statistical analysis of molecular signal recording</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>: <fpage>e1003145</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003145" xlink:type="simple">10.1371/journal.pcbi.1003145</ext-link></comment> <object-id pub-id-type="pmid">23874187</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Magierowski</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Messier</surname> <given-names>GG</given-names></name>. <article-title>Internal Readout System for Molecular Recorders</article-title>. <source>IEEE Trans Mol Biol Multi-Scale Commun</source>. <year>2015</year>;<volume>1</volume>: <fpage>26</fpage>–<lpage>36</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005483.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Juang</surname> <given-names>B-H</given-names></name>. <article-title>On the Hidden Markov Model and Dynamic Time Warping for Speech Recognition-A Unified View</article-title>. <source>AT&amp;T Bell Lab Tech J</source>. <year>1984</year>;<volume>63</volume>: <fpage>1213</fpage>–<lpage>1243</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005483.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sakoe</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Chiba</surname> <given-names>S</given-names></name>. <article-title>Dynamic programming algorithm optimization for spoken word recognition</article-title>. <source>IEEE Trans Acoust</source>. <year>1978</year>;<volume>26</volume>: <fpage>43</fpage>–<lpage>49</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005483.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gasser</surname> <given-names>T</given-names></name>. <article-title>Alignment of curves by dynamic time warping</article-title>. <source>Ann Stat</source>. <year>1997</year>;<volume>25</volume>: <fpage>1251</fpage>–<lpage>1276</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/aos/1069362747" xlink:type="simple">10.1214/aos/1069362747</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1005483.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nakagawa</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nakanishi</surname> <given-names>H</given-names></name>. <article-title>Speaker-independent English consonant and Japanese word recognition by a stochastic dynamic time warping method</article-title>. <source>J Inst Electron Telecommun Eng</source>. <year>1988</year>;<volume>34</volume>: <fpage>87</fpage>–<lpage>95</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://www.slp.ics.tut.ac.jp/shiryou/number-2/E1988-16.pdf" xlink:type="simple">http://www.slp.ics.tut.ac.jp/shiryou/number-2/E1988-16.pdf</ext-link></mixed-citation></ref>
<ref id="pcbi.1005483.ref013"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Sart D, Mueen A, Najjar W, Keogh E, Niennattrakul V. Accelerating dynamic time warping subsequence search with GPUs and FPGAs. Proc—IEEE Int Conf Data Mining, ICDM. 2010; 1001–1006.</mixed-citation></ref>
<ref id="pcbi.1005483.ref014"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Bemdt DJ. Using Dynamic Time Warping to Find Patterns in Time Series. 1994; 359–370.</mixed-citation></ref>
<ref id="pcbi.1005483.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Victor</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Goldberg</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Gardner</surname> <given-names>D</given-names></name>. <article-title>Dynamic programming algorithms for comparing multineuronal spike trains via cost-based metrics and alignments</article-title>. <source>J Neurosci Methods</source>. <year>2007</year>;<volume>161</volume>: <fpage>351</fpage>–<lpage>360</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2006.11.001" xlink:type="simple">10.1016/j.jneumeth.2006.11.001</ext-link></comment> <object-id pub-id-type="pmid">17174403</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Pichler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Buchanan</surname> <given-names>K a</given-names></name>, <name name-style="western"><surname>Sjöström</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Mrsic-Flogel</surname> <given-names>TD</given-names></name>. <article-title>Functional specificity of local synaptic connections in neocortical networks</article-title>. <source>Nature</source>. <year>2011</year>;<volume>473</volume>: <fpage>87</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09880" xlink:type="simple">10.1038/nature09880</ext-link></comment> <object-id pub-id-type="pmid">21478872</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref017"><label>17</label><mixed-citation publication-type="other" xlink:type="simple">Tan GTG, Feng SFS, Sun NSN. Locality and Parallelism Optimization for Dynamic Programming Algorithm in Bioinformatics. ACMIEEE SC 2006 Conf SC06. 2006; 78.</mixed-citation></ref>
<ref id="pcbi.1005483.ref018"><label>18</label><mixed-citation publication-type="other" xlink:type="simple">Xiao L, Zheng Y, Tang W, Yao G, Ruan L. Parallelizing Dynamic Time Warping Algorithm Using Prefix Computations on GPU. 2013 IEEE 10th Int Conf High Perform Comput Commun 2013 IEEE Int Conf Embed Ubiquitous Comput. 2013; 294–299.</mixed-citation></ref>
<ref id="pcbi.1005483.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwartz</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Quake</surname> <given-names>SR</given-names></name>. <article-title>Single molecule measurement of the “speed limit” of DNA polymerase</article-title>. <source>Proc Natl Acad Sci</source>. <year>2009</year>;<volume>107</volume>: <fpage>1254</fpage>–<lpage>1254</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005483.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zamft</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Marblestone</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Kording</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Schmidt</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Martin-Alarcon</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tyo</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Measuring cation dependent DNA polymerase fidelity landscapes by deep sequencing</article-title>. <source>PLoS One</source>. <year>2012</year>;<volume>7</volume>: <fpage>e43876</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0043876" xlink:type="simple">10.1371/journal.pone.0043876</ext-link></comment> <object-id pub-id-type="pmid">22928047</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beard</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Shock</surname> <given-names>DD</given-names></name>, <name name-style="western"><surname>Vande Berg</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Wilson</surname> <given-names>SH</given-names></name>. <article-title>Efficiency of correct nucleotide insertion governs DNA polymerase fidelity</article-title>. <source>J Biol Chem</source>. <year>2002</year>;<volume>277</volume>: <fpage>47393</fpage>–<lpage>47398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1074/jbc.M210036200" xlink:type="simple">10.1074/jbc.M210036200</ext-link></comment> <object-id pub-id-type="pmid">12370169</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Glaser</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Zamft</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Church</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Kording</surname> <given-names>KP</given-names></name>. <article-title>Puzzle imaging: Using large-scale dimensionality reduction algorithms for localization</article-title>. <source>PLoS One</source>. <year>2015</year>;<volume>10</volume>: <fpage>1</fpage>–<lpage>23</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005483.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Flint</surname> <given-names>RD</given-names></name>, <name name-style="western"><surname>Lindberg</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Jordan</surname> <given-names>LR</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>LE</given-names></name>, <name name-style="western"><surname>Slutzky</surname> <given-names>MW</given-names></name>. <article-title>Accurate decoding of reaching movements from field potentials in the absence of spikes</article-title>. <source>J Neural Eng</source>. <year>2012</year>;<volume>9</volume>: <fpage>46006</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005483.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stevenson</surname> <given-names>IH</given-names></name>, <name name-style="western"><surname>Cherian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>London</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Sachs</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Lindberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Reimer</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Statistical assessment of the stability of neural movement representations</article-title>. <source>J Neurophysiol</source>. <year>2011</year>;<volume>106</volume>: <fpage>764</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00626.2010" xlink:type="simple">10.1152/jn.00626.2010</ext-link></comment> <object-id pub-id-type="pmid">21613593</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walker</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Kording</surname> <given-names>K</given-names></name>. <article-title>The Database for Reaching Experiments and Models</article-title>. <name name-style="western"><surname>Lytton</surname> <given-names>WW</given-names></name>, editor. <source>PLoS One</source>. <year>2013</year>;<volume>8</volume>: <fpage>e78747</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0078747" xlink:type="simple">10.1371/journal.pone.0078747</ext-link></comment> <object-id pub-id-type="pmid">24244351</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mytelka</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Chamberlin</surname> <given-names>MJ</given-names></name>. <article-title>Analysis and suppression of DNA polymerase pauses associated with a trinucleotide consensus</article-title>. <source>Nucleic Acids Res</source>. <year>1996</year>;<volume>24</volume>: <fpage>2774</fpage>–<lpage>2781</lpage>. <object-id pub-id-type="pmid">8759010</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>LaDuca</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Fay</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Chuang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>McHenry</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Bambara</surname> <given-names>RA</given-names></name>. <article-title>Site-specific pausing of deoxyribonucleic acid synthesis catalyzed by four forms of Escherichia coli DNA polymerase III</article-title>. <source>Biochemistry</source>. <year>1983</year>;<volume>22</volume>: <fpage>5177</fpage>–<lpage>88</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/6360204" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/6360204</ext-link> <object-id pub-id-type="pmid">6360204</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Myers</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rabiner</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Rosenberg</surname> <given-names>AE</given-names></name>. <article-title>Performance tradeoffs in dynamic time warping algorithms for isolated word recognition</article-title>. <source>IEEE Trans Acoust</source>. <year>1980</year>;<volume>ASSP-28</volume>: <fpage>623</fpage>–<lpage>635</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1163491" xlink:type="simple">http://ieeexplore.ieee.org/xpls/abs_all.jsp?arnumber=1163491</ext-link></mixed-citation></ref>
<ref id="pcbi.1005483.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tanner</surname> <given-names>NA</given-names></name>, <name name-style="western"><surname>Loparo</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Hamdan</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Jergic</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dixon</surname> <given-names>NE</given-names></name>, <name name-style="western"><surname>van Oijen</surname> <given-names>AM</given-names></name>. <article-title>Real-time single-molecule observation of rolling-circle DNA replication</article-title>. <source>Nucleic Acids Res</source>. <year>2009</year>;<volume>37</volume>: <fpage>e27</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkp006" xlink:type="simple">10.1093/nar/gkp006</ext-link></comment> <object-id pub-id-type="pmid">19155275</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kunkel</surname> <given-names>TA</given-names></name>. <article-title>DNA Replication Fidelity</article-title>. <source>J Biol Chem</source>. <year>2004</year>;<volume>279</volume>: <fpage>16895</fpage>–<lpage>16898</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1074/jbc.R400006200" xlink:type="simple">10.1074/jbc.R400006200</ext-link></comment> <object-id pub-id-type="pmid">14988392</object-id></mixed-citation></ref>
<ref id="pcbi.1005483.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Perkins</surname> <given-names>T</given-names></name>. <article-title>Maximum likelihood trajectories for continuous-time Markov chains</article-title>. <source>Adv Neural Inf Process Syst</source>. <year>2009</year>;<volume>22</volume>: <fpage>6</fpage>–<lpage>14</lpage>. Available: <ext-link ext-link-type="uri" xlink:href="http://books.nips.cc/papers/files/nips22/NIPS2009_0822.pdf" xlink:type="simple">http://books.nips.cc/papers/files/nips22/NIPS2009_0822.pdf</ext-link></mixed-citation></ref>
<ref id="pcbi.1005483.ref032"><label>32</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Rabiner</surname> <given-names>LL</given-names></name>, <name name-style="western"><surname>Juang</surname> <given-names>B-HB</given-names></name>. <source>Fundamentals of Speech Recognition [Internet]</source>. <publisher-name>Prentice Hall</publisher-name>. <year>1993</year>. p. <fpage>507</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005483.ref033"><label>33</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Itakura</surname> <given-names>F</given-names></name>. <source>Minimum prediction residual principle applied to speech recognition</source>. <publisher-name>IEEE Trans Acoust</publisher-name>. <year>1975</year>;</mixed-citation></ref>
<ref id="pcbi.1005483.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Viljoen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Griep</surname> <given-names>M a</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Viljoen</surname> <given-names>H</given-names></name>. <article-title>A macroscopic kinetic model for DNA polymerase elongation and high-fidelity nucleotide selection</article-title>. <source>Comput Biol Chem</source>. <year>2005</year>;<volume>29</volume>: <fpage>101</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.compbiolchem.2005.02.003" xlink:type="simple">10.1016/j.compbiolchem.2005.02.003</ext-link></comment> <object-id pub-id-type="pmid">15833438</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>