<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01866</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004275</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Automated High-Throughput Characterization of Single Neurons by Means of Simplified Spiking Models</article-title>
<alt-title alt-title-type="running-head">High-Throughput Single-Neuron Characterization</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Pozzorini</surname> <given-names>Christian</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Mensi</surname> <given-names>Skander</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Hagens</surname> <given-names>Olivier</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Naud</surname> <given-names>Richard</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Koch</surname> <given-names>Christof</given-names></name>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Gerstner</surname> <given-names>Wulfram</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="econtrib001"><sup>‡</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Laboratory of Computational Neuroscience (LCN), Brain Mind Institute, School of Computer and Communication Sciences and School of Life Sciences, École Polytechnique Fédérale de Lausanne, Lausanne, Switzerland</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Laboratory of Neural Microcircuitry (LNMC), Brain Mind Institute, School of Life Sciences, École Polytechnique Fédérale de Lausanne, Lausanne, Switzerland</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Physics, University of Ottawa, Ottawa, Canada</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Allen Institute for Brain Science, Seattle, Washington, USA</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Pillow</surname> <given-names>Jonathan W.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>The University of Texas at Austin, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: CP SM CK WG. Performed the experiments: OH. Analyzed the data: SM CP. Wrote the paper: CP CK WG SM OH RN. Wrote the initial draft and the Python toolbox: CP.</p>
</fn>
<fn fn-type="other" id="econtrib001">
<p>‡ These authors also contributed equally to this work.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">christian.pozzorini@epfl.ch</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>6</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>17</day>
<month>6</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>6</issue>
<elocation-id>e1004275</elocation-id>
<history>
<date date-type="received">
<day>11</day>
<month>10</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>4</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Pozzorini et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004275" xlink:type="simple"/>
<abstract>
<p>Single-neuron models are useful not only for studying the emergent properties of neural circuits in large-scale simulations, but also for extracting and summarizing in a principled way the information contained in electrophysiological recordings. Here we demonstrate that, using a convex optimization procedure we previously introduced, a Generalized Integrate-and-Fire model can be accurately fitted with a limited amount of data. The model is capable of predicting both the spiking activity and the subthreshold dynamics of different cell types, and can be used for online characterization of neuronal properties. A protocol is proposed that, combined with emergent technologies for automatic patch-clamp recordings, permits automated, <italic>in vitro</italic> high-throughput characterization of single neurons.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Large-scale, high-throughput data acquisition is revolutionizing the field of neuroscience. Single-neuron electrophysiology is moving from the situation where a highly skilled experimentalist can patch a few cells per day, to a situation where robots will collect large amounts of data. To take advantage of this quantity of data, this technological advance requires a paradigm shift in the experimental design and analysis. Presently, most single-neuron experimental studies rely on old protocols—such as injections of steps and ramps of current—that rarely inform theoreticians and modelers interested in emergent properties of the brain. Here, we describe an efficient protocol for high-throughput <italic>in vitro</italic> electrophysiology as well as a set of mathematical tools that neuroscientists can use to directly translate experimental data into realistic spiking neuron models. The efficiency of the proposed method makes it suitable for high-throughput data analysis, allowing for the generation of a standardized database of realistic single-neuron models.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by: Swiss National Science Foundation (SNSF, grant numbers 200020_132871/1 and 200020_147200; <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.snf.ch/fr/Pages/default.aspx">http://www.snf.ch/fr/Pages/default.aspx</ext-link>) to CP and SM. European Community’s Seventh Framework Program (BrainScaleS, grant no. 269921; <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://cordis.europa.eu/fp7/home_en.html">http://cordis.europa.eu/fp7/home_en.html</ext-link>) to SM; European Union Seventh Framework Programme (FP7/2007–2013) under grant agreement no. 604102 (Human Brain Project; <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://www.humanbrainproject.eu/">https://www.humanbrainproject.eu/</ext-link>) to CP; A grant from the EPFL to the LNMC (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://markram-lab.epfl.ch/">http://markram-lab.epfl.ch/</ext-link>) to OH; and Fonds de recherche du Québec - Nature et technologies (FQRNT, <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://www.frqnt.gouv.qc.ca/">http://www.frqnt.gouv.qc.ca/</ext-link>) to RN. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="1"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>The main methods and data included in this paper are available at wiki.epfl.ch/giftoolbox</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p><italic>In vitro</italic> patch-clamping is the gold standard used to investigate the intrinsic electrophysiological properties of neurons, but remains labour intensive and requires a trained experimentalist with high technical skills. In the last years, several platforms have been developed that automatize electrophysiological recordings for ion-channel screening and drug discovery [<xref ref-type="bibr" rid="pcbi.1004275.ref001">1</xref>]. Most of the existing platforms are, however, designed to record from mammalian cell lines or oocytes in which ion-channels of interest are artificially expressed [<xref ref-type="bibr" rid="pcbi.1004275.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref003">3</xref>]. In the near future, this technology is likely to be transferred to more complex setups, such as <italic>in vitro</italic> brain slices. High-throughput electrophysiology can be pushed forward with <italic>in vivo</italic> whole-cell patch-clamp recordings that are, at least partially, automatized [<xref ref-type="bibr" rid="pcbi.1004275.ref004">4</xref>]. With this technique, three to seven minutes are sufficient for a trained technician or a robot to automatically identify a cell and form a gigaohm seal of the same quality as achieved by an electrophysiologist [<xref ref-type="bibr" rid="pcbi.1004275.ref004">4</xref>]. This technological advance represents an important step towards high-throughput electrophysiology <italic>in vivo</italic> or on <italic>in vitro</italic> brain slices.</p>
<p>To make sense of the large amount of data that automated patch-clamp can produce, adequate computational tools and experimental protocols have to be developed. Traditional protocols for single-neuron characterization rely on current-clamp injections of stimuli (e.g., square current pulses, ramps of current) that are specifically designed to extract a small number of parameters (e.g., membrane time constant, firing threshold). While this is a valid approach, the input currents adopted in these experiments are artificial and strongly differ from the signals that single neurons process <italic>in vivo</italic>. Moreover, the choice of the parameters used for single-neuron characterization is arbitrary and different parameters are generally estimated in separate sets of experiments. In this study, an alternative method is proposed in which the electrophysiological properties of neurons are characterized by means of simplified neuron models.</p>
<p>Ideally, a single-neuron model should be sufficiently complex and flexible to capture, by a single change of parameters, the spiking activity of different neurons, but also simple-enough to allow robust parameter estimation [<xref ref-type="bibr" rid="pcbi.1004275.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref006">6</xref>]. Detailed biophysical models with stochastic ion channel dynamics can in principle account for every aspect of single-neuron activity; however, due to their complexity, they require high computational power [<xref ref-type="bibr" rid="pcbi.1004275.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref007">7</xref>–<xref ref-type="bibr" rid="pcbi.1004275.ref009">9</xref>]. While systematic fitting of detailed biophysical models is possible [<xref ref-type="bibr" rid="pcbi.1004275.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1004275.ref015">15</xref>], most of the existing methods assume the knowledge of all the parameters that determine the dynamics of the ion channels included in the model. Overall, a reliable and efficient fitting procedure for detailed biophysical models is not known [<xref ref-type="bibr" rid="pcbi.1004275.ref006">6</xref>]. In a second class of spiking neuron models, which we call simplified threshold models, the biophysical mechanisms relevant for neural computation are not explicitly modeled, but are accounted for by phenomenological (i.e., effective) descriptions [<xref ref-type="bibr" rid="pcbi.1004275.ref016">16</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref017">17</xref>]. Despite their simplicity, threshold models are surprisingly good at predicting single-neuron activity [<xref ref-type="bibr" rid="pcbi.1004275.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004275.ref025">25</xref>], at least for the case of single-electrode somatic stimulation (but see [<xref ref-type="bibr" rid="pcbi.1004275.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref027">27</xref>]). Nowadays, simplified threshold models are mainly used in large-scale simulations to study the emergent properties of neural circuits [<xref ref-type="bibr" rid="pcbi.1004275.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref029">29</xref>]. By taking a different perspective, we will demonstrate that the same models can also serve an equally important purpose, namely to characterize the electrical properties of single neurons. In this view, simplified threshold models are interpreted as computational tools to automatically compress the information contained in a voltage recording into a set of unique and meaningful parameters. Summarizing the information of complex voltage recordings can in turn enable systematic comparisons, clustering and identification of cell types. Finally, in patch-clamp experiments aimed at studying detailed aspects of the neuronal dynamics, automated online identification of neurons could allow for <italic>on the fly</italic> implementation of specific stimulus sets, which are best suited for the neuron under study.</p>
<p>After demonstrating that a limited amount of data, and little computing time, are sufficient to fit and validate our previous Generalized Integrate-and-Fire model (GIF, see [<xref ref-type="bibr" rid="pcbi.1004275.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>]), we introduce an experimental protocol that, combined with automated patch-clamp technology, could make automated high-throughput single-neuron characterization possible. On the experimental side, the protocol relies on <italic>in vitro</italic> somatic injections of rapidly fluctuating currents that mimic natural inputs received <italic>in vivo</italic> at the soma of neurons. On the computational side, the protocol is based on Active Electrode Compensation [<xref ref-type="bibr" rid="pcbi.1004275.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref033">33</xref>], GIF model parameter extraction [<xref ref-type="bibr" rid="pcbi.1004275.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>] and the spike-train similarity measure <inline-formula id="pcbi.1004275.e001"><mml:math id="M1" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mtext mathvariant="normal">d</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> [<xref ref-type="bibr" rid="pcbi.1004275.ref034">34</xref>]. These computational methods are combined and implemented in a Python toolbox (freely available at wiki.epfl.ch/giftoolbox). The validity of our approach is finally demonstrated with two applications: i) <italic>in silico</italic> recordings obtained by simulating the activity of a multi-compartmental conductance-based model; and ii) <italic>in vitro</italic> recordings from L5 pyramidal neurons obtained using manual patch clamping. We found that fitting and validating a GIF model takes approximatively five minutes. Considering the time required to automatically establish a patch-clamp seal, the complete characterization of a single neuron can therefore be achieved in around ten minutes. We conclude that GIF models are useful not only for network simulations, but also for rapid and systematic single-neuron characterization.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>The Results section is organized as follows. In the first two sections, we respectively define the GIF model and the procedures used for parameter extraction and model validation. Using artificial data generated by the GIF model itself, we then determine the amount of data and the computing time required to perform accurate parameter extraction and model validation. Based on these results, an experimental protocol is established that enables automated high-throughput characterization of single neurons. In the last sections, the validity of this protocol is verified using <italic>in silico</italic> recordings obtained by simulating the activity of a multi-compartmental conductance-based model [<xref ref-type="bibr" rid="pcbi.1004275.ref014">14</xref>] as well as <italic>in vitro</italic> recordings from layer 5 (L5) pyramidal neurons obtained using standard patch clamping. The GIF model performance is finally compared against that of a standard Generalized Linear Model (GLM) [<xref ref-type="bibr" rid="pcbi.1004275.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref036">36</xref>].</p>
<sec id="sec003">
<title>Generalized Integrate-and-Fire model</title>
<p>The GIF model discussed in this study [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref037">37</xref>] is a leaky integrate-and-fire model augmented with a spike-triggered current <italic>η</italic>(<italic>t</italic>), a moving threshold <italic>γ</italic>(<italic>t</italic>) and the escape rate mechanism [<xref ref-type="bibr" rid="pcbi.1004275.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref039">39</xref>] for stochastic spike emission (<xref ref-type="fig" rid="pcbi.1004275.g001">Fig 1A</xref>). This model is able to predict both the spiking activity and the subthreshold dynamics of individual neurons (<xref ref-type="fig" rid="pcbi.1004275.g001">Fig 1B</xref>), and it is flexible enough to capture the behavior of different neuronal cell types [<xref ref-type="bibr" rid="pcbi.1004275.ref037">37</xref>].</p>
<fig id="pcbi.1004275.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The GIF model accurately predicts both the subthreshold and the spiking activity of cortical neurons.</title>
<p><bold>(A)</bold> Block representation of the GIF model. The membrane acts as a low-pass filter <italic>κ</italic>(<italic>t</italic>) on the input current <italic>I</italic>(<italic>t</italic>) to produce the modeled potential <italic>V</italic>(<italic>t</italic>). The exponential nonlinearity (escape-rate) transforms this voltage into an instantaneous firing intensity <italic>λ</italic>(<italic>t</italic>), according to which spikes are generated. Each time a spike is emitted, both a current <italic>η</italic>(<italic>t</italic>) and a movement of the firing threshold <italic>γ</italic>(<italic>t</italic>) are triggered. <bold>(B)</bold> The GIF model accurately predicts the occurrence of individual spikes with millisecond precision. To evaluate the predictive power of the GIF model, the response of a L5 pyramidal neuron to a fluctuating input current (top, the horizontal dashed line represents 0 nA) has been recorded intracellularly (middle, black). The same protocol was repeated nine times to assess the reliability of the neural response (bottom, black raster). The GIF model (with parameters extracted using a different dataset) was able to accurately predict both the subthreshold (middle, red) and the spiking response (bottom, red raster) of the cell.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.g001"/>
</fig>
<p>In the model, the subthreshold membrane potential <italic>V</italic>(<italic>t</italic>) evolves according to the following differential equation:
<disp-formula id="pcbi.1004275.e002"><alternatives><graphic id="pcbi.1004275.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e002"/><mml:math id="M2" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>C</mml:mi> <mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mtext>L</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mtext>L</mml:mtext></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:munder> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where the parameters <italic>C</italic>, <italic>g</italic><sub>L</sub> and <italic>E</italic><sub>L</sub> define the passive properties of the neuron, <italic>I</italic>(<italic>t</italic>) is the input current and <inline-formula id="pcbi.1004275.e003"><mml:math id="M3" overflow="scroll"><mml:mrow><mml:mo stretchy="false">{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> are the spike times. According to <xref ref-type="disp-formula" rid="pcbi.1004275.e002">Eq 1</xref>, the passive properties of the membrane are described by an exponential filter <inline-formula id="pcbi.1004275.e004"><mml:math id="M4" overflow="scroll"><mml:mrow><mml:mi>κ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mi>R</mml:mi> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext mathvariant="normal">m</mml:mtext></mml:msub></mml:mfrac> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:mfrac><mml:mrow><mml:mo>−</mml:mo> <mml:mi>t</mml:mi></mml:mrow> <mml:msub><mml:mi>τ</mml:mi> <mml:mtext mathvariant="normal">m</mml:mtext></mml:msub></mml:mfrac> <mml:mo stretchy="true">)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula>, with <inline-formula id="pcbi.1004275.e005"><mml:math id="M5" overflow="scroll"><mml:mrow><mml:mi>R</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>g</mml:mi> <mml:mtext mathvariant="normal">L</mml:mtext> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> being the cell resistance and <italic>τ</italic><sub>m</sub> = <italic>RC</italic> being the membrane timescale (<xref ref-type="fig" rid="pcbi.1004275.g001">Fig 1A</xref>). Each time an action potential is fired, an intrinsic current with stereotypical shape <italic>η</italic>(<italic>t</italic>) is triggered. By convention, the spike-triggered current <italic>η</italic>(<italic>t</italic>) is hyperpolarizing when its amplitude is positive and depolarizing otherwise. Currents triggered by different spikes accumulate and produce spike-frequency adaptation, if <italic>η</italic>(<italic>t</italic>) &gt; 0 (or facilitation, if <italic>η</italic>(<italic>t</italic>) &lt; 0). The functional shape of <italic>η</italic>(<italic>t</italic>) varies among neuron types [<xref ref-type="bibr" rid="pcbi.1004275.ref037">37</xref>]. Consequently the time course of <italic>η</italic>(<italic>t</italic>) is not assumed <italic>a priori</italic> but is extracted from intracellular recordings. Each time a spike is emitted, the numerical integration is stopped during a short absolute refractory period <italic>T</italic><sub>ref</sub> and the membrane potential is reset to <inline-formula id="pcbi.1004275.e006"><mml:math id="M6" overflow="scroll"><mml:mrow><mml:mi>V</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext mathvariant="normal">ref</mml:mtext></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext mathvariant="normal">reset</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
<p>Spikes are produced stochastically according to a point process with conditional firing intensity <italic>λ</italic>(<italic>t</italic>∣<italic>V</italic>, <italic>V</italic><sub><italic>T</italic></sub>), which exponentially depends on the momentary difference between the membrane potential <italic>V</italic>(<italic>t</italic>) and the firing threshold <italic>V</italic><sub>T</sub>(<italic>t</italic>) [<xref ref-type="bibr" rid="pcbi.1004275.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref040">40</xref>]:
<disp-formula id="pcbi.1004275.e007"><alternatives><graphic id="pcbi.1004275.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e007"/><mml:math id="M7" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>|</mml:mo> <mml:mi>V</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:mtext>exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mi>V</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>V</mml:mi></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>λ</italic><sub>0</sub> has units of <italic>s</italic><sup>−1</sup>, so that <italic>λ</italic>(<italic>t</italic>) is in Hz and Δ<italic>V</italic> defines the level of stochasticity. According to <xref ref-type="disp-formula" rid="pcbi.1004275.e007">Eq 2</xref>, if Δ<italic>V</italic> ≠ 0, the probability of a spike to occur at a time <inline-formula id="pcbi.1004275.e008"><mml:math id="M8" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∈</mml:mo> <mml:mo stretchy="false">[</mml:mo> <mml:mi>t</mml:mi> <mml:mo>;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> is given by:
<disp-formula id="pcbi.1004275.e009"><alternatives><graphic id="pcbi.1004275.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>t</mml:mi> <mml:mo>;</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mi>t</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msubsup> <mml:mi>λ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>s</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo> <mml:mo>≈</mml:mo> <mml:mi>λ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
In the limit Δ<italic>V</italic> → 0, the model becomes deterministic and action potentials are emitted at the precise moment when the membrane potential crosses the firing threshold. Importantly, the value of Δ<italic>V</italic> is extracted from experimental data.</p>
<p>Finally, the dynamics of the firing threshold <italic>V</italic><sub><italic>T</italic></sub>(<italic>t</italic>) is given by:
<disp-formula id="pcbi.1004275.e010"><alternatives><graphic id="pcbi.1004275.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>T</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>T</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:munder> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <inline-formula id="pcbi.1004275.e011"><mml:math id="M11" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>T</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is a constant and <italic>γ</italic>(<italic>t</italic>) describes the stereotypical time course of the firing threshold after the emission of an action potential. Since the contribution of different spikes accumulates, the moving threshold defined in <xref ref-type="disp-formula" rid="pcbi.1004275.e010">Eq 4</xref> constitutes an additional source of adaptation (or facilitation). Similar to <italic>η</italic>(<italic>t</italic>), the functional shape of <italic>γ</italic>(<italic>t</italic>) is not assumed <italic>a priori</italic> but is extracted from intracellular recordings. All model parameters are summarized in <xref ref-type="table" rid="pcbi.1004275.t001">Table 1</xref>.</p>
<table-wrap id="pcbi.1004275.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.t001</object-id>
<label>Table 1</label>
<caption>
<title>List of model parameters and symbols.</title>
</caption>
<alternatives>
<graphic id="pcbi.1004275.t001g" mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.t001"/>
<table frame="box" rules="all" border="0">
<colgroup span="1">
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
<col align="left" valign="top" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1"><bold>GIF model</bold></th>
<th align="left" rowspan="1" colspan="1"/>
<th align="left" rowspan="1" colspan="1"><bold>GLM</bold></th>
<th align="left" rowspan="1" colspan="1"/>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Membrane capacitance</td>
<td align="left" rowspan="1" colspan="1"><italic>C</italic></td>
<td align="left" rowspan="1" colspan="1">Stimulus filter</td>
<td align="left" rowspan="1" colspan="1"><italic>κ</italic><sub>GLM</sub>(<italic>t</italic>)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Membrane conductance</td>
<td align="left" rowspan="1" colspan="1"><italic>g</italic><sub>L</sub></td>
<td align="left" rowspan="1" colspan="1">Spike-history filter</td>
<td align="left" rowspan="1" colspan="1"><italic>h</italic><sub>GLM</sub>(<italic>t</italic>)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Reversal potential</td>
<td align="left" rowspan="1" colspan="1"><italic>E</italic><sub>L</sub></td>
<td align="left" rowspan="1" colspan="1">Baseline activity</td>
<td align="left" rowspan="1" colspan="1"><italic>E</italic><sub>0</sub></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Refractory period</td>
<td align="left" rowspan="1" colspan="1"><italic>T</italic><sub>ref</sub></td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Voltage reset</td>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub>reset</sub></td>
<td align="left" rowspan="1" colspan="1"><bold>AEC</bold></td>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Threshold baseline</td>
<td align="left" rowspan="1" colspan="1">
<inline-formula id="pcbi.1004275.e012">
<mml:math id="M12" overflow="scroll">
<mml:mrow>
<mml:msubsup>
<mml:mi>V</mml:mi>
<mml:mi>T</mml:mi>
<mml:mo>*</mml:mo>
</mml:msubsup>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
<td align="left" rowspan="1" colspan="1">I-V optimal linear filter (<xref ref-type="disp-formula" rid="pcbi.1004275.e079">Eq 11</xref>)</td>
<td align="left" rowspan="1" colspan="1"><italic>κ</italic><sub>opt</sub>(<italic>t</italic>)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Threshold sharpness</td>
<td align="left" rowspan="1" colspan="1">Δ<italic>V</italic></td>
<td align="left" rowspan="1" colspan="1">Electrode filter (<xref ref-type="disp-formula" rid="pcbi.1004275.e084">Eq 14</xref>)</td>
<td align="left" rowspan="1" colspan="1"><italic>κ</italic><sub>e</sub>(<italic>t</italic>)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Spike-triggered current</td>
<td align="left" rowspan="1" colspan="1"><italic>η</italic>(<italic>t</italic>)</td>
<td align="left" rowspan="1" colspan="1">Electrode time constant</td>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic><sub>e</sub></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Spike-triggered threshold</td>
<td align="left" rowspan="1" colspan="1"><italic>γ</italic>(<italic>t</italic>)</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Cell resistance</td>
<td align="left" rowspan="1" colspan="1">
<inline-formula id="pcbi.1004275.e013">
<mml:math id="M13" overflow="scroll">
<mml:mrow>
<mml:mi>R</mml:mi>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mi>g</mml:mi>
<mml:mtext mathvariant="normal">L</mml:mtext>
<mml:mrow>
<mml:mo>−</mml:mo>
<mml:mn>1</mml:mn>
</mml:mrow>
</mml:msubsup>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
<td align="left" rowspan="1" colspan="1"><bold>Performance evaluation</bold></td>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Membrane timescale</td>
<td align="left" rowspan="1" colspan="1"><italic>τ</italic><sub>m</sub> = <italic>RC</italic></td>
<td align="left" rowspan="1" colspan="1">Spike-train similarity (<xref ref-type="disp-formula" rid="pcbi.1004275.e131">Eq 25</xref>)</td>
<td align="left" rowspan="1" colspan="1">
<inline-formula id="pcbi.1004275.e014">
<mml:math id="M14" overflow="scroll">
<mml:mrow>
<mml:msubsup>
<mml:mi>M</mml:mi>
<mml:mi>d</mml:mi>
<mml:mo>*</mml:mo>
</mml:msubsup>
</mml:mrow>
</mml:math>
</inline-formula>
</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Membrane filter</td>
<td align="left" rowspan="1" colspan="1"><italic>κ</italic>(<italic>t</italic>)</td>
<td align="left" rowspan="1" colspan="1">Voltage prediction error (<xref ref-type="disp-formula" rid="pcbi.1004275.e139">Eq 27</xref>)</td>
<td align="left" rowspan="1" colspan="1"><italic>ϵ</italic><sub>V</sub></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Effective adaptation filter (<xref ref-type="disp-formula" rid="pcbi.1004275.e052">Eq 7</xref>)</td>
<td align="left" rowspan="1" colspan="1"><italic>h</italic>(<italic>t</italic>)</td>
<td align="left" rowspan="1" colspan="1">Parameter prediction error (<xref ref-type="disp-formula" rid="pcbi.1004275.e140">Eq 28</xref>)</td>
<td align="left" rowspan="1" colspan="1"><italic>ϵ</italic><sub>param</sub></td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec004">
<title>GIF model parameter extraction</title>
<p>Given the intracellular voltage response <italic>V</italic><sub>data</sub>(<italic>t</italic>) evoked <italic>in vitro</italic> by a controlled input current <italic>I</italic><sub>tr</sub>(<italic>t</italic>), all of the GIF model parameters are extracted from experimental data (<italic>training set</italic>) using a three-step procedure (<xref ref-type="fig" rid="pcbi.1004275.g002">Fig 2</xref>) that we previously introduced [<xref ref-type="bibr" rid="pcbi.1004275.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>]. A detailed description of the fitting procedure can be found in the Materials and Methods section.</p>
<fig id="pcbi.1004275.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Schematic representation of the procedure used for GIF model parameter extraction.</title>
<p>In <italic>Step 1</italic> (first row), the experimental spike train <italic>S</italic><sub>data</sub>(<italic>t</italic>) is extracted from the voltage trace <italic>V</italic><sub>data</sub>(<italic>t</italic>) using a standard threshold-crossing method (left, dashed line). Parameters related to absolute refractoriness are extracted from the average spike shape (middle). In <italic>Step 2</italic> (second row), given the injected current <italic>I</italic><sub>tr</sub>(<italic>t</italic>) and the recorded potential <italic>V</italic><sub>data</sub>, all the parameters <italic>θ</italic><sub>sub</sub> defining the dynamics of the subthreshold membrane potential (<xref ref-type="disp-formula" rid="pcbi.1004275.e002">Eq 1</xref>) are extracted by performing a least-square multilinear regression on the membrane potential derivative <inline-formula id="pcbi.1004275.e015"><mml:math id="M15" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. Since <xref ref-type="disp-formula" rid="pcbi.1004275.e002">Eq 1</xref> does not describe the membrane potential dynamics during action potentials, all the data close to spikes are discarded. In <italic>Step 3</italic> (third row), the subthreshold parameters <italic>θ</italic><sub>sub</sub> are first used to compute the subthreshold voltage of the model <inline-formula id="pcbi.1004275.e016"><mml:math id="M16" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="normal">model</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. The parameters <italic>θ</italic><sub>th</sub> defining the dynamics of the firing threshold (left, dashed line) are then extracted by maximizing the probability (i.e., the <italic>log-likelihood</italic>) that the experimental spike train <italic>S</italic><sub>data</sub>(<italic>t</italic>) was produced by the model, given the subthreshold dynamics <inline-formula id="pcbi.1004275.e017"><mml:math id="M17" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="normal">model</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.g002"/>
</fig>
<p>In <italic>Step 1</italic> (<xref ref-type="fig" rid="pcbi.1004275.g002">Fig 2</xref>, Step 1), the experimental spike train <inline-formula id="pcbi.1004275.e018"><mml:math id="M18" overflow="scroll"><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is first defined as the collection of instants <inline-formula id="pcbi.1004275.e019"><mml:math id="M19" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> at which <italic>V</italic><sub>data</sub>(<italic>t</italic>) crossed a certain threshold from below. The average spike shape <italic>V</italic><sub>STA</sub>(<italic>t</italic>) is then obtained by computing the spike-triggered average (STA) of <italic>V</italic><sub>data</sub>(<italic>t</italic>). Depending on the cell type (i.e., depending on the average spike shape), the absolute refractory period <italic>T</italic><sub>ref</sub> is fixed to a certain value and the reset potential is computed as <italic>V</italic><sub>reset</sub> = <italic>V</italic><sub>STA</sub>(<italic>T</italic><sub>ref</sub>). In the GIF model, a period of absolute refractoriness can alternatively be implemented by setting the first milliseconds of the spike-triggered threshold movement <italic>γ</italic>(<italic>t</italic>) to very large values. For this reason, as long as <italic>T</italic><sub>ref</sub> remains smaller than the shortest interspike interval (ISI) observed in the data, its precise value is not critical. A sensible choice is to set <italic>T</italic><sub>ref</sub> about twice the spike width at half maximum.</p>
<p>In <italic>Step 2</italic> (<xref ref-type="fig" rid="pcbi.1004275.g002">Fig 2</xref>, Step 2), the first-order temporal derivative of the experimental voltage <inline-formula id="pcbi.1004275.e020"><mml:math id="M20" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is estimated by finite differences and the parameters <italic>θ</italic><sub>sub</sub> = {<italic>C</italic>, <italic>g</italic><sub>L</sub>, <italic>E</italic><sub>L</sub>, <italic>η</italic>(<italic>t</italic>)} determining the membrane potential dynamics are extracted by fitting <xref ref-type="disp-formula" rid="pcbi.1004275.e002">Eq 1</xref> on <inline-formula id="pcbi.1004275.e021"><mml:math id="M21" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. This is done by exploiting the knowledge of the experimental voltage <italic>V</italic><sub>data</sub>(<italic>t</italic>) and the external input <italic>I</italic><sub>tr</sub>(<italic>t</italic>). To avoid <italic>a priori</italic> assumptions on the functional shape of the spike-triggered current, <italic>η</italic>(<italic>t</italic>) is expanded in a linear combination of rectangular basis functions. Consequently, optimal parameters minimizing the sum of squared errors between <inline-formula id="pcbi.1004275.e022"><mml:math id="M22" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and <inline-formula id="pcbi.1004275.e023"><mml:math id="M23" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> can be efficiently obtained by solving a multilinear regression problem [<xref ref-type="bibr" rid="pcbi.1004275.ref022">22</xref>] (cf. Eqs <xref ref-type="disp-formula" rid="pcbi.1004275.e093">17</xref>–<xref ref-type="disp-formula" rid="pcbi.1004275.e094">18</xref>).</p>
<p>In <italic>Step 3</italic> (<xref ref-type="fig" rid="pcbi.1004275.g002">Fig 2</xref>, Step 3), the parameters estimated so far are first used to compute the subthreshold membrane potential of the model <inline-formula id="pcbi.1004275.e024"><mml:math id="M24" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="normal">model</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>. For that, <xref ref-type="disp-formula" rid="pcbi.1004275.e002">Eq 1</xref> is numerically solved by enforcing adaptation currents <italic>η</italic>(<italic>t</italic>) at all the observed spike times <inline-formula id="pcbi.1004275.e025"><mml:math id="M25" overflow="scroll"><mml:mrow><mml:mo stretchy="false">{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula>. Given <inline-formula id="pcbi.1004275.e026"><mml:math id="M26" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="normal">model</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>, the parameters <inline-formula id="pcbi.1004275.e027"><mml:math id="M27" overflow="scroll"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mtext mathvariant="normal">th</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>T</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>V</mml:mi> <mml:mo>,</mml:mo> <mml:mi>γ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> defining the firing threshold dynamics (cf. Eqs <xref ref-type="disp-formula" rid="pcbi.1004275.e007">2</xref>–<xref ref-type="disp-formula" rid="pcbi.1004275.e010">4</xref>) are then extracted by maximizing the probability (i.e., the <italic>log-likelihood</italic>) of the experimental spike train <italic>S</italic><sub>data</sub>(<italic>t</italic>) being produced by the GIF model (cf. Eqs <xref ref-type="disp-formula" rid="pcbi.1004275.e102">20</xref>–<xref ref-type="disp-formula" rid="pcbi.1004275.e105">21</xref>). Similar to <italic>η</italic>(<italic>t</italic>), the spike-triggered threshold movement is extracted by expanding <italic>γ</italic>(<italic>t</italic>) in a linear combination of rectangular basis functions. Since the parameters <italic>λ</italic><sub>0</sub> and <inline-formula id="pcbi.1004275.e028"><mml:math id="M28" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>T</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> are redundant, <italic>λ</italic><sub>0</sub> is fixed to 1 Hz. With the exponential function in <xref ref-type="disp-formula" rid="pcbi.1004275.e007">Eq 2</xref>, the <italic>log-likelihood</italic> to maximize is guaranteed to be a concave function of <italic>θ</italic><sub>th</sub>[<xref ref-type="bibr" rid="pcbi.1004275.ref041">41</xref>] and the optimization problem can be solved using standard gradient ascent techniques. The method used in this last step closely resembles the standard GLM fitting procedure [<xref ref-type="bibr" rid="pcbi.1004275.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref036">36</xref>]. However, here, by exploiting the information contained in the subthreshold dynamics of the membrane potential, the maximum likelihood approach is specifically used to infer the dynamics of the firing threshold. In contrast to GLMs, the GIF model can consequently disentangle adaptation processes mediated by intrinsic currents and threshold movements.</p>
</sec>
<sec id="sec005">
<title>GIF model validation</title>
<p>To obtain a high-throughput pipeline for GIF model parameter extraction, the method described in the previous section has to be complemented with a validation protocol designed to automatically detect and discard trials in which the fitting procedure fails. Good spiking neuron models should be able to accurately predict the occurrence of individual action potentials with millisecond precision [<xref ref-type="bibr" rid="pcbi.1004275.ref006">6</xref>]. To take into account the stochastic nature of single neurons [<xref ref-type="bibr" rid="pcbi.1004275.ref042">42</xref>], we designed a validation protocol based on the measurement of the model performance in predicting spike emission probability. After the acquisition of the <italic>training dataset</italic> used for parameter extraction, a new set of recordings (<italic>test dataset</italic>) is performed in which single neurons are stimulated repetitively with a test current <italic>I</italic><sub>test</sub>(<italic>t</italic>). The resulting set of experimental spike trains is then compared against a set of spike trains predicted by repetitive simulations of the GIF model. To obtain a quantitative measure of the model’s predictive power, the similarity <inline-formula id="pcbi.1004275.e029"><mml:math id="M29" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> [<xref ref-type="bibr" rid="pcbi.1004275.ref034">34</xref>] between the two sets of spike trains is computed (<xref ref-type="sec" rid="sec011">Materials and Methods</xref>). <inline-formula id="pcbi.1004275.e030"><mml:math id="M30" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> takes values between 0 and 1, where <inline-formula id="pcbi.1004275.e031"><mml:math id="M31" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> indicates that the model is unable to predict any of the experimental spikes and <inline-formula id="pcbi.1004275.e032"><mml:math id="M32" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></inline-formula> indicates a perfect match. Importantly, <inline-formula id="pcbi.1004275.e033"><mml:math id="M33" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> avoids the <italic>small-sample bias</italic> known to occur when measuring the similarity between small groups of spike trains as well as the <italic>deterministic bias</italic> known to favor noise-free models [<xref ref-type="bibr" rid="pcbi.1004275.ref034">34</xref>].</p>
</sec>
<sec id="sec006">
<title>Testing GIF model parameter extraction and validation on artificial data</title>
<p>To estimate the amount of data required to perform GIF model parameter extraction, we first tested our fitting procedure on an artificial training set generated by simulating the response of a GIF model to a fluctuating current <italic>I</italic>(<italic>t</italic>). The choice of reference parameters (Fig <xref ref-type="fig" rid="pcbi.1004275.g003">3A</xref>–<xref ref-type="fig" rid="pcbi.1004275.g003">3D</xref>, black) was based on previous results [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>]. In particular, both the spike-triggered current <italic>η</italic>(<italic>t</italic>) and the threshold movement <italic>γ</italic>(<italic>t</italic>) were defined as a linear combination of <italic>K</italic> = 26 log-spaced rectangular basis functions approximating a power-law decay over 5 seconds [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref043">43</xref>]. Overall, the reference model had 59 parameters: 31 were related to the subthreshold dynamics and 28 to the firing threshold.</p>
<fig id="pcbi.1004275.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Validation of the procedure used for GIF model parameter extraction.</title>
<p><bold>(A)-(D)</bold> GIF model parameters used to generate the artificial data (black) recovered using a training set of <italic>T</italic><sub>tr</sub> = 10 s (gray) and <italic>T</italic><sub>tr</sub> = 100 s (red). Error bars and shaded areas represent one standard deviation obtained using five different data sets. In case of perfect agreement, black lines, gray lines and shaded areas are not visible. <bold>(A)</bold> Membrane filter <italic>κ</italic>(<italic>t</italic>). Inset: membrane timescale <italic>τ</italic><sub>m</sub> = <italic>C</italic>/<italic>g</italic><sub>L</sub>. <bold>(B)</bold> Spike-triggered current <italic>η</italic>(<italic>t</italic>). <bold>(C)</bold> Spike-triggered movement of the firing threshold <italic>γ</italic>(<italic>t</italic>). <bold>(D)</bold> Reversal potential (<italic>E</italic><sub>L</sub>, top left); cell resistance (<inline-formula id="pcbi.1004275.e034"><mml:math id="M34" overflow="scroll"><mml:mrow><mml:mi>R</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>g</mml:mi> <mml:mtext mathvariant="normal">L</mml:mtext> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>, top right); threshold baseline (<inline-formula id="pcbi.1004275.e035"><mml:math id="M35" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mtext mathvariant="normal">T</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, bottom left) and threshold sharpness (Δ<italic>V</italic>, bottom right). <bold>(E)</bold> Estimation error <italic>ϵ</italic><sub>param</sub> on model parameters (upper panel), performance on spike-timing prediction <inline-formula id="pcbi.1004275.e036"><mml:math id="M36" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> (middle panel) and computing time required for parameter extraction (lower panel) as a function of the training set size <italic>T</italic><sub>tr</sub>. Gray areas indicate one standard deviation across different artificial datasets generated using the same reference parameters. Gray and red arrows indicate the performance obtained with a training set of 10 s and 100 s, respectively. <bold>(F)</bold> Reliability of the validation procedure as a function of the number of repetitions <italic>n</italic><sub>test</sub> and the duration <italic>T</italic><sub>test</sub> of the test current. For different values of <italic>n</italic><sub>test</sub> and <italic>T</italic><sub>test</sub>, <inline-formula id="pcbi.1004275.e037"><mml:math id="M37" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> was computed 1000 times using different test currents. Consistent with the result that <inline-formula id="pcbi.1004275.e038"><mml:math id="M38" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> corrects the small-sample bias, the mean value of <inline-formula id="pcbi.1004275.e039"><mml:math id="M39" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>998</mml:mn></mml:mrow></mml:math></inline-formula> (dashed line) obtained across repetitions of different test currents did not depend on <italic>n</italic><sub>test</sub> and <italic>T</italic><sub>test</sub>. The continuous lines represent the 0.25-quantiles of the <inline-formula id="pcbi.1004275.e040"><mml:math id="M40" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> distribution obtained with <italic>n</italic><sub>test</sub> = {3,6,9,12,15} (from dark to light gray) and indicate that the reliability of the measure increases with <italic>n</italic><sub>test</sub> and <italic>T</italic><sub>test</sub>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.g003"/>
</fig>
<p>The input current <italic>I</italic>(<italic>t</italic>) used to build the artificial training set was generated at Δ<italic>T</italic> <sup>−1</sup> = 20 kHz by numerically solving the stochastic differential equation <inline-formula id="pcbi.1004275.e041"><mml:math id="M41" overflow="scroll"><mml:mrow><mml:mi>τ</mml:mi> <mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:mi>I</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msqrt><mml:mrow><mml:mn>2</mml:mn> <mml:mi>τ</mml:mi></mml:mrow></mml:msqrt> <mml:mi>σ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mi>ξ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in discrete time
<disp-formula id="pcbi.1004275.e042"><alternatives><graphic id="pcbi.1004275.e042g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e042"/><mml:math id="M42" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>-</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mi>τ</mml:mi></mml:mfrac> <mml:mo>·</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi> <mml:mo>+</mml:mo> <mml:msqrt><mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi></mml:mrow> <mml:mi>τ</mml:mi></mml:mfrac></mml:msqrt> <mml:mo>·</mml:mo> <mml:mo>𝓝</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>ξ</italic>(<italic>t</italic>) is a Gaussian white-noise process generated by independently sampling from a Normal distribution 𝓝(0,1), <italic>τ</italic> = 3 ms is the characteristic timescale on which the input fluctuates, <italic>I</italic><sub>0</sub> defines the mean input and <italic>σ</italic>(<italic>t</italic>) is the time-dependent standard deviation of <italic>I</italic>(<italic>t</italic>). Ornstein-Uhlenbeck processes (i.e. stationary filtered Gaussian processes) have been extensively used to model the input current received <italic>in vivo</italic> at the soma of neocortical neurons [<xref ref-type="bibr" rid="pcbi.1004275.ref044">44</xref>]. Here, we relaxed the assumption of stationarity by modulating the variance of the input with a periodic oscillation [<xref ref-type="bibr" rid="pcbi.1004275.ref043">43</xref>] given by:
<disp-formula id="pcbi.1004275.e043"><alternatives><graphic id="pcbi.1004275.e043g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e043"/><mml:math id="M43" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>σ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>σ</mml:mi> <mml:mo form="prefix">sin</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mi>π</mml:mi> <mml:mi>f</mml:mi> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>σ</italic><sub>0</sub> and Δ<italic>σ</italic> are constants and <italic>f</italic> = 0.2 Hz is the modulation frequency. An input current with non-stationary statistics drives the neurons through different regimes producing broad ISI distributions that better constrain the fit of adaptation processes. The input parameters <italic>I</italic><sub>0</sub>, <italic>σ</italic><sub>0</sub> and Δ<italic>σ</italic> were adjusted to generate an artificial training set in which the GIF model emitted spikes at an average firing rate of 10 Hz oscillating over 5 seconds between around 7 and 13 Hz.</p>
<p>The fitting procedure illustrated in <xref ref-type="fig" rid="pcbi.1004275.g002">Fig 2</xref> was then applied to recover the reference parameters of the GIF model used to generate the artificial dataset (Fig <xref ref-type="fig" rid="pcbi.1004275.g003">3A</xref>–<xref ref-type="fig" rid="pcbi.1004275.g003">3D</xref>, black). To estimate the amount of data required to guarantee a high degree of accuracy, this operation was repeated several times by varying the size of the training set <italic>T</italic><sub>tr</sub> (i.e., the duration of the input current <italic>I</italic>(<italic>t</italic>)). Fig <xref ref-type="fig" rid="pcbi.1004275.g003">3A</xref>–<xref ref-type="fig" rid="pcbi.1004275.g003">3D</xref> shows a comparison between the reference parameters and the results obtained by fitting a training set of <italic>T</italic><sub>tr</sub> = 10 seconds (gray) and <italic>T</italic><sub>tr</sub> = 100 seconds (red). Overall, we found that 100 seconds were sufficient to accurately recover the reference parameters. To quantify the accuracy of the fit, we computed the mean error <italic>ϵ</italic><sub>param</sub> on model parameters as a function of <italic>T</italic><sub>tr</sub> (see <xref ref-type="sec" rid="sec011">Materials and Methods</xref>). The results indicate that the minimum amount of data required for accurate parameter extraction is 30–40 seconds. In particular, we found that 100 seconds were sufficient to limit the error to <italic>ϵ</italic><sub>param</sub> &lt; 2.0% (<xref ref-type="fig" rid="pcbi.1004275.g003">Fig 3E</xref>, top). The great accuracy with which the fitted model was able to predict the spiking activity of the reference model (<inline-formula id="pcbi.1004275.e044"><mml:math id="M44" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>998</mml:mn></mml:mrow></mml:math></inline-formula>) confirmed the goodness of this fit (<xref ref-type="fig" rid="pcbi.1004275.g003">Fig 3E</xref>, middle). To achieve high-throughput and perform parameter extraction <italic>on the fly</italic>, it is crucial to minimize the computing time (CPU time) required for the fit. We measured the CPU time as a function of the training set duration <italic>T</italic><sub>tr</sub> (<xref ref-type="fig" rid="pcbi.1004275.g003">Fig 3E</xref>, bottom) and we found that accurate parameter extraction from a training set of <italic>T</italic><sub>tr</sub> = 100 seconds requires around 60 seconds of computing. We concluded that GIF model parameter extraction is suitable for high-throughput.</p>
<p>A second time-consuming procedure that has to be analyzed is the validation protocol. To quantify the predictive power of the fitted model, the reference model was stimulated with repetitive injections of a test current <italic>I</italic><sub>test</sub>(<italic>t</italic>) generated according to Eqs <xref ref-type="disp-formula" rid="pcbi.1004275.e042">5</xref>–<xref ref-type="disp-formula" rid="pcbi.1004275.e043">6</xref>. To estimate the number of repetitions <italic>n</italic><sub>test</sub> and the duration <italic>T</italic><sub>test</sub> of the test current required to obtain a reliable estimate of the model predictive power, the similarity measure <inline-formula id="pcbi.1004275.e045"><mml:math id="M45" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> was computed multiple times using different values of <italic>n</italic><sub>test</sub> and <italic>T</italic><sub>test</sub> (<xref ref-type="fig" rid="pcbi.1004275.g003">Fig 3F</xref>). On average, the value of <inline-formula id="pcbi.1004275.e046"><mml:math id="M46" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> was independent of both the input current duration and the number of repetitions, confirming that the spike-train metrics <inline-formula id="pcbi.1004275.e047"><mml:math id="M47" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> successfully eliminates the <italic>small sample bias</italic> [<xref ref-type="bibr" rid="pcbi.1004275.ref034">34</xref>]. We measured the variability of <inline-formula id="pcbi.1004275.e048"><mml:math id="M48" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> across validation procedures performed with different realizations of <italic>I</italic><sub>test</sub>(<italic>t</italic>) and found that the reliability of <inline-formula id="pcbi.1004275.e049"><mml:math id="M49" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> increased with both the number of repetitions <italic>n</italic><sub>test</sub> and the duration of the test current <italic>T</italic><sub>test</sub> (<xref ref-type="fig" rid="pcbi.1004275.g003">Fig 3F</xref>). Spike-triggered processes can last for several seconds [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref043">43</xref>]. This sets a constraint on the minimal duration of both the test current <italic>I</italic><sub>test</sub>(<italic>t</italic>) and the interstimulus interval. By taking into account these constraints, we concluded that, while respecting high-throughput constraints, a validation protocol based on nine injections of a 10-second current guarantees a reliable estimation of the model’s predictive power (<xref ref-type="fig" rid="pcbi.1004275.g003">Fig 3F</xref>).</p>
</sec>
<sec id="sec007">
<title>A protocol for automated high-throughput single-neuron characterization</title>
<p>Based on the results reported in the previous section, we designed a protocol for the fit and the validation of GIF models on <italic>in vitro</italic> intracellular recordings (<xref ref-type="fig" rid="pcbi.1004275.g004">Fig 4</xref>). The protocol is conceptually divided in two phases. In the first part, a <italic>training set</italic> is acquired by recording the single-neuron response to a fluctuating input <italic>I</italic><sub>tr</sub>(<italic>t</italic>) lasting for <italic>T</italic><sub>tr</sub> = 100 seconds and generated according to Eqs <xref ref-type="disp-formula" rid="pcbi.1004275.e042">5</xref>–<xref ref-type="disp-formula" rid="pcbi.1004275.e043">6</xref>. These data are then used for parameter extraction. In the second part of the protocol, nine repetitive injections of a new 10-second current <italic>I</italic><sub>test</sub>(<italic>t</italic>) are performed with an interstimulus interval of 10 seconds, so as to allow the cell to recover. These data (<italic>test set</italic>) are then used to quantify the predictive power of the GIF model with the spike-train similarity measure <inline-formula id="pcbi.1004275.e050"><mml:math id="M50" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>. Since all the computations required for parameter extraction and model validation can be performed <italic>on the fly</italic>, the whole protocol requires 5 minutes and is suitable for high-throughput.</p>
<fig id="pcbi.1004275.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Schematic representation of the protocol for high-throughput single-neuron characterization.</title>
<p>To characterize the properties of the electrode required for AEC, the experimental protocol starts with the injection of a short subthreshold current. While the filtering properties of the patch clamp are estimated (AEC box, left), the training dataset is collected. After training set collection, the raw data are preprocessed with AEC (AEC box, right). Then, in parallel with GIF model parameter extraction and successive spike timing prediction, the test dataset is collected by injecting nine repetitions of the same time-dependent current. Finally, after complete acquisition of the test set, the similarity measure <inline-formula id="pcbi.1004275.e051"><mml:math id="M51" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mtext mathvariant="normal">d</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> between the observed and the predicted spike trains is computed. Overall, GIF model parameter extraction and validation requires around five minutes.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.g004"/>
</fig>
<p>Current-clamp experiments in which the same electrode is used both for stimulating and recording from single neurons are biased due to the voltage drop across the electrode [<xref ref-type="bibr" rid="pcbi.1004275.ref032">32</xref>]. To remove this bias, intracellular recordings are preprocessed using a technique called Active Electrode Compensation (AEC, refs. [<xref ref-type="bibr" rid="pcbi.1004275.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref033">33</xref>], see <xref ref-type="sec" rid="sec011">Materials and Methods</xref>). To perform AEC, the filtering properties of the electrode have to be estimated. For that, an additional 10-second subthreshold current injection is performed before the acquisition of the <italic>training set</italic> (<xref ref-type="fig" rid="pcbi.1004275.g004">Fig 4</xref>).</p>
</sec>
<sec id="sec008">
<title>Testing the high-throughput protocol on <italic>in silico</italic> recordings</title>
<p>A different class of models used to describe the electrical activity of individual neurons includes the so called multi-compartment conductance-based models (or detailed biophysical models). In contrast to point-neuron models, detailed biophysical models account for the intricate morphology of both dendritic and axonal arborizations and explicitly describe the dynamics of a large variety of ion channels mediating active currents. Both aspects are likely to play a role in single-neuron information processing [<xref ref-type="bibr" rid="pcbi.1004275.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref046">46</xref>]. A detailed biophysical model (DBM) has recently been proposed that captures several features of L5b thick-tufted pyramidal neurons [<xref ref-type="bibr" rid="pcbi.1004275.ref014">14</xref>]. In particular, this model includes active dendrites and describes the interactions between Na<sup>+</sup>-spiking at the soma, back-propagating action potentials and Ca<sup>2+</sup>-spikes generated at the distal apical dendrites.</p>
<p>To validate our procedure for high-throughput single-neuron characterization, the protocol described in <xref ref-type="fig" rid="pcbi.1004275.g004">Fig 4</xref> was tested <italic>in silico</italic> by simulating the DBM response to a set of current injections (<xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5A</xref>, see <xref ref-type="sec" rid="sec011">Materials and Methods</xref>). The input parameters were calibrated to obtain an average firing rate of 10 Hz with slow rate fluctuations between 7 and 13 Hz. Moreover, to model stochastic spike emission, a source of noise was introduced by corrupting the input current with some additive white-noise (see <xref ref-type="sec" rid="sec011">Materials and Methods</xref>). Capturing the DBM spiking response to dendritic injections goes beyond the scope of this study. Since we are ultimately interested in automatic somatic patching, all <italic>in silico</italic> experiments were preformed by delivering the current at the somatic compartment (<xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5A</xref>). DBM somatic recordings were then used to perform GIF model parameter extraction (Fig <xref ref-type="fig" rid="pcbi.1004275.g005">5B</xref>–<xref ref-type="fig" rid="pcbi.1004275.g005">5D</xref>). Compared with previous results from <italic>in vitro</italic> recordings in L5 pyramidal neurons [<xref ref-type="bibr" rid="pcbi.1004275.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>], the membrane filter <italic>κ</italic>(<italic>t</italic>) was characterized by a relatively short timescale (<italic>τ</italic><sub>m</sub> = 6.7 ms, s.d. 0.1 ms, <xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5B</xref>). GIF model parameter extraction also revealed the presence of a long-lasting adaptation current (<xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5C</xref>) as well as a long-lasting spike-triggered movement of the firing threshold (<xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5D</xref>). Consistent with the tendency of L5b pyramidal neurons to produce bursts of action potentials (ref. [<xref ref-type="bibr" rid="pcbi.1004275.ref014">14</xref>] and <xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5G</xref>), the activation of the spike-triggered current was not instantaneous.</p>
<fig id="pcbi.1004275.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Testing GIF model parameter extraction on <italic>in silico</italic> recordings from a detailed biophysical model: optimal GIF model parameters.</title>
<p><bold>(A)</bold> Reconstructed morphology of the detailed biophysical model (DBM, ref. [<xref ref-type="bibr" rid="pcbi.1004275.ref014">14</xref>]) used to validate the protocol for high-throughput single-neuron characterization. The recording site is indicated by the red pipette. <bold>(B)-(D)</bold> GIF model parameters extracted from <italic>in silico</italic> recordings obtained by simulating the DBM response to a somatic current injection. The filters obtained by averaging the parameters extracted from five independent training sets of <italic>T</italic><sub>tr</sub> = 100 s each are shown in red. Gray areas indicate one standard deviation. <bold>(B)</bold> Membrane filter <italic>κ</italic>(<italic>t</italic>). Inset: comparison between the membrane timescale extracted using a GIF model and the timescale of the GLM linear filter (c.f., exponential fit of <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) in panel <italic>E</italic>). Each couple of open circles indicates the timescale extracted from a specific training set. Bar plots represent the mean and one standard deviation across training sets (<italic>τ</italic><sub>m</sub> = 6.7 ms, s.d. 0.1 ms, GIF; <italic>τ</italic><sub>m</sub> = 8.9 ms, s.d. 1.3 ms, GLM). <bold>(C)</bold> Spike-triggered current <italic>η</italic>(<italic>t</italic>). Inset: zoom on the first 400 ms. <bold>(D)</bold> Spike-triggered movement of the firing threshold <italic>γ</italic>(<italic>t</italic>). <bold>(E)-(F)</bold> GLM parameters extracted from the same <italic>in silico</italic> recordings used to fit the GIF model. Average filters are shown in blue. Gray areas indicate one standard deviation across training sets. <bold>(E)</bold> Linear filter <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) (blue) and exponential fit (dashed black). For comparison, a rescaled version of the membrane filter <italic>κ</italic>(<italic>t</italic>) is shown in red. Inset: same data displayed on semi-logarithmic scales. <bold>(F)</bold> Spike-history filter <italic>h</italic><sub>GLM</sub>(<italic>t</italic>). For comparison, a rescaled version of the GIF model effective filter <italic>h</italic>(<italic>t</italic>) (<xref ref-type="disp-formula" rid="pcbi.1004275.e052">Eq 7</xref>) is shown in red. Inset: same data displayed on double-logarithmic scales. <bold>(G)</bold> ISI distributions computed using the <italic>test set</italic> data (black line and gray area) the GIF model prediction (red) and the GLM prediction (blue).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.g005"/>
</fig>
<p>According to cable theory [<xref ref-type="bibr" rid="pcbi.1004275.ref047">47</xref>], the large number of dendritic branches explicitly modeled in the DBM, is expected to manifest itself in a membrane filter <italic>κ</italic>(<italic>t</italic>) decaying over multiple timescales. To verify the accuracy of the single-exponential assumption and to compare the GIF model performance against a reference model, we also used the <italic>in silico</italic> recordings to fit a GLM [<xref ref-type="bibr" rid="pcbi.1004275.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref036">36</xref>], (Fig <xref ref-type="fig" rid="pcbi.1004275.g005">5E</xref> and <xref ref-type="fig" rid="pcbi.1004275.g005">5F</xref>). In the GLM, the linear filter <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) acting on the input current is not assumed <italic>a priori</italic> to be an exponential function and its shape is extracted from experimental data using a non-parametric method (see <xref ref-type="sec" rid="sec011">Materials and Methods</xref>). We found that the GLM filter <italic>κ</italic><sub>GLM</sub>(<italic>s</italic>) and the membrane filer <italic>κ</italic>(<italic>t</italic>) of the GIF model were in good agreement (<xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5E</xref>), suggesting that complex dendritic morphologies weakly affect temporal integration at the somatic compartment. Further quantitative evidence was provided by fitting <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) with a single exponential function and comparing the resulting timescale against <italic>τ</italic><sub>m</sub> (<xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5B</xref>, inset). The GLM spike-history filter <italic>h</italic><sub>GLM</sub>(<italic>t</italic>) extracted from <italic>in silico</italic> recordings (<xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5F</xref>) was also in good agreement with the effective adaptation filter <italic>h</italic>(<italic>t</italic>) of the GIF model [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref037">37</xref>]:
<disp-formula id="pcbi.1004275.e052"><alternatives><graphic id="pcbi.1004275.e052g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e052"/><mml:math id="M52" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mi>κ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
This result confirmed that <italic>h</italic><sub>GLM</sub>(<italic>t</italic>) combines, but cannot disentangle, the effects of the adaptation current <italic>η</italic>(<italic>t</italic>) and the movement of the firing threshold <italic>γ</italic>(<italic>t</italic>). In contrast to GIF models, GLMs do not model absolute refractoriness with a dead time followed by a voltage reset. This explains why, during the first milliseconds, <italic>h</italic><sub>GLM</sub>(<italic>t</italic>) is much larger than <italic>h</italic>(<italic>t</italic>) (<xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5F</xref>). Finally, consistent with previous results that in L5 pyramidal neurons spike-frequency adaptation occurs on multiple timescales [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref043">43</xref>], we noticed that both <italic>h</italic>(<italic>t</italic>) and <italic>h</italic><sub>GLM</sub>(<italic>t</italic>) were approximatively linear on double logarithmic scales (<xref ref-type="fig" rid="pcbi.1004275.g005">Fig 5F</xref>, inset).</p>
<p>The predictive power of both the GIF model and the GLM was then assessed on a <italic>test set</italic> obtained by simulating the DBM response to nine repetitive injections of a new 10-second current (<xref ref-type="fig" rid="pcbi.1004275.g006">Fig 6A</xref>). Both models achieved a similar performance and were able to predict around 80% of the spikes emitted by the DBM (temporal precision Δ = 4 ms; <inline-formula id="pcbi.1004275.e053"><mml:math id="M53" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> = 0.80, s.d. 0.01, GIF; <inline-formula id="pcbi.1004275.e054"><mml:math id="M54" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> = 0.79, s.d. 0.01, GLM; <xref ref-type="fig" rid="pcbi.1004275.g006">Fig 6B</xref>). Compared to the GLM, the GIF model presented two advantages. First, the GIF model, but not the GLM, explicitly modeled the dynamics of the membrane potential and could therefore predict the DBM subthreshold voltage with an average root mean squared error (RMSE) of 3.4 mV, s.d. 0.03 mV (variance explained <italic>ϵ</italic><sub>V</sub> = 74.3 %, s.d. 1.1%; <xref ref-type="fig" rid="pcbi.1004275.g006">Fig 6C</xref>). Second, the time required to perform parameter extraction was faster for the GIF model than for the GLM (<italic>T</italic><sub>CPU</sub> = 86 s, GIF; <italic>T</italic><sub>CPU</sub> = 143 s, GLM).</p>
<fig id="pcbi.1004275.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Testing GIF model parameter extraction on <italic>in silico</italic> recordings from a detailed biophysical model: GIF model validation.</title>
<p><bold>(A)</bold> Fraction of the input current <italic>I</italic><sub>test</sub>(<italic>t</italic>) (top, gray) used for model validation; typical DBM response evoked by a single current injection (middle, black); DBM spiking activity in response to nine repetitive injections of the same input (bottom, black raster); PSTH constructed by averaging the nine spike trains smoothed with a rectangular window of 500 ms (bottom, black line). GIF model and GLM predictions are shown in red and blue, respectively. Dashed black lines represent 0 nA (top) and 0 Hz (bottom). <bold>(B)-(D)</bold> Performance comparison between GIF model (red) and GLM (blue) in predicting the DBM activity. Parameter extraction and model validation were repeated five times using different datasets. Each couple of open circles indicates the performance obtained by both models on a specific dataset. Bar plots indicate the mean and one standard deviation across repetitions. <bold>(B)</bold> Spike-timing prediction as quantified by <inline-formula id="pcbi.1004275.e055"><mml:math id="M55" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> with precision Δ = 4 ms. <bold>(C)</bold> Mean prediction error <italic>ϵ</italic><sub>V</sub> on subthreshold membrane potential fluctuations. The GLM does not explicitly model the subthreshold membrane potential dynamics and is therefore not applicable (N/A). <bold>(D)</bold> GIF model spike-timing prediction (<inline-formula id="pcbi.1004275.e056"><mml:math id="M56" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, with precision Δ = 4 ms) as a function of the training set size used for parameter extraction. Increasing the duration of the training set from 100 s to 120 s does not improve the GIF model predictive power (<inline-formula id="pcbi.1004275.e057"><mml:math id="M57" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> = 0.80, s.d. 0.01, <italic>T</italic><sub>tr</sub> = 100 s; <inline-formula id="pcbi.1004275.e058"><mml:math id="M58" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> = 0.80, s.d. 0.01, <italic>T</italic><sub>tr</sub> = 120 s; <italic>n</italic> = 10, paired Student <italic>t</italic>-test, <italic>t</italic><sub>4</sub> = 0.05, <italic>p</italic> = 0.97; n.s. &gt; 0.05).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.g006"/>
</fig>
<p>Repeating the entire protocol by varying the duration of <italic>I</italic><sub>tr</sub>(<italic>t</italic>) confirmed that a training set of <italic>T</italic><sub>tr</sub> = 100 s was sufficient to ensure convergence of the fitting procedure (<xref ref-type="fig" rid="pcbi.1004275.g006">Fig 6D</xref>). Overall, these results suggest that, despite their simplicity, modern point-neuron models are capable of predicting most of the spikes emitted by a detailed biophysical model in response to complex somatic current injections.</p>
</sec>
<sec id="sec009">
<title>Testing the high-throughput protocol on <italic>in vitro</italic> patch-clamp recordings</title>
<p>To confirm the results reported in the previous section, the protocol for high-throughput single-neuron characterization was further tested using standard current-clamp <italic>in vitro</italic> recordings from L5 pyramidal neurons (see <xref ref-type="sec" rid="sec011">Materials and Methods</xref>). At the beginning of the experiment, the input current was calibrated to obtain an average firing rate of 10 Hz with amplitude fluctuations between 7 and 13 Hz. For that, we set Δ<italic>σ</italic> = 0.5, <italic>I</italic><sub>0</sub> = <italic>σ</italic><sub>0</sub> and adjusted <italic>I</italic><sub>0</sub> in order to obtain an average firing rate of around 10 Hz. While this simple approach works well for L5 pyramidal neurons, different cell types might require a more involved calibration protocol in which <italic>I</italic><sub>0</sub> ≠ <italic>σ</italic><sub>0</sub>. In these cases, an alternative solution consist of: i) temporarily setting <italic>I</italic><sub>0</sub> = 0 pA and looking for two values of <italic>σ</italic><sub>0</sub>, denoted <inline-formula id="pcbi.1004275.e059"><mml:math id="M59" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn> <mml:mtext mathvariant="normal">min</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="pcbi.1004275.e060"><mml:math id="M60" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn> <mml:mtext mathvariant="normal">max</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula>, giving rise to subthreshold voltage fluctuations <italic>σ</italic><sub>V</sub> of desired magnitudes (e.g., <inline-formula id="pcbi.1004275.e061"><mml:math id="M61" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mtext mathvariant="normal">V</mml:mtext> <mml:mtext mathvariant="normal">min</mml:mtext></mml:msubsup> <mml:mo>≈</mml:mo> <mml:mn>3</mml:mn></mml:mrow></mml:math></inline-formula> mV and <inline-formula id="pcbi.1004275.e062"><mml:math id="M62" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>σ</mml:mi> <mml:mtext mathvariant="normal">V</mml:mtext> <mml:mtext mathvariant="normal">max</mml:mtext></mml:msubsup> <mml:mo>≈</mml:mo> <mml:mn>7</mml:mn></mml:mrow></mml:math></inline-formula> mV); ii) set <inline-formula id="pcbi.1004275.e063"><mml:math id="M63" overflow="scroll"><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn> <mml:mtext mathvariant="normal">min</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn> <mml:mtext mathvariant="normal">max</mml:mtext></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:math></inline-formula> and <inline-formula id="pcbi.1004275.e064"><mml:math id="M64" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>σ</mml:mi> <mml:mo>=</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn> <mml:mtext mathvariant="normal">max</mml:mtext></mml:msubsup> <mml:mo>−</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn> <mml:mtext mathvariant="normal">min</mml:mtext></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>/</mml:mo> <mml:mn>2</mml:mn> <mml:msub><mml:mi>σ</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula>; iii) adjust <italic>I</italic><sub>0</sub> to obtain an average firing rate of around 10 Hz.</p>
<p>Since the same patch-clamp electrode was used to simultaneously stimulate and record from single neurons, the acquired signal <italic>V</italic><sub>rec</sub>(<italic>t</italic>) is a biased version of the real membrane potential <italic>V</italic><sub>data</sub>(<italic>t</italic>) [<xref ref-type="bibr" rid="pcbi.1004275.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref033">33</xref>]. This bias is due to the voltage drop <italic>V</italic><sub>e</sub>(<italic>t</italic>) across the patch-clamp electrode and was removed using a technique called Active Electrode Compensation (AEC, see <xref ref-type="sec" rid="sec011">Materials and Methods</xref> and <xref ref-type="fig" rid="pcbi.1004275.g007">Fig 7A</xref>). In AEC [<xref ref-type="bibr" rid="pcbi.1004275.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref033">33</xref>], the electrode is modeled as an arbitrarily complex linear filter <italic>κ</italic><sub>e</sub>(<italic>t</italic>) estimated at the beginning of the experiment from the optimal linear filter <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) between a 10-second subthreshold current <italic>I</italic><sub>sub</sub>(<italic>t</italic>) and the recorded response <italic>V</italic><sub>sub</sub>(<italic>t</italic>) (<xref ref-type="fig" rid="pcbi.1004275.g007">Fig 7B</xref>). For all subsequent injections, we estimated the voltage drop across the electrode <italic>V</italic><sub>e</sub>(<italic>t</italic>) by convolving the input current with the electrode filter <italic>κ</italic><sub>e</sub>(<italic>t</italic>) (<xref ref-type="fig" rid="pcbi.1004275.g007">Fig 7C</xref>). We finally recovered the membrane potential <italic>V</italic><sub>data</sub>(<italic>t</italic>) by subtracting <italic>V</italic><sub>e</sub>(<italic>t</italic>) from the recorded signal <italic>V</italic><sub>rec</sub>(<italic>t</italic>) (Fig <xref ref-type="fig" rid="pcbi.1004275.g007">7A</xref> and <xref ref-type="fig" rid="pcbi.1004275.g007">7D</xref>):
<disp-formula id="pcbi.1004275.e065"><alternatives><graphic id="pcbi.1004275.e065g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e065"/><mml:math id="M65" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mtext>data</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>rec</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>e</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula></p>
<p>According to our high-throughput protocol, the training set was compensated only after its complete acquisition. With this strategy, the time-consuming procedure required to estimate the electrode filter can be performed during the acquisition of the training set (see <xref ref-type="fig" rid="pcbi.1004275.g004">Fig 4</xref>), limiting the total duration of the protocol. Consistent with previous results [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>], we found that the electrode filter <italic>κ</italic><sub>e</sub>(<italic>t</italic>) decayed on a very rapid timescale <italic>τ</italic><sub>e</sub> = 0.54 ms, s.d. 0.11 ms (<xref ref-type="fig" rid="pcbi.1004275.g007">Fig 7C</xref>). Consequently, AEC acted on the raw data as a low-pass filter with a cutoff frequency of around 2 kHz.</p>
<fig id="pcbi.1004275.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Data preprocessing: Active Electrode Compensation.</title>
<p><bold>(A)</bold> Schematic representation of the Active Electrode Compensation technique used to correct for the experimental bias known to occur when the same patch-clamp electrode is used to simultaneously inject and record from a single neuron. The artifactual voltage <italic>V</italic><sub>e</sub>(<italic>t</italic>) across the pipette is estimated by filtering the input current <italic>I</italic>(<italic>t</italic>) with the electrode filter <italic>κ</italic><sub>e</sub>(<italic>t</italic>). The intracellular membrane potential <italic>V</italic><sub>data</sub>(<italic>t</italic>) if finally obtained by subtracting the artifactual voltage <italic>V</italic><sub>e</sub>(<italic>t</italic>) from the recorded signal <italic>V</italic><sub>rec</sub>(<italic>t</italic>). <bold>(B)</bold> Typical optimal linear filter <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) between the subthreshold input current <italic>I</italic><sub>sub</sub>(<italic>t</italic>) and the recorded signal <italic>V</italic><sub>sub</sub>(<italic>t</italic>). To estimate the electrode filter, an exponential fit is performed on the tail of <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) (dashed black). Inset: Magnification of the y-axis illustrating the good accuracy of the exponential fit (dashed black) on the tail of the optimal linear filter <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) (red). <bold>(C)</bold> Typical electrode filter <italic>κ</italic><sub>e</sub>(<italic>t</italic>) obtained by subtracting the exponential fit from the optimal linear filter <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) (see panel <italic>B</italic>). Since <italic>in vitro</italic> recordings were performed with the standard bridge compensation technique, the electrode filter <italic>κ</italic><sub>e</sub>(<italic>t</italic>) is characterized by a strong initial negative peak. The characteristic timescale of the electrode filter <italic>τ</italic><sub>e</sub> was measured by performing an exponential fit (dashed black) on <italic>κ</italic><sub>e</sub>(<italic>t</italic>). Inset: distribution of the electrode timescales <italic>τ</italic><sub>e</sub> measured in ten different recordings included in this study. <bold>(D)</bold> Comparison between recorded signal <italic>V</italic><sub>rec</sub>(<italic>t</italic>) (black) and membrane potential <italic>V</italic><sub>data</sub>(<italic>t</italic>) (red) obtained after AEC. Inset: zoom indicating that AEC operates as a low-pass filter by removing high-frequency components from the acquired signal. Scale bars: 30 ms, 5 mV.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.g007"/>
</fig>
<p>After AEC, the <italic>in vitro</italic> recordings acquired from ten different L5 pyramidal neurons (<xref ref-type="fig" rid="pcbi.1004275.g008">Fig 8A</xref>) were used to perform GIF model parameter extraction (Fig <xref ref-type="fig" rid="pcbi.1004275.g008">8B</xref>–<xref ref-type="fig" rid="pcbi.1004275.g008">8E</xref>). All of the extracted parameters were consistent with the ones previously obtained by fitting the GIF model on <italic>in vitro</italic> recordings from L5 pyramidal neurons responding to a mean-modulated input [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>]. The parameters describing the passive properties of the membrane (i.e., the resting membrane potential <italic>E</italic><sub>L</sub>, the membrane timescale <italic>τ</italic><sub>m</sub> and the input resistance <italic>R</italic>) revealed the presence of cell-to-cell variability (Fig <xref ref-type="fig" rid="pcbi.1004275.g008">8B</xref> and <xref ref-type="fig" rid="pcbi.1004275.g008">8E</xref>) and were on average consistent with previous results obtained using standard characterization protocols based on current-step injections [<xref ref-type="bibr" rid="pcbi.1004275.ref048">48</xref>]. Our characterization approach further showed that, in L5 Pyr neurons, spike-frequency adaptation is mediated by a long-lasting adaptation current featuring a power-law decay (<xref ref-type="fig" rid="pcbi.1004275.g008">Fig 8C</xref>; see also ref. [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>]), which possibly results from the combined action of multiple channels operating on different timescales [<xref ref-type="bibr" rid="pcbi.1004275.ref049">49</xref>]. In standard protocols for single-neuron characterization, spike-triggered currents are generally assessed indirectly by measuring the spike after-hyperpolarization (AHP) induced by an artificial current pulse designed to evoke one or more action potentials (see, e.g., refs. [<xref ref-type="bibr" rid="pcbi.1004275.ref049">49</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref050">50</xref>]). Importantly, with our characterization method the magnitude and the time-course of adaptation currents mediating AHPs can be measured simultaneously along with the other GIF model parameters, while neurons are processing <italic>in vivo</italic>-like inputs. Finally, our characterization protocol showed the presence of large firing threshold movements triggered by the emission of action potentials and lasting for several hundreds of milliseconds (<xref ref-type="fig" rid="pcbi.1004275.g008">Fig 8D</xref>). The dynamical properties of the firing threshold have been previously shown to be cell-type specific [<xref ref-type="bibr" rid="pcbi.1004275.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref051">51</xref>] and functionally relevant [<xref ref-type="bibr" rid="pcbi.1004275.ref052">52</xref>], but are generally not considered in standard characterization protocols.</p>
<fig id="pcbi.1004275.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Testing the protocol for high-throughput single-neuron characterization on <italic>in vitro</italic> patch-clamp recordings: optimal GIF model parameters.</title>
<p><bold>(A)</bold> Staining of a biocytin-filled L5 pyramidal neuron included in this study. <bold>(B)-(E)</bold> GIF model parameters extracted from ten L5 pyramidal neurons. Average filters are shown in red. Gray lines show the results from individual neurons. <bold>(B)</bold> Membrane filter <italic>κ</italic>(<italic>t</italic>). Inset: comparison between the characteristic timescale of <italic>κ</italic>(<italic>t</italic>) and the slow timescale <italic>τ</italic><sub>slow</sub> of <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) (see panel <italic>F</italic>). Each couple of open circles indicates the parameters measured in a single neuron. Bar plots indicate the mean and one standard deviation across neurons. <bold>(C)</bold> Spike-triggered current <italic>η</italic>(<italic>t</italic>) displayed on double-logarithmic scales. <bold>(D)</bold> Spike-triggered movement of the firing threshold <italic>γ</italic>(<italic>t</italic>) displayed on double-logarithmic scales. <bold>(E)</bold> Histograms of GIF model parameters extracted from ten L5 pyramidal neurons. From left to right: reversal potential, <italic>E</italic><sub>L</sub>; membrane timescale, <italic>τ</italic><sub><italic>m</italic></sub> = <italic>C</italic>/<italic>g</italic><sub>L</sub>; cell resistance, <inline-formula id="pcbi.1004275.e066"><mml:math id="M66" overflow="scroll"><mml:mrow><mml:mi>R</mml:mi> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>g</mml:mi> <mml:mtext mathvariant="normal">L</mml:mtext> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula>; firing threshold baseline, <inline-formula id="pcbi.1004275.e067"><mml:math id="M67" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mtext mathvariant="normal">T</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>; firing threshold sharpness, Δ<italic>V</italic>. <bold>(F)-(H)</bold> GLM parameters extracted from ten L5 pyramidal neurons. Average filters are shown in blue. Gray areas indicate one standard deviation across neurons. <bold>(F)</bold> GLM linear filter <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) (blue). For comparison, a rescaled version of the GIF filter <italic>κ</italic>(<italic>t</italic>) is shown in red. Inset: same data shown on semi-logarithmic scales. To quantify the slow <italic>τ</italic><sub>slow</sub> (panel <italic>B</italic>, inset) and the fast <italic>τ</italic><sub>fast</sub> timescale of <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>), we performed a double exponential fit (not shown for clarity) of <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>). <bold>(G)</bold> GLM spike-history filter <italic>h</italic><sub>GLM</sub>(<italic>t</italic>) (blue). For comparison, a rescaled version of the effective GIF adaptation filer <italic>h</italic>(<italic>t</italic>) (c.f., <xref ref-type="disp-formula" rid="pcbi.1004275.e052">Eq 7</xref>) is shown in red. <bold>(H)</bold> Distribution of the GLM parameter <italic>E</italic><sub>0</sub> extracted from ten L5 pyramidal neurons.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.g008"/>
</fig>
<p>To allow for a comparison, we also used the <italic>in vitro</italic> recordings to perform GLM parameter extraction (Fig <xref ref-type="fig" rid="pcbi.1004275.g008">8F</xref>–<xref ref-type="fig" rid="pcbi.1004275.g008">8H</xref>, see <xref ref-type="sec" rid="sec011">Materials and Methods</xref>). Confirming the results reported in the previous section, the effective spike-history filter <italic>h</italic>(<italic>t</italic>) of the GIF model obtained by combining the spike-triggered current <italic>η</italic>(<italic>t</italic>) and threshold movement <italic>γ</italic>(<italic>t</italic>) was in good agreement with the GLM spike-history filter <italic>h</italic><sub>GLM</sub>(<italic>t</italic>) (<xref ref-type="fig" rid="pcbi.1004275.g008">Fig 8G</xref>). The linear filters <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) and <italic>κ</italic>(<italic>t</italic>) were also in good agreement (Fig <xref ref-type="fig" rid="pcbi.1004275.g008">8B</xref> and <xref ref-type="fig" rid="pcbi.1004275.g008">8F</xref>, <italic>τ</italic><sub>m</sub> = 20.9 ms, s.d. 6.5 ms GIF; <italic>τ</italic><sub>slow</sub> = 22.5 ms, s.d. 3.0 ms GLM). However, the large values observed in the first two bins of <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) indicated the presence of a second rapid component (<italic>τ</italic><sub>fast</sub> = 1.9 ms, s.d. 0.5 ms), which is neglected in the GIF model (<xref ref-type="fig" rid="pcbi.1004275.g008">Fig 8F</xref>, inset).</p>
<p>We tested the predictive power of both the GIF model and the GLM on a new set of recordings (<italic>test set</italic>) in which a test current <italic>I</italic><sub>test</sub>(<italic>t</italic>) was repetitively injected (<xref ref-type="fig" rid="pcbi.1004275.g009">Fig 9A</xref>). In terms of mere spike-timing prediction, the GIF model and the GLM achieved similar results (<inline-formula id="pcbi.1004275.e068"><mml:math id="M68" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>79</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>04</mml:mn></mml:mrow></mml:math></inline-formula>, GIF; <inline-formula id="pcbi.1004275.e069"><mml:math id="M69" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>81</mml:mn> <mml:mo>±</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>04</mml:mn></mml:mrow></mml:math></inline-formula>, GLM; <xref ref-type="fig" rid="pcbi.1004275.g009">Fig 9B</xref>). Moreover, the GIF model, but not the GLM, could predict the subthreshold response of real neurons with an RMSE of 3.6 mV, s.d. 0.5 mV (variance explained <italic>ϵ</italic><sub>V</sub> = 80.1 %, s.d. 4.1%; <xref ref-type="fig" rid="pcbi.1004275.g009">Fig 9C</xref>). These results indicate that the difference observed between the linear filters <italic>κ</italic>(<italic>t</italic>) and <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) does not have a major impact on the predictive power of the models.</p>
<fig id="pcbi.1004275.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004275.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Testing the protocol for high-throughput single-neuron characterization on <italic>in vitro</italic> patch-clamp recordings: GIF model validation.</title>
<p><bold>(A)</bold> Input current <italic>I</italic><sub>test</sub>(<italic>t</italic>) (top, gray) used for model validation, typical L5 pyramidal neuron response evoked by a single current injection (middle, black) spiking activity observed in response to nine repetitive injections of the same input (bottom, black raster) and PSTH constructed by averaging the nine spike trains within rectangular windows of 500 ms (bottom, black line). GIF model and GLM predictions are shown in red and blue, respectively. <bold>(B)-(D)</bold> Summary data for the performance of the GIF model and the GLM in predicting the responses of ten L5 pyramidal neurons. Each couple of open circles indicates the performance on an individual cell. Error plots indicate the mean and one standard deviation across neurons. <bold>(B)</bold> Spike-timing prediction as quantified by <inline-formula id="pcbi.1004275.e070"><mml:math id="M70" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> with precision Δ = 4 ms. <bold>(C)</bold> Mean prediction error <italic>ϵ</italic><sub>V</sub> on subthreshold membrane potential fluctuations. The GLM does not explicitly model the subthreshold membrane potential dynamics and is therefore not applicable (N/A). <bold>(D)</bold> GIF model spike-timing prediction (<inline-formula id="pcbi.1004275.e071"><mml:math id="M71" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, with precision Δ = 4 ms) as a function of the training set size used for parameter extraction. Increasing the duration of the training set from 100 s to 120 s does not improve the GIF model predictive power (<inline-formula id="pcbi.1004275.e072"><mml:math id="M72" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> = 0.79, s.d. 0.04, <italic>T</italic><sub>tr</sub> = 100 s; <inline-formula id="pcbi.1004275.e073"><mml:math id="M73" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> = 0.79, s.d. 0.04, <italic>T</italic><sub>tr</sub> = 120 s; <italic>n</italic> = 10, paired Student <italic>t</italic>-test, <italic>t</italic><sub>9</sub> = 0.25, <italic>p</italic> = 0.8; n.s. &gt; 0.05).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004275.g009"/>
</fig>
<p>Finally, comparing the predictive power of different GIF models with parameters extracted from five training sets of different durations (<italic>T</italic><sub>tr</sub> = 10, 30, 60, 100 and 120 s; <xref ref-type="fig" rid="pcbi.1004275.g009">Fig 9D</xref>) confirmed that 100 seconds of intracellular recordings are sufficient to accurately constrain the GIF model parameters. We conclude that our protocol for GIF model parameter extraction is suitable for high-throughput single-neuron characterization.</p>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>The intrinsic dynamics of individual neurons strongly differ between cell types and brain areas [<xref ref-type="bibr" rid="pcbi.1004275.ref053">53</xref>]. This heterogeneity is increasingly considered as a critical feature of the brain and not as a consequence of biological imprecision [<xref ref-type="bibr" rid="pcbi.1004275.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref055">55</xref>]. Taking into account single-neuron variability may be crucial to understand how neural systems support computation. In the near future, automated electrophysiology will likely make available increasingly large amounts of data. Due to their inherent complexity (and their high dimensionality), raw data from patch-clamp recordings are difficult to interpret and cannot be directly clustered to identify electrophysiological types. GIF models are currently employed by computational neuroscientists mainly to investigate the emergent properties of neural networks. Here, we showed that these models also comprise a powerful tool to cast the information provided by voltage recordings into small sets of model parameters that can be easily interpreted and compared.</p>
<p>More precisely, we demonstrated that the fitting procedure for GIF models we recently introduced [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref037">37</xref>] (Figs <xref ref-type="fig" rid="pcbi.1004275.g001">1</xref> and <xref ref-type="fig" rid="pcbi.1004275.g002">2</xref>) is suitable for high-throughput analysis of intracellular patch-clamp recordings. Using an artificial dataset generated by the model itself, we first established that GIF model parameter extraction and validation can be accomplished in around five minutes given a limited amount of intracellular recordings (<xref ref-type="fig" rid="pcbi.1004275.g003">Fig 3</xref>). Based on these results, we then designed a protocol for the characterization of the electrical activity of single neurons (<xref ref-type="fig" rid="pcbi.1004275.g004">Fig 4</xref>). On the experimental side, the protocol relies on <italic>in vitro</italic> injections of rapidly fluctuating currents. To compensate for the artifact known to occur while delivering inputs through the recording electrode, we propose the use of Active Electrode Compensation [<xref ref-type="bibr" rid="pcbi.1004275.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref033">33</xref>] (<xref ref-type="fig" rid="pcbi.1004275.g007">Fig 7</xref>). In AEC, estimating the electrode properties is a potentially time-consuming procedure. For this reason, in our protocol, artifacts resulting from the voltage drop across the patch-clamp electrode are removed only after the complete acquisition of the dataset used for parameter extraction (<xref ref-type="fig" rid="pcbi.1004275.g004">Fig 4</xref>). We tested the protocol for high-throughput single-neuron characterization using both <italic>in silico</italic> data (Figs <xref ref-type="fig" rid="pcbi.1004275.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1004275.g006">6</xref>) as well as <italic>in vitro</italic> recordings obtained with conventional (i.e., manual) patch-clamping (Figs <xref ref-type="fig" rid="pcbi.1004275.g008">8</xref> and <xref ref-type="fig" rid="pcbi.1004275.g009">9</xref>). In both cases the results confirmed our conclusion drawn from the analysis of artificial data generated by the GIF model itself (Fig <xref ref-type="fig" rid="pcbi.1004275.g003">3</xref>)X namely that a GIF model with parameters extracted from a training set with size larger than 30 seconds accurately predicts both the subthreshold and the spiking response evoked by a new input. Considering that long current-clamp recordings are generally affected by low-frequency artifacts such as drifts in resting membrane potential, access resistance and average firing rate, it seems unlikely that a training set whose size prohibits rapid characterization would improve accuracy. Intriguingly, we found that the GIF model achieves almost identical performances in predicting <italic>in silico</italic> and <italic>in vitro</italic> data (Figs <xref ref-type="fig" rid="pcbi.1004275.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1004275.g009">9</xref>), indicating that detailed biophysical models could be used in the future to guide the improvement of simplified spiking models. Analyzing the performance of the GIF model in response to dendritic inputs goes beyond the scope of this study. However, as demonstrated by a recent study [<xref ref-type="bibr" rid="pcbi.1004275.ref056">56</xref>], the mathematical framework discussed here is flexible and can in principle be extended to account for dendritic current injections.</p>
<p>Considering the time required to automatically select a target neuron and form a gigaohm seal, our results demonstrate that, if combined with emergent technologies for automatic patch-clamping, the mathematical tools discussed in this study could be used to implement a high-throughput pipeline performing single-neuron characterization in around ten minutes. Importantly, all the computations in the protocol can be executed <italic>on the fly</italic>, while electrophysiological recordings are being performed. Consequently, the model performance in predicting the spiking activity (i.e., <inline-formula id="pcbi.1004275.e074"><mml:math id="M74" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mtext mathvariant="normal">d</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>) and the subthreshold voltage dynamics (i.e., <italic>ϵ</italic><sub>V</sub>) could be used for online monitoring and quality control, possibly allowing for automated detection of experimental problems. Online characterization and identification of neurons may also prove useful in more detailed high-throughput characterization of neuronal cell types currently being set up in the context of several large-scale brain initiatives as this would allow for <italic>on the fly</italic> implementation of cell-specific stimulus sets. Similarly, online identification could be useful in manual patch-clamp experiments whose aim is not to perform high-throughput single-neuron characterization, but is to study other neuronal properties (e.g., the dynamics of specific ion-channels under pharmacology, the effect of neuromodulators on the response properties of neurons, connectivity, short-term and spike-timing dependent plasticity). These experiments generally start with a brief set of current injections (e.g., current-steps) aimed at identifying some basic features of the neuronal dynamics (e.g., passive membrane properties, firing patterns). Given its short duration and its limited requirements in terms of computing power, our protocol could provide an alternative in these situations.</p>
<p>To allow for a comparison, both <italic>in silico</italic> and <italic>in vitro</italic> recordings were also fitted with a GLM [<xref ref-type="bibr" rid="pcbi.1004275.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref036">36</xref>]. Despite the fact that GLMs are more flexible than GIF models, we found that, in terms of mere spike timing prediction, the two models achieved similar performance (Figs <xref ref-type="fig" rid="pcbi.1004275.g006">6</xref> and <xref ref-type="fig" rid="pcbi.1004275.g009">9</xref>). This result can be understood by noting that the <italic>nonparametric</italic> filter <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) extracted with the GLM fitting procedure is well approximated by the exponential filter <italic>κ</italic>(<italic>t</italic>) of the GIF model. GLMs are typically considered as statistical models for spike trains and their parameters are only loosely related to biophysical cell properties. The reason for this is that GLM parameter extraction entirely relies on the likelihood maximization of the spiking data. If on one hand this fact constitutes a big advantage in case of (multi-electrode) extracellular recordings [<xref ref-type="bibr" rid="pcbi.1004275.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref036">36</xref>], the standard GLM framework is less appropriate for whole-cell current-clamp data. In contrast to GIF models, GLMs do not explicitly model the membrane potential dynamics, do not exploit all the information available in intracellular recordings and, consequently, are unable to predict the subthreshold activity of single neurons. Moreover, compared to GLMs, we found that parameter extraction for GIF models is faster.</p>
<p>A voltage-dependent plasticity rule has recently been proposed [<xref ref-type="bibr" rid="pcbi.1004275.ref057">57</xref>] in which the subthreshold dynamics of the membrane potential plays a crucial role in explaining a large variety of experimental results obtained using different induction protocols for long-term potentiation (or depression). Among others, this finding highlights the need of spiking neuron models that accurately capture the subthreshold membrane potential dynamics. The GIF model accounts for spike-dependent adaptation using two distinct filters: a spike-triggered current <italic>η</italic>(<italic>t</italic>) and a spike-triggered movement of the firing threshold <italic>γ</italic>(<italic>t</italic>). At first glance, having two spike-dependent processes might seem redundant and unnecessary. However, while the firing threshold only affects spike probability, adaptation currents also alter the dynamics of the subthreshold membrane potential. This explains why the correct distinction between these two forms of adaptation is key to correctly predict the subthreshold response of single neurons. Supporting this claim, a reduced GIF model, in which the two processes mediating spike-frequency adaptation are combined into a single effective filter <italic>h</italic>(<italic>t</italic>) (<xref ref-type="disp-formula" rid="pcbi.1004275.e052">Eq 7</xref>), has been shown to systematically overestimate the membrane potential [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>].</p>
<p>Since GLM parameter extraction entirely relies on spiking data (see <xref ref-type="sec" rid="sec011">Materials and Methods</xref>), the linear filter <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) also includes the effects of all biophysical processes that affect spike emission without altering the subthreshold membrane potential. In particular, the filter <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>), but not the filter <italic>κ</italic>(<italic>t</italic>) of the GIF model, is expected to capture a potential coupling between subthreshold voltage and firing threshold [<xref ref-type="bibr" rid="pcbi.1004275.ref058">58</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref059">59</xref>]. Possibly explaining the difference we found between <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) and <italic>κ</italic>(<italic>t</italic>) (<xref ref-type="fig" rid="pcbi.1004275.g008">Fig 8F</xref>), both direct [<xref ref-type="bibr" rid="pcbi.1004275.ref060">60</xref>] and indirect [<xref ref-type="bibr" rid="pcbi.1004275.ref052">52</xref>] experimental evidence has been provided that such a coupling exists in cortical pyramidal neurons. Extending the GIF model to account for a coupling between membrane potential and firing threshold is beyond the scope of this study and will be presented in a separate publication. It is however worth noting that the threshold equation of the GIF model can be easily augmented as follows:
<disp-formula id="pcbi.1004275.e075"><alternatives><graphic id="pcbi.1004275.e075g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e075"/><mml:math id="M75" display="block" overflow="scroll"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mi>T</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>+</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mtext>j</mml:mtext></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mtext>last</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mi>t</mml:mi></mml:munderover><mml:msub><mml:mi>κ</mml:mi><mml:mi>θ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>-</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
with <italic>κ</italic><sub><italic>θ</italic></sub>(<italic>t</italic>) being an arbitrarily shaped filter that, with a straightforward extension of the maximum likelihood method used in Step 3 (see <xref ref-type="fig" rid="pcbi.1004275.g002">Fig 2</xref>, <italic>Step 3</italic>), could be extracted from intracellular recordings.</p>
<p>In contrast to the GIF model, popular point-neuron models like the adaptive exponential integrate-and-fire (ADEX, [<xref ref-type="bibr" rid="pcbi.1004275.ref061">61</xref>]) or the adaptive quadratic integrate-and-fire (AQIF, [<xref ref-type="bibr" rid="pcbi.1004275.ref062">62</xref>]) feature a subthreshold adaptation current <italic>w</italic>(<italic>t</italic>) governed by the following differential equation
<disp-formula id="pcbi.1004275.e076"><alternatives><graphic id="pcbi.1004275.e076g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e076"/><mml:math id="M76" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>τ</mml:mi> <mml:mi>w</mml:mi></mml:msub> <mml:mover accent="true"><mml:mi>w</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mi>w</mml:mi> <mml:mo>+</mml:mo> <mml:mi>a</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>V</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula></p>
<p>Extending the GIF model with <xref ref-type="disp-formula" rid="pcbi.1004275.e076">Eq 10</xref> would relax the assumption of having a single exponential membrane filter <italic>κ</italic>(<italic>t</italic>) and, depending on the parameter choice, the subthreshold dynamics of the resulting model could account for two-timescale decay or resonance [<xref ref-type="bibr" rid="pcbi.1004275.ref030">30</xref>]. In ADEX and the AQIF model, this current has been shown to play an important role in explaining the variety of firing patterns emitted by single neurons in response to a step of current [<xref ref-type="bibr" rid="pcbi.1004275.ref063">63</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref064">64</xref>]. In the GIF model, the lack of subthreshold adaptation is, at least partially, compensated by the fact that the spike-triggered current is not assumed to be exponential, but can have an arbitrary shape. For example, the GIF model can capture the <italic>resonate-and-fire</italic> behavior by means of a biphasic spike-triggered current. Such a current hyperpolarizes the membrane during the first milliseconds and then rapidly becomes positive, thereby favoring the emission of spikes with a particular interspike interval [<xref ref-type="bibr" rid="pcbi.1004275.ref037">37</xref>]. Our results suggest that, while increasing the complexity, extending a GIF model with a subthreshold current <italic>w</italic>(<italic>t</italic>) does not significantly improve the model’s performance in predicting the activity of the three main neuronal types of the mouse barrel cortex [<xref ref-type="bibr" rid="pcbi.1004275.ref030">30</xref>]. However, this might not hold true for neurons in other brain regions or in the case of more sophisticated stimulation paradigms. Performing parameter extraction with a GIF model extended with <xref ref-type="disp-formula" rid="pcbi.1004275.e076">Eq 10</xref> is possible. Once the timescale <italic>τ</italic><sub><italic>w</italic></sub> is known, performing a least-square regression similar to <xref ref-type="disp-formula" rid="pcbi.1004275.e093">Eq 17</xref> is indeed sufficient to recover all the other parameters. Extended GIF model parameter extraction can therefore be performed by iterating on <italic>τ</italic><sub><italic>w</italic></sub> and looking for the timescale that minimizes the sum of squared errors on the voltage derivative. Since line-search (i.e., brute-force) algorithms can be efficiently executed using parallel computing, extending a GIF model with a subthreshold adaptation current does not necessarily imply a dramatic increase of the CPU time required for parameter extraction.</p>
<p>In the field of computational neuroscience, the last years have been characterized by the announcements of several large-scale projects aimed to build realistic models of the electrical activity of entire brains [<xref ref-type="bibr" rid="pcbi.1004275.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref065">65</xref>–<xref ref-type="bibr" rid="pcbi.1004275.ref067">67</xref>]. To achieve this ambitious goal, it is of crucial importance to characterize and model the diversity amongst the brain’s fundamental building blocks: the single neurons. Here, we demonstrate that, if combined with automatic patch-clamp recordings, a fitting technique for GIF models, which we recently introduced [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref037">37</xref>], can be used to build a pipeline for high-throughput single-neuron characterization and modeling.</p>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec012">
<title>Ethics Statement</title>
<p>All procedures in this study were conducted in conformity with the Swiss Welfare Act and the Swiss National Institutional Guidelines on Animal Experimentation for the ethical use of animals. The Swiss Cantonal Veterinary Office approved the project following an ethical review by the State Committee for Animal Experimentation.</p>
</sec>
<sec id="sec013">
<title>Electrophysiological recordings</title>
<p><italic>In vitro</italic> electrophysiological recordings were performed on 300 <italic>μ</italic>m thick parasagittal acute slices from the right hemispheres of male P13–15 C57Bl/6J mouse brains, which were quickly dissected and sliced (HR2 vibratome, Sigmann Elektronik, Germany) in ice-cold artificial cerebrospinal fluid (ACSF) (in mM: NaCl 124, KCl 2.5, MgCl<sub>2</sub> 10, NaH<sub>2</sub>PO<sub>4</sub> 1.25, CaCl<sub>2</sub> 0.5, D-(+)-Glucose 25, NaHC0<sub>3</sub> 25; pH 7.3, s.d. 0.1, aerated with 95% O<sub>2</sub>, 5% CO<sub>2</sub>), followed by a 15 minute incubation at 34°C in standard ACSF (in mM: NaCl 124, KCl 2.5, MgCl<sub>2</sub> 1, NaH<sub>2</sub>PO<sub>4</sub> 1.25, CaCl<sub>2</sub> 2, D-(+)-Glucose 25, NaHC0<sub>3</sub> 25; pH 7.4, aerated with 95% O<sub>2</sub>, 5% CO<sub>2</sub>), equally used as bath solution. Cells were visualized using infrared differential interference contrast video microscopy (VX55 camera, Till Photonics, Germany and BX51WI microscope, Olympus, Japan). Somatic whole-cell current clamp recordings of layer 5 pyramidal cells in the primary somatosensory cortex were performed at 32, s.d. 1°C with an Axon Multiclamp 700B Amplifier (Molecular Devices, USA) using 6.5–7.5 MΩ borosilicate pipettes, containing (in mM): K<sup>+</sup>–gluconate 110, KCl 10, ATP–Mg<sup>2+</sup> 4, <inline-formula id="pcbi.1004275.e077"><mml:math id="M77" overflow="scroll"><mml:mrow><mml:msubsup><mml:mtext mathvariant="normal">Na</mml:mtext> <mml:mn>2</mml:mn> <mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>–phosphocreatine 10, GTP–Na<sup>+</sup> 0.3, HEPES 10, biocytin 5 mg/ml; pH 7.3, 300 mOsm). To ensure intact axonal and dendritic arborisation, recordings were conducted in slices cut parallel to the apical dendrites.</p>
<p>Data were acquired at Δ<italic>T</italic> <sup>−1</sup> = 20 kHz using an ITC-18 digitising board (InstruTECH, USA) controlled by a custom-written software module operating within IGOR Pro (Wavemetrics, USA). Voltage signals were low-pass filtered (Bessel, 10 kHz) and not corrected for the liquid junction potential. Only cells with an access resistance &lt; 25MΩ (20.2, s.d. 3.2 MΩ, <italic>n</italic> = 10), which was compensated throughout the recording, and a drift in the resting membrane potential &lt; 2.5 mV (1.2 mV, s.d. 0.8 mV, <italic>n</italic> = 10) between the start and the end of the recording were retained for further analysis.</p>
</sec>
<sec id="sec014">
<title><italic>In silico</italic> recordings: multi-compartmental model simulations</title>
<p><italic>In silico</italic> recordings were performed by simulating a multi-compartmental model of aN L5b pyramidal neuron [<xref ref-type="bibr" rid="pcbi.1004275.ref014">14</xref>]. The model was obtained from Model DB (accession number 139653) and all simulations were performed in Neuron [<xref ref-type="bibr" rid="pcbi.1004275.ref068">68</xref>]. Similar to the <italic>in vitro</italic> experiments, input currents <italic>I</italic>(<italic>t</italic>) were generated according to Eqs <xref ref-type="disp-formula" rid="pcbi.1004275.e042">5</xref>–<xref ref-type="disp-formula" rid="pcbi.1004275.e043">6</xref> (with sampling frequency Δ<italic>T</italic> <sup>−1</sup> = 20 kHz) and were delivered at the somatic compartment. To obtain an average firing rate fluctuating between 7 and 13 Hz, the input parameters were set to <italic>I</italic><sub>0</sub> = 520 pA, <italic>σ</italic><sub>0</sub> = 320 pA and Δ<italic>σ</italic> = 0.5. To reproduce spike timing variability between responses to repetitive injections of the same current <italic>I</italic>(<italic>t</italic>), a source of noise was included in the model by adding a zero-mean white-noise signal <italic>ξ</italic><sub>w.n.</sub>(<italic>t</italic>) to <italic>I</italic>(<italic>t</italic>). In order to capture the autocorrelation function between spike trains recorded <italic>in vitro</italic> in response to different repetitions of the test set current, the magnitude of the noise was set to <inline-formula id="pcbi.1004275.e078"><mml:math id="M78" overflow="scroll"><mml:mrow><mml:msqrt><mml:mrow><mml:mo>〈</mml:mo><mml:msub><mml:mi>ξ</mml:mi><mml:mrow><mml:mtext>w</mml:mtext><mml:mo>.</mml:mo><mml:mtext>n</mml:mtext><mml:mo>.</mml:mo></mml:mrow></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>〉</mml:mo></mml:mrow></mml:msqrt><mml:mo>=</mml:mo></mml:mrow></mml:math></inline-formula> 160 pA. The same amount of noise was also used to generate the training dataset. GIF model and GLM parameter extraction were performed by treating the noise current <italic>ξ</italic><sub>w.n.</sub>(<italic>t</italic>) as being unknown.</p>
</sec>
<sec id="sec015">
<title>Data preprocessing: Active Electrode Compensation</title>
<p>All the <italic>in vitro</italic> recordings included in this study were preprocessed using AEC [<xref ref-type="bibr" rid="pcbi.1004275.ref032">32</xref>] according to the following four-step procedure [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref033">33</xref>].</p>
<p><bold>Step 1</bold>: Shortly before the acquisition of the <italic>training dataset</italic> (see <xref ref-type="fig" rid="pcbi.1004275.g004">Fig 4</xref>), we recorded the intracellular response <italic>V</italic><sub>sub</sub>(<italic>t</italic>) evoked by the injection of a short subthreshold current <italic>I</italic><sub>sub</sub>(<italic>t</italic>). The input was generated according to <xref ref-type="disp-formula" rid="pcbi.1004275.e042">Eq 5</xref> with parameters <italic>I</italic><sub>0</sub> = 0 pA, <italic>σ</italic>(<italic>t</italic>) = 75 pA and <italic>τ</italic> = 3 ms and evoked small-amplitude subthreshold fluctuations around the resting potential. With this parameter choice, the standard deviation of <italic>V</italic><sub>sub</sub>(<italic>t</italic>) was around 2–3 mV.</p>
<p><bold>Step 2</bold>: We then estimated the optimal linear filter <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) between the subthreshold input <italic>I</italic><sub>sub</sub>(<italic>t</italic>) and the recorded signal <italic>V</italic><sub>sub</sub>(<italic>t</italic>) (<xref ref-type="fig" rid="pcbi.1004275.g007">Fig 7B</xref>). To reduce computing time, <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) was defined over a finite interval [0,200ms] as
<disp-formula id="pcbi.1004275.e079"><alternatives><graphic id="pcbi.1004275.e079g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e079"/><mml:math id="M79" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mtext>opt</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>M</mml:mi></mml:munderover> <mml:msub><mml:mi>b</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:msup><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
with {<italic>f</italic><sup>(<italic>m</italic>)</sup>(<italic>t</italic>)} being a set of M = 202 rectangular basis functions of linearly increasing width. The parameters <italic>b</italic> = [<italic>b</italic><sub>1</sub>, …, <italic>b</italic><sub><italic>M</italic></sub>] determining the shape of <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) were then estimated by solving the following multilinear regression:
<disp-formula id="pcbi.1004275.e080"><alternatives><graphic id="pcbi.1004275.e080g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e080"/><mml:math id="M80" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>b</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>Z</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mi>Z</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mi>Z</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mi>V</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where, using the discrete-time notation <italic>x</italic><sub><italic>t</italic></sub> = <italic>x</italic>(<italic>t</italic> · Δ<italic>T</italic>) and by removing the subscripts <italic>sub</italic> for clarity, <italic>V</italic> is a vector whose <italic>t</italic>-th element is given by the membrane potential <italic>V</italic><sub><italic>t</italic></sub> = <italic>V</italic>(<italic>t</italic>Δ<italic>T</italic>) and <italic>Z</italic> is a matrix made of vectors <inline-formula id="pcbi.1004275.e081"><mml:math id="M81" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> defined as:
<disp-formula id="pcbi.1004275.e082"><alternatives><graphic id="pcbi.1004275.e082g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e082"/><mml:math id="M82" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>z</mml:mi> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mspace width="4.pt"/><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:munderover> <mml:msubsup><mml:mi>f</mml:mi> <mml:mtext>s</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mo>…</mml:mo> <mml:mspace width="4.pt"/><mml:mo>,</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mi>t</mml:mi></mml:munderover> <mml:msubsup><mml:mi>f</mml:mi> <mml:mtext>s</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>M</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>I</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi></mml:mrow></mml:msub> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi> <mml:mspace width="4.pt"/><mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
with <italic>I</italic><sub><italic>t</italic></sub> = <italic>I</italic>(<italic>t</italic>Δ<italic>T</italic>).</p>
<p><bold>Step 3</bold>: An exponential function <italic>f</italic>(<italic>t</italic>;<italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>) = <italic>a</italic><sub>1</sub>exp(−<italic>t</italic>/<italic>a</italic><sub>2</sub>) was then fitted to the tail of <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) by minimizing the error <inline-formula id="pcbi.1004275.e083"><mml:math id="M83" overflow="scroll"><mml:mrow><mml:mi>E</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext mathvariant="normal">min</mml:mtext></mml:msub> <mml:mo>∞</mml:mo></mml:msubsup> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mtext mathvariant="normal">opt</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>s</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:mi>f</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>;</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:math></inline-formula> (<xref ref-type="fig" rid="pcbi.1004275.g007">Fig 7B</xref>). In AEC, the electrode is assumed to operate on fast timescales (&lt; 1 ms) and the slow decay in <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) is attributed to the cell. For this reason the fit was performed with <italic>T</italic><sub>min</sub> = 5 ms, and the electrode filter was estimated as
<disp-formula id="pcbi.1004275.e084"><alternatives><graphic id="pcbi.1004275.e084g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e084"/><mml:math id="M84" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>κ</mml:mi> <mml:mtext>e</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>κ</mml:mi> <mml:mtext>opt</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>;</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
with <inline-formula id="pcbi.1004275.e085"><mml:math id="M85" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> and <inline-formula id="pcbi.1004275.e086"><mml:math id="M86" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>a</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> being the optimal parameters minimizing <italic>E</italic>(<italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>). To improve accuracy, Steps 2 and 3 were repeated 15 times by resampling from the available data and the final electrode filter used for AEC was obtained by averaging the results across repetitions (<xref ref-type="fig" rid="pcbi.1004275.g007">Fig 7C</xref>). Alternatively, the electrode filter <italic>κ</italic><sub>e</sub>(<italic>t</italic>) can be extracted from <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) by considering that also the net current flowing through the cell membrane is affected by the electrode properties (see ref. [<xref ref-type="bibr" rid="pcbi.1004275.ref032">32</xref>]).</p>
<p><bold>Step 4</bold>: Finally, for all subsequent current-clamp injections, the membrane potential <italic>V</italic><sub>data</sub>(<italic>t</italic>) was estimated as follows (Fig <xref ref-type="fig" rid="pcbi.1004275.g007">7A</xref> and <xref ref-type="fig" rid="pcbi.1004275.g007">7D</xref>):
<disp-formula id="pcbi.1004275.e087"><alternatives><graphic id="pcbi.1004275.e087g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e087"/><mml:math id="M87" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mtext>data</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>rec</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>∞</mml:mi></mml:msubsup> <mml:msub><mml:mi>κ</mml:mi> <mml:mtext>e</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>I</mml:mi> <mml:mtext>ext</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
where <italic>I</italic><sub>ext</sub>(<italic>t</italic>) is the injected current, <italic>V</italic><sub>rec</sub>(<italic>t</italic>) is the recorded signal and the convolution integral on the right-hand side of <xref ref-type="disp-formula" rid="pcbi.1004275.e087">Eq 15</xref> approximates the voltage drop <italic>V</italic><sub>e</sub>(<italic>t</italic>) across the electrode.</p>
<p>Expanding <italic>κ</italic><sub>opt</sub>(<italic>t</italic>) in rectangular basis functions drastically reduces the computing time required in Step 2. Overall, Steps 1–3 were performed in around 62 seconds and can in principle be executed while the <italic>training set</italic> is being acquired. Step 4 requires less than 1 second and can be performed after training set collection without compromising high-throughput (<xref ref-type="fig" rid="pcbi.1004275.g004">Fig 4</xref>). Since in our protocol model validation only relies on spike-timing prediction, AEC only has to be applied to the training dataset. Here, in order to asses the prediction error on the subthreshold membrane potential, we also performed AEC on all test set recordings. In order to evaluate the quality of the recordings, our protocol for high-throughput single-neuron characterization (<xref ref-type="fig" rid="pcbi.1004275.g004">Fig 4</xref>) could in principle be extended by repeating Steps 1–3 after complete acquisition of the <italic>test set</italic>. These additional data could indeed be used to verify whether the electrode properties (i.e., the access resistance, the electrode timescale and, more generally, the electrode filter <italic>κ</italic><sub>e</sub>(<italic>t</italic>)) were satisfactory and sufficiently stable during the experiment (see ref. [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>]).</p>
</sec>
<sec id="sec016">
<title>GIF model parameter extraction</title>
<p>Given the intracellular membrane potential <italic>V</italic><sub>data</sub>(<italic>t</italic>) measured at a sampling frequency Δ<italic>T</italic> <sup>−1</sup> in response to a known input current <italic>I</italic><sub>tr</sub>(<italic>t</italic>), as well as the spike times <inline-formula id="pcbi.1004275.e088"><mml:math id="M88" overflow="scroll"><mml:mrow><mml:mo stretchy="false">{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> defined as instants at which <italic>V</italic><sub>data</sub>(<italic>t</italic>) crosses 0 mV from below, all the GIF model parameters are extracted following a three-step procedure [<xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref037">37</xref>] (<xref ref-type="fig" rid="pcbi.1004275.g002">Fig 2</xref>).</p>
<p><bold>Step 1</bold>: The absolute refractory period <italic>T</italic><sub>ref</sub> is fixed to an arbitrary value and the voltage reset is estimated by the average membrane potential recorded <italic>T</italic><sub>ref</sub> milliseconds after a spike <inline-formula id="pcbi.1004275.e089"><mml:math id="M89" overflow="scroll"><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mtext>reset</mml:mtext></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo> <mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mrow><mml:mtext>data</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mtext>ref</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula>. Since absolute refractoriness can be captured by a spike-triggered movement of the firing threshold, the particular choice of <italic>T</italic><sub>ref</sub> is not crucial and the only constraint is given by the shortest interspike interval in the dataset. Here, for L5 pyramidal neurons, we set the refractory period to <italic>T</italic><sub>ref</sub> = 4 ms.</p>
<p><bold>Step 2</bold>: The parameters determining the subthreshold dynamics of the membrane potential are extracted. To allow convex optimization, the spike-triggered current <italic>η</italic>(<italic>t</italic>) is expanded as a linear combination of basis functions [<xref ref-type="bibr" rid="pcbi.1004275.ref022">22</xref>]:
<disp-formula id="pcbi.1004275.e090"><alternatives><graphic id="pcbi.1004275.e090g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e090"/><mml:math id="M90" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>K</mml:mi></mml:munderover> <mml:msub><mml:mi>η</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msup><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(16)</label></disp-formula>
where {<italic>η</italic><sub><italic>k</italic></sub>} is a set of parameters controlling the time course of <italic>η</italic>(<italic>t</italic>). The parameters <inline-formula id="pcbi.1004275.e091"><mml:math id="M91" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mtext mathvariant="normal">sub</mml:mtext> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mi>C</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>·</mml:mo> <mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mi>g</mml:mi> <mml:mtext mathvariant="normal">L</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>E</mml:mi> <mml:mtext mathvariant="normal">L</mml:mtext></mml:msub> <mml:msub><mml:mi>g</mml:mi> <mml:mtext mathvariant="normal">L</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>η</mml:mi> <mml:mi>K</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> are then extracted by minimizing the sum of squared errors between the observed voltage derivative <inline-formula id="pcbi.1004275.e092"><mml:math id="M92" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> and that of the model (i.e., <xref ref-type="disp-formula" rid="pcbi.1004275.e002">Eq 1</xref>). Since all subthreshold parameters <italic>θ</italic><sub>sub</sub> act linearly on the observables, this optimization problem can be efficiently solved by computing the following multilinear regression [<xref ref-type="bibr" rid="pcbi.1004275.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref022">22</xref>]:
<disp-formula id="pcbi.1004275.e093"><alternatives><graphic id="pcbi.1004275.e093g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e093"/><mml:math id="M93" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>sub</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>X</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mi>X</mml:mi> <mml:mi>T</mml:mi></mml:msup> <mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˙</mml:mo></mml:mover> <mml:mtext>data</mml:mtext></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where <italic>X</italic> is a matrix whose rows are given by the vectors
<disp-formula id="pcbi.1004275.e094"><alternatives><graphic id="pcbi.1004275.e094g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e094"/><mml:math id="M94" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext>data</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msup><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mo>…</mml:mo> <mml:mspace width="4.pt"/><mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msup><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>K</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
and <inline-formula id="pcbi.1004275.e095"><mml:math id="M95" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula> is a column-vector containing the voltage first-order derivative estimated by finite differences <inline-formula id="pcbi.1004275.e096"><mml:math id="M96" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mrow><mml:mo stretchy="true">(</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="true">)</mml:mo></mml:mrow> <mml:mo>/</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:math></inline-formula>. Since the GIF model does not capture the subthreshold dynamics during spike initiation, all the data points close to action potentials <inline-formula id="pcbi.1004275.e097"><mml:math id="M97" overflow="scroll"><mml:mrow><mml:mo stretchy="false">{</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">∣</mml:mo> <mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:mn>5</mml:mn> <mml:mtext mathvariant="normal">ms</mml:mtext> <mml:mo>;</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext mathvariant="normal">ref</mml:mtext></mml:msub> <mml:mo stretchy="false">]</mml:mo> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> are excluded from the regression.</p>
<p>In principle, the residuals of this multilinear regression could provide some additional information about the quality of the recordings and could therefore be used for online quality control. This is true especially in cases where a large number of experiments are repeated in similar cell types and under similar conditions. In such a situation, one can indeed evaluate the results with respect to the distribution of errors obtained in previous experiments. Although the magnitude of high-frequency noise in patch-clamp recordings is generally low, this metric might however depend on the experimental sampling frequency. Overall, to limit the impact of high-frequency noise, it is generally safer to assess the model performance by computing the residuals on <italic>V</italic><sub>data</sub> (c.f., <xref ref-type="disp-formula" rid="pcbi.1004275.e139">Eq 27</xref>), rather than on <inline-formula id="pcbi.1004275.e098"><mml:math id="M98" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>.</mml:mo></mml:mover> <mml:mtext mathvariant="normal">data</mml:mtext></mml:msub></mml:mrow></mml:math></inline-formula>.</p>
<p><bold>Step 3</bold>: The parameters defining the dynamics of the firing threshold are extracted. To determine the functional shape of the spike-triggered movement of the firing threshold, we first expand <italic>γ</italic>(<italic>t</italic>) as a sum of basis functions:
<disp-formula id="pcbi.1004275.e099"><alternatives><graphic id="pcbi.1004275.e099g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e099"/><mml:math id="M99" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>P</mml:mi></mml:munderover> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:msup><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula></p>
<p>Given the parameters obtained in the first two steps and the spike times observed in the experiment, the subthreshold membrane potential <inline-formula id="pcbi.1004275.e100"><mml:math id="M100" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="normal">model</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is then computed by numerical integration of <xref ref-type="disp-formula" rid="pcbi.1004275.e002">Eq 1</xref>. Without loss of flexibility, the parameter <italic>λ</italic><sub>0</sub> is fixed to 1 Hz and all threshold parameters <inline-formula id="pcbi.1004275.e101"><mml:math id="M101" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>θ</mml:mi> <mml:mtext mathvariant="normal">th</mml:mtext> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>Δ</mml:mo> <mml:msup><mml:mi>V</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>·</mml:mo> <mml:mo stretchy="false">[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mtext mathvariant="normal">T</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>P</mml:mi></mml:msub> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> are finally extracted by maximizing the log-likelihood of the experimental spike-train [<xref ref-type="bibr" rid="pcbi.1004275.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref069">69</xref>]:
<disp-formula id="pcbi.1004275.e102"><alternatives><graphic id="pcbi.1004275.e102g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e102"/><mml:math id="M102" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix">argmax</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mtext>th</mml:mtext></mml:msub></mml:munder> <mml:mo>{</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi>θ</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>T</mml:mi> <mml:mo>·</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>Ω</mml:mi></mml:mrow></mml:munder> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:msub><mml:mi>θ</mml:mi> <mml:mtext>th</mml:mtext></mml:msub> <mml:mo>)</mml:mo> <mml:mo>}</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
where <inline-formula id="pcbi.1004275.e103"><mml:math id="M103" overflow="scroll"><mml:mrow><mml:mo>Ω</mml:mo> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">∣</mml:mo> <mml:mi>t</mml:mi> <mml:mo>∉</mml:mo> <mml:mo stretchy="false">[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext mathvariant="normal">ref</mml:mtext></mml:msub><mml:mspace width="1pt"/> <mml:mo stretchy="false">]</mml:mo> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> is a set that excludes all the data points falling in the absolute refractory periods and the vectors <inline-formula id="pcbi.1004275.e104"><mml:math id="M104" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></inline-formula> are defined as
<disp-formula id="pcbi.1004275.e105"><alternatives><graphic id="pcbi.1004275.e105g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e105"/><mml:math id="M105" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>y</mml:mi> <mml:mi>t</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext>model</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msup><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4.pt"/><mml:mo>…</mml:mo> <mml:mspace width="4.pt"/><mml:mo>,</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msup><mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>ref</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula></p>
<p>With the exponential function in <xref ref-type="disp-formula" rid="pcbi.1004275.e007">Eq 2</xref>, the log-likelihood to maximize is a convex function of <italic>θ</italic><sub>th</sub>[<xref ref-type="bibr" rid="pcbi.1004275.ref041">41</xref>] and both its gradient and Hessian can be computed analytically. Consequently, the optimization problem of <xref ref-type="disp-formula" rid="pcbi.1004275.e102">Eq 20</xref> can be efficiently solved using the Newton-Raphson (gradient ascent) method. Alternatively, Step 3 can be performed using the recorded potential <italic>V</italic><sub>data</sub>(<italic>t</italic>) instead of <inline-formula id="pcbi.1004275.e106"><mml:math id="M106" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="normal">model</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1004275.e105">Eq 21</xref>. Since small inaccuracies in Step 2 can be compensated in <italic>Step 3</italic>, performing the fit using <inline-formula id="pcbi.1004275.e107"><mml:math id="M107" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="normal">model</mml:mtext></mml:msub> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> generally improves spike-timing prediction.</p>
<p>In order to avoid numerical problems resulting from the inappropriate choice of the initial condition <italic>θ</italic><sub>th,0</sub> used in Step 3, it is convenient to first find the optimal threshold parameters <inline-formula id="pcbi.1004275.e108"><mml:math id="M108" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="normal">T</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="pcbi.1004275.e109"><mml:math id="M109" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>V</mml:mi></mml:mrow> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> of a reduced GIF model in which the firing threshold is constant (i.e., <inline-formula id="pcbi.1004275.e110"><mml:math id="M110" overflow="scroll"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mtext mathvariant="normal">T</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mtext mathvariant="normal">T</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>). For that, a first gradient ascent is performed with initial conditions Δ<italic>V</italic><sub>0</sub> = 50 mV and <inline-formula id="pcbi.1004275.e111"><mml:math id="M111" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>T</mml:mi> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:mo>Δ</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>·</mml:mo> <mml:mtext>log</mml:mtext><mml:mspace width="4.pt"/> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>‾</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula>, where <inline-formula id="pcbi.1004275.e112"><mml:math id="M112" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>‾</mml:mo></mml:mover></mml:mrow></mml:math></inline-formula> denotes the average firing rate in the data. Then, a second gradient ascent is performed on the log-likelihood of the full model using <inline-formula id="pcbi.1004275.e113"><mml:math id="M113" overflow="scroll"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mtext mathvariant="normal">th,0</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mover accent="true"><mml:mrow><mml:mo>Δ</mml:mo> <mml:mi>V</mml:mi></mml:mrow> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>·</mml:mo> <mml:mo stretchy="false">[</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mtext mathvariant="normal">T</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:math></inline-formula> as initial condition.</p>
</sec>
<sec id="sec017">
<title>Generalized Linear Model</title>
<p>All GIF model performance included in this study are compared against the ones of a standard GLM [<xref ref-type="bibr" rid="pcbi.1004275.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref036">36</xref>]. In the GLM, spikes are emitted stochastically according to the following conditional intensity
<disp-formula id="pcbi.1004275.e114"><alternatives><graphic id="pcbi.1004275.e114g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e114"/><mml:math id="M114" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mrow><mml:mtext>GLM</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:mi>I</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>λ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>·</mml:mo><mml:mtext>exp</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>E</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:munderover><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∫</mml:mo></mml:mstyle><mml:mn>0</mml:mn><mml:mi>t</mml:mi></mml:munderover><mml:msub><mml:mi>κ</mml:mi><mml:mrow><mml:mtext>GLM</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>s</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>I</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:mi>s</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi><mml:mo>+</mml:mo><mml:munder><mml:mstyle mathsize="140%" displaystyle="true"><mml:mo>∑</mml:mo></mml:mstyle><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mi>t</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>h</mml:mi><mml:mrow><mml:mtext>GLM</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(22)</label></disp-formula>
with <italic>λ</italic><sub>0</sub> = 1 Hz. In the GLM, the linear filter <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) is not assumed to be exponential but is extracted from experimental data through linear expansion in rectangular basis functions. Moreover, the GLM accounts for spike-history effects with a unique filter <italic>h</italic><sub>GLM</sub>(<italic>t</italic>). The GLM also differs from the GIF model because it has neither an absolute refractory period nor an explicit reset after the emission of a spike. To obtain a fair comparison between the two models, the filter <italic>h</italic><sub>GLM</sub>(<italic>t</italic>) was expanded using the same basis functions as used for <italic>γ</italic>(<italic>t</italic>) in the GIF and the number of basis functions used for <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>) was such that, in total, the two models had the same number of parameters. Given the input current <italic>I</italic>(<italic>t</italic>) and the observed spike train <italic>S</italic><sub>data</sub>(<italic>t</italic>), GLM parameters <italic>θ</italic><sub>GLM</sub> = {<italic>E</italic><sub>0</sub>, <italic>κ</italic><sub>GLM</sub>(<italic>t</italic>), <italic>h</italic><sub>GLM</sub>(<italic>t</italic>)} were extracted with standard methods [<xref ref-type="bibr" rid="pcbi.1004275.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref036">36</xref>] by maximizing the model log-likelihood <italic>L</italic>(<italic>θ</italic><sub>GLM</sub>) = log<italic>p</italic>(<italic>S</italic><sub>data</sub>∣<italic>I</italic>, <italic>θ</italic><sub>GLM</sub>) using <inline-formula id="pcbi.1004275.e115"><mml:math id="M115" overflow="scroll"><mml:mrow><mml:msub><mml:mi>θ</mml:mi> <mml:mtext mathvariant="normal">GLM,0</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mo stretchy="false">{</mml:mo> <mml:mtext>log</mml:mtext> <mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>‾</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>0</mml:mn> <mml:mo stretchy="false">}</mml:mo></mml:mrow></mml:math></inline-formula> as initial condition. Importantly, the GLM fitting procedure does not exploit the information available in the subthreshold membrane potential fluctuations and all of its parameters are extracted using the maximum likelihood approach. This explains why fitting a GLM requires more CPU time than fitting a GIF model.</p>
</sec>
<sec id="sec018">
<title>Similarity measure <inline-formula id="pcbi.1004275.e116"><mml:math id="M116" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> between sets of spike trains</title>
<p>To quantify the model performance in predicting spikes, we used the normalized, bias-corrected metrics <inline-formula id="pcbi.1004275.e117"><mml:math id="M117" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> [<xref ref-type="bibr" rid="pcbi.1004275.ref034">34</xref>]. <inline-formula id="pcbi.1004275.e118"><mml:math id="M118" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> relies on a measure of the distance between the experimental and the predicted spike-emission probability, which are in turn inferred from the responses to a limited number of repetitive current injections. Importantly, <inline-formula id="pcbi.1004275.e119"><mml:math id="M119" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> resolves the <italic>small sample</italic> bias known to affect most of the similarity measures when the number of available spike trains is small. Also, in contrast to previous measures based on naive pairwise comparisons (e.g., the Γ coincidence factor used in ref. [<xref ref-type="bibr" rid="pcbi.1004275.ref070">70</xref>]), <inline-formula id="pcbi.1004275.e120"><mml:math id="M120" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> does not suffer from the so-called <italic>deterministic bias</italic> known to favor noise-free models and is therefore well suited for the evaluation of stochastic spiking models [<xref ref-type="bibr" rid="pcbi.1004275.ref034">34</xref>]. Moreover, in contrast to many other correlation-based measures, <inline-formula id="pcbi.1004275.e121"><mml:math id="M121" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is sensitive to the accuracy with which both the shape and the amplitude of the spike probability is predicted.</p>
<p>Given a small set of experimental spiketrains <inline-formula id="pcbi.1004275.e122"><mml:math id="M122" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi> <mml:mtext mathvariant="normal">(d)</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>f</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>f</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> recorded in response to <italic>N</italic><sub>d</sub> repetitive injections <italic>i</italic> = 1, …, <italic>N</italic><sub>d</sub> of the same input current <italic>I</italic><sub>test</sub>(<italic>t</italic>), as well as a large set of spike trains <inline-formula id="pcbi.1004275.e123"><mml:math id="M123" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mtext mathvariant="normal">(m)</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>f</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>t</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>f</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> predicted by <italic>N</italic><sub>m</sub> repetitive simulations <italic>j</italic> = 1, …, <italic>N</italic><sub>m</sub> of a stochastic model, the similarity <inline-formula id="pcbi.1004275.e124"><mml:math id="M124" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> between the two sets of spike trains is defined as [<xref ref-type="bibr" rid="pcbi.1004275.ref034">34</xref>]:
<disp-formula id="pcbi.1004275.e125"><alternatives><graphic id="pcbi.1004275.e125g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e125"/><mml:math id="M125" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:mo>·</mml:mo> <mml:mo>⟨</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mtext>d</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mtext>m</mml:mtext></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mrow><mml:mfrac><mml:mn>2</mml:mn> <mml:mrow><mml:msub><mml:mi>N</mml:mi> <mml:mtext>d</mml:mtext></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mtext>d</mml:mtext></mml:msub> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mtext>d</mml:mtext></mml:msub></mml:msubsup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>i</mml:mi> <mml:mo>'</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mtext>d</mml:mtext></mml:msub></mml:msubsup> <mml:mo>⟨</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>(d)</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:msup><mml:mi>i</mml:mi> <mml:mo>'</mml:mo></mml:msup></mml:mrow> <mml:mtext>(d)</mml:mtext></mml:msubsup> <mml:mo>⟩</mml:mo> <mml:mo>+</mml:mo> <mml:mo>⟨</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mtext>m</mml:mtext></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mtext>m</mml:mtext></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where <inline-formula id="pcbi.1004275.e126"><mml:math id="M126" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi> <mml:mtext mathvariant="normal">(d)</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula> denotes the <italic>i</italic>-th experimental spike-train, <inline-formula id="pcbi.1004275.e127"><mml:math id="M127" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mtext mathvariant="normal">d</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mi>d</mml:mi></mml:msub></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mtext mathvariant="normal">d</mml:mtext></mml:msub></mml:msubsup> <mml:msubsup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi> <mml:mtext mathvariant="normal">(d)</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula> is the average experimental response across trials (that is,i.e., the experimental peri-stimulus-time histogram (PSTH) computed with infinitesimally small bins), <inline-formula id="pcbi.1004275.e128"><mml:math id="M128" overflow="scroll"><mml:mrow><mml:msub><mml:mi>ν</mml:mi> <mml:mtext mathvariant="normal">m</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>N</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>N</mml:mi> <mml:mtext mathvariant="normal">m</mml:mtext></mml:msub></mml:msubsup> <mml:msubsup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi> <mml:mtext mathvariant="normal">(m)</mml:mtext></mml:msubsup></mml:mrow></mml:math></inline-formula> is the average model response and ⟨<italic>ν</italic><sub>m</sub>, <italic>ν</italic><sub><italic>m</italic></sub>⟩ represents its norm. Due to high-throughput requirements and experimental constraints, only a small number <italic>N</italic><sub>d</sub> of experimental spike-trains are available. For this reason, the norm of <italic>ν</italic><sub>d</sub> must be computed using an unbiased estimator (cf. first term in the denominator of <xref ref-type="disp-formula" rid="pcbi.1004275.e125">Eq 23</xref>). Finally, the brackets ⟨·, ·⟩ denote the inner product used to quantify the distance between two spike trains [<xref ref-type="bibr" rid="pcbi.1004275.ref034">34</xref>]:
<disp-formula id="pcbi.1004275.e129"><alternatives><graphic id="pcbi.1004275.e129g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e129"/><mml:math id="M129" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>T</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mi>∞</mml:mi></mml:mrow> <mml:mi>∞</mml:mi></mml:msubsup> <mml:mi>K</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>'</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>S</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>S</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>'</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>d</mml:mi> <mml:mi>s</mml:mi> <mml:mi>d</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>'</mml:mo></mml:msup> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
where <italic>K</italic>(<italic>s</italic>, <italic>s</italic>′) is a two-dimensional kernel defining the degree of coincidence between two spikes occurred at times <italic>s</italic> and <italic>s</italic>′.</p>
<p>While different windows <italic>K</italic>(<italic>s</italic>, <italic>s</italic>′) may be used, the Kistler coincidence kernel <italic>K</italic>(<italic>s</italic>, <italic>s</italic>′) = <italic>δ</italic>(<italic>s</italic>′) · Θ(<italic>s</italic>+Δ) · Θ(−<italic>s</italic>+Δ) was chosen with Δ = 4 ms as in refs.[<xref ref-type="bibr" rid="pcbi.1004275.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004275.ref031">31</xref>]. With this particular choice, the inner product ⟨<italic>S</italic><sub><italic>i</italic></sub>, <italic>S</italic><sub><italic>j</italic></sub>⟩ equals the number of spikes in <italic>S</italic><sub><italic>i</italic></sub> that fell ±Δ ms apart to one of the spikes in <italic>S</italic><sub><italic>j</italic></sub> and, consequently, <inline-formula id="pcbi.1004275.e130"><mml:math id="M130" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> becomes:
<disp-formula id="pcbi.1004275.e131"><alternatives><graphic id="pcbi.1004275.e131g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e131"/><mml:math id="M131" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>M</mml:mi> <mml:mi>d</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:msub><mml:mi>n</mml:mi> <mml:mtext>dm</mml:mtext></mml:msub></mml:mrow> <mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:mtext>dd</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>+</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mtext>mm</mml:mtext></mml:msub></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(25)</label></disp-formula>
with <italic>n</italic><sub>dm</sub> being the average number of coincident spikes between data (<italic>d</italic>) and model (<italic>m</italic>), <italic>n</italic><sub>mm</sub> being the average number of coincident spikes computed across <italic>N</italic><sub>m</sub> = 500 repetitions generated by the model and <inline-formula id="pcbi.1004275.e132"><mml:math id="M132" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:mtext mathvariant="normal">dd</mml:mtext> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> being the bias-corrected average number of coincident spikes between different experimental spike trains (i.e., the number of coincident spikes between experimental spike trains <inline-formula id="pcbi.1004275.e133"><mml:math id="M133" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>d</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> and <inline-formula id="pcbi.1004275.e134"><mml:math id="M134" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mi>j</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>d</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></inline-formula> averaged across (<italic>i</italic>, <italic>j</italic>) ∈ [1, <italic>N</italic><sub>d</sub>] × [1, <italic>N</italic><sub>d</sub>] with <italic>i</italic> ≠ <italic>j</italic>, see <xref ref-type="disp-formula" rid="pcbi.1004275.e125">Eq 23</xref>).</p>
</sec>
<sec id="sec019">
<title>Performance evaluation</title>
<p><italic>Prediction error <italic>ϵ</italic><sub>V</sub> on the subthreshold response</italic>. For each repetition <italic>i</italic> in the <italic>test set</italic>, we computed the coefficient of determination <inline-formula id="pcbi.1004275.e135"><mml:math id="M135" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></inline-formula> between the experimental membrane potential <inline-formula id="pcbi.1004275.e136"><mml:math id="M136" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mi>i</mml:mi> <mml:mtext mathvariant="normal">(data)</mml:mtext></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> and the GIF model prediction <inline-formula id="pcbi.1004275.e137"><mml:math id="M137" overflow="scroll"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mtext mathvariant="normal">(model)</mml:mtext></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> (obtained by solving <xref ref-type="disp-formula" rid="pcbi.1004275.e002">Eq 1</xref> and enforcing the spikes to occur at the same time as in the experiment):
<disp-formula id="pcbi.1004275.e138"><alternatives><graphic id="pcbi.1004275.e138g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e138"/><mml:math id="M138" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>test</mml:mtext></mml:msub></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>(data)</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi> <mml:mtext>(model)</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:msub><mml:mi>T</mml:mi> <mml:mtext>test</mml:mtext></mml:msub></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mi>i</mml:mi> <mml:mtext>(data)</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mi>V</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>i</mml:mi><mml:mrow><mml:mtext>(data)</mml:mtext></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mi>d</mml:mi> <mml:mi>t</mml:mi></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula></p>
<p>The prediction error <italic>ϵ</italic><sub>V</sub> on the subthreshold response was then obtained by averaging the results from each repetition:
<disp-formula id="pcbi.1004275.e139"><alternatives><graphic id="pcbi.1004275.e139g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e139"/><mml:math id="M139" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mtext>V</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>n</mml:mi> <mml:mtext>test</mml:mtext></mml:msub></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mtext>test</mml:mtext></mml:msub></mml:munderover> <mml:msubsup><mml:mi>R</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(27)</label></disp-formula> <italic>ϵ</italic><sub>V</sub> takes values between 0 and 1 and can be interpreted as the fraction of variance of the subthreshold membrane potential fluctuations that the model was able to predict. The parameters <italic>T</italic><sub>test</sub> and <italic>n</italic><sub>test</sub> denote the duration and the number of repetitions in the <italic>test set</italic>, respectively.</p>
<p><italic>Prediction error <italic>ϵ</italic><sub>param</sub> on the GIF model parameters</italic>. The mean error <italic>ϵ</italic><sub>param</sub> on the parameters <italic>θ</italic> extracted from artificial data is defined as
<disp-formula id="pcbi.1004275.e140"><alternatives><graphic id="pcbi.1004275.e140g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004275.e140"/><mml:math id="M140" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mtext>param</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mo>⟨</mml:mo> <mml:mfrac><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>⟩</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(28)</label></disp-formula>
where <inline-formula id="pcbi.1004275.e141"><mml:math id="M141" overflow="scroll"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo></mml:mrow></mml:math></inline-formula> is the <italic>L</italic>1-error between the estimated parameter <inline-formula id="pcbi.1004275.e142"><mml:math id="M142" overflow="scroll"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>θ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and the reference parameter <italic>θ</italic><sub><italic>i</italic></sub> (used to generate the artificial data). Overall, <italic>ϵ</italic><sub>param</sub> measures the absolute percentage error averaged across model parameters.</p>
<p>All the CPU times reported in this study were obtained using an IntelCore i7 CPU920 @ 2.67GHz with 24 GB RAM. Both GLM and GIF model parameters were extracted using custom-written Matlab procedures.</p>
</sec>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1004275.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dunlop</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bowlby</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Peri</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Vasilyev</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Arias</surname> <given-names>R</given-names></name> (<year>2008</year>) <article-title>High-throughput electrophysiology: an emerging paradigm for ion-channel screening and physiology</article-title>. <source>Nature Reviews Drug Discovery</source> <volume>7</volume>: <fpage>358</fpage>–<lpage>368</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrd2552" xlink:type="simple">10.1038/nrd2552</ext-link></comment> <object-id pub-id-type="pmid">18356919</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Xu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Guia</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rothwarf</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sithiphong</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ouang</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>A benchmark study with seal chip planar patch-clamp technology</article-title>. <source>Assay and Drug Development Technologies</source> <volume>1</volume>: <fpage>675</fpage>–<lpage>684</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/154065803770381039" xlink:type="simple">10.1089/154065803770381039</ext-link></comment> <object-id pub-id-type="pmid">15090240</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Finkel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wittel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Handran</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hughes</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Costantin</surname> <given-names>J</given-names></name> (<year>2006</year>) <article-title>Population patch clamp improves data consistency and success rates in the measurement of ionic currents</article-title>. <source>Journal of Biomolecular Screening</source> <volume>11</volume>: <fpage>488</fpage>–<lpage>496</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/1087057106288050" xlink:type="simple">10.1177/1087057106288050</ext-link></comment> <object-id pub-id-type="pmid">16760372</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kodandaramaiah</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Franzesi</surname> <given-names>GT</given-names></name>, <name name-style="western"><surname>Chow</surname> <given-names>BY</given-names></name>, <name name-style="western"><surname>Boyden</surname> <given-names>ES</given-names></name>, <name name-style="western"><surname>Forest</surname> <given-names>CR</given-names></name> (<year>2012</year>) <article-title>Automated whole-cell patch-clamp electrophysiology of neurons in vivo</article-title>. <source>Nature Methods</source> <volume>9</volume>: <fpage>585</fpage>–<lpage>587</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1993" xlink:type="simple">10.1038/nmeth.1993</ext-link></comment> <object-id pub-id-type="pmid">22561988</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Herz</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Gollisch</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Machens</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Jaeger</surname> <given-names>D</given-names></name> (<year>2006</year>) <article-title>Modeling single-neuron dynamics and computations: a balance of detail and abstraction</article-title>. <source>Science</source> <volume>314</volume>: <fpage>80</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1127240" xlink:type="simple">10.1126/science.1127240</ext-link></comment> <object-id pub-id-type="pmid">17023649</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name> (<year>2009</year>) <article-title>How good are neuron models?</article-title> <source>Science</source> <volume>326</volume>: <fpage>379</fpage>–<lpage>380</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1181936" xlink:type="simple">10.1126/science.1181936</ext-link></comment> <object-id pub-id-type="pmid">19833951</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name> (<year>1999</year>) <source>Biophysics of computation: information processing in single neurons</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004275.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name> (<year>2006</year>) <article-title>The blue brain project</article-title>. <source>Nature Reviews Neuroscience</source> <volume>7</volume>: <fpage>153</fpage>–<lpage>160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn1848" xlink:type="simple">10.1038/nrn1848</ext-link></comment> <object-id pub-id-type="pmid">16429124</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Dercksen</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Sakmann</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Oberlaender</surname> <given-names>M</given-names></name> (<year>2011</year>) <article-title>Simulation of signal flow in 3d reconstructions of an anatomically realistic neural network in rat vibrissal cortex</article-title>. <source>Neural Networks</source> <volume>24</volume>: <fpage>998</fpage>–<lpage>1011</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neunet.2011.06.013" xlink:type="simple">10.1016/j.neunet.2011.06.013</ext-link></comment> <object-id pub-id-type="pmid">21775101</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Prinz</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Billimoria</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Marder</surname> <given-names>E</given-names></name> (<year>2003</year>) <article-title>Alternative to hand-tuning conductance-based models: construction and analysis of databases of model neurons</article-title>. <source>Journal of Neurophysiology</source> <volume>90</volume>: <fpage>3998</fpage>–<lpage>4015</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00641.2003" xlink:type="simple">10.1152/jn.00641.2003</ext-link></comment> <object-id pub-id-type="pmid">12944532</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gold</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Henze</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name> (<year>2006</year>) <article-title>On the origin of the extracellular action potential waveform: a modeling study</article-title>. <source>Journal of Neurophysiology</source> <volume>95</volume>: <fpage>3113</fpage>–<lpage>3128</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00979.2005" xlink:type="simple">10.1152/jn.00979.2005</ext-link></comment> <object-id pub-id-type="pmid">16467426</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Huys</surname> <given-names>QJ</given-names></name>, <name name-style="western"><surname>Ahrens</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name> (<year>2006</year>) <article-title>Efficient estimation of detailed single-neuron models</article-title>. <source>Journal of Neurophysiology</source> <volume>96</volume>: <fpage>872</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00079.2006" xlink:type="simple">10.1152/jn.00079.2006</ext-link></comment> <object-id pub-id-type="pmid">16624998</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Druckmann</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Banitt</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Gidon</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schürmann</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Segev</surname> <given-names>I</given-names></name> (<year>2007</year>) <article-title>A novel multiple objective optimization framework for constraining conductance-based neuron models by experimental data</article-title>. <source>Frontiers in Neuroscience</source> <volume>1</volume>: <fpage>1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/neuro.01.1.1.001.2007" xlink:type="simple">10.3389/neuro.01.1.1.001.2007</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hay</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schürmann</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Segev</surname> <given-names>I</given-names></name> (<year>2011</year>) <article-title>Models of neocortical layer 5b pyramidal cells capturing a wide range of dendritic and perisomatic active properties</article-title>. <source>PLoS Computational Biology</source> <volume>7</volume>: <fpage>e1002107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002107" xlink:type="simple">10.1371/journal.pcbi.1002107</ext-link></comment> <object-id pub-id-type="pmid">21829333</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Vavoulis</surname> <given-names>DV</given-names></name>, <name name-style="western"><surname>Straub</surname> <given-names>VA</given-names></name>, <name name-style="western"><surname>Aston</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>J</given-names></name> (<year>2012</year>) <article-title>A self-organizing state-space-model approach for parameter estimation in hodgkin-huxley-type models of single neurons</article-title>. <source>PLoS Computational Biology</source> <volume>8</volume>: <fpage>e1002401</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002401" xlink:type="simple">10.1371/journal.pcbi.1002401</ext-link></comment> <object-id pub-id-type="pmid">22396632</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kistler</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name> (<year>2014</year>) <source>From single neurons to networks and models of cognition</source>. <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004275.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name> (<year>2007</year>) <source>Dynamical systems in neuroscience: the geometry of excitability and bursting</source>. <publisher-loc>Cambridge, Mass.</publisher-loc>: <publisher-name>MIT Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004275.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Softky</surname> <given-names>WR</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name> (<year>1993</year>) <article-title>The highly irregular firing of cortical cells is inconsistent with temporal integration of random epsps</article-title>. <source>Journal of Neuroscience</source> <volume>13</volume>: <fpage>334</fpage>–<lpage>350</lpage>. <object-id pub-id-type="pmid">8423479</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Troyer</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>KD</given-names></name> (<year>1997</year>) <article-title>Physiological gain leads to high isi variability in a simple model of a cortical regular spiking cell</article-title>. <source>Neural Computation</source> <volume>9</volume>: <fpage>971</fpage>–<lpage>983</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.1997.9.5.971" xlink:type="simple">10.1162/neco.1997.9.5.971</ext-link></comment> <object-id pub-id-type="pmid">9188190</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Keat</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Reinagel</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Meister</surname> <given-names>M</given-names></name> (<year>2001</year>) <article-title>Predicting every spike: a model for the responses of visual neurons</article-title>. <source>Neuron</source> <volume>30</volume>: <fpage>803</fpage>–<lpage>817</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(01)00322-1" xlink:type="simple">10.1016/S0896-6273(01)00322-1</ext-link></comment> <object-id pub-id-type="pmid">11430813</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pillow</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Uzzell</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Simoncelli</surname> <given-names>EP</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>E</given-names></name> (<year>2005</year>) <article-title>Prediction and decoding of retinal ganglion cell responses with a probabilistic spiking model</article-title>. <source>Journal of Neuroscience</source> <volume>25</volume>: <fpage>11003</fpage>–<lpage>11013</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3305-05.2005" xlink:type="simple">10.1523/JNEUROSCI.3305-05.2005</ext-link></comment> <object-id pub-id-type="pmid">16306413</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Pillow</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Simoncelli</surname> <given-names>E</given-names></name> (<year>2005</year>) <article-title>Comparing integrate-and-fire models estimated using intracellular and extracellular data</article-title>. <source>Neurocomputing</source> <volume>65</volume>: <fpage>379</fpage>–<lpage>385</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neucom.2004.10.032" xlink:type="simple">10.1016/j.neucom.2004.10.032</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jolivet</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schürmann</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Roth</surname> <given-names>A</given-names></name> (<year>2008</year>) <article-title>The quantitative single-neuron modeling competition</article-title>. <source>Biological Cybernetics</source> <volume>99</volume>: <fpage>417</fpage>–<lpage>426</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00422-008-0261-x" xlink:type="simple">10.1007/s00422-008-0261-x</ext-link></comment> <object-id pub-id-type="pmid">19011928</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kobayashi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Tsubo</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shinomoto</surname> <given-names>S</given-names></name> (<year>2009</year>) <article-title>Made-to-order spiking neuron model equipped with a multi-timescale adaptive threshold</article-title>. <source>Frontiers in Computational Neuroscience</source> <volume>3</volume>: <fpage>9</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/neuro.10.009.2009" xlink:type="simple">10.3389/neuro.10.009.2009</ext-link></comment> <object-id pub-id-type="pmid">19668702</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dong</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Mihalas</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Yoshioka</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bensmaia</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Niebur</surname> <given-names>E</given-names></name> (<year>2013</year>) <article-title>A simple model of mechanotransduction in primate glabrous skin</article-title>. <source>Journal of Neurophysiology</source> <volume>109</volume>: <fpage>1350</fpage>–<lpage>1359</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00395.2012" xlink:type="simple">10.1152/jn.00395.2012</ext-link></comment> <object-id pub-id-type="pmid">23236001</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Häusser</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Spruston</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Stuart</surname> <given-names>GJ</given-names></name> (<year>2000</year>) <article-title>Diversity and dynamics of dendritic signaling</article-title>. <source>Science</source> <volume>290</volume>: <fpage>739</fpage>–<lpage>744</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.290.5492.739" xlink:type="simple">10.1126/science.290.5492.739</ext-link></comment> <object-id pub-id-type="pmid">11052929</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Larkum</surname> <given-names>ME</given-names></name>, <name name-style="western"><surname>Nevian</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sandler</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Polsky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Schiller</surname> <given-names>J</given-names></name> (<year>2009</year>) <article-title>Synaptic integration in tuft dendrites of layer 5 pyramidal neurons: a new unifying principle</article-title>. <source>Science</source> <volume>325</volume>: <fpage>756</fpage>–<lpage>760</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1171958" xlink:type="simple">10.1126/science.1171958</ext-link></comment> <object-id pub-id-type="pmid">19661433</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Edelman</surname> <given-names>GM</given-names></name> (<year>2008</year>) <article-title>Large-scale model of mammalian thalamocortical systems</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>105</volume>: <fpage>3593</fpage>–<lpage>3598</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0712231105" xlink:type="simple">10.1073/pnas.0712231105</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gewaltig</surname> <given-names>MO</given-names></name>, <name name-style="western"><surname>Diesmann</surname> <given-names>M</given-names></name> (<year>2007</year>) <article-title>Nest (neural simulation tool)</article-title>. <source>Scholarpedia</source> <volume>2</volume>: <fpage>1430</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4249/scholarpedia.1430" xlink:type="simple">10.4249/scholarpedia.1430</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="other">Mensi S, Naud R, Gerstner W (2011) From stochastic nonlinear integrate-and-fire to generalized linear models. Advances in Neural Information Processing Systems. pp. 1377–1385.</mixed-citation>
</ref>
<ref id="pcbi.1004275.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pozzorini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> (<year>2013</year>) <article-title>Temporal whitening by power-law adaptation in neocortical neurons</article-title>. <source>Nature Neuroscience</source> <volume>16</volume>: <fpage>942</fpage>–<lpage>948</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.3431" xlink:type="simple">10.1038/nn.3431</ext-link></comment> <object-id pub-id-type="pmid">23749146</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Piwkowska</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Monier</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rudolph-Lilith</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fournier</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Levy</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>High-resolution intracellular recordings using a real-time computational model of the electrode</article-title>. <source>Neuron</source> <volume>59</volume>: <fpage>379</fpage>–<lpage>391</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2008.06.021" xlink:type="simple">10.1016/j.neuron.2008.06.021</ext-link></comment> <object-id pub-id-type="pmid">18701064</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Badel</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lefort</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>M</given-names></name> (<year>2008</year>) <article-title>Dynamic IV curves are reliable predictors of naturalistic pyramidal-neuron voltage traces</article-title>. <source>Journal of Neurophysiology</source> <volume>99</volume>: <fpage>656</fpage>–<lpage>666</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01107.2007" xlink:type="simple">10.1152/jn.01107.2007</ext-link></comment> <object-id pub-id-type="pmid">18057107</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerhard</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> (<year>2011</year>) <article-title>Improved similarity measures for small sets of spike trains</article-title>. <source>Neural Computation</source> <volume>23</volume>: <fpage>3016</fpage>–<lpage>3069</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00208" xlink:type="simple">10.1162/NECO_a_00208</ext-link></comment> <object-id pub-id-type="pmid">21919785</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Truccolo</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Eden</surname> <given-names>UT</given-names></name>, <name name-style="western"><surname>Fellows</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>EN</given-names></name> (<year>2005</year>) <article-title>A point process framework for relating neural spiking activity to spiking history, neural ensemble, and extrinsic covariate effects</article-title>. <source>Journal of Neurophysiology</source> <volume>93</volume>: <fpage>1074</fpage>–<lpage>1089</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00697.2004" xlink:type="simple">10.1152/jn.00697.2004</ext-link></comment> <object-id pub-id-type="pmid">15356183</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Chichilnisky</surname> <given-names>EJ</given-names></name> <etal>et al</etal>. (<year>2008</year>) <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title>. <source>Nature</source> <volume>454</volume>: <fpage>995</fpage>–<lpage>999</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07140" xlink:type="simple">10.1038/nature07140</ext-link></comment> <object-id pub-id-type="pmid">18650810</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mensi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pozzorini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Avermann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CC</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> (<year>2012</year>) <article-title>Parameter extraction and classification of three cortical neuron types reveals two distinct adaptation mechanisms</article-title>. <source>Journal of Neurophysiology</source> <volume>107</volume>: <fpage>1756</fpage>–<lpage>1775</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00408.2011" xlink:type="simple">10.1152/jn.00408.2011</ext-link></comment> <object-id pub-id-type="pmid">22157113</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Kistler</surname> <given-names>WM</given-names></name> (<year>2002</year>) <source>Spiking neuron models: single neurons, populations, plasticity</source>. <publisher-loc>Cambridge, U.K.</publisher-loc>: <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004275.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jolivet</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rauch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lüscher</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> (<year>2006</year>) <article-title>Predicting spike timing of neocortical pyramidal neurons by simple threshold models</article-title>. <source>Journal of Computational Neuroscience</source> <volume>21</volume>: <fpage>35</fpage>–<lpage>49</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-006-7074-5" xlink:type="simple">10.1007/s10827-006-7074-5</ext-link></comment> <object-id pub-id-type="pmid">16633938</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>van Hemmen</surname> <given-names>JL</given-names></name> (<year>1992</year>) <article-title>Associative memory in a network of spiking neurons</article-title>. <source>Network: Computation in Neural Systems</source> <volume>3</volume>: <fpage>139</fpage>–<lpage>164</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0954-898X/3/2/004" xlink:type="simple">10.1088/0954-898X/3/2/004</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name> (<year>2004</year>) <article-title>Maximum likelihood estimation of cascade point-process neural encoding models</article-title>. <source>Network: Computation in Neural Systems</source> <volume>15</volume>: <fpage>243</fpage>–<lpage>262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1088/0954-898X/15/4/002" xlink:type="simple">10.1088/0954-898X/15/4/002</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mainen</surname> <given-names>ZF</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name> (<year>1995</year>) <article-title>Reliability of spike timing in neocortical neurons</article-title>. <source>Science</source> <volume>268</volume>: <fpage>1503</fpage>–<lpage>1506</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.7770778" xlink:type="simple">10.1126/science.7770778</ext-link></comment> <object-id pub-id-type="pmid">7770778</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lundstrom</surname> <given-names>BN</given-names></name>, <name name-style="western"><surname>Higgs</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Spain</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Fairhall</surname> <given-names>AL</given-names></name> (<year>2008</year>) <article-title>Fractional differentiation by neocortical pyramidal neurons</article-title>. <source>Nature Neuroscience</source> <volume>11</volume>: <fpage>1335</fpage>–<lpage>1342</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2212" xlink:type="simple">10.1038/nn.2212</ext-link></comment> <object-id pub-id-type="pmid">18931665</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref044">
<label>44</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Destexhe</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Paré</surname> <given-names>D</given-names></name> (<year>1999</year>) <article-title>Impact of network activity on the integrative properties of neocortical pyramidal neurons in vivo</article-title>. <source>Journal of Neurophysiology</source> <volume>81</volume>: <fpage>1531</fpage>–<lpage>1547</lpage>. <object-id pub-id-type="pmid">10200189</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref045">
<label>45</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Segev</surname> <given-names>I</given-names></name> (<year>2000</year>) <article-title>The role of single neurons in information processing</article-title>. <source>Nature Neuroscience</source> <volume>3</volume>: <fpage>1171</fpage>–<lpage>1177</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/81444" xlink:type="simple">10.1038/81444</ext-link></comment> <object-id pub-id-type="pmid">11127834</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref046">
<label>46</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>London</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Häusser</surname> <given-names>M</given-names></name> (<year>2005</year>) <article-title>Dendritic computation</article-title>. <source>Annual Review of Neuroscience</source> <volume>28</volume>: <fpage>503</fpage>–<lpage>532</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.neuro.28.061604.135703" xlink:type="simple">10.1146/annurev.neuro.28.061604.135703</ext-link></comment> <object-id pub-id-type="pmid">16033324</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref047">
<label>47</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Rall</surname> <given-names>W</given-names></name> (<year>2011</year>) <source>Core conductor theory and cable properties of neurons</source>. <publisher-name>Comprehensive Physiology</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004275.ref048">
<label>48</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Avermann</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tomm</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mateo</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Petersen</surname> <given-names>CC</given-names></name> (<year>2012</year>) <article-title>Microcircuits of excitatory and inhibitory neurons in layer 2/3 of mouse barrel cortex</article-title>. <source>Journal of Neurophysiology</source>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00917.2011" xlink:type="simple">10.1152/jn.00917.2011</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref049">
<label>49</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sah</surname> <given-names>P</given-names></name> (<year>1996</year>) <article-title>Ca<sup>2+</sup>-activated K<sup>+</sup> currents in neurones: types, physiological roles and modulation</article-title>. <source>Trends in Neurosciences</source> <volume>19</volume>: <fpage>150</fpage>–<lpage>154</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0166-2236(96)80026-9" xlink:type="simple">10.1016/S0166-2236(96)80026-9</ext-link></comment> <object-id pub-id-type="pmid">8658599</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref050">
<label>50</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schwindt</surname> <given-names>PC</given-names></name>, <name name-style="western"><surname>Spain</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Foehring</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Stafstrom</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Chubb</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Crill</surname> <given-names>WE</given-names></name> (<year>1988</year>) <article-title>Multiple potassium conductances and their functions in neurons from cat sensorimotor cortex in vitro</article-title>. <source>Journal of Neurophysiology</source> <volume>59</volume>: <fpage>424</fpage>–<lpage>449</lpage>. <object-id pub-id-type="pmid">3351569</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref051">
<label>51</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Azouz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>CM</given-names></name> (<year>2000</year>) <article-title>Dynamic spike threshold reveals a mechanism for synaptic coincidence detection in cortical neurons in vivo</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>97</volume>: <fpage>8110</fpage>–<lpage>8115</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.130200797" xlink:type="simple">10.1073/pnas.130200797</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref052">
<label>52</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Azouz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>CM</given-names></name> (<year>2003</year>) <article-title>Adaptive coincidence detection and dynamic gain control in visual cortical neurons in vivo</article-title>. <source>Neuron</source> <volume>37</volume>: <fpage>513</fpage>–<lpage>523</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(02)01186-8" xlink:type="simple">10.1016/S0896-6273(02)01186-8</ext-link></comment> <object-id pub-id-type="pmid">12575957</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref053">
<label>53</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Toledo-Rodriguez</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Gupta</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Silberberg</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>C</given-names></name> (<year>2004</year>) <article-title>Interneurons of the neocortical inhibitory system</article-title>. <source>Nature Reviews Neuroscience</source> <volume>5</volume>: <fpage>793</fpage>–<lpage>807</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn1519" xlink:type="simple">10.1038/nrn1519</ext-link></comment> <object-id pub-id-type="pmid">15378039</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref054">
<label>54</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Padmanabhan</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Urban</surname> <given-names>NN</given-names></name> (<year>2010</year>) <article-title>Intrinsic biophysical diversity decorrelates neuronal firing while increasing information content</article-title>. <source>Nature Neuroscience</source> <volume>13</volume>: <fpage>1276</fpage>–<lpage>1282</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2630" xlink:type="simple">10.1038/nn.2630</ext-link></comment> <object-id pub-id-type="pmid">20802489</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref055">
<label>55</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tripathy</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Padmanabhan</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Gerkin</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Urban</surname> <given-names>NN</given-names></name> (<year>2013</year>) <article-title>Intermediate intrinsic diversity enhances neural population coding</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>110</volume>: <fpage>8248</fpage>–<lpage>8253</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1221214110" xlink:type="simple">10.1073/pnas.1221214110</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref056">
<label>56</label>
<mixed-citation xlink:type="simple" publication-type="journal"><name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bathellier</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> (<year>2014</year>) <article-title>Spike-timing prediction in cortical neurons with active dendrites</article-title>. <source>Frontiers in Computational Neuroscience</source> <volume>8</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncom.2014.00090" xlink:type="simple">10.3389/fncom.2014.00090</ext-link></comment> <object-id pub-id-type="pmid">25165443</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref057">
<label>57</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Clopath</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Büsing</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Vasilaki</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> (<year>2010</year>) <article-title>Connectivity reflects coding: a model of voltage-based stdp with homeostasis</article-title>. <source>Nature Neuroscience</source> <volume>13</volume>: <fpage>344</fpage>–<lpage>352</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2479" xlink:type="simple">10.1038/nn.2479</ext-link></comment> <object-id pub-id-type="pmid">20098420</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref058">
<label>58</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Mihalaş</surname> <given-names>Ş</given-names></name>, <name name-style="western"><surname>Niebur</surname> <given-names>E</given-names></name> (<year>2009</year>) <article-title>A generalized linear integrate-and-fire neural model produces diverse spiking behaviors</article-title>. <source>Neural Computation</source> <volume>21</volume>: <fpage>704</fpage>–<lpage>718</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2008.12-07-680" xlink:type="simple">10.1162/neco.2008.12-07-680</ext-link></comment> <object-id pub-id-type="pmid">18928368</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref059">
<label>59</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Platkiewicz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name> (<year>2010</year>) <article-title>A threshold equation for action potential initiation</article-title>. <source>PLoS Computational Biology</source> <volume>6</volume>: <fpage>e1000850</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000850" xlink:type="simple">10.1371/journal.pcbi.1000850</ext-link></comment> <object-id pub-id-type="pmid">20628619</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref060">
<label>60</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Higgs</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Spain</surname> <given-names>WJ</given-names></name> (<year>2011</year>) <article-title>Kv1 channels control spike threshold dynamics and spike timing in cortical pyramidal neurones</article-title>. <source>The Journal of Physiology</source> <volume>589</volume>: <fpage>5125</fpage>–<lpage>5142</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.2011.216721" xlink:type="simple">10.1113/jphysiol.2011.216721</ext-link></comment> <object-id pub-id-type="pmid">21911608</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref061">
<label>61</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> (<year>2005</year>) <article-title>Adaptive exponential integrate-and-fire model as an effective description of neuronal activity</article-title>. <source>Journal of Neurophysiology</source> <volume>94</volume>: <fpage>3637</fpage>–<lpage>3642</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00686.2005" xlink:type="simple">10.1152/jn.00686.2005</ext-link></comment> <object-id pub-id-type="pmid">16014787</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref062">
<label>62</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Izhikevich</surname> <given-names>EM</given-names></name> (<year>2003</year>) <article-title>Simple model of spiking neurons</article-title>. <source>Neural Networks, IEEE Transactions on Neural Networks</source> <volume>14</volume>: <fpage>1569</fpage>–<lpage>1572</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNN.2003.820440" xlink:type="simple">10.1109/TNN.2003.820440</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref063">
<label>63</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Marcille</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Clopath</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> (<year>2008</year>) <article-title>Firing patterns in the adaptive exponential integrate-and-fire model</article-title>. <source>Biological Cybernetics</source> <volume>99</volume>: <fpage>335</fpage>–<lpage>347</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00422-008-0264-7" xlink:type="simple">10.1007/s00422-008-0264-7</ext-link></comment> <object-id pub-id-type="pmid">19011922</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref064">
<label>64</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Touboul</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Brette</surname> <given-names>R</given-names></name> (<year>2008</year>) <article-title>Dynamics and bifurcations of the adaptive exponential integrate-and-fire model</article-title>. <source>Biological Cybernetics</source> <volume>99</volume>: <fpage>319</fpage>–<lpage>334</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s00422-008-0267-4" xlink:type="simple">10.1007/s00422-008-0267-4</ext-link></comment> <object-id pub-id-type="pmid">19011921</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref065">
<label>65</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name> (<year>2012</year>) <article-title>Neuroscience: Observatories of the mind</article-title>. <source>Nature</source> <volume>483</volume>: <fpage>397</fpage>–<lpage>398</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/483397a" xlink:type="simple">10.1038/483397a</ext-link></comment> <object-id pub-id-type="pmid">22437592</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref066">
<label>66</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Waldrop</surname> <given-names>MM</given-names></name> (<year>2012</year>) <article-title>Computer modelling: Brain in a box</article-title>. <source>Nature</source> <volume>482</volume>: <fpage>456</fpage>–<lpage>458</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/482456a" xlink:type="simple">10.1038/482456a</ext-link></comment> <object-id pub-id-type="pmid">22358809</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref067">
<label>67</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kandel</surname> <given-names>ER</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Matthews</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name> (<year>2013</year>) <article-title>Neuroscience thinks big (and collaboratively)</article-title>. <source>Nature Reviews Neuroscience</source> <volume>14</volume>: <fpage>659</fpage>–<lpage>664</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn3578" xlink:type="simple">10.1038/nrn3578</ext-link></comment> <object-id pub-id-type="pmid">23958663</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref068">
<label>68</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Carnevale</surname> <given-names>NT</given-names></name>, <name name-style="western"><surname>Hines</surname> <given-names>ML</given-names></name> (<year>2006</year>) <source>The NEURON book</source>. <publisher-name>Cambridge University Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004275.ref069">
<label>69</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brillinger</surname> <given-names>DR</given-names></name> (<year>1988</year>) <article-title>Maximum likelihood analysis of spike trains of interacting nerve cells</article-title>. <source>Biological Cybernetics</source> <volume>59</volume>: <fpage>189</fpage>–<lpage>200</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00318010" xlink:type="simple">10.1007/BF00318010</ext-link></comment> <object-id pub-id-type="pmid">3179344</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004275.ref070">
<label>70</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jolivet</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Kobayashi</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rauch</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Naud</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Shinomoto</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gerstner</surname> <given-names>W</given-names></name> (<year>2008</year>) <article-title>A benchmark test for a quantitative assessment of simple neuron models</article-title>. <source>Journal of Neuroscience Methods</source> <volume>169</volume>: <fpage>417</fpage>–<lpage>424</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2007.11.006" xlink:type="simple">10.1016/j.jneumeth.2007.11.006</ext-link></comment> <object-id pub-id-type="pmid">18160135</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>