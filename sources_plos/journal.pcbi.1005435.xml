<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-01259</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005435</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological niches</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Ecological niches</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Multivariate analysis</subject><subj-group><subject>Principal component analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Multivariate analysis</subject><subj-group><subject>Principal component analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Microbial ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Microbial ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Community ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Community ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Algebra</subject><subj-group><subject>Linear algebra</subject><subj-group><subject>Vector spaces</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Variable habitat conditions drive species covariation in the human microbiota</article-title>
<alt-title alt-title-type="running-head">Variable habitat conditions drive species covariation in the human microbiota</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-8835-1096</contrib-id>
<name name-style="western">
<surname>Fisher</surname> <given-names>Charles K.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="fn" rid="currentaff001"><sup>¤</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Mora</surname> <given-names>Thierry</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Walczak</surname> <given-names>Aleksandra M.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Laboratoire de physique théorique, CNRS, UPMC and École normale supérieure, Paris, France</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Laboratoire de physique statistique, CNRS, UPMC and École normale supérieure, Paris, France</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Lessler</surname> <given-names>Justin</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Johns Hopkins Bloomberg School of Public Health, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p>
<list list-type="simple">
<list-item>
<p><bold>Methodology:</bold> CKF.</p>
</list-item>
<list-item>
<p><bold>Software:</bold> CKF.</p>
</list-item>
<list-item>
<p><bold>Writing – original draft:</bold> CKF TM AMW.</p>
</list-item>
</list>
</p>
</fn>
<fn fn-type="current-aff" id="currentaff001">
<label>¤</label> <p>Current address: Pfizer, Inc., Cambridge, Massachusetts, United States of America</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">charleskennethfisher@gmail.com</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2017</year>
</pub-date>
<pub-date pub-type="epub">
<day>27</day>
<month>4</month>
<year>2017</year>
</pub-date>
<volume>13</volume>
<issue>4</issue>
<elocation-id>e1005435</elocation-id>
<history>
<date date-type="received">
<day>2</day>
<month>8</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>1</day>
<month>3</month>
<year>2017</year>
</date>
</history>
<permissions>
<copyright-year>2017</copyright-year>
<copyright-holder>Fisher et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005435"/>
<abstract>
<p>Two species with similar resource requirements respond in a characteristic way to variations in their habitat—their abundances rise and fall in concert. We use this idea to learn how bacterial populations in the microbiota respond to habitat conditions that vary from person-to-person across the human population. Our mathematical framework shows that habitat fluctuations are sufficient for explaining intra-bodysite correlations in relative species abundances from the Human Microbiome Project. We explicitly show that the relative abundances of closely related species are positively correlated and can be predicted from taxonomic relationships. We identify a small set of functional pathways related to metabolism and maintenance of the cell wall that form the basis of a common resource sharing niche space of the human microbiota.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>The human body is inhabited by a vast number of microorganisms comprising the human microbiota. The species composition of the microbiota varies considerably from person-to-person and the relative abundances of some species rise and fall in concert. We introduce a mathematical model where differences in habitat conditions cause most of the variability of the microbiota. A statistical analysis shows that variable habitat conditions are sufficient for explaining the patterns of variation observed across a healthy human population and, as a result, the correlation between the relative abundances of two species reflects how closely related they are rather than how they directly interact with each other.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>Institut Philippe Meyer</institution>
</funding-source>
</award-group>
<funding-statement>This work was funded by a Philippe Meyer Fellowship to CKF (<ext-link ext-link-type="uri" xlink:href="http://www.ipm.ens.fr/?lang=en" xlink:type="simple">http://www.ipm.ens.fr/?lang=en</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="0"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Source code and processed data files are available as part of the Supporting Information and at <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/charleskennethfisher/home/programs-and-data" xlink:type="simple">https://sites.google.com/site/charleskennethfisher/home/programs-and-data</ext-link>. We obtained all of the data from publicly available resources. Specifically, data from the Human Microbiome Project were obtained from MG-RAST at <ext-link ext-link-type="uri" xlink:href="http://metagenomics.anl.gov/mgmain.html?mgpage=project&amp;project=mgp385" xlink:type="simple">http://metagenomics.anl.gov/mgmain.html?mgpage=project&amp;project=mgp385</ext-link>, and data on species metabolic enzymes were obtained from KEGG at <ext-link ext-link-type="uri" xlink:href="http://www.genome.jp/kegg/" xlink:type="simple">http://www.genome.jp/kegg/</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Species in an ecosystem interact with each other and with their environment. Both types of interactions leave an imprint on the composition and diversity of a community. Two species competing for exactly the same resources engage in a struggle for existence [<xref ref-type="bibr" rid="pcbi.1005435.ref001">1</xref>]. In the end, one species will win the competition by driving the other to extinction. As a result, one might expect that closely related species rarely occupy the same habitat where they would risk being drawn into competition. On the other hand, species that survive in the same habitat must share many common features [<xref ref-type="bibr" rid="pcbi.1005435.ref002">2</xref>]. Thus, the rise and fall of a common resource may cause the abundances of similar species to rise and fall in concert. These opposing ecological forces simultaneously push and pull on species abundances to shape the composition of a community.</p>
<p>Ecological processes operate on the thousands of microbial species that inhabit the human body [<xref ref-type="bibr" rid="pcbi.1005435.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1005435.ref006">6</xref>] just as they operate on the Amazon rainforest. Technological advances have recently made it possible to study the human microbiota using 16S ribosomal RNA tag-sequencing and whole genome ‘shotgun’ metagenomics [<xref ref-type="bibr" rid="pcbi.1005435.ref007">7</xref>]. Variability in the composition of the microbiota can be studied in two ways. Longitudinal studies follow the relative abundances of the species in a single bodysite of a particular person over time [<xref ref-type="bibr" rid="pcbi.1005435.ref008">8</xref>]. Cross-sectional studies examine the relative abundances of the species in a single bodysite across a sample of many different people [<xref ref-type="bibr" rid="pcbi.1005435.ref009">9</xref>]. These studies have demonstrated that the composition of the human microbiota exhibits three qualitative scales of variation [<xref ref-type="bibr" rid="pcbi.1005435.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref011">11</xref>]: there are small-scale fluctuations in relative species abundances through time, there are medium-scale variations in species composition from person-to-person, and there are large-scale differences in species composition between different bodysites.</p>
<p>In this work we quantitatively explore the idea that variations in species abundances between different sites can be explained mainly through the local variations in resource availability. Concretely, we reanalyze data from the Human Microbiome Project (HMP) [<xref ref-type="bibr" rid="pcbi.1005435.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1005435.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref012">12</xref>] on the species composition of different bodysites (i.e., gut, skin, vagina, and oral cavity; <xref ref-type="fig" rid="pcbi.1005435.g001">Fig 1</xref>). To develop the analysis method, we start from a theoretical model that assumes maximal diversity of species and derives a relationship between species abundance and resource availability. We then use the results of this model to guide the joint analysis of the datasets from different body sites in the HMP project, introducing a new Common Component Analysis (CoCA) method. The general idea is that if the same species exist in different body sites, the same resources must also be present at these body sites. We find that this intuition is correct by showing that the covariance of species abundances at specific body sites can be simultaneously projected into the same basis that describes the availability of effective resources. This means that the abundances of species at different body sites are driven by the same set of resources, just different resources are of varying importance at different body sites. These results cannot be reproduced from randomized data and reflect an underlying global set of ecological resources shared between body sites.</p>
<fig id="pcbi.1005435.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005435.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schematic outline of the paper.</title>
<p>A) Data on the microbial species composition of the gut, oral cavity, vagina, and skin from the Human Microbiome Project were obtained from MG-RAST. One hundred highly abundant species were selected for further study (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). The top five most abundant species in each bodysite are shown. B) We propose a theory for the composition of the microbiota based on a Maximum Diversity Hypothesis, which says that the equilibrium relative species abundances in a community maximize the diversity of the community while ensuring that all niches are fully utilized. As a consequence, variability from person-to-person in the species composition within a bodysite results from variability in the availabilities of some ‘effective resources’ that define the space of niches. C) An overview of the steps in the Common Components Analysis (CoCA) algorithm. Covariance matrices are computed from the log-ratio transformed relative abundances in each bodysite. The covariance matrices are simultaneously diagonalized to obtain a basis of common components, and an inverse log-ratio transform is applied obtain the inferred effective resource utilizations. D. Overall logical flow of the paper. Characterizing the effective resources allows us to identify the functional pathways which must be conserved to utilize a common habitat.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.g001" xlink:type="simple"/>
</fig>
<p>Our method identifies species that share common resources. To understand the source of this sharing, we look for similarities between the species. We find that species that share common resources are also closely related taxonomically, suggesting that evolution is constrained by ecology. We further back this observation by identifying specific metabolic pathways that are conserved between species identified as close using our resource sharing analysis.</p>
<p>The goal of this work is three-fold. First, we introduce a new analysis technique that identifies covariations among components in different subsets that are driven by the same process (CoCA). Second, by successfully applying the CoCA analysis technique to HMP data, we show that the diversity of the microbiome at different body sites is shaped by common biological processes. Third, in the case of the specific problem of species at different ecological sites, we make the biological point that microbiome species that share the same resources are also closely related taxonomically and we back this fact by identifying shared pathways. The methodological developments are presented in the “Theory” subsection of the Results and the biological results in the“Analysis” subsection. For readers predominantly interested in the biological results the “Analysis” subsection can be read independently of the “Theory” subsection.</p>
<p>In addition to presenting statistical evidence for the observations described above, we formulate a hypothesis (in the form of a mathematical model) that explains their origin. Our model is inspired by MacArthur’s famous model of competition [<xref ref-type="bibr" rid="pcbi.1005435.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1005435.ref015">15</xref>], but is adapted to account for the compositional nature of metagenomic survey data. We demonstrate that <italic>habitat variability</italic> is sufficient to explain the medium-scale variations in species composition observed in a cross-sectional study of the human microbiota. As a result, the relative abundances of closely related species are positively correlated—they rise and fall in concert as habitat conditions vary from person-to-person. Therefore, cross-sectional studies allow us to extract a wealth of information about the influence of species traits and habitat properties on community composition using advanced statistical techniques.</p>
</sec>
<sec id="sec002" sec-type="conclusions">
<title>Results and discussion</title>
<sec id="sec003">
<title>Theory</title>
<sec id="sec004">
<title>MacArthur’s consumer-resource model and the definition of effective resources</title>
<p>Before we present the method developed in this paper, for completeness we first briefly discuss a classic deterministic model of resources utilization. In a series of pioneering papers [<xref ref-type="bibr" rid="pcbi.1005435.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref014">14</xref>], Robert MacArthur developed a theory that explicitly linked the dynamics of resource and consumer species in an ecosystem. This section will provide a brief, non-technical discussion of MacArthur’s theory to provide some context for our work. The consumer-resource model describes the <italic>absolute abundances</italic> of the species in a community where <italic>M</italic> of the species are resources <italic>μ</italic> = 1, …, <italic>M</italic> and <italic>N</italic> are consumers <italic>i</italic> = 1, …, <italic>N</italic>. Assuming that the dynamics of the resource species are much faster than the dynamics of the consumers, the dynamics of the consumer species are governed by a system of generalized Lotka-Volterra equations. MacArthur showed that the equilibrium <italic>absolute abundances</italic> of the consumer species correspond to the point where the consumers make the most effective use of the resources.</p>
<p>Species in MacArthur’s model are characterized by resource utilizations—that is, each consumer species <italic>i</italic> is described by a vector of length <italic>M</italic> containing the rate that species <italic>i</italic> depletes resource <italic>μ</italic> = 1, …, <italic>M</italic>. The resource utilizations form the basis of a vector space that one could call a niche space. The community dynamics cannot have an internal equilibrium (i.e., with all species coexisting) unless the basis is either complete (i.e. <italic>M</italic> = <italic>N</italic>) or overcomplete (i.e. <italic>M</italic> &gt; <italic>N</italic>). It is important to keep in mind, however, that there are many mechanisms that lead to coexistence in real communities where spatial and stochastic effects are important [<xref ref-type="bibr" rid="pcbi.1005435.ref016">16</xref>]. Although the resource basis was defined in a biologically meaningful way by MacArthur, there is nothing that restricts us to this exact choice. In fact, any set of <italic>N</italic> linearly independent vectors constructed from linear combinations of the resource utilizations will also be an equally valid basis. This leads to an infinite choice of potential bases that have exactly the same dynamics (thus, they will be indistinguishable by a statistical model), with each possible set of basis vectors providing a different view of the niche space. Although these basis vectors are related to the original resource utilizations they are, indeed, different so we have adopted the term “effective resources” to reflect the ambiguity in relating the inferred bases that we will use in this paper to the underlying resources.</p>
</sec>
<sec id="sec005">
<title>Adapting resource models to relative abundances with the maximum diversity hypothesis</title>
<p>Our first step to analyze the HMP microbiome dataset is to build a theoretical model for species abundance covariation that will guide our inference. Metagenomic survey experiments typically provide measures of relative, rather than absolute, species abundances. That is, the experiments do not provide an accurate measure of the overall size of the population. Therefore, it is necessary to develop a theory that directly models relative abundances. Our theory is inspired by two aspects of MacArthur’s consumer resource model [<xref ref-type="bibr" rid="pcbi.1005435.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1005435.ref015">15</xref>]: first, species are described by vectors of resource utilizations that act as a basis of a linear niche space and, secondly, that the equilibrium relative abundances correspond to the point where the consumers make the most effective use of the resources. Specifically, our model is based on an ecological hypothesis we call the maximum diversity hypothesis:</p>
<disp-quote>
<p><bold>Maximum Diversity Hypothesis:</bold> The equilibrium relative species abundances in a community maximize the diversity of the community while ensuring that all effective resources are fully utilized.</p>
</disp-quote>
<p>Many mechanisms that may lead to high diversity communities (e.g. see [<xref ref-type="bibr" rid="pcbi.1005435.ref016">16</xref>]) have been identified, but we will not attempt a mechanistic derivation of the maximum diversity hypothesis in this work. Instead, we will show that the maximum diversity hypothesis implies that cross-sectional covariances in log-ratio transformed relative abundances can be described by a statistical factor model and that this model is consistent with observations in the human microbiome.</p>
<p>To formalize the model, we suppose that a particular community has <italic>M</italic> effective resources that define the dimensions of a niche space. Note that we use the term ‘effective resources’ in an abstract way that captures all of the abiotic and biotic factors that affect the species composition within a community. Each effective resource <italic>μ</italic> has an availability <italic>V</italic><sub><italic>μ</italic></sub>, which varies between different environments. It is the variation in the availabilities of the effective resources that drives variation in species composition between communities. In a community composed only of species <italic>i</italic>, an amount <italic>V</italic><sub><italic>iμ</italic></sub> of effective resource <italic>μ</italic> will be utilized. In other words, <italic>V</italic><sub><italic>iμ</italic></sub> describes the ability of species <italic>i</italic> to utilize effective resource <italic>μ</italic>. Note that <italic>V</italic><sub><italic>iμ</italic></sub> can be positive, in which case species <italic>i</italic> depletes effective resource <italic>μ</italic>, or it could be negative, in which case species <italic>i</italic> adds more of effective resource <italic>μ</italic> to the environment. For example, a bacterium may secrete a metabolite that is utilized by other species. Finally, we quantify the diversity of a community using the Shannon entropy <italic>H</italic>[<bold><italic>x</italic></bold>] = −∑<sub><italic>i</italic></sub> <italic>x</italic><sub><italic>i</italic></sub> log <italic>x</italic><sub><italic>i</italic></sub> [<xref ref-type="bibr" rid="pcbi.1005435.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref018">18</xref>], where <italic>x</italic><sub><italic>i</italic></sub> is the abundance of species <italic>i</italic>. Following the maximum diversity hypothesis, the equilibrium relative species abundances can be obtained by maximizing <italic>H</italic>[<bold><italic>x</italic></bold>] subject to constraints <italic>V</italic><sub><italic>μ</italic></sub> = ∑<sub><italic>i</italic></sub> <italic>V</italic><sub><italic>iμ</italic></sub><italic>x</italic><sub><italic>i</italic></sub> and ∑<sub><italic>i</italic></sub> <italic>x</italic><sub><italic>i</italic></sub> = 1.</p>
<p>We can solve for the equilibrium relative abundances by maximizing the Lagrangian:
<disp-formula id="pcbi.1005435.e001"><alternatives><graphic id="pcbi.1005435.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">x</mml:mi> <mml:mo>,</mml:mo> <mml:mo mathvariant="bold">λ</mml:mo> <mml:mo>,</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>μ</mml:mi></mml:munder> <mml:msub><mml:mo>λ</mml:mo> <mml:mi>μ</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>V</mml:mi> <mml:mi>μ</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>μ</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>γ</italic> and the λ<sub><italic>μ</italic></sub>’s are Lagrange multipliers. The solution is given by</p>
<disp-formula id="pcbi.1005435.e002">
<alternatives>
<graphic id="pcbi.1005435.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e002" xlink:type="simple"/>
<mml:math display="block" id="M2">
<mml:mrow>
<mml:mo form="prefix">log</mml:mo>
<mml:msubsup>
<mml:mi>x</mml:mi>
<mml:mi>i</mml:mi>
<mml:mo>*</mml:mo>
</mml:msubsup>
<mml:mo>=</mml:mo>
<mml:munder>
<mml:mo>∑</mml:mo>
<mml:mi>μ</mml:mi>
</mml:munder>
<mml:msub>
<mml:mi>λ</mml:mi>
<mml:mi>μ</mml:mi>
</mml:msub>
<mml:msub>
<mml:mi>V</mml:mi>
<mml:mrow>
<mml:mi>i</mml:mi>
<mml:mi>μ</mml:mi>
</mml:mrow>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mtext>constant</mml:mtext>
</mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
<p>
<xref ref-type="disp-formula" rid="pcbi.1005435.e002">Eq 2</xref> is of the form:
<disp-formula id="pcbi.1005435.e003"><alternatives><graphic id="pcbi.1005435.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>species</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>i</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>abundance</mml:mtext> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mtext>resources</mml:mtext></mml:munder> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>availability</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>of</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>effective</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>resource</mml:mtext> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>species</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>i</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>effective</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>resource</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>utilization</mml:mtext> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mtext>constant</mml:mtext></mml:mrow></mml:math></alternatives></disp-formula>
People have different diets, behaviors, and genetic predispositions. Thus, the availabilities of the effective resources λ<sub><italic>μ</italic></sub> vary from person-to-person, causing the relative abundances of the species to vary as well. As a result, the relative abundances of species that use similar effective resources will be correlated, and it is possible to solve an inverse problem to learn the <italic>V</italic><sub><italic>iμ</italic></sub> (which species use which effective resources) from these correlations (<xref ref-type="fig" rid="pcbi.1005435.g001">Fig 1C and 1D</xref>).</p>
<p>The effective resource utilizations, <italic>V</italic><sub><italic>iμ</italic></sub>, form the basis for the space of log-ratio transformed relative abundances. This space has dimension <italic>N</italic> − 1 because one degree of freedom is lost due to ignorance of the total population size. As a result, the dimension of the niche space inferred from <italic>relative abundances</italic> is, at most, <italic>M</italic> ≤ <italic>N</italic> − 1. Our maximum diversity hypothesis allows for coexistence even if the number of effective resources is much smaller than the number of consumer species, which is a departure from classical theories of consumer-resource systems based on deterministic dynamics, such as MacArthur’s model. Real systems, however, are much more complex than these deterministic models and there exist many well-known mechanisms (e.g. spatial structure, stochasticity [<xref ref-type="bibr" rid="pcbi.1005435.ref016">16</xref>]) that lead to communities that are more diverse than predicted from classical models. In our statistical inference models used to analyze the microbiome data, we set <italic>M</italic> = <italic>N</italic> − 1 and let the weights of the inferred effective resources determine the dimension of the niche space.</p>
</sec>
<sec id="sec006">
<title>Effective resource models are factor models that can be trained with Common Components Analysis (CoCA)</title>
<p>The maximum diversity hypothesis can be implemented as a statistical inference model, which we present on the example of the HMP dataset. The Human Microbiome Project data are grouped into four bodysites (gut, skin, vagina, and oral cavity). There are two standard approaches to analyzing the data in such a situation: first, the data can be lumped together and principal components analysis (PCA) can be performed on all of it, and second, individual PCAs can be performed for each bodysite. The first approach provides a single basis that describes all of the data, allowing one to make direct comparisons of the bodysites within the new basis. However, PCA performed on all of the bodysites at once cannot separate intra-bodysite variability from inter-bodysite differences—it assumes that everything is Gaussian. The second approach focuses only on the intra-bodysite variation, but it provides a different basis for each bodysite making inter-bodysite comparisons difficult. To overcome these limitations, we developed an approach based on the maximum diversity hypothesis, that we call common components analysis (CoCA). The method identifies the single common basis, <italic>V</italic><sub><italic>iμ</italic></sub>, that simultaneously captures the directions of intra-bodysite variability within every bodysite according to <xref ref-type="disp-formula" rid="pcbi.1005435.e002">Eq 2</xref>. Our approach is related to methods called “approximate simultaneous non-orthogonal diagonalization” in the machine learning literature [<xref ref-type="bibr" rid="pcbi.1005435.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1005435.ref021">21</xref>].</p>
<p>This statistical inference belongs to the class of factor models that perform matrix factorization. Matrix factorization methods are a cornerstone of machine learning and statistics encompassing techniques such as principal components analysis (PCA), principal coordinates analysis (PCoA), archetype analysis, autoencoders, and k-means clustering [<xref ref-type="bibr" rid="pcbi.1005435.ref022">22</xref>–<xref ref-type="bibr" rid="pcbi.1005435.ref024">24</xref>]. These methods can be interpreted in two ways: first, they map the data to a new vector space with lower dimension, and second, they represent generative models based on some latent (or hidden) variables. Below, we provide a brief description of the CoCA algorithm.</p>
</sec>
<sec id="sec007">
<title>Log-ratio transformations</title>
<p>Before developing a latent factor model for relative species abundances, we need to briefly discuss the log-ratio transformations used to tackle the compositional nature of the data; a more detailed discussion is presented in <xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>. Compositional data analysis is focused on ratios of relative abundances. In this work, we use an Additive Log-Ratio (ALR) transform that defines the relative abundance of one species as a reference and measures the ratio of every other species to the reference. Distances between ALR transformed relative abundances are not identical to those computed using a natural metric for compositional data (i.e., the Aitchison metric) but they are highly correlated (<xref ref-type="supplementary-material" rid="pcbi.1005435.s001">S1 Fig</xref>). In the context of our model, log-ratio transformation means that we cannot estimate the matrix of resource utilizations (<bold>V</bold>) directly. Instead, we can only directly estimate an <italic>N</italic> − 1 × <italic>N</italic> − 1 matrix <inline-formula id="pcbi.1005435.e004"><alternatives><graphic id="pcbi.1005435.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">G</mml:mi> <mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, where <bold>G</bold> is a matrix that implements the log-ratio transform (<xref ref-type="sec" rid="sec016">Materials and Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). Before making any statements about the species’ resource utilizations, we have to invert effect of the log-ratio transform to obtain <inline-formula id="pcbi.1005435.e005"><alternatives><graphic id="pcbi.1005435.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi mathvariant="bold">G</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> so that our analyses are not sensitive to the particular choice of transformation. We chose the ALR transform in this work because the pseudoinverse <bold>G</bold><sup>−1</sup> can be computed efficiently under the assumption that <bold>V</bold> is sparse (<xref ref-type="sec" rid="sec016">Materials and Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>).</p>
</sec>
<sec id="sec008">
<title>Diagonalizing the log-ratio transformed covariance matrix</title>
<p>CoCA and PCA have closely related generative models. In each case, a covariance matrix of log-ratio transformed relative abundances takes the form <inline-formula id="pcbi.1005435.e006"><alternatives><graphic id="pcbi.1005435.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mo mathvariant="bold">Ψ</mml:mo> <mml:mo mathvariant="bold">=</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo mathvariant="bold">˜</mml:mo></mml:mover> <mml:mo mathvariant="bold">Σ</mml:mo> <mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo mathvariant="bold">˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> where <bold>Σ</bold> is a diagonal matrix. The differences are as follows. In PCA, <bold>Ψ</bold> is the covariance matrix of the log-ratio transformed relative abundances taken without regard to bodysite and <inline-formula id="pcbi.1005435.e007"><alternatives><graphic id="pcbi.1005435.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo mathvariant="bold">˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is assumed to be orthogonal. In CoCA, by contrast, there is an equation for each bodysite s: <inline-formula id="pcbi.1005435.e008"><alternatives><graphic id="pcbi.1005435.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Ψ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:mo mathvariant="bold">=</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo mathvariant="bold">˜</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo mathvariant="bold">˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. While the diagonal matrix <bold>Σ</bold><sub><bold><italic>s</italic></bold></sub> is specific to each bodysite, the matrix <inline-formula id="pcbi.1005435.e009"><alternatives><graphic id="pcbi.1005435.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is shared across all bodysites, but is not assumed to be orthogonal.</p>
<p>PCoA is a commonly used variant of PCA that performs the factorization on an <italic>implied</italic> covariance matrix derived from a matrix of squared distances. Given that PCA and PCoA are basically the same method (applied in different vector spaces), we will refer only to PCA from now on.</p>
</sec>
<sec id="sec009">
<title>CoCA for relative species abundances</title>
<p>As above, let <italic>x</italic> denote an <italic>N</italic> dimensional vector of relative species abundances and <bold><italic>y</italic></bold> = <bold>G</bold> log <bold><italic>x</italic></bold> denote the (<italic>N</italic> − 1) dimensional vector obtained by taking the additive log-ratio transform of <bold><italic>x</italic></bold> (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). The isometric log-ratio transform could also be have been used for this purpose, but the centered log-ratio transform should not be used because the resulting covariance matrix will not be invertible. Let <inline-formula id="pcbi.1005435.e010"><alternatives><graphic id="pcbi.1005435.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub></mml:math></alternatives></inline-formula> denote the mean of <italic>y</italic> from bodysite <italic>s</italic>, and <bold>Ψ</bold><sub><bold><italic>s</italic></bold></sub> its covariance matrix. We search for a single matrix <inline-formula id="pcbi.1005435.e011"><alternatives><graphic id="pcbi.1005435.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> so that <inline-formula id="pcbi.1005435.e012"><alternatives><graphic id="pcbi.1005435.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:msub><mml:mo mathvariant="bold">Ψ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:mo mathvariant="bold">=</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo mathvariant="bold">˜</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is satisfied for all bodysites <italic>s</italic>. We require <bold>Σ</bold><sub><bold><italic>s</italic></bold></sub> to be diagonal, as in PCA, but do not require <inline-formula id="pcbi.1005435.e013"><alternatives><graphic id="pcbi.1005435.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> to be orthogonal. This performs a simultaneous diagonalization of the covariance matrices from each bodysite. <italic>It is crucial to remember that a set of unrelated covariance matrices cannot be simultaneously diagonalized (see</italic> <xref ref-type="supplementary-material" rid="pcbi.1005435.s002">S2 Fig</xref> Thus, CoCA is not a general analysis technique like PCA; instead, it is only applicable to situations where multiple covariance matrices arise from the same underlying generative process.</p>
<p>Like in PCA, we can formulate CoCA as a generative model, which closely follows the model of maximum diversity of <xref ref-type="disp-formula" rid="pcbi.1005435.e002">Eq 2</xref>. In each bodysite <italic>s</italic>, the log-ratio transformed abundances are generated randomly as
<disp-formula id="pcbi.1005435.e014"><alternatives><graphic id="pcbi.1005435.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">λ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="1.em"/><mml:msub><mml:mo mathvariant="bold">λ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">λ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:mo mathvariant="bold">+</mml:mo> <mml:mi>δ</mml:mi> <mml:msub><mml:mo mathvariant="bold">λ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
where the mean <inline-formula id="pcbi.1005435.e015"><alternatives><graphic id="pcbi.1005435.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mover accent="true"><mml:mo mathvariant="bold">λ</mml:mo> <mml:mo>¯</mml:mo></mml:mover> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is expressed in the basis of <inline-formula id="pcbi.1005435.e016"><alternatives><graphic id="pcbi.1005435.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and <italic>δ</italic><bold>λ</bold><sub><bold><italic>s</italic></bold></sub> is a Gaussian random vector of zero mean and diagonal covariance matrix <bold>Σ</bold><sub><bold><italic>s</italic></bold></sub>. In this equation, we have assumed that the experimental errors are small relative to the intra-bodysite variation in the relative abundances so that they can be neglected. Maximizing the log-likelihood is equivalent to minimizing the KL-divergence between the assumed distribution and the empirical distribution. The fraction of samples coming from bodysite <italic>s</italic> is <italic>p</italic><sub><italic>s</italic></sub>, and the bodysite labels are known. Therefore, the total negative log-likelihood is a weighted sum of each of the individual negative log-likelihoods. The matrices <inline-formula id="pcbi.1005435.e017"><alternatives><graphic id="pcbi.1005435.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005435.e018"><alternatives><graphic id="pcbi.1005435.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> can be inferred by minimizing this conditional negative log-likelihood:
<disp-formula id="pcbi.1005435.e019"><alternatives><graphic id="pcbi.1005435.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>s</mml:mi></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>Tr</mml:mtext></mml:mrow> <mml:mrow><mml:mo>[</mml:mo> <mml:msub><mml:mo mathvariant="bold">Ψ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mo form="prefix">log</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mrow><mml:mo>|</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula>
The objective function was minimized with respect to <inline-formula id="pcbi.1005435.e020"><alternatives><graphic id="pcbi.1005435.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and the diagonal matrices <bold>Σ</bold><sub><bold><italic>s</italic></bold></sub> using gradient descent (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>).</p>
</sec>
<sec id="sec010">
<title>Inverting the log-ratio transform</title>
<p>The procedure above infers the transformed matrices <inline-formula id="pcbi.1005435.e021"><alternatives><graphic id="pcbi.1005435.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">G</mml:mi> <mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. In order to interpret these numbers, we first need to invert the log-ratio transform and recover the matrix of resource utilizations in the original space, “<inline-formula id="pcbi.1005435.e022"><alternatives><graphic id="pcbi.1005435.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi mathvariant="bold">G</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>.” The log-ratio transformation matrix <bold>G</bold> has dimensions <italic>N</italic> − 1 × <italic>N</italic> and, therefore, is not uniquely invertible (hence the quotation marks). However, if we assume that <bold>V</bold> is sparse then it is possible to uniquely solve for <bold>V</bold> in terms of the inferred <inline-formula id="pcbi.1005435.e023"><alternatives><graphic id="pcbi.1005435.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. In the context of our ecological model, this assumption means that any individual consumer species is unlikely to be able to utilize every effective resource. The algorithm for sparse inversion of the log-ratio transformation (<xref ref-type="sec" rid="sec016">Materials and Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>) was applied to the component matrices obtained from both PCA and CoCA before performing any species comparisons based on the inferred resource utilizations.</p>
<p>Log-ratio transformations (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>) ensure that Euclidean distances in the transformed space can be used to estimate beta diversity—though, only the isometric log-ratio transform ensures that these distances coincide with the Aitchison metric for compositional data (<xref ref-type="supplementary-material" rid="pcbi.1005435.s001">S1 Fig</xref>). It is, of course, possible to choose from many different distance metrics, such as Bray-Curtis or UniFrac [<xref ref-type="bibr" rid="pcbi.1005435.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref026">26</xref>]. Using other metrics, an appropriate dimensionality reduction is Principal Coordinates Analysis (PCoA), or classical multidimensional scaling [<xref ref-type="bibr" rid="pcbi.1005435.ref027">27</xref>], rather than PCA. It is also possible to develop an analogous CoCA for these alternative distance metrics, but the theoretical interpretation as a consumer-resource system derived from the maximum diversity hypothesis would no longer apply.</p>
</sec>
</sec>
<sec id="sec011">
<title>Analysis</title>
<p>Although we have stated the maximum diversity hypothesis as a generative model of species composition, we rarely know, and generally cannot measure, all of the effective resources in a community. Therefore, we treat the mathematical model as an inverse problem with the goal of inferring the effective resources from observations of species composition across many individuals and bodysites. The inverse problem can be solved because, by construction, the model imposes that the inferred effective resources correspond to directions with high intra-bodysite variability (<xref ref-type="fig" rid="pcbi.1005435.g002">Fig 2A–2C</xref>). We exploit this feature to developed a technique we called CoCA that infers the characteristics of the species and habitats from observed correlations (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). Like other techniques for simultaneous matrix diagonalization [<xref ref-type="bibr" rid="pcbi.1005435.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1005435.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref028">28</xref>], CoCA aims to find a single set of directions that simultaneously explain variation within each of the bodysites. Moreover, CoCA has a theoretical interpretation derived from the maximum diversity hypothesis and properly accounts for the compositional nature of genomic survey data.</p>
<fig id="pcbi.1005435.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005435.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Describing intra-bodysite variability with common components analysis.</title>
<p>A) Covariation of the relative abundances along any direction captures both inter-bodysite differences and intra-bodysite variability. B) The law of total variance states that the variance along a direction is variance = (inter-bodysite differences)<sup>2</sup> + intra-bodysite variance. C) Common Components Analysis (CoCA) finds a common set of directions that simultaneously capture intra-bodysite variability in each of the four bodysites. D) Most of the intra-bodysite variability in species composition can be explained with a small number of common components. E) Projecting the samples onto two common components with large inter-bodysite differences and small intra-bodysite variation clearly separates the four body sites.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.g002" xlink:type="simple"/>
</fig>
<p>Our statistical analysis of the data from the Human Microbiome Project (HMP) centers on three observations:</p>
<list list-type="order">
<list-item>
<p>The covariance matrices from the bodysites are simultaneously diagonalizable and, thus, have a common basis.</p>
</list-item>
<list-item>
<p>Species that are close together in this common basis are also closely related taxonomically.</p>
</list-item>
<list-item>
<p>(Corollary) Distances between species in the common basis can be predicted from the similarities of the species in a small number of metabolic pathways.</p>
</list-item>
</list>
<p>The first point is a validation of our mathematical model, whereas points 2 and 3 demonstrate that the results obtained by CoCA have biologically reasonable interpretations. Point 3 is a corollary of point 2; if taxonomy explains species relationships in the common basis then it follows that there will also be a relationship with characteristics that vary by taxonomy (e.g., metabolic pathways). Nevertheless, it is important to check that the pathways that are selected make biological sense. We compare the CoCA results to PCA, as well as to the results of the CoCA algorithm applied to randomized data (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>).</p>
<sec id="sec012">
<title>The covariance matrices from the bodysites are simultaneously diagonalizable and, thus, have a common basis</title>
<p>We applied CoCA to study the relative abundances of <italic>N</italic> = 100 highly abundant species from the HMP (SI). To validate the mathematical model underlying CoCA, we verified that its assumptions, which are rooted in our hypothesis that compositional variation is driven by habitat fluctuations, are not violated (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). In general, it is not possible to find single basis that simultaneously diagonalizes multiple covariance matrices. Thus, the CoCA algorithm will fail actually fail if the underlying data are not generated by a set of latent variables reflecting a common biological process underlying intra-bodysite variability. PCA, by contrast, always finds the basis that explains the maximum <italic>total</italic> (rather than intra-bodysite) variation using the smallest number of components, even if the assumptions underlying the generative model (e.g. normality) are violated.</p>
<p>We tested our model by applying CoCA to both the real covariance matrices constructed from data, and to randomized covariance matrices that do not have a common basis (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). The top row of <xref ref-type="fig" rid="pcbi.1005435.g003">Fig 3</xref> shows that CoCA identifies a common basis that explains the observed covariances quite well, with <italic>R</italic><sup>2</sup> ≥ 0.78. As expected, the second row of <xref ref-type="fig" rid="pcbi.1005435.g003">Fig 3</xref> shows that the CoCA algorithm cannot fit the covariance matrices after randomization, with <italic>R</italic><sup>2</sup> = 0 in all bodysites. In contrast to PCA, the vectors defining the common basis do not need to be orthogonal. Therefore, it is also necessary to check that variation along these directions is uncorrelated within each bodysite. <xref ref-type="supplementary-material" rid="pcbi.1005435.s002">S2 Fig</xref> shows that the variances along each direction agree nearly perfectly with the inferred variances (i.e., <italic>Σ</italic><sub><italic>ij</italic>|<italic>s</italic></sub>), and <xref ref-type="supplementary-material" rid="pcbi.1005435.s003">S3 Fig</xref> shows that the correlations between the inferred components are small. Taken together, these results demonstrate that observed covariance matrices are approximately simultaneously diagonalizable, and that the observed performance is not due to chance.</p>
<fig id="pcbi.1005435.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005435.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Goodness-of-fit of the common components analysis model.</title>
<p>Correlations between the observed covariances (<bold>Σ</bold><sub><bold><italic>s</italic></bold></sub>) and those computed from CoCA (<inline-formula id="pcbi.1005435.e024"><alternatives><graphic id="pcbi.1005435.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:msub><mml:mo mathvariant="bold">Σ</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi></mml:msub> <mml:msup><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>) in each of the 4 body sites. (Insets) The distribution of correlations from all 20 randomizations, which are roughly an order of magnitude smaller than the observed values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.g003" xlink:type="simple"/>
</fig>
<p>
<xref ref-type="fig" rid="pcbi.1005435.g002">Fig 2D</xref> shows that CoCA identifies a few components (i.e., effective resources) that explain most of the intra-bodysite variation in the human microbiota. Even though the CoCA components only capture the directions that explain intra-bodysite variability, they can be ranked by the ratio of how much they vary between bodysites to how much they vary within bodysites. Sorting the CoCA components in this way identifies directions that clearly separate all four bodysites into coherent clusters (<xref ref-type="fig" rid="pcbi.1005435.g002">Fig 2E</xref>). By contrast, the principal components are typically ranked based on their contribution to total variability, which is a mixture of inter- and intra-bodysite variation. Thus, highly ranked principal components may correspond to directions with large intra-bodysite variations, causing them to miss directions with large inter-bodysite differences. As a result, the two largest principal components are unable to separate all four bodysites (<xref ref-type="supplementary-material" rid="pcbi.1005435.s005">S5</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005435.s006">S6</xref> Figs).</p>
</sec>
<sec id="sec013">
<title>Species that are close together in this common basis are also closely related taxonomically</title>
<p>CoCA describes each species as a vector where, after recovery of the sparse matrix <bold>V</bold> from the inferred <inline-formula id="pcbi.1005435.e025"><alternatives><graphic id="pcbi.1005435.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, each element of the vector describes the ability of that species to use one of the effective resources. Thus, the angle between two of these vectors describes how similar the two species are in terms of their abilities to use the effective resources. Species that are positively correlated are close together in this ‘niche space’, whereas species that are uncorrelated (or anti-correlated) are far apart. <xref ref-type="fig" rid="pcbi.1005435.g004">Fig 4A</xref> shows all of the species connected into a tree, so that each species is only connected to other species with similar effective resource utilizations. Coloring the tree by taxonomic classification at the level of ‘order’ reveals that the species cluster into taxonomically coherent groups [<xref ref-type="bibr" rid="pcbi.1005435.ref029">29</xref>]. In fact, the more similar two species are in terms of taxonomy, the closer they are in this niche space (<xref ref-type="fig" rid="pcbi.1005435.g004">Fig 4B</xref>; <xref ref-type="supplementary-material" rid="pcbi.1005435.s004">S4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005435.s006">S6</xref> Figs). To put it another way, the relative abundances of related species are highly correlated because they have similar resource requirements. This is true even though species that use similar resources are competing with each other. The intuition derived from dynamical models that the abundances of competing species should be anti-correlated simply does not apply when the habitat conditions are highly variable.</p>
<fig id="pcbi.1005435.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005435.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Visualizing the niche space of the human microbiota.</title>
<p>Each species can be described as a vector within a niche space that describes the ability of a species to utilize the effective resources, weighted by the average variability of that resource within each of the bodysites. Distances between two species in this niche space were quantified with a metric that measures the angle the two vectors (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). A) The minimum spanning tree of the niche space connects all of the species so that the average distance between connected species is as small as possible. Thus, two species are connected if they have similar effective resource utilizations. The species are colored according to their taxonomic classification at level ‘order’. Only the top eight orders with the most representative species are colored; species in underrepresented orders are shown in gray. B) The distance between species in the niche space obtained from CoCA is strongly related to species similarity. Here, the taxonomic distance between two species is five minus the number of overlapping taxonomic levels. See SI for discussion of statistical significance.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Distances between species in the common basis can be predicted from the similarities of the species in a small number of metabolic pathways</title>
<p>So far, we have described the components derived from CoCA as abstract resources that represent unknown abiotic and biotic factors in the habitat. To check that these effective resources correspond to biologically meaningful functions, we regressed the distances between species in the CoCA derived niche space against inter-species distances computed from KEGG functional pathways (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>) [<xref ref-type="bibr" rid="pcbi.1005435.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref031">31</xref>]. As we have focused on the taxonomic description of communities, we compiled functional information from taxonomic classifications to maintain the same level of granularity (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). A similar analysis could be performed by mapping CoCA effective resources to functional categories directly from whole genome sequencing data, or from functional information estimated using PICRUSt or Tax4Fun [<xref ref-type="bibr" rid="pcbi.1005435.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref033">33</xref>] for 16S community surveys. We used a statistical technique called the Bayesian Ising Approximation to assign a posterior probability to each KEGG pathway [<xref ref-type="bibr" rid="pcbi.1005435.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref035">35</xref>] (<xref ref-type="sec" rid="sec016">Materials and Methods</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). The posterior probability is a measure of degree of belief; it quantifies how relevant each KEGG pathway is for computing the similarity between species derived from CoCA. A histogram of the posterior probabilities is shown in <xref ref-type="fig" rid="pcbi.1005435.g005">Fig 5A</xref> (also <xref ref-type="supplementary-material" rid="pcbi.1005435.s007">S7</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005435.s008">S8</xref> Figs). We designated pathways as relevant if they had a posterior probability greater than 0.95. The 17 pathways reaching this threshold for relevance are listed in alphabetical order in <xref ref-type="fig" rid="pcbi.1005435.g005">Fig 5B</xref>. Taken together, these relevant pathways explain roughly half of the variation in the distances between species in the CoCA derived niche space (<xref ref-type="fig" rid="pcbi.1005435.g005">Fig 5C</xref>). Thus, the percentage of variance explained by the pathways is roughly equivalent to the variance explained by taxonomy, as one would expect if the two analyses pick up on the same underlying relationship. The relevant pathways are primarily associated with carbon metabolism or maintenance of the cell wall. Thus, CoCA highlights the ecological separation between aerobic and anaerobic species and between gram positive and gram negative bacteria, pointing to the importance of both metabolic processes and host-microbiome interactions for structuring the human microbiota.</p>
<fig id="pcbi.1005435.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005435.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Functional pathways related to inter-species distances in niche space.</title>
<p>We performed a linear regression of the squared distances computed from CoCA against the squared distances computed from KEGG functional pathways (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). Each pathway was assigned a probability that it contributes to the distances between species in niche space (i.e. that the regression coefficient associated with the pathway is nonzero) using a Bayesian model selection algorithm (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). A) A histogram of the probabilities associated with each of the KEGG pathways. We defined pathways as significantly associated if they had a posterior probability greater than 0.95, and the bar representing the significant pathways is shown in red. B) A list of the relevant functional pathways in alphabetical order. C) The regression using just these relevant pathways has a correlation coefficient of <italic>R</italic><sup>2</sup> = 0.47.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.g005" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec015">
<title>Conclusion</title>
<p>Previous studies have revealed that bacteria exhibit tremendous genomic and functional diversity due, in part, to high rates of horizontal gene transfer (HGT) [<xref ref-type="bibr" rid="pcbi.1005435.ref036">36</xref>]. As a result, the ability of sequence-based or taxonomic classification of bacteria to capture ecological relationships has been called into question [<xref ref-type="bibr" rid="pcbi.1005435.ref037">37</xref>–<xref ref-type="bibr" rid="pcbi.1005435.ref040">40</xref>]. Nevertheless, we found that genetically related species respond to fluctuating habitat conditions in the same way, implying that they occupy similar ecological niches. Thus, current taxonomic groupings of bacteria are largely sufficient for explaining cross-sectional correlations in relative species abundances over the healthy human population. This result is not at odds with high rates of HGT; it simply implies ecologically derived constraints on evolution.</p>
<p>We introduced CoCA, a theory-driven data analysis technique that can be applied to any cross-sectional study with labeled metadata, including studies with populations corresponding to healthy and unhealthy individuals. Although the effective resources identified by CoCA are derived entirely from data on relative species abundances across a population, they reflect indirect ecological relationships between species that are mediated through resources and form the basis of a common resource sharing niche space of the human microbiota. Future analyses of larger, and more diverse, datasets will further elucidate the relationship between this underlying niche space and the functional properties of the organisms in the microbiota. Given that CoCA identifies features that separate the bodysites with high fidelity, we believe that it is a useful technique for identifying microbiota based biomarkers that discriminate between host phenotypes. Extending our results to include data from unhealthy subjects will be an important avenue for future work.</p>
<p>A recent paper by Bashan et al [<xref ref-type="bibr" rid="pcbi.1005435.ref041">41</xref>] developed an approach to analyzing microbial dynamics based on a Dissimilarity-Overlap Curve. They found that communities with a high overlap in the species that were present also have a low dissimilarity in their relative abundance profiles. They argue that this relationship is evidence of “universality” where interspecies interactions are essentially the same across a population of human subjects. Our model is also based on the assumption that the underlying drivers of variation in the microbiota are the same across subjects and across bodysites, and it is only the relative importance of these factors that leads to differences between groups. However, we focused only on variation in the relative abundances of highly abundant species that are present across all four major bodysites in the Human Microbiome Project rather than variation in species assemblages.</p>
<p>The successful application of CoCA to HMP data from four different body sites implies that the processes that shape the variation in species abundances are shared between bodysites, and only changes in the specific contribution of various effective resources differentiate bodysites. CoCA uses simultaneous diagonalization to identify processes that are shared between communities. Covariance matrices from communities without shared drivers of variation cannot be simultaneously diagonalized, as we showed with randomized data. Consequently, we would expect that CoCA would fail on datasets from clearly different ecological environments (e.g., hot springs compared to body sites). In this case, failure is not a bad thing: it can be easily diagnosed from the poor agreement between the predicted and observed covariances and it provides an ecologically meaningful result be ruling out the hypothesis that the environments have shared drivers of variation.</p>
<p>CoCA does not explain 100% of the variation in the HMP data, nor do taxonomic relationships explain 100% of the variation in the inferred resource utilizations. The additional variation is likely do to other types of interactions between species in the human microbiota that cannot be captured using effective resources that are shared across bodysites. Moreover, effective resources are only defined by a statistical model and, therefore, do not have obvious relationships to measurable environmental variables. Here, we attempted to explain the inferred effective resources in terms of metabolic processes inferred through KEGG pathways but it is likely that other factors, such as resilience to temperature or pH ranges, contribute to the effective resources in ways that our analysis with KEGG pathways could not uncover.</p>
<p>Our study also has other limitations that should be addressed in future work. We have based our analyses on relative species abundances derived from OTUs constructed using data from the HMP. These data are likely to be noisy, but the degree of uncertainty is difficult to quantify. Moreover, the use of OTUs defined by 97% sequence identity, and subsequent reduction of the communities to 100 highly abundant species, leads to a coarse grained representation that may smooth out relevant features. It will be important to revisit our analyses on additional datasets, and with additional tools for generating highly accurate pictures of community composition. On the theoretical side, it will be important to examine the validity of the maximum diversity hypothesis across communities with different properties.</p>
</sec>
</sec>
<sec id="sec016" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec017">
<title>Data collection</title>
<p>We analyzed data from the Human Microbiome Project (HMP) on person-to-person variability in relative species abundances in four bodysites (gut, oral cavity, vagina, and skin; <xref ref-type="fig" rid="pcbi.1005435.g001">Fig 1A</xref>) [<xref ref-type="bibr" rid="pcbi.1005435.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1005435.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref012">12</xref>]. The species-level relative abundances derived from the HMP whole genome sequencing data were obtained from MG-RAST (Project 385) through the MR-RAST API [<xref ref-type="bibr" rid="pcbi.1005435.ref042">42</xref>]. Only the processed data as provided on the MG-RAST server were extracted. Thus, these species counts were constructed using the default MG-RAST pipeline [<xref ref-type="bibr" rid="pcbi.1005435.ref043">43</xref>]. Briefly, this pipeline identifies putative rRNA fragments and clusters them at 97% identity to define operational taxonomic units, which are assigned species labels using a search against the M5rna database [<xref ref-type="bibr" rid="pcbi.1005435.ref044">44</xref>]. We eliminated any lowly abundant species and selected for further study 100 species (<xref ref-type="fig" rid="pcbi.1005435.g003">Fig 3A</xref>) that were highly abundant across all bodysites, as described in <xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>. The final dataset (consisting of the counts of the 100 selected species in each of the samples) is available in the Supporting Information (<xref ref-type="supplementary-material" rid="pcbi.1005435.s011">S1 Code</xref>) and at <ext-link ext-link-type="uri" xlink:href="https://sites.google.com/site/charleskennethfisher/home/programs-and-data" xlink:type="simple">https://sites.google.com/site/charleskennethfisher/home/programs-and-data</ext-link> along with the source code.</p>
</sec>
<sec id="sec018">
<title>Log-ratio transformations and CoCA</title>
<p>Log-ratio transformations are obtained using <bold><italic>y</italic></bold> = <bold>G</bold> log <bold><italic>x</italic></bold>, where <bold><italic>x</italic></bold> is an <italic>N</italic> dimensional vector of relative abundances, <bold>G</bold> is an <italic>N</italic> − 1 × <italic>N</italic> matrix with <bold>G1</bold> = <bold>0</bold>, and <bold><italic>y</italic></bold> is an <italic>N</italic> − 1 dimensional vector of transformed relative abundances. We use a <bold>G</bold> that implements an additive log-ratio (or ALR) transform, but the choice of <bold>G</bold> is not critical for our analyses and some other possible choices are discussed further in the <xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>. Applying a log-ratio transformation to <xref ref-type="disp-formula" rid="pcbi.1005435.e002">Eq 2</xref> gives <inline-formula id="pcbi.1005435.e026"><alternatives><graphic id="pcbi.1005435.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:mrow><mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">G</mml:mi> <mml:mi mathvariant="bold">V</mml:mi> <mml:mo mathvariant="bold">λ</mml:mo> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo mathvariant="bold">λ</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Here, <bold>V</bold> is an <italic>N</italic> × <italic>N</italic> − 1 dimensional matrix whereas <inline-formula id="pcbi.1005435.e027"><alternatives><graphic id="pcbi.1005435.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">G</mml:mi> <mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> is an <italic>N</italic> − 1 × <italic>N</italic> − 1 dimensional matrix. Once again, the use of relative abundances shows up as a loss of information. The matrix <bold>V</bold> that contains the information about all <italic>N</italic> species that we would like to obtain can only be recovered from <inline-formula id="pcbi.1005435.e028"><alternatives><graphic id="pcbi.1005435.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula> using some assumptions.</p>
<p>The use of compositional transformations with CoCA requires an extra step to recover the <italic>N</italic> × <italic>N</italic> − 1 dimensional matrix <bold>V</bold> from the <italic>N</italic> − 1 × <italic>N</italic> − 1 dimensional matrix <inline-formula id="pcbi.1005435.e029"><alternatives><graphic id="pcbi.1005435.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">G</mml:mi> <mml:mi mathvariant="bold">V</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>. Unfortunately, the matrix <bold>G</bold> is not invertible. But, if we assume that <bold>V</bold> is sparse then it is possible to determine <bold>V</bold> from <inline-formula id="pcbi.1005435.e030"><alternatives><graphic id="pcbi.1005435.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. In the context of the model, this assumption means that any individual consumer species is unlikely to be able to utilize every effective resource. To recover <bold>V</bold> from <inline-formula id="pcbi.1005435.e031"><alternatives><graphic id="pcbi.1005435.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, we solve the problem:
<disp-formula id="pcbi.1005435.e032"><alternatives><graphic id="pcbi.1005435.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:msub><mml:mrow><mml:mo>|</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold">V</mml:mi> <mml:mo>|</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mn>1</mml:mn></mml:msub> <mml:mspace width="4.pt"/><mml:mtext>subject</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>to</mml:mtext> <mml:mspace width="4.pt"/><mml:mi mathvariant="bold">G</mml:mi> <mml:mi mathvariant="bold">V</mml:mi> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
where ||<bold>V</bold>||<sub>1</sub> = ∑<sub><italic>iμ</italic></sub> |<italic>V</italic><sub><italic>iμ</italic></sub>|. Using the ALR transform, all of the solutions to this problem are all of the form <inline-formula id="pcbi.1005435.e033"><alternatives><graphic id="pcbi.1005435.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>μ</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>μ</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>i</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mi>μ</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> for <italic>i</italic> = 1, …, <italic>N</italic>, where <italic>z</italic><sub><italic>μ</italic></sub> can, in principle, take on any real value. Because we want the solution with a minimum <italic>L</italic><sub>1</sub> norm, it is sufficient to test <italic>z</italic><sub><italic>μ</italic></sub> = 0 and <inline-formula id="pcbi.1005435.e034"><alternatives><graphic id="pcbi.1005435.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:mrow><mml:msub><mml:mi>z</mml:mi> <mml:mi>μ</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mrow><mml:mo>{</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>μ</mml:mi></mml:mrow></mml:msub> <mml:mo>}</mml:mo></mml:mrow> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> (the only sparse solutions) and to choose the one with minimum norm. This is a tractable search over <italic>N</italic>(<italic>N</italic> − 1) possibilities in the worst case and can be done easily for reasonable system sizes.</p>
</sec>
<sec id="sec019">
<title>Pathway selection with the Bayesian Ising Approximation</title>
<p>Each row of the matrix <inline-formula id="pcbi.1005435.e035"><alternatives><graphic id="pcbi.1005435.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>=</mml:mo> <mml:mi mathvariant="bold">G</mml:mi> <mml:mover accent="true"><mml:mi mathvariant="bold">V</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula> (here, <bold>G</bold> is a matrix that arises from the log-ratio transform—see details) describes how one of the species responds to changes in the latent variables. Thus, the <italic>i</italic><sup><italic>th</italic></sup> row of <bold>V</bold> is a mathematical representation of species <italic>i</italic>. The distance between species <italic>i</italic> and <italic>j</italic> in the inferred basis can be calculated by computing the distance between the <italic>i</italic><sup><italic>th</italic></sup> and <italic>j</italic><sup><italic>th</italic></sup> rows of <bold>V</bold> with each column (i.e., latent variable) weighted by its variance (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>).</p>
<p>Distances between species computed from the common components were regressed against the distances computed from KEGG pathways (<xref ref-type="supplementary-material" rid="pcbi.1005435.s010">S1 Text</xref>). To select relevant pathways, we compute posterior probabilities for each regression coefficient to be non-zero using the Bayesian Ising Approximation (BIA) [<xref ref-type="bibr" rid="pcbi.1005435.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1005435.ref035">35</xref>]. The BIA approximates the posterior distribution of a vector indicator variables with <italic>s</italic><sub><italic>i</italic></sub> = +1 if pathway <italic>i</italic> relevant and <italic>s</italic><sub><italic>i</italic></sub> = − 1 if pathway <italic>i</italic> is not relevant. The posterior distribution is approximately an Ising model described by:
<disp-formula id="pcbi.1005435.e036"><alternatives><graphic id="pcbi.1005435.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:mtext> </mml:mtext> <mml:msub><mml:mi>P</mml:mi> <mml:mo>λ</mml:mo></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">s</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="bold-italic">y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≃</mml:mo> <mml:mfrac><mml:msup><mml:mi>n</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mn>4</mml:mn> <mml:mo>λ</mml:mo></mml:mrow></mml:mfrac> <mml:mfenced close=")" open="(" separators=""><mml:munder><mml:mo>∑</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mstyle> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>;</mml:mo> <mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>s</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
where the external fields (<italic>h</italic><sub><italic>i</italic></sub>) and couplings (<italic>J</italic><sub><italic>ij</italic></sub>) are defined as:
<disp-formula id="pcbi.1005435.e037"><alternatives><graphic id="pcbi.1005435.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mrow><mml:msub><mml:mi>h</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula> <disp-formula id="pcbi.1005435.e038"><alternatives><graphic id="pcbi.1005435.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e038" xlink:type="simple"/><mml:math display="block" id="M38"><mml:mrow><mml:msub><mml:mi>J</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>λ</mml:mo> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mfrac><mml:mi>n</mml:mi> <mml:mo>λ</mml:mo></mml:mfrac> <mml:mfenced close=")" open="(" separators=""><mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>r</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mstyle> <mml:msup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
and λ is the inverse variance of the prior distribution. Here, <italic>r</italic>(<italic>z</italic><sub>1</sub>, <italic>z</italic><sub>2</sub>) is the Pearson correlation coefficient between variables <italic>z</italic><sub>1</sub> and <italic>z</italic><sub>2</sub>. The BIA approximation is based on a series expansion that is valid as long as:
<disp-formula id="pcbi.1005435.e039"><alternatives><graphic id="pcbi.1005435.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mrow><mml:mo>λ</mml:mo> <mml:mo>≥</mml:mo> <mml:msup><mml:mo>λ</mml:mo> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mi>n</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>p</mml:mi> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
where <inline-formula id="pcbi.1005435.e040"><alternatives><graphic id="pcbi.1005435.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mi>r</mml:mi> <mml:mo>=</mml:mo> <mml:msqrt><mml:mrow><mml:msup><mml:mi>p</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mi>r</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:math></alternatives></inline-formula> is the root mean square correlation between features.</p>
<p>To perform feature selection, we are interested in computing marginal probabilities <italic>P</italic><sub>λ</sub>(<italic>s</italic><sub><italic>j</italic></sub> = 1|<bold>y</bold>) ≃ (1 + <italic>m</italic><sub><italic>j</italic></sub>(λ))/2, where we have defined the magnetizations <italic>m</italic><sub><italic>j</italic></sub>(λ) = 〈<italic>s</italic><sub><italic>j</italic></sub>〉. While there are many techniques for calculating the magnetizations of an Ising model, we focus on the mean field approximation which leads to a self-consistent equation:</p>
<disp-formula id="pcbi.1005435.e041">
<alternatives>
<graphic id="pcbi.1005435.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005435.e041" xlink:type="simple"/>
<mml:math display="block" id="M41"><mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo form="prefix">tanh</mml:mo><mml:mfenced close="]" open="[" separators=""><mml:mfrac><mml:msup><mml:mi>n</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mn>4</mml:mn><mml:mo>λ</mml:mo></mml:mrow></mml:mfrac><mml:mfenced close=")" open="(" separators=""><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mstyle displaystyle="true" scriptlevel="0"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:munder><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>m</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mo>λ</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mfenced></mml:mrow></mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
<p>This mean field approximation provides a computationally efficient tool that approximates Bayesian feature selection for linear regression.</p>
</sec>
</sec>
<sec id="sec020">
<title>Supporting information</title>
<supplementary-material id="pcbi.1005435.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Comparison of the additive logratio (ALR) transform with the Aitchison distance.</title>
<p>A) The Aitchison distance is a metric for relative abundance data based on log-ratios. The ALR transform is not isometric (meaning, it does not preserve distances exactly) but the distances computed with the ALR transformed relative abundances are highly correlated the Aitchison distance (R = 0.87). b) The first two principal coordinates computed using the Aitchison distance. c) The first two principal coordinates computed using the ALR transformed relative abundances (reproduced in <xref ref-type="supplementary-material" rid="pcbi.1005435.s007">S7E Fig</xref>).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Fitting the common components analysis model.</title>
<p>Plot of the CoCA objective function during gradient descent using the true covariance matrices (red, dashed line) and 20 randomized covariances matrices (black lines). The error bars on the final value of the objective function with the randomized matrices represent ± 6 standard deviations.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Comparing the variance in λ to Σ<sub><italic>s</italic></sub>.</title>
<p>(Top row) Correlations between diagonal elements of <bold>Σ<sub><italic>s</italic></sub></bold> and the variances computed from the inferred <bold>λ</bold>’s. (Middle row) Correlations between diagonal elements of <bold>Σ<sub><italic>s</italic></sub></bold> and the variances computed from the inferred <bold>λ</bold>’s for the best of the 20 randomizations. (Bottom row) The distribution of correlations from all 20 randomizations.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Intra-body site correlations between common components.</title>
<p>Histograms of the correlations between λ<sub><italic>μ</italic></sub> and λ<sub><italic>ν</italic></sub>, conditioned on body site, computed from observed covariance matrices (top row) and randomized covariance matrices (bottom row). These plots show that the niche availabilities obtained from the observed data are approximately uncorrelated, whereas those inferred from randomized covariance matrices are not.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Correlation between taxonomic and ecological distances.</title>
<p>Histogram of the correlation between the taxonomic distance and ecological distances computed from randomized covariance matrices. The correlation obtained with the observed data is shown as a dotted red line. The true correlation lies far outside the distribution obtained from randomization.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Schematic comparison of CoCA and PCA.</title>
<p>Each species corresponds to a point in a high dimensional niche space. Fluctuations in the availabilities of the niches from person-to-person cause fluctuations in the relative abundances of the species. If the distribution of niche availabilities does not depend on the bodysite (e.g. gut, skin, etc) then the log-ratio transformed abundances are Gaussian distributed, and the structure of niche space can be inferred using Principal Components Analysis (PCA) by finding the set of axes with the largest variation. If the distribution of the niche availabilities does depend on the bodysite, however, then the log-ratio transformed abundances are drawn from mixture of Gaussians and maximum likelihood fitting of the model identifies a common set of axes, or common components, that approximately diagonalize the covariance matrices in each of the bodysites.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s007" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Comparison of CoCA and PCA on the HMP data.</title>
<p>A) Percentage of variance explained in each bodysite as function of the number of common components. B) Projecting onto two common components with large inter-bodysite differences and small intra-bodysite variation separates the bodysites into coherent clusters. C) Distances between species computed from CoCA are strongly correlated with taxonomy. Note that parts A-C are reproduced from the Main Text to facilitate comparison with PCA. D) Percentage of variance explained in each bodysite as function of the number of principal components. E) Projecting onto the two largest principal components fails to separate the bodysites into coherent clusters. F) Distances between species computed from PCA are only weakly correlated with taxonomy.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s008" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Feature selection path of the Bayesian Ising Approximation.</title>
<p>Posterior probability that each figure (i.e., KEGG pathway) is relevant for computing the ecological distance between species as a function of the variance of the prior distribution (i.e., the inverse of the regularization parameter). The pathways with a posterior probability greater than 0.95 when the inverse regularization parameter is one (i.e, λ*/λ = 1) are shown in red.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s009" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Comparison of BIA to Monte Carlo simulations.</title>
<p>Posterior probabilities estimated using the BIA compared to those computed with Monte Carlo simulations for λ = λ*. Four pathways (shown) reach a posterior probability of 0.95 for Monte Carlo, but not for BIA. All pathways that reached the 0.95 threshold for relevance with the BIA also reached the relevance threshold with Monte Carlo.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s010" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Extended sections on theory and materials and methods.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005435.s011" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005435.s011" xlink:type="simple">
<label>S1 Code</label>
<caption>
<title>Zip archive containing the CoCA code and the processed HMP data.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We would like to thank Thomas Gurry for helpful conversations.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005435.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macarthur</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Levins</surname> <given-names>R</given-names></name>. <article-title>The Limiting Similarity, Convergence, and Divergence of Coexisting Species</article-title>. <source>The American Naturalist</source>. <year>1967</year>;<volume>101</volume>(<issue>921</issue>):<fpage>377</fpage>–<lpage>385</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/282505" xlink:type="simple">10.1086/282505</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chesson</surname> <given-names>P</given-names></name>. <article-title>Mechanisms of maintenance of species diversity</article-title>. <source>Annual review of Ecology and Systematics</source>. <year>2000</year>; p. <fpage>343</fpage>–<lpage>366</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.ecolsys.31.1.343" xlink:type="simple">10.1146/annurev.ecolsys.31.1.343</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Turnbaugh</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Ley</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Hamady</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fraser-Liggett</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>JI</given-names></name>. <article-title>The human microbiome project</article-title>. <source>Nature</source>. <year>2007</year>;<volume>449</volume>(<issue>7164</issue>):<fpage>804</fpage>–<lpage>810</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature06244" xlink:type="simple">10.1038/nature06244</ext-link></comment> <object-id pub-id-type="pmid">17943116</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>Consortium HMP</collab>, <etal>et al</etal>. <article-title>A framework for human microbiome research</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>215</fpage>–<lpage>221</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11209" xlink:type="simple">10.1038/nature11209</ext-link></comment> <object-id pub-id-type="pmid">22699610</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>Consortium HMP</collab>, <etal>et al</etal>. <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>207</fpage>–<lpage>214</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link></comment> <object-id pub-id-type="pmid">22699609</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dewhirst</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Izard</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paster</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Tanner</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>WH</given-names></name>, <etal>et al</etal>. <article-title>The human oral microbiome</article-title>. <source>Journal of bacteriology</source>. <year>2010</year>;<volume>192</volume>(<issue>19</issue>):<fpage>5002</fpage>–<lpage>5017</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JB.00542-10" xlink:type="simple">10.1128/JB.00542-10</ext-link></comment> <object-id pub-id-type="pmid">20656903</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wooley</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Godzik</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Friedberg</surname> <given-names>I</given-names></name>. <article-title>A primer on metagenomics</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>2</issue>):<fpage>e1000667</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000667" xlink:type="simple">10.1371/journal.pcbi.1000667</ext-link></comment> <object-id pub-id-type="pmid">20195499</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Caporaso</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>Lauber</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Costello</surname> <given-names>EK</given-names></name>, <name name-style="western"><surname>Berg-Lyons</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gonzalez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stombaugh</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Moving pictures of the human microbiome</article-title>. <source>Genome Biol</source>. <year>2011</year>;<volume>12</volume>(<issue>5</issue>):<fpage>R50</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2011-12-5-r50" xlink:type="simple">10.1186/gb-2011-12-5-r50</ext-link></comment> <object-id pub-id-type="pmid">21624126</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yatsunenko</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Rey</surname> <given-names>FE</given-names></name>, <name name-style="western"><surname>Manary</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Trehan</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Dominguez-Bello</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Contreras</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>Human gut microbiome viewed across age and geography</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>222</fpage>–<lpage>227</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature11053" xlink:type="simple">10.1038/nature11053</ext-link></comment> <object-id pub-id-type="pmid">22699611</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Costello</surname> <given-names>EK</given-names></name>, <name name-style="western"><surname>Lauber</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Hamady</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fierer</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>. <article-title>Bacterial community variation in human body habitats across space and time</article-title>. <source>Science</source>. <year>2009</year>;<volume>326</volume>(<issue>5960</issue>):<fpage>1694</fpage>–<lpage>1697</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1177486" xlink:type="simple">10.1126/science.1177486</ext-link></comment> <object-id pub-id-type="pmid">19892944</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Claesson</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Cusack</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>O’Sullivan</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Greene-Diniz</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>de Weerd</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Flannery</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Composition, variability, and temporal stability of the intestinal microbiota of the elderly</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year>;<volume>108</volume>(<issue>Supplement 1</issue>):<fpage>4586</fpage>–<lpage>4591</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1000097107" xlink:type="simple">10.1073/pnas.1000097107</ext-link></comment> <object-id pub-id-type="pmid">20571116</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gevers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Petrosino</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>McGuire</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Birren</surname> <given-names>BW</given-names></name>, <etal>et al</etal>. <article-title>The human microbiome project: a community resource for the healthy human microbiome</article-title>. <source>PLoS biology</source>. <year>2012</year>;<volume>10</volume>(<issue>8</issue>):<fpage>e1001377</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.1001377" xlink:type="simple">10.1371/journal.pbio.1001377</ext-link></comment> <object-id pub-id-type="pmid">22904687</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mac Arthur</surname> <given-names>R</given-names></name>. <article-title>Species packing, and what competition minimizes</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1969</year>;<volume>64</volume>(<issue>4</issue>):<fpage>1369</fpage>–<lpage>1371</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.64.4.1369" xlink:type="simple">10.1073/pnas.64.4.1369</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>MacArthur</surname> <given-names>R</given-names></name>. <article-title>Species packing and competitive equilibrium for many species</article-title>. <source>Theoretical population biology</source>. <year>1970</year>;<volume>1</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0040-5809(70)90039-0" xlink:type="simple">10.1016/0040-5809(70)90039-0</ext-link></comment> <object-id pub-id-type="pmid">5527624</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chesson</surname> <given-names>P</given-names></name>. <article-title>MacArthur’s consumer-resource model</article-title>. <source>Theoretical Population Biology</source>. <year>1990</year>;<volume>37</volume>(<issue>1</issue>):<fpage>26</fpage>–<lpage>38</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0040-5809(90)90025-Q" xlink:type="simple">10.1016/0040-5809(90)90025-Q</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wright</surname> <given-names>JS</given-names></name>. <article-title>Plant diversity in tropical forests: a review of mechanisms of species coexistence</article-title>. <source>Oecologia</source>. <year>2002</year>;<volume>130</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s004420100809" xlink:type="simple">10.1007/s004420100809</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shannon</surname> <given-names>CE</given-names></name>. <article-title>A mathematical theory of communication</article-title>. <source>ACM SIGMOBILE Mobile Computing and Communications Review</source>. <year>2001</year>;<volume>5</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1145/584091.584093" xlink:type="simple">10.1145/584091.584093</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>MacArthur</surname> <given-names>R</given-names></name>. <article-title>Fluctuations of animal populations and a measure of community stability</article-title>. <source>ecology</source>. <year>1955</year>;<volume>36</volume>(<issue>3</issue>):<fpage>533</fpage>–<lpage>536</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/1929601" xlink:type="simple">10.2307/1929601</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Flury</surname> <given-names>BK</given-names></name>. <article-title>Two generalizations of the common principal component model</article-title>. <source>Biometrika</source>. <year>1987</year>;<volume>74</volume>(<issue>1</issue>):<fpage>59</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biomet/74.1.59" xlink:type="simple">10.1093/biomet/74.1.59</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vollgraf</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Obermayer</surname> <given-names>K</given-names></name>. <article-title>Quadratic optimization for simultaneous matrix diagonalization</article-title>. <source>Signal Processing, IEEE Transactions on</source>. <year>2006</year>;<volume>54</volume>(<issue>9</issue>):<fpage>3270</fpage>–<lpage>3278</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TSP.2006.877673" xlink:type="simple">10.1109/TSP.2006.877673</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trendafilov</surname> <given-names>NT</given-names></name>. <article-title>Stepwise estimation of common principal components</article-title>. <source>Computational Statistics &amp; Data Analysis</source>. <year>2010</year>;<volume>54</volume>(<issue>12</issue>):<fpage>3446</fpage>–<lpage>3457</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.csda.2010.03.010" xlink:type="simple">10.1016/j.csda.2010.03.010</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref022">
<label>22</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Udell</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Horn</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Zadeh</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Boyd</surname> <given-names>S</given-names></name>. <source>Generalized low rank models</source>. arXiv preprint arXiv:14100342. <year>2014</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005435.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cutler</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Breiman</surname> <given-names>L</given-names></name>. <article-title>Archetypal analysis</article-title>. <source>Technometrics</source>. <year>1994</year>;<volume>36</volume>(<issue>4</issue>):<fpage>338</fpage>–<lpage>347</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/00401706.1994.10485840" xlink:type="simple">10.1080/00401706.1994.10485840</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref024">
<label>24</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bauckhage</surname> <given-names>C</given-names></name>. <source>k-Means Clustering Is Matrix Factorization</source>. arXiv preprint arXiv:151207548. <year>2015</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005435.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bray</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Curtis</surname> <given-names>JT</given-names></name>. <article-title>An ordination of the upland forest communities of southern Wisconsin</article-title>. <source>Ecological monographs</source>. <year>1957</year>;<volume>27</volume>(<issue>4</issue>):<fpage>325</fpage>–<lpage>349</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/1942268" xlink:type="simple">10.2307/1942268</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lozupone</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Knight</surname> <given-names>R</given-names></name>. <article-title>UniFrac: a new phylogenetic method for comparing microbial communities</article-title>. <source>Applied and environmental microbiology</source>. <year>2005</year>;<volume>71</volume>(<issue>12</issue>):<fpage>8228</fpage>–<lpage>8235</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/AEM.71.12.8228-8235.2005" xlink:type="simple">10.1128/AEM.71.12.8228-8235.2005</ext-link></comment> <object-id pub-id-type="pmid">16332807</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref027">
<label>27</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Kruskal</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Wish</surname> <given-names>M</given-names></name>. <source>Multidimensional scaling</source>. <volume>vol. 11</volume>. <publisher-name>Sage</publisher-name>; <year>1978</year>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.4135/9781412985130" xlink:type="simple">10.4135/9781412985130</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref028">
<label>28</label>
<mixed-citation publication-type="other" xlink:type="simple">Wang H, Banerjee A, Boley D. Common component analysis for multiple covariance matrices. In: Proceedings of the 17th ACM SIGKDD international conference on Knowledge discovery and data mining. ACM; 2011. p. 956–964.</mixed-citation>
</ref>
<ref id="pcbi.1005435.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Federhen</surname> <given-names>S</given-names></name>. <article-title>The NCBI taxonomy database</article-title>. <source>Nucleic acids research</source>. <year>2012</year>;<volume>40</volume>(<issue>D1</issue>):<fpage>D136</fpage>–<lpage>D143</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkr1178" xlink:type="simple">10.1093/nar/gkr1178</ext-link></comment> <object-id pub-id-type="pmid">22139910</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kanehisa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Goto</surname> <given-names>S</given-names></name>. <article-title>KEGG: kyoto encyclopedia of genes and genomes</article-title>. <source>Nucleic acids research</source>. <year>2000</year>;<volume>28</volume>(<issue>1</issue>):<fpage>27</fpage>–<lpage>30</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/28.1.27" xlink:type="simple">10.1093/nar/28.1.27</ext-link></comment> <object-id pub-id-type="pmid">10592173</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mazumdar</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Amar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Segrè</surname> <given-names>D</given-names></name>. <article-title>Metabolic proximity in the order of colonization of a microbial community</article-title>. <source>PloS one</source>. <year>2013</year>;<volume>8</volume>(<issue>10</issue>):<fpage>e77617</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0077617" xlink:type="simple">10.1371/journal.pone.0077617</ext-link></comment> <object-id pub-id-type="pmid">24204896</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Langille</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Zaneveld</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Caporaso</surname> <given-names>JG</given-names></name>, <name name-style="western"><surname>McDonald</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Knights</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>JA</given-names></name>, <etal>et al</etal>. <article-title>Predictive functional profiling of microbial communities using 16S rRNA marker gene sequences</article-title>. <source>Nature biotechnology</source>. <year>2013</year>;<volume>31</volume>(<issue>9</issue>):<fpage>814</fpage>–<lpage>821</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2676" xlink:type="simple">10.1038/nbt.2676</ext-link></comment> <object-id pub-id-type="pmid">23975157</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aßhauer</surname> <given-names>KP</given-names></name>, <name name-style="western"><surname>Wemheuer</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Daniel</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Meinicke</surname> <given-names>P</given-names></name>. <article-title>Tax4Fun: predicting functional profiles from metagenomic 16S rRNA data</article-title>. <source>Bioinformatics</source>. <year>2015</year>;<volume>31</volume>(<issue>17</issue>):<fpage>2882</fpage>–<lpage>2884</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv287" xlink:type="simple">10.1093/bioinformatics/btv287</ext-link></comment> <object-id pub-id-type="pmid">25957349</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fisher</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Mehta</surname> <given-names>P</given-names></name>. <article-title>Bayesian feature selection for high-dimensional linear regression via the Ising approximation with applications to genomics</article-title>. <source>Bioinformatics</source>. <year>2015</year>; p. <fpage>btv037</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv037" xlink:type="simple">10.1093/bioinformatics/btv037</ext-link></comment> <object-id pub-id-type="pmid">25619995</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref035">
<label>35</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Fisher</surname> <given-names>CK</given-names></name>, <name name-style="western"><surname>Mehta</surname> <given-names>P</given-names></name>. <source>Bayesian feature selection with strongly-regularizing priors maps to the Ising Model</source>. arXiv preprint arXiv:14110591. <year>2014</year>;.</mixed-citation>
</ref>
<ref id="pcbi.1005435.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smillie</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Cordero</surname> <given-names>OX</given-names></name>, <name name-style="western"><surname>David</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Alm</surname> <given-names>EJ</given-names></name>. <article-title>Ecology drives a global network of gene exchange connecting the human microbiome</article-title>. <source>Nature</source>. <year>2011</year>;<volume>480</volume>(<issue>7376</issue>):<fpage>241</fpage>–<lpage>244</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10571" xlink:type="simple">10.1038/nature10571</ext-link></comment> <object-id pub-id-type="pmid">22037308</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tikhonov</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Leach</surname> <given-names>RW</given-names></name>, <name name-style="western"><surname>Wingreen</surname> <given-names>NS</given-names></name>. <article-title>Interpreting 16S metagenomic data without clustering to achieve sub-OTU resolution</article-title>. <source>The ISME journal</source>. <year>2015</year>;<volume>9</volume>(<issue>1</issue>):<fpage>68</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/ismej.2014.117" xlink:type="simple">10.1038/ismej.2014.117</ext-link></comment> <object-id pub-id-type="pmid">25012900</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Koeppel</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>M</given-names></name>. <article-title>Surprisingly extensive mixed phylogenetic and ecological signals among bacterial Operational Taxonomic Units</article-title>. <source>Nucleic acids research</source>. <year>2013</year>; p. <fpage>gkt241</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkt241" xlink:type="simple">10.1093/nar/gkt241</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Philippot</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Andersson</surname> <given-names>SG</given-names></name>, <name name-style="western"><surname>Battin</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Prosser</surname> <given-names>JI</given-names></name>, <name name-style="western"><surname>Schimel</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Whitman</surname> <given-names>WB</given-names></name>, <etal>et al</etal>. <article-title>The ecological coherence of high bacterial taxonomic ranks</article-title>. <source>Nature Reviews Microbiology</source>. <year>2010</year>;<volume>8</volume>(<issue>7</issue>):<fpage>523</fpage>–<lpage>529</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrmicro2367" xlink:type="simple">10.1038/nrmicro2367</ext-link></comment> <object-id pub-id-type="pmid">20531276</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doolittle</surname> <given-names>WF</given-names></name>. <article-title>Phylogenetic classification and the universal tree</article-title>. <source>Science</source>. <year>1999</year>;<volume>284</volume>(<issue>5423</issue>):<fpage>2124</fpage>–<lpage>2128</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.284.5423.2124" xlink:type="simple">10.1126/science.284.5423.2124</ext-link></comment> <object-id pub-id-type="pmid">10381871</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bashan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Carey</surname> <given-names>VJ</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Hohmann</surname> <given-names>EL</given-names></name>, <etal>et al</etal>. <article-title>Universality of human microbial dynamics</article-title>. <source>Nature</source>. <year>2016</year>;<volume>534</volume>(<issue>7606</issue>):<fpage>259</fpage>–<lpage>262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature18301" xlink:type="simple">10.1038/nature18301</ext-link></comment> <object-id pub-id-type="pmid">27279224</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wilke</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bischof</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Harrison</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Brettin</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>D’Souza</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gerlach</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>A RESTful API for accessing microbial community data for MG-RAST</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>1</issue>):<fpage>e1004008</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004008" xlink:type="simple">10.1371/journal.pcbi.1004008</ext-link></comment> <object-id pub-id-type="pmid">25569221</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Glass</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Wilkening</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wilke</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Antonopoulos</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Meyer</surname> <given-names>F</given-names></name>. <article-title>Using the metagenomics RAST server (MG-RAST) for analyzing shotgun metagenomes</article-title>. <source>Cold Spring Harbor Protocols</source>. <year>2010</year>;(<volume>2010</volume>):pdb–prot5368. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/pdb.prot5368" xlink:type="simple">10.1101/pdb.prot5368</ext-link></comment> <object-id pub-id-type="pmid">20150127</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005435.ref044">
<label>44</label>
<mixed-citation publication-type="other" xlink:type="simple">Wilke A, Glass E, Bischof J, Braithwaite D, Souza M, Gerlach W. MG-RAST technical report and manual for version 3.3. 6–Rev 1; 2013.</mixed-citation>
</ref>
</ref-list>
</back>
</article>