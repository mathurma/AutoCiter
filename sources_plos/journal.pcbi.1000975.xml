<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">10-PLCB-RA-1627R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000975</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biophysics/Biomacromolecule-Ligand Interactions</subject><subject>Biophysics/Macromolecular Assemblies and Machines</subject><subject>Biophysics/Membrane Proteins and Energy Transduction</subject><subject>Biophysics/Theory and Simulation</subject><subject>Computational Biology/Signaling Networks</subject><subject>Computational Biology/Synthetic Biology</subject><subject>Computational Biology/Systems Biology</subject><subject>Computational Biology/Transcriptional Regulation</subject><subject>Pharmacology</subject></subj-group></article-categories><title-group><article-title>Scalable Rule-Based Modelling of Allosteric Proteins and Biochemical Networks</article-title><alt-title alt-title-type="running-head">Rule-Based Modelling of Allosteric Networks</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Ollivier</surname><given-names>Julien F.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Shahrezaei</surname><given-names>Vahid</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Swain</surname><given-names>Peter S.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Centre for Nonlinear Dynamics, Department of Physiology, McGill University, Montreal, Québec, Canada</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Centre for Systems Biology at Edinburgh, University of Edinburgh, Edinburgh, United Kingdom</addr-line>       </aff><aff id="aff3"><label>3</label><addr-line>Department of Mathematics, Imperial College London, London, United Kingdom</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Ranganathan</surname><given-names>Rama</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">UT Southwestern Medical Center, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">julien.ollivier@gmail.com</email> (JFO); <email xlink:type="simple">peter.swain@ed.ac.uk</email> (PSS)</corresp>
<fn fn-type="con"><p>Wrote the paper: JFO PSS. Conceived research: JFO PSS. Designed research: JFO. Performed research: JFO VS. Conceived research.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>11</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>4</day><month>11</month><year>2010</year></pub-date><volume>6</volume><issue>11</issue><elocation-id>e1000975</elocation-id><history>
<date date-type="received"><day>8</day><month>1</month><year>2010</year></date>
<date date-type="accepted"><day>24</day><month>9</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Ollivier et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Much of the complexity of biochemical networks comes from the information-processing abilities of allosteric proteins, be they receptors, ion-channels, signalling molecules or transcription factors. An allosteric protein can be uniquely regulated by each combination of input molecules that it binds. This “regulatory complexity” causes a combinatorial increase in the number of parameters required to fit experimental data as the number of protein interactions increases. It therefore challenges the creation, updating, and re-use of biochemical models. Here, we propose a rule-based modelling framework that exploits the intrinsic modularity of protein structure to address regulatory complexity. Rather than treating proteins as “black boxes”, we model their hierarchical structure and, as conformational changes, internal dynamics. By modelling the regulation of allosteric proteins through these conformational changes, we often decrease the number of parameters required to fit data, and so reduce over-fitting and improve the predictive power of a model. Our method is thermodynamically grounded, imposes detailed balance, and also includes molecular cross-talk and the background activity of enzymes. We use our Allosteric Network Compiler to examine how allostery can facilitate macromolecular assembly and how competitive ligands can change the observed cooperativity of an allosteric protein. We also develop a parsimonious model of G protein-coupled receptors that explains functional selectivity and can predict the rank order of potency of agonists acting through a receptor. Our methodology should provide a basis for scalable, modular and executable modelling of biochemical networks in systems and synthetic biology.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>The complexity of biochemical networks challenges our ability to create quantitative and predictive models of cellular responses to extracellular changes. In these networks, the regulation of allosteric receptors and proteins by multiple drugs or endogenous ligands introduces “regulatory complexity” because a large number of parameters is required to describe such interactions. Protein interactions also give rise to “combinatorial complexity” by generating large numbers of protein complexes and covalent modification states. To address these twin problems, we propose a modelling framework that combines a modular description of protein structure and function with a rule-based description of protein interactions. We define the input-output function of an allosteric protein through its thermodynamic properties and structural components. We show that our “biomolecule-centric” methodology, in contrast to <italic>ad hoc</italic> approaches that emphasize the regulatory logic of interactions, can reduce the number of parameters required to model experimental observations. We also demonstrate how the application of our framework gives insights into the assembly of macromolecular complexes and increases the predictive power of a standard model of G protein-coupled receptors. These benefits are possible in many systems, given the ubiquity of allostery in biochemical networks. Our research delineates a fundamental relationship between allostery, modularity, and complexity in biochemical networks.</p>
</abstract><funding-group><funding-statement>JFO was funded by the National Sciences and Engineering Council of Canada (NSERC, <ext-link ext-link-type="uri" xlink:href="http://www.nserc-crsng.gc.ca" xlink:type="simple">http://www.nserc-crsng.gc.ca</ext-link>), Canadian Institutes of Health Research (CIHR, <ext-link ext-link-type="uri" xlink:href="http://www.cihr-irsc.gc.ca" xlink:type="simple">http://www.cihr-irsc.gc.ca</ext-link>), and Fonds québecois de recherche sur la nature et les technologies (FQRNT, <ext-link ext-link-type="uri" xlink:href="http://www.fqrnt.gouv.qc.ca" xlink:type="simple">http://www.fqrnt.gouv.qc.ca</ext-link>). VS was supported by an NSERC postdoctoral fellowship. PSS is supported by a Scottish Universities Life Sciences Alliance (SULSA, <ext-link ext-link-type="uri" xlink:href="http://www.sulsa.ac.uk" xlink:type="simple">http://www.sulsa.ac.uk</ext-link>) professorship in Systems Biology and held a Canada Research Chair, also in Systems Biology. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>A goal of biology is to understand the structure and function of the biochemical networks that underpin cellular decision-making. One organizing principle is that these networks are inherently modular <xref ref-type="bibr" rid="pcbi.1000975-Hartwell1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1000975-Alon1">[3]</xref>, with specific functions ascribed to a subset of proteins in the network. Yet, like logic gates in electronic circuits, even individual proteins can perform sophisticated computations and integrate multiple inputs <xref ref-type="bibr" rid="pcbi.1000975-Bray1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1000975-Dueber1">[7]</xref>. In engineering, a modular approach to the analysis of a system scales well with the size of the system and its complexity. Indeed, engineers design systems hierarchically with modules comprising other modules. If molecular biology is similarly modular, which structures are the “atomic” modules from which larger modules are constructed? In signalling networks, we may plausibly ascribe this role to protein subunits and domains <xref ref-type="bibr" rid="pcbi.1000975-Pawson3">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Lim1">[9]</xref>. Their function as elementary modules often depends on allosteric transitions: an interaction at one site alters the structure at a distant site via a conformational change. Indeed, allostery increases the information-processing ability of a network because it transforms proteins from passive substrates to dynamic computational elements <xref ref-type="bibr" rid="pcbi.1000975-Smock1">[10]</xref>. A modular approach to the analysis and design of biochemical networks should therefore explicitly describe the computations performed by individual allosteric proteins.</p>
<p>Efforts to tackle complexity in biochemical networks should also exploit the modularity of protein structure. Protein structure is hierarchical, and a given protein often has domains also present in other proteins or repeated subunits. For example, many signalling proteins contain SH2 or PDZ domains, and many receptors, ion channels and enzymes are multimers. In genetic networks, transcription factors are also often multimers or have a common DNA-binding domain, such as a zinc finger or homeobox. The re-use of protein domains is both a simplifying and confounding feature: once a domain has been characterized, that characterization can be used again, but it is also necessary to model molecular cross-talk between signalling pathways that contain proteins with similar structures.</p>
<p><italic>In vivo</italic>, protein interactions can generate both combinatorial and regulatory complexity. Combinatorial complexity is an “explosion” in the number of possible <italic>species</italic> in a system as the number of proteins and interactions in the system increases. It arises because the number of states of a module dramatically increases as its proteins bind ligands as well as each other and as different residues are covalently modified <xref ref-type="bibr" rid="pcbi.1000975-Endy1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Hlavacek1">[12]</xref>. For example, p53, the so-called cellular “gatekeeper”, has 37 known modification sites and so potentially 2<sup>37</sup> states <xref ref-type="bibr" rid="pcbi.1000975-Toledo1">[13]</xref>. Thus, a complete description of the system potentially requires a combinatorially large number of chemically distinct species and reactions. In contrast, “regulatory complexity” is a combinatorial increase in the number of <italic>parameters</italic> required to describe the regulatory interactions within a system as the number of interactions increase. This complexity arises because the strength of protein interactions depends on the state of a module, and each state of the module potentially requires a unique set of parameters to characterize interactions within the module, with other modules in the network, and with molecules external to the network. Measuring this number of parameters <italic>in vivo</italic> is challenging.</p>
<p>Rule-based modelling addresses combinatorial complexity and allows biologists to specify the regulatory logic of a system <xref ref-type="bibr" rid="pcbi.1000975-Hlavacek2">[14]</xref>. Examples include BioNetGen <xref ref-type="bibr" rid="pcbi.1000975-Blinov1">[15]</xref>, Kappa <xref ref-type="bibr" rid="pcbi.1000975-Danos1">[16]</xref>, Moleculizer <xref ref-type="bibr" rid="pcbi.1000975-Lok1">[17]</xref> and StochSim <xref ref-type="bibr" rid="pcbi.1000975-LeNovere1">[18]</xref>. Rather than explicitly enumerating each species and reaction in the network, a rule-based model describes a system as a collection of biomolecules interacting according to a set of rules. Each rule is a template for a reaction that specifies the reactants, products and all relevant biochemical parameters. Thus, combinatorially complex systems are compactly described because a large number of distinct reactions are subsumed in the template encoded by a single rule. An algorithm may automatically infer a complete reaction network prior to simulation or, if the combinatorial complexity is too great, use alternative techniques to simulate the system <xref ref-type="bibr" rid="pcbi.1000975-Danos2">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Colvin1">[20]</xref>. Importantly, some rules also specify contextual conditions that constrain when an interaction can occur and hence encode the regulatory logic of the network. For example, a rule may allow only a doubly phosphorylated MAP kinase to phosphorylate its substrate.</p>
<p>Rule-based formalisms can describe complex biochemical systems, but inherently offer little guidance on avoiding a number of methodological problems. First, using rules to specify the regulatory logic of a system does not address the system's regulatory complexity. Consider G protein-coupled receptors (GPCRs), which allosterically couple an extracellular ligand-binding site to an intracellular G protein-binding site <xref ref-type="bibr" rid="pcbi.1000975-Pierce1">[21]</xref>. GPCRs can be promiscuous, binding multiple intracellular targets <xref ref-type="bibr" rid="pcbi.1000975-Gudermann1">[22]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Kukkonen1">[23]</xref>. Supposing a given GPCR can bind one of <italic>L</italic> different drugs or endogenous ligands and one of <italic>G</italic> different G proteins, then in principle we require <italic>LG</italic> pair-wise cooperativity parameters to describe how each ligand regulates the GPCR's affinity for each G protein. Thus, the number of regulatory parameters scales with <italic>LG</italic>, and the number of rules also scales with <italic>LG</italic> because each parameter is part of a rule with distinct contextual constraints. Promiscuous allosteric proteins can therefore require a large number of rules and parameters to characterize their interactions.</p>
<p>Second, a module should have a well-described function and be easily re-used and “portable” between systems, but most rule-based formalisms are not inherently modular. Modellers typically treat proteins as “black boxes” and define interactions using biochemical equations. In such “interaction-centric” approaches, the regulation of proteins is encoded by rules with <italic>ad hoc</italic> (system-specific) conditions that no longer apply when the proteins interact with different partners. These <italic>ad hoc</italic> rules obfuscate the mechanism underlying allosteric regulation because they do not show explicitly how the intrinsic structural and thermodynamic properties of allosteric proteins generate their functional properties. In contrast, a “biomolecule-centric” approach would encode regulatory logic in the proteins themselves. Fewer changes to rules would then be required to define how a new set of interaction partners regulates the protein's activity. If a model includes protein domains and subunits, re-use of these components would also be simplified.</p>
<p>Finally, models generated by rule-based methods should be thermodynamically correct. In biochemical networks, there are often sets of reversible reactions that connect into a closed loop, forming a thermodynamic cycle. In many of these cycles no free energy is consumed: for example, when proteins bind multiple ligands, when ligands bind several conformations of a protein, or when ion channels bind multiple agonists and have closed, open, and desensitized states. Thermodynamics imposes a mathematical relationship between the equilibrium constants for all the reactions involved in such cycles: their product must be unity. Equilibrium constants cannot therefore be assigned independently. A thermodynamically correct methodology should ensure that a model satisfies this constraint, ideally by construction.</p>
<p>Here, we present a modular and scalable modelling methodology that alleviates the regulatory as well as the combinatorial complexity of biochemical networks. We first describe our modelling framework, which uses a thermodynamically grounded treatment of allostery in which ligands distinguish only the conformational state of allosteric proteins. We also introduce a rule-based modelling tool that implements our methodology: the Allosteric Network Compiler (ANC). We use ANC to examine how allostery can make macromolecular assembly more efficacious. We then show how our modelling framework describes common mechanisms of allostery by mapping the regulatory properties of a protein onto conformational changes in the protein itself and demonstrate how we can ease the analysis of multiple ligands interacting through an allosteric protein. Next, we discuss how our approach reduces regulatory complexity and thereby increases a model's modularity. Finally, we use our framework to develop a model of G protein-coupled receptors whose regulatory complexity scales with (L+G) instead of LG and consequently has greater predictive power. While our major goal is to introduce a new modular modelling methodology rather than its implementation, we have made ANC and the models we discuss available at: <ext-link ext-link-type="uri" xlink:href="http://swainlab.bio.ed.ac.uk/anc" xlink:type="simple">http://swainlab.bio.ed.ac.uk/anc</ext-link>.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>A structurally and thermodynamically grounded rule-based methodology for modeling allosteric proteins and biochemical networks is implemented in ANC</title>
<p>Our method is based on the Monod-Wyman-Changeux (MWC) paradigm of allostery <xref ref-type="bibr" rid="pcbi.1000975-Monod1">[24]</xref>. We assume that allosteric proteins are dynamic and have one or more structural components, such as domains or subunits, with distinct conformations. These conformational states have different biological activity – for example, a basal state with poor affinity to downstream proteins and an active state that can bind these proteins. Thermal fluctuations cause these allosteric components to transition between their two conformations in either a concerted or sequential fashion <xref ref-type="bibr" rid="pcbi.1000975-Koshland1">[25]</xref>. Ligands and other molecules interact non-cooperatively with each conformation of the protein, distinguishing only its conformational state, and so contribute independently to the equilibrium of the allosteric transition. Each such contribution is parameterized by a “regulatory factor” Γ, which gives the fold-change of the equilibrium constant generated by interactions with the ligand. We make a similar independence assumption with respect to the transition state of the allosteric transition such that ligands also contribute independently to the transition's kinetic rate-constants. These contributions to the kinetics are parameterized in terms of one or more “Φ-values”, which give the effect of modifiers on the forward and reverse rates of the allosteric transition (see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>).</p>
<p>Thus, an allosteric protein can be seen as a modular and dynamic computational device, and we can define the input and output of each allosteric component. The input is a “modifier”, a molecule that binds to and locally perturbs the structure of the component; the output is the fraction of time the component spends in each conformation when the allosteric transition is at equilibrium (see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>). Activation corresponds to biasing the equilibrium in favour of the biologically active state; inhibition corresponds to biasing towards the inactive state. Depending on the system, modifiers may be ligands <xref ref-type="bibr" rid="pcbi.1000975-Monod1">[24]</xref>, covalent modifications <xref ref-type="bibr" rid="pcbi.1000975-Volkman1">[26]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Asakura1">[27]</xref>, the conformational state of another component <xref ref-type="bibr" rid="pcbi.1000975-Koshland1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Herzfeld1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Henry1">[29]</xref>, or mutations <xref ref-type="bibr" rid="pcbi.1000975-Ozcan1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Grosman1">[31]</xref>.</p>
<p>An ANC model consists of a set of modular structures and interaction rules. Using our rule-based approach (Tables 1–5 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>, Figures 1–9 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>) and building on the thermodynamic framework described in <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>, each molecule in a system is described using an ANC construct called a <italic>structure</italic>, which captures the true structure of a protein in terms of its components (<xref ref-type="fig" rid="pcbi-1000975-g001">Figure 1A</xref>). ANC-structures contain two types of components: hierarchical components and interaction sites. Hierarchical components have two roles. The first is that of containment and composition: a hierarchical component typically contains interaction sites but can also contain other hierarchical components. Hierarchical components may represent a unit of tertiary structure, such as a protein domain, or of quaternary structure, for example, a protein with multiple subunits. Their second role is to undergo conformational transitions if designated as allosteric, following the two-state model described in <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>. Interaction sites are of three types: catalytic sites (such as a kinase or phosphatase), sites that can be covalently modified, and ligand-binding sites. Next, <italic>rules</italic> specify the interactions between sites and how the strength of these interactions depends on the conformational state or the covalent modifications of a protein (<xref ref-type="fig" rid="pcbi-1000975-g001">Figure 1B</xref>). If the interaction is a binding reaction, the rule gives the association and dissociation rates. If the interaction is enzymatic – such as a phosphorylation or dephosphorylation – then we assume a Michaelis-Menten mechanism, and the rules give the rate of formation of the product and the association and dissociation rates between the sites, which must be a catalytic site and a covalent modification site.</p>
<fig id="pcbi-1000975-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000975.g001</object-id><label>Figure 1</label><caption>
<title>The Allosteric Network Compiler – modelling elements and methodological flowchart.</title>
<p>(<bold>A</bold>) Example structures. Each structure has a name (underlined) and comprises a set of named components. Hierarchical components (triangles) represent part or all of a biomolecule and contain, as denoted by arrows, one or more interaction sites (circles). <italic>Left:</italic> The structure X represents a simple ligand with a single binding site (circle with horizontal bar). <italic>Centre-left:</italic> The structure A represents a generic, divalent allosteric adaptor protein. The adaptor's hierarchical component is allosteric (indicated by a tilde) and transitions between low <italic>(R)</italic> and high-affinity <italic>(T)</italic> conformational states. The dashed lines indicate that each binding site acts as a modifier for the allosteric transition, with each interaction parameterized by the indicated Φ-value, and that ligands can distinguish each conformation. <italic>Centre-right:</italic> The structure R is a simplified model of the nicotinic aceltylcholine receptor (nAChR), following Edelstein <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000975-Edelstein1">[67]</xref> but without desensitized states. The allosteric component transitions between closed <italic>(C)</italic> and open <italic>(O)</italic> states. <italic>Right:</italic> The structure K is a model of a mitogen activated protein kinase (MAPK) with two activating phosphorylation sites (circles with vertical bar and a grey dot as a placeholder for the state) and a catalytic site (circle with cross). The allosteric component transitions between inactive <italic>(I)</italic> and active <italic>(A)</italic> states. Both the phosphorylation sites and the catalytic site are modifiers of the allosteric transition: each successive phosphorylation biases the equilibrium of the enzyme towards the active state by a regulatory factor Γ<sub>Y1</sub> or Γ<sub>Y2</sub>. Each of these interactions is also parameterized by a distinct Φ-value. (<bold>B</bold>) Example rules. A pair of binding rules for the adaptor A and the ligand X specify the association and dissociation rates of A<sub>X</sub> with X when A<sub>X</sub> is in the <italic>R</italic> and <italic>T</italic> states, a similar pair (not shown) specifies the rates for A<sub>Y</sub> and Y, and we define the affinities K<sub>RX</sub> and K<sub>TX</sub> implied by the rates (in gray, e.g. K<sub>RX</sub> = kf<sub>RX</sub>/kb<sub>RX</sub>). A covalent modification rule for the kinase K acting on an unphosphorylated (open dot) downstream target Y follows the Michaelis-Menten mechanism for enzyme-substrate interactions and yields a phosphorylated substrate (filled dot). (<bold>C</bold>) Methodological flowchart. In a model of the adaptor protein A and its ligands X and Y (Figure 7 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>), the rules state that both ligands bind with higher affinity to the <italic>T</italic> state of the adaptor. This model is compiled by ANC to generate a reaction network where horizontal transitions correspond to conformational changes, vertical transitions correspond to binding the ligand X, and transitions into the page represent binding the ligand Y. K<sub>RT</sub> is the allosteric equilibrium constant, while the regulatory factors Γ<sub>X</sub> and Γ<sub>Y</sub> are the differential affinity of the ligands to each conformation of A and are calculated by ANC using the rate constants given in the rules (e.g. Γ<sub>X</sub> = K<sub>TX</sub>/K<sub>RX</sub>). The reaction network is converted into ordinary differential equations by <italic>Facile</italic> and these are simulated in <italic>Matlab</italic> to compute the output response of the system (bound A<sub>Y</sub> vs. X, with A<sub>TOT</sub> = 1, Y<sub>TOT</sub> = 1, K<sub>RT</sub> = 10<sup>−3</sup> K<sub>RX</sub> = 0.1, K<sub>TX</sub> = 10, K<sub>RY</sub> = 0.01, K<sub>TY</sub> = 100, arbitrary units).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.g001" xlink:type="simple"/></fig>
<p>The overall modelling process for a divalent adaptor protein and two ligands is illustrated in <xref ref-type="fig" rid="pcbi-1000975-g001">Figure 1C</xref>. Structures and rules are entered as text and saved to a file (section §2.7 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>). ANC reads the file, creates an initial set of seed structures, and launches an iterative compilation algorithm. At each iteration, the algorithm determines all inter- and intramolecular reactions, the products created, and their biochemical rates. In a subsequent iteration, the newly created products may in turn react to produce yet more species. Once a final biochemical reaction network has been obtained, it is simulated using deterministic or stochastic methods (see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>). The deterministic simulation in <xref ref-type="fig" rid="pcbi-1000975-g001">Figure 1C</xref> shows how upon binding X, which could represent an activated receptor, the adaptor A recruits increasing amounts of Y, which could represent a downstream signalling protein.</p>
</sec><sec id="s2b">
<title>Analysis of the cooperativity of ligand binding to a generic divalent allosteric protein</title>
<p>The generic model of a divalent allosteric protein shown in <xref ref-type="fig" rid="pcbi-1000975-g001">Figure 1C</xref> (full details in Figure 7 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>) can be used to model proteins that play other roles than adaptors. For example, A could be a membrane-bound receptor, X an extra-cellular agonist, and Y an intracellular signalling protein which binds preferentially to the active conformation of the receptor. The usefulness and simplicity of this model motivates us to analyze it mathematically.</p>
<p>In the model, the binding of X and Y to A is cooperative because binding of X to A changes the affinity of A for Y by a factor θ and likewise the binding of Y to A changes the affinity of A for X also by a factor θ. By coarse-graining over the conformations of A (<xref ref-type="fig" rid="pcbi-1000975-g002">Figure 2A</xref>, inset), we can express the cooperativity parameter θ as (section §2.1 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>):<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e001" xlink:type="simple"/><label>(1)</label></disp-formula>where K<sub>RT</sub> is the allosteric equilibrium constant and Γ<sub>X</sub> (or Γ<sub>Y</sub>) is the differential affinity of the X (or Y) to each conformation of A. The cooperativity increases as the degree of bias (Γ<sub>X</sub> and Γ<sub>Y</sub>) that X and Y exert on the conformational transitions of A increase. We can also define the apparent affinity of X and Y to this coarse-grained A:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e002" xlink:type="simple"/><label>(2)</label></disp-formula>These equations relate the underlying parameters of the model to experimental observables: both the affinity K<sub>X</sub> of X to A and the affinity θK<sub>X</sub> of X to A when A is bound by Y are measurable.</p>
<fig id="pcbi-1000975-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000975.g002</object-id><label>Figure 2</label><caption>
<title>Allostery makes macromolecular assembly robust and controllable.</title>
<p>(<bold>A</bold>) Effect of allostery on macromolecular assembly when a linker component is over-expressed. Each curve shows the equilibrium concentration of the XAY trimer against the total amount of A. The total amount of X and Y was unity, while K<sub>RT</sub> and the affinities of X and Y to each conformation of A (K<sub>RX</sub>, K<sub>RY</sub>, K<sub>TX</sub>, K<sub>TY</sub>) were chosen to yield a desired value of θ and with K<sub>X</sub> = K<sub>Y</sub> = 1. <italic>Inset</italic>: A coarse-grained version of the divalent protein model of <xref ref-type="fig" rid="pcbi-1000975-g001">Figure 1C</xref> sums over the two possible conformations of A and shows that with K<sub>X</sub>, K<sub>Y</sub> and the concentrations of X and Y held constant, the efficacy of assembly depends only on the cooperativity parameter θ. (<bold>B</bold>) Regulation of cooperativity and assembly. The value of θ depends on the other parameters of the model through Equation 1, which is plotted against K<sub>RT</sub> on one axis and Γ<sub>X</sub> and Γ<sub>Y</sub> (assumed equal) on the other. Increasing Γ<sub>X</sub> and Γ<sub>Y</sub> always increases cooperativity, however θ has a maximum value as K<sub>RT</sub> is changed.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.g002" xlink:type="simple"/></fig></sec><sec id="s2c">
<title>Allostery can make macromolecular assembly robust even when linker proteins are over-abundant</title>
<p>Counter-intuitively, an excess of some components of a macromolecular complex can inhibit formation of the complex <xref ref-type="bibr" rid="pcbi.1000975-Bray2">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Swain1">[33]</xref>. This phenomenon, called the prozone effect, is strongest for a protein that links two or more separable parts of a complex. It occurs because the linker protein competes with itself for the binding of the other components of the complex, and so if it is present in excessively high amounts, few of the linker proteins will succeed in simultaneously binding all the other components, resulting in partially formed complexes.</p>
<p>Here, we show that allostery can mitigate the prozone effect, at least for a divalent allosteric protein. We consider the divalent structure A to represent a linking protein with X and Y being the remaining parts of a complex. In <xref ref-type="fig" rid="pcbi-1000975-g002">Figure 2A</xref>, we demonstrate how increasing the cooperativity increases the range of concentrations of A for which assembly of the complex XAY is efficacious (i.e. where the equilibrium amount of complex exceeds 50% of the maximum amount). This range increases from 1.3 decades when θ = 1 to 4.0 decades when θ = 10<sup>4</sup>, and the maximal amount of complex formed increases by a factor of 5.7 (Figure 11 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>). Thus, an allosteric linker protein has a dual benefit in macromolecular assembly: it both increases the amount of complex when the components are present in their stochiometric amounts and makes complex formation more robust to the over-expression of the linker protein. Allosteric linker proteins could explain the low correlation observed between over-expression of a linker protein and lethality of that over-expression in budding yeast <xref ref-type="bibr" rid="pcbi.1000975-Oberdorf1">[34]</xref>.</p>
<p>That the efficacy of macromolecular assembly depends strongly on the value of the cooperativity parameter θ suggests that assembly could be modulated by changing θ. <xref ref-type="fig" rid="pcbi-1000975-g002">Figure 2B</xref> shows the dependence of θ on the allosteric equilibrium constant and the differential affinity of the ligands X and Y. Cooperativity has a maximum at K<sub>RT</sub> = (Γ<sub>X</sub>Γ<sub>Y</sub>)<sup>−1/2</sup> and thus assembly of the XAY trimer could in principle be controlled through the binding of a cofactor or a covalent modification that changes the allosteric equilibrium constant of A from a value far from its optimum to a value near the optimum (or vice versa).</p>
</sec><sec id="s2d">
<title>A compact, structural and modular representation of allosteric proteins</title>
<p>There are two well-known mechanisms for generating cooperative behaviour in proteins: concerted and sequential allostery. In their seminal paper, Monod, Wyman and Changeux introduced a two-state model to explain cooperative interactions in oligomeric enzymes and proteins <xref ref-type="bibr" rid="pcbi.1000975-Monod1">[24]</xref>. They proposed that all subunits of such proteins undergo a <italic>concerted</italic>, reversible, and quaternary-level transition between two conformational states. Ligand-binding to each conformation is non-cooperative, but each conformation differs in its affinity for ligands and this difference gives rise to cooperative effects. Subsequently, Koshland, Nemethy and Filmer lifted the assumption of concerted transitions with their <italic>sequential</italic> model, in which each subunit transitions individually between two conformational states <xref ref-type="bibr" rid="pcbi.1000975-Koshland1">[25]</xref>. This model can explain negative cooperativity in oligomeric proteins. It assumes, however, that ligands cause an instantaneous conformational change, or an <italic>induced fit</italic>, in the structure of the subunit. Both the concerted and induced fit assumptions can be relaxed and are special cases of the general allosteric model of Herzfeld and Stanley <xref ref-type="bibr" rid="pcbi.1000975-Herzfeld1">[28]</xref>.</p>
<p>ANC-structures can be used to implement these models of allosteric regulation. A concerted model of a generic, homotetrameric protein is shown in <xref ref-type="fig" rid="pcbi-1000975-g003">Figure 3A</xref>. The transition between the two conformations, labelled <italic>R</italic> and <italic>T</italic>, is concerted because a single allosteric component contains all subunits. Cooperativity will arise if a ligand has a higher affinity for one state, say the <italic>R</italic> state, and if the unligated protein is mostly in the alternate state <italic>T</italic>. Then, once bound by ligand, the protein spends more time in the <italic>R</italic> state and so favours the binding of additional ligands. In contrast, a sequential model has an ANC-structure with four allosteric components, each with <italic>r</italic> and <italic>t</italic> states. <xref ref-type="fig" rid="pcbi-1000975-g003">Figures 3B and 3C</xref> show how we implement the tetrahedral and square geometries described by Koshland <italic>et al.</italic> <xref ref-type="bibr" rid="pcbi.1000975-Koshland1">[25]</xref> through different configurations of the allosteric coupling between subunits. Two components are allosterically coupled if the conformation of one component biases the conformational equilibrium of the other component, and vice versa. For example, in <xref ref-type="fig" rid="pcbi-1000975-g003">Figures 3B and 3C</xref>, ligand binding favours the <italic>r</italic> state of an individual subunit, and this subunit when in its <italic>r</italic> state favours the <italic>r</italic> state in those subunits to which it is allosterically coupled and so generates a cooperative response. Finally, we illustrate the general approach with the tertiary two-state model shown in <xref ref-type="fig" rid="pcbi-1000975-g003">Figure 3D</xref>, which allows both quaternary, <italic>R</italic>↔<italic>T</italic> and tertiary, <italic>r</italic>↔<italic>t</italic>, allosteric transitions <xref ref-type="bibr" rid="pcbi.1000975-Henry1">[29]</xref>. Here, ligand binding favours <italic>r</italic> at the bound subunit because of the ligand's higher affinity for <italic>r</italic>. Cooperativity arises because the <italic>R</italic> state of the quaternary structure reciprocally favours the <italic>r</italic> state of the tertiary subunits. Thus, a subunit in the <italic>r</italic> state favours <italic>R</italic> at the quaternary level and so favours subunits not yet bound by ligand to also be in the <italic>r</italic> state, promoting binding of additional ligands. Our ANC implementation of the tertiary two-state model correctly reproduced the Henry <italic>et al.</italic> model, which has 252 molecular species <xref ref-type="bibr" rid="pcbi.1000975-Henry1">[29]</xref>.</p>
<fig id="pcbi-1000975-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000975.g003</object-id><label>Figure 3</label><caption>
<title>Classic and general models of allostery and protein structure are described by our modelling framework.</title>
<p>(<bold>A</bold>) A concerted model of a tetrameric allosteric protein has one allosteric component and 4 identical interaction sites to represent each subunit. The dashed lines indicate that each ligand-binding site is a modifier for the <italic>R</italic>↔<italic>T</italic> allosteric transition and all 4 interactions are identically parameterized by Φ<sub>LB</sub>. (<bold>B</bold>) In a sequential model of the protein, a top-level hierarchical component comprises 4 identical allosteric components that individually change conformation and bind ligand. These components are allosterically coupled (dashed lines) such that each subunit is equivalent and a modifier for all neighbouring subunits – the “tetrahedral” model. The strength of the coupling is given by the regulatory factor Γ<sub>S</sub> and the effect of each modifier on the kinetics of coupled components is parametrized by Φ<sub>LB</sub> and Φ<sub>S</sub>. (<bold>C</bold>) Altered lateral interactions between subunits gives the “square” model. (<bold>D</bold>) A tertiary two-state model has one allosteric hierarchical component containing 4 identical allosteric components, each with a ligand-binding site. The upper quaternary component is allosterically coupled to each tertiary component with strength Γ and the tertiary components are coupled to their binding site. The effect of the quaternary conformation on the kinetics of the tertiary transition is given by Φ<sub>Q</sub>, and the reciprocal interaction is parameterized by Φ<sub>T</sub>. (<bold>E</bold>) The ligand for all four models. (<bold>F</bold>) Rules for the concerted model in panel A. (<bold>G</bold>) Rules for the models in panels B, C and D.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.g003" xlink:type="simple"/></fig>
<p>An advantage of ANC is its ability to easily formulate and simulate mathematically complex models. For example, we will show that the cooperativity of an allosteric protein binding a ligand, such as a transcription factor binding an inducer, can be substantially changed through adding a competing ligand. Although a mathematical analysis of various allosteric models with two competing ligands exists <xref ref-type="bibr" rid="pcbi.1000975-Henis1">[35]</xref>, little is known about multiple ligands and the analysis is cumbersome for the sequential model despite simplifying assumptions. Using ANC, we characterized the binding cooperativity of a ligand L0 to a tetrameric allosteric protein in the presence of one of three different competing ligands for both the concerted and sequential models (<xref ref-type="fig" rid="pcbi-1000975-g004">Figure 4</xref>). In the absence of competitors, the Hill coefficients for binding L0 in the concerted and sequential models were ∼2.8 and ∼2.2 respectively. By increasing the concentration of the competitor ligand L1, which binds preferentially to the same conformation as L0, the Hill coefficient decreased progressively to 1 (i.e. no cooperativity). With ligand L3, which binds preferentially to the low affinity state for L0, the Hill coefficients increased to ∼3.6 and ∼3.4. With ligand L2, which binds with equal affinity to all conformations, the Hill coefficient did not change. With competitors L2 and L3, the EC50 of L0 binding increased but at low concentrations of L1, the EC50 of L0 was slightly lower (Figure 12 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>).</p>
<fig id="pcbi-1000975-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000975.g004</object-id><label>Figure 4</label><caption>
<title>Cooperative binding of competitive ligands to the concerted and sequential models.</title>
<p>The allosteric equilibrium of an unligated protein favours a state <italic>T</italic> (or <italic>t</italic>). Ligand L0 binds preferentially to state <italic>R</italic> (or <italic>r</italic>) and so binds cooperatively to the protein. The Hill coefficient of the dose-response function for L0 (the number of L0 bound to the protein versus the concentration of L0) was measured in the presence of increasing concentrations of three competing ligands: L1 favours the <italic>R</italic> state; L2 is neutral; L3 favours the <italic>T</italic> state. Concentrations of competing ligands are normalized to the EC50 of their own occupancy function. For the concerted model K<sub>RT</sub> = 10<sup>3</sup>; for the sequential (tetrahedral) model K<sub>rt</sub> = 0.1 and Γ<sub>S</sub> = 10. Ligand affinities were set to K<sub>RLi</sub> = K<sub>rLi</sub> = (Γ<sub>i</sub>)<sup>−1/2</sup> and K<sub>TLi</sub> = K<sub>tLi</sub> = (Γ<sub>i</sub>)<sup>1/2</sup> with Γ<sub>0</sub> = Γ<sub>1</sub> = 0.01 (prefers <italic>R</italic> or <italic>r</italic>), Γ<sub>2</sub> = 1 and Γ<sub>3</sub> = 100 (prefers <italic>T</italic> or <italic>t</italic>).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.g004" xlink:type="simple"/></fig>
<p>In addition to ligand binding, our methodology also describes other mechanisms for allosteric regulation that are ubiquitous in cellular signalling. Phosphorylation or other post-translational modifications, dimerization, receptor clustering and point mutations can also regulate or change protein function. Our thermodynamic framework (see <xref ref-type="sec" rid="s4"><italic>Methods</italic></xref>) unifies the treatment of such heterogeneous modifiers of protein activity. In section §2.4 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>, we discuss how dimerization and ligand binding jointly regulate the activity of the epidermal growth factor receptor, and how ligand binding combines with methylation to regulate a chemotaxis receptor (Figure 13 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>).</p>
</sec><sec id="s2e">
<title>Encoding regulatory logic through intensive rather than extensive parameters reduces regulatory complexity and increases modularity</title>
<p>We can distinguish two types of parameters that affect modularity in different ways: <italic>intensive</italic> parameters and <italic>extensive</italic> parameters. Intensive parameters describe the conformational transitions and intramolecular interactions of a protein and, as such, are modular because they are inherent to the protein and independent of the protein's interaction partners. Therefore, we associate intensive parameters with a protein's ANC-structure. In contrast, extensive parameters describe the interactions of a protein with other biomolecules and increase in number as the number of these interactions increase. Extensive parameters, contained in rules for interaction, are the “wiring” between modules and are non-modular because they depend on the system in which the protein functions. Regulatory complexity occurs when the number of extensive parameters describing a system scales combinatorially with the number of interactions in the system.</p>
<p>Our biomolecule-centric methodology minimizes regulatory complexity. For example, we analyzed a generic model of an <italic>N</italic>-valent, two-state protein where each of the <italic>N</italic> binding sites is unique and binds exactly <italic>L</italic> ligands (section §2.5 and Table 6 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>). In an “interaction-centric” modelling approach, there are no intensive parameters and the number of extensive parameters scales as <italic>L<sup>N</sup></italic>. In the “biomolecule-centric” methodology of ANC, there are 2 intensive parameters and the number of extensive parameters scales linearly with the number of interactions <italic>NL</italic>. Using our methodology can therefore yield large savings; for instance if N = 6 and L = 5, we have 91 independent rate constants rather than over 233,000 (Table 7 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>). Thus, by encoding the regulatory logic of proteins with intensive rather than extensive parameters, we reduce regulatory complexity. We therefore improve the model's modularity because only extensive parameters change when a model is updated.</p>
</sec><sec id="s2f">
<title>Refactoring yields a scalable and modular GPCR model that can explain functional selectivity</title>
<p>Using our biomolecule-centric modelling framework, we can convert a non-modular model into a modular one. Such refactoring is also useful when a protein has more than two conformational states, unlike the core allosteric components in ANC-structures. To illustrate, we introduce a new model for the activation of G protein-coupled receptors (GPCRs). GPCRs are a common target for pharmaceutical drugs <xref ref-type="bibr" rid="pcbi.1000975-Jacoby1">[36]</xref>. Such drugs include agonists that promote activation of the receptor, inverse agonists that promote deactivation of the receptor, and antagonists that by binding to the receptor block the action of agonists.</p>
<p>Although several allosteric models have been proposed <xref ref-type="bibr" rid="pcbi.1000975-Kenakin1">[37]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Christopoulos1">[38]</xref>, we will consider the cubic ternary complex model <xref ref-type="bibr" rid="pcbi.1000975-Weiss1">[39]</xref> because this model describes the constitutive activity of a GPCR, the action of inverse agonists and antagonists, and how some inverse agonists can cause a GPCR to recruit G proteins but remain inactive <xref ref-type="bibr" rid="pcbi.1000975-Monczor1">[40]</xref>. The model also explains the functional selectivity of receptors (also called agonist trafficking, ligand-biased agonism, or protean agonism) <xref ref-type="bibr" rid="pcbi.1000975-Kenakin2">[41]</xref> through the notion of active states of the receptor that are specific to a ligand or a G protein <xref ref-type="bibr" rid="pcbi.1000975-Christopoulos1">[38]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Watson1">[42]</xref>. However, the model does not include receptor homo- or hetero-oligomerization <xref ref-type="bibr" rid="pcbi.1000975-Devi1">[43]</xref>–<xref ref-type="bibr" rid="pcbi.1000975-Panetta1">[48]</xref>, or the possibility that GPCRs form stable, pre-assembled complexes with downstream proteins <xref ref-type="bibr" rid="pcbi.1000975-Lavine1">[49]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Dupre1">[50]</xref>.</p>
<p>A naive implementation of the cubic ternary complex model in our framework uses a divalent ANC-structure with a single allosteric component (<xref ref-type="fig" rid="pcbi-1000975-g005">Figure 5A, C</xref>). This implementation captures Weiss <italic>et al.</italic>'s assumption that the receptor has only two conformational states. However, it does not capture the cooperative binding of a ligand to either the inactive or active states of the receptor because such binding is incompatible with the paradigm that each modifier contributes independently to the equilibrium constant of the allosteric transition <xref ref-type="bibr" rid="pcbi.1000975-Monod1">[24]</xref>. This cooperative effect is described in Weiss <italic>et al.</italic>'s model through the cooperativity parameters γ and δ. However, these parameters are extensive and specific to each combination of ligand and G protein. They therefore introduce regulatory complexity.</p>
<fig id="pcbi-1000975-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000975.g005</object-id><label>Figure 5</label><caption>
<title>Cubic and quartic ternary complex models of a GPCR in our modelling framework.</title>
<p>The mapping between the cubic (A) and quartic (B) models shows how the two models are related. (<bold>A</bold>) A naive implementation of the cubic ternary complex model. The ANC-structure R has one allosteric component which transitions between a low-affinity, inactive (<italic>i</italic>) state and a high-affinity, active (<italic>a</italic>) state with the indicated equilibrium constant (in gray). LB and GB are binding sites for an extracellular ligand L (not shown) and an intracellular target G protein (not shown). In the corresponding cubic, 8-state transition diagram K<sub>act</sub> is the unligated allosteric equilibrium constant, K<sub>a</sub> and K<sub>g</sub> are ligand affinities to the reference (inactive) state, and α and β are ratios of affinities. We parenthesize the cooperativity parameters δ and γ to indicate that these parameters of the cubic ternary complex model have to be added as <italic>ad hoc</italic> rules to the naïve implementation. (<bold>B</bold>) In our quartic ternary complex model, an ANC-structure R comprises two allosteric components: the extracellular domain ED transitions between low and high-affinity states (<italic>s</italic> and <italic>t</italic>); the intracellular domain ID transitions between inactive and active states (<italic>i</italic> and <italic>a</italic>). These transitions are reciprocally linked (dashed line) so each domain acts a modifier of the other with the interaction parameterized by Γ and Φ. The binding sites are allosterically coupled to <italic>both</italic> allosteric components, therefore each ligand “sees” 4 possible conformations of the receptor. In the quartic state-transition diagram K<sub>actG</sub> and K<sub>actL</sub> are the unligated allosteric equilibrium constants, Г is the regulatory factor linking the <italic>s</italic>↔<italic>t</italic> and <italic>i</italic>↔<italic>a</italic> transitions, K<sub>a</sub>′ and K<sub>g</sub>′ are ligand affinities to the reference state <italic>si</italic>, and α and β are ratios of ligand affinities of the subscripted state relative to the reference state. For clarity, we show only the unligated <italic>s</italic>↔<italic>t</italic> transition. (<bold>C</bold>) Rules for the cubic ternary complex model showing the rate and equilibrium constants for ligand and G protein binding. (<bold>D</bold>) A subset of the rules for the quartic ternary complex model shows the rate and equilibrium constants for ligand binding. A similar set of rules specifies rate and equilibrium constants for binding G protein (Figure 9 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.g005" xlink:type="simple"/></fig>
<p>To resolve this difficulty, we propose a sequential allosteric model of the GPCR with two coupled allosteric components: an extracellular allosteric component, which binds a ligand, and an intracellular allosteric component, which binds a G protein (<xref ref-type="fig" rid="pcbi-1000975-g005">Figure 5B, D</xref>). The ligand and the G protein interact simultaneously with <italic>both</italic> allosteric components. They therefore “see” four possible conformations of the receptor instead of two. These conformations are implied in the cubic ternary complex model because each ligand has four distinct affinities to the receptor. However, none of the extensive parameters in our model are cooperativity parameters specific to a ligand-G protein pair, thus eliminating regulatory complexity.</p>
<p>Our quartic ternary complex model can be projected onto the cubic model by defining coarse-grained variables that sum over the conformations of the extracellular allosteric component (<xref ref-type="fig" rid="pcbi-1000975-g005">Figure 5</xref> and section §2.6 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>). The “inactive” and “active” states in the cubic model therefore correspond to a mixture of conformational states, providing a mechanism for how different ligands induce an apparently unique conformation of the activated GPCR with a distinct affinity for the G protein <xref ref-type="bibr" rid="pcbi.1000975-Kenakin3">[51]</xref>. In our model, each ligand uniquely affects the allosteric equilibrium of the extracellular domain and therefore the fraction of time that the receptor is in the <italic>s</italic> and <italic>t</italic> states, which in turn uniquely modulates the affinity of the active GPCR for the G protein.</p>
<p>Our quartic model for the GPCR is more modular and parsimonious than the cubic model because it includes a structurally and biophysically plausible mechanism for how ligands and G proteins interact cooperatively with the GPCR. We encode the logic of these regulatory interactions in the protein's ANC-structure using intensive parameters, rather than in <italic>ad hoc</italic> rules with extensive parameters. Our “refactored” model has 11 parameters (3 of which are intensive) compared to the 7 parameters of the cubic model (1 of which is intensive) and double the number of states. This initial cost for increased modularity and “portability” becomes a benefit as the number of types of ligands and G proteins increases. The number of extensive parameters in our model scales linearly with the number of interactions; in the cubic model, the number of extensive parameters scales combinatorially. For example, suppose we wish to model 4 different ligands that activate the thyroid-stimulating hormone receptor. In human thyroid membranes, this GPCR can activate at least 10 different G proteins <xref ref-type="bibr" rid="pcbi.1000975-Gudermann1">[22]</xref>. With 4 ligands and 10 G proteins, our quartic model is almost twice as parsimonious as the cubic model, requiring 59 rather than 109 parameters.</p>
<p>The quartic model also has more predictive power than the cubic model and therefore can be more rigorously tested. For each pair of ligands and G proteins, the cubic model requires the specification of two cooperativity parameters, δ and γ, specific to that pair. It is therefore limited in the predictions it can make. For example, for each new G protein added to the system, new cooperativity parameters are needed for all previously characterized ligands to be able to predict the new G protein's GPCR-mediated response to these ligands. In contrast, the quartic model is completely characterized for the new target pathway by measuring four extensive parameters – one for each conformation of the GPCR – and we can then predict the GPCR-mediated response to all ligands. In particular, we can predict the rank order of potency of the ligands to activate the new pathway, a standard means to compare agonists in pharmacology, and detect functional selectivity <xref ref-type="bibr" rid="pcbi.1000975-Kenakin3">[51]</xref>.</p>
<p>Like the cubic model, the quartic ternary complex model also explains functional selectivity, though this is not obvious considering that these models cannot be related through a simple projection when multiple ligands and G proteins interact with a single receptor. Indeed, in the quartic model δ and γ are not free parameters but are correlated because of their dependence on underlying rates. We therefore simulated the GPCR-mediated response to several ligands that cause (in)activation of two different G proteins (<xref ref-type="fig" rid="pcbi-1000975-g006">Figure 6A and 6B</xref>). Ligand L1 has the greatest ability to activate G protein G1 as measured by its potency (−log(EC50) of the response) and efficacy (maximal activation). For G1, ligand L2 has intermediate potency and efficacy and L3 has the lowest potency and efficacy. Also, L1 is better able to activate G1 than G2. If the receptor had only a single active state, we would therefore infer that this state must have a poorer ability to bind and activate G2 and would expect that L2 should also have a decreased ability to activate G2. The potency and efficacy of L2 on G2 is, however, greater than that of L1 indicating a reversal in the rank order of the potency and efficacy of L1 and L2. Also, ligand L3 is an agonist for G1 but an inverse agonist for G2. These observations of agonists selectively (in)activating distinct target pathways cannot be reconciled with a model comprising a single active state of the receptor. Functional selectivity can also be observed for the repression of activity by inverse agonists because there are also two <italic>inactive</italic> states of the receptor (<xref ref-type="fig" rid="pcbi-1000975-g006">Figure 6B</xref>).</p>
<fig id="pcbi-1000975-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000975.g006</object-id><label>Figure 6</label><caption>
<title>Functional selectivity of agonists in the quartic ternary complex model.</title>
<p>(<bold>A</bold>, <bold>B</bold>) We simulated the GPCR-mediated (in)activation two target G proteins by several ligands. A dose-response for each ligand and G protein pair shows the amount of receptor species capable of signalling (R<sub>sa</sub>G+R<sub>ta</sub>G+LR<sub>sa</sub>G+LR<sub>ta</sub>G) as a fraction of the total number of receptors and against the concentration of ligand (arbitrary units). The concentrations of receptor and G protein are unity. Parameter values: KactL = 1, KactG = 0.05, Γ = 1, affinities for L1 are given by: (Ka′, α<sub>t</sub>, α<sub>a</sub>, α<sub>at</sub>) = (10,0.1,10,1), for L2: (1,20,20,400), L3: (0.1,10,10,0.01), L4: (100,0.1,0.4,0.01) L5: (20,20,0.05,5), G1: (Kg′, β<sub>t</sub>, β<sub>a</sub>, β<sub>at</sub>) = (10,0.1,10,1) and G2: (1,10,10,100).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.g006" xlink:type="simple"/></fig>
<p>The quartic model is modular and therefore is easily extended to include additional signalling interactions such as the regulation of the receptor by allosteric ligands <xref ref-type="bibr" rid="pcbi.1000975-Hall1">[52]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Christopoulos1">[38]</xref>. Also, by adding dimerization sites, we could incorporate existing models of dimerization of GPCRs <xref ref-type="bibr" rid="pcbi.1000975-Durroux1">[47]</xref>. Some GPCRs may also oligomerize <italic>in vivo</italic>, for instance by forming tetramers <xref ref-type="bibr" rid="pcbi.1000975-Ma1">[53]</xref>. We could model oligomerization by concatenating multiple receptor models within a larger ANC-structure through modular composition. A starting point could be one of the models of <xref ref-type="fig" rid="pcbi-1000975-g003">Figure 3</xref>, but substituting for each subunit the ANC-structure for a GPCR and, as appropriate, adding allosteric couplings to model inter-receptor interactions.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>Biochemical networks are complex yet modular: networks exhibit both combinatorial and regulatory complexity, but individual proteins have intrinsic functional properties that determine how they detect and process information. Complexity is also reduced because similar proteins or similar protein domains appear in many signalling pathways and often interact with similar protein partners. We propose a modelling methodology, embodied by ANC, that exploits the modularity of proteins to reduce the complexity of modelling biochemical networks. Given modular ANC-structures, which encode a protein's regulatory properties, adding new interactions to an ANC model usually requires substantially fewer parameters than with other rule-based models, particularly as the promiscuity of binding of proteins, and hence the complexity of the network, increases. ANC-structures are also portable because different signalling pathways are modeled by simply “re-wiring” proteins rather than through writing new <italic>ad hoc</italic> rules encoding the regulatory logic specific to each pathway.</p>
<p>In our methodology, models are structured to minimize regulatory complexity both to avoid over-fitting data and because large numbers of biochemical parameters are difficult to measure <italic>in vivo</italic>. Indeed, our modelling framework reflects a natural division between two classes of parameters: “intensive” parameters describe the allosteric transitions and intramolecular interactions of a particular protein and are attributes of ANC-structures; “extensive” parameters describe the interactions of the protein with other biomolecules and are associated with rules. In different biochemical networks, only the extensive parameters of a protein change. Through its assumption that a ligand or substrate distinguishes only the conformation of a protein or enzyme and not its occupancy or state of covalent modification at distant sites, our modelling framework substantially reduces the number of extensive parameters required: their number scales linearly, rather than combinatorially, with the number of interactions. This reduction in extensive parameters allows a model for the interaction of a protein with individual ligands to also predict the response to mixtures of ligands with no additional parameters <xref ref-type="bibr" rid="pcbi.1000975-Senozan1">[54]</xref>. We have shown that interference with a competing ligand can either increase or decrease the cooperativity of the response to the original ligand (<xref ref-type="fig" rid="pcbi-1000975-g004">Figure 4</xref>) – a potentially useful mechanism of control.</p>
<p>Our methodology reduces the regulatory complexity but increases the combinatorial complexity of a system because each conformation of an allosteric protein introduces a new state. Thus, a reduction in regulatory complexity incurs the computational cost of modelling additional species. Nevertheless, recent advances in rule-based modeling have introduced new methods that allow fast simulation of systems with large numbers of chemical species and reactions <xref ref-type="bibr" rid="pcbi.1000975-Lok1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Danos2">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Colvin1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Conzelmann1">[55]</xref>–<xref ref-type="bibr" rid="pcbi.1000975-Feret1">[57]</xref>. By focusing on avoiding an exponential increase in extensive parameters in systems with promiscuous binding, our methodology both complements and potentially benefits from these innovations.</p>
<p>We also make a first step at integrating free energy-based constraints into a rule-based modelling framework, adding to earlier work on imposing detailed balance in models of biochemical networks <xref ref-type="bibr" rid="pcbi.1000975-Colquhoun1">[58]</xref>–<xref ref-type="bibr" rid="pcbi.1000975-Ederer2">[61]</xref>. By automatically computing all dependent extensive parameters associated with allosteric transitions – the allosteric equilibrium and rate constants for each ligated and modified state – from the appropriate independent parameters, ANC prevents the modeller from incorrectly specifying these parameters. Thus, cycles comprising allosteric transitions are biophysically correct by construction. For complex models with a combinatorially large number of occupancy states and covalent modifications, this automation is essential.</p>
<p>Two other advantages of our modelling framework are significant. First, ANC-structures enable a coarse-grained hierarchical description of physical structure by requiring the specification of protein domains and if desired tertiary and quaternary structure, including oligomeric receptor clusters. ANC-structures can also model the internal geometry of a protein by describing those domains of the protein that interact allosterically and those that do not (<xref ref-type="fig" rid="pcbi-1000975-g003">Figure 3</xref>). Second, the thermodynamic framework underpinning our method offers a systematic and unified way to model how proteins integrate heterogeneous inputs such as ligands, phosphorylations, or even small mutations to compute an output response.</p>
<p>Our modelling framework encourages the modeller to develop a mechanism to explain the regulatory properties of a protein and hence to build models that have predictive power and so can be experimentally tested. For example, an ANC model of the activation of GPCRs suggests that the well-known cubic ternary complex model has implicitly coarse-grained some conformations of the GPCR. By including these conformations in an ANC-structure, our new quartic model prevents over-fitting and has the potential to predict the rank order of potency and efficacy of ligands acting through a GPCR. This model of the GPCR has two linked allosteric components, each with just two conformational states that interact independently with other molecules. These mechanistic assumptions do not, however, apply to the GPCR as a whole, which has four conformational states. Thus, while the two-state assumption may not hold for all proteins, other mechanistic models can be accommodated within our framework.</p>
<p>Having allostery at its centre, our framework can suggest simple mechanisms through which the cell might regulate and increase the efficacy of cellular processes. For example, the assembly of macromolecular complexes can be considerably undermined through the prozone effect when linker proteins are over-expressed <xref ref-type="bibr" rid="pcbi.1000975-Bray2">[32]</xref>. Consequently we might expect that expression of the components of macromolecular complexes is tightly regulated. Such regulation can be complex and expensive. Yet modelling with our framework suggests that if allosteric proteins are part of the macromolecular complex and if the linker proteins are allosteric then the prozone effect can be substantially reduced and without energy input (<xref ref-type="fig" rid="pcbi-1000975-g002">Figure 2A</xref>).</p>
<p>A challenge in designing synthetic biological systems is to have predictive modelling tools. Here, ANC has several potential advantages. First, the modularity of ANC-structures allows models of synthetic systems to be straightforwardly extended: for example, as different synthetic subsystems are combined to generate more complex behaviour <xref ref-type="bibr" rid="pcbi.1000975-Dueber1">[7]</xref>. Second, through its rule-based modeling and the specification of rules of interaction between protein components rather than between proteins, ANC naturally models molecular cross-talk between synthetic sub-circuits in a larger synthetic circuit and between a synthetic circuit and the endogenous biochemistry (if a rule-based model of endogenous signalling is available). In both cases, ANC will find and model interactions if proteins are present that happen to have complementary binding domains. Such interactions could, for example, affect the formation of macromolecular signalling complexes (<xref ref-type="fig" rid="pcbi-1000975-g002">Figure 2</xref>) or change the Hill coefficient of the response of a crucial pathway (<xref ref-type="fig" rid="pcbi-1000975-g004">Figure 4</xref>). Finally, an ANC model includes background activity in all enzymes because control of each enzyme is described by an allosteric transition between inactive and active conformations. This transition will occur regardless of the presence of input signals to the system, although the probability of such occurrences can be small. Like molecular cross-talk, background activity can cause a synthetic circuit to deviate substantially from its designed behaviour.</p>
<p>Faced with the complexity of cellular signalling and genetic networks, researchers are developing new computational methods to quantitatively model and predict cellular behaviour despite that complexity. In this spirit, we have identified and discussed a distinct form of complexity – regulatory complexity – which arises from the allosteric regulation of proteins. Combining and extending established biophysical principles with more recent rule-based methods, we propose a modular and scalable methodology, exemplified by our Allosteric Network Compiler, to describe the complexity of cellular signalling. By emphasizing the allosteric control of proteins, we capture the inherent modularity of protein structure and function exploited by cells themselves. Our method is a general, principled and simplifying addition to any modeling framework.</p>
</sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<sec id="s4a">
<title>Thermodynamic framework</title>
<p>To compute how multiple modifiers collectively bias the conformational equilibrium of an allosteric component, we use thermodynamics <xref ref-type="bibr" rid="pcbi.1000975-Ackers1">[62]</xref>. We arbitrarily designate one conformation as the reference state <italic>R</italic> and the alternate conformation as <italic>T</italic>. If we let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e003" xlink:type="simple"/></inline-formula> be the difference in free energy between the <italic>R</italic> and the <italic>T</italic> conformations in the absence of any modifiers, then the difference in free energy in the presence of <italic>N</italic> modifiers is, quite generally <xref ref-type="bibr" rid="pcbi.1000975-Saiz1">[63]</xref>,<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e004" xlink:type="simple"/><label>(3)</label></disp-formula>where we include contributions of free energy to the new allosteric equilibrium that are determined by each modifier alone, by pair-wise interactions between modifiers, and by all higher order interactions.</p>
<p>We assume that all modifiers interact independently (non-cooperatively) with each conformational state of the protein component, with the energy of interaction to the <italic>R</italic> state of the component given by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e005" xlink:type="simple"/></inline-formula> and to the <italic>T</italic> state by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e006" xlink:type="simple"/></inline-formula> for the modifier indexed by <italic>i</italic>. Consequently, the free energy required to apply a modifier to each conformation does not depend on the presence or absence of other modifiers – a modifier can only distinguish the conformational state of the component. Therefore we need consider just the first order terms of equation (1) and ignore higher order interactions:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e007" xlink:type="simple"/><label>(4)</label></disp-formula>For each modifier, a reversible thermodynamic cycle exists around which the change in free energy must be zero. For example, equilibria exist between the <italic>R</italic> and the <italic>T</italic> states of the component, between the modifier <italic>i</italic> being applied to the <italic>R</italic> state (a free energy change of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e008" xlink:type="simple"/></inline-formula>), the modifier being applied to the <italic>T</italic> state (a free energy change of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e009" xlink:type="simple"/></inline-formula>), and between the <italic>R</italic> and the <italic>T</italic> states of the modified form of the component. To have no change in free energy around this cycle implies that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e010" xlink:type="simple"/></inline-formula>. Hence, we have:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e011" xlink:type="simple"/><label>(5)</label></disp-formula>From statistical mechanics, we know that the equilibrium constant between any two states of a system, say A and B, is connected to the difference in their free energy through the expression<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e012" xlink:type="simple"/></disp-formula>Therefore, we may exponentiate equation (3) to find the corresponding equilibrium constant:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e013" xlink:type="simple"/><label>(6)</label></disp-formula>with <italic>kT</italic> denoting the product of Boltzmann's constant and temperature.</p>
<p>Equation (6) describes the input-output function of an allosteric component, which may embody a domain, a subunit, or an entire protein. The output <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e014" xlink:type="simple"/></inline-formula> is the allosteric constant of the component under the effect of N modifiers. It is obtained by multiplying a baseline equilibrium constant <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e015" xlink:type="simple"/></inline-formula> with each “regulatory factor” Γ<italic><sub>i</sub></italic>, which describes the effect of an input modifier <italic>i</italic> on the allosteric equilibrium. If the modifier is a ligand, then Γ<italic><sub>i</sub></italic> is the ratio of the ligand's affinity to each conformation. If the modifier is a covalent modification such as a phosphorylation, the regulatory factor is an independent parameter related to the free energies required to phosphorylate each conformation. If the modifier is another allosteric component to which the component is allosterically coupled (e.g. <xref ref-type="fig" rid="pcbi-1000975-g003">Figure 3B–D</xref>), then Γ<italic><sub>i</sub></italic> is an independent parameter related to the free energy of interaction of the <italic>T</italic> form of the modifier with each conformation of the allosteric component, and gives the fold-change in the allosteric equilibrium constant induced by the <italic>T</italic> form of the modifier. When this modifier is in its reference state, which we label <italic>R</italic>, the output is by definition unchanged and the regulatory factor is not applied.</p>
<p>To compute how the kinetics of a component's allosteric transition are affected by the presence of modifiers, we first write the forward and backward rate constants for the unmodified component in terms of the free energy difference between the transition state (denoted †) and each conformational state <xref ref-type="bibr" rid="pcbi.1000975-Jackson1">[64]</xref>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e016" xlink:type="simple"/><label>(7a)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e017" xlink:type="simple"/><label>(7b)</label></disp-formula>To obtain the rate constants for a modified state, the simplest approach is to assume a constant pre-exponential factor <italic>C</italic> and that modifiers contribute independently to a change in the free energy of the transition state (section §1.2 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>). The assumption of independence is not arbitrary: at the core of the MWC paradigm of allostery is the assumption that modifiers contribute independently to the free energy of each conformational state. Here we extend this idea to the transition state of the allosteric transition. As a result, modifiers independently affect the kinetic rates, just as they do the equilibrium constant, and we can write:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e018" xlink:type="simple"/><label>(8a)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.e019" xlink:type="simple"/><label>(8b)</label></disp-formula>for parameters Φ<sub>i</sub>.</p>
<p>We choose this parameterization because Φ<sub>i</sub> = Φ<sub>j</sub> implies the existence of a linear free energy relationship for two modifiers <italic>i</italic> and <italic>j</italic> (section §1.3 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>). A linear free energy relationship <xref ref-type="bibr" rid="pcbi.1000975-Leffler1">[65]</xref> is a common, simplifying assumption in biophysical models: in a set of related reactions, the logarithm of a transition rate is assumed to be linearly related to the logarithm of the equilibrium constant <xref ref-type="bibr" rid="pcbi.1000975-Grosman1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Eaton1">[66]</xref>. The parameter Φ denotes the proportionality constant. Assuming a linear free energy relationship to model simultaneous modifiers, for example in models of hemoglobin or of the nicotinic acetylcholine receptor <xref ref-type="bibr" rid="pcbi.1000975-Henry1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Eaton1">[66]</xref>, <xref ref-type="bibr" rid="pcbi.1000975-Edelstein1">[67]</xref>, also implies that these modifiers independently affect the conformational transition, with each effect parameterized by the same value of Φ (section §1.3 of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>).</p>
</sec><sec id="s4b">
<title>Validation, testing, modelling and simulation</title>
<p>We validated our overall methodological flow (<xref ref-type="fig" rid="pcbi-1000975-g001">Figure 1C</xref>) and verified the output of ANC by implementing and simulating an allosteric model <xref ref-type="bibr" rid="pcbi.1000975-Stefan1">[68]</xref> of the signalling protein calmodulin (Figure 10A and Figure 10B of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>). Binding of calcium to calmodulin modulates its affinity for downstream effectors. We confirmed that ANC correctly generates the 352 biochemical equations of the model of Stefan <italic>et al.</italic> and that our simulation results were consistent with theirs, using their experimentally derived parameter values (Figure 10C of <xref ref-type="supplementary-material" rid="pcbi.1000975.s001">Text S1</xref>).</p>
<p>ANC possesses a number of features which ease modelling and simulation of biochemical networks. First, ANC allows users to parameterize a model so that parameter values can be changed after compilation. Also, ANC supports <italic>stimuli</italic>, through which the user can apply input waveforms to specified nodes in the network, and <italic>probes</italic> – user-defined collections of molecules – to measure network output. Finally, ANC allows the creation of <italic>ad hoc</italic> regulatory conditions to support interaction-centric approaches. Such <italic>ad hoc</italic> conditions, however, reduce the modularity and scalability of a model and so do not play to the strength of our methodology.</p>
<p>Using Facile <xref ref-type="bibr" rid="pcbi.1000975-SisoNadal1">[69]</xref>, an application distributed with ANC, we can export an ANC-compiled network to standard tools such as Matlab, XPP, Maple or Mathematica for deterministic simulation or analysis, to EasyStoch for stochastic simulation <xref ref-type="bibr" rid="pcbi.1000975-Shahrezaei1">[70]</xref>, or to SBML <xref ref-type="bibr" rid="pcbi.1000975-Hucka1">[71]</xref>.</p>
</sec><sec id="s4c">
<title>Limitations of method</title>
<p>The current implementation of ANC has three principle limitations. 1) The reaction network is enumerated, so ANC's performance may degrade significantly if the compiled network is large. 2) Only rules for binding and Michealis-Menten interactions can be created. 3) While ANC supports unimolecular association and dissociation, detailed balance is enforced only for cycles comprising purely bimolecular associations.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000975.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000975.s001" xlink:type="simple"><label>Text S1</label><caption>
<p>Supplementary information. This file contains all supplementary information for the article.</p>
<p>(4.94 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank Vincent Danos, James Faeder, Catherine Lichten, Terry Hébert, David MacLean, Bruno Martins and Victor Neruda for useful discussions and critical readings of the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000975-Hartwell1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hartwell</surname><given-names>LH</given-names></name>
<name name-style="western"><surname>Hopfield</surname><given-names>JJ</given-names></name>
<name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Murray</surname><given-names>AW</given-names></name>
</person-group>             <year>1999</year>             <article-title>From molecular to modular cell biology.</article-title>             <source>Nature</source>             <volume>402</volume>             <fpage>C47</fpage>             <lpage>52</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Tyson1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Tyson</surname><given-names>JJ</given-names></name>
<name name-style="western"><surname>Chen</surname><given-names>KC</given-names></name>
<name name-style="western"><surname>Novak</surname><given-names>B</given-names></name>
</person-group>             <year>2003</year>             <article-title>Sniffers, buzzers, toggles and blinkers: dynamics of regulatory and signaling pathways in the cell.</article-title>             <source>Curr Opin Cell Biol</source>             <volume>15</volume>             <fpage>221</fpage>             <lpage>231</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Alon1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Alon</surname><given-names>U</given-names></name>
</person-group>             <year>2007</year>             <article-title>Network motifs: theory and experimental approaches.</article-title>             <source>Nat Rev Genet</source>             <volume>8</volume>             <fpage>450</fpage>             <lpage>461</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Bray1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bray</surname><given-names>D</given-names></name>
</person-group>             <year>1995</year>             <article-title>Protein molecules as computational elements in living cells.</article-title>             <source>Nature</source>             <volume>376</volume>             <fpage>307</fpage>             <lpage>312</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Pawson1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pawson</surname><given-names>T</given-names></name>
</person-group>             <year>1995</year>             <article-title>Protein modules and signalling networks.</article-title>             <source>Nature</source>             <volume>373</volume>             <fpage>573</fpage>             <lpage>580</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Pawson2"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pawson</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Gish</surname><given-names>GD</given-names></name>
<name name-style="western"><surname>Nash</surname><given-names>P</given-names></name>
</person-group>             <year>2001</year>             <article-title>SH2 domains, interaction modules and cellular wiring.</article-title>             <source>Trends Cell Biol</source>             <volume>11</volume>             <fpage>504</fpage>             <lpage>511</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Dueber1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dueber</surname><given-names>JE</given-names></name>
<name name-style="western"><surname>Yeh</surname><given-names>BJ</given-names></name>
<name name-style="western"><surname>Bhattacharyya</surname><given-names>RP</given-names></name>
<name name-style="western"><surname>Lim</surname><given-names>WA</given-names></name>
</person-group>             <year>2004</year>             <article-title>Rewiring cell signaling: the logic and plasticity of eukaryotic protein circuitry.</article-title>             <source>Curr Opin Struct Biol</source>             <volume>14</volume>             <fpage>690</fpage>             <lpage>699</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Pawson3"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pawson</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Nash</surname><given-names>P</given-names></name>
</person-group>             <year>2003</year>             <article-title>Assembly of cell regulatory systems through protein interaction domains.</article-title>             <source>Science</source>             <volume>300</volume>             <fpage>445</fpage>             <lpage>452</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Lim1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lim</surname><given-names>WA</given-names></name>
</person-group>             <year>2002</year>             <article-title>The modular logic of signaling proteins: building allosteric switches from simple binding domains.</article-title>             <source>Curr Opin Struct Biol</source>             <volume>12</volume>             <fpage>61</fpage>             <lpage>68</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Smock1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smock</surname><given-names>RG</given-names></name>
<name name-style="western"><surname>Gierasch</surname><given-names>LM</given-names></name>
</person-group>             <year>2009</year>             <article-title>Sending signals dynamically.</article-title>             <source>Science</source>             <volume>324</volume>             <fpage>198</fpage>             <lpage>203</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Endy1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Endy</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Brent</surname><given-names>R</given-names></name>
</person-group>             <year>2001</year>             <article-title>Modelling cellular behaviour.</article-title>             <source>Nature</source>             <volume>409</volume>             <fpage>391</fpage>             <lpage>395</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Hlavacek1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hlavacek</surname><given-names>WS</given-names></name>
<name name-style="western"><surname>Faeder</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>Blinov</surname><given-names>ML</given-names></name>
<name name-style="western"><surname>Perelson</surname><given-names>AS</given-names></name>
<name name-style="western"><surname>Goldstein</surname><given-names>B</given-names></name>
</person-group>             <year>2003</year>             <article-title>The complexity of complexes in signal transduction.</article-title>             <source>Biotechnol Bioeng</source>             <volume>84</volume>             <fpage>783</fpage>             <lpage>794</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Toledo1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Toledo</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Wahl</surname><given-names>GM</given-names></name>
</person-group>             <year>2006</year>             <article-title>Regulating the p53 pathway: in vitro hypotheses, in vivo veritas.</article-title>             <source>Nat Rev Cancer</source>             <volume>6</volume>             <fpage>909</fpage>             <lpage>923</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Hlavacek2"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hlavacek</surname><given-names>WS</given-names></name>
<name name-style="western"><surname>Faeder</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>Blinov</surname><given-names>ML</given-names></name>
<name name-style="western"><surname>Posner</surname><given-names>RG</given-names></name>
<name name-style="western"><surname>Hucka</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Rules for modeling signal-transduction systems.</article-title>             <source>Sci STKE</source>             <volume>2006</volume>             <fpage>re6</fpage>          </element-citation></ref>
<ref id="pcbi.1000975-Blinov1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Blinov</surname><given-names>ML</given-names></name>
<name name-style="western"><surname>Faeder</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>Goldstein</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Hlavacek</surname><given-names>WS</given-names></name>
</person-group>             <year>2004</year>             <article-title>BioNetGen: software for rule-based modeling of signal transduction based on the interactions of molecular domains.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>3289</fpage>             <lpage>3291</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Danos1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Danos</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Laneve</surname><given-names>C</given-names></name>
</person-group>             <year>2004</year>             <article-title>Formal molecular biology.</article-title>             <source>Theor Comput Sci</source>             <volume>325</volume>             <fpage>69</fpage>             <lpage>110</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Lok1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lok</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Brent</surname><given-names>R</given-names></name>
</person-group>             <year>2005</year>             <article-title>Automatic generation of cellular reaction networks with Moleculizer 1.0.</article-title>             <source>Nat Biotechnol</source>             <volume>23</volume>             <fpage>131</fpage>             <lpage>136</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-LeNovere1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Le Novere</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Shimizu</surname><given-names>TS</given-names></name>
</person-group>             <year>2001</year>             <article-title>STOCHSIM: modelling of stochastic biomolecular processes.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>             <fpage>575</fpage>             <lpage>576</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Danos2"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Danos</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Feret</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Fontana</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Krivine</surname><given-names>J</given-names></name>
</person-group>             <year>2007</year>             <article-title>Scalable simulation of cellular signaling networks.</article-title>             <source>Programming Languages and Systems, Proceedings</source>             <volume>4807</volume>             <fpage>139</fpage>             <lpage>157</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Colvin1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Colvin</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Monine</surname><given-names>MI</given-names></name>
<name name-style="western"><surname>Faeder</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>Hlavacek</surname><given-names>WS</given-names></name>
<name name-style="western"><surname>Von Hoff</surname><given-names>DD</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Simulation of large-scale rule-based models.</article-title>             <source>Bioinformatics</source>             <volume>25</volume>             <fpage>910</fpage>             <lpage>917</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Pierce1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pierce</surname><given-names>KL</given-names></name>
<name name-style="western"><surname>Premont</surname><given-names>RT</given-names></name>
<name name-style="western"><surname>Lefkowitz</surname><given-names>RJ</given-names></name>
</person-group>             <year>2002</year>             <article-title>Seven-transmembrane receptors.</article-title>             <source>Nat Rev Mol Cell Biol</source>             <volume>3</volume>             <fpage>639</fpage>             <lpage>650</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Gudermann1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gudermann</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Kalkbrenner</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Schultz</surname><given-names>G</given-names></name>
</person-group>             <year>1996</year>             <article-title>Diversity and selectivity of receptor-G protein interaction.</article-title>             <source>Annu Rev Pharmacol Toxicol</source>             <volume>36</volume>             <fpage>429</fpage>             <lpage>459</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Kukkonen1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kukkonen</surname><given-names>JP</given-names></name>
<name name-style="western"><surname>Nasman</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Akerman</surname><given-names>KE</given-names></name>
</person-group>             <year>2001</year>             <article-title>Modelling of promiscuous receptor-Gi/Gs-protein coupling and effector response.</article-title>             <source>Trends Pharmacol Sci</source>             <volume>22</volume>             <fpage>616</fpage>             <lpage>622</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Monod1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Monod</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Wyman</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Changeux</surname><given-names>JP</given-names></name>
</person-group>             <year>1965</year>             <article-title>On the Nature of Allosteric Transitions: A Plausible Model.</article-title>             <source>J Mol Biol</source>             <volume>12</volume>             <fpage>88</fpage>             <lpage>118</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Koshland1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Koshland</surname><given-names>DE</given-names><suffix>Jr</suffix></name>
<name name-style="western"><surname>Nemethy</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Filmer</surname><given-names>D</given-names></name>
</person-group>             <year>1966</year>             <article-title>Comparison of experimental binding data and theoretical models in proteins containing subunits.</article-title>             <source>Biochemistry</source>             <volume>5</volume>             <fpage>365</fpage>             <lpage>385</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Volkman1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Volkman</surname><given-names>BF</given-names></name>
<name name-style="western"><surname>Lipson</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Wemmer</surname><given-names>DE</given-names></name>
<name name-style="western"><surname>Kern</surname><given-names>D</given-names></name>
</person-group>             <year>2001</year>             <article-title>Two-state allosteric behavior in a single-domain signaling protein.</article-title>             <source>Science</source>             <volume>291</volume>             <fpage>2429</fpage>             <lpage>2433</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Asakura1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Asakura</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Honda</surname><given-names>H</given-names></name>
</person-group>             <year>1984</year>             <article-title>Two-state model for bacterial chemoreceptor proteins. The role of multiple methylation.</article-title>             <source>J Mol Biol</source>             <volume>176</volume>             <fpage>349</fpage>             <lpage>367</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Herzfeld1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Herzfeld</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Stanley</surname><given-names>HE</given-names></name>
</person-group>             <year>1974</year>             <article-title>A general approach to co-operativity and its application to the oxygen equilibrium of hemoglobin and its effectors.</article-title>             <source>J Mol Biol</source>             <volume>82</volume>             <fpage>231</fpage>             <lpage>265</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Henry1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Henry</surname><given-names>ER</given-names></name>
<name name-style="western"><surname>Bettati</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Hofrichter</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Eaton</surname><given-names>WA</given-names></name>
</person-group>             <year>2002</year>             <article-title>A tertiary two-state allosteric model for hemoglobin.</article-title>             <source>Biophys Chem</source>             <volume>98</volume>             <fpage>149</fpage>             <lpage>164</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Ozcan1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ozcan</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Klein</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Lemmon</surname><given-names>MA</given-names></name>
<name name-style="western"><surname>Lax</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Schlessinger</surname><given-names>J</given-names></name>
</person-group>             <year>2006</year>             <article-title>On the nature of low- and high-affinity EGF receptors on living cells.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>103</volume>             <fpage>5735</fpage>             <lpage>5740</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Grosman1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Grosman</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Zhou</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Auerbach</surname><given-names>A</given-names></name>
</person-group>             <year>2000</year>             <article-title>Mapping the conformational wave of acetylcholine receptor channel gating.</article-title>             <source>Nature</source>             <volume>403</volume>             <fpage>773</fpage>             <lpage>776</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Bray2"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bray</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Lay</surname><given-names>S</given-names></name>
</person-group>             <year>1997</year>             <article-title>Computer-based analysis of the binding steps in protein complex formation.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>94</volume>             <fpage>13493</fpage>             <lpage>13498</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Swain1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Swain</surname><given-names>PS</given-names></name>
</person-group>             <year>2004</year>             <article-title>Efficient attenuation of stochasticity in gene expression through post-transcriptional control.</article-title>             <source>J Mol Biol</source>             <volume>344</volume>             <fpage>965</fpage>             <lpage>976</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Oberdorf1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Oberdorf</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Kortemme</surname><given-names>T</given-names></name>
</person-group>             <year>2009</year>             <article-title>Complex topology rather than complex membership is a determinant of protein dosage sensitivity.</article-title>             <source>Mol Syst Biol</source>             <volume>5</volume>             <fpage>253</fpage>          </element-citation></ref>
<ref id="pcbi.1000975-Henis1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Henis</surname><given-names>YI</given-names></name>
<name name-style="western"><surname>Levitzki</surname><given-names>A</given-names></name>
</person-group>             <year>1979</year>             <article-title>Ligand competition curves as a diagnostic tool for delineating the nature of site-site interactions: theory.</article-title>             <source>Eur J Biochem</source>             <volume>102</volume>             <fpage>449</fpage>             <lpage>465</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Jacoby1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Jacoby</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Bouhelal</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Gerspacher</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Seuwen</surname><given-names>K</given-names></name>
</person-group>             <year>2006</year>             <article-title>The 7 TM G-protein-coupled receptor target family.</article-title>             <source>Chem Med Chem</source>             <volume>1</volume>             <fpage>761</fpage>             <lpage>782</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Kenakin1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kenakin</surname><given-names>T</given-names></name>
</person-group>             <year>2004</year>             <article-title>Principles: receptor theory in pharmacology.</article-title>             <source>Trends Pharmacol Sci</source>             <volume>25</volume>             <fpage>186</fpage>             <lpage>192</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Christopoulos1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Christopoulos</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Kenakin</surname><given-names>T</given-names></name>
</person-group>             <year>2002</year>             <article-title>G protein-coupled receptor allosterism and complexing.</article-title>             <source>Pharmacol Rev</source>             <volume>54</volume>             <fpage>323</fpage>             <lpage>374</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Weiss1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Weiss</surname><given-names>JM</given-names></name>
<name name-style="western"><surname>Morgan</surname><given-names>PH</given-names></name>
<name name-style="western"><surname>Lutz</surname><given-names>MW</given-names></name>
<name name-style="western"><surname>Kenakin</surname><given-names>TP</given-names></name>
</person-group>             <year>1996</year>             <article-title>The cubic ternary complex receptor-occupancy model. III. resurrecting efficacy.</article-title>             <source>J Theor Biol</source>             <volume>181</volume>             <fpage>381</fpage>             <lpage>397</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Monczor1"><label>40</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Monczor</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Fernandez</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Legnazzi</surname><given-names>BL</given-names></name>
<name name-style="western"><surname>Riveiro</surname><given-names>ME</given-names></name>
<name name-style="western"><surname>Baldi</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>2003</year>             <article-title>Tiotidine, a histamine H2 receptor inverse agonist that binds with high affinity to an inactive G-protein-coupled form of the receptor. Experimental support for the cubic ternary complex model.</article-title>             <source>Mol Pharmacol</source>             <volume>64</volume>             <fpage>512</fpage>             <lpage>520</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Kenakin2"><label>41</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kenakin</surname><given-names>T</given-names></name>
</person-group>             <year>1995</year>             <article-title>Agonist-receptor efficacy. II. Agonist trafficking of receptor signals.</article-title>             <source>Trends Pharmacol Sci</source>             <volume>16</volume>             <fpage>232</fpage>             <lpage>238</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Watson1"><label>42</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Watson</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Chen</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Irving</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Way</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Chen</surname><given-names>WJ</given-names></name>
<etal/></person-group>             <year>2000</year>             <article-title>The use of stimulus-biased assay systems to detect agonist-specific receptor active states: implications for the trafficking of receptor stimulus by agonists.</article-title>             <source>Mol Pharmacol</source>             <volume>58</volume>             <fpage>1230</fpage>             <lpage>1238</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Devi1"><label>43</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Devi</surname><given-names>LA</given-names></name>
</person-group>             <year>2001</year>             <article-title>Heterodimerization of G-protein-coupled receptors: pharmacology, signaling and trafficking.</article-title>             <source>Trends Pharmacol Sci</source>             <volume>22</volume>             <fpage>532</fpage>             <lpage>537</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-George1"><label>44</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>George</surname><given-names>SR</given-names></name>
<name name-style="western"><surname>O'Dowd</surname><given-names>BF</given-names></name>
<name name-style="western"><surname>Lee</surname><given-names>SP</given-names></name>
</person-group>             <year>2002</year>             <article-title>G-protein-coupled receptor oligomerization and its potential for drug discovery.</article-title>             <source>Nat Rev Drug Discov</source>             <volume>1</volume>             <fpage>808</fpage>             <lpage>820</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Milligan1"><label>45</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Milligan</surname><given-names>G</given-names></name>
</person-group>             <year>2004</year>             <article-title>G protein-coupled receptor dimerization: function and ligand pharmacology.</article-title>             <source>Mol Pharmacol</source>             <volume>66</volume>             <fpage>1</fpage>             <lpage>7</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Park1"><label>46</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Park</surname><given-names>PS</given-names></name>
<name name-style="western"><surname>Filipek</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Wells</surname><given-names>JW</given-names></name>
<name name-style="western"><surname>Palczewski</surname><given-names>K</given-names></name>
</person-group>             <year>2004</year>             <article-title>Oligomerization of G protein-coupled receptors: past, present, and future.</article-title>             <source>Biochemistry</source>             <volume>43</volume>             <fpage>15643</fpage>             <lpage>15656</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Durroux1"><label>47</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Durroux</surname><given-names>T</given-names></name>
</person-group>             <year>2005</year>             <article-title>Principles: a model for the allosteric interactions between ligand binding sites within a dimeric GPCR.</article-title>             <source>Trends Pharmacol Sci</source>             <volume>26</volume>             <fpage>376</fpage>             <lpage>384</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Panetta1"><label>48</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Panetta</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Greenwood</surname><given-names>MT</given-names></name>
</person-group>             <year>2008</year>             <article-title>Physiological relevance of GPCR oligomerization and its impact on drug discovery.</article-title>             <source>Drug Discov Today</source>             <volume>13</volume>             <fpage>1059</fpage>             <lpage>1066</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Lavine1"><label>49</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lavine</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Ethier</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Oak</surname><given-names>JN</given-names></name>
<name name-style="western"><surname>Pei</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>F</given-names></name>
<etal/></person-group>             <year>2002</year>             <article-title>G protein-coupled receptors form stable complexes with inwardly rectifying potassium channels and adenylyl cyclase.</article-title>             <source>J Biol Chem</source>             <volume>277</volume>             <fpage>46010</fpage>             <lpage>46019</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Dupre1"><label>50</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dupre</surname><given-names>DJ</given-names></name>
<name name-style="western"><surname>Robitaille</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Ethier</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Villeneuve</surname><given-names>LR</given-names></name>
<name name-style="western"><surname>Mamarbachi</surname><given-names>AM</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Seven transmembrane receptor core signaling complexes are assembled prior to plasma membrane trafficking.</article-title>             <source>J Biol Chem</source>             <volume>281</volume>             <fpage>34561</fpage>             <lpage>34573</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Kenakin3"><label>51</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kenakin</surname><given-names>T</given-names></name>
</person-group>             <year>2003</year>             <article-title>Ligand-selective receptor conformations revisited: the promise and the problem.</article-title>             <source>Trends Pharmacol Sci</source>             <volume>24</volume>             <fpage>346</fpage>             <lpage>354</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Hall1"><label>52</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hall</surname><given-names>DA</given-names></name>
</person-group>             <year>2000</year>             <article-title>Modeling the functional effects of allosteric modulators at pharmacological receptors: an extension of the two-state model of receptor activation.</article-title>             <source>Mol Pharmacol</source>             <volume>58</volume>             <fpage>1412</fpage>             <lpage>1423</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Ma1"><label>53</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ma</surname><given-names>AW</given-names></name>
<name name-style="western"><surname>Redka</surname><given-names>DS</given-names></name>
<name name-style="western"><surname>Pisterzi</surname><given-names>LF</given-names></name>
<name name-style="western"><surname>Angers</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Wells</surname><given-names>JW</given-names></name>
</person-group>             <year>2007</year>             <article-title>Recovery of oligomers and cooperativity when monomers of the M2 muscarinic cholinergic receptor are reconstituted into phospholipid vesicles.</article-title>             <source>Biochemistry</source>             <volume>46</volume>             <fpage>7907</fpage>             <lpage>7927</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Senozan1"><label>54</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Senozan</surname><given-names>NM</given-names></name>
<name name-style="western"><surname>DeVore</surname><given-names>JA</given-names></name>
<name name-style="western"><surname>Lesniewski</surname><given-names>EK</given-names></name>
</person-group>             <year>1998</year>             <article-title>Hemoglobin-oxygen-carbon monoxide equilibria with the MWC model.</article-title>             <source>Biophys Chem</source>             <volume>75</volume>             <fpage>141</fpage>             <lpage>150</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Conzelmann1"><label>55</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Conzelmann</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Saez-Rodriguez</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Sauter</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Kholodenko</surname><given-names>BN</given-names></name>
<name name-style="western"><surname>Gilles</surname><given-names>ED</given-names></name>
</person-group>             <year>2006</year>             <article-title>A domain-oriented approach to the reduction of combinatorial complexity in signal transduction networks.</article-title>             <source>BMC Bioinformatics</source>             <volume>7</volume>             <fpage>34</fpage>          </element-citation></ref>
<ref id="pcbi.1000975-Yang1"><label>56</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yang</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Monine</surname><given-names>MI</given-names></name>
<name name-style="western"><surname>Faeder</surname><given-names>JR</given-names></name>
<name name-style="western"><surname>Hlavacek</surname><given-names>WS</given-names></name>
</person-group>             <year>2008</year>             <article-title>Kinetic Monte Carlo method for rule-based modeling of biochemical networks.</article-title>             <source>Phys Rev E Stat Nonlin Soft Matter Phys</source>             <volume>78</volume>             <fpage>031910</fpage>          </element-citation></ref>
<ref id="pcbi.1000975-Feret1"><label>57</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Feret</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Danos</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Krivine</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Harmer</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Fontana</surname><given-names>W</given-names></name>
</person-group>             <year>2009</year>             <article-title>Internal coarse-graining of molecular systems.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>106</volume>             <fpage>6453</fpage>             <lpage>6458</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Colquhoun1"><label>58</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Colquhoun</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Dowsland</surname><given-names>KA</given-names></name>
<name name-style="western"><surname>Beato</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Plested</surname><given-names>AJR</given-names></name>
</person-group>             <year>2004</year>             <article-title>How to impose microscopic: Reversibility in complex reaction mechanisms.</article-title>             <source>Biophys J</source>             <volume>86</volume>             <fpage>3510</fpage>             <lpage>3518</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Yang2"><label>59</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Yang</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Bruno</surname><given-names>WJ</given-names></name>
<name name-style="western"><surname>Hlavacek</surname><given-names>WS</given-names></name>
<name name-style="western"><surname>Pearson</surname><given-names>JE</given-names></name>
</person-group>             <year>2006</year>             <article-title>On imposing detailed balance in complex reaction mechanisms.</article-title>             <source>Biophys J</source>             <volume>91</volume>             <fpage>1136</fpage>             <lpage>1141</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Ederer1"><label>60</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ederer</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Gilles</surname><given-names>ED</given-names></name>
</person-group>             <year>2007</year>             <article-title>Thermodynamically feasible kinetic models of reaction networks.</article-title>             <source>Biophys J</source>             <volume>92</volume>             <fpage>1846</fpage>             <lpage>1857</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Ederer2"><label>61</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ederer</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Gilles</surname><given-names>ED</given-names></name>
</person-group>             <year>2008</year>             <article-title>Thermodynamic Constraints in Kinetic Modeling: Thermodynamic-Kinetic Modeling in Comparison to Other Approaches.</article-title>             <source>Eng Life Sci</source>             <volume>8</volume>             <fpage>467</fpage>             <lpage>476</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Ackers1"><label>62</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ackers</surname><given-names>GK</given-names></name>
<name name-style="western"><surname>Johnson</surname><given-names>AD</given-names></name>
<name name-style="western"><surname>Shea</surname><given-names>MA</given-names></name>
</person-group>             <year>1982</year>             <article-title>Quantitative model for gene regulation by lambda phage repressor.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>79</volume>             <fpage>1129</fpage>             <lpage>1133</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Saiz1"><label>63</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Saiz</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Vilar</surname><given-names>JM</given-names></name>
</person-group>             <year>2006</year>             <article-title>Stochastic dynamics of macromolecular-assembly networks.</article-title>             <source>Mol Syst Biol</source>             <volume>2</volume>             <fpage>2006 0024</fpage>          </element-citation></ref>
<ref id="pcbi.1000975-Jackson1"><label>64</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Jackson</surname><given-names>MB</given-names></name>
</person-group>             <year>2006</year>             <source>Molecular and cellular biophysics</source>             <publisher-loc>Cambridge ; New York</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name> <fpage>xiii, 512</fpage>           </element-citation></ref>
<ref id="pcbi.1000975-Leffler1"><label>65</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Leffler</surname><given-names>JE</given-names></name>
</person-group>             <year>1953</year>             <article-title>Parameters for the Description of Transition States.</article-title>             <source>Science</source>             <volume>117</volume>             <fpage>340</fpage>             <lpage>341</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Eaton1"><label>66</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eaton</surname><given-names>WA</given-names></name>
<name name-style="western"><surname>Henry</surname><given-names>ER</given-names></name>
<name name-style="western"><surname>Hofrichter</surname><given-names>J</given-names></name>
</person-group>             <year>1991</year>             <article-title>Application of linear free energy relations to protein conformational changes: the quaternary structural change of hemoglobin.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>88</volume>             <fpage>4472</fpage>             <lpage>4475</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Edelstein1"><label>67</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Edelstein</surname><given-names>SJ</given-names></name>
<name name-style="western"><surname>Schaad</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Henry</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Bertrand</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Changeux</surname><given-names>JP</given-names></name>
</person-group>             <year>1996</year>             <article-title>A kinetic mechanism for nicotinic acetylcholine receptors based on multiple allosteric transitions.</article-title>             <source>Biol Cybern</source>             <volume>75</volume>             <fpage>361</fpage>             <lpage>379</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-Stefan1"><label>68</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stefan</surname><given-names>MI</given-names></name>
<name name-style="western"><surname>Edelstein</surname><given-names>SJ</given-names></name>
<name name-style="western"><surname>Le Novere</surname><given-names>N</given-names></name>
</person-group>             <year>2008</year>             <article-title>An allosteric model of calmodulin explains differential activation of PP2B and CaMKII.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105</volume>             <fpage>10768</fpage>             <lpage>10773</lpage>          </element-citation></ref>
<ref id="pcbi.1000975-SisoNadal1"><label>69</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Siso-Nadal</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Ollivier</surname><given-names>JF</given-names></name>
<name name-style="western"><surname>Swain</surname><given-names>PS</given-names></name>
</person-group>             <year>2007</year>             <article-title>Facile: a command-line network compiler for systems biology.</article-title>             <source>BMC Syst Biol</source>             <volume>1</volume>             <fpage>36</fpage>          </element-citation></ref>
<ref id="pcbi.1000975-Shahrezaei1"><label>70</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shahrezaei</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Ollivier</surname><given-names>JF</given-names></name>
<name name-style="western"><surname>Swain</surname><given-names>PS</given-names></name>
</person-group>             <year>2008</year>             <article-title>Colored extrinsic fluctuations and stochastic gene expression.</article-title>             <source>Mol Syst Biol</source>             <volume>4</volume>             <fpage>196</fpage>          </element-citation></ref>
<ref id="pcbi.1000975-Hucka1"><label>71</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hucka</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Finney</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Sauro</surname><given-names>HM</given-names></name>
<name name-style="western"><surname>Bolouri</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Doyle</surname><given-names>JC</given-names></name>
<etal/></person-group>             <year>2003</year>             <article-title>The systems biology markup language (SBML): a medium for representation and exchange of biochemical network models.</article-title>             <source>Bioinformatics</source>             <volume>19</volume>             <fpage>524</fpage>             <lpage>531</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>