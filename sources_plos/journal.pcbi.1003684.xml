<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-02041</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003684</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Computational neuroscience</subject></subj-group></subj-group><subj-group><subject>Neuroscience</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Modeling Higher-Order Correlations within Cortical Microcolumns</article-title>
<alt-title alt-title-type="running-head">Higher-Order Correlations in Cortical Microcolumns</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Köster</surname><given-names>Urs</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Sohl-Dickstein</surname><given-names>Jascha</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Gray</surname><given-names>Charles M.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Olshausen</surname><given-names>Bruno A.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Redwood Center for Theoretical Neuroscience, University of California, Berkeley, Berkeley, California, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Applied Physics, Stanford University and Khan Academy, Palo Alto, California, United States of America</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Cell Biology and Neuroscience, Montana State University, Bozeman, Montana, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Macke</surname><given-names>Jakob H.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Max Planck Institute for Biological Cybernetics and Bernstein Center for Computational Neuroscience, Germany</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">urs@berkeley.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: CMG UK. Performed the experiments: CMG UK. Analyzed the data: UK BAO JSD. Contributed reagents/materials/analysis tools: CMG UK JSD. Wrote the paper: UK JSD.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>7</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>3</day><month>7</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>7</issue>
<elocation-id>e1003684</elocation-id>
<history>
<date date-type="received"><day>29</day><month>12</month><year>2013</year></date>
<date date-type="accepted"><day>8</day><month>5</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Köster et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>We statistically characterize the population spiking activity obtained from simultaneous recordings of neurons across all layers of a cortical microcolumn. Three types of models are compared: an Ising model which captures pairwise correlations between units, a Restricted Boltzmann Machine (RBM) which allows for modeling of higher-order correlations, and a semi-Restricted Boltzmann Machine which is a combination of Ising and RBM models. Model parameters were estimated in a fast and efficient manner using minimum probability flow, and log likelihoods were compared using annealed importance sampling. The higher-order models reveal localized activity patterns which reflect the laminar organization of neurons within a cortical column. The higher-order models also outperformed the Ising model in log-likelihood: On populations of 20 cells, the RBM had 10% higher log-likelihood (relative to an independent model) than a pairwise model, increasing to 45% gain in a larger network with 100 spatiotemporal elements, consisting of 10 neurons over 10 time steps. We further removed the need to model stimulus-induced correlations by incorporating a peri-stimulus time histogram term, in which case the higher order models continued to perform best. These results demonstrate the importance of higher-order interactions to describe the structure of correlated activity in cortical networks. Boltzmann Machines with hidden units provide a succinct and effective way to capture these dependencies without increasing the difficulty of model estimation and evaluation.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Communication between neurons underlies all perception and cognition. Hence, to understand how the brain's sensory systems such as the visual cortex work, we need to model how neurons encode and communicate information about the world. To this end, we simultaneously recorded the activity of many neurons in a cortical column, a fundamental building block of information processing in the brain. This allows us to discover statistical structure in their activity, a first step to uncovering communication pathways and coding principles. To capture the statistical structure of firing patterns, we fit models that assign a probability to each observed pattern. Fitting probability distributions is generally difficult because the model probabilities of all possible states have to sum to one, and enumerating all possible states in a large system is not possible. Making use of recent advances in parameter estimation, we are able to fit models and test the quality of the fit to the data. The resulting model parameters can be interpreted as the effective connectivity between groups of cells, thus revealing patterns of interaction between neurons in a cortical circuit.</p>
</abstract>
<funding-group><funding-statement>BAO, CMG and UK were supported by National Eye Institute grant #EY019965. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Electrophysiology is rapidly moving towards high density recording techniques capable of capturing the simultaneous activity of large populations of neurons. This raises the challenge of understanding how networks encode and process information in ways that go beyond tuning properties or feedforward receptive field models. Modeling the distribution of states in a network provides a way to discover communication patterns between neurons or functional groupings such as cell assemblies which may exhibit a more direct relation to stimulus or behavioral variables.</p>
<p>The Ising model, originally developed in the 1920s to describe magnetic interactions <xref ref-type="bibr" rid="pcbi.1003684-Ising1">[1]</xref>, has been used to statistically characterize electrophysiological data, particularly in the retina <xref ref-type="bibr" rid="pcbi.1003684-Schneidman1">[2]</xref>, and more recently for cortical recordings <xref ref-type="bibr" rid="pcbi.1003684-Yu1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003684-Hamilton1">[4]</xref>. This model treats spikes from a population of neurons binned in time as binary vectors and captures dependencies between cells with the maximum entropy distribution for pairwise dependencies. This has been shown to provide a good model for small groups of cells in the retina <xref ref-type="bibr" rid="pcbi.1003684-Ganmor1">[5]</xref>, though it is unable to capture dependencies higher than second-order.</p>
<p>In this work, we apply maximum entropy models to neural population recordings from the visual cortex. Cortical networks have proven more challenging to model than the retina: The magnitude and importance of pairwise correlations between cortical cells is controversial <xref ref-type="bibr" rid="pcbi.1003684-Ecker1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003684-Renart1">[7]</xref> and higher-order correlations, i.e. correlations which cannot be captured by a pair-wise maximum entropy model, play a more important role <xref ref-type="bibr" rid="pcbi.1003684-Ohiorhenuan1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1003684-Yu2">[10]</xref>. One of the challenges with current recording technologies is that we can record simultaneously only a tiny fraction of the cells that make up a cortical circuit. Sparse sampling together with the complexity of the circuit mean that the majority of a cell's input will be from cells outside the recorded population. In adult cat visual cortex, direct synaptic connections have been reported to occur between 11%–30% of nearby pairs of excitatory neurons in layer IV <xref ref-type="bibr" rid="pcbi.1003684-Stratford1">[11]</xref>, while a larger fraction of cell pairs show “polysynaptic” couplings <xref ref-type="bibr" rid="pcbi.1003684-Ghose1">[12]</xref>, defined by a broad peak in the cross-correlation between two cells. This type of coupling can be due to common inputs (either from a different cortical area or lateral connections) or a chain of monosynaptic connections. A combination of these is believed to give rise to most of the statistical interactions between recorded pairs of cells. The Ising model, which assumes only pairwise couplings, is well suited to model direct (and symmetric) synaptic coupling, but cannot capture interactions involving more than two cells. We propose a new approach, that addresses both incomplete sampling and common inputs from other cell assemblies, by extending the Ising model with a layer of hidden units or latent variables. The resulting model is a semi-Restricted Boltzmann Machine (sRBM), which combines pairwise connections between visible units with an additional set of connections to hidden units.</p>
<p>Estimating the parameters of energy-based models, to which Ising models and Boltzmann machines belong, is computationally hard because these models cannot be normalized in closed form. For both Ising models and Boltzmann machines with hidden units, the normalization constant is intractable to compute, consisting of a sum over the exponential number of states of the system. This makes exact maximum likelihood estimation impossible for all but the smallest systems and necessitates approximate or computationally expensive estimation methods. In this work, we use Minimum Probability Flow (MPF <xref ref-type="bibr" rid="pcbi.1003684-SohlDickstein1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003684-SohlDickstein2">[14]</xref>, in the context of neural decoding see <xref ref-type="bibr" rid="pcbi.1003684-Hamilton1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003684-Schaub1">[15]</xref>) to estimate parameters efficiently without computing the intractable partition function. It provides a straightforward way to estimate the parameters of Ising models and Boltzmann machines for high-dimensional data.</p>
<p>Another challenge in using energy-based models is the evaluation of their likelihood after fitting to the data, which is again made difficult due to the partition function. To compute probabilities and compare the likelihood of different models, annealed importance sampling (AIS) <xref ref-type="bibr" rid="pcbi.1003684-Neal1">[16]</xref> was used to estimate the partition function.</p>
<p>Combining these two methods for model estimation and evaluation, we show that with hidden units, Boltzmann machines can capture the distribution of states in a microcolumn of cat visual cortex significantly better than an Ising model without hidden units. The higher-order structure discovered by the model is spatially organized and specific to cortical layers, indicating that common input or recurrent connectivity within individual layers of a microcolumn are the dominant source of correlations. Applied to spatiotemporal patterns of activity, the model captures temporal structure in addition to dependencies across different cells, allowing us to predict spiking activity based on the history of the network.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Modeling laminar population recordings</title>
<p>We estimated Ising, RBM and sRBM models for populations of cortical cells simultaneously recorded across all cortical layers in a microcolumn of cat V1 in response to long, continuous natural movies presented at a frame rate of 150 Hz. Code for the model estimation is available for download at <ext-link ext-link-type="uri" xlink:href="http://github.com/ursk/srbm" xlink:type="simple">http://github.com/ursk/srbm</ext-link>. <xref ref-type="fig" rid="pcbi-1003684-g001">Fig. 1a</xref>) shows an example frame from one of the movies. Model parameters were estimated using MPF with an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e001" xlink:type="simple"/></inline-formula> regularization penalty on the model parameters to prevent overfitting. To compute and compare likelihoods, the models were normalized using AIS. Here we present data from two animals, one with 22 single units (B4), another with 36 units (T6), as well as a multiunit recording with 26 units (B4M). <xref ref-type="fig" rid="pcbi-1003684-g001">Fig. 1b</xref>) shows spiking data from session B4 in 20 ms bins, with black squares indicating a spike in a bin. Spatiotemporal datasets were constructed by concatenating spikes from consecutive time bins. Pairs of cells show weak positive correlations, shown in <xref ref-type="fig" rid="pcbi-1003684-g001">Fig. 1c</xref>), and noise correlations computed from 60 repetitions of a 30s stimulus are similarly small and positive. For all recordings, the population was verified to be visually responsive and the majority of cells were orientation selective simple or complex cells. As recordings were performed from a single cortical column, receptive fields shared the same retinotopic location and have similar orientation selectivity, differing mostly in size, spatial frequency and phase selectivity. See <xref ref-type="bibr" rid="pcbi.1003684-Kster1">[17]</xref> for a receptive field analysis performed on the same raw data.</p>
<fig id="pcbi-1003684-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003684.g001</object-id><label>Figure 1</label><caption>
<title>Laminar population recordings in response to natural movies.</title>
<p>(<bold>a</bold>) Example of one of the natural movie stimuli, depicting ducks on a lawn, presented full-field at 150 frames per second. (<bold>b</bold>) Example data from 22 cells (session B4), binned in 20 ms windows, 2 s of data. Columns of this matrix form the training data for our algorithm. For the spatiotemporal version of the model, several adjacent columns are concatenated. (<bold>c</bold>) Pairwise correlations in the raw data, and noise correlations computed from 60 repetitions of a 30 s stimulus, binned at 20 ms. Both show small, positive correlations. Shuffling spikes for each of the cells shows that correlations expected due to shared firing rate modulations time-locked to the stimulus are much smaller.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003684.g001" position="float" xlink:type="simple"/></fig></sec><sec id="s2b">
<title>Pairwise and higher-order models</title>
<p>The estimated model parameters for the three different types of models (Ising, RBM and sRBM) are shown in <xref ref-type="fig" rid="pcbi-1003684-g002">Fig. 2</xref> for session B4. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e002" xlink:type="simple"/></inline-formula> sparseness penalty, chosen to optimize likelihood on a validation dataset, results in many of the parameters being zero. For the Ising model (a) we show the coupling as a matrix plot, with lines indicating anatomical layer boundaries. The diagonal contains the bias terms, which are negative since all cells are off the majority of the time. The matrix has many small positive weights that encourage positive pairwise correlations.</p>
<fig id="pcbi-1003684-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003684.g002</object-id><label>Figure 2</label><caption>
<title>Functional connectivity patterns of the three models estimated for recording session B4.</title>
<p>The horizontal lines indicate approximate boundaries between cortical layers II/III, layer IV and layers V/VI. (<bold>a</bold>) Ising model coupling matrix. Each row/column of the matrix corresponds to a neuron, bias terms are shown on the diagonal. The model has many small coupling terms that encode positive correlations. (<bold>b</bold>) The RBM coupling weights are shown as a bar chart for each hidden unit, ordered from left to right from largest to smallest activity. The first bar chart is the bias for all the visible units, and the blue bar at the top of each plot corresponds to the bias of that hidden unit. Blue bars indicate negative values (the bias terms are predominantly negative, but plotted with flipped sign to fit on the scale of the remaining terms). (<bold>c</bold>) The sRBM weights are shown in the same way, with the pairwise couplings on the left and hidden units on the right. The pairwise connections are qualitatively very different from those of the Ising model, as most of the structure is better captured by hidden units. (<bold>d</bold>) Pairwise coupling terms for the Ising model with stimulus terms. Much of the structure, in particular the bias terms, have been explained away by the stimulus terms. (<bold>e</bold>) Hidden unit couplings for the RBM with stimulus terms. The structure of the hidden units remains largely unchanged, indicating higher-order couplings are due to network interactions and not stimulus correlations.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003684.g002" position="float" xlink:type="simple"/></fig>
<p>In (b) we show the hidden units of the RBM as individual bar plots, with the bars representing connection strengths to visible units. The topmost bar corresponds to the hidden bias of the unit, and hidden units are ordered from highest to lowest variance. The units are highly selective in connectivity: The first unit almost exclusively connects to cells in the deep (granular and subgranular) cortical layers. The second unit captures correlations between cells in the superficial (supergranular) layers. The correlations are of high order, with 10 and more cells receiving input from a hidden unit. The remaining units connect fewer cells, but still tend to be location-specific. Only the hidden units that have non-zero couplings are shown. Additional hidden units are turned off by the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e003" xlink:type="simple"/></inline-formula> sparseness penalty, which was chosen to maximize likelihood on the cross-validation dataset. The interpretation of hidden units is quite similar to the pairwise terms of the Ising model: positive coupling to a group of visible units encourages these units to become active simultaneously, as the energy of the system is lowered if both the hidden unit and the cells it connects to are active. Thus the hidden units become switched on when cells they connect to are firing (activation of hidden units not shown).</p>
<p>The sRBM combines both pairwise and hidden connections and hence is visualized with a pairwise coupling matrix and bar plots for hidden units. With the larger number of parameters, the best model is even more sparse in the number of nonzero parameters. The remaining pairwise terms predominantly encode negative interactions, and much of the positive coupling has been explained away by the hidden units. These give rise to strong positive couplings within either superficial (II/III) or intermediate (IV) and deep (V/VI) layers, which explain the majority of structure in the data. The more succinct explanation for dependencies between recorded neurons is via connections to shared hidden units, rather than direct couplings between visible units. The RBM and sRBM in this comparison were both estimated with 22 hidden units, but we show only units that did not turn off entirely due to the sparseness penalty. In this example, a sparseness penalty of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e004" xlink:type="simple"/></inline-formula> was found to be optimal for all three models.</p>
</sec><sec id="s2c">
<title>Including stimulus-driven components</title>
<p>In order to ascertain to what degree the stimulus driven component of activity accounts for the learned higher-order correlations, we augmented the above models with a dynamic bias term that consists of the log of the average instantaneous firing probability of each cell over repeated presentations of the same stimulus. In the case that all trained parameters were zero, this model would assign a firing probability to all neurons identical to that in the peri-stimulus time histogram (PSTH).</p>
<p>In <xref ref-type="fig" rid="pcbi-1003684-g002">Fig. 2d</xref>) the couplings for the Ising model with stimulus terms are shown. As the pairwise couplings now only capture additional structure beyond correlations explained by the stimulus, they tend to be weaker than in the Ising model without stimulus terms. In particular the bias terms on the diagonal are almost completely explained away by the dynamic bias. The same reasoning applies to the RBM with PSTH terms, which is shown in e). Although the couplings are weaker than for the pure RBM, the basic structure remains, with the first two hidden units explaining correlations within superficial and deep groups of cells, respectively. This shows that the learned coupling structure can not be explained purely from higher-order stimulus correlations and receptive field overlap. Even when stimulus-induced correlations are fully accounted for, the correlation structure captured by the RBM remains similar and higher-order correlations are the dominant driver of correlated firing.</p>
</sec><sec id="s2d">
<title>Model comparison</title>
<p>For a quantitative comparison between models, we computed normalized likelihoods using Annealed Importance Sampling (AIS) to estimate the partition function. For each model, we generated 500 samples through a chain of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e005" xlink:type="simple"/></inline-formula> annealing steps. To ensure convergence of the chain, we use a series of chains varying the number of annealing steps and verify that the estimate of the partition function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e006" xlink:type="simple"/></inline-formula> stabilizes to within at least 0.02 bits/s (see <xref ref-type="supplementary-material" rid="pcbi.1003684.s001">Fig. S1</xref>). For models of size 20 and smaller we furthermore computed the partition function exactly to verify the AIS estimate.</p>
<p><xref ref-type="fig" rid="pcbi-1003684-g003">Fig. 3a</xref>) shows a comparison of excess log likelihood <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e007" xlink:type="simple"/></inline-formula> for the three different models and on all three datasets. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e008" xlink:type="simple"/></inline-formula>, which we define as the gain in likelihood over the independent firing rate model, is computed in units of bits/spike for the full population. Both higher-order models outperform the Ising model in fitting the datasets significantly. Error bars are standard deviation computed from 10 models with different random subsets of the data used for learning and validation, and different random seeds for the parameters and the AIS sampling runs.</p>
<fig id="pcbi-1003684-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003684.g003</object-id><label>Figure 3</label><caption>
<title>Model comparison using likelihood gain over the independent model.</title>
<p>Likelihoods are normalized to bits/spike to account for different population size as well as firing rate. (<bold>a</bold>) The change in performance with dataset size (22 cells for session B4, 26 cells for MU, and 36 cells for T6) is thus due to additional structure captured from larger populations. B4 and T6 are spike sorted, B4M is a multiunit dataset. All three models outperform the independent model by 0.4–0.8 bits/spike. The higher-order models with hidden units give a small (0.03–0.04 bits/spike, about 10%) improvement over the Ising model for the small datasets, growing to 0.18 bits/spike, about 28%, for the dataset with the large population size. (<bold>b</bold>) Including stimulus terms provides a large gain in likelihood, even the stimulus PSTH term alone outperforms the network models by a large margin for this dataset. There is still a significant gain by including coupling terms. The difference between the second order Ising model and higher-order RBM is particularly visible in the right hand plot which shows the gain relative to the PSTH only model. All error bars indicate one standard deviation over repeated estimation on different random subsets of the data for training and validation and random initializations of AIS estimation.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003684.g003" position="float" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1003684-g003">Fig. 3b</xref>) shows the excess log likelihood for the models with stimulus terms. Due to the additional computational complexity, these models were only estimated for the small B4 data set. The left of the two bar plots shows that including the stimulus information through the PSTH greatly increases the likelihood, even the PSTH only model without coupling terms outperforms the Ising and RBM models by about 0.7 bits/s. Including coupling terms still increases the likelihood, which is particularly visible on the right bar plot which shows the log likelihood gain relative to the PSTH model. Including higher-order coupling terms still provides a significant gain over the pairwise model, confirming that there are higher-order correlation in the data beyond those induced by the stimulus.</p>
<p>Each of the models was estimated for a range of sparseness parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e009" xlink:type="simple"/></inline-formula> bracketing the optimal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e010" xlink:type="simple"/></inline-formula> using 4-fold cross-validation on a holdout set, and the results are shown for the optimal choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e011" xlink:type="simple"/></inline-formula> for each model.</p>
<p>Additional insight into the relative performance of the models can be gained by comparing model probabilities to empirical probabilities for the various types of patterns. <xref ref-type="fig" rid="pcbi-1003684-g004">Fig. 4</xref> shows scatter plots of model probabilities under the different models against pattern frequencies in the data. Patterns with a single active cell, two simultaneously active cells, etc. are distinguished by different symbols. As expected from the positive correlations, the independent model (yellow) shown in a) consistently overestimates the probabilities of cells being active individually, so these patterns fall above the identity line, while all other patterns are underestimated. For comparison, the Ising model is shown in the same plot (blue), and does significantly better, indicated by the points moving closer to the identity line. It still tends to fail in a similar way though, with many of the triplet patterns being underestimated as the model cannot capture triplet correlations. In b), this model is directly compared against the RBM (green). Except for very rare patterns, most points are now very close to the identity line, as the model can fully capture higher-order dependencies. Hidden units describe global dependencies that greatly increase the frequency of high order patterns compared to individually active cells. The 5% and 95% confidence intervals for the counting noise expected in the empirical frequency of states are shown as dashed lines. The solid line is the identity. Inserts in both models show the distribution of synchrony, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e012" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e013" xlink:type="simple"/></inline-formula> is the number of cells simultaneously firing in one time bin. This metric has been used for example in <xref ref-type="bibr" rid="pcbi.1003684-Tkaik1">[18]</xref> to show how pairwise models fail to capture higher-order dependencies. In the case of the T6 data set with 36 cells shown here, the Ising model and RBM both provide a good fit to the distribution of synchrony in the observed data.</p>
<fig id="pcbi-1003684-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003684.g004</object-id><label>Figure 4</label><caption>
<title>Scatter plot showing empirical probabilities against model probabilities on T6 test dataset.</title>
<p>Different models are distinguished by color, the number of simultaneously spiking cells in each pattern by different symbols. (<bold>a</bold>) shows the independent model compared to the Ising model, (<bold>b</bold>) shows the Ising model compared to the RBM. The sRBM is omitted as it is very similar to the RBM. The RBM significantly outperforms simpler models. Inserts in both models show the distribution of synchrony, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e014" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e015" xlink:type="simple"/></inline-formula> is the number of cells simultaneously firing in one time bin. The synchrony in the empirical distribution (red line) is greatly underestimated by the independent model (yellow), but well captured by both the pairwise (blue) and higher-order model (green).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003684.g004" position="float" xlink:type="simple"/></fig>
<p>Note that any error in estimating the partition function of the models would lead to a vertical offset of all points. Thus visually checking the alignment of the data cloud around the identity line provides a visual verification that there are no catastrophic errors in the estimation of the partition function. Unfortunately we cannot use this alignment as a shortcut to compute the partition function without sampling, e.g. by defining <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e016" xlink:type="simple"/></inline-formula> such that the all zeros state has the correct frequency, as this assumes a perfect model fit. For instance, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e017" xlink:type="simple"/></inline-formula> regularization tends to reduce model probabilities of the most frequent states, so this estimate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e018" xlink:type="simple"/></inline-formula> would systematically overestimate the likelihood of regularized models. We note, however, that for higher-order models with no regularization this estimate does indeed agree well with the AIS estimate.</p>
</sec><sec id="s2e">
<title>Spatiotemporal models</title>
<p>The same models can be used to capture spatiotemporal patterns by treating previous time steps as additional cells. Consecutive network states binned at 6.7 ms were concatenated in blocks of up to 13 time steps, for a total network dimensionality of 130 with 10 cells. These models were cross-validated and the sparseness parameters optimized in the same way as for the instantaneous model. This allows us to learn kernels that describe the temporal structure of interactions between cells.</p>
<p>In <xref ref-type="fig" rid="pcbi-1003684-g005">Fig. 5</xref> we compare the relative performance of spatiotemporal Ising and higher-order models as a function of the number of time steps included in the model. To create the datasets, we picked a subset of 10 cells with the highest firing rates from the B4 dataset (4 cells from subgranular, 2 from granuar and 4 from supergranular layers) and concatenated blocks of up to 13 subsequent data vectors. This way models of any dimensionality divisible by 10 can be estimated. The number of parameters of the RBM and Ising model were kept the same by fixing the number of hidden units in the RBM to be equal to the number of visible units, the sRBM was also estimated with a square weight matrix for the hidden layer. As before, the higher-order models consistently outperform the Ising model. The likelihood per spike increases with the network size for all models, as additional information from network interactions leads to an improvement in the predictive power of the model. The curve for the Ising model levels off after a dimensionality of about 30 is reached, as higher-order structure that is not well captured by pairwise coupling becomes increasingly important. However, the likelihood of higher-order models continues to increase through the entire experimental range.</p>
<fig id="pcbi-1003684-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003684.g005</object-id><label>Figure 5</label><caption>
<title>Likelihood comparison as a function of model size.</title>
<p>Spatiotemporal models with 10 cells and a varying number of concatenated time steps. The log-likelihood per spike increases as each neuron is modeled as part of a longer time sequence. This effect holds both for Ising and higher-order models. Since the Ising model cannot capture many of the relevant dependencies, the increase in likelihood saturates after about 3 timesteps for the Ising model, but continues to increase for the higher-order models. Insert: Comparison of the entropy per time slice for Ising and RBM models as a function of model size. As the RBM is better able to model spatiotemporal dependencies, the additional entropy for extra frames is smaller than for the Ising models. The RBM does not reach the point of extensivity, where additional frames add constant entropy. Multiple lines of the same color indicate repeated runs with different random initialization.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003684.g005" position="float" xlink:type="simple"/></fig>
<p>The insert in the figure shows the entropy of the models, normalized by the data dimensionality by dividing by the number of frames and neurons. The entropy was computed as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e019" xlink:type="simple"/></inline-formula> where the expectation of the energy was estimated by initializing 100,000 samples using the holdout data set, and then running 2000 steps of Gibbs sampling. Due to temporal dependencies additional frames carry less entropy, but we do not reach the point of extensivity where the additional entropy per frame reaches a constant value. As the RBM is better able to explain additional structure in new frames, the additional entropy for new frames is much less than for the Ising model.</p>
<p>A similar observation has been made in <xref ref-type="bibr" rid="pcbi.1003684-Ganmor1">[5]</xref>, where Ising and higher-order models for 100 retinal ganglion cells were compared to models for 10 time steps of 10 cells. It is noteworthy that temporal dependencies are similar to dependencies between different cells, in that there are strong higher-order correlations not well described by pairwise couplings. These dependencies extend surprisingly far across time (at least 87 ms, corresponding to the largest models estimated here) and are of such a form that including pairwise couplings to these states does not increase the likelihood of the model. This has implications e.g. for GLMs that are typically estimated with linear spike coupling kernels which will likely miss these interactions.</p>
<p>To predict spiking based on the network history, we can compute the conditional distribution of single units given the state of the rest of the network. This is illustrated for a network with 15 time steps for a dimensionality of 150. This model is not included in the above likelihood comparison, as the AIS normalization becomes very expensive for this model size. <xref ref-type="fig" rid="pcbi-1003684-g006">Fig. 6a</xref>) shows the learned weights of 18 randomly chosen nonzero hidden units for a spatiotemporal RBM model with 150 hidden units. Each subplot corresponds to one hidden unit, which connects to 10 neurons (vertical axis) across 15 time steps or 100 ms (horizontal axis). Some units specialize in spatial coupling across different cells at a constant time lag. As the model has no explicit notion of time, the time lag of these spatial couplings is not unique and the model learns multiple copies of the same spatial pattern. Thus while there are 55 nonzero hidden units, the number of unique patterns is much smaller so that the effective representation is quite sparse. The remaining units describe smooth, long-range temporal dependencies, typically for small groups of cells. Both of these subpopulations capture higher-order structure connecting many neurons that cannot be well approximated with pairwise couplings.</p>
<fig id="pcbi-1003684-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003684.g006</object-id><label>Figure 6</label><caption>
<title>Spatiotemporal network models.</title>
<p>(<bold>a</bold>) Hidden units of spatiotemporal sRBM model. For each hidden unit, the horizontal axis is time and the vertical axis cells with horizontal bars separating the subgranular, granular and supergranular cortical layers. (<bold>b</bold>) Log-likelihood gain for each of the 10 cells (ordered by firing rate) conditioned on the remainder of the network state for all three models. (<bold>c</bold>) Spike prediction from network history. For one of the cells, we show 1 s of predicted activity given the history of the network state. In each case when a spike occurs in the data (gray bars), there is an elevated probability under the models (colored bars).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003684.g006" position="float" xlink:type="simple"/></fig>
<p>By conditioning the probability of one cell at one time bin on the state of the remaining network, we can compute how much information about a cell is captured by the model over a naive prediction based on the firing rate of the cell. This conditional likelihood for each cell is plotted in <xref ref-type="fig" rid="pcbi-1003684-g006">Fig. 6b</xref>) in a similar way to excess log likelihood for the entire population in <xref ref-type="fig" rid="pcbi-1003684-g005">Fig. 5</xref>, except in units of bits per second rather than bits per spike. While the result here reflects our previous observation that Boltzmann machines with hidden units outperform Ising models, we note that the conditional probabilities are easily normalized in closed form since they describe a one-dimensional state space. Thus we can ensure that the likelihood gain holds independent of the estimation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e020" xlink:type="simple"/></inline-formula> and is not due to systematic errors in sampling from the high-dimensional models. <xref ref-type="fig" rid="pcbi-1003684-g006">Fig. 6c</xref>) provides a more intuitive look at the prediction. For 1 s of data from one cell, where 5 spikes occur, we show the conditional firing probabilities for the three models given 100 ms of history of itself and the other cells. Qualitatively, the models perform well in predicting spiking probabilities, suggesting it might compare favorably to prediction based on GLMs or Ising models <xref ref-type="bibr" rid="pcbi.1003684-Truccolo1">[19]</xref>.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<sec id="s3a">
<title>Contributions</title>
<p>While there has been a resurgence of interest in Ising-like maximum entropy models for describing neural data, progress has been hampered mainly by two problems. First, estimation of energy based models is difficult since these models cannot be normalized in closed form. Evaluating the likelihood of the model thus requires approximations or a numerical integral over the exponential number of states of the model, making maximum likelihood estimation computationally intractable. Even the pairwise Ising model is typically intractable to estimate, and various approximations are required to overcome this problem. Second, the number of model parameters to be estimated grows very rapidly with neural population size. If correlations up to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e021" xlink:type="simple"/></inline-formula> order are considered, the number of parameters is proportional to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e022" xlink:type="simple"/></inline-formula>. In general, fully describing the distribution over states requires a number of parameters which is exponential in the number of neurons. This can be dealt with by cutting off dependencies at some low order, by estimating only a small number of higher-order coupling terms, or by imposing some specific form on the dependencies.</p>
<p>We attempted to address both of these problems here. Parameter estimation was made tractable using MPF, and latent variables were shown to be an effective way of capturing high order dependencies. This addresses several shortcomings that have been identified with the Ising model.</p>
</sec><sec id="s3b">
<title>Shortcomings of Ising models</title>
<p>As argued in <xref ref-type="bibr" rid="pcbi.1003684-Macke1">[20]</xref>, models with direct (pairwise) couplings are not well suited to model data recorded from cortical networks. Since only a tiny fraction of the neurons making up the circuit are recorded, most input is likely to be common input to many of the recorded cells rather than direct synapses between them. While this work compares Generalized Linear Models (GLMs) such as models of the retina <xref ref-type="bibr" rid="pcbi.1003684-Pillow1">[21]</xref> and for LGN <xref ref-type="bibr" rid="pcbi.1003684-Butts1">[22]</xref> to linear dynamical systems (LDS) models, the argument applies equally for the models presented here.</p>
<p>Another shortcoming of the Ising model and some previous extensions is that the number of parameters to be estimated does not scale favorably with the dimensionality of the network. The number of pairwise coupling terms in GLM and Ising models scales with the square of the number of neurons, so with the amounts of data typically collected in electrophysiological experiments it is only possible to identify the parameters for small networks with a few tens of cells. This problem is aggravated by including higher-order couplings: for example the number of third order coupling parameters scales with the cube of the data dimensionality. Therefore attempting to estimate these coupling parameters directly is a daunting task that usually requires approximations and strong regularization.</p>
</sec><sec id="s3c">
<title>Higher-order correlations in small networks</title>
<p>Early attempts at modeling higher-order structure side-stepped these technical issues by focussing on structure in very small networks. Ohiorhenuan noted that Ising models fail to explain structure in cat visual cortex <xref ref-type="bibr" rid="pcbi.1003684-Ohiorhenuan1">[8]</xref> and was able to model triplet correlations <xref ref-type="bibr" rid="pcbi.1003684-Ohiorhenuan2">[9]</xref> by considering very small populations of no more than 6 neurons. Similarly, Yu et al. <xref ref-type="bibr" rid="pcbi.1003684-Yu1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1003684-Yu2">[10]</xref> show that over the scale of adjacent cortical columns of anesthetized cat visual cortex, small subnetworks of 10 cells are better characterized with a dichotomized Gaussian model than the pairwise maximum entropy distribution. While the dichotomized Gaussian <xref ref-type="bibr" rid="pcbi.1003684-Macke2">[23]</xref> is estimated only from pairwise statistics, it carries higher-order correlations that can be interpreted as common Gaussian inputs <xref ref-type="bibr" rid="pcbi.1003684-Macke3">[24]</xref>. However these correlations are implicit in the structure of the model and not directly estimated from the data as with the RBM, so it is not clear that the model would perform as well on different datasets.</p>
</sec><sec id="s3d">
<title>Modeling large networks</title>
<p>Given that higher-order correlations are important to include in statistical models of neural activity, the question turns to how these models can be estimated for larger data sets. In this section, we focus on two approaches that are complementary to our model using hidden units. The increasing role of higher-order correlations in larger networks was first observed in <xref ref-type="bibr" rid="pcbi.1003684-Tkacik1">[25]</xref>, where Ising models were fit via MCMC methods to the same 40 cell retina dataset that was analyzed in terms of subsets of 10 cells in <xref ref-type="bibr" rid="pcbi.1003684-Schneidman1">[2]</xref>. This point is further emphasized by Schneidman and Ganmor in <xref ref-type="bibr" rid="pcbi.1003684-Ganmor1">[5]</xref>, who caution that trying to model small subsets (10 cells) of a larger network to infer properties of the full network may lead to incorrect conclusions, and show that for retinal networks higher-order correlations start to dominate only once a certain network size is reached.</p>
<p>Therefore they address the same question as the present paper, i.e. how to capture <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e023" xlink:type="simple"/></inline-formula> order correlations without the accompanying <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e024" xlink:type="simple"/></inline-formula> growth in the number of free parameters in a larger network. In their proposed Reliable Interaction Model (RIM), they exploit the sparseness of the neural firing patterns to argue that it is possible to explicitly include third, forth and higher-order terms in the distribution, as most higher-order coupling terms will be zero. Therefore the true distribution can be well approximated from a small number of these terms, which can be calculated using a simple recursive scheme. In practice, the main caveat is that only patterns that appear in the data many times are used to calculate the coupling terms. While the model by construction assigns correct relative probabilities to observed patterns, the probability assigned to unobserved patterns is unconstrained, and most of the RIM's probability mass may thus be assigned to states which never occur in the data.</p>
<p>The second alternative to the RBM with hidden units is to include additional low-dimensional constraints in an Ising model. In the “K-pairwise” model <xref ref-type="bibr" rid="pcbi.1003684-Tkaik1">[18]</xref>, <xref ref-type="bibr" rid="pcbi.1003684-Tkaik2">[26]</xref>, in addition to constraining pairwise correlations, a term is introduced to constrain the probability of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e025" xlink:type="simple"/></inline-formula> neurons being active simultaneously. This adds very little model complexity, but significantly improves the model of the data. This is shown, for example, by computing conditional predictions in a similar fashion to that shown in <xref ref-type="fig" rid="pcbi-1003684-g006">Fig. 6c</xref>), where the K-pairwise model for a population of 100 retinal ganglion cells has an 80% correlation with the repeated trial PSTH. In contrast to the RBM, however, this model is not structured in a way that can be easily interpreted in terms of functional connectivity. To estimate these models for large numbers (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e026" xlink:type="simple"/></inline-formula>) of neurons, the authors leverage the sampling algorithm described in <xref ref-type="bibr" rid="pcbi.1003684-Broderick1">[27]</xref>, an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e027" xlink:type="simple"/></inline-formula>-regularized histogram Monte Carlo method.</p>
<p>In addition to proposing a faster (though slower than MPF) parameter estimation method for this class of models, Tkačik and colleagues address the difficulty in sampling from the model and computing the partition function. In our experiments the overall limiting factor is the Gibbs sampler in the AIS partition function estimation. Tkačik et al. use a more efficient sampling algorithm (Wang-Landau) to compute partition functions and entropy of their models. As an even simpler approach to the partition function problem, they suggest that it can be obtained in closed form if the empirical probability of at least one pattern in the data is accurately known. A case in point is the all zeros pattern that is typically frequent for recordings with sparsely firing neurons. Unfortunately, this approach is limited in that it assumes that the probability the model assigns to the state is identical to the empirical probability of the state. In the case that the model has not been perfectly fit to the data, or in the case that the data does not belong to the model class, this will lead to an incorrect estimate of the partition function.</p>
</sec><sec id="s3e">
<title>Modeling stimulus-driven components</title>
<p>Since the activity we are modeling is in response to a specific stimulus, one may rightfully question whether the observed higher-order correlations in neural activity are simply due to higher-order structure contained in the stimulus, as opposed to being an emergent property of cortical networks. In an attempt to tease apart the contribution of the stimulus, we included a nonparametric PSTH term in the model. However, this can capture arbitrarily complex stimulus transformations using the trial-averaged response to predict the response to a new repetition of the same stimulus. As an “oracle model”, it does not only capture the part of the response that could be attributed to a feed-forward receptive field, but also captures contextual modulation effects mediated by surrounding columns and feedback from higher brain areas, essentially making it “too good” as a stimulus model. The RBM and Ising models are then relegated to merely explain the trial to trial variability in our experiments. Not including stimulus terms and finding the best model to explain the correlations present in the data, irrespective of whether they are due to stimulus or correlated variability, seems to be an equally valid approach to discover functional connectivity in the population.</p>
</sec><sec id="s3f">
<title>Relation to GLMs</title>
<p>GLMs <xref ref-type="bibr" rid="pcbi.1003684-Pillow1">[21]</xref> can be used to model each cell conditioned on the rest of the population. While mostly used for stimulus response models including stimulus terms, they are easily extended with terms for cross-spike coupling, which capture interactions between cells. GLMs have been successfully augmented with latent variables <xref ref-type="bibr" rid="pcbi.1003684-Macke1">[20]</xref>, for instance to model the effect of common noisy inputs on synchronized firing at fast timescales <xref ref-type="bibr" rid="pcbi.1003684-Vidne1">[28]</xref>. A major limitation of GLMs is that current implementations can only be estimated efficiently if they are linear in the stimulus features and network coupling terms, so they are not easily generalized to higher-order interactions. Two approaches have been used to overcome this limitation for stimulus terms. The GLM can be extended with additional nonlinearities, preserving convexity on subproblems <xref ref-type="bibr" rid="pcbi.1003684-Butts1">[22]</xref>. Alternatively, the stimulus terms can be packaged into nonlinear features which are computed in preprocessing and usually come with the penalty of a large increase in the dimensionality of the problem <xref ref-type="bibr" rid="pcbi.1003684-Gerwinn1">[29]</xref>. However, we are not aware of any work applying either of these ideas to spike history rather than stimulus terms. Another noteworthy drawback of GLMs is that instantaneous coupling terms cannot be included <xref ref-type="bibr" rid="pcbi.1003684-Macke1">[20]</xref>, so instantaneous correlations cannot be modeled and have to be approximated using very fine temporal discretization.</p>
</sec><sec id="s3g">
<title>Conclusion</title>
<p>The RBM provides a parsimonious model for higher-order dependencies in neural population data. Without explicitly enumerating a potentially exponential number of coupling terms or being constrained by only measurements of pairwise correlations, it provides a low-dimensional, physiologically interpretable model that can be easily estimated for populations of 100 or more cells.</p>
<p>The connectivity patterns the RBM learns from cells simultaneously recorded from all cortical layers are spatially localized, showing that small neural assemblies within cortical layers are strongly coupled. This suggests that cells within a layer perform similar computations on common input, while cells across different cortical layers participate in distinct computations and have much less coupled activity. This novel observation is made possible by the RBM: because each of the hidden units responds to (and therefore learns on) a large number of recorded patterns, it can capture dependencies that are too weak to extract with previous models. In particular, the connectivity patterns discovered by the RBM and sRBM are by no means obvious from the covariance of the data or by inspecting the coupling matrix of the Ising model. This approach, combining a straightforward estimation procedure and a powerful model, can be extended from polytrode recordings to capture physiologically meaningful connectivity patterns in other types of multi-electrode data.</p>
</sec></sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Recording and experimental procedures</title>
<sec id="s4a1">
<title>Ethics statement</title>
<p>The protocol used in the experiments was approved by the Institutional Animal Care and Use Committee at Montana State University and conformed to the guidelines recommended in Preparation and Maintenance of Higher Mammals During Neuroscience Experiments, National Institutes of Health Publication 913207 (National Institutes of Heath, Bethesda, MD 1991).</p>
</sec><sec id="s4a2">
<title>Visual stimuli</title>
<p>Three movies of 8, 20 and 30 minutes duration were captured at 300 frames per second and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e028" xlink:type="simple"/></inline-formula> pixel resolution with a Casio F1 camera. All movies were recorded on the campus of MSU Bozeman and depicted natural scenes such as ducks swimming on a pond, selected to contain heterogeneous motion across the scene. The camera was mounted on a tripod to avoid camera motion and there were no scene changes within movies, so the spatiotemporal statistics of the movie do not contain artifacts from camera motion or cuts. Movies were converted to grayscale with no additional contrast normalization on top of the in-camera processing, and temporally down-sampled to 150 Hz for presentation. The high frame rate was chosen to prevent cells phase locking to the frame rate, and scene changes were minimized to avoid evoked potentials due to sudden luminance changes. The movies were presented at 150 frames per second on a 21″ CRT monitor that was calibrated for a linear response. Each of the three movies was presented once and a 30 s segment of the first movie was presented for 60 repeated trials.</p>
</sec><sec id="s4a3">
<title>Recording methods</title>
<p>Data were recorded from anesthetized cat visual cortex in response to a custom set of full field natural movie stimuli. The surgical methods are described in detail elsewhere <xref ref-type="bibr" rid="pcbi.1003684-Gray1">[30]</xref>. In brief, the anesthetized animals were mounted in a stereotaxic frame and a small craniotomy was made over area 17. The dura was reflected and agar in artificial cerebrospinal fluid was applied to protect the cortical surface and reduce pulsations. The polytrode was slowly lowered perpendicularly into cortex using a hydraulic microdrive. Recordings were made with single shank 32 channel polytrodes (Neuronexus Technologies A1×32) with a channel spacing of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e029" xlink:type="simple"/></inline-formula>, contact diameter of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e030" xlink:type="simple"/></inline-formula> and thickness of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e031" xlink:type="simple"/></inline-formula>, spanning all the layers of visual cortex. Individual datasets had on the order of 20 to 40 simultaneously recorded neurons.</p>
<p>For spike sorting, the 32 polytrode channels were treated as 8 non-overlapping groups, shown in Fig. S 2a). To each group, a standard tetrode spike sorting method was applied <xref ref-type="bibr" rid="pcbi.1003684-Gray1">[30]</xref>: In brief, spike waveforms were extracted at a threshold of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e032" xlink:type="simple"/></inline-formula> and features (area, energy, peak, valley, peak valley ratio, width, trigger value and the first three principal components) computed for each channel in the group. In this feature space the data was clustered using k-means clustering (KlustaKwik, <xref ref-type="bibr" rid="pcbi.1003684-Harris1">[31]</xref>) with a manual cleanup using the MClust Matlab package <xref ref-type="bibr" rid="pcbi.1003684-Redish1">[32]</xref>. See Fig. S 2b) for cluster isolation for an example channel group. Cleanup consisted of identifying and removing artifacts, and merging clusters belonging to the same cell. Clusters were then labeled as either single- or multi-unit activity based on the following diagnostics: Inspection of distribution of waveform amplitudes on all four channels to ensure clusters were well-separated and no spikes were missing due to the thresholding; inspection of cross-correlograms to identify cells that appeared on two neighboring tetrode groups or triggered on two channels within a group; inspection of inter-spike interval distributions to identify multiunit activity based on intervals shorter than 1 ms and thus below the refractory period of a single cell; inspection of raw waveforms and the time-course of waveform amplitudes. Clusters that passed all criteria were added to the single unit data set, for which ISI histograms are shown in Fig. S 2c), remaining spikes were considered multi-unit activity. Unless noted otherwise, spikes for all data sets were binned at 20 ms where bins with a single spike (2.4% of bins) and multiple spikes (0.9% of bins) were both treated as spiking and the rest as non-spiking. The bin size was chosen to span the width of the central peak in cross-correlograms between pairs of cells such as shown in <xref ref-type="fig" rid="pcbi-1003684-g007">Fig. 7c</xref>), where the dashed vertical lines at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e033" xlink:type="simple"/></inline-formula> envelope the central peak.</p>
<fig id="pcbi-1003684-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003684.g007</object-id><label>Figure 7</label><caption>
<title>Experimental methods.</title>
<p>(<bold>a</bold>) Example recording site with lines indicating layer boundaries and a schematic drawing of the 32-channel probe. (<bold>b</bold>) Current source density (the second spatial derivative of the LFP) in response to a full-field flash stimulus, showing a strong current sink in layer IV and to a lesser degree in layer VI. CSD was used to assign layer boundaries. (<bold>c</bold>) Cross-correlation for one pair of cells across time, binned at 6.7 ms. Correlations fall off quickly as the time lag increases with a central peak extending <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e034" xlink:type="simple"/></inline-formula> indicated by dashed lines.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003684.g007" position="float" xlink:type="simple"/></fig></sec><sec id="s4a4">
<title>Histological procedures</title>
<p>To register individual recording channels with cortical layers, recording locations were reconstructed from Nissl-stained histological sections, and current source density (CSD) analysis in response to 100 repetitions of a full-field stimulus flashed at 1 Hz was used to infer the location of cortical layer IV on the polytrode <xref ref-type="bibr" rid="pcbi.1003684-Mitzdorf1">[33]</xref>. Spike-sorted units were assigned to layers based on the channel with the largest amplitude. In <xref ref-type="fig" rid="pcbi-1003684-g007">Fig. 7a</xref>) we use horizontal lines to indicate cortical layer boundaries and their position relative to the polytrode. <xref ref-type="fig" rid="pcbi-1003684-g007">Fig. 7b</xref>) shows the CSD response for this session, showing a strong current sink in layer IV and to a lesser degree in layer VI.</p>
</sec><sec id="s4a5">
<title>Datasets</title>
<p>The models were estimated on a data set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e035" xlink:type="simple"/></inline-formula> data vectors corresponding to approximately 60 minutes of recording time. The data were split into two subsets of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e036" xlink:type="simple"/></inline-formula> by random assignment of data points: a training set for parameter estimation and a test set to compute cross-validated likelihoods.</p>
<p>For the stimulus dependent model, a separate data set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e037" xlink:type="simple"/></inline-formula> data vectors was used, taken from a 30 s long movie that was repeated for 60 presentations, and again split into a training and test set of equal size. No separate validation set was used and the hyper-parameter was selected directly on the test set.</p>
<p>We also analyzed spatiotemporal patterns of data, which were created by concatenating consecutive state vectors. For the spatiotemporal experiments a bin width of 6.7 ms, corresponding to the frame rate of the stimulus, was used. This bin size is a compromise capturing more detailed structure in the data without leading to an undue increase in dimensionality and complexity. Up to 13 time bins were concatenated in order to discover spatiotemporal patterns and predict spiking given the history over the prior 87 ms. These models were trained on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e038" xlink:type="simple"/></inline-formula> samples and likelihoods were computed on a set of equal size.</p>
</sec></sec><sec id="s4b">
<title>Model and estimation</title>
<p>The sRBM consists of a set of binary visible units <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e039" xlink:type="simple"/></inline-formula> corresponding to observed neurons in the data and a set of hidden units <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e040" xlink:type="simple"/></inline-formula> that capture higher-order dependencies. Weights between visible units, corresponding to an Ising model or fully visible Boltzmann machine, capture pairwise couplings in the data. Weights between visible and hidden units, corresponding to an RBM, learn to describe higher-order structure.</p>
<p>The Ising model with visible-visible coupling weights <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e041" xlink:type="simple"/></inline-formula> and biases <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e042" xlink:type="simple"/></inline-formula> has an energy function<disp-formula id="pcbi.1003684.e043"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e043" xlink:type="simple"/><label>(1)</label></disp-formula>with associated probability distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e044" xlink:type="simple"/></inline-formula>, where the normalization constant, or partition function, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e045" xlink:type="simple"/></inline-formula> consists of a sum over all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e046" xlink:type="simple"/></inline-formula> system states.</p>
<p>The RBM with visible-hidden coupling weights <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e047" xlink:type="simple"/></inline-formula> and hidden and visible biases <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e048" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e049" xlink:type="simple"/></inline-formula> has an energy function<disp-formula id="pcbi.1003684.e050"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e050" xlink:type="simple"/><label>(2)</label></disp-formula>with associated probability distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e051" xlink:type="simple"/></inline-formula>. Since the there are no connections between hidden units (hence “restricted” Boltzmann machine), the latent variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e052" xlink:type="simple"/></inline-formula> can be analytically marginalized out of the distribution (see supplementary information) to obtain<disp-formula id="pcbi.1003684.e053"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e053" xlink:type="simple"/><label>(3)</label></disp-formula></p>
<p>This step gives a standard energy-based model which we can estimate in our framework, while in a fully connected Boltzmann machine we could not marginalize over hidden units, making the estimation intractable. The energy for the marginalized distribution over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e054" xlink:type="simple"/></inline-formula> (sometimes referred to as the free energy in machine learning literature) is<disp-formula id="pcbi.1003684.e055"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e055" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e056" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e057" xlink:type="simple"/></inline-formula> row of the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e058" xlink:type="simple"/></inline-formula>. The energy function for an sRBM combines the Ising model and RBM energy terms,<disp-formula id="pcbi.1003684.e059"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e059" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>As with the RBM, it is straightforward to marginalize over the hidden units for an sRBM,<disp-formula id="pcbi.1003684.e060"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e060" xlink:type="simple"/><label>(6)</label></disp-formula><disp-formula id="pcbi.1003684.e061"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e061" xlink:type="simple"/><label>(7)</label></disp-formula></p>
<p>A hierarchical Markov Random Field based on the sRBM has previously been applied as a model for natural image patches <xref ref-type="bibr" rid="pcbi.1003684-Osindero1">[34]</xref>, with the parameters estimated using contrastive divergence (CD) <xref ref-type="bibr" rid="pcbi.1003684-Hinton1">[35]</xref>.</p>
<p>To include stimulus effects into the Boltzmann machine models, we start with a maximum entropy model constrained to fit the peri-stimulus time histogram (PSTH), i.e. the response to a given stimulus obtained by empirically computing the firing probabilities averaged over repeated presentations. This non-parametric model has the form<disp-formula id="pcbi.1003684.e062"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e062" xlink:type="simple"/><label>(8)</label></disp-formula>where the subscript <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e063" xlink:type="simple"/></inline-formula> refers to histogram, and both the dynamic bias term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e064" xlink:type="simple"/></inline-formula> and the data vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e065" xlink:type="simple"/></inline-formula> have explicit time dependence. The dynamic bias terms in this model can be computed in closed form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e066" xlink:type="simple"/></inline-formula> where the PSTH <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e067" xlink:type="simple"/></inline-formula> sums over stimulus repetitions and counts the number of spikes fired by the neuron. Starting with this model and keeping the dynamic bias term fixed at the closed form solution, we add pairwise and higher-order coupling terms to obtain<disp-formula id="pcbi.1003684.e068"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e068" xlink:type="simple"/><label>(9)</label></disp-formula><disp-formula id="pcbi.1003684.e069"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e069" xlink:type="simple"/><label>(10)</label></disp-formula>which combine the Ising and RBM population models, respectively, with the stimulus model given by the PSTH term. Estimation of these models is no more difficult than the standard Ising and RBM models, since the PSTH term is computed in closed form and effectively only adds a constant to the energy function. This method corresponds to model T2 (explicit time dependence, second order stimulus dependence) of <xref ref-type="bibr" rid="pcbi.1003684-GranotAtedgi1">[36]</xref>, where it is not further explored due to the requirement for repeated stimulus segments. We used 60 repetitions of a 30 s long natural movie to estimate the PSTH.</p>
<p>Instead of CD, which is based on sampling, we train the models using Minimum Probability Flow (MPF, <xref ref-type="bibr" rid="pcbi.1003684-SohlDickstein1">[13]</xref>), a recently developed parameter estimation method for energy based models. MPF works by minimizing the KL divergence between the data distribution and the distribution which results from moving slightly away from the data distribution towards the model distribution. This KL divergence will be uniquely zero in the case where the model distribution is identical to the data distribution. While CD is a stochastic heuristic for parameter update, MPF provides a deterministic and easy to evaluate objective function. Second order gradient methods can therefore be used to speed up optimization considerably. The MPF objective function<disp-formula id="pcbi.1003684.e070"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e070" xlink:type="simple"/><label>(11)</label></disp-formula>measures the flow of probability out of data states <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e071" xlink:type="simple"/></inline-formula> into neighboring non-data states <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e072" xlink:type="simple"/></inline-formula>, where the connectivity function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e073" xlink:type="simple"/></inline-formula> identifies neighboring states, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e074" xlink:type="simple"/></inline-formula> is the list of data states. We consider the case where the connectivity function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e075" xlink:type="simple"/></inline-formula> is set to connect all states which differ by a single bit flip<disp-formula id="pcbi.1003684.e076"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003684.e076" xlink:type="simple"/><label>(12)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e077" xlink:type="simple"/></inline-formula> is the Hamming distance between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e078" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e079" xlink:type="simple"/></inline-formula>. See supplementary information for a derivation of the MPF objective function and gradients for the sRBM, RBM, and Ising models. In all experiments, minimization of K was performed with the MinFunc implementation of L-BFGS <xref ref-type="bibr" rid="pcbi.1003684-Schmidt1">[37]</xref>.</p>
<p>To prevent overfitting all models were estimated with an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e080" xlink:type="simple"/></inline-formula> sparseness penalty on the coupling parameters. This was done by adding a term of the form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e081" xlink:type="simple"/></inline-formula> to the objective function, summing over the absolute values of the elements of both the visible and hidden weight matrices. The optimal sparseness <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e082" xlink:type="simple"/></inline-formula> was chosen by cross-validating the log-likelihood on a holdout set, with the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e083" xlink:type="simple"/></inline-formula> selected from the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e084" xlink:type="simple"/></inline-formula> spanning the range of optimal regularization for all models.</p>
<p>Since MPF learning does not give an estimate of the partition function, for models that were too large to normalize by summing over all states, we use annealed importance sampling (AIS, <xref ref-type="bibr" rid="pcbi.1003684-Neal1">[16]</xref>) to compute normalized probabilities. AIS is a sequential Monte Carlo method that works by gradually morphing a distribution with a known normalization constant (in our case a uniform distribution over <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e085" xlink:type="simple"/></inline-formula>) into the distribution of interest. See supplementary information for more detail. AIS applied to RBM models is described in <xref ref-type="bibr" rid="pcbi.1003684-Salakhutdinov1">[38]</xref>, which also highlights the shortcomings of previously used deterministic approximations. Since AIS requires running a sampling chain, in our case a Gibbs sampler, it generally takes much longer than the parameter estimation.</p>
<p>Normalizing the distribution via AIS allows us to compute the log likelihood of the model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e086" xlink:type="simple"/></inline-formula> and compare it to the likelihood gained over a baseline model. This baseline assumes cells to be independent and characterized by their firing rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e087" xlink:type="simple"/></inline-formula> with rates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e088" xlink:type="simple"/></inline-formula> for individual cells <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e089" xlink:type="simple"/></inline-formula>. The independent model is easily estimated and normalized, and is commonly used as a reference for model comparison. The excess log likelihood over this baseline is defined in terms of a sample expectation as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e090" xlink:type="simple"/></inline-formula>.</p>
<p>The excess log likelihood rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e091" xlink:type="simple"/></inline-formula>, computed in bits/spike by normalizing with the population firing rate per time bin, is used as the basis for model comparisons. Normalizing by the firing rate and comparing bits/spike rather than bits per unit time has the advantage that this measure is less sensitive to the overall activity when comparing across data sets. For models with stimulus terms, a separate normalization constant is required for each state of the dynamic bias. As our 30 s stimulus segment data set consists of 1500 time bins, this amounts to computing 1500 separate partition functions. This limits us to small models with up to 20 neurons where the partition function can be computed quickly by enumerating the full state space, avoiding the use of the costly AIS sampling procedure. To compare likelihoods, we use the PSTH model (i.e. the model with only stimulus and no coupling terms) as the baseline since all three likelihoods are much higher than for models without stimulus terms.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003684.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003684.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Monitoring the convergence of the AIS estimate for the partition function.</bold> Example shows a 20-dimensional Ising model. Each entry on the horizontal axis corresponds to an annealing chain with a different number of steps. Points correspond to the 500 individual samples, the blue line is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e092" xlink:type="simple"/></inline-formula> of the average from the samples. The solid green line is the true value of the partition function computed numerically by summing over the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003684.e093" xlink:type="simple"/></inline-formula> states. The dashed lines correspond to our convergence criterion of 0.02 deviation from the true partition function.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003684.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003684.s002" position="float" xlink:type="simple"><label>Figure S2</label><caption>
<p><bold>Overview of the data preprocessing and spike sorting procedure (B4 dataset).</bold> Spike waveforms were extracted based on a threshold on each channel and assigned to a unit based on a k-means clustering procedure applied to groups of 4 consecutive channels. (<bold>a</bold>) Mean waveforms of units on 32 channels separated into 8 non-overlapping groups. On each group, the identified units are shown in different colors, and corresponding cell numbers are given. Spikes that could not be assigned to a single unit are captured by MUA clusters. Units 6 and 12 are visibly the same cell picked up on neighboring groups (confirmed by cross-correlation, not shown) and excluded from the data set. (<bold>b</bold>) For single units in group 2, we show the projection of the spikes from 6 different units onto a set of 3 of the total 52 features used for clustering. Similar to spike sorting tetrode data, relative amplitude differences on nearby recording channels provide discrimination between nearby cells. (<bold>c</bold>) Histograms of the inter-spike intervals (ISI) for all 22 single units identified above. The presence of ISIs below the refractory period of a neuron (threshold at 1 ms, shown as a dotted line) provides evidence of multiple neurons being classified in the same cluster. Neurons 17 and 18 have a small amount of contamination with multiunit activity.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003684.s003" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003684.s003" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Marginalizing over hidden units.</bold> Derivation of the marginal distribution of the RBM so it can be estimated as a standard energy-based model without latent variables.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003684.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003684.s004" position="float" xlink:type="simple"><label>Text S2</label><caption>
<p><bold>Objective functions and gradients.</bold> Derivations of the MPF objective function and gradient for the Ising model, RBM and sRBM.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003684.s005" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003684.s005" position="float" xlink:type="simple"><label>Text S3</label><caption>
<p><bold>Annealed importance sampling.</bold> Implementation details of the sampling scheme to compute normalized probabilities from the models.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003684-Ising1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ising</surname><given-names>E</given-names></name> (<year>1925</year>) <article-title>Beitrag zur Theorie des Ferromagnetismus</article-title>. <source>Zeitschrift für Physik A</source> <volume>31</volume>: <fpage>253</fpage>–<lpage>258</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Schneidman1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Berry</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Segev</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name> (<year>2006</year>) <article-title>Weak pairwise correlations imply strongly correlated network states in a neural population</article-title>. <source>Nature</source> <volume>440</volume>: <fpage>1007</fpage>–<lpage>12</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Yu1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Singer</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Nikolic</surname><given-names>D</given-names></name> (<year>2008</year>) <article-title>A Small World of Neuronal Synchrony</article-title>. <source>Cerebral Cortex</source> <volume>18</volume>: <fpage>2891</fpage>–<lpage>2901</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Hamilton1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hamilton</surname><given-names>LS</given-names></name>, <name name-style="western"><surname>Sohl-Dickstein</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Huth</surname><given-names>AG</given-names></name>, <name name-style="western"><surname>Carels</surname><given-names>VM</given-names></name>, <name name-style="western"><surname>Deisseroth</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Optogenetic activation of an inhibitory network enhances feedforward functional connectivity in auditory cortex</article-title>. <source>Neuron</source> <volume>80</volume>: <fpage>1066</fpage>–<lpage>76</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Ganmor1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ganmor</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Segev</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name> (<year>2011</year>) <article-title>Sparse low-order interaction network underlies a highly correlated and learnable neural population code</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>108</volume>: <fpage>9679</fpage>–<lpage>84</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Ecker1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ecker</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Berens</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Keliris</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Bethge</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Logothetis</surname><given-names>NK</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Decorrelated neuronal firing in cortical microcircuits</article-title>. <source>Science (New York, NY)</source> <volume>327</volume>: <fpage>584</fpage>–<lpage>7</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Renart1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Renart</surname><given-names>A</given-names></name>, <name name-style="western"><surname>De la Rocha</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bartho</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Hollender</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Parga</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The asynchronous state in cortical circuits</article-title>. <source>Science</source> <volume>327</volume>: <fpage>587</fpage>–<lpage>590</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Ohiorhenuan1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ohiorhenuan</surname><given-names>IE</given-names></name>, <name name-style="western"><surname>Mechler</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Purpura</surname><given-names>KP</given-names></name>, <name name-style="western"><surname>Schmid</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Hu</surname><given-names>Q</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Sparse coding and high-order correlations in fine-scale cortical networks</article-title>. <source>Nature</source> <volume>466</volume>: <fpage>617</fpage>–<lpage>21</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Ohiorhenuan2"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ohiorhenuan</surname><given-names>IE</given-names></name>, <name name-style="western"><surname>Victor</surname><given-names>JD</given-names></name> (<year>2011</year>) <article-title>Information-geometric measure of 3-neuron firing patterns characterizes scale-dependence in cortical networks</article-title>. <source>Journal of Computational Neuroscience</source> <volume>30</volume>: <fpage>125</fpage>–<lpage>41</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Yu2"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Nakahara</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Santos</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Nicolic</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Higher-order interactions characterized in cortical activity</article-title>. <source>Journal of Neuroscience</source> <volume>31</volume>: <fpage>17514</fpage>–<lpage>17526</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Stratford1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stratford</surname><given-names>KJ</given-names></name>, <name name-style="western"><surname>Tarczy-Hornoch</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Martin</surname><given-names>KA</given-names></name>, <name name-style="western"><surname>Bannister</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Jack</surname><given-names>JJ</given-names></name> (<year>1996</year>) <article-title>Excitatory synaptic inputs to spiny stellate cells in cat visual cortex</article-title>. <source>Nature</source> <volume>382</volume>: <fpage>258</fpage>–<lpage>261</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Ghose1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ghose</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Freeman</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Ohzawa</surname><given-names>I</given-names></name> (<year>1994</year>) <article-title>Local intracortical connections in the cat's visual cortex: postnatal development and plasticity</article-title>. <source>Journal of Neurophysiology</source> <volume>72</volume>: <fpage>1290</fpage>–<lpage>303</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-SohlDickstein1"><label>13</label>
<mixed-citation publication-type="book" xlink:type="simple">Sohl-Dickstein J, Battaglino P, DeWeese M (2011) Minimum Probability Flow Learning. In: Proceedings of the 28th International Conference on Machine Learning (ICML-11). 905–912 p.</mixed-citation>
</ref>
<ref id="pcbi.1003684-SohlDickstein2"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sohl-Dickstein</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Battaglino</surname><given-names>P</given-names></name>, <name name-style="western"><surname>DeWeese</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>New Method for Parameter Estimation in Probabilistic Models: Minimum Probability Flow</article-title>. <source>Physical Review Letters</source> <volume>107</volume>: <fpage>11</fpage>–<lpage>14</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Schaub1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schaub</surname><given-names>MT</given-names></name>, <name name-style="western"><surname>Schultz</surname><given-names>SR</given-names></name> (<year>2012</year>) <article-title>The Ising decoder: reading out the activity of large neural ensembles</article-title>. <source>Journal of Computational Neuroscience</source> <volume>32</volume>: <fpage>101</fpage>–<lpage>118</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Neal1"><label>16</label>
<mixed-citation publication-type="book" xlink:type="simple">Neal R (2001) Annealed Importance Sampling. In: Statistics and Computing 11, Toronto. pp. 125–139. URL <ext-link ext-link-type="uri" xlink:href="http://www.springerlink.com/index/X40W6W4R1142651K.pdf" xlink:type="simple">http://www.springerlink.com/index/X40W6W4R1142651K.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Kster1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Köster</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Olshausen</surname><given-names>B</given-names></name> (<year>2013</year>) <article-title>Testing our conceptual understanding of V1 function</article-title>. <source>arXiv preprint</source> <volume>arXiv</volume>: <fpage>13110778</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Tkaik1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tkačik</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Marre</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Mora</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Amodei</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Berry II</surname><given-names>MJ</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>The simplest maximum entropy model for collective behavior in a neural network</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source> <volume>2013</volume>: <fpage>P03011</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Truccolo1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Truccolo</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Hochberg</surname><given-names>LR</given-names></name>, <name name-style="western"><surname>Donoghue</surname><given-names>JP</given-names></name> (<year>2009</year>) <article-title>Collective dynamics in human and monkey sensorimotor cortex : predicting single neuron spikes</article-title>. <source>Nature Neuroscience</source> <volume>13</volume>: <fpage>105</fpage>–<lpage>111</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Macke1"><label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">Macke JH, Buesing L, Cunningham JP, Yu BM, Shenoy KV, <etal>et al</etal>.. (2011) Empirical models of spiking in neural populations. In: Advances in Neural Information Processing Systems. pp. 1350–1358.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Pillow1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pillow</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Shlens</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Sher</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname><given-names>AM</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title>. <source>Nature</source> <volume>454</volume>: <fpage>995</fpage>–<lpage>9</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Butts1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Butts</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Weng</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Jin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Alonso</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Paninski</surname><given-names>L</given-names></name> (<year>2011</year>) <article-title>Temporal Precision in the Visual Pathway through the Interplay of Excitation and Stimulus-Driven Suppression</article-title>. <source>Journal of Neuroscience</source> <volume>31</volume>: <fpage>11313</fpage>–<lpage>11327</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Macke2"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Macke</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Berens</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Ecker</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Tolias</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Bethge</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Generating spike trains with specified correlation coefficients</article-title>. <source>Neural Computation</source> <volume>21</volume>: <fpage>397</fpage>–<lpage>423</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Macke3"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Macke</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Opper</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bethge</surname><given-names>M</given-names></name> (<year>2011</year>) <article-title>Common Input Explains Higher-Order Correlations and Entropy in a Simple Model of Neural Population Activity</article-title>. <source>Physical Review Letters</source> <volume>106</volume>: <fpage>208102</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Tkacik1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tkacik</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Berry</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name> (<year>2006</year>) <article-title>Ising models for networks of real neurons</article-title>. <source>arXiv preprint</source> <volume>arXiv</volume> <volume>0611072</volume> <fpage>4</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Tkaik2"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tkačik</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Marre</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Amodei</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Bialek</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Searching for collective behavior in a large network of sensory neurons</article-title>. <source>PLoS computational biology</source> <volume>10</volume>: <fpage>e1003408</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Broderick1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Broderick</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Dudik</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Tkacik</surname><given-names>G</given-names></name> (<year>2007</year>) <article-title>Faster solutions of the inverse pairwise Ising problem</article-title>. <source>arXiv preprint</source> <volume>arXiv</volume>: <fpage>07122437v2</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Vidne1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vidne</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ahmadian</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Shlens</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Pillow</surname><given-names>JW</given-names></name>, <name name-style="western"><surname>Kulkarni</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Modeling the impact of common noise inputs on the network activity of retinal ganglion cells</article-title>. <source>Journal of computational neuroscience</source> <volume>33</volume>: <fpage>97</fpage>–<lpage>121</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Gerwinn1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerwinn</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Macke</surname><given-names>JH</given-names></name>, <name name-style="western"><surname>Bethge</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Bayesian inference for generalized linear models for spiking neurons</article-title>. <source>Frontiers in Computational Neuroscience</source> <volume>4</volume>: <fpage>12</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Gray1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gray</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Maldonado</surname><given-names>PE</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>M</given-names></name>, <name name-style="western"><surname>McNaughton</surname><given-names>B</given-names></name> (<year>1995</year>) <article-title>Tetrodes markedly improve the reliability and yield of multiple single-unit isolation from multi-unit recordings in cat striate cortex</article-title>. <source>Journal of Neuroscience Methods</source> <volume>63</volume>: <fpage>43</fpage>–<lpage>54</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Harris1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Harris</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Henze</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Csicsvari</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hirase</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Buzsaki</surname><given-names>G</given-names></name> (<year>2000</year>) <article-title>Accuracy of Tetrode Spike Separation as Determined by Simultaneous Intracellular and Extracellular Measurements</article-title>. <source>Journal of Neurophysiology</source> <volume>84</volume>: <fpage>401</fpage>–<lpage>414</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Redish1"><label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Redish D (2012) MClust. Technical report, University of Minnesota, Minneapolis. URL <ext-link ext-link-type="uri" xlink:href="http://redishlab.neuroscience.umn.edu/MClust/MClust.html" xlink:type="simple">http://redishlab.neuroscience.umn.edu/MClust/MClust.html</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Mitzdorf1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mitzdorf</surname><given-names>U</given-names></name> (<year>1985</year>) <article-title>Current source-density method and application in cat cerebral cortex: investigation of evoked potentials and EEG phenomena</article-title>. <source>Physiological reviews</source> <volume>65</volume>: <fpage>37</fpage>–<lpage>100</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Osindero1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Osindero</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>G</given-names></name> (<year>2008</year>) <article-title>Modeling image patches with a directed hierarchy of Markov random fields</article-title>. <source>Advances in Neural Information Processing</source></mixed-citation>
</ref>
<ref id="pcbi.1003684-Hinton1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hinton</surname><given-names>GE</given-names></name> (<year>2002</year>) <article-title>Training products of experts by minimizing contrastive divergence</article-title>. <source>Neural Computation</source> <volume>14</volume>: <fpage>1771</fpage>–<lpage>800</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-GranotAtedgi1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Granot-Atedgi</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Tkačik</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Segev</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Schneidman</surname><given-names>E</given-names></name> (<year>2013</year>) <article-title>Stimulus-dependent maximum entropy models of neural population codes</article-title>. <source>PLoS computational biology</source> <volume>9</volume>: <fpage>e1002922</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Schmidt1"><label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Schmidt M (2005) MinFunc. Technical report, Laboratoire d'Informatique de l'École Normale Supérieure, Paris. URL <ext-link ext-link-type="uri" xlink:href="http://www.di.ens.fr/~mschmidt/Software/minFunc.html" xlink:type="simple">http://www.di.ens.fr/~mschmidt/Software/minFunc.html</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003684-Salakhutdinov1"><label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">Salakhutdinov R, Murray I (2008) On the quantitative analysis of deep belief networks. In: International Conference on Machine Learning. URL <ext-link ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id=1390266" xlink:type="simple">http://dl.acm.org/citation.cfm?id=1390266</ext-link>.</mixed-citation>
</ref>
</ref-list></back>
</article>