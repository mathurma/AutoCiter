<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-00021</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003227</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories>
<title-group>
<article-title>GINI: From ISH Images to Gene Interaction Networks</article-title>
<alt-title alt-title-type="running-head">GINI: From ISH Images to Gene Interaction Networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Puniyani</surname><given-names>Kriti</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Xing</surname><given-names>Eric P.</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><addr-line>School of Computer Science, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Chechik</surname><given-names>Gal</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Bar Ilan University, Israel</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">epxing@cs.cmu.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: KP EPX. Performed the experiments: KP. Analyzed the data: KP. Contributed reagents/materials/analysis tools: KP. Wrote the paper: KP EPX.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>10</month><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>10</day><month>10</month><year>2013</year></pub-date>
<volume>9</volume>
<issue>10</issue>
<elocation-id>e1003227</elocation-id>
<history>
<date date-type="received"><day>30</day><month>12</month><year>2012</year></date>
<date date-type="accepted"><day>30</day><month>7</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Puniyani, Xing</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Accurate inference of molecular and functional interactions among genes, especially in multicellular organisms such as Drosophila, often requires statistical analysis of correlations not only between the magnitudes of gene expressions, but also between their temporal-spatial patterns. The ISH (<italic>in-situ-hybridization</italic>)-based gene expression micro-imaging technology offers an effective approach to perform large-scale spatial-temporal profiling of whole-body mRNA abundance. However, analytical tools for discovering gene interactions from such data remain an open challenge due to various reasons, including difficulties in extracting canonical representations of gene activities from images, and in inference of statistically meaningful networks from such representations. In this paper, we present GINI, a machine learning system for inferring gene interaction networks from Drosophila embryonic ISH images. GINI builds on a computer-vision-inspired vector-space representation of the spatial pattern of gene expression in ISH images, enabled by our recently developed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e001" xlink:type="simple"/></inline-formula> system; and a new multi-instance-kernel algorithm that learns a sparse Markov network model, in which, every gene (i.e., node) in the network is represented by a vector-valued spatial pattern rather than a scalar-valued gene intensity as in conventional approaches such as a Gaussian graphical model. By capturing the notion of spatial similarity of gene expression, and at the same time properly taking into account the presence of multiple images per gene via multi-instance kernels, GINI is well-positioned to infer statistically sound, and biologically meaningful gene interaction networks from image data. Using both synthetic data and a small manually curated data set, we demonstrate the effectiveness of our approach in network building. Furthermore, we report results on a large publicly available collection of Drosophila embryonic ISH images from the Berkeley Drosophila Genome Project, where GINI makes novel and interesting predictions of gene interactions. Software for GINI is available at <ext-link ext-link-type="uri" xlink:href="http://sailing.cs.cmu.edu/Drosophila_ISH_images/" xlink:type="simple">http://sailing.cs.cmu.edu/Drosophila_ISH_images/</ext-link></p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>As high-throughput technologies for molecular abundance profiling are becoming more inexpensive and accessible, computational inference of gene interaction networks from such data based on well-founded statistical principles is imperative to advance the understanding of regulatory mechanisms in various biological systems. Reverse engineering of gene networks has traditionally relied on analysis of whole-genome microarray data; here we present a new method, GINI, to infer gene networks from ISH images, thereby enabling exploration of spatial characteristics of gene expressions for network inference. Our method generates a Markov network, which encapsulates globally meaningful statistical-dependencies from vector-valued gene spatial patterns. In other words, we advance the state-of-art in both the usage of richer forms of expression data, and the employment of principled statistical methodology for sound network inference on such new form of data. Our results show that analyzing the spatial distribution of gene expression enables us to capture information not available from microarray data. Such an analysis is especially important in analyzing genes involved in embryonic development of Drosophila to reveal specific spatial patterning that determines the development of the 14 segments of the adult fly.</p>
</abstract>
<funding-group><funding-statement>This work was supported by NSF DBI-0546594, the NSF Career Award to EPX, and NIH 1R01GM093156. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="15"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>In multicellular organisms such as the metazoans, many important biological processes such as development and differentiation depend fundamentally on the spatial and temporal control of gene expression <xref ref-type="bibr" rid="pcbi.1003227-Davidson1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003227-Gilbert1">[2]</xref>. To date, the molecular basis and regulatory circuitry underlying metazoan gene regulation remains largely unknown. Numerous statistical or algorithmic approaches have been attempted to infer “networks” of regulatory elements from high-throughput experimental data, based on various computational techniques like Bayesian networks <xref ref-type="bibr" rid="pcbi.1003227-Friedman1">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1003227-Segal1">[5]</xref>, undirected Gaussian graphical models <xref ref-type="bibr" rid="pcbi.1003227-Ma1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003227-Dobra1">[7]</xref>, graph mining <xref ref-type="bibr" rid="pcbi.1003227-Tanay1">[8]</xref>, ordinary differential equations <xref ref-type="bibr" rid="pcbi.1003227-Gardner1">[9]</xref>, partial correlations <xref ref-type="bibr" rid="pcbi.1003227-Basso1">[10]</xref>, and others. Comparisons of different methods used for reverse engineering gene networks have been performed <xref ref-type="bibr" rid="pcbi.1003227-Bansal1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1003227-Hache1">[12]</xref>, and predictions made by automatically learned gene networks have been experimentally validated <xref ref-type="bibr" rid="pcbi.1003227-Carro1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003227-Wang1">[14]</xref>, thus increasing the credibility of such approaches.</p>
<p>This progress notwithstanding, a key deficiency of existing approaches is that they rely almost exclusively on univariate characteristics of gene states, such as a continuous-valued abundance measurement from microarray, or a binary on/off status derived from discretization of microarray data. However, microarray profiling of mRNA abundance can often be ill-suited for spatial-temporal analysis of gene expressions in multicellular organisms such as Drosophila, or in tissues/organs with natural or pathological progressions, because it captures only the “average” pattern of a sample. For any sample of interesting heterogeneous cell populations, the averaging operation would cause severe information loss and inaccuracy in downstream analysis (see <xref ref-type="fig" rid="pcbi-1003227-g001">Figure 1</xref> in <xref ref-type="bibr" rid="pcbi.1003227-Puniyani1">[15]</xref> for an intuitive illustration of how two genes with completely different spatial patterns over time yield near identical “average” temporal patterns.)</p>
<fig id="pcbi-1003227-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g001</object-id><label>Figure 1</label><caption>
<title>ISH analysis is more challenging than microarray analysis.</title>
<p>(a) Univariate measurements taken simultaneously for all genes simplifies gene network inference from microarray data. (b) GINI extends such analysis to inferring a network from bags of images per gene.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g001" position="float" xlink:type="simple"/></fig>
<p>Recent advancements in image-based genome-scale profiling technology such as whole-body mRNA abundance micro-imaging via <italic>in situ hybridization</italic> (ISH) have begun to reveal a more holistic view of the activities and functions of genes in rich spatial-temporal contexts. ISH has been used to characterize whole genome expression patterns for different species such as Drosophila embryos <xref ref-type="bibr" rid="pcbi.1003227-Tomancak1">[16]</xref>, <xref ref-type="bibr" rid="pcbi.1003227-Tomancak2">[17]</xref>, C. elegans <xref ref-type="bibr" rid="pcbi.1003227-Yuji1">[18]</xref>, and adult mouse brain <xref ref-type="bibr" rid="pcbi.1003227-Lein1">[19]</xref>, and at smaller scales for Arabidopsis flowers <xref ref-type="bibr" rid="pcbi.1003227-Wellner1">[20]</xref>, testicular germ cell tumors <xref ref-type="bibr" rid="pcbi.1003227-Almstrup1">[21]</xref>, and others. The availability of this form of gene expression data calls for development of next-generation image analysis systems to facilitate not only efficient pattern mining such as image clustering or retrieval, but also in-depth reasoning of complex spatial-temporal relationships between gene expression patterns, which will be essential for functional genomics and regulatory network inference in higher organisms. In this paper, we focus on a particularly interesting, but previously unaddressed challenge along this direction: inferring a statistically sound gene network from gene expression micro-imaging data, in the same sense of inferring a gene network from microarray data as widely studied in the literature. Analyzing ISH data allows us to infer a network by computing similarities in the spatial distributions of gene expressions in Drosophila embryo. Another important source of information is the temporal changes of the spatial distributions of genes, which could reveal how a gene regulation network evolves over time during dynamic biological processes such as embryogenesis <xref ref-type="bibr" rid="pcbi.1003227-Ahmed1">[22]</xref>. We will defer the spatio-temporal network building based on time series of ISH data for future work as it requires the technique developed in this paper as a building block.</p>
<p>A major motivation of our work is the extensive imagery documentation of all the genes expressed during Drosophila embryogenesis via ISH imaging by the Berkeley Drosophila Genome Project (BDGP) <xref ref-type="bibr" rid="pcbi.1003227-Tomancak1">[16]</xref>. BDGP is an ongoing effort to determine gene expression patterns during embryogenesis for Drosophila genes. In February 2013, the data contained more than 110,000 ISH images capturing the expression pattern of 7516 genes. Each image is annotated with time information, indicating the development of the embryo in six development stage ranges. Each image documents the gene expression pattern of a single gene in an embryo. Most images have a single embryo, however some images capture partial views of the embryo, others have overlapping or touching embryos. This is an extremely interesting but difficult dataset that reveals unprecedented details of gene activities during metazoan embryogenesis, but at the same time posts large unanswered challenges on methodologies for systematic and principled analysis. Specifically, we recognized the following main challenges that are unique to micro-imaging data versus the classical microarray data, which must be properly addressed before a genome-scale gene network can be derived from such data.</p>
<list list-type="simple"><list-item>
<p><bold>Representation and quantification of gene activities:</bold> Unlike microarrays, which represent gene activity with a univariate state or magnitude, images provide high-dimensional information for every gene, and it remains an open problem in computer vision research to extract meaningful features from the ISH images that are suitable for comparing activities of different genes and other genome-wide analysis <xref ref-type="bibr" rid="pcbi.1003227-Puniyani1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003227-Frise1">[23]</xref>.</p>
</list-item><list-item>
<p><bold>Multi-variate measurement:</bold> Even after one can standardize the imagery-records of the expression of a gene at a particular time point by a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e002" xlink:type="simple"/></inline-formula>-dimensional vector, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e003" xlink:type="simple"/></inline-formula> are the number of features extracted from the image, a proper metric must be defined to quantify distances between them.</p>
</list-item><list-item>
<p><bold>Condition alignment:</bold> Images for different genes are typically taken under non-identical conditions (e.g., time, temperature, etc.), whereas a microarray is a snapshot of multiple genes under the same condition. This affects how signals are normalized across genes before they can be compared.</p>
</list-item><list-item>
<p><bold>Sample imbalance:</bold> Different genes typically have different number of image records, i.e., for gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e004" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e005" xlink:type="simple"/></inline-formula>, their corresponding measurements can be in the form of two bags of different sizes. It is not clear how to define distance or correlation between bags of images of different sizes. One simple solution to this problem is to randomly sample a single image from each gene. However, throwing away images fails to capture the natural variation observed in gene expression patterns for some genes. Further, if noise in the expression patterns has not been removed correctly in the feature extraction step, leveraging the existence of multiple images per gene can lead to reduced noise, and improved performance.</p>
</list-item><list-item>
<p><bold>Sparsity and statistical interpretability:</bold> The interaction network proposed must be sparse and statistically meaningful, since we expect that a small fraction of all possible interactions are actually present in a single organism, and such interactions must reveal globally consistent conditional-independence relationships between genes, which is not possible in a simple pairwise-correlation graph.</p>
</list-item></list>
<p>There has been some earlier work on automatic annotation of ISH images with annotation terms <xref ref-type="bibr" rid="pcbi.1003227-Yuan1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003227-Mace1">[25]</xref>, clustering of gene expressions <xref ref-type="bibr" rid="pcbi.1003227-Tomancak2">[17]</xref>, determination of the development stage of embryos <xref ref-type="bibr" rid="pcbi.1003227-Gargesha1">[26]</xref>, etc., some of which have been applied on the BDGP dataset. In this paper, we propose a machine learning system to infer gene interaction networks from spatial similarity of gene expressions captured via ISH images. The system is called GINI, for Gene Interaction Network from Images. With such a system, we were able to address satisfactorily the challenges mentioned above, and systematically performed a genome-scale network learning and analysis on the BDGP dataset.</p>
<sec id="s1a">
<title>Overview of the GINI approach</title>
<p>GINI first extracts the gene expression pattern from each image using a computer version driven image analysis pipeline <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e006" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003227-Puniyani1">[15]</xref>. These expression patterns are spatially aligned and normalized to enable spatial comparison of gene expression across multiple images. Next, the expression patterns are represented by suitable standardized features through a process called “triangulation”, followed by feature normalization and selection. Since each gene may have a different number of images in the data, each gene can now be represented by a “bag” or a set of feature vectors - one feature vector per image. Thus, our task is to estimate the gene network, given bags of images per gene (<xref ref-type="fig" rid="pcbi-1003227-g001">Figure 1</xref>). We cast the problem of estimating a gene interaction network as the task of estimating the graph structure <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e007" xlink:type="simple"/></inline-formula> of a Markov random field (MRF) over the genes. The underlying graph encodes conditional independence assumptions between the genes, that is, two genes are said to not interact in the network if their gene expressions are conditionally independent of each other, conditioned on the expression of all other genes in the network. We employ multi-instance kernel technique using different order statistics to compute similarity between bags of images. We then estimate a sparse network of gene interactions by modeling the data as a multi-variate multi-attribute Gaussian, and estimating the sparse inverse covariance matrix of the model. A schematic diagram of the system pipeline can be seen in <xref ref-type="fig" rid="pcbi-1003227-g002">Figure 2</xref>.</p>
<fig id="pcbi-1003227-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g002</object-id><label>Figure 2</label><caption>
<title>GINI schematic.</title>
<p>The schematic shows an outline of the overall system to reverse engineer gene networks from ISH data. Sample output of each step is shown on top of the box corresponding to that step.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s1b">
<title>Contributions</title>
<p>GINI is a bioimage informatics system based on a computer vision pipeline for ISH micro-image processing and a statistical learning algorithm for network inference. The main contributions of this work are summarized below.</p>
<p>First, the image analytic pipeline used by GINI offers a rigorous and universal approach to extract a standardized representation of spatial patterns of gene expressions. Comparing to the popular SIFT features <xref ref-type="bibr" rid="pcbi.1003227-Yuan1">[24]</xref>, which is based on detecting interest points with heavy assumptions on object shape, texture, and other physical properties originally meant for natural objects, our approach is more suitable for ISH staining in Drosophila embryos which do not resemble natural objects and require preservation of overall spatial shape and overall intensity information in a canonical way for intra-gene normalization and inter-gene comparison.</p>
<p>Second, GINI infers a network that enjoys the Markov network property: it gives globally consistent conditional-independency interpretation for every edge, and therefore is biologically more meaningful. It is known that marginal correlation (as often used in estimating an <italic>ad hoc</italic> network), which is computed for every gene-pair in isolation (i.e., ignoring all other genes in the system), confounds direct and indirect dependencies, and could result in a clique-like dense graph or subgraph among genes that are not directly dependent, but have a long-distance interaction. Studying conditional independencies in a network allows us to predict interactions between a pair of genes in the context of other genes, allowing a distinction to be made between direct and indirect relationships between the genes, and reducing false positives.</p>
<p>Third, our formulation based on Gaussian Markov random field and multi-instance kernel for the GINI network is convex, hence the globally optimal estimator of the network is computed, no approximations are involved. Furthermore, under suitable conditions, our graphical model learning algorithm is sparsistent, i.e. as the amount of available data increases, the algorithm is statistically guaranteed to predict the correct interactions between the genes. While Bach et.al. <xref ref-type="bibr" rid="pcbi.1003227-Bach1">[27]</xref> have previously proposed learning the structure of graphical models from data using Mercer kernels, their approach is based on a non-convex local greedy search to find edges in the graph. Our approach represents the first work that uses Mercer kernels and Gaussian Graphical Models to predict kernelized graphical models using a convex formulation.</p>
<p>Finally, with the GINI system, we were able to systematically perform a genome-scale network learning and analysis of the genes expressed during 2 time points of Drosophila embryogenesis recorded by ISH imaging from BDGP <xref ref-type="bibr" rid="pcbi.1003227-Tomancak1">[16]</xref>. In both time points, we find that the GINI networks are modular and scale free, which are properties predicted to hold true in gene interaction networks. Further, different regions of the networks are enriched for spatial annotations, thus GINI is able to cluster spatially similar genes. The hubs of the networks, i.e., the genes with the largest number of predicted interactions are functionally enriched for important cellular functions. We demonstrate that the networks predicted by analyzing microarray data does not have either spatial or functional enrichment, thus these results could not have been obtained by analyzing microarray data.</p>
<p>To the best of our knowledge, GINI represents one of the first efforts to reverse engineering gene networks from ISH image data. In both extensive simulation studies and empirical biological analysis, we demonstrate the effectiveness of GINI in predicting networks, and show that the statistical assumptions behind GINI are reasonable, and the biological analysis enabled by GINI merits close examination and further exploration.</p>
</sec></sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<p>We begin by introducing the key algorithmic innovations needed to compute the gene network from the ISH images, assuming that each gene has a bag of images, with the images processed to be represented by informative and canonical feature vectors. This is followed by a discussion on the image processing procedures needed to extract informative features from the images.</p>
<sec id="s2a">
<title>Network inference from “one image per gene” ISH data</title>
<p>We first show how GINI estimates a gene network, when each gene has only one image. The next subsection extends the GINI algorithm to deal with multiple images per gene.</p>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e008" xlink:type="simple"/></inline-formula> denote the set of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e009" xlink:type="simple"/></inline-formula> genes being studied, so that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e010" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e011" xlink:type="simple"/></inline-formula> gene, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e012" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e013" xlink:type="simple"/></inline-formula> is the number of features extracted per image. Each feature represents the gene expression in a spatial location of the embryo.</p>
<p>Note that algorithms that analyze microarray data typically treat samples drawn from different time points as independent samples <xref ref-type="bibr" rid="pcbi.1003227-Jaffrezic1">[28]</xref>, even though expressions of the same gene across time is expected to be auto correlated. We similarly assume that the different spatial features are independent of each other. The spatial independence assumption has also been implicitly made by <xref ref-type="bibr" rid="pcbi.1003227-Segal2">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1003227-Janssens1">[30]</xref> while modeling transcription networks in Drosophila embryos. In the <xref ref-type="sec" rid="s3">results</xref> section, we use simulated data to demonstrate that this assumption does not affect the accuracy of the algorithm significantly.</p>
<p>By modeling the gene interactions as invariant across the spatial locations in the embryo, we can assume that each feature is independently and identically drawn (i.i.d.) from the same distribution. Inferring gene interactions is then equivalent to modeling the dependence between the expression values of different genes at the same spatial location. Expression of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e014" xlink:type="simple"/></inline-formula> genes in each spatial location is assumed to be drawn from some (multi-variate) distribution, independent of all other spatial locations. Each spatial feature <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e015" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e016" xlink:type="simple"/></inline-formula>) may be modeled as a vector of length <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e017" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e018" xlink:type="simple"/></inline-formula> capturing the expression value of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e019" xlink:type="simple"/></inline-formula> gene in this location <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e020" xlink:type="simple"/></inline-formula>. This gives us <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e021" xlink:type="simple"/></inline-formula> independent samples with which the parameters of the underlying distribution may be learned. Formally, let each spatial location be drawn independently from a multi-variate Gaussian <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e022" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e023" xlink:type="simple"/></inline-formula> is the mean vector, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e024" xlink:type="simple"/></inline-formula> is the positive semi-definite covariance matrix between the genes.</p>
<p>In a multivariate Gaussian distribution, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e025" xlink:type="simple"/></inline-formula> entry of the inverse covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e026" xlink:type="simple"/></inline-formula> is zero if and only if the corresponding genes are conditionally independent given the rest of the graph. Thus, the non-zero entries of the inverse covariance matrix correspond to edges in the corresponding Gaussian Markov random field, giving rise to the gene interaction network. The Gaussian Markov random field is also known as a Gaussian graphical model (GGM) <xref ref-type="bibr" rid="pcbi.1003227-Dempster1">[31]</xref>. Since we expect a small number of interactions per gene, the estimated graph must be sparse, i.e. the number of non-zero entries of the inverse covariance matrix must be small.</p>
<p>Thus, the gene interaction network may be estimated by learning a Gaussian distribution from the observed images, such that the inverse covariance matrix is sparse. The mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e027" xlink:type="simple"/></inline-formula> of the Gaussian is estimated by the observed sample mean,<disp-formula id="pcbi.1003227.e028"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e028" xlink:type="simple"/><label>(1)</label></disp-formula></p>
<p>Then, the inverse covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e029" xlink:type="simple"/></inline-formula> can be estimated by minimizing the negative log-likelihood of the data, over all possible positive semi-definite matrices. To enforce sparsity, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e030" xlink:type="simple"/></inline-formula> norm of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e031" xlink:type="simple"/></inline-formula>, which counts the number of non-zero elements, is added to the negative log likelihood. Since optimizing the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e032" xlink:type="simple"/></inline-formula> norm is non-convex and NP hard, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e033" xlink:type="simple"/></inline-formula> norm is used as a convex relaxation to the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e034" xlink:type="simple"/></inline-formula> norm. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e035" xlink:type="simple"/></inline-formula> norm of a matrix is the sum of the absolute values of the elements of the matrix, and also enforces sparsity in the solution. Adding the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e036" xlink:type="simple"/></inline-formula> norm regularization also ensures that the minimizer of the objective function exists, and is well defined. Thus, our objective function is<disp-formula id="pcbi.1003227.e037"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e037" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e038" xlink:type="simple"/></inline-formula> is the second moment matrix about the mean<disp-formula id="pcbi.1003227.e039"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e039" xlink:type="simple"/><label>(3)</label></disp-formula><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e040" xlink:type="simple"/></inline-formula> is a tuning parameter, by which we determine the strength of the penalty. As we increase the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e041" xlink:type="simple"/></inline-formula>, we increase the penalty on the absolute values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e042" xlink:type="simple"/></inline-formula>, and hence, the graph induced by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e043" xlink:type="simple"/></inline-formula> becomes more sparse. The edges in the graphical model are then estimated as<disp-formula id="pcbi.1003227.e044"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e044" xlink:type="simple"/><label>(4)</label></disp-formula></p>
<sec id="s2a1">
<title>Optimization</title>
<p>The objective function defined in <xref ref-type="disp-formula" rid="pcbi.1003227.e037">Equation 2</xref> is convex, hence it can be solved by any convex optimization algorithm. Banerjee et. al. <xref ref-type="bibr" rid="pcbi.1003227-Banerjee1">[32]</xref> formulated an <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e045" xlink:type="simple"/></inline-formula> block coordinate descent method to solve it, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e046" xlink:type="simple"/></inline-formula> is the number of dimensions. Friedman et. al. <xref ref-type="bibr" rid="pcbi.1003227-Friedman2">[33]</xref> formulated each step of the block coordinate descent as a Lasso regression, and solved it in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e047" xlink:type="simple"/></inline-formula> - they named their technique glasso. The glasso algorithm uses a series of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e048" xlink:type="simple"/></inline-formula> penalized regressions, called Lasso regressions <xref ref-type="bibr" rid="pcbi.1003227-Tibshirani1">[34]</xref>; and we use the glasso algorithm for efficient optimization of our objective function.</p>
<p>Note that <xref ref-type="disp-formula" rid="pcbi.1003227.e037">Equation 2</xref> is a function of data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e049" xlink:type="simple"/></inline-formula> only through the sample covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e050" xlink:type="simple"/></inline-formula>, hence, we can replace the sample covariance matrix with a suitable similarity or kernel function. This is the key idea behind GINI's algorithm to deal with multiple images per gene, which we discuss in the next section.</p>
</sec></sec><sec id="s2b">
<title>Network inference from “multiple images per gene” ISH data</title>
<p>Multiple images of the same gene at the same time point should have the same gene expression pattern. However, in practice, the expression patterns in different images may differ considerably, for three main reasons.</p>
<p>Firstly, there is a wide interval of time considered as a single time point while collecting such data. For instance, the BDGP data divides embryonic development into 6 time stages. The last stage 13–16 corresponds to development of the embryo 9.3 to 15 hours after fertilization, which represents more than a third of the time taken for embryonic development. Hence, the true gene expression pattern may be dynamic within the time period of a single development stage, and the gene expressions captured for the same gene at the same time may not look similar to each other. Secondly, we might expect that for any organism for which ISH data is collected, there will necessarily be some ambiguity in how the development stage of the organism is labeled by human annotators. Finally, noise in the expression patterns due to excessive staining, lighting conditions and similar other reasons will also be observed. For all of the above reasons, any network-learning algorithm should leverage the existence of multiple images per gene per time point in improving its estimates of gene similarity.</p>
<p>The problem of multiple images per gene is reminiscent of multi-instance learning <xref ref-type="bibr" rid="pcbi.1003227-Maron1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003227-Andrews1">[36]</xref>. Multi-instance learning is a form of supervised learning, where instead of labeling each instance, a bag of instances is labeled. A popular solution to the multi-instance problem is to define a multi-instance kernel, that can compute the similarity between bags of instances. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e051" xlink:type="simple"/></inline-formula> be a collection of order statistics of the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e052" xlink:type="simple"/></inline-formula>, for example, mean, median, minimum, maximum etc. In <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e053" xlink:type="simple"/></inline-formula> dimensions, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e054" xlink:type="simple"/></inline-formula> is computed on each dimension independently, to form a vector of order statistics. If we use <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e055" xlink:type="simple"/></inline-formula> order statistics, then the length of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e056" xlink:type="simple"/></inline-formula> will be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e057" xlink:type="simple"/></inline-formula>. The similarity between gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e058" xlink:type="simple"/></inline-formula> with a set of images <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e059" xlink:type="simple"/></inline-formula> and gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e060" xlink:type="simple"/></inline-formula> with images <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e061" xlink:type="simple"/></inline-formula> can then be computed as<disp-formula id="pcbi.1003227.e062"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e062" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e063" xlink:type="simple"/></inline-formula> is an appropriate kernel function between vectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e064" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e065" xlink:type="simple"/></inline-formula>. Such a kernel is called the statistic kernel.</p>
<p>The choice of the order statistics used in the kernel depends on the data collection procedure of the ISH. One concern in ISH data is that images may be overstained. In such a scenario, the median may be an appropriate choice of order statistic. If over-staining is not a concern, the maximum statistic may be more appropriate to ensure that information about presence of gene expression is not lost.</p>
<p>For the BDGP data, we use the covariance kernel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e066" xlink:type="simple"/></inline-formula>, and the mean statistic <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e067" xlink:type="simple"/></inline-formula>. The choice of using a single statistic to represent information from multiple images was due to the presence of noisy images in the data set. Thus,<disp-formula id="pcbi.1003227.e068"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e068" xlink:type="simple"/><label>(6)</label></disp-formula></p>
<p>Thus, our choice of kernel is equivalent to computing the mean similarity of all pairs of images in bags <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e069" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e070" xlink:type="simple"/></inline-formula>. This specific kernel is also known as the normalized set kernel, and has been shown to perform very well in multi-instance classification <xref ref-type="bibr" rid="pcbi.1003227-Gartner1">[37]</xref>.</p>
<p>Any kernel function may be written as the dot product in some higher dimensional feature space, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e071" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003227-Aronszajn1">[38]</xref>. Hence, if we assume that the data is drawn from a distribution such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e072" xlink:type="simple"/></inline-formula> is a zero-mean Gaussian, we can learn the gene interaction network by treating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e073" xlink:type="simple"/></inline-formula> as the sample covariance matrix. Since estimating the inverse covariance matrix by solving <xref ref-type="disp-formula" rid="pcbi.1003227.e037">equation 2</xref> requires only the sample covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e074" xlink:type="simple"/></inline-formula> and not the data itself, we can kernelize it by using the kernel matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e075" xlink:type="simple"/></inline-formula> defined in <xref ref-type="disp-formula" rid="pcbi.1003227.e068">equation 6</xref> as the required sample covariance matrix. Thus, the objective function is<disp-formula id="pcbi.1003227.e076"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e076" xlink:type="simple"/><label>(7)</label></disp-formula>which can be solved as discussed in the previous section.</p>
<sec id="s2b1">
<title>Consistency of the estimate</title>
<p>Given samples <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e077" xlink:type="simple"/></inline-formula> drawn from a Gaussian distribution, it can be shown that the objective function in <xref ref-type="disp-formula" rid="pcbi.1003227.e037">Equation 2</xref> leads to a consistent solution, with a suitable choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e078" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003227-Banerjee1">[32]</xref>. That is, the estimator <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e079" xlink:type="simple"/></inline-formula> converges in probability to the true inverse covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e080" xlink:type="simple"/></inline-formula>.</p>
<p>GINI however does not work with samples from a Gaussian distribution, but directly with a multi-instance kernel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e081" xlink:type="simple"/></inline-formula>. By definition, any kernel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e082" xlink:type="simple"/></inline-formula> can be represented as an inner product in some feature space <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e083" xlink:type="simple"/></inline-formula>, i.e. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e084" xlink:type="simple"/></inline-formula>. For the multi-instance statistic kernel, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e085" xlink:type="simple"/></inline-formula>, that is, the feature space is defined by the order statistics computed over bag <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e086" xlink:type="simple"/></inline-formula>. Since the order statistics for image data is bounded between 0 and 255, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e087" xlink:type="simple"/></inline-formula> is a bounded random variable. Hence the distribution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e088" xlink:type="simple"/></inline-formula> is sub-Gaussian. For sub-Gaussian distributions, Ravikumar et. al. <xref ref-type="bibr" rid="pcbi.1003227-Ravikumar1">[39]</xref> show that the penalized maximum likelihood estimator defined in <xref ref-type="disp-formula" rid="pcbi.1003227.e076">Equation 7</xref> is sparsistent, i.e. as the amount of data increases, the probability of identifying incorrect edges goes to zero. Thus, the kernelized estimator defined by GINI is sparsistent.</p>
<p>Thus, the GINI algorithm predicts the gene interaction network in two steps: in the first step, the similarity between different genes is computed using a multi-instance kernel. In the next step, a sparse interaction network is learned from the similarity matrix by solving <xref ref-type="disp-formula" rid="pcbi.1003227.e076">Equation 7</xref>, and predicting edges corresponding to the non-zeros of the non-diagonal entries of the estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e089" xlink:type="simple"/></inline-formula>. The next subsections describe the feature extraction, representation, and normalization process used to obtain suitable features from images that can be input into GINI.</p>
</sec></sec><sec id="s2c">
<title>Image processing</title>
<p>We convert the ISH images into canonical feature vectors suitable for analysis by our algorithm described above in a three-step manner. First, the precise expression pattern found in each image is extracted and aligned spatially to make all images spatially comparable. Next, each image is represented by a feature vector using Delaunay triangulation. Finally, features are normalized and feature selection is performed to extract meaningful features, that can be then used to compute the multi-set kernels to obtain gene similarity and learn the gene network.</p>
<sec id="s2c1">
<title>Feature extraction via <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e090" xlink:type="simple"/></inline-formula></title>
<p>ISH images are taken under diverse lighting conditions, and may suffer from poor quality staining/washing. A good feature extraction system must remove these effects, controlling for position, orientation etc. of the embryo and extract a precise gene expression pattern from the ISH images. In previous work <xref ref-type="bibr" rid="pcbi.1003227-Puniyani1">[15]</xref>, we developed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e091" xlink:type="simple"/></inline-formula>, an automatic system for embryonic ISH image feature extraction. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e092" xlink:type="simple"/></inline-formula> registers each Drosophila ISH image by first extracting the embryo (foreground) from the image, using edge filters and image analysis techniques. Next, the alignment, size, shape and orientation of the embryo is determined, and normalized to a standardized ellipse. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e093" xlink:type="simple"/></inline-formula> also does automatic error detection and correction, rejecting images where the gene expression extraction process may have introduced errors, and also rejecting partial embryos, multiple embryos physically touching each other, and excessively dried or otherwise mishandled embryos. Next, the expression stain is extracted from the standardized embryo using a novel algorithm that maximizes the contrast between the stained and unstained regions of the embryo. Finally, an image segmentation algorithm using Markov random fields is defined to extract only the regions that have gene expression. Thus, a concise and high-fidelity gene expression pattern is extracted from the ISH image.</p>
</sec><sec id="s2c2">
<title>Feature representation via Delaunay triangulation</title>
<p>While <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e094" xlink:type="simple"/></inline-formula> makes the images of different genes alignable spatially, and therefore directly comparable, the expression patterns must still be converted into an appropriate feature representation. One commonly used method for feature representation is to use the SIFT feature descriptor <xref ref-type="bibr" rid="pcbi.1003227-Lowe1">[40]</xref> in either a grid of points spaced uniformly through the image, with principal component analysis (PCA) used for dimensionality reduction <xref ref-type="bibr" rid="pcbi.1003227-Puniyani1">[15]</xref>, or via interest point detection and codebook generation <xref ref-type="bibr" rid="pcbi.1003227-Yuan1">[24]</xref>. Such techniques work well for supervised tasks like image annotation where a weight can be learned for each direction computed by PCA or for each codeword in the generated codebook. However, for unsupervised tasks, where weights cannot be learned, we wish to extract features that explicitly take into account the spatial distribution of the gene expression. A pixel level feature representation on the other hand, allows us to capture spatial information, but has high redundancy due to the correlation between neighboring pixels.</p>
<p>To reduce redundancy while capturing spatial gene expression information, we choose to overlay a fixed triangular mesh on top of the standardized embryo. The gene expression pattern for each image may then be represented as the median gene expression present in each triangle in this mesh. A mesh of 311 equilateral triangles was produced by using the Delaunay triangulation algorithm <xref ref-type="bibr" rid="pcbi.1003227-Persson1">[41]</xref>, and aligning the mesh to the standardized embryo, as described in <xref ref-type="bibr" rid="pcbi.1003227-Frise1">[23]</xref>. Each image can then be represented as a feature vector of length 311, with each feature representing the median gene expression expressed in a specific location on the embryo, which is fixed across all images. For example, triangle 1 may correspond to the head in all images, and so on. Modeling the spatial locations in a lower dimensional space via triangulation helps in approximating the independence assumption made in the GINI algorithm, analogous to using coarse time definitions while making microarray measurements.</p>
<p><xref ref-type="fig" rid="pcbi-1003227-g003">Figure 3</xref> shows examples of ISH images converted into the triangulated gene expression patterns. As can be seen, triangulating the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e095" xlink:type="simple"/></inline-formula> output captures the key features of the gene expression location and strengths. Thus, triangulation enables reducing the dimensionality of the feature space, while retaining explicit spatial information about the gene expression, which other dimensionality reduction techniques would not be able to capture.</p>
<fig id="pcbi-1003227-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g003</object-id><label>Figure 3</label><caption>
<title>Triangulation.</title>
<p>Examples of how ISH images are converted into low-dimensional triangulated representations, for efficient feature representation.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g003" position="float" xlink:type="simple"/></fig></sec><sec id="s2c3">
<title>Feature processing</title>
<p>The feature vectors extracted by triangulating the expression patterns are not normalized, hence, we need to adjust the signal obtained from different images to a common scale. The set of triangulated features may also contain uninformative features that may add a bias if used directly to compute the multi-set kernel. Further, the gene network analysis should only consider genes with informative expression patterns that have non-trivial spatial expression in the data. Hence, we need to further process the features to select informative features and genes, and normalize the features in an appropriate manner.</p>
</sec><sec id="s2c4">
<title>Feature normalization</title>
<p>Unlike in microarray data, the currently available ISH data does not measure the signal related to nonspecific binding of the probe for each image, hence the background correction of intensities cannot be image specific. Each gene expression pattern is normalized to have its expression values(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e096" xlink:type="simple"/></inline-formula>) lie between 0 and 255 (the minimum and maximum color value). The feature value is then computed as the logarithm of the expression value : <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e097" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2c5">
<title>Feature &amp; gene selection</title>
<p>A large percentage of the ISH images have no stain, or ubiquitous staining. In the BDGP data, 55% of the genes have at least one image, in at least one time point, with no stain. Since no information may be inferred from such data, these images must be removed from analysis. This can be achieved by removing expression patterns having variance below a threshold (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e098" xlink:type="simple"/></inline-formula>, usually 0.1).</p>
<p>Additionally, features that have low variance in the data set are capturing no information about the gene expression variation across multiple genes. Hence, they must be removed from the analysis as well. Since removing images from the analysis affects the feature variance and vice-versa, we alternate removing features and images with low variance, until both feature variance and image variance is greater than the threshold. This is described formally in <xref ref-type="sec" rid="pcbi-1003227-box001">Algorithm 1</xref>.</p>
<boxed-text id="pcbi-1003227-box001" position="float"><sec id="s2c5a1">
<title>Algorithm 1. Algorithm Outlining Feature Normalization and Processing.</title><p><bold>Input</bold>: triangulated features for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e099" xlink:type="simple"/></inline-formula> images : <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e100" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e101" xlink:type="simple"/></inline-formula>;</p>
<p>  variance threshold <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e102" xlink:type="simple"/></inline-formula></p>
<p><bold>Output</bold>: normalized and processed features in matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e103" xlink:type="simple"/></inline-formula></p>
<p><bold>for</bold> <italic>image</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e104" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
<p> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e105" xlink:type="simple"/></inline-formula>;</p>
<p><bold>end</bold></p>
<p><bold>while</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e106" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
<p> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e107" xlink:type="simple"/></inline-formula>;</p>
<p> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e108" xlink:type="simple"/></inline-formula>;</p>
<p> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e109" xlink:type="simple"/></inline-formula>;</p>
<p> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e110" xlink:type="simple"/></inline-formula>;</p>
<p><bold>end</bold></p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e111" xlink:type="simple"/></inline-formula> for matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e112" xlink:type="simple"/></inline-formula> returns a vector containing the variance of each column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e113" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e114" xlink:type="simple"/></inline-formula> returns the indices of the non-zero elements of vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e115" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e116" xlink:type="simple"/></inline-formula> is the transpose of matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e117" xlink:type="simple"/></inline-formula>.</p>
</sec></boxed-text></sec></sec><sec id="s2d">
<title>Summary of the GINI system</title>
<p>Putting everything together, we conclude the method section with a summary of the GINI system for network inference from ISH images. Each ISH image is converted into a standardized expression pattern using <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e118" xlink:type="simple"/></inline-formula>, and then triangulated to extract a low-dimensional spatial feature vector. Next, feature values are normalized, uninformative features are removed, and genes with insufficient information available are rejected. Finally, the multi-set kernel is used to compute the similarity between the bags of image vectors available for each gene, and the gene network is estimated using <xref ref-type="disp-formula" rid="pcbi.1003227.e076">Equation 7</xref>. The algorithm is summarized in <xref ref-type="sec" rid="pcbi-1003227-box002">Algorithm 2</xref>.</p>
<boxed-text id="pcbi-1003227-box002" position="float"><sec id="s2d1a">
<title>Algorithm 2. The Final GINI Algorithm to Obtain the Gene Network from ISH Images</title>
<p><bold>Input:</bold> Embryonic ISH images for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e119" xlink:type="simple"/></inline-formula> genes;</p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e120" xlink:type="simple"/></inline-formula> - tuning parameter to control sparsity</p>
<p><bold>Output</bold>: Predicted gene network for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e121" xlink:type="simple"/></inline-formula> genes</p>
<p><bold>for</bold> <italic>gene</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e122" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
<p> // feature extraction</p>
<p> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e123" xlink:type="simple"/></inline-formula>;</p>
<p> <bold>for</bold> <italic>each image</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e124" xlink:type="simple"/></inline-formula> of gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e125" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
<p>  Extract expression patterns from image <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e126" xlink:type="simple"/></inline-formula> using   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e127" xlink:type="simple"/></inline-formula>;</p>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e128" xlink:type="simple"/></inline-formula>triangulate expression pattern of image <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e129" xlink:type="simple"/></inline-formula>;</p>
<p>  // feature normalization</p>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e130" xlink:type="simple"/></inline-formula>;</p>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e131" xlink:type="simple"/></inline-formula>;</p>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e132" xlink:type="simple"/></inline-formula>;</p>
<p> <bold>end</bold></p>
<p> // <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e133" xlink:type="simple"/></inline-formula> is now the set of all normalized features of the  images of gene <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e134" xlink:type="simple"/></inline-formula></p>
<p><bold>end</bold></p>
<p>// Define the multi-instance kernel</p>
<p><bold>for</bold> <italic>gene</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e135" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
<p> <bold>for</bold> <italic>gene</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e136" xlink:type="simple"/></inline-formula> <bold>do</bold></p>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e137" xlink:type="simple"/></inline-formula></p>
<p> <bold>end</bold></p>
<p><bold>end</bold></p>
<p>// Run glasso using kernel <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e138" xlink:type="simple"/></inline-formula></p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e139" xlink:type="simple"/></inline-formula>;</p>
<p>Predicted edges in the network: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e140" xlink:type="simple"/></inline-formula>non-zeros in the non-diagonal elements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e141" xlink:type="simple"/></inline-formula>;</p>
</sec></boxed-text><sec id="s2d2">
<title>Computational complexity</title>
<p>We assume that the number of images per gene is small and bounded by a constant, and hence the total number of images is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e142" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e143" xlink:type="simple"/></inline-formula> is the number of genes. Then, given the triangulated features of all images, feature and gene selection takes time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e144" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e145" xlink:type="simple"/></inline-formula> to compute the correlation matrix in feature and gene space respectively. Computing the kernel requires <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e146" xlink:type="simple"/></inline-formula> time, and finally, the computational complexity of minimizing the log-det divergence is known to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e147" xlink:type="simple"/></inline-formula>. The overall computational complexity is then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e148" xlink:type="simple"/></inline-formula>. Assuming <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e149" xlink:type="simple"/></inline-formula>, the complexity may be assumed to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e150" xlink:type="simple"/></inline-formula>. The implementation is efficient, and computes a gene network for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e151" xlink:type="simple"/></inline-formula> genes in a few minutes on an Intel Core-2 CPU with 2 GB memory.</p>
</sec></sec></sec><sec id="s3">
<title>Results</title>
<p>We first demonstrate that the independence and Gaussian assumptions are reasonable for ISH data, and that GINI explains the ISH data well, with small fitting errors, and no bias in the residues. Next, we show the performance on a small subset of 12 images for 6 genes to verify that the network predicted by GINI is reasonable. We then run GINI on two datasets of ISH images from 2 time points in the BDGP data, and study the networks. We find the networks are modular and scale free as expected. Furthermore, different regions of the networks are enriched for spatial annotations, and the hubs of the networks are functionally enriched for important cellular functions. Finally, we demonstrate that these results could not have been obtained by analyzing microarray data.</p>
<sec id="s3a">
<title>Validation of the GINI assumptions: Independent spatial data</title>
<p>GINI assumes that the gene expression in each triangle can be assumed to be independently drawn from a multi-variate Gaussian. However, the true gene expression in adjacent spatial locations is correlated and not independent. To verify that this dependence of adjacent samples does not affect the accuracy of the estimated network, we simulate synthetic data where the underlying network is known, but the data points are not independent of each other, and test whether GINI can recover the correct network in such a scenario. The data samples depend on each other via a parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e152" xlink:type="simple"/></inline-formula> that captures degree of dependence between data samples. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e153" xlink:type="simple"/></inline-formula>, all data samples are drawn i.i.d. from the known distribution. As <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e154" xlink:type="simple"/></inline-formula> increases, data samples are drawn from the same distribution, but they depend on the adjacent samples.</p>
<sec id="s3a1">
<title>Data generation</title>
<p>For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e155" xlink:type="simple"/></inline-formula> dimensions, the true inverse covariance matrix was constructed by using the AR(1) model from <xref ref-type="bibr" rid="pcbi.1003227-Yuan2">[42]</xref>. That is, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e156" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e157" xlink:type="simple"/></inline-formula>, with all other elements being zero. Dependent samples are generated from a zero mean Gaussian having the above known inverse covariance matrix, as explained below.</p>
<p>Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e158" xlink:type="simple"/></inline-formula> be the fractional overlap between adjacent samples. The first sample is sampled independently from the above specified Gaussian. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e159" xlink:type="simple"/></inline-formula> sample is generated from the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e160" xlink:type="simple"/></inline-formula> sample as follows. Pick <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e161" xlink:type="simple"/></inline-formula> random features <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e162" xlink:type="simple"/></inline-formula>, and copy the value of the previous sample for these features : <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e163" xlink:type="simple"/></inline-formula>. Now, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e164" xlink:type="simple"/></inline-formula> can be partitioned into the “known” <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e165" xlink:type="simple"/></inline-formula> features and the remaining <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e166" xlink:type="simple"/></inline-formula> features which still need to be sampled, conditioned on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e167" xlink:type="simple"/></inline-formula>. If we partition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e168" xlink:type="simple"/></inline-formula> as<disp-formula id="pcbi.1003227.e169"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e169" xlink:type="simple"/></disp-formula>then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e170" xlink:type="simple"/></inline-formula> conditioned on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e171" xlink:type="simple"/></inline-formula> can be shown to be Gaussian with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e172" xlink:type="simple"/></inline-formula> and covariance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e173" xlink:type="simple"/></inline-formula>, which can be computed as below, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e174" xlink:type="simple"/></inline-formula> can be sampled from it.<disp-formula id="pcbi.1003227.e175"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e175" xlink:type="simple"/><label>(8)</label></disp-formula><disp-formula id="pcbi.1003227.e176"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e176" xlink:type="simple"/><label>(9)</label></disp-formula></p>
<p>We ran two experiments. In the first, a fixed number of samples(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e177" xlink:type="simple"/></inline-formula>) were used to learn the network. In the second, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e178" xlink:type="simple"/></inline-formula> increases, more samples (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e179" xlink:type="simple"/></inline-formula>) are available for learning the network. In both experiments, for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e180" xlink:type="simple"/></inline-formula> value, we randomly sample data points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e181" xlink:type="simple"/></inline-formula> using the method outlined above, estimate the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e182" xlink:type="simple"/></inline-formula> matrix, and compare it to the known <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e183" xlink:type="simple"/></inline-formula> matrix, to compute precision and recall. Results are averaged over 50 runs of the experiment.</p>
<p><xref ref-type="fig" rid="pcbi-1003227-g004">Figure 4(a)</xref> shows that as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e184" xlink:type="simple"/></inline-formula> increases, the precision (fraction of correct interactions among all inferred ones) and recall (fraction of correct interaction among all true interactions) stay constant for small values for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e185" xlink:type="simple"/></inline-formula>. Only when the amount of dependence increases beyond half, do we see a small reduction in accuracy. Thus, we can conclude that even if there is a large spatial dependence in gene expression, the result is equivalent to a slight reduction in performance. Futher, in <xref ref-type="fig" rid="pcbi-1003227-g004">Figure 4(b)</xref>, we see that if we can increase the number of data points as we increase <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e186" xlink:type="simple"/></inline-formula>, the performance remains the same as using i.i.d. data.</p>
<fig id="pcbi-1003227-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g004</object-id><label>Figure 4</label><caption>
<title>GINI assumptions are reasonable.</title>
<p>Even if the data are not independent draws from the Gaussian, the network can still be learned with high precision and recall. (a) For a fixed number of data points, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e187" xlink:type="simple"/></inline-formula> increases beyond 0.5, the precision and recall reduces. (b) If we allow the number of data points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e188" xlink:type="simple"/></inline-formula> to increase as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e189" xlink:type="simple"/></inline-formula> increases, the precision and accuracy of the method is not affected. The standard deviation at each point in both results is approximately 0.09.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g004" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s3b">
<title>GINI explains the ISH data well</title>
<p>For a high-dimensional distribution, it is not feasible to test if the data is truly Gaussian. However, a consequence of Gaussianity is that for each gene, the gene expression can be expressed as a weighted linear sum of the expression values of a few other genes, which form the edges of the network. To test if this assumption holds true in ISH data, for each gene, we fit a linear regression between the gene and its neighbors found by GINI and look at the absolute value of the error i.e. the mean absolute difference between the predicted and the known gene expression. When the maximum expression value is 1, for more than 90% of the genes we looked at, the absolute error was less than 0.02; 99.5% of all genes had absolute error less than 0.05, confirming that the GINI generative model explains the ISH data.</p>
<p>We also confirm that the prediction error is not systematic with respect to the spatial location. For each gene, we compute the prediction error (residue) when the gene is predicted by regressing it on its neighbors. For each spatial location, we plot the mean residue at that location for all genes. As can be seen in <xref ref-type="fig" rid="pcbi-1003227-g005">Figure 5</xref>, there is no systematic bias in the spatial positions that are hardest to predict for any gene.</p>
<fig id="pcbi-1003227-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g005</object-id><label>Figure 5</label><caption>
<title>GINI error analysis.</title>
<p>Locations where gene expression cannot be predicted easily. Red color indicates that the true gene expression was higher than predicted by the regression, while blue indicates that the true gene expression was lower than predicted by the regression. Note that since the difference in the true and predicted gene expressions is very small, the mean residue values were multiplied by 10 to improve the contrast of the image for visualization purposes. Thus, there is no systematic bias in the spatial locations where expression is hard to predict.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g005" position="float" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>Network on limited data</title>
<p>Before running our algorithm on a large sized dataset, we construct an artificial small data set to verify the results. We input 12 images, shown in <xref ref-type="fig" rid="pcbi-1003227-g006">Figure 6(a)</xref> from 6 genes to the GINI algorithm (each gene has 1–3 images in the data set). With <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e190" xlink:type="simple"/></inline-formula>, 4 edges are predicted in the network, shown in <xref ref-type="fig" rid="pcbi-1003227-g006">Figure 6(b)</xref>. As can be seen, the three genes hunchback(<italic>hb</italic>), four-jointed(<italic>fj</italic>), and <italic>Blimp-1</italic>, which are expressed in the dorsal, ventral and procephalic ectoderm, are connected in a single cluster. Similarly, the genes organic anion transporting polypeptide 74D(<italic>Oatp74D</italic>) and bicoid(<italic>bcd</italic>) are connected by an edge, since both show expression in the foregut and the anterior endoderm. Finally, the expression of sloppy paired-1<italic>(slp1)</italic> was considered to be sufficiently different from the other genes, hence it is not connected to any other gene in the network.</p>
<fig id="pcbi-1003227-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g006</object-id><label>Figure 6</label><caption>
<title>Example network on small data.</title>
<p>(a) 12 images input to the GINI system, and (b) network of genes learnt by it, with each gene represented by one image.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g006" position="float" xlink:type="simple"/></fig>
<p>Thus, the gene interaction network found by GINI can be verified to be reasonable for the above small data set.</p>
</sec><sec id="s3d">
<title>Network on the whole BDGP data</title>
<p>We now turn our attention to the ISH images from the Berkeley Drosophila Genome Project data set. We have obtained around 67400 ISH images of 3509 protein-coding genes from the BDGP data released in September 2009, captured at key development stages of embryonic development. Each image captures embryonic gene expression of a single gene using RNA in-situ hybridization. Each image was labeled manually with the age of the embryo, categorized into six distinct embryonic stages : 1–3, 4–6, 7–8, 9–10, 11–12, and 13–16. Genes are also annotated with ontology terms from a controlled vocabulary of around 295 terms, describing the unique embryonic structures in which gene expression is observed during the various stages of embryonic development. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e191" xlink:type="simple"/></inline-formula> analyzes these image automatically, rejecting unsuitable images, to produce 51593 expression patterns of 3347 genes.</p>
<p>As proof of concept, we focus on images viewed from a lateral perspective from two development stage ranges of this data : 9–10 and 13–16. For the stage 9–10, we have 2869 expression patterns of 2609 genes, and for stage 13–16, we have 6350 expression patterns of 3258 genes. We extracted features as described in the <xref ref-type="sec" rid="s2">methods</xref> section. For each development stage, we ran a separate analysis.</p>
<p>Using a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e192" xlink:type="simple"/></inline-formula> value of 0.775 for stage 9–10, we ran GINI and obtained a network having 258 genes, and 516 interactions (edges) between them. For the development stage 13–16, we used <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e193" xlink:type="simple"/></inline-formula>, and obtained a network with 1202 genes and 3666 interactions between them. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e194" xlink:type="simple"/></inline-formula> value was selected for each network by running GINI for 21 <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e195" xlink:type="simple"/></inline-formula> values between 0.5 and 1, and picking a value such that the mean-degree for the network is reasonable (approximately 2–3) - see Supplementary <xref ref-type="supplementary-material" rid="pcbi.1003227.s002">Figure S1</xref> for a plot that shows how the number of edges in the network decreases as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e196" xlink:type="simple"/></inline-formula> increases.</p>
<p>Some of the interactions predicted by GINI have already been reported in the literature. For example, in the network for stage 9–10, GINI predicts that DCP-1 (CG5370), an effector caspase which is involved in apoptosis, will interact with the <italic>thread</italic> gene (CG12284), a known inhibitor of apoptosis protein <xref ref-type="bibr" rid="pcbi.1003227-JS1">[43]</xref>. GINI also predicts that <italic>Snf5- related 1</italic>(CG1064) interacts with <italic>echinoid</italic> (CG12676), both of which are known to be involved in epidermis development, muscle organ development, as well as imaginal disc-derived wing vein morphogenesis. In the 13–16 development network, GINI predicts that the <italic>capping protein beta</italic> gene (CG17158) interacts with the <italic>Glycogen phosphorylase</italic> gene (CG7254), and <italic>Tpc1</italic> (CG6608) interacts with CG2812, which has been previously reported in <xref ref-type="bibr" rid="pcbi.1003227-Giot1">[44]</xref>.</p>
<p>The next five subsections do a detailed analysis of the 2 networks.</p>
</sec><sec id="s3e">
<title>Scale free network</title>
<p>A network is said to be scale free if its degree distribution asymptotically follows a power law. That is, the fraction of genes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e197" xlink:type="simple"/></inline-formula> that have at least <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e198" xlink:type="simple"/></inline-formula> interactions with other genes is<disp-formula id="pcbi.1003227.e199"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003227.e199" xlink:type="simple"/><label>(10)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e200" xlink:type="simple"/></inline-formula> is the scale free parameter, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e201" xlink:type="simple"/></inline-formula> is the normalization constant. It has been hypothesized that gene regulatory networks are scale free <xref ref-type="bibr" rid="pcbi.1003227-Basso1">[10]</xref>. We looked at the characteristic of our interaction networks by plotting the number of interactions per gene (<xref ref-type="fig" rid="pcbi-1003227-g007">Figure 7</xref>), and found that the networks found by GINI are scale free. The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e202" xlink:type="simple"/></inline-formula> parameter obtained is 2.3 and 2.5 for the 9–10 and 13–16 networks respectively, which corresponds well to the values observed for a large variety of power law graphs. The scale free nature of the network was found to be independent of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e203" xlink:type="simple"/></inline-formula> tuning parameter of the algorithm.</p>
<fig id="pcbi-1003227-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g007</object-id><label>Figure 7</label><caption>
<title>Scale-free network.</title>
<p>Connectivity properties of the reconstructed network for time stage 9–10, and 13–16. The scale free nature of the plot can be observed for both networks. The plot for stage 9–10 has fewer points since the network constructed has fewer nodes and edges.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g007" position="float" xlink:type="simple"/></fig>
<p>Unlike the gene regulatory network obtained for Human-B cells <xref ref-type="bibr" rid="pcbi.1003227-Basso1">[10]</xref>, we found that the scale-free nature of the gene network we obtain has a good fit, without observing a deviation from the expected at low connectivity values. However, this could be a side-effect of the larger number of genes they analyzed.</p>
</sec><sec id="s3f">
<title>The BDGP networks are modular</title>
<p>Using spectral clustering, we construct 12 regions or clusters within each network, and visualize the five biggest clusters of each of the networks in <xref ref-type="fig" rid="pcbi-1003227-g008">Figure 8</xref>. All 12 clusters in both networks are very well separated. The ratio of within-cluster edges to total number of edges is 70% and 87% for the 9–10 and 13–16 development stage networks respectively, indicating that the estimated networks are highly modular. From a biological perspective, different parts of gene networks may be responsible for different pathways or biological functional components of the cell, thus modularity is a good prediction for real interaction networks.</p>
<fig id="pcbi-1003227-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g008</object-id><label>Figure 8</label><caption>
<title>Modular network.</title>
<p>A global view of the networks constructed by our algorithm for development stage 9–10, and 13–16, visualized for 5 of the 12 clusters in the network. The nodes of each cluster in the network are represented by different colors. Red edges are edges between nodes in the same cluster, while green edges are edges between nodes in different clusters. Each cluster is represented by one or two spatial annotation terms enriched in the cluster.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g008" position="float" xlink:type="simple"/></fig></sec><sec id="s3g">
<title>Hub analysis</title>
<p>Given the scale-free nature of the network, a small number of the genes have a large number of interactions. We analyze the Gene Ontology functions of the genes having the largest number of interactions, i.e. the hubs of the network. The question we wish to address is: if we pick the top 5% of the genes having the maximum connectivity with other genes, what kind of functional enrichment do these genes have? Our background population is of the 2609 and 3258 genes for which we have at least one ISH image describing its expression for the 9–10 and 13–16 stages respectively. We use the hypergeometric test, with Bonferroni correction used to correct for multiple hypothesis tests <xref ref-type="bibr" rid="pcbi.1003227-Boyle1">[45]</xref>. As can be seen in <xref ref-type="table" rid="pcbi-1003227-t001">Table 1</xref>, we observe enrichment of a wide variety of functions that are essential to cell growth and functioning, including metabolic processes, cellular respiration, transport of electrons and ions, protein modification, ribosome biogenesis etc.</p>
<table-wrap id="pcbi-1003227-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.t001</object-id><label>Table 1</label><caption>
<title>GO functional analysis for the gene hubs of the GINI network.</title>
</caption><alternatives><graphic id="pcbi-1003227-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Stage</td>
<td align="left" rowspan="1" colspan="1">Gene Ontology term</td>
<td align="left" rowspan="1" colspan="1">Hub frequency</td>
<td align="left" rowspan="1" colspan="1">Genome frequency</td>
<td align="left" rowspan="1" colspan="1">P-value</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">9–10</td>
<td align="left" rowspan="1" colspan="1">cellular macromolecule metabolic process</td>
<td align="left" rowspan="1" colspan="1">57 of 119 genes, 47.9%</td>
<td align="left" rowspan="1" colspan="1">652 of 2575 genes, 25.3%</td>
<td align="left" rowspan="1" colspan="1">1.79e-05</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">macromolecule metabolic process</td>
<td align="left" rowspan="1" colspan="1">62 of 119 genes, 52.1%</td>
<td align="left" rowspan="1" colspan="1">772 of 2575 genes, 30.0%</td>
<td align="left" rowspan="1" colspan="1">8.16e-05</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">cell cycle</td>
<td align="left" rowspan="1" colspan="1">24 of 119 genes, 20.2%</td>
<td align="left" rowspan="1" colspan="1">174 of 2575 genes, 6.8%</td>
<td align="left" rowspan="1" colspan="1">0.00029</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">primary metabolic process</td>
<td align="left" rowspan="1" colspan="1">67 of 119 genes, 56.3%</td>
<td align="left" rowspan="1" colspan="1">962 of 2575 genes, 37.4%</td>
<td align="left" rowspan="1" colspan="1">0.00559</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">cell cycle phase</td>
<td align="left" rowspan="1" colspan="1">18 of 119 genes, 15.1%</td>
<td align="left" rowspan="1" colspan="1">127 of 2575 genes, 4.9%</td>
<td align="left" rowspan="1" colspan="1">0.00667</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">cellular metabolic process</td>
<td align="left" rowspan="1" colspan="1">64 of 119 genes, 53.8%</td>
<td align="left" rowspan="1" colspan="1">910 of 2575 genes, 35.3%</td>
<td align="left" rowspan="1" colspan="1">0.00827</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">mitotic cell cycle</td>
<td align="left" rowspan="1" colspan="1">18 of 119 genes, 15.1%</td>
<td align="left" rowspan="1" colspan="1">131 of 2575 genes, 5.1%</td>
<td align="left" rowspan="1" colspan="1">0.01039</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">cell cycle process</td>
<td align="left" rowspan="1" colspan="1">19 of 119 genes, 16.0%</td>
<td align="left" rowspan="1" colspan="1">146 of 2575 genes, 5.7%</td>
<td align="left" rowspan="1" colspan="1">0.01313</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">cellular process</td>
<td align="left" rowspan="1" colspan="1">90 of 119 genes, 75.6%</td>
<td align="left" rowspan="1" colspan="1">1508 of 2575 genes, 58.6%</td>
<td align="left" rowspan="1" colspan="1">0.01798</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">macromolecule modification</td>
<td align="left" rowspan="1" colspan="1">20 of 119 genes, 16.8%</td>
<td align="left" rowspan="1" colspan="1">163 of 2575 genes, 6.3%</td>
<td align="left" rowspan="1" colspan="1">0.01888</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">protein modification process</td>
<td align="left" rowspan="1" colspan="1">19 of 119 genes, 16.0%</td>
<td align="left" rowspan="1" colspan="1">155 of 2575 genes, 6.0%</td>
<td align="left" rowspan="1" colspan="1">0.03111</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">nucleobase-containing compound metabolic process</td>
<td align="left" rowspan="1" colspan="1">39 of 119 genes, 32.8%</td>
<td align="left" rowspan="1" colspan="1">476 of 2575 genes, 18.5%</td>
<td align="left" rowspan="1" colspan="1">0.04665</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">13–16</td>
<td align="left" rowspan="1" colspan="1">energy derivation by oxidation of organic compounds</td>
<td align="left" rowspan="1" colspan="1">13 of 159 genes, 8.2%</td>
<td align="left" rowspan="1" colspan="1">47 of 3217 genes, 1.5%</td>
<td align="left" rowspan="1" colspan="1">0.00011</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">cellular respiration</td>
<td align="left" rowspan="1" colspan="1">12 of 159 genes, 7.5%</td>
<td align="left" rowspan="1" colspan="1">43 of 3217 genes, 1.3%</td>
<td align="left" rowspan="1" colspan="1">0.00031</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">generation of precursor metabolites and energy</td>
<td align="left" rowspan="1" colspan="1">14 of 159 genes, 8.8%</td>
<td align="left" rowspan="1" colspan="1">60 of 3217 genes, 1.9%</td>
<td align="left" rowspan="1" colspan="1">0.00039</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">electron transport chain</td>
<td align="left" rowspan="1" colspan="1">10 of 159 genes, 6.3%</td>
<td align="left" rowspan="1" colspan="1">32 of 3217 genes, 1.0%</td>
<td align="left" rowspan="1" colspan="1">0.00093</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">mitochondrial ATP synthesis coupled electron transport</td>
<td align="left" rowspan="1" colspan="1">9 of 159 genes, 5.7%</td>
<td align="left" rowspan="1" colspan="1">26 of 3217 genes, 0.8%</td>
<td align="left" rowspan="1" colspan="1">0.00121</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">ATP synthesis coupled electron transport</td>
<td align="left" rowspan="1" colspan="1">9 of 159 genes, 5.7%</td>
<td align="left" rowspan="1" colspan="1">27 of 3217 genes, 0.8%</td>
<td align="left" rowspan="1" colspan="1">0.00174</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">cellular process</td>
<td align="left" rowspan="1" colspan="1">116 of 159 genes, 73.0%</td>
<td align="left" rowspan="1" colspan="1">1808 of 3217 genes, 56.2%</td>
<td align="left" rowspan="1" colspan="1">0.00211</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">respiratory electron transport chain</td>
<td align="left" rowspan="1" colspan="1">9 of 159 genes, 5.7%</td>
<td align="left" rowspan="1" colspan="1">28 of 3217 genes, 0.9%</td>
<td align="left" rowspan="1" colspan="1">0.00246</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">oxidative phosphorylation</td>
<td align="left" rowspan="1" colspan="1">9 of 159 genes, 5.7%</td>
<td align="left" rowspan="1" colspan="1">29 of 3217 genes, 0.9%</td>
<td align="left" rowspan="1" colspan="1">0.00342</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">ribosome biogenesis</td>
<td align="left" rowspan="1" colspan="1">7 of 159 genes, 4.4%</td>
<td align="left" rowspan="1" colspan="1">20 of 3217 genes, 0.6%</td>
<td align="left" rowspan="1" colspan="1">0.01640</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">cellular metabolic process</td>
<td align="left" rowspan="1" colspan="1">78 of 159 genes, 49.1%</td>
<td align="left" rowspan="1" colspan="1">1091 of 3217 genes, 33.9%</td>
<td align="left" rowspan="1" colspan="1">0.01708</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">mitochondrial electron transport, NADH to ubiquinone</td>
<td align="left" rowspan="1" colspan="1">6 of 159 genes, 3.8%</td>
<td align="left" rowspan="1" colspan="1">15 of 3217 genes, 0.5%</td>
<td align="left" rowspan="1" colspan="1">0.02661</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>GO functional analysis for the gene hubs of the networks learned for the two development stages by GINI. Both networks have hubs that are enriched for multiple important cellular functions.</p></fn></table-wrap-foot></table-wrap>
<p>Next, we examine a few high-degree hubs in the two networks in detail, along with their neighborhood genes in the networks. <xref ref-type="fig" rid="pcbi-1003227-g009">Figure 9</xref> shows the hub neighborhood for two genes in the 9–10 development stage network. CG3969 is a Activated Cdc42 kinase-like gene known to be involved in protein phosphorylation <xref ref-type="bibr" rid="pcbi.1003227-Consortium1">[46]</xref> and cell death <xref ref-type="bibr" rid="pcbi.1003227-Gorski1">[47]</xref>, and CG9984 (<italic>TH1</italic>) is known to be involved in regulation of biosynthetic process <xref ref-type="bibr" rid="pcbi.1003227-Missra1">[48]</xref> and nervous system development <xref ref-type="bibr" rid="pcbi.1003227-Neumller1">[49]</xref>. Both genes interact with many genes having functions related to the primary metabolic process, and single-organism cellular process. In stage 13–16, we examine the hub neighborhood of CG5904 and CG6501. The mitochondrial ribosomal protein CG5904 has been previously predicted to be a structural constituent of ribosome <xref ref-type="bibr" rid="pcbi.1003227-Koc1">[50]</xref>, and we find that it interacts with many genes involved in the ribosome biogenesis. Gene CG6501 (<italic>Ns2</italic>) has been previously predicted to be involved in phagocytosis, engulfment <xref ref-type="bibr" rid="pcbi.1003227-StroscheinStevenson1">[51]</xref>, and ribosome biogenesis <xref ref-type="bibr" rid="pcbi.1003227-Consortium1">[46]</xref>; CG6501's neighborhood has multiple genes that are also involved in ribosome biogenesis and single-organism cellular process.</p>
<fig id="pcbi-1003227-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g009</object-id><label>Figure 9</label><caption>
<title>Hubs of the GINI network.</title>
<p>A look into the neighborhoods of a few hubs from the GINI networks for stage 9–10 and 13–16. A few enriched GO groups are highlighted in the subnetworks as shown.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g009" position="float" xlink:type="simple"/></fig></sec><sec id="s3h">
<title>Enrichment of annotation terms</title>
<p>Each gene in the BDGP data has been labeled manually by annotations describing the spatial gene expression, using 295 annotation terms. We expect that since the gene interaction network is constructed via spatial similarity, genes that are connected to each other in the network will have similar spatial annotation terms.</p>
<p>To test this, we cluster the gene network using spectral clustering <xref ref-type="bibr" rid="pcbi.1003227-NG1">[52]</xref> into 12 clusters, and analyze the enrichment of each cluster for annotation terms using the hypergeometric test, with Bonferroni correction used to correct for multiple hypothesis tests. In the gene network for the 9–10 stage, 11 of the 12 clusters are enriched for 63 total annotation terms (<xref ref-type="fig" rid="pcbi-1003227-g010">Figure 10</xref>). The only cluster not showing any enrichment in the 9–10 stage network is also the smallest cluster, having only 4 genes. For example, in cluster 8, 92% of the genes have expression in the ventral nerve cord primordium P3 , while only 8% of the genes in the data have expression in this region. Similarly, 73% of the genes in cluster 11 have expression in the trunk mesoderm primordium, while only 16% of the genes in the data have expression in this region. For the 13–16 stage network, all 12 clusters are enriched for a total of 81 enrichments, a part of which is visualized in <xref ref-type="fig" rid="pcbi-1003227-g010">Figure 10</xref>. <xref ref-type="supplementary-material" rid="pcbi.1003227.s003">Tables S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1003227.s004">S2</xref> in the supplementary material report the complete enrichment analysis.</p>
<fig id="pcbi-1003227-g010" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g010</object-id><label>Figure 10</label><caption>
<title>Spatial annotations.</title>
<p>Enrichment analysis for clusters in the gene interaction networks found by GINI. A green dot indicates enrichment with a P-value<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e204" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g010" position="float" xlink:type="simple"/></fig><sec id="s3h1">
<title>Triangulation improves quality of result</title>
<p>Previous work on image processing for ISH images has focused on using SIFT features, and constructing a codebook that contain all the embryonic structures that the system is expected to annotate <xref ref-type="bibr" rid="pcbi.1003227-Yuan1">[24]</xref>. In this section, we show that triangulation produces more interesting networks over such a SIFT feature representation. We use the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e205" xlink:type="simple"/></inline-formula> gene expression patterns, and represent them by constructing SIFT features of the expression pattern over a grid. These grid SIFT features are then represented with a codebook of 2000 dictionary features, as described in <xref ref-type="bibr" rid="pcbi.1003227-Yuan1">[24]</xref>. We then use these dictionary features instead of the triangulated features to learn the GINI network. <xref ref-type="fig" rid="pcbi-1003227-g011">Figure 11</xref> shows that the resulting networks are not as richly enriched as the ones derived from the triangulation features in <xref ref-type="fig" rid="pcbi-1003227-g010">Figure 10</xref>. The total number of enrichments in the SIFT codebook network is 42 and 21 for the 9–10 and 13–16 development stage networks respectively. In contrast, the triangulated GINI networks had 63 and 81 enrichments for the 9–10 and 13–16 stage networks. <xref ref-type="fig" rid="pcbi-1003227-g012">Figure 12</xref> shows that this result is independent of the number of clusters selected for the analysis, for both triangulated networks as well as SIFT codebook networks.</p>
<fig id="pcbi-1003227-g011" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g011</object-id><label>Figure 11</label><caption>
<title>Enrichment analysis on networks learned from SIFT dictionary features instead of triangulation features.</title>
<p>The network for development stage 9–10 has only 7 enriched clusters of the 12 clusters in the network. For the stage 13–16 network, only 3 of the 12 clusters are enriched for spatial annotations.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g011" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003227-g012" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g012</object-id><label>Figure 12</label><caption>
<title>SIFT codebook features do not perform as well as triangulated features on ISH data.</title>
<p>Percentage of clusters enriched for spatial annotations in networks predicted by GINI as a function of number of clusters for data from development stage 9–10 and 13–16. As can be seen, using triangulated features produces networks with more enriched clusters than using SIFT-codeword features, independent of the number of clusters selected for the analysis. Further, the enrichment of the GINI network clusters does not significantly vary as the number of clusters are varied.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g012" position="float" xlink:type="simple"/></fig></sec><sec id="s3h2">
<title>Sensitivity to the tuning parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e206" xlink:type="simple"/></inline-formula></title>
<p>Supplementary <xref ref-type="supplementary-material" rid="pcbi.1003227.s002">Figure S1</xref> shows how the number of edges in the network decreases as the tuning parameter(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e207" xlink:type="simple"/></inline-formula>) of the GINI algorithm increases. To confirm that the enrichment results are not sensitive to the choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e208" xlink:type="simple"/></inline-formula>, we obtained 21 predicted networks by varying the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e209" xlink:type="simple"/></inline-formula> value uniformly from 0.5 to 1. For each network, we repeated the clustering and enrichment analysis, and found that the enrichment for term annotations is not highly sensitive to choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e210" xlink:type="simple"/></inline-formula> ( <xref ref-type="fig" rid="pcbi-1003227-g013">Figure 13</xref>). The enrichment results are also not dependent on the number of clusters - we get high enrichment, independent of the number of clusters chosen while running the clustering algorithm (<xref ref-type="fig" rid="pcbi-1003227-g012">Figure 12</xref>).</p>
<fig id="pcbi-1003227-g013" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g013</object-id><label>Figure 13</label><caption>
<title><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e211" xlink:type="simple"/></inline-formula> tuning. Percentage of clusters enriched for spatial annotations in networks predicted by GINI as a function of tuning parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e212" xlink:type="simple"/></inline-formula> for data from development stage 9–10 and 13–16. As we increase <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e213" xlink:type="simple"/></inline-formula>, the number of edges predicted in the network decrease, however, the enrichment of the different clusters stays almost constant. Thus, qualitative analysis of the network does not seem to be sensitive to choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e214" xlink:type="simple"/></inline-formula>.</title>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g013" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s3i">
<title>Comparison with microarray network</title>
<p>We learn a network from microarray data collected by the BDGP project over 12 time points in embryonic development <xref ref-type="bibr" rid="pcbi.1003227-Tomancak1">[16]</xref>, over the same genes that are being studied in the 9–10 and 13–16 networks, using covariance between the microarray expression as the kernel. We find that the overlap in edges between the 2 networks is very small, only 1% of the edges are common to both networks. If we assume that spatial expression annotations are a proxy for functional enrichment, then we can check if the microarray network is enriched for the spatial annotation terms. <xref ref-type="fig" rid="pcbi-1003227-g014">Figure 14</xref> shows that the percentage of enriched clusters in the microarray network is small, independent of the number of clusters analyzed.</p>
<fig id="pcbi-1003227-g014" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.g014</object-id><label>Figure 14</label><caption>
<title>Microarray v/s ISH data.</title>
<p>The percentage of clusters that are enriched for spatial term annotations using networks learned from ISH and microarray data.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.g014" position="float" xlink:type="simple"/></fig>
<p>We can also test functional GO enrichment of the hubs of the network. <xref ref-type="table" rid="pcbi-1003227-t002">Table 2</xref> shows that the hubs of the microarray network for stage 13–16 are enriched for only a single function, where 4 of the 145 hub genes are involved in the “aromatic compound catabolic process”, while the microarray data network for stage 9–10 has no enrichments.</p>
<table-wrap id="pcbi-1003227-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003227.t002</object-id><label>Table 2</label><caption>
<title>GO functional analysis for the gene hubs of the microarray network.</title>
</caption><alternatives><graphic id="pcbi-1003227-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003227.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Stage</td>
<td align="left" rowspan="1" colspan="1">Gene Ontology term</td>
<td align="left" rowspan="1" colspan="1">Hub frequency</td>
<td align="left" rowspan="1" colspan="1">Genome frequency</td>
<td align="left" rowspan="1" colspan="1">P-value</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">13–16</td>
<td align="left" rowspan="1" colspan="1">aromatic compound catabolic process</td>
<td align="left" rowspan="1" colspan="1">4 of 145 genes, 2.8%</td>
<td align="left" rowspan="1" colspan="1">6 of 3213 genes, 0.2%</td>
<td align="left" rowspan="1" colspan="1">0.01841</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>GO functional analysis for the gene hubs of the microarray networks learned for genes with images in the 13–16 development stage. No enriched terms were found for the microarray network constructed on genes from the 9–10 stage.</p></fn></table-wrap-foot></table-wrap>
<p>Thus, we find that the network learned from ISH images is clearly different from a network learned from microarray data. The ISH image network is enriched for spatial annotation terms, as well as functional enrichment of the hubs of the network, which does not hold true for the microarray network. This suggests that analyzing ISH images could support different scientific conclusions, which should be studied in greater detail.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>GINI predicts gene interaction networks by analyzing Drosophila embryo ISH images. While the experiments above have been reported on the ISH data from BDGP, the GINI algorithm can be applied to all image data, by suitably modifying only the image processing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e215" xlink:type="simple"/></inline-formula> pipeline. Using synthetic and image data, we establish that GINI fits the ISH data well, with low error residues, and that it can learn the true network correctly even if the data is not completely i.i.d. The analysis of the BDGP data shows that the hubs of the predicted gene interaction network are enriched for essential cellular functions, and that different regions of the interaction network are enriched for different combinations of annotation terms describing the gene expression. Thus, the predicted gene interaction network is capturing essential spatial and functional information about the expression pattern of the genes. We found that the gene interaction network learned from ISH images differs significantly from a network learned from microarray data.</p>
<p>The current work focuses on extracting gene networks from spatial data. The next step is combining information from multiple time stages to improve predictions, thus learning spatial-temporal gene networks. The problem of time-varying networks has been studied extensively for microarray data, by using different statistical penalties to estimate the network. For example, Ahmed et. al. <xref ref-type="bibr" rid="pcbi.1003227-Ahmed1">[22]</xref> construct time varying networks by using a temporally smoothed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e216" xlink:type="simple"/></inline-formula>-regularized logistic regression formulation, while Danaher et. al. <xref ref-type="bibr" rid="pcbi.1003227-Danaher1">[53]</xref> propose a fused lasso and group lasso based approach to combine information across time. Extensions of such algorithms for image data require stronger assumptions on data quality, such as having the same number of genes and image quality across time. Further, certain development stages may be less informative than others; for example, very few genes are active at development stage 1–3, and expression data from this stage is not as informative as expression data from development stage 13–16, when the embryo is much more mature. Developing algorithms that can account for such variations in data quality, while combining information across time, remains an interesting future direction to explore.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003227.s001" mimetype="application/x-bzip2" xlink:href="info:doi/10.1371/journal.pcbi.1003227.s001" position="float" xlink:type="simple"><label>Dataset S1</label><caption>
<p><bold>Networks predicted by GINI for the 9–10 and 13–16 development stages.</bold> For the data at each stage, multiple networks were predicted by varying the tuning parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e217" xlink:type="simple"/></inline-formula>, between 0.5 and 1, as described in the paper. The network for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e218" xlink:type="simple"/></inline-formula> value is stored in a separate file in the dataset, in a format readable by Cytoscape.</p>
<p>(BZ2)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003227.s002" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003227.s002" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Number of predicted edges versus</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e219" xlink:type="simple"/></inline-formula>. Number of edges predicted by GINI as a function of tuning parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e220" xlink:type="simple"/></inline-formula> for data from development stage 9–10 and 13–16. As <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003227.e221" xlink:type="simple"/></inline-formula> decreases, the number of edges selected in the network increase.</p>
<p>(TIFF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003227.s003" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003227.s003" position="float" xlink:type="simple"><label>Table S1</label><caption>
<p><bold>Enrichment analysis for network for development stage 9–10.</bold> For each of the 12 clusters in the GINI network for stage 9–10, the spatial annotation terms for which each cluster is enriched is shown. 11 of the 12 clusters are enriched for at least one spatial annotation.</p>
<p>(PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003227.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003227.s004" position="float" xlink:type="simple"><label>Table S2</label><caption>
<p><bold>Enrichment analysis for network for development stage 13–16.</bold> For each of the 12 clusters in the GINI network for stage 13–16, the spatial annotation terms for which each cluster is enriched is shown.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003227-Davidson1"><label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">Davidson EH (2001) Genomic Regulatory Systems. Academic Press.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Gilbert1"><label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Gilbert SF (2003) Developmental Biology, Seventh Edition. Sinauer Associates.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Friedman1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Linial</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Nachman</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Pe'er</surname><given-names>D</given-names></name> (<year>2000</year>) <article-title>Using Bayesian networks to analyze expression data</article-title>. <source>J Comput Biol</source> <volume>7</volume>: <fpage>601</fpage>–<lpage>620</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Pournara1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pournara</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Wernisch</surname><given-names>L</given-names></name> (<year>2004</year>) <article-title>Reconstruction of gene networks using Bayesian learning and manipulation experiments</article-title>. <source>Bioinformatics</source> <volume>20</volume> (<issue>(17)</issue>) <fpage>2934</fpage>–<lpage>42</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Segal1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segal</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Koller</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Friedman</surname><given-names>N</given-names></name> (<year>2003</year>) <article-title>Module networks: Identifying regulatory modules and their condition-specific regulators from gene expression data</article-title>. <source>Nature genetics</source> <volume>34</volume>: <fpage>166</fpage>–<lpage>176</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Ma1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ma</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Gong</surname><given-names>Q</given-names></name>, <name name-style="western"><surname>Bohnert</surname><given-names>HJ</given-names></name> (<year>2007</year>) <article-title>An Arabidopsis gene network based on the graphical Gaussian model</article-title>. <source>Genome Res</source> <volume>17</volume>: <fpage>1614</fpage>–<lpage>1625</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Dobra1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dobra</surname><given-names>A</given-names></name>, <name name-style="western"><surname>West</surname><given-names>M</given-names></name> (<year>2004</year>) <article-title>Sparse graphical models for exploring gene expression data</article-title>. <source>J Multivariate analysis</source> <volume>90</volume>: <fpage>196</fpage>–<lpage>212</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Tanay1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tanay</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sharan</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kupiec</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Shamir</surname><given-names>R</given-names></name> (<year>2004</year>) <article-title>Revealing modularity and organization in the yeast molecular network by integrated analysis of highly heterogeneous genomewide data</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>101</volume> (<issue>(9)</issue>) <fpage>2981</fpage>–<lpage>6</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Gardner1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gardner</surname><given-names>T</given-names></name>, <name name-style="western"><surname>di Bernardo</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Lorenz</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Collins</surname><given-names>JJ</given-names></name> (<year>2003</year>) <article-title>Inferring genetic networks and identifying compound mode of action via expression profiling</article-title>. <source>Science</source> <volume>301</volume>: <fpage>102</fpage>–<lpage>105</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Basso1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Basso</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Magolin</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Califano</surname><given-names>A</given-names></name> (<year>2005</year>) <article-title>Reverse engineering of regulatory networks in human B cells</article-title>. <source>Nature Genetics</source> <volume>37</volume>: <fpage>382</fpage>–<lpage>390</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Bansal1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bansal</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Belcastro</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Ambesi-Impiombato</surname><given-names>A</given-names></name>, <name name-style="western"><surname>di Bernardo</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>How to infer gene networks from expression profiles</article-title>. <source>Mol Sys Biology</source> <volume>3</volume> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb4100158" xlink:type="simple">10.1038/msb4100158</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003227-Hache1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hache</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Lehrach</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Herwig</surname><given-names>R</given-names></name> (<year>2009</year>) <article-title>Reverse engineering of gene regulatory networks: A comparative study</article-title>. <source>EURASIP Journal on Bioinformatics and Systems Biology</source> <volume>2009</volume> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1155/2009/617281" xlink:type="simple">10.1155/2009/617281</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003227-Carro1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carro</surname><given-names>MS</given-names></name>, <name name-style="western"><surname>Califano</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Iavarone</surname><given-names>A</given-names></name> (<year>2010</year>) <article-title>The transcriptional network for mesenchymal transformation of brain tumours</article-title>. <source>Nature</source> <volume>463</volume>: <fpage>318</fpage>–<lpage>325</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Wang1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Saito</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Califano</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Genome-wide identification of post-translational modulators of transcription factor activity in human B-cells</article-title>. <source>Nature Biotechnology</source> <volume>27</volume>: <fpage>829</fpage>–<lpage>839</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Puniyani1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Puniyani</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Faloutsos</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Xing</surname><given-names>E</given-names></name> (<year>2010</year>) <article-title>SPEX∧2: automated concise extraction of spatial gene expression patterns from fly embryo ISH images</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>47</fpage>–<lpage>56</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Tomancak1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tomancak</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Beaton</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Weiszmann</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kwan</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Shu</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>Systematic determination of patterns of gene expression during Drosophila embryogenesis</article-title>. <source>Genome Biology</source> <volume>3</volume>: <fpage>research0088.1</fpage>–<lpage>research0088.14</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Tomancak2"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tomancak</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Berman</surname><given-names>BP</given-names></name>, <name name-style="western"><surname>A</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Weiszmann</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Kwan</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Global analysis of patterns of gene expression during drosophila embryogenesis</article-title>. <source>Genome Biology</source> <volume>8</volume> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2007-8-7-r145" xlink:type="simple">10.1186/gb-2007-8-7-r145</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003227-Yuji1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yuji</surname><given-names>K</given-names></name> (<year>2001</year>) <article-title>Systematic analysis of gene expression of the C. elegans genome</article-title>. <source>Protein, Nucleic Acid and Enzyme</source> <volume>46</volume>: <fpage>2425</fpage>–<lpage>2431</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Lein1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lein</surname><given-names>ES</given-names></name>, <name name-style="western"><surname>Hawrylycz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Ao</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>AR</given-names></name> (<year>2007</year>) <article-title>Genome-wide atlas of gene expression in the adult mouse brain</article-title>. <source>Nature</source> <volume>445</volume>: <fpage>168</fpage>–<lpage>176</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Wellner1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wellner</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Meyerowitz</surname><given-names>EM</given-names></name> (<year>2004</year>) <article-title>Genome-wide analysis of spatial gene expression in Arabidopsis owers</article-title>. <source>Plant Cell</source> <volume>16</volume>: <fpage>1314</fpage>–<lpage>1326</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Almstrup1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Almstrup</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Leffers</surname><given-names>H</given-names></name> (<year>2004</year>) <article-title>Embryonic stem cell-like features of testicular carcinoma in situ revealed by genome-wide gene expression profiling</article-title>. <source>Cancer Research</source> <volume>64</volume>: <fpage>4736</fpage>–<lpage>43</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Ahmed1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ahmed</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Xing</surname><given-names>EP</given-names></name> (<year>2009</year>) <article-title>Tesla: Recovering time-varying networks of dependencies in social and biological studies</article-title>. <source>Proc Natl Acad Sci</source> <volume>106</volume>: <fpage>11878</fpage>–<lpage>11883</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Frise1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Frise</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Hammonds</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Celniker</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Systematic image-driven analysis of the spatial Drosophila embryonic expression landscape</article-title>. <source>Mol Sys Biology</source> <volume>6</volume> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2009.102" xlink:type="simple">10.1038/msb.2009.102</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003227-Yuan1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yuan</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Woodard</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ji</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Jiang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>ZH</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Learning sparse representations for fruit fly gene expression pattern image annotation and retrieval</article-title>. <source>BMC Bioinformatics</source> <volume>13</volume> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-13-107" xlink:type="simple">10.1186/1471-2105-13-107</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003227-Mace1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mace</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Ohler</surname><given-names>U</given-names></name> (<year>2010</year>) <article-title>Extraction and comparison of gene expression patterns from 2D RNA in situ hybridization images</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>761</fpage>–<lpage>769</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Gargesha1"><label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Gargesha M, Yang J, Van Emden B, Panchanathan S, Kumar S (2005) Automatic annotation techniques for gene expression images of the fruit fly embryo. In: Society of Photo-Optical Instrumentation Engineers (SPIE) Conference Series. volume 5960, pp. 576–583.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Bach1"><label>27</label>
<mixed-citation publication-type="other" xlink:type="simple">Bach F, Jordan M (2002) Learning graphical models with mercer kernels. In: Becker S, Thrun S, Obermayer K, editors, NIPS. volume 15, pp. 1009–1016.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Jaffrezic1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jaffrezic</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Tosser-Klopp</surname><given-names>G</given-names></name> (<year>2009</year>) <article-title>Gene network reconstruction from microarray data</article-title>. <source>BMC Proceedings</source> <volume>3</volume>: <fpage>S12</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Segal2"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segal</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Unnerstall</surname><given-names>U</given-names></name>, <name name-style="western"><surname>Gaul</surname><given-names>U</given-names></name> (<year>2008</year>) <article-title>Predicting expression patterns from regulatory sequence in Drosophila segmentation</article-title>. <source>Nature</source> <volume>451</volume>: <fpage>535</fpage>–<lpage>540</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Janssens1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Janssens</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Reinitz</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>Quantitative and predictive model of transcriptional control of the Drosophila melanogaster even skipped gene</article-title>. <source>Nat Gen</source> <volume>38</volume>: <fpage>1159</fpage>–<lpage>1165</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Dempster1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dempster</surname><given-names>AP</given-names></name> (<year>1972</year>) <article-title>Covariance selection</article-title>. <source>Biometrics-Special Multivariate Issue</source> <volume>28</volume>: <fpage>157</fpage>–<lpage>175</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Banerjee1"><label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Banerjee O, Ghaoui LE, d'Aspremont A, Natsoulis G (2006) Convex optimization techniques for fitting sparse Gaussian graphical models. In: ICML. pp. 89–96. <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://doi.acm.org/10.1145/1143844.1143856" xlink:type="simple">http://doi.acm.org/10.1145/1143844.1143856</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003227-Friedman2"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name> (<year>2007</year>) <article-title>Sparse inverse covariance estimation with the graphical lasso</article-title>. <source>Biostatistics</source> <volume>9</volume>: <fpage>432</fpage>–<lpage>441</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Tibshirani1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name> (<year>1996</year>) <article-title>Regression shrinkage and selection via the lasso</article-title>. <source>J R Statist Soc B</source> <volume>58</volume>: <fpage>267</fpage>–<lpage>288</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Maron1"><label>35</label>
<mixed-citation publication-type="other" xlink:type="simple">Maron O, Ratan AL (1998) Multiple-instance learning for natural scene classification. In: The Fifteenth International Conference on Machine Learning. Morgan Kaufmann, pp. 341–349.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Andrews1"><label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Andrews S, Tsochantaridis I, Hofmann T (2003) Support vector machines for multiple-instance learning. In: Advances in Neural Information Processing Systems. MIT Press, pp. 561–568.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Gartner1"><label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Gartner T, Flach PA, Kowalczyk A, Smola AJ (2002) Multi-instance kernels. In: ICML. pp. 179–186.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Aronszajn1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Aronszajn</surname><given-names>N</given-names></name> (<year>1950</year>) <article-title>Theory of reproducing kernels</article-title>. <source>Transactions of the American Mathematical Society</source> <volume>68</volume>: <fpage>337</fpage>–<lpage>404</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Ravikumar1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ravikumar</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Wainwright</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Raskutti</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>B</given-names></name> (<year>2011</year>) <article-title>High-dimensional covariance estimation by minimizing L1-penalized log-determinant divergence</article-title>. <source>Electronic Journal of Statistics</source> <volume>5</volume>: <fpage>935</fpage>–<lpage>980</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Lowe1"><label>40</label>
<mixed-citation publication-type="other" xlink:type="simple">Lowe DG (1999) Object recognition from local scale-invariant features. In: Seventh International Conference on Computer Vision. Kerkyra , Greece, pp. 1150–1157.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Persson1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Persson</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Strang</surname><given-names>G</given-names></name> (<year>2004</year>) <article-title>A simple mesh generator in Matlab</article-title>. <source>SIAM</source> <volume>46</volume>: <fpage>329</fpage>–<lpage>345</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Yuan2"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yuan</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lin</surname><given-names>Y</given-names></name> (<year>2007</year>) <article-title>Model selection and estimation in the Gaussian graphical model</article-title>. <source>Biometrika</source> <volume>94</volume>: <fpage>19</fpage>–<lpage>35</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-JS1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>JS</surname><given-names>P</given-names></name>, <name name-style="western"><surname>M</surname><given-names>B</given-names></name>, <name name-style="western"><surname>K</surname><given-names>M</given-names></name> (<year>2003</year>) <article-title>Stage-specific regulation of caspase activity in Drosophila oogenesis</article-title>. <source>Dev Biology</source> <volume>260</volume>: <fpage>113</fpage>–<lpage>123</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Giot1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Giot</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bader</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Brouwer</surname><given-names>C</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>A protein interaction map of Drosophila melanogaster</article-title>. <source>Science</source> <volume>302</volume>: <fpage>1727</fpage>–<lpage>1736</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Boyle1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boyle</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Weng</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Sherlock</surname><given-names>G</given-names></name> (<year>2004</year>) <article-title>GO::TermFinder—open source software for accessing gene ontology information and finding significantly enriched gene ontology terms associated with a list of genes</article-title>. <source>Bioinformatics</source> <volume>20</volume>: <fpage>3710</fpage>–<lpage>3715</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Consortium1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Consortium</surname><given-names>TF</given-names></name> (<year>2002</year>) <article-title>The FlyBase database of the Drosophila genome projects and community literature</article-title>. <source>Nucleic Acids Res</source> <volume>30</volume>: <fpage>106</fpage>–<lpage>108</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Gorski1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gorski</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Chittaranjan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Pleasance</surname><given-names>ED</given-names></name>, <name name-style="western"><surname>Freeman</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Anderson</surname><given-names>CL</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>A SAGE approach to discovery of genes involved in autophagic cell death</article-title>. <source>Current Biology</source> <volume>13</volume>: <fpage>358</fpage>–<lpage>363</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Missra1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Missra</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Gilmour</surname><given-names>DS</given-names></name> (<year>2010</year>) <article-title>Interactions between DSIF (DRB sensitivity inducing factor), NELF (negative elongation factor), and the Drosophila RNA polymerase II transcription elongation complex</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>107</volume>: <fpage>11301</fpage>–<lpage>11306</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Neumller1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neumüller</surname><given-names>RA</given-names></name>, <name name-style="western"><surname>Richter</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Fischer</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Novatchkova</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Neumüller</surname><given-names>KG</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Genome-wide analysis of self-renewal in Drosophila neural stem cells by transgenic RNAi</article-title>. <source>Cell Stem Cell</source> <volume>8</volume>: <fpage>580</fpage>–<lpage>593</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Koc1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koc</surname><given-names>EC</given-names></name>, <name name-style="western"><surname>Burkhart</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Blackburn</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Moseley</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Spremulli</surname><given-names>LL</given-names></name> (<year>2001</year>) <article-title>The small subunit of the mammalian mitochondrial ribosome: Identification of the full complement of ribosomal proteins present</article-title>. <source>Journal of Biological Chemistry</source> <volume>276</volume>: <fpage>19363</fpage>–<lpage>19374</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-StroscheinStevenson1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stroschein-Stevenson</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Foley</surname><given-names>E</given-names></name>, <name name-style="western"><surname>O'Farrell</surname><given-names>PH</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>AD</given-names></name> (<year>2006</year>) <article-title>Identification of Drosophila gene products required for phagocytosis of candida albicans</article-title>. <source>PLoS Biology</source> <volume>4</volume>: <fpage>e4</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003227-NG1"><label>52</label>
<mixed-citation publication-type="other" xlink:type="simple">NG A, Jordan M, Weiss Y (2001) On spectral clustering: Analysis and an algorithm. In: Neural Information Processing Systems. MIT Press, pp. 849–856.</mixed-citation>
</ref>
<ref id="pcbi.1003227-Danaher1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Danaher</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Wang</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Witten</surname><given-names>DM</given-names></name> (<year>2013</year>) <article-title>The joint graphical lasso for inverse covariance estimation across multiple classes</article-title>. <source>Journal of the Royal Statistical Society, Series B</source> <comment>[epub ahead of print. doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/rssb.12033" xlink:type="simple"> 10.1111/rssb.12033</ext-link></comment></mixed-citation>
</ref>
</ref-list></back>
</article>