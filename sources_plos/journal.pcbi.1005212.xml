<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00640</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005212</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Gene ontologies</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genome analysis</subject><subj-group><subject>Gene ontologies</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Multivariate analysis</subject><subj-group><subject>Principal component analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Multivariate analysis</subject><subj-group><subject>Principal component analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Random variables</subject><subj-group><subject>Covariance</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Gene mapping</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Gene mapping</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Statistical inference</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Statistical inference</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Order Under Uncertainty: Robust Differential Expression Analysis Using Probabilistic Models for Pseudotime Inference</article-title>
<alt-title alt-title-type="running-head">Probabilistic Models for Pseudotime Inference</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Campbell</surname> <given-names>Kieran R.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7615-8523</contrib-id>
<name name-style="western">
<surname>Yau</surname> <given-names>Christopher</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Physiology, Anatomy and Genetics, University of Oxford, Oxford, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Wellcome Trust Centre for Human Genetics, University of Oxford, Oxford, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Statistics, University of Oxford, Oxford, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Rattray</surname> <given-names>Magnus</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Manchester, UNITED KINGDOM</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"><list-item><p><bold>Conceived and designed the experiments:</bold> KRC CY.</p></list-item> <list-item><p><bold>Performed the experiments:</bold> KRC.</p></list-item> <list-item><p><bold>Analyzed the data:</bold> KRC.</p></list-item> <list-item><p><bold>Contributed reagents/materials/analysis tools:</bold> KRC.</p></list-item> <list-item><p><bold>Wrote the paper:</bold> KRC CY.</p></list-item></list></p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">cyau@well.ox.ac.uk</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>11</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>21</day>
<month>11</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>11</issue>
<elocation-id>e1005212</elocation-id>
<history>
<date date-type="received">
<day>21</day>
<month>4</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>10</month>
<year>2016</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Campbell, Yau</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005212"/>
<abstract>
<p>Single cell gene expression profiling can be used to quantify transcriptional dynamics in temporal processes, such as cell differentiation, using computational methods to label each cell with a ‘pseudotime’ where true time series experimentation is too difficult to perform. However, owing to the high variability in gene expression between individual cells, there is an inherent uncertainty in the precise temporal ordering of the cells. Pre-existing methods for pseudotime estimation have predominantly given point estimates precluding a rigorous analysis of the implications of uncertainty. We use probabilistic modelling techniques to quantify pseudotime uncertainty and propagate this into downstream differential expression analysis. We demonstrate that reliance on a point estimate of pseudotime can lead to inflated false discovery rates and that probabilistic approaches provide greater robustness and measures of the temporal resolution that can be obtained from pseudotime inference.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Understanding the “cellular programming” that controls fundamental, dynamic biological processes is important for determining normal cellular function and potential perturbations that might give rise to physiological disorders. Ideally, investigations would employ time series experiments to periodically measure the properties of each cell. This would allow us to understand the sequence of gene (in)activations that constitute the program being followed. In practice, such experiments can be difficult to perform as cellular activity may be asynchronous with each cell occupying a different phase of the process of interested. Furthermore, the unbiased measurement of all transcripts or proteins requires the cells to be captured and lysed precluding the continued monitoring of that cell. In the absence of the ability to conduct true time series experiments, pseudotime algorithms exploit the asynchronous cellular nature of these systems to mathematically assign a “pseudotime” to each cell based on its molecular profile allowing the cells to be aligned and the sequence of gene activation events retrospectively inferred. Existing approaches predominantly use deterministic methods that ignore the statistical uncertainties associated with the problem. This paper demonstrates that this statistical uncertainty limits the temporal resolution that can be extracted from static snapshots of cell expression profiles and can also detrimentally affect downstream analysis.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>090532/Z/09/Z</award-id>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000265</institution-id>
<institution>Medical Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>MR/L001411/1</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7615-8523</contrib-id>
<name name-style="western">
<surname>Yau</surname> <given-names>Christopher</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100007421</institution-id>
<institution>Li Ka Shing Foundation</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-7615-8523</contrib-id>
<name name-style="western">
<surname>Yau</surname> <given-names>Christopher</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>KRC is supported by a UK Medical Research Council funded doctoral studentship. CY is supported by a UK Medical Research Council New Investigator Research Grant (Ref. No. MR/L001411/1), the Wellcome Trust Core Award Grant Number 090532/Z/09/Z, the John Fell Oxford University Press (OUP) Research Fund and the Li Ka Shing Foundation via a Oxford-Stanford Big Data in Human Health Seed Grant. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="10"/>
<table-count count="0"/>
<page-count count="20"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Our software is available as an R package available at Github: <ext-link ext-link-type="uri" xlink:href="http://www.github.com/kieranrcampbell/pseudogp" xlink:type="simple">http://www.github.com/kieranrcampbell/pseudogp</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>The emergence of high-throughput single cell genomics as a tool for the precision study of biological systems [<xref ref-type="bibr" rid="pcbi.1005212.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1005212.ref004">4</xref>] has given rise to a variety of novel computational and statistical modelling challenges [<xref ref-type="bibr" rid="pcbi.1005212.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1005212.ref006">6</xref>]. One particular area of interest has been the study of transcriptional dynamics in temporal processes, such as cell differentiation or proliferation [<xref ref-type="bibr" rid="pcbi.1005212.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1005212.ref008">8</xref>], in order to understand the coordinated changes in transcription programming that underlie these processes. In the study of such systems, practical experimental designs that can allow the collection of real time series data maybe difficult or impossible to achieve. Instead, investigators have adopted computational methods to identify temporal signatures and trends from unordered genomic profiles of single cells, a process known as <italic>pseudotemporal ordering</italic> [<xref ref-type="bibr" rid="pcbi.1005212.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1005212.ref019">19</xref>]. Computational approaches for this problem were first tackled in the context of gene expression microarray analysis of bulk cell populations [<xref ref-type="bibr" rid="pcbi.1005212.ref020">20</xref>–<xref ref-type="bibr" rid="pcbi.1005212.ref022">22</xref>] but the recent availability of single cell technology overcomes the limitations of measuring population averaged signals in bulk analyses.</p>
<p>Pseudotemporal ordering of whole transcriptome profiles of single cells with unsupervised computational methods has an advantage over flow cytometry-based assays in that it does not rely on <italic>a priori</italic> knowledge of marker genes. The principle underlying these methods is that each single cell RNA sequencing experiment constitutes a time series in which each cell represents a distinct time point along a continuum representing the underlying degree of temporal progress (<xref ref-type="fig" rid="pcbi.1005212.g001">Fig 1A</xref>). During the single cell capture process, the <italic>true</italic> temporal label that identifies the stage of the cell is lost (<xref ref-type="fig" rid="pcbi.1005212.g001">Fig 1B</xref>) and these parameters become latent, unobserved quantities that must be statistically inferred from the collection of single cell expression profiles (<xref ref-type="fig" rid="pcbi.1005212.g001">Fig 1C</xref>). Importantly, absolute physical time information will in general be irretrievably lost and it is only possible to assign a “pseudotime” for each cell that provides a relative quantitative measure of progression. Consequently, whilst the correspondence between physical and pseudotime ordering maybe conserved, the pseudotimes themselves are not necessarily calibrated to actual physical times. Pseudotime estimation can potentially be used to recapitulate temporal resolution in an experiment that does not explicitly capture labelled time series data. The pseudotimes could then be used to identify genes that are differentially expressed across pseudotime (<xref ref-type="fig" rid="pcbi.1005212.g001">Fig 1D</xref>) providing insight into the evolution of transcription programming.</p>
<fig id="pcbi.1005212.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The single cell pseudotime estimation problem.</title>
<p>(A) Single cells at different stages of a temporal process. (B) The temporal labelling information is lost during single cell capture. (C) Statistical pseudotime estimation algorithms attempt to reconstruct the relative temporal ordering of the cells but cannot fully reproduce physical time. (D) The pseudotime estimates can be used to identify genes that are differentially expressed over (pseudo)time.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g001" xlink:type="simple"/>
</fig>
<p>Practically, current methods for pseudotime inference proceed via a multi-step process which we describe throughout using gene expression data as the focus of our discussion. First, gene selection and dimensionality reduction techniques are applied to compress the information held in the high-dimensional gene expression profiles to a small number of dimensions (typically two or three for simplicity of visualisation). The identification of an appropriate dimensionality reduction technique is a <italic>subjective</italic> choice and a number of methods have been adopted such as Principal and Independent Components Analysis (P/ICA) and highly non-linear techniques such as diffusion maps [<xref ref-type="bibr" rid="pcbi.1005212.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1005212.ref023">23</xref>] or stochastic neighbourhood embedding (SNE) [<xref ref-type="bibr" rid="pcbi.1005212.ref024">24</xref>–<xref ref-type="bibr" rid="pcbi.1005212.ref026">26</xref>]. This choice is guided by whether the dimensionality reduction procedure is able to identify a suitable low-dimensional embedding of the data that contains a relatively smooth trajectory that might plausibly correspond to the temporal process under investigation.</p>
<p>Next, the pseudotime trajectory of the cells in this low-dimensional embedding is characterised. In Monocle [<xref ref-type="bibr" rid="pcbi.1005212.ref012">12</xref>] this is achieved by the construction of a minimum spanning tree (MST) joining all cells. The diameter of the MST provides the main trajectory along which pseudotime is measured. Related graph-based techniques (Wanderlust) have also been used to characterise temporal processes from single cell mass cytometry data [<xref ref-type="bibr" rid="pcbi.1005212.ref010">10</xref>]. In SCUBA [<xref ref-type="bibr" rid="pcbi.1005212.ref011">11</xref>] the trajectory itself is directly modelled using principal curves [<xref ref-type="bibr" rid="pcbi.1005212.ref027">27</xref>] and pseudotime is assigned to each cell by projecting its location in the low-dimensional embedding on to the principal curve. The estimated pseudotimes can then be used to order the cells and to assess differential expression of genes across pseudotime. Note that in the diffusion pseudotime framework [<xref ref-type="bibr" rid="pcbi.1005212.ref017">17</xref>], all the diffusion components are used in the random-walk pseudotime model and there is no strict dimensionality reduction step. However, the derivation of the diffusion maps does lead to the compression of information into the first few diffusion components which is what enables successful visualisation [<xref ref-type="bibr" rid="pcbi.1005212.ref023">23</xref>].</p>
<p>A limitation of these approaches is that they provide only a single <italic>point estimate</italic> of pseudotimes concealing the full impact of variability and technical noise. As a consequence, the statistical uncertainty in the pseudotimes is not propagated to downstream analyses precluding a thorough treatment of stability. To date, the impact of this pseudotime uncertainty has not been explored and its implications are unknown as the methods applied typically do not possess a probabilistic interpretation. However, we can examine the stability of the pseudotime estimates by taking multiple random subsets of a dataset and re-estimating the pseudotimes for each subset. For example, we have found that the pseudotime assigned to the same cell can vary considerably across random subsets in Monocle (details given in <xref ref-type="supplementary-material" rid="pcbi.1005212.s001">S1 Text</xref> and <xref ref-type="supplementary-material" rid="pcbi.1005212.s002">S1 Fig</xref>).</p>
<p>In order to address pseudotime uncertainty in a formal and coherent framework, probabilistic approaches using Gaussian Process Latent Variable Models (GPLVM) have been used recently as non-parametric models of pseudotime trajectories [<xref ref-type="bibr" rid="pcbi.1005212.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1005212.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1005212.ref029">29</xref>]. These provide an explicit model of pseudotimes as latent embedded one-dimensional variables. These models can be fitted within a Bayesian statistical framework using priors on the pseudotimes [<xref ref-type="bibr" rid="pcbi.1005212.ref014">14</xref>], deterministic optimisation methods for approximate inference [<xref ref-type="bibr" rid="pcbi.1005212.ref029">29</xref>] or Markov Chain Monte Carlo (MCMC) simulations allowing full posterior uncertainty in the pseudotimes to be determined [<xref ref-type="bibr" rid="pcbi.1005212.ref028">28</xref>]. In this article we adopt this framework based to assess the impact of pseudotime uncertainty on downstream differential analyses. We will show that pseudotime uncertainty can be non-negligible and when propagated to downstream analysis may considerably inflate false discovery rates. We demonstrate that there exists a limit to the degree of recoverable temporal resolution, due to intrinsic variability in the data, with which we can make statements such as “this cell precedes another”. Finally, we propose a simple means of accounting for the different possible choices of reduced dimension data embeddings. We demonstrate that, given sensible choices of low-dimensional representations, these can be combined to produce more robust pseudotime estimates. Overall, we outline a modelling and analytical strategy to produce more stable pseudotime based differential expression analysis.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Statistical model for probabilistic pseudotime</title>
<p>The hierarchical model specification for the Gaussian Process Latent Variable model is described as follows:
<disp-formula id="pcbi.1005212.e001"><alternatives><graphic id="pcbi.1005212.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005212.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mi>γ</mml:mi></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Gamma</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>β</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>λ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Exp</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>γ</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>InvGamma</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>α</mml:mi> <mml:mo>,</mml:mo> <mml:mi>β</mml:mi> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:msub><mml:mtext>TruncNormal</mml:mtext> <mml:mrow><mml:mo>[</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mo mathvariant="bold">Σ</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mtext>diag</mml:mtext> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>P</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>K</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mi>λ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>μ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>GP</mml:mtext> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>K</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>P</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi mathvariant="bold">x</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>MultiNorm</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="bold-italic">μ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mo mathvariant="bold">Σ</mml:mo> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="3.33333pt"/><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <bold>x</bold><sub><italic>i</italic></sub> is the <italic>P</italic>-dimensional input of cell <italic>i</italic> (of <italic>N</italic>) found by performing dimensionality reduction on the entire gene set (for our experiments <italic>P</italic> = 2 following previous studies). The observed data is distributed according to a multivariate normal distribution with mean function <bold><italic>μ</italic></bold> and a diagonal noise covariance matrix <bold>Σ</bold>. The prior over the mean function <bold><italic>μ</italic></bold> in each dimension is given by a Gaussian Process with zero mean and covariance function <italic>K</italic> given by a standard double exponential kernel. The latent pseudotimes <italic>t</italic><sub>1</sub>, …, <italic>t</italic><sub><italic>N</italic></sub> are drawn from a truncated Normal distribution on the range [0, 1). Under this model |<bold><italic>λ</italic></bold>| can be thought of as the arc-length of the pseudotime trajectories, so applying larger levels of shrinkage to it will result in smoother trajectories passing through the point space. This shrinkage is ultimately controlled by the gamma hyperprior on <italic>γ</italic>, whose mean and variance are given by <inline-formula id="pcbi.1005212.e002"><alternatives><graphic id="pcbi.1005212.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005212.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mfrac><mml:msub><mml:mi>γ</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>β</mml:mi></mml:msub></mml:mfrac></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005212.e003"><alternatives><graphic id="pcbi.1005212.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005212.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mfrac><mml:msub><mml:mi>γ</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:msubsup><mml:mi>γ</mml:mi> <mml:mi>β</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:mfrac></mml:math></alternatives></inline-formula> respectively. Therefore, adjusting these parameters allows curves to match prior smoothness expectations provided by plotting marker genes.</p>
<p>The hyperparameters <italic>γ</italic><sub><italic>α</italic></sub>, <italic>γ</italic><sub><italic>β</italic></sub>, <italic>α</italic>, <italic>β</italic>, <italic>μ</italic><sub><italic>t</italic></sub> and <inline-formula id="pcbi.1005212.e004"><alternatives><graphic id="pcbi.1005212.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005212.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msubsup></mml:math></alternatives></inline-formula> are fixed and values for specific experiments for given in <xref ref-type="supplementary-material" rid="pcbi.1005212.s001">S1 Text</xref>. Inference was performed using the Stan probabilistic programming language [<xref ref-type="bibr" rid="pcbi.1005212.ref030">30</xref>] and our implementation is available as an <monospace>R</monospace> package at <ext-link ext-link-type="uri" xlink:href="http://www.github.com/kieranrcampbell/pseudogp" xlink:type="simple">http://www.github.com/kieranrcampbell/pseudogp</ext-link>.</p>
</sec>
<sec id="sec004">
<title>Sigmoidal model for switch-like gene (in)activation behaviours across pseudotime</title>
<p>We detail the mathematical specification of the sigmoidal switch model below. Let <italic>y</italic><sub><italic>ij</italic></sub> denote the log<sub>2</sub> gene expression of gene <italic>i</italic> in cell <italic>j</italic> at pseudotime <italic>t</italic><sub><italic>j</italic></sub> then
<disp-formula id="pcbi.1005212.e005"><alternatives><graphic id="pcbi.1005212.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005212.e005" xlink:type="simple"/><mml:math display="block" id="M5"><mml:mrow><mml:msub><mml:mi>y</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mtext>Norm</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.277778em"/><mml:msubsup><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
where
<disp-formula id="pcbi.1005212.e006"><alternatives><graphic id="pcbi.1005212.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005212.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mrow><mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfenced close="" open="{" separators=""><mml:mtable><mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>gene</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>i</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>not</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>differentially</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>expressed</mml:mtext> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="center"><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn> <mml:msubsup><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mo form="prefix">exp</mml:mo> <mml:mfenced close=")" open="(" separators=""><mml:mo>-</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>t</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mfenced></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>gene</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>i</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>differentially</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>expressed</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mfenced></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula></p>
<p>Under this model the parameter <italic>k</italic><sub><italic>i</italic></sub> can be thought of as an activation ‘strength’ relating to how quickly a gene switches on or off, while <inline-formula id="pcbi.1005212.e007"><alternatives><graphic id="pcbi.1005212.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005212.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:msubsup><mml:mi>t</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> relates to the pseudotime at which the gene switches on or off.</p>
<p>The case of a gene not being differentially expressed is a nested model of the differential expression case found by setting <italic>k</italic> = 0. Consequently we can use a likelihood ratio test with no differential expression as the null hypothesis and differential expression as the alternative and twice the difference in their log-likelihoods will form a <italic>χ</italic><sup>2</sup> test statistic with 2 degrees of freedom. The maximum likelihood estimates of the parameters under the differential expression model have no analytical solution so L-BFGS-B optimisation was used (implemented in the <monospace>R</monospace> package <monospace>switchde</monospace>, <ext-link ext-link-type="uri" xlink:href="http://github.com/kieranrcampbell/switchde" xlink:type="simple">http://github.com/kieranrcampbell/switchde</ext-link>). The dropout model from ZIFA [<xref ref-type="bibr" rid="pcbi.1005212.ref031">31</xref>] can be incorporated into the model and details are given in <xref ref-type="supplementary-material" rid="pcbi.1005212.s001">S1 Text</xref>.</p>
</sec>
</sec>
<sec id="sec005" sec-type="results">
<title>Results</title>
<sec id="sec006">
<title>Probabilistic pseudotime inference using Gaussian Process Latent Variable Models</title>
<p>We first provide a brief overview of the Gaussian Process Latent Variable Model [<xref ref-type="bibr" rid="pcbi.1005212.ref032">32</xref>]. The GPLVM uses a Gaussian Process to define a stochastic mapping between a low-dimensional latent space to a (typically) higher dimensional observation space. A Gaussian Process is characterised by a mean function describing the expected mapping between the latent and observation spaces and a covariance function that describes the covariance between the mapping function evaluated at any two arbitrary latent positions. The covariance function therefore acts to control the second-order statistics of the Gaussian Process and suitable choices can be designed to encourage properties such as smoothness, periodicity or other second-order features.</p>
<p>For this application, the latent space is one-dimensional, describing pseudotime progression whilst the observations are the reduced dimensionality representations of the single cell expression data. We will use Bayesian inference to characterise the joint posterior distribution <italic>p</italic>(<bold>t</bold>|<bold>X</bold>) of the pseudotimes <bold>t</bold> = {<italic>t</italic><sub>1</sub>, …, <italic>t</italic><sub><italic>n</italic></sub>} given the expression data <bold>X</bold> = {x<sub>1</sub>, …, x<sub><italic>n</italic></sub>} for <italic>n</italic> single cells. As the integrals involved are mathematically intractable, we will use Markov Chain Monte Carlo simulations to obtain a numerical approximation to the posterior by drawing samples from the posterior distribution. Each sample corresponds to one possible trajectory <italic>and</italic> ordering for the cells with the set of samples providing an approximate distribution of pseudotimes. The pseudotime values are between measured 0 and 1 where a value of 0 corresponds to one end state of the temporal process and a value 1 to the other. In this work we focus only on non-bifurcating processes. <xref ref-type="fig" rid="pcbi.1005212.g002">Fig 2</xref> gives a diagrammatic representation of our proposed workflow and a more detailed model descriptions is given in Methods.</p>
<fig id="pcbi.1005212.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Workflow for fitting Bayesian Gaussian Process Latent Variable Model pseudotime models.</title>
<p>Reduced-dimension representations of the gene expression data (from Laplacian eigenmaps, PCA or t-SNE) are created. The pseudotime can be fitted using one or more low dimensional representations of the data. Posterior samples of pseudotimes are drawn from a Bayesian GPLVM and these are used to obtain alternative pseudotime estimates. Downstream differential analyses can be performed on the posterior samples to characterise the robustness with respect to variation in pseudotime estimates.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec007">
<title>Sources of uncertainty in pseudotime inference</title>
<p>We applied our probabilistic pseudotime inference to three published single-cell RNA-seq datasets of differentiating cells: myoblasts in Trapnell et al. (2014) [<xref ref-type="bibr" rid="pcbi.1005212.ref012">12</xref>], hippocampal quiescent neural stem cells in Shin et al. (2015) [<xref ref-type="bibr" rid="pcbi.1005212.ref016">16</xref>] and sensory epithelia from the inner ear in Burns et al. (2015) [<xref ref-type="bibr" rid="pcbi.1005212.ref033">33</xref>]. For the Trapnell and Shin datasets we used Laplacian Eigenmaps [<xref ref-type="bibr" rid="pcbi.1005212.ref034">34</xref>] for dimensionality reduction prior to pseudotime inference, while for the Burns dataset we used the PCA representation of the cells from the original publication (for a detailed description of our analysis, see <xref ref-type="supplementary-material" rid="pcbi.1005212.s001">S1 Text</xref>). These particular choices of reduced dimensionality representations gave visually plausible trajectory paths in two dimensions.</p>
<p>An implicit assumption in pseudotime estimation is that proximity in pseudotime should reflect proximity in the observation or data space. That is, two cells with similar pseudotime assignments should have similar gene expression profiles but, in practice, cell-to-cell variability and technical noise means that the location of the cells in the observation space will be variable even if they truly do have the same pseudotime. We plotted posterior mean pseudotime trajectories for the three datasets learned using the GPLVM in <xref ref-type="fig" rid="pcbi.1005212.g003">Fig 3A–3C</xref> and the posterior predictive data distribution <italic>p</italic>(<bold>X</bold>*|<bold>X</bold>). The posterior predictive data distribution gives an indication of where <italic>future</italic> data points might occur given the existing data. Notice that for all three data sets, this distribution can be quite diffuse. This is due to a combination of actual cell-to-cell expression variability, manifesting as a spread of data points around the mean trajectory, but also model misspecification (the difference between what our “assumed” model and the “true” but unknown data generating mechanism).</p>
<fig id="pcbi.1005212.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Posterior pseudotime trajectories for three single-cell RNA-seq datasets.</title>
<p>Posterior pseudotime trajectories shown in a two-dimensional reduced representation space for (left) a Laplacian eigenmaps representation of Trapnell et al. (2014) [<xref ref-type="bibr" rid="pcbi.1005212.ref012">12</xref>], (centre) Laplacian eigenmaps representation of Burns et al. (2015) [<xref ref-type="bibr" rid="pcbi.1005212.ref033">33</xref>] and (right) PCA representation of Shin et al. (2015) [<xref ref-type="bibr" rid="pcbi.1005212.ref016">16</xref>]. Each point represents a cell and the black line represents the mean pseudotime trajectory. Plots <bold>(A-C)</bold> shows the overall posterior predictive data density (red) whilst <bold>(D-F)</bold> shows the conditional posterior predictive data density for <italic>t</italic> = 0.5 (red) and <italic>t</italic> = 0.7 (blue).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g003" xlink:type="simple"/>
</fig>
<p>It is interesting to discuss the latter point as it is an issue that is often not adequately addressed or fully acknowledged in the literature. The GPLVM applied assumes a homoscedastic noise distribution which is uniform along the pseudotime trajectory. However, it is clear that the variability of the data points can change along the trajectory and a heteroscedastic (non-uniform) noise model may be more appropriate in certain scenarios. Unfortunately, whilst models of heteroscedastic noise processes can be applied [<xref ref-type="bibr" rid="pcbi.1005212.ref035">35</xref>], these typically severely complicate the statistical inference and require a model of how the variability changes over pseudotime which is likely to be unknown. The important point here is that the posterior probability calculations are always calibrated with respect to a given model. The better the model represents the true data generating mechanism, the better calibrated the probabilities. Model misspecification can also contribute to posterior uncertainty in inferred parameters.</p>
<p>Returning to the intrinsic cell-to-cell variability, we next considered the conditional posterior predictive data distributions <italic>p</italic>(<bold>X</bold>*|<italic>t</italic>*,<bold>X</bold>) which are shown in <xref ref-type="fig" rid="pcbi.1005212.g003">Fig 3D–3F</xref>. These distributions show the possible distribution of future data points given the existing data <italic>and</italic> a theoretical pseudotime <italic>t</italic>* and, in this example, we condition on pseudotimes <italic>t</italic>* = 0.5 and <italic>t</italic>* = 0.7. Although the two pseudotimes differ by a magnitude of 0.2, the conditional predictive distributions are very close or overlapping. This means that cells with pseudotimes of 0.5 or 0.7 could have given rise to data point occupying these overlapping regions. This variability is what ultimately limits the temporal resolution that can be obtained.</p>
<p>It is important to note that the posterior mean trajectories correspond to certain <italic>a priori</italic> or subjective smoothness assumptions (specified as hyperparameters in the model specification) which dedicate the curvature properties of the trajectory. <xref ref-type="fig" rid="pcbi.1005212.g004">Fig 4</xref> shows three alternative posterior mean pseudotime trajectories for the Trapnell data based on different hyperparameters settings for the GPLVM. In a truly unsupervised scenario all three paths could be plausible as we would have little information to inform us about the true shape of the trajectory. This would become an additional source of uncertainty in the pseudotime estimates. However, we favoured hyperparameter settings that gave rise to well-defined (unimodal) posterior distributions that resulted in multiple independent Markov Chain Monte Carlo runs converging to the same mean trajectory rather than settings that give rise to a “lumpy” posterior distribution with many local modes corresponding to different interpretations of the data (see <xref ref-type="supplementary-material" rid="pcbi.1005212.s003">S2 Fig</xref>). Later on, when we consider inference using multiple representations, the ability to specify a wider choice of trajectories is useful as we will demonstrate how the correspondence between pseudotime trajectories in different reduced dimension representations is not always obvious from a visual analysis.</p>
<fig id="pcbi.1005212.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Effect of prior expectations on pseudotime trajectories.</title>
<p>The prior probability distribution (defined in terms of hyperparameters (<italic>γ</italic><sub><italic>α</italic></sub>, <italic>γ</italic><sub><italic>β</italic></sub>) in our model) on the expected smoothness of pseudotime trajectories can fundamentally change the inferred progression path. Examples shown using the data of Trapnell et al. (2014) [<xref ref-type="bibr" rid="pcbi.1005212.ref012">12</xref>]. Red—shows the density of the posterior predictive data distribution. Black—shows the mean pseudotime trajectory. Shrinkage hyperparameters (<italic>γ</italic><sub><italic>α</italic></sub>, <italic>γ</italic><sub><italic>β</italic></sub>) of (30, 5), (5, 1) and (3, 1) were used for <bold>A</bold>, <bold>B</bold> and <bold>C</bold> respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g004" xlink:type="simple"/>
</fig>
<p>We next examined the posterior distributions in pseudotime assignment for four cells from the Trapnell dataset in <xref ref-type="fig" rid="pcbi.1005212.g005">Fig 5A</xref>. Uncertainty in the estimate of pseudotime is assessed using the highest probability density (HPD) credible interval (CI), the Bayesian equivalent of the confidence interval. The 95% pseudotime CI typically covers around one quarter of the trajectory, suggesting that pseudotemporal orderings of single-cells can potentially only resolve a cell’s place within a trajectory to a coarse estimate (e.g. ‘beginning’, ‘middle’ or ‘end’) and do not necessarily dramatically increase the temporal resolution of the data. One immediate consequence of this is that it is unlikely that we can make definite statements such as whether one cell comes exactly before or after another. This is illustrated in <xref ref-type="fig" rid="pcbi.1005212.g005">Fig 5B–5D</xref> which displays the estimated pseudotime uncertainty for all three datasets. In all the datasets, the general progression is apparent, but the precise ordering of the cells has a non-trivial degree of ambiguity.</p>
<fig id="pcbi.1005212.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Posterior uncertainty in pseudotime trajectories.</title>
<p><bold>(A)</bold> Posterior uncertainty in pseudotimes for four randomly selected cells from the Trapnell et al. (2014) dataset. Horizontal bars represent the 95% highest probability density (HPD) credible interval (CI), which typically covers around a quarter of the pseudotime trajectory. <bold>(B-D)</bold> Boxplots showing the posterior uncertainty for each cell from the Trapnell et al. (2014) datasets. The edges of the boxes and tails correspond to the 75% and 95% HPD-CIs respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Failure to account for pseudotime uncertainty leads to increased false discovery rates</title>
<p>The previous section addressed the sources of statistical uncertainty in the pseudotimes. We next explored the impact of pseudotime uncertainty on downstream analysis. Specifically, we focused on the identification of genes that are differentially expressed across pseudotime. Typically, these analyses involve regression models that assume the input variables (the pseudotimes) are both fixed and certain but, with our probabilistic model, we can use the posterior samples from our Bayesian model to refit the regression model to each pseudotime estimate. In doing so we can examine which genes are called as significant in each of the posterior samples and assess the stability of the differential expression analysis to pseudotime uncertainty by recording how frequently genes are designated as significant across the posterior samples. This allowed us to re-estimate the false discovery rate (FDR) fully accounting for the variability in pseudotime. As there are a multitude of sources of uncertainty on top of this (such as biological and technical variability) this allows us to put a lower bound on the FDR of such analyses in general.</p>
<p>Precisely, we fitted the tobit regression model from [<xref ref-type="bibr" rid="pcbi.1005212.ref012">12</xref>] for each gene for each sample from the posterior pseudotime distribution, giving us a per-gene set of false-discovery-rate-corrected <italic>Q</italic>-values. We then compared the proportion of times a gene is called as differentially expressed (5% FDR) across all pseudotime samples to the <italic>Q</italic>-value using a point pseudotime estimate based on the maximum <italic>a posteriori</italic> (or MAP) estimate. We reasoned that if a gene is truly differentially expressed then such expression will be robust to the underlying uncertainty in the ordering. Note for comparison, our MAP estimates with the GPLVM correlate strongly with Monocle derived pseudotime point estimates (see <xref ref-type="supplementary-material" rid="pcbi.1005212.s004">S3 Fig</xref>).</p>
<p>
<xref ref-type="fig" rid="pcbi.1005212.g006">Fig 6(A) and 6(B)</xref> shows two analyses for two illustrative genes (ITGAE and ID2) in the Trapnell data set. Using the MAP pseudotime estimates, differential expression analysis of ITGAE over pseudotime attained a <italic>q</italic>-value of 0.02. However, the gene was only called significant in only 9% of posterior pseudotime samples with a median <italic>q</italic>-value of 0.32. In contrast, ID1—known to be involved in muscle differentiation—had a <italic>q</italic>-value of 6.6 × 10<sup>−11</sup> using the MAP pseudotime estimate, but was also called significant in all the posterior pseudotime estimates having a median <italic>q</italic>-value of 4.4 × 10<sup>−11</sup>. This indicates that the significance of the temporal expression variability of ID1 is highly robust whilst the significance ITGAE is much more dependent on the exact pseudotemporal ordering chosen.</p>
<fig id="pcbi.1005212.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Approximate FDR for differential expression across pseudotime.</title>
<p><bold>(A)</bold> Gene expression plots across pseudotime, with black traces corresponding to models fitted to pseudotime samples while the red trace corresponds to the point (MAP) estimate for two exemplar genes and <bold>(B)</bold> corresponding gene expression heatmap for 20 randomly sampled posterior pseudotimes. <bold>(C)</bold> The number of genes identified as robust and unstable for all three datasets examined.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g006" xlink:type="simple"/>
</fig>
<p>As a conservative rule of thumb, we designated two sets of putative temporal associations: (i) a <italic>robust</italic> set comprising genes with a <italic>q</italic>-value less than 5% at the MAP estimate of pseudotime but also identified as significant in 95+% of the posterior pseudotime samples and (ii) an <italic>unstable</italic> set of genes whose <italic>q</italic>-values are less than 5% using the MAP estimate of pseudotime but is significant in less than 95% of the posterior pseudotime samples. Looking across all genes in the the three datasets we found that approximately half of the associations in all three datasets were unstable and whose temporal association depended on the choice of pseudotime estimates (<xref ref-type="fig" rid="pcbi.1005212.g006">Fig 6C</xref>).</p>
<p>We performed a Gene Ontology enrichment analysis of the differentially expressed genes using (i) the robust set only, (ii) all DE genes (robust and unstable) and (iii) the unstable set only, using the GOseq package [<xref ref-type="bibr" rid="pcbi.1005212.ref036">36</xref>] with a 5% FDR significance level, enriching for categories corresponding to biological processes (<xref ref-type="fig" rid="pcbi.1005212.g007">Fig 7</xref>). The set of unstable genes give no significant enriched GO categories on their own whilst the robust set gave a similar number of enriched GO categories as using all DE genes despite containing only half the number of genes. In all three datasets, there was a large overlap between the enriched GO categories identified and interestingly a high proportion of GO terms that are only significant from the robust gene set only. This suggests that the inclusion of the unstable gene set, potentially containing nuisance findings, may have reduced power to identify certain GO categories. Overall, our analysis suggests that the robust set of temporally differentially expressed genes identified by taking into account posterior uncertainty is a biologically meaningful gene set and not an arbitrary subset of the set of all DE genes.</p>
<fig id="pcbi.1005212.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Gene Ontology Enrichment Analysis.</title>
<p><bold>(A)</bold> Number of enriched GO categories for the three datasets studied. Genes used for enrichment were either those that exhibit <italic>robust</italic> differential expression, <italic>unstable</italic> differential expression or <italic>all</italic>. <bold>(B-D)</bold> Venn diagrams showing the number of enriched GO terms based on the differential expression categories above.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g007" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>A sigmoidal model of switch-like behaviour across pseudotime</title>
<p>In the previous section, we examined differential expression across pseudotime by fitting generalized additive models to the gene expression profiles [<xref ref-type="bibr" rid="pcbi.1005212.ref012">12</xref>]. Their approach used a Tobit regression model with a cubic smoothing spline link function. Hypothesis testing using the likelihood ratio test is conducted against a null model of no pseudotime dependence. This model provides a highly flexible but non-specific model of pseudotime dependence that was not suited to the next question we wished to address.</p>
<p>Specifically, we were interested in whether we could identify if two genes switched behaviours at the <italic>same</italic> (or similar) times during the temporal process and therefore an estimate of the time resolution that can be gained from a pseudotime estimation approach. This requires estimation of a parameter that can be directly linked to a switch on(/off) time that is not present in the Tobit regression model. As a result, we propose a “sigmoidal” model of differential expression across pseudotime that better captures switch-like gene (in)activation and has easy to interpret parameters corresponding to activation time and strength. By combining such a parametric model with the Bayesian inference of pseudotime we can then infer the resolution to which we can say whether one gene switches on or off before another. Details of the sigmoidal gene activation model are given in Methods and in <xref ref-type="supplementary-material" rid="pcbi.1005212.s001">S1 Text</xref>.</p>
<p>We applied our sigmoidal model to learn patterns of switch-like behaviour of genes in the Trapnell dataset. For each gene we estimated the <italic>activation time</italic> (<italic>t</italic><sub>0</sub>) as well as the <italic>activation strength</italic> (<italic>k</italic>). We fitted these sigmoidal switching models to all posterior pseudotime samples to approximate the posterior distribution for the time and strength parameters. We uncovered a small set of genes whose median activation strength is distinctly larger than the rest and had low variability across posterior pseudotime samples implying a population of genes that exhibit highly switch-like behaviour (<xref ref-type="fig" rid="pcbi.1005212.g008">Fig 8A</xref>). Some genes showed high activation strength for certain pseudotime estimates but low overall median levels across all the posterior samples. We concluded that genes with large credible intervals on the estimates of activation strength do not show robust switch-like behaviour and demonstrate the necessity of using probabilistic methods to infer gene behaviour as opposed to point estimates that might give highly unstable results.</p>
<fig id="pcbi.1005212.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Robust inference of switch-like behaviour in genes across pseudotime.</title>
<p><bold>(A)</bold> The square-root of the median of the activation strength parameter <italic>k</italic> across all pseudotime samples as a function of activation time <italic>t</italic><sub>0</sub>. The error bars show the 95% credible interval, demonstrating that point estimates can severely skew the apparent behaviour of genes and a requirement for a robust Bayesian treatment of gene expression. A distinct population of genes whose median activation strength sits separate from the majority close to the x-axis implies a subset of genes show true switch-like behaviour. <bold>(B)</bold> Representative examples of genes whose median activation strength is large (top row) compared to small (bottom row). Each black point represents the gene expression of the cell with red lines corresponding to posterior traces of the sigmoidal gene expression model. Genes with a large activation strength show a distinct gene expression pattern compared to those with a small activation strength. <bold>(C)</bold> A posterior density plot of the activation time for the five genes showing strong activation strength in (B).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g008" xlink:type="simple"/>
</fig>
<p>Representative examples of genes with large and small activation strengths showed marked differences in the gene expression patterns corresponding to strong and weak switch-like behaviour as expected (<xref ref-type="fig" rid="pcbi.1005212.g008">Fig 8B</xref>). In addition, we examined the posterior density activation time <italic>t</italic><sub>0</sub> for the five genes showing strong switching behaviour (<xref ref-type="fig" rid="pcbi.1005212.g008">Fig 8C</xref>). Under a point estimate of pseudotime each gene would give a distinct activation time with which these genes can be ordered. However, when pseudotime uncertainty is taken into account, a distribution over possible activation times emerges. In this case, the five genes all have activation times between 0.3 and 0.5 precluding a precise ordering (if one exists) of activation. Visually, this seems sensible since there is considerable cell-to-cell variability in the expression of these genes and not all cells express the genes during the “on” phase. We are therefore unable to determine whether the “on” phase begins when the first cell with high expression is first observed in pseudotime or, if it starts before, and the first few cells simply have null expression (for biological or technical reasons).</p>
<p>We further explore this in <xref ref-type="fig" rid="pcbi.1005212.g009">Fig 9</xref> which shows ten genes identified as having significant switch-like pseudotime dependence but with a range of mean activation times <italic>t</italic><sub>0</sub>. The switch-like behaviour is stable to the different posterior pseudotime estimates that were sampled from the GPLVM. It is clear that the two genes RARRES3 and C1S are activating at an earlier time compared to the genes IL20RA and APOL4. However, we cannot be confident of the ordering within the pairs RARRES3/C1S and IL20RA/APOL4 in pseudotime since the distributions over the activation times are not well-separated and it is impossible to make any definitive statements as to whether one of these genes (in)activates before another. If the probability of a sequence of activation events is required, instead of examining each gene in isolation, we can count the number of posterior samples in which one gene precedes another instead and evidence may emerge of a possible ordering. These observations suggests a finite temporal resolution limit that can be obtained using pseudotemporal ordering.</p>
<fig id="pcbi.1005212.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Identifying pseudotime dependent gene activation behaviour.</title>
<p>Ten selected genes from [<xref ref-type="bibr" rid="pcbi.1005212.ref012">12</xref>] found using our sigmoidal gene activation model exhibiting a range of activation times. For each gene, we show the expression levels of each cell (centre) where each row corresponds to an ordering according to a different posterior samples of pseudotime. The orange line corresponds to a point estimate of the activation time. The posterior density of the estimated activation time is also shown (right).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g009" xlink:type="simple"/>
</fig>
<p>We note that we have deliberately avoid directly linking the sigmoidal gene activation and GPLVM pseudotime models to derive a single, joint model. In a joint model, the inference would attempt to order the cells in such a way as to maximise the fit of the sigmoidal and GPLVM to the expression data. However, as the sigmoidal model is only intended to identify genes with switch-like behaviour, it cannot explain other types of pseudotime dependence that may and do exist. This model misspecification would potentially drive inference in ways that cannot be foreseen.</p>
</sec>
<sec id="sec010">
<title>Contribution to pseudotime uncertainty from the reduced dimensional representation</title>
<p>Finally, we address the impact of the dimensionality reduction that is often applied to single cell gene expression data prior to pseudotime estimation. The choice of dimensionality reduction approach is based on whether the method gives rise to a putative pseudotime trajectory in the reduced dimensionality representation. This is typically conducted with visual inspection followed by confirmational analysis by examining known marker genes with established temporal association. This may lead to a number of possibilities since the same trajectory may exist in a number of reduced dimensionality representations.</p>
<p>We sought to characterise the contribution of the dimensionality reduction process to pseudotime uncertainty. The wide variety of dimensionality reduction methods available and in use for pseudotime estimation precludes a complete investigation here and we choose to focus instead on principal components analysis—a standard technique—and used, for example, in Waterfall [<xref ref-type="bibr" rid="pcbi.1005212.ref037">37</xref>] or TSCAN [<xref ref-type="bibr" rid="pcbi.1005212.ref018">18</xref>] or as a preprocessing step used before applying non-linear methods such as t-SNE or GPLVMs.</p>
<p>To do this, we used the differentiating myoblasts data set [<xref ref-type="bibr" rid="pcbi.1005212.ref012">12</xref>] and performed PCA (using the <monospace>R</monospace> package <monospace>scater</monospace> [<xref ref-type="bibr" rid="pcbi.1005212.ref038">38</xref>]). We then applied GPLVM pseudotime estimation to the two-dimensional principal component representation and identified a set of 1,968 robustly differentially expressed genes from the posterior pseudotime samples. Next, we took 50 random subsets containing 80% of the cells and repeated the above procedure on each subset. As the PCA projection depends on the data itself, the reduced dimensional representation derived from each subsample will be different, we wanted to compare the differentially expressed genes identified to those found using the full data to determine if the variation in the reduced dimensionality representation impacts on the downstream differential expression analyses. We examined all genes and PCA subsamples and found that over 90% of differential expression tests showed a robust temporal association (<xref ref-type="fig" rid="pcbi.1005212.g010">Fig 10A</xref>). Over half of all genes were robustly differentially expressed in all PCA subsamples and over 80% in at least 40 out of 50 PCA subsamples (<xref ref-type="fig" rid="pcbi.1005212.g010">Fig 10B</xref>). These results indicate that the vast majority of genes remained robustly differentially expressed despite the differences in the reduced dimensional space across the random subsets (and the potential loss of detection power due to there being fewer cells).</p>
<fig id="pcbi.1005212.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005212.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Pseudotime uncertainty arising from reduced dimensional representation.</title>
<p><bold>(A)</bold> Proportion of all subsampled differential expression tests where the gene was found to be robustly differentially expressed using only those genes robustly differentially expressed when considering all cells. <bold>(B)</bold> Cumulative frequency of cell subsamples in which a given gene is robustly differentially expressed. Over half of all genes were robustly differentially expressed in all PCA subsamples.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.g010" xlink:type="simple"/>
</fig>
<p>Our results may be further explained by the fact that principal components analysis uses a linear, orthogonal transformation that maximises variance in the principal directions. This will give reduced dimensional representations that are likely to be robust in many instances to variable cell inputs given sufficiently large sample sizes. Highly nonlinear techniques, such as t-SNE, Laplacian Eigenmaps or diffusion maps, maybe more sensitive to the input data and the resultant reduced dimensional representations more variable. A thorough characterisation of the relative contribution of the reduced dimensional representation and the curve fitting to the statistical uncertainty in the pseudotime estimates must be determined through simulations (like the ones detailed here) and conclusions may differ for different dimensionality reduction/curve fitting combinations.</p>
</sec>
</sec>
<sec id="sec011" sec-type="conclusions">
<title>Discussion</title>
<p>Pseudotime estimation from gene expression profiling of single cells provides the ability to extract temporal information about complex biological processes from which <italic>true</italic> time series experimentation may be technically challenging or impossible. In our investigations we have sought to characterise the utility of a probabilistic approach to the single cell pseudotime estimation problem over approaches that only return a single point estimate of pseudotime. Our work is significant since it has so far not been possible to assess the impact of this statistical uncertainty in downstream analyses and to ascertain the level of temporal resolution that can be obtained.</p>
<p>In order to address this we adopted a Gaussian Process Latent Variable modelling framework to perform probabilistic pseudotime estimation within a Bayesian inference setting. The GPLVM allows us to probabilistically explore a range of different pseudotime trajectories within the reduced dimensional space. We showed that in a truly unbiased and unsupervised analysis the properties of the pseudotime trajectory will never purely be a product of the data alone and can heavily depend on prior assumptions about the smoothness, length scales of the trajectory and noise properties. Using samples drawn from the posterior distribution over pseudotime estimates under the GPLVM we were able to assess if genes that showed a significant pseudotime dependence under a point (MAP) pseudotime estimate would be robust to different possible pseudotime estimates. In two of the three datasets we examined we discovered that, when adjusted for pseudotime uncertainty, the false discovery rate may be significantly larger than the target 5%. Our investigations show that reliance on a single estimate of pseudotime can lead to increased number of false discoveries but that it is possible to assess the impact of such assumptions within a probabilistic framework.</p>
<p>A caveat of the specific methodology adopted in this study is that it is necessarily computationally intensive due to the use of full Markov chain Monte Carlo based Bayesian inference and is dominated by functions of the Gaussian Process covariance matrix that have complexity <italic>O</italic>(<italic>n</italic><sup>3</sup>) where <italic>n</italic> is the number of cells. Our STAN implementation is able to process 300 cells in around 15 minutes on a standard laptop computer but well-known variational approximations based on inducing point [<xref ref-type="bibr" rid="pcbi.1005212.ref039">39</xref>] and recent stochastic variational algorithms [<xref ref-type="bibr" rid="pcbi.1005212.ref040">40</xref>] can reduce the computational burden and improve scaling to <italic>O</italic>(<italic>n</italic>) &gt; 10<sup>4</sup>. However, this scalability comes at the expense of the reduced ability to fully characterise posterior uncertainty. In this study we have focused purely on best characterising the posterior uncertainty using MCMC algorithms that asymptotically converge to the true posterior distribution. In practice this purest approach may not be necessary but we argue that pseudotime uncertainty should be addressed.</p>
<p>It is important to note that the GPLVM used in our investigations is not intended to be a single, all-encompassing solution for pseudotime modelling problems. For our purposes, it provided a simple and relevant device for tackling the single trajectory pseudotime problem in a probabilistic manner but clearly has limitations when the temporal process under investigation contains bifurcations or heteroscedastic noise processes (as discussed earlier). Improved and/or alternative probabilistic models are required to address more challenging modelling scenarios but the general procedures we describe are generic and should be applicable to any problem where statistical inference for a probabilistic model can give posterior simulation samples.</p>
<p>We also developed a novel sigmoidal gene expression temporal association model that enabled us to identify genes exhibiting a strong switch-like (in)activation behaviour. For these genes we were then able to estimate the activation times and use these to assess the time resolution that can be attained using pseudotime estimates of single cells. Our investigations show that pseudotime uncertainty prevents precise characterisation of the gene activation time but a probabilistic model can provide a distribution over the possibilities. In application, this uncertainty means that it is challenging to make precise statements about when regulatory factors will turn on or off and if they act in unison. This places an upper limit on the accuracy of dynamic gene regulation models and causal relationships between genes that could be built from the single cell expression data.</p>
<p>In conclusion, single cell genomics has provided a precision tool with which to interrogate complex temporal biological processes. However, as widely reported in recent studies, the properties of single cell gene expression data are complex and highly variable. We have shown that the many sources of variability can contribute to significant uncertainty in statistical inference for pseudotemporal ordering problems. We argue therefore that strong statistical foundations are vital and that probabilistic methods for provide a platform for quantifying uncertainty in pseudotemporal ordering which can be used to more robustly identify genes that are differentially expressed over time. Robust statistical procedures can also temper potentially unrealistic expectations about the level of temporal resolution that can be obtained from computationally-based pseudotime estimation. Ultimately, as the raw input data is not true time series data, pseudotime estimation is only ever an attempt to solve a <italic>missing data</italic> statistical inference problem that we should remind ourselves involves quantities (pseudotimes) that are <italic>unknown, never can be known</italic>.</p>
</sec>
<sec id="sec012">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005212.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Supplementary Methods.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005212.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.s002" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Inherent uncertainty from sub-sampling with point-estimation methods.</title>
<p>80% of cells were subsampled from the Laplacian Eigenmaps representation 30 times and the pseudotime refitted using <monospace>Monocle</monospace>’s MST approach. <bold>A</bold> Boxplots of resamples across all cells. Upper and lower whiskers extend to the highest and lowest values within 1.5 times the interquartile range. <bold>B</bold> The 2<italic>σ</italic> interval was then computed for the pseudotime of each cell, which varies from as low as close to 0 up to almost half the pseudotime interval (0.5).</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005212.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.s003" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Stability of trajectories across multiple chains.</title>
<p>GPLVM trajectories were fit on the Trapnell dataset using either a high level of shrinkage in <bold>A</bold> &amp; <bold>C</bold> (<italic>γ</italic><sub><italic>α</italic></sub> = 35, <italic>γ</italic><sub><italic>β</italic></sub> = 5) or using a low level of shrinkage in <bold>B</bold> &amp; <bold>D</bold> (<italic>γ</italic><sub><italic>α</italic></sub> = 3, <italic>γ</italic><sub><italic>β</italic></sub> = 1) for 10 separate MCMC chains. It can be seen that the trajectories consistently fit using high levels of shrinkage, implying this is required to have a well-defined posterior as opposed to a ‘lumpy’ posterior with many local maxima using low levels of shrinkage. <bold>C</bold> &amp; <bold>D</bold> show the posterior densities for a randomly chosen cell (number 100) using the two different shrinkage regimes as defined above.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005212.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005212.s004" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Comparison of MAP pseudotime using GPLVM to orderings using <monospace>Monocle</monospace>.</title>
<p>Left: <monospace>Monocle</monospace> ordering found using ICA on 500 most variable genes. Right: <monospace>Monocle</monospace> orderings found using a Laplacian Eigenmaps embedding as described above. Error bars show the 95% HPD credible interval.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1005212.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kalisky</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Quake</surname> <given-names>SR</given-names></name>. <article-title>Single-cell genomics</article-title>. <source>Nature methods</source>. <year>2011</year>;<volume>8</volume>(<issue>4</issue>):<fpage>311</fpage>–<lpage>314</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth0411-311" xlink:type="simple">10.1038/nmeth0411-311</ext-link></comment> <object-id pub-id-type="pmid">21451520</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shapiro</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Biezuner</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Linnarsson</surname> <given-names>S</given-names></name>. <article-title>Single-cell sequencing-based technologies will revolutionize whole-organism science</article-title>. <source>Nature reviews Genetics</source>. <year>2013</year> <month>Sep</month>;<volume>14</volume>(<issue>9</issue>):<fpage>618</fpage>–<lpage>30</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/23897237" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/23897237</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg3542" xlink:type="simple">10.1038/nrg3542</ext-link></comment> <object-id pub-id-type="pmid">23897237</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macaulay</surname> <given-names>IC</given-names></name>, <name name-style="western"><surname>Voet</surname> <given-names>T</given-names></name>. <article-title>Single cell genomics: advances and future perspectives</article-title>. <source>PLoS genetics</source>. <year>2014</year> <month>Jan</month>;<volume>10</volume>(<issue>1</issue>):<fpage>e1004126</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3907301&amp;tool=pmcentrez&amp;rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3907301&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1004126" xlink:type="simple">10.1371/journal.pgen.1004126</ext-link></comment> <object-id pub-id-type="pmid">24497842</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wills</surname> <given-names>QF</given-names></name>, <name name-style="western"><surname>Mead</surname> <given-names>AJ</given-names></name>. <article-title>Application of Single Cell Genomics in Cancer: Promise and Challenges</article-title>. <source>Human molecular genetics</source>. <year>2015</year>;p. <fpage>ddv235</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/hmg/ddv235" xlink:type="simple">10.1093/hmg/ddv235</ext-link></comment> <object-id pub-id-type="pmid">26113645</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stegle</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Teichmann</surname> <given-names>Sa</given-names></name>, <name name-style="western"><surname>Marioni</surname> <given-names>JC</given-names></name>. <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>. <source>Nature reviews Genetics</source>. <year>2015</year> <month>Jan</month>;<volume>16</volume>(<issue>3</issue>):<fpage>133</fpage>–<lpage>145</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/doifinder/10.1038/nrg3833" xlink:type="simple">http://www.nature.com/doifinder/10.1038/nrg3833</ext-link>. <object-id pub-id-type="pmid">25628217</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>. <article-title>Defining cell types and states with single-cell genomics</article-title>. <source>Genome Res</source>. <year>2015</year> <month>Oct</month>;<volume>25</volume>(<issue>10</issue>):<fpage>1491</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.190595.115" xlink:type="simple">10.1101/gr.190595.115</ext-link></comment> <object-id pub-id-type="pmid">26430159</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Treutlein</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Brownfield</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Wu</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Neff</surname> <given-names>NF</given-names></name>, <name name-style="western"><surname>Mantalas</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Espinoza</surname> <given-names>FH</given-names></name>, <etal>et al</etal>. <article-title>Reconstructing lineage hierarchies of the distal lung epithelium using single-cell RNA-seq</article-title>. <source>Nature</source>. <year>2014</year>;<volume>509</volume>(<issue>7500</issue>):<fpage>371</fpage>–<lpage>375</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature13173" xlink:type="simple">10.1038/nature13173</ext-link></comment> <object-id pub-id-type="pmid">24739965</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tsang</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Burke</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Buettner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Kolodziejczyk</surname> <given-names>AA</given-names></name>, <etal>et al</etal>. <article-title>Single-cell transcriptomic reconstruction reveals cell cycle and multi-lineage differentiation defects in Bcl11a-deficient hematopoietic stem cells</article-title>. <source>Genome biology</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13059-015-0739-5" xlink:type="simple">10.1186/s13059-015-0739-5</ext-link></comment> <object-id pub-id-type="pmid">26387834</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qiu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Simonds</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Gibbs</surname> <given-names>KD</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Bruggner</surname> <given-names>RV</given-names></name>, <name name-style="western"><surname>Linderman</surname> <given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Extracting a cellular hierarchy from high-dimensional cytometry data with SPADE</article-title>. <source>Nature biotechnology</source>. <year>2011</year>;<volume>29</volume>(<issue>10</issue>):<fpage>886</fpage>–<lpage>891</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.1991" xlink:type="simple">10.1038/nbt.1991</ext-link></comment> <object-id pub-id-type="pmid">21964415</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Amir</surname> <given-names>EAD</given-names></name>, <name name-style="western"><surname>Tadmor</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Simonds</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>TJ</given-names></name>, <etal>et al</etal>. <article-title>Single-cell trajectory detection uncovers progression and regulatory coordination in human B cell development</article-title>. <source>Cell</source>. <year>2014</year> <month>Apr</month>;<volume>157</volume>(<issue>3</issue>):<fpage>714</fpage>–<lpage>25</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0092867414004711" xlink:type="simple">http://www.sciencedirect.com/science/article/pii/S0092867414004711</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2014.04.005" xlink:type="simple">10.1016/j.cell.2014.04.005</ext-link></comment> <object-id pub-id-type="pmid">24766814</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marco</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Karp</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Robson</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hart</surname> <given-names>AH</given-names></name>, <name name-style="western"><surname>Trippa</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Bifurcation analysis of single-cell gene expression data reveals epigenetic landscape</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2014</year> <month>Dec</month>;<volume>111</volume>(<issue>52</issue>):<fpage>E5643</fpage>–<lpage>50</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=4284553&amp;tool=pmcentrez&amp;rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=4284553&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1408993111" xlink:type="simple">10.1073/pnas.1408993111</ext-link></comment> <object-id pub-id-type="pmid">25512504</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Trapnell</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cacchiarelli</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Grimsby</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pokharel</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Morse</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The dynamics and regulators of cell fate decisions are revealed by pseudotemporal ordering of single cells</article-title>. <source>Nature biotechnology</source>. <year>2014</year> <month>Apr</month>;<volume>32</volume>(<issue>4</issue>):<fpage>381</fpage>–<lpage>6</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/24658644" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/24658644</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2859" xlink:type="simple">10.1038/nbt.2859</ext-link></comment> <object-id pub-id-type="pmid">24658644</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moignard</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Woodhouse</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Haghverdi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Lilly</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Tanaka</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Wilkinson</surname> <given-names>AC</given-names></name>, <etal>et al</etal>. <article-title>Decoding the regulatory network of early blood development from single-cell gene expression measurements</article-title>. <source>Nature Biotechnology</source>. <year>2015</year> <month>Feb</month>;<volume>33</volume>(<issue>3</issue>). Available from: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/doifinder/10.1038/nbt.3154" xlink:type="simple">http://www.nature.com/doifinder/10.1038/nbt.3154</ext-link>. <object-id pub-id-type="pmid">25664528</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reid</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Wernisch</surname> <given-names>L</given-names></name>. <article-title>Pseudotime estimation: deconfounding single cell time series</article-title>. <source>bioRxiv</source>. <year>2015</year>;p. <fpage>019588</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btw372" xlink:type="simple">10.1093/bioinformatics/btw372</ext-link></comment> <object-id pub-id-type="pmid">27318198</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hanchate</surname> <given-names>NK</given-names></name>, <name name-style="western"><surname>Kondoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Kuang</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ye</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Qiu</surname> <given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Single-cell transcriptomics reveals receptor transformations during olfactory neurogenesis</article-title>. <source>Science</source>. <year>2015</year> <month>Nov</month>;p. science.aad2456–. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.sciencemag.org/content/early/2015/11/04/science.aad2456.full" xlink:type="simple">http://www.sciencemag.org/content/early/2015/11/04/science.aad2456.full</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.aad2456" xlink:type="simple">10.1126/science.aad2456</ext-link></comment> <object-id pub-id-type="pmid">26541607</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Berg</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shin</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bonaguidi</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Single-Cell RNA-Seq with Waterfall Reveals Molecular Cascades underlying Adult Neurogenesis</article-title>. <source>Cell Stem Cell</source>. <year>2015</year> <month>Aug</month>;<volume>17</volume>(<issue>3</issue>):<fpage>360</fpage>–<lpage>372</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.cell.com/article/S1934590915003124/fulltext" xlink:type="simple">http://www.cell.com/article/S1934590915003124/fulltext</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.stem.2015.07.013" xlink:type="simple">10.1016/j.stem.2015.07.013</ext-link></comment> <object-id pub-id-type="pmid">26299571</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Haghverdi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Buettner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Buettner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>. <article-title>Diffusion pseudotime robustly reconstructs lineage branching</article-title>. <source>Nature Methods</source>. <year>2016</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.3971" xlink:type="simple">10.1038/nmeth.3971</ext-link></comment> <object-id pub-id-type="pmid">27571553</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ji</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Ji</surname> <given-names>H</given-names></name>. <article-title>TSCAN: Pseudo-time reconstruction and evaluation in single-cell RNA-seq analysis</article-title>. <source>Nucleic acids research</source>. <year>2016</year>;p. <fpage>gkw430</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkw430" xlink:type="simple">10.1093/nar/gkw430</ext-link></comment> <object-id pub-id-type="pmid">27179027</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Matsumoto</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kiryu</surname> <given-names>H</given-names></name>. <article-title>SCOUP: a probabilistic model based on the Ornstein–Uhlenbeck process to analyze single-cell expression data during differentiation</article-title>. <source>BMC bioinformatics</source>. <year>2016</year>;<volume>17</volume>(<issue>1</issue>):<fpage>1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s12859-016-1109-3" xlink:type="simple">10.1186/s12859-016-1109-3</ext-link></comment> <object-id pub-id-type="pmid">27277014</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Magwene</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Lizardi</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>J</given-names></name>. <article-title>Reconstructing the temporal ordering of biological samples using microarray data</article-title>. <source>Bioinformatics</source>. <year>2003</year>;<volume>19</volume>(<issue>7</issue>):<fpage>842</fpage>–<lpage>850</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btg081" xlink:type="simple">10.1093/bioinformatics/btg081</ext-link></comment> <object-id pub-id-type="pmid">12724294</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gupta</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bar-Joseph</surname> <given-names>Z</given-names></name>. <article-title>Extracting dynamics from static cancer expression data</article-title>. <source>IEEE/ACM transactions on computational biology and bioinformatics / IEEE, ACM</source>. <year>2008</year>;<volume>5</volume>(<issue>2</issue>):<fpage>172</fpage>–<lpage>82</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/18451427" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/18451427</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TCBB.2007.70233" xlink:type="simple">10.1109/TCBB.2007.70233</ext-link></comment> <object-id pub-id-type="pmid">18451427</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qiu</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gentles</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Plevritis</surname> <given-names>SK</given-names></name>. <article-title>Discovering biological progression underlying microarray samples</article-title>. <source>PLoS computational biology</source>. <year>2011</year> <month>Apr</month>;<volume>7</volume>(<issue>4</issue>):<fpage>e1001123</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3077357&amp;tool=pmcentrez&amp;rendertype=abstract" xlink:type="simple">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3077357&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1001123" xlink:type="simple">10.1371/journal.pcbi.1001123</ext-link></comment> <object-id pub-id-type="pmid">21533210</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Haghverdi</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Buettner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Theis</surname> <given-names>FJ</given-names></name>. <article-title>Diffusion maps for high-dimensional single-cell analysis of differentiation data</article-title>. <source>Bioinformatics</source>. <year>2015</year>;(<issue>May</issue>):<fpage>1</fpage>–<lpage>10</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/26002886" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/26002886</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btv325" xlink:type="simple">10.1093/bioinformatics/btv325</ext-link></comment> <object-id pub-id-type="pmid">26002886</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref024">
<label>24</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Hinton</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Roweis</surname> <given-names>ST</given-names></name>. <article-title>Stochastic neighbor embedding</article-title>. In: <source>Advances in neural information processing systems</source>; <year>2002</year>. p. <fpage>833</fpage>–<lpage>840</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005212.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Van der Maaten</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hinton</surname> <given-names>G</given-names></name>. <article-title>Visualizing data using t-SNE</article-title>. <source>Journal of Machine Learning Research</source>. <year>2008</year>;<volume>9</volume>(<issue>2579–2605</issue>):<fpage>85</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005212.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Amir</surname> <given-names>EaD</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Tadmor</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Simonds</surname> <given-names>EF</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Bendall</surname> <given-names>SC</given-names></name>, <etal>et al</etal>. <article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>. <source>Nature biotechnology</source>. <year>2013</year> <month>Jun</month>;<volume>31</volume>(<issue>6</issue>):<fpage>545</fpage>–<lpage>52</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.ncbi.nlm.nih.gov/pubmed/23685480" xlink:type="simple">http://www.ncbi.nlm.nih.gov/pubmed/23685480</ext-link>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2594" xlink:type="simple">10.1038/nbt.2594</ext-link></comment> <object-id pub-id-type="pmid">23685480</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Stuetzle</surname> <given-names>W</given-names></name>. <source>Principal Curves</source>. <year>2012</year> <month>Mar</month>;Available from: <ext-link ext-link-type="uri" xlink:href="http://www.tandfonline.com/doi/abs/10.1080/01621459.1989.10478797" xlink:type="simple">http://www.tandfonline.com/doi/abs/10.1080/01621459.1989.10478797</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005212.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Campbell</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Yau</surname> <given-names>C</given-names></name>. <article-title>Bayesian Gaussian Process Latent Variable Models for pseudotime inference in single-cell RNA-seq data</article-title>. <source>bioRxiv</source>. <year>2015</year>;p. <fpage>026872</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005212.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Macaulay</surname> <given-names>IC</given-names></name>, <name name-style="western"><surname>Svensson</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Labalette</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ferreira</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Hamey</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Voet</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Single-Cell RNA-Sequencing Reveals a Continuous Spectrum of Differentiation in Hematopoietic Cells</article-title>. <source>Cell Reports</source>. <year>2016</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.celrep.2015.12.082" xlink:type="simple">10.1016/j.celrep.2015.12.082</ext-link></comment> <object-id pub-id-type="pmid">26804912</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gelman</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>J</given-names></name>. <article-title>Stan A Probabilistic Programming Language for Bayesian Inference and Optimization</article-title>. <source>Journal of Educational and Behavioral Statistics</source>. <year>2015</year>;p. 1076998615606113. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3102/1076998615606113" xlink:type="simple">10.3102/1076998615606113</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Pierson</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yau</surname> <given-names>C</given-names></name>. <article-title>ZIFA: Dimensionality reduction for zero-inflated single-cell gene expression analysis</article-title>. <source>Genome biology</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/s13059-015-0805-z" xlink:type="simple">10.1186/s13059-015-0805-z</ext-link></comment> <object-id pub-id-type="pmid">26527291</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Titsias</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>N</given-names></name>. <article-title>Bayesian Gaussian Process Latent Variable Model</article-title>. <source>Artificial Intelligence</source>. <year>2010</year>;<volume>9</volume>:<fpage>844</fpage>–<lpage>851</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://eprints.pascal-network.org/archive/00006343/" xlink:type="simple">http://eprints.pascal-network.org/archive/00006343/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005212.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Burns</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Kelly</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Hoa</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Morell</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Kelley</surname> <given-names>MW</given-names></name>. <article-title>Single-cell RNA-Seq resolves cellular complexity in sensory organs from the neonatal inner ear</article-title>. <source>Nature Communications</source>. <year>2015</year>;<volume>6</volume>:<fpage>8557</fpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/doifinder/10.1038/ncomms9557" xlink:type="simple">http://www.nature.com/doifinder/10.1038/ncomms9557</ext-link>. <object-id pub-id-type="pmid">26469390</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Belkin</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Niyogi</surname> <given-names>P</given-names></name>. <source>Laplacian Eigenmaps for Dimensionality Reduction and Data</source>. <year>2003</year>;<volume>1396</volume>:<fpage>1373</fpage>–<lpage>1396</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005212.ref035">
<label>35</label>
<mixed-citation publication-type="other" xlink:type="simple">Le QV, Smola AJ, Canu S. Heteroscedastic Gaussian process regression. In: Proceedings of the 22nd international conference on Machine learning. ACM; 2005. p. 489–496.</mixed-citation>
</ref>
<ref id="pcbi.1005212.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Young</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Wakefield</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Smyth</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Oshlack</surname> <given-names>A</given-names></name>. <article-title>Gene ontology analysis for RNA-seq: accounting for selection bias</article-title>. <source>Genome biology</source>. <year>2010</year>;<volume>11</volume>(<issue>2</issue>):<fpage>1</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2010-11-2-r14" xlink:type="simple">10.1186/gb-2010-11-2-r14</ext-link></comment> <object-id pub-id-type="pmid">20132535</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Berg</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Shin</surname> <given-names>JY</given-names></name>, <name name-style="western"><surname>Song</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bonaguidi</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Single-cell RNA-seq with waterfall reveals molecular cascades underlying adult neurogenesis</article-title>. <source>Cell stem cell</source>. <year>2015</year>;<volume>17</volume>(<issue>3</issue>):<fpage>360</fpage>–<lpage>372</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.stem.2015.07.013" xlink:type="simple">10.1016/j.stem.2015.07.013</ext-link></comment> <object-id pub-id-type="pmid">26299571</object-id></mixed-citation>
</ref>
<ref id="pcbi.1005212.ref038">
<label>38</label>
<mixed-citation publication-type="other" xlink:type="simple">McCarthy D, Wills Q, Campbell K. scater: Single-cell analysis toolkit for gene expression data in R.;. <ext-link ext-link-type="uri" xlink:href="Https://github.com/davismcc/scater" xlink:type="simple">Https://github.com/davismcc/scater</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1005212.ref039">
<label>39</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Titsias</surname> <given-names>MK</given-names></name>. <source>Variational Learning of Inducing Variables in Sparse Gaussian Processes</source>. In: <publisher-name>AISTATS</publisher-name>. <volume>vol. 12</volume>; <year>2009</year>. p. <fpage>567</fpage>–<lpage>574</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1005212.ref040">
<label>40</label>
<mixed-citation publication-type="other" xlink:type="simple">Hensman J, Fusi N, Lawrence ND. Gaussian processes for big data. arXiv preprint arXiv:13096835. 2013;.</mixed-citation>
</ref>
</ref-list>
</back>
</article>