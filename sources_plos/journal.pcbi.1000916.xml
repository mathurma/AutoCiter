<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">10-PLCB-RA-1966R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000916</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology</subject><subject>Computational Biology/Comparative Sequence Analysis</subject><subject>Computational Biology/Transcriptional Regulation</subject><subject>Mathematics/Statistics</subject></subj-group></article-categories><title-group><article-title>High Resolution Models of Transcription Factor-DNA Affinities Improve <italic>In Vitro</italic> and <italic>In Vivo</italic> Binding Predictions</article-title><alt-title alt-title-type="running-head">Modeling Transcription Factor-DNA Affinities</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Agius</surname><given-names>Phaedra</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Arvey</surname><given-names>Aaron</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Chang</surname><given-names>William</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Noble</surname><given-names>William Stafford</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Leslie</surname><given-names>Christina</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Computational Biology Program, Memorial Sloan-Kettering Cancer Center, New York, New York, United States of America</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Genome Sciences, University of Washington, Seattle, Washington, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Ohler</surname><given-names>Uwe</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">Duke University, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">cleslie@cbio.mskcc.org</email></corresp>
<fn fn-type="con"><p>Wrote the paper: PA AA CL. Developed the kernel approach, carried out the computational experiments on the protein binding microarray data sets, assisted with analysis of the ChIP-seq data sets, and helped to supervise students working on the project : PA. Conceived of project and helped to design computational approach, supervised the research: CL. Carried out the computational experiments on the ChIP-seq data sets: AA. Carried out the yeast conservation analysis and helped to test the kernel approach on protein binding microarray data sets: WC. Helped to supervise the research and edit the manuscript: WSN.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>9</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>9</day><month>9</month><year>2010</year></pub-date><volume>6</volume><issue>9</issue><elocation-id>e1000916</elocation-id><history>
<date date-type="received"><day>22</day><month>3</month><year>2010</year></date>
<date date-type="accepted"><day>3</day><month>8</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Agius et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Accurately modeling the DNA sequence preferences of transcription factors (TFs), and using these models to predict <italic>in vivo</italic> genomic binding sites for TFs, are key pieces in deciphering the regulatory code. These efforts have been frustrated by the limited availability and accuracy of TF binding site motifs, usually represented as position-specific scoring matrices (PSSMs), which may match large numbers of sites and produce an unreliable list of target genes. Recently, protein binding microarray (PBM) experiments have emerged as a new source of high resolution data on <italic>in vitro</italic> TF binding specificities. PBM data has been analyzed either by estimating PSSMs or via rank statistics on probe intensities, so that individual sequence patterns are assigned enrichment scores (E-scores). This representation is informative but unwieldy because every TF is assigned a list of thousands of scored sequence patterns. Meanwhile, high-resolution <italic>in vivo</italic> TF occupancy data from ChIP-seq experiments is also increasingly available. We have developed a flexible discriminative framework for learning TF binding preferences from high resolution <italic>in vitro</italic> and <italic>in vivo</italic> data. We first trained support vector regression (SVR) models on PBM data to learn the mapping from probe sequences to binding intensities. We used a novel <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e001" xlink:type="simple"/></inline-formula>-mer based string kernel called the di-mismatch kernel to represent probe sequence similarities. The SVR models are more compact than E-scores, more expressive than PSSMs, and can be readily used to scan genomics regions to predict <italic>in vivo</italic> occupancy. Using a large data set of yeast and mouse TFs, we found that our SVR models can better predict probe intensity than the E-score method or PBM-derived PSSMs. Moreover, by using SVRs to score yeast, mouse, and human genomic regions, we were better able to predict genomic occupancy as measured by ChIP-chip and ChIP-seq experiments. Finally, we found that by training kernel-based models directly on ChIP-seq data, we greatly improved <italic>in vivo</italic> occupancy prediction, and by comparing a TF's <italic>in vitro</italic> and <italic>in vivo</italic> models, we could identify cofactors and disambiguate direct and indirect binding.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Transcription factors (TFs) are proteins that bind sites in the non-coding DNA and regulate the expression of targeted genes. Being able to predict the genome-wide binding locations of TFs is an important step in deciphering gene regulatory networks. Historically, there was very limited experimental data on the DNA-binding preferences of most TFs. Computational biologists used known sites to estimate simple binding site motifs, called position-specific scoring matrices, and scan the genome for additional potential binding locations, but this approach often led to many false positive predictions. Here we introduce a machine learning approach to leverage new high resolution data on the binding preferences of TFs, namely, protein binding microarray (PBM) experiments which measure the <italic>in vitro</italic> binding affinities of TFs with respect to an array of double-stranded DNA probes, and chromatin immunoprecipitation experiments followed by next generation sequencing (ChIP-seq) which measure <italic>in vivo</italic> genome-wide binding of TFs in a given cell type. We show that by training statistical models on high resolution PBM and ChIP-seq data, we can more accurately represent the subtle DNA binding preferences of TFs and predict their genome-wide binding locations. These results will enable advances in the computational analysis of transcriptional regulation in mammalian genomes.</p>
</abstract><funding-group><funding-statement>This work was funded in part by NIH R01 grant GM074257. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Gene regulatory programs are orchestrated by transcription factors (TFs), proteins that coordinate expression of target genes both through direct interaction with DNA and with non-DNA-binding accessory proteins (cofactors). A recent catalog of human and mouse TFs documented almost 900 likely TFs in the human genome, including over 500 with sequence-specific binding to double-stranded DNA <xref ref-type="bibr" rid="pcbi.1000916-Fulton1">[1]</xref>. Accurately modeling the DNA sequence preferences of these TFs, and using these sequence preferences in an appropriate way to predict whether the TF can bind a genomic site <italic>in vivo</italic>, are key pieces in unraveling the regulatory code. For many years, these efforts have been frustrated by the limited availability and quality of TF binding site motifs, usually represented as a position-specific scoring matrix (PSSM) or a consensus sequence. These motifs may match thousands of sites in intergenic regions, producing an unreliable list of potential TF target genes. <xref ref-type="bibr" rid="pcbi.1000916-Harbison1">[2]</xref> showed that motif hits in yeast could be filtered by TF occupancy profiles measured by ChIP-chip experiments, producing a better quality regulatory map. However, TF occupancy is condition-specific and, in metazoan genomes, cell type-dependent, due to differences in chromatin state, concentrations of cofactors, and other epigenetic determinants. Since it is not feasible to collect occupancy data for all TFs and all possible cellular contexts, we must develop better methods for predicting <italic>in vivo</italic> occupancy, which will depend in part on improving our models of TF binding preferences.</p>
<p>Recently, protein binding microarray technology (PBM) has emerged as a new high-throughput technique to obtain more comprehensive data on a TF's <italic>in vitro</italic> sequence specificities <xref ref-type="bibr" rid="pcbi.1000916-Berger1">[3]</xref>. PBM experiments measure binding of a fluorescently tagged TF or TF binding domain to a carefully designed set of double-stranded DNA probes which cover the space of all possible DNA 10-mers.</p>
<p>So far, PBM data has been analyzed by extracting PSSMs or computing rank statistics on probe intensities from the TF binding experiment <xref ref-type="bibr" rid="pcbi.1000916-Berger1">[3]</xref>. Traditional PSSMs may underfit PBM data by failing to capture subtle but detectable sequence preferences. Alternatively, an enrichment score (E-score) can be computed for each short sequence pattern, e.g. all possible 8-mers <xref ref-type="bibr" rid="pcbi.1000916-Berger1">[3]</xref> or longer gapped <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e002" xlink:type="simple"/></inline-formula>-mer patterns. The collection of 8-mers with high E-scores then constitutes a kind of binding profile, with the E-score value giving a ranking of binding preferences. This representation provides much more information about a TF's DNA sequence affinities than a PSSM, but it is quite unwieldy, as each TF is assigned a list of thousands of scored <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e003" xlink:type="simple"/></inline-formula>-mer sequence patterns. Moreover, the E-score approach only implements a rough summarization of the raw probe-level intensity data and, in particular, treats each 8-mer (or longer gapped) pattern independently without attempting to exploit sequence similarities between 8-mers.</p>
<p>In recent years, there have been numerous successful applications of discriminative machine learning techniques to sequence modeling problems in computational biology (reviewed in <xref ref-type="bibr" rid="pcbi.1000916-Noble1">[4]</xref>), including <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e004" xlink:type="simple"/></inline-formula>-mer based string kernel methods that exploit approximate matches of short sequence patterns <xref ref-type="bibr" rid="pcbi.1000916-Leslie1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1000916-Kuang1">[6]</xref>. These studies suggest that a more compact and accurate model of TF binding affinities could be <italic>learned</italic> from PBM data by <italic>training</italic> on probe sequences with a suitable kernel approach. In the first part of our study, we used a supervised learning strategy to obtain more accurate TF binding preference models from <italic>in vitro</italic> PBM probe-level data. As a component of this strategy, we developed a novel string kernel for comparing short double-stranded DNA sequences in a manner that captures similarity of potential TF binding sites. This kernel, called the <italic>di-mismatch kernel</italic>, is a first order Markov mismatch kernel – meaning that it is based on the alphabet of dinucleotides (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>) – and extends the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e005" xlink:type="simple"/></inline-formula>-mer based string kernel methods that we and others have used for a wide range of problems involving modeling of biological sequences. In our approach, we used <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e006" xlink:type="simple"/></inline-formula>-mer based string kernels for representing the similarity of double-stranded probe sequences on the PBM, and we trained support vector regression (SVR) models to directly learn the mapping from probe sequence to binding intensity from PBM training data (<xref ref-type="fig" rid="pcbi-1000916-g001">Figure 1</xref>, top). The trained models can then be used directly to scan intergenic regions, yielding a predicted occupancy profile (<xref ref-type="fig" rid="pcbi-1000916-g001">Figure 1</xref>, bottom).</p>
<fig id="pcbi-1000916-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000916.g001</object-id><label>Figure 1</label><caption>
<title>Supervised learning of TF sequence specificities from protein binding microarrays.</title>
<p>In our approach, we directly learn the mapping from double-stranded DNA probe sequence to intensity in the PBM TF binding experiment by using support vector regression (SVR) together with novel <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e007" xlink:type="simple"/></inline-formula>-mer based string kernels. Probe sequences containing high affinity binding sites have high intensity in the PBM binding experiment; such probes are shown bound by the fluorescently tagged TF (left) and are indicated by green points in the SVR training (right). The SVR predicts probe intensity from probe sequence composition. The trained SVRs can be used to scan intergenic regions to predict <italic>in vivo</italic> TF occupancy.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.g001" xlink:type="simple"/></fig>
<p>To benchmark our approach, we used a large data set of mouse and yeast TFs from three separate studies for which PBM data for two independent probe designs is available. In these cases, we can train SVR models and compute E-scores using data from one PBM probe design and test how well each method predicts the high-intensity probes in the second probe design. We found that our SVR method strongly and consistently outperformed both the E-score and PSSM methods for this <italic>in vitro</italic> binding prediction task. Moreover, by using SVRs to score yeast intergenic regions as well as mouse and human genomic regions, we were better able to predict genomic occupancy as measured by ChIP-chip and ChIP-seq, compared with a previously described occupancy scoring method based on E-scores or PSSM-based prediction.</p>
<p>In the second part of our study, we trained kernel-based SVM models directly on ChIP-seq data, learning to discriminate between ChIP-seq peak and non-peak genomic regions. We call these <italic>in vivo</italic> models, although the ChIP-seq experiments are performed in cell lines, to distinguish them from PBM-trained <italic>in vitro</italic> models. We found that the ChIP-derived SVM models significantly improve TF occupancy prediction in mammalian genomes when compared to PBM-derived SVR models. Moreover, our SVM approach outperforms existing PSSM approaches such as Weeder and MDscan <xref ref-type="bibr" rid="pcbi.1000916-Pavesi1">[7]</xref>, <xref ref-type="bibr" rid="pcbi.1000916-Liu1">[8]</xref>. Finally, we performed a feature analysis to extract <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e008" xlink:type="simple"/></inline-formula>-mers contained in both the <italic>in vitro</italic> and <italic>in vivo</italic> models. In the latter case, we were able to identify binding information about cofactors and disambiguate direct and indirect binding. These results suggest a strategy for combining discriminatively trained models from <italic>in vitro</italic> and <italic>in vivo</italic> data in order to decipher the transcriptional regulatory code.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>SVRs with di-mismatch kernel methods learn <italic>in vitro</italic> TF sequence preferences</title>
<p>A PBM experiment provides high resolution data on the binding affinities of a TF, comprising <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e009" xlink:type="simple"/></inline-formula>44K double stranded DNA probes and corresponding measured probe intensities, which quantify the TF binding affinities for the probe sequences. The unique sequence in each probe is a 36-mer, and the probe set is mathematically specified to contain all possible 10-mers as subsequences. We used the probe data as labeled training examples, i.e. pairs <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e010" xlink:type="simple"/></inline-formula>, for learning a function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e011" xlink:type="simple"/></inline-formula> that predicts binding intensity from (36-mer) sequences. Since we were not only interested in learning to distinguish between bound and unbound probes but also predicting the range of binding affinities, we used support vector regression (SVR) to train our models.</p>
<p>To compare pairs of probe sequences for SVR training, we developed a novel string kernel called the di-mismatch kernel, which is a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e012" xlink:type="simple"/></inline-formula>-mer based string kernel adapted to the problem of TF binding models (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). Briefly, this kernel computes a similarity between probe sequences based on inexact matches to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e013" xlink:type="simple"/></inline-formula>-mer features, allowing up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e014" xlink:type="simple"/></inline-formula> mismatches, where we count mismatches in the alphabet of dinucleotides. This choice reduces the size of the “mismatch neighborhood” of a given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e015" xlink:type="simple"/></inline-formula>-mer (i.e. fewer <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e016" xlink:type="simple"/></inline-formula>-mers are similar to it) and favors mismatches that occur consecutively. A typical parameter choice is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e017" xlink:type="simple"/></inline-formula>, i.e., considering 13-mer sequences, allowing up to 5 mismatches, and operating in the first order alphabet of dinucleotides.</p>
</sec><sec id="s2b">
<title>Trained SVRs yield more accurate <italic>in vitro</italic> TF binding models</title>
<p>We first tested the performance of our SVR models on <italic>in vitro</italic> binding preferences, in order to establish that they could better capture TF sequence specificities than existing approaches. For 33 yeast and 114 mouse TFs, experimental data for two independent PBM array designs were available <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1000916-Badis1">[10]</xref>, measuring TF binding against two completely disjoint PBM probe sets. This combined data set provided a perfect cross-validation setting where we trained a model using data from one array design (“training PBM”) and then tested the model's ability to predict binding preferences on the other array design's probe sequences (“test PBM”). We benchmarked the SVR models against the E-score approach <xref ref-type="bibr" rid="pcbi.1000916-Berger1">[3]</xref>, using the E-scores for all 8-mer patterns, both contiguous and gappy, as computed and posted on the Uniprobe database <xref ref-type="bibr" rid="pcbi.1000916-Newburger1">[11]</xref>. E-scores are modified Wilcoxon rank statistics that assess the enrichment of a given 8-mer sequence pattern in probe sequences at the top of the intensity ranking in a PBM experiment. These scores range from −0.5 to 0.5, where scores approaching 0.5 indicate that the 8-mer pattern is mostly present in bound probe sequences. In their yeast <italic>in vivo</italic> predictions, <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref> identify high scoring 8-mer patterns to predict TF binding preferences. Therefore, we compared SVR performance to a maximum E-score approach, where each probe sequence in the test PBM is assigned the maximal E-score over the 8-mer patterns it contains, and the E-scores are computed on the training PBM. We call this the E-max score. We note that due to feature selection, our models contain no more than 4,000 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e018" xlink:type="simple"/></inline-formula>-mer features. By contrast, for the data set 114 mouse TFs, the average number of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e019" xlink:type="simple"/></inline-formula>-mers with E-scores above 0.35 (the threshold used for reporting the pattern) was 13,300, with just 10<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e020" xlink:type="simple"/></inline-formula> of the TFs having fewer than 3,000 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e021" xlink:type="simple"/></inline-formula>-mers and 64<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e022" xlink:type="simple"/></inline-formula> having more than 10,000 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e023" xlink:type="simple"/></inline-formula>-mers. In this sense, the SVR models are more compact than the E-score approach.</p>
<p>Because we want the models to predict the most preferred binding sequences, we first validated the results by counting how many of the top 100 predicted probes are in the top 100 highest intensity probes in the test data. Naturally, these scores range from 0 to 100, with 100 indicating perfect detection of the preferred test probes by the top predictions; we refer to these validation scores as “the detection of the top 100 probes”. For each method and each TF, we averaged the detection rates over the two PBM designs to get one representative score for the TF.</p>
<p>To ensure that our model was not specifically tuned to the PBM array data published in the Bulyk lab, we tested our model on another set of yeast PBM arrays published by <xref ref-type="bibr" rid="pcbi.1000916-Badis2">[12]</xref>. Although the PBM array design is intrinsically the same, the probe sequences are different. Two array designs were used to run experiments on 37 yeast TFs and, as before, we perform a cross-validation experiment and compare to the E-max performance by using the published E-scores for this data set. In <xref ref-type="fig" rid="pcbi-1000916-g002">Figure 2 (a)</xref>, we show a scatter plot for the three datasets, contrasting SVR to the E-max scores for yeast and mouse PBM data. When a point lies above the diagonal line, the SVR model is better at detecting the top 100 than the E-max approach; we observe that over 80<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e024" xlink:type="simple"/></inline-formula> of the points lie above the diagonal (149 out of 184 TFs). This performance advantage is not achieved with standard string kernels as the spectrum and regular mismatch kernels. When we tested the mismatch kernel with parameters that intuitively seemed suitable – <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e025" xlink:type="simple"/></inline-formula> – we found little improvement over E-max and much weaker performance than the di-mismatch kernel (see Figure S4 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>).</p>
<fig id="pcbi-1000916-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000916.g002</object-id><label>Figure 2</label><caption>
<title>SVR models improve over E-scores and PSSMs for <italic>in vitro</italic> binding prediction.</title>
<p>(a) The scatter plot shows the detection of the top 100 probes using maximum E-scores (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e026" xlink:type="simple"/></inline-formula>-axis) and the SVR model (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e027" xlink:type="simple"/></inline-formula>-axis) in the prediction of <italic>in vitro</italic> TF binding preferences. Each point corresponds to one TF. The figure contains 37 yeast TFs from <xref ref-type="bibr" rid="pcbi.1000916-Badis2">[12]</xref>, 33 yeast TFs from <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref> (blue), and 114 mouse TFs from <xref ref-type="bibr" rid="pcbi.1000916-Badis1">[10]</xref> (red). (b) This panel is similar to panel (a), but compares the SVR versus PBM-derived PSSMs for the 114 mouse TFs.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.g002" xlink:type="simple"/></fig>
<p>To compare our discriminative model against a standard PSSM motif approach, we also tested the performance of PBM-derived PSSMs for the mouse TF data set <xref ref-type="bibr" rid="pcbi.1000916-Badis1">[10]</xref>. PSSMs for these TFs, derived from PBM probe intensity data using the Seed-and-Wobble algorithm <xref ref-type="bibr" rid="pcbi.1000916-Berger1">[3]</xref>, are available through the Uniprobe database. However, for the Uniprobe motifs, data from both PBM array designs for a TF have been combined to estimate a single PSSM. For a fair comparison in our cross-validation setting, we therefore re-ran the Seed-and-Wobble algorithm on each PBM experiment separately, using parameters similar to those adopted for the published motifs: we used patterns of 8-mers (allowing two gaps) in Seed-and-Wobble and then “trimmed” the resulting PSSM to maximize similarity (as measured by KL divergence) to the published PSSM. Then we used the PSSM derived from the first array design to test on probe sequences from the second array design, and vice versa. We found that SVR strongly outperforms PSSMs (<xref ref-type="fig" rid="pcbi-1000916-g002">Figure 2 (b)</xref> with wins on 81% of the TFs, while E-max essentially ties the PSSM performance (E-max wins on 52% of TFs, Figure S1 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>), suggesting that E-max and PSSM approaches are similar and correlated. We note that since the Seed-and-Wobble method uses on E-scores to derive PSSMs, this correlation is perhaps expected.</p>
<p>We note that other algorithms for extracting PSSMs from PBMs have also been proposed, including RankMotif++ <xref ref-type="bibr" rid="pcbi.1000916-Chen1">[13]</xref> (see Figure S3 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>), which was shown to outperform Seed-and-Wobble on a set of five TFs in a similar assessment using cross-validation over probe designs. However, even in this assessment, RankMotif++ did not outperform an 8-mer based method similar to E-max. More precisely, instead of using E-scores, 8-mers were scored by their median training probe intensity or “Z-score”, and test probe sequences were scored by the maximal median intensity over 8-mers, which we can call the “Z-max” approach. For completeness, we did a complete benchmarking of the E-max and Z-max methods and found no significant difference in their performance (Figure S2 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>). Moreover, we found no significant difference in performance between RankMotif and Seed-and-Wobble, while we found that SVR models significantly outperformed RankMotif (Figure S3 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>). Therefore, the main conclusion of the previous RankMotif study – namely, that a PSSM method can be competitive with a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e028" xlink:type="simple"/></inline-formula>-mer scoring derived from simple statistics on the probe intensity data – is consistent with our findings. However, we additionally find that supervised discriminative models with SVRs strongly outperform both PSSMs and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e029" xlink:type="simple"/></inline-formula>-mer scoring for the task of predicting <italic>in vitro</italic> TF binding preferences.</p>
</sec><sec id="s2c">
<title>SVR models improve <italic>in vivo</italic> occupancy prediction in yeast</title>
<p>Next we used the SVR models trained on <italic>in vitro</italic> PBM data to predict <italic>in vivo</italic> occupancy, as measured by chromatin immunoprecipation followed by microarray (ChIP-chip) experiments.</p>
<p>There are 68 yeast TFs for which PBM data and ChIP-chip data are both available. For each TF, we first computed SVR binding profiles along 6724 intergenic regions (IGRs), each 200–2000 nucleotides in length, using a sliding 36-mer window for scoring. <xref ref-type="fig" rid="pcbi-1000916-g003">Figure 3(a,b)</xref> shows predicted binding profiles for two yeast TFs, Ume6 and Gal4, along IGRs that they occupy <italic>in vivo</italic> using different methods: log-odds scores for PBM-derived PSSMs (gold), maximal E-score over a fixed threshold of 0.35 (blue); E-score based occupancy (black), corresponding to the median probe intensity of PBM probes containing the highest-scoring 8-mer pattern <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref>; and SVR scores (green). For Ume6, all methods detect this IGR among the top 200 predictions and seem to agree on the location of the highest and second highest peak. For Gal4, the SVR profile and the noisier E-score profiles seem to locate a different binding peak than the PBM-derived PSSM, and only the SVR method detects this IGR among the top 200 predictions. While the ChIP-chip data cannot identify the true location(s) of the binding sites, we do find increasing enrichment for conservation with increasing SVR score (Figure S5 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>), with even moderate scoring peaks showing enrichment for conservation relative to background.</p>
<fig id="pcbi-1000916-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000916.g003</object-id><label>Figure 3</label><caption>
<title>SVRs improve <italic>in vivo</italic> occupancy prediction in yeast.</title>
<p>Predicted binding profiles for (a) yeast TF Ume6 along IGR iYFL022C and (b) yeast TF Gal4 along IGR iYFR026C using log-odds ratios for the PBM-derived PSSM motif (gold); max E-score, considering only 8-mer patterns satisfying a minimal E-score threshold of 0.35 (blue); E-score based occupancy, plotting median probe intensity for 8-mer patterns with maximal E-score (black); and SVR prediction scores (green). (c) Scatter plots showing occupancy score predictions (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e030" xlink:type="simple"/></inline-formula>-axis) versus SVR (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e031" xlink:type="simple"/></inline-formula>-axis) for yeast <italic>in vivo</italic> binding preferences as measured by detection of the top 200 IGRs by the top 200 predictions.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.g003" xlink:type="simple"/></fig>
<p>We then compared the performance of SVR models with previously published results based on the E-score occupancy method of <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref>. Following the previous analysis, when TF occupancy data is available for more than one condition, we aggregated the data by assigning each IGR the minimal ChIP-chip <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e032" xlink:type="simple"/></inline-formula>-value over conditions (with Bonferroni correction) to obtain as comprehensive a list of true positive IGRs as possible. While <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref> used an ROC analysis relative to a fixed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e033" xlink:type="simple"/></inline-formula>-value cut-off of 0.001, we found that AUCs for TFs with very few true positive IGRs were not informative for either method. We instead computed the detection of the top 200 IGRs by the top 200 predictions, where the top 200 “bound” IGRs were determined by their <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e034" xlink:type="simple"/></inline-formula>-value ranking. For the SVR method, we ranked IGRs by the height of their max peak, while for the E-score occupancy method, we used the scores provided by the authors. <xref ref-type="fig" rid="pcbi-1000916-g003">Figure 3(c)</xref> shows a scatter plot of the detection of the top 200 IGRs by SVR and E-score occupancy.</p>
<p>Since chromatin state and interactions with other DNA-binding factors influence <italic>in vivo</italic> occupancy, we do not expect a TF's sequence signal alone to perfectly correlate with the occupancy data. In fact, similar to the results reported by <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref>, prediction of <italic>in vivo</italic> occupancy is weak to very poor (fewer than 40 of the top 200 IGRs detected) by both methods for most TFs. However, for the TFs with the best results by the E-score occupancy method (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e035" xlink:type="simple"/></inline-formula>40 top IGRs detected), the SVR method outperforms the previous occupancy score method in 8 out of 9 cases, sometimes to a large degree. <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref> performed extensive motif analysis to give evidence that indirect binding may account for a part of the TF occupancy signal in yeast. We too hypothesized that interpreting TF occupancy is confounded by indirect or competitive binding. We performed a detailed analysis of potential interactions between TFs and cooperative or competing partners (see Figure S6 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>), and we found for 26 out of the 68 yeast TFs, the TF's <italic>in vivo</italic> occupancy is well predicted by the SVR model of a second potential “partner” TF (Figure S6 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>).</p>
<p>As we did for the <italic>in vitro</italic> cross-validation experiments, we also benchmarked SVR and E-score occupancy against PBM-derived PSSMs from <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref>, where we scanned PSSMs across IGR sequences and scored each IGR by its maximum log odds score. Again, we evaluated performance by counting the detection of the top 200 IGRs based in the top 200 predictions, and we found that for the 9 well-predicted TFs, the SVR model outperforms PSSMs (6 wins, 1 ties, 2 losses) while the E-score occupancy performs worse than PSSMs for 5 of these 9 TFs (Figure S7 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>).</p>
</sec><sec id="s2d">
<title>SVR models improve genomic occupancy prediction in mammalian genomes</title>
<p>We next evaluated the performance of PBM-derived SVR models for the prediction of TF occupancy in mouse and human genomes. We examined seven ChIP-seq experiments conducted in three different cell types: Oct4, Sox2, Klf4, and Esrrb in E14 mouse ES cells <xref ref-type="bibr" rid="pcbi.1000916-Chen2">[14]</xref>; Srf and Gabpa in GM12878 cells (human EBV-transformed B-lymphocytes) <xref ref-type="bibr" rid="pcbi.1000916-ENCODE1">[15]</xref>; and Hnf4a in HepG2 cells <xref ref-type="bibr" rid="pcbi.1000916-Wallerman1">[16]</xref>. For TFs whose binding domain is not present in the UniPROBE PBM database, we used the most similar binding domain(s) with available PBM data: Pou2f3 and Pou2f1 substituting for Oct4; Sox12 and Sox21 for Sox2; Klf7 for Klf4; and Esrra for Esrrb. Both Pou2f3 and Pou2f1 differ from Oct4 by just one residue in their DNA-contact residues, based on homeodomain-DNA contacts determined from the 3D structure for Engrailed <xref ref-type="bibr" rid="pcbi.1000916-Fraenkel1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1000916-Kissinger1">[18]</xref>. Sox2 best aligns with Sox21, but we include Sox12 as well to assess the variability of PBM-derived models for TF domains that are thought to bind similar motifs.</p>
<p>We computed the SVR models by carefully selecting the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e036" xlink:type="simple"/></inline-formula> using cross-validation experiments on PBM array data (see <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>). For our test data, we selected a set of 1000 confident ChIP-seq peak regions and 1000 “negative” regions selected from flanking sequences. More specifically, we extracted 60bp regions centered around the peaks (positive examples) and 60bp regions 300bp away from the peaks (negative examples). Model performance was measured by the area under the ROC curve (AUC), using the maximum SVR prediction score (over 36-mer windows) to rank the ChIP-seq 60-mers. We compared our SVR models to the occupancy score derived from E-scores <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref>. We also compared to PSSMs extracted from PBM data with the Seed-and-Wobble algorithm <xref ref-type="bibr" rid="pcbi.1000916-Berger1">[3]</xref>, <xref ref-type="bibr" rid="pcbi.1000916-Badis1">[10]</xref>, which are available for download from UniPROBE <xref ref-type="bibr" rid="pcbi.1000916-Newburger1">[11]</xref>.</p>
<p><xref ref-type="fig" rid="pcbi-1000916-g004">Figure 4(a)</xref> shows AUC results for all three methods; here, in cases where UniPROBE reports both primary and secondary PSSMs, we show results for the primary motif. We found that SVR outperforms both the PSSM and occupancy score methods in 7 out of 9 cases, where we report results for models trained on two different PBM experiments to predict Oct4 and Sox2 occupancy. There were two TFs, Sox21 and Hnf4a, for which the secondary PSSM outperformed the primary PSSM. However, in each case, the improved AUC (0.75 and 0.70, respectively) was still worse than the performance of the PBM-derived SVR.</p>
<fig id="pcbi-1000916-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000916.g004</object-id><label>Figure 4</label><caption>
<title>Predicting TF occupancy in mouse and human genomes as evaluated on ChIP-seq data.</title>
<p>(a) SVRs trained on PBM arrays are able to capture ChIP-seq peaks better than PSSMs or the occupancy score. (b) SVMs trained on ChIP-seq data capture sequence information from the genomic context of ChIP-seq peaks and improve <italic>in vivo</italic> prediction performance.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.g004" xlink:type="simple"/></fig>
<p>We report two SVR results for Hnf4a, one using the mouse PBM array data present in the UniPROBE database (<xref ref-type="fig" rid="pcbi-1000916-g004">Figure 4(a)</xref>, Hnf4a, leftmost bar), the other using a novel PBM array design developed specifically for human Hnf4a and using the purified full-length protein instead of the DNA-binding domain in the PBM experiment <xref ref-type="bibr" rid="pcbi.1000916-Bolotin1">[19]</xref>. In the latter dataset, short probe sequences were designed based on known motifs for Hnf4a (see Figure S8 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref> for contrasting binding profiles of the standard versus custom PBM array). <xref ref-type="bibr" rid="pcbi.1000916-Bolotin1">[19]</xref> published two such PBM array designs and, by combining data from the two arrays and modifying our algorithm to accommodate the 13-mers that comprise this PBM data, we were able to train an SVR model that gave the best predictions of Hnf4a <italic>in vivo</italic> binding (<xref ref-type="fig" rid="pcbi-1000916-g004">Figure 4(a)</xref>, Hnf4a, rightmost bar).</p>
</sec><sec id="s2e">
<title>Training discriminative models directly on ChIP-seq data improves occupancy prediction</title>
<p>Since PBM arrays are limited to capturing the <italic>in vitro</italic> binding preferences of transcription factor domains, we hypothesized that additional sequence signals may be present in ChIP-seq data and enable improved prediction performance. We therefore trained support vector machines (SVMs) using the standard <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e037" xlink:type="simple"/></inline-formula> parameters on 60-mer ChIP-seq peaks (positive sequences) and flanking negative sequences. This training procedure potentially allows the SVM to capture sequence information for both the chromatin immunoprecipitated TF and its <italic>cis</italic> cofactors. We evaluated performance by computing AUCs on the same test sets of 1000 ChIP-seq peaks and 1000 flanking negative sequences using 10-fold cross-validation.</p>
<p>For a method comparison, we used two popular motif discovery algorithms, Weeder <xref ref-type="bibr" rid="pcbi.1000916-Pavesi1">[7]</xref> and MDscan <xref ref-type="bibr" rid="pcbi.1000916-Liu1">[8]</xref>, which determine overrepresented <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e038" xlink:type="simple"/></inline-formula>-mer and PSSM motifs, respectively. Again, we tested these methods using 10-fold cross-validation and evaluating AUCs on held-out folds.</p>
<p>Weeder performs an exhaustive search for the most overrepresented <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e039" xlink:type="simple"/></inline-formula>-mer patterns for a given specified size <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e040" xlink:type="simple"/></inline-formula>. We used the algorithm to find the top 50 enriched motifs in the training data, allowing up to one mismatch. To make predictions, we counted the occurrences of these motifs in the test sequences, again allowing up to one mismatch, and used this count to rank the test sequences. We tested <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e041" xlink:type="simple"/></inline-formula>-mer lengths 6, 8 and 10, and reported results for the best performing model. MDscan identifies overrepresented motifs by iteratively constructing PSSMs and using binding site flanking regions to define a Markov chain background model. We applied the highest scoring PSSM as found by MDscan to the test sequences, using a zero order Markov model based on nucleotide frequencies in the human genome as the background model. (We did not use a first order Markov background model since we found it slightly decreased PSSM performance for all but one TF.) We experimented with motif lengths of 8, 10 12, 14 and 16 and reported the best results.</p>
<p><xref ref-type="fig" rid="pcbi-1000916-g004">Figure 4(b)</xref> shows results for ChIP-derived SVM models and the motif discovery approaches for the occupancy prediction task. We first note that for 4 out of 6 TFs, the ChIP-derived SVM model significantly outperforms the corresponding PBM-derived SVR model(s). The exceptions are Essrb and Gabpa, where there is little difference in performance between the <italic>in vitro</italic> and <italic>in vivo</italic> models. Furthermore, although Weeder and MDscan yielded predictions with AUCs above 0.65 for all 7 TFs, the SVM model outperformed both methods in every case that we considered (<xref ref-type="fig" rid="pcbi-1000916-g004">Figure 4(b)</xref>), sometimes by more than 0.1 in the AUC score. It is also worth noting that while Weeder and MDscan required parameter tuning, the SVM model parameters were kept fixed. As a final method comparison, we also tested a newer motif discovery algorithm called cERMIT <xref ref-type="bibr" rid="pcbi.1000916-Georgiev1">[20]</xref> on these data sets, and we again found that the SVM models outperformed the best-performing PSSM returned by cERMIT (Figure S11 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>).</p>
<p>We caution that our sample set of TFs is small: although we did a thorough search for all available ChIP-seq data sets, we found only a small number of TFs with both PBM and ChIP-seq data; moreover, in some cases, the TF domain represented in the PBM experiment is slightly different than in the TF ChIP-seq experiment. It will therefore be important to repeat these experiments on a wider range of TFs once suitable data becomes available.</p>
<p>Finally, we evaluated whether there was any advantage to training regression models on ChIP-seq peaks labeled with real-valued occupancy rather that binary classifiers to discriminate between peaks/non-peaks. We found that SVR models trained with real-valued labels gave slightly worse performance in our AUC analysis as compared to SVM models (see Figure S11 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>). We hypothesize that either (i) the currently available ChIP-seq derived occupancy scores are not yet quantitative enough to use to train a regression model or (ii) the best predictor of peak height/occupancy score is not the sequence signal itself but chromatin state (accessibility of the DNA, nucleosome positioning, histone modifications).</p>
</sec><sec id="s2f">
<title>PBM experiments may capture alternate motifs that are not preferred <italic>in vivo</italic></title>
<p>To understand the differences between <italic>in vitro</italic> and <italic>in vivo</italic> TF binding models, we developed an approach to examine the sequence information extracted by the SVR/SVM models. It is of course possible to simply examine the top-weighted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e042" xlink:type="simple"/></inline-formula>-mers in the SVR/SVM weight vectors; for example, the 13-mers with highest positive weights in the PBM-derived SVR models often contain subsequences that resemble the Seed-and-Wobble motifs derived from the same data (Tables S2 and S3 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>). We sought instead to visualize the full <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e043" xlink:type="simple"/></inline-formula>-mer content of the model. We first looked at the <italic>in vitro</italic> models for Oct4, since the PBM-derived PSSMs for the two selected “nearest neighbor” Pou domains had very different performance, and we wanted to understand the source of the instability.</p>
<p>We used a feature analysis procedure to look inside the “black box” of the PBM-derived SVR model for Pou2f3, the neighbor of Oct4 with the better performing PSSM. The solution of the SVR optimization problem determines a weight vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e044" xlink:type="simple"/></inline-formula> over the space of 13-mer sequence features; 13-mers with high weights contribute the most to high binding prediction scores. The basic idea is to represent the similarity of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e045" xlink:type="simple"/></inline-formula>-mer features based on their support across the training data and also visually represent the weight of the features in the SVR/SVM model. In this way, we avoid doing too much <italic>post hoc</italic> summarization of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e046" xlink:type="simple"/></inline-formula>-mers, and instead we represent the features more as they are used and contribute to the model.</p>
<p>To obtain a similarity measure between these features, we represented each 13-mer by the vector of its alignment scores to the training sequences (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>). Intuitively, 13-mers that are close in Hamming distance will be represented by nearby vectors in this representation. After clustering 13-mer features based on this vector representation and projecting to a two-dimensional representation (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>), we identified two clusters of features, shown in <xref ref-type="fig" rid="pcbi-1000916-g005">Figure 5(a)</xref> using stars and circles. The color scheme indicates the SVR weight associated with the 13-mer feature, red for highly weighted features and blue for low weights. The two well-separated clusters suggest that the SVR is learning a primary and secondary motif, similar to results of PSSM-based analysis <xref ref-type="bibr" rid="pcbi.1000916-Badis1">[10]</xref>. We took a 13-mer feature near the centroid of each cluster and expanded each into a PSSM by aligning to the positive training sequences (see <xref ref-type="sec" rid="s4">Materials and Methods</xref>): the “star” cluster is represented by a motif that looks like the canonical Oct4 octamer (<named-content content-type="gene" xlink:type="simple">ATGCAAAT</named-content>), but the “circle” cluster is centered on a more degenerate (<named-content content-type="gene" xlink:type="simple">TAATT</named-content>) motif. To determine the <italic>in vivo</italic> prediction performance of each cluster independently, we retrained SVR models using the star and circle 13-mer features separately and obtained dramatically different AUCs of 0.75 and 0.54, respectively, on the Oct4 ChIP-seq data. The poor <italic>in vivo</italic> performance of the star cluster of features suggests that the PBM is learning a secondary motif that is not preferred <italic>in vivo</italic>. The presence of these apparently PBM-specific features only slightly degrades the performance of the full SVR model (AUC of.74) but may seriously impact PSSM-based methods. For example, the Seed-and-Wobble algorithm identifies a primary motif similar to <named-content content-type="gene" xlink:type="simple">TAATTA</named-content> for the other Oct4 nearest neighbor, Pou2f1 (see Figure S10 in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>), which accounts for its poor occupancy prediction. We reiterate the caveat that neither of these Pou domains is in fact Oct4; it is conceivable that the differences between PBM and ChIP binding preferences are due in part to differences in these homeodomains.</p>
<fig id="pcbi-1000916-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000916.g005</object-id><label>Figure 5</label><caption>
<title>Sequence feature analysis of <italic>in vitro</italic> and <italic>in vivo</italic> models.</title>
<p>We plot <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e047" xlink:type="simple"/></inline-formula>-mers contributing to the (a) Oct4 PBM model and (b) Sox2 ChIP model, where each point represents a 13-mer and is colored according to its model weight (red for high weights, blue for low weights). Star and circle point styles indicate different clusters. For the PBM-derived model, the clusters appear to represent primary and secondary binding motifs, with the more degenerate motif perhaps arising as an artifact of the PBM experiment. For the ChIP-derived model, the clusters correspond to the motifs for Sox2 and its cofactor Oct4. (c) PBM-derived PSSMs for Sox12 and Pou2f3, downloaded from UniPROBE, and ChIP-derived PSSM for Sox2, computed using MDscan on the Sox2 ChIP-peak sequences (60bp long).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.g005" xlink:type="simple"/></fig></sec><sec id="s2g">
<title>ChIP-derived SVMs capture information about cofactor motifs</title>
<p>We next performed a similar feature analysis of the ChIP-derived model for Sox2, one of the examples where the <italic>in vivo</italic> model strongly outperformed the <italic>in vitro</italic> model. Here, 13-mer features from the SVM model are represented by their vector of alignment scores relative to 60bp sequences under ChIP-seq peaks rather than probe sequences.</p>
<p>Again, we identified two well-separated clusters, shown using stars and circles in <xref ref-type="fig" rid="pcbi-1000916-g005">Figure 5(b)</xref>. Here, the cluster representative for the “star” cluster can be expanded to a PSSM that closely resembles the Sox2 motif. However, the representative for the “circle” cluster maps to part of the Oct4 octamer motif, indicating that the ChIP-derived model is learning binding information about Sox2's binding partner Oct4 (<xref ref-type="fig" rid="pcbi-1000916-g005">Figure 5(c)</xref>). We hypothesized that this additional <italic>cis</italic> information may account for part of the improvement of the <italic>in vivo</italic> model over the PBM-derived model. To quantify this effect, we identified Sox2 bound regions that are not detected by the PBM-trained SVR model but are correctly detected by the ChIP-trained SVM (Figure S9(a) in <xref ref-type="supplementary-material" rid="pcbi.1000916.s001">Text S1</xref>). These 33 60bp regions were 6-fold depleted for the core Sox2 motif TTGT and 3-fold enriched for the core Oct4 motif TGCA. Moreover, 32 out of 33 of these regions were detected as positives by the PBM-trained SVR for Oct4 (). These results suggest that some binding of Sox2 may be indirect via binding of the cofactor Oct4.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>We have presented a flexible new discriminative framework for learning TF binding models from high resolution <italic>in vitro</italic> and <italic>in vivo</italic> data. In particular, we showed that SVR models using string kernels outperform existing existing approaches like PSSMs and E-scores for predicting <italic>in vitro</italic> TF binding preferences as measured by PBM experiments, based on cross-validation experiments across array designs. We also found that PBM-derived SVR models improve <italic>in vivo</italic> occupancy prediction over PBM-derived PSSMs and E-scores, in particular when ChIP-seq (as opposed to lower resolution ChIP-chip) data is available for validation. Furthermore, we saw that by training directly on ChIP-seq, i.e. using ChIP-seq peaks to define positive genomic training sequences and taking non-peak regions as negative sequences, we can significantly improve over PBM-derived models and outperform existing motif discovery methods. We also described a feature analysis procedure for looking inside the “black box” of the trained SVR/SVM models to identify clusters of sequence features that contribute to binding predictions. Importantly, this analysis allowed us to confirm that ChIP-trained SVM models were learning additional sequence signals corresponding to cofactor binding sites.</p>
<p>PSSMs have a long history in the analysis of TF binding sites and remain ubiquitous due to their interpretability. However, as we continue to accumulate mammalian PBM data and ChIP-seq data, the more general models that we develop here—i.e. models that do not force a PSSM representation on binding sites and can integrate <italic>in vivo</italic> sequence signals from both a TF and its cofactors—may be more suitable for representing complex regulatory regions. We anticipate a number of directions for building on this work. First, we can develop strategies to train jointly on PBM and ChIP-seq data for the same TF in order to cleanly disambiguate between direct and indirect binding. Second, as more PBM data becomes available, we can develop multi-task training strategies for modeling the binding preferences of a class of structurally related TFs, using features of the amino acid sequence as well as a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e048" xlink:type="simple"/></inline-formula>-mer representation of probe sequences. Then, given a new TF for which PBM data is not available, the model would extend to predict its binding preferences. Third, we can combine our <italic>in vivo</italic> TF sequence preference models with data on chromatin state, including histone modifications and DNase I footprinting, using a kernel combination strategy. The goal would be to predict TF target genes in new cell types, given only the chromatin information in the cell type, after training on ChIP-seq data paired with chromatin data in other cell types. Therefore, the flexible sequence-based framework we describe here provides the foundation for the systematic modeling of genome-wide TF occupancy.</p>
</sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Overview of SVR training</title>
<p>We developed a training strategy for our SVR models that involved three key components: (1) the choice of kernel, which specifies the space of features used to compare pairs of probe sequences; (2) the sampling procedure for selecting the training sequences, which produces more informative training data and reduces training time; (3) the feature selection method, which eliminates unimportant features and further improves computational efficiency. Each component is described in more technical detail below. We used the LIBSVM package for the computation of SVR models, keeping the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e049" xlink:type="simple"/></inline-formula> parameter fixed at 0.1 for all experiments.</p>
</sec><sec id="s4b">
<title>The di-mismatch kernel</title>
<p>Training a kernel method like an SVR on sequence data requires the use of some kind of string kernel, i.e. a similarity measure between sequences that defines an inner product in a corresponding feature space. Various <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e050" xlink:type="simple"/></inline-formula>-mer based string kernels have been proposed, including the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e051" xlink:type="simple"/></inline-formula> mismatch kernel <xref ref-type="bibr" rid="pcbi.1000916-Leslie1">[5]</xref>, where the feature representation for a sequence amounts to an inexact-matching histogram of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e052" xlink:type="simple"/></inline-formula>-mer counts, allowing up to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e053" xlink:type="simple"/></inline-formula> mismatches in each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e054" xlink:type="simple"/></inline-formula>-mer match (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e055" xlink:type="simple"/></inline-formula>). Here, however, even for small values of the mismatch parameter <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e056" xlink:type="simple"/></inline-formula>, this kernel tends to make the “mismatch” neighborhood of a given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e057" xlink:type="simple"/></inline-formula>-mer too large.</p>
<p>We therefore developed a novel first order Markov mismatch kernel, called the <italic>di</italic>-mismatch kernel, that counts mismatching dinucleotides and that inherently favors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e058" xlink:type="simple"/></inline-formula>-mers with consecutive mismatches. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e059" xlink:type="simple"/></inline-formula> be a set of unique <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e060" xlink:type="simple"/></inline-formula>-mers that occur in the set of training sequences (PBM probe sequences). Given a training sequence <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e061" xlink:type="simple"/></inline-formula> of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e062" xlink:type="simple"/></inline-formula>, we define the set of substrings of length <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e063" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e064" xlink:type="simple"/></inline-formula> to be<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e065" xlink:type="simple"/></disp-formula>Then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e066" xlink:type="simple"/></inline-formula> may be represented by the feature vector<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e067" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e068" xlink:type="simple"/></inline-formula>, and the value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e069" xlink:type="simple"/></inline-formula> is the di-mismatch score between two <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e070" xlink:type="simple"/></inline-formula>-mers, which counts the number of matching dinucleotides between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e071" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e072" xlink:type="simple"/></inline-formula>, that number being set to zero if this count falls below the threshold <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e073" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e074" xlink:type="simple"/></inline-formula> is the maximum number of mismatches allowed.</p>
<p>This score inherently favors consecutive mismatches, as we show in the following examples. Consider the first pair of 13-mers shown with four non-consecutive mismatches, which results in 6 mismatching dinucleotides out of 12:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e075" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e076" xlink:type="simple"/></disp-formula>In contrast, the following pair of 13-mers with four consecutive mismatches leads to a count of 5 mismatching dinucleotides.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e077" xlink:type="simple"/></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e078" xlink:type="simple"/></disp-formula></p>
<p>By enforcing a mismatch parameter of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e079" xlink:type="simple"/></inline-formula>, we induce sparsity in the feature counts and seem to obtain more meaningful “neighborhoods” of the features <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e080" xlink:type="simple"/></inline-formula> than the standard mismatch kernel. This procedure appeared to capture the full dynamic range of effective binding while downsampling the large number of unbound probes.</p>
<p>Since the PBM arrays are designed to give good coverage of 8-mer patterns (including gapped patterns), we chose <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e081" xlink:type="simple"/></inline-formula> parameters that would require at least 8 matching characters between the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e082" xlink:type="simple"/></inline-formula>-mers. Our parameter experiments on one set of yeast PBM arrays <xref ref-type="bibr" rid="pcbi.1000916-Zhu1">[9]</xref> indicated <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e083" xlink:type="simple"/></inline-formula> to be the best parameter setting, and we used this kernel choice for the <italic>in vitro</italic> evaluation for most of our reported results. However, one may use a 10-fold cross-validation approach on the training PBM array to perform a grid-search and thereby optimize the choice of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e084" xlink:type="simple"/></inline-formula> parameters. We used such a strategy for the 7 mammalian <italic>in vivo</italic> occupancy predictions (<xref ref-type="fig" rid="pcbi-1000916-g004">Figure 4</xref>), whereby we tested <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e085" xlink:type="simple"/></inline-formula> parameters ranging from <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e086" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e087" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e088" xlink:type="simple"/></inline-formula>.</p>
<p>Much like the mismatch kernel, the computational cost of scoring test sequences with the trained di-mismatch SVM/SVR model is linear with respect to the input sequence length. Every <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e089" xlink:type="simple"/></inline-formula>-mer has a non-zero match score to a fixed number of features, and each feature is represented by a weight in the support vector model. Therefore, the contribution of each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e090" xlink:type="simple"/></inline-formula>-mer can be pre-computed, and those with non-zero contribution can be stored in a hash table.</p>
</sec><sec id="s4c">
<title>Sampling PBM data to obtain an informative training set</title>
<p>Standard PBM arrays typically contain <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e091" xlink:type="simple"/></inline-formula>44K probes, each associated with a binding intensity score, but only few hundred probes indicate some level of TF binding. Using all of the PBM probes as training data would allow the SVR to achieve good training loss simply by learning that most probes have low binding scores. In order to learn sequence information associated with the bound probes, we selected training sequences from the tails of the distribution of the normalized binding intensities. More specifically, we selected the set of “positive” training probes to be those sequences associated with normalized binding intensities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e092" xlink:type="simple"/></inline-formula>; if the number of such probes was less than 500, we selected the top 500 probes ranked by their binding signals. The same number of “negative” training probes was selected from the other end of the distribution. This procedure appeared to capture the full dynamic range of effective binding for learning the regression model while downsampling the large number of unbound probes. We also tried sampling “negative” probes from the full intensity distribution (anywhere outside the positive tail), but we found that using the negative tail yielded better results.</p>
</sec><sec id="s4d">
<title>Feature selection</title>
<p>Careful feature selection can eliminate noisy features and of course reduces computational costs, both in the training and testing of the model. In particular, choosing very infrequent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e093" xlink:type="simple"/></inline-formula>-mers may add noise, and ideally, sequence features should display a preference either for bound or unbound probes. Therefore, we selected the feature set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e094" xlink:type="simple"/></inline-formula> to be those <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e095" xlink:type="simple"/></inline-formula>-mers that are over-represented either in the “positive” or “negative” probe class by computing the mean di-mismatch score for each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e096" xlink:type="simple"/></inline-formula>-mer in each class and ranking features by the difference between these means. In all reported results, we used at most 4000 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e097" xlink:type="simple"/></inline-formula>-mers for our models.</p>
</sec><sec id="s4e">
<title>ChIP-seq processing</title>
<p>We processed the ChIP-seq data using the SPP package <xref ref-type="bibr" rid="pcbi.1000916-Kharchenko1">[21]</xref> and extracted the top 1000 peaks to define a gold standard for occupancy. A 60bp window was selected around each of the peaks and used as the positive examples. A 60bp window 300bp to the left of the peak was selected as the negative example.</p>
</sec><sec id="s4f">
<title>Extracting features from SVR/SVM models</title>
<p>It is informative to be able to use the SVM model to visualize the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e098" xlink:type="simple"/></inline-formula>-mers that contribute to the model. Here our goal is to visually represent both (i) the similarity of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e099" xlink:type="simple"/></inline-formula>-mer features based on their support across the training data representing and (ii) the contribution (or weight) of these <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e100" xlink:type="simple"/></inline-formula>-mers to the model.</p>
<p>To obtain a similarity measure between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e101" xlink:type="simple"/></inline-formula>-mer features extracted from the trained models, we represented each <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e102" xlink:type="simple"/></inline-formula>-mer by a vector of alignment scores against the positive training sequences used to compute the SVR model: we found the optimal ungapped alignment of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e103" xlink:type="simple"/></inline-formula>-mer to each training sequence and used the number of match positions as the alignment score. Intuitively, sequence-similar <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e104" xlink:type="simple"/></inline-formula>-mers will have similar alignment scores across the training examples, so they will be represented by nearby vectors in this representation. However, we are not explicitly modeling sequence dependence but instead relying on co-occurrence of matches of similar <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e105" xlink:type="simple"/></inline-formula>-mers. We then performed <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e106" xlink:type="simple"/></inline-formula>-means clustering (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e107" xlink:type="simple"/></inline-formula> = 2) on the vectors representing the 13-mer features. Next we used the SVM/SVR weight vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e108" xlink:type="simple"/></inline-formula>, derived from the solution to the optimization problem, to select the top 500 representatives for each cluster, thereby reducing the rest of our analysis to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e109" xlink:type="simple"/></inline-formula>-mers that contributed significantly to the model. Next, we projected the 1000 <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e110" xlink:type="simple"/></inline-formula>-mers to a two-dimensional representation using principal component analysis (PCA), distinguishing cluster members with circles and stars in the plot. The relative significance of each feature is indicated by a color scale ranging from red to blue, for high and low <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e111" xlink:type="simple"/></inline-formula> respectively.</p>
<p>Finally, we defined a cluster representative for each group by the feature that has the following two properties: (i) it is in the top quartile of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e112" xlink:type="simple"/></inline-formula> weights for that cluster, and (ii) it is the closest feature to the cluster centroid. This gives us a cluster representative that is simultaneously close to the true cluster centroid and significant for the model. Finally, to represent a given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e113" xlink:type="simple"/></inline-formula>-mer feature by a motif logo, we selected the top 50 positive training sequences that best aligned with the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e114" xlink:type="simple"/></inline-formula>-mer, extracted the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000916.e115" xlink:type="simple"/></inline-formula>-length sequences that matched the feature, and computed a PSSM.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000916.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000916.s001" xlink:type="simple"><label>Text S1</label><caption>
<p>High resolution models of transcription factor-DNA affinities improve in vitro and in vivo binding predictions: Supplementary information.</p>
<p>(1.13 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank Steve Lianoglou for help with preparing the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000916-Fulton1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fulton</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Sundararajan</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Badis</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Hughes</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Wasserman</surname><given-names>W</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>TFCat: the curated catalog of mouse and human transcription factors.</article-title>             <source>Genome Biol</source>             <volume>10</volume>             <fpage>R29</fpage>          </element-citation></ref>
<ref id="pcbi.1000916-Harbison1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Harbison</surname><given-names>CT</given-names></name>
<name name-style="western"><surname>Gordon</surname><given-names>DB</given-names></name>
<name name-style="western"><surname>Lee</surname><given-names>TI</given-names></name>
<name name-style="western"><surname>Rinaldi</surname><given-names>NJ</given-names></name>
<name name-style="western"><surname>Macisaac</surname><given-names>KD</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Transcriptional regulatory code of a eukaryotic genome.</article-title>             <source>Nature</source>             <volume>431</volume>             <fpage>99</fpage>             <lpage>104</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Berger1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name>
<name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Qureshi</surname><given-names>AM</given-names></name>
<name name-style="western"><surname>He</surname><given-names>FS</given-names></name>
<name name-style="western"><surname>Estep</surname><given-names>PW</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Compact, universal DNA microarrays to comprehensively determine transcription-factor binding site specificities.</article-title>             <source>Nature Biotechnol</source>             <volume>12</volume>             <fpage>1249</fpage>             <lpage>1435</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Noble1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Noble</surname><given-names>WS</given-names></name>
</person-group>             <year>2004</year>             <article-title>Support vector machine applications in computational biology, MIT Press, chapter 3.</article-title>             <source>Computational Molecular Biology</source>             <comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.amazon.com/exec/obidos/redirect?tag=citeulike07-20&amp;path=ASIN/0262195097" xlink:type="simple">http://www.amazon.com/exec/obidos/redirect?tag=citeulike07-20&amp;path=ASIN/0262195097</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000916-Leslie1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Leslie</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Eskin</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Cohen</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Weston</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Noble</surname><given-names>WS</given-names></name>
</person-group>             <year>2004</year>             <article-title>Mismatch string kernels for discriminative protein classification.</article-title>             <source>Bioinformatics</source>             <volume>20</volume>             <fpage>467</fpage>             <lpage>76</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Kuang1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kuang</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Ie</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Wang</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Wang</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Siddiqi</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2005</year>             <article-title>Remote protein homology detection and motif extraction using profile kernels.</article-title>             <source>J Bioinform Comput Biol</source>             <volume>3</volume>             <fpage>527</fpage>             <lpage>550</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Pavesi1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Pavesi</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Mauri</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Pesole</surname><given-names>G</given-names></name>
</person-group>             <year>2001</year>             <article-title>An algorithm for finding signals of unknown length in DNA sequences.</article-title>             <source>Bioinformatics</source>             <volume>17</volume>          </element-citation></ref>
<ref id="pcbi.1000916-Liu1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Liu</surname><given-names>XS</given-names></name>
<name name-style="western"><surname>Brutlag</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>J</given-names></name>
</person-group>             <year>2002</year>             <article-title>An algorithm for finding protein-DNA binding sites with applications to chromatin-immunoprecipitation microarray experiments.</article-title>             <source>Nature Biotechnol</source>             <volume>20</volume>             <fpage>835</fpage>             <lpage>839</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Zhu1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Zhu</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Byers</surname><given-names>K</given-names></name>
<name name-style="western"><surname>McCord</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Shi</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Berger</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>High-resolution DNA binding specificity analysis of yeast transcription factors.</article-title>             <source>Genome Res</source>             <volume>19</volume>             <fpage>556</fpage>             <lpage>566</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Badis1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Badis</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Berger</surname><given-names>MF</given-names></name>
<name name-style="western"><surname>Philippakis</surname><given-names>AA</given-names></name>
<name name-style="western"><surname>Talukder</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Gehrke</surname><given-names>AR</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Diversity and complexity in DNA recognition by transcription factors.</article-title>             <source>Science</source>             <volume>324</volume>             <fpage>1720</fpage>             <lpage>1723</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Newburger1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Newburger</surname><given-names>DE</given-names></name>
<name name-style="western"><surname>Bulyk</surname><given-names>ML</given-names></name>
</person-group>             <year>2009</year>             <article-title>UniPROBE: an online database of protein binding microarray data on protein-DNA interactions.</article-title>             <source>Nucleic Acids Res</source>             <volume>37</volume>             <fpage>77</fpage>             <lpage>82</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Badis2"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Badis</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Chan</surname><given-names>ET</given-names></name>
<name name-style="western"><surname>van Bakel</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Pena-Castillo</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Tillo</surname><given-names>D</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>A library of yeast transcription factor motifs reveals a widespread function for Rsc3 in targeting nucleosome exclusion at promoters.</article-title>             <source>Mol Cell</source>             <volume>32</volume>             <fpage>878</fpage>             <lpage>887</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Chen1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chen</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Hughes</surname><given-names>TR</given-names></name>
<name name-style="western"><surname>Morris</surname><given-names>Q</given-names></name>
</person-group>             <year>2007</year>             <article-title>RankMotif++: a motif-search algorithm that accounts for relative ranks of K-mers in binding transcription factors.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>i72</fpage>             <lpage>i79</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-Chen2"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chen</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Xu</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Yuan</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Fang</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Huss</surname><given-names>M</given-names></name>
<etal/></person-group>             <year>2008</year>             <article-title>Integration of external signaling pathways with the core transcriptional network in embryonic stem cells.</article-title>             <source>Cell</source>             <volume>133</volume>             <fpage>1106</fpage>             <lpage>1117</lpage>          </element-citation></ref>
<ref id="pcbi.1000916-ENCODE1"><label>15</label><element-citation publication-type="other" xlink:type="simple">             <collab xlink:type="simple">ENCODE</collab>             <year>2010</year>             <article-title>ENCODE data at UCSC Genome Browser.</article-title>             <comment>Available: <ext-link ext-link-type="uri" xlink:href="http://www.genome.gov/10005107" xlink:type="simple">http://www.genome.gov/10005107</ext-link>. Unpublished</comment>          </element-citation></ref>
<ref id="pcbi.1000916-Wallerman1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wallerman</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Motallebipour</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Enroth</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Patra</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Bysani</surname><given-names>MSR</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Molecular interactions between hnf4a, foxa2 and gabp identified at regulatory dna elements through chip-sequencing.</article-title>             <source>Nucleic Acids Res</source>             <volume>37</volume>             <fpage>7498</fpage>          </element-citation></ref>
<ref id="pcbi.1000916-Fraenkel1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fraenkel</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Rould</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Chambers</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Pabo</surname><given-names>C</given-names></name>
</person-group>             <year>1998</year>             <article-title>Engrailed homeodomain-dna complex at 2.2 å resolution: a detailed view of the interface and comparison with other engrailed structures1.</article-title>             <source>J Mol Biol</source>             <volume>284</volume>             <fpage>351</fpage>          </element-citation></ref>
<ref id="pcbi.1000916-Kissinger1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kissinger</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Martin-Blanco</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Kornberg</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Pabo</surname><given-names>C</given-names></name>
</person-group>             <year>1990</year>             <article-title>Crystal structure of an engrailed homeodomain-dna complex at 2.8 p resolution: A framework for understanding homeodomain-dna interactions.</article-title>             <source>Cell</source>             <volume>63</volume>             <fpage>579</fpage>          </element-citation></ref>
<ref id="pcbi.1000916-Bolotin1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bolotin</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Liao</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Ta</surname><given-names>TC</given-names></name>
<name name-style="western"><surname>Yang</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Hwang-Verslues</surname><given-names>W</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>Integrated approach for the identification of human HNF4<italic>α</italic> target genes using protein binding microarrays.</article-title>             <source>Hepatology</source>          </element-citation></ref>
<ref id="pcbi.1000916-Georgiev1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Georgiev</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Boyle</surname><given-names>AP</given-names></name>
<name name-style="western"><surname>Jayasurya</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Ding</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Mukherjee</surname><given-names>S</given-names></name>
<etal/></person-group>             <year>2010</year>             <article-title>Evidence-ranked motif identification.</article-title>             <source>Genome Biol</source>             <volume>11</volume>             <fpage>R19</fpage>          </element-citation></ref>
<ref id="pcbi.1000916-Kharchenko1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kharchenko</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Tolstorukov</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Park</surname><given-names>P</given-names></name>
</person-group>             <year>2008</year>             <article-title>Design and analysis of chip-seq experiments for dna-binding proteins.</article-title>             <source>Nature Biotechnol advanced online publication</source>             <fpage>1351</fpage>             <lpage>1359</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>