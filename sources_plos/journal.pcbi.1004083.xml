<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-00173</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004083</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Improved Estimation and Interpretation of Correlations in Neural Circuits</article-title>
<alt-title alt-title-type="running-head">Estimation and Interpretation of Neural Correlations</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Yatsenko</surname> <given-names>Dimitri</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Josić</surname> <given-names>Krešimir</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Ecker</surname> <given-names>Alexander S.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="aff" rid="aff005"><sup>5</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Froudarakis</surname> <given-names>Emmanouil</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Cotton</surname> <given-names>R. James</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Tolias</surname> <given-names>Andreas S.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff006"><sup>6</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Neuroscience, Baylor College of Medicine, Houston, Texas, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Mathematics and Department of Biology and Biochemistry, University of Houston, Houston, Texas, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Werner Reichardt Center for Integrative Neuroscience and Institute for Theoretical Physics, University of Tübingen, Germany</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Bernstein Center for Computational Neuroscience, Tübingen, Germany</addr-line>
</aff>
<aff id="aff005">
<label>5</label>
<addr-line>Max Planck Institute for Biological Cybernetics, Tübingen, Germany</addr-line>
</aff>
<aff id="aff006">
<label>6</label>
<addr-line>Department of Computational and Applied Mathematics, Rice University, Houston, Texas, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Pillow</surname> <given-names>Jonathan W.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>The University of Texas at Austin, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: DY KJ ASE AST. Performed the experiments: DY EF RJC. Analyzed the data: DY RJC. Wrote the paper: DY KJ ASE AST.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">atolias@cns.bcm.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>3</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>31</day>
<month>3</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>3</issue>
<elocation-id>e1004083</elocation-id>
<history>
<date date-type="received">
<day>29</day>
<month>1</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>11</day>
<month>12</month>
<year>2014</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Yatsenko et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004083" xlink:type="simple"/>
<abstract>
<p>Ambitious projects aim to record the activity of ever larger and denser neuronal populations in vivo. Correlations in neural activity measured in such recordings can reveal important aspects of neural circuit organization. However, estimating and interpreting large correlation matrices is statistically challenging. Estimation can be improved by regularization, i.e. by imposing a structure on the estimate. The amount of improvement depends on how closely the assumed structure represents dependencies in the data. Therefore, the selection of the most efficient correlation matrix estimator for a given neural circuit must be determined empirically. Importantly, the identity and structure of the most efficient estimator informs about the types of dominant dependencies governing the system. We sought statistically efficient estimators of neural correlation matrices in recordings from large, dense groups of cortical neurons. Using fast 3D random-access laser scanning microscopy of calcium signals, we recorded the activity of nearly every neuron in volumes 200 μm wide and 100 μm deep (150–350 cells) in mouse visual cortex. We hypothesized that in these densely sampled recordings, the correlation matrix should be best modeled as the combination of a sparse graph of pairwise partial correlations representing local interactions and a low-rank component representing common fluctuations and external inputs. Indeed, in cross-validation tests, the covariance matrix estimator with this structure consistently outperformed other regularized estimators. The sparse component of the estimate defined a graph of interactions. These interactions reflected the physical distances and orientation tuning properties of cells: The density of positive ‘excitatory’ interactions decreased rapidly with geometric distances and with differences in orientation preference whereas negative ‘inhibitory’ interactions were less selective. Because of its superior performance, this ‘sparse+latent’ estimator likely provides a more physiologically relevant representation of the functional connectivity in densely sampled recordings than the sample correlation matrix.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>It is now possible to record the spiking activity of hundreds of neurons at the same time. A meaningful statistical description of the collective activity of these neural populations—their ‘functional connectivity’—is a forefront challenge in neuroscience. We addressed this problem by identifying statistically efficient estimators of correlation matrices of the spiking activity of neural populations. Various underlying processes may reflect differently on the structure of the correlation matrix: Correlations due to common network fluctuations or external inputs are well estimated by low-rank representations, whereas correlations arising from linear interactions between pairs of neurons are well approximated by their pairwise <italic>partial</italic> correlations. In our data obtained from fast 3D two-photon imaging of calcium signals of large and dense groups of neurons in mouse visual cortex, the best estimation performance was attained by decomposing the correlation matrix into a sparse network of partial correlations (‘interactions’) combined with a low-rank component. The inferred interactions were both positive (‘excitatory’) and negative (‘inhibitory’) and reflected the spatial organization and orientation preferences of the interacting cells. We propose that the most efficient among many estimators provides a more informative picture of the functional connectivity than previous analyses of neural correlations.</p>
</abstract>
<funding-group>
<funding-statement>This work was supported by grants NEI R01-EY018847, NEI P30-EY002520-33, NEI T32-EY07001-37, NIDA R01DA028525, the NIH-Pioneer award DP1-OD008301 to AST, the McKnight Scholar Award to AST; the Arnold \&amp; Beckman Foundation Young Investigator Award to AST; and NSF grants DMS-0817649, DMS-1122094 to KJ. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="0"/>
<page-count count="28"/>
</counts>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p><italic>Functional connectivity</italic> is a statistical description of observed <italic>multineuronal</italic> activity patterns not reducible to the response properties of the individual cells. Functional connectivity reflects local synaptic connections, shared inputs from other regions, and endogenous network activity. Although functional connectivity is a phenomenological description without a strict mechanistic interpretation, it can be used to generate hypotheses about the anatomical architecture of the neural circuit and to test hypotheses about the processing of information at the population level.</p>
<p>Pearson correlations between the spiking activity of pairs of neurons are among the most familiar measures of functional connectivity [<xref ref-type="bibr" rid="pcbi.1004083.ref001">1</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref005">5</xref>]. In particular, <italic>noise correlations</italic>, <italic>i.e.</italic> the correlations of trial-to-trial response variability between pairs of neurons, have a profound impact on stimulus coding [<xref ref-type="bibr" rid="pcbi.1004083.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref011">11</xref>]. In addition, noise correlations and correlations in spontaneous activity have been hypothesized to reflect aspects of synaptic connectivity [<xref ref-type="bibr" rid="pcbi.1004083.ref012">12</xref>]. Interest in neural correlations has been sustained by a series of discoveries of their nontrivial relationships to various aspects of circuit organization such as the physical distances between the neurons [<xref ref-type="bibr" rid="pcbi.1004083.ref013">13</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref014">14</xref>], their synaptic connectivity [<xref ref-type="bibr" rid="pcbi.1004083.ref015">15</xref>], stimulus response similarity [<xref ref-type="bibr" rid="pcbi.1004083.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref015">15</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref022">22</xref>], cell types [<xref ref-type="bibr" rid="pcbi.1004083.ref023">23</xref>], cortical layer specificity [<xref ref-type="bibr" rid="pcbi.1004083.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref025">25</xref>], progressive changes in development and in learning [<xref ref-type="bibr" rid="pcbi.1004083.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref028">28</xref>], changes due to sensory stimulation and global brain states [<xref ref-type="bibr" rid="pcbi.1004083.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref029">29</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref033">33</xref>].</p>
<p>Neural correlations do not come with ready or unambiguous mechanistic interpretations. They can arise from monosynaptic or polysynaptic interactions, common or correlated inputs, oscillations, top-down modulation, and background network fluctuations, and other mechanisms [<xref ref-type="bibr" rid="pcbi.1004083.ref034">34</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref039">39</xref>]. But multineuronal recordings do provide more information than an equivalent number of separately recorded pairs of cells. For example, the eigenvalue decomposition of the covariance matrix expresses shared correlated activity components across the population; common fluctuations of population activity may be accurately represented by only a few eigenvectors that affect all correlation coefficients. On the other hand, a correlation matrix can be specified using the <italic>partial correlations</italic> between pairs of the recorded neurons. The partial correlation coefficient between two neurons reflects their linear association conditioned on the activity of all the other recorded cells [<xref ref-type="bibr" rid="pcbi.1004083.ref040">40</xref>]. Under some assumptions, partial correlations measure conditional independence between variables and may more directly approximate causal effects between components of complex systems than correlations [<xref ref-type="bibr" rid="pcbi.1004083.ref040">40</xref>]. For this reason, partial correlations have been used to describe interactions between genes in functional genomics [<xref ref-type="bibr" rid="pcbi.1004083.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref042">42</xref>] and between brain regions in imaging studies [<xref ref-type="bibr" rid="pcbi.1004083.ref043">43</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref044">44</xref>]. These opportunities have not yet been explored in neurophysiological studies where most analyses have only considered the distributions of pairwise correlations [<xref ref-type="bibr" rid="pcbi.1004083.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref013">13</xref>].</p>
<p>However, estimation of correlation matrices from large populations presents a number of numerical challenges. The amount of recorded data grows only linearly with population size whereas the number of estimated coefficients increases quadratically. This mismatch leads to an increase in spurious correlations, overestimation of common activity (<italic>i.e.</italic> overestimation of the largest eigenvalues) [<xref ref-type="bibr" rid="pcbi.1004083.ref045">45</xref>], and poorly conditioned partial correlations [<xref ref-type="bibr" rid="pcbi.1004083.ref041">41</xref>]. The <italic>sample correlation matrix</italic> is an unbiased estimate of the true correlations but its many free parameters make it sensitive to sampling noise. As a result, on average, the sample correlation matrix is farther from the true correlation matrix than some structured estimates.</p>
<p>Estimation can be improved through <italic>regularization</italic>, the technique of deliberately imposing a structure on an estimate in order to reduce its estimation error [<xref ref-type="bibr" rid="pcbi.1004083.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref046">46</xref>]. To ‘impose a structure’ on an estimate means to bias (‘shrink’) it toward a reduced representation with fewer free parameters, the <italic>target estimate</italic>. The optimal target estimate and the optimal amount of shrinkage can be obtained from the data sample either analytically [<xref ref-type="bibr" rid="pcbi.1004083.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref047">47</xref>] or by cross-validation [<xref ref-type="bibr" rid="pcbi.1004083.ref048">48</xref>]. An estimator that produces estimates that are, on average, closer to the truth for a given sample size is said to be more <italic>efficient</italic> than other estimators.</p>
<p>Although regularized covariance matrix estimation is commonplace in finance [<xref ref-type="bibr" rid="pcbi.1004083.ref047">47</xref>], functional genomics [<xref ref-type="bibr" rid="pcbi.1004083.ref041">41</xref>], and brain imaging [<xref ref-type="bibr" rid="pcbi.1004083.ref044">44</xref>], surprisingly little work has been done to identify optimal regularization of neural correlation matrices.</p>
<p>Improved estimation of the correlation matrix is beneficial in itself. For example, improved estimates can be used to optimize decoding of the population activity [<xref ref-type="bibr" rid="pcbi.1004083.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref049">49</xref>]. But reduced estimation error is not the only benefit of regularization. Finding the most efficient among many regularized estimators leads to insights about the system itself: the structure of the most efficient estimator is a parsimonious representation of the regularities in the data.</p>
<p>The advantages due to regularization increase with the size of the recorded population. With the advent of big neural data [<xref ref-type="bibr" rid="pcbi.1004083.ref050">50</xref>], the search for optimal regularization schemes will become increasingly relevant in any model of population activity. Since optimal regularization schemes are specific to systems under investigation, the inference of functional connectivity in large-scale neural data will entail the search for optimal regularization schemes. Such schemes may involve combinations of heuristic rules and numerical techniques specially designed for given types of neural circuits.</p>
<p>What structures of correlation matrices best describe the multineuronal activity in specific circuits and in specific brain states? More specifically, are correlations in the visual cortex during visual stimulation best explained by common fluctuations or by local interactions within the recorded microcircuit?</p>
<p>To address these questions, we evaluated four regularized covariance matrix estimators that imposed different structures on the estimate. The estimators are designated as follows:
<list list-type="simple">
<list-item><p><italic>C</italic><sub>sample</sub>—the sample covariance matrix, the unbiased estimator.</p></list-item>
<list-item><p><italic>C</italic><sub>diag</sub>—linear shrinkage of covariances toward zero, <italic>i.e.</italic> toward a diagonal covariance matrix.</p></list-item>
<list-item><p><italic>C</italic><sub>factor</sub>—a low-rank approximation of the sample covariance matrix, representing inputs from unobserved shared factors (latent units).</p></list-item>
<list-item><p><italic>C</italic><sub>sparse</sub>—sparse partial correlations, <italic>i.e.</italic> a large fraction of the <italic>partial</italic> correlations between pairs of neurons are set to zero.</p></list-item>
<list-item><p><italic>C</italic><sub>sparse+latent</sub>—sparse partial correlations between the recorded neurons <italic>and</italic> linear interactions with a number of latent units.</p></list-item>
</list></p>
<p>First, we used simulated data to demonstrate that the selection of the optimal estimator indeed pointed to the true structure of the dependencies in the data.</p>
<p>We then performed a cross-validated evaluation to establish which of the four regularized estimators was most efficient for representing the population activity of dense groups of neurons in mouse primary visual cortex recorded with high-speed 3D random-access two-photon imaging of calcium signals. In our data, the sample correlation coefficients were largely positive and low. We found that the most efficient estimator of the correlation matrix in these data was <italic>C</italic><sub>sparse+latent</sub>. This estimator revealed a sparse network of partial correlations (‘interactions’), between the observed neurons; it also inferred a number of latent units interacting with the observed neurons. We analyzed these networks of partial correlations and found the following: Whereas significant noise correlations were predominantly positive, the inferred interactions had a large fraction of negative values possibly reflecting inhibitory circuitry. Moreover, the inferred positive interactions exhibited a substantially stronger relationship to the physical distances and to the differences in preferred orientations than noise correlations. In contrast, the inferred negative interactions were less selective.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec002a">
<title>Covariance estimation</title>
<p>The covariance matrix is defined as
<disp-formula id="pcbi.1004083.e001"><alternatives><graphic id="pcbi.1004083.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mrow><mml:mo>Σ</mml:mo> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>−</mml:mo> <mml:mi>μ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>−</mml:mo> <mml:mi>μ</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>T</mml:mo></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/> <mml:mi>μ</mml:mi> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>x</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
where the <italic>p</italic> × 1 vector <italic>x</italic> is a single observation of the firing rates of <italic>p</italic> neurons in a time bin of some duration, <inline-formula id="pcbi.1004083.e002"><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mi> </mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>⋅</mml:mo> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> denotes expectation, and <italic>μ</italic> is the vector of expected firing rates.</p>
<p>Given a set of observations {<italic>x</italic>(<italic>t</italic>): <italic>t</italic> ∈ <italic>T</italic>} of population activity, where <italic>x</italic>(<italic>t</italic>) contains observed firing rates in time bin <italic>t</italic>, and an independent estimate of the mean firing rates <inline-formula id="pcbi.1004083.e003"><mml:math id="M3" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover></mml:math></inline-formula>, the <italic>sample covariance matrix</italic>,
<disp-formula id="pcbi.1004083.e004"><alternatives><graphic id="pcbi.1004083.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e004"/><mml:math id="M4" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>T</mml:mi></mml:mrow></mml:munder> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>x</mml:mi> <mml:mo stretchy="false">(</mml:mo></mml:mrow></mml:mstyle> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>x</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>T</mml:mo></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
where <italic>n</italic> is the number of time bins in <italic>T</italic>, is an unbiased estimate of the true covariance matrix, <italic>i.e.</italic> <inline-formula id="pcbi.1004083.e005"><mml:math id="M5" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mi> </mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>Σ</mml:mo></mml:mrow></mml:math></inline-formula>. In all cases when the unbiasedness of the sample covariance matrix matters in this paper, the mean activity is estimated independently from a separate sample.</p>
<p>Given any covariance matrix estimate <italic>C</italic>, the corresponding correlation matrix <italic>R</italic> is calculated by normalizing the rows and columns of <italic>C</italic> by the square roots of its diagonal elements to produce unit entries on the diagonal:
<disp-formula id="pcbi.1004083.e006"><alternatives><graphic id="pcbi.1004083.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e006"/><mml:math id="M6" display="block" overflow="scroll"><mml:mrow><mml:mi>R</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mtext>diag</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mi>C</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup> <mml:mi>C</mml:mi> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mtext>diag</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mi>C</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
where diag(<italic>C</italic>) denotes the diagonal matrix with the diagonal elements from <italic>C</italic>.</p>
<p>The <italic>partial correlation</italic> between a pair of variables is the Pearson correlation coefficient of the residuals of the linear least-squares predictor of their activity based on all the other variables, excluding the pair [<xref ref-type="bibr" rid="pcbi.1004083.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref051">51</xref>]. Partial correlations figure prominently in probabilistic <italic>graphical modeling</italic> wherein the joint distribution is explained by sets of pairwise interactions [<xref ref-type="bibr" rid="pcbi.1004083.ref040">40</xref>]. For multivariate Gaussian distributions, zero partial correlations indicate conditional independence of the pair, implying a lack of direct interaction [<xref ref-type="bibr" rid="pcbi.1004083.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref052">52</xref>]. More generally, partial correlations can serve as a measure of conditional independence under the assumption that dependencies in the system are close to linear effects [<xref ref-type="bibr" rid="pcbi.1004083.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref053">53</xref>]. As neural recordings become increasingly dense, partial correlations may prove useful as indicators of conditional independence (lack of functional connectivity) between pairs of neurons.</p>
<p>Pairwise partial correlations are closely related to the elements of the <italic>precision matrix</italic>, <italic>i.e.</italic> the inverse of the covariance matrix [<xref ref-type="bibr" rid="pcbi.1004083.ref040">40</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref052">52</xref>]. Zero elements in the precision matrix signify zero partial correlations between the corresponding pairs of variables. Given the covariance estimate <italic>C</italic>, the matrix of partial correlations <italic>P</italic> is computed by normalizing the rows and columns of the <italic>precision matrix</italic> <italic>C</italic><sup>−1</sup> to produce negative unit entries on the diagonal:
<disp-formula id="pcbi.1004083.e007"><alternatives><graphic id="pcbi.1004083.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e007"/><mml:math id="M7" display="block" overflow="scroll"><mml:mrow><mml:mi>P</mml:mi> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtext>diag</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>C</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup> <mml:mspace width="1pt"/><mml:msup><mml:mi>C</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtext>diag</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>C</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(4)</label></disp-formula></p>
<p>Increasing the number of recorded neurons results in a higher <italic>condition number</italic> of the sample covariance matrix [<xref ref-type="bibr" rid="pcbi.1004083.ref045">45</xref>] making the partial correlation estimates more <italic>ill-conditioned</italic>: small errors in the covariance estimates translate into greater errors in the estimates of the partial correlations. With massively multineuronal recordings, partial correlations cannot be estimated without <italic>regularization</italic> [<xref ref-type="bibr" rid="pcbi.1004083.ref041">41</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref045">45</xref>].</p>
<p>We considered four regularized estimators based on distinct families of target estimates: <italic>C</italic><sub>diag</sub>, <italic>C</italic><sub>factor</sub>, <italic>C</italic><sub>sparse</sub>, and <italic>C</italic><sub>sparse+latent</sub>. In probabilistic models with exclusively linear dependencies, the target estimates of these estimators correspond to distinct families of graphical models (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 1).</p>
<fig id="pcbi.1004083.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004083.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Regularized estimators whose structure matches the true structure in the data are more efficient.</title>
<p><bold>Row 1.</bold> Graphical models of the target estimates of the four respective regularized covariance matrix estimators. Recorded neurons are represented by the green spheres and latent units by the lightly shaded spheres. Edges represent conditional dependencies, <italic>i.e.</italic> ‘interactions’. <bold>Row 1, A</bold>. For estimator <italic>C</italic><sub>diag</sub>, the target estimate is a diagonal matrix, which describes systems that lack linear dependencies. <bold>Row 1, B.</bold> For estimator <italic>C</italic><sub>factor</sub>, the target estimate is a factor model (low-rank matrix plus a diagonal matrix), representing systems in which correlations arise due to common input from latent units. <bold>Row 1, C</bold>. For estimator <italic>C</italic><sub>sparse</sub>, the covariance matrix is approximated as the inverse of a sparse matrix. This approximation describes systems in which correlations arise from a sparse set of linear associations between the observed units. <bold>Row 1, D</bold>. For estimator <italic>C</italic><sub>sparse+latent</sub>, the covariance matrix is approximated as the inverse of the sum of a sparse matrix and a low-rank matrix. This approximation describes a model wherein correlations arise due to sparse associations between the recorded cells <italic>and</italic> due to several latent units.</p>
<p><bold>Row 2:</bold> Examples of 50 × 50 correlation matrices corresponding to each structure: <bold>A.</bold> the diagonal correlation matrix, <bold>B.</bold> a factor model with four latent units, <bold>C.</bold> a correlation matrix with 67% off-diagonal zeros in its inverse, and <bold>D.</bold> a correlation matrix whose inverse is the sum of a rank-3 matrix (<italic>i.e.</italic> three latent units) and a sparse matrix with 76% off-diagonal zeros.</p>
<p><bold>Row 3:</bold> Sample correlation matrices calculated from samples of size <italic>n</italic> = 500 drawn from simulated random processes with respective correlation matrices shown in Row 2. The structure of the sample correlation matrix is difficult to discern by eye.</p>
<p><bold>Row 4:</bold> Estimates computed from the same data as in Row 3 using structured estimators of the correct type, optimized by cross-validation. The regularized estimates are closer to the truth than the sample correlation matrices.</p>
<p><bold>Row 5:</bold> True loss (<xref ref-type="disp-formula" rid="pcbi.1004083.e013">Eq. 9</xref>) for the five estimators as a function of sample size. The error bars indicate the standard deviation of the mean. Estimators with structure that matches the true model converged to zero faster than the other estimators.</p>
<p><bold>Row 6:</bold> Validation loss (<xref ref-type="disp-formula" rid="pcbi.1004083.e019">Eq. 10</xref>) for the five estimators relative to the matching estimators for each type of ground truth. Error bars indicate the standard deviation of the mean. Differences in validation loss approximate differences in true loss.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004083.g001"/>
</fig>
<p>The target estimate of estimator <italic>C</italic><sub>diag</sub> is the diagonal matrix <italic>D</italic> containing estimates of neurons’ variances. Regularization is achieved by linear <italic>shrinkage</italic> of the sample covariance matrix <italic>C</italic><sub>sample</sub> toward <italic>D</italic> as controlled by the scalar <italic>shrinkage intensity</italic> parameter <italic>λ</italic> ∈ [0, 1]:
<disp-formula id="pcbi.1004083.e008"><alternatives><graphic id="pcbi.1004083.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e008"/><mml:math id="M8" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>diag</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mi>λ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>λ</mml:mi> <mml:mi>D</mml:mi> <mml:mspace width="1pt"/></mml:mrow></mml:math></alternatives> <label>(5)</label></disp-formula>
The structure imposed by <italic>C</italic><sub>diag</sub> describes a population with no linear associations between the neurons (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 1, A). If sample correlations are largely spurious, <italic>C</italic><sub>diag</sub> is expected to be more efficient than other estimators.</p>
<p>Estimator <italic>C</italic><sub>factor</sub> approximates the covariance matrix by the factor model,
<disp-formula id="pcbi.1004083.e009"><alternatives><graphic id="pcbi.1004083.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>factor</mml:mtext></mml:mrow></mml:msub> <mml:mspace width="1pt"/> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/> <mml:mi>L</mml:mi> <mml:mspace width="1pt"/> <mml:mo>+</mml:mo> <mml:mspace width="1pt"/> <mml:mi>D</mml:mi> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(6)</label></disp-formula>
where <italic>L</italic> is a <italic>p</italic> × <italic>p</italic> symmetric positive semidefinite matrix with low rank and <italic>D</italic> is a diagonal matrix. This approximation is the basis for <italic>factor analysis</italic> [<xref ref-type="bibr" rid="pcbi.1004083.ref051">51</xref>], where matrix <italic>L</italic> represents covariances arising from latent factors. The rank of <italic>L</italic> corresponds to the number of latent factors. Matrix <italic>D</italic> contains the variances of the cells’ independent activity from the latent factors. The estimator is regularized by selecting the rank of <italic>L</italic> and by shrinking the independent variances in <italic>D</italic> toward their mean. The structure imposed by <italic>C</italic><sub>factor</sub> describes a population whose activity is linearly driven by a number of latent factors that affect many cells while direct interactions between the recorded cells are insignificant (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 1, B).</p>
<p>Estimator <italic>C</italic><sub>sparse</sub> is produced by approximating the sample covariance matrix by the inverse of a sparse matrix <italic>S</italic>:
<disp-formula id="pcbi.1004083.e010"><alternatives><graphic id="pcbi.1004083.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sparse</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mi>S</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(7)</label></disp-formula>
The estimator is regularized by adjusting the sparsity (fraction of off-diagonal zeros) of <italic>S</italic>. The problem of finding the optimal set of non-zero elements in <italic>S</italic> is known as <italic>covariance selection</italic> [<xref ref-type="bibr" rid="pcbi.1004083.ref052">52</xref>]. The structure imposed by <italic>C</italic><sub>sparse</sub> describes conditions in which neural correlations arise from direct linear effects (‘interactions’) between some pairs of neurons (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 1, C).</p>
<p>Estimator <italic>C</italic><sub>sparse+latent</sub> is obtained by approximating the sample covariance matrix by a matrix whose inverse is the difference of a sparse component and a low-rank component:
<disp-formula id="pcbi.1004083.e011"><alternatives><graphic id="pcbi.1004083.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sparse</mml:mtext> <mml:mo>+</mml:mo> <mml:mtext>latent</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>−</mml:mo> <mml:mi>L</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
where <italic>S</italic> is a sparse matrix and <italic>L</italic> is a low-rank matrix. The estimator is regularized by adjusting the sparsity of <italic>S</italic> and the rank of <italic>L</italic>. See <xref ref-type="sec" rid="sec004">Methods</xref> for more detailed explanations. The structure imposed by <italic>C</italic><sub>sparse+latent</sub> favors conditions in which the activity of neurons is determined by linear effects between some observed pairs of neurons and linear effects from several latent units (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 1, D) [<xref ref-type="bibr" rid="pcbi.1004083.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref055">55</xref>].</p>
<p>We refer to the sparse partial correlations in estimators <italic>C</italic><sub>sparse</sub> and <italic>C</italic><sub>sparse+latent</sub> as ‘interactions’.</p>
</sec>
<sec id="sec002b">
<title>Simulation</title>
<p>We next demonstrated how the most efficient among different regularized estimators can reveal the structure of correlations. We constructed four families of 50 × 50 covariance matrices, each with structure that matched one of the four regularized estimators (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 2, A–D and <xref ref-type="sec" rid="sec004">Methods</xref>). We used these covariance matrices as the ground truth in multivariate Gaussian distributions with zero means and drew samples of various sizes. The sample correlation matrices from finite samples (<italic>e.g.</italic> <italic>n</italic> = 500 in <xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 3) were contaminated with sampling noise and their underlying structures were difficult to discern.</p>
<p>The evaluation of any covariance matrix estimator, <italic>C</italic>, is performed with respect to a <italic>loss function ℓ</italic>(<italic>C</italic>, Σ) to quantify its discrepancy from the truth, Σ. The loss function is chosen to attain its minimum when <italic>C</italic> = Σ. Here, in the role of the loss function we adopted the Kullback-Leibler divergence between multivariate normal distributions with equal means, scaled by <inline-formula id="pcbi.1004083.e012"><mml:math id="M12" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>2</mml:mn> <mml:mi>p</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> to make its values comparable across different population sizes:
<disp-formula id="pcbi.1004083.e013"><alternatives><graphic id="pcbi.1004083.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e013"/><mml:math id="M13" display="block" overflow="scroll"><mml:mrow><mml:mi>ℓ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mo>Σ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>2</mml:mn> <mml:mi>p</mml:mi></mml:mfrac> <mml:msub><mml:mi>D</mml:mi> <mml:mrow><mml:mi>K</mml:mi> <mml:mi>L</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mo>Σ</mml:mo></mml:msub> <mml:mo>‖</mml:mo> <mml:msub><mml:mi mathvariant="script">N</mml:mi> <mml:mi>C</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>p</mml:mi></mml:mfrac> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtext>Tr</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>C</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>Σ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>+</mml:mo> <mml:mo>ln</mml:mo><mml:mspace width="1pt"/><mml:mi>det</mml:mi><mml:mspace width="1pt"/><mml:mi>C</mml:mi> <mml:mo>−</mml:mo> <mml:mo>ln</mml:mo><mml:mspace width="1pt"/><mml:mi>det</mml:mi><mml:mspace width="1pt"/><mml:mo>Σ</mml:mo> <mml:mo>−</mml:mo> <mml:mi>p</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(9)</label></disp-formula>
Thus <italic>ℓ</italic>(<italic>C</italic>, <italic>Σ</italic>) is expressed in nats/neuron per time bin.</p>
<p>When the ground truth is not accessible, the loss cannot be computed directly but may be estimated from data through <italic>validation</italic>. In a validation procedure, a validation sample covariance matrix <inline-formula id="pcbi.1004083.e014"><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is computed from a testing data set that is independent from the data used for computing <italic>C</italic>. Then the <italic>validation loss</italic> <inline-formula id="pcbi.1004083.e015"><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:mi>ℒ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> measures the discrepancy of <italic>C</italic> from <inline-formula id="pcbi.1004083.e016"><mml:math id="M16" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>. Here, in the role of validation loss, we adopted the negative multivariate normal log likelihood of <italic>C</italic> given <inline-formula id="pcbi.1004083.e017"><mml:math id="M17" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, also scaled by <inline-formula id="pcbi.1004083.e018"><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>2</mml:mn> <mml:mi>p</mml:mi></mml:mfrac></mml:mrow></mml:math></inline-formula> and omitting the constant term:
<disp-formula id="pcbi.1004083.e019"><alternatives><graphic id="pcbi.1004083.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e019"/><mml:math id="M19" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mrow><mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>p</mml:mi></mml:mfrac> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtext>Tr</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msup><mml:mi>C</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo stretchy="false">)</mml:mo> <mml:mo>+</mml:mo> <mml:mo>/</mml:mo><mml:mi mathvariant="normal">ln</mml:mi><mml:mspace width="1pt"/><mml:mi>det</mml:mi><mml:mspace width="1pt"/><mml:mi>C</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(10)</label></disp-formula></p>
<p>Since <inline-formula id="pcbi.1004083.e020"><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:mi mathvariant="script">L(</mml:mi> <mml:mo>⋅</mml:mo> <mml:mo>,</mml:mo> <mml:mspace width="1pt"/> <mml:mo>⋅</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is additive in its second argument and <inline-formula id="pcbi.1004083.e021"><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> is an unbiased estimate of Σ, then, for given <italic>C</italic> and Σ, the validation loss is an unbiased estimate of the true loss, up to a constant:
<disp-formula id="pcbi.1004083.e022"><alternatives><graphic id="pcbi.1004083.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e022"/><mml:math id="M22" display="block" overflow="scroll"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mspace width="1pt"/> <mml:mo>=</mml:mo> <mml:mspace width="1pt"/> <mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mo>Σ</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>ℓ</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>C</mml:mi> <mml:mo>,</mml:mo> <mml:mo>Σ</mml:mo> <mml:mo stretchy="false">)</mml:mo> <mml:mo>+</mml:mo> <mml:mtext>const</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
Therefore, the validation procedure allows comparing the relative values of the loss attained by different covariance matrix estimators even without access to the ground truth.</p>
<p>We drew 30 independent samples with sample sizes <italic>n</italic> = 250, 500, 1000, 2000, and 4000 from each model and computed the loss <italic>ℓ</italic>(<italic>C</italic>, Σ) for each of the five estimators. The hyperparameters of the regularized estimators were optimized by nested cross-validation using only the data in the sample. All the regularized estimators produced better estimates (lower loss) than the sample covariance matrix. However, estimators whose structure matched the true model outperformed the other estimators (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Rows 4 and 5). The validation loss computed by ten-fold cross-validation (see <xref ref-type="sec" rid="sec004">Methods</xref>) accurately reproduced the relative values of the true loss as well as the rankings of the estimators even without access to the ground truth (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 6).</p>
<p>Note that when the ground truth had zero correlations (Column A), <italic>C</italic><sub>factor</sub> performed equally well to <italic>C</italic><sub>diag</sub> because it correctly inferred zero factors and only estimated the individual variances. Similarly, when the number of latent units was zero (Column C), <italic>C</italic><sub>sparse+latent</sub> performed nearly equally well to <italic>C</italic><sub>sparse</sub> because it correctly inferred zero latent units. With increasing sample sizes, all estimators converged to the ground truth (zero loss) but the estimators with correct structure outperformed the others even for large samples.</p>
<p>In Gaussian models, the pairwise partial correlations perfectly characterize the conditional dependencies between the variables. To demonstrate that estimator rankings were robust to deviations from Gaussian models, we repeated the same cross-validated evaluation using pairwise Ising models to generate the data. Ising models have been used to infer functional connectivity from neuronal spike trains [<xref ref-type="bibr" rid="pcbi.1004083.ref056">56</xref>]. Conveniently, the Ising model has equivalent mathematical form to the Gaussian distribution,
<disp-formula id="pcbi.1004083.e023"><alternatives><graphic id="pcbi.1004083.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e023"/><mml:math id="M23" display="block" overflow="scroll"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>∼</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>Z</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>J</mml:mi> <mml:mo>,</mml:mo> <mml:mi>h</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac> <mml:mi>exp</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac> <mml:msup><mml:mi>x</mml:mi> <mml:mo>T</mml:mo></mml:msup> <mml:mi>J</mml:mi> <mml:mi>x</mml:mi> <mml:mo>+</mml:mo> <mml:msup><mml:mi>h</mml:mi> <mml:mo>T</mml:mo></mml:msup> <mml:mi>x</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(12)</label></disp-formula>
but the Ising model is defined on the multivariate binary domain rather than the continuous domain. Both models are maximum-entropy models constrained to match the mean firing rates and the covariance matrix [<xref ref-type="bibr" rid="pcbi.1004083.ref057">57</xref>]. The partition function <italic>Z</italic>(<italic>J</italic>, <italic>h</italic>) normalizes the distributions on the models’ respective domains. In the Gaussian model, the matrix −<italic>J</italic><sup>−1</sup> is the covariance matrix; and the mean values are <italic>μ</italic> = <italic>J</italic><sup>−1</sup> <italic>h</italic>. For the Ising model, <italic>J</italic> is the matrix of pairwise interactions and <italic>h</italic> is the vector of the cells’ individual activity drives, although they do not have a simple relationship to the means and the covariance matrix. Both distributions have the same structure of pairwise conditional dependencies: zeros in the matrix <italic>J</italic> indicate conditional independence between the corresponding pair of neurons.</p>
<p>Indeed, despite their considerable departure from strictly linear conditional dependencies, Ising models yielded the same relationships between the performances of the covariance estimators as the Gaussian models in cross-validation (<xref ref-type="fig" rid="pcbi.1004083.g002">Fig. 2</xref>). Identical interaction matrices <italic>J</italic> of the joint distributions over the observable and latent variables were used for both the Gaussian and the Ising models.</p>
<fig id="pcbi.1004083.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004083.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Performance of covariance estimators on samples drawn from Ising models.</title>
<p><bold>A–D</bold> Validation losses of covariance matrix estimators relative to the estimator whose structure matches the ground truth. The calculation is performed identically to <xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 6 except Ising models are used as ground truth.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004083.g002"/>
</fig>
<p>This simulation study demonstrated that cross-validated evaluation of regularized estimators of the covariance matrices of population activity can discriminate between structures of dependencies in the population. The selection of the most efficient covariance estimators for particular neural circuits is therefore an empirical finding characteristic of the nature of circuit interactions.</p>
</sec>
<sec id="sec002c">
<title>The <italic>C</italic><sub>sparse+latent</sub> estimator is most efficient in neural data</title>
<p>We recorded the calcium activity of densely sampled populations of neurons in layers 2/3 and upper layer 4 in primary visual cortex of sedated mice using fast random-access 3D scanning two-photon microscopy during visual stimulation (<xref ref-type="fig" rid="pcbi.1004083.g003">Fig. 3 A–B</xref>) [<xref ref-type="bibr" rid="pcbi.1004083.ref058">58</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref060">60</xref>]. This technique allowed fast sampling (100–150 Hz) from large numbers (150–350) of cells in 200 × 200 × 100 <italic>μ</italic>m<sup>3</sup> volumes of cortical tissue (<xref ref-type="fig" rid="pcbi.1004083.g003">Fig. 3 C and D</xref>). The instantaneous firing rates were inferred using sparse nonnegative deconvolution [<xref ref-type="bibr" rid="pcbi.1004083.ref061">61</xref>] (<xref ref-type="fig" rid="pcbi.1004083.g003">Fig. 3 C</xref>). Only cells that produced detectable calcium activity were included in the analysis (see <xref ref-type="sec" rid="sec004">Methods</xref>). First, 30 repetitions of full-field drifting gratings of 16 directions were presented in random order. Each grating was played for 500 ms, without intervening blanks. This stimulus was used to compute the orientation tuning of the recorded cells (<xref ref-type="fig" rid="pcbi.1004083.g003">Fig. 3 D</xref>). To estimate the noise correlation matrix, we presented only two distinct directions in some experiments or five directions in others with 100–300 repetitions of each condition. Each grating lasted 1 second and was followed by a 1-second blank. The traces were then binned into 150 ms intervals aligned on the stimulus onset for the estimation of the correlation matrix. The sample correlation coefficients were largely positive and low (<xref ref-type="fig" rid="pcbi.1004083.g003">Fig. 3 E and F</xref>). The average value of the correlation coefficient across sites ranged from 0.0065 to 0.051 with the mean across sites of 0.018.</p>
<fig id="pcbi.1004083.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004083.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Acquisition of neural signals for the estimation of noise correlations.</title>
<p>Visual stimuli comprising full-field drifting gratings interleaved with blank screens (<bold>A</bold>) presented during two-photon recordings of somatic calcium signals using fast 3D random-access microscopy (<bold>B</bold>). <bold>C–F</bold>. Calcium activity data from an example site. <bold>C</bold>. Representative calcium signals of seven cells, downsampled to 20 Hz, out of the 292 total recorded cells. Spiking activity inferred by nonnegative deconvolution is shown by red ticks below the trace. <bold>D</bold>. The spatial arrangement and orientation tuning of the 292 cells from the imaged site. The cells’ colors indicate their orientation preferences. The gray cells were not significantly tuned. <bold>E</bold>. The sample noise correlation matrix of the activity of the neural population. <bold>F</bold>. Histogram of noise correlation coefficients in one site. The red line indicates the mean correlation coefficient of 0.020.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004083.g003"/>
</fig>
<p>In these densely sampled populations, direct interactions between cells are likely to influence the patterns of population activity. We therefore hypothesized that covariance matrix estimators that explicitly modeled the partial correlations between pairs of neurons (<italic>C</italic><sub>sparse</sub> and <italic>C</italic><sub>sparse+latent</sub>) would have a performance advantage. However, the observed neurons must also be strongly influenced by global activity fluctuations and by unobserved common inputs to the advantage of estimators that explicitly model common fluctuations of the entire population: <italic>C</italic><sub>factor</sub> and <italic>C</italic><sub>sparse+latent</sub>. If both types of effects are significant, then <italic>C</italic><sub>sparse+latent</sub> should outperform the other estimators.</p>
<p>To test this hypothesis, we computed the validation loss of estimators <italic>C</italic><sub>sample</sub>, <italic>C</italic><sub>diag</sub>, <italic>C</italic><sub>factor</sub>, <italic>C</italic><sub>sparse</sub>, and <italic>C</italic><sub>sparse+latent</sub> in <italic>n</italic> = 27 imaged sites in 14 mice. The hyperparameters of each estimator were optimized by nested cross-validation (See <xref ref-type="supplementary-material" rid="pcbi.1004083.s001">S1 Fig.</xref> and <xref ref-type="sec" rid="sec004">Methods</xref>). Indeed, the sparse+latent estimator outperformed the other estimators (<xref ref-type="fig" rid="pcbi.1004083.g004">Fig. 4</xref>). The respective median differences of the validation loss were 0.039, 0.0016, 0.0029, and 0.0059 nats/cell/bin, significantly greater than zero (<italic>p</italic> &lt; 0.01 in each comparison, Wilcoxon signed rank test).</p>
<fig id="pcbi.1004083.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004083.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Performance of estimator <italic>C</italic><sub>sparse+latent</sub> expressed as validation loss (<xref ref-type="disp-formula" rid="pcbi.1004083.e019">eq. 10</xref>) relative to the other estimators: <italic>C</italic><sub>sample</sub>, <italic>C</italic><sub>diag</sub>, <italic>C</italic><sub>factor</sub>, and <italic>C</italic><sub>sparse</sub>.</title>
<p>Covariance estimators <italic>C</italic><sub>sample</sub>, <italic>C</italic><sub>diag</sub>, <italic>C</italic><sub>factor</sub>, and <italic>C</italic><sub>sparse</sub> produced consistently greater validation losses than <italic>C</italic><sub>sparse+latent</sub> (<italic>p</italic> &lt; 0.01 in each comparison, Wilcoxon signed rank test, <italic>n</italic> = 27 sites in 14 mice). The box plots indicate the 25<sup><italic>th</italic></sup>, 50<sup><italic>th</italic></sup>, and 75<sup><italic>th</italic></sup> percentiles with the whiskers extending to the minimum and maximum values after excluding the outliers marked with ‘+’.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004083.g004"/>
</fig>
</sec>
<sec id="sec002d">
<title>Structure of <italic>C</italic><sub>sparse+latent</sub> estimates</title>
<p>We examined the composition of the <italic>C</italic><sub>sparse+latent</sub> estimates for each imaged site (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5</xref> and <xref ref-type="fig" rid="pcbi.1004083.g006">Fig. 6</xref>). Although the regularized estimates were similar to the sample correlation matrix (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 A and B</xref>), the corresponding partial correlation matrices differed substantially (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 C and D</xref>). The estimates separated two sources of correlations: a network of linear interactions expressed by the sparse component of the inverse and latent units expressed by the low-rank components of the inverse (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 E</xref>). The sparse partial correlations revealed a network that differed substantially from the network composed of the greatest coefficients in the sample correlation matrix (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 F, G, H, and I</xref>).</p>
<fig id="pcbi.1004083.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004083.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Structure revealed by <italic>C</italic><sub>sparse+latent</sub>.</title>
<p><bold>A, B</bold>. The regularized estimate <italic>C</italic><sub>sparse+latent</sub> closely approximates the sample correlation matrix <italic>C</italic><sub>sample</sub>. <bold>C, D</bold>. The partial correlation matrices from the two estimates differ substantially. <bold>E.</bold> The partial correlation matrix of the regularized estimate is decomposed into a sparse component with 92.8% off-diagonal zeros (bottom-left) and low-rank component of rank 72 (top-right). <bold>F</bold>. The sparse component of the regularized partial correlation matrix had little resemblance to the sample correlations: The gray region indicates the range of correlations containing 92.8% of cells pairs, equal to the fraction of zeros in the sparse partial correlation matrix. Correlation coefficients outside this interval formed the network of greatest correlations. This network differed from the sparse component of the <italic>C</italic><sub>sparse+latent</sub>: Only 27.7% of the highest correlations coefficients outside the gray regions coincided with interactions inferred by <italic>C</italic><sub>sparse+latent</sub>. <bold>G.</bold> A graphical depiction of the positive (green) and negative (magenta) sparse partial correlations as edges between observed neurons. The line weight indicates the magnitude of the partial correlation. <bold>H.</bold> A subset of neurons from the center of the cluster shown in <bold>G</bold> showing the sparse partial correlations. <bold>I</bold>. The same subset of neurons with edges indicating sample correlations thresholded to match the sparsity of the sparse partial correlation. These edges correspond to the sample correlation coefficients outside the gray region in panel F.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004083.g005"/>
</fig>
<fig id="pcbi.1004083.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004083.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Properties of <italic>C</italic><sub>sparse+latent</sub> estimates from all imaged sites.</title>
<p>Each point represents an imaged site with its color indicating the population size as shown in panels A and B. The example site from Figs. <xref ref-type="fig" rid="pcbi.1004083.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1004083.g005">5</xref> is circled in blue.</p>
<p><bold>A.</bold> The number of inferred latent units <italic>vs</italic>. population size. <bold>B.</bold> The connectivity of the sparse component of partial correlations as a function of population size. <bold>C.</bold> The average sample correlations <italic>vs</italic>. the average partial correlations (<xref ref-type="disp-formula" rid="pcbi.1004083.e007">Eq. 4</xref>) of the <italic>C</italic><sub>sparse+latent</sub> estimate. <bold>D.</bold> The percentage of negative interactions vs. connectivity in the <italic>C</italic><sub>sparse+latent</sub> estimates.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004083.g006"/>
</fig>
<p>In the example site (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5</xref>), the sparse component had 92.8% sparsity (or conversely, 7.2% connectivity: connectivity = 1−sparsity) with average node degree of 20.9 (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 G</xref>). The average node degree, <italic>i.e.</italic> the average number of interactions linking each neuron, is related to connectivity as degree = connectivity⋅(<italic>p</italic>−1), where <italic>p</italic> is the number of neurons. The low-rank component had rank 72, denoting 72 inferred latent units. The number of latent units increased with population size (<xref ref-type="fig" rid="pcbi.1004083.g006">Fig. 6 A</xref>) but the connectivity was highly variable (<xref ref-type="fig" rid="pcbi.1004083.g006">Fig. 6 B</xref>): Several sites, despite their large population sizes, were driven by latent units and had few pairwise interactions. This variability may be explained by differences in brain states and recording quality and warrants further investigation.</p>
<p>The average partial correlations calculated from these estimates according to <xref ref-type="disp-formula" rid="pcbi.1004083.e007">Eq. 4</xref> at all 27 sites were about 5 times lower than the average sample correlations (<xref ref-type="fig" rid="pcbi.1004083.g006">Fig. 6 C</xref>). This suggests that correlations between neurons build up from multiple chains of smaller interactions. Furthermore, the average partial correlations were less variable (<italic>p</italic> = 0.002 Brown-Forsythe test): the coefficient of variation of the average sample correlations across sites was 0.45 whereas that of the average partial correlations was 0.29.</p>
<p>While the sample correlations were mostly positive, the sparse component of the partial correlations (‘interactions’) had a high fraction (28.7% in the example site) of negative values (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 F</xref>). The fraction of negative interactions increased with the inferred connectivity (<xref ref-type="fig" rid="pcbi.1004083.g006">Fig. 6 D</xref>), suggesting that negative interactions can be inferred only after a sufficient density of positive interactions has been uncovered.</p>
<p>Thresholded sample correlations have been used in several studies to infer pairwise interactions [<xref ref-type="bibr" rid="pcbi.1004083.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref062">62</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref064">64</xref>]. We therefore compared the interactions in the sparse component of <italic>C</italic><sub>sparse+latent</sub> to those obtained from the sample correlations thresholded to the same level of connectivity. The networks revealed by the two methods differed substantially. In the example site with 7.2% connectivity in <italic>C</italic><sub>sparse+latent</sub>, only 27.7% of the connections coincided with the above-threshold sample correlations (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 F, H, and I</xref>). In particular, most of the inferred negative interactions corresponded to low sample correlations (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 F</xref>) where high correlations are expected given the rest of the correlation matrix.</p>
</sec>
<sec id="sec002e">
<title>Relationship of <italic>C</italic><sub>sparse+latent</sub> to orientation tuning and physical distances</title>
<p>We then examined how the structure of the <italic>C</italic><sub>sparse+latent</sub> estimates related to the differences in orientation preference and to the physical distances separating pairs of cells (<xref ref-type="fig" rid="pcbi.1004083.g007">Fig. 7</xref>). Five sites with highest pairwise connectivities were included in the analysis. Partial correlations were computed using <xref ref-type="disp-formula" rid="pcbi.1004083.e007">Eq. 4</xref> based on the regularized estimate, including both the sparse and the latent component. Connectivity was computed as the fraction of pairs of cells connected by non-zero elements (interactions) in the sparse component of the estimate, segregated into positive and negative connectivities.</p>
<fig id="pcbi.1004083.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004083.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Dependence of sample correlations, regularized partial correlations, and connectivity inferred by <italic>C</italic><sub>sparse+latent</sub> on the differences in preferred orientations, Δori, and physical distances: horizontal Δ<italic>x</italic> and depth Δ<italic>z</italic>.</title>
<p>Five sites with highest connectivity (see <xref ref-type="fig" rid="pcbi.1004083.g006">Fig. 6 B</xref>) were selected for this analysis.</p>
<p><bold>A</bold>–<bold>C.</bold> Mean sample correlations in relation to Δori, Δ<italic>x</italic> and Δ<italic>z</italic>, respectively. For Δ<italic>x</italic> averages, only horizontally aligned cell pairs with Δ<italic>z</italic> &lt; 30 <italic>μm</italic> were considered. Similarly, for Δ<italic>z</italic> averages, only vertically aligned cell pairs with Δ<italic>x</italic> &lt; 30 <italic>μm</italic> were considered.</p>
<p><bold>D</bold>–<bold>F.</bold> Mean partial correlations regularized by the <italic>C</italic><sub>sparse+latent</sub> estimator binned the same way as the sample correlations above. The partial correlations exhibit stronger dependence on Δori, Δ<italic>x</italic>, and Δ<italic>z</italic> than sample correlations.</p>
<p><bold>G</bold>–<bold>I.</bold> Positive connectivity (green) and negative connectivity (red) inferred by the <italic>C</italic><sub>sparse+latent</sub> estimator. Positive and negative connectivities refer to the fractions of the positive and negative partial correlations computed from the sparse component <italic>S</italic> of <italic>C</italic><sub>sparse+latent</sub>. Positive connectivity decreases with Δori, Δ<italic>x</italic>, and Δ<italic>z</italic>. Negative connectivity does not decrease with Δori, Δ<italic>x</italic> within the examined range, and with Δ<italic>z</italic> for small values of Δ<italic>z</italic> &lt; 60 <italic>μm</italic>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004083.g007"/>
</fig>
<p>First, we analyzed how correlations and connectivity depended on the differences in preferred orientations (Δori) of pairs of significantly (<italic>α</italic> = 0.05) tuned cells. The partial correlations decayed more rapidly with Δori than did sample correlations (<xref ref-type="fig" rid="pcbi.1004083.g007">Fig. 7 A and D</xref>. <italic>p</italic> &lt; 10<sup>−9</sup> in each of the five sites, two-sample <italic>t</italic>-test of the difference of the linear regression coefficients in normalized data). Positive connectivity decreased with Δori (<italic>p</italic> &lt; 0.005 in each of the five sites, <italic>t</italic>-test on the logistic regression coefficient) whereas negative connectivity did not decrease (<xref ref-type="fig" rid="pcbi.1004083.g007">Fig. 7 G</xref>): The slope in the logistic model of connectivity with respect to Δori was significantly higher for positive than for negative interactions (<italic>p</italic> &lt; 0.04 in each of the five sites, two-sample <italic>t</italic>-test of the difference of the logistic regression coefficient).</p>
<p>Second, we compared how correlations and connectivity depended on the physical distance separating pairs of cells. We distinguished between the lateral distance, Δ<italic>x</italic>, in the plane parallel to the pia, and the vertical distance, Δ<italic>z</italic>, orthogonal to the pia. When considering the dependence on Δ<italic>x</italic>, the analysis was limited to cell pairs located at the same depth with Δ<italic>z</italic> &lt; 30 <italic>μ</italic>m; conversely, when considering the dependence on Δ<italic>z</italic>, only vertically aligned cell pairs with Δ<italic>x</italic> &lt; 30 <italic>μ</italic>m were included. Again, the partial correlations decayed more rapidly both laterally and vertically than sample correlations (<xref ref-type="fig" rid="pcbi.1004083.g007">Fig. 7 B, C, E, F</xref>. <italic>p</italic> &lt; 10<sup>−6</sup> in each of the five sites, for both lateral and vertical distances, two-sample <italic>t</italic>-test of the difference of the linear regression coefficients in normalized data). Positive connectivity decayed with distance (<italic>p</italic> &lt; 10<sup>−6</sup> in each of the five sites for positive interactions, <italic>t</italic>-test on the logistic regression coefficient in normalized data) (<xref ref-type="fig" rid="pcbi.1004083.g007">Fig. 7 E, H, I</xref>), so that cells separated laterally by less than 25 <italic>μ</italic>m were 3.2 times more likely to be connected than cells separated laterally by more than 150 <italic>μ</italic>m. Although the positive connectivity appeared to decay faster with vertical than with lateral distance, the differences in slopes of the respective logistic regression models were not significant with available data. The negative connectivity decayed slower with distance (<xref ref-type="fig" rid="pcbi.1004083.g007">Fig. 7 H and I</xref>): The slope in the respective logistic models with respect to the lateral distance was significantly higher for positive than for negative connectivities (<italic>p</italic> &lt; 0.05 in each of the five sites, two-sample <italic>t</italic>-test of the difference of the logistic regression coefficients).</p>
</sec>
</sec>
<sec id="sec003" sec-type="conclusions">
<title>Discussion</title>
<sec id="sec003a">
<title>Functional connectivity as a network of pairwise interactions</title>
<p>Functional connectivity is often represented as a graph of pairwise interactions. The goal of many studies of functional connectivity has been to estimate anatomical connectivity from observed multineuronal spiking activity. For example, characteristic peaks and troughs in the pairwise cross-correlograms of recorded spike trains contain statistical signatures of monosynaptic connections and shared synaptic inputs [<xref ref-type="bibr" rid="pcbi.1004083.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref035">35</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref065">65</xref>]. Such signatures are ambiguous as they can arise from network effects other than direct synaptic connections [<xref ref-type="bibr" rid="pcbi.1004083.ref066">66</xref>]. With simultaneous recordings from more neurons, ambiguities can be resolved by inferring the conditional dependencies between pairs of neurons. Direct causal interactions between neurons produce statistical dependency between them even after conditioning on the state of the remainder of the network and external input. Therefore, conditional independence shown statistically can signify the absence of a direct causal influence.</p>
<p>Conditional dependencies can be inferred by fitting a probabilistic model of the joint population activity. For example, generalized linear models (GLMs) have been constructed to include biophysically plausible synaptic integration, membrane kinetics, and individual neurons’ stimulus drive [<xref ref-type="bibr" rid="pcbi.1004083.ref067">67</xref>]. Maximum entropy models constrained by observed pairwise correlations are among other models with pairwise coupling between cells [<xref ref-type="bibr" rid="pcbi.1004083.ref068">68</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref072">72</xref>]. Assuming that the population response follows a multivariate normal distribution, the conditional dependencies between pairs of neurons are expressed by the partial correlations between them. Each probabilistic model, fitted to the same data may reveal a completely different network of ‘interactions’, <italic>i.e.</italic>conditional dependencies between pairs of cells.</p>
<p>It is not yet clear which approach provides the best correspondence with anatomical connectivity. Little experimental evidence is available to answer this question. The connectivity graphs inferred by various statistical methods are commonly reported without examining their relation to anatomy. Topological properties of such graphs have been interpreted as principles of circuit organization (<italic>e.g.</italic> small-world organization) [<xref ref-type="bibr" rid="pcbi.1004083.ref062">62</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref064">64</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref070">70</xref>]. However, the topological properties of functional connectivity graphs can depend on the method of inference [<xref ref-type="bibr" rid="pcbi.1004083.ref073">73</xref>]. Until a physiological interpretation of functional connectivity is established, the physiological relevance of such analyses remains in question and we did not attempt applying graph-theoretical analyses to our results.</p>
<p>Inference of the conditional dependencies also depends on the completeness of the recorded population: To equate conditional dependency to direct interaction between two neurons, we must record from all neurons with which the pair interacts. Unobserved portions of the circuit may manifest as conditional dependencies between observed neurons that do not directly interact. For this reason, statistical models of population activity have been most successfully applied to <italic>in vitro</italic> preparations of the retina or cell cultures where high-quality recordings from the complete populations were available [<xref ref-type="bibr" rid="pcbi.1004083.ref067">67</xref>]. In cortical tissue, electrode arrays record from a small fraction of cells in a given volume, limiting the validity of inference of the pairwise conditional dependencies. Perhaps for this reason, partial correlations have not, until now, been used to describe the functional connectivity in cortical populations.</p>
<p>Two-photon imaging of population calcium signals presents unique advantages for the estimation of functional connectivity. While the temporal resolution of calcium signals is limited by the calcium dye kinetics, fast imaging techniques combined with spike inference algorithms provide millisecond-scale temporal resolution of single action potentials [<xref ref-type="bibr" rid="pcbi.1004083.ref074">74</xref>]. However, such high temporal precision comes at the cost of lower accuracy of inferred spike rates. Better accuracy is achieved when calcium signals are analyzed on scales of tens of milliseconds [<xref ref-type="bibr" rid="pcbi.1004083.ref060">60</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref075">75</xref>]. The major advantage of calcium imaging is its ability to characterize the spatial arrangement and types of recorded cells. Recently, advanced imaging techniques have allowed recording from nearly every cell in a volume of cortical tissue <italic>in vivo</italic> [<xref ref-type="bibr" rid="pcbi.1004083.ref059">59</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref060">60</xref>] and even from entire nervous systems [<xref ref-type="bibr" rid="pcbi.1004083.ref076">76</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref077">77</xref>]. These techniques may provide more incisive measurements of functional connectivity than electrophysiological recordings.</p>
<p>The low temporal resolution of calcium signals limits the use of functional connectivity methods that rely on millisecond-scale binning of signals (cross-correlograms, some GLMs, and binary maximum entropy models). Hence, most studies of functional connectivity have relied on instantaneous sample correlations [<xref ref-type="bibr" rid="pcbi.1004083.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref063">63</xref>]. Although some investigators have interpreted such correlations as indicators of (chemical or electrical) synaptic connectivity, most used them as more general indicators of functional connectivity without relating them to underlying mechanisms.</p>
<p>In this study, we sought to infer pairwise functional connectivity networks in cortical microcircuits. We hypothesized that partial correlations correspond more closely to underlying mechanisms than sample correlations when recordings are sufficiently dense. Since neurons form synaptic connections mostly locally and sparsely [<xref ref-type="bibr" rid="pcbi.1004083.ref078">78</xref>], we <italic>a priori</italic> favored solutions with sparse partial correlations. Under the assumptions that the recorded population is sufficiently complete and that the model correctly represents the nature of interactions, the network of partial correlations can better represent the functional dependencies in the circuit than correlations.</p>
</sec>
<sec id="sec003b">
<title>Functional connectivity as coactivations</title>
<p>Another approach to describing the functional connectivity of a circuit is to isolate individual patterns of multineuronal coactivations. Depending on the method of their extraction, coactivation patterns may be referred to as <italic>assemblies</italic>, <italic>factor loadings</italic>, <italic>principal components</italic>, <italic>independent components</italic>, <italic>activity modes</italic>, <italic>eigenvectors</italic>, or <italic>coactivation maps</italic> [<xref ref-type="bibr" rid="pcbi.1004083.ref079">79</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref084">84</xref>]. Coactivation patterns could be interpreted as signatures of Hebbian cell assemblies, <italic>i.e.</italic> groups of tightly interconnected groups of cells involved in a common computation [<xref ref-type="bibr" rid="pcbi.1004083.ref079">79</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref082">82</xref>]. Coactivation patterns could also result from shared input from unobserved parts of the circuit, or global network fluctuations modulating the activity of the local circuit [<xref ref-type="bibr" rid="pcbi.1004083.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref085">85</xref>].</p>
<p>Coactivation patterns and pairwise connectivity are not mutually exclusive since assemblies arise from patterns of synaptic connectivity. However, an analysis of coactivation shifts the focus from detailed interactions to collective behavior. In our study, the functional connectivity solely through modes of coactivations was represented by the factor analysis-based estimator <italic>C</italic><sub>factor</sub>.</p>
</sec>
<sec id="sec003c">
<title>Combining pairwise interactions and coactivations</title>
<p>In the effort to account for the joint activity patterns that are poorly explained by pairwise interactions, investigators have augmented models of pairwise interactions with additional factors such as latent variables, higher-order correlations, or global network fluctuations [<xref ref-type="bibr" rid="pcbi.1004083.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref086">86</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref089">89</xref>].</p>
<p>In our study, we combined pairwise interactions with collective coactivations by applying the recently developed numerical techniques for the inference of the partial correlation structure in systems with latent variables [<xref ref-type="bibr" rid="pcbi.1004083.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref055">55</xref>]. The resulting estimator, <italic>C</italic><sub>sparse+latent</sub>, effectively decomposed the functional connectivity into a sparse network of pairwise interactions and coactivation mode vectors.</p>
</sec>
<sec id="sec003d">
<title>Addressing ill-posedness</title>
<p>Inferring the conditional dependencies between variables in a probabilistic model often becomes an ill-posed problem: small variations in the data can produce large errors in the inferred network of dependencies (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 C and D</xref>). The problem becomes worse as the number of recorded neurons increases until such models lose their statistical validity [<xref ref-type="bibr" rid="pcbi.1004083.ref090">90</xref>]. As techniques have improved to allow recording from larger neuronal populations, experimental neuroscientists have addressed this problem by extending the recording durations to keep sampling noise in check and verified that existing models are not overfitted [<xref ref-type="bibr" rid="pcbi.1004083.ref087">87</xref>]. However, ambitious projects already underway, such as the BRAIN initiative [<xref ref-type="bibr" rid="pcbi.1004083.ref050">50</xref>], aim to record from significantly larger populations. Simply increasing recording duration will be neither practical nor sufficient, and the problem must be addressed by using regularized estimators. Regularization biases the solution toward a small subspace in order to counteract the effects of sampling noise in the empirical data. However, biasing the solution to an inappropriate subspace does not allow significant estimation improvement and hinders interpretation.</p>
<p>Several strategies have been developed to limit the model space in order to improve the quality of the estimate. For example, Ganmor et al. [<xref ref-type="bibr" rid="pcbi.1004083.ref086">86</xref>] developed a heuristic rule to identify the most significant features that must be fitted by a maximum entropy model for improved performance in the retina. As another example of regularization, generalized linear models typically employ <italic>L</italic><sub>1</sub> penalty terms to constrain the solution space and to effectively reduce the dimensionality of the solution [<xref ref-type="bibr" rid="pcbi.1004083.ref067">67</xref>].</p>
<p>Our study demonstrates regularization schemes empirically optimized for specific types of neural data.</p>
</sec>
<sec id="sec003e">
<title>Model selection</title>
<p>Various model selection criteria have been devised to select between families of models and the optimal subsets of variables in a given model family based on observed data. Despite its high computational demands, cross-validation is among the most popular model selection approaches due to its minimal assumptions about the data-generating process [<xref ref-type="bibr" rid="pcbi.1004083.ref091">91</xref>].</p>
<p>We evaluated the covariance matrix estimators using a loss function derived from the normal distribution. However, this does not limit the applicability of its conclusions to normal distributions. Other probabilistic models, fitted to the same data, could also serve as estimators of the covariance matrix. If a different model yields better estimation of the covariance matrix than the estimator proposed here, we believe that its structure should deserve consideration as the better representation of the functional connectivity.</p>
<p>The results of model selection must be interpreted with caution. As we demonstrated by simulation, even models with incorrect forms of dependencies can substantially improve estimates (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref>). Therefore, showing that a more constrained model has better cross-validated performance than a more complex model does not necessarily support the conclusion that it reveals a better representation of dependencies in the data. This caveat is related to <italic>Stein’s Paradox</italic> [<xref ref-type="bibr" rid="pcbi.1004083.ref092">92</xref>]: The biasing of an estimate toward an arbitrary low-dimensional target can consistently outperform a less constrained estimate.</p>
</sec>
<sec id="sec003f">
<title>Physiological interpretation and future directions</title>
<p>We showed that among several models a sparse network of linear interactions with several latent inputs yielded the best estimates of the noise covariance matrix for cortical microcircuits. This finding is valuable in itself: improved estimates of the noise covariance matrix for large datasets are important in order to understand the role of noise correlations in population coding [<xref ref-type="bibr" rid="pcbi.1004083.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref011">11</xref>]</p>
<p>Moreover, this estimation approach provides a graphical representation of the dependencies in the data that can be used to formulate and test hypotheses about the structure of connectivity in the microcircuit. Importantly, the inferred functional interactions were substantially different from the network of the highest sample correlations. For example, the <italic>C</italic><sub>sparse+latent</sub> estimator reveals a large number of negative interactions that were not present in the sample correlation matrix (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 F</xref>) and may reflect inhibitory circuitry.</p>
<p>Distances between cells in physical space and in sensory feature space had a stronger effect on the partial correlations estimated by the <italic>C</italic><sub>sparse+latent</sub> estimator than on sample correlations (<xref ref-type="fig" rid="pcbi.1004083.g007">Fig. 7 A–F</xref>). These differences support the idea that correlations are built up from partial correlations in chains of intermediate cells positioned closer and tuned more similarly to one another, with potentially closer correspondence to anatomical connectivity. These differences may also be at least partially explained by a trivial effect of regularization: the <italic>L</italic><sub>1</sub> penalty applied by the estimator (<xref ref-type="disp-formula" rid="pcbi.1004083.e036">Eq. 18</xref>) suppresses small partial correlations to a greater extent than large partial correlations, enhancing the apparent effect of distance and tuning. Still, the distinct positive and negative connectivity patterns (<xref ref-type="fig" rid="pcbi.1004083.g007">Fig. 7 G–I</xref>) may reflect geometric and graphical features of local excitatory and inhibitory networks. Indeed, the relationships between patterns of positive and negative connectivities inferred by the estimator resembled the properties of excitatory and inhibitory synaptic connectivities with respect to distance, cortical layers, and feature tuning [<xref ref-type="bibr" rid="pcbi.1004083.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref078">78</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref093">93</xref>–<xref ref-type="bibr" rid="pcbi.1004083.ref098">98</xref>]. For example, while excitatory neurons form synapses within highly specific local cliques [<xref ref-type="bibr" rid="pcbi.1004083.ref078">78</xref>], inhibitory interneurons form synapses with nearly all excitatory cells within local microcircuits [<xref ref-type="bibr" rid="pcbi.1004083.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref096">96</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref099">99</xref>]. To further investigate the link between synaptic connectivity and inferred functional connectivity, in future experiments, we will use molecular markers for various cell types with follow-up multiple whole-cell <italic>in vitro</italic> recordings [<xref ref-type="bibr" rid="pcbi.1004083.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref028">28</xref>] to directly compare the inferred functional connectivity graphs to the underlying anatomical circuitry. Finally, the latent units inferred by the estimator can be analyzed for their physiological functions. For example, these latent units may be modulated under different brain states (e.g. slow-wave sleep, attention) and stimulus conditions (e.g. certain types of stimuli may engage feedback connections) [<xref ref-type="bibr" rid="pcbi.1004083.ref100">100</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref101">101</xref>].</p>
</sec>
</sec>
<sec id="sec004" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec004a">
<title>Ethics statement</title>
<p>All procedures were conducted in accordance with the ethical guidelines of the National Institutes of Health and were approved by the Baylor College of Medicine IACUC.</p>
</sec>
<sec id="sec004b">
<title>Surgery and two-photon imaging</title>
<p>The surgical procedures and data acquisition were performed as described in [<xref ref-type="bibr" rid="pcbi.1004083.ref060">60</xref>]: C57BL/6J mice (aged p40–60) were used. For surgery, animals were initially anesthetized with isoflurane (3%). During the experiments, animals were sedated with a mixture of fentanyl (0.05 mg/kg), midazolam (5 mg/kg), and medetomidine (0.5 mg/kg), with boosts of half the initial dose every 3 hours. A craniotomy was performed over the right primary visual cortex. Membrane-permeant calcium indicator Oregon Green 488 BAPTA-1 AM (OGB-1, Invitrogen) was loaded by bolus injection. The craniotomy was sealed using a glass coverslip secured with dental cement.</p>
<p>Calcium imaging began 1 hour after dye injection. All imaging was performed using 3D-RAMP two-photon microscopy [<xref ref-type="bibr" rid="pcbi.1004083.ref060">60</xref>]. First, a 3D stack was acquired and cells were manually segmented. Then calcium signal were collected by sampling in the center of each cell at rates of 100 Hz or higher, depending on the number of cells.</p>
</sec>
<sec id="sec004c">
<title>Visual stimulus</title>
<p>The visual stimulus consisted of full-field drifting gratings with 90% contrast, 10 cd/m<sup>2</sup> luminance, 0.08 cycles/degree spatial frequency, and 2 cycles/s temporal frequency. Two types of stimuli were presented for each imaging site: First, directional tuning was mapped using a pseudo-random sequence of drifting gratings at sixteen directions of motion, 500 ms per direction, without blanks, with 12–30 trials for each direction of motion. Second, to measure correlations, the stimulus was modified to include only two directions of motion (in 9 datasets) or five directions (in 22 datasets) and the gratings were presented for 1 second and were separated by 1-second blanks, with 100–300 trials for each direction of motion.</p>
</sec>
<sec id="sec004d">
<title>Data processing</title>
<p>All data were processed in MATLAB using the DataJoint data processing chain toolbox (<ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://datajoint.github.com">http://datajoint.github.com</ext-link>).</p>
<p>The measured fluorescent traces were deconvolved to reconstruct the firing rates for each neuron: First, the first principal component was subtracted from the raw traces in order to reduce common mode noise related to small cardiovascular movements [<xref ref-type="bibr" rid="pcbi.1004083.ref060">60</xref>]. The resulting traces were high-pass filtered above 0.1 Hz and downsampled to 20 Hz (<xref ref-type="fig" rid="pcbi.1004083.g003">Fig. 3 C</xref>). Then, the firing rates were estimated using by nonnegative deconvolution [<xref ref-type="bibr" rid="pcbi.1004083.ref061">61</xref>].</p>
<p>Orientation tuning was computed by fitting the mean firing rates for each direction of motion <italic>ϕ</italic> using two-peaked von Mises tuning functions <inline-formula id="pcbi.1004083.e024"><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:mi>f</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mi>a</mml:mi> <mml:mo>+</mml:mo> <mml:mi>b</mml:mi><mml:mspace width="1pt"/><mml:mi>exp</mml:mi> <mml:mrow><mml:mo stretchy="true">[</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>w</mml:mi></mml:mfrac> <mml:mo stretchy="false">(</mml:mo> <mml:mi>cos</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>−</mml:mo> <mml:mi>θ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="true">]</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>c</mml:mi><mml:mspace width="1pt"/><mml:mi>exp</mml:mi> <mml:mrow><mml:mo stretchy="true">[</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>w</mml:mi></mml:mfrac> <mml:mo stretchy="false">(</mml:mo> <mml:mi>cos</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>−</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:mi>π</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:mn>1</mml:mn> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="true">]</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> where <italic>b</italic> ≥ <italic>c</italic> are the amplitudes of the two respective peaks, <italic>w</italic> is the tuning width, and <italic>θ</italic> is the preferred direction. The significance of the fit was determined by the permutation test: the labels of the direction were randomly permuted 10,000 times; the <italic>p</italic>-values of the fits were computed as the fraction of permutations that yielded <italic>R</italic><sup>2</sup> equal to or higher than that of the original data. Cells were considered tuned with <italic>p</italic> &lt; 0.05.</p>
<p>For covariance estimation, the analysis was limited to the period with two or five stimulus conditions and lasted between 14 and 27 minutes (mean 22 minutes). Cells that did not have substantial spiking activity (those whose variance was less than 1% of the median across the site) or whose activity was unstable (those whose variance in the least active quarter of the recording did not exceed 1% of the variance in the most active quarter) were excluded from the analysis.</p>
</sec>
<sec id="sec004e">
<title>Cross-validation</title>
<p>To compare the performance of the estimators, we used conventional 10-fold cross-validation: Trials were randomly divided into 10 subsets with approximately equal numbers of trials of each condition in each subset. Each subset was then used as the testing sample with the rest of the data used as the training sample for estimating the covariance matrix. The average validation loss over the 10 folds was reported.</p>
<p>Since each of the regularized estimators had one or two hyperparameters, we used <italic>nested cross-validation</italic>: The outer loop evaluated the performance of the estimators with the hyperparameter values optimized by cross-validation within the inner loop. Hyperparameters were optimized by a two-phase search algorithm: random search to find a good starting point for the subsequent pattern search to find the global minimum. The inner cross-validation loop subdivided the training dataset from the outer loop to perform 10-fold cross-validation in order to evaluate each choice of the hyperparameter values. Thus the size of the training dataset within the inner loop comprised 81% of the entire recording. <xref ref-type="supplementary-material" rid="pcbi.1004083.s001">S1 Fig.</xref> illustrates the dependence of the validation loss on the hyperparameters of the <italic>C</italic><sub>sparse+latent</sub> estimator for the example site shown in Figs. <xref ref-type="fig" rid="pcbi.1004083.g003">3</xref> and <xref ref-type="fig" rid="pcbi.1004083.g005">5</xref> and the optimal value found by the pattern search algorithm.</p>
<p>When the validation loss was not required, only the inner loop of cross-validation was used on the entire dataset. This approach was used to compute the covariance matrix estimates and their true loss in the simulation study (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Rows 4 and 5) and to analyze the partial correlation structure of the <italic>C</italic><sub>sparse+latent</sub> estimator (<xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5</xref>–<xref ref-type="fig" rid="pcbi.1004083.g007">7</xref>).</p>
</sec>
<sec id="sec004f">
<title>Covariance estimation</title>
<p>Within the inner loop of cross-validation, regularized covariance matrix estimation required only the sample covariance matrix <italic>C</italic><sub>sample</sub> of the training dataset and the hyperparameter values provided by the outer loop.</p>
<p>Estimator <italic>C</italic><sub>diag</sub> (<xref ref-type="disp-formula" rid="pcbi.1004083.e008">Eq. 5</xref>) used two hyperparameters: the covariance shrinkage intensity <italic>λ</italic> ∈ [0, 1] and variance shrinkage intensity <italic>α</italic> ∈ [0, 1]. The variances (the diagonal of <italic>C</italic><sub>sample</sub>) were shrunk linearly toward their mean value <inline-formula id="pcbi.1004083.e025"><mml:math id="M25" display="inline" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>p</mml:mi></mml:mfrac> <mml:mspace width="1pt"/> <mml:mtext>Tr</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula>:
<disp-formula id="pcbi.1004083.e026"><alternatives><graphic id="pcbi.1004083.e026g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e026"/><mml:math id="M26" display="block" overflow="scroll"><mml:mrow><mml:mi>D</mml:mi> <mml:mo>=</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mi>α</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mtext>diag</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>p</mml:mi></mml:mfrac> <mml:mspace width="1pt"/><mml:mtext>Tr</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo> <mml:mi>I</mml:mi></mml:mrow></mml:math></alternatives> <label>(13)</label></disp-formula>
The <italic>C</italic><sub>diag</sub> estimate was then obtained by shrinking <italic>C</italic><sub>sample</sub> toward <italic>D</italic> according to <xref ref-type="disp-formula" rid="pcbi.1004083.e008">Eq. 5</xref>.</p>
<p>In estimator <italic>C</italic><sub>factor</sub> (<xref ref-type="disp-formula" rid="pcbi.1004083.e009">Eq. 6</xref>), the low-rank matrix <italic>L</italic> and the diagonal matrix <italic>D</italic> were found by solving the minimization problem
<disp-formula id="pcbi.1004083.e027"><alternatives><graphic id="pcbi.1004083.e027g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e027"/><mml:math id="M27" display="block" overflow="scroll"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>L</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mrow><mml:mtext>arg</mml:mtext> <mml:mspace width="1pt"/> <mml:mtext>min</mml:mtext></mml:mrow> <mml:mrow><mml:mover><mml:mi>L</mml:mi> <mml:mo>̂</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover><mml:mi>D</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:mrow></mml:munder> <mml:mi>ℒ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mover><mml:mi>L</mml:mi> <mml:mo>̂</mml:mo></mml:mover> <mml:mo>+</mml:mo> <mml:mover><mml:mi>D</mml:mi> <mml:mo>̂</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
using an expectation-maximization (EM) algorithm for a specified rank of <italic>L</italic>. After that, the diagonal of <italic>D</italic> was linearly shrunk toward the its mean diagonal value similar to <xref ref-type="disp-formula" rid="pcbi.1004083.e026">Eq. 13</xref>.</p>
<p>In estimator <italic>C</italic><sub>sparse</sub> (<xref ref-type="disp-formula" rid="pcbi.1004083.e010">Eq. 7</xref>), the sparse precision matrix <italic>S</italic> was found by minimizing the <italic>L</italic><sub>1</sub>-penalized loss with regularization parameter <italic>λ</italic>:
<disp-formula id="pcbi.1004083.e028"><alternatives><graphic id="pcbi.1004083.e028g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e028"/><mml:math id="M28" display="block" overflow="scroll"><mml:mrow><mml:mi>S</mml:mi> <mml:mo>=</mml:mo> <mml:munder><mml:mrow><mml:mtext>arg</mml:mtext> <mml:mspace width="1pt"/> <mml:mtext>min</mml:mtext></mml:mrow> <mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>̂</mml:mo></mml:mover> <mml:mo>≻</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:munder> <mml:mi mathvariant="script">L</mml:mi> <mml:mspace width="1pt"/> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>λ</mml:mi> <mml:mo>‖</mml:mo> <mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mo>‖</mml:mo> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></alternatives> <label>(15)</label></disp-formula>
where <inline-formula id="pcbi.1004083.e029"><mml:math id="M29" display="inline" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>≻</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></inline-formula> denotes the constraint that <inline-formula id="pcbi.1004083.e030"><mml:math id="M30" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula> be a positive-definite matrix and <inline-formula id="pcbi.1004083.e031"><mml:math id="M31" display="inline" overflow="scroll"><mml:mrow><mml:mo>‖</mml:mo><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:msub><mml:mo>‖</mml:mo><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:math></inline-formula> is the element-wise <italic>L</italic><sub>1</sub> norm of the matrix <inline-formula id="pcbi.1004083.e032"><mml:math id="M32" display="inline" overflow="scroll"><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></inline-formula>. This problem formulation is known as <italic>graphical lasso</italic> [<xref ref-type="bibr" rid="pcbi.1004083.ref102">102</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref103">103</xref>]. To solve this minimization problem, we adapted the alternative-direction method of multipliers (ADMM) [<xref ref-type="bibr" rid="pcbi.1004083.ref055">55</xref>]. Unlike <italic>C</italic><sub>diag</sub> and <italic>C</italic><sub>factor</sub>, this estimator does not include linear shrinkage: the selection of the sparsity level provides sufficient flexibility to fine-tune the regularization level.</p>
<p>Estimator <italic>C</italic><sub>sparse+latent</sub> (<xref ref-type="disp-formula" rid="pcbi.1004083.e011">Eq. 8</xref>) estimates a larger sparse precision matrix <italic>S</italic>* of the joint distribution of the <italic>p</italic> observed neurons and <italic>d</italic> latent units.
<disp-formula id="pcbi.1004083.e033"><alternatives><graphic id="pcbi.1004083.e033g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e033"/><mml:math id="M33" display="block" overflow="scroll"><mml:mrow><mml:msup><mml:mi>S</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>S</mml:mi></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mn>12</mml:mn></mml:mrow> <mml:mo>T</mml:mo></mml:msubsup></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mn>22</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(16)</label></disp-formula>
where the <italic>p</italic> × <italic>p</italic> partition <italic>S</italic> corresponds to the visible units. Then the covariance matrix of the observed population is
<disp-formula id="pcbi.1004083.e034"><alternatives><graphic id="pcbi.1004083.e034g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e034"/><mml:math id="M34" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sparse</mml:mtext> <mml:mo>+</mml:mo> <mml:mtext>latent</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>S</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub> <mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mn>22</mml:mn></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mn>12</mml:mn></mml:mrow> <mml:mo>T</mml:mo></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(17)</label></disp-formula>
The rank of the <italic>p</italic>×<italic>p</italic> matrix <inline-formula id="pcbi.1004083.e035"><mml:math id="M35" display="inline" overflow="scroll"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>S</mml:mi> <mml:mrow><mml:mn>12</mml:mn></mml:mrow></mml:msub> <mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mn>22</mml:mn></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>S</mml:mi> <mml:mrow><mml:mn>12</mml:mn></mml:mrow> <mml:mo>T</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> matches the number of the latent units in the joint distribution. Rather than finding <italic>S</italic><sub>12</sub> and <italic>S</italic><sub>22</sub> separately, <italic>L</italic> can be estimated as a low-rank positive semidefinite matrix. To simultaneously optimize the sparse component <italic>S</italic> and the low-rank component <italic>L</italic>, we adapted the loss function with an <italic>L</italic><sub>1</sub> penalty on <italic>S</italic> and another penalty on the trace of <italic>L</italic> [<xref ref-type="bibr" rid="pcbi.1004083.ref054">54</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref055">55</xref>]:
<disp-formula id="pcbi.1004083.e036"><alternatives><graphic id="pcbi.1004083.e036g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e036"/><mml:math id="M36" display="block" overflow="scroll"><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>S</mml:mi> <mml:mo>,</mml:mo> <mml:mi>L</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:munder><mml:mrow><mml:mtext>arg</mml:mtext> <mml:mspace width="1pt"/> <mml:mtext>min</mml:mtext></mml:mrow> <mml:mrow><mml:mover><mml:mi>S</mml:mi> <mml:mo>̂</mml:mo></mml:mover> <mml:mo>,</mml:mo> <mml:mover><mml:mi>L</mml:mi> <mml:mo>̂</mml:mo></mml:mover></mml:mrow></mml:munder><mml:mspace width="1pt"/><mml:mi mathvariant="script">L</mml:mi> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>−</mml:mo> <mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>,</mml:mo> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi> <mml:mo>‖</mml:mo> <mml:mover accent="true"><mml:mi>S</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:msub><mml:mo>‖</mml:mo> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>β</mml:mi> <mml:mspace width="1pt"/> <mml:mtext>Tr</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mover accent="true"><mml:mi>L</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives> <label>(18)</label></disp-formula>
The trace of a symmetric semidefinite matrix equals the sum of the absolute values of its eigenvalues, <italic>i.e.</italic> its <italic>nuclear norm</italic>; penalty on Tr(<italic>L</italic>) favors solutions with few non-zero eigenvalues or, equivalently, low-rank solutions while keeping the convexity of the overall optimization problem [<xref ref-type="bibr" rid="pcbi.1004083.ref104">104</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref105">105</xref>]. This allows using convex optimization algorithm such as ADMM to be applied with great computational efficiency [<xref ref-type="bibr" rid="pcbi.1004083.ref055">55</xref>].</p>
<p>The partial correlation matrix (<xref ref-type="disp-formula" rid="pcbi.1004083.e007">Eq. 4</xref>) computed from <italic>C</italic><sub>sparse+latent</sub> includes interactions between the visible and latent units and was used in <xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 C and D</xref> and <xref ref-type="fig" rid="pcbi.1004083.g006">Fig. 6 C</xref>, and <xref ref-type="fig" rid="pcbi.1004083.g007">Fig. 7 D–F</xref>). The partial correlation matrix computed from <italic>S</italic> alone expresses strengths of pairwise interactions
<disp-formula id="pcbi.1004083.e037"><alternatives><graphic id="pcbi.1004083.e037g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e037"/><mml:math id="M37" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>P</mml:mi> <mml:mrow><mml:mtext>sparse</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mo>−</mml:mo> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mtext>diag</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mi>S</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup> <mml:mi>S</mml:mi> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mtext>diag</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mi>S</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives> <label>(19)</label></disp-formula>
and were used in <xref ref-type="fig" rid="pcbi.1004083.g005">Fig. 5 F, G, H</xref>.</p>
<p>The MATLAB code for these computations is available online at <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="http://github.com/atlab/cov-est">http://github.com/atlab/cov-est</ext-link>.</p>
</sec>
<sec id="sec004g">
<title>Cross-validation with conditioned variances</title>
<p>Special attention was given to estimating the variances. All evaluations and optimization in this study were defined with respect to the covariance matrices. However, neuroscientists often estimate a common correlation matrix across multiple stimulus conditions when the variances of responses are conditioned on the stimulus [<xref ref-type="bibr" rid="pcbi.1004083.ref106">106</xref>, <xref ref-type="bibr" rid="pcbi.1004083.ref107">107</xref>]. In this study, we too conditioned the variances on the stimulus but estimated a single correlation matrix across all conditions. Here we describe the computation of the validation loss (<xref ref-type="disp-formula" rid="pcbi.1004083.e019">Eq. 10</xref>) when the variances were allowed to vary with the stimulus condition.</p>
<p>Let <italic>T</italic><sub><italic>c</italic></sub> and <inline-formula id="pcbi.1004083.e038"><mml:math id="M38" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi> <mml:mi>c</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> denote the sets of time bin indices for the training and testing samples, respectively, limited to condition <italic>c</italic>.</p>
<p>Similar to <xref ref-type="disp-formula" rid="pcbi.1004083.e004">Eq. 2</xref>, the training and testing sample covariance matrices for condition <italic>c</italic> are
<disp-formula id="pcbi.1004083.e039"><alternatives><graphic id="pcbi.1004083.e039g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e039"/><mml:math id="M39" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>c</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>c</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>T</mml:mo></mml:msup></mml:mrow></mml:math></alternatives> <label>(20)</label></disp-formula>
and
<disp-formula id="pcbi.1004083.e040"><alternatives><graphic id="pcbi.1004083.e040g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e040"/><mml:math id="M40" display="block" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>c</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msubsup><mml:mi>T</mml:mi> <mml:mi>c</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:munder> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>c</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>x</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>−</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mi>c</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>T</mml:mo></mml:msup></mml:mrow></mml:math></alternatives> <label>(21)</label></disp-formula>
Here <italic>n</italic><sub><italic>c</italic></sub> and <inline-formula id="pcbi.1004083.e041"><mml:math id="M41" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>c</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> denote the sizes of <italic>T</italic><sub><italic>c</italic></sub> and <inline-formula id="pcbi.1004083.e042"><mml:math id="M42" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>T</mml:mi> <mml:mi>c</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula>, respectively.</p>
<p>Note that <inline-formula id="pcbi.1004083.e043"><mml:math id="M43" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mover><mml:mi>x</mml:mi> <mml:mo accent="true">‾</mml:mo></mml:mover> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:msub><mml:mi>n</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mfrac> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mi>x</mml:mi> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></inline-formula> is estimated from the training sample but used in both estimates, making <inline-formula id="pcbi.1004083.e044"><mml:math id="M44" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> an unbiased estimate of the true covariance matrix, Σ. As such, <inline-formula id="pcbi.1004083.e045"><mml:math id="M45" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:math></inline-formula> can be used for validation.</p>
<p>The common correlation matrix <italic>R</italic><sub>sample</sub> is estimated by averaging the condition-specific correlations:
<disp-formula id="pcbi.1004083.e046"><alternatives><graphic id="pcbi.1004083.e046g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e046"/><mml:math id="M46" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>c</mml:mi></mml:munder> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mstyle> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>c</mml:mi></mml:munder> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>T</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:munder> <mml:mi>z</mml:mi></mml:mstyle></mml:mrow></mml:mstyle> <mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mi>z</mml:mi> <mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo> <mml:mi>t</mml:mi> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>T</mml:mo></mml:msup> <mml:mo>,</mml:mo></mml:mrow></mml:math></alternatives> <label>(22)</label></disp-formula>
where <inline-formula id="pcbi.1004083.e047"><mml:math id="M47" display="inline" overflow="scroll"><mml:mrow><mml:mi>n</mml:mi> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>c</mml:mi></mml:munder> <mml:msub><mml:mi>n</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:math></inline-formula> and <italic>V</italic><sub><italic>c</italic>, sample</sub> = diag(<italic>C</italic><sub><italic>c</italic>, sample</sub>) is the diagonal matrix containing the sample variances. Then <italic>R</italic><sub>sample</sub> is simply the covariance matrix of the <italic>z</italic>-score signal <inline-formula id="pcbi.1004083.e048"><mml:math id="M48" display="inline" overflow="scroll"><mml:mrow><mml:mi>z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>V</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mo>,</mml:mo><mml:mtext>sample</mml:mtext></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></inline-formula> of the training sample.</p>
<p>For consistency with prior work, we applied regularization to covariance matrices rather than to correlation matrices. The common covariance matrix was estimated by scaling <italic>R</italic><sub>sample</sub> by the average variances across conditions <inline-formula id="pcbi.1004083.e049"><mml:math id="M49" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>n</mml:mi></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>c</mml:mi></mml:munder> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mstyle> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula>:
<disp-formula id="pcbi.1004083.e050"><alternatives><graphic id="pcbi.1004083.e050g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e050"/><mml:math id="M50" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow></mml:msub> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives> <label>(23)</label></disp-formula>
Note that <italic>C</italic><sub>sample</sub> differs from the sample covariance matrix computed without conditioning the variances on <italic>c</italic> and this computation helps avoid any biases that would be introduced by ignoring changes in variance.</p>
<p>The covariance matrix estimators <italic>C</italic><sub>diag</sub>, <italic>C</italic><sub>factor</sub>, <italic>C</italic><sub>sparse</sub> or <italic>C</italic><sub>sparse+latent</sub> convert <italic>C</italic><sub>sample</sub> into its regularized counterpart denoted here as <italic>C</italic><sub>reg</sub>.</p>
<p>To evaluate the estimators, we regularized the conditioned variances by linear shrinkage toward their mean value across all conditions. This was done by scaling <italic>C</italic><sub>reg</sub> by the conditioned variance adjustment matrix <inline-formula id="pcbi.1004083.e051"><mml:math id="M51" display="inline" overflow="scroll"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mi>δ</mml:mi> <mml:mi>I</mml:mi> <mml:mo>+</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:mi>δ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:msubsup><mml:mi>V</mml:mi> <mml:mrow><mml:mtext>sample</mml:mtext></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msubsup> <mml:msub><mml:mi>V</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow></mml:msub></mml:mrow></mml:math></inline-formula> to produce the conditioned regularized covariance matrix estimate:
<disp-formula id="pcbi.1004083.e052"><alternatives><graphic id="pcbi.1004083.e052g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e052"/><mml:math id="M52" display="block" overflow="scroll"><mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>reg</mml:mtext></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup> <mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mtext>reg</mml:mtext></mml:mrow></mml:msub> <mml:msubsup><mml:mi>Q</mml:mi> <mml:mi>c</mml:mi> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives> <label>(24)</label></disp-formula></p>
<p>The variance regularization parameter <italic>δ</italic> ∈ [0, 1] was optimized in the inner loop of cross-validation along with the other hyperparameters.</p>
<p>The overall validation loss is obtained by averaging the validation losses across all conditions:
<disp-formula id="pcbi.1004083.e053"><alternatives><graphic id="pcbi.1004083.e053g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004083.e053"/><mml:math id="M53" display="block" overflow="scroll"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>c</mml:mi></mml:munder> <mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>c</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>c</mml:mi></mml:munder> <mml:mrow><mml:msubsup><mml:mi>n</mml:mi> <mml:mi>c</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow></mml:mstyle> <mml:mi mathvariant="script">L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>C</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>reg</mml:mtext></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>C</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>sample</mml:mtext></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(25)</label></disp-formula></p>
<p>With negative normal log-likelihood as the validation loss (<xref ref-type="disp-formula" rid="pcbi.1004083.e019">Eq. 10</xref>) and the unbiased validation covariance matrix <italic>C</italic><sub><italic>c</italic>, sample</sub>, the loss function in <xref ref-type="disp-formula" rid="pcbi.1004083.e053">Eq. 25</xref> is an unbiased estimate of the true loss. Hence, it was used for evaluations reported in <xref ref-type="fig" rid="pcbi.1004083.g004">Fig. 4</xref>.</p>
</sec>
<sec id="sec004h">
<title>Simulation</title>
<p>For simulation, ground truth covariance matrices were produced by taking 150 independent samples from an artificial population of 50 independent, identically normally distributed units. The covariance matrices were then subjected to the respective regularizations to produce the ground truth matrices for the simulation studies (<xref ref-type="fig" rid="pcbi.1004083.g001">Fig. 1</xref> Row 2). Samples were then drawn from multivariate normal distributions models with the respective true covariance matrices to be estimated by each of the estimators. For Ising models, the negative inverse of the true covariance matrix was used as the matrix of coupling coefficients and the sampling was performed by the Metropolis-Hastings algorithm.</p>
</sec>
</sec>
<sec id="sec005">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004083.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004083.s001" mimetype="application/postscript" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Optimization of hyperparameters of the <italic>C</italic><sub>sparse+latent</sub> estimator.</title>
<p><bold>A.</bold> Validation loss (<xref ref-type="disp-formula" rid="pcbi.1004083.e053">Eq. 25</xref>) for the example site in <xref ref-type="fig" rid="pcbi.1004083.g003">Fig. 3</xref> and <xref ref-type="fig" rid="pcbi.1004083.g005">5</xref> as a function of the hyperparameters <italic>α</italic> and <italic>β</italic> of the <italic>C</italic><sub>sparse+latent</sub> estimator (<xref ref-type="disp-formula" rid="pcbi.1004083.e011">Eq. 8</xref> and <xref ref-type="disp-formula" rid="pcbi.1004083.e036">Eq. 18</xref>). In all panels, the red cross marks the optimal value found by the pattern search algorithm described in Methods. <bold>B.</bold> The connectivity (1 − sparsity) of the sparse component <italic>S</italic> as a function of <italic>α</italic> and <italic>β</italic> for the example site. <bold>C.</bold> The number of latent units, <italic>i.e.</italic> the rank of the low-rank component <italic>L</italic>, as a function of hyperparameters <italic>α</italic> and <italic>β</italic>. <bold>D.</bold> The loss function as a function of the connectivity and the number of latent units.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Genevera Allen for a helpful discussion, and Eftychios Pnevmatikakis for helpful suggestions and feedback on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004083.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Pouget</surname> <given-names>A</given-names></name> (<year>2006</year>) <article-title>Neural correlations, population coding and computation</article-title>. <source>Nat Rev Neurosci</source> <volume>7</volume>: <fpage>358</fpage>–<lpage>366</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrn1888" xlink:type="simple">10.1038/nrn1888</ext-link></comment> <object-id pub-id-type="pmid">16760916</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zohary</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Newsome</surname> <given-names>WT</given-names></name> (<year>1994</year>) <article-title>Correlated neuronal discharge rate and its implications for psychophysical performance</article-title>. <source>Nature</source> <volume>370</volume>: <fpage>140</fpage>–<lpage>143</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/370140a0" xlink:type="simple">10.1038/370140a0</ext-link></comment> <object-id pub-id-type="pmid">8022482</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kohn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name> (<year>2005</year>) <article-title>Stimulus dependence of neuronal correlation in primary visual cortex of the macaque</article-title>. <source>J Neurosci</source> <volume>25</volume>: <fpage>3661</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5106-04.2005" xlink:type="simple">10.1523/JNEUROSCI.5106-04.2005</ext-link></comment> <object-id pub-id-type="pmid">15814797</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bair</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Zohary</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Newsome</surname> <given-names>WT</given-names></name> (<year>2001</year>) <article-title>Correlated firing in macaque visual area mt: time scales and relationship to behavior</article-title>. <source>The journal of Neuroscience</source> <volume>21</volume>: <fpage>1676</fpage>–<lpage>1697</lpage>. <object-id pub-id-type="pmid">11222658</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ecker</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Keliris</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Bethge</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Logothetis</surname> <given-names>NK</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Decorrelated neuronal firing in cortical microcircuits</article-title>. <source>Science</source> <volume>327</volume>: <fpage>584</fpage>–<lpage>587</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1179867" xlink:type="simple">10.1126/science.1179867</ext-link></comment> <object-id pub-id-type="pmid">20110506</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Abbott</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name> (<year>1999</year>) <article-title>The effect of correlated variability on the accuracy of a population code</article-title>. <source>Neural computation</source> <volume>11</volume>: <fpage>91</fpage>–<lpage>101</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/089976699300016827" xlink:type="simple">10.1162/089976699300016827</ext-link></comment> <object-id pub-id-type="pmid">9950724</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sompolinsky</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Yoon</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kang</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shamir</surname> <given-names>M</given-names></name> (<year>2001</year>) <article-title>Population coding in neuronal systems with correlated noise</article-title>. <source>Physical Review E</source> <volume>64</volume>: <fpage>051904</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.64.051904" xlink:type="simple">10.1103/PhysRevE.64.051904</ext-link></comment> <object-id pub-id-type="pmid">11735965</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Nirenberg</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name> (<year>2003</year>) <article-title>Decoding neuronal spike trains: How important are correlations?</article-title> <source>Proceedings of the National Academy of Sciences</source> <volume>100</volume>: <fpage>7348</fpage>–<lpage>7353</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1131895100" xlink:type="simple">10.1073/pnas.1131895100</ext-link></comment> <object-id pub-id-type="pmid">12775756</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Josic</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shea-Brown</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Doiron</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>de la Rocha</surname> <given-names>J</given-names></name> (<year>2009</year>) <article-title>Stimulus-dependent correlations and population codes</article-title>. <source>Neural computation</source> <volume>21</volume>: <fpage>2774</fpage>–<lpage>2804</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/neco.2009.10-08-879" xlink:type="simple">10.1162/neco.2009.10-08-879</ext-link></comment> <object-id pub-id-type="pmid">19635014</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ecker</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Gerwinn</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tolias</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Bethge</surname> <given-names>M</given-names></name> (<year>2011</year>) <article-title>Reassessing optimal neural population codes with neurometric functions</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>4423</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1015904108" xlink:type="simple">10.1073/pnas.1015904108</ext-link></comment> <object-id pub-id-type="pmid">21368193</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ecker</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Tolias</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Bethge</surname> <given-names>M</given-names></name> (<year>2011</year>) <article-title>The effect of noise correlations in populations of diversely tuned neurons</article-title>. <source>The Journal of Neuroscience</source> <volume>31</volume>: <fpage>14272</fpage>–<lpage>14283</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2539-11.2011" xlink:type="simple">10.1523/JNEUROSCI.2539-11.2011</ext-link></comment> <object-id pub-id-type="pmid">21976512</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gerstein</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>W</given-names></name> (<year>1964</year>) <article-title>Simultaneous studies of firing patterns in several neurons</article-title>. <source>Science</source> <volume>143</volume>: <fpage>1325</fpage>–<lpage>1327</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.143.3612.1325" xlink:type="simple">10.1126/science.143.3612.1325</ext-link></comment> <object-id pub-id-type="pmid">17799237</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Kohn</surname> <given-names>A</given-names></name> (<year>2008</year>) <article-title>Spatial and temporal scales of neuronal correlation in primary visual cortex</article-title>. <source>J Neurosci</source> <volume>28</volume>: <fpage>12591</fpage>–<lpage>12603</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2929-08.2008" xlink:type="simple">10.1523/JNEUROSCI.2929-08.2008</ext-link></comment> <object-id pub-id-type="pmid">19036953</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Denman</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Contreras</surname> <given-names>D</given-names></name> (<year>2013</year>) <article-title>The structure of pairwise correlation in mouse primary visual cortex reveals functional organization in the absence of an orientation map</article-title>. <source>Cereb Cortex</source>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bht128" xlink:type="simple">10.1093/cercor/bht128</ext-link></comment> <object-id pub-id-type="pmid">23689635</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Pichler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Buchanan</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Sjöström</surname> <given-names>PJ</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Functional specificity of local synaptic connections in neocortical networks</article-title>. <source>Nature</source> <volume>473</volume>: <fpage>87</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature09880" xlink:type="simple">10.1038/nature09880</ext-link></comment> <object-id pub-id-type="pmid">21478872</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Arieli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shoham</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hildesheim</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Grinvald</surname> <given-names>A</given-names></name> (<year>1995</year>) <article-title>Coherent spatiotemporal patterns of ongoing activity revealed by real-time optical imaging coupled with single-unit recording in the cat visual cortex</article-title>. <source>Journal of Neurophysiology</source> <volume>73</volume>: <fpage>2072</fpage>–<lpage>2093</lpage>. <object-id pub-id-type="pmid">7623099</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chiu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Weliky</surname> <given-names>M</given-names></name> (<year>2002</year>) <article-title>Relationship of correlated spontaneous activity to functional ocular dominance columns in the developing visual cortex</article-title>. <source>Neuron</source> <volume>35</volume>: <fpage>1123</fpage>–<lpage>1134</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0896-6273(02)00867-X" xlink:type="simple">10.1016/S0896-6273(02)00867-X</ext-link></comment> <object-id pub-id-type="pmid">12354401</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kenet</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bibitchkov</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tsodyks</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Grinvald</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Arieli</surname> <given-names>A</given-names></name> (<year>2003</year>) <article-title>Spontaneously emerging cortical representations of visual attributes</article-title>. <source>Nature</source> <volume>425</volume>: <fpage>954</fpage>–<lpage>956</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature02078" xlink:type="simple">10.1038/nature02078</ext-link></comment> <object-id pub-id-type="pmid">14586468</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cohen</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Newsome</surname> <given-names>WT</given-names></name> (<year>2008</year>) <article-title>Context-dependent changes in functional circuitry in visual area mt</article-title>. <source>Neuron</source> <volume>60</volume>: <fpage>162</fpage>–<lpage>173</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2008.08.007" xlink:type="simple">10.1016/j.neuron.2008.08.007</ext-link></comment> <object-id pub-id-type="pmid">18940596</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cohen</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Maunsell</surname> <given-names>JH</given-names></name> (<year>2009</year>) <article-title>Attention improves performance primarily by reducing interneuronal correlations</article-title>. <source>Nature neuroscience</source> <volume>12</volume>: <fpage>1594</fpage>–<lpage>1600</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2439" xlink:type="simple">10.1038/nn.2439</ext-link></comment> <object-id pub-id-type="pmid">19915566</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref021">
<label>21</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rothschild</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Nelken</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Mizrahi</surname> <given-names>A</given-names></name> (<year>2010</year>) <article-title>Functional organization and population dynamics in the mouse primary auditory cortex</article-title>. <source>Nature neuroscience</source> <volume>13</volume>: <fpage>353</fpage>–<lpage>360</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2484" xlink:type="simple">10.1038/nn.2484</ext-link></comment> <object-id pub-id-type="pmid">20118927</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref022">
<label>22</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Sommer</surname> <given-names>MA</given-names></name> (<year>2013</year>) <article-title>Spatial and temporal scales of neuronal correlation in visual area v4</article-title>. <source>The Journal of Neuroscience</source> <volume>33</volume>: <fpage>5422</fpage>–<lpage>5432</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.4782-12.2013" xlink:type="simple">10.1523/JNEUROSCI.4782-12.2013</ext-link></comment> <object-id pub-id-type="pmid">23516307</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref023">
<label>23</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hofer</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Pichler</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Vogelstein</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ros</surname> <given-names>H</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Differential connectivity and response dynamics of excitatory and inhibitory neurons in visual cortex</article-title>. <source>Nature neuroscience</source> <volume>14</volume>: <fpage>1045</fpage>–<lpage>1052</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2876" xlink:type="simple">10.1038/nn.2876</ext-link></comment> <object-id pub-id-type="pmid">21765421</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref024">
<label>24</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Hansen</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Chelaru</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Dragoi</surname> <given-names>V</given-names></name> (<year>2012</year>) <article-title>Correlated variability in laminar cortical circuits</article-title>. <source>Neuron</source> <volume>76</volume>: <fpage>590</fpage>–<lpage>602</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2012.08.029" xlink:type="simple">10.1016/j.neuron.2012.08.029</ext-link></comment> <object-id pub-id-type="pmid">23141070</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref025">
<label>25</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Jia</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zandvakili</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kohn</surname> <given-names>A</given-names></name> (<year>2013</year>) <article-title>Laminar dependence of neuronal correlations in visual cortex</article-title>. <source>Journal of neurophysiology</source> <volume>109</volume>: <fpage>940</fpage>–<lpage>947</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.00846.2012" xlink:type="simple">10.1152/jn.00846.2012</ext-link></comment> <object-id pub-id-type="pmid">23197461</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref026">
<label>26</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Golshani</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Gonçalves</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Khoshkhoo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Mostany</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Smirnakis</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Internally mediated developmental desynchronization of neocortical network activity</article-title>. <source>J Neurosci</source> <volume>29</volume>: <fpage>10890</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.2012-09.2009" xlink:type="simple">10.1523/JNEUROSCI.2012-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19726647</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref027">
<label>27</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fetsch</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Fok</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Perceptual learning reduces interneuronal correlations in macaque visual cortex</article-title>. <source>Neuron</source> <volume>71</volume>: <fpage>750</fpage>–<lpage>761</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2011.06.015" xlink:type="simple">10.1016/j.neuron.2011.06.015</ext-link></comment> <object-id pub-id-type="pmid">21867889</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref028">
<label>28</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ko</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cossell</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Baragli</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Antolik</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Clopath</surname> <given-names>C</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>The emergence of functional microcircuits in visual cortex</article-title>. <source>Nature</source> <volume>496</volume>: <fpage>96</fpage>–<lpage>100</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12015" xlink:type="simple">10.1038/nature12015</ext-link></comment> <object-id pub-id-type="pmid">23552948</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref029">
<label>29</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Greenberg</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Houweling</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Kerr</surname> <given-names>JN</given-names></name> (<year>2008</year>) <article-title>Population imaging of ongoing neuronal activity in the visual cortex of awake rats</article-title>. <source>Nature neuroscience</source> <volume>11</volume>: <fpage>749</fpage>–<lpage>751</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2140" xlink:type="simple">10.1038/nn.2140</ext-link></comment> <object-id pub-id-type="pmid">18552841</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref030">
<label>30</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Goard</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dan</surname> <given-names>Y</given-names></name> (<year>2009</year>) <article-title>Basal forebrain activation enhances cortical coding of natural scenes</article-title>. <source>Nat Neurosci</source> <volume>12</volume>: <fpage>1444</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nn.2402" xlink:type="simple">10.1038/nn.2402</ext-link></comment> <object-id pub-id-type="pmid">19801988</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref031">
<label>31</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kohn</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Zandvakili</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>MA</given-names></name> (<year>2009</year>) <article-title>Correlations and brain states: from electrophysiology to functional imaging</article-title>. <source>Curr Opin Neurobiol</source> <volume>19</volume>: <fpage>434</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2009.06.007" xlink:type="simple">10.1016/j.conb.2009.06.007</ext-link></comment> <object-id pub-id-type="pmid">19608406</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref032">
<label>32</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ecker</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cotton</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Subramaniyan</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Denfield</surname> <given-names>GH</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>State dependence of noise correlations in macaque primary visual cortex</article-title>. <source>Neuron</source> <volume>82</volume>: <fpage>235</fpage>–<lpage>248</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2014.02.006" xlink:type="simple">10.1016/j.neuron.2014.02.006</ext-link></comment> <object-id pub-id-type="pmid">24698278</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref033">
<label>33</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Renart</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>de la Rocha</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bartho</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hollender</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Parga</surname> <given-names>N</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The asynchronous state in cortical circuits</article-title>. <source>Science</source> <volume>327</volume>: <fpage>587</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1179850" xlink:type="simple">10.1126/science.1179850</ext-link></comment> <object-id pub-id-type="pmid">20110507</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref034">
<label>34</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Perkel</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Gerstein</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>GP</given-names></name> (<year>1967</year>) <article-title>Neuronal spike trains and stochastic point processes: II. simultaneous spike trains</article-title>. <source>Biophysical journal</source> <volume>7</volume>: <fpage>419</fpage>–<lpage>440</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(67)86597-4" xlink:type="simple">10.1016/S0006-3495(67)86597-4</ext-link></comment> <object-id pub-id-type="pmid">4292792</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref035">
<label>35</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Moore</surname> <given-names>GP</given-names></name>, <name name-style="western"><surname>Segundo</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Perkel</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Levitan</surname> <given-names>H</given-names></name> (<year>1970</year>) <article-title>Statistical signs of synaptic interaction in neurons</article-title>. <source>Biophysical Journal</source> <volume>10</volume>: <fpage>876</fpage>–<lpage>900</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(70)86341-X" xlink:type="simple">10.1016/S0006-3495(70)86341-X</ext-link></comment> <object-id pub-id-type="pmid">4322240</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref036">
<label>36</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Shadlen</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Newsome</surname> <given-names>WT</given-names></name> (<year>1998</year>) <article-title>The variable discharge of cortical neurons: implications for connectivity, computation, and information coding</article-title>. <source>J Neurosci</source> <volume>18</volume>: <fpage>3870</fpage>–<lpage>96</lpage>. <object-id pub-id-type="pmid">9570816</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref037">
<label>37</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Salinas</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name> (<year>2001</year>) <article-title>Correlated neuronal activity and the flow of neural information</article-title>. <source>Nature Reviews Neuroscience</source> <volume>2</volume>: <fpage>539</fpage>–<lpage>550</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/35086012" xlink:type="simple">10.1038/35086012</ext-link></comment> <object-id pub-id-type="pmid">11483997</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref038">
<label>38</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ostojic</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Brunel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hakim</surname> <given-names>V</given-names></name> (<year>2009</year>) <article-title>How connectivity, background activity, and synaptic properties shape the cross-correlation between spike trains</article-title>. <source>The Journal of Neuroscience</source> <volume>29</volume>: <fpage>10234</fpage>–<lpage>10253</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1275-09.2009" xlink:type="simple">10.1523/JNEUROSCI.1275-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19692598</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref039">
<label>39</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Rosenbaum</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Josić</surname> <given-names>K</given-names></name> (<year>2011</year>) <article-title>Mechanisms that modulate the transfer of spiking correlations</article-title>. <source>Neural computation</source> <volume>23</volume>: <fpage>1261</fpage>–<lpage>1305</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00116" xlink:type="simple">10.1162/NECO_a_00116</ext-link></comment> <object-id pub-id-type="pmid">21299426</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref040">
<label>40</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Whittaker</surname> <given-names>J</given-names></name> (<year>1990</year>) <source>Graphical models in applied multivariate statistics</source>. <publisher-name>Wiley Publishing</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref041">
<label>41</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schäfer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Strimmer</surname> <given-names>K</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>A shrinkage approach to large-scale covariance matrix estimation and implications for functional genomics</article-title>. <source>Statistical applications in genetics and molecular biology</source> <volume>4</volume>: <fpage>32</fpage>. <object-id pub-id-type="pmid">16646851</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref042">
<label>42</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Peng</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>J</given-names></name> (<year>2009</year>) <article-title>Partial correlation estimation by joint sparse regression models</article-title>. <source>Journal of the American Statistical Association</source> <volume>104</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/jasa.2009.0126" xlink:type="simple">10.1198/jasa.2009.0126</ext-link></comment> <object-id pub-id-type="pmid">19881892</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref043">
<label>43</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Varoquaux</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Gramfort</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Poline</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Thirion</surname> <given-names>B</given-names></name> (<year>2012</year>) <article-title>Markov models for fmri correlation structure: is brain functional connectivity small world, or decomposable into networks?</article-title> <source>Journal of Physiology-Paris</source> <volume>106</volume>: <fpage>212</fpage>–<lpage>221</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jphysparis.2012.01.001" xlink:type="simple">10.1016/j.jphysparis.2012.01.001</ext-link></comment> <object-id pub-id-type="pmid">22326672</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref044">
<label>44</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ryali</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Supekar</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Menon</surname> <given-names>V</given-names></name> (<year>2012</year>) <article-title>Estimation of functional connectivity in fmri data using stability selection-based sparse partial correlation with elastic net penalty</article-title>. <source>Neuroimage</source> <volume>59</volume>: <fpage>3852</fpage>–<lpage>3861</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2011.11.054" xlink:type="simple">10.1016/j.neuroimage.2011.11.054</ext-link></comment> <object-id pub-id-type="pmid">22155039</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref045">
<label>45</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ledoit</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>M</given-names></name> (<year>2004</year>) <article-title>A well-conditioned estimator for large-dimensional covariance matrices</article-title>. <source>Journal of multivariate analysis</source> <volume>88</volume>: <fpage>365</fpage>–<lpage>411</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0047-259X(03)00096-4" xlink:type="simple">10.1016/S0047-259X(03)00096-4</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref046">
<label>46</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Bickel</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tsybakov</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>van de Geer</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>B</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Regularization in statistics</article-title>. <source>Test</source> <volume>15</volume>: <fpage>271</fpage>–<lpage>344</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF02607055" xlink:type="simple">10.1007/BF02607055</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref047">
<label>47</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ledoit</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>M</given-names></name> (<year>2003</year>) <article-title>Improved estimation of the covariance matrix of stock returns with an application to portfolio selection</article-title>. <source>Journal of Empirical Finance</source> <volume>10</volume>: <fpage>603</fpage>–<lpage>621</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0927-5398(03)00007-0" xlink:type="simple">10.1016/S0927-5398(03)00007-0</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref048">
<label>48</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Friedman</surname> <given-names>JH</given-names></name> (<year>1989</year>) <article-title>Regularized discriminant analysis</article-title>. <source>Journal of the American statistical association</source> <volume>84</volume>: <fpage>165</fpage>–<lpage>175</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1989.10478752" xlink:type="simple">10.1080/01621459.1989.10478752</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref049">
<label>49</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ecker</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Cotton</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>WJ</given-names></name>, <name name-style="western"><surname>Bethge</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A fast and simple population code for orientation in primate v1</article-title>. <source>The Journal of Neuroscience</source> <volume>32</volume>: <fpage>10618</fpage>–<lpage>10626</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1335-12.2012" xlink:type="simple">10.1523/JNEUROSCI.1335-12.2012</ext-link></comment> <object-id pub-id-type="pmid">22855811</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref050">
<label>50</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Alivisatos</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Chun</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Church</surname> <given-names>GM</given-names></name>, <name name-style="western"><surname>Deisseroth</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Donoghue</surname> <given-names>JP</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>The brain activity map</article-title>. <source>Science</source> <volume>339</volume>: <fpage>1284</fpage>–<lpage>1285</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1236939" xlink:type="simple">10.1126/science.1236939</ext-link></comment> <object-id pub-id-type="pmid">23470729</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref051">
<label>51</label>
<mixed-citation xlink:type="simple" publication-type="other">
Anderson T (2003) An introduction to multivariate statistical analysis. Wiley series in probability and statistics.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref052">
<label>52</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Dempster</surname> <given-names>A</given-names></name> (<year>1972</year>) <article-title>Covariance selection</article-title>. <source>Biometrics</source>: <fpage>157</fpage>–<lpage>175</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.2307/2528966" xlink:type="simple">10.2307/2528966</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref053">
<label>53</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Baba</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Shibata</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Sibuya</surname> <given-names>M</given-names></name> (<year>2004</year>) <article-title>Partial correlation and conditional correlation as measures of conditional independence</article-title>. <source>Australian &amp; New Zealand Journal of Statistics</source> <volume>46</volume>: <fpage>657</fpage>–<lpage>664</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-842X.2004.00360.x" xlink:type="simple">10.1111/j.1467-842X.2004.00360.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref054">
<label>54</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Chandrasekaran</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Parrilo</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Willsky</surname> <given-names>AS</given-names></name> (<year>2010</year>) <article-title>Latent variable graphical model selection via convex optimization</article-title>. In: <source>Communication, Control, and Computing (Allerton), 2010 48th Annual Allerton Conference on</source>. <publisher-name>IEEE</publisher-name>, pp. <fpage>1610</fpage>–<lpage>1613</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref055">
<label>55</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ma</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Xue</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Zou</surname> <given-names>H</given-names></name> (<year>2013</year>) <article-title>Alternating direction methods for latent variable gaussian graphical model selection</article-title>. <source>Neural computation</source>: <fpage>1</fpage>–<lpage>27</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1162/NECO_a_00379" xlink:type="simple">10.1162/NECO_a_00379</ext-link></comment> <object-id pub-id-type="pmid">23607561</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref056">
<label>56</label>
<mixed-citation xlink:type="simple" publication-type="book">
<name name-style="western"><surname>Hertz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roudi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tyrcha</surname> <given-names>J</given-names></name> (<year>2013</year>) <article-title>Ising models for inferring network structure from spike data</article-title>. In: <name name-style="western"><surname>Quiroga</surname> <given-names>RQ</given-names></name>, <name name-style="western"><surname>Panzeri</surname> <given-names>S</given-names></name>, editors, <source>Principles of neural coding</source>, <publisher-name>CRC Press</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref057">
<label>57</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jaynes</surname> <given-names>ET</given-names></name> (<year>1957</year>) <article-title>Information theory and statistical mechanics</article-title>. <source>Phys Rev</source> <volume>106</volume>: <fpage>620</fpage>–<lpage>630</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRev.106.620" xlink:type="simple">10.1103/PhysRev.106.620</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref058">
<label>58</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Reddy</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Saggau</surname> <given-names>P</given-names></name> (<year>2005</year>) <article-title>Fast three-dimensional laser scanning scheme using acousto-optic deflectors</article-title>. <source>J Biomed Opt</source> <volume>10</volume>: <fpage>064038</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1117/1.2141504" xlink:type="simple">10.1117/1.2141504</ext-link></comment> <object-id pub-id-type="pmid">16409103</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref059">
<label>59</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Katona</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Szalay</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Maák</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kaszás</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Veress</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Fast two-photon in vivo imaging with three-dimensional random-access scanning in large tissue volumes</article-title>. <source>Nat Methods</source>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1851" xlink:type="simple">10.1038/nmeth.1851</ext-link></comment> <object-id pub-id-type="pmid">22231641</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref060">
<label>60</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Cotton</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Froudarakis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Storer</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Saggau</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Tolias</surname> <given-names>AS</given-names></name> (<year>2013</year>) <article-title>Three-dimensional mapping of microcircuit correlation structure</article-title>. <source>Frontiers in Neural Circuits</source> <volume>7</volume>: <fpage>151</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncir.2013.00151" xlink:type="simple">10.3389/fncir.2013.00151</ext-link></comment> <object-id pub-id-type="pmid">24133414</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref061">
<label>61</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Vogelstein</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Packer</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Machado</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Sippy</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Babadi</surname> <given-names>B</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Fast nonnegative deconvolution for spike train inference from population calcium imaging</article-title>. <source>Journal of neurophysiology</source> <volume>104</volume>: <fpage>3691</fpage>–<lpage>3704</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01073.2009" xlink:type="simple">10.1152/jn.01073.2009</ext-link></comment> <object-id pub-id-type="pmid">20554834</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref062">
<label>62</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Feldt</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Bonifazi</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Cossart</surname> <given-names>R</given-names></name> (<year>2011</year>) <article-title>Dissecting functional connectivity of neuronal microcircuits: experimental and theoretical insights</article-title>. <source>Trends in neurosciences</source> <volume>34</volume>: <fpage>225</fpage>–<lpage>236</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tins.2011.02.007" xlink:type="simple">10.1016/j.tins.2011.02.007</ext-link></comment> <object-id pub-id-type="pmid">21459463</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref063">
<label>63</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Malmersjö</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rebellato</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Smedler</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Planert</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kanatani</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Neural progenitors organize in small-world networks to promote cell proliferation</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>110</volume>: <fpage>E1524</fpage>–<lpage>E1532</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1220179110" xlink:type="simple">10.1073/pnas.1220179110</ext-link></comment> <object-id pub-id-type="pmid">23576737</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref064">
<label>64</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Sadovsky</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>MacLean</surname> <given-names>JN</given-names></name> (<year>2014</year>) <article-title>Mouse visual neocortex supports multiple stereotyped patterns of microcircuit activity</article-title>. <source>The Journal of Neuroscience</source> <volume>34</volume>: <fpage>7769</fpage>–<lpage>7777</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0169-14.2014" xlink:type="simple">10.1523/JNEUROSCI.0169-14.2014</ext-link></comment> <object-id pub-id-type="pmid">24899701</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref065">
<label>65</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Alonso</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Martinez</surname> <given-names>LM</given-names></name> (<year>1998</year>) <article-title>Functional connectivity between simple cells and complex cells in cat striate cortex</article-title>. <source>Nature neuroscience</source> <volume>1</volume>: <fpage>395</fpage>–<lpage>403</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/1609" xlink:type="simple">10.1038/1609</ext-link></comment> <object-id pub-id-type="pmid">10196530</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref066">
<label>66</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Aertsen</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gerstein</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Habib</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Palm</surname> <given-names>G</given-names></name> (<year>1989</year>) <article-title>Dynamics of neuronal firing correlation: modulation of “effective connectivity”</article-title>. <source>Journal of neurophysiology</source> <volume>61</volume>: <fpage>900</fpage>–<lpage>917</lpage>. <object-id pub-id-type="pmid">2723733</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref067">
<label>67</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pillow</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Litke</surname> <given-names>AM</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Spatio-temporal correlations and visual signalling in a complete neuronal population</article-title>. <source>Nature</source> <volume>454</volume>: <fpage>995</fpage>–<lpage>999</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature07140" xlink:type="simple">10.1038/nature07140</ext-link></comment> <object-id pub-id-type="pmid">18650810</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref068">
<label>68</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Schneidman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Berry</surname> <given-names>MJ</given-names> <suffix>2nd</suffix></name>, <name name-style="western"><surname>Segev</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bialek</surname> <given-names>W</given-names></name> (<year>2006</year>) <article-title>Weak pairwise correlations imply strongly correlated network states in a neural population</article-title>. <source>Nature</source> <volume>440</volume>: <fpage>1007</fpage>–<lpage>12</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature04701" xlink:type="simple">10.1038/nature04701</ext-link></comment> <object-id pub-id-type="pmid">16625187</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref069">
<label>69</label>
<mixed-citation xlink:type="simple" publication-type="other">
Tkacik G, Schneidman E, Berry I, Michael J, Bialek W (2006) Ising models for networks of real neurons. arXiv preprint q-bio/0611072.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref070">
<label>70</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Yu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Huang</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Nikolic</surname> <given-names>D</given-names></name> (<year>2008</year>) <article-title>A small world of neuronal synchrony</article-title>. <source>Cereb Cortex</source> <volume>18</volume>: <fpage>2891</fpage>–<lpage>901</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/bhn047" xlink:type="simple">10.1093/cercor/bhn047</ext-link></comment> <object-id pub-id-type="pmid">18400792</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref071">
<label>71</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tang</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jackson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Hobbs</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>JL</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>A maximum entropy model applied to spatial and temporal correlations from cortical networks in vitro</article-title>. <source>J Neurosci</source> <volume>28</volume>: <fpage>505</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3359-07.2008" xlink:type="simple">10.1523/JNEUROSCI.3359-07.2008</ext-link></comment> <object-id pub-id-type="pmid">18184793</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref072">
<label>72</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Shlens</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Field</surname> <given-names>GD</given-names></name>, <name name-style="western"><surname>Gauthier</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Greschner</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sher</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>The structure of large-scale synchronized firing in primate retina</article-title>. <source>J Neurosci</source> <volume>29</volume>: <fpage>5022</fpage>–<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5187-08.2009" xlink:type="simple">10.1523/JNEUROSCI.5187-08.2009</ext-link></comment> <object-id pub-id-type="pmid">19369571</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref073">
<label>73</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zalesky</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Fornito</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bullmore</surname> <given-names>E</given-names></name> (<year>2012</year>) <article-title>On the use of correlation as a measure of network connectivity</article-title>. <source>Neuroimage</source> <volume>60</volume>: <fpage>2096</fpage>–<lpage>2106</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuroimage.2012.02.001" xlink:type="simple">10.1016/j.neuroimage.2012.02.001</ext-link></comment> <object-id pub-id-type="pmid">22343126</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref074">
<label>74</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Grewe</surname> <given-names>BF</given-names></name>, <name name-style="western"><surname>Langer</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kasper</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Kampa</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Helmchen</surname> <given-names>F</given-names></name> (<year>2010</year>) <article-title>High-speed in vivo calcium imaging reveals neuronal network activity with near-millisecond precision</article-title>. <source>Nat Meth</source> <volume>7</volume>: <fpage>399</fpage>–<lpage>405</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1453" xlink:type="simple">10.1038/nmeth.1453</ext-link></comment> <object-id pub-id-type="pmid">20400966</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref075">
<label>75</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Theis</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Berens</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Froudarakis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Reimer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Roman-Roson</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Supervised learning sets benchmark for robust spike detection from calcium imaging signals</article-title>. <source>bioRxiv</source>: <fpage>010777</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref076">
<label>76</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Leung</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>GX</given-names></name>, <name name-style="western"><surname>Mourrain</surname> <given-names>P</given-names></name> (<year>2013</year>) <article-title>Imaging zebrafish neural circuitry from whole brain to synapse</article-title>. <source>Frontiers in neural circuits</source> <volume>7</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fncir.2013.00076" xlink:type="simple">10.3389/fncir.2013.00076</ext-link></comment> <object-id pub-id-type="pmid">23630470</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref077">
<label>77</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ahrens</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Orger</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Robson</surname> <given-names>DN</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Keller</surname> <given-names>PJ</given-names></name> (<year>2013</year>) <article-title>Whole-brain functional imaging at cellular resolution using light-sheet microscopy</article-title>. <source>Nature methods</source> <volume>10</volume>: <fpage>413</fpage>–<lpage>420</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2434" xlink:type="simple">10.1038/nmeth.2434</ext-link></comment> <object-id pub-id-type="pmid">23524393</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref078">
<label>78</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Perin</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Berger</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Markram</surname> <given-names>H</given-names></name> (<year>2011</year>) <article-title>A synaptic organizing principle for cortical neuronal groups</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>5419</fpage>–<lpage>24</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1016051108" xlink:type="simple">10.1073/pnas.1016051108</ext-link></comment> <object-id pub-id-type="pmid">21383177</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref079">
<label>79</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gerstein</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Bedenbaugh</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Aertsen</surname> <given-names>AM</given-names></name> (<year>1989</year>) <article-title>Neuronal assemblies</article-title>. <source>Biomedical Engineering, IEEE Transactions on</source> <volume>36</volume>: <fpage>4</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/10.16444" xlink:type="simple">10.1109/10.16444</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref080">
<label>80</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Chapin</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Nicolelis</surname> <given-names>MA</given-names></name> (<year>1999</year>) <article-title>Principal component analysis of neuronal ensemble activity reveals multidimensional somatosensory representations</article-title>. <source>Journal of neuroscience methods</source> <volume>94</volume>: <fpage>121</fpage>–<lpage>140</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0165-0270(99)00130-2" xlink:type="simple">10.1016/S0165-0270(99)00130-2</ext-link></comment> <object-id pub-id-type="pmid">10638820</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref081">
<label>81</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Peyrache</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Benchenane</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Khamassi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Wiener</surname> <given-names>SI</given-names></name>, <name name-style="western"><surname>Battaglia</surname> <given-names>FP</given-names></name> (<year>2010</year>) <article-title>Principal component analysis of ensemble recordings reveals cell assemblies at high temporal resolution</article-title>. <source>Journal of computational neuroscience</source> <volume>29</volume>: <fpage>309</fpage>–<lpage>325</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s10827-009-0154-6" xlink:type="simple">10.1007/s10827-009-0154-6</ext-link></comment> <object-id pub-id-type="pmid">19529888</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref082">
<label>82</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ch’Ng</surname> <given-names>YH</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>RC</given-names></name> (<year>2010</year>) <article-title>Cellular imaging of visual cortex reveals the spatial and functional organization of spontaneous activity</article-title>. <source>Frontiers in integrative neuroscience</source> <volume>4</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.3389/fnint.2010.00020" xlink:type="simple">10.3389/fnint.2010.00020</ext-link></comment> <object-id pub-id-type="pmid">20941381</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref083">
<label>83</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lopes-dos Santos</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Conde-Ocazionez</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nicolelis</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Ribeiro</surname> <given-names>ST</given-names></name>, <name name-style="western"><surname>Tort</surname> <given-names>AB</given-names></name> (<year>2011</year>) <article-title>Neuronal assembly detection and cell membership specification by principal component analysis</article-title>. <source>PloS one</source> <volume>6</volume>: <fpage>e20996</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0020996" xlink:type="simple">10.1371/journal.pone.0020996</ext-link></comment> <object-id pub-id-type="pmid">21698248</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref084">
<label>84</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Lopes-dos Santos</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Ribeiro</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tort</surname> <given-names>AB</given-names></name> (<year>2013</year>) <article-title>Detecting cell assemblies in large neuronal populations</article-title>. <source>Journal of Neuroscience Methods</source> <volume>220</volume>: <fpage>149</fpage>–<lpage>166</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2013.04.010" xlink:type="simple">10.1016/j.jneumeth.2013.04.010</ext-link></comment> <object-id pub-id-type="pmid">23639919</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref085">
<label>85</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Okun</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yger</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Marguet</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Gerard-Mercier</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Benucci</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Population rate dynamics and multineuron firing patterns in sensory cortex</article-title>. <source>J Neurosci</source> <volume>32</volume>: <fpage>17108</fpage>–<lpage>19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1831-12.2012" xlink:type="simple">10.1523/JNEUROSCI.1831-12.2012</ext-link></comment> <object-id pub-id-type="pmid">23197704</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref086">
<label>86</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ganmor</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Segev</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Schneidman</surname> <given-names>E</given-names></name> (<year>2011</year>) <article-title>Sparse low-order interaction network underlies a highly correlated and learnable neural population code</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>9679</fpage>–<lpage>84</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1019641108" xlink:type="simple">10.1073/pnas.1019641108</ext-link></comment> <object-id pub-id-type="pmid">21602497</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref087">
<label>87</label>
<mixed-citation xlink:type="simple" publication-type="other">
Tkačik G, Marre O, Amodei D, Schneidman E, Bialek W, et al. (2013) Searching for collective behavior in a network of real neurons. arXiv preprint arXiv:13063061.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref088">
<label>88</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Pfau</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pnevmatikakis</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Paninski</surname> <given-names>L</given-names></name> (<year>2013</year>) <article-title>Robust learning of low-dimensional dynamics from large neural ensembles</article-title>. In: <source>Advances in Neural Information Processing Systems</source>. pp. <fpage>2391</fpage>–<lpage>2399</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref089">
<label>89</label>
<mixed-citation xlink:type="simple" publication-type="other">
Köster U, Sohl-Dickstein J, Gray CM, Olshausen BA (2013) Higher order correlations within cortical layers dominate functional connectivity in microcolumns. arXiv preprint arXiv:13010050.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref090">
<label>90</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Roudi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Nirenberg</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Latham</surname> <given-names>PE</given-names></name> (<year>2009</year>) <article-title>Pairwise maximum entropy models for studying large biological systems: when they can work and when they can’t</article-title>. <source>PLoS computational biology</source> <volume>5</volume>: <fpage>e1000380</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000380" xlink:type="simple">10.1371/journal.pcbi.1000380</ext-link></comment> <object-id pub-id-type="pmid">19424487</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref091">
<label>91</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Arlot</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Celisse</surname> <given-names>A</given-names></name> (<year>2010</year>) <article-title>A survey of cross-validation procedures for model selection</article-title>. <source>Statistics Surveys</source> <volume>4</volume>: <fpage>40</fpage>–<lpage>79</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/09-SS054" xlink:type="simple">10.1214/09-SS054</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref092">
<label>92</label>
<mixed-citation xlink:type="simple" publication-type="other">
Efron B, Morris CN (1977) Stein’s paradox in statistics. WH Freeman.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref093">
<label>93</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Song</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sjöström</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Reigl</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chklovskii</surname> <given-names>DB</given-names></name> (<year>2005</year>) <article-title>Highly nonrandom features of synaptic connectivity in local cortical circuits</article-title>. <source>PLoS biology</source> <volume>3</volume>: <fpage>e68</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pbio.0030068" xlink:type="simple">10.1371/journal.pbio.0030068</ext-link></comment> <object-id pub-id-type="pmid">15737062</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref094">
<label>94</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Oswald</surname> <given-names>AMM</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>AD</given-names></name> (<year>2008</year>) <article-title>Maturation of intrinsic and synaptic properties of layer 2/3 pyramidal neurons in mouse auditory cortex</article-title>. <source>Journal of neurophysiology</source> <volume>99</volume>: <fpage>2998</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1152/jn.01160.2007" xlink:type="simple">10.1152/jn.01160.2007</ext-link></comment> <object-id pub-id-type="pmid">18417631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref095">
<label>95</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Adesnik</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Scanziani</surname> <given-names>M</given-names></name> (<year>2010</year>) <article-title>Lateral competition for cortical space by layer-specific horizontal circuits</article-title>. <source>Nature</source> <volume>464</volume>: <fpage>1155</fpage>–<lpage>1160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature08935" xlink:type="simple">10.1038/nature08935</ext-link></comment> <object-id pub-id-type="pmid">20414303</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref096">
<label>96</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fino</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name> (<year>2011</year>) <article-title>Dense inhibitory connectivity in neocortex</article-title>. <source>Neuron</source> <volume>69</volume>: <fpage>1188</fpage>–<lpage>203</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2011.02.025" xlink:type="simple">10.1016/j.neuron.2011.02.025</ext-link></comment> <object-id pub-id-type="pmid">21435562</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref097">
<label>97</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Isaacson</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Scanziani</surname> <given-names>M</given-names></name> (<year>2011</year>) <article-title>How inhibition shapes cortical activity</article-title>. <source>Neuron</source> <volume>72</volume>: <fpage>231</fpage>–<lpage>243</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2011.09.027" xlink:type="simple">10.1016/j.neuron.2011.09.027</ext-link></comment> <object-id pub-id-type="pmid">22017986</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref098">
<label>98</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Levy</surname> <given-names>RB</given-names></name>, <name name-style="western"><surname>Reyes</surname> <given-names>AD</given-names></name> (<year>2012</year>) <article-title>Spatial profile of excitatory and inhibitory synaptic connectivity in mouse primary auditory cortex</article-title>. <source>J Neurosci</source> <volume>32</volume>: <fpage>5609</fpage>–<lpage>19</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.5158-11.2012" xlink:type="simple">10.1523/JNEUROSCI.5158-11.2012</ext-link></comment> <object-id pub-id-type="pmid">22514322</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref099">
<label>99</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Packer</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Yuste</surname> <given-names>R</given-names></name> (<year>2011</year>) <article-title>Dense, unspecific connectivity of neocortical parvalbumin-positive interneurons: a canonical microcircuit for inhibition?</article-title> <source>The Journal of Neuroscience</source> <volume>31</volume>: <fpage>13260</fpage>–<lpage>13271</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3131-11.2011" xlink:type="simple">10.1523/JNEUROSCI.3131-11.2011</ext-link></comment> <object-id pub-id-type="pmid">21917809</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref100">
<label>100</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Reimer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Froudarakis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Cadwell</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Yatsenko</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Denfield</surname> <given-names>GH</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Pupil fluctuations track fast switching of cortical states during quiet wakefulness</article-title>. <source>Neuron</source> <volume>84</volume>: <fpage>355</fpage>–<lpage>362</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2014.09.033" xlink:type="simple">10.1016/j.neuron.2014.09.033</ext-link></comment> <object-id pub-id-type="pmid">25374359</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref101">
<label>101</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Fu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Tucciarone</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Espinosa</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Sheng</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Darcy</surname> <given-names>DP</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>A cortical circuit for gain control by behavioral state</article-title>. <source>Cell</source> <volume>156</volume>: <fpage>1139</fpage>–<lpage>1152</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2014.01.050" xlink:type="simple">10.1016/j.cell.2014.01.050</ext-link></comment> <object-id pub-id-type="pmid">24630718</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref102">
<label>102</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Meinshausen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bühlmann</surname> <given-names>P</given-names></name> (<year>2006</year>) <article-title>High-dimensional graphs and variable selection with the lasso</article-title>. <source>The Annals of Statistics</source> <volume>34</volume>: <fpage>1436</fpage>–<lpage>1462</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1214/009053606000000281" xlink:type="simple">10.1214/009053606000000281</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref103">
<label>103</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hastie</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name> (<year>2008</year>) <article-title>Sparse inverse covariance estimation with the graphical lasso</article-title>. <source>Biostatistics</source> <volume>9</volume>: <fpage>432</fpage>–<lpage>441</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biostatistics/kxm045" xlink:type="simple">10.1093/biostatistics/kxm045</ext-link></comment> <object-id pub-id-type="pmid">18079126</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref104">
<label>104</label>
<mixed-citation xlink:type="simple" publication-type="other">
Fazel M (2002) Matrix rank minimization with applications. Ph.D. thesis, Stanford University.</mixed-citation>
</ref>
<ref id="pcbi.1004083.ref105">
<label>105</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Recht</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Fazel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Parrilo</surname> <given-names>PA</given-names></name> (<year>2010</year>) <article-title>Guaranteed minimum-rank solutions of linear matrix equations via nuclear norm minimization</article-title>. <source>SIAM review</source> <volume>52</volume>: <fpage>471</fpage>–<lpage>501</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/070697835" xlink:type="simple">10.1137/070697835</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref106">
<label>106</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Vogels</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Spileers</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Orban</surname> <given-names>G</given-names></name> (<year>1989</year>) <article-title>The response variability of striate cortical neurons in the behaving monkey</article-title>. <source>Experimental brain research</source> <volume>77</volume>: <fpage>432</fpage>–<lpage>436</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/BF00275002" xlink:type="simple">10.1007/BF00275002</ext-link></comment> <object-id pub-id-type="pmid">2792290</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004083.ref107">
<label>107</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Ponce-Alvarez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Thiele</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Albright</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Stoner</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Deco</surname> <given-names>G</given-names></name> (<year>2013</year>) <article-title>Stimulus-dependent variability and noise correlations in cortical mt neurons</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>110</volume>: <fpage>13162</fpage>–<lpage>13167</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1300098110" xlink:type="simple">10.1073/pnas.1300098110</ext-link></comment> <object-id pub-id-type="pmid">23878209</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>