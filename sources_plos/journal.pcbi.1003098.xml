<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-01961</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003098</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Metabolism</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Chemistry</subject><subj-group><subject>Physical chemistry</subject><subj-group><subject>Thermodynamics</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Consistent Estimation of Gibbs Energy Using Component Contributions</article-title>
<alt-title alt-title-type="running-head">Gibbs Energy Estimation by Component Contributions</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Noor</surname><given-names>Elad</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Haraldsdóttir</surname><given-names>Hulda S.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Milo</surname><given-names>Ron</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Fleming</surname><given-names>Ronan M. T.</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Plant Sciences Department, Weizmann Institute of Science, Rehovot, Israel</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Center for Systems Biology, University of Iceland, Reykjavik, Iceland</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Luxembourg Centre for Systems Biomedicine, University of Luxembourg, Esch-sur-Alzette, Luxembourg</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Beard</surname><given-names>Daniel A.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Medical College of Wisconsin, United States of America</addr-line></aff>
<author-notes>
    <corresp id="cor1">* E-mail: <email xlink:type="simple">ron.milo@weizmann.ac.il</email> (RM); <email xlink:type="simple">ronan.mt.fleming@gmail.com</email> (RMTF) </corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: EN HSH RM RMTF. Performed the experiments: EN HSH. Analyzed the data: EN HSH. Contributed reagents/materials/analysis tools: EN HSH RM RMTF. Wrote the paper: EN HSH RM RMTF.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>7</month><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>11</day><month>7</month><year>2013</year></pub-date>
<volume>9</volume>
<issue>7</issue>
<elocation-id>e1003098</elocation-id>
<history>
<date date-type="received"><day>14</day><month>12</month><year>2012</year></date>
<date date-type="accepted"><day>30</day><month>4</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Noor et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" vol="" page="e1002972" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1002972"> <article-title>New Methods Section in PLOS Computational Biology</article-title></related-article>
<abstract>
<p>Standard Gibbs energies of reactions are increasingly being used in metabolic modeling for applying thermodynamic constraints on reaction rates, metabolite concentrations and kinetic parameters. The increasing scope and diversity of metabolic models has led scientists to look for genome-scale solutions that can estimate the standard Gibbs energy of all the reactions in metabolism. Group contribution methods greatly increase coverage, albeit at the price of decreased precision. We present here a way to combine the estimations of group contribution with the more accurate reactant contributions by decomposing each reaction into two parts and applying one of the methods on each of them. This method gives priority to the reactant contributions over group contributions while guaranteeing that all estimations will be consistent, i.e. will not violate the first law of thermodynamics. We show that there is a significant increase in the accuracy of our estimations compared to standard group contribution. Specifically, our cross-validation results show an 80% reduction in the median absolute residual for reactions that can be derived by reactant contributions only. We provide the full framework and source code for deriving estimates of standard reaction Gibbs energy, as well as confidence intervals, and believe this will facilitate the wide use of thermodynamic data for a better understanding of metabolism.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>The metabolism of living organisms is a complex system with a large number of parameters and interactions. Nevertheless, it is governed by a strict set of rules that make it somewhat predictable and amenable to modeling. The laws of thermodynamics play a pivotal role by determining reaction feasibility and by governing the kinetics of enzymes. Here we introduce estimations for the standard Gibbs energy of reactions, with the best combination of accuracy and coverage to date. The estimations are derived using a new method which we denote <italic>component contribution</italic>. This method integrates multiple sources of information into a consistent framework that obeys the laws of thermodynamics, and provides a significant improvement in accuracy compared to previous genome-wide estimations of standard Gibbs energies. We apply and test our method on reconstructions of <italic>E. coli</italic> and human metabolism and, in addition, do our best to facilitate the use of these estimations in future models by providing open-source software that performs the integration in a streamlined process.</p>
</abstract>
<funding-group><funding-statement>EN is grateful to the Azrieli Foundation for the award of an Azrieli Fellowship (<ext-link ext-link-type="uri" xlink:href="http://www.azrielifoundation.org/" xlink:type="simple">http://www.azrielifoundation.org/</ext-link>). RM is supported by the European Research Council, (<ext-link ext-link-type="uri" xlink:href="http://erc.europa.eu/" xlink:type="simple">http://erc.europa.eu/</ext-link>, [260392 - SYMPAC]) and is the incumbent of the Anna and Maurice Boukstein Career Development Chair in Perpetuity. RMTF and HSH were supported by the U.S. Department of Energy (Office of Advanced Scientific Computing Research, <ext-link ext-link-type="uri" xlink:href="http://science.energy.gov/ascr/" xlink:type="simple">http://science.energy.gov/ascr/</ext-link>, and Office of Biological and Environmental Research, <ext-link ext-link-type="uri" xlink:href="http://science.energy.gov/ber/" xlink:type="simple">http://science.energy.gov/ber/</ext-link>) as part of the Scientific Discovery Through Advanced Computing program, grant DE-FG02-09ER25917 and the Icelandic Research Fund, grant No. 100406022. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="11"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods Article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>A living system, like any other physical system, obeys the laws of thermodynamics. In the context of metabolism, the laws of thermodynamics have been successfully applied in several modeling schemes to improve accuracy in predictions and eliminate infeasible functional states. For instance, several methodologies that reflect the constraints imposed by the second law of thermodynamics have been developed <xref ref-type="bibr" rid="pcbi.1003098-Beard1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1003098-Fleming1">[3]</xref> and were shown to remove thermodynamically infeasible loops and improve overall predictions. Alternatively, thermodynamic data have been integrated directly into genome-wide models and analysis methods <xref ref-type="bibr" rid="pcbi.1003098-Henry1">[4]</xref>–<xref ref-type="bibr" rid="pcbi.1003098-Haraldsdttir1">[10]</xref>. Unfortunately, this integration has been hindered by the fact that thermodynamic parameters for most reactions are effectively missing (sometimes due to scattered accessibility or non-standard annotations).</p>
<p>The nearly ubiquitous method for experimentally obtaining thermodynamic parameters for biochemical reactions, specifically their standard transformed Gibbs energies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e001" xlink:type="simple"/></inline-formula>, is directly measuring the apparent equilibrium constant <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e002" xlink:type="simple"/></inline-formula> and then applying the formula <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e003" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e004" xlink:type="simple"/></inline-formula> is the gas constant and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e005" xlink:type="simple"/></inline-formula> is the temperature. Typically, the substrates of the reaction are added to a buffered medium together with an enzyme that specifically catalyzes the reaction. After the concentrations reach a steady-state, the reaction quotient <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e006" xlink:type="simple"/></inline-formula> is calculated by dividing the product concentrations by the substrate concentrations. It is recommended to do the same measurement in the opposite direction as well (starting with what were earlier the products). If the experiment is successful, and the steady-state reached is an equilibrium state then both values for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e007" xlink:type="simple"/></inline-formula> (measured in both directions) will be equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e008" xlink:type="simple"/></inline-formula> and thus to each other. Notably, due to the nature of this method, only reactions with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e009" xlink:type="simple"/></inline-formula> close to the equilibrium value of zero can be directly measured since current technology allows measuring metabolite concentrations only within a range of a few orders of magnitude. Although this method involves purifying substantial amounts of the enzyme, it has been applied to many of the enzyme-catalyzed reactions studied throughout the last century and the results were published in hundreds or even thousands of papers. A comprehensive collection of measured <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e010" xlink:type="simple"/></inline-formula> (among other thermodynamic parameters), for more than 400 reactions, has been published by the National Institute of Standards and Technology (NIST) in the Thermodynamics of Enzyme-Catalyzed Reactions Database (TECRDB <xref ref-type="bibr" rid="pcbi.1003098-Goldberg1">[11]</xref>). However, even this wide collection covers less than 10% of biochemical reactions in standard metabolic reconstructions, such as the <italic>E. coli</italic> model iAF1260 <xref ref-type="bibr" rid="pcbi.1003098-Feist1">[5]</xref>.</p>
<p>In 1957 <xref ref-type="bibr" rid="pcbi.1003098-Krebs1">[12]</xref>, K. Burton recognized that these apparent equilibrium constants can be used (together with chemically derived standard Gibbs energies for some simple compounds) to calculate equilibrium constants of reactions with no known <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e011" xlink:type="simple"/></inline-formula> values. This method is based on the notion that by knowing the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e012" xlink:type="simple"/></inline-formula> of two different reactions, one can calculate the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e013" xlink:type="simple"/></inline-formula> of the combined reaction by summing the two known standard transformed Gibbs energies – as dictated by the first law of thermodynamics. For example, although the reaction of ATP hydrolysis (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e014" xlink:type="simple"/></inline-formula>) might be too far from equilibrium to be measured directly, one can more easily measure the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e015" xlink:type="simple"/></inline-formula> of the reactions of glucose kinase (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e016" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e017" xlink:type="simple"/></inline-formula> kJ/mol) and of glucose-6P phosphatase (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e018" xlink:type="simple"/></inline-formula>; <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e019" xlink:type="simple"/></inline-formula> kJ/mol), which are both closer to equilibrium. The standard transformed Gibbs energy for the total reaction (i.e. ATP hydrolysis) would thus be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e020" xlink:type="simple"/></inline-formula> kJ/mol.</p>
<p>In order to facilitate these <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e021" xlink:type="simple"/></inline-formula> calculations, Burton published a table of about 100 inferred standard Gibbs energies of formation (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e022" xlink:type="simple"/></inline-formula>) which are defined as the standard Gibbs energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e023" xlink:type="simple"/></inline-formula> of the <italic>formation reaction</italic>, i.e. the reaction of forming a compound out of pure elements in their standard forms (e.g. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e024" xlink:type="simple"/></inline-formula>). Some of these values were taken from chemical thermodynamic tables, and the rest were derived by Burton using the arithmetic approach of combining reactions. For instance, if all species except one in an enzyme-catalyzed reaction have known <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e025" xlink:type="simple"/></inline-formula>, and the reaction's <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e026" xlink:type="simple"/></inline-formula> can be obtained experimentally, then the last remaining <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e027" xlink:type="simple"/></inline-formula> can be calculated and added to the table. After compiling such a table, the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e028" xlink:type="simple"/></inline-formula> of any reaction involving species that appear in the table can be easily calculated by summing the formation energies of all the products and subtracting those of the substrates. Throughout this paper we will refer to this method of calculating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e029" xlink:type="simple"/></inline-formula> as the Reactant Contribution (RC) method, since it is based on the contribution of each reactant to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e030" xlink:type="simple"/></inline-formula> (i.e. its standard Gibbs energy of formation).</p>
<p>In the 50 years following Burton's work, several such tables of formation Gibbs energies have been published. Some of the most noteworthy are the table by R. Thauer <xref ref-type="bibr" rid="pcbi.1003098-Thauer1">[13]</xref> and the larger collection by R. Alberty <xref ref-type="bibr" rid="pcbi.1003098-Alberty1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003098-Alberty2">[15]</xref>. Using these values, one can determine Gibbs energies for more reactions at a wider range of physiological conditions (pH, ionic strength) than the set of reactions measured and stored in TECRDB. However, even this advanced method covers less than 10% of reactions in the <italic>E. coli</italic> model. This gap has prompted scientists to develop methods that can estimate the missing thermodynamic parameters for genome-wide models.</p>
<p>Quite coincidentally, a year after Burton published his thermodynamic tables, S. Benson and J. Buss <xref ref-type="bibr" rid="pcbi.1003098-Benson1">[16]</xref> published their work on additivity rules for the estimation of molecular properties. Benson and Buss called the law of additivity of atomic properties a <italic>zero-order</italic> approximation, the additivity of bond properties a <italic>first-order</italic> approximation, and the additivity of group properties a <italic>second-order</italic> approximation. Groups were defined as pairs of atoms or structural elements with distances of 3–5 Å. The contribution of each group to the total was determined by linear regression. Using the second-order approximation, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e031" xlink:type="simple"/></inline-formula> is calculated as the sum of the standard Gibbs energy contributions of groups that are produced in the reaction, minus the contributions of groups that are consumed. This method is commonly called the Group Contribution (GC) method. Burton's method of calculating the Gibbs energy of formation for compounds (which we denote RC) can be thought of as a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e032" xlink:type="simple"/></inline-formula>-<italic>order</italic> approximation, where the entire molecule is taken as the basic additivity unit for estimating the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e033" xlink:type="simple"/></inline-formula> (of course, this is not actually an approximation).</p>
<p>Group contribution methods were relatively successful in estimating the thermodynamic parameters of ideal gases <xref ref-type="bibr" rid="pcbi.1003098-Benson1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1003098-Ritter1">[19]</xref>, and later extended to liquid and solid phases <xref ref-type="bibr" rid="pcbi.1003098-Domalski1">[20]</xref>. Only in 1988 <xref ref-type="bibr" rid="pcbi.1003098-Mavrovouniotis1">[21]</xref> was it brought to the world of biochemical reactions in aqueous solutions and has since become the most widely used technique for estimating the Gibbs energy of reactions <xref ref-type="bibr" rid="pcbi.1003098-Mavrovouniotis2">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1003098-Noor1">[24]</xref>. GC methods can cover the majority of relevant biochemical reactions (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e034" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e035" xlink:type="simple"/></inline-formula> of the reactions in <italic>E. coli</italic> and human cell metabolic models respectively) <xref ref-type="bibr" rid="pcbi.1003098-Feist1">[5]</xref>, <xref ref-type="bibr" rid="pcbi.1003098-Haraldsdttir1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003098-Noor1">[24]</xref>. The downside of GC lies in its accuracy, since it relies on a simplifying assumption that the contributions of groups are additive. Evidently, the average estimation error attributed to GC is about 9–10 kJ/mol <xref ref-type="bibr" rid="pcbi.1003098-Jankowski1">[23]</xref>. In a recent study, we showed that an improvement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e036" xlink:type="simple"/></inline-formula> can be achieved by considering different pseudoisomers that exist simultaneously for many of the compounds <xref ref-type="bibr" rid="pcbi.1003098-Noor1">[24]</xref> (see Section S1 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref> for details). Even with this improvement, error in GC estimates is still significantly higher than in RC estimates (<xref ref-type="fig" rid="pcbi-1003098-g001">Figure 1</xref>).</p>
<fig id="pcbi-1003098-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003098.g001</object-id><label>Figure 1</label><caption>
<title>The development of Gibbs energy estimation frameworks.</title>
<p>The coverage is calculated as the percent of the relevant reactions in the KEGG database (i.e. reactions that have full chemical descriptions and are chemically balanced). The median residual (in absolute values) is calculated using leave-one-out cross-validation over the set of reactions that are within the scope of each method. Note that the reason component contribution has a higher median absolute residual than RC is only due to its higher coverage of reactions (for reactions covered by RC, the component contribution method gives the exact same predictions). *The residual value for Alberty's method is not based on cross-validation since it is a result of manual curation of multiple data sources – a process that we cannot readily repeat.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003098.g001" position="float" xlink:type="simple"/></fig>
<p>In this paper, we aim to unify GC and RC into a more general framework we call the Component Contribution method. We demonstrate that component contribution combines the accuracy of RC with the coverage of GC in a fully consistent manner. A plot comparing the component contribution method to other known methods is given in <xref ref-type="fig" rid="pcbi-1003098-g001">Figure 1</xref>.</p>
<sec id="s2a">
<title>Unifying reactant and group contribution methods</title>
<p>The extensive use of formation Gibbs energies for calculating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e037" xlink:type="simple"/></inline-formula> might create the impression that combining these two frameworks (RC and GC) is a trivial task. Traditionally, the formation energy of all pure elements in their standard forms is set to zero by definition. All other compounds' formation energies are calculated in relation to these reference points. This is a sound definition which creates a consistent framework for deriving the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e038" xlink:type="simple"/></inline-formula> of any reaction which is chemically balanced. However, the difficulty of calculating the formation energy for some complex but useful co-factors has been side-stepped by creating a somewhat looser definition of formation Gibbs energy, where several non-elemental compounds are defined as reference points as well (with a standard formation energy of zero). For some rare reactions, this definition can create a conflict that will result in a very large mistake in the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e039" xlink:type="simple"/></inline-formula>.</p>
<p>For instance, Alberty's formation energy table <xref ref-type="bibr" rid="pcbi.1003098-Alberty2">[15]</xref> lists 16 compounds as having <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e040" xlink:type="simple"/></inline-formula>. Among these, only 5 are elements (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e041" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e042" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e043" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e044" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e045" xlink:type="simple"/></inline-formula>) and 11 are co-factors (CoA<sup>−1</sup>, NAD(ox)<sup>−1</sup>, FAD(ox)<sup>−2</sup>, FMN(ox)<sup>−2</sup> and seven other redox carriers). In most reactions which use these co-factors as substrates, the “zeros” will cancel out since one of the products will match it with a formation energy which is defined according to the same reference point (e.g. FAD(ox)<sup>−2</sup> will be matched with FAD(red)<sup>−2</sup> whose formation energy is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e046" xlink:type="simple"/></inline-formula> kJ/mol in Albery's table). Nevertheless, there are a handful of reactions where this matching doesn't occur. In the reaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e047" xlink:type="simple"/></inline-formula> (catalyzed by <italic>FAD nucleotidohydrolase</italic>, EC 3.6.1.18), there is a violation of conservation laws for FAD and FMN (both have <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e048" xlink:type="simple"/></inline-formula> in Alberty's table). Therefore, using the table naïvely for this reaction would yield a wrong value, namely <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e049" xlink:type="simple"/></inline-formula> kJ/mol. Combining formation energies derived using GC with ones from RC greatly increases the number of reactions where different reference-points are mixed together, and mistakes such as the one described above become much more common.</p>
<p>One way to deal with the problem of reference-point conflicts, is to use either RC or GC exclusively for every reaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e050" xlink:type="simple"/></inline-formula> being estimated. Specifically, RC will by applied to all reactions that can be completely covered by it. Only if one or more reactants are missing from the formation energy table, we would use the less precise GC method for the entire reaction. Unfortunately, combining the frameworks in such a way can easily lead to violations of the first law of thermodynamics. This stems from the fact that inconsistent use of formation energies across several reactions, coming from inaccuracies in the estimation method that do not cancel out, can create situations where futile cycles will have a non-zero change in Gibbs energy. An example for such a futile cycle is given in <xref ref-type="fig" rid="pcbi-1003098-g002">Figure 2</xref>. Applying this method for large-scale metabolic reconstructions will most likely lead to non-physical solutions.</p>
<fig id="pcbi-1003098-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003098.g002</object-id><label>Figure 2</label><caption>
<title>An example of a futile cycle where Gibbs energies are derived using RC and GC.</title>
<p>The combined stoichiometry of (1) threonine aldolase, (2) acetaldehyde dehydrogenase (acetylating), (3) glycine C-acetyltransferase, and (4) threonine:NAD oxidoreductase creates a futile cycle where all the inputs and outputs are balanced. Using RC we are able to derive the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e051" xlink:type="simple"/></inline-formula> of reactions 1 and 2 (green), but since 2-amino-3-oxobutanoate does not appear in formation energy tables – we must use GC for reactions 3 and 4 (magenta). The sum of all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e052" xlink:type="simple"/></inline-formula> in this case is −6.0 kJ/mol which is a violation of the first law of thermodynamics.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003098.g002" position="float" xlink:type="simple"/></fig>
<p>Reference-point conflicts and first-law violations can both be avoided, by adjusting baseline formation energies of compounds with non-elemental reference points to match group contribution estimates. This approach was taken in <xref ref-type="bibr" rid="pcbi.1003098-Fleming2">[8]</xref> and <xref ref-type="bibr" rid="pcbi.1003098-Haraldsdttir1">[10]</xref>. The formation energies of FAD(ox)<sup>−2</sup> and all other reference points in Alberty's table were set equal to their group contribution estimates. All formation energies that were determined relative to each reference point were then adjusted according to Alberty's table to maintain the same relative formation energies. The main disadvantage of this approach is that the set of reference points is fixed and limited to a few common cofactors. The coverage of reactant contributions could be increased by also defining less common metabolites as reference points, but listing them all in a static table would be impractical and inefficient.</p>
<p>The component contribution method, which is described in detail in the following sections of this paper, manages to combine the estimates of RC and GC while avoiding any reference-point conflicts or first-law violations. In the component contribution framework, the maximal set of reference points given a set of measured reactions is automatically determined. We maintain the notion of prioritizing RC over GC, but rather than applying only one method exclusively per reaction, we split every reaction into two independent reactions. One of these sub-reactions can be evaluated using RC, while the other cannot – and thus its <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e053" xlink:type="simple"/></inline-formula> is calculated using GC. We use linear orthogonal projections in order to split each of the reactions, ensuring that all estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e054" xlink:type="simple"/></inline-formula> values are self-consistent. The choice of orthogonal projections is somewhat arbitrary, and is based on the assumption that it is beneficial to minimize the euclidean distance to the projected point that can be estimated using RC. This framework also enables us to calculate confidence intervals for standard reaction Gibbs energies in a mathematically sound way.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>The component contribution method</title>
<p>The component contribution method integrates reactant contributions and group contributions in a single, unified framework using a layered linear regression technique. This technique enables maximum usage of the more accurate reactant contributions, and fills in missing information using group contributions in a fully consistent manner. The inputs to the component contribution method are the stoichiometric matrix of measured reactions, denoted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e055" xlink:type="simple"/></inline-formula>, and a list of measurements of their standard Gibbs energies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e056" xlink:type="simple"/></inline-formula> (see Table S2 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref> for a list of mathematical symbols). In our case, all data is taken from TECRDB <xref ref-type="bibr" rid="pcbi.1003098-Goldberg1">[11]</xref> and tables of compound formation energies <xref ref-type="bibr" rid="pcbi.1003098-Thauer1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003098-Alberty2">[15]</xref>. As a pre-processing step which is used to linearize the problem, we apply an inverse Legendre transform to the observed equilibrium constants in TECRDB and the formation energies, if necessary (same as in <xref ref-type="bibr" rid="pcbi.1003098-Noor1">[24]</xref>, see Section S1 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref>). To provide context for the mathematical formulation of the component contribution method, we precede it with general formulations of the reactant and group contribution methods, and discuss the limitations of each. The reactant and group contribution methods are both based on linear regression. The difference between the two methods lies in the regression models used in each.</p>
<sec id="s3a1">
<title>Reactant contribution method</title>
<p>The regression model used in the reactant contribution method is based on the first law of thermodynamics (conservation of energy). The first law dictates that the overall standard Gibbs energy of a reaction that takes place in more than one step, is the sum of the standard Gibbs energies of all the intermediate steps at the same conditions <xref ref-type="bibr" rid="pcbi.1003098-Berry1">[25]</xref>. Consequently, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e057" xlink:type="simple"/></inline-formula> is the vector of standard Gibbs energies of formation for compounds in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e058" xlink:type="simple"/></inline-formula>, then the standard Gibbs energies of reactions in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e059" xlink:type="simple"/></inline-formula> are given by the equation<disp-formula id="pcbi.1003098.e060"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e060" xlink:type="simple"/><label>(1)</label></disp-formula></p>
<p>From <xref ref-type="disp-formula" rid="pcbi.1003098.e060">Eq. 1</xref> it is apparent that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e061" xlink:type="simple"/></inline-formula> is in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e062" xlink:type="simple"/></inline-formula>, which we denote by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e063" xlink:type="simple"/></inline-formula>. In practice, this may not be readily true for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e064" xlink:type="simple"/></inline-formula> from TECRDB, since its values are empirically derived and thus subject to measurement noise. Also, the exact ionic strength is not known for most measurements and the extended Debye-Hückel theory of electrolyte solutions <xref ref-type="bibr" rid="pcbi.1003098-Dill1">[26]</xref> (which the inverse Legendre transform is based on <xref ref-type="bibr" rid="pcbi.1003098-Alberty3">[27]</xref>) is itself an approximation. The linear regression model used in the reactant contribution method for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e065" xlink:type="simple"/></inline-formula> therefore takes the form<disp-formula id="pcbi.1003098.e066"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e066" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e067" xlink:type="simple"/></inline-formula> encompasses the error from the aforementioned sources.</p>
<p>Least-squares linear regression on the system in <xref ref-type="disp-formula" rid="pcbi.1003098.e066">Eq. 2</xref> gives the reactant contribution estimate of the standard Gibbs energies of formation for compounds in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e068" xlink:type="simple"/></inline-formula><disp-formula id="pcbi.1003098.e069"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e069" xlink:type="simple"/><label>(3)</label></disp-formula>The Moore–Penrose pseudoinverse <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e070" xlink:type="simple"/></inline-formula> is used because <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e071" xlink:type="simple"/></inline-formula> is typically column rank deficient. Reactant contribution fitted standard Gibbs energies for reactions in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e072" xlink:type="simple"/></inline-formula> are,<disp-formula id="pcbi.1003098.e073"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e073" xlink:type="simple"/><label>(4)</label></disp-formula>i.e., they are the orthogonal projection of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e074" xlink:type="simple"/></inline-formula> onto <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e075" xlink:type="simple"/></inline-formula>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e076" xlink:type="simple"/></inline-formula> is therefore the closest point to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e077" xlink:type="simple"/></inline-formula> that is consistent with the first law of thermodynamics. The residual of the fit<disp-formula id="pcbi.1003098.e078"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e078" xlink:type="simple"/><label>(5)</label></disp-formula>gives an estimate of the error term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e079" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003098.e066">Eq. 2</xref>. We stress that there is a conceptual distinction between the residual (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e080" xlink:type="simple"/></inline-formula>) and the statistical error (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e081" xlink:type="simple"/></inline-formula>). <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e082" xlink:type="simple"/></inline-formula> is dependent on the specific sample of equilibrium constants we use in the training set, while <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e083" xlink:type="simple"/></inline-formula> is a random variable that can only be approximated. We use the term <italic>error</italic> for the deviation of an observed or estimated Gibbs energy (known values), from the (unknown) true Gibbs energy. The term <italic>residual</italic> is used for the deviation of an observed Gibbs energy from an estimate. We note that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e084" xlink:type="simple"/></inline-formula> is in the null space of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e085" xlink:type="simple"/></inline-formula>, denoted <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e086" xlink:type="simple"/></inline-formula>, since the null space is the orthogonal complement of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e087" xlink:type="simple"/></inline-formula>, according to the fundamental theorem of linear algebra.</p>
<p>The standard Gibbs energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e088" xlink:type="simple"/></inline-formula> of an unmeasured reaction with stoichiometric vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e089" xlink:type="simple"/></inline-formula> can be estimated with the reactant contribution method as<disp-formula id="pcbi.1003098.e090"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e090" xlink:type="simple"/><label>(6)</label></disp-formula>This result is consistent with the first law of thermodynamics in the following sense. In general, the first law implies that the standard Gibbs energy of a linear combination of reactions, is the same combination applied to the respective standard reaction Gibbs energies. Mathematically, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e091" xlink:type="simple"/></inline-formula> then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e092" xlink:type="simple"/></inline-formula>. The former equation gives <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e093" xlink:type="simple"/></inline-formula> which is precisely the result in <xref ref-type="disp-formula" rid="pcbi.1003098.e090">Eq. 6</xref>. Having compliance with the first law as the only assumption explains the high accuracy of the reactant contribution method.</p>
<p>The reactant contribution method can be used to evaluate standard Gibbs energies for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e094" xlink:type="simple"/></inline-formula> in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e095" xlink:type="simple"/></inline-formula>, i.e. reactions that are linear combinations of reactions in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e096" xlink:type="simple"/></inline-formula> (and thus have at least one solution for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e097" xlink:type="simple"/></inline-formula>). Any component of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e098" xlink:type="simple"/></inline-formula> that is not in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e099" xlink:type="simple"/></inline-formula> cannot be evaluated. Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e100" xlink:type="simple"/></inline-formula> is rank deficient, its range represents only a fraction of the entire space of reactions and thus most reactions are under-determined by this method. For instance, the CMP phosphohydrolase reaction (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e101" xlink:type="simple"/></inline-formula>) exists in the <italic>E. coli</italic> model but is not listed as a measured reaction in TECRDB. Although CMP and cytidine both appear in other measured reactions (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e102" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e103" xlink:type="simple"/></inline-formula>), it is impossible to use a combination of reactions in TECRDB to find the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e104" xlink:type="simple"/></inline-formula> of the CMP phosphohydrolase reaction.</p>
</sec><sec id="s3a2">
<title>Group contribution method</title>
<p>Increased reaction coverage can be achieved using the group contribution method, where each compound in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e105" xlink:type="simple"/></inline-formula> is decomposed into a predefined set of structural subgroups. Each decomposition is represented by a row of the group incidence matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e106" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e107" xlink:type="simple"/></inline-formula> is assumed to be a linear combination of the standard Gibbs energy contributions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e108" xlink:type="simple"/></inline-formula> of the groups in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e109" xlink:type="simple"/></inline-formula>. The linear regression model for the group contribution method is<disp-formula id="pcbi.1003098.e110"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e110" xlink:type="simple"/><label>(7)</label></disp-formula><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e111" xlink:type="simple"/></inline-formula> describes the group decompositions of reactions in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e112" xlink:type="simple"/></inline-formula> i.e., the stoichiometry of groups that are consumed or produced in the reactions. An estimate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e113" xlink:type="simple"/></inline-formula> is obtained using linear regression on the system in <xref ref-type="disp-formula" rid="pcbi.1003098.e110">Eq. 7</xref> i.e.,<disp-formula id="pcbi.1003098.e114"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e114" xlink:type="simple"/><label>(8)</label></disp-formula>and like in reactant contribution we define <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e115" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e116" xlink:type="simple"/></inline-formula>. The group contribution estimate of the standard reaction Gibbs energy for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e117" xlink:type="simple"/></inline-formula> can then be derived as<disp-formula id="pcbi.1003098.e118"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e118" xlink:type="simple"/><label>(9)</label></disp-formula></p>
<p>The reaction coverage of the group contribution method is much greater than that of the reactant contribution method in <xref ref-type="disp-formula" rid="pcbi.1003098.e090">Eq. 6</xref>, because the column rank deficiency of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e119" xlink:type="simple"/></inline-formula> is much smaller than that of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e120" xlink:type="simple"/></inline-formula>. However, this greater coverage comes at a price, since the assumption of group additivity underlying the model in <xref ref-type="disp-formula" rid="pcbi.1003098.e110">Eq. 7</xref> is not always accurate. We estimated the root-mean-square error resulting from this assumption as 6.8 kJ/mol for all reactions in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e121" xlink:type="simple"/></inline-formula> (see Section S4 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref> for details). The reaction coverage of group contribution methods is still limited to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e122" xlink:type="simple"/></inline-formula>, i.e. reactions with group decompositions that are linear combinations of the group decompositions of measured reactions.</p>
</sec><sec id="s3a3">
<title>Mathematical formulation of the component contribution method</title>
<p>The reactant contribution method covers any vector in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e123" xlink:type="simple"/></inline-formula>. The component contribution method takes advantage of the fact that any reaction vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e124" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e125" xlink:type="simple"/></inline-formula> can be decomposed into a component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e126" xlink:type="simple"/></inline-formula> in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e127" xlink:type="simple"/></inline-formula>, and an orthogonal component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e128" xlink:type="simple"/></inline-formula> in the null space of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e129" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e130" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e131" xlink:type="simple"/></inline-formula> be the orthogonal projection matrices onto the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e132" xlink:type="simple"/></inline-formula> and the null space of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e133" xlink:type="simple"/></inline-formula>, respectively. Then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e134" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e135" xlink:type="simple"/></inline-formula> (so <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e136" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e137" xlink:type="simple"/></inline-formula>). The component contribution method applies the more reliable reactant contribution method to evaluate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e138" xlink:type="simple"/></inline-formula>, and only applies the less reliable group contribution method to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e139" xlink:type="simple"/></inline-formula> (see <xref ref-type="fig" rid="pcbi-1003098-g003">Figure 3</xref>). The standard reaction Gibbs energy estimate for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e140" xlink:type="simple"/></inline-formula> is obtained by summing up the contributions from the two components (see <xref ref-type="disp-formula" rid="pcbi.1003098.e090">Equations 6</xref> and <xref ref-type="disp-formula" rid="pcbi.1003098.e118">9</xref>) i.e.,<disp-formula id="pcbi.1003098.e141"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e141" xlink:type="simple"/><label>(10)</label></disp-formula>(see the full derivation in Section S3 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref>). We note that using the two orthogonal projections is only one option for separating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e142" xlink:type="simple"/></inline-formula> to two components and applying RC and GC on each one respectively. Other pairs of linear projections could be applied as long as they fulfill the requirement that they sum up to the identity matrix, and that the range of the first one is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e143" xlink:type="simple"/></inline-formula>. Here we chose <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e144" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e145" xlink:type="simple"/></inline-formula> because they minimize the norm of the second component, and we assume there is benefit to it.</p>
<fig id="pcbi-1003098-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003098.g003</object-id><label>Figure 3</label><caption>
<title>A diagram illustrating how the component contribution method projects the stoichiometric vector onto the different spaces.</title>
<p>(A) The reaction vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e146" xlink:type="simple"/></inline-formula> is decomposed into the two components <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e147" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e148" xlink:type="simple"/></inline-formula>, where the reactant contribution and group contribution methods are used for the relevant components. Later, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e149" xlink:type="simple"/></inline-formula> is decomposed into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e150" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e151" xlink:type="simple"/></inline-formula>. The same projection is shown graphically in (B) where the green plane represents the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e152" xlink:type="simple"/></inline-formula> and the normal to that plane represents the null space of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e153" xlink:type="simple"/></inline-formula>. (C) An example for a reaction which decomposes into two non-zero components. In this case, the component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e154" xlink:type="simple"/></inline-formula> is equal to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e155" xlink:type="simple"/></inline-formula>, which means that the reaction is covered by the component contribution method.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003098.g003" position="float" xlink:type="simple"/></fig>
<p>The component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e156" xlink:type="simple"/></inline-formula> in the null space of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e157" xlink:type="simple"/></inline-formula> can only be evaluated if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e158" xlink:type="simple"/></inline-formula> is in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e159" xlink:type="simple"/></inline-formula>, i.e. the space covered by group contributions. We thus require that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e160" xlink:type="simple"/></inline-formula> where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e161" xlink:type="simple"/></inline-formula> is the component of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e162" xlink:type="simple"/></inline-formula> in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e163" xlink:type="simple"/></inline-formula>. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e164" xlink:type="simple"/></inline-formula> has a nonzero component <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e165" xlink:type="simple"/></inline-formula> then the overall reaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e166" xlink:type="simple"/></inline-formula> cannot be evaluated using component contributions. In practice we assign an infinite uncertainty to reactions where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e167" xlink:type="simple"/></inline-formula> as discussed in section <italic>Calculation of confidence intervals</italic>. The two orthogonal components of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e168" xlink:type="simple"/></inline-formula> are determined by orthogonal projections onto the subspaces of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e169" xlink:type="simple"/></inline-formula>, in the same way that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e170" xlink:type="simple"/></inline-formula> was decomposed by projections onto the subspaces of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e171" xlink:type="simple"/></inline-formula>. Component contribution is thus based on two layers of orthogonal decompositions; a first layer where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e172" xlink:type="simple"/></inline-formula> is decomposed into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e173" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e174" xlink:type="simple"/></inline-formula>, and a second layer where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e175" xlink:type="simple"/></inline-formula> is decomposed into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e176" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e177" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1003098-g003">Figure 3</xref>).</p>
<p>A common example where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e178" xlink:type="simple"/></inline-formula> occurs where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e179" xlink:type="simple"/></inline-formula> is a reaction that includes the formation of an uncommon group. If this group does not appear (or is always conserved) in all of the reactions in the training set then the contribution of that group is unknown. Since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e180" xlink:type="simple"/></inline-formula> has a non-zero value corresponding to that group, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e181" xlink:type="simple"/></inline-formula> cannot be in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e182" xlink:type="simple"/></inline-formula>.</p>
</sec></sec><sec id="s3b">
<title>Validation results</title>
<p>In order to evaluate the improvement in estimations derived using component contribution compared to an implementation of group contribution <xref ref-type="bibr" rid="pcbi.1003098-Noor1">[24]</xref>, we ran a cross-validation analysis (see section <italic>Leave-one-out cross-validation</italic> for details). The results of this analysis are shown in <xref ref-type="fig" rid="pcbi-1003098-g004">Figure 4</xref>, where we compare the distributions of the absolute residuals (the difference between each method's estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e183" xlink:type="simple"/></inline-formula> and the observed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e184" xlink:type="simple"/></inline-formula> according to TECRDB). For each estimation, the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e185" xlink:type="simple"/></inline-formula> for that reaction (or any other measurement of the same reaction) was not used for training the group contribution and component contribution methods.</p>
<fig id="pcbi-1003098-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003098.g004</object-id><label>Figure 4</label><caption>
<title>Cumulative distributions for the cross-validation results.</title>
<p>The CDF of the absolute-value residuals for both group contribution (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e186" xlink:type="simple"/></inline-formula>, pink) and component contribution (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e187" xlink:type="simple"/></inline-formula>, purple). The reactions were separated to ones which are (A) linearly-dependent on the set of all other reactions (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e188" xlink:type="simple"/></inline-formula> is in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e189" xlink:type="simple"/></inline-formula>, the stoichiometric matrix of all reactions except <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e190" xlink:type="simple"/></inline-formula>), and (B) to ones which are linearly-independent (and thus component contribution uses group decompositions for at least part of the reaction). We found an 80% reduction in the median for the former set and no significant change for the latter (p-value = <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e191" xlink:type="simple"/></inline-formula>).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003098.g004" position="float" xlink:type="simple"/></fig>
<p>Our results show a significant improvement for component contribution compared to group contribution when focusing on reactions in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e192" xlink:type="simple"/></inline-formula>. The median of all residuals (absolute value) was reduced from 4.6 to 1.0 kJ/mol (p-value<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e193" xlink:type="simple"/></inline-formula>) for this set of reactions. For reactions that were not in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e194" xlink:type="simple"/></inline-formula>, there was no significant difference (p-value = 0.45) in the median absolute residual between the two methods. The error in group contribution estimates that is due to the assumption of group additivity does not depend on the extent to which group contribution is used (see Section S4.2 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref>). Because component contribution uses group contribution to some extent for all reactions that are not in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e195" xlink:type="simple"/></inline-formula>, the error in component contribution estimates for those reactions is not significantly lower than the error in group contribution estimates. Note that it is still very important to use component contribution for these reactions (and not GC) for the sake of having consistent estimations across whole metabolic models (see section <italic>Unifying reactant and group contribution methods</italic> in the <xref ref-type="sec" rid="s2">Introduction</xref>).</p>
<p>In each iteration of the cross-validation, one reaction was excluded from the training set. To further validate the component contribution method, we used the results of each iteration to predict independent observations of the reaction that was excluded. All available observations of that reaction were then compared against the prediction intervals for its standard Gibbs energy (see section <italic>Calculation of prediction intervals</italic> in the <xref ref-type="sec" rid="s5">Methods</xref>). Overall, we found that 73% of observations fell within their respective 68% prediction intervals, 89% fell within their 90% prediction intervals, 92% fell within their 95% prediction intervals, and 97% within their 99% intervals. Prediction intervals obtained with the component contribution method were on average 36% smaller than those obtained with group contribution. Taken together, these results show that the component contribution method yields estimates with reliable confidence intervals, as well as increased accuracy and reduced uncertainty compared to group contribution.</p>
</sec><sec id="s3c">
<title>Application to genome-scale metabolic reconstructions</title>
<p>A major application of the component contribution method is estimation of standard Gibbs energies for reactions in genome-scale reconstructions. Such large reaction networks require consistent and reliable estimates with high coverage. If estimates are not consistent, the risk of reference point violations increases with network size. As discussed in section <italic>Adjustment to in vivo conditions</italic>, metabolic models generally require estimates of standard transformed Gibbs energies, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e196" xlink:type="simple"/></inline-formula>, at <italic>in vivo</italic> conditions. To meet this requirement, we have integrated the component contribution method into a new version (2.0) of von Bertalanffy <xref ref-type="bibr" rid="pcbi.1003098-Fleming4">[28]</xref> (see section <italic>Implementation and availability of code</italic>).</p>
<p>Here, we apply von Bertalanffy 2.0 to two reconstruction; the <italic>E. coli</italic> reconstruction iAF1260 <xref ref-type="bibr" rid="pcbi.1003098-Feist1">[5]</xref> and the human reconstruction Recon 1 <xref ref-type="bibr" rid="pcbi.1003098-Duarte1">[29]</xref>. Standard transformed reaction Gibbs energies had previously been estimated for both reconstructions, with older versions of von Bertalanffy <xref ref-type="bibr" rid="pcbi.1003098-Fleming2">[8]</xref>, . Those older versions relied on a combination of experimentally derived standard formation energies from <xref ref-type="bibr" rid="pcbi.1003098-Alberty2">[15]</xref>, and estimated standard formation energies obtained with the group contribution method presented in <xref ref-type="bibr" rid="pcbi.1003098-Jankowski1">[23]</xref>. We compare estimates obtained with the new version of von Bertalanffy, to both experimental data in TECRDB, and estimates obtained with the older versions.</p>
<p><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e197" xlink:type="simple"/></inline-formula> were obtained for 90% (1878/2078) of internal reactions in iAF1260, and 72% (2416/3362) of internal reactions in Recon 1. External reactions i.e., exchange, demand and sink reactions are not mass or charge balanced and therefore have no defined Gibbs energies. To validate our estimates we compared them to available experimental data. Measurements of apparent equilibrium constants (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e198" xlink:type="simple"/></inline-formula>) were available in TECRDB for 163 of the evaluated iAF1260 reactions, and 186 Recon 1 reactions. Multiple measurements, made at different experimental conditions, were often available for a single reaction. To enable comparison, the data in TECRDB was first normalized to standard conditions by applying an inverse Legendre transform as described in Section S1 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref>. The resulting standard reaction Gibbs energies (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e199" xlink:type="simple"/></inline-formula>) were then adjusted to the conditions in <xref ref-type="table" rid="pcbi-1003098-t001">Tables 1</xref> and <xref ref-type="table" rid="pcbi-1003098-t002">2</xref> with von Bertalanffy, to obtain standard transformed reaction Gibbs energies, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e200" xlink:type="simple"/></inline-formula>. Comparison of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e201" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e202" xlink:type="simple"/></inline-formula> gave a root mean square error (RMSE) of 2.7 kJ/mol for iAF1260, and 3.1 kJ/mol for Recon 1.</p>
<table-wrap id="pcbi-1003098-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003098.t001</object-id><label>Table 1</label><caption>
<title>pH and electrical potential in each compartment of the <italic>E. coli</italic> reconstruction iAF1260.</title>
</caption><alternatives><graphic id="pcbi-1003098-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003098.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Compartment</td>
<td align="left" rowspan="1" colspan="1">pH</td>
<td align="left" rowspan="1" colspan="1">Electrical potential (mV)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Cytosol</td>
<td align="left" rowspan="1" colspan="1">7.70</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Periplasm</td>
<td align="left" rowspan="1" colspan="1">7.70</td>
<td align="left" rowspan="1" colspan="1">90</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Extracellular fluid</td>
<td align="left" rowspan="1" colspan="1">7.70</td>
<td align="left" rowspan="1" colspan="1">90</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>Electrical potential in each compartment is relative to electrical potential in the cytosol. Temperature was set to 310.15 K (37°C), and ionic strength was assumed to be 0.25 M <xref ref-type="bibr" rid="pcbi.1003098-Alberty1">[14]</xref> in all compartments. Taken from <xref ref-type="bibr" rid="pcbi.1003098-Fleming2">[8]</xref>.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1003098-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003098.t002</object-id><label>Table 2</label><caption>
<title>pH and electrical potential in each compartment of the human reconstruction Recon 1.</title>
</caption><alternatives><graphic id="pcbi-1003098-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003098.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Compartment</td>
<td align="left" rowspan="1" colspan="1">pH</td>
<td align="left" rowspan="1" colspan="1">Electrical potential (mV)</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Cytosol</td>
<td align="left" rowspan="1" colspan="1">7.20</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Extracellular fluid</td>
<td align="left" rowspan="1" colspan="1">7.40</td>
<td align="left" rowspan="1" colspan="1">30</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Golgi apparatus</td>
<td align="left" rowspan="1" colspan="1">6.35</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Lysosomes</td>
<td align="left" rowspan="1" colspan="1">5.50</td>
<td align="left" rowspan="1" colspan="1">19</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mitochondria</td>
<td align="left" rowspan="1" colspan="1">8.00</td>
<td align="left" rowspan="1" colspan="1">−155</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Nucleus</td>
<td align="left" rowspan="1" colspan="1">7.20</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Endoplasmic reticulum</td>
<td align="left" rowspan="1" colspan="1">7.20</td>
<td align="left" rowspan="1" colspan="1">0</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Peroxisomes</td>
<td align="left" rowspan="1" colspan="1">7.00</td>
<td align="left" rowspan="1" colspan="1">12</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>Electrical potential in each compartment is relative to electrical potential in the cytosol. Temperature was set to 310.15 K (37°C), and ionic strength was assumed to be 0.15 M <xref ref-type="bibr" rid="pcbi.1003098-Alberty1">[14]</xref> in all compartments. Taken from <xref ref-type="bibr" rid="pcbi.1003098-Haraldsdttir1">[10]</xref>.</p></fn></table-wrap-foot></table-wrap>
<p>von Bertalanffy 2.0 relies on component contribution estimated standard reaction Gibbs energies, whereas older versions relied on a combination of experimental data and group contribution estimates. <xref ref-type="table" rid="pcbi-1003098-t003">Table 3</xref> compares standard transformed Gibbs energy estimates, for iAF1260 and Recon 1, between versions. Use of component contribution resulted in both higher coverage and lower RMSE than was achieved with the previously available data. The greater coverage was due to reactions where groups or compounds that were not covered by component contributions canceled out, because they appeared unchanged on both sides of the reactions. Such reactions are easily identified and evaluated within the component contribution framework.</p>
<table-wrap id="pcbi-1003098-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003098.t003</object-id><label>Table 3</label><caption>
<title>Comparison of standard transformed reaction Gibbs energy estimates based on component contributions, to estimates based on previously available data.</title>
</caption><alternatives><graphic id="pcbi-1003098-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003098.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="2" align="left" rowspan="1">iAF1260</td>
<td colspan="2" align="left" rowspan="1">Recon 1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">Fleming et al. <xref ref-type="bibr" rid="pcbi.1003098-Fleming2">[8]</xref></td>
<td align="left" rowspan="1" colspan="1">Current study</td>
<td align="left" rowspan="1" colspan="1">Haraldsdóttir et al. <xref ref-type="bibr" rid="pcbi.1003098-Haraldsdttir1">[10]</xref></td>
<td align="left" rowspan="1" colspan="1">Current study</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Coverage</td>
<td align="left" rowspan="1" colspan="1">85%</td>
<td align="left" rowspan="1" colspan="1">90%</td>
<td align="left" rowspan="1" colspan="1">63%</td>
<td align="left" rowspan="1" colspan="1">72%</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">RMSE (kJ/mol)</td>
<td align="left" rowspan="1" colspan="1">9.9</td>
<td align="left" rowspan="1" colspan="1">2.7</td>
<td align="left" rowspan="1" colspan="1">11.6</td>
<td align="left" rowspan="1" colspan="1">3.1</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e203" xlink:type="simple"/></inline-formula> (kJ/mol)</td>
<td align="left" rowspan="1" colspan="1">20.3</td>
<td align="left" rowspan="1" colspan="1">2.3</td>
<td align="left" rowspan="1" colspan="1">3.4</td>
<td align="left" rowspan="1" colspan="1">2.2</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>Another improvement achieved with the component contribution method was the lower standard error, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e204" xlink:type="simple"/></inline-formula>, of standard reaction Gibbs energy estimates compared with previously available methods (<xref ref-type="table" rid="pcbi-1003098-t003">Table 3</xref>). This is an important improvement as standard error has previously been shown to affect predictions made based on reaction Gibbs energy estimates <xref ref-type="bibr" rid="pcbi.1003098-Henry2">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003098-Fleming2">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003098-Haraldsdttir1">[10]</xref>. The reduction in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e205" xlink:type="simple"/></inline-formula> was obtained by accounting for covariances in parameter estimates (see section <italic>Calculation of confidence intervals</italic>). As we showed in section <italic>Validation results</italic>, the lower standard errors of component contribution estimates yielded reliable prediction intervals for observed standard reaction Gibbs energies. They can therefore be expected to also yield reliable confidence intervals for true standard reaction Gibbs energies.</p>
<p>The lower RMSE achieved with component contribution stems primarily from two factors. The first is the normalization of the training data by the inverse Legendre transform, which in <xref ref-type="bibr" rid="pcbi.1003098-Noor1">[24]</xref> was shown to lead to significant improvements in group contribution estimates of Gibbs energies. The second factor is the greater number of reactions that are fully evaluated with reactant contribution (<xref ref-type="disp-formula" rid="pcbi.1003098.e090">Eq. 6</xref>). Close to 10% of all evaluated reactions in both iAF1260 and Recon 1, were fully evaluated using only reactant contribution (<xref ref-type="fig" rid="pcbi-1003098-g005">Figure 5</xref>). Although this category represents a minority of all reactions, it includes the majority of reactions in central carbon metabolism. The greater accuracy in Gibbs energy estimates for reactions in central carbon metabolism is expected to have a disproportionally large effect, as these reactions are involved in most metabolic activities. To support this claim, we predicted 312 flux distributions for iAF1260 and 97 flux distributions for Recon 1 (see Section S6 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref> for details). We found that the tenth of reactions that were fully evaluated with reactant contributions carried approximately half of the total flux in iAF1260 and a third of the total flux in Recon 1 (<xref ref-type="fig" rid="pcbi-1003098-g005">Figure 5</xref>).</p>
<fig id="pcbi-1003098-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003098.g005</object-id><label>Figure 5</label><caption>
<title>Distribution of the fractions of reaction vectors (black)</title>
<p>in iAF1260 (<italic>E. coli</italic>) and Recon 1 (human), that were in the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e206" xlink:type="simple"/></inline-formula>, and were thus evaluated with reactant contribution (RC). For a reaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e207" xlink:type="simple"/></inline-formula>, this fraction was calculated as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e208" xlink:type="simple"/></inline-formula>. Passive and facilitated diffusion reactions, where the reactants undergo no chemical changes, are not included in the figure. 9.4% of all evaluated reactions in iAF1260 were fully evaluated using only reactant contributions. These reactions carried approximately half of the total flux (red) in 312 predicted flux distributions. The 8.3% of evaluated reactions in Recon 1 that were fully evaluated with reactant contributions, carried close to a third of the total flux in 97 predicted flux distributions.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003098.g005" position="float" xlink:type="simple"/></fig></sec></sec><sec id="s4">
<title>Discussion</title>
<p>The component contribution method presented in this paper merges two established methods for calculating standard Gibbs energies of reactions while maintaining each of their advantages; accuracy in the case of reactant contribution (RC) and the wide coverage of group contribution (GC). By representing every reaction as a sum of two complementary component reactions, one in the subspace that is completely covered by RC and the other in the complementary space, we maximize the usage of information that can be obtained with the more accurate RC method. Overall, we find that there is a 50% reduction in the median absolute residual compared to standard GC methods, while providing the same wide coverage and ensuring that there are no reference-point inconsistencies that otherwise lead to large errors. Furthermore, since our method is based on least-squares linear regression, we use standard practices for calculating confidence intervals for standard Gibbs energies (see section <italic>Calculation of confidence intervals</italic>), and for weighing the measured standard Gibbs energies used as training data (see Section S1.2 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref>).</p>
<p>Since the empirical data used in our method is measured in various conditions (temperature, pH, ionic strength, metal ion concentrations, etc.) – it is important to “standardize” the input data before applying any linear regression model <xref ref-type="bibr" rid="pcbi.1003098-Noor1">[24]</xref>. In this work, we used an inverse Legendre transform to normalize the pH and ionic strength, but ignore the temperature effect and the metal ion concentrations (see Section S1.1 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref>). In addition, the proton dissociation constants were obtained from a third party software estimator (by Marvin, see <xref ref-type="sec" rid="s5">Methods</xref>) and have a mean absolute error of about 0.9 pH units <xref ref-type="bibr" rid="pcbi.1003098-Lee1">[30]</xref>. Notably, a commendable effort for creating a database of thermodynamic quantities <xref ref-type="bibr" rid="pcbi.1003098-Li1">[31]</xref> has been published recently, where the data was standardized using more reliable parameters and considering more effects. This database currently only covers reactions from glycolysis, the tricarboxylic acid cycle, and the pentose phosphate pathway. Therefore, we chose to use the more extensive TECRDB database and perform the inverse Legendre transform ourselves, effectively increasing the coverage while compromising on the accuracy of the data. Since the changes brought forward in the component contribution method are independent of the source of input data, we believe that it will benefit from any future improvements in these databases.</p>
<p>The precision of the component contribution method is limited by the accuracy of the measured reaction equilibrium constants used in the regression model. In cases of isolated reactions, where the empirical data cannot be corroborated by overlapping measurements, large errors will be directly propagated to our estimate of those reactions' standard Gibbs energies. As the number of measurements underlying an estimate is reflected in its standard error, however, confidence intervals for such reactions will be large. It is therefore recommended to use confidence intervals, and not point estimates, for simulations and predictions based on standard Gibbs energy estimates. In the future, it might be worthwhile to integrate several promising computational prediction approaches <xref ref-type="bibr" rid="pcbi.1003098-Irikura1">[32]</xref> which are not based on RC and GC, such as molecular mechanics methods <xref ref-type="bibr" rid="pcbi.1003098-Jorgensen1">[33]</xref>, density functional methods <xref ref-type="bibr" rid="pcbi.1003098-Goerigk1">[34]</xref>, and post Hartree-Fock approaches <xref ref-type="bibr" rid="pcbi.1003098-Peterson1">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003098-Bylaska1">[36]</xref>. Although the computational cost of these methods can be substantial depending on the theoretical method and the solvation models <xref ref-type="bibr" rid="pcbi.1003098-Marenich1">[37]</xref> used, they have the advantage of being based on computable chemical and physical principles, implying that a 100% coverage of all biochemical reactions is achievable (though not yet practical). Currently, the accuracy of these methods for reactions in solution is limited. Nevertheless, they might already be useful for estimating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e209" xlink:type="simple"/></inline-formula> of reactions that are not covered by component contributions, or for validating the sparse measurements. Alternatively, a method that infers <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e210" xlink:type="simple"/></inline-formula> from reaction similarities named IGERS <xref ref-type="bibr" rid="pcbi.1003098-Rother1">[38]</xref> manages to be much more accurate than GC when predicting the standard Gibbs energy of reactions which are very similar to a reaction with a measured <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e211" xlink:type="simple"/></inline-formula>. Adding IGERS as another layer between RC and GC using the ideas presented in this paper might contribute to the overall accuracy of our estimations. Finally, the laws of additivity suggested by <xref ref-type="bibr" rid="pcbi.1003098-Benson1">[16]</xref> include single atom (zero-order) and single bond (first-order) contributions, which would be too crude to use for approximating Gibbs energies directly, but might be useful as two extra layers in a method like component contribution and help cover a wider fraction of the reaction space.</p>
<p>The use of thermodynamic parameters in modeling living systems has been hindered by the fact that it is mostly inaccessible or requires a high level of expertise to use correctly, especially in genome-scale models. In order to alleviate this limitation, we created a framework that facilitates the integration of standard reaction Gibbs energies into existing models and also embedded our code into the openCOBRA toolbox. The entire framework (including the source code and training data) is freely available. We envisage a collaborative community effort that will result in a simple and streamlined process where these important thermodynamic data are widely used and where future improvements in estimation methods will seamlessly propagate to modelers.</p>
</sec><sec id="s5" sec-type="methods">
<title>Methods</title>
<sec id="s5a">
<title>Calculation of confidence intervals</title>
<p>The component contribution estimated standard Gibbs energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e212" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003098.e141">Eq. 10</xref>, is a point estimate of the true standard Gibbs energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e213" xlink:type="simple"/></inline-formula> for reaction vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e214" xlink:type="simple"/></inline-formula>. To quantify the uncertainty in this estimate, we need to calculate confidence intervals for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e215" xlink:type="simple"/></inline-formula>. An important advantage of integrating the reactant and group contribution methods in a single, unified framework is that it greatly simplifies calculation of confidence intervals. We present the key equations in this section. A summary of the statistical theory underlying these equations <xref ref-type="bibr" rid="pcbi.1003098-Kutner1">[39]</xref> is given in Section S7 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref>.</p>
<p>The covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e216" xlink:type="simple"/></inline-formula> for the reactant contribution estimates (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e217" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003098.e069">Eq. 3</xref>) is calculated as<disp-formula id="pcbi.1003098.e218"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e218" xlink:type="simple"/><label>(11)</label></disp-formula>where the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e219" xlink:type="simple"/></inline-formula> is scaled by the estimated variance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e220" xlink:type="simple"/></inline-formula> of the error term <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e221" xlink:type="simple"/></inline-formula> in <xref ref-type="disp-formula" rid="pcbi.1003098.e066">Eq. 2</xref>. Our estimate of the variance was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e222" xlink:type="simple"/></inline-formula> (kJ/mol)<sup>2</sup>. The covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e223" xlink:type="simple"/></inline-formula> for the group contribution estimates (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e224" xlink:type="simple"/></inline-formula>) is likewise obtained as<disp-formula id="pcbi.1003098.e225"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e225" xlink:type="simple"/><label>(12)</label></disp-formula>where the estimated variance of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e226" xlink:type="simple"/></inline-formula> from <xref ref-type="disp-formula" rid="pcbi.1003098.e110">Eq. 7</xref> was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e227" xlink:type="simple"/></inline-formula> (kJ/mol)<sup>2</sup>.</p>
<p>For a reaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e228" xlink:type="simple"/></inline-formula>, the <italic>standard error</italic> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e229" xlink:type="simple"/></inline-formula> is given by<disp-formula id="pcbi.1003098.e230"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e230" xlink:type="simple"/><label>(13)</label></disp-formula>The confidence interval for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e231" xlink:type="simple"/></inline-formula>, at a specified confidence level <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e232" xlink:type="simple"/></inline-formula>, is given by<disp-formula id="pcbi.1003098.e233"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e233" xlink:type="simple"/><label>(14)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e234" xlink:type="simple"/></inline-formula> is the value of the standard normal distribution at a cumulative probability of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e235" xlink:type="simple"/></inline-formula>. The 95% confidence interval for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e236" xlink:type="simple"/></inline-formula> is therefore <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e237" xlink:type="simple"/></inline-formula>.</p>
<p>In calculating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e238" xlink:type="simple"/></inline-formula>, we employ the covariance matrices for estimated parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e239" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e240" xlink:type="simple"/></inline-formula>. In contrast, Jankowski et al. used only the diagonal of the covariance matrix for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e241" xlink:type="simple"/></inline-formula> in their implementation of the group contribution method <xref ref-type="bibr" rid="pcbi.1003098-Jankowski1">[23]</xref>. The main advantage of using covariance matrices is that it leads to more appropriate confidence intervals for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e242" xlink:type="simple"/></inline-formula>, that can be much smaller. Knowledge about the relative Gibbs energy of two groups or compounds, increases with the number of measurements for reactions where those groups or compounds occur together. This knowledge should be reflected in smaller confidence intervals for reactions where the groups or compounds co-occur. Covariance matrices provide a means for propagating this knowledge. If only the diagonal of the covariance matrix is used, this knowledge is lost and confidence intervals will often be unnecessarily large.</p>
<p>The covariance matrices can likewise be used to propagate lack of knowledge to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e243" xlink:type="simple"/></inline-formula>. If <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e244" xlink:type="simple"/></inline-formula> is not in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e245" xlink:type="simple"/></inline-formula> then the reaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e246" xlink:type="simple"/></inline-formula> is not covered by the group contribution method or by the component contribution method. Then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e247" xlink:type="simple"/></inline-formula> obtained with <xref ref-type="disp-formula" rid="pcbi.1003098.e141">Eq. 10</xref> will not be a valid estimate of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e248" xlink:type="simple"/></inline-formula>, and should have a large (infinite) standard error. This can be achieved by adding a term to <xref ref-type="disp-formula" rid="pcbi.1003098.e230">Eq. 13</xref>;<disp-formula id="pcbi.1003098.e249"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e249" xlink:type="simple"/><label>(15)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e250" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e251" xlink:type="simple"/></inline-formula> is a projection matrix onto the null-space of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e252" xlink:type="simple"/></inline-formula>. <xref ref-type="disp-formula" rid="pcbi.1003098.e249">Eq. 15</xref> will give <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e253" xlink:type="simple"/></inline-formula> for all reactions that cannot be evaluated with component contributions because <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e254" xlink:type="simple"/></inline-formula> has a nonzero component in the null-space of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e255" xlink:type="simple"/></inline-formula>. In practice, we use a very large value instead of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e256" xlink:type="simple"/></inline-formula> (e.g. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e257" xlink:type="simple"/></inline-formula> kJ/mol) which will dominate any reasonable Gibbs energy in case <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e258" xlink:type="simple"/></inline-formula> is not orthogonal to this null-space.</p>
</sec><sec id="s5b">
<title>Leave-one-out cross-validation</title>
<p>Both group contribution and component contribution are parametric methods that use a set of training data in order to evaluate a long list of parameters. In order to validate these models, we need to use more empirical data which has not been used in the training phase. Since data regarding reaction Gibbs energies is scarce, we apply the leave-one-out method in order to maximize the amount of data left for training in each cross-validation iteration. As a measure for the quality of the standard Gibbs energy estimations from each method we use the median absolute residual of the cross-validation results compared to the observations.</p>
<p>Our entire training set consists of 4146 distinct reaction measurements. However, since many of them are experimental replicates – measurements of the same chemical reaction in different conditions or by different researchers – we can only use each distinct reaction once. We thus take the median <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e259" xlink:type="simple"/></inline-formula> over all replicates (after applying the inverse Legendre transform) as the value to be used for training or cross-validation. We choose the median rather than the mean to avoid sensitivity to outliers. After this process of unifying observations, we are left with 694 unique reaction observations. Note that the repetitions do play a role in determining the standard error in standard Gibbs energy estimates (see section <italic>Calculation of confidence intervals</italic>). Finally, the vector of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e260" xlink:type="simple"/></inline-formula> values for the unique reactions is projected onto the range of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e261" xlink:type="simple"/></inline-formula> since we assume that the actual values comply with the first law of thermodynamics (see section <italic>Reactant contribution method</italic>) and that any deviation is caused by experimental error.</p>
</sec><sec id="s5c">
<title>Calculation of prediction intervals</title>
<p>The <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e262" xlink:type="simple"/></inline-formula> prediction interval for a reaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e263" xlink:type="simple"/></inline-formula>, with estimated standard Gibbs energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e264" xlink:type="simple"/></inline-formula>, is calculated as<disp-formula id="pcbi.1003098.e265"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e265" xlink:type="simple"/><label>(16)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e266" xlink:type="simple"/></inline-formula> was defined in <xref ref-type="disp-formula" rid="pcbi.1003098.e233">Eq. 14</xref>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e267" xlink:type="simple"/></inline-formula>, the standard error of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e268" xlink:type="simple"/></inline-formula>, was defined in <xref ref-type="disp-formula" rid="pcbi.1003098.e249">Eq. 15</xref>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e269" xlink:type="simple"/></inline-formula> is calculated as<disp-formula id="pcbi.1003098.e270"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003098.e270" xlink:type="simple"/><label>(17)</label></disp-formula>i.e., it is a weighted mean of the estimated variances for reactant and group contribution, where the weights are the fractions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e271" xlink:type="simple"/></inline-formula> that are in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e272" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e273" xlink:type="simple"/></inline-formula>, respectively. A summary of the statistical theory underlying calculation of prediction intervals <xref ref-type="bibr" rid="pcbi.1003098-Kutner1">[39]</xref> is given in Section S7 in <xref ref-type="supplementary-material" rid="pcbi.1003098.s001">Text S1</xref>.</p>
</sec><sec id="s5d">
<title>Adjustment to <italic>in vivo</italic> conditions</title>
<p>For an input reaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e274" xlink:type="simple"/></inline-formula>, the component contribution method outputs an estimate of the reaction's standard <italic>chemical</italic> Gibbs energy <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e275" xlink:type="simple"/></inline-formula>. In a chemical reaction each compound is represented in a specific protonation state. This is in contrast to biochemical reactions, where each compound is represented as a pseudoisomer group of one <italic>or more</italic> species in different protonation states. To thermodynamically constrain models of living organisms we require Gibbs energies of biochemical reactions at <italic>in vivo</italic> conditions, known as standard <italic>transformed</italic> reaction Gibbs energies <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e276" xlink:type="simple"/></inline-formula>.</p>
<p>We estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e277" xlink:type="simple"/></inline-formula> with version 2.0 of von Bertalanffy <xref ref-type="bibr" rid="pcbi.1003098-Fleming2">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003098-Haraldsdttir1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003098-Fleming4">[28]</xref>; a Matlab implementation of biochemical thermodynamics theory as presented in <xref ref-type="bibr" rid="pcbi.1003098-Alberty1">[14]</xref>. A comprehensive summary of the relevant theory is given in <xref ref-type="bibr" rid="pcbi.1003098-Haraldsdttir1">[10]</xref>. In addition to component contribution estimates of standard Gibbs energies, required inputs to von Bertalanffy are a stoichiometric matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e278" xlink:type="simple"/></inline-formula> for a metabolic reconstruction of an organism, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e279" xlink:type="simple"/></inline-formula> values for compounds in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e280" xlink:type="simple"/></inline-formula>, and literature data on temperature, pH, ionic strength (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e281" xlink:type="simple"/></inline-formula>) and electrical potential (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e282" xlink:type="simple"/></inline-formula>) in each cell compartment in the reconstruction.</p>
<p>We estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e283" xlink:type="simple"/></inline-formula> for reactions in two multi-compartmental, genome scale metabolic reconstructions; an <italic>E. coli</italic> reconstruction iAF1260 <xref ref-type="bibr" rid="pcbi.1003098-Feist1">[5]</xref>, and a human reconstruction Recon 1 <xref ref-type="bibr" rid="pcbi.1003098-Duarte1">[29]</xref>. The environmental parameters pH, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e284" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e285" xlink:type="simple"/></inline-formula> were taken from <xref ref-type="bibr" rid="pcbi.1003098-Fleming2">[8]</xref> for <italic>E. coli</italic> (<xref ref-type="table" rid="pcbi-1003098-t001">Table 1</xref>), and from <xref ref-type="bibr" rid="pcbi.1003098-Haraldsdttir1">[10]</xref> for human (<xref ref-type="table" rid="pcbi-1003098-t002">Table 2</xref>). <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003098.e286" xlink:type="simple"/></inline-formula> values were estimated with Calculator Plugins, Marvin 5.10.1, 2012, ChemAxon (<ext-link ext-link-type="uri" xlink:href="http://www.chemaxon.com" xlink:type="simple">http://www.chemaxon.com</ext-link>).</p>
</sec><sec id="s5e">
<title>Implementation and availability of code</title>
<p>The component contribution method has been implemented in both Matlab and Python. The Matlab implementation is tailored towards application to genome-scale metabolic reconstructions. It is fully compatible with the COBRA toolbox <xref ref-type="bibr" rid="pcbi.1003098-Schellenberger2">[40]</xref> and is freely available as part of the openCOBRA project on Sourceforge (<ext-link ext-link-type="uri" xlink:href="http://sourceforge.net/projects/opencobra/" xlink:type="simple">http://sourceforge.net/projects/opencobra/</ext-link>). The component contribution method has been integrated into version 2.0 of von Bertalanffy to provide an easy-to-use tool to estimate transformed Gibbs energies at <italic>in vivo</italic> conditions. The Python implementation is a stand-alone package that can be used by researchers with suitable programming skills. The Python package includes a simple front-end called eQuilibrator (<ext-link ext-link-type="uri" xlink:href="http://equilibrator.weizmann.ac.il/" xlink:type="simple">http://equilibrator.weizmann.ac.il/</ext-link>), which is a freely available online service. The Python code for component contribution is licensed under the open source MIT License and available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/eladnoor/component-contribution" xlink:type="simple">https://github.com/eladnoor/component-contribution</ext-link>). Our code depends on the open source chemistry toolbox called Open Babel <xref ref-type="bibr" rid="pcbi.1003098-OBoyle1">[41]</xref>.</p>
</sec></sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003098.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003098.s001" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p>Supporting text with sections on 1) the inverse Legendre transform of the training data, 2) group decomposition, 3) the full mathematical derivation of the component contribution method, 4) estimation of error in the group model, 5) reaction type statistics, 6) prediction of flux distributions, 7) the theory underlying calculation of confidence and prediction intervals, and 8) mathematical symbols used throughout the manuscript.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank Arren Bar-Even, Wolfram Liebermeister, Naama Tepper, Tomer Shlomi, Bastian Niebel, Steinn Gudmundsson, Adrian Jinich, Dmitrij Rappoport, and William R. Cannon for helpful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003098-Beard1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Beard</surname><given-names>DA</given-names></name>, <name name-style="western"><surname>Babson</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Curtis</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Qian</surname><given-names>H</given-names></name> (<year>2004</year>) <article-title>Thermodynamic constraints for biochemical networks</article-title>. <source>journal of theoretical biology</source> <volume>228</volume>: <fpage>327</fpage>–<lpage>33</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Schellenberger1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schellenberger</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lewis</surname><given-names>NE</given-names></name>, <name name-style="western"><surname>Palsson</surname><given-names>BO</given-names></name> (<year>2011</year>) <article-title>Elimination of thermodynamically infeasible loops in steady-state metabolic models</article-title>. <source>Biophysical journal</source> <volume>100</volume>: <fpage>544</fpage>–<lpage>53</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Fleming1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name>, <name name-style="western"><surname>Maes</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Saunders</surname><given-names>Ma</given-names></name>, <name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Palsson</surname><given-names>BO</given-names></name> (<year>2012</year>) <article-title>A variational principle for computing nonequilibrium uxes and potentials in genome-scale biochemical networks</article-title>. <source>Journal of theoretical biology</source> <volume>292</volume>: <fpage>71</fpage>–<lpage>7</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Henry1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henry</surname><given-names>CS</given-names></name>, <name name-style="western"><surname>Jankowski</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Broadbelt</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Hatzimanikatis</surname><given-names>V</given-names></name> (<year>2006</year>) <article-title>Genome-scale thermodynamic analysis of Escherichia coli metabolism</article-title>. <source>Biophysical journal</source> <volume>90</volume>: <fpage>1453</fpage>–<lpage>61</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Feist1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Feist</surname><given-names>AM</given-names></name>, <name name-style="western"><surname>Henry</surname><given-names>CS</given-names></name>, <name name-style="western"><surname>Reed</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Krummenacker</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Joyce</surname><given-names>AR</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>A genome-scale metabolic reconstruction for Escherichia coli K-12 MG1655 that accounts for 1260 ORFs and thermodynamic information</article-title>. <source>Molecular systems biology</source> <volume>3</volume>: <fpage>121</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Henry2"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henry</surname><given-names>CS</given-names></name>, <name name-style="western"><surname>Broadbelt</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Hatzimanikatis</surname><given-names>V</given-names></name> (<year>2007</year>) <article-title>Thermodynamics-based metabolic flux analysis</article-title>. <source>Biophysical journal</source> <volume>92</volume>: <fpage>1792</fpage>–<lpage>805</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Zamboni1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zamboni</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Kummel</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Heinemann</surname><given-names>M</given-names></name> (<year>2008</year>) <article-title>fanNET:g a tool for network-embedded thermodynamic analysis of quantitative metabolome data</article-title>. <source>BMC Bioinf</source> <volume>9</volume>: <fpage>199</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Fleming2"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Nasheuer</surname><given-names>HP</given-names></name> (<year>2009</year>) <article-title>Quantitative assignment of reaction directionality in constraint-based models of metabolism: application to Escherichia coli</article-title>. <source>Biophysical chemistry</source> <volume>145</volume>: <fpage>47</fpage>–<lpage>56</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Fleming3"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Provan</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Nasheuer</surname><given-names>HP</given-names></name> (<year>2010</year>) <article-title>Integrated stoichiometric, thermodynamic and kinetic modelling of steady state metabolism</article-title>. <source>Journal of Theoretical Biology</source> <volume>264</volume>: <fpage>683</fpage>–<lpage>692</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Haraldsdttir1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haraldsdóttir</surname><given-names>HS</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name> (<year>2012</year>) <article-title>Quantitative assignment of reaction directionality in a multicompartmental human metabolic reconstruction</article-title>. <source>Biophysical journal</source> <volume>102</volume>: <fpage>1703</fpage>–<lpage>11</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Goldberg1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goldberg</surname><given-names>RN</given-names></name>, <name name-style="western"><surname>Tewari</surname><given-names>YB</given-names></name>, <name name-style="western"><surname>Bhat</surname><given-names>TN</given-names></name> (<year>2004</year>) <article-title>Thermodynamics of enzyme-catalyzed reactions–a database for quantitative biochemistry</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>20</volume>: <fpage>2874</fpage>–<lpage>7</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Krebs1"><label>12</label>
<mixed-citation publication-type="other" xlink:type="simple">Krebs HA, Kornberg HL, Burton K (1957) Energy transformation in living matter. Berlin, Germany: Springer.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Thauer1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thauer</surname><given-names>RK</given-names></name>, <name name-style="western"><surname>Jungermann</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Decker</surname><given-names>K</given-names></name> (<year>1977</year>) <article-title>Energy conservation in chemotrophic anaerobic bacteria</article-title>. <source>Bacteriological reviews</source> <volume>41</volume>: <fpage>809</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Alberty1"><label>14</label>
<mixed-citation publication-type="other" xlink:type="simple">Alberty RA (2003) Thermodynamics of Biochemical Reactions. Hoboken N.J.: John Wiley &amp; Sons, 0–2 pp.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Alberty2"><label>15</label>
<mixed-citation publication-type="other" xlink:type="simple">Alberty RA (2006) Biochemical Thermodynamics: Applications of Mathematica (Methods of Biochemical Analysis). Wiley-Interscience, 480 pp.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Benson1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benson</surname><given-names>SW</given-names></name>, <name name-style="western"><surname>Buss</surname><given-names>JH</given-names></name> (<year>1958</year>) <article-title>Additivity Rules for the Estimation of Molecular Properties. Thermodynamic Properties</article-title>. <source>The Journal of Chemical Physics</source> <volume>29</volume>: <fpage>546</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Benson2"><label>17</label>
<mixed-citation publication-type="other" xlink:type="simple">Benson SW (1967) Thermochemical Kinetics. New York, NY: John Wiley &amp; Sons, Inc., 320 pp.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Benson3"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benson</surname><given-names>SW</given-names></name>, <name name-style="western"><surname>Cruickshank</surname><given-names>FR</given-names></name>, <name name-style="western"><surname>Golden</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Haugen</surname><given-names>GR</given-names></name>, <name name-style="western"><surname>O'Neal</surname><given-names>HE</given-names></name>, <etal>et al</etal>. (<year>1969</year>) <article-title>Additivity rules for the estimation of thermochemical properties</article-title>. <source>Chemical Reviews</source> <volume>69</volume>: <fpage>279</fpage>–<lpage>324</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Ritter1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ritter</surname><given-names>ER</given-names></name>, <name name-style="western"><surname>Bozzelli</surname><given-names>JW</given-names></name> (<year>1991</year>) <article-title>THERM: Thermodynamic property estimation for gas phase radicals and molecules</article-title>. <source>International Journal of Chemical Kinetics</source> <volume>23</volume>: <fpage>767</fpage>–<lpage>778</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Domalski1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Domalski</surname><given-names>ES</given-names></name>, <name name-style="western"><surname>Hearing</surname><given-names>ED</given-names></name> (<year>1988</year>) <article-title>Estimation of the Thermodynamic Properties of Hydrocarbons at 298.15 K</article-title>. <source>Journal of Physical and Chemical Reference Data</source> <volume>17</volume>: <fpage>1637</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Mavrovouniotis1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mavrovouniotis</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Bayol</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lam</surname><given-names>TkM</given-names></name>, <name name-style="western"><surname>Stephanopoulos</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Stephanopoulos</surname><given-names>G</given-names></name> (<year>1988</year>) <article-title>A group contribution method for the estimation of equilibrium constants for biochemical reactions</article-title>. <source>Biotechnology Techniques</source> <volume>2</volume>: <fpage>23</fpage>–<lpage>28</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Mavrovouniotis2"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mavrovouniotis</surname><given-names>ML</given-names></name> (<year>1991</year>) <article-title>Group contributions for estimating standard gibbs energies of formation of biochemical compounds in aqueous solution</article-title>. <source>Biotechnology and Bioengineering</source> <volume>38</volume>: <fpage>803</fpage>–<lpage>804</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Jankowski1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jankowski</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Henry</surname><given-names>CS</given-names></name>, <name name-style="western"><surname>Broadbelt</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Hatzimanikatis</surname><given-names>V</given-names></name> (<year>2008</year>) <article-title>Group contribution method for thermodynamic analysis of complex metabolic networks</article-title>. <source>Biophysical journal</source> <volume>95</volume>: <fpage>1487</fpage>–<lpage>99</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Noor1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Noor</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Bar-Even</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Flamholz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Lubling</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Davidi</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>An integrated open framework for thermodynamics of reactions that combines accuracy and coverage</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>28</volume>: <fpage>2037</fpage>–<lpage>2044</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Berry1"><label>25</label>
<mixed-citation publication-type="other" xlink:type="simple">Berry SR, Rice SA, Ross J (2000) Thermochemistry and its applications. Oxford: Oxford University Press, 2nd edition, 388–419 pp.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Dill1"><label>26</label>
<mixed-citation publication-type="other" xlink:type="simple">Dill KA, Bromberg S (2003) Molecular driving forces: Statistical thermodynamics in Chemistry and Biology. London: Garland Science.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Alberty3"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Alberty</surname><given-names>RA</given-names></name> (<year>2002</year>) <article-title>Inverse Legendre Transform in Biochemical Thermodynamics: Illustrated with the Last Five Reactions of Glycolysis</article-title>. <source>The Journal of Physical Chemistry B</source> <volume>106</volume>: <fpage>6594</fpage>–<lpage>6599</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Fleming4"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name> (<year>2011</year>) <article-title>von Bertalanffy 1.0: a COBRA toolbox extension to thermodynamically constrain metabolic models</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>27</volume>: <fpage>142</fpage>–<lpage>3</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Duarte1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Duarte</surname><given-names>NC</given-names></name>, <name name-style="western"><surname>Becker</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Jamshidi</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Mo</surname><given-names>ML</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Global reconstruction of the human metabolic network based on genomic and bibliomic data</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>104</volume>: <fpage>1777</fpage>–<lpage>82</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Lee1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Crippen</surname><given-names>GM</given-names></name> (<year>2009</year>) <article-title>Predicting pKa</article-title>. <source>Journal of chemical information and modeling</source> <volume>49</volume>: <fpage>2013</fpage>–<lpage>33</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Li1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Qi</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Beard</surname><given-names>DA</given-names></name> (<year>2011</year>) <article-title>A database of thermodynamic properties of the reactions of glycolysis, the tricarboxylic acid cycle, and the pentose phosphate pathway</article-title>. <source>Database : the journal of biological databases and curation</source> <volume>2011</volume>: <fpage>bar005</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Irikura1"><label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Irikura KK, Frurip DJ (1998) Computational Thermochemistry. In: ACS Symposium Series, Washington, DC: American Chemical Society, volume 677 of ACS Symposium Series, chapter 1. pp. 2–18.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Jorgensen1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jorgensen</surname><given-names>WL</given-names></name>, <name name-style="western"><surname>Maxwell</surname><given-names>DS</given-names></name>, <name name-style="western"><surname>Tirado-Rives</surname><given-names>J</given-names></name> (<year>1996</year>) <article-title>Development and Testing of the OPLS All-Atom Force Field on Conformational Energetics and Properties of Organic Liquids</article-title>. <source>Journal of the American Chemical Society</source> <volume>118</volume>: <fpage>11225</fpage>–<lpage>11236</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Goerigk1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goerigk</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Grimme</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>A General Database for Main Group Thermochemistry, Kinetics, and Noncovalent Interactions - Assessment of Common and Reparameterized (meta -)GGA Density Functionals</article-title>. <source>Journal of Chemical Theory and Computation</source> <volume>6</volume>: <fpage>107</fpage>–<lpage>126</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Peterson1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peterson</surname><given-names>Ka</given-names></name>, <name name-style="western"><surname>Feller</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Dixon</surname><given-names>Da</given-names></name> (<year>2012</year>) <article-title>Chemical accuracy in ab initio thermochemistry and spectroscopy: current strategies and future challenges</article-title>. <source>Theoretical Chemistry Accounts</source> <volume>131</volume>: <fpage>1079</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Bylaska1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bylaska</surname><given-names>EJ</given-names></name>, <name name-style="western"><surname>Glaesemann</surname><given-names>KR</given-names></name>, <name name-style="western"><surname>Felmy</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Vasiliu</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Dixon</surname><given-names>DA</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Free energies for degradation reactions of 1,2,3-trichloropropane from ab initio electronic structure theory</article-title>. <source>The journal of physical chemistry A</source> <volume>114</volume>: <fpage>12269</fpage>–<lpage>82</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Marenich1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marenich</surname><given-names>AV</given-names></name>, <name name-style="western"><surname>Ding</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Cramer</surname><given-names>CJ</given-names></name>, <name name-style="western"><surname>Truhlar</surname><given-names>DG</given-names></name> (<year>2012</year>) <article-title>Resolution of a Challenge for Solvation Modeling: Calculation of Dicarboxylic Acid Dissociation Constants Using Mixed DiscreteContinuum Solvation Models</article-title>. <source>The Journal of Physical Chemistry Letters</source> <volume>3</volume>: <fpage>1437</fpage>–<lpage>1442</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Rother1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rother</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Hoffmann</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bulik</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hoppe</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Gasteiger</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>IGERS: inferring Gibbs energy changes of biochemical reactions from reaction similarities</article-title>. <source>Biophysical journal</source> <volume>98</volume>: <fpage>2478</fpage>–<lpage>86</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Kutner1"><label>39</label>
<mixed-citation publication-type="other" xlink:type="simple">Kutner MH, Nachtsheim CJ, Neter J, Li W (2004) Multiple Regression I. In: Applied Linear Statistical Models, McGraw-Hill/Irwin, chapter 6. 5 edition, pp. 214–255.</mixed-citation>
</ref>
<ref id="pcbi.1003098-Schellenberger2"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schellenberger</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Que</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Orth</surname><given-names>JD</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Quantitative prediction of cellular metabolism with constraint-based models: the COBRA Toolbox v2.0</article-title>. <source>Nature protocols</source> <volume>6</volume>: <fpage>1290</fpage>–<lpage>307</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003098-OBoyle1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>O'Boyle</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>Banck</surname><given-names>M</given-names></name>, <name name-style="western"><surname>James</surname><given-names>Ca</given-names></name>, <name name-style="western"><surname>Morley</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Vandermeersch</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Open Babel: An open chemical toolbox</article-title>. <source>Journal of cheminformatics</source> <volume>3</volume>: <fpage>33</fpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>