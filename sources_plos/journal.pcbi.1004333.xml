<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" dtd-version="3.0" xml:lang="en" article-type="research-article">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00187</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004333</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>BASiCS: Bayesian Analysis of Single-Cell Sequencing Data</article-title>
<alt-title alt-title-type="running-head">BASiCS: Bayesian Analysis of Single-Cell Sequencing Data</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Vallejos</surname> <given-names>Catalina A.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Marioni</surname> <given-names>John C.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Richardson</surname> <given-names>Sylvia</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>MRC Biostatistics Unit, Cambridge Institute of Public Health, Cambridge, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>EMBL European Bioinformatics Institute, Cambridge, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Morris</surname> <given-names>Quaid</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>University of Toronto, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: CAV JCM SR. Performed the experiments: CAV. Analyzed the data: CAV. Contributed reagents/materials/analysis tools: JCM SR. Wrote the paper: CAV JCM SR.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">catalina@mrc-bsu.cam.ac.uk</email> (CAV); <email xlink:type="simple">marioni@ebi.ac.uk</email> (JCM); <email xlink:type="simple">sylvia.richardson@mrc-bsu.cam.ac.uk</email> (SR)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>6</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="epub">
<day>24</day>
<month>6</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>6</issue>
<elocation-id>e1004333</elocation-id>
<history>
<date date-type="received">
<day>4</day>
<month>2</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>13</day>
<month>5</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Vallejos et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004333" xlink:type="simple"/>
<abstract>
<p>Single-cell mRNA sequencing can uncover novel cell-to-cell heterogeneity in gene expression levels in seemingly homogeneous populations of cells. However, these experiments are prone to high levels of unexplained technical noise, creating new challenges for identifying genes that show genuine heterogeneous expression within the population of cells under study. BASiCS (Bayesian Analysis of Single-Cell Sequencing data) is an integrated Bayesian hierarchical model where: (i) cell-specific normalisation constants are estimated as part of the model parameters, (ii) technical variability is quantified based on spike-in genes that are artificially introduced to each analysed cell’s lysate and (iii) the total variability of the expression counts is decomposed into technical and biological components. BASiCS also provides an intuitive detection criterion for highly (or lowly) variable genes within the population of cells under study. This is formalised by means of tail posterior probabilities associated to high (or low) biological cell-to-cell variance contributions, quantities that can be easily interpreted by users. We demonstrate our method using gene expression measurements from mouse Embryonic Stem Cells. Cross-validation and meaningful enrichment of gene ontology categories within genes classified as highly (or lowly) variable supports the efficacy of our approach.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Gene expression signatures have historically been used to generate molecular fingerprints that characterise distinct tissues. Moreover, by interrogating these molecular signatures it has been possible to understand how a tissue’s function is regulated at the molecular level. However, even between cells from a seemingly homogeneous tissue sample, there exists substantial heterogeneity in gene expression levels. These differences might correspond to novel subtypes or to transient states linked, for example, to the cell cycle. Single-cell RNA-sequencing, where the transcriptomes of individual cells are profiled using next generation sequencing, provides a method for identifying genes that show more variation across cells than expected by chance, which might be characteristic of such populations. However, single-cell RNA-sequencing is subject to a high degree of technical noise, making it necessary to account for this to robustly identify such genes. To this end, we use a fully Bayesian approach that jointly models extrinsic spike-in molecules with genes from the cells of interest allowing better identification of such genes than previously described computational strategies. We validate our approach using data from mouse Embryonic Stem Cells.</p>
</abstract>
<funding-group>
<funding-statement>Core funding from the EMBL supported JCM and CAV. Core funding from the MRC supported SR and CAV. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="9"/>
<table-count count="0"/>
<page-count count="18"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Current technology allows the analysis of gene expression with high resolution. Instead of measuring average expression levels across a bulk population, scientists can now report information at the single cell level using techniques such as single-cell RNA-sequencing (scRNA-seq) [<xref ref-type="bibr" rid="pcbi.1004333.ref001">1</xref>]. Unlike bulk experiments, scRNA-seq can uncover heterogenous gene expression patterns in seemingly homogeneous populations of cells [<xref ref-type="bibr" rid="pcbi.1004333.ref002">2</xref>], opening the door to important biological questions that remain otherwise unanswered. However, besides experimental challenges such as the isolation of single cells and parallel sequencing of multiple cDNA libraries [<xref ref-type="bibr" rid="pcbi.1004333.ref003">3</xref>], statistical analysis of single-cell level data is itself a challenge [<xref ref-type="bibr" rid="pcbi.1004333.ref004">4</xref>]. Firstly, cell-specific measurements can vary in scale due to differences in total cellular mRNA content [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]. For instance, in <xref ref-type="fig" rid="pcbi.1004333.g001">Fig 1(a)</xref>, each gene has the same expression rate in both cells, yet the expression counts in the first cell will be roughly twice as much as those from the second cell. In the same spirit, if different sequencing depths (the number of times a single nucleotide is read during the sequencing) are applied to these cells, the scale of expression counts will also be affected. Thus, normalisation is a crucial issue in this context. Another fundamental problem for interpreting single-cell sequencing is the presence of high levels of unexplained technical noise (unrelated to sequencing depth and other amplification biases) [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]. This creates new challenges for identifying genes that show genuine biological cell-to-cell heterogeneity—beyond that induced by technical variation—and motivates the systematic inclusion of spike-in genes in single-cell experiments. Quantifying genuine heterogeneity in gene expression is an important step as it can lead to the discovery of co-expressed genes and novel cell subpopulations, among others [<xref ref-type="bibr" rid="pcbi.1004333.ref004">4</xref>][<xref ref-type="bibr" rid="pcbi.1004333.ref006">6</xref>]. Recently, the introduction of Unique Molecular Identifiers (UMI) attached to each cDNA molecule during reverse transcription has substantially reduced the levels of unexplained technical noise and eliminated the effect of sequencing depth changes and other amplification biases in single-cell experiments. Unlike most scRNA-seq datasets published to date—where expression counts likely correspond to the number of reads mapped to each gene—UMI based datasets are recorded in terms of the number of molecules, producing a meaningful scale for the expression counts. Nevertheless, our analysis of a mouse Embryonic Stem Cells (ESC) suggests that unexplained technical variability can not be completely removed by using UMIs (see <xref ref-type="sec" rid="sec008">Results</xref> section) and that an accurate quantification of technical variability still remains important.</p>
<fig id="pcbi.1004333.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004333.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Graphical representation of gene expression in two cells from a homogeneous population but with different total mRNA content.</title>
<p>(a) Three biological genes have the same expression rates in both cells, however cell 1 doubles cell 2 in terms of total mRNA content. As a result, the expression counts in cell 1 will be roughly twice as much as those from cell 2, for all genes. In terms of the cell-specific size factors <italic>ϕ</italic><sub><italic>j</italic></sub>, an appropriate normalisation in this case would be e.g. <italic>ϕ</italic><sub>1</sub> = 2, <italic>ϕ</italic><sub>2</sub> = 1 (or any other values such that <italic>ϕ</italic><sub>1</sub>/<italic>ϕ</italic><sub>2</sub> = 2). (b) The same cells after the addition of two molecules of a spike-in gene to each cell. Because the same number of spike-in molecules are added to each cell, the spike-in expression counts are independent of the total mRNA content of each cell. Therefore, the cell-specific size factors <italic>ϕ</italic><sub><italic>j</italic></sub> are not required when modelling the technical gene.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.g001"/>
</fig>
<p>Throughout, we motivate our method using UMI-based expression counts. However, the methodology described here is general and can be also extended to traditional scRNA-seq experiments (where expression counts represent the number of short reads mapped to specific genes) by modifying the interpretation of some model parameters. Typical UMI based scRNA-seq data can be represented by a <italic>q</italic> × <italic>n</italic> matrix whose entries are the number of mRNA molecules mapped to specific genes (proxy for gene expression) for each cell. More specifically, let <italic>X</italic><sub><italic>ij</italic></sub> be a random variable representing the expression count of a gene <italic>i</italic> in cell <italic>j</italic> (<italic>i</italic> = 1, …, <italic>q</italic>; <italic>j</italic> = 1, …, <italic>n</italic>). Thus, in a homogeneous population of cells where the true concentration of fragments from a gene <italic>i</italic> is <italic>μ</italic><sub><italic>i</italic></sub> (in a suitable unit) and where measurements are not affected by unexplained technical error, <italic>X</italic><sub><italic>ij</italic></sub> follows a Poisson distribution with rate <italic>ϕ</italic><sub><italic>j</italic></sub> <italic>s</italic><sub><italic>j</italic></sub> <italic>μ</italic><sub><italic>i</italic></sub>, where <italic>ϕ</italic><sub><italic>j</italic></sub> adjusts the expression rate in terms of total mRNA content in cell <italic>j</italic> and <italic>s</italic><sub><italic>j</italic></sub> accounts for changes in capture efficiency across cells (for read-based expression counts, the latter also captures differences in sequencing depth and other amplification biases). Nonetheless, the Poisson model often predicts smaller variability than is observed in real datasets [<xref ref-type="bibr" rid="pcbi.1004333.ref007">7</xref>]. This so-called overdispersion is potentially linked to genes whose expression has a substantially larger biological cell-to-cell variability than would be expected in a homogeneous population of cells. However, this excess of variability may also arise from unexplained technical noise [<xref ref-type="bibr" rid="pcbi.1004333.ref006">6</xref>].</p>
<p>Non-biological spike-in genes (which are added to the lysis buffer and thence present at the same level in every cell) can be used to quantify technical noise (differences in capture efficiency and other unexplained sources). A typical example is the set of 92 extrinsic molecules derived by the External RNA Controls Consortium (ERCC) [<xref ref-type="bibr" rid="pcbi.1004333.ref008">8</xref>]. As the number of spike-in molecules added to each cell is known from experimental information, this provides a gold standard to which empirical measurements of spike-in genes’ expression can be compared, enabling a quantitative calibration of the technical noise. Similar strategies have also been used in the context of measurement error problems, where a validation <italic>error free</italic> group or gold standard measurements provide information about unknown sources of error (e.g. [<xref ref-type="bibr" rid="pcbi.1004333.ref009">9</xref>]).</p>
<p>Consistent with previous related literature (e.g. [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>], [<xref ref-type="bibr" rid="pcbi.1004333.ref007">7</xref>]), we introduce a model based on a Poisson structure. In BASiCS (Bayesian Analysis of Single-Cell Sequencing data), a joint model of biological and spike-in genes is formulated to simultaneously quantify unexplained technical noise and cell-to-cell biological heterogeneity using the complete set of data, borrowing information between both sets of genes (spike-in and biological) through common parameters in a hierarchical structure. Additionally, BASiCS incorporates an automated normalisation method, where normalising constants are treated as model parameters. These constitute major methodological advantages over previous 3-step approaches, where first datasets are pre-normalised and secondly unexplained technical noise is estimated using only the spike-in genes, before these parameters are plugged in when modelling biological data (ignoring the uncertainty related to the technical fit).</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec003">
<title>The BASiCS model</title>
<p>Throughout, we analyse the expression counts of <italic>q</italic> genes, where <italic>q</italic><sub>0</sub> are expressed in the population of cells under study (biological genes) and the remaining <italic>q</italic>−<italic>q</italic><sub>0</sub> are spike-in (technical) genes. Let <italic>X</italic><sub><italic>ij</italic></sub> be a random variable representing the expression count of a gene <italic>i</italic> in cell <italic>j</italic> (<italic>i</italic> = 1, …, <italic>q</italic>; <italic>j</italic> = 1, …, <italic>n</italic>). Firstly, we define a model for the technical genes, whose expression counts are not affected by total cellular mRNA content (see <xref ref-type="fig" rid="pcbi.1004333.g001">Fig 1(b)</xref>), thus the cell-specific size factors <italic>ϕ</italic><sub><italic>j</italic></sub> are not required (in this case, the normalisation must only account for differences in capture efficiency via the <italic>s</italic><sub><italic>j</italic></sub>’s). Naturally, for spike-in genes, deviations from a Poisson formulation are due only to unexplained technical variability. We assume that this unexplained technical noise depends on cell-specific characteristics and that, for a given cell, it affects the expression counts of <italic>all genes in the same manner</italic>. Under this assumption, unexplained technical noise can be incorporated through the following hierarchical model
<disp-formula id="pcbi.1004333.e001"><alternatives><graphic id="pcbi.1004333.e001g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e001"/><mml:math id="M1" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mover><mml:mo>∼</mml:mo> <mml:mtext>ind</mml:mtext></mml:mover> <mml:mtext>Poisson</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="5.69046pt"/><mml:msub><mml:mi>ν</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mo>|</mml:mo></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mover><mml:mo>∼</mml:mo> <mml:mtext>ind</mml:mtext></mml:mover> <mml:mtext>Gamma</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd/><mml:mtd><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi></mml:mrow> <mml:mtext>;</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mtext>,</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>μ</italic><sub><italic>i</italic></sub> represents the normalised expression rate of gene <italic>i</italic> in the population of cells under study and the random effect <italic>ν</italic><sub><italic>j</italic></sub> (with E(<italic>ν</italic><sub><italic>j</italic></sub>∣<italic>s</italic><sub><italic>j</italic></sub>, <italic>θ</italic>) = <italic>s</italic><sub><italic>j</italic></sub> and <inline-formula id="pcbi.1004333.e002"><alternatives><graphic id="pcbi.1004333.e002g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e002"/><mml:math id="M2" display="inline" overflow="scroll"><mml:mrow><mml:mtext mathvariant="normal">Var</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">∣</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>s</mml:mi> <mml:mi>j</mml:mi> <mml:mn>2</mml:mn></mml:msubsup> <mml:mi>θ</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>) fluctuates around the capture efficiency normalising constant <italic>s</italic><sub><italic>j</italic></sub>, quantifying unexplained technical noise via a single hyper-parameter <italic>θ</italic>, borrowing information across all genes and cells (see <xref ref-type="fig" rid="pcbi.1004333.g002">Fig 2</xref>). The model in <xref ref-type="disp-formula" rid="pcbi.1004333.e001">Eq (1)</xref> is equivalent to a negative binomial distribution for the expression counts (like in [<xref ref-type="bibr" rid="pcbi.1004333.ref007">7</xref>]). In order to accommodate the biological genes, BASICS extends the model in <xref ref-type="disp-formula" rid="pcbi.1004333.e001">Eq (1)</xref> as
<disp-formula id="pcbi.1004333.e003"><alternatives><graphic id="pcbi.1004333.e003g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e003"/><mml:math id="M3" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mover><mml:mo>∼</mml:mo> <mml:mtext>ind</mml:mtext></mml:mover> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>Poisson</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mtext>,</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mtext>;</mml:mtext></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>Poisson</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>ν</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi></mml:mrow> <mml:mtext>,</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula> <disp-formula id="pcbi.1004333.e004"><alternatives><graphic id="pcbi.1004333.e004g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e004"/><mml:math id="M4" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>with</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>ν</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mover><mml:mo>∼</mml:mo> <mml:mtext>ind</mml:mtext></mml:mover> <mml:mtext>Gamma</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext> <mml:mspace width="4.pt"/><mml:msub><mml:mi>ρ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">|</mml:mo></mml:mrow> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mover><mml:mo>∼</mml:mo> <mml:mtext>ind</mml:mtext></mml:mover> <mml:mtext>Gamma</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>ν</italic><sub><italic>j</italic></sub>’s and <italic>ρ</italic><sub><italic>ij</italic></sub>’s are mutually independent random effects and the cell-specific size factors <italic>ϕ</italic><sub><italic>j</italic></sub> are introduced to normalise the biological expression counts according to differences in total mRNA content (see <xref ref-type="fig" rid="pcbi.1004333.g001">Fig 1(a)</xref>). As in <xref ref-type="disp-formula" rid="pcbi.1004333.e001">Eq (1)</xref>, the <italic>ν</italic><sub><italic>j</italic></sub>’s capture cell-to-cell unexplained technical variability, oscillating around the capture efficiency normalising constants (<italic>s</italic><sub><italic>j</italic></sub>) according to the strength of unexplained technical variability (<italic>θ</italic>). The additional random effects, <italic>ρ</italic><sub><italic>ij</italic></sub> (with E(ρ<sub><italic>ij</italic></sub>∣<italic>δ</italic><sub><italic>i</italic></sub>) = 1 and Var(<italic>ρ</italic><sub><italic>ij</italic></sub>∣<italic>δ</italic><sub><italic>i</italic></sub>) = <italic>δ</italic><sub><italic>i</italic></sub>), relate to heterogeneous expression of a gene across cells, quantifying biological cell-to-cell variability via gene-specific hyper-parameters <italic>δ</italic><sub><italic>i</italic></sub>, borrowing information across all cells (see <xref ref-type="fig" rid="pcbi.1004333.g002">Fig 2</xref>). Unlike previous stepwise approaches (e.g. [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]), BASiCS treats cell-specific normalising constants (<italic>ϕ</italic><sub><italic>j</italic></sub>’s and <italic>s</italic><sub><italic>j</italic></sub>’s) as model parameters, and estimates them by combining information across all genes (see <xref ref-type="fig" rid="pcbi.1004333.g002">Fig 2</xref>), providing simultaneous inference with all other model parameters.</p>
<fig id="pcbi.1004333.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004333.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Graphical representation of the hierarchical model implemented in BASiCS.</title>
<p>Diagram based on the expression counts of 2 genes (<italic>i</italic>: biological and <italic>i</italic>′: technical) at 2 cells (<italic>j</italic> and <italic>j</italic>′). Squared and circular nodes denote known observed quantities (observed expression counts and added number of spike-in mRNA molecules) and unknown elements, respectively. Whereas black circular nodes represent the random effects that play an intermediate role in our hierarchical structure, red circular nodes relate to unknown model parameters in the top layer of hierarchy in our model. Blue, green and grey areas highlight elements that are shared within a biological gene, technical gene or cell, respectively. BASiCS treats cell-specific normalising constants (<italic>ϕ</italic><sub><italic>j</italic></sub>’s and <italic>s</italic><sub><italic>j</italic></sub>’s) as model parameters, and estimates them by combining information across all genes. Unexplained technical noise is quantified via a single hyper-parameter <italic>θ</italic>, borrowing information across all genes and cells. Finally, BASiCS quantifies biological cell-to-cell variability via gene-specific hyper-parameters <italic>δ</italic><sub><italic>i</italic></sub>, borrowing information across all cells.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.g002"/>
</fig>
<p>Here, the marginal distribution of the expression count of gene <italic>i</italic> in cell <italic>j</italic> (integrating out the random effects <italic>ν</italic><sub><italic>j</italic></sub>’s and <italic>ρ</italic><sub><italic>ij</italic></sub>’s) induces the same expected counts as in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]. In fact,
<disp-formula id="pcbi.1004333.e005"><alternatives><graphic id="pcbi.1004333.e005g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e005"/><mml:math id="M5" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mtext>E</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mtext>with</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mspace width="4.pt"/><mml:mtext>when</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:mi>i</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow> <mml:mspace width="4.pt"/><mml:mtext>and</mml:mtext> <mml:mspace width="4.pt"/><mml:mrow><mml:msub><mml:mi>I</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow> <mml:mspace width="4.pt"/><mml:mtext>otherwise.</mml:mtext></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
In addition, the variance of these expression counts can be decomposed as
<disp-formula id="pcbi.1004333.e006"><alternatives><graphic id="pcbi.1004333.e006g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e006"/><mml:math id="M6" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Var</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo stretchy="false">|</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>θ</mml:mi> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>+</mml:mo> <mml:msub><mml:mtext>I</mml:mtext> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
The first term in <xref ref-type="disp-formula" rid="pcbi.1004333.e006">Eq (5)</xref> is the biological baseline variance—based on a Poisson(<inline-formula id="pcbi.1004333.e007"><alternatives><graphic id="pcbi.1004333.e007g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e007"/><mml:math id="M7" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi> <mml:msub><mml:mi>I</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msubsup> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>) model. The second component represents the variance inflation due to unexplained technical variability and the final term is linked to biological cell-to-cell heterogeneity. The decomposition in <xref ref-type="disp-formula" rid="pcbi.1004333.e006">Eq (5)</xref> is similar (as a function of the expected counts) to those proposed in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] and [<xref ref-type="bibr" rid="pcbi.1004333.ref007">7</xref>], which have been validated empirically.</p>
</sec>
<sec id="sec004">
<title>BASiCS: detection of highly and lowly variable genes</title>
<p>Intuitively, highly variable genes (HVG) are those for which a large fraction of the total expression variability is explained by a biological cell-to-cell heterogeneity component. Here, we characterise highly variable genes as those for which
<disp-formula id="pcbi.1004333.e008"><alternatives><graphic id="pcbi.1004333.e008g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e008"/><mml:math id="M8" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>≡</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>δ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd/><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>where</mml:mtext> <mml:mspace width="5.69046pt"/><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:mo>=</mml:mo> <mml:munder><mml:mtext>median</mml:mtext> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:munder> <mml:mo stretchy="false">{</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>s</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo stretchy="false">}</mml:mo> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd/></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
i.e. when the proportion of the total variability of the expression counts of gene <italic>i</italic> in a reference cell (derived from <xref ref-type="disp-formula" rid="pcbi.1004333.e006">Eq (5)</xref>, replacing <italic>ϕ</italic><sub><italic>j</italic></sub> <italic>s</italic><sub><italic>j</italic></sub> by (<italic>ϕs</italic>)<sup>*</sup> in order to represent a <italic>typical cell</italic> within the analysed sample) that is explained by biological cell-to-cell heterogeneity exceeds a variance contribution threshold <italic>γ</italic><sub><italic>H</italic></sub>. In other words, we characterise as HVG those whose biological cell-to-cell heterogeneity component explains <italic>γ</italic><sub><italic>H</italic></sub> × 100% of the total variability (in a typical cell). The latter criterion induces contours in terms of <italic>δ</italic><sub><italic>i</italic></sub>, which are given by
<disp-formula id="pcbi.1004333.e009"><alternatives><graphic id="pcbi.1004333.e009g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e009"/><mml:math id="M9" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>δ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mo>[</mml:mo> <mml:mfrac><mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo> <mml:mo>[</mml:mo> <mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mi>s</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>*</mml:mo></mml:msup> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>+</mml:mo> <mml:mi>θ</mml:mi></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:mi>θ</mml:mi></mml:mrow></mml:mfrac> <mml:mo>]</mml:mo> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
Naturally, the contour in <xref ref-type="disp-formula" rid="pcbi.1004333.e009">Eq (7)</xref> is an increasing function of <italic>γ</italic><sub><italic>H</italic></sub>. Additionally, it is a decreasing function of the normalised expression rate <italic>μ</italic><sub><italic>i</italic></sub>, which is a welcome feature (previous studies have shown evidence of lower levels of biological cell-to-cell heterogeneity in highly expressed genes [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]).</p>
<p>BASiCS quantifies the evidence in favour of a gene being highly variable in terms of the upper tail posterior probabilities (associated to high biological cell-to-cell heterogeneity components) and labels as HVG those genes such that (for a given evidence threshold <italic>α</italic><sub><italic>H</italic></sub>)
<disp-formula id="pcbi.1004333.e010"><alternatives><graphic id="pcbi.1004333.e010g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e010"/><mml:math id="M10" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>P</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>:</mml:mo> <mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula>
i.e. when such evidence is strong. Analogously, lowly variable genes (LVG) would be those for which
<disp-formula id="pcbi.1004333.e011"><alternatives><graphic id="pcbi.1004333.e011g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e011"/><mml:math id="M11" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>L</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>L</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>P</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>σ</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>&lt;</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>L</mml:mi></mml:msub></mml:msub> <mml:mrow><mml:mo>|</mml:mo></mml:mrow> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>:</mml:mo> <mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>}</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:msub><mml:mrow/><mml:mi>L</mml:mi></mml:msub></mml:msub> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
for a given variance contribution threshold <italic>γ</italic><sub><italic>L</italic></sub> and an evidence threshold <italic>α</italic><sub><italic>L</italic></sub>. Estimates of these quantities can be easily computed based on a posterior sample of the model parameters, requiring minimal computational effort (other criteria, such as Bayes Factors, usually require intensive calculations [<xref ref-type="bibr" rid="pcbi.1004333.ref010">10</xref>]). Tail posterior probabilities have also been used in the context of differential expression for microarray experiments [<xref ref-type="bibr" rid="pcbi.1004333.ref011">11</xref>], providing richer and more interpretable output than standard hypothesis testing procedures.</p>
<p>Our method for detecting highly (and lowly) variable genes requires the choice of variance contribution thresholds <italic>γ</italic><sub><italic>H</italic></sub> and <italic>γ</italic><sub><italic>L</italic></sub> as well as evidence thresholds <italic>α</italic><sub><italic>H</italic></sub> and <italic>α</italic><sub><italic>L</italic></sub>. If there is biological motivation behind particular values of <italic>γ</italic><sub><italic>H</italic></sub> or <italic>γ</italic><sub><italic>L</italic></sub>, these values can be fixed prior to the analysis. However, <italic>α</italic><sub><italic>H</italic></sub> and <italic>α</italic><sub><italic>L</italic></sub> have a technical role, quantifying the uncertainty associated with the detection of HVG and LVG. For fixed values of <italic>γ</italic><sub><italic>H</italic></sub> and <italic>γ</italic><sub><italic>L</italic></sub>, we can choose optimal values for <italic>α</italic><sub><italic>H</italic></sub> and <italic>α</italic><sub><italic>L</italic></sub> as those where the expected false discovery rate (EFDR) and expected false negative rate (EFNR) coincide. For the rule in <xref ref-type="disp-formula" rid="pcbi.1004333.e010">Eq (8)</xref>, these quantities are defined as in [<xref ref-type="bibr" rid="pcbi.1004333.ref012">12</xref>] and respectively given by
<disp-formula id="pcbi.1004333.e012"><alternatives><graphic id="pcbi.1004333.e012g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e012"/><mml:math id="M12" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>EFDR</mml:mtext> <mml:msub><mml:mi>α</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msubsup> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mspace width="5.69046pt"/><mml:mtext>and</mml:mtext></mml:mrow></mml:mtd> <mml:mtd/><mml:mtd columnalign="left"><mml:mrow/></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>EFNR</mml:mtext> <mml:msub><mml:mi>α</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msubsup> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:msubsup> <mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:msub><mml:mrow/><mml:mi>H</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd> <mml:mtd/></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <italic>I(A)</italic> = 1 if <italic>A</italic> is true, 0 otherwise. Equivalent expressions can be determined for <xref ref-type="disp-formula" rid="pcbi.1004333.e011">Eq (9)</xref>, replacing <inline-formula id="pcbi.1004333.e013"><alternatives><graphic id="pcbi.1004333.e013g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e013"/><mml:math id="M13" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <italic>α</italic><sub><italic>H</italic></sub> by <inline-formula id="pcbi.1004333.e014"><alternatives><graphic id="pcbi.1004333.e014g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e014"/><mml:math id="M14" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>L</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <italic>α</italic><sub><italic>L</italic></sub>, respectively. Alternatively, if there is no clear pre-determined choice for <italic>γ</italic><sub><italic>H</italic></sub> and <italic>γ</italic><sub><italic>L</italic></sub>, choosing a specific common value for the EFDR and the EFNR (e.g. EFDR = EFNR = 10%) can define optimal values for <italic>α</italic><sub><italic>H</italic></sub> and <italic>α</italic><sub><italic>L</italic></sub> as well as for <italic>γ</italic><sub><italic>H</italic></sub> and <italic>γ</italic><sub><italic>L</italic></sub>.</p>
<p>Beyond the choice of particular thresholds for the detection of highly and lowly variable genes, a key advantage of our method is the generation of a natural ranking of the genes in terms of the percentage of variance explained by the biological cell-to-cell heterogeneity component (<italic>σ</italic><sub><italic>i</italic></sub>). For particular threshold choices, our method classifies as highly variable those genes for which <italic>σ</italic><sub><italic>i</italic></sub> is high (above the variance contribution threshold <italic>γ</italic><sub><italic>H</italic></sub>) and where there is strong evidence to support this fact (the probability of {<italic>σ</italic><sub><italic>i</italic></sub> &gt; <italic>γ</italic><sub><italic>H</italic></sub>} is above the evidence threshold <italic>α</italic><sub><italic>H</italic></sub>). As a result, BASiCS aims to identify key drivers of cell-to-cell heterogeneity rather than complete enumeration. Our analysis does not imply that all genes located below these thresholds have stable expression among the analysed cells.</p>
</sec>
<sec id="sec005">
<title>BASiCS: identifiability</title>
<p>Without additional assumptions, the parameters of the model presented in <xref ref-type="disp-formula" rid="pcbi.1004333.e003">Eq (2)</xref> and <xref ref-type="disp-formula" rid="pcbi.1004333.e004">Eq (3)</xref> cannot be identified. However, the cell-specific capture efficiency normalising terms <italic>s</italic><sub><italic>j</italic></sub>’s can be identified if we assume that <italic>μ</italic><sub><italic>q</italic><sub>0</sub>+1</sub>, …, <italic>μ</italic><sub><italic>q</italic></sub> are known. This is not a limitation, because the true concentration of the spike-in genes added to each cell are known from experimental information. In addition, <italic>δ</italic><sub><italic>i</italic></sub>’s (quantifying gene-specific biological cell-to-cell heterogeneity) and <italic>θ</italic> (quantifying unexplained technical variability) can be identified via the variance of the biological and technical expression counts. Nonetheless, the scale of the <italic>ϕ</italic><sub><italic>j</italic></sub>’s (cell-specific mRNA content normalisation) is arbitrary because <italic>μ</italic><sub>1</sub>, …, <italic>μ</italic><sub><italic>q</italic><sub>0</sub></sub> are unknown. A simple solution is to impose the restriction <inline-formula id="pcbi.1004333.e015"><alternatives><graphic id="pcbi.1004333.e015g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e015"/><mml:math id="M15" display="inline" overflow="scroll"><mml:mrow><mml:msup><mml:mi>n</mml:mi> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, which can be achieved by reparameterising the model in terms of <italic>κ</italic><sub>1</sub>, …, <italic>κ</italic><sub><italic>n</italic></sub> with
<disp-formula id="pcbi.1004333.e016"><alternatives><graphic id="pcbi.1004333.e016g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e016"/><mml:math id="M16" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mfrac><mml:mrow><mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>κ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mspace width="0.166667em"/><mml:msup><mml:mi>e</mml:mi> <mml:msub><mml:mi>κ</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:msup></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mspace width="28.45274pt"/><mml:msub><mml:mi>κ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
Although this restriction imposes an arbitrary scale to the <italic>ϕ</italic><sub><italic>j</italic></sub>’s, this does not affect inference about <italic>relative differences</italic> between the <italic>μ</italic><sub><italic>i</italic></sub>’s, nor the <italic>δ</italic><sub><italic>i</italic></sub>’s. Therefore, standard analyses, such as the detection of highly variable genes or differential expression, are not affected by particular values of <italic>ϕ</italic><sub>0</sub>. For simplicity, we recommend <italic>ϕ</italic><sub>0</sub> = <italic>n</italic> (this value will be used hereafter in this article).</p>
</sec>
<sec id="sec006">
<title>BASiCS: prior specification and implementation of posterior inference</title>
<p>We assume prior independence between all model parameters, using a flat <italic>non-informative</italic> prior for the normalised expression rates <italic>μ</italic><sub>1</sub>, …, <italic>μ</italic><sub><italic>q</italic><sub>0</sub></sub> and proper <italic>informative</italic> prior distributions for all other model parameters. Under this prior, Bayesian inference is implemented using an Adaptive Metropolis (AM) within Gibbs Sampling (GS) algorithm [<xref ref-type="bibr" rid="pcbi.1004333.ref013">13</xref>]. This algorithm was implemented using a combination of C++ and R via the Rcpp library [<xref ref-type="bibr" rid="pcbi.1004333.ref014">14</xref>]. An R package has been prepared and is available at: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://github.com/catavallejos/BASiCS">https://github.com/catavallejos/BASiCS</ext-link></p>
<p>More details about the prior specification and the implementation of posterior inference can be found in <xref ref-type="supplementary-material" rid="pcbi.1004333.s001">S1 Text</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004333.s002">S2 Text</xref>, respectively. Information regarding the computational cost of our method is displayed in <xref ref-type="supplementary-material" rid="pcbi.1004333.s007">S7 Text</xref>.</p>
</sec>
<sec id="sec007">
<title>Alternative method presented in Brennecke et al (2013)</title>
<p>Here, we briefly discuss the 3-step method described in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] to analyse scRNA-seq data and to detect HVG in the population of cells under study (notably, BASiCS not only provides a method for HVG detection, but LVG can also be identified). This method pre-normalises the expression counts using the method available in DESeq [<xref ref-type="bibr" rid="pcbi.1004333.ref015">15</xref>], calculating two separate sets of normalising constants as:
<disp-formula id="pcbi.1004333.e017"><alternatives><graphic id="pcbi.1004333.e017g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e017"/><mml:math id="M17" display="block" overflow="scroll"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mi>j</mml:mi> <mml:mi>B</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mtext>median</mml:mtext> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub> <mml:mo>{</mml:mo> <mml:mfrac><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mfrac> <mml:mo>}</mml:mo> <mml:mspace width="2.84544pt"/><mml:mtext>and</mml:mtext></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mi>j</mml:mi> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mtext>median</mml:mtext> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi></mml:mrow></mml:msub> <mml:mo>{</mml:mo> <mml:mfrac><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>n</mml:mi></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>/</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msup></mml:mfrac> <mml:mo>}</mml:mo> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mo>…</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
for biological and technical genes, respectively (in <xref ref-type="disp-formula" rid="pcbi.1004333.e017">Eq (12)</xref>, <italic>x</italic><sub><italic>ij</italic></sub> represents the observed counts of a gene <italic>i</italic> in cell <italic>j</italic>). In terms of our notation, <inline-formula id="pcbi.1004333.e018"><alternatives><graphic id="pcbi.1004333.e018g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e018"/><mml:math id="M18" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mi>j</mml:mi> <mml:mi>B</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004333.e019"><alternatives><graphic id="pcbi.1004333.e019g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e019"/><mml:math id="M19" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi> <mml:mi>j</mml:mi> <mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> play the role of <italic>ϕ</italic><sub><italic>j</italic></sub> <italic>s</italic><sub><italic>j</italic></sub> and <italic>s</italic><sub><italic>j</italic></sub>, respectively. Based on point estimates of these quantities, normalised expression counts are then computed as <inline-formula id="pcbi.1004333.e020"><alternatives><graphic id="pcbi.1004333.e020g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e020"/><mml:math id="M20" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>ω</mml:mi> <mml:mi>j</mml:mi> <mml:mi>B</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004333.e021"><alternatives><graphic id="pcbi.1004333.e021g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e021"/><mml:math id="M21" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msubsup><mml:mi>ω</mml:mi> <mml:mi>j</mml:mi> <mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> for biological and technical genes, respectively. When a large number of genes is being analysed, the variance associated to estimators in <xref ref-type="disp-formula" rid="pcbi.1004333.e017">Eq (12)</xref> is negligible. However, the expressions in <xref ref-type="disp-formula" rid="pcbi.1004333.e017">Eq (12)</xref> are undefined if one or more of the expression counts of any analysed gene are equal to zero (the geometric means in the denominators are equal to zero). A common solution is to exclude those genes with zero counts from the normalisation calculations (but not from any other downstream analysis). As a result, these estimators become highly unstable, especially for strong levels of technical noise (where a high proportion of zero counts is typically observed). This is illustrated in <xref ref-type="fig" rid="pcbi.1004333.g003">Fig 3</xref> (see panels (a) and (b)), where we simulated data using the same structure as the mouse ESC dataset analysed in the Results section, using the model implemented in BASiCS and a range of values for <italic>θ</italic> (including <italic>θ</italic> = 0, where there is no unexplained technical noise). <xref ref-type="fig" rid="pcbi.1004333.g003">Fig 3(b)</xref> also shows that the stepwise approach proposed in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] does not recover the correct scale for the <italic>s</italic><sub><italic>j</italic></sub>’s (not surprising as their method was not designed to do so). In contrast, <xref ref-type="fig" rid="pcbi.1004333.g003">Fig 3(c)</xref> shows the superior performance of our approach. This is not surprising because: (i) our estimates used the actual expression rates of the spike-in genes (given by the number of mRNA ERCC molecules added to the lysis buffer of each cell), instead of their empirical counterparts (recovering a correct and meaningful scale for the <italic>s</italic><sub><italic>j</italic></sub>’s) and (ii) we combined information from all genes (biological and technical) without having to exclude genes where one or more cell-specific counts were equal to zero.</p>
<fig id="pcbi.1004333.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004333.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Simulated performance of <italic>s</italic><sub><italic>j</italic></sub>’s estimates (method described in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] and BASiCS).</title>
<p>Based on 400 simulated datasets from the model implemented in BASiCS with the same structure as in the mouse ESC dataset (simulated parameter values defined as posterior medians of the original model fit) and 6 different values for <italic>θ</italic>. (a) percentage of the simulated spike-in genes (out of 46) without zero counts (i.e. those that can be used when calculating the estimator proposed in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]) for different simulated values of <italic>θ</italic>. (b) and (c) estimates of <italic>s</italic><sub>1</sub> (first cell) across all simulated datasets for different simulated values of <italic>θ</italic> using the method described in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] and BASiCS (posterior medians), respectively. As the strength of unexplained technical noise increases (larger values of <italic>θ</italic>), estimates obtained using the approach described in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] become highly unstable (we illustrated this using the first simulated cell, but the same conclusion can be obtained based on any other cell). This is due to a larger proportion of zeros among the simulated expression counts, i.e. less spike-in genes can be used when estimating <italic>s</italic><sub>1</sub>. In contrast, the stability of the BASiCS estimates is not substantially affected by the strength of unexplained technical noise.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.g003"/>
</fig>
<p>Using the pre-normalised expression counts, [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] proposes a HVG detection method based on the relationship between gene-specific sample means and the corresponding coefficients of variation. An initial fit of this relationship is made using only the spike-in genes (where heterogeneous expression is only due to a technical component), quantifying the effect of unexplained technical variability. The output of this technical fit is then plugged in when modelling biological data, characterising as HVG those whose expression variability substantially exceeds what would be expected due to technical variability (i.e. the level predicted by the technical fit)—ignoring the uncertainty associated to the technical fit.</p>
</sec>
</sec>
<sec id="sec008" sec-type="results">
<title>Results</title>
<sec id="sec009">
<title>Motivating data: mouse ESC presented in Islam et al (2014)</title>
<p>To illustrate BASiCS we consider scRNA-seq data for 7,941 genes (7,895 biological and 46 ERCC spikes) from 41 mouse ESCs. This corresponds to a subset of the dataset presented in [<xref ref-type="bibr" rid="pcbi.1004333.ref016">16</xref>], generated by discarding those genes with total count (across all cells) below 41 (i.e. where the counts are, on average, less than 1 molecule per cell). By doing this, we exclude genes with very low expression rates, which have less biological relevance. As illustrated in [<xref ref-type="bibr" rid="pcbi.1004333.ref016">16</xref>], the use of UMIs (attached to each cDNA molecule during reverse transcription) reduces the strength of technical noise. Nevertheless, our analysis suggests that unexplained technical variability has not been completely removed by this technology (see <xref ref-type="sec" rid="sec014">discussion</xref> below). <xref ref-type="supplementary-material" rid="pcbi.1004333.s003">S3 Text</xref> describes the input parameters used for the implementation (including prior hyper-parameters values). The data and code used for the analysis are provided in <xref ref-type="supplementary-material" rid="pcbi.1004333.s009">S1 Data</xref>.</p>
</sec>
<sec id="sec010">
<title>Normalisation</title>
<p>
<xref ref-type="fig" rid="pcbi.1004333.g004">Fig 4</xref> summarises posterior inference for the cell-specific normalising terms <italic>ϕ</italic><sub><italic>j</italic></sub>’s and <italic>s</italic><sub><italic>j</italic></sub>’s. Panel (a) suggests there is a substantial heterogeneity in the total mRNA content per cell (<italic>ϕ</italic><sub><italic>j</italic></sub>) and a relatively good correspondence between our estimates and the ones produced by the method in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]. In the context of UMI datasets, the <italic>s</italic><sub><italic>j</italic></sub>’s can be understood as a measure of changes in capture efficiency. In the ideal case, all the <italic>s</italic><sub><italic>j</italic></sub> coefficients should approach 1 (i.e. all gene molecules are captured). Instead, in the case of the analysed mouse ESCs, the posterior medians of the <italic>s</italic><sub><italic>j</italic></sub>’s vary between 0.31 and 0.44 across cells (see panel (b)), suggesting that part of the original molecules are lost throughout the experiment (this is particularly critical for lowly expressed genes, as they might not be captured at all). As shown in panel (b), the BASiCS estimations of the <italic>s</italic><sub><italic>j</italic></sub>’s show good concordance with the empirical proportions of total spike-in molecules captured in each cell. The small scale difference between the posterior medians of the <italic>s</italic><sub><italic>j</italic></sub>’s and these empirical proportions is due to a highly skewed posterior distribution of the <italic>s</italic><sub><italic>j</italic></sub>’s; however posterior modes closely match these values (see panels (c) and (d)). Panel (b) also shows a strong discrepancy between the methods when estimating the <italic>s</italic><sub><italic>j</italic></sub>’s. Our method suggests that the scale of the technical counts does not substantially vary among cells, which is more reasonable when analysing UMI-based counts. Finally, an important feature of our method is a direct quantification of the uncertainty related to estimation of all normalising constants <italic>ϕ</italic><sub><italic>j</italic></sub>’s and <italic>s</italic><sub><italic>j</italic></sub>’s (by means of high posterior density intervals), an element that was ignored in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>].</p>
<fig id="pcbi.1004333.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004333.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Normalisation.</title>
<p>(a) and (b): for each of the 41 mouse ESCs, vertical lines represent the 95% high posterior density interval (blue dot located at the posterior median) of cell-specific normalising constants <italic>ϕ</italic><sub><italic>j</italic></sub> (cellular mRNA content) and <italic>s</italic><sub><italic>j</italic></sub> (interpreted in terms of capture and reverse transcription efficiency for UMI counts), respectively. While BASiCS suggests substantial heterogeneity in the total amount of molecules per cell (<italic>ϕ</italic><sub><italic>j</italic></sub>), the scale of the technical counts remains stable among cells (<italic>s</italic><sub><italic>j</italic></sub>). This is expected when using UMI protocols, where counts should not be affected by sequencing depth and other amplification biases. Red dots are the values estimated by the stepwise method described in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]. There is a good agreement of the methods in terms of cellular mRNA content (<italic>ϕ</italic><sub><italic>j</italic></sub>), but the estimations of <italic>s</italic><sub><italic>j</italic></sub> according to [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] suggest stronger differences than what is expected when using UMI protocols. In (b), black dots represent the proportion of total spike-in molecules captured in each cell. Our estimations of the <italic>s</italic><sub><italic>j</italic></sub>’s are in better agreement with these empirical measurements (suggesting BASiCS infers a more adequate reverse transcription efficiency level). (c) and (d) histogram of a Markov Chain Monte Carlo sample from <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub>, respectively. These posterior distributions are highly skewed and thence the posterior modes are a closer match to the empirical capture proportions than the corresponding posterior medians.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.g004"/>
</fig>
</sec>
<sec id="sec011">
<title>Variance decomposition and detection of HVG/LVG</title>
<p>Despite the use of UMIs, posterior inference strongly suggests the presence of unexplained technical noise in gene expression measurements (see <xref ref-type="fig" rid="pcbi.1004333.g005">Fig 5</xref>). In fact, the posterior distribution of the unexplained technical variability parameter <italic>θ</italic> is concentrated away from zero (see panel (b)). In addition, even though the posterior distribution of the cell-specific normalising terms <italic>s</italic><sub><italic>j</italic></sub> is homogeneous across cells, panel (a) shows substantial differences among the cell-specific random effects (<italic>ν</italic><sub><italic>j</italic></sub>). Overall—across all genes—the unexplained technical component explains approximately 28% of the total variability of expression counts in a typical cell. The data also exhibit strong evidence of biological cell-to-cell heterogeneity. In fact, in the case of the analysed mouse ESC dataset, the posterior median of <italic>σ</italic><sub><italic>i</italic></sub> (defined in <xref ref-type="disp-formula" rid="pcbi.1004333.e008">Eq (6)</xref>) is above 62% for 50% of the 7,895 biological genes (see <xref ref-type="fig" rid="pcbi.1004333.g006">Fig 6(a)</xref>). In addition, <xref ref-type="fig" rid="pcbi.1004333.g006">Fig 6(b)</xref> shows a strong relationship between the biological cell-to-cell heterogeneity (<italic>δ</italic><sub><italic>i</italic></sub>) and the gene-specific expression rates (<italic>μ</italic><sub><italic>i</italic></sub>) which is coherent with the contours in <xref ref-type="disp-formula" rid="pcbi.1004333.e009">Eq (7)</xref> that are decreasing functions of <italic>μ</italic><sub><italic>i</italic></sub>.</p>
<fig id="pcbi.1004333.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004333.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Cell-specific random effects linked to unexplained technical variability.</title>
<p>(a): for each of the 41 mouse ES cells, vertical lines represent the 95% high posterior density interval (blue dot located at the posterior median) of the random effects related to unexplained technical cell-to-cell variability (<italic>ν</italic><sub><italic>j</italic></sub>). (b): histogram of a Markov Chain Monte Carlo sample from <italic>θ</italic>. Posterior inference strongly suggests the presence of unexplained technical noise in gene expression measurements. In fact, the posterior distribution of <italic>θ</italic> is concentrated away from zero and—even though the posterior distributions of the <italic>s</italic><sub><italic>j</italic></sub>’s are highly homogeneous across cells (see <xref ref-type="fig" rid="pcbi.1004333.g004">Fig 4(b)</xref>)—there is a strong heterogeneity among the posterior distributions of the <italic>ν</italic><sub><italic>j</italic></sub>’s (evidenced by non-overlapping 95% high posterior density intervals).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.g005"/>
</fig>
<fig id="pcbi.1004333.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004333.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Biological cell-to-cell heterogeneity.</title>
<p>(a): Histogram of the posterior medians of gene-specific biological cell-to-cell heterogeneity variance contributions <italic>σ</italic><sub><italic>i</italic></sub> (defined in <xref ref-type="disp-formula" rid="pcbi.1004333.e008">Eq (6)</xref>) across the 7,895 biological genes. (b): For each of the 7,895 biological genes, posterior medians of biological cell-to-cell heterogeneity term <italic>δ</italic><sub><italic>i</italic></sub> (log scale) against posterior medians of expression level <italic>μ</italic><sub><italic>i</italic></sub> (log scale). Red lines represent the contours in <xref ref-type="disp-formula" rid="pcbi.1004333.e009">Eq (7)</xref>, related to HVG (log scale) at different levels of the variance contribution threshold <italic>γ</italic><sub><italic>H</italic></sub>. Blue lines represent the equivalent contours linked to LVG at different levels of the variance contribution threshold <italic>γ</italic><sub><italic>L</italic></sub>. These contours were estimated based on posterior medians of <italic>ϕ</italic><sub><italic>j</italic></sub>’s, <italic>s</italic><sub><italic>j</italic></sub>’s and <italic>θ</italic>.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.g006"/>
</fig>
<p>In practice, we define variance contribution thresholds (<italic>γ</italic><sub><italic>H</italic></sub> and <italic>γ</italic><sub><italic>L</italic></sub>) and evidence thresholds (<italic>α</italic><sub><italic>H</italic></sub> and <italic>α</italic><sub><italic>L</italic></sub>) for the detection of HVG and LVG by setting the EFDR and the EFNR (defined as in <xref ref-type="disp-formula" rid="pcbi.1004333.e012">Eq (10)</xref>) equal to 10% (see Table S1 in <xref ref-type="supplementary-material" rid="pcbi.1004333.s004">S4 Text</xref>). Using this rule, we obtain <italic>γ</italic><sub><italic>H</italic></sub> = 0.79, <italic>γ</italic><sub><italic>L</italic></sub> = 0.41 (with corresponding evidence thresholds <italic>α</italic><sub><italic>H</italic></sub> = 0.7925, <italic>α</italic><sub><italic>L</italic></sub> = 0.7650). Therefore, we label as highly variable those genes for which there is strong evidence of a biological cell-to-cell heterogeneity component that explains more than 79% of the total expression variability. Similarly, we set <italic>γ</italic><sub><italic>L</italic></sub> = 0.41, thus defining as LVG those with strong evidence that the biological cell-to-cell heterogeneity explains less than 41% of the total expression variability. Posterior estimates of the detection probabilities associated to each gene are displayed in <xref ref-type="fig" rid="pcbi.1004333.g007">Fig 7</xref>. While LVG are typically associated with large expression rates, the expression rates of HVG are concentrated in a lower range. With these variance contributions and evidence thresholds, we detect 133 HVG and 589 LVG (highlighted in <xref ref-type="fig" rid="pcbi.1004333.g007">Fig 7</xref>, panels (a) and (b), respectively).</p>
<fig id="pcbi.1004333.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004333.g007</object-id>
<label>Fig 7</label>
<caption>
<title>HVG and LVG detection.</title>
<p>(a) and (b): for each of the 7,895 biological genes, gene-specific expression rate <italic>μ</italic><sub><italic>i</italic></sub> (log scale) against the probability of being HVG (<inline-formula id="pcbi.1004333.e022"><alternatives><graphic id="pcbi.1004333.e022g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e022"/><mml:math id="M22" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>H</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>) and the probability of being LVG (<inline-formula id="pcbi.1004333.e023"><alternatives><graphic id="pcbi.1004333.e023g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e023"/><mml:math id="M23" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>L</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>γ</mml:mi> <mml:mi>L</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>), respectively. Setting the EFDR and the EFNR equal to 10%, the corresponding variance contribution thresholds are <italic>γ</italic><sub><italic>H</italic></sub> = 79% and <italic>γ</italic><sub><italic>L</italic></sub> = 41%. Black dashed lines located at optimal (i.e. when EFDR and EFNR coincide) evidence thresholds <italic>α</italic><sub><italic>H</italic></sub> = 0.7925 and <italic>α</italic><sub><italic>L</italic></sub> = 0.7650, respectively. The 133 and 589 genes classified as HVG and LVG are highlighted in red and blue, respectively.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.g007"/>
</fig>
</sec>
<sec id="sec012">
<title>Biological interpretation of HVG and LVG</title>
<p>Among the 133 genes classified as HVG, there is an enrichment of genes related to cell differentiation (see Table S2 in <xref ref-type="supplementary-material" rid="pcbi.1004333.s005">S5 Text</xref>). These HVG include (posterior medians of <italic>σ</italic><sub><italic>i</italic></sub> are shown in parenthesis) <italic>Dppa3</italic> (85.1%) for which [<xref ref-type="bibr" rid="pcbi.1004333.ref017">17</xref>] previously showed heterogeneous expression in mouse ES cells via <italic>in situ</italic> hybridisation. Other genes for which [<xref ref-type="bibr" rid="pcbi.1004333.ref017">17</xref>] found heterogeneous expression did not pass our criteria, yet we estimate a substantial component of biological cell-to-cell heterogeneity associated to most of them: <italic>Esrrb</italic> (79.7%), <italic>Zfp42</italic> (75.9%), <italic>Krt8</italic> (67.8%), <italic>Nanog</italic> (66.4%), <italic>Atf4</italic> (64.6%), <italic>Whsc2</italic> (56.3%), <italic>Rest</italic> (48.7%), <italic>Fscn1</italic> (47.5%) and <italic>Pa2g4</italic> (27.5%). In particular, some of these genes would be classified as HVG if a slightly less conservative EFDR and EFNR threshold was adopted. Our results are more conservative than those according to the method described in [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] (see <xref ref-type="fig" rid="pcbi.1004333.g008">Fig 8(a)</xref>), where 1,363 genes were labelled as HVG. This is not surprising as their method suggests stronger heterogeneity among the cell-specific normalising constants <italic>s</italic><sub><italic>j</italic></sub>’s, potentially inducing spurious heterogeneous expression in genes that remain otherwise stable. In addition, as shown in <xref ref-type="fig" rid="pcbi.1004333.g008">Fig 8(b)</xref>, there is a relatively good correspondence between our results and the list of HVG published by [<xref ref-type="bibr" rid="pcbi.1004333.ref016">16</xref>] (their heuristic method classified as HVG those with substantially larger expression variability than would be predicted by a Poisson model, arguing that the need of normalisation and quantification of unexplained technical noise is removed by the use of UMIs). There are 23 genes classified as HVG by both methods (also detected by [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]), including e.g. <italic>Sprr2b</italic> (91.6%), <italic>Dqx1</italic> (90.9%) <italic>Ccdc48</italic> (90.9%), <italic>Mreg</italic> (89.1%) and <italic>Fst</italic> (88.1%). Several of the genes presented as HVG by [<xref ref-type="bibr" rid="pcbi.1004333.ref016">16</xref>] but not by us are borderline according to our criteria and exhibit a substantial, yet less predominant, intra-tissue heterogeneity (the posterior medians of <italic>σ</italic><sub><italic>i</italic></sub> are above 68% for 75% of them). For example, <italic>Lefty1</italic> exhibits a heterogeneous pattern of expression, which BASiCS reflects by estimating <italic>σ</italic><sub><italic>i</italic></sub> = 79.4% (yet the data does not provide enough evidence to conclude that <italic>more than</italic> <italic>γ</italic><sub><italic>H</italic></sub> = 79% of the expression variability of <italic>Lefty1</italic> can be attributed to a biological cell-to-cell heterogeneity component). Nonetheless, other genes identified as highly variable by [<xref ref-type="bibr" rid="pcbi.1004333.ref016">16</xref>], such as <italic>Gapdh</italic> (35.7%), are far from being labelled as HVG by our method (<inline-formula id="pcbi.1004333.e024"><alternatives><graphic id="pcbi.1004333.e024g" mimetype="image" xlink:type="simple" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004333.e024"/><mml:math id="M24" display="inline" overflow="scroll"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>i</mml:mi> <mml:mi>H</mml:mi></mml:msubsup> <mml:mo stretchy="false">(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>79</mml:mn> <mml:mo stretchy="false">)</mml:mo> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>009</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>). The latter is more reasonable, in view of the extensive use of <italic>Gapdh</italic> as a reference gene in mouse ESCs [<xref ref-type="bibr" rid="pcbi.1004333.ref018">18</xref>].</p>
<fig id="pcbi.1004333.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004333.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Comparison of HVG detection among different methods.</title>
<p>For each of the 7,895 biological genes, posterior medians of biological cell-to-cell heterogeneity term <italic>δ</italic><sub><italic>i</italic></sub> (log scale) against posterior medians of expression level <italic>μ</italic><sub><italic>i</italic></sub> (log scale). While the methods described in [<xref ref-type="bibr" rid="pcbi.1004333.ref016">16</xref>] and [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] only provide a characterisation of HVG, BASiCS is able to detect those genes whose expression rates are stable among cells.</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.g008"/>
</fig>
<p>The enrichment of lowly and mildly expressed genes within those highlighted as highly variable is not an artefact of our method and relates to the characteristics of the analysed mouse ESC dataset. In fact, the analysed sample includes cells from a fairly homogeneous population of cells and highly expressed genes are mostly related to key processes that are common to all cells, acting as <italic>housekeeping genes</italic>. To validate this, we analysed the dataset described in [<xref ref-type="bibr" rid="pcbi.1004333.ref019">19</xref>], which contains 3,005 samples from a highly heterogeneous population of cells. In such a setting, our analysis reveals that BASiCS is capable of detecting highly variable genes across the whole range of expression levels (see <xref ref-type="supplementary-material" rid="pcbi.1004333.s008">S8 Text</xref>).</p>
<p>In terms of LVG, neither [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] nor [<xref ref-type="bibr" rid="pcbi.1004333.ref016">16</xref>] can be employed. Our results are validated by a strong enrichment of genes related to core cellular processes such as translation and translational elongation (see Table S2 in <xref ref-type="supplementary-material" rid="pcbi.1004333.s005">S5 Text</xref>). In particular, we include <italic>Eif5b</italic> (12.7%) which has been previously shown to have homogeneous expression in mouse ESCs [<xref ref-type="bibr" rid="pcbi.1004333.ref017">17</xref>]. Our list of LVG also includes e.g.: <italic>Mir466d</italic> (4.0%), <italic>Hsp90ab1</italic> (5.8%), <italic>Gm6251</italic> (11.4%), <italic>Zfp207</italic> (13%) and <italic>Arpc1b</italic> (14.0%). <italic>Gapdh</italic> is not labelled as LVG, however the posterior distribution of its associated <italic>σ</italic><sub><italic>i</italic></sub> is heavily skewed towards small values and it would be included in the LVG list if we used a slightly higher EFDR and EFNR threshold.</p>
</sec>
<sec id="sec013">
<title>Cross-validation</title>
<p>As well as enabling estimation of the degree of unobserved technical noise, the spike-in genes can also be used to validate our method. We performed a <italic>cross-validation</italic>-type procedure where, for each of the 46 ERCC spike-in genes in turn, we modified the dataset by treating the selected technical gene as if it were a biological one. As the number of added mRNA molecules of these technical genes is known from experimental information, this experiment allows an assessment of our estimates of gene-specific normalised expression levels (<italic>μ</italic><sub><italic>i</italic></sub>). As shown in <xref ref-type="fig" rid="pcbi.1004333.g009">Fig 9(a)</xref>, our estimates are gathered around the true values, except for lowly expressed technical genes, where the experiment suggests a small positive bias. Estimates according to [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] are highly correlated with the true values, however the true scale has not been recovered (not surprising as their method is not designed to estimate the right scale of the <italic>s</italic><sub><italic>j</italic></sub>’s, see <xref ref-type="fig" rid="pcbi.1004333.g003">Fig 3</xref>). In addition, we can use this analysis to validate posterior inference on the cell-to-cell biological heterogeneity components (<italic>δ</italic><sub><italic>i</italic></sub>) and our detection criteria for HVG and LVG (see <xref ref-type="fig" rid="pcbi.1004333.g009">Fig 9</xref>, panels (b), (c) and (d)). As expected, none of the spike-in genes were detected as HVG by our criteria. On the other hand, there is strong evidence that 21 (out of 46) spike-in genes fall in the LVG category, with some others just failing to overcome our conservative criteria.</p>
<fig id="pcbi.1004333.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004333.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Cross-validation experiment.</title>
<p>(a) true versus estimated normalised expression level <italic>μ</italic><sub><italic>i</italic></sub> for each of the 46 ERCC spike-in genes (log-scale). Our estimations are gathered around the true values, except for lowly expressed technical genes, where the experiment suggests a small positive bias. Estimations according to [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>] are highly correlated with the true values, however the true scale has not been recovered (not surprising as their method is not designed to estimate the right scale of the <italic>s</italic><sub><italic>j</italic></sub>’s, see <xref ref-type="fig" rid="pcbi.1004333.g003">Fig 3</xref>). (b): <xref ref-type="fig" rid="pcbi.1004333.g008">Fig 8(a)</xref> superimposing (in black) estimated values for each of the 46 ERCC spike-in genes. (c) and (d): panels (c) and (d) of <xref ref-type="fig" rid="pcbi.1004333.g007">Fig 7</xref> superposing (in black) estimated probabilities associated to each of the 46 ERCC spike-in genes. As expected, none of the spike-in genes were detected as HVG by our criteria. On the other hand, there is strong evidence in favour of being LVG for 21 of the technical genes (and some others are borderline according to our conservative criteria).</p>
</caption>
<graphic mimetype="image" xlink:type="simple" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.g009"/>
</fig>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>Single-cell measurements of gene expression can expose heterogeneous behaviour within seemingly homogeneous populations of cells [<xref ref-type="bibr" rid="pcbi.1004333.ref002">2</xref>]. BASiCS incorporates an integrated normalisation method where cell-specific normalising constants are estimated as model parameters. In particular, we normalise expression counts according to the mRNA content of each cell. These so-called size factors are biologically important since they can partially reflect cell cycle stage (cells tend to contain more mRNA molecules in later stages of the cell cycle [<xref ref-type="bibr" rid="pcbi.1004333.ref020">20</xref>]). To demonstrate this idea, we analysed the mouse ESC dataset described in [<xref ref-type="bibr" rid="pcbi.1004333.ref020">20</xref>], where the cell cycle stage of the analysed cells was recorded. BASiCS estimates substantially larger mRNA content for those cells captured during G2 and M phases (with respect to those in earlier stages of the cell cycle). A summary of this analysis is displayed in <xref ref-type="supplementary-material" rid="pcbi.1004333.s006">S6 Text</xref>.</p>
<p>Additionally, our joint model of biological and spike-in genes allows biological cell-to-cell variability to be teased apart from other technical sources of variability as well as facilitating the generation of a calibrated decision rule, based on easily interpretable posterior probabilities, for selecting highly or lowly variable genes in the population of cells under study. Such information can uncover sub-populations of cells with distinct patterns of gene expression as well as producing a natural ranking of genes according to their biologically variability.</p>
<p>Among others, future extensions of BASiCS include the implementation of differential expression analyses. BASiCS also provides a basis to build more complex downstream analyses including cluster analyses and spatial models, among others. In addition, fast advances in technology suggest that the number of sequenced cells will dramatically increase in the near future (e.g. the one described in [<xref ref-type="bibr" rid="pcbi.1004333.ref019">19</xref>]), hence we foresee that a parallel implementation of the algorithm (e.g. using graphical processing units) might be necessary to cope with such large datasets more efficiently.</p>
</sec>
<sec id="sec015">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004333.s001" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.s001" mimetype="application/pdf" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Prior specification and posterior propriety.</title>
<p>Description of the prior distribution employed for the analysis. As the suggested prior is <italic>improper</italic> (i.e. the integral over the parameter space is not finite), posterior propriety must be verified before performing inference. Nonetheless, we show that a sufficient condition for posterior existence is that each biological gene must be expressed (positive count) in at least one cell.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004333.s002" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.s002" mimetype="application/pdf" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Implementation.</title>
<p>Description of the algorithm employed for the implementation of Bayesian inference. This is based on the Adaptive Metropolis (AM) within Gibbs Sampling (GS) algorithm presented in [<xref ref-type="bibr" rid="pcbi.1004333.ref013">13</xref>]. Posterior inference was implemented in C++ and R via the Rcpp library [<xref ref-type="bibr" rid="pcbi.1004333.ref014">14</xref>]. An R package has been prepared and is available at: <ext-link ext-link-type="uri" xlink:type="simple" xlink:href="https://github.com/catavallejos/BASiCS">https://github.com/catavallejos/BASiCS</ext-link>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004333.s003" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.s003" mimetype="application/pdf" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Implementation specification when analysing the mouse ESC dataset.</title>
<p>Hyper-parameter values and other input quantities required for the algorithm described in <xref ref-type="supplementary-material" rid="pcbi.1004333.s002">S2 Text</xref>. Includes Figures S1 and S2.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004333.s004" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.s004" mimetype="application/pdf" xlink:type="simple">
<label>S4 Text</label>
<caption>
<title>EFDR and EFNR related to highly (and lowly) variable genes detection for a range of variance contribution thresholds.</title>
<p>Optimal evidence thresholds (when the EFDR and the EFNR coincide) the associated values of EFDR (=EFNR) are provided. We also display the total number of genes that would be detected as HVG or LVG for each set of thresholds. Includes Table S1.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004333.s005" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.s005" mimetype="application/pdf" xlink:type="simple">
<label>S5 Text</label>
<caption>
<title>Gene ontology enrichment analysis of highly (and lowly) variable genes among the analysed mouse ESC dataset.</title>
<p>Results of gene ontology enrichment analysis among the genes detected as highly (and lowly) variable by BASiCS and the methods described in [<xref ref-type="bibr" rid="pcbi.1004333.ref016">16</xref>] and [<xref ref-type="bibr" rid="pcbi.1004333.ref005">5</xref>]. Includes Table S2.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004333.s006" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.s006" mimetype="application/pdf" xlink:type="simple">
<label>S6 Text</label>
<caption>
<title>On the interpretation of the cell-specific mRNA content normalising constants.</title>
<p>Using a cell-cycle annotated dataset we illustrate how the cell-specific mRNA content normalising constants <italic>ϕ</italic><sub><italic>j</italic></sub> can partially capture the cell cycle effect. Includes Figure S3.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004333.s007" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.s007" mimetype="application/pdf" xlink:type="simple">
<label>S7 Text</label>
<caption>
<title>Computational cost.</title>
<p>A summary of the computational cost of the MCMC algorithm using simulated datasets with a variety of numbers of cells and genes. Includes Figure S4.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004333.s008" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.s008" mimetype="application/pdf" xlink:type="simple">
<label>S8 Text</label>
<caption>
<title>Analysis of Zeisel et al (2015) dataset.</title>
<p>Illustrates the performance of BASiCS when analysing a larger scale dataset, including samples from several sub-populations. Includes Table S3 and Figures S5–S8.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004333.s009" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004333.s009" mimetype="application/zip" xlink:type="simple">
<label>S1 Data</label>
<caption>
<title>Analysed dataset and analysis code.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We acknowledge Nick Goldman (EMBL-EBI) and all members of the Marioni laboratory (EMBL-EBI) and Richardson research group (MRC-BSU) for invaluable discussions and helpful suggestions. We also thank Sten Linnarsson for providing experimental information about the mouse ESC dataset.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004333.ref001">
<label>1</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Tang</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Barbacioru</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Nordman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lee</surname> <given-names>C</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>mRNA-Seq whole-transcriptome analysis of a single cell</article-title>. <source>Nature Methods</source> <volume>6</volume>: <fpage>377</fpage>–<lpage>382</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1315" xlink:type="simple">10.1038/nmeth.1315</ext-link></comment> <object-id pub-id-type="pmid">19349980</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref002">
<label>2</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Patel</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Tirosh</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Trombetta</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Shalek</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Gillespie</surname> <given-names>SM</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>. <source>Science</source> <volume>344</volume>: <fpage>1396</fpage>–<lpage>1401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1254257" xlink:type="simple">10.1126/science.1254257</ext-link></comment> <object-id pub-id-type="pmid">24925914</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref003">
<label>3</label>
<mixed-citation xlink:type="simple" publication-type="other">Saliba AE, Westermann AJ, Gorski SA, Vogel J (2014) Single-cell RNA-seq: advances and future challenges. Nucleic Acids Research: gku555.</mixed-citation>
</ref>
<ref id="pcbi.1004333.ref004">
<label>4</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Stegle</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Teichmann</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Marioni</surname> <given-names>JC</given-names></name> (<year>2015</year>) <article-title>Computational and analytical challenges in single-cell transcriptomics</article-title>. <source>Nature Review Genetics</source> <volume>16</volume>: <fpage>133</fpage>–<lpage>145</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrg3833" xlink:type="simple">10.1038/nrg3833</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref005">
<label>5</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Brennecke</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Anders</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>JK</given-names></name>, <name name-style="western"><surname>Kolodziejczyk</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>X</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Accounting for technical noise in single-cell RNA-seq experiments</article-title>. <source>Nature Methods</source> <volume>10</volume>: <fpage>1093</fpage>–<lpage>1095</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2645" xlink:type="simple">10.1038/nmeth.2645</ext-link></comment> <object-id pub-id-type="pmid">24056876</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref006">
<label>6</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Macaulay</surname> <given-names>IC</given-names></name>, <name name-style="western"><surname>Voet</surname> <given-names>T</given-names></name> (<year>2014</year>) <article-title>Single cell genomics: advances and future perspectives</article-title>. <source>PLoS Genetics</source> <volume>10</volume>: <fpage>e1004126</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pgen.1004126" xlink:type="simple">10.1371/journal.pgen.1004126</ext-link></comment> <object-id pub-id-type="pmid">24497842</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref007">
<label>7</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Grün</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kester</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname> <given-names>A</given-names></name> (<year>2014</year>) <article-title>Validation of noise models for single-cell transcriptomics</article-title>. <source>Nature methods</source> <volume>11</volume>: <fpage>637</fpage>–<lpage>640</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2930" xlink:type="simple">10.1038/nmeth.2930</ext-link></comment> <object-id pub-id-type="pmid">24747814</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref008">
<label>8</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Jiang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Schlesinger</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Synthetic spike-in standards for RNA-seq experiments</article-title>. <source>Genome Research</source> <volume>21</volume>: <fpage>1543</fpage>–<lpage>1551</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.121095.111" xlink:type="simple">10.1101/gr.121095.111</ext-link></comment> <object-id pub-id-type="pmid">21816910</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref009">
<label>9</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Richardson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gilks</surname> <given-names>WR</given-names></name> (<year>1993</year>) <article-title>A Bayesian approach to measurement error problems in epidemiology using conditional independence models</article-title>. <source>American Journal of Epidemiology</source> <volume>138</volume>: <fpage>430</fpage>–<lpage>442</lpage>. <object-id pub-id-type="pmid">8213748</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref010">
<label>10</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Kass</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Raftery</surname> <given-names>AE</given-names></name> (<year>1995</year>) <article-title>Bayes factors</article-title>. <source>Journal of the American Statistical Association</source> <volume>90</volume>: <fpage>773</fpage>–<lpage>795</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/01621459.1995.10476572" xlink:type="simple">10.1080/01621459.1995.10476572</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref011">
<label>11</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Gupta</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Greco</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Auvinen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Arjas</surname> <given-names>E</given-names></name> (<year>2010</year>) <article-title>Bayesian integrated modeling of expression data: a case study on RhoG</article-title>. <source>BMC Bioinformatics</source> <volume>11</volume>: <fpage>295</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-11-295" xlink:type="simple">10.1186/1471-2105-11-295</ext-link></comment> <object-id pub-id-type="pmid">20515463</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref012">
<label>12</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Newton</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Noueiry</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sarkar</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Ahlquist</surname> <given-names>P</given-names></name> (<year>2004</year>) <article-title>Detecting differential gene expression with a semiparametric hierarchical mixture method</article-title>. <source>Biostatistics</source> <volume>5</volume>: <fpage>155</fpage>–<lpage>176</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/biostatistics/5.2.155" xlink:type="simple">10.1093/biostatistics/5.2.155</ext-link></comment> <object-id pub-id-type="pmid">15054023</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref013">
<label>13</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Roberts</surname> <given-names>GO</given-names></name>, <name name-style="western"><surname>Rosenthal</surname> <given-names>JS</given-names></name> (<year>2009</year>) <article-title>Examples of adaptive MCMC</article-title>. <source>Journal of Computational and Graphical Statistics</source> <volume>18</volume>: <fpage>349</fpage>–<lpage>367</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1198/jcgs.2009.06134" xlink:type="simple">10.1198/jcgs.2009.06134</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref014">
<label>14</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Eddelbuettel</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>François</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Allaire</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chambers</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bates</surname> <given-names>D</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Rcpp: Seamless R and C++ integration</article-title>. <source>Journal of Statistical Software</source> <volume>40</volume>: <fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004333.ref015">
<label>15</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Anders</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Huber</surname> <given-names>W</given-names></name> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biology</source> <volume>11</volume>: <fpage>R106</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/gb-2010-11-10-r106" xlink:type="simple">10.1186/gb-2010-11-10-r106</ext-link></comment> <object-id pub-id-type="pmid">20979621</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref016">
<label>16</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Islam</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zeisel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Joost</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>La Manno</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Zajac</surname> <given-names>P</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Quantitative single-cell RNA-seq with unique molecular identifiers</article-title>. <source>Nature Methods</source> <volume>11</volume>: <fpage>163</fpage>–<lpage>166</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2772" xlink:type="simple">10.1038/nmeth.2772</ext-link></comment> <object-id pub-id-type="pmid">24363023</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref017">
<label>17</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Carter</surname> <given-names>MG</given-names></name>, <name name-style="western"><surname>Stagg</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Falco</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Yoshikawa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bassey</surname> <given-names>UC</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>An in situ hybridization-based screen for heterogeneously expressed genes in mouse ES cells</article-title>. <source>Gene Expression Patterns</source> <volume>8</volume>: <fpage>181</fpage>–<lpage>198</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.gep.2007.10.009" xlink:type="simple">10.1016/j.gep.2007.10.009</ext-link></comment> <object-id pub-id-type="pmid">18178135</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref018">
<label>18</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Murphy</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Polak</surname> <given-names>JM</given-names></name> (<year>2002</year>) <article-title>Differentiating embryonic stem cells: GAPDH, but neither HPRT nor β-tubulin is suitable as an internal standard for measuring RNA levels</article-title>. <source>Tissue Engineering</source> <volume>8</volume>: <fpage>551</fpage>–<lpage>559</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/107632702760240472" xlink:type="simple">10.1089/107632702760240472</ext-link></comment> <object-id pub-id-type="pmid">12201995</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref019">
<label>19</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Zeisel</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Muñoz-Manchado</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Codeluppi</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lönnerberg</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>La Manno</surname> <given-names>G</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>Cell types in the mouse cortex and hippocampus revealed by single-cell rna-seq</article-title>. <source>Science</source> <volume>347</volume>: <fpage>1138</fpage>–<lpage>1142</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.aaa1934" xlink:type="simple">10.1126/science.aaa1934</ext-link></comment> <object-id pub-id-type="pmid">25700174</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004333.ref020">
<label>20</label>
<mixed-citation xlink:type="simple" publication-type="journal">
<name name-style="western"><surname>Buettner</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Natarajan</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Casale</surname> <given-names>FP</given-names></name>, <name name-style="western"><surname>Proserpio</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Scialdone</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>Computational analysis of cell-to-cell heterogeneity in single-cell rna-sequencing data reveals hidden subpopulations of cells</article-title>. <source>Nature biotechnology</source> <volume>33</volume>: <fpage>155</fpage>–<lpage>160</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.3102" xlink:type="simple">10.1038/nbt.3102</ext-link></comment> <object-id pub-id-type="pmid">25599176</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>