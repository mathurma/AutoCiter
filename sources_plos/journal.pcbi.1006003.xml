<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01443</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006003</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognition</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Memory</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Thermodynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>DNA-binding proteins</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Systems science</subject><subj-group><subject>Nonlinear dynamics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems science</subject><subj-group><subject>Nonlinear dynamics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neural networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene expression</subject><subj-group><subject>Gene regulation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Network analysis</subject><subj-group><subject>Network motifs</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Gene regulatory networks</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Gene regulatory networks</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Memory functions reveal structural properties of gene regulatory networks</article-title>
<alt-title alt-title-type="running-head">Memory functions reveal structural properties of gene regulatory networks</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0001-5111-353X</contrib-id>
<name name-style="western">
<surname>Herrera-Delgado</surname> <given-names>Edgar</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Perez-Carrasco</surname> <given-names>Ruben</given-names></name>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1020-5240</contrib-id>
<name name-style="western">
<surname>Briscoe</surname> <given-names>James</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0169-7893</contrib-id>
<name name-style="western">
<surname>Sollich</surname> <given-names>Peter</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>The Francis Crick Institute, London, United Kingdom</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Mathematics, King’s College London, Strand, London, United Kingdom</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Mathematics, University College London, London, United Kingdom</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Francois</surname> <given-names>Paul</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>McGill, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">james.briscoe@crick.ac.uk</email> (JB); <email xlink:type="simple">peter.sollich@kcl.ac.uk</email> (PS)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>22</day>
<month>2</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>2</issue>
<elocation-id>e1006003</elocation-id>
<history>
<date date-type="received">
<day>30</day>
<month>8</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>1</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Herrera-Delgado et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006003"/>
<abstract>
<p>Gene regulatory networks (GRNs) control cellular function and decision making during tissue development and homeostasis. Mathematical tools based on dynamical systems theory are often used to model these networks, but the size and complexity of these models mean that their behaviour is not always intuitive and the underlying mechanisms can be difficult to decipher. For this reason, methods that simplify and aid exploration of complex networks are necessary. To this end we develop a broadly applicable form of the Zwanzig-Mori projection. By first converting a thermodynamic state ensemble model of gene regulation into mass action reactions we derive a general method that produces a set of time evolution equations for a subset of components of a network. The influence of the rest of the network, the bulk, is captured by memory functions that describe how the subnetwork reacts to its own past state via components in the bulk. These memory functions provide probes of near-steady state dynamics, revealing information not easily accessible otherwise. We illustrate the method on a simple cross-repressive transcriptional motif to show that memory functions not only simplify the analysis of the subnetwork but also have a natural interpretation. We then apply the approach to a GRN from the vertebrate neural tube, a well characterised developmental transcriptional network composed of four interacting transcription factors. The memory functions reveal the function of specific links within the neural tube network and identify features of the regulatory structure that specifically increase the robustness of the network to initial conditions. Taken together, the study provides evidence that Zwanzig-Mori projections offer powerful and effective tools for simplifying and exploring the behaviour of GRNs.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Gene regulatory networks are essential for cell fate specification and function. But the recursive links that comprise these networks often make determining their properties and behaviour complicated. Computational models of these networks can also be difficult to decipher. To reduce the complexity of such models we employ a Zwanzig-Mori projection approach. This allows a system of ordinary differential equations, representing a network, to be reduced to an arbitrary subnetwork consisting of part of the initial network, with the rest of the network (bulk) captured by memory functions. These memory functions account for the bulk by describing signals that return to the subnetwork after some time, having passed through the bulk. We show how this approach can be used to simplify analysis and to probe the behaviour of a gene regulatory network. Applying the method to a transcriptional network in the vertebrate neural tube reveals previously unappreciated properties of the network. By taking advantage of the structure of the memory functions we identify interactions within the network that are unnecessary for sustaining correct patterning. Upon further investigation we find that these interactions are important for conferring robustness to variation in initial conditions. Taken together we demonstrate the validity and applicability of the Zwanzig-Mori projection approach to gene regulatory networks.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000266</institution-id>
<institution>Engineering and Physical Sciences Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>EP/L015854/1</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0169-7893</contrib-id>
<name name-style="western">
<surname>Sollich</surname> <given-names>Peter</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000289</institution-id>
<institution>Cancer Research UK</institution>
</institution-wrap>
</funding-source>
<award-id>FC001051</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1020-5240</contrib-id>
<name name-style="western">
<surname>Briscoe</surname> <given-names>James</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/501100000265</institution-id>
<institution>Medical Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>FC001051</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1020-5240</contrib-id>
<name name-style="western">
<surname>Briscoe</surname> <given-names>James</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>FC001051</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1020-5240</contrib-id>
<name name-style="western">
<surname>Briscoe</surname> <given-names>James</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award005">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>WT098326MA</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-1020-5240</contrib-id>
<name name-style="western">
<surname>Briscoe</surname> <given-names>James</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award006">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100004440</institution-id>
<institution>Wellcome Trust</institution>
</institution-wrap>
</funding-source>
<award-id>WT098325MA</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Perez-Carrasco</surname> <given-names>Ruben</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>EHD and PS acknowledge the stimulating research environment provided by the EPSRC Centre for Doctoral Training in Cross-Disciplinary Approaches to Non-Equilibrium Systems (CANES, EP/L015854/1) (<ext-link ext-link-type="uri" xlink:href="https://www.epsrc.ac.uk/skills/students/centres/profiles/crossdisciplinaryapproachestononequilibriumsystems/" xlink:type="simple">https://www.epsrc.ac.uk/skills/students/centres/profiles/crossdisciplinaryapproachestononequilibriumsystems/</ext-link>). RPC was supported by the Wellcome Trust (WT098325MA) EHD and JB are supported by the Francis Crick Institute which receives its core funding from Cancer Research UK (FC001051) (<ext-link ext-link-type="uri" xlink:href="https://www.cancerresearchuk.org/" xlink:type="simple">https://www.cancerresearchuk.org/</ext-link>), UK Medical Research Council (FC001051) (<ext-link ext-link-type="uri" xlink:href="https://www.mrc.ac.uk/" xlink:type="simple">https://www.mrc.ac.uk/</ext-link>), Wellcome Trust (FC001051 and WT098326MA) (<ext-link ext-link-type="uri" xlink:href="https://wellcome.ac.uk/" xlink:type="simple">https://wellcome.ac.uk/</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="0"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-03-06</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Biological systems are complex, comprising multiple interacting components. In many cases this complexity makes it difficult to identify underlying mechanisms and to understand the function of a system. Gene regulatory networks (GRNs) are an example of this problem [<xref ref-type="bibr" rid="pcbi.1006003.ref001">1</xref>]. A GRN comprises the set of interacting genes responsible for the development, differentiation or homoeostasis of a tissue and provides a formal system-level, causative explanation for gene regulation. In physical terms, a GRN consists of modular DNA sequences—cis regulatory elements—that bind to specific sets of transcriptional activators and repressors, which control the expression of associated genes. Some of the regulated genes are themselves transcriptional regulators. Thus, at the core of a GRN is a recursive set of regulatory links that forms a transcriptional network, the dynamics of which is responsible for the spatial and temporal patterns of gene expression.</p>
<p>Attempts have been made to map large transcriptional networks, yet even for relatively small networks, the number of links and the feedback within the system make intuitive understanding difficult to obtain. Various computational models have been developed to address this. Logical models, which describe regulatory interactions qualitatively, provide a flexible and simplifying formalism to explore and understand the behaviour of a network [<xref ref-type="bibr" rid="pcbi.1006003.ref002">2</xref>]. However, these approaches are unable to capture subtler features of a network that depend on specific aspects of the timing or concentration of components of the network. For this, continuous models based on, for example, ordinary differential equations (ODEs) are often employed [<xref ref-type="bibr" rid="pcbi.1006003.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref004">4</xref>]. These models describe gene regulation in much greater detail, and there are well-developed mathematical theories that provide powerful tools to distill the dynamical details of such systems. These have been used successfully to gain insight into the operation of GRNs and suggest explanations for otherwise difficult to understand behaviours, including emergent phenomena such as self-organisation, oscillations, spatial patterning, and scaling of pattern size [<xref ref-type="bibr" rid="pcbi.1006003.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1006003.ref008">8</xref>]. A disadvantage of this approach, however, is that ODE models often require a large number of parameters, including binding affinities, degradation rates, production rates, etc. While it is often possible to numerically analyse large systems, the power of analytical tools is in many cases lost due to lack of knowledge of parameters or the complexity of the network.</p>
<p>Various techniques have been developed to reduce the complexity of models yet preserve specific features of the behaviour of the system. For Boolean networks it is possible to remove specific components while restructuring other parts of the network to conserve the logical structure, but this requires quite specific network topologies [<xref ref-type="bibr" rid="pcbi.1006003.ref009">9</xref>]. In the case of mass action reactions, one approach to simplification is to generate intermediate species in a systematic way such as to make different systems comparable. This then allows the identification of motifs that can be simplified. This approach comes with the natural limitation that the species involved cannot be chosen <italic>a priori</italic> and must conform to a particular network structure [<xref ref-type="bibr" rid="pcbi.1006003.ref010">10</xref>]. Other methods to reduce complexity involve removing nodes or perturbing the system and analysing <italic>a posteriori</italic> the effect that this has on the dynamics of the network. This can be helpful to develop intuition, but generally requires the investigation of a large number of combinations of perturbations [<xref ref-type="bibr" rid="pcbi.1006003.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref012">12</xref>]. A further approach, although applicable only in rather specific cases, is to enforce a timescale separation between network nodes that is chosen not to perturb the dynamics significantly [<xref ref-type="bibr" rid="pcbi.1006003.ref013">13</xref>]. One can find “morphisms” that relate network structure to function in order to then simplify a set of nodes into potentially simpler motifs; this can reveal an interpretation of how certain motifs work but does not provide a direct conversion from the original network [<xref ref-type="bibr" rid="pcbi.1006003.ref014">14</xref>]. Less formal methods for replacing well understood network motifs with simpler motifs producing similar behaviour have also been extensively explored [<xref ref-type="bibr" rid="pcbi.1006003.ref015">15</xref>]. Along similar lines, entire parts of a network can be substituted with effective nodes with more complicated dynamics that produce similar output for a set of chosen species, although the feasiblity of this depends on network structure and the complexity of the original dynamics [<xref ref-type="bibr" rid="pcbi.1006003.ref016">16</xref>].</p>
<p>We focus in this paper on reducing model complexity by tracking a subnetwork that is embedded within the remainder—or “bulk”—of a larger system. Analysing the behaviour of the subnetwork and its interaction with the bulk can help reveal and rationalise the properties of the entire network. With any coarse graining approach, including those discussed above, a compromise must be reached between the precision of the method, i.e. how well it captures the dynamics of the full network, and the simplicity and interpretability of the resulting description. For example, the introduction of intermediate species can produce model reductions with high precision but these may not be interpretable [<xref ref-type="bibr" rid="pcbi.1006003.ref010">10</xref>], while morphism approaches provide interpretable insights into the structure but capture the full model dynamics only for specific initial conditions and system parameters [<xref ref-type="bibr" rid="pcbi.1006003.ref014">14</xref>]. We consider important for interpretability the ability to <italic>choose</italic> a subnetwork, guided by biological relevance or the availability of data; none of the methods described above allow this and instead identify a subnetwork based on their internal criteria.</p>
<p>One class of methods that offers the potential to balance accuracy and interpretability are Zwanzig-Mori projections [<xref ref-type="bibr" rid="pcbi.1006003.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref018">18</xref>]. Originally developed to allow the extraction of macroscopic equations from a microscopic description of the dynamics—a brief overview can be found in <italic>e.g.</italic> [<xref ref-type="bibr" rid="pcbi.1006003.ref019">19</xref>]—these methods have since been used to separate a network into an arbitarily chosen subnetwork and bulk in ways that preserve substantial features of the original temporal dynamics [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>]. Used in this way, the approach describes the concentration of components in the subnetwork in detail, while the activities of the species in the bulk are replaced with so-called ‘memory functions’. These memory functions are derived from the detailed kinetic description of the remainder of the network and summarise how, by acting via the bulk, the past behaviour of the subnetwork influences its current state (<xref ref-type="fig" rid="pcbi.1006003.g001">Fig 1</xref>). The resulting memory functions are functions of time difference, describing the amplitude of a signal returning from the bulk some specified time after the original signal left the subnetwork. Additionally, it is possible to separate each memory function in order to analyse through which bulk species the signal is flowing, thus providing a means to gain a more systematic understanding of a system.</p>
<fig id="pcbi.1006003.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006003.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Sketch describing the concept of memory within a reaction network.</title>
<p>A network is divided into bulk and subnetwork, <italic>x</italic> axis represents time. Concentration changes in the subnetwork act as signals that leave the subnetwork and travel into the bulk. There they interact with other bulk species and return at a later timepoint via bulk-to-subnetwork interactions. The net effect of such interactions is thus that the subnetwork reacts to its own past. The precise influence of past subnetwork states is governed by <italic>memory functions</italic> that depend on the time difference, <italic>i.e.</italic> on how long ago the relevant signal has left the subnetwork.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.g001" xlink:type="simple"/>
</fig>
<p>Evolving from its original applications to critical dynamics and supercooled liquids near the glass transition [<xref ref-type="bibr" rid="pcbi.1006003.ref022">22</xref>], this approach has been applied to biochemical networks [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>], where it has been used to analyse the dynamics of signaling in the EGFR (epidermal growth factor receptor) network. It has since been developed further to include also enzymatic Michaelis-Menten reactions [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>]. Here we apply the Zwanzig-Mori approach to the analysis of GRNs. We derive a general method that is applicable to any thermodynamic state ensemble representation of protein dynamics including transcriptional networks. These thermodynamic equations mechanistically represent interactions between proteins via transcriptional regulation [<xref ref-type="bibr" rid="pcbi.1006003.ref023">23</xref>] and can be expanded into mass action reactions to which the Zwanzig-Mori projection formalism can be applied. This approach not only justifies a heuristic method where the thermodynamic equations are expanded to quadratic order around a steady state to obtain a set of effective unary and binary reactions, but also opens up the possibility of developing more advanced projection approximations. We test the method on a cross repressive motif, where we show that we are able to qualitatively reproduce the dynamics of the system and obtain a simple intuitive interpretation of the memory functions. Finally, we use the approach on a GRN from the vertebrate neural tube, a well characterised developmental GRN composed of four interacting transcription factors [<xref ref-type="bibr" rid="pcbi.1006003.ref024">24</xref>]. This reveals the importance of specific links within the network and identifies features that appear to be present primarily to increase the robustness of the network to initial conditions, rather than maintain the steady states. Taken together, the study provides evidence that Zwanzig-Mori projections are a powerful and efficient method to simplify and explore the behaviour of gene regulatory networks, with memory functions providing new tools for probing the dynamics near steady state.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec003">
<title>Thermodynamic state ensemble models for gene regulation dynamics</title>
<p>Several classes of model have been developed to describe gene regulation. One such class consists of thermodynamic state ensemble models in which equations are constructed that relate interactions between key components of the regulatory mechanism to gene expression [<xref ref-type="bibr" rid="pcbi.1006003.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref026">26</xref>]. In these models, all possible states of a regulated gene are enumerated. Each state consists of a specific set of transcription factors bound to a DNA cis-regulatory element, weighted by the affinity of interactions. The rate at which a protein is produced is then represented as a ratio of the weight of the subset of states that promote gene expression, to the total weight of all states. We define the vector <bold><italic>x</italic></bold> such that it contains the protein concentrations for each gene. We can then generically define the time evolution for any protein concentration, indexed by <italic>j</italic>, as
<disp-formula id="pcbi.1006003.e001"><alternatives><graphic id="pcbi.1006003.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi></mml:munder> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>β</mml:mi> <mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:math></alternatives> <label>(1)</label></disp-formula>
<disp-formula id="pcbi.1006003.e002"><alternatives><graphic id="pcbi.1006003.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msubsup></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>n</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:msub> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:msubsup><mml:mi>n</mml:mi> <mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msubsup></mml:msubsup></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives> <label>(2)</label></disp-formula>
Here <italic>β</italic><sub><italic>j</italic></sub> is the decay rate of protein <italic>j</italic>. We use the summation over <bold><italic>n</italic></bold> to represent all possible binding conformations for the DNA that produces protein <italic>j</italic>. The term <italic>α</italic><sub>(<italic>j</italic>,<bold><italic>n</italic></bold>)</sub> represents the production rate of protein <italic>j</italic> from a particular DNA conformation <bold><italic>n</italic></bold>. The factor <italic>w</italic><sub>(<italic>j</italic>,<bold><italic>n</italic></bold>)</sub> is the specific affinity for individual proteins to the DNA that produces species <italic>x</italic><sub><italic>j</italic></sub>. Finally <italic>x</italic><sub>(<italic>j</italic>,<bold><italic>n</italic></bold>)</sub> is the concentration of DNA producing protein <italic>j</italic> and in conformation <bold><italic>n</italic></bold>. This is assigned in <xref ref-type="disp-formula" rid="pcbi.1006003.e002">(2)</xref> as the weight of the conformation, dependent on the protein concentrations in a mass-action form, normalised by the total weight of all conformations. This ensures that <italic>x</italic><sub>(<italic>j</italic>,<bold><italic>n</italic></bold>)</sub> lies in the range [0, 1], so it is not an absolute concentration; any overall DNA concentration scale is therefore to be understood as incorporated into the protein production rates <italic>α</italic><sub>(<italic>j</italic>,<bold><italic>n</italic></bold>)</sub>. Accordingly one can also think of <italic>x</italic><sub>(<italic>j</italic>,<bold><italic>n</italic></bold>)</sub> as the probability of finding a certain conformation <bold><italic>n</italic></bold> of the DNA producing protein <italic>j</italic>. As made explicit in <xref ref-type="disp-formula" rid="pcbi.1006003.e002">(2)</xref>, the DNA conformation label <bold><italic>n</italic></bold> is a collection of integers <italic>n</italic><sub><italic>i</italic></sub> counting how many copies of protein <italic>i</italic> are bound to the DNA.</p>
</sec>
<sec id="sec004">
<title>Setup of projection method</title>
<p>The Zwanzig-Mori method in general starts from the choice of a set of observables for which dynamical equations are to be obtained. Initially we select, as the simplest possible observables, the deviations from steady state of the concentrations of the chosen subnetwork species. For these observables the Zwanzig-Mori projection leads to a set of dynamical equations of the form
<disp-formula id="pcbi.1006003.e003"><alternatives><graphic id="pcbi.1006003.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo></mml:mrow> <mml:mrow><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msup></mml:munderover> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup> <mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msup></mml:munderover> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mtext>Memory</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>function</mml:mtext></mml:mrow></mml:munder> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives> <label>(3)</label></disp-formula>
Here <italic>δx</italic><sub><italic>i</italic></sub> are the subnetwork concentration deviations as defined explicitly below and <italic>N</italic><sup>s</sup> indicates the number of subnetwork species. The Ω<sub><italic>ji</italic></sub> define a <italic>rate matrix</italic> <bold>Ω</bold> that represents subnetwork interactions. The <italic>r</italic><sub><italic>i</italic></sub>(<italic>t</italic>) are so-called <italic>random forces</italic> that arise from the uncertainty about the initial (time <italic>t</italic> = 0) state of the bulk concentrations. (For the linear dynamics they can be expressed in closed form [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>] but this is not useful in our context as discussed in Sec. <italic>Nonlinear projected equations</italic> below.)</p>
<p>The key quantities in the <xref ref-type="disp-formula" rid="pcbi.1006003.e003">eq (3)</xref> are the <italic>memory functions</italic> <italic>M</italic><sub><italic>ji</italic></sub>(Δ<italic>t</italic>), which describe how past concentration fluctuations <italic>δx</italic><sub><italic>j</italic></sub>(<italic>t</italic>′) influence the current time evolution. However, while the projected equations are formally exact, it is in general impossible to evaluate these memory functions explicitly. One scenario where this <italic>can</italic> be done is a network of unary reactions, where the full reaction equations are linear in the concentrations [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>]. This suggests a heuristic approach to calculating memory functions in the current context, which is to linearize the thermodynamic equations. One can think of this as generating a set of effective unary reactions (at least loosely; see Sec. <italic>Justifying the heuristics: Network expansion</italic>). Explicitly, one linearly expands the time evolution eqs <xref ref-type="disp-formula" rid="pcbi.1006003.e001">(1)</xref> with <xref ref-type="disp-formula" rid="pcbi.1006003.e002">(2)</xref> inserted. The expansion is performed around a steady state with concentrations <italic>y</italic><sub><italic>i</italic></sub>, <italic>i.e.</italic> in terms of the deviations <italic>δx</italic><sub><italic>i</italic></sub> = <italic>x</italic><sub><italic>i</italic></sub> − <italic>y</italic><sub><italic>i</italic></sub>. The r.h.s. of <xref ref-type="disp-formula" rid="pcbi.1006003.e001">(1)</xref> then contains only linear terms in the <italic>δx</italic><sub><italic>i</italic></sub> since constant terms cancel out because of the steady state condition. One can therefore write the time evolution equations in matrix form [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>]
<disp-formula id="pcbi.1006003.e004"><alternatives><graphic id="pcbi.1006003.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e004" xlink:type="simple"/><mml:math display="block" id="M4"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mi>N</mml:mi> <mml:mi mathvariant="normal">s</mml:mi></mml:msup></mml:munderover> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
for an appropriately defined matrix <bold><italic>L</italic></bold> with entries <italic>L</italic><sub><italic>ji</italic></sub>.</p>
</sec>
<sec id="sec005">
<title>Projected equations for linearised dynamics</title>
<p>From the matrix <bold><italic>L</italic></bold> one can calculate the terms in the (linear) projected dynamics of the subnetwork concentrations from <xref ref-type="disp-formula" rid="pcbi.1006003.e003">(3)</xref> as shown in [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>]. We summarize the method here. One separates the set of all (linear in concentration) observables into subnetwork (s) and bulk (b), and assumes as above that these concentration deviations <italic>δx</italic><sub><italic>i</italic></sub> are numbered so that the first <italic>N</italic><sup>s</sup> are the subnetwork observables while the rest are the bulk observables. The matrix <bold><italic>L</italic></bold> for the linearised dynamics then separates into blocks according to the different observables:
<disp-formula id="pcbi.1006003.e041"><graphic id="pcbi.1006003.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e041" xlink:type="simple"/><label>(5)</label></disp-formula>
where labels S and B represent respectively the set of species in the subnetwork and in the bulk.</p>
<p>We use the labels S and B here to represent subnetwork and bulk species respectively, this will be useful once more subnetwork and bulk observables arise (see Sec. <italic>Mathematical results</italic>). The rate matrix <bold>Ω</bold> with entries Ω<sub><italic>ji</italic></sub> in the projected <xref ref-type="disp-formula" rid="pcbi.1006003.e003">eq (3)</xref> is then simply the subnetwork block of <bold><italic>L</italic></bold>,
<disp-formula id="pcbi.1006003.e006"><alternatives><graphic id="pcbi.1006003.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e006" xlink:type="simple"/><mml:math display="block" id="M6"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo mathvariant="bold">Ω</mml:mo> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>S,S</mml:mtext></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
The memory functions similarly form the elements of a memory matrix, which can be expressed in terms of the blocks of <bold><italic>L</italic></bold> as [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>]
<disp-formula id="pcbi.1006003.e007"><alternatives><graphic id="pcbi.1006003.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e007" xlink:type="simple"/><mml:math display="block" id="M7"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="bold-italic">M</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>S,B</mml:mtext></mml:msup> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>B,B</mml:mtext></mml:msup> <mml:mo>Δ</mml:mo> <mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>B,S</mml:mtext></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
This form allows straightforward evaluation of the memory functions starting from any given matrix <bold><italic>L</italic></bold> describing the linearised dynamics.</p>
</sec>
<sec id="sec006">
<title>Nonlinear projected equations</title>
<p>To capture the leading nonlinear corrections to the subnetwork dynamics, it is natural to enlarge the set of subnetwork observables by adding quadratic observables, i.e. products of concentration deviations. The projected equations then become
<disp-formula id="pcbi.1006003.e008"><alternatives><graphic id="pcbi.1006003.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mo>∂</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true" mathsize="140%"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msup></mml:mrow></mml:munderover></mml:mstyle> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true" mathsize="140%"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>j</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>k</mml:mi> <mml:mo>≤</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msup></mml:mrow> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msup></mml:mrow></mml:munderover></mml:mstyle> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:msub><mml:mo>Ω</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo> <mml:mstyle displaystyle="true" mathsize="140%"><mml:msubsup><mml:mo>∫</mml:mo> <mml:mn>0</mml:mn> <mml:mi>t</mml:mi></mml:msubsup></mml:mstyle> <mml:mi>d</mml:mi> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mstyle displaystyle="true" mathsize="140%"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msup></mml:mrow></mml:munderover></mml:mstyle> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="2pt"/><mml:munder><mml:munder><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo stretchy="true">︸</mml:mo></mml:munder> <mml:mrow><mml:mtext>Linear</mml:mtext> <mml:mspace width="2pt"/><mml:mtext>memory</mml:mtext></mml:mrow></mml:munder> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true" mathsize="140%"><mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>≤</mml:mo> <mml:mi>j</mml:mi> <mml:mo>≤</mml:mo> <mml:mi>k</mml:mi> <mml:mo>≤</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msup></mml:mrow> <mml:mrow><mml:msup><mml:mi>N</mml:mi> <mml:mi>s</mml:mi></mml:msup></mml:mrow></mml:munderover></mml:mstyle> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="2pt"/><mml:munder><mml:munder><mml:mrow><mml:msub><mml:mi>M</mml:mi> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>k</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>−</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo stretchy="true">︸</mml:mo></mml:munder> <mml:mrow><mml:mtext>Nonlinear</mml:mtext> <mml:mspace width="2pt"/><mml:mtext>memory</mml:mtext></mml:mrow></mml:munder></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>t</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(8)</label></disp-formula>
This form is analogous to <xref ref-type="disp-formula" rid="pcbi.1006003.e003">(3)</xref> but now includes the quadratic observables that we have retained, both in the subnetwork interactions (rate matrix terms) and in the memory terms. Once again <italic>r</italic><sub><italic>i</italic></sub>(<italic>t</italic>) represents the <italic>random forces</italic> but in this nonlinear case further characterization would require knowledge of the statistics of the initial bulk fluctuations, which is not generally available. We therefore disregard these terms, making <xref ref-type="disp-formula" rid="pcbi.1006003.e003">(3)</xref> a <italic>closed</italic> system of equations for the time evolution of the subnetwork concentrations. Note that neglecting the random forces is equivalent to assuming that the bulk concentrations are at their steady state values at the initial time. Formally these initial bulk concentrations should be random rather than deterministic to make the Zwanzig-Mori projection well defined; we follow the strategy of [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>] here and use initial Poisson distributions in the limit of vanishing variance. This limit has already been taken in the results above [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>]. How large protein copy numbers have to be to allow stochastic effects to be safely neglected is something that could be studied in future work; the answer will depend, among other things, on the degree of nonlinearity of the GRN time evolution equations [<xref ref-type="bibr" rid="pcbi.1006003.ref027">27</xref>].</p>
<p>Moving on to the nonlinear memory functions, we are again faced with the difficulty that these cannot in general be evaluated explicitly. However, previous work [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>] has developed a systematic approximation technique, which is applicable to the case of reaction networks with unary and binary reactions described by mass action kinetics. In such networks the time evolution equations for linear observables have linear and quadratic terms on the r.h.s. Inserting these into the equations for <italic>quadratic</italic> observables using the product rule gives <italic>e.g.</italic> <disp-formula id="pcbi.1006003.e009"><alternatives><graphic id="pcbi.1006003.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
and one sees that cubic terms arise. The approximation in [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>] neglects these terms in the spirit of an expansion to second order in the changes from steady state <italic>δx</italic>. These changes are therefore implicitly assumed to be small. Defining a vector <bold><italic>z</italic></bold> that collects all <italic>δx</italic> variables and their products such as <inline-formula id="pcbi.1006003.e010"><alternatives><graphic id="pcbi.1006003.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:mi>δ</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, <italic>δx</italic><sub>1</sub> <italic>δx</italic><sub>2</sub>, one can now again write a matrix form of the time evolution equations:
<disp-formula id="pcbi.1006003.e011"><alternatives><graphic id="pcbi.1006003.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>z</mml:mi> <mml:mi>α</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>β</mml:mi></mml:munder> <mml:msub><mml:mi>z</mml:mi> <mml:mi>β</mml:mi></mml:msub> <mml:msub><mml:mi>L</mml:mi> <mml:mrow><mml:mi>β</mml:mi> <mml:mi>α</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
The rate matrix entries and memory functions can then be calculated [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>] from the general formulae (<xref ref-type="disp-formula" rid="pcbi.1006003.e006">6</xref> and <xref ref-type="disp-formula" rid="pcbi.1006003.e007">7</xref>), applied to the expanded <bold><italic>L</italic></bold> matrix constructed as explained above. Because the subnetwork block S now contains linear {s} and quadratic observables {ss}, the matrices have the corresponding block structures. The coefficients Ω<sub><italic>ji</italic></sub> are collected in the block <bold>Ω</bold><sup>s,s</sup>, for example, and the Ω<sub>(<italic>jk</italic>)<italic>i</italic></sub> in the block <bold>Ω</bold><sup>ss,s</sup> of the overall rate matrix <bold>Ω</bold>. The memory functions <italic>M</italic><sub><italic>ji</italic></sub>(Δ<italic>t</italic>) and <italic>M</italic><sub>(<italic>jk</italic>)<italic>i</italic></sub>(Δ<italic>t</italic>) are similarly contained in blocks <bold><italic>M</italic></bold><sup>s,s</sup> and <bold><italic>M</italic></bold><sup>ss,s</sup> of the memory matrix <bold><italic>M</italic></bold>.</p>
<p>To apply the above technique in order to derive nonlinear projected subnetwork equations for GRN dynamics, the obvious heuristic route is again to expand the dynamical <xref ref-type="disp-formula" rid="pcbi.1006003.e001">eq (1)</xref>, this time to second order in the <italic>δx</italic><sub><italic>i</italic></sub>, to obtain an effective set of unary and binary reactions. This set defines the matrix <bold><italic>L</italic></bold>, from which the rate matrix and memory functions can then be found as explained above.</p>
</sec>
<sec id="sec007">
<title>Justifying the heuristics: Network expansion</title>
<p>The heuristic method set out above for deriving linear or nonlinear subnetwork equations for GRN dynamics is a useful practical recipe, but its mathematical basis is not obvious. One difficulty is that the thermodynamic GRN <xref ref-type="disp-formula" rid="pcbi.1006003.e001">eq (1)</xref> involve rational functions of the concentrations such as 1/(1 + <italic>x</italic><sub>1</sub>), and while these can be Taylor expanded they have only finite radius of convergence. Not only does the heuristic method then have to throw away an infinite number of higher order terms when truncating the Taylor expansion after linear or quadratic order, but it may implicitly be using the resulting approximation outside the regime where the expansion is even convergent. In addition, while we have loosely talked about the expanded time evolution equations as representing networks of effective reactions, such an interpretation is in no way assured as there is no underlying mechanistic model and hence no constraints that would ensure an appropriate stoichiometry or even positivity of rate constants.</p>
<p>Our mathematical contribution in this paper is to demonstrate that the above limitations can be resolved, and the heuristic approach justified, by initially <italic>expanding</italic> the thermodynamic eqs (<xref ref-type="disp-formula" rid="pcbi.1006003.e001">1</xref> and <xref ref-type="disp-formula" rid="pcbi.1006003.e002">2</xref>) into a network of well-defined unary and binary reactions. The way to achieve this is already suggested by <xref ref-type="disp-formula" rid="pcbi.1006003.e002">(2)</xref>: we represent each possible existing DNA conformation as an additional species whose concentration has its own dynamical evolution, such that in an appropriate limit of fast DNA binding and unbinding, it reaches the quasi-steady state (QSS) values of the DNA conformation concentrations <xref ref-type="disp-formula" rid="pcbi.1006003.e002">(2)</xref>. The prefix “quasi” refers to the fact that this steady state is for given protein concentrations, which themselves change slowly in time. We can then apply the Zwanzig-Mori method to this network to extract memory functions for the chosen subnetwork. In doing this we can justify removing higher order terms as in [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>] as the system is composed of only first and second order reactions. Finally the limit of fast DNA binding and unbinding has to be taken. Our result is that this procedure results in exactly the same projected equations as the heuristic approach described above, thus putting the method on a firm mathematical footing. The conclusion applies not only in the context of GRNs but in all networks with the appropriate timescale separation, provided that all fast observables are treated as part of the bulk. More sophisticated projection methods can then be derived by retaining some fast observables (in our case, subnetwork DNA) in the subnetwork. For the case of Michaelis-Menten dynamics, previous work has shown that such an approach allows one to derive projected equations that retain all subnetwork nonlinearities [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>]. More generally, by embedding GRN models based on thermodynamic state ensembles into the broad class of mass action reaction networks, our network expansion method opens up the possibility of incorporating stochastic effects and of applying a broad range of other approximation and model reduction techniques [<xref ref-type="bibr" rid="pcbi.1006003.ref028">28</xref>].</p>
</sec>
</sec>
<sec id="sec008" sec-type="results">
<title>Results</title>
<p>In this section we first provide our mathematical results, where we use a network expansion technique to provide a justification for the heuristic approach to finding memory functions for GRNs that was described in Secs. <italic>Projected equations for linearised dynamics</italic> and <italic>Nonlinear projected equations</italic> above. We then demonstrate applications of the approach with case studies. We first illustrate the memory function method on a simple example system. Finally, the results from the biological application to neural tube patterning are given in Sec. <italic>Application to neural tube network</italic> onwards.</p>
<sec id="sec009">
<title>Mathematical results</title>
<sec id="sec010">
<title>Network expansion applied to a protein-DNA binding mechanism</title>
<p>Our network expansion approach necessitates defining new reaction rates for binding and unbinding of protein to/from DNA that are consistent with the affinities <italic>w</italic> from the thermodynamic description. To be explicit, we define <inline-formula id="pcbi.1006003.e012"><alternatives><graphic id="pcbi.1006003.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>+</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> as the rate constant for protein <italic>p</italic> to bind to DNA coding for protein <italic>j</italic> and in binding conformation <bold><italic>n</italic></bold>, with a similar meaning for <inline-formula id="pcbi.1006003.e013"><alternatives><graphic id="pcbi.1006003.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula>. These rates will thus describe the interaction each DNA species has with the protein species that bind to it. With these rate constants we write down an equation for the time evolution of each DNA concentration <italic>x</italic><sub>(<italic>j</italic>,<bold><italic>n</italic></bold>)</sub>:
<disp-formula id="pcbi.1006003.e014"><alternatives><graphic id="pcbi.1006003.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>p</mml:mi></mml:munder> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>−</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>+</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>+</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>-</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>-</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(11)</label></disp-formula>
The first term on the r.h.s. of <xref ref-type="disp-formula" rid="pcbi.1006003.e014">(11)</xref> represents binding of protein <italic>p</italic> to DNA conformation (<italic>j</italic>, <bold><italic>n</italic></bold> − <bold><italic>e</italic></bold><sub><italic>p</italic></sub>) to make DNA conformation (<italic>j</italic>, <bold><italic>n</italic></bold>). Here <bold><italic>e</italic></bold><sub><italic>p</italic></sub> is a unit vector whose <italic>i</italic>-th entry is <italic>δ</italic><sub><italic>ip</italic></sub>, <italic>i.e.</italic> a 1 at position <italic>p</italic> and zeros elsewhere. Similarly the third term on the right of <xref ref-type="disp-formula" rid="pcbi.1006003.e014">(11)</xref> describes unbinding of protein <italic>p</italic>. The other two terms capture how DNA in conformation (<italic>j</italic>, <bold><italic>n</italic></bold>) can be lost by these two processes.</p>
<p>We next establish the relationship between the rate constants <italic>k</italic> in the mass action representation <xref ref-type="disp-formula" rid="pcbi.1006003.e014">(11)</xref> and the affinities <italic>w</italic> of the thermodynamic form. The rate constants need to be chosen to ensure the QSS <xref ref-type="disp-formula" rid="pcbi.1006003.e002">(2)</xref> of the DNA concentrations. The simplest assumption is detailed balance, which requires that in this steady state the net change in DNA concentration from any <italic>individual pair</italic> of binding and unbinding reactions between two conformations vanishes. Detailed balance means, in particular, that where there are multiple reaction paths from one DNA conformation to another, which might be distinguished by the order in which the various proteins bind, each path carries zero reaction flux rather than having a preferred forward or backward reaction direction. Balancing in this way the net change from binding of protein <italic>p</italic> to DNA in conformation (<italic>j</italic>, <bold><italic>n</italic></bold>) with the reverse unbinding transition, for the QSS concentrations <xref ref-type="disp-formula" rid="pcbi.1006003.e002">(2)</xref>, gives
<disp-formula id="pcbi.1006003.e015"><alternatives><graphic id="pcbi.1006003.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>+</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>-</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:munder><mml:mo>∏</mml:mo> <mml:mi>i</mml:mi></mml:munder> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>i</mml:mi> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>δ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
The protein concentrations cancel from this as they should and we are left with a constraint on the rate constants:
<disp-formula id="pcbi.1006003.e016"><alternatives><graphic id="pcbi.1006003.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>+</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>-</mml:mo></mml:mrow></mml:msubsup></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula>
To finish our construction, we need to ensure that the DNA concentrations reach the QSS values that we have imposed above with the detailed balance constraint <xref ref-type="disp-formula" rid="pcbi.1006003.e016">(13)</xref>. This requires that we make all DNA binding and unbinding reactions fast. Formally we introduce a fast rate factor <italic>γ</italic> and write all rate constants in the form <inline-formula id="pcbi.1006003.e017"><alternatives><graphic id="pcbi.1006003.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>±</mml:mo></mml:mrow></mml:msubsup> <mml:mo>=</mml:mo> <mml:mi>γ</mml:mi> <mml:msubsup><mml:mover accent="true"><mml:mi>k</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>±</mml:mo></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, with the understanding that we will take the limit <italic>γ</italic> → ∞ at fixed <inline-formula id="pcbi.1006003.e018"><alternatives><graphic id="pcbi.1006003.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mover accent="true"><mml:mi>k</mml:mi> <mml:mo>˜</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. This construction is analogous to the one previously used for Michaelis-Menten reactions [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>]. As there, we also need to ensure that the changes to protein concentrations from binding to DNA are negligible, as such effects are not described by the original thermodynamic <xref ref-type="disp-formula" rid="pcbi.1006003.e001">eq (1)</xref>. (We do, however, include them in the finite-<italic>γ</italic> numerics of <xref ref-type="fig" rid="pcbi.1006003.g002">Fig 2B</xref>.) This is achieved by scaling all DNA concentrations as <inline-formula id="pcbi.1006003.e019"><alternatives><graphic id="pcbi.1006003.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>x</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>/</mml:mo> <mml:msup><mml:mi>γ</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The intuition for this construction is that the amount of protein bound to DNA is, at most, of the order of the total concentration of DNA, which vanishes for <italic>γ</italic>′ → ∞. Finally, to compensate for the DNA concentration scaling, protein production rates have to be scaled as <inline-formula id="pcbi.1006003.e020"><alternatives><graphic id="pcbi.1006003.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mi>γ</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:msub><mml:mover accent="true"><mml:mi>α</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<fig id="pcbi.1006003.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006003.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Example of application of Zwanzig-Mori projection.</title>
<p>(<bold>A</bold>) Illustration of the methodology, for the example of a cross repressive motif. First the nonlinear thermodynamic reactions (left) are expanded into mass action reactions with an appropriate timescale separation (centre). This generates additional nodes that represent the possible DNA conformations for both proteins, with <italic>e.g.</italic> g1DNA/g2Prot indicating DNA for gene 1 with protein 2 bound to it. To the expanded network we can apply the projection approach, retaining only the concentration of protein 1 in the subnetwork. The effect of the rest of the network—the bulk—is captured via memory terms (right). (<bold>B</bold>) Comparison of the cross repressive motif described via the original thermodynamic equations and the expanded mass action equations with and without timescale separation. Already for a moderate fast rate factor of <italic>γ</italic> = 10 the mass action and thermodynamic time evolutions are visually indistinguishable. Two time courses are plotted in Fig. (<bold>B</bold>-<bold>D</bold>), for g1Prot &amp; g2Prot. (<bold>C</bold>-<bold>D</bold>) Demonstration of the projection approach with g1Prot in subnetwork and g2Prot in bulk. The projected equations track the dynamics of the original thermodynamic equation with a reduced system that contains memory functions. However, one can observe in (<bold>C</bold>) that accuracy can be lost in the transient if the system is initiated too far away from the fixed steady state. (<bold>D</bold>) Starting nearer to the steady state (at <italic>t</italic> = 1) substantially increases the accuracy of the projected description. (<bold>E</bold>) Example of memory functions of protein 1 to itself, decaying with time difference. The linear memory function is positive as expected from the network (positive feedback loop), while the nonlinear term is negative to correct for range-limiting nonlinearities that the linear terms cannot capture. Parameters used are <italic>α</italic><sub>1</sub> = 1, <italic>α</italic><sub>2</sub> = 1, <italic>w</italic><sub>p1</sub> = 1, <italic>w</italic><sub>p2</sub> = 2, <italic>w</italic><sub>1</sub> = 2, <italic>w</italic><sub>2</sub> = 2, <italic>β</italic><sub>1</sub> = 1/2, <italic>β</italic><sub>2</sub> = 1/2.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.g002" xlink:type="simple"/>
</fig>
<p>With the above rescalings, the limit <italic>γ</italic> → ∞ ensures that the “fast” species, <italic>i.e.</italic> the DNA concentrations are always in QSS with respect to the “slow” protein concentrations. The limit <italic>γ</italic>′ → ∞, on the other hand, means that the effects of binding to, and unbinding from, DNA can be neglected in the equations for the protein concentrations. These statements can be shown mathematically along the lines of the arguments in [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>]. After dropping all tildes on rates and concentrations again—this is the notational convention we adopt for the rest of the paper—the time evolution of the concentrations in our expanded network is given by <xref ref-type="disp-formula" rid="pcbi.1006003.e001">(1)</xref> for the protein equations, while for the DNA species one has
<disp-formula id="pcbi.1006003.e021"><alternatives><graphic id="pcbi.1006003.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:mi>γ</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>p</mml:mi></mml:munder> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>+</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>-</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>+</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>-</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi mathvariant="bold-italic">e</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>-</mml:mo> <mml:msubsup><mml:mi>k</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>-</mml:mo></mml:mrow></mml:msubsup> <mml:msub><mml:mi>x</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives> <label>(14)</label></disp-formula>
Note that in the above argument we do not require a specific relation between <italic>γ</italic> and <italic>γ</italic>′. In reality the rate for producing a single protein from the appropriate DNA, which is of order <italic>γ</italic>′, is lower than the DNA binding/unbinding rates, which are <italic>O</italic>(<italic>γ</italic>). However, quantifying this would be non-trivial as the model described here simplifies many biological steps into each of the two elementary processes of protein production and binding/unbinding. In any event, for our argument to hold we only need both <italic>γ</italic> and <italic>γ</italic>′ to be large, and for simplicity we take then <italic>γ</italic> = <italic>γ</italic>′ as was done in [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>].</p>
</sec>
<sec id="sec011">
<title>Obtaining linearised projected equations</title>
<p>We now proceed to use the expanded network to derive linearised projected equations. After the expansion, this requires us to keep track of deviations from steady state of all protein and DNA concentrations. We label these observables by “s” and “b” for subnetwork and bulk proteins as before, and “a” for DNA. Below we will refer to the DNA species in the system as “fast”, as expressed mathematically by the factor <italic>γ</italic> on the r.h.s. of <xref ref-type="disp-formula" rid="pcbi.1006003.e021">(14)</xref>, while protein species are “slow”. Note that the <italic>rate constants</italic> for protein production are also fast, of order <italic>γ</italic>′, but that the resulting <italic>changes</italic> to protein concentrations are slow because of the low concentration of (protein-producing) DNA.</p>
<p>We construct our <bold><italic>L</italic></bold> matrix by placing the DNA in the bulk, such that S = {s} and B = {b, a}, giving the block form
<disp-formula id="pcbi.1006003.e042"><graphic id="pcbi.1006003.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e042" xlink:type="simple"/><label>(15)</label></disp-formula>
The expression <xref ref-type="disp-formula" rid="pcbi.1006003.e007">(7)</xref> for the resulting memory function now explicitly involves the fast rate factor <italic>γ</italic> and the rate constants <inline-formula id="pcbi.1006003.e023"><alternatives><graphic id="pcbi.1006003.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msubsup><mml:mover accent="true"><mml:mi>k</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>±</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> used in the construction of our expanded network. These parameters appear in the third column in the second expression for <bold><italic>L</italic></bold> in <xref ref-type="disp-formula" rid="pcbi.1006003.e042">(15)</xref>, which encodes the time evolution equations for the DNA species. Our remaining task is to take the limit <italic>γ</italic> → ∞, with the aim of obtaining an expression for the memory function that only involves parameters of the original thermodynamic eqs (<xref ref-type="disp-formula" rid="pcbi.1006003.e001">1</xref> and <xref ref-type="disp-formula" rid="pcbi.1006003.e002">2</xref>). To take this limit, one notes that all blocks in the third column of <xref ref-type="disp-formula" rid="pcbi.1006003.e042">(15)</xref> are proportional to <italic>γ</italic>. As the memory function contains an exponential of <bold><italic>L</italic></bold>, it will then have contributions decaying for time differences of order 1/<italic>γ</italic>, arising from the DNA dynamics, as well as slow contributions decaying on timescales of order unity.</p>
<p>For <italic>γ</italic> → ∞ the fast memory function contributions become effectively instantaneous and add to the rate matrix, and only the slow contributions remain in the memory function. This separation into fast and slow pieces of the memory can be performed using the method in [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>] because <bold><italic>L</italic></bold> has exactly the same division into fast and slow blocks as there. It leads to the simple result that the final rate matrix and (slow) memory function for <italic>γ</italic> → ∞ can be calculated from an effective <bold><italic>L</italic></bold>-matrix no longer involving the fast degrees of freedom. To state the expression for the effective <bold><italic>L</italic></bold>, we first isolate the slow piece of our original <bold><italic>L</italic></bold>:
<disp-formula id="pcbi.1006003.e043"><graphic id="pcbi.1006003.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e043" xlink:type="simple"/><label>(16)</label></disp-formula>
(The zero blocks here arise from the fact that subnetwork and bulk proteins do not interact directly in our GRN setting, but only via the DNA species.) The effective <bold><italic>L</italic></bold>-matrix that gives us the rate matrix and memory function for <italic>γ</italic> → ∞ is then of the form <bold><italic>L</italic></bold><sub>eff</sub> = <bold><italic>L</italic></bold><sub>∖<italic>a</italic></sub> + Δ<bold><italic>L</italic></bold><sub>∖<italic>a</italic></sub>, which written out reads:
<disp-formula id="pcbi.1006003.e044"><graphic id="pcbi.1006003.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e044" xlink:type="simple"/><label>(17)</label></disp-formula>
Here the second term including the minus is the additional contribution Δ<bold><italic>L</italic></bold><sub>∖<italic>a</italic></sub> from the fast degrees of freedom. The matrix <bold><italic>L</italic></bold><sub>eff</sub> can be inserted directly into (<xref ref-type="disp-formula" rid="pcbi.1006003.e006">6</xref> and <xref ref-type="disp-formula" rid="pcbi.1006003.e007">7</xref>) to obtain the projected equations for linearised dynamics, with the fast rate limit already taken.</p>
</sec>
<sec id="sec012">
<title>Fast binding limit as quasi-steady state elimination</title>
<p>As in [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>], the result <xref ref-type="disp-formula" rid="pcbi.1006003.e044">(17)</xref> has a simple interpretation: <bold><italic>L</italic></bold><sub>eff</sub> can be obtained by eliminating the fast degrees of freedom from the linearised time evolution equations using a QSS condition. Using the block form <xref ref-type="disp-formula" rid="pcbi.1006003.e005">(5)</xref>, these equations can be written as
<disp-formula id="pcbi.1006003.e026"><alternatives><graphic id="pcbi.1006003.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>sT</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>sT</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>s,s</mml:mtext></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>aT</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,s</mml:mtext></mml:msup></mml:mrow></mml:math></alternatives> <label>(18a)</label></disp-formula>
<disp-formula id="pcbi.1006003.e027"><alternatives><graphic id="pcbi.1006003.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>bT</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>bT</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>b,b</mml:mtext></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>aT</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,b</mml:mtext></mml:msup></mml:mrow></mml:math></alternatives> <label>(18b)</label></disp-formula>
<disp-formula id="pcbi.1006003.e028"><alternatives><graphic id="pcbi.1006003.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>aT</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>sT</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>s,a</mml:mtext></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>bT</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>b,a</mml:mtext></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>aT</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,a</mml:mtext></mml:msup></mml:mrow></mml:math></alternatives> <label>(18c)</label></disp-formula>
where <bold><italic>δx</italic></bold><sup>sT</sup>, <bold><italic>δx</italic></bold><sup>bT</sup> and <bold><italic>δx</italic></bold><sup>aT</sup> are vectors collecting the concentration deviations of subnetwork proteins, bulk proteins and DNA species, respectively. All blocks of <bold><italic>L</italic></bold> appearing in <xref ref-type="disp-formula" rid="pcbi.1006003.e028">(18c)</xref> are proportional to <italic>γ</italic>. This justifies elimination of the fast variables using a QSS condition for these fast (DNA) degrees of freedom, effectively setting the r.h.s. of <xref ref-type="disp-formula" rid="pcbi.1006003.e028">(18c)</xref> to zero. The fast species concentrations are then expressed as:
<disp-formula id="pcbi.1006003.e029"><alternatives><graphic id="pcbi.1006003.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>aT</mml:mtext></mml:msup> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>sT</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>s,a</mml:mtext></mml:msup> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>bT</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>b,a</mml:mtext></mml:msup> <mml:mo>)</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,a</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
If we now substitute this back into the time evolution eqs (<xref ref-type="disp-formula" rid="pcbi.1006003.e026">18a</xref> and <xref ref-type="disp-formula" rid="pcbi.1006003.e027">18b</xref>) we obtain:
<disp-formula id="pcbi.1006003.e030"><alternatives><graphic id="pcbi.1006003.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>sT</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>sT</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>s,s</mml:mtext></mml:msup> <mml:mo>-</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>s,a</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,a</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,s</mml:mtext></mml:msup></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>s,s</mml:mtext></mml:msup></mml:mrow></mml:munder> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>bT</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:munder><mml:munder accentunder="true"><mml:mrow><mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>b,a</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,a</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,s</mml:mtext></mml:msup></mml:mrow> <mml:mo>︸</mml:mo></mml:munder> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>b,s</mml:mtext></mml:msup></mml:mrow></mml:munder> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>bT</mml:mtext></mml:msup></mml:mrow> <mml:mrow><mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>sT</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>s,a</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,a</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,b</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">δ</mml:mi> <mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>bT</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>b,b</mml:mtext></mml:msup> <mml:mo>-</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>b,a</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,a</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,b</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
Writing these time evolution equations in matrix form gives exactly the effective <bold><italic>L</italic></bold>-matrix <bold><italic>L</italic></bold><sub>eff</sub> defined in <xref ref-type="disp-formula" rid="pcbi.1006003.e044">(17)</xref>, as claimed. Two terms have been highlighted here by brackets for later comparison.</p>
</sec>
<sec id="sec013">
<title>Equivalence to heuristic linearisation</title>
<p>So far we have shown that the rate matrix and memory functions for the linearised dynamics can be found by applying standard projection results to a set of time evolution equations for only the slow degrees of freedom. This reduced set of equations is obtained by first expanding the thermodynamic equations into a set of mass-action equations, linearising, and finally eliminating the fast variables using a QSS assumption. We next show that this procedure is equivalent to directly linearising the original thermodynamic equations, for any case where there is a timescale separation. This generalises previous work [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>] that only considered separate (non-interacting) fast species. To verify the equivalence, it is useful to write the expanded mass-action equations in the generic form
<disp-formula id="pcbi.1006003.e031"><alternatives><graphic id="pcbi.1006003.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e031" xlink:type="simple"/><mml:math display="block" id="M31"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>s</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>b</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>a</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="5.0pt"/><mml:mspace width="5.0pt"/><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>s</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>b</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>a</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="5.0pt"/><mml:mspace width="5.0pt"/><mml:msup><mml:mi>γ</mml:mi> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>s</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>b</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>a</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
where <italic>x</italic><sub><italic>s</italic></sub>, <italic>x</italic><sub><italic>b</italic></sub> and <italic>x</italic><sub><italic>a</italic></sub> are generic components of <bold><italic>x</italic></bold><sup>s</sup>, <bold><italic>x</italic></bold><sup>b</sup> and <bold><italic>x</italic></bold><sup>a</sup>, respectively. This expanded description is constructed so that for <italic>γ</italic> → ∞, when the <italic>x</italic><sub><italic>a</italic></sub> can be replaced by their QSS values <inline-formula id="pcbi.1006003.e032"><alternatives><graphic id="pcbi.1006003.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula>, one recovers the original thermodynamic equations. These can therefore be written as
<disp-formula id="pcbi.1006003.e033"><alternatives><graphic id="pcbi.1006003.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>s</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>b</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>a</mml:mtext></mml:msup> <mml:msup><mml:mrow/><mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
<disp-formula id="pcbi.1006003.e034"><alternatives><graphic id="pcbi.1006003.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>∂</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:msub><mml:mi>x</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>s</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>b</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>a</mml:mtext></mml:msup> <mml:msup><mml:mrow/><mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(23)</label></disp-formula>
where the dependence of the <inline-formula id="pcbi.1006003.e035"><alternatives><graphic id="pcbi.1006003.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msubsup><mml:mi>x</mml:mi> <mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> on <bold><italic>x</italic></bold><sup>s</sup> and <bold><italic>x</italic></bold><sup>b</sup> is defined implicitly by
<disp-formula id="pcbi.1006003.e036"><alternatives><graphic id="pcbi.1006003.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>R</mml:mi> <mml:mi>a</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>s</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>b</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">x</mml:mi></mml:mrow> <mml:mtext>a</mml:mtext></mml:msup> <mml:msup><mml:mrow/><mml:mo>*</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(24)</label></disp-formula>
Expanding now the thermodynamic equations to linear order around a steady state one has
<disp-formula id="pcbi.1006003.e037"><alternatives><graphic id="pcbi.1006003.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mo>∂</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>=</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mfrac> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>b</mml:mi></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:munder></mml:mstyle> <mml:munder><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>a</mml:mi></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:mo>∂</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow> <mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow> <mml:mo stretchy="true">︸</mml:mo></mml:munder> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">L</mml:mi> <mml:mrow><mml:mtext>s,s</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:munder> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub> <mml:mo>+</mml:mo> <mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>b</mml:mi></mml:munder></mml:mstyle> <mml:munder><mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo> <mml:mi>a</mml:mi></mml:munder></mml:mstyle> <mml:mfrac><mml:mrow><mml:mo>∂</mml:mo> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow> <mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mo>∂</mml:mo> <mml:msub><mml:mi>x</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow> <mml:mo stretchy="true">︸</mml:mo></mml:munder> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msup><mml:mi mathvariant="bold-italic">L</mml:mi> <mml:mrow><mml:mtext>b,s</mml:mtext></mml:mrow></mml:msup></mml:mrow></mml:munder> <mml:mi>δ</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(25)</label></disp-formula>
Here all derivatives are evaluated at the steady state, and the terms in the second line arise from the variation of the QSS values of the fast variables. The required coefficients of the type <inline-formula id="pcbi.1006003.e038"><alternatives><graphic id="pcbi.1006003.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math></alternatives></inline-formula> can be found by differentiating <xref ref-type="disp-formula" rid="pcbi.1006003.e036">(24)</xref> with respect to the relevant slow variable, here <italic>x</italic><sub><italic>s</italic></sub>:
<disp-formula id="pcbi.1006003.e039"><alternatives><graphic id="pcbi.1006003.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e039" xlink:type="simple"/><mml:math display="block" id="M39"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac> <mml:mo>+</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:msup><mml:mi>a</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:munder> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mi>a</mml:mi></mml:msub></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:msup><mml:mi>a</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:mfrac> <mml:mfrac><mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mrow><mml:msup><mml:mi>a</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:mrow> <mml:mrow><mml:mi>∂</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(26)</label></disp-formula>
We can now show that <xref ref-type="disp-formula" rid="pcbi.1006003.e037">(25)</xref> is identical to <xref ref-type="disp-formula" rid="pcbi.1006003.e030">(20)</xref> derived above. To see this, we note that by linearising the expanded mass action <xref ref-type="disp-formula" rid="pcbi.1006003.e031">eq (21)</xref> one can identify the entries of <bold><italic>L</italic></bold>: for example, <bold><italic>L</italic></bold><sup>b,s</sup> has entries ∂<italic>R</italic><sub><italic>s</italic></sub>/∂<italic>x</italic><sub><italic>b</italic></sub>, <bold><italic>L</italic></bold><sup>s,a</sup> has entries <italic>γ</italic> ∂<italic>R</italic><sub><italic>a</italic></sub>/∂<italic>x</italic><sub><italic>s</italic></sub> etc. The QSS coefficients arising from <xref ref-type="disp-formula" rid="pcbi.1006003.e039">(26)</xref> can then be written in matrix form as <inline-formula id="pcbi.1006003.e040"><alternatives><graphic id="pcbi.1006003.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>/</mml:mo> <mml:mi>∂</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>s</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>s,a</mml:mtext></mml:msup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mi mathvariant="bold-italic">L</mml:mi></mml:mrow> <mml:mtext>a,a</mml:mtext></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>s</mml:mi> <mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, with a similar expression for <inline-formula id="pcbi.1006003.e025"><alternatives><graphic id="pcbi.1006003.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:mi>∂</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mi>a</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>/</mml:mo> <mml:mi>∂</mml:mi> <mml:msub><mml:mi>x</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>. Inserting these expressions into <xref ref-type="disp-formula" rid="pcbi.1006003.e037">(25)</xref> does indeed lead directly to <xref ref-type="disp-formula" rid="pcbi.1006003.e030">(20)</xref>, with matching terms indicated by the brackets. An exactly analogous argument demonstrates the equivalence for ∂<sub><italic>t</italic></sub> <italic>δx</italic><sub><italic>b</italic></sub>.</p>
<p>With the above arguments we have justified the heuristic method of Sec. <italic>Projected equations for linearised dynamics</italic> for obtaining linearised projected equations for the dynamics of a subnetwork within a larger GRN written in thermodynamic form: expand the GRN equations to linear order in protein concentrations around a steady state. Then construct from this the matrix <bold><italic>L</italic></bold><sub>eff</sub> and partition this into “s” and “b” blocks according to the chosen subnetwork–bulk split. Finally determine the rate matrix and memory function matrix from (<xref ref-type="disp-formula" rid="pcbi.1006003.e006">6</xref> and <xref ref-type="disp-formula" rid="pcbi.1006003.e007">7</xref>). We invoked an expanded network of binary reactions involving DNA conformations to <italic>derive</italic> that this is the correct method, but note that its <italic>application</italic> only requires the original thermodynamic equations as input. Therefore the resulting projected equations are, as they should be, independent of the details of the rates <inline-formula id="pcbi.1006003.e024"><alternatives><graphic id="pcbi.1006003.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msubsup><mml:mover accent="true"><mml:mi>k</mml:mi> <mml:mo>˜</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>j</mml:mi> <mml:mo>,</mml:mo> <mml:mi mathvariant="bold-italic">n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mi>p</mml:mi> <mml:mo>±</mml:mo></mml:mrow></mml:msubsup></mml:math></alternatives></inline-formula> used in the construction of the expanded network.</p>
</sec>
<sec id="sec014">
<title>Derivation of nonlinear projected equations</title>
<p>To capture more of the nonlinearity inherent in GRNs one can extend the approach described in the previous sections, to include terms that are quadratic in the deviations from a steady state. The memory function then contains fast and slow contributions, with the former being transformed into additional rate matrix terms when <italic>γ</italic> → ∞. The resulting rate matrix and slow memory functions can be obtained from an effective <bold><italic>L</italic></bold>-matrix involving only slow (linear and quadratic) observables. As before, this <bold><italic>L</italic></bold><sub>eff</sub> can be viewed as arising from a QSS elimination of the fast observables. Finally, one can show that this explicit elimination of the fast observables is equivalent to directly expanding the original thermodynamic equations to <italic>quadratic</italic> order in concentration deviations from the steady state: this justifies the heuristic method given in the Sec. <italic>Nonlinear projected equations</italic>.</p>
<p>Except for the last step, the above chain of argument is analogous to the linearised dynamics case, being based entirely on the identical structure of the partition—compare <xref ref-type="disp-formula" rid="pcbi.1006003.e005">(5)</xref> and (<xref ref-type="supplementary-material" rid="pcbi.1006003.s001">S1 Text</xref>, Eq. S.1)—of <bold><italic>L</italic></bold> into fast and slow blocks. The final reduction to a quadratic expansion of the thermodynamic equations is more subtle because the projection approach treats quadratic observables as distinct and not directly tied to products of linear observables. We defer the details to <xref ref-type="supplementary-material" rid="pcbi.1006003.s001">S1 Text</xref> and note only that our derivation there both simplifies and generalises that in [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>], from enzyme species that do not interact with each other to arbitrary interactions of the fast degrees of freedom.</p>
</sec>
</sec>
<sec id="sec015">
<title>Case studies</title>
<sec id="sec016">
<title>Zwangzig-Mori projection of a cross-repression motif</title>
<p>We applied the Zwanzig-Mori projection method to a cross repressive motif to illustrate our approach. <xref ref-type="fig" rid="pcbi.1006003.g002">Fig 2A</xref> shows the expansion procedure for this very simple regulation network: each of two genes is repressed through one binding site for the other factor. This system can be expanded to represent all possible DNA conformations, bound and unbound, as shown graphically by the four outer nodes in the network in the centre of <xref ref-type="fig" rid="pcbi.1006003.g002">Fig 2A</xref>. As the arrows indicate, in the expanded network unbound DNA can bind protein to form bound DNA; the reverse process is also possible. In this way one creates a set of reaction equations that has been extended and brought into mass action form by including the concentration of DNA conformations. The equations used for <xref ref-type="fig" rid="pcbi.1006003.g002">Fig 2</xref> are of the form of <xref ref-type="disp-formula" rid="pcbi.1006003.e001">(1)</xref> &amp; <xref ref-type="disp-formula" rid="pcbi.1006003.e002">(2)</xref>:
<disp-formula id="pcbi.1006003.e022"><alternatives><graphic id="pcbi.1006003.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mo>∂</mml:mo> <mml:mi>t</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtext>g1Prot</mml:mtext></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>w</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>w</mml:mi> <mml:mrow><mml:mtext>p2</mml:mtext></mml:mrow></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtext>g2Prot</mml:mtext></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>−</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msup> <mml:mo>−</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mtext>1</mml:mtext></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtext>g1Prot</mml:mtext></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives> <label>(27)</label></disp-formula>
and conversely for g2Prot. In numerical simulations of the expanded network we first checked the fast rate limit, which we control by setting the ratio, <italic>γ</italic>, of typical DNA reaction rates to protein production rates. <xref ref-type="fig" rid="pcbi.1006003.g002">Fig 2B</xref> shows that already with a moderate value of <italic>γ</italic> = 10 the predicted time courses of protein concentrations are almost identical to those predicted by the thermodynamic equations. As <italic>γ</italic> → ∞ the trajectories from the mass action equations and the thermodynamic equations become identical.</p>
<p>We chose to separate the system so that one protein species, g1Prot, is in the subnetwork and the other, g2Prot, is in the bulk. After expanding into protein and DNA species we proceeded to place all DNA species along with g2Prot in the bulk. Because we have performed the expansion around a steady state, the method is more precise when close to the steady state as expected (<xref ref-type="fig" rid="pcbi.1006003.g002">Fig 2D</xref>). Note that the cross-repressive motif with one binding site is not bistable. It could be made bistable by adding binding sites; with the current approach the behaviour around each steady state would then have to be analysed separately, as we also do in the neural tube application in the Sec. <italic>Application to neural tube network</italic>. More general projection methods can overcome this limitation as detailed in the Discussion, although it is clear that there are limits of principle here. For example, where the dynamical choice of steady state depends crucially on the initial concentration of a bulk species, this effect cannot be captured by a subnetwork description that by definition does not track this species.</p>
<p>Next we analyse the memory functions in our cross-repressive example, which can be thought of as describing the strength of a signal returning from the bulk a specific time after the original signal entered the bulk from the subnetwork (<xref ref-type="fig" rid="pcbi.1006003.g002">Fig 2E</xref>). The amplitude of the leading <italic>linear</italic> memory function—where the signal is <italic>δx</italic><sub>1</sub>(<italic>t</italic>′)—is positive. This makes sense as, in the cross repressive motif, a protein is inhibiting its inhibitor, thus promoting its own production. The second order memory function governs the effects of the signal <inline-formula id="pcbi.1006003.e005"><alternatives><graphic id="pcbi.1006003.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006003.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi>δ</mml:mi> <mml:msubsup><mml:mi>x</mml:mi> <mml:mn>1</mml:mn> <mml:mn>2</mml:mn></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. It is, in this case, negative and acts as a correction that captures nonlinearities beyond the linear memory. We observe that the decay in time of the memory functions is determined by the decay rate of the bulk protein. This is consistent with the memory function describing a protein repressing its own repressor, hence the effect only lasts as long as the repressor protein is present. Overall, the memory functions provide compact and readable descriptions of how the bulk modifies and influences the activity of the subnetwork.</p>
</sec>
<sec id="sec017">
<title>Application to neural tube network</title>
<p>Reducing part of a network into memory functions offers a way to simplify and analyse the effect of the factors in this bulk part on the remaining subnetwork. To illustrate this approach we chose to analyse a four gene network involved in the embryonic patterning of the vertebrate neural tube [<xref ref-type="bibr" rid="pcbi.1006003.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref030">30</xref>]. The developing neural tube is a well characterised example of developmental pattern formation. In this tissue, the secreted molecule, Sonic-Hedgehog (Shh) forms a ventral to dorsal gradient [<xref ref-type="bibr" rid="pcbi.1006003.ref031">31</xref>]. This in turn generates discrete domains of gene expression that define the progenitors of the distinct neuronal subtypes that comprise spinal cord circuitry (<xref ref-type="fig" rid="pcbi.1006003.g003">Fig 3A and 3B</xref>). A transcriptional network has been identified that is controlled by graded Shh signaling and is responsible for specifying ventral progenitor domains [<xref ref-type="bibr" rid="pcbi.1006003.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref032">32</xref>]. Genetic and molecular experiments have determined the activity of the components of this network (<xref ref-type="fig" rid="pcbi.1006003.g003">Fig 3C</xref>) and documented the temporal dynamics of pattern formation in vitro and in vivo [<xref ref-type="bibr" rid="pcbi.1006003.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref033">33</xref>]. For the three most ventral domains of progenitors, four transcription factors are essential, Nkx2.2, Olig2, Pax6 and Irx3. The most ventral domain (p3 domain) is characterised by high Nkx2.2 and low levels of the other three proteins; the domain adjacent to this (pMN domain) has high levels of Olig2, medium levels of Pax6 and low levels of the other two proteins. Dorsal to this, the p2 domain expresses high levels of Pax6 and Irx3 and low levels of the other two proteins.</p>
<fig id="pcbi.1006003.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006003.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Patterning of the vertebrate neural tube.</title>
<p>(<bold>A</bold>) Antibody staining of Wild type (WT) mouse stained for three of the main bands in dorso-ventral patterning. (Image provided by Katherine Exelby). (<bold>B</bold>) Illustration of neural tube patterning: ventral Shh secreted from the notocord and floor plate (termed “Source”) generates patterned domains along the dorso-ventral axis. Each domain is defined by the expression of a characteristic set of genes. (<bold>C</bold>) GRN that patterns the three most ventral domains of the neural tube. The chosen separation of bulk (purple) and subnetwork (green) in the application of the Zwanzig-Mori projection is also shown. (<bold>D</bold>) Simulations of steady state pattern along the dorsoventral axis using a set of thermodynamic equations of the form of eqs (<xref ref-type="disp-formula" rid="pcbi.1006003.e001">1</xref> and <xref ref-type="disp-formula" rid="pcbi.1006003.e002">2</xref>). These equations were taken—along with appropriate initial conditions of 0 for all species—from [<xref ref-type="bibr" rid="pcbi.1006003.ref024">24</xref>]. For all plots where <italic>x</italic> axis represents neural tube position, zero corresponds to the most ventral point. (<bold>E</bold>) Full bifurcation diagram illustrating the multistable nature of the network. Shown are steady state concentrations of the four molecular species against neural tube position, with unstable steady states marked dashed. Colours in (<bold>D</bold>, <bold>E</bold>) identify genes/proteins in the same way as in the labelling of the illustration (<bold>B</bold>) and of the network nodes in (<bold>C</bold>). This colour code is used throughout the paper unless otherwise noted.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.g003" xlink:type="simple"/>
</fig>
<p>Mathematical models have been formulated based on the experimental data and these are able to replicate key aspects of cell patterning [<xref ref-type="bibr" rid="pcbi.1006003.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref033">33</xref>] (<xref ref-type="fig" rid="pcbi.1006003.g003">Fig 3D</xref>). We take advantage of these to develop a Zwanzig-Mori projection of the system (using equations as described in [<xref ref-type="bibr" rid="pcbi.1006003.ref024">24</xref>] &amp; <xref ref-type="supplementary-material" rid="pcbi.1006003.s003">S3 Text</xref>). To this end, we chose Nkx2.2 and Olig2 to be the subnetwork species, given that they are receiving direct input from Shh (<xref ref-type="fig" rid="pcbi.1006003.g003">Fig 3C</xref>), and replaced Irx3 and Pax6 with memory functions.</p>
</sec>
<sec id="sec018">
<title>Linear memory analysis</title>
<p>We first examined the properties of the linear memory functions. These are the most substantial contributions, close to the specific steady states, of the species in the bulk (Pax6 and Irx3) on the temporal changes in the activity of Nkx2.2 and Olig2. We note that the system is multistable (<xref ref-type="fig" rid="pcbi.1006003.g003">Fig 3E</xref>) and different combinations of steady states are available at different positions along the dorsal ventral axis (Shh gradient). We therefore analysed each possible steady state along the neural tube. In this case, as the bulk species are mutual repressors with the subnetwork species, they form a positive feedback loop with the factors in the subnetwork. As a consequence, each of the linear memory functions is positive and exponentially decaying on the time-scale of protein degradation of the bulk species. Thus the relative contribution of each of the memory functions can be assessed by comparing their amplitude, defined as the memory function value at zero time difference.</p>
<p>We calculated the amplitudes of the memory functions and determined the memory effects that Nkx2.2 and Olig2 receive over time. Furthermore, we used the method developed in [<xref ref-type="bibr" rid="pcbi.1006003.ref020">20</xref>] to <italic>decompose</italic> the memory into contributions from memory signals passing through the two different bulk species (<xref ref-type="fig" rid="pcbi.1006003.g004">Fig 4A–4D</xref>). This allowed us to determine the importance of specific regulatory interactions between transcription factors (TFs) at every position of the neural tube model, and assess their respective contributions. The results indicate that, for the most part, there is only a small memory amplitude of Nkx2.2 to the past of Olig2 passing through Pax6 (<xref ref-type="fig" rid="pcbi.1006003.g004">Fig 4B</xref>; note the logarithmic <italic>y</italic>-axis): the memory of (past) Olig2 on Nkx2.2 is largely dominated by memory through Irx3. The only exception is for steady states that are not reached during normal neural tube patterning (lower pair of curves in the neural tube position range ≈ [0.2 … 0.45] in <xref ref-type="fig" rid="pcbi.1006003.g004">Fig 4B</xref>). These steady states exist because the system is multistable, but the initial conditions that lead to them are incompatible with physiological conditions. We additionally observe in <xref ref-type="fig" rid="pcbi.1006003.g004">Fig 4A</xref> that the memory of Nkx2.2 to itself is for the most part shared between Irx3 and Pax6, with no particular TF being dominant. There are again exceptions from this, but only in steady states that are biologically unreasonable. In the case of the memory of Olig2, it can only be influenced by Irx3 as is clear from the structure of the network in <xref ref-type="fig" rid="pcbi.1006003.g003">Fig 3C</xref>. Channel decomposition is therefore unnecessary. We observe that the memory effects of Olig2 to itself are strongest in the p3 domain, and the opposite is true (memory of Nkx2.2 on Olig2 is stronger) in the pMN domain.</p>
<fig id="pcbi.1006003.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006003.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Memory amplitude and temporal dynamics.</title>
<p>(<bold>A</bold>) Amplitude of memory (memory function at Δ<italic>t</italic> = 0) of Nkx2.2 to itself along the neural tube. There are multiple lines as the analysis was performed at all possible stable steady states. The vertical axis is logarithmic to make the range of amplitudes easier to appreciate. Colours identify the memory amplitude contribution from each of the two possible bulk channels, via Irx3 and Pax6, respectively. Thick lines indicate physiological states, while thin lines indicate states that are not usually observed in vivo. (<bold>B</bold>) Linear memory amplitude of (past) Olig2 on Nkx2.2 along the neural tube. The memory via Pax6 is for the most part below the memory via Irx3 in each pair of corresponding curves. (<bold>C,D</bold>) Memory amplitudes of Olig2 to Nkx2.2 (<bold>C</bold>) and to itself (<bold>D</bold>). No channel decomposition is performed as Olig2 receives memory only via the Irx3 channel. (<bold>E</bold>) Nonlinear memory of (past) Olig2 squared on Nkx2.2 in the p3 domain, where dynamics are dominated by Irx3; memory via Pax6 is negligible by comparison. (<bold>F</bold>) Nonlinear memory function of (past) Olig2 squared on Nkx2.2 from position 0.2 in (<bold>E</bold>), plotted to show that the relative contribution of the Pax6 channel is small also for all time differences. (<bold>G,H</bold>) Nonlinear memory functions of Olig2 to Nkx2.2 (<bold>G</bold>) and itself (<bold>H</bold>) in the p2 domain at position 0.7, exemplifying the potential for nontrivial time dependences (including non-monotonicity and sign changes) in the nonlinear memory functions.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.g004" xlink:type="simple"/>
</fig>
<p>We observe in <xref ref-type="fig" rid="pcbi.1006003.g003">Fig 3</xref> that the order of magnitude of the memory amplitudes changes substantially with neural tube position. This is a consequence of the system becoming more or less sensitive to concentration fluctuations of a given species within the network. An example of this is Nkx2.2 memory to itself via Pax6 in the pMN domain (<xref ref-type="fig" rid="pcbi.1006003.g004">Fig 4A</xref>), where dorsally the lower levels of Shh mean that the binding sites of Nkx2.2 are less occupied by the active form of Gli (Gli is the transcriptional effector downstream of Shh that binds to Nkx2.2 &amp; Olig2, see [<xref ref-type="bibr" rid="pcbi.1006003.ref024">24</xref>] for details on how this is implemented). Active Gli sets the rate of production of Nkx2.2 and thus has a direct effect on the amplitude of the memory functions. In addition to this, as one moves dorsally in the pMN domain, the steady state concentration of Pax6 is increasing (<xref ref-type="fig" rid="pcbi.1006003.g003">Fig 3E</xref>, also observed experimentally). This increase causes the system to become insensitive to fluctuations of Pax6 proteins as Pax6 binding sites are typically already saturated. This phenomenon is at work also in the other memory function amplitudes that change across neural tube position as seen in <xref ref-type="fig" rid="pcbi.1006003.g004">Fig 4A–4D</xref>.</p>
</sec>
<sec id="sec019">
<title>Nonlinear memory analysis</title>
<p>We next examined the second order memory functions. These provide corrections to the linear memory terms and encode information about how the bulk nodes drive the system towards a steady state. Quantitative accuracy in capturing the dynamics of the full nonlinear network will also be improved to the extent possible within an expansion around a steady state, but such accuracy is not our main focus—it is the additional insights gained from the memory functions that we are after.</p>
<p>It is apparent that once memory terms are included, different trajectories in the subnetwork plane <italic>cross</italic>. This is visually most obvious with the full nonlinear memory terms (<xref ref-type="supplementary-material" rid="pcbi.1006003.s004">S1C and S1G Fig</xref>) and consistent with the full dynamics (<xref ref-type="supplementary-material" rid="pcbi.1006003.s004">S1D and S1H Fig</xref>). The crossings arise from the fact that, in the presence of memory, systems in the same state can follow different trajectories towards a steady state depending on their past. In the full dynamics, the additional information as to which path a system will take is contained in the bulk species, which effectively hold the information on the past of the system. In the case of the memory functions, the memory is not contained in network nodes outside of the subnetwork, but is represented explicitly via the memory terms, with the time difference dependence of the memory functions indicating, for example, the timescale of the memory. This offers a useful abstraction: while it is not easy to visualize the four-dimensional concentration space for the full dynamics, the projection approach reduces the system to two components with memory of their own past.</p>
<p>In the nonlinear memory functions, we can assess the importance of the link from Olig2 to Pax6 by considering the squared deviations of Olig2: the Pax6 channel contribution to this memory necessarily involves signals being propagated via this Olig2→Pax6 link. We find that the Pax6 channel makes a very small contribution to the nonlinear memory amplitude in comparison to the Irx3 channel. This is shown in <xref ref-type="fig" rid="pcbi.1006003.g004">Fig 4E</xref> for the p3 domain but is true also for all other states. We additionally checked the time-dependence of the memory function: from <xref ref-type="fig" rid="pcbi.1006003.g004">Fig 4F</xref> one sees that the relative contribution of the Pax6 channel to the nonlinear memory of (past) Olig2 squared on Nkx2.2 remains small at all time-differences. Together with our results above for linear memory functions, we thus conclude that the repression of Pax6 by Olig2 is dispensable for maintaining an established dorsal-ventral pattern. We plot an example of nonlinear memory functions (<xref ref-type="fig" rid="pcbi.1006003.g004">Fig 4G and 4H</xref>) to illustrate that their dependence on time difference can include non-monotonicities and sign changes that mean memory amplitudes do not tell the full story of the effect of nonlinear memory. The effects of including the memory terms can be confirmed and further visualised by considering the effective drift vector, which contains the rates of change of the concentrations of Nkx2.2 and Olig2. We describe this approach in <xref ref-type="supplementary-material" rid="pcbi.1006003.s002">S2 Text</xref>, where we also discuss further how specific contributions of the nonlinear memory affect the dynamics, for example in the approach to the state in the p2 domain.</p>
</sec>
<sec id="sec020">
<title>Exploration of network properties</title>
<p>The analysis of both linear and nonlinear memory functions in the previous section suggested that the repression of Pax6 by Olig2 is not critical for the dynamics of the steady states observed in neural tube patterning. We based this on the observation that the amplitude of memory that is transmitted through this link is relatively small compared to the other memory functions, for all biologically relevant steady states.</p>
<p>To test this prediction of the memory function analysis, we removed the repressive link from Olig2 to Pax6 in the full model. Consistent with our prediction of the relative insignificance of the link from Olig2 to Pax6, the resulting steady state concentrations of the simulations are similar to those in the original system (<xref ref-type="fig" rid="pcbi.1006003.g005">Fig 5A</xref>). The only qualitative change is the increased level of Pax6 between neural tube position 0.2 and 0.7, which results from the loss of the repressive link. But the spatial aspects, such as the positional sequence of genes and qualitative concentrations, of the domains are otherwise unaltered.</p>
<fig id="pcbi.1006003.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006003.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Olig2 repression of Pax6 increases robustness to initial conditions.</title>
<p>(<bold>A</bold>) Patterning without the repressive link from Olig2 to Pax6, showing steady states reached from standard initial conditions. Compared to the full network, the qualitative domain structure is conserved. (<bold>B</bold>) Patterning for the full network for initial conditions with high levels of Pax6 and Irx3 is qualitatively identical to low initial levels of Pax6 and Irx3. Initial conditions [Pax6] = [Irx3] = 1. (<bold>C</bold>) Patterning without the repressive link from Olig2 to Pax6 for initial conditions with high levels of Pax6 and Irx3. The p3 domain is lost as a consequence of the different initial conditions. (<bold>D</bold>) Bifurcation diagram of the network without Olig2-Pax6 repression. The region in which the pMN state (Olig2 high) is stable has expanded ventrally, thus making the ventralmost region bistable.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.g005" xlink:type="simple"/>
</fig>
<p>Since the repressive link between Olig2 and Pax6 has been experimentally documented [<xref ref-type="bibr" rid="pcbi.1006003.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1006003.ref035">35</xref>] but from our analysis is not required for the dynamics around the steady state, we sought to understand what purpose it might serve during development. We performed simulations from varying initial conditions for both WT (<xref ref-type="fig" rid="pcbi.1006003.g005">Fig 5B</xref>) and the system lacking the link (<xref ref-type="fig" rid="pcbi.1006003.g005">Fig 5C</xref>). These show that the p3 domain is reached from only a small range of initial conditions following the removal of the repressive link between Olig2 and Pax6. To rationalise this, we performed a bifurcation analysis (<xref ref-type="fig" rid="pcbi.1006003.g005">Fig 5D</xref>). This indicated that the removal of the Olig2 inhibition of Pax6 markedly increased the range of positions at which the Olig2 steady state is present, thus facilitating its invasion into the Nkx2.2 domain. In particular, under initial conditions of high Pax6 and Irx3, the pMN domain is induced ventrally. In the unperturbed network it is not possible to reach this steady state in the ventralmost part because the system is monostable, allowing only the p3 domain to arise. On the other hand, in the absence of Olig2 inhibition of Pax6, the ventral region is bistable. Hence, depending on the initial conditions a pMN fate can be reached (<xref ref-type="fig" rid="pcbi.1006003.g005">Fig 5D</xref>). Taken together, this analysis suggests that the repressive link from Olig2 to Pax6 contributes to the robustness of the system for patterning the neural tube.</p>
<p>A potential explanation for the seemingly dispensable regulatory interaction between Olig2 and Pax6 arises from considering the normal development of the neural tube. During embryonic neural tube development, neural progenitors are generated by the process of neural induction and this initiates the expression of neural genes including Pax6 and Irx3. At the same time, cells of the notochord (which underlies the ventral midline of the neural tube) begin to secrete Shh. Shh spreads into the neural tube and neural progenitors respond to the signal. The consequence is that in the ventral neural tube neural progenitors begin responding to Shh at intermediate levels of Pax6 and Irx3. A more appropriate initial condition, representative of the in vivo situation, is for Pax6 and Irx3 to be somewhere between 0 and maximum. Moreover, heterogeneity between cells, as well as variation in the exact timing of developmental events along the rostral-caudal axis of the embryo, means that the precise initial conditions—the levels of Pax6 and Irx3 when cells respond to Shh signalling—will vary. Hence the robustness provided by the Olig2-Pax6 link may play an important role in ensuring reliable pattern formation in the developing neural tube.</p>
</sec>
</sec>
</sec>
<sec id="sec021" sec-type="conclusions">
<title>Discussion</title>
<p>We have developed a generally applicable method for applying Zwanzig-Mori projections to transcriptional networks that allows the analysis of subnetworks extracted from a larger network. We demonstrated the approach on a simple genetic cross repressive motif, to illustrate the minimal example of a memory function, and on a more complicated, but well-characterised, transcriptional network operating in the ventral part of the vertebrate neural tube. This showed how the method allows the function and importance of specific links within a network to be defined in an intuitive manner. We used these insights to identify structural features of the neural tube network that appear primarily to increase the robustness of the network to initial conditions, rather than maintain its steady state.</p>
<p>The projection technique is straightforward to implement using the methodology described, and can be applied to any GRN following the thermodynamic formalism (including activation, repression, competitive and cooperative binding). Further protein-protein interactions could readily be incorporated as these would be represented by simple first order (unary) or second order (binary) interactions. Thus, in addition to gene regulation, nonlinear protein-protein interactions mediated by enzymes such as those found in signal transduction pathways could be included in the analysis [<xref ref-type="bibr" rid="pcbi.1006003.ref021">21</xref>]. It would also be possible to include Hill functions as long as these possess integer exponents [<xref ref-type="bibr" rid="pcbi.1006003.ref027">27</xref>]. Note that our treatment relies on mass action kinetics, which implicitly assumes that the different molecular species are well mixed by diffusion processes that are faster than any of the reaction kinetics [<xref ref-type="bibr" rid="pcbi.1006003.ref036">36</xref>]. The size of the matrices involved in constructing the memory functions scales as the square of the number of bulk species, which in our experience means that networks with up to 200 nodes can be investigated without difficulty. Thus, the generality of the method and the ability to implement it algorithmically provide a comprehensive mathematical toolkit to simplify and analyse dynamical systems describing a range of cellular and molecular processes.</p>
<p>In our mathematical treatment we took advantage of an argument of timescale separation for molecular mechanisms operating in transcriptional networks, in which fast processes (DNA-protein interactions) are assumed to be in QSS compared to the slow processes (changes in protein concentration). We also assume the effective concentration of DNA species to be small in comparison to that of protein species. We consider these to be reasonable assumptions because DNA-protein interactions occur at a much faster rate than the changes in protein concentrations produced by transcription and translation [<xref ref-type="bibr" rid="pcbi.1006003.ref037">37</xref>]. Moreover, there are usually at most four DNA copies of each gene per cell, whereas the number of individual protein molecules is normally considerably higher. The production of individual proteins per DNA copy number, <italic>i.e.</italic> the relevant rate constant, can then be large while the resulting relative changes to protein concentration are slow. These assumptions allowed us to construct an extended reaction network involving fast molecular (DNA) species and at most binary reactions. This construction is sufficiently general for it to be applicable to other systems with a timescale separation, as long as they satisfy the above conditions for the relevant concentrations and rate constants.</p>
<p>An important component of this Zwanzig-Mori projection method is that the memory functions describe all the behaviours of a system in the vicinity of a steady state. Even though this comes at the cost of predictions becoming increasingly inaccurate the further the system is from the fixed point, the information around the steady state is sufficient to distil relevant properties of the network. We therefore employ the method as a tool for probing the dynamics near a chosen steady state, rather than for tracking dynamics. The benefit is that the resulting memory functions are substantially simpler than the original system. There is no need to perform simulations to analyse memory functions or to test different positions in phase space as a steady state is approached. Moreover, the method can also be applied to an arbitrarily chosen subnetwork of a generic network whereas other model reduction approaches—as discussed in the Introduction—do not allow this, and are also more restrictive as they require specific network motifs or functional forms of the dynamics.</p>
<p>The memory functions produced by the Zwanzig-Mori approach allow exploration of the amplitudes and timescales of the interactions between the subnetwork and bulk. This can reveal information that is not otherwise easy to discern from the parameters of the full dynamics or from the functional form of the equations. Each memory function represents the total of the contributions from a given subnetwork component that feeds back to the subnetwork over time after passing through the bulk. This total memory can be decomposed into channels that describe the flow of signals through specific components in the bulk. In this way, the channels that dominate a memory effect can be identified, providing insight into the dynamical mechanisms responsible for achieving and maintaining a steady state. The memory functions thus help to extract features of the dynamics that would not be readily detectable in direct simulations of the time evolution equations.</p>
<p>An example of the type of insight provided by the projection method came from our analysis of the neural tube network. We focused on a subnetwork comprising Nkx2.2 and Olig2. Decomposition of the memory functions suggested that an experimentally documented repression of Pax6 by Olig2 [<xref ref-type="bibr" rid="pcbi.1006003.ref034">34</xref>] plays only a minor role in sustaining the steady state pattern. Consistent with this prediction, simulations in which this regulatory link had been eliminated in the full model showed qualitatively unchanged steady states. We note that removal of the repressive link between Olig2 and Pax6 is distinct from the removal of Olig2 itself [<xref ref-type="bibr" rid="pcbi.1006003.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006003.ref033">33</xref>]. In the Olig2 mutant, the repressive effect of Olig2 on both Nkx2.2 and Pax6 are eliminated whereas the removal of the Pax6-Olig2 link leaves the repressive effect of Olig2 on Nkx2.2 intact. The memory function analysis thus raised the question of what purpose the Olig2-Pax6 regulation might serve and prompted us to explore the transient system dynamics, specifically the effect of the initial conditions, which are unknown in the <italic>in vivo</italic> system. Simulations in the absence of the Olig2-Pax6 repression, compared to the full model, revealed a marked increase in sensitivity to these initial conditions. Comparison of the bifurcation diagrams of the systems, with and without the Pax6-Olig2 link, indicated that the well-defined Nkx2.2 monostable region (p3 domain)—which appears at high levels of Shh signalling in the full system—was replaced by a region of bistability for Nkx2.2 and Olig2 in the absence of the Olig2-Pax6 regulation. In this latter case the steady state induced by high levels of signal therefore depends on the initial concentrations of Pax6 and Irx3. This suggests that, while not necessary to maintain steady states, the Olig2-Pax6 regulation ensures access to the appropriate steady states irrespective of the initial levels of Pax6 and Irx3. As these may differ between cells and at different locations along the rostral-caudal axis of the neural tube, the Olig2-Pax6 regulatory link might make the system less sensitive to these variations. This implies that the primary purpose of Olig2 repression of Pax6 is to increase the robustness of pattern formation.</p>
<p>Alternative implementations of the Zwanzig-Mori projection [<xref ref-type="bibr" rid="pcbi.1006003.ref038">38</xref>–<xref ref-type="bibr" rid="pcbi.1006003.ref040">40</xref>] have been developed that do not rely on expanding around a fixed steady state and we are currently adapting these for transcriptional networks. While these alternative methods may provide a solution to the specific limitations of our current Zwanzig-Mori projection method, the nonlinear memory functions they produce are much richer. Further work will be needed to fully understand the more complex information they encode. Projection methods might also provide a way to analyse systems for which only partial information is available. Given a known subnetwork that is not able to fully reproduce experimental observations, the incorporation of memory functions provides a means to explore the possible effects of unknown factors. This could then be used to identify plausible network structures that generate these memory functions. Taken together therefore, the projection approach provides tools to simplify, visualise and explore the behaviour of large networks that would otherwise be difficult to analyse in their entirety.</p>
</sec>
<sec id="sec022">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006003.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.s001" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Justification of heuristic method for quadratic observables.</title>
<p>In this Appendix we give the details of the projection method with linear and quadratic observables, applied to an expanded network as outlined in Sec. <italic>Nonlinear projected equations</italic>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006003.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.s002" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Further analysis of memory effects.</title>
<p>In this Appendix we give additional detail of the wide variety of effects that memory functions contribute to the behaviour of a system. Specifically, we explore the effect of the contributions from nonlinear memory terms and provide an alternative visualisation using a first order time expansion of the effective drift of the system.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006003.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.s003" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Model details.</title>
<p>Equations and parameters used in model of neural tube patterning network.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006003.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.s004" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Trajectories approaching a steady state, with and without memory.</title>
<p>Trajectories approaching a high Olig2 state in the pMN domain from a range of initial conditions, with no memory (<bold>A</bold>), with only linear memory (<bold>B</bold>), with linear and nonlinear memory (<bold>C</bold>), and the full dynamics (<bold>D</bold>). Trajectories approaching a low Olig2, low Nkx2.2 state in the p2 domain from different initial conditions, with no memory (<bold>E</bold>), with only linear memory (<bold>F</bold>), with linear and nonlinear memory (<bold>G</bold>), and the full dynamics (<bold>H</bold>). All figures are parametric plots, showing Nkx2.2 and Olig2 concentrations on the <italic>x</italic>- and <italic>y</italic>-axis, respectively, with time as curve parameter. The trajectories are coloured to represent the norm of the drift vector of the system as indicated by the colour scale; high values indicate the system is evolving quickly while the opposite is true for low values. Scalebars on the right apply to the corresponding row. Path crossing can be seen in (<bold>C</bold>–<bold>D</bold>) &amp; (<bold>G</bold>–<bold>H</bold>), illustrating the importance of nonlinear memory terms to reproduce qualitative features of the full thermodynamic equations.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006003.s005" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.s005" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Nonlinear memory amplitudes.</title>
<p>(<bold>A</bold>-<bold>D</bold>) Nonlinear memory amplitudes across neural tube positions within the pMN domain. The plot titles indicate the type of memory, <italic>e.g.</italic> (<bold>C</bold>) shows memory of (past) Nkx2.2 squared fluctuation on Olig2. Memory effects of past Olig2-fluctuations in the pMN domain are negligible. (<bold>E</bold>-<bold>H</bold>) Nonlinear memory amplitudes across neural tube positions within the p2 domain. Nkx2.2 receives very little quadratic memory influence in this domain. The <italic>x</italic>-axis represents neural tube position in all plots. Blue and yellow lines indicate the decomposition into Pax6 and Irx3 channels, while green lines indicate the total memory.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006003.s006" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006003.s006" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Effective drift changes as a consequence of memory terms.</title>
<p>Colour map and contour plots of the norm of the effective drift, in conditions identical to those in <xref ref-type="supplementary-material" rid="pcbi.1006003.s004">S1A–S1C Fig</xref> for the first row (pMN domain) and <xref ref-type="supplementary-material" rid="pcbi.1006003.s004">S1E–S1G Fig</xref> (p2 domain) for the second row. (<bold>A</bold>,<bold>D</bold>) Memoryless drift, (<bold>B</bold>,<bold>E</bold>) drift with linear memory, (<bold>C</bold>,<bold>F</bold>) drift with linear and nonlinear memory. The scalebar on the right applies to each entire row. Effective drift norms have been calculated for time <italic>t</italic> = 0.8.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We are grateful to Katherine Exelby for providing microscopy images.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006003.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Levine</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>EH</given-names></name>. <article-title>Gene regulatory networks for development</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2005</year>;<volume>102</volume>(<issue>14</issue>):<fpage>4936</fpage>–<lpage>4942</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0408031102" xlink:type="simple">10.1073/pnas.0408031102</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Glass</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kauffman</surname> <given-names>SA</given-names></name>. <article-title>The logical analysis of continuous, non-linear biochemical control networks</article-title>. <source>Journal of Theoretical Biology</source>. <year>1973</year>;<volume>39</volume>(<issue>1</issue>):<fpage>103</fpage>–<lpage>129</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0022-5193(73)90208-7" xlink:type="simple">10.1016/0022-5193(73)90208-7</ext-link></comment> <object-id pub-id-type="pmid">4741704</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mogilner</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wollman</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Marshall</surname> <given-names>WF</given-names></name>. <article-title>Quantitative Modeling in Cell Biology: What Is It Good for?</article-title> <source>Developmental Cell</source>. <year>2006</year>;<volume>11</volume>(<issue>3</issue>):<fpage>279</fpage>–<lpage>287</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006003.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Craciun</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Tang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Feinberg</surname> <given-names>M</given-names></name>. <article-title>Understanding bistability in complex enzyme-driven reaction networks</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2006</year>;<volume>103</volume>(<issue>23</issue>):<fpage>8697</fpage>–<lpage>8702</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0602767103" xlink:type="simple">10.1073/pnas.0602767103</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kondo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Miura</surname> <given-names>T</given-names></name>. <article-title>Reaction-Diffusion Model as a Framework for Understanding Biological Pattern Formation</article-title>. <source>Science</source>. <year>2010</year>;<volume>329</volume>(<issue>5999</issue>):<fpage>1616</fpage>–<lpage>1620</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1179047" xlink:type="simple">10.1126/science.1179047</ext-link></comment> <object-id pub-id-type="pmid">20929839</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Novák</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Tyson</surname> <given-names>JJ</given-names></name>. <article-title>Design principles of biochemical oscillators</article-title>. <source>Nature Reviews Molecular Cell Biology</source>. <year>2008</year>;<volume>9</volume>(<issue>12</issue>):<fpage>981</fpage>–<lpage>991</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrm2530" xlink:type="simple">10.1038/nrm2530</ext-link></comment> <object-id pub-id-type="pmid">18971947</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Perkins</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Jaeger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Reinitz</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Glass</surname> <given-names>L</given-names></name>. <article-title>Reverse engineering the gap gene network of Drosophila melanogaster</article-title>. <source>PLoS Computational Biology</source>. <year>2006</year>;<volume>2</volume>(<issue>5</issue>):<fpage>417</fpage>–<lpage>428</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.0020051" xlink:type="simple">10.1371/journal.pcbi.0020051</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Umulis</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Shimmi</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>O’Connor</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Othmer</surname> <given-names>HG</given-names></name>. <article-title>Organism-Scale Modeling of Early Drosophila Patterning via Bone Morphogenetic Proteins</article-title>. <source>Developmental Cell</source>. <year>2010</year>;<volume>18</volume>(<issue>2</issue>):<fpage>260</fpage>–<lpage>274</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.devcel.2010.01.006" xlink:type="simple">10.1016/j.devcel.2010.01.006</ext-link></comment> <object-id pub-id-type="pmid">20159596</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Naldi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Remy</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Thieffry</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Chaouiya</surname> <given-names>C</given-names></name>. <article-title>Dynamically consistent reduction of logical regulatory graphs</article-title>. <source>Theoretical Computer Science</source>. <year>2011</year>;<volume>412</volume>(<issue>21</issue>):<fpage>2207</fpage>–<lpage>2218</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tcs.2010.10.021" xlink:type="simple">10.1016/j.tcs.2010.10.021</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Feliu</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Wiuf</surname> <given-names>C</given-names></name>. <article-title>Simplifying biochemical models with intermediate species</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2013</year>;<volume>10</volume>(<issue>87</issue>):<fpage>20130484</fpage>–<lpage>20130484</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2013.0484" xlink:type="simple">10.1098/rsif.2013.0484</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Okino</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Mavrovouniotis</surname> <given-names>ML</given-names></name>. <article-title>Simplification of Mathematical Models of Chemical Reaction Systems</article-title>. <source>Chemical Reviews</source>. <year>1998</year>;<volume>98</volume>(<issue>2</issue>):<fpage>391</fpage>–<lpage>408</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/cr950223l" xlink:type="simple">10.1021/cr950223l</ext-link></comment> <object-id pub-id-type="pmid">11848905</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gay</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Soliman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fages</surname> <given-names>F</given-names></name>. <article-title>A graphical method for reducing and relating models in systems biology</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>18</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq388" xlink:type="simple">10.1093/bioinformatics/btq388</ext-link></comment> <object-id pub-id-type="pmid">20823324</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sunnaker</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Cedersund</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Jirstrand</surname> <given-names>M</given-names></name>. <article-title>A method for zooming of nonlinear models of biochemical systems</article-title>. <source>BMC systems biology</source>. <year>2011</year>;<volume>5</volume>(<issue>1</issue>):<fpage>140</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-5-140" xlink:type="simple">10.1186/1752-0509-5-140</ext-link></comment> <object-id pub-id-type="pmid">21899762</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cardelli</surname> <given-names>L</given-names></name>. <article-title>Morphisms of reaction networks that couple structure to function</article-title>. <source>BMC Systems Biology</source>. <year>2014</year>;<volume>8</volume>(<issue>1</issue>):<fpage>84</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-8-84" xlink:type="simple">10.1186/1752-0509-8-84</ext-link></comment> <object-id pub-id-type="pmid">25128194</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Alon</surname> <given-names>U</given-names></name>. <article-title>Network motifs: Theory and experimental approaches</article-title>. <source>Nature Reviews Genetics</source>. <year>2007</year>;<volume>8</volume>(<issue>6</issue>):<fpage>450</fpage>–<lpage>461</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg2102" xlink:type="simple">10.1038/nrg2102</ext-link></comment> <object-id pub-id-type="pmid">17510665</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Apri</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>de Gee</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Molenaar</surname> <given-names>J</given-names></name>. <article-title>Complexity reduction preserving dynamical behavior of biochemical networks</article-title>. <source>Journal of Theoretical Biology</source>. <year>2012</year>;<volume>304</volume>:<fpage>16</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2012.03.019" xlink:type="simple">10.1016/j.jtbi.2012.03.019</ext-link></comment> <object-id pub-id-type="pmid">22465110</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mori</surname> <given-names>H</given-names></name>. <article-title>Transport, Collective Motion, and Brownian Motion</article-title>. <source>Progress of Theoretical Physics</source>. <year>1965</year>;<volume>33</volume>(<issue>3</issue>):<fpage>423</fpage>–<lpage>455</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1143/PTP.33.423" xlink:type="simple">10.1143/PTP.33.423</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zwanzig</surname> <given-names>R</given-names></name>. <article-title>Memory effects in irreversible thermodynamics</article-title>. <source>Physical Review</source>. <year>1961</year>;<volume>124</volume>(<issue>4</issue>):<fpage>983</fpage>–<lpage>992</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRev.124.983" xlink:type="simple">10.1103/PhysRev.124.983</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ritort</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sollich</surname> <given-names>P</given-names></name>. <article-title>Glassy dynamics of kinetically constrained models</article-title>. <source>Advances in Physics</source>. <year>2003</year>;<volume>52</volume>(<issue>4</issue>):<fpage>219</fpage>–<lpage>342</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/0001873031000093582" xlink:type="simple">10.1080/0001873031000093582</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rubin</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Lawler</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sollich</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ng</surname> <given-names>T</given-names></name>. <article-title>Memory effects in biochemical networks as the natural counterpart of extrinsic noise</article-title>. <source>Journal of Theoretical Biology</source>. <year>2014</year>;<volume>357</volume>:<fpage>245</fpage>–<lpage>267</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.jtbi.2014.06.002" xlink:type="simple">10.1016/j.jtbi.2014.06.002</ext-link></comment> <object-id pub-id-type="pmid">24928151</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rubin</surname> <given-names>KJ</given-names></name>, <name name-style="western"><surname>Sollich</surname> <given-names>P</given-names></name>. <article-title>Michaelis-Menten dynamics in protein subnetworks</article-title>. <source>Journal of Chemical Physics</source>. <year>2016</year>;<volume>144</volume>(<issue>17</issue>):<fpage>174114</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1063/1.4947478" xlink:type="simple">10.1063/1.4947478</ext-link></comment> <object-id pub-id-type="pmid">27155632</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gotze</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Sjogren</surname> <given-names>L</given-names></name>. <article-title>Relaxation processes in supercooled liquids</article-title>. <source>Reports on Progress in Physics</source>. <year>1992</year>;<volume>55</volume>(<issue>3</issue>):<fpage>241</fpage>–<lpage>376</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/0034-4885/55/3/001" xlink:type="simple">10.1088/0034-4885/55/3/001</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bintu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Buchler</surname> <given-names>NE</given-names></name>, <name name-style="western"><surname>Garcia</surname> <given-names>HG</given-names></name>, <name name-style="western"><surname>Gerland</surname> <given-names>U</given-names></name>, <name name-style="western"><surname>Hwa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kondev</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Transcriptional regulation by the numbers: Models</article-title>. <source>Current Opinion in Genetics and Development</source>. <year>2005</year>;<volume>15</volume>(<issue>2</issue>):<fpage>116</fpage>–<lpage>124</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gde.2005.02.007" xlink:type="simple">10.1016/j.gde.2005.02.007</ext-link></comment> <object-id pub-id-type="pmid">15797194</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Page</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Perez-Carrasco</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Barnes</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Briscoe</surname> <given-names>J</given-names></name>. <article-title>A theoretical framework for the regulation of Shh morphogen-controlled gene expression</article-title>. <source>Development</source>. <year>2014</year>;<volume>141</volume>(<issue>20</issue>):<fpage>3868</fpage>–<lpage>3878</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.112573" xlink:type="simple">10.1242/dev.112573</ext-link></comment> <object-id pub-id-type="pmid">25294939</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shea</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Ackers</surname> <given-names>GK</given-names></name>. <article-title>The OR control system of bacteriophage lambda</article-title>. <source>Journal of Molecular Biology</source>. <year>1985</year>;<volume>181</volume>(<issue>2</issue>):<fpage>211</fpage>–<lpage>230</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0022-2836(85)90086-5" xlink:type="simple">10.1016/0022-2836(85)90086-5</ext-link></comment> <object-id pub-id-type="pmid">3157005</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sherman</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>BA</given-names></name>. <article-title>Thermodynamic state ensemble models of cis-regulation</article-title>. <source>PLoS Computational Biology</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>):<fpage>e1002407</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002407" xlink:type="simple">10.1371/journal.pcbi.1002407</ext-link></comment> <object-id pub-id-type="pmid">22479169</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thomas</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Straube</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>The slow-scale linear noise approximation: an accurate, reduced stochastic description of biochemical networks under timescale separation conditions</article-title>. <source>BMC systems biology</source>. <year>2012</year>;<volume>6</volume>(<issue>ii</issue>):<fpage>39</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1752-0509-6-39" xlink:type="simple">10.1186/1752-0509-6-39</ext-link></comment> <object-id pub-id-type="pmid">22583770</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Schnoerr</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Sanguinetti</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>Approximation and inference methods for stochastic biochemical kinetics—A tutorial review</article-title>. <source>Journal of Physics A: Mathematical and Theoretical</source>. <year>2017</year>;<volume>50</volume>(<issue>9</issue>):<fpage>093001</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1088/1751-8121/aa54d9" xlink:type="simple">10.1088/1751-8121/aa54d9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dessaud</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>McMahon</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Briscoe</surname> <given-names>J</given-names></name>. <article-title>Pattern formation in the vertebrate neural tube: a sonic hedgehog morphogen-regulated transcriptional network</article-title>. <source>Development</source>. <year>2008</year>;<volume>135</volume>(<issue>15</issue>):<fpage>2489</fpage>–<lpage>2503</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1242/dev.009324" xlink:type="simple">10.1242/dev.009324</ext-link></comment> <object-id pub-id-type="pmid">18621990</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cohen</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Briscoe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Blassberg</surname> <given-names>R</given-names></name>. <article-title>Morphogen Interpretation: The Transcriptional Logic Of Neural Tube Patterning</article-title>. <source>Current Opinion in Genetics and Development</source>. <year>2013</year>;<volume>23</volume>(<issue>4</issue>):<fpage>423</fpage>–<lpage>428</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.gde.2013.04.003" xlink:type="simple">10.1016/j.gde.2013.04.003</ext-link></comment> <object-id pub-id-type="pmid">23725799</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Roelink</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Porter</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Chiang</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Tanabe</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>DT</given-names></name>, <name name-style="western"><surname>Beachy</surname> <given-names>PA</given-names></name>, <etal>et al</etal>. <article-title>Floor plate and motor neuron induction by different concentrations of the amino-terminal cleavage product of sonic hedgehog autoproteolysis</article-title>. <source>Cell</source>. <year>1995</year>;<volume>81</volume>(<issue>3</issue>):<fpage>445</fpage>–<lpage>455</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0092-8674(95)90397-6" xlink:type="simple">10.1016/0092-8674(95)90397-6</ext-link></comment> <object-id pub-id-type="pmid">7736596</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Briscoe</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pierani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jessell</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Ericson</surname> <given-names>J</given-names></name>. <article-title>A homeodomain protein code specifies progenitor cell identity and neuronal fate in the ventral neural tube</article-title>. <source>Cell</source>. <year>2000</year>;<volume>101</volume>(<issue>4</issue>):<fpage>435</fpage>–<lpage>445</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0092-8674(00)80853-3" xlink:type="simple">10.1016/S0092-8674(00)80853-3</ext-link></comment> <object-id pub-id-type="pmid">10830170</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Balaskas</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ribeiro</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Panovska</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dessaud</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sasai</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Page</surname> <given-names>KM</given-names></name>, <etal>et al</etal>. <article-title>Gene regulatory logic for reading the sonic hedgehog signaling gradient in the vertebrate neural tube</article-title>. <source>Cell</source>. <year>2012</year>;<volume>148</volume>(<issue>1-2</issue>):<fpage>273</fpage>–<lpage>284</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2011.10.047" xlink:type="simple">10.1016/j.cell.2011.10.047</ext-link></comment> <object-id pub-id-type="pmid">22265416</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhou</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>DJ</given-names></name>. <article-title>The bHLH transcription factors OLIG2 and OLIG1 couple neuronal and glial subtype specification</article-title>. <source>Cell</source>. <year>2002</year>;<volume>109</volume>(<issue>1</issue>):<fpage>61</fpage>–<lpage>73</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0092-8674(02)00677-3" xlink:type="simple">10.1016/S0092-8674(02)00677-3</ext-link></comment> <object-id pub-id-type="pmid">11955447</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kutejova</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sasai</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Shah</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Gouti</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Briscoe</surname> <given-names>J</given-names></name>. <article-title>Neural Progenitors Adopt Specific Identities by Directly Repressing All Alternative Progenitor Transcriptional Programs</article-title>. <source>Developmental Cell</source>. <year>2016</year>;<volume>36</volume>(<issue>6</issue>):<fpage>639</fpage>–<lpage>653</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.devcel.2016.02.013" xlink:type="simple">10.1016/j.devcel.2016.02.013</ext-link></comment> <object-id pub-id-type="pmid">26972603</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Smith</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Grima</surname> <given-names>R</given-names></name>. <article-title>Breakdown of the reaction-diffusion master equation with nonelementary rates</article-title>. <source>Physical Review E</source>. <year>2016</year>;<volume>93</volume>(<issue>5</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevE.93.052135" xlink:type="simple">10.1103/PhysRevE.93.052135</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Garcia</surname> <given-names>HG</given-names></name>, <name name-style="western"><surname>Sanchez</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kuhlman</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Kondev</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Phillips</surname> <given-names>R</given-names></name>. <article-title>Transcription by the numbers redux: Experiments and calculations that surprise</article-title>. <source>Trends in Cell Biology</source>. <year>2010</year>;<volume>20</volume>(<issue>12</issue>):<fpage>723</fpage>–<lpage>733</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tcb.2010.07.002" xlink:type="simple">10.1016/j.tcb.2010.07.002</ext-link></comment> <object-id pub-id-type="pmid">20801657</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref038">
<label>38</label>
<mixed-citation publication-type="other" xlink:type="simple">Zwanzig, R. Systems Far from Equilibrium. vol. 132 of Lecture Notes in Physics. Garrido L, editor. Berlin, Heidelberg: Springer; 1980. Available from: <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/10.1007/BFb0025609" xlink:type="simple">http://link.springer.com/10.1007/BFb0025609</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006003.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chorin</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Hald</surname> <given-names>OH</given-names></name>, <name name-style="western"><surname>Kupferman</surname> <given-names>R</given-names></name>. <article-title>Optimal prediction and the Mori-Zwanzig representation of irreversible processes</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2000</year>;<volume>97</volume>(<issue>7</issue>):<fpage>2968</fpage>–<lpage>2973</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.97.7.2968" xlink:type="simple">10.1073/pnas.97.7.2968</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006003.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Zwanzig</surname> <given-names>R</given-names></name>. <source>Nonequilibrium Statistical Mechanics</source>. <publisher-name>Oxford University Press</publisher-name>; <year>2001</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://books.google.co.uk/books?id=4cI5136OdoMC" xlink:type="simple">https://books.google.co.uk/books?id=4cI5136OdoMC</ext-link>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>