<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" article-type="research-article" dtd-version="3.0" xml:lang="en">
  <front>
    <journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
        <publisher-name>Public Library of Science</publisher-name>
        <publisher-loc>San Francisco, USA</publisher-loc>
      </publisher></journal-meta>
    <article-meta><article-id pub-id-type="publisher-id">PCOMPBIOL-D-12-00495</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1002699</article-id><article-categories>
        <subj-group subj-group-type="heading">
          <subject>Research Article</subject>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Medicine</subject>
          <subj-group>
            <subject>Epidemiology</subject>
            <subj-group>
              <subject>Infectious disease epidemiology</subject>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline-v2">
          <subject>Social and behavioral sciences</subject>
          <subj-group>
            <subject>Geography</subject>
            <subj-group>
              <subject>Human geography</subject>
              <subj-group>
                <subject>Distance-decay models</subject>
              </subj-group>
            </subj-group>
          </subj-group>
        </subj-group>
        <subj-group subj-group-type="Discipline">
          <subject>Public Health and Epidemiology</subject>
        </subj-group>
      </article-categories><title-group><article-title>Evaluating the Adequacy of Gravity Models as a Description of Human Mobility for Epidemic Modelling</article-title><alt-title alt-title-type="running-head">Evaluating Gravity Models for Epidemic Modelling</alt-title></title-group><contrib-group>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Truscott</surname>
            <given-names>James</given-names>
          </name>
          <xref ref-type="aff" rid="aff1"/>
          <xref ref-type="corresp" rid="cor1">
            <sup>*</sup>
          </xref>
        </contrib>
        <contrib contrib-type="author" xlink:type="simple">
          <name name-style="western">
            <surname>Ferguson</surname>
            <given-names>Neil M.</given-names>
          </name>
        </contrib>
      </contrib-group><aff id="aff1">
        <addr-line>MRC Centre for Outbreak Analysis and Modelling, Imperial College London, London, United Kingdom</addr-line>
      </aff><contrib-group>
        <contrib contrib-type="editor" xlink:type="simple">
          <name name-style="western">
            <surname>Pascual</surname>
            <given-names>Mercedes</given-names>
          </name>
          <role>Editor</role>
          <xref ref-type="aff" rid="edit1"/>
        </contrib>
      </contrib-group><aff id="edit1">
        <addr-line>University of Michigan and Howard Hughes Med. Inst., United States of America</addr-line>
      </aff><author-notes>
        <corresp id="cor1">* E-mail: <email xlink:type="simple">j.truscott@imperial.ac.uk</email></corresp>
        <fn fn-type="conflict">
          <p>The authors have declared that no competing interests exist.</p>
        </fn>
        <fn fn-type="con">
          <p>Conceived and designed the experiments: JT NMF. Performed the experiments: JT. Analyzed the data: JT. Wrote the paper: JT NMF.</p>
        </fn>
      </author-notes><pub-date pub-type="collection">
        <month>10</month>
        <year>2012</year>
      </pub-date><pub-date pub-type="epub">
        <day>18</day>
        <month>10</month>
        <year>2012</year>
      </pub-date><volume>8</volume><issue>10</issue><elocation-id>e1002699</elocation-id><history>
        <date date-type="received">
          <day>27</day>
          <month>3</month>
          <year>2012</year>
        </date>
        <date date-type="accepted">
          <day>8</day>
          <month>8</month>
          <year>2012</year>
        </date>
      </history><permissions>
        
        <copyright-holder>Truscott, Ferguson</copyright-holder>
        <license xlink:type="simple">
          <license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
        </license>
      </permissions><abstract>
        <p>Gravity models have a long history of use in describing and forecasting the movements of people as well as goods and services, making them a natural basis for disease transmission rates over distance. In agent-based micro-simulations, gravity models can be directly used to represent movement of individuals and hence disease. In this paper, we consider a range of gravity models as fits to movement data from the UK and the US. We examine the ability of synthetic networks generated from fitted models to match those from the data in terms of epidemic behaviour; in particular, times to first infection. For both datasets, best fits are obtained with a two-piece ‘matched’ power law distance distribution. Epidemics on synthetic UK networks match well those on data networks across all but the smallest nodes for a range of aggregation levels. We derive an expression for time to infection between nodes in terms of epidemiological and network parameters which illuminates the influence of network clustering in spread across networks and suggests an approximate relationship between the log-likelihood deviance of model fit and the match times to infection between synthetic and data networks. On synthetic US networks, the match in epidemic behaviour is initially poor and sensitive to the initially infected node. Analysis of times to infection indicates a failure of models to capture infrequent long-range contact between large nodes. An assortative model based on node population size captures this heterogeneity, considerably improving the epidemiological match between synthetic and data networks.</p>
      </abstract><abstract abstract-type="summary">
        <title>Author Summary</title>
        <p>An accurate representation of disease transmission between spatially-distinct regions is an essential part of modelling epidemic behaviour on a national or international scale. Gravity models, which describe movement fluxes between regions in terms of their populations and distance from each other, have a history of successful use in the geography and economics and are increasingly used in epidemiology. We look at the ability of a range of gravity models to fit human movement data from the UK and the US. In particular, we compare the behaviour of a simple flu-like epidemic model on synthetic networks generated by fitted gravity models and on the original network present in the data, using time to first infection. For UK data, epidemic behaviour on synthetic networks matches that on the original data quite closely. For US movement data, synthetic networks perform much worse. We develop an analytic expression for infection time between two regions which indicates that our gravity models fail to capture long range connections between large populations. A model with assortative mixing based on population size greatly improves the match between synthetic and data networks.</p>
      </abstract><funding-group>
        <funding-statement>This work has been supported by European Union FP7 grants FLUMODCONT and EMPIRIE. [<ext-link ext-link-type="uri" xlink:href="http://www.ukcds.org.uk/page-EU_Research-8.html" xlink:type="simple">http://www.ukcds.org.uk/page-EU_Research-8.html</ext-link>]. Also by the National Institute of General Medical Sciences MIDAS funding program [<ext-link ext-link-type="uri" xlink:href="http://www.nigms.nih.gov/Research/FeaturedPrograms/MIDAS/" xlink:type="simple">http://www.nigms.nih.gov/Research/FeaturedPrograms/MIDAS/</ext-link>] and the MRC Outbreak Centre [<ext-link ext-link-type="uri" xlink:href="http://www1.imperial.ac.uk/medicine/about/institutes/outbreaks/" xlink:type="simple">http://www1.imperial.ac.uk/medicine/about/institutes/outbreaks/</ext-link>]. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
      </funding-group><counts>
        <page-count count="12"/>
      </counts></article-meta>
  </front>
  <body>
    <sec id="s1">
      <title>Introduction</title>
      <p>Gravity models of population movement characterize the distribution of trips between discrete locations, based on the populations of the origin and destination and the distance between them. The use of gravity models to describe movement between population centres can be traced back at least as far as the work of Zipf in the 1940's <xref ref-type="bibr" rid="pcbi.1002699-Zipf1">[1]</xref>. In this work, Zipf provides a theoretical motivation for movement between cities 1 and 2 being governed by a <italic>P<sub>1</sub>P<sub>2</sub>/d</italic> relationship, where <italic>P</italic> is the respective city population and <italic>d</italic> is separation distance. He also identifies this relationship in passenger and freight movements between US cities <xref ref-type="bibr" rid="pcbi.1002699-Zipf1">[1]</xref>. Until recently, the main areas of application for gravity models has been in analyzing and forecasting the demand for goods and services in spatially distributed populations <xref ref-type="bibr" rid="pcbi.1002699-Haynes1">[2]</xref>. Consequently, much of the theoretical work has focused on the modeling of journey costs and discrete choice models <xref ref-type="bibr" rid="pcbi.1002699-Ortuzar1">[3]</xref>.</p>
      <p>More recently, gravity models have been adapted to describe the spread of a range of biological agents, such as invasive species <xref ref-type="bibr" rid="pcbi.1002699-Schneider1">[4]</xref> and plant pathogens <xref ref-type="bibr" rid="pcbi.1002699-Ferrari1">[5]</xref>. Of particular interest in the context of this paper is their use as a description of infectious disease transmission between regions. As a description of movement between spatially distinct populations, gravity models offer a simple model of disease transmission strength between meta-populations. Xia et al. model the dynamics of pre-vaccination measles as city meta populations connected by a gravity-based movement of infectious individuals <xref ref-type="bibr" rid="pcbi.1002699-Xia1">[6]</xref>. The model succeeds in capturing most of the spatiotemporal properties of epidemics, including case rates, periodicity and fade-out behaviour. A similarly structured model was applied to seasonal influenza data in the US by Viboud et al. <xref ref-type="bibr" rid="pcbi.1002699-Viboud1">[7]</xref>. In this case, it was found that fitting the underlying gravity model to commuting data successfully captured the observed synchrony in epidemics as a function of distance, population size and transmission. Gravity models are now increasingly used in both metapopulation- and individual-based epidemic micro-simulations <xref ref-type="bibr" rid="pcbi.1002699-CiofidegliAtti1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1002699-Merler2">[11]</xref>.</p>
      <p>The aim of this paper is to look at the ability of gravity models to represent commuter movement data in the UK and US to the fidelity needed to capture expected patterns of epidemic spread. We examine which models best capture the statistical properties of the data and what aspects are poorly represented. We address how the choice of level of spatial aggregation influences the fit of models. Most importantly, we examine the behaviour of a simple SIR epidemic on synthetic networks reconstructed from fitted gravity models and ask how epidemic behaviour depends on the underlying model and on the level of aggregation.</p>
    </sec>
    <sec id="s2" sec-type="materials|methods">
      <title>Materials and Methods</title>
      <sec id="s2a">
        <title>UK commuting data</title>
        <p>The UK population and commuting data is taken from the 1991 census. The data set combines information for England and Wales collected by the Office for National Statistics and Scottish data from the General Register Office for Scotland <xref ref-type="bibr" rid="pcbi.1002699-Anon1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1002699-Anon2">[13]</xref>. The smallest region of aggregation of data available is the Census Area Statistics Ward, corresponding to the electoral wards which define the basic political and administrative geographical units in the UK. We look at the fit of models at three different levels of aggregation, featuring wards, district and counties as the basic regions. We concentrate on the district level, as districts correspond well with individual cities and are comparable in many ways to counties in the US data-set.</p>
        <p>Information on commuting patterns comes from the associated Special Workplace Statistics for both Scotland and England and Wales. The data sets comprise the responses from a randomly chosen 10% of the surveyed population who were asked for the location of their place of work and their means of transport for commuting. From this can be constructed the flow of commuters between any two pairs of wards (in this paper we aggregate across modes of transport to recover the total flow).</p>
        <p>The models we fit to the data are functions of the destination work population, so we exclude the small fraction of wards (1%) that have no commuter population. For the remaining wards, our data set consists of a population of wards with resident population and location (as northing and easting) and a set of commuting sub-populations between pairs of wards. This data set can easily be spatially aggregated to the district of county level.</p>
        <p>We have chosen to use the 1991 census data as opposed to the more recent 2001 set, which entails two potential drawbacks. Firstly the data is a decade older, but more importantly only 10% of commuting data was obtained in 1991. Use of the 2001 data is problematical, however, due to disclosure control methods introduced in that year. The so-called ‘small cell adjustment method’ (SCAM) involves the adjustment of small cell counts (1 or 2) in the data to either 0 or 3 (precise details of the algorithm have not been released). Stillwell and Duke-Williams discuss some of the consequences arising from SCAM <xref ref-type="bibr" rid="pcbi.1002699-Stillwell1">[14]</xref>. Among those relevant to the current work are that small commuter counts are more likely at longer distances and these are particularly important for fitting the power-law distributions used in our models and also that small numbers of individuals may still trigger disproportionately large local epidemics. A further issue is that SCAM is not applied to movements with origins in Scotland and is hence spatially inhomogeneous.</p>
      </sec>
      <sec id="s2b">
        <title>US commuting data</title>
        <p>US population and commuting data is taken from the US Census in 2000. The data is available from the US Census Bureau web-site <xref ref-type="bibr" rid="pcbi.1002699-Anon3">[15]</xref>. With regard to working habits, the census asks participants to identify the location of the place they worked at most frequently in the previous week. Hence we might expect the resulting data to contain more irregular and long-distance journeys than the UK data. Commuting data for 2000 at the county level was retrieved from the site along with populations and geographical centroid location for each county. We consider only counties from the 48 contiguous states and exclude all movements to US territories. The mean population of the included counties is approximately 90,000 residents.</p>
      </sec>
      <sec id="s2c">
        <title>Movement models</title>
        <p>We look at movement models that calculate the probability, <italic>p<sub>ij</sub></italic>, of a journey from node <italic>i</italic> to node <italic>j</italic><disp-formula id="pcbi.1002699.e001"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e001" xlink:type="simple"/><label>(1)</label></disp-formula>where <italic>P<sub>i</sub></italic> is the resident population, <italic>C<sub>i</sub></italic> is the population who work in node <italic>i</italic> (regardless of where they live) and <italic>θ</italic> is a vector of parameters. The function <italic>f(d)</italic> is a distance kernel which encapsulates the effect of separation on the probability of a journey between two locations. We normalize to impose the constraint <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e002" xlink:type="simple"/></inline-formula>.</p>
        <p>As well as this ‘unconstrained’ model, we consider a ‘constrained’ model which assumes that the probability of a journey emanating from node <italic>i</italic> (including those within node <italic>i</italic>), <italic>q<sub>i</sub></italic>, is matched to that in the data. That is,<disp-formula id="pcbi.1002699.e003"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e003" xlink:type="simple"/></disp-formula>where <italic>T<sub>ij</sub></italic> is the flow from node <italic>i</italic> to <italic>j</italic> and <italic>T<sub>tot</sub></italic> is the total number of journeys in the data. We then express the probability of a particular journey in a conditional form, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e004" xlink:type="simple"/></inline-formula>, where<disp-formula id="pcbi.1002699.e005"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e005" xlink:type="simple"/><label>(2)</label></disp-formula>By setting parameters to zero, we can examine a range of sub-models. We look at models of distance interaction of two forms, smooth kernel (SK),<disp-formula id="pcbi.1002699.e006"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e006" xlink:type="simple"/></disp-formula>and a two-piece ‘matched’ kernel (MK),<disp-formula id="pcbi.1002699.e007"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e007" xlink:type="simple"/></disp-formula>where <italic>π</italic> is a point probability mass for commuting within the node of residence (<italic>d</italic> = 0), <italic>α</italic> is a distance scale below which the kernel function saturates, and <italic>γ</italic>, <italic>γ<sub>2</sub></italic> are power parameters. Here <italic>A</italic> is a function of the other parameters such that <italic>f</italic>(<italic>d</italic>) is continuous at <italic>d<sub>c</sub></italic>.</p>
        <p>These models are fitted to the movement data by constructing a likelihood function for the data and maximizing using standard MCMC techniques. We use a multinomial likelihood for the distribution of journeys among nodes<disp-formula id="pcbi.1002699.e008"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e008" xlink:type="simple"/></disp-formula>Discarding terms independent of the movement model gives a log-likelihood of<disp-formula id="pcbi.1002699.e009"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e009" xlink:type="simple"/><label>(3)</label></disp-formula>In the case of the locally-constrained model, the log-likelihood can be split into two terms<disp-formula id="pcbi.1002699.e010"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e010" xlink:type="simple"/><label>(4)</label></disp-formula>If the set of <italic>q<sub>i</sub></italic> are considered as <italic>N</italic> additional independent parameters, it is easy to show that local constraints correspond to the maximization of the likelihood with respect to <italic>q<sub>i</sub></italic>, allowing a direct comparison of the two model types.</p>
        <p>The raw commuting data can be represented as a weighted graph, the nodes of which are the locations represented in the data. Edge weight is then just the number of reported journeys between two nodes. One can then simulate an epidemic occurring on this data-derived network. An equivalent interpretation is that of a metapopulation, where the patches are the locations in the data and the origin-destination flow matrix is used to construct the patch-to-patch coupling matrix. Similarly, we can construct synthetic networks from the fitted movement models and compare the dynamics of epidemics on those networks with the dynamics of epidemics on the data-derived network.</p>
      </sec>
      <sec id="s2d">
        <title>Epidemic model</title>
        <p>In order to make these comparisons, we employ a simple stochastic SIR (susceptible-infected-recovered) model such as might be used to describe the spread of influenza. A connection from node <italic>i</italic> to node <italic>j</italic> consists of a population, <italic>N<sub>ij</sub></italic>, resident in <italic>i</italic> and working in <italic>j</italic>. To simplify the model, we assume that all residents of a node are working (in reality, approximately 40% of the resident population travels to work). Of this population, <italic>S<sub>ij</sub></italic>(<italic>t</italic>) and <italic>I<sub>ij</sub></italic>(<italic>t</italic>) are the number of individuals who are susceptible and infected at time <italic>t</italic>, respectively. The susceptible population is subject to forces of infection from the node within which they reside, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e011" xlink:type="simple"/></inline-formula>, and the one at which they work, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e012" xlink:type="simple"/></inline-formula>. Both the working and resident populations are assumed to be well mixed and hence the forces of infection are given by<disp-formula id="pcbi.1002699.e013"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e013" xlink:type="simple"/></disp-formula>Infected individuals recover into a removed class at a rate σ. Hence in a naïve population, R<sub>0</sub> = (<italic>β<sub>h</sub>+β<sub>w</sub></italic>)/<italic>σ</italic>, neglecting local saturation effects. Unless otherwise stated, we use the following parameter values: <italic>β<sub>h</sub></italic> = 0.5/d, <italic>β<sub>w</sub></italic> = 0.4/d and <italic>σ</italic> = 0.5/d, giving a generation time of 2 days and an R<sub>0</sub> of 1.8.</p>
        <p>Comparison of the behaviour of the epidemic model on different networks is based on the times to first infection for network nodes from a given initial infection site. Under certain simplifying assumptions, an approximation for the mean time to infection between two nodes can be calculated for the above epidemiological model.<disp-formula id="pcbi.1002699.e014"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e014" xlink:type="simple"/><label>(5)</label></disp-formula>The parameters <italic>Λ<sub>1,2</sub></italic> and ς<italic><sub>1,2</sub></italic> represent network properties, such as the fraction of journeys between the two nodes. r = <italic>β<sub>h</sub></italic>+<italic>β<sub>w</sub></italic>+<italic>σ</italic> is the epidemic growth rate in a large node. The equation illustrates how epidemiological effects combine with network properties to determine the speed of infection across a connection. The details of the analysis and the definitions of the parameters can be found in the Supplementary Information <xref ref-type="supplementary-material" rid="pcbi.1002699.s001">Text S1</xref>.</p>
      </sec>
    </sec>
    <sec id="s3">
      <title>Results</title>
      <sec id="s3a">
        <title>UK fits</title>
        <p><xref ref-type="table" rid="pcbi-1002699-t001">Table 1</xref> shows the maximum likelihood values and associated parameter estimators for a range of models at the district level of aggregation in the UK. The biggest influence on log-likelihood is whether local constraints are imposed. For a given kernel type, a locally constrained model has a greater log-likelihood by a margin of approximately 230,000. The locally constrained model effectively has an extra parameter for each node (the number of workers living there). Model comparison statistics (such as the Akaike information Criterion) offset the number of model parameters against the log likelihood, but these 456 additional degrees of freedom are clearly insufficient to account for the increase in likelihood. We have omitted further discussion of models which include an exponent on the destination population, <italic>τ<sub>d</sub></italic>. The improvement in likelihood over a model with only commuter population dependence is minimal (∼2500) and not discernible in the statistics of flow distributions or behaviour of the epidemiological model.</p>
        <table-wrap id="pcbi-1002699-t001" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.t001</object-id><label>Table 1</label><caption>
            <title>Maximum likelihood parameter estimates for different models to UK commuting data at the district level of aggregation and for the MK, locally constrained model across different levels of aggregation.</title>
          </caption><alternatives>
            <graphic id="pcbi-1002699-t001-1" mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.t001" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" colspan="9" rowspan="1">Models at district level aggregation</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">Model</td>
                  <td align="left" colspan="1" rowspan="1">τ<sub>o</sub></td>
                  <td align="left" colspan="1" rowspan="1">τ<sub>c</sub></td>
                  <td align="left" colspan="1" rowspan="1">γ</td>
                  <td align="left" colspan="1" rowspan="1">α (km)</td>
                  <td align="left" colspan="1" rowspan="1">π</td>
                  <td align="left" colspan="1" rowspan="1">γ<sub>2</sub></td>
                  <td align="left" colspan="1" rowspan="1"><italic>d</italic><sub>c</sub> (km)</td>
                  <td align="left" colspan="1" rowspan="1">Δ<italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e001" xlink:type="simple"/></inline-formula></italic></td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">MK, constrained</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0.95</td>
                  <td align="left" colspan="1" rowspan="1">6.6</td>
                  <td align="left" colspan="1" rowspan="1">35</td>
                  <td align="left" colspan="1" rowspan="1">1.3</td>
                  <td align="left" colspan="1" rowspan="1">1.53</td>
                  <td align="left" colspan="1" rowspan="1">87</td>
                  <td align="left" colspan="1" rowspan="1">−267138</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">SK, constrained</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0.95</td>
                  <td align="left" colspan="1" rowspan="1">3.9</td>
                  <td align="left" colspan="1" rowspan="1">13.5</td>
                  <td align="left" colspan="1" rowspan="1">0.79</td>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">−283505</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">MK, unconstrained</td>
                  <td align="left" colspan="1" rowspan="1">0.23</td>
                  <td align="left" colspan="1" rowspan="1">0.72</td>
                  <td align="left" colspan="1" rowspan="1">17.4</td>
                  <td align="left" colspan="1" rowspan="1">158</td>
                  <td align="left" colspan="1" rowspan="1">4.1</td>
                  <td align="left" colspan="1" rowspan="1">1.79</td>
                  <td align="left" colspan="1" rowspan="1">70</td>
                  <td align="left" colspan="1" rowspan="1">−496648</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">SK, unconstrained</td>
                  <td align="left" colspan="1" rowspan="1">0.23</td>
                  <td align="left" colspan="1" rowspan="1">0.71</td>
                  <td align="left" colspan="1" rowspan="1">4.1</td>
                  <td align="left" colspan="1" rowspan="1">22</td>
                  <td align="left" colspan="1" rowspan="1">2.65</td>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">−516385</td>
                </tr>
                <tr>
                  <td align="left" colspan="9" rowspan="1">Best fit model at different aggregation levels</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">County</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0.89</td>
                  <td align="left" colspan="1" rowspan="1">19</td>
                  <td align="left" colspan="1" rowspan="1">304</td>
                  <td align="left" colspan="1" rowspan="1">2.4</td>
                  <td align="left" colspan="1" rowspan="1">1.24</td>
                  <td align="left" colspan="1" rowspan="1">130</td>
                  <td align="left" colspan="1" rowspan="1">−86286</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">District</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0.95</td>
                  <td align="left" colspan="1" rowspan="1">6.6</td>
                  <td align="left" colspan="1" rowspan="1">35</td>
                  <td align="left" colspan="1" rowspan="1">1.3</td>
                  <td align="left" colspan="1" rowspan="1">1.53</td>
                  <td align="left" colspan="1" rowspan="1">87</td>
                  <td align="left" colspan="1" rowspan="1">−267138</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">Ward</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0.98</td>
                  <td align="left" colspan="1" rowspan="1">4.1</td>
                  <td align="left" colspan="1" rowspan="1">8.5</td>
                  <td align="left" colspan="1" rowspan="1">1.13</td>
                  <td align="left" colspan="1" rowspan="1">1.84</td>
                  <td align="left" colspan="1" rowspan="1">87</td>
                  <td align="left" colspan="1" rowspan="1">−1499291</td>
                </tr>
              </tbody>
            </table>
          </alternatives><table-wrap-foot>
            <fn id="nt101">
              <label/>
              <p>Log likelihood values quoted relative to that of the saturated model. Saturated model log likelihood = −9087628 (county), −14941875 (district), −24483851 (ward).</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>A smaller difference arises between models with a smooth offset power law kernel (SK) and those with a matched two-section kernel (MK - see the Models section). For a given constraint type, use the MK model improves maximum likelihood by approximately 20,000 for the addition of two new parameters; a critical distance, <italic>d</italic><sub>c</sub>, beyond which an outer power, <italic>γ<sub>2</sub></italic>, is used. In general, credible intervals for parameters are typically less than 0.5% of their maximum likelihood estimates. Intervals for π and <italic>γ<sub>2</sub></italic> are slightly wider at around 1.5%, reflecting the smaller amount of data to estimate them Such narrow intervals reflect the large amount of data used in the fitting, rather than sensitivity in any of the observable statistics of the fitted model.</p>
        <p>Across different levels of aggregation, the MK, locally constrained model consistently gives the best fit. Parameter values generally change monotonically as the aggregation unit is made smaller. In particular, note the trend in commuter population power, <italic>τ<sub>c</sub></italic>, and the point mass, π, which both approach 1 as the size of the aggregation unit approaches 1, a feature we address in the discussion. The wide range of powers and scaling parameters for the inner kernel can be understood in the context of the limiting behaviour of the offset power law. For large γ, the offset power function converges to an exponential distribution.<disp-formula id="pcbi.1002699.e015"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e015" xlink:type="simple"/></disp-formula>where <italic>s</italic> = <italic>α/γ</italic>. Given the magnitude of the estimates of <italic>γ</italic> for the MK model, the ratio s is perhaps a better estimate than <italic>α</italic> of the spatial scale of the inner kernel. Its size is comparable to that of a typical node at each level of aggregation.</p>
        <p><xref ref-type="fig" rid="pcbi-1002699-g001">Figure 1</xref> illustrates the source of the differences in likelihoods. From the point of view of the two part likelihood expressed in <xref ref-type="disp-formula" rid="pcbi.1002699.e010">equation 4</xref>, the globally-constrained model needs to fit the total outflow from each node as well as the relative probabilities of journeys starting from each node. As shown in <xref ref-type="fig" rid="pcbi-1002699-g001">Figure 1A</xref>, the model generally underestimates the number of travelling workers in a node.</p>
        <fig id="pcbi-1002699-g001" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.g001</object-id>
          <label>Figure 1</label>
          <caption>
            <title>A) Comparison of observed node outflows with those generated by the globally-constrained MK model.</title>
            <p>B) Distance distribution of synthetic connections generated by SK and MK locally constrained models.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.g001" xlink:type="simple"/>
        </fig>
        <p><xref ref-type="fig" rid="pcbi-1002699-g001">Figure 1B</xref> shows the distance distribution among connections in the SK and MK constrained models in comparison to that found in the data. The distribution from the movement data has a clear ‘kink’ at approximately 150 km, beyond which journeys are more common than would be expected under a pure power-law distribution. Only 1% of journeys are longer than 225 km, with 90% being less than 42 km. As a result, shorter journeys dominate the likelihood and introduce a strong bias in the longer journeys for the SK model.</p>
        <p><xref ref-type="fig" rid="pcbi-1002699-g002">Figure 2</xref> compares the behaviour of epidemics on synthetic networks derived from these model fits with epidemic dynamics on the network constructed using the data. Times to first infection for each node are shown, calculated as the mean time (over 100 realisations) to the first infection of a resident of the node. <xref ref-type="fig" rid="pcbi-1002699-g002">Figure 2A and B</xref> show the results for the MK model for epidemics started in Camden, London, at the district and county level of aggregation. The fit is quite accurate across all nodes for both aggregations, with a root mean square error of 1.6 and 1.9 days for the district and county levels respectively. In contrast, the use of the SK model has a pronounced and characteristic effect on the progress of an epidemic (<xref ref-type="fig" rid="pcbi-1002699-g002">Figure 2C</xref>). Times to infection match well up to approximately 15 days, at which point the infection of subsequent nodes is delayed by up to 2 weeks. This is because the SK model underestimates the degree of contact over longer distances. <xref ref-type="fig" rid="pcbi-1002699-g002">Figure 2C</xref> therefore indicates that the later infected nodes are infected across long distances, from some of the initially infected nodes, rather than along longer chains of short range transmissions. The good agreement of times to infection between the data and synthetic networks is generally maintained across different initial nodes. The exception is for initial nodes with very small populations. In these cases, the times to infection for other nodes is uniformly faster for the MK modelled network than the data network (see <xref ref-type="fig" rid="pcbi-1002699-g002">Figure 2D</xref>). The faster transmission from the smallest nodes is matched by the faster transmission to the smallest nodes (points under the line with times&gt;20 days in <xref ref-type="fig" rid="pcbi-1002699-g002">Figure 2A and B</xref>) and appears to be a general feature of these models.</p>
        <fig id="pcbi-1002699-g002" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.g002</object-id>
          <label>Figure 2</label>
          <caption>
            <title>Times to infection for locally constrained MK model at A) district level and B) county level from initial seeding in Camden.</title>
            <p>C) Times to infection for smooth kernel model and data network against distance from seeding event. D) Matched kernel model times from least populous node in UK (Stewarty).</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.g002" xlink:type="simple"/>
        </fig>
        <p><xref ref-type="fig" rid="pcbi-1002699-g003">Figure 3A</xref> shows times to infection on the data network against log node population. The shape and gradient of the main diagonal band is common to all seeding points, indicating a strong linear relationship between time to infection across the network and the log population of a node. For seeding in London, a second initial band of similar gradient can be seen for times less than 10 days, representing spread from the initial seeding through the Home Counties by London commuters.</p>
        <fig id="pcbi-1002699-g003" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.g003</object-id>
          <label>Figure 3</label>
          <caption>
            <title>Estimates of time to infection from theory.</title>
            <p>A) Time to infection against log resident population on the data network (initial seeding: Camden). B) Theoretical against simulated times to infection across whole network at county scale as predicted by quickest path (seeding: West Midlands). C) As B) but at District level (initial seeding: Birmingham). D) Sensitivity of time to infection to value or r (default r<sub>0</sub> = 0.4) initial seeding: Birmingham.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.g003" xlink:type="simple"/>
        </fig>
        <p>The analytical approximation for the time to infection of an epidemic process on a travel network (developed in Supplementary information <xref ref-type="supplementary-material" rid="pcbi.1002699.s001">text, S1</xref>) is able to shed greater light onto the influence of epidemiological processes and network structure on the behaviour of the epidemic. In general, times to infection for a particular node will depend not only on the epidemiological parameters and the movement fluxes to and from that node, but also on the structure of the travel network as a whole. Times to infection will depend on the structure in two main ways. Firstly, through how direct a route exists between two nodes and secondly on the degree of clustering. Clustering potentially allows each node to be subject to more than one force of infection from different connected nodes.</p>
        <p>In order to investigate the importance of clustering (i.e. multiple competing sources of infection), we can construct a distance matrix between nodes with elements given by the transmission times predicted by <xref ref-type="disp-formula" rid="pcbi.1002699.e014">equation 5</xref>, which implicitly assumes only a single source of infection for each node. A measure of distance between 2 points in the network is then the shortest path between those points given by the distance matrix (shortest distances can be calculated using the Floyd-Warshall algorithm <xref ref-type="bibr" rid="pcbi.1002699-Cormen1">[16]</xref>). <xref ref-type="fig" rid="pcbi-1002699-g003">Figure 3B and C</xref> compares times to infection estimated using this shortest path algorithm applied using the data network with those generated by simulating an epidemic on the same network, at the county and district level of aggregation respectively. At the county level, the agreement with theory is fairly good, suggesting that, in general, the force of infection experienced by a given node is dominated by a single infected contact and that clustering plays only a minor role. For district aggregation, agreement is good for the first 15 days, after which the theoretical predictions for many nodes are late by 7–10 days. This suggests clustering of connections is accelerating transmission, almost certainly through large conurbations. We discuss this effect in detail in the final section.</p>
        <p><xref ref-type="fig" rid="pcbi-1002699-g003">Figure 3D</xref> illustrates the sensitivity of times to infection to variation in the epidemiological parameters. As discussed in SI <xref ref-type="supplementary-material" rid="pcbi.1002699.s001">Text S1</xref>, theory predicts that times to infection should scale proportionally with changes in the parameter grouping <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e016" xlink:type="simple"/></inline-formula>. This effect can be clearly seen in <xref ref-type="fig" rid="pcbi-1002699-g003">Figure 3D</xref> in which times to infection for different values or <italic>r</italic> are plotted against those for the default value, <italic>r<sub>0</sub></italic>. The gradient of lines in <xref ref-type="fig" rid="pcbi-1002699-g003">Figure 3D</xref> should be well approximated by<disp-formula id="pcbi.1002699.e017"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e017" xlink:type="simple"/></disp-formula>And this is the case over a range of values of <italic>β<sub>h</sub></italic>, <italic>β<sub>w</sub></italic> and <italic>σ</italic> (R<sup>2</sup>&gt;90%).</p>
      </sec>
      <sec id="s3b">
        <title>US fits</title>
        <p><xref ref-type="table" rid="pcbi-1002699-t002">Table 2</xref> shows the best fit parameters for a range of models to the US movement data. The order of goodness of fit is the same as that for the UK data set. Credible intervals are generally smaller than for the UK data set (&lt;0.5% for all parameter values), reflecting the larger dataset from which they are inferred. Type of constraint is again the dominant effect with a difference in log-likelihood that cannot be accounted for by the extra effective degrees of freedom (3109 nodes in this case). There is a clear secondary effect from allowing the distance kernel to be of two sections which suggests that the distance distribution of connections may have a ‘kink’ in it similar to the UK case.</p>
        <table-wrap id="pcbi-1002699-t002" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.t002</object-id><label>Table 2</label><caption>
            <title>Best fits for various models to US data at the county level of aggregation and the best fit for the MK model at the state level.</title>
          </caption><alternatives>
            <graphic id="pcbi-1002699-t002-2" mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.t002" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <thead>
                <tr>
                  <td align="left" colspan="1" rowspan="1">Model</td>
                  <td align="left" colspan="1" rowspan="1">τ<sub>o</sub></td>
                  <td align="left" colspan="1" rowspan="1">τ<sub>c</sub></td>
                  <td align="left" colspan="1" rowspan="1">γ</td>
                  <td align="left" colspan="1" rowspan="1">α (km)</td>
                  <td align="left" colspan="1" rowspan="1">π</td>
                  <td align="left" colspan="1" rowspan="1">γ<sub>2</sub></td>
                  <td align="left" colspan="1" rowspan="1"><italic>d</italic><sub>c</sub> (km)</td>
                  <td align="left" colspan="1" rowspan="1">Δ<italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e002" xlink:type="simple"/></inline-formula></italic></td>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">MK, constrained</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0.82</td>
                  <td align="left" colspan="1" rowspan="1">20.3</td>
                  <td align="left" colspan="1" rowspan="1">293</td>
                  <td align="left" colspan="1" rowspan="1">1.19</td>
                  <td align="left" colspan="1" rowspan="1">1.8</td>
                  <td align="left" colspan="1" rowspan="1">155</td>
                  <td align="left" colspan="1" rowspan="1">−13496740</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">SK, constrained</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0.81</td>
                  <td align="left" colspan="1" rowspan="1">4.17</td>
                  <td align="left" colspan="1" rowspan="1">25.7</td>
                  <td align="left" colspan="1" rowspan="1">0.39</td>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">−15797154</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">MK, unconstrained</td>
                  <td align="left" colspan="1" rowspan="1">0.31</td>
                  <td align="left" colspan="1" rowspan="1">0.74</td>
                  <td align="left" colspan="1" rowspan="1">5.9</td>
                  <td align="left" colspan="1" rowspan="1">146</td>
                  <td align="left" colspan="1" rowspan="1">3.78</td>
                  <td align="left" colspan="1" rowspan="1">3.4</td>
                  <td align="left" colspan="1" rowspan="1">40</td>
                  <td align="left" colspan="1" rowspan="1">−19849694</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">SK, unconstrained</td>
                  <td align="left" colspan="1" rowspan="1">0.32</td>
                  <td align="left" colspan="1" rowspan="1">0.73</td>
                  <td align="left" colspan="1" rowspan="1">4.5</td>
                  <td align="left" colspan="1" rowspan="1">43</td>
                  <td align="left" colspan="1" rowspan="1">1.28</td>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">−22199706</td>
                </tr>
                <tr>
                  <td align="left" colspan="9" rowspan="1">Best fit model at different aggregation levels</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">US County</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0.82</td>
                  <td align="left" colspan="1" rowspan="1">20.3</td>
                  <td align="left" colspan="1" rowspan="1">293</td>
                  <td align="left" colspan="1" rowspan="1">1.19</td>
                  <td align="left" colspan="1" rowspan="1">1.8</td>
                  <td align="left" colspan="1" rowspan="1">155</td>
                  <td align="left" colspan="1" rowspan="1">−13496740</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">State</td>
                  <td align="left" colspan="1" rowspan="1">0</td>
                  <td align="left" colspan="1" rowspan="1">0.59</td>
                  <td align="left" colspan="1" rowspan="1">20</td>
                  <td align="left" colspan="1" rowspan="1">322</td>
                  <td align="left" colspan="1" rowspan="1">0.4</td>
                  <td align="left" colspan="1" rowspan="1">2</td>
                  <td align="left" colspan="1" rowspan="1">35.5</td>
                  <td align="left" colspan="1" rowspan="1">−2949828</td>
                </tr>
              </tbody>
            </table>
          </alternatives><table-wrap-foot>
            <fn id="nt102">
              <label/>
              <p>Log likelihoods are quoted relative to that of the saturated model. County-level saturated model log likelihood = −975239008, State-level saturated model log likelihood = −467836121.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p><xref ref-type="fig" rid="pcbi-1002699-g004">Figure 4A and B</xref> illustrate the quality of synthetic networks generated from the best fitting local, matched model. There is strong agreement with data for predicted inflows to nodes (<xref ref-type="fig" rid="pcbi-1002699-g004">Figure 4A</xref>), but a weaker match to the distance distribution of journeys, particularly between 300 and 1200 km.</p>
        <fig id="pcbi-1002699-g004" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.g004</object-id>
          <label>Figure 4</label>
          <caption>
            <title>Comparison of summary statistics between the best fit MK model and data.</title>
            <p>A) Predicted inflow to nodes against actual inflow. B) Distribution of trip distances for matched kernel model and data.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.g004" xlink:type="simple"/>
        </fig>
        <p><xref ref-type="fig" rid="pcbi-1002699-g005">Figure 5A</xref> shows mean times to infection on the data network for all counties in the continental US against the log of their populations. There is a strong linear correlation between node infection time and log population and this relationship is to a large extent independent of the initial point of infection. The effect matches that seen in the UK epidemics, but is more pronounced.</p>
        <fig id="pcbi-1002699-g005" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.g005</object-id>
          <label>Figure 5</label>
          <caption>
            <title>Epidemic dynamics in the US.</title>
            <p>A) Mean times to infection on the data network for counties against log population. Mean times to infection on the MK model network vs. those on the data network for epidemics initialised in B) Los Angeles County and C) Clinton County, Iowa (small dots give 95% confidence intervals on the times to infection for the data network). D) RMS difference in time to infection between data and synthetic networks (see <xref ref-type="sec" rid="s3">Results</xref> section) against mean deviance for the best fit MK model on different data sets and at various aggregation levels.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.g005" xlink:type="simple"/>
        </fig>
        <p>As illustrated by <xref ref-type="fig" rid="pcbi-1002699-g005">Figure 5B and C</xref>, the epidemic dynamics recovered from the best fit US MK model are much poorer than seen for the UK. For a significant fraction of nodes, deviations from the target behaviour are large, going beyond the 95% confidence intervals for the times to infection on the data network. The distribution of deviations is also not consistent across initial seeding points. Seeded in Los Angeles County, times to infection from the MK model are higher than for the data network for low times to infection, but too low for the nodes with longest time to infection. From Clinton County, Iowa (population approx. 50,000), infections times are uniformly too low for the synthetic network.</p>
        <p>The significantly poorer fit in the US than in the UK is to be expected given the log likelihood values for the underlying model. In SI <xref ref-type="supplementary-material" rid="pcbi.1002699.s002">Text, S2</xref>, we derive an approximate measure of the goodness of fit of the mobility model which can be compared between different datasets. This mean deviance measure is based on the relative log likelihood, Δ<italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e003" xlink:type="simple"/></inline-formula></italic>, and is defined as<disp-formula id="pcbi.1002699.e018"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e018" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e019" xlink:type="simple"/></inline-formula> is the total number of trips in the relevant dataset. The derivation shows that the quantity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e020" xlink:type="simple"/></inline-formula> is also related to the expected deviation in time to infection across the model network. <xref ref-type="fig" rid="pcbi-1002699-g005">Figure 5D</xref> compares this goodness of fit measure to the corresponding measure of the goodness of fit of simulated epidemics on the synthetic network to those on the data network. This latter goodness of fit between epidemics is quantified by the root-mean-square (RMS) difference in mean times to infection between the data and synthetic networks, averaged across a range of initial nodes. Each point on the figure is based on the best fitting MK model applied to a different underlying dataset or level of spatial aggregation. Values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e021" xlink:type="simple"/></inline-formula> suggest that the fits of the MK model to the US data at the state level and to the UK data at the district and county level are of comparable quality. RMS differences in time to infection are also similar for these fits at 2–2.5 days. The value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e022" xlink:type="simple"/></inline-formula> for the county level US data set is much greater, indicating a worse fit, and the RMS difference in time to infection is also much larger.</p>
        <p>There is considerable variation in the goodness of fit among epidemics started from different nodes between the MK and data US networks. This suggests that the model is failing to capture accurately some subset of the work flows in the dataset. We can use the expression for the time to infection (<xref ref-type="disp-formula" rid="pcbi.1002699.e014">Equation 5</xref>) to calculate the theoretical mean time to infection for all connections in both the data network and the synthetic MK-based network to try to identify what the essential discrepancies are. The two networks differ not only in the work flows between nodes, but also in which connections are present, so it's necessary to aggregate the time to infection information to allow comparison. In <xref ref-type="fig" rid="pcbi-1002699-g006">Figure 6</xref>, average times to infection between pairs of nodes are shown aggregated into bins by source and destination log population size. Use of log population size is suggested both by the form of <xref ref-type="disp-formula" rid="pcbi.1002699.e014">equation 5</xref> and the strong correlation it has with infection times.</p>
        <fig id="pcbi-1002699-g006" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.g006</object-id>
          <label>Figure 6</label>
          <caption>
            <title>Mean time to infection difference matrix for the US.</title>
            <p>For each network, the time to infection between 2 nodes is averaged across all connections within a square. Colours in the matrix represent the difference between mean times on the A) MK network B) Assortative network and the data network. Positive values represent slower transmission on the synthetic network. Times to infection are calculated from <xref ref-type="disp-formula" rid="pcbi.1002699.e014">equation 5</xref>.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.g006" xlink:type="simple"/>
        </fig>
        <p><xref ref-type="fig" rid="pcbi-1002699-g006">Figure 6</xref> shows that for connections between large nodes, transmissions on the synthetic network are markedly slower than on the data network (red region). This is balanced by faster times to infection for other connections, particularly from small population source nodes. The majority of connections, represented by the centre of the diagram, fit quite well. These results suggest a distinct mechanism that is missing from the simple MK model that affects movements between highly populated nodes. Since only a small fraction of total movements is between such nodes, the effect is swamped in the likelihood. The best fitting region is for log populations between about 5.3 and 6.2, corresponding to the sources of the bulk of outflows.</p>
        <p>To better capture the interactions between large population centres, we adapt the MK model to make it assortative with respect to node population size. The assortative model categorises nodes as large or small according to a critical size, P<sub>c</sub>. To allow large sparsely-distributed population centres to make contact with each other, different gravity model parameters are then fitted for large to large interactions and for all other possible contacts.</p>
        <p>The best fit parameters for the assortative model are shown in <xref ref-type="table" rid="pcbi-1002699-t003">Table 3</xref>. The main contrast with the simple MK model is in the outer power parameter, γ<sub>2</sub>. The previous value of 1.8 is reduced to 1.21 for movements between large nodes, but increases to above 2 for all other types of connection. This encourages longer transmissions among large nodes and shorter transmissions where one of the nodes is small. The threshold population size distinguishing large and small populations (also fitted) was estimated at approximately 158,000.</p>
        <table-wrap id="pcbi-1002699-t003" orientation="portrait" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.t003</object-id><label>Table 3</label><caption>
            <title>Maximum likelihood estimators for parameters of the assortative model at the county level.</title>
          </caption><alternatives>
            <graphic id="pcbi-1002699-t003-3" mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.t003" xlink:type="simple"/>
            <table>
              <colgroup span="1">
                <col align="left" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
                <col align="center" span="1"/>
              </colgroup>
              <tbody>
                <tr>
                  <td align="left" colspan="1" rowspan="1">τ<sub>c</sub></td>
                  <td align="left" colspan="1" rowspan="1">log(P<sub>c</sub>)</td>
                  <td align="left" colspan="1" rowspan="1">α (km)</td>
                  <td align="left" colspan="1" rowspan="1">π</td>
                  <td align="left" colspan="1" rowspan="1"/>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">0.854</td>
                  <td align="left" colspan="1" rowspan="1">5.19</td>
                  <td align="left" colspan="1" rowspan="1">280</td>
                  <td align="left" colspan="1" rowspan="1">1.28</td>
                  <td align="left" colspan="1" rowspan="1">Common</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">γ</td>
                  <td align="left" colspan="1" rowspan="1">γ<sub>2</sub></td>
                  <td align="left" colspan="1" rowspan="1">d<sub>c</sub> (km)</td>
                  <td align="left" colspan="1" rowspan="1"/>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">17.4</td>
                  <td align="left" colspan="1" rowspan="1">1.21</td>
                  <td align="left" colspan="1" rowspan="1">164</td>
                  <td align="left" colspan="1" rowspan="1">Large-large</td>
                </tr>
                <tr>
                  <td align="left" colspan="1" rowspan="1">-</td>
                  <td align="left" colspan="1" rowspan="1">20.5</td>
                  <td align="left" colspan="1" rowspan="1">2.32</td>
                  <td align="left" colspan="1" rowspan="1">138</td>
                  <td align="left" colspan="1" rowspan="1">otherwise</td>
                </tr>
              </tbody>
            </table>
          </alternatives><table-wrap-foot>
            <fn id="nt103">
              <label/>
              <p>Relative likelihood, Δ<italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e004" xlink:type="simple"/></inline-formula></italic> = −12084243.</p>
            </fn>
          </table-wrap-foot></table-wrap>
        <p>The gain in likelihood of the assortative model over the simpler version is not large. However, the improvement in the ability to reproduce the epidemic timing seen for the data network is significant (See <xref ref-type="fig" rid="pcbi-1002699-g005">Figure 5D</xref> for the corresponding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e023" xlink:type="simple"/></inline-formula> value). The improvement in the quality of the fit in terms of epidemic behaviour can be seen <xref ref-type="fig" rid="pcbi-1002699-g007">Figure 7</xref>. <xref ref-type="fig" rid="pcbi-1002699-g007">Figure 7A and B</xref> should be compared with <xref ref-type="fig" rid="pcbi-1002699-g005">Figure 5B and C</xref> respectively. The assortative structure has clearly lessened some of the bias towards transmission being too fast to smaller nodes and too slow to larger ones in the epidemic initiated in Los Angeles (<xref ref-type="fig" rid="pcbi-1002699-g007">Figure 7A</xref>). Equally, the epidemic started in Clinton County has ‘slowed down’, converging towards the behaviour seen for the data network (<xref ref-type="fig" rid="pcbi-1002699-g007">Figure 7B</xref>). These improvements in fit are reflected in the RMS time differences shown in <xref ref-type="fig" rid="pcbi-1002699-g005">Figure 5D</xref>.</p>
        <fig id="pcbi-1002699-g007" orientation="portrait" position="float">
          <object-id pub-id-type="doi">10.1371/journal.pcbi.1002699.g007</object-id>
          <label>Figure 7</label>
          <caption>
            <title>Times to infection for different nodes for the assortative model in the US at the county level of aggregation with initial seeding A) Los Angeles County, B) Clinton County, Iowa.</title>
            <p>Grey dots represent 95% intervals across simulation realisations for the times to infection on the data network.</p>
          </caption>
          <graphic mimetype="image" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.g007" xlink:type="simple"/>
        </fig>
      </sec>
    </sec>
    <sec id="s4">
      <title>Discussion</title>
      <p>Understanding what aspects of human movement patterns are important to capture in transmission models is important in improving our ability to predict the spatiotemporal spread of emerging epidemics. As increasing volumes of finely resolved mobility data become available, one option is to incorporate these data directly into epidemic simulations. However, the availability of such directly applicable and comprehensive data sets is confined largely to Western Europe and the United States and concerns primarily human movement. In many parts of the world, such as Africa and East Asia, such data may be available only patchily, if at all, or at an inconvenient scale of aggregation <xref ref-type="bibr" rid="pcbi.1002699-VanKerkhove1">[17]</xref>, <xref ref-type="bibr" rid="pcbi.1002699-Garske1">[18]</xref>. Hence models are necessary to extrapolate to data poor areas. In this paper, we have looked at how well gravity movement models perform when fully supported by data. How well they perform with limited data is a topic for further work.</p>
      <p>Optimally, we would like a mechanistic but parsimonious model of human mobility which captures just sufficient detail to adequately represent the spatiotemporal spread of infection. ‘Adequately’ is clearly a subjective term, but a clear minimum criterion is that any model of mobility produces spatiotemporal dynamics that are not qualitatively different from those produced by raw mobility data itself. A much more rigorous criterion might be that a mobility model reproduces the connectivity of specific individual locations sufficiently accurately that the expected time to infection of every location estimated from mobility data is reproduced by a model to a certain level of precision.</p>
      <p>In this paper, we have focussed on the first criterion rather than the second – we are interested in matching the marginal statistical properties of spatial epidemics at the level of the ensemble of included locations, rather than the risk profile of each individual location.</p>
      <p>Our study shows that quite simple gravity models are able to capture many features of UK commuter flows at a variety of spatial scales. However, for a good fit to the observed patterns, it proved necessary to constrain the models to exactly reproduce the number of commuters resident in each node (<italic>i.e.</italic> total outflow, including self-flow). As shown in <xref ref-type="fig" rid="pcbi-1002699-g001">Figure 1A</xref>, the unconstrained model did quite poorly at matching this feature of the data. This seems surprising in light of the fact that the fraction of workers living in a node is well described as a fraction of the total population (approximately 36% in the UK). However, from <xref ref-type="disp-formula" rid="pcbi.1002699.e001">equation 1</xref>, the probability of a worker living in node <italic>i</italic> is<disp-formula id="pcbi.1002699.e024"><graphic orientation="portrait" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1002699.e024" xlink:type="simple"/></disp-formula>This expression is clearly dependent on the number and ‘attractiveness’ of other nodes around node <italic>i</italic>, indicating that the globally constrained model is density dependent. As result, the model favours greater outflows in more population- and node-dense areas. The locally constrained model largely removes this density dependence.</p>
      <p>The introduction of a matched two-part kernel greatly improves the ability of gravity models to reproduce the observed distance distribution of journeys. The improvement to the fit is mainly seen in journeys longer than 200 km which are quite rare in the data and hence give only a modest improvement in likelihood.</p>
      <p>The UK data set allows for models to be fitted to three nested levels of aggregation; ward, district and county. As the spatial scale of aggregation decreases, most of the parameters change monotonically (<italic>τ<sub>c</sub></italic>,<italic>λ</italic> = <italic>α</italic>/<italic>γ</italic>,<italic>γ<sub>2</sub></italic>,<italic>π</italic>). The theoretical limit of this aggregation process would be at the level of the individual at which point, powers on population sizes are meaningless. Hence the apparent convergence of the parameter <italic>τ<sub>c</sub></italic> to 1 suggests that gravity models may continue to be valid down to this level. The apparent convergence of π to 1 also suggests the distance kernel at the individual level might be smooth without a discontinuity at 0. This is encouraging for the use of gravity models in individual-based micro-simulations <xref ref-type="bibr" rid="pcbi.1002699-Ferguson1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1002699-Ferguson2">[19]</xref>.</p>
      <p>Epidemics run on synthetic mobility networks derived from the best-fit UK model match quite closely simulated outbreak behaviour on the data network. The only clear bias, which is replicated at all levels of aggregation, is faster rates of spread both to and from the smallest nodes than are seen on the data network. For the poorer fitting models (locally constrained SK and globally constrained MK), their ability to reproduce epidemic dynamics on the data network is not well predicted by their likelihood values. The globally constrained MK performs comparably to the locally constrained model, but the SK model is unable to reproduce the timing of infection of the nodes infected latest in an epidemic (<xref ref-type="fig" rid="pcbi-1002699-g002">Figure 2C</xref>). This is because infection does not spread to distant nodes in a wave-like manner (<italic>i.e.</italic> utilising long chains of strong, short distance connections), but rather through weaker, long distance connections from the first few infected nodes. As a result, biases in the models in the strengths of rare long distance connections can have an effect on an epidemic out of all proportion to the effect of those long-range connections' contribution to the likelihood.</p>
      <p>The transmission time theory developed in SI <xref ref-type="supplementary-material" rid="pcbi.1002699.s001">Text, S1</xref>, proves to be a good predictor of the times to infection generated by simulation, although with a slight tendency to overestimate times to infection. It represents the sensitivity of epidemic dynamics to the epidemiological parameters well, both qualitatively and quantitatively. The approximation gives a fairly accurate prediction for first infection times at the UK county level (<xref ref-type="fig" rid="pcbi-1002699-g003">Figure 3C</xref>), under the assumption that infection travels between nodes via the minimum-time route only. However, at the district level, this approach starts to break down. While infection times of nodes affected early in an epidemic are well described, later infection times are considerably over-estimated. This appears to be because some nodes are subject to significant forces of infection from more than one source node. Close examination of infection times indicate that transmission through large conurbations is accelerated in comparison with the naive single quickest path algorithm. Neighbouring nodes in cities are very well connected and hence generate many sources of force of infection for a susceptible node. A related issue is that the assumption of small proportional flows between nodes underpinning the analysis may be broken between densely populated contiguous nodes. Essentially, nodes within conurbations are often so strongly connected that they cannot be regarded, epidemiologically, to be independent weakly interacting communities. An equally accurate but more parsimonious division of the population geographically could be achieved by amalgamating such urban nodes. The time to infection expression we derived could be used to discriminate which nodes should be amalgamated by defining a minimum transmission time for two nodes to be considered independent. This is an area for future work.</p>
      <p>When applied to the US data, the rank order of fit of the different gravity models examined was the same as for the UK analysis, but the quality of fit was considerably worse for the US county-scale data (the finest level of aggregation considered). The mean deviance measure, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1002699.e025" xlink:type="simple"/></inline-formula>, for the best fit MK model makes this clear (<xref ref-type="fig" rid="pcbi-1002699-g005">Figure 5D</xref>). Although the predicted node inflows match the data well, reproduction of the distance distribution of journeys is not particularly accurate (<xref ref-type="fig" rid="pcbi-1002699-g004">Figure 4</xref>).</p>
      <p>Comparing epidemics run on the best fit synthetic and data networks for the US shows a much poorer fit than obtained in the UK analysis to times to infection, in line with what might be expected from the mean deviance statistic. The much improved fit at the state level compared with the county level suggests that some of the problem in matching the data arises from heterogeneities in movements and population at the county scale. A number of refinements of the basic MK model were attempted, such as: inclusion of a mean income term and population density term alongside the population terms in <xref ref-type="disp-formula" rid="pcbi.1002699.e005">equation 2</xref>; inclusion of a third matched kernel section to better match the distance distribution (see <xref ref-type="fig" rid="pcbi-1002699-g004">Figure 4B</xref>). None of these produced any appreciable improvement in likelihood or epidemic fit. However, the deviances in time to infection of nodes shown in <xref ref-type="fig" rid="pcbi-1002699-g006">Figure 6</xref> suggest a limited number of flows into and out of the most populated nodes are underestimated by the model. Addressing this with an assortative spatial interaction between large and small populations improves the fit between epidemics. The principle change in the model is an increase in the distance over which movements can occur between large population centres.</p>
      <p>A plausible explanation for the excess in long-range journeys between large nodes in the US is domestic air travel. The extreme size of the continental United States and its sparsely populated central region encourages long range flights to connect the two coasts, for example, usually between highly populated nodes. There is much less need for flights over short distances and few closely spaced large population nodes for them to fly between. These kinds of flows, although important for disease transmission, may not be well modelled by power law kernels and gravity models. As they are relatively rare, they carry little statistical ‘weight’ within the likelihood expression, but still play a crucial role in long distance disease transmission.</p>
      <p>Comparison between the parameter estimates for the two regions are hard to make, as the levels of aggregation differ. Perhaps the closest match is between US counties and UK districts, both in terms of population size and demographically (large conurbations are made up of several of the units in both cases). As can be seen from <xref ref-type="table" rid="pcbi-1002699-t001">tables 1</xref>,<xref ref-type="table" rid="pcbi-1002699-t002">2</xref> and <xref ref-type="table" rid="pcbi-1002699-t003">3</xref>, parameter values are not generally transferable. The exponent of long distance connections is consistent between MK models (approx 1.8), but it is this aspect of the US fit which changes most with the introduction of assortativity and hence is most strongly associated with the poor performance of the MK model in the US. As discussed, the poor fit in the US is probably the result of the demographic heterogeneity and large size of the country. It seems more likely that parameter estimates for the UK may transfer better to other European countries with similar demographies.</p>
      <p>It is clear from <xref ref-type="fig" rid="pcbi-1002699-g006">Figure 6</xref> that although an assortative model considerably improves the fit to the spatio-temporal dynamics of the epidemic, it doesn't have much effect on the underlying biases of the gravity model with regard to the US mobility data. Further work is necessary to identify what features of the data are essential to an accurate model. Preliminary show that dividing the country into regions of similar population density (east and west coasts separated by a central region) leads to better fits within each but requires additional models for movements between them. A recent paper Simini et al. presents a radical new model defining the relative probabilities of trips purely in terms of resident population distributions <xref ref-type="bibr" rid="pcbi.1002699-Simini1">[20]</xref>. Simulations show that this model performs at least as well as the assortative model described in this paper in matching epidemic behaviour. The time to infection theory (SI <xref ref-type="supplementary-material" rid="pcbi.1002699.s001">Text S1</xref>) suggests several applications. In meta-population models, it allows a comparison between local epidemic timescale and that of transmission to neighbouring nodes. Hence it is possible to optimise meta-population structure to ensure that individual nodes represent largely independent populations weakly linked to each other. The theory also suggests an alternative approach to clustering on a network in terms of its accelerating effect on the speed of epidemics on a network.</p>
    </sec>
    <sec id="s5">
      <title>Supporting Information</title>
      <supplementary-material id="pcbi.1002699.s001" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.s001" xlink:type="simple">
        <label>Text S1</label>
        <caption>
          <p>
            <bold>Transmission time theory.</bold>
          </p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
      <supplementary-material id="pcbi.1002699.s002" mimetype="application/pdf" orientation="portrait" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1002699.s002" xlink:type="simple">
        <label>Text S2</label>
        <caption>
          <p>
            <bold>Interpretation of the likelihood.</bold>
          </p>
          <p>(PDF)</p>
        </caption>
      </supplementary-material>
    </sec>
  </body>
  <back>
    <ref-list>
      <title>References</title>
      <ref id="pcbi.1002699-Zipf1">
        <label>1</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zipf</surname><given-names>GK</given-names></name> (<year>1946</year>) <article-title>The P1 P2/D Hypothesis: On the Intercity Movement of Persons</article-title>. <source>Am Sociol Rev</source> <volume>11</volume>: <fpage>677</fpage>–<lpage>686</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Haynes1">
        <label>2</label>
        <mixed-citation publication-type="other" xlink:type="simple">Haynes KE, Fotheringham AS (1984) Gravity and Spatial Interaction Models. Sage publications.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Ortuzar1">
        <label>3</label>
        <mixed-citation publication-type="other" xlink:type="simple">Ortuzar JD, Willumsen LG (2004) Modelling Transport. 3rd edition. John Wiley and Sons.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Schneider1">
        <label>4</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schneider</surname><given-names>DW</given-names></name>, <name name-style="western"><surname>Ellis</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Cummings</surname><given-names>KS</given-names></name> (<year>1998</year>) <article-title>A transportation model assessment of the risk to native mussel communities from zebra mussel spread</article-title>. <source>Conserv Biol</source> <volume>12</volume>: <fpage>788</fpage>–<lpage>800</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Ferrari1">
        <label>5</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ferrari</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Bjørnstad</surname><given-names>ON</given-names></name>, <name name-style="western"><surname>Partain</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Antonovics</surname><given-names>J</given-names></name> (<year>2006</year>) <article-title>A gravity model for the spread of a pollinator-borne plant pathogen</article-title>. <source>Am Nat</source> <volume>168</volume>: <fpage>294</fpage>–<lpage>303</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Xia1">
        <label>6</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xia</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Bjørnstad</surname><given-names>ON</given-names></name>, <name name-style="western"><surname>Grenfell</surname><given-names>BT</given-names></name> (<year>2004</year>) <article-title>Measles metapopulation dynamics: a gravity model for epidemiological coupling and dynamics</article-title>. <source>The Am Nat</source> <volume>164</volume>: <fpage>267</fpage>–<lpage>281</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1086/422341" xlink:type="simple">10.1086/422341</ext-link></comment></mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Viboud1">
        <label>7</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Viboud</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bjørnstad</surname><given-names>ON</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Simonsen</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>MA</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Synchrony, waves, and spatial hierarchies in the spread of influenza</article-title>. <source>Science</source> <volume>312</volume>: <fpage>447</fpage>–<lpage>451</lpage>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-CiofidegliAtti1">
        <label>8</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ciofi degli Atti</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Merler</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Rizzo</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ajelli</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Massari</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Mitigation measures for pandemic influenza in Italy: an individual based model considering different scenarios</article-title>. <source>PloS One</source> <volume>3</volume>: <fpage>e1790</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0001790" xlink:type="simple">10.1371/journal.pone.0001790</ext-link></comment></mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Merler1">
        <label>9</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Merler</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ajelli</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>The role of population heterogeneity and human mobility in the spread of pandemic influenza</article-title>. <source>Proc Biol Sci</source> <volume>277</volume>: <fpage>557</fpage>–<lpage>565</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.2009.1605" xlink:type="simple">10.1098/rspb.2009.1605</ext-link></comment></mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Ferguson1">
        <label>10</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ferguson</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>Cummings</surname><given-names>DAT</given-names></name>, <name name-style="western"><surname>Fraser</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Cajka</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Cooley</surname><given-names>PC</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Strategies for mitigating an influenza pandemic</article-title>. <source>Nature</source> <volume>442</volume>: <fpage>448</fpage>–<lpage>452</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature04795" xlink:type="simple">10.1038/nature04795</ext-link></comment></mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Merler2">
        <label>11</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Merler</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Ajelli</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>The role of population heterogeneity and human mobility in the spread of pandemic influenza</article-title>. <source>Proc Biol Sci</source> <volume>277</volume>: <fpage>557</fpage>–<lpage>565</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rspb.2009.1605" xlink:type="simple">10.1098/rspb.2009.1605</ext-link></comment></mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Anon1">
        <label>12</label>
        <mixed-citation publication-type="other" xlink:type="simple">Anon (n.d.) Office for National Statistics Census page. Office for National Statistics. Available:<ext-link ext-link-type="uri" xlink:href="http://www.ons.gov.uk/census/index.html" xlink:type="simple">http://www.ons.gov.uk/census/index.html</ext-link>. Accessed 24 February 2009.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Anon2">
        <label>13</label>
        <mixed-citation publication-type="other" xlink:type="simple">Anon (n.d.) General Register Office for Scotland Census page. General Register Office for Scotland. Available:<ext-link ext-link-type="uri" xlink:href="http://www.gro-scotland.gov.uk/census/index.html" xlink:type="simple">http://www.gro-scotland.gov.uk/census/index.html</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Stillwell1">
        <label>14</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stillwell</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Duke-Williams</surname><given-names>O</given-names></name> (<year>2007</year>) <article-title>Understanding the 2001 UK census migration and commuting data: the effect of small cell adjustment and problems of comparison with 1991</article-title>. <source>J R Stat Soc Ser A Stat Soc</source> <volume>170</volume>: <fpage>425</fpage>–<lpage>445</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1467-985X.2006.00458.x" xlink:type="simple">10.1111/j.1467-985X.2006.00458.x</ext-link></comment></mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Anon3">
        <label>15</label>
        <mixed-citation publication-type="other" xlink:type="simple">Anon (n.d.) Census 2000 Gateway. US Census Bureau. Available:<ext-link ext-link-type="uri" xlink:href="http://www.census.gov/main/www/cen2000.html" xlink:type="simple">http://www.census.gov/main/www/cen2000.html</ext-link>.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Cormen1">
        <label>16</label>
        <mixed-citation publication-type="other" xlink:type="simple">Cormen TH, Leiserson CE, Rivest RL, Stein C (2009) Introduction to Algorithms. 3rd edition. MIT Press, Cambridge, London.</mixed-citation>
      </ref>
      <ref id="pcbi.1002699-VanKerkhove1">
        <label>17</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Van Kerkhove</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Vong</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Guitian</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Holl</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Mangtani</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Poultry movement networks in Cambodia: implications for surveillance and control of highly pathogenic avian influenza (HPAI/H5N1)</article-title>. <source>Vaccine</source> <volume>27</volume>: <fpage>6345</fpage>–<lpage>6352</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.vaccine.2009.05.004" xlink:type="simple">10.1016/j.vaccine.2009.05.004</ext-link></comment></mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Garske1">
        <label>18</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Garske</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Peng</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Ye</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Zhou</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Travel patterns in China</article-title>. <source>PloS One</source> <volume>6</volume>: <fpage>e16364</fpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0016364" xlink:type="simple">10.1371/journal.pone.0016364</ext-link></comment></mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Ferguson2">
        <label>19</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ferguson</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>Cummings</surname><given-names>DAT</given-names></name>, <name name-style="western"><surname>Cauchemez</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Fraser</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Riley</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Strategies for containing an emerging influenza pandemic in Southeast Asia</article-title>. <source>Nature</source> <volume>437</volume>: <fpage>209</fpage>–<lpage>214</lpage> <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature04017" xlink:type="simple">10.1038/nature04017</ext-link></comment></mixed-citation>
      </ref>
      <ref id="pcbi.1002699-Simini1">
        <label>20</label>
        <mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Simini</surname><given-names>F</given-names></name>, <name name-style="western"><surname>González</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Maritan</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Barabási</surname><given-names>A</given-names></name> (<year>2012</year>) <article-title>A universal model for mobility and migration patterns</article-title>. <source>Nature</source> <fpage>1</fpage>–<lpage>17</lpage> <comment> doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature10856" xlink:type="simple">10.1038/nature10856</ext-link></comment></mixed-citation>
      </ref>
    </ref-list>
  </back>
</article>