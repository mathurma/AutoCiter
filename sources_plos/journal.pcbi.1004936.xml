<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article article-type="research-article" dtd-version="1.1d3" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004936</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-01321</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Computational techniques</subject><subj-group><subject>Split-decomposition method</subject><subj-group><subject>Multiple alignment calculation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject><subj-group><subject>Hidden Markov models</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure comparison</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject><subj-group><subject>Protein structure comparison</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical models</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Molecular biology techniques</subject><subj-group><subject>Sequencing techniques</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data visualization</subject><subj-group><subject>Infographics</subject><subj-group><subject>Charts</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Bayesian Top-Down Protein Sequence Alignment with Inferred Position-Specific Gap Penalties</article-title>
<alt-title alt-title-type="running-head">Top-Down Alignment with Inferred Position-Specific Gap Penalties</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Neuwald</surname>
<given-names>Andrew F.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Altschul</surname>
<given-names>Stephen F.</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Institute for Genome Sciences and Department of Biochemistry &amp; Molecular Biology, University of Maryland School of Medicine, Baltimore, Maryland, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>National Center for Biotechnology Information, National Library of Medicine, National Institutes of Health, Bethesda, Maryland, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Orengo</surname>
<given-names>Christine A.</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>University College London, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: AFN. Performed the experiments: AFN. Analyzed the data: AFN. Contributed reagents/materials/analysis tools: AFN SFA. Wrote the paper: AFN SFA. Designed and implemented routines for Dirichlet mixture priors and BILD scores: SFA. Designed and implemented other aspects of the GISMO program: AFN.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">aneuwald@som.umaryland.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>18</day>
<month>5</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>5</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>5</issue>
<elocation-id>e1004936</elocation-id>
<history>
<date date-type="received">
<day>6</day>
<month>8</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>24</day>
<month>4</month>
<year>2016</year>
</date>
</history>
<permissions>
<license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">
<license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">Creative Commons CC0</ext-link> public domain dedication.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004936"/>
<abstract>
<p>We describe a Bayesian Markov chain Monte Carlo (MCMC) sampler for protein multiple sequence alignment (MSA) that, as implemented in the program GISMO and applied to large numbers of diverse sequences, is more accurate than the popular MSA programs MUSCLE, MAFFT, Clustal-Ω and Kalign. Features of GISMO central to its performance are: <bold>(i)</bold> It employs a “top-down” strategy with a favorable asymptotic time complexity that first identifies regions generally shared by all the input sequences, and then realigns closely related subgroups in tandem. <bold>(ii)</bold> It infers position-specific gap penalties that favor insertions or deletions (indels) within each sequence at alignment positions in which indels are invoked in other sequences. This favors the placement of insertions between conserved blocks, which can be understood as making up the proteins’ structural core. <bold>(iii)</bold> It uses a Bayesian statistical measure of alignment quality based on the minimum description length principle and on Dirichlet mixture priors. Consequently, GISMO aligns sequence regions only when statistically justified. This is unlike methods based on the <italic>ad hoc</italic>, but widely used, sum-of-the-pairs scoring system, which will align random sequences. <bold>(iv)</bold> It defines a system for exploring alignment space that provides natural avenues for further experimentation through the development of new sampling strategies for more efficiently escaping from suboptimal traps. GISMO’s superior performance is illustrated using 408 protein sets containing, on average, 235 sequences. These sets correspond to NCBI Conserved Domain Database alignments, which have been manually curated in the light of available crystal structures, and thus provide a means to assess alignment accuracy. GISMO fills a different niche than other MSA programs, namely identifying and aligning a conserved domain present within a large, diverse set of full length sequences. The GISMO program is available at <ext-link ext-link-type="uri" xlink:href="http://gismo.igs.umaryland.edu/" xlink:type="simple">http://gismo.igs.umaryland.edu/</ext-link>.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Existing multiple alignment programs typically utilize (i) bottom-up progressive strategies, which require the time-consuming alignment of each pair of input sequences, (ii) <italic>ad hoc</italic> measures of alignment quality, and (iii) pre-specified, uniformly-defined gap penalties. Here we describe an alternative strategy that first provisionally aligns regions generally shared by all the input sequences, and then refines this alignment by iteratively realigning correlated sequences in tandem. It infers position-specific gap penalties directly from the evolving alignment. It avoids suboptimal traps by stochastically traversing the complex, correlated space of alignments using a statistically rigorous measure of alignment quality. For large sequence sets, this approach offers clear advantages in alignment accuracy over the most popular programs currently available.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution>the School of Medicine at the University of Maryland, Baltimore</institution>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Neuwald</surname>
<given-names>Andrew F.</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution>the Intramural Research Program of the National Library of Medicine</institution>
</funding-source>
<principal-award-recipient>
<name name-style="western">
<surname>Altschul</surname>
<given-names>Stephen F.</given-names>
</name>
</principal-award-recipient>
</award-group>
<funding-statement>SFA was funded by the NIH Intramural Research Program. AFN received no specific funding for this work. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="0"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The GISMO program and sequence data sets analyzed in this study are available at <ext-link ext-link-type="uri" xlink:href="http://gismo.igs.umaryland.edu/" xlink:type="simple">http://gismo.igs.umaryland.edu/</ext-link>. Other data are provided in the supporting information.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper.</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>A common starting point for the computational analysis of proteins is the construction of a multiple sequence alignment (MSA). Insofar as they result from protein functional similarities and differences, the patterns of residue conservation and divergence within such an alignment provide clues to biological function. Of course the biological relevance of any observed patterns depends upon an alignment’s accuracy, and alignments of larger sequence sets have greater statistical power. For biologically appropriate scoring systems applied to more than a very small number of sequences, however, no optimization procedures are known that are both tractable and rigorous; thus all practical MSA programs rely upon heuristic methods.</p>
<p>The most widely used general approach to multiple alignment is the progressive technique [<xref ref-type="bibr" rid="pcbi.1004936.ref001">1</xref>], which constructs an MSA by combining sub-alignments, beginning with similar pairs and progressing to more distantly related groups. Many progressive alignment programs are slowed by the need to construct a “guide tree”, which specifies the order in which sequence subgroups are aligned, from pairwise alignment scores. For <italic>n</italic> sequences of a fixed average length, it requires O(<italic>n</italic><sup>2</sup>) time to compute such scores, and this becomes the time-dominating step for large <italic>n</italic>. One way around this problem is to iteratively refine a guide tree and MSA starting from an initial crude guide tree, an approach used in the popular MUSCLE [<xref ref-type="bibr" rid="pcbi.1004936.ref002">2</xref>] and MAFFT [<xref ref-type="bibr" rid="pcbi.1004936.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1004936.ref005">5</xref>] programs. The MAFFT PartTree [<xref ref-type="bibr" rid="pcbi.1004936.ref006">6</xref>] and Clustal-Ω mBed [<xref ref-type="bibr" rid="pcbi.1004936.ref007">7</xref>] algorithms yield guide tree construction times of <italic>n</italic>log <italic>n</italic>. A recent O(<italic>n</italic>) approach [<xref ref-type="bibr" rid="pcbi.1004936.ref008">8</xref>] is to use a simple chained guide tree, and add individual sequences to a growing alignment in an arbitrary order.</p>
<p>An alternative O(<italic>n</italic>) method that avoids aligning all sequences to one another is to use Markov chain Monte Carlo (MCMC) sampling to iteratively align sequences to an evolving hidden Markov model (HMM) [<xref ref-type="bibr" rid="pcbi.1004936.ref009">9</xref>–<xref ref-type="bibr" rid="pcbi.1004936.ref011">11</xref>]. Our approach initially uses a block-based HMM to represent islands of similarity within otherwise dissimilar sequences. The number of the blocks and their lengths are first sampled randomly from a prior distribution, and placed randomly but co-linearly within each sequence. Posterior HMM parameters are derived from this alignment. Next, an arbitrary sequence <italic>S</italic> is removed from the alignment, and the model’s parameters are updated and then used to sample new locations for its blocks within <italic>S</italic>. This process may be iterated an arbitrary number of times. Also, both blocks and columns at the edges of each block are iteratively sampled in or out of the alignment and of the corresponding model. Sampling continues in this way until the log-likelihood ratio (LLR) implied for the evolving HMM fails to improve over a specified number of iterations. All alignments are sampled using probabilities proportional to their LLRs. Note that the hmmt program iteratively refines an HMM in a similar manner [<xref ref-type="bibr" rid="pcbi.1004936.ref012">12</xref>].</p>
<p>Aligning distantly related sequences presents major algorithmic and statistical challenges because such sequences typically share similarity only within a common structural core, with sizable insertions often occurring between core elements. Classical dynamic programming alignment algorithms typically have difficulty spanning these insert regions because the log-odds scores associated with weakly conserved core elements are often too low to offset the gap penalties incurred. Fortunately, even when the conserved blocks are very subtle, an MCMC strategy can take advantage of a large number of input sequences to detect weak yet statistically significant similarities.</p>
<p>Two factors have tended to slow previous MCMC sampling procedures, or to trap them in local optima. The first is the inclusion of correlated sequences within the input. When a set of such sequences is misaligned to the main body of sequences, it favors recurring misalignment when individual sequences from the set are resampled. This problem may be partially addressed by removing from the program’s input all but one sequence among closely related sets; these sequences may be added to the alignment at the program’s end. The second factor is the difficulty in accurately identifying the number and locations of aligned columns corresponding to the structural core, and the corresponding placement of indels. A previous sampler addressed this problem with only partial success by splitting or joining contiguous blocks, extending or trimming blocks, and by allowing short indels within a block [<xref ref-type="bibr" rid="pcbi.1004936.ref010">10</xref>].</p>
<p>A critical issue for multiple alignment programs is how they internally assess sequence alignment quality. One widely used measure is the sum of the implied pairwise scores, but this measure lacks a good mathematical justification. Previous MCMC programs introduced measures with a rigorous statistical basis by sampling over the posterior probability distribution defined by a statistical model for aligned columns [<xref ref-type="bibr" rid="pcbi.1004936.ref009">9</xref>, <xref ref-type="bibr" rid="pcbi.1004936.ref013">13</xref>]. However, they employed uniform HMM transition probabilities (i.e., gap penalties) [<xref ref-type="bibr" rid="pcbi.1004936.ref010">10</xref>], which fail to model position-specific indels with comparable generality.</p>
<p>In this article, we describe a new approach to MSA, whose main features are as follows. <bold>(a)</bold> It uses a <bold>top-down strategy</bold> and MCMC sampling to align <italic>n</italic> sequences of a fixed average length in O(<italic>n</italic>) time. It achieves this by first globally aligning input sequences to a block-based model, then generalizing this model by converting aligned blocks into a continuous, gapped alignment and refining it by repeated Markov chain resampling. <bold>(b)</bold> It employs a Bayesian generative statistical model and the minimum description length (MDL) principle [<xref ref-type="bibr" rid="pcbi.1004936.ref014">14</xref>] to measure the quality of alignments, and seeks to optimize this measure. <bold>(c)</bold> It employs Dirichlet mixture priors [<xref ref-type="bibr" rid="pcbi.1004936.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004936.ref016">16</xref>] constructed using recently described optimization procedures [<xref ref-type="bibr" rid="pcbi.1004936.ref017">17</xref>]. <bold>(d)</bold> It dynamically infers HMM position-specific transition probabilities (i.e., gap penalties) based on the evolving alignment. <bold>(e)</bold> It uses new sampling strategies for correlated sequences to efficiently escape from local optima. We have implemented this approach in a program called GISMO (<underline>Gi</underline>bbs <underline>S</underline>ampler for <underline>M</underline>ulti-alignment <underline>O</underline>ptimization) and demonstrate here that it can align large numbers of diverse protein sequences on average more accurately than existing methods.</p>
<sec id="sec002">
<title>The GISMO sampler</title>
<p>GISMO shares certain algorithmic and statistical features with an earlier version of this sampler [<xref ref-type="bibr" rid="pcbi.1004936.ref010">10</xref>], including the optimization of a hidden Markov model (HMM); the corresponding statistical model is reviewed in Methods. In this section we describe features key to our new sampler.</p>
</sec>
<sec id="sec003">
<title>Top-down alignment strategy</title>
<p>Most multiple alignment methods utilize a “bottom-up” progressive alignment strategy. That is, they start by aligning the most closely-related sequences and progressing to those more distantly related. GISMO takes an inverted, “top-down” MCMC approach that starts by aligning, among all sequences, the core regions they share. It first generates a random alignment consisting of many short (5- to 15-column) co-linear aligned blocks (<bold><xref ref-type="fig" rid="pcbi.1004936.g001">Fig 1A</xref></bold>). It then samples sequences, columns and blocks into and out of this alignment, proportionally to their likelihoods as implied by the underlying statistical model. The resulting relatively crude block-based alignment is then converted into a single HMM (<bold><xref ref-type="fig" rid="pcbi.1004936.g001">Fig 1B</xref></bold>) with position-specific transition probabilities that are allowed to evolve as the sampler progresses (see below). Finally, GISMO applies various sampling strategies to optimize the number of columns and the locations of indels and to realign clusters of correlated sequences that, if sampled individually, could trap the sampler in a suboptimal alignment.</p>
<fig id="pcbi.1004936.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004936.g001</object-id>
<label>Fig 1</label>
<caption>
<title>GISMO block-based and hidden Markov models.</title>
<p><bold>A</bold>. Schematic of a hypothetical GISMO phase 1 block based alignment, which is initialized to consist of many short, ungapped aligned blocks. <bold>B</bold>. Architecture for the GISMO phase 2 HMM. Red transition arrows between states emit residues. Transition probabilities are inferred from the sequence data. Note that the HMM is local with respect to each sequence but global with respect to the model.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>A measure of alignment quality</title>
<p>A program’s measure of multiple alignment quality, either explicit or implicit, plays a vital role in determining the alignments it will produce. GISMO’s measure corresponds to an underlying generative statistical model, specifically an HMM, and, to the extent that it can efficiently explore alignment space, GISMO will converge on an optimal solution (assuming that sequence weights remain the same; see below). GISMO’s statistical model has several features worth noting. (i) To counter redundancy or bias among the input sequences, GISMO down-weights closely correlated sequences [<xref ref-type="bibr" rid="pcbi.1004936.ref018">18</xref>]. Early on as the alignment evolves so do the sequences’ inferred weights; in the final stage of sampling these weights remain constant. (ii) GISMO models the tendency for amino acid residues to substitute for one another using Dirichlet mixture priors [<xref ref-type="bibr" rid="pcbi.1004936.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004936.ref016">16</xref>], whose calculation has recently been refined [<xref ref-type="bibr" rid="pcbi.1004936.ref017">17</xref>]. This improves the statistical model’s sensitivity to biological relationships. See <xref ref-type="sec" rid="sec017">Methods</xref> for mathematical details.</p>
</sec>
<sec id="sec005">
<title>Inferred position-specific gap penalties</title>
<p>As described in Methods, GISMO infers HMM transition probabilities at each model position based on the evolving alignment itself. More specifically, the observed numbers of each type of transition, along with specified prior probability distributions for these transitions, imply posterior probabilities for each transition at each position. These correspond to implicit gap penalties, which favor insertions or deletions (indels) within a given sequence that vary in tandem with where indels have been inferred within other sequences. This tends automatically to favor near block-based alignments—a characteristic that the following column-sampling strategy exploits.</p>
</sec>
<sec id="sec006">
<title>Column sampling strategies</title>
<p>The HMM’s evolving position-specific transition probabilities tend to align conserved regions of the proteins as contiguous blocks, separated by insertions of varying lengths. To improve the alignment, however, it is desirable for the sampler to explore alternative configurations of aligned columns. To determine the proper extent of an implied block, GISMO adds or removes columns based on their <bold>Bayesian Integral Log-odds</bold> (<bold>BILD</bold>) scores [<xref ref-type="bibr" rid="pcbi.1004936.ref019">19</xref>]. The BILD formalism arises from the <bold>Minimum Description Length</bold> (<bold>MDL</bold>) principle [<xref ref-type="bibr" rid="pcbi.1004936.ref014">14</xref>], which provides a criterion for choosing among alternative models for describing a set of data. Conceptually, it suggests that the best model, among a set of alternatives, is that which minimizes the description length of the model, plus the maximum-likelihood description length of the data given the model. Note, however, that early in our sampling, we retain columns that, based on their BILD scores, fail marginally to be statistically supported, in order to allow the sampler time to converge on an accurate alignment. GISMO also will move model columns from one side of a set of insertions to the other, if this improves the aggregate BILD score</p>
</sec>
<sec id="sec007">
<title>Sequence sampling strategies</title>
<p>When individual sequences are realigned to the evolving HMM, they may be sampled (as described in Methods) one at a time, with the HMM parameters recomputed after each sequence is removed from the alignment. However, this approach encounters difficulties when an alignment consists of distinct clusters of more closely related sequences, because a sampled sequence is biased by the remaining sequences of its cluster to realign as before. Sampling all the sequences of a cluster in tandem can overcome this “stickiness”. GISMO does this in two distinct ways. First, for a cluster <italic>C</italic> of extremely closely related sequences whose mutual alignment lacks indels: (i) GISMO constructs a consensus sequence <italic>S</italic> to represent the sequences in <italic>C</italic>, and prealigns <italic>S</italic> to these sequences; (ii) It removes all the sequences of <italic>C</italic> from the general alignment, and adjusts the implied HMM parameters accordingly; (iii) It aligns <italic>S</italic> to the HMM by sampling; (iv) Using <italic>S</italic> as a template, it places the sequences of <italic>C</italic> back into the general alignment.</p>
<p>Alternatively, for a cluster <italic>C</italic> of somewhat more distantly related sequences: (i) GISMO removes all the sequences of <italic>C</italic> from the general alignment and adjusts the implied HMM accordingly; (ii) It realigns the sequences of <italic>C</italic> in turn to the HMM by sampling. GISMO applies this latter realignment procedure not only to sets of sequences clustered by sequence similarity, but also to groups of sequences that share congruent insertions or deletions or that share a non-consensus residue in an otherwise well conserved column (see <bold><xref ref-type="supplementary-material" rid="pcbi.1004936.s008">S1 Fig</xref></bold>). In all these cases, by sampling ‘sticky’ sequences in tandem, GISMO is able to escape many local traps in alignment space.</p>
<p>Finally, GISMO applies three different coordinated sampling strategies: (i) It realigns sequences using a ‘purged’ set as follows: first, it groups all sequences into closely-related clusters; second, it retains in the alignment only the one sequence from each cluster closest to the cluster’s consensus sequence; third, it realigns by sampling each of the remaining sequences; finally, it resamples into the alignment each of the sequences that were originally excluded. This step resembles another, recently-described MSA strategy [<xref ref-type="bibr" rid="pcbi.1004936.ref020">20</xref>]. (ii) It removes in tandem the poorest scoring sequences and then resamples them, under the assumption that poor scores may arise from alignment errors. And (iii) it removes in tandem and then resamples randomly chosen sequence subsets.</p>
</sec>
<sec id="sec008">
<title>Competitive selection strategy</title>
<p>Given the stochastic nature of MCMC sampling, it is advantageous to focus on refining the best alignment among several initial candidate alignments. GISMO does this as follows. (i) It generates a rough block-based alignment for all input sequences, which it uses to construct clusters of closely related sequences, and then selects one sequence from each cluster for further preliminary alignment. (ii) For these sequences, it independently generates a population of block-based alignments, ten by default. (iii) It converts each of these alignments into an HMM alignment and resamples its sequences permitting the introduction of gaps. (iv) It scores each alignment by its similarity to the other alignments (see <xref ref-type="sec" rid="sec017">Methods</xref>). The assumption is that the best alignments will share more similarity with other alignments. Moreover, such agreement may indicate, in the absence of structural information, that a more accurate alignment has been found. (v) It further refines the highest scoring alignments, five by default, and then selects the best of these by the same criterion. (vi) It samples back the remaining sequences, performs additional refinement, and returns a final, full alignment.</p>
</sec>
</sec>
<sec id="sec009" sec-type="results">
<title>Results</title>
<p>The GISMO program was implemented in C++. We tested GISMO on 408 protein sequence sets; these correspond to those domain alignments within version 3.14 of the NCBI Conserved Domain Database (CDD) [<xref ref-type="bibr" rid="pcbi.1004936.ref021">21</xref>] that contain at least 50 sequences, at least 10 of which share less than 70% identity to each other. (The CDD MSA identifiers are listed in <bold><xref ref-type="supplementary-material" rid="pcbi.1004936.s004">S1 Charts</xref></bold>.) These MSAs have been manually-curated in the light of available crystal structures and serve here as gold standards, against which GISMO and other programs’ MSAs may be benchmarked. These alignments contain up to 2,399 sequences and contain in aggregate between 3,583 and 3,929,595 residues. This test set focuses on the principle application motivating the development of GISMO, the accurate alignment of a conserved domain shared by a relatively large number of diverse, full-length sequences that, outside of the shared domain, are otherwise unrelated.</p>
<sec id="sec010">
<title>Comparisons with other programs</title>
<p>GISMO was compared to four widely used MSA programs, MUSCLE (v3.8.31) [<xref ref-type="bibr" rid="pcbi.1004936.ref002">2</xref>], MAFFT (v7.158b) [<xref ref-type="bibr" rid="pcbi.1004936.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1004936.ref005">5</xref>], Clustal-Ω (v 1.2.0) [<xref ref-type="bibr" rid="pcbi.1004936.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1004936.ref023">23</xref>] and Kalign (v2.04) [<xref ref-type="bibr" rid="pcbi.1004936.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004936.ref025">25</xref>] as well as to Dialign (v2.2) [<xref ref-type="bibr" rid="pcbi.1004936.ref026">26</xref>, <xref ref-type="bibr" rid="pcbi.1004936.ref027">27</xref>], which, like GISMO, is designed to align conserved regions in sequences that share local homology but are otherwise unrelated [<xref ref-type="bibr" rid="pcbi.1004936.ref028">28</xref>]. For all programs, we obtained the latest versions and used the default parameter settings; for MAFFT this involved using the–auto option, which allows the program to choose the best settings.</p>
</sec>
<sec id="sec011">
<title>Alignment quality</title>
<p>We assess alignment accuracy using SP-scores, with the CDD alignments as benchmarks. In brief, an SP-score (from "Sum of the Pairs") is the proportion of aligned pairs of residues within a benchmark multiple alignment, that are similarly aligned within a test multiple alignment. Note that the term "SP-score", with a related but distinct meaning, frequently describes elsewhere an objective measure of multiple alignment quality, as opposed to a measure of alignment accuracy with reference to a benchmark, its meaning here. Note also that our benchmark CDD alignments leave many residues in many sequences unaligned, and these are ignored in calculating SP-scores, so a program that aligns these residues is neither penalized nor advantaged. In practice, GISMO leaves many of these residues unaligned as well, in contrast to most other multiple alignment programs. To the extent that one is not merely agnostic about these residues’ proper alignment, but believes they should in fact be left unaligned, GISMO's performance is underestimated here.</p>
<p>To compare GISMO to other programs, we define the GISMO ∆SP-score as the SP-score for GISMO minus the SP-score for the other program. <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2</xref> </bold>plots GISMO ∆SP-scores as a function of several MSA features, namely the number of aligned sequences (<bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2A and 2B</xref></bold>), the ratio of domain to mean sequence length (<bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2C</xref></bold>), and the relative entropy as an indicator of sequence diversity (<bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2D</xref></bold>). The plotted scores are averages for each of four equal-sized partitions of the 408 CDD test sets (i.e., 102 in each partition); the first through fourth partitions contain those test sets having the lowest to highest values, respectively, for the various independent variables. For comparison, <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2A and 2B</xref> </bold>also include a fifth partition consisting of 162 Balibase 3 [<xref ref-type="bibr" rid="pcbi.1004936.ref029">29</xref>] test sets, which contain fewer aligned sequences (35 on average) than do CDD MSAs, are less diverse and are typically truncated versions of the full-length sequences. <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2A</xref></bold> reveals that GISMO performs worse than all of the other programs on the Balibase 3 sequence sets, but progressively better on the progressively larger CDD sequence sets. A plausible explanation for this is that, as the number of sequences increases, so does GISMO’s statistical power to infer subtle sequence properties leading to higher quality alignments. These properties include both residue and indel probabilities at each position in each alignment, with indel probabilities likely to depend on the number of sequences to a greater extent because more observations are required for their accurate estimation. For the 408 CDD MSAs GISMO ∆SP-scores were statistically significant based on a one-tailed Wilcoxon signed rank test [<xref ref-type="bibr" rid="pcbi.1004936.ref030">30</xref>] with <italic>p</italic> &lt; 10<sup>−5</sup> for all five programs (see <bold><xref ref-type="supplementary-material" rid="pcbi.1004936.s001">S1 Statistics</xref></bold>); based on the corresponding Z-scores, CLUSTAL- Ω (Z = +4.31) and MAFFT (Z = +6.02) performed better than MUSCLE, DIALIGN and KALIGN (Z = 8.87, 11.73, and 10.70, respectively).</p>
<fig id="pcbi.1004936.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004936.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Comparison of GISMO to five other MSA programs.</title>
<p>As described in the text, for each analysis the CDD test sets were first ordered based on the property specified on the x-axis and then split into four equal-sized partitions. The x-coordinates for all data points are averages, for the property in question, over the test sets assigned to the various partitions; similarly, the GISMO ΔSP-scores for each program are averages taken over these partitions. <bold>A</bold>. GISMO ΔSP-scores as a function of the number of sequences. For comparison, an additional, leftmost set of data points (shown with back-glow) corresponds to 162 out of 218 Balibase 3 test sets; for the remaining 56 Balibase sets, GISMO failed to find a statistically significant alignment presumably due to sparse data: some of these sets have as few as 4 sequences. <bold>B</bold>.GISMO ΔSP-scores as a function of the number of truncated sequences, as defined in the text. <bold>C</bold>. GISMO ΔSP-scores as a function of the ratio between the domain length and mean sequence length. For sequence sets with low ratios, the shared domain is more challenging to align due to a larger search space. <bold>D</bold>. GISMO ΔSP-scores as a function of average relative entropy (with respect to a standard background amino acid distribution and expressed in nats, with 1 nat = 1/ln(2) bits) over all column positions in each benchmark MSA; sequence diversity can be understood as inversely related to relative entropy. For sequence sets with low relative entropy, the shared domain is more difficult to align due to weaker conservation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.g002" xlink:type="simple"/>
</fig>
<p>GISMO’s enhanced alignment quality for larger sequence sets may be due either to improved detection of the conserved domain within full-length sequences or to improved placement of indels within the domain or both. The analyses in <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2B–2D</xref> </bold>examine the degree to which GISMO’s superior performance may be due to each of these factors. <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2B</xref></bold> repeats the analysis of <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2A</xref></bold> using truncated versions of the input sequences, which consist of the aligned domain region within each CDD MSA plus ten residues on each side of this region (or as many as exist, if less than ten). On the rightmost partition, containing the largest sets of truncated-sequences, GISMO performs better than the other programs. This indicates that, even when the conserved regions are predefined, GISMO yields more accurate MSAs on sufficiently large data sets. <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2C</xref></bold> plots average GISMO ∆SP-scores as a function of the ratio between conserved domain length and the average sequence length. This ratio corresponds to the relative size of the alignment space over which each MSA program needs to search for the conserved region, and therefore provides a measure of alignment difficulty. On average, GISMO alignment quality relative to these other programs improves as this ratio decreases, that is, as the level of difficulty increases. GISMO’s performance relative to these other programs likewise improves as the level of sequence diversity increases (<bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2D</xref></bold>). Together, these analyses suggest that, for large sets of diverse, full-length sequence sets, GISMO is superior both at identifying and aligning conserved domains.</p>
<p>Also worth noting about the analyses in <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2</xref> </bold>is MUSCLE’s much improved relative performance on the truncated versus the full-length sets as a function of the number of aligned sequences (compare <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2A</xref> and <xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2B</xref></bold>). This suggests that MUSCLE is better at properly aligning conserved regions than at identifying them within full-length sequences. This also illustrates how each program’s relative performance may be better on some sequence sets and worse on others. In this regard, we surmise that the reliance on benchmark sets with a rather limited range of properties has tended to favor certain MSA program niches over others. In particular, our analysis suggests that programs for aligning large sets of diverse full-length sequences are underrepresented.</p>
</sec>
<sec id="sec012">
<title>Run-to-run variability</title>
<p>Unlike most MSA programs, GISMO is stochastic and therefore will return a different MSA for each run. This raises the question of GISMO’s run-to-run SP-score variability, as well as how this compares to the variability in SP-scores among distinct deterministic programs. To start, <bold><xref ref-type="fig" rid="pcbi.1004936.g003">Fig 3A</xref></bold> plots the range of SP-scores, computed for all of the 408 CDD MSAs, and sorted from lowest to highest values separately for each program. Note that there are many low SP-scores corresponding to sequence sets that are particularly difficult to align correctly. Consistent with the <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2</xref> </bold>analyses, GISMO SP-scores are comparatively higher for its more challenging CDD benchmark sets. <bold><xref ref-type="fig" rid="pcbi.1004936.g003">Fig 3B</xref></bold> illustrates the run-to-run variability in GISMO's SP-scores, and thus in the alignments it produced. Some may find this variability disturbing, in contrast to the consistent results returned by deterministic programs. However, the consistency of results does not imply reliability. In <bold><xref ref-type="fig" rid="pcbi.1004936.g003">Fig 3C and 3D</xref> </bold>we plot the range of SP-scores produced by the six programs we have analyzed. The independent variable in these figures corresponds to a position within an array of the 408 CDD test sets; in <bold><xref ref-type="fig" rid="pcbi.1004936.g003">Fig 3C</xref></bold> this array is ordered by the (single-run) GISMO SP-score and in <bold><xref ref-type="fig" rid="pcbi.1004936.g003">Fig 3D</xref></bold> by the CLUSTAL-Ω SP-score. Comparing these graphs to <bold><xref ref-type="fig" rid="pcbi.1004936.g003">Fig 3B</xref></bold>, we see that the results produced by a collection of widely-used programs are considerably more variable than those produced by separate GISMO runs. Also, in <bold><xref ref-type="fig" rid="pcbi.1004936.g003">Fig 3C</xref></bold>, it is evident that the SP-scores for other programs are more frequently smaller rather than greater than GISMO's SP-scores. The variability of GISMO's results reflects the inherent uncertainty present in constructing alignments for most real sequence sets, and may provide a sense of the degree of this uncertainly.</p>
<fig id="pcbi.1004936.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004936.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Variability in SP-scores among six GISMO runs and among the six programs GISMO, MAFFT, CLUSTAL-Ω, MUSCLE, Dialign and Kalign.</title>
<p>SP-scores are based upon the CDD MSAs as benchmarks and vary from 0 (no correctly aligned sequence pairs) to 1 (all pairs aligned correctly). A. The sorted SP-scores for a single GISMO run (red line with yellow back-glow) compared with the sorted scores for the five other programs. B. Run-to-run variability in SP-scores over six GISMO runs. Test set data points are sorted along the x-axis by the SP-score obtained for each set on the first run (red data points) of six. C. SP-scores for the six programs analyzed, sorted by the GISMO score on each test set. GISMO SP-scores (for a single run) are shown in red. Each red data point and the five black data points (one point for each program) plotted in the same column correspond to the same test set. D. SP-scores for the six programs, sorted by the CLUSTAL-Ω score on each test set. Data points for GISMO and for CLUSTAL-Ω are shown in red and green, respectively.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.g003" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec013">
<title>Program runtimes</title>
<p>Log-log plots of each program’s runtimes for each of the 408 CDD test sets are given in <bold><xref ref-type="fig" rid="pcbi.1004936.g004">Fig 4</xref></bold>, which shows runtimes as a function of the sum of the input lengths for each test set. The average runtime for GISMO was 204 minutes, which is the slowest. GISMO took 971 and 89 times longer to run, on average, than the two fastest programs Kalign and MAFFT, respectively; GISMO took 13 and 4 times longer, on average, than Clustal-Ω and MUSCLE, respectively. However, GISMO’s runtime <italic>t</italic> is roughly estimated to be a linear function of <italic>N</italic> ≡ the total input length based on the slopes of the trendlines in <bold><xref ref-type="fig" rid="pcbi.1004936.g004">Fig 4</xref></bold>. The MAFFT data points lack a trendline because MAFFT applies one of several different algorithmic strategies based on the input set, which led to the discontinuity evident in <xref ref-type="fig" rid="pcbi.1004936.g004">Fig 4</xref>. The trendlines for the remaining programs indicate runtimes roughly proportional to <italic>N</italic><sup>1.6</sup> and <italic>N</italic><sup>2.2</sup>. There is considerable variability in GISMO runtimes for a given <italic>N</italic>, presumably due to differences in alignment difficulty: the subtlety and length of conserved regions can vary substantially between test sets having the same <italic>N</italic>. GISMO continues to perform sampling iterations as long as the evolving alignment continues to improve significantly based on its log-likelihood (see <xref ref-type="sec" rid="sec017">Methods</xref>). This potential increase in sampling time may be offset by an increase in statistical power with increasing numbers of sequences, thereby allowing the sampler to converge more rapidly due to a higher signal-to-noise ratio. This can explain why the trendline for GISMO runtimes as a function of <italic>N</italic> remains roughly linear. Runtimes for most of the other programs also exhibit a fair amount of scatter for a given <italic>N</italic> (<bold><xref ref-type="fig" rid="pcbi.1004936.g004">Fig 4</xref></bold>), but their alignment quality fails to improve with increasing <italic>N</italic> relative to GISMO. GISMO's slowly increasing runtimes and its enhanced alignment quality relative to that of other programs for the progressively larger data sets examined here (<bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2</xref></bold>) places it among the methods of choice for even larger data sets consisting of tens of thousands of sequences.</p>
<fig id="pcbi.1004936.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004936.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Log-log plots of program runtimes as a function of the total input length.</title>
<p>Each data point corresponds to one MSA generated by the program indicated. Estimated time complexities based on trendline slopes were for: GISMO, <italic>t</italic> ∝ <italic>N</italic><sup>0.96</sup>; Clustal-Ω, <italic>t</italic> ∝ <italic>N</italic><sup>1.6</sup>; Kalign, <italic>t</italic> ∝ <italic>N</italic><sup>1.6</sup>; MUSCLE, <italic>t</italic> ∝ <italic>N</italic><sup>2.1</sup> and Dialign <italic>t</italic> ∝ <italic>N</italic><sup>2.2</sup>, where <italic>N</italic> is the total number of residues in the aligned sequences. A trendline is not shown for MAFFT because (with the–auto option) it uses one of several different algorithms depending on the input sequence set; this produces a discontinuity in the data points.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec014">
<title>Prefab benchmarking</title>
<p>Because GISMO is designed to align only those regions conserved by all of the sequences included in the input set, it is most appropriate to benchmark it against CDD alignments, which likewise only align the common conserved region. However, we were curious to know how it performs against a benchmark set designed for MSA programs that globally align all of the input sequences. For this we selected the Prefab benchmark set [<xref ref-type="bibr" rid="pcbi.1004936.ref031">31</xref>], which consists of 1,682 pairs of structurally aligned sequences. To enlarge each Prefab input set we added up to 1,000 representative homologous sequences (based on how many were available for each family); these expanded Prefab sets (collectively termed Prefab+) are available from the GISMO website. Inasmuch as GISMO will leave unaligned those regions within each Prefab pair that are not conserved in the other sequences, it is disadvantaged relative to the MAFFT, MUSCLE, Clustal-Ω and Kalign programs, which will globally align the input sequences. This is especially true for closely related Prefab sequence pairs, as is illustrated in <xref ref-type="supplementary-material" rid="pcbi.1004936.s003">S1 Text</xref>. Despite this handicap, GISMO scores about as well as these other programs on the 1,682 Prefab+ alignments overall (see Wilcoxon signed rank test results in <xref ref-type="supplementary-material" rid="pcbi.1004936.s002">S2 Statistics</xref>). Consistent with our CDD benchmark test results, GISMO performs significantly better than these programs on the 841 largest Prefab+ input sets and on the 841 most distantly related Prefab+ input sets; significantly worse on the 841 smallest sets; and significantly worse than MAFFT and Kalign and about the same as MUSCLE and Clustal-Ω on the 841 most similar sequence sets.</p>
</sec>
<sec id="sec015">
<title>GISMO example alignments</title>
<p>An example of how GISMO aligns representative proteins of known structure for acetylase domain proteins is shown in <bold><xref ref-type="fig" rid="pcbi.1004936.g005">Fig 5</xref></bold>. This illustrates how GISMO’s inferred position-specific gap penalties tend to align sequences as conserved indel-sparse “blocks”, which typically correspond to the proteins’ structural core. In contrast, alignments generated by other programs typically have more gaps. This is seen, for example, in <bold><xref ref-type="supplementary-material" rid="pcbi.1004936.s009">S2</xref>–<xref ref-type="supplementary-material" rid="pcbi.1004936.s014">S7</xref> Figs</bold>, which compare the GISMO and MAFFT alignments for representative proteins containing PH, α,β-hydrolase fold and SH2 domains. We chose MAFFT for comparison because it obtained the best GISMO ΔSP-scores when aligning conserved regions within much longer sequences (leftmost data points in <bold><xref ref-type="fig" rid="pcbi.1004936.g002">Fig 2C</xref></bold>).</p>
<fig id="pcbi.1004936.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004936.g005</object-id>
<label>Fig 5</label>
<caption>
<title>GISMO acetylase domain alignment.</title>
<p>Representative proteins of known structure are shown—no two of which share more than 27% sequence identity over the domain footprint. The full alignment consists of 2,125 sequences.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.g005" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec016" sec-type="conclusions">
<title>Discussion</title>
<p>By eliminating the need for a guide tree, our earlier MSA Gibbs samplers [<xref ref-type="bibr" rid="pcbi.1004936.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1004936.ref011">11</xref>] constituted a fundamental shift away from conventional progressive alignment methods. They also placed the multiple alignment problem on a firm statistical foundation. However, these samplers modeled indels and amino acid residue prior probabilities inadequately, and often became trapped in misaligned states due to sequence correlations. As a result these samplers were slow and often converged on alignments that were far from optimal. Here we address these inadequacies by incorporating adaptive, position-specific gap penalties, Dirichlet mixture priors and correlated-sequence sampling strategies. As implemented in the GISMO program and illustrated here, these enhancements have yielded improvements in alignment quality.</p>
<p>GISMO’s advantage over progressive alignment methods is most noticeable when a shared domain is present within long, multi-domain proteins. Consider, for example, the MAFFT and GISMO MSAs in <bold><xref ref-type="supplementary-material" rid="pcbi.1004936.s009">S2</xref> and <xref ref-type="supplementary-material" rid="pcbi.1004936.s010">S3</xref> Figs</bold>, which consist of 582 PH domain protein sequences ranging in length from 94 to 7968 residues with an average length of 891 residues. By iteratively aligning each sequence to a relatively short HMM (the PH domain model consists of about 100 residues) GISMO avoids the problem of aligning pairs of long sequences, consisting mostly of unrelated regions. Moreover, it appears that these unrelated regions can easily mislead progressive alignment methods: Other than GISMO, all of the programs analyzed here will readily align even random sequences. A MAFFT alignment of shuffled PH protein sequences is shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1004936.s015">S8 Fig</xref></bold>. Clustal-Ω, MUSCLE, Dalign and Kalign likewise will align these same random sequences, although quite differently from MAFFT.</p>
<p>In contrast, due to its statistical basis, GISMO will align only sequences sharing significant similarity. This feature also allows GISMO to identify the HMM architecture and parameters most likely to generate the input sequences and to thereby define the extent of the core alignment more precisely. Sampling from the Bayesian posterior probability distribution leads to output alignment variability, which some biologists might find troubling. However, we believe that this allows a more realistic assessment of what can reliably be inferred from the input sequences than does repeatedly returning the same suboptimal alignment. As illustrated in <bold><xref ref-type="fig" rid="pcbi.1004936.g003">Fig 3</xref></bold>, independent sampling runs can also provide some sense of alignment uncertainty.</p>
<p>For some domains, different runs of the current version of GISMO (or runs of different programs) generate significantly differing alignments, some of which appear to be far from optimal. However, the statistical and algorithmic foundations laid here provide avenues for further improvement: Close examination of misaligned regions can suggest new sampling strategies for escaping suboptimal traps. Such strategies may yield more than merely incremental improvement to alignment results. With this in view, we anticipate many further enhancements to GISMO. In particular, there is a large body of literature on MCMC sampling strategies [<xref ref-type="bibr" rid="pcbi.1004936.ref032">32</xref>] that, when applied, could lead to more rapid convergence on near optimal alignments. More generalized sampling strategies could allow the alignment of multiple copies of a conserved domain within individual sequences, or the automated exclusion of input sequences lacking the conserved domain. Thus far, we have not focused on optimizing GISMO’s code, which lends itself readily to parallelization, and we anticipate being able to increase its speed substantially.</p>
<p>Finally, we ask: What is the benefit of a large, high quality alignment of evolutionarily-related sequences? We suggest an answer through an analogy to physical chemistry: Statistical thermodynamics describes the macroscopic properties of matter as average molecular properties arising from probability distributions over quantum mechanical states. Its central concept is the Boltzmann distribution, which specifies the most probable population of molecular states for a system in thermodynamic equilibrium. This distribution defines all of the thermodynamic properties central to our understanding of chemistry—such as entropy, heat capacity, enthalpy and free energy.</p>
<p>Likewise, the biological properties of proteins may be better understood by considering average properties implied by probability distributions over polypeptide states, with the central concept being a distribution specifying the most probable population of sequences for a protein class in evolutionary equilibrium. GISMO can be used, in combination with a companion MCMC sampler for protein classification [<xref ref-type="bibr" rid="pcbi.1004936.ref033">33</xref>, <xref ref-type="bibr" rid="pcbi.1004936.ref034">34</xref>], to define such a distribution and, by implication, the sequences that arise due to their underlying biochemical properties. Thus, by analogy to thermodynamics, identifying the most statistically striking features of protein sequences indirectly elucidates these biological properties. With this as partial motivation, the GISMO program is being incorporated into a broader project for modeling protein domains [<xref ref-type="bibr" rid="pcbi.1004936.ref035">35</xref>].</p>
</sec>
<sec id="sec017" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec018">
<title>Notation and definitions</title>
<p>The following notation is used for vectors <bold>v</bold> = (<italic>v</italic><sub>1</sub>,…,<italic>v</italic><sub><italic>n</italic></sub>)<sup><italic>T</italic></sup> and <bold>w</bold> = (<italic>w</italic><sub>1</sub>,…,<italic>w</italic><sub><italic>n</italic></sub>)<sup><italic>T</italic></sup>: |<bold>v</bold>| = |<italic>v</italic><sub>1</sub>|+…+|<italic>v</italic><sub><italic>n</italic></sub>|, <bold>v</bold>+<bold>w</bold> = (<italic>v</italic><sub>1</sub>+<italic>w</italic><sub>1</sub>,…,<italic>v</italic><sub><italic>n</italic></sub>+<italic>w</italic><sub><italic>n</italic></sub>)<sup><italic>T</italic></sup>, <bold>v</bold>/<bold>w</bold> = (<italic>v</italic><sub>1</sub>/<italic>w</italic><sub>1</sub>,…,<italic>v</italic><sub><italic>n</italic></sub>/<italic>w</italic><sub><italic>n</italic></sub>)<sup><italic>T</italic></sup>, <inline-formula id="pcbi.1004936.e001"><alternatives><graphic id="pcbi.1004936.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:msup><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold">w</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>…</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and Γ(<bold>v</bold>) = Γ(<italic>v</italic><sub>1</sub>)…Γ(<italic>v</italic><sub><italic>n</italic></sub>). Given <italic>K</italic> proteins, their sequences are defined by <inline-formula id="pcbi.1004936.e002"><alternatives><graphic id="pcbi.1004936.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mi>K</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> where each vector <inline-formula id="pcbi.1004936.e003"><alternatives><graphic id="pcbi.1004936.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> corresponds to the <italic>k</italic>-th sequence, <italic>n</italic><sub><italic>k</italic></sub> is the <italic>k</italic>-th sequence’s length and the <italic>r</italic><sub><italic>k</italic>,<italic>i</italic></sub> corresponds to the <italic>i</italic>-th residue in that sequence. <bold>h</bold>( ) defines a counting function where, for example, <bold>h</bold>(<italic>R</italic><sub><italic>k</italic></sub>) returns a length 20 vector of the counts for the residue types in <italic>R</italic><sub><italic>k</italic></sub>.</p>
<p>A block-based alignment of the input sequences is defined by <italic>w</italic> columns. The set of variables defining the sequence positions for column <italic>j</italic> is defined by <italic>A</italic><sub><italic>j</italic></sub> = {<italic>a</italic><sub>1,<italic>j</italic></sub>,…,<italic>a</italic><sub><italic>K</italic>,<italic>j</italic></sub>}. We define <italic>A</italic><sub><italic>j</italic>[−<italic>k</italic>]</sub> ≡ <italic>A</italic><sub><italic>j</italic></sub> − {<italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub>} to denote the set <italic>A</italic><sub><italic>j</italic></sub> without <italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub>. An alignment is defined by the matrix <bold>A</bold> = (<italic>A</italic><sub>1</sub>,…,<italic>A</italic><sub><italic>w</italic></sub>)<sup><italic>T</italic></sup> and {<bold>A</bold>} ≡ {<italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub>: <italic>k</italic> = 1,..,<italic>K</italic>, <italic>j</italic> = 1,…,<italic>w</italic>} denotes the set of residues indices for the alignment variable <bold>A</bold>. We represent the collection of residues indexed by elements in a set C as <bold>R</bold><sub><italic>C</italic></sub>. For instance, <bold>R</bold><sub>{<bold>A</bold>}</sub> = {<italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub>: <italic>k</italic> = 1,…,<italic>K</italic>; <italic>j</italic> = 1,…<italic>w</italic>} represents the set of residues in the alignment defined by <bold>A</bold>.</p>
</sec>
<sec id="sec019">
<title>GISMO statistical model</title>
<p>The residue frequencies observed for column <italic>c</italic> are modeled as a multinomial distribution with parameters <bold>θ</bold><sub><italic>c</italic></sub> = (<italic>θ</italic><sub>1,<italic>c</italic></sub>,…,<italic>θ</italic><sub>20,<italic>c</italic></sub>)<sup><italic>T</italic></sup> where <inline-formula id="pcbi.1004936.e004"><alternatives><graphic id="pcbi.1004936.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mn>20</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> and <italic>θ</italic><sub><italic>i</italic>,<italic>c</italic></sub> &gt; 0 for all <italic>i</italic>. That is, the vector <bold>Θ</bold> = (<bold>θ</bold><sub>1</sub>,…,<bold>θ</bold><sub><italic>w</italic></sub>) defines a product multinomial model corresponding to the full alignment. The vector <bold>θ</bold><sub>0</sub> corresponds to a background amino acid residue distribution. Hence, the complete-data likelihood function is given by
<disp-formula id="pcbi.1004936.e005">
<alternatives>
<graphic id="pcbi.1004936.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e005" xlink:type="simple"/>
<mml:math display="block" id="M5">
<mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Θ</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msubsup><mml:mi mathvariant="bold">θ</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi mathvariant="bold">R</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:munderover></mml:mstyle><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi mathvariant="bold">θ</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">θ</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where it is assumed that Θ ∼ <italic>D</italic>(B) and <bold>θ</bold><sub>0</sub> ∼ <italic>D</italic>(<bold>α</bold>) (where <italic>D</italic> denotes the Dirichlet distribution), and where B = (<italic>β</italic><sub>1</sub>,…,<italic>β</italic><sub><italic>w</italic></sub>) specifies the Dirichlet distribution parameters (commonly interpreted as numbers of pseudocounts) at each column position <italic>j</italic>, and <bold>α</bold> specifies the parameters for the background distribution. (Recall that the alignment is specified by the matrix <bold>A</bold> = (<italic>A</italic><sub>1</sub>,…,<italic>A</italic><sub><italic>w</italic></sub>) = (<italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub>)<sub><italic>K</italic>×<italic>w</italic></sub> where <italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub> indicates the position of the <italic>j-</italic>th column, which is assumed to be present in all of the sequences.) The likelihood of <bold>A</bold> with the <bold>θ</bold>’s integrated out is
<disp-formula id="pcbi.1004936.e006">
<alternatives>
<graphic id="pcbi.1004936.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e006" xlink:type="simple"/>
<mml:math display="block" id="M6">
<mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold">A</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi mathvariant="bold">α</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula></p>
<p>The conditional predictive probability distribution of this conserved region occurring at position <italic>i</italic> in sequence <italic>k</italic> is given by
<disp-formula id="pcbi.1004936.e007">
<alternatives>
<graphic id="pcbi.1004936.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e007" xlink:type="simple"/>
<mml:math display="block" id="M7">
<mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">A</mml:mi><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi mathvariant="bold">R</mml:mi></mml:mrow></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msup><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi mathvariant="bold">θ</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where the <inline-formula id="pcbi.1004936.e008"><alternatives><graphic id="pcbi.1004936.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi mathvariant="bold">θ</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are the posterior means of the <bold>θ</bold>, given the observed sequence data <bold>R</bold> and the current alignment <bold>A</bold><sub>[−<italic>k</italic>]</sub>. This statistical model serves as the foundation for the HMM [<xref ref-type="bibr" rid="pcbi.1004936.ref010">10</xref>] used in later stages of sampling.</p>
</sec>
<sec id="sec020">
<title>Dirichlet mixture priors</title>
<p>In order to capture the fact that certain biochemically or structurally similar amino acid residues are more likely to occur together we have incorporated Dirichlet Mixture priors [<xref ref-type="bibr" rid="pcbi.1004936.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1004936.ref016">16</xref>], as refined by [<xref ref-type="bibr" rid="pcbi.1004936.ref017">17</xref>]. In order to speed up sampling, GISMO uses a 20 component mixture in the first (competitive) phase of sample, inasmuch as the goal is to merely obtain a reasonable starting alignment without overtraining the evolving HMM. After this initial phase GISMO applies a 58-component mixture.</p>
</sec>
<sec id="sec021">
<title>Down weighting for sequence redundancy</title>
<p>Sequences are down weighted for redundancy using the following procedure. For each sequence <italic>k</italic> a non-integer weight is computed using the method of Henikoff and Henikoff [<xref ref-type="bibr" rid="pcbi.1004936.ref018">18</xref>] as:
<disp-formula id="pcbi.1004936.e009">
<alternatives>
<graphic id="pcbi.1004936.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e009" xlink:type="simple"/>
<mml:math display="block" id="M9">
<mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <inline-formula id="pcbi.1004936.e010"><alternatives><graphic id="pcbi.1004936.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the number of residue types at each position <italic>j</italic> and where <inline-formula id="pcbi.1004936.e011"><alternatives><graphic id="pcbi.1004936.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo>≤</mml:mo><mml:mi>K</mml:mi><mml:mo>∧</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the number of sequences with the same residue at position <italic>j</italic> as for sequence <italic>k</italic>. The rationale for this formulation is that if a sequence matches lots of sequences at most positions, then it should receive a lower weight than a sequence that matches few sequences at most positions. These weights are then normalized and integerized as:
<disp-formula id="pcbi.1004936.e012">
<alternatives>
<graphic id="pcbi.1004936.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mrow><mml:mi>W</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>⌈</mml:mo><mml:mrow><mml:mn>100</mml:mn><mml:mo>⋅</mml:mo><mml:mi>W</mml:mi><mml:mi>t</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>÷</mml:mo><mml:mi>w</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mtext>max</mml:mtext></mml:mrow></mml:msub></mml:mrow><mml:mo>⌉</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>wt</italic><sub>max</sub> corresponds to the maximum non-integer sequence weight. Because these weights depend upon the evolving alignment, they are updated after each sampling cycle.</p>
</sec>
<sec id="sec022">
<title>Inferred HMM transition probabilities</title>
<p>We model the transition probabilities for the HMM shown in <bold><xref ref-type="fig" rid="pcbi.1004936.g001">Fig 1B</xref></bold> using a generalization of our previous formulation [<xref ref-type="bibr" rid="pcbi.1004936.ref010">10</xref>] as follows. The probability matrix for transitions from column <italic>j</italic> states in the HMM is:
<disp-formula id="pcbi.1004936.e013">
<alternatives>
<graphic id="pcbi.1004936.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mspace width="0.25em"/></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>M</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>I</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mrow><mml:mi>j</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mtext>M</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ι</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>ι</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mtext>I</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ι</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>ι</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where 1 ≤ <italic>j</italic> ≤ <italic>w</italic> and where M, I, and D denote match, insertion and deletion states, respectively. The probability matrix for transitions out of the start state is:
<disp-formula id="pcbi.1004936.e014">
<alternatives>
<graphic id="pcbi.1004936.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mspace width="0.25em"/></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>M</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mtext>D</mml:mtext><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mtext>Start</mml:mtext></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Transitions into M and I states emit a residue as specified by the Θ of our statistical model.</p>
<p><italic>Inference of transition probabilities</italic>. For a given alignment <bold><italic>A</italic></bold>, each sequence <italic>S<sub>k</sub></italic> is associated with a “path” through the HMM indicating its alignment against the model Θ. We denote the collection of these paths by Λ and the total number of HMM transitions of type M→M, M→I, …, D→D at position <italic>j</italic> by
<disp-formula id="pcbi.1004936.e015">
<alternatives>
<graphic id="pcbi.1004936.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e015" xlink:type="simple"/>
<mml:math display="block" id="M15">
<mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mspace width="0.25em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:mi>j</mml:mi><mml:mo stretchy="false">]</mml:mo><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Ignoring the indexing variable <italic>j</italic> for clarity, the likelihood of the transition probability parameters at each position is
<disp-formula id="pcbi.1004936.e016">
<alternatives>
<graphic id="pcbi.1004936.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e016" xlink:type="simple"/>
<mml:math display="block" id="M16">
<mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi>ι</mml:mi><mml:mo>,</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ι</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msubsup><mml:mi>ι</mml:mi><mml:mi>o</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>o</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ι</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msubsup><mml:mi>ι</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup><mml:msubsup><mml:mi>δ</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msubsup><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
with independent prior distributions
<disp-formula id="pcbi.1004936.e017">
<alternatives>
<graphic id="pcbi.1004936.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e017" xlink:type="simple"/>
<mml:math display="block" id="M17">
<mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>ι</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ι</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>∼</mml:mo><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:msub><mml:mi>ι</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mtext>and</mml:mtext><mml:mspace width="0.25em"/><mml:msub><mml:mi>δ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>n</italic><sub><italic>mi</italic></sub>, <italic>n</italic><sub><italic>md</italic></sub>, <italic>n</italic><sub><italic>mm</italic></sub>, <italic>n</italic><sub><italic>ii</italic></sub>, <italic>n</italic><sub><italic>im</italic></sub>, <italic>n</italic><sub><italic>dd</italic></sub>, <italic>n</italic><sub><italic>dm</italic></sub> are corresponding prior pseudo counts. The corresponding maximum a posteriori probability (MAP) estimates for the transition probabilities at each position <italic>j</italic> are computed from these observed and prior counts. These define the position specific gap penalties. The joint posterior distribution for the alignment and transition probability parameters is
<disp-formula id="pcbi.1004936.e018">
<alternatives>
<graphic id="pcbi.1004936.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e018" xlink:type="simple"/>
<mml:math display="block" id="M18">
<mml:mrow><mml:mi>g</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">R</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
where <italic>P</italic>(<bold>R</bold>|<bold>A</bold>,Λ) is a generalization of Equation (1), and where <inline-formula id="pcbi.1004936.e019"><alternatives><graphic id="pcbi.1004936.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1004936.e020"><alternatives><graphic id="pcbi.1004936.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are length <italic>w</italic> vectors representing the column-specific transition probabilities with prior probability:
<disp-formula id="pcbi.1004936.e021">
<alternatives>
<graphic id="pcbi.1004936.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e021" xlink:type="simple"/>
<mml:math display="block" id="M21">
<mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>w</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Given the alignment and thus the paths Λ, we have the conditional posterior distribution
<disp-formula id="pcbi.1004936.e022">
<alternatives>
<graphic id="pcbi.1004936.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e022" xlink:type="simple"/>
<mml:math display="block" id="M22">
<mml:mtable columnalign="right"><mml:mtr><mml:mtd><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>|</mml:mo><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>A</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>ι</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ι</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>×</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mrow><mml:msub><mml:mi>ι</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>ι</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Sampling on the distribution for each position <italic>j</italic> is done by drawing the random variables:
<disp-formula id="pcbi.1004936.e023">
<alternatives>
<graphic id="pcbi.1004936.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e023" xlink:type="simple"/>
<mml:math display="block" id="M23">
<mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004936.e024">
<alternatives>
<graphic id="pcbi.1004936.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e024" xlink:type="simple"/>
<mml:math display="block" id="M24">
<mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004936.e025">
<alternatives>
<graphic id="pcbi.1004936.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e025" xlink:type="simple"/>
<mml:math display="block" id="M25">
<mml:mrow><mml:msub><mml:mi>ι</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>δ</mml:mi><mml:mi>o</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:msubsup><mml:mi>ι</mml:mi><mml:mi>o</mml:mi><mml:mi>*</mml:mi></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mspace width="0.25em"/><mml:mtext>where</mml:mtext><mml:mspace width="0.35em"/><mml:msubsup><mml:mi>ι</mml:mi><mml:mi>o</mml:mi><mml:mi>*</mml:mi></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004936.e026">
<alternatives>
<graphic id="pcbi.1004936.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e026" xlink:type="simple"/>
<mml:math display="block" id="M26">
<mml:mrow><mml:mtext>and</mml:mtext><mml:mspace width="0.35em"/><mml:msub><mml:mi>ι</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mtext>Beta</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>For computational efficiency, the ι and δ may be integrated out [<xref ref-type="bibr" rid="pcbi.1004936.ref010">10</xref>] to get
<disp-formula id="pcbi.1004936.e027">
<alternatives>
<graphic id="pcbi.1004936.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e027" xlink:type="simple"/>
<mml:math display="block" id="M27">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∬</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="2em"/><mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
</disp-formula></p>
<p>This gives rise to a new posterior distribution <italic>g</italic>(<bold>A</bold>, Λ) ∝ <italic>P</italic>(<bold>R</bold> | <bold>A</bold>, Λ) × <italic>h</italic>(Λ), for which the transition probability parameters need not be fixed or updated and which allows the optimal indel penalties to be determined from the sequence data.</p>
</sec>
<sec id="sec023">
<title>Sampling algorithm</title>
<p>GISMO’s MCMC sampling algorithm explores the space of possible alignments by executing Markovian transitions between alignments. This involves sampling alternative alignments of either individual sequences or groups of sequences. In either case, such sampling is done as follows: First, the sequence or sequences are removed from the alignment and the posterior parameters of the HMM are recalculated based on the retained aligned sequences and the priors. Next, emission probabilities for the twenty amino acids at each position are sampled from the posterior emission probability distributions defined by the HMM parameters; note that these sampled probabilities define a sampled HMM. Finally, the previously removed sequences are optimally realigned to the sampled HMM. We explored sampling transition probabilities in the same way, but found little benefit of doing so; instead, the MAP estimates for transition probabilities are used. GISMO applies simulated annealing [<xref ref-type="bibr" rid="pcbi.1004936.ref036">36</xref>] to favor convergence on an optimal alignment in later stages of sampling. Sampling starts at a “temperature” of <italic>T</italic> = 1 (i.e., sample each transition directly proportional to its actual probability <italic>p</italic>) and ends at <italic>T</italic> = 0 (i.e., always take the highest probability transition); between these two extremes the temperature is dropped in <italic>ΔT</italic> = 0.1 increments with sampling probabilities set to <inline-formula id="pcbi.1004936.e028"><alternatives><graphic id="pcbi.1004936.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004936.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mfrac bevelled="true"><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. Sampling iteratively through all of the sequences continues until this fails to find a new highest probability state.</p>
</sec>
<sec id="sec024">
<title>Availability</title>
<p>The GISMO program and the CDD benchmark MSAs and sequence sets used for this study are available at <ext-link ext-link-type="uri" xlink:href="http://gismo.igs.umaryland.edu/" xlink:type="simple">http://gismo.igs.umaryland.edu/</ext-link>.</p>
</sec>
</sec>
<sec id="sec025">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004936.s001" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s001" xlink:type="simple">
<label>S1 Statistics</label>
<caption>
<title>Excel file with one-tail Wilcoxon signed rank tests for CDD runs.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s002" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s002" xlink:type="simple">
<label>S2 Statistics</label>
<caption>
<title>Excel file with one-tail Wilcoxon signed rank tests for Prefab+ runs.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s003" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Explains why Prefab sets are poorly designed for benchmarking GISMO.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s004" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s004" xlink:type="simple">
<label>S1 Charts</label>
<caption>
<title>Excel file containing SP-score data and charts for full length sequence sets.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s005" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s005" xlink:type="simple">
<label>S2 Charts</label>
<caption>
<title>Excel file containing SP-score data and charts for truncated sequence sets.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s006" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s006" xlink:type="simple">
<label>S3 Charts</label>
<caption>
<title>Excel file containing SP-score data and charts for multiple GISMO runs.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s007" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s007" xlink:type="simple">
<label>S1 Runtimes</label>
<caption>
<title>Excel file containing data and charts for program runtime analyses.</title>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s008" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Misaligned, correlated sequences within an alignment of enolases.</title>
<p>The nine sequences between the two lines are misaligned; the insert residues shown in red correspond structurally to the first 10 columns shown. Note that these misaligned sequences share two distinguishing features: (i) they contain 27–30 residue insertions that the other sequences lack and they conserve a glycine (G) residue in the seventh column instead of the consensus arginine (R) residue. GISMO relies on such features to identify and realign clusters of correlated sequences.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s009" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Representative sequences of known structure from a GISMO alignment of 532 PH domains.</title>
<p>This corresponds to the same sequences and domain footprint as the MAFFT alignment in <xref ref-type="supplementary-material" rid="pcbi.1004936.s010">S3 Fig</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s010" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Representative sequences of known structure from a MAFFT alignment of 582 PH domains.</title>
<p>This corresponds to the same sequences and domain footprint as the GISMO alignment in <xref ref-type="supplementary-material" rid="pcbi.1004936.s009">S2 Fig</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s011" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Representative sequences of known structure from a GISMO alignment of 836 α,β-hydrolase fold domains.</title>
<p>This corresponds to the same sequences and domain footprint as the MAFFT alignment in <xref ref-type="supplementary-material" rid="pcbi.1004936.s012">S5 Fig</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s012" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Representative sequences of known structure from the MAFFT alignment of 836 α,β-hydrolase fold domains.</title>
<p>This corresponds to the same sequences and domain footprint as the GISMO alignment in <xref ref-type="supplementary-material" rid="pcbi.1004936.s011">S4 Fig</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s013" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Representative sequences of known structure from a GISMO alignment of 2,193 SH2 domains.</title>
<p>This corresponds to the same sequences and domain footprint as the MAFFT alignment in <xref ref-type="supplementary-material" rid="pcbi.1004936.s014">S7 Fig</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s014" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Representative sequences of known structure from the MAFFT alignment of 2,193 SH2 domains.</title>
<p>This corresponds to the same sequences and domain footprint as the GISMO alignment in <xref ref-type="supplementary-material" rid="pcbi.1004936.s013">S6 Fig</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004936.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004936.s015" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>MAFFT alignment of 99 randomly shuffled PH domain proteins.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank L. Aravind for critical assessment of the GIMSO program and helpful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004936.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Feng</surname> <given-names>DF</given-names></name>, <name name-style="western"><surname>Doolittle</surname> <given-names>RF</given-names></name>. <article-title>Progressive sequence alignment as a prerequisite to correct phylogenetic trees</article-title>. <source>J Mol Evol</source>. <year>1987</year>;<volume>25</volume>(<issue>4</issue>):<fpage>351</fpage>–<lpage>60</lpage>. <object-id pub-id-type="pmid">3118049</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>. <source>BMC Bioinformatics</source>. <year>2004</year>;<volume>5</volume>(<issue>1</issue>):<fpage>113</fpage>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Misawa</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kuma</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Miyata</surname> <given-names>T</given-names></name>. <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source>Nucleic Acids Res</source>. <year>2002</year>;<volume>30</volume>(<issue>14</issue>):<fpage>3059</fpage>–<lpage>66</lpage>. <object-id pub-id-type="pmid">12136088</object-id></mixed-citation></ref>
<ref id="pcbi.1004936.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Standley</surname> <given-names>DM</given-names></name>. <article-title>MAFFT multiple sequence alignment software version 7: improvements in performance and usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>;<volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/mst010" xlink:type="simple">10.1093/molbev/mst010</ext-link></comment> <object-id pub-id-type="pmid">23329690</object-id>; PubMed Central PMCID: PMC3603318.</mixed-citation></ref>
<ref id="pcbi.1004936.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Standley</surname> <given-names>DM</given-names></name>. <article-title>MAFFT: iterative refinement and additional methods</article-title>. <source>Methods Mol Biol</source>. <year>2014</year>;<volume>1079</volume>:<fpage>131</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-62703-646-7_8" xlink:type="simple">10.1007/978-1-62703-646-7_8</ext-link></comment> <object-id pub-id-type="pmid">24170399</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Toh</surname> <given-names>H</given-names></name>. <article-title>PartTree: an algorithm to build an approximate tree from a large number of unaligned sequences</article-title>. <source>Bioinformatics</source>. <year>2007</year>;<volume>23</volume>(<issue>3</issue>):<fpage>372</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl592" xlink:type="simple">10.1093/bioinformatics/btl592</ext-link></comment> <object-id pub-id-type="pmid">17118958</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blackshields</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sievers</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Shi</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Wilm</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Higgins</surname> <given-names>DG</given-names></name>. <article-title>Sequence embedding for fast construction of guide trees for multiple sequence alignment</article-title>. <source>Algorithms Mol Biol</source>. <year>2010</year>;<volume>5</volume>:<fpage>21</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1748-7188-5-21" xlink:type="simple">10.1186/1748-7188-5-21</ext-link></comment> <object-id pub-id-type="pmid">20470396</object-id>; PubMed Central PMCID: PMC2893182.</mixed-citation></ref>
<ref id="pcbi.1004936.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boyce</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Sievers</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Higgins</surname> <given-names>DG</given-names></name>. <article-title>Simple chained guide trees give high-quality protein multiple sequence alignments</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2014</year>;<volume>111</volume>(<issue>29</issue>):<fpage>10556</fpage>–<lpage>61</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1405628111" xlink:type="simple">10.1073/pnas.1405628111</ext-link></comment> <object-id pub-id-type="pmid">25002495</object-id>; PubMed Central PMCID: PMC4115562.</mixed-citation></ref>
<ref id="pcbi.1004936.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>CE</given-names></name>. <article-title>Markovian structures in biological sequence alignments</article-title>. <source>J Am Stat Assoc</source>. <year>1999</year>;<volume>94</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>. <article-title>Gapped alignment of protein sequence motifs through Monte Carlo optimization of a hidden Markov model</article-title>. <source>BMC Bioinformatics</source>. <year>2004</year>;<volume>5</volume>(<issue>1</issue>):<fpage>157</fpage>. <object-id pub-id-type="pmid">15504234</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Lipman</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>CE</given-names></name>. <article-title>Extracting protein alignment models from the sequence database</article-title>. <source>Nucleic Acids Research</source>. <year>1997</year>;<volume>25</volume>(<issue>9</issue>):<fpage>1665</fpage>–<lpage>77</lpage>. <object-id pub-id-type="pmid">9108146</object-id></mixed-citation></ref>
<ref id="pcbi.1004936.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eddy</surname> <given-names>SR</given-names></name>. <article-title>Profile hidden Markov models</article-title>. <source>Bioinformatics</source>. <year>1998</year>;<volume>14</volume>(<issue>9</issue>):<fpage>755</fpage>–<lpage>63</lpage>. <object-id pub-id-type="pmid">9918945</object-id></mixed-citation></ref>
<ref id="pcbi.1004936.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>CE</given-names></name>. <article-title>Bayesian models for multiple local sequence alignment and Gibbs sampling strategies</article-title>. <source>J Am Stat Assoc</source>. <year>1995</year>;<volume>90</volume>(<issue>432</issue>):<fpage>1156</fpage>–<lpage>70</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref014"><label>14</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Grunwald</surname> <given-names>PD</given-names></name>. <chapter-title>The minimum description length principle</chapter-title>. <publisher-loc>Boston</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>2007</year>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hughey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mian</surname> <given-names>IS</given-names></name>, <name name-style="western"><surname>Sjolander</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Haussler</surname> <given-names>D</given-names></name>. <article-title>Using Dirichlet mixture priors to derive hidden Markov models for protein families</article-title>. <source>Ismb</source>. <year>1993</year>;<volume>1</volume>:<fpage>47</fpage>–<lpage>55</lpage>. <object-id pub-id-type="pmid">7584370</object-id></mixed-citation></ref>
<ref id="pcbi.1004936.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sjolander</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Karplus</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hughey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mian</surname> <given-names>IS</given-names></name>, <etal>et al</etal>. <article-title>Dirichlet mixtures: a method for improved detection of weak but significant protein sequence homology</article-title>. <source>Comput Appl Biosci</source>. <year>1996</year>;<volume>12</volume>(<issue>4</issue>):<fpage>327</fpage>–<lpage>45</lpage>. <object-id pub-id-type="pmid">8902360</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nguyen</surname> <given-names>VA</given-names></name>, <name name-style="western"><surname>Boyd-Graber</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>. <article-title>Dirichlet mixtures, the Dirichlet process, and the structure of protein space</article-title>. <source>Journal of computational biology: a journal of computational molecular cell biology</source>. <year>2013</year>;<volume>20</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>18</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2012.0244" xlink:type="simple">10.1089/cmb.2012.0244</ext-link></comment> <object-id pub-id-type="pmid">23294268</object-id>; PubMed Central PMCID: PMC3541698.</mixed-citation></ref>
<ref id="pcbi.1004936.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henikoff</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Henikoff</surname> <given-names>JG</given-names></name>. <article-title>Position-based sequence weights</article-title>. <source>J Mol Biol</source>. <year>1994</year>;<volume>243</volume>(<issue>4</issue>):<fpage>574</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">7966282</object-id></mixed-citation></ref>
<ref id="pcbi.1004936.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Wootton</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Zaslavsky</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>YK</given-names></name>. <article-title>The construction and use of log-odds substitution scores for multiple sequence alignment</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>7</issue>):<fpage>e1000852</fpage>. Epub 2010/07/27. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000852" xlink:type="simple">10.1371/journal.pcbi.1000852</ext-link></comment> <object-id pub-id-type="pmid">20657661</object-id>; PubMed Central PMCID: PMC2904766.</mixed-citation></ref>
<ref id="pcbi.1004936.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mirarab</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Guo</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>LS</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>T</given-names></name>. <article-title>PASTA: Ultra-Large Multiple Sequence Alignment for Nucleotide and Amino-Acid Sequences</article-title>. <source>Journal of computational biology: a journal of computational molecular cell biology</source>. <year>2015</year>;<volume>22</volume>(<issue>5</issue>):<fpage>377</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2014.0156" xlink:type="simple">10.1089/cmb.2014.0156</ext-link></comment> <object-id pub-id-type="pmid">25549288</object-id>; PubMed Central PMCID: PMC4424971.</mixed-citation></ref>
<ref id="pcbi.1004936.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marchler-Bauer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Derbyshire</surname> <given-names>MK</given-names></name>, <name name-style="western"><surname>Gonzales</surname> <given-names>NR</given-names></name>, <name name-style="western"><surname>Lu</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Chitsaz</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Geer</surname> <given-names>LY</given-names></name>, <etal>et al</etal>. <article-title>CDD: NCBI's conserved domain database</article-title>. <source>Nucleic Acids Res</source>. <year>2015</year>;<volume>43</volume>(Database issue):<fpage>D222</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gku1221" xlink:type="simple">10.1093/nar/gku1221</ext-link></comment> <object-id pub-id-type="pmid">25414356</object-id>; PubMed Central PMCID: PMC4383992.</mixed-citation></ref>
<ref id="pcbi.1004936.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sievers</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Higgins</surname> <given-names>DG</given-names></name>. <article-title>Clustal Omega, accurate alignment of very large numbers of sequences</article-title>. <source>Methods Mol Biol</source>. <year>2014</year>;<volume>1079</volume>:<fpage>105</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-62703-646-7_6" xlink:type="simple">10.1007/978-1-62703-646-7_6</ext-link></comment> <object-id pub-id-type="pmid">24170397</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sievers</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wilm</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dineen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Karplus</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>. <source>Mol Syst Biol</source>. <year>2011</year>;<volume>7</volume>:<fpage>539</fpage>. Epub 2011/10/13. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2011.75" xlink:type="simple">10.1038/msb.2011.75</ext-link></comment> msb201175 [pii]. <object-id pub-id-type="pmid">21988835</object-id>; PubMed Central PMCID: PMC3261699.</mixed-citation></ref>
<ref id="pcbi.1004936.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lassmann</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Frings</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Sonnhammer</surname> <given-names>EL</given-names></name>. <article-title>Kalign2: high-performance multiple alignment of protein and nucleotide sequences allowing external features</article-title>. <source>Nucleic Acids Res</source>. <year>2009</year>;<volume>37</volume>(<issue>3</issue>):<fpage>858</fpage>–<lpage>65</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkn1006" xlink:type="simple">10.1093/nar/gkn1006</ext-link></comment> <object-id pub-id-type="pmid">19103665</object-id>; PubMed Central PMCID: PMC2647288.</mixed-citation></ref>
<ref id="pcbi.1004936.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lassmann</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Sonnhammer</surname> <given-names>EL</given-names></name>. <article-title>Kalign—an accurate and fast multiple sequence alignment algorithm</article-title>. <source>BMC Bioinformatics</source>. <year>2005</year>;<volume>6</volume>:<fpage>298</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-6-298" xlink:type="simple">10.1186/1471-2105-6-298</ext-link></comment> <object-id pub-id-type="pmid">16343337</object-id>; PubMed Central PMCID: PMC1325270.</mixed-citation></ref>
<ref id="pcbi.1004936.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morgenstern</surname> <given-names>B</given-names></name>. <article-title>DIALIGN 2: improvement of the segment-to-segment approach to multiple sequence alignment</article-title>. <source>Bioinformatics</source>. <year>1999</year>;<volume>15</volume>(<issue>3</issue>):<fpage>211</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">10222408</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morgenstern</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Frech</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dress</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Werner</surname> <given-names>T</given-names></name>. <article-title>DIALIGN: finding local similarities by multiple sequence alignment</article-title>. <source>Bioinformatics</source>. <year>1998</year>;<volume>14</volume>(<issue>3</issue>):<fpage>290</fpage>–<lpage>4</lpage>. <object-id pub-id-type="pmid">9614273</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morgenstern</surname> <given-names>B</given-names></name>. <article-title>Multiple sequence alignment with DIALIGN</article-title>. <source>Methods Mol Biol</source>. <year>2014</year>;<volume>1079</volume>:<fpage>191</fpage>–<lpage>202</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-62703-646-7_12" xlink:type="simple">10.1007/978-1-62703-646-7_12</ext-link></comment> <object-id pub-id-type="pmid">24170403</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thompson</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Koehl</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ripp</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Poch</surname> <given-names>O</given-names></name>. <article-title>BAliBASE 3.0: Latest developments of the multiple sequence alignment benchmark</article-title>. <source>Proteins</source>. <year>2005</year>;<volume>61</volume>(<issue>1</issue>):<fpage>127</fpage>–<lpage>36</lpage>. <object-id pub-id-type="pmid">16044462</object-id></mixed-citation></ref>
<ref id="pcbi.1004936.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilcoxon</surname> <given-names>AF</given-names></name>. <article-title>Individual comparisons by ranking methods</article-title>. <source>Biometrics</source>. <year>1945</year>;<volume>1</volume>:<fpage>80</fpage>–<lpage>3</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Res</source>. <year>2004</year>;<volume>32</volume>(<issue>5</issue>):<fpage>1792</fpage>–<lpage>7</lpage>. Print 2004. <object-id pub-id-type="pmid">15034147</object-id></mixed-citation></ref>
<ref id="pcbi.1004936.ref032"><label>32</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>. <chapter-title>Monte Carlo Strategies in Scientific Computing</chapter-title>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>2008</year>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>A Bayesian sampler for optimization of protein domain hierarchies</article-title>. <source>Journal of Computational Biology</source>. <year>2014</year>;<volume>21</volume>(<issue>3</issue>):<fpage>269</fpage>–<lpage>86</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2013.0099" xlink:type="simple">10.1089/cmb.2013.0099</ext-link></comment> <object-id pub-id-type="pmid">24494927</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Protein domain hierarchy Gibbs sampling strategies</article-title>. <source>Statistical applications in genetics and molecular biology</source>. <year>2014</year>;<volume>13</volume>(<issue>4</issue>):<fpage>497</fpage>–<lpage>517</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1515/sagmb-2014-0008" xlink:type="simple">10.1515/sagmb-2014-0008</ext-link></comment> <object-id pub-id-type="pmid">24988248</object-id>.</mixed-citation></ref>
<ref id="pcbi.1004936.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Lanczycki</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Marchler-Bauer</surname> <given-names>A</given-names></name>. <article-title>Automated hierarchical classification of protein domain subfamilies based on functionally-divergent residue signatures</article-title>. <source>BMC Bioinformatics</source>. <year>2012</year>;<volume>13</volume>:<fpage>144</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-13-144" xlink:type="simple">10.1186/1471-2105-13-144</ext-link></comment> <object-id pub-id-type="pmid">22726767</object-id>; PubMed Central PMCID: PMC3599474.</mixed-citation></ref>
<ref id="pcbi.1004936.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kirkpatrick</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gelatt</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Vecchi</surname> <given-names>MP</given-names></name>. <article-title>Optimization by simulated annealing</article-title>. <source>Science</source>. <year>1983</year>;<volume>220</volume>:<fpage>671</fpage>–<lpage>80</lpage>. <object-id pub-id-type="pmid">17813860</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>