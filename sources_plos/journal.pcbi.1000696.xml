<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-0081R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000696</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Systems Biology</subject><subject>Computer Science/Systems and Control Theory</subject><subject>Mathematics/Statistics</subject></subj-group></article-categories><title-group><article-title>Parameter Estimation and Model Selection in Computational Biology</article-title><alt-title alt-title-type="running-head">Parameter Estimation in Computational Biology</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Lillacci</surname><given-names>Gabriele</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Khammash</surname><given-names>Mustafa</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group><aff id="aff1">          <addr-line>Center for Control, Dynamical Systems and Computation, University of California at Santa Barbara, Santa Barbara, California, United States of America</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Asthagiri</surname><given-names>Anand R.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">California Institute of Technology, United States of America</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">khammash@engr.ucsb.edu</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: MK. Performed the experiments: GL. Analyzed the data: GL. Contributed reagents/materials/analysis tools: GL. Wrote the paper: GL.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>3</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>5</day><month>3</month><year>2010</year></pub-date><volume>6</volume><issue>3</issue><elocation-id>e1000696</elocation-id><history>
<date date-type="received"><day>22</day><month>1</month><year>2009</year></date>
<date date-type="accepted"><day>30</day><month>1</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Lillacci, Khammash</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>A central challenge in computational modeling of biological systems is the determination of the model parameters. Typically, only a fraction of the parameters (such as kinetic rate constants) are experimentally measured, while the rest are often fitted. The fitting process is usually based on experimental time course measurements of observables, which are used to assign parameter values that minimize some measure of the error between these measurements and the corresponding model prediction. The measurements, which can come from immunoblotting assays, fluorescent markers, etc., tend to be very noisy and taken at a limited number of time points. In this work we present a new approach to the problem of parameter selection of biological models. We show how one can use a dynamic recursive estimator, known as extended Kalman filter, to arrive at estimates of the model parameters. The proposed method follows. First, we use a variation of the Kalman filter that is particularly well suited to biological applications to obtain a first guess for the unknown parameters. Secondly, we employ an a posteriori identifiability test to check the reliability of the estimates. Finally, we solve an optimization problem to refine the first guess in case it should not be accurate enough. The final estimates are guaranteed to be statistically consistent with the measurements. Furthermore, we show how the same tools can be used to discriminate among alternate models of the same biological process. We demonstrate these ideas by applying our methods to two examples, namely a model of the heat shock response in <italic>E. coli</italic>, and a model of a synthetic gene regulation system. The methods presented are quite general and may be applied to a wide class of biological systems where noisy measurements are used for parameter estimation or model selection.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>Parameter estimation is a key issue in systems biology, as it represents the crucial step to obtaining predictions from computational models of biological systems. This issue is usually addressed by “fitting” the model simulations to the observed experimental data. Such approach does not take the measurement noise into full consideration. We introduce a new method built on the combination of Kalman filtering, statistical tests, and optimization techniques. The filter is well-known in control and estimation theory and has found application in a wide range of fields, such as inertial guidance systems, weather forecasting, and economics. We show how the statistics of the measurement noise can be optimally exploited and directly incorporated into the design of the estimation algorithm in order to achieve more accurate results, and to validate/invalidate the computed estimates. We also show that a significant advantage of our estimator is that it offers a powerful tool for model selection, allowing rejection or acceptance of competing models based on the available noisy measurements. These results are of immediate practical application in computational biology, and while we demonstrate their use for two specific examples, they can in fact be used to study a wide class of biological systems.</p>
</abstract><funding-group><funding-statement>This material is based upon work supported by the National Science Foundation under Grant NSF-CDI ECCS-0835847, NSF-ECCS-0802008, NIH R01GM049831, and the Institute for Collaborative Biotechnologies through Grant DAAD19-03-D-0004 from the U.S. Army Research office. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="17"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Many biological processes are modeled using ordinary differential equations (ODEs) that describe the evolution over time of certain quantities of interest. At the molecular level, the variables considered in the models often represent concentrations (or number of molecules) of chemical species, such as proteins and mRNA. Once the pathway structure is known, the corresponding equations are relatively easy to write down using widely accepted kinetic laws, such as the law of mass action or the Michaelis-Menten law.</p>
<p>In general the equations will depend on several parameters. Some of them, such as reaction rates, and production and decay coefficients have a physical meaning. Others might come from approximations or reductions that are justified by the structure of the system and, therefore, they might have no direct biological or biochemical interpretation. In both cases, most of the parameters are unknown. While sometimes it is feasible to measure them experimentally (especially those in the first class), in many cases this is very hard, expensive, time consuming, or even impossible. However, it is usually possible to measure some of the other variables involved in the models (such as abundance of chemical species) using PCR, immunoblotting assays, fluorescent markers, and the like.</p>
<p>For these reasons, the problem of <italic>parameter estimation</italic>, that is the indirect determination of the unknown parameters from measurements of other quantities, is a key issue in computational and systems biology. The knowledge of the parameter values is crucial whenever one wants to obtain quantitative, or even qualitative information from the models <xref ref-type="bibr" rid="pcbi.1000696-Ingram1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000696-Mayo1">[2]</xref>.</p>
<p>In the last fifteen years a lot of attention has been given to this problem in the systems biology community. Much research has been conducted on the applications to computational biology models of several optimization techniques, such as linear and nonlinear least-squares fitting <xref ref-type="bibr" rid="pcbi.1000696-Mendes1">[3]</xref>, simulated annealing <xref ref-type="bibr" rid="pcbi.1000696-Kirkpatrick1">[4]</xref>, genetic algorithms <xref ref-type="bibr" rid="pcbi.1000696-Srinivas1">[5]</xref>, and evolutionary computation <xref ref-type="bibr" rid="pcbi.1000696-Ashyraliyev1">[6]</xref>,<xref ref-type="bibr" rid="pcbi.1000696-Moles1">[7]</xref>. The latter is suggested as the method of choice for large parameter estimation problems <xref ref-type="bibr" rid="pcbi.1000696-Moles1">[7]</xref>. Starting with a suitable initial guess, optimization methods search more or less exhaustively the parameter space in the attempt to minimize a certain cost function. This is usually defined as the error in some sense between the output of the model and the data that comes from the experiments. The result is the set of parameters that produce the <italic>best fit</italic> between simulations and experimental data. One of the main problems associated with optimization methods is that they tend to be computationally expensive and may not perform well if the noise in the measurements is significant.</p>
<p>Considerable interested has also been raised by Bayesian methods <xref ref-type="bibr" rid="pcbi.1000696-Wilkinson1">[8]</xref>, which can extract information from noisy or uncertain data. This includes both measurement noise and intrinsic noise, which is well known to play an important role in chemical kinetics when species are present in low copy numbers <xref ref-type="bibr" rid="pcbi.1000696-McAdams1">[9]</xref>. The main advantage of these methods is their ability to infer the whole probability distributions of the parameters, rather than just a point estimate. Also, they can handle estimation of stochastic systems with no substantial modification to the algorithms <xref ref-type="bibr" rid="pcbi.1000696-Toni1">[10]</xref>. The main obstacle to their application is computational, since analytical approaches are not feasible for non-trivial problems and numerical solutions are also challenging due to the need to solve high-dimensional integration problems. Nonetheless, the most recent advancements in Bayesian computation, such as Markov chain Monte Carlo techniques <xref ref-type="bibr" rid="pcbi.1000696-Brooks1">[11]</xref>, ensemble methods <xref ref-type="bibr" rid="pcbi.1000696-Brown1">[12]</xref>,<xref ref-type="bibr" rid="pcbi.1000696-Battogtokh1">[13]</xref>, and sequential Monte Carlo methods that don't require likelihoods <xref ref-type="bibr" rid="pcbi.1000696-Toni1">[10]</xref>,<xref ref-type="bibr" rid="pcbi.1000696-Sisson1">[14]</xref> have been successfully applied to biological systems, usually in the case of lower-dimensional problems and/or availability of a relatively high number of data samples. Maximum-likelihood estimation <xref ref-type="bibr" rid="pcbi.1000696-Muller1">[15]</xref>,<xref ref-type="bibr" rid="pcbi.1000696-Bortz1">[16]</xref> has also been extensively applied.</p>
<p>More recently, parameter estimation for computational biology models has been tackled in the framework of control theory by using state observers. These algorithms were originally developed for the problem of state estimation, in which one seeks to estimate the time evolution of the unobserved components of the state of a dynamical system. The controls literature on this subject is vast, but in the context of biological or biochemical systems the classically used approaches include Luenberger-like <xref ref-type="bibr" rid="pcbi.1000696-Hulhoven1">[17]</xref>, Kalman filter based, <xref ref-type="bibr" rid="pcbi.1000696-Wells1">[18]</xref>–<xref ref-type="bibr" rid="pcbi.1000696-Lillacci2">[20]</xref>, and high-gain observers <xref ref-type="bibr" rid="pcbi.1000696-Bullinger1">[21]</xref>. Other methods have been developed by exploiting the special structure of specific problems <xref ref-type="bibr" rid="pcbi.1000696-Dochain1">[22]</xref>. State observers can be employed for parameter estimation using the technique of state extension, in which parameters are transformed into states by suitably expanding the system under study <xref ref-type="bibr" rid="pcbi.1000696-Dochain1">[22]</xref>–<xref ref-type="bibr" rid="pcbi.1000696-Fey1">[24]</xref>. In this context extended Kalman filtering <xref ref-type="bibr" rid="pcbi.1000696-Sun1">[25]</xref>,<xref ref-type="bibr" rid="pcbi.1000696-Wang1">[26]</xref> and unscented Kalman filtering <xref ref-type="bibr" rid="pcbi.1000696-Quach1">[27]</xref> methods have been applied as well.</p>
<p>When the number of unknown parameters is very large, it is often impossible to find a unique solution to this problem. In this case, one finds several sets of parameters, or ranges of values, that are all equally likely to give a good fit. This situation is usually referred to as the model being <italic>non identifiable</italic>, and it is the one that's most commonly encountered in practice. Furthermore, it is known that a large class of systems biology models display sensitivities to the parameter values that are roughly evenly distributed over many orders of magnitude. Such “sloppiness” has been suggested as a factor that makes parameter estimation difficult <xref ref-type="bibr" rid="pcbi.1000696-Gutenkunst1">[28]</xref>. These and similar results indicate that the search for the exact individual values of the parameters is a hopeless task in most cases <xref ref-type="bibr" rid="pcbi.1000696-Ashyraliyev1">[6]</xref>. However, it is also known that even if the estimation process is not able to tightly constrain any of the parameter values, the models can still be able to yield significant quantitative predictions <xref ref-type="bibr" rid="pcbi.1000696-Brown1">[12]</xref>.</p>
<p>The purpose of the present contribution is to extend the results on parameter estimation by Kalman filtering by introducing a procedure that can be applied to large parameter spaces, can handle sparse and noisy data, and provides an evaluation of the statistical significance of the computed estimates. To achieve this goal, we introduce a constrained hybrid extended Kalman filtering algorithm, together with a measure of accuracy of the estimation process based on a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e001" xlink:type="simple"/></inline-formula> variance test. Furthermore, we show how these techniques together can be also used to address the problem of model selection, in which one has to pick the most plausible model for a given process among a list of candidates. A distinctive feature of this approach is the ability to use information about the statistics of the measurement noise in order to ensure that the estimated parameters are statistically consistent with the available experimental data.</p>
<p>The rest of this paper is organized as follows. In the <xref ref-type="sec" rid="s2">Methods</xref> Section we introduce all the theory associated with our procedure, namely the constrained hybrid extended Kalman filter, the accuracy measure and its use in estimation refinement, and the application to the model selection problem. In the <xref ref-type="sec" rid="s3">Results</xref> Section we demonstrate the procedure on two examples drawn from molecular biology. Finally, in the <xref ref-type="sec" rid="s4">Discussion</xref> Section we summarize the new procedure, we give some additional remarks, and we point out how these findings will be of immediate interest to researchers in computational biology, who use experimental data to construct dynamical models of biological phenomena.</p>
</sec><sec id="s2" sec-type="methods">
<title>Methods</title>
<sec id="s2a">
<title>Problem formulation</title>
<p>Throughout this paper, we will assume that the process of interest can be modeled by a system of ordinary differential equations of the form:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e002" xlink:type="simple"/><label>(1)</label></disp-formula>The state vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e003" xlink:type="simple"/></inline-formula> usually contains concentrations of certain chemical species of interest, such as mRNA or proteins. The <italic>input signal</italic> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e004" xlink:type="simple"/></inline-formula> represents some kind of external forcing of the process, such as temperature changes, the addition or removal of certain chemicals or drugs, and so forth. The <italic>output signal</italic> <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e005" xlink:type="simple"/></inline-formula> represents the quantity or quantities we can measure experimentally. These are related to the state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e006" xlink:type="simple"/></inline-formula> through the function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e007" xlink:type="simple"/></inline-formula>, which we call the <italic>output function</italic>. The output function is to be determined from the design of the biological experiments that are used to get the measurements for parameter estimation. As an example, when measuring protein concentrations, in some biological experiments it is harder and/or more expensive and/or more time consuming to distinguish among different post-translational modifications of the same protein. This situation corresponds in our setting to choosing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e008" xlink:type="simple"/></inline-formula> equal to the sum of two or more state variables, representing the total amount of protein.</p>
<p>The vector <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e009" xlink:type="simple"/></inline-formula> contains the unknown parameters that we seek to estimate. Note that, since the parameters are constants, it is always possible to consider them as additional state variables with a rate of change equal to zero. In this way, we treat them as constant <italic>functions of time</italic> as opposed to constant <italic>numbers</italic>. This technique is usually referred to as <italic>state extension</italic>. Our system (1) then becomes:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e010" xlink:type="simple"/><label>(2)</label></disp-formula></p>
<p>Using state extension, the problem of parameter estimation is converted into a problem of <italic>state estimation</italic>, that is determining the state of a system from measurements of the output. More precisely, we are trying to determine the <italic>initial conditions</italic> that when used to initialize the system (2) generate the observed output <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e011" xlink:type="simple"/></inline-formula>. In the case of the parameters, since <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e012" xlink:type="simple"/></inline-formula>, it is obvious that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e013" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e014" xlink:type="simple"/></inline-formula>.</p>
<p>Solving this problem requires answering the following two questions.</p>
<list list-type="order"><list-item>
<p>Given a system of the form (2), does the output <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e015" xlink:type="simple"/></inline-formula> contain enough information to uniquely determine a reliable estimate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e016" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e017" xlink:type="simple"/></inline-formula>?</p>
</list-item><list-item>
<p>If so, how can we compute such estimate?</p>
</list-item></list>
<p>The first question is usually referred to as the problem of <italic>identifiability</italic>. In control theory, much work has been done in studying this property in terms of another one called <italic>observability</italic> <xref ref-type="bibr" rid="pcbi.1000696-Farina1">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000696-Fey1">[24]</xref>. Roughly speaking, a system is observable if every set of initial conditions produces an output that is different from the one generated by every other set. Identifiability can also be studied a posteriori <xref ref-type="bibr" rid="pcbi.1000696-Ashyraliyev1">[6]</xref>, by testing the reliability of the estimates <italic>after they have been computed</italic>. We will make use of this second approach.</p>
<p>To answer the second question, we need to show how to design an algorithm (or device) that can estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e018" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e019" xlink:type="simple"/></inline-formula> from measurements of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e020" xlink:type="simple"/></inline-formula>, which, in general, will not be perfect, but noisy and sparse. Such algorithms, called <italic>state observers</italic>, can be formulated in a plethora of different ways, each of which is better suited for different applications. The observer we are going to use is based on extended Kalman filtering, and is described in detail in the next Section.</p>
</sec><sec id="s2b">
<title>Extended Kalman filtering</title>
<p>Extended Kalman filtering is considered to be the de-facto standard of nonlinear state estimation <xref ref-type="bibr" rid="pcbi.1000696-Simon1">[29]</xref>. It found several applications in many different fields, such as positioning systems, robot navigation and economics. The Kalman filter is a set of equations that provides an efficient computational technique to estimating the state of a process, in a way that minimizes the covariance of the estimation error. The filter is very powerful in several aspects: it supports estimations of past, present, and even future states, and it can do so even when the precise nature of the modeled system is unknown. Unlike most of the classical parameter estimation methods, the Kalman filter is a <italic>recursive estimator</italic>. At each time step the filter refines the previous estimate by incorporating in it new information from the model and from the output.</p>
<p>The Kalman filter works in two steps: first it estimates the process state and covariance at some time using information from the model only (<italic>prediction</italic>); then it employs a feedback from the noisy measurements to improve the first estimates (<italic>correction</italic>). As such, the equations for the Kalman filter fall into two groups: <italic>time update equations</italic> for the prediction step and <italic>measurement update equations</italic> for the correction step. The time update equations are responsible for propagating forward (in time) the current state and error covariance estimates to obtain the <italic>a priori</italic> estimates for the next time step. The measurement update equations are responsible for the feedback, i.e. for incorporating a new measurement into the a priori estimate to obtain an improved <italic>a posteriori estimate</italic>. After each time and measurement update pair, the process is repeated with the previous a posteriori estimates used to predict the new a priori estimates.</p>
<p>In order to set these ideas in a more rigorous mathematical framework, consider the following system:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e021" xlink:type="simple"/><label>(3)</label></disp-formula>As we note from the structure of system (3), we are assuming that we have a continuous-time process which we want to estimate using discrete-time measurements of the output. This is the most common case when dealing with deterministic models of biological systems. These are usually of the form (1), therefore continuous-time. However, the measurements for estimation tend to be available only at discrete time instants. We will denote these instants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e022" xlink:type="simple"/></inline-formula>, with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e023" xlink:type="simple"/></inline-formula> being the corresponding values of the measurements. The output of the filter will then be the a posteriori estimates of the state corresponding to instants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e024" xlink:type="simple"/></inline-formula>, which we will denote <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e025" xlink:type="simple"/></inline-formula>. We remark that after applying state extension as described in the previous Section, the unknown parameters are now part of the state of the system, therefore their estimates at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e026" xlink:type="simple"/></inline-formula> are components of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e027" xlink:type="simple"/></inline-formula>. We also note that the output function <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e028" xlink:type="simple"/></inline-formula> in (3) is allowed to be different at different time step: this is very important e.g. when incorporating data from different measurements, because it allows the algorithm to use measurements of different species at different times.</p>
<p>The variable <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e029" xlink:type="simple"/></inline-formula>, usually called the <italic>process noise</italic>, represents the amount of confidence we have in our model. The process noise is assumed to be a Gaussian random variable with zero mean and covariance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e030" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e031" xlink:type="simple"/></inline-formula> is a positive definite matrix. The noise that affects the different components of the state is assumed to be uncorrelated, so that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e032" xlink:type="simple"/></inline-formula> is diagonal. Larger entries in <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e033" xlink:type="simple"/></inline-formula> correspond to lower confidence in the accuracy of the model. The variable <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e034" xlink:type="simple"/></inline-formula> is referred to as the <italic>measurement noise</italic>, and expresses the reliability of the measurements. The measurement noise is also assumed to be Gaussian with zero mean, and its covariance matrix will be denoted by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e035" xlink:type="simple"/></inline-formula>. Again, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e036" xlink:type="simple"/></inline-formula> is assumed to be a positive definite, diagonal matrix, since the noise that affects different measurements is assumed to be uncorrelated. Note that while <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e037" xlink:type="simple"/></inline-formula> is usually chosen by the user in order to tell the filter how much the model should be trusted, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e038" xlink:type="simple"/></inline-formula> is fixed by the quality of the measurements. In other words, <italic>the statistics of the measurements noise are assumed to be known</italic>. This fact will be particularly important for the a posteriori reliability test described in the next Section.</p>
<p>The variation of the Kalman filter we present here is the one that is best suited for a system of the form (3), and it is usually referred to as the <italic>hybrid extended Kalman filter</italic> (HEKF). The word <italic>extended</italic> refers to the fact that it can deal with nonlinear systems, while <italic>hybrid</italic> indicates that it uses continuous-time process model and discrete-time measurements. We next describe the time update equations and measurement update equations of the HEKF.</p>
<p>First of all, we need some initial conditions to start the filter from. Ideally, we would like the initial conditions to be <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e039" xlink:type="simple"/></inline-formula> (the initial conditions of the process) but this is clearly not possible. Since we do not have any measurements available to estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e040" xlink:type="simple"/></inline-formula>, it makes sense to take our initial estimate of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e041" xlink:type="simple"/></inline-formula> equal to the expected value of the initial state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e042" xlink:type="simple"/></inline-formula>. Therefore, we write:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e043" xlink:type="simple"/><label>(4)</label></disp-formula>It follows that the initial condition for the error covariance can be set as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e044" xlink:type="simple"/><label>(5)</label></disp-formula></p>
<p>We can now apply the time update equations to obtain the current a priori estimates. The current a priori state estimate, which we denote <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e045" xlink:type="simple"/></inline-formula>, is formed by integrating the continuous-time process in the time interval <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e046" xlink:type="simple"/></inline-formula>, using the previous a posteriori estimate as initial condition. The current a priori error covariance estimate, denoted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e047" xlink:type="simple"/></inline-formula>, is formed by integrating a differential Lyapunov equation using the previous a posteriori error covariance as initial condition <xref ref-type="bibr" rid="pcbi.1000696-Simon1">[29]</xref>.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e048" xlink:type="simple"/><label>(6a)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e049" xlink:type="simple"/><label>(6b)</label></disp-formula></p>
<p>The matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e050" xlink:type="simple"/></inline-formula> is the Jacobian of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e051" xlink:type="simple"/></inline-formula> evaluated at the previous a posteriori state estimate. The structure of equations (6) shows a very important feature of the HEKF algorithm, i.e. its ability to deal with non-uniformly sampled data. As we will see in the examples in the <xref ref-type="sec" rid="s3">Results</xref> Section, this is useful because it allows one to capture all the information about the evolution of a process using a minimum number of data points.</p>
<p>The measurement update equations are used to form the a posteriori estimates by incorporating information from the output of the system into the a priori estimates. The correction is based on the difference between the actual measurement and the <italic>predicted measurement</italic>, that is what the measurement would be if the real value of the state were exactly equal to its a priori estimate. Such difference is weighed by a <italic>gain</italic>, which takes into account the fact that the measurements are not perfect. The gain at time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e052" xlink:type="simple"/></inline-formula> is given by:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e053" xlink:type="simple"/><label>(7)</label></disp-formula>where the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e054" xlink:type="simple"/></inline-formula> is the Jacobian of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e055" xlink:type="simple"/></inline-formula> evaluated at the previous a posteriori state estimate. Given that, the current a posteriori state and error covariance estimates, denoted <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e056" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e057" xlink:type="simple"/></inline-formula> respectively, are formed using the following equations:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e058" xlink:type="simple"/><label>(8a)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e059" xlink:type="simple"/><label>(8b)</label></disp-formula></p>
<p>We refer to <xref ref-type="bibr" rid="pcbi.1000696-Simon1">[29]</xref> for a rigorous derivation of the equations we presented so far.</p>
<p>We remark that the algorithm we just introduced, as well as the ones employed in other works <xref ref-type="bibr" rid="pcbi.1000696-Sun1">[25]</xref>–<xref ref-type="bibr" rid="pcbi.1000696-Quach1">[27]</xref>, provides <italic>unconstrained</italic> estimates. In some cases it is necessary to take into account equality or inequality constraints that prevent <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e060" xlink:type="simple"/></inline-formula> from assuming certain values. This can be important for the following reasons.</p>
<list list-type="order"><list-item>
<p>To incorporate into the estimation process prior knowledge that might be available on some of the quantities in the model.</p>
</list-item><list-item>
<p>To keep the estimates biologically meaningful. Depending on how the model is formulated, certain quantities may be sign-definite. In many cases, for example, both the states and the parameters must be positive.</p>
</list-item><list-item>
<p>To ensure that the evaluation of the functions <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e061" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e062" xlink:type="simple"/></inline-formula> and of their Jacobians <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e063" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e064" xlink:type="simple"/></inline-formula> are well-posed. The algorithm will not work if at any given step <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e065" xlink:type="simple"/></inline-formula> lays outside the domain of definition of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e066" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e067" xlink:type="simple"/></inline-formula> or of their partial derivatives.</p>
</list-item></list>
<p>To cope with these issues, we apply the constrained estimation technique developed in <xref ref-type="bibr" rid="pcbi.1000696-Simon2">[30]</xref>,<xref ref-type="bibr" rid="pcbi.1000696-Simon3">[31]</xref>. This is derived using the fact that the estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e068" xlink:type="simple"/></inline-formula> is the value that maximizes the conditional probability of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e069" xlink:type="simple"/></inline-formula> given the measurements <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e070" xlink:type="simple"/></inline-formula> up to time <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e071" xlink:type="simple"/></inline-formula>. Furthermore, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e072" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e073" xlink:type="simple"/></inline-formula> are jointly Gaussian, which means that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e074" xlink:type="simple"/></inline-formula> is conditionally Gaussian given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e075" xlink:type="simple"/></inline-formula>. Finally, if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e076" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e077" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e078" xlink:type="simple"/></inline-formula> are jointly Gaussian, then <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e079" xlink:type="simple"/></inline-formula> is the conditional mean of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e080" xlink:type="simple"/></inline-formula> given the measurements <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e081" xlink:type="simple"/></inline-formula>. These three properties, which are derived in <xref ref-type="bibr" rid="pcbi.1000696-Anderson1">[32]</xref>, imply that the conditional probability of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e082" xlink:type="simple"/></inline-formula> given <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e083" xlink:type="simple"/></inline-formula> can be written as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e084" xlink:type="simple"/></disp-formula>Now, suppose we have a set of linear constraints of the form <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e085" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e086" xlink:type="simple"/></inline-formula> is a constant matrix of suitable dimensions. If <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e087" xlink:type="simple"/></inline-formula> does not satisfy the constraints, we need to replace it with a constrained estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e088" xlink:type="simple"/></inline-formula>. This can be obtained by maximizing <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e089" xlink:type="simple"/></inline-formula> subject to the constraints, or equivalently, by maximizing its natural logarithm. Therefore, the problem we need to solve can be cast as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e090" xlink:type="simple"/><label>(9)</label></disp-formula></p>
<p>Since <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e091" xlink:type="simple"/></inline-formula> is a covariance matrix, and it is therefore strictly positive definite, this is a <italic>strictly convex</italic> quadratic programming problem that can be easily solved using standard algorithms, such as reflective Newton methods <xref ref-type="bibr" rid="pcbi.1000696-Coleman1">[33]</xref> and active set methods <xref ref-type="bibr" rid="pcbi.1000696-Gill1">[34]</xref>.</p>
</sec><sec id="s2c">
<title>Constrained HEKF algorithm summary</title>
<list list-type="order"><list-item>
<p>Set the initial conditions according to (4) and (5).</p>
</list-item><list-item>
<p>Compute the Jacobians of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e092" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e093" xlink:type="simple"/></inline-formula> around the previous a posteriori state estimate.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e094" xlink:type="simple"/><label>(10)</label></disp-formula></p>
</list-item><list-item>
<p>Advance to the next time step using (6).</p>
</list-item><list-item>
<p>Compute the gain using (7)</p>
</list-item><list-item>
<p>Incorporate the current measurement using (8).</p>
</list-item><list-item>
<p>Check if the estimate satisfies the constraints. If not, replace it with the solution of (9).</p>
</list-item><list-item>
<p>Repeat steps 2–6 for all the time instants <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e095" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
</sec><sec id="s2d">
<title>An a posteriori identifiability test</title>
<p>While for linear models the Kalman filter has nice convergence properties, in the case of the <italic>extended</italic> Kalman filter for nonlinear systems no such properties have been proven yet. As it is well-known in the literature <xref ref-type="bibr" rid="pcbi.1000696-Simon1">[29]</xref>, sometimes the filter may diverge, or may give biased estimates. While the first situation is easily detected in any implementation, the second one is dangerous, because the algorithm appears to run normally but produces severely wrong results. It is therefore extremely important to have a test that allows us to assess the reliability of the estimates.</p>
<p>The test we present here is based on a simple estimation of the variance of a random variable. Consider again a continuous-time process which is measured at discrete time instants. Assuming we are able to measure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e096" xlink:type="simple"/></inline-formula> different quantities, we can rewrite our model expanding the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e097" xlink:type="simple"/></inline-formula> components of the output:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e098" xlink:type="simple"/><label>(11)</label></disp-formula>As in the previous Section, we assume that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e099" xlink:type="simple"/></inline-formula> is a Gaussian random variable with zero mean and diagonal covariance matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e100" xlink:type="simple"/></inline-formula>. This means that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e101" xlink:type="simple"/></inline-formula> is a <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e102" xlink:type="simple"/></inline-formula> matrix, whose diagonal entries <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e103" xlink:type="simple"/></inline-formula> are the variances of each component of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e104" xlink:type="simple"/></inline-formula>. What (11) says is that each output is a sampled version of the corresponding function of the state, with an additive noise superimposed to it.</p>
<p>Now, suppose that by running the HEKF we find an estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e105" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e106" xlink:type="simple"/></inline-formula>. Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e107" xlink:type="simple"/></inline-formula> be the solution of (11) corresponding to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e108" xlink:type="simple"/></inline-formula>. If we accept <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e109" xlink:type="simple"/></inline-formula> as a good approximation of the real solution <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e110" xlink:type="simple"/></inline-formula>, then we can write estimates of each component of the noise as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e111" xlink:type="simple"/><label>(12)</label></disp-formula>This equation, for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e112" xlink:type="simple"/></inline-formula>, gives <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e113" xlink:type="simple"/></inline-formula> samples of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e114" xlink:type="simple"/></inline-formula> Gaussian random variables with zero mean. The main idea behind the test is that if <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e115" xlink:type="simple"/></inline-formula> is close to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e116" xlink:type="simple"/></inline-formula>, and consequently <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e117" xlink:type="simple"/></inline-formula> is close to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e118" xlink:type="simple"/></inline-formula>, then the variance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e119" xlink:type="simple"/></inline-formula> will be close to the variance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e120" xlink:type="simple"/></inline-formula>.</p>
<p>Let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e121" xlink:type="simple"/></inline-formula> be the variance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e122" xlink:type="simple"/></inline-formula>. We can use the samples (12) to build a <italic>point estimate</italic> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e123" xlink:type="simple"/></inline-formula> in the following way:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e124" xlink:type="simple"/><label>(13)</label></disp-formula>The random variable <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e125" xlink:type="simple"/></inline-formula> has a probability density function equal to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e126" xlink:type="simple"/></inline-formula> distribution with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e127" xlink:type="simple"/></inline-formula> degrees of freedom <xref ref-type="bibr" rid="pcbi.1000696-Papoulis1">[35]</xref>.</p>
<p>Using this fact, we can form <italic>interval estimates</italic> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e128" xlink:type="simple"/></inline-formula> corresponding to different confidence coefficients <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e129" xlink:type="simple"/></inline-formula>. The confidence coefficient is a probability, so it takes values between 0 and 1. Common values for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e130" xlink:type="simple"/></inline-formula> include 0.9, 0.95 and 0.997. Denote by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e131" xlink:type="simple"/></inline-formula> the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e132" xlink:type="simple"/></inline-formula>-th percentile of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e133" xlink:type="simple"/></inline-formula> distribution with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e134" xlink:type="simple"/></inline-formula> degrees of freedom. Then, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e135" xlink:type="simple"/></inline-formula> is in the interval<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e136" xlink:type="simple"/><label>(14)</label></disp-formula>with a probability of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e137" xlink:type="simple"/></inline-formula>.</p>
<p>It is then clear that if the real variance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e138" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e139" xlink:type="simple"/></inline-formula> does not lie in the interval indicated by (14), it is extremely unlikely that the measurements <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e140" xlink:type="simple"/></inline-formula> were generated by the set of parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e141" xlink:type="simple"/></inline-formula>, given the fact that the noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e142" xlink:type="simple"/></inline-formula> has a variance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e143" xlink:type="simple"/></inline-formula>. Therefore, we can reject the estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e144" xlink:type="simple"/></inline-formula> as wrong with a confidence of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e145" xlink:type="simple"/></inline-formula>.</p>
<p>We remark that this test can be also used independently of the HEKF to validate/invalidate the estimates computed by any other parameter estimation method.</p>
</sec><sec id="s2e">
<title>Estimate refinement</title>
<p>Although the HEKF can be applied to fairly large extended systems, when the parameter space is very large (and the extended system is therefore not observable) a single run of the filter will generally yield estimates that do not satisfy the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e146" xlink:type="simple"/></inline-formula> identifiability test described in the previous Section. Also, the estimates will be characterized by large uncertainties, as one can see by inspecting the entries of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e147" xlink:type="simple"/></inline-formula> matrices. In this situation, the solution to the parameter estimation problem is not unique, therefore there will be infinite sets of parameters that are all equally likely to be correct. The best that one can do in this case is to find one or more values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e148" xlink:type="simple"/></inline-formula> such that the corresponding solutions are consistent with the experimental observations in the sense of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e149" xlink:type="simple"/></inline-formula> test.</p>
<p>In order to do that, we can make use of the probabilistic information we have about the measurement noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e150" xlink:type="simple"/></inline-formula>. In particular, we know that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e151" xlink:type="simple"/></inline-formula> is a Gaussian random variable with zero mean and covariance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e152" xlink:type="simple"/></inline-formula>. As we saw in the previous Section, given a certain estimated parameter set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e153" xlink:type="simple"/></inline-formula>, we can construct <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e154" xlink:type="simple"/></inline-formula> samples of an estimate <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e155" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e156" xlink:type="simple"/></inline-formula> through (12). It makes sense, then, to ask for which values of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e157" xlink:type="simple"/></inline-formula> the mean and variance of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e158" xlink:type="simple"/></inline-formula> will be close to zero and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e159" xlink:type="simple"/></inline-formula> respectively. In other words, one can <italic>minimize</italic> the expected value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e160" xlink:type="simple"/></inline-formula> and the difference between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e161" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e162" xlink:type="simple"/></inline-formula> by solving the following problem:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e163" xlink:type="simple"/><label>(15)</label></disp-formula></p>
<p>The weights <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e164" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e165" xlink:type="simple"/></inline-formula> can be chosen by the user to attribute different relative importances to the mean matching and to the variance matching parts of the cost function. The most appropriate choice can be different for different problems. Note the scaling that is introduced in the function, which ensures that all the measurements are equally weighted in the minimization process, regardless of their size. This problem will not have any special properties in general, so it can be solved with any general purpose minimization algorithm. The Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm <xref ref-type="bibr" rid="pcbi.1000696-Fletcher1">[36]</xref> has proven to be a good practical choice.</p>
<p>We argue that this <italic>moment matching</italic> optimization is a better alternative than directly fitting the data points, as it guarantees that the result of the optimization process will be a statistically valid parameter set in the sense of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e166" xlink:type="simple"/></inline-formula> test (see the examples in the <xref ref-type="sec" rid="s3">Results</xref> section).</p>
<p>To summarize, the proposed algorithm is a three-stage process. In the first stage, we run the constrained HEKF algorithm on the model to get a first estimate of the unknown parameters. In the second stage we study a posteriori the identifiabilty problem, by running the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e167" xlink:type="simple"/></inline-formula> test. If the test is passed, the HEKF was able to recover the unique solution to the problem and the first estimate can be considered valid. If not, most likely no unique solution exists, and the first estimate needs to be refined by running the third stage, i.e. the moment matching optimization. The whole procedure is visualized in the flowchart of <xref ref-type="fig" rid="pcbi-1000696-g001">Figure 1</xref>.</p>
<fig id="pcbi-1000696-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.g001</object-id><label>Figure 1</label><caption>
<title>Flowchart of the proposed method.</title>
<p>The algorithm is a three-stage process, which involves Kalman filtering, a statistical accuracy test and an optimization problem.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.g001" xlink:type="simple"/></fig></sec><sec id="s2f">
<title>Model selection</title>
<p>One of the most interesting features of approaching the parameter estimation problem using state extension is that it allows for a <italic>simultaneous estimation</italic> of both the state and the parameters of the process under investigation. Therefore, the Kalman filter, together with the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e168" xlink:type="simple"/></inline-formula> variance test we described, can also be used to address the problem of <italic>model selection</italic>.</p>
<p>Frequently, the structure of biochemical pathways is not completely known. One has an idea of the genes and proteins that play a role in a certain process, but the exact interconnections among such components are not fully elucidated. It may not be clear, for example, whether a certain gene is regulated using a positive feedback loop or a negative feedback loop, or if a certain reaction takes place with or without intermediate steps. In these scenarios, it is possible to write down different models corresponding to the different hypotheses and then use the Kalman filter to assess which one is the most likely to have generated the measurements that are observed in the experiments.</p>
<p>In order to simplify the presentation, suppose we have two different models of the form (3) for the same process. We can write them as:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e169" xlink:type="simple"/><label>(16)</label></disp-formula>The two models differ in everything except the measured data points <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e170" xlink:type="simple"/></inline-formula> and the statistics of the noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e171" xlink:type="simple"/></inline-formula> that is superimposed to them.</p>
<p>Running the HEKF for these models will give estimates of their states, which we will denote <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e172" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e173" xlink:type="simple"/></inline-formula>. In analogy to what we did for the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e174" xlink:type="simple"/></inline-formula> test, we can plug the estimates into <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e175" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e176" xlink:type="simple"/></inline-formula> respectively. This will give two different estimates of the measurement noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e177" xlink:type="simple"/></inline-formula>:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e178" xlink:type="simple"/><label>(17a)</label></disp-formula><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e179" xlink:type="simple"/><label>(17b)</label></disp-formula>We can now form point estimates and interval estimates of the variance of each component of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e180" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e181" xlink:type="simple"/></inline-formula> using (13) and (14) respectively. Again, the main idea behind this test is that the estimated variances that are closer to the real variances of the measurement noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e182" xlink:type="simple"/></inline-formula> must come from the model that is more likely to have generated the measurements observed in the experiments. Moreover, if the real variances of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e183" xlink:type="simple"/></inline-formula> do not lie in the interval estimates computed for a certain model, we can reject that model as wrong with a probability of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e184" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e185" xlink:type="simple"/></inline-formula> is the confidence coefficient that was used for the test.</p>
<p>Note that the two estimates of the measurement noise (17) can also be formed by using the model solution. However, using the Kalman filter estimates of the states allows the procedure to be carried out even if the initial conditions are unknown.</p>
<sec id="s2f1">
<title>Model selection algorithm summary</title>
<list list-type="order"><list-item>
<p>Run the constrained HEKF on the models <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e186" xlink:type="simple"/></inline-formula> to get their state estimates <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e187" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Compute the estimates of the measurement noise <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e188" xlink:type="simple"/></inline-formula> using (17).</p>
</list-item><list-item>
<p>Form point and interval estimates of the variance of each component of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e189" xlink:type="simple"/></inline-formula> using (13) and (14).</p>
</list-item><list-item>
<p>Discard the models for which the interval estimates do not contain the real variances of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e190" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Select the model whose variances match the best with the real variances of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e191" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
</sec></sec></sec><sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>A model of the heat shock response in <italic>E. coli</italic></title>
<sec id="s3a1">
<title>The model</title>
<p>Exposure to high temperatures cause proteins to unfold from their functional three-dimensional structure. Misfolding can eventually result in the death of the cell. To mitigate the deleterious effects of heat, cells express heat-shock proteins whose role is to refold unfolded or misfolded proteins.</p>
<p>In <italic>E. coli</italic>, the heat shock response is implemented through an intricate architecture of feedback loops centered on the sigma-factor that regulates the transcription of the heat shock proteins under normal and stress conditions. The enzyme RNA polymerase (RNAP) bound to this regulatory sigma-factor, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e192" xlink:type="simple"/></inline-formula>, recognizes the heat shock gene promoters and transcribes specific heat shock genes. The heat shock genes encode predominantly molecular chaperones (i.e. enzymes that are involved in refolding denatured proteins), and proteases that degrade unfolded proteins. At physiological temperatures (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e193" xlink:type="simple"/></inline-formula>C to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e194" xlink:type="simple"/></inline-formula>C), there is very little <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e195" xlink:type="simple"/></inline-formula> present and, hence, the levels of the heat shock genes are very low. When bacteria are exposed to high temperatures, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e196" xlink:type="simple"/></inline-formula> first rapidly accumulates, allowing increased transcription of the heat shock genes and then declines to a new steady state level, characteristic of the new temperature. The accumulation of high levels of heat shock proteins leads to the efficient refolding of the denatured proteins, thereby decreasing the pool of unfolded protein.</p>
<p>The following reduced order model of this process has been developed by El-Samad et al. <xref ref-type="bibr" rid="pcbi.1000696-ElSamad1">[37]</xref>.<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e197" xlink:type="simple"/><label>(18)</label></disp-formula>In this model <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e198" xlink:type="simple"/></inline-formula> represents the number of molecules of chaperones, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e199" xlink:type="simple"/></inline-formula> the number of molecules of the factor <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e200" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e201" xlink:type="simple"/></inline-formula> the total number of unfolded proteins. For further details on the model and the value of the parameters, see <xref ref-type="bibr" rid="pcbi.1000696-ElSamad1">[37]</xref> and the references therein.</p>
</sec><sec id="s3a2">
<title>Small parameter space case</title>
<p>To demonstrate the use of the ideas we described in the <xref ref-type="sec" rid="s2">Methods</xref> Section, suppose we want to estimate the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e202" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e203" xlink:type="simple"/></inline-formula> in (18). We assume that measurements of the variables <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e204" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e205" xlink:type="simple"/></inline-formula> are available. The measurements are assumed to be very noisy and sparse.</p>
<p>As soon as the temperature is increased, we observe a rapid accumulation of the chaperones and of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e206" xlink:type="simple"/></inline-formula> factor. After approximately 50 minutes, the system reaches a new steady state, characterized by elevated levels of these proteins. Given this kind of behavior, it makes sense to take measurements very frequently soon after the heat shock is applied. The sampling interval can then be increased, since the system doesn't evolve as quickly any more. We choose to sample at <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e207" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e208" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e209" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e210" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e211" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e212" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e213" xlink:type="simple"/></inline-formula> minutes. From <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e214" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e215" xlink:type="simple"/></inline-formula> we choose a constant sampling period of 25 minutes. This choice requires the collection of 22 total data points.</p>
<p>Once the time vector has been determined, we can run the experiments and collect our measurements. In this example, the data for the measurements are generated <italic>in silico</italic>. First we simulate the model and evaluate the solution at the given time instants, and then we add white Gaussian noise to it to simulate measurement noise. Typical measurement signals are shown in <xref ref-type="fig" rid="pcbi-1000696-g002">Figure 2</xref>. The components of the noise have variances equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e216" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e217" xlink:type="simple"/></inline-formula>. The red dotted lines represent the noise-free solutions obtained from the run of the model. The green squares represent the actual information known to the filter. The data points are collected at the sampling instants described above.</p>
<fig id="pcbi-1000696-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.g002</object-id><label>Figure 2</label><caption>
<title>Estimation of 2 parameters in the heat shock model.</title>
<p>The data points (green squares) are obtained by evaluating the true model solution (red dashed curve) at the chosen time points, and then adding white Gaussian noise. The blue solid line shows the reconstructed solution corresponding to the HEKF estimates for the parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e218" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e219" xlink:type="simple"/></inline-formula>. Both the reconstructed measurement signal for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e220" xlink:type="simple"/></inline-formula> (top) and the one for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e221" xlink:type="simple"/></inline-formula> (bottom) are very close to the respective true solutions. The graphs are zoomed to highlight the transient response of the heat shock system after a temperature increase.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.g002" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1000696-g003">Figure 3</xref> shows the results of a typical run of the hybrid extended Kalman filter applied to this problem. The filter is started from initial conditions equal to <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e222" xlink:type="simple"/></inline-formula>. The dotted line represents the true value of the parameter. The red triangles show how the filter updates the estimate based on the information that comes from the measurements. After a transient, the estimates keep oscillating around the true values of the parameters. From this time-varying signal, a single number is extracted by averaging over the last ten samples (marked by the green line), when the filter has converged to a steady state. The final estimates for this simulation are<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e223" xlink:type="simple"/></disp-formula>while the true value is 3 for both parameters. Even in presence of such high levels of noise, the estimation is very accurate, with less than <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e224" xlink:type="simple"/></inline-formula> error. The ideal and reconstructed solutions are almost indistinguishable.</p>
<fig id="pcbi-1000696-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.g003</object-id><label>Figure 3</label><caption>
<title>Time evolution of the Kalman filter parameter estimates in the heat shock model.</title>
<p>After an initial transient, the estimates of the two parameters <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e225" xlink:type="simple"/></inline-formula> (top) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e226" xlink:type="simple"/></inline-formula> (bottom), represented by the triangles, keep oscillating around the respective true values (blue dashed line). The last 10 samples (connected by the green line) are averaged to extract a single number from this time-varying signal.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.g003" xlink:type="simple"/></fig></sec><sec id="s3a3">
<title>A posteriori identifiability test</title>
<p>To check the estimation results we just obtained, we compute the point and interval estimates of the variances of the two components of the measurement noise according to (13) and (15) respectively. We fix a confidence coefficient of 0.95.</p>
<p>For the first component of the noise we get<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e227" xlink:type="simple"/></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e228" xlink:type="simple"/></disp-formula>The error between the real variance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e229" xlink:type="simple"/></inline-formula> and the point estimate is only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e230" xlink:type="simple"/></inline-formula>. Moreover, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e231" xlink:type="simple"/></inline-formula> lies in the interval estimate.</p>
<p>For the second component of the noise we get<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e232" xlink:type="simple"/></disp-formula>and<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e233" xlink:type="simple"/></disp-formula>The error between the real variance <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e234" xlink:type="simple"/></inline-formula> and the point estimate is only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e235" xlink:type="simple"/></inline-formula>. Moreover, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e236" xlink:type="simple"/></inline-formula> lies in the interval estimate. These results confirm that the estimates we obtained using the hybrid extended Kalman filter can be considered valid.</p>
</sec><sec id="s3a4">
<title>Model selection</title>
<p>To illustrate the use of the Kalman filter for model selection, consider again the measurements signals shown in <xref ref-type="fig" rid="pcbi-1000696-g002">Figure 2</xref>. In this case, the problem is not the estimation of the parameters (which are assumed to be known), but the comparison of two different models for the process. Following the notation introduced earlier, let <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e237" xlink:type="simple"/></inline-formula> be (18) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e238" xlink:type="simple"/></inline-formula> be the model:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e239" xlink:type="simple"/><label>(19)</label></disp-formula>The key difference between <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e240" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e241" xlink:type="simple"/></inline-formula> is the presence or absence of the spike in the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e242" xlink:type="simple"/></inline-formula> factor following the heat shock. This corresponds to turning off one of the feedback loops in the heat shock response system. The two solutions are compared in <xref ref-type="fig" rid="pcbi-1000696-g004">Figure 4</xref>. The thick dotted lines in the plots represent the ideal time evolutions of chaperones and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e243" xlink:type="simple"/></inline-formula> factor simulated using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e244" xlink:type="simple"/></inline-formula> (red) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e245" xlink:type="simple"/></inline-formula> (blue). The triangles represent the relative estimated temporal evolutions using the HEKF.</p>
<fig id="pcbi-1000696-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.g004</object-id><label>Figure 4</label><caption>
<title>Discrimination between competing heat shock models.</title>
<p>The models (18) (blue) and (19) (red) are compared in terms of their <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e246" xlink:type="simple"/></inline-formula> (top) and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e247" xlink:type="simple"/></inline-formula> (bottom) outputs. Both signals evolve to the same steady state, but with different transient behavior. The dashed lines represent the ideal model solutions, the triangles are the corresponding Kalman filter estimates.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.g004" xlink:type="simple"/></fig>
<p>We now obtain the estimates of the measurement noise using (17) and compute the point and interval estimates of the variances of their components using (13) and (14). The results are summarized in <xref ref-type="table" rid="pcbi-1000696-t001">Table 1</xref>. It is clear that only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e248" xlink:type="simple"/></inline-formula> produces results that are compatible with the measurements. Therefore, we can reject <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e249" xlink:type="simple"/></inline-formula> as an inaccurate model with a probability of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e250" xlink:type="simple"/></inline-formula>.</p>
<table-wrap id="pcbi-1000696-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.t001</object-id><label>Table 1</label><caption>
<title>Discrimination of the heat shock models.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000696-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Model</td>
<td align="left" colspan="2" rowspan="1">Component 1</td>
<td align="left" colspan="2" rowspan="1">Component 2</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Point</td>
<td align="left" colspan="1" rowspan="1">Interval</td>
<td align="left" colspan="1" rowspan="1">Point</td>
<td align="left" colspan="1" rowspan="1">Interval</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e251" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e252" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e253" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e254" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e255" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e256" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e257" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e258" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e259" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e260" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Real variances</td>
<td align="left" colspan="2" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e261" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="2" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e262" xlink:type="simple"/></inline-formula></td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>The table shows the point estimates (13) and interval estimates (14) of the measurement noise variances corresponding to the models <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e263" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e264" xlink:type="simple"/></inline-formula>. We note that the real variances encoded in the matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e265" xlink:type="simple"/></inline-formula> lie inside the interval estimates for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e266" xlink:type="simple"/></inline-formula>, but not inside the ones for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e267" xlink:type="simple"/></inline-formula>. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e268" xlink:type="simple"/></inline-formula> test indicates that only <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e269" xlink:type="simple"/></inline-formula> is consistent with the data.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s3a5">
<title>Large parameter space case</title>
<p>Suppose now we seek to estimate 6 of the parameters in (18), namely <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e270" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e271" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e272" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e273" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e274" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e275" xlink:type="simple"/></inline-formula>. We are going to use the same type of measurements as in the previous case, with as many data points and as much noise.</p>
<p>In this new example, a single run of the HEKF produces values that do not satisfy the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e276" xlink:type="simple"/></inline-formula> identifiability test. The interval estimates generated by the test do not contain the real variances that were used to generate the measurements, thereby indicating that the parameter values inferred by the HEKF can not be considered valid (<xref ref-type="fig" rid="pcbi-1000696-g005">Figure 5</xref>). Therefore, we apply the estimate refinement technique introduced in the <xref ref-type="sec" rid="s2">Methods</xref> Section. We minimize (15) with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e277" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e278" xlink:type="simple"/></inline-formula>. For the minimization we use the Broyden-Fletcher-Goldfarb-Shanno (BFGS) algorithm, as described in <xref ref-type="bibr" rid="pcbi.1000696-Fletcher1">[36]</xref> and as implemented in the GNU Scientific Library <xref ref-type="bibr" rid="pcbi.1000696-Galassi1">[38]</xref>.</p>
<fig id="pcbi-1000696-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.g005</object-id><label>Figure 5</label><caption>
<title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e279" xlink:type="simple"/></inline-formula> interval estimates in the case of valid and invalid parameter sets.</title>
<p>The red set of interval estimates corresponds to a parameter set computed with the HEKF only (invalid). The green set corresponds to a parameter set that was obtained with the combination of HEKF and moment matching optimization (valid). The real variances (blue triangles) only lie inside the intervals corresponding to a valid estimation. The top panel is relative to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e280" xlink:type="simple"/></inline-formula> measurement signal, the bottom panel to the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e281" xlink:type="simple"/></inline-formula> measurement signal.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.g005" xlink:type="simple"/></fig>
<p>The results are presented in <xref ref-type="fig" rid="pcbi-1000696-g006">Figure 6</xref>. A minimum was found after 1560 iterations of the BFGS algorithm, with a cost value of 0.14 (note that the optimal value of the cost is zero). The minimization took about 3 hours to run on a MacBook Pro with a single 2.6 GHz processor. <xref ref-type="fig" rid="pcbi-1000696-g005">Figure 5</xref> shows how the interval estimates of the variances for the refined estimates now contain the real variances.</p>
<fig id="pcbi-1000696-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.g006</object-id><label>Figure 6</label><caption>
<title>Estimation of 6 parameters in the heat shock model.</title>
<p>The data points (green squares) are obtained by evaluating the true model solution (red dashed curve) at the chosen time points, and then adding white Gaussian noise. The blue solid line shows the reconstructed solution corresponding to the parameters estimates. Both the reconstructed measurement signal for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e282" xlink:type="simple"/></inline-formula> (top) and the one for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e283" xlink:type="simple"/></inline-formula> (bottom) are very close to the respective true solutions. The graphs are zoomed to highlight the transient response of the heat shock system after a temperature increase.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.g006" xlink:type="simple"/></fig>
<p>We also compared the results of our method with a nonlinear Levenberg-Marquardt least-squares fitting and a genetic algorithm fitting directly on the data points. The results are summarized in <xref ref-type="table" rid="pcbi-1000696-t002">Tables 2</xref>, <xref ref-type="table" rid="pcbi-1000696-t003">3</xref> and <xref ref-type="table" rid="pcbi-1000696-t004">4</xref>. If we compare the three tables, it is clear that only our method was capable of estimating a parameter set that was consistent with the simulated data in the sense of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e284" xlink:type="simple"/></inline-formula> test.</p>
<table-wrap id="pcbi-1000696-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.t002</object-id><label>Table 2</label><caption>
<title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e285" xlink:type="simple"/></inline-formula> test results for the estimation of 6 parameters in the heat shock model (moment matching).</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000696-t002-2" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.t002" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="2" rowspan="1">BFGS moments</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Component 1</td>
<td align="left" colspan="1" rowspan="1">Component 2</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Mean error</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e286" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e287" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e288" xlink:type="simple"/></inline-formula> point</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e289" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1">890.6</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e290" xlink:type="simple"/></inline-formula> interval</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e291" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e292" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Real variances</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e293" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e294" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e295" xlink:type="simple"/></inline-formula> test result</td>
<td align="center" colspan="2" rowspan="1">pass</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt102"><label/><p>The table shows the point estimates (13) and interval estimates (14) of the measurement noise variances corresponding to the parameter set computed using the BFGS moment matching optimization described in the <xref ref-type="sec" rid="s2">Methods</xref> Section. The optimization took 1560 iterations (about 3 hours running time). All the interval estimates contain the corresponding real variances, indicating that the parameter set can be considered valid in the sense of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e296" xlink:type="simple"/></inline-formula> test.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000696-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.t003</object-id><label>Table 3</label><caption>
<title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e297" xlink:type="simple"/></inline-formula> test results for the estimation of 6 parameters in the heat shock model (nonlinear least-squares).</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000696-t003-3" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.t003" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="2" rowspan="1">LM data</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Component 1</td>
<td align="left" colspan="1" rowspan="1">Component 2</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Mean error</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e298" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e299" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e300" xlink:type="simple"/></inline-formula> point</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e301" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e302" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e303" xlink:type="simple"/></inline-formula> interval</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e304" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e305" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Real variances</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e306" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e307" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e308" xlink:type="simple"/></inline-formula> test result</td>
<td align="center" colspan="2" rowspan="1">fail</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt103"><label/><p>The table shows the point estimates (13) and interval estimates (14) of the measurement noise variances corresponding to the parameter set computed using a nonlinear least-squares fitting directly on the data points. The fitting was carried out with the Levenberg-Marquardt algorithm (LM). The optimization took 115 iterations (about 21 minutes running time). The interval estimates do not contain the corresponding real variances, indicating that the parameter set is invalidated by the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e309" xlink:type="simple"/></inline-formula> test.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000696-t004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.t004</object-id><label>Table 4</label><caption>
<title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e310" xlink:type="simple"/></inline-formula> test results for the estimation of 6 parameters in the heat shock model (genetic algorithm).</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000696-t004-4" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.t004" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="2" rowspan="1">GA data</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Component 1</td>
<td align="left" colspan="1" rowspan="1">Component 2</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Mean error</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e311" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e312" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e313" xlink:type="simple"/></inline-formula> point</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e314" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e315" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e316" xlink:type="simple"/></inline-formula> interval</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e317" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e318" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Real variances</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e319" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e320" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e321" xlink:type="simple"/></inline-formula> test result</td>
<td align="center" colspan="2" rowspan="1">fail</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt104"><label/><p>The table shows the point estimates (13) and interval estimates (14) of the measurement noise variances corresponding to the parameter set computed using a genetic algorithm (GA) fitting directly on the data points. The optimization took 106 iterations (about 5 minutes running time). The interval estimate for component 2 does not contain the corresponding real variance, indicating that the parameter set is invalidated by the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e322" xlink:type="simple"/></inline-formula> test.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s3b">
<title>The repressilator</title>
<p>The repressilator is a synthetic gene regulatory network, whose model is frequently used as an example for numerical algorithms <xref ref-type="bibr" rid="pcbi.1000696-Toni1">[10]</xref>,<xref ref-type="bibr" rid="pcbi.1000696-Quach1">[27]</xref>. It consists of three genes connected in a feedback loop, where each gene transcribes the repressor protein for the next gene in the loop. The original model of Elowitz and Leibler <xref ref-type="bibr" rid="pcbi.1000696-Elowitz1">[39]</xref> consists of six equations with four parameters, where all the three genes have the same production and degradation rates, and are affected in the same way by the corresponding repressor. Likewise, the three proteins have the same production and degradation rates.</p>
<p>In this example we consider a more general version of the repressilator, where each component is allowed to have different parameters. The model equations are as follows<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e323" xlink:type="simple"/><label>(20)</label></disp-formula>for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e324" xlink:type="simple"/></inline-formula>, with the convention that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e325" xlink:type="simple"/></inline-formula>. The interactions of each gene/protein pair are characterized by 6 rates, therefore the total number of parameters to be estimated is 18.</p>
<p>We are assuming that we are able to measure the mRNA concentrations (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e326" xlink:type="simple"/></inline-formula>), but not the protein concentrations (<inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e327" xlink:type="simple"/></inline-formula>). We collect 30 equally spaced data points for each mRNA species. The noise in the measurements is assumed to have a power (i.e. variance) of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e328" xlink:type="simple"/></inline-formula> of the mean of the signal. The parameters and the initial conditions to generate the simulated data are chosen so that the system displays a limit cycle behavior.</p>
<p>As in the large parameter space case for the heat shock model, a single run of the HEKF produces estimates that do not satisfy the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e329" xlink:type="simple"/></inline-formula> identifiability test. Therefore, we apply the estimate refinement technique by minimizing (15) with <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e330" xlink:type="simple"/></inline-formula>. The results are presented in <xref ref-type="fig" rid="pcbi-1000696-g007">Figure 7</xref>. For the sake of brevity, we only show the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e331" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e332" xlink:type="simple"/></inline-formula> measurements. The <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e333" xlink:type="simple"/></inline-formula> measurement is presented in the supporting <xref ref-type="supplementary-material" rid="pcbi.1000696.s002">Figure S1</xref>.</p>
<fig id="pcbi-1000696-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.g007</object-id><label>Figure 7</label><caption>
<title>Estimation of 18 parameters in the repressilator model.</title>
<p>The data points (green squares) are obtained by evaluating the true model solution (red dashed curve) at the chosen time points, and then adding white Gaussian noise. The blue solid line shows the reconstructed solution corresponding to the estimated parameters. Both the reconstructed measurement signal for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e334" xlink:type="simple"/></inline-formula> (top) and the one for <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e335" xlink:type="simple"/></inline-formula> (bottom) are very close to the respective true solutions. The graph for the measurement <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e336" xlink:type="simple"/></inline-formula> is presented in the supporting <xref ref-type="supplementary-material" rid="pcbi.1000696.s002">Figure S1</xref>.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.g007" xlink:type="simple"/></fig>
<p>We also compared the results of our method with a nonlinear Levenberg-Marquardt least-squares fitting and a genetic algorithm fitting directly on the data points. The results are summarized in <xref ref-type="table" rid="pcbi-1000696-t005">Tables 5</xref>, <xref ref-type="table" rid="pcbi-1000696-t006">6</xref> and <xref ref-type="table" rid="pcbi-1000696-t007">7</xref>. Only our method was capable of estimating a parameter set that was consistent with the simulated data in the sense of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e337" xlink:type="simple"/></inline-formula> test.</p>
<table-wrap id="pcbi-1000696-t005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.t005</object-id><label>Table 5</label><caption>
<title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e338" xlink:type="simple"/></inline-formula> test results for the estimation of 18 parameters in the repressilator model (moment matching).</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000696-t005-5" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.t005" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="3" rowspan="1">BFGS moments</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Component 1</td>
<td align="left" colspan="1" rowspan="1">Component 2</td>
<td align="left" colspan="1" rowspan="1">Component 3</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Mean error</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e339" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e340" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e341" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e342" xlink:type="simple"/></inline-formula> point</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e343" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e344" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e345" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e346" xlink:type="simple"/></inline-formula> interval</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e347" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e348" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e349" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Real variances</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e350" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e351" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e352" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e353" xlink:type="simple"/></inline-formula> test result</td>
<td align="center" colspan="3" rowspan="1">pass</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt105"><label/><p>The table shows the point estimates (13) and interval estimates (14) of the measurement noise variances corresponding to the parameter set computed using the BFGS moment matching optimization described in the <xref ref-type="sec" rid="s2">Methods</xref> Section. The optimization took 720 iterations (about 26 minutes running time). All the interval estimates contain the corresponding real variances, indicating that the parameter set can be considered valid in the sense of the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e354" xlink:type="simple"/></inline-formula> test.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000696-t006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.t006</object-id><label>Table 6</label><caption>
<title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e355" xlink:type="simple"/></inline-formula> test results for the estimation of 18 parameters in the repressilator model (least-squares).</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000696-t006-6" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.t006" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="3" rowspan="1">LM data</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Component 1</td>
<td align="left" colspan="1" rowspan="1">Component 2</td>
<td align="left" colspan="1" rowspan="1">Component 3</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Mean error</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e356" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e357" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e358" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e359" xlink:type="simple"/></inline-formula> point</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e360" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e361" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e362" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e363" xlink:type="simple"/></inline-formula> interval</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e364" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e365" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e366" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Real variances</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e367" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e368" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e369" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e370" xlink:type="simple"/></inline-formula> test result</td>
<td align="center" colspan="3" rowspan="1">fail</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt106"><label/><p>The table shows the point estimates (13) and interval estimates (14) of the measurement noise variances corresponding to the parameter set computed using a nonlinear least-squares fitting directly on the data points. The fitting was carried out with the Levenberg-Marquardt algorithm (LM). The optimization took 129 iterations (about 3 minutes running time). The interval estimate for component 3 does not contain the corresponding real variance, indicating that the parameter set is invalidated by the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e371" xlink:type="simple"/></inline-formula> test.</p></fn></table-wrap-foot></table-wrap><table-wrap id="pcbi-1000696-t007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000696.t007</object-id><label>Table 7</label><caption>
<title><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e372" xlink:type="simple"/></inline-formula> test results for the estimation of 18 parameters in the repressilator model (genetic algorithm).</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000696-t007-7" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.t007" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="1" rowspan="1">Method</td>
<td align="left" colspan="3" rowspan="1">GA data</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Component 1</td>
<td align="left" colspan="1" rowspan="1">Component 2</td>
<td align="left" colspan="1" rowspan="1">Component 3</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1">Mean error</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e373" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e374" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e375" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e376" xlink:type="simple"/></inline-formula> point</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e377" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e378" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e379" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e380" xlink:type="simple"/></inline-formula> interval</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e381" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e382" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e383" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1">Real variances</td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e384" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e385" xlink:type="simple"/></inline-formula></td>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e386" xlink:type="simple"/></inline-formula></td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"><inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e387" xlink:type="simple"/></inline-formula> test result</td>
<td align="center" colspan="3" rowspan="1">fail</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt107"><label/><p>The table shows the point estimates (13) and interval estimates (14) of the measurement noise variances corresponding to the parameter set computed using a genetic algorithm (GA) fitting directly on the data points. The optimization took 101 iterations (about 4 minutes running time). The interval estimates do not contain the real variances, indicating that the parameter set is invalidated by the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e388" xlink:type="simple"/></inline-formula> test.</p></fn></table-wrap-foot></table-wrap></sec></sec><sec id="s4">
<title>Discussion</title>
<p>We have presented a novel approach for parameter estimation and model selection in computational biology. We have used this approach as a basis for a new algorithm for estimating parameters in models of biological systems from noisy and sparse experimental measurements. The approach is based on the combination of an extended Kalman filter algorithm, a statistical accuracy test, and a moment matching procedure. Furthermore, we have showed how the same tools can be used to discriminate among different candidate models of the same biological process. We have demonstrated the application of these ideas through two examples, a reduced order model of the heat shock response in <italic>E. coli</italic> and a generalized model of the repressilator (an additional example is available in the supporting file <xref ref-type="supplementary-material" rid="pcbi.1000696.s001">Text S1</xref>).</p>
<p>Parameter estimation using state observers in general, and the Kalman filter in particular, confers the significant advantage of fully exploiting the prior knowledge on the process that is encoded into the model. Observers are designed using the system's equations themselves, thus taking into account the system's dynamics. The Kalman filter has nice properties that are guaranteed to hold when the underlying dynamical system is linear and the noise statistics are Gaussian. In this case, the Kalman filter is the <italic>optimal</italic> state estimator, meaning that it produces the estimates with the smallest standard deviation of the estimation error. Even if the noise is not Gaussian, the Kalman filter is the optimal linear estimator. When the filter is extended for use with nonlinear dynamical systems through the time-varying linearization (10), such properties only hold in an approximate way, and one loses many of the theoretical guarantees that apply when the model is linear. However, in practice the extended Kalman filter has proven to be a successful choice in a wide range of applications, becoming the de-facto standard in nonlinear state estimation <xref ref-type="bibr" rid="pcbi.1000696-Simon1">[29]</xref>.</p>
<p>The Kalman filter approach to parameter estimation displays some features that make it particularly well suited to biological applications. For example, the <italic>hybrid</italic> Extended Kalman Filter (HEKF) is capable of estimating the parameters of continuous-time models with discrete-time measurements. This is important because most deterministic models of biological systems are continuous-time. However, most experimental techniques produce discrete-time data, often with large and non-uniform sampling intervals. The presented algorithm accommodates such situations without introducing any additional error due to a discretization of the system equations.</p>
<p>In spite of the above advantages, several challenges arise when using the Kalman filter for parameter estimation in a general nonlinear model. First, in the nonlinear setting, the Kalman Filter is not in general the optimal estimator. Moreover, if the initial estimates are too far off the filter may diverge, or converge to an estimate whose mean is different from the true mean. Additional factors can also be a source of error. State observers, as the name implies, were originally developed to estimate the <italic>state</italic> of a system – not its parameters. The state extension that becomes necessary to include the parameters into the estimation variables can introduce non-uniqueness of the solution (loss of observability), which can be problematic for the algorithms <xref ref-type="bibr" rid="pcbi.1000696-Simon1">[29]</xref>. Furthermore, the covariance propagation equation in (6) is subject to numerical ill-conditioning, which can make the estimated error covariance matrices unreliable. These are some of the key reasons why the extended Kalman filter can produce unreliable estimates, and consequently, why a refined algorithm is needed for parameter estimation.</p>
<p>To alleviate some of the shortcomings of the HEKF in parameter estimation, we have proposed to augment the HEKF with an a posteriori <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e389" xlink:type="simple"/></inline-formula> statistical test and a subsequent optimization stage, both of which explicitly incorporate the information about measurement noise statistics into the estimation process. The test serves as a tool for the statistical reliability assessment of computed estimates, which validates the consistency of these estimates with respect to noise statistics. It also inspires a new technique for the discrimination between different candidate models for the same process. When the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e390" xlink:type="simple"/></inline-formula> test shows that filter parameter estimates are inconsistent with the noise model, which can happen for any of the reasons mentioned in the previous paragraph, an estimate refinement step can become necessary. This takes the form of an optimization stage that begins where the HEKF left off. This proceeds until an estimate that satisfies the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e391" xlink:type="simple"/></inline-formula> test is reached.</p>
<p>If the <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e392" xlink:type="simple"/></inline-formula> test for parameter estimates is the sole measure for accepting or rejecting a parameter estimate, then why not use it solely for parameter estimation by optimizing that measure directly, bypassing the Kalman Filter altogether? In the small parameter space case, numerical evidence suggests that if a unique solution to the parameter estimation problem exists, the HEKF is able to infer it with great speed and accuracy. This was seen in both the heat shock model and in the gene expression model, available in the supporting file <xref ref-type="supplementary-material" rid="pcbi.1000696.s001">Text S1</xref>. If the number of parameters is large and a good initial guess is not available, the HEKF is still able to run and provide a suitable initial guess for the subsequent refinement step, which can be expected to significantly reduce the running time of the moment matching optimization. Furthermore, the HEKF provides a computationally cheap algorithm, which scales much better than e.g. Bayesian methods and the particle filter. For these reasons, we believe that the HEKF represents a good choice as a first stage followed by moment matching optimization.</p>
<p>Coupling the Kalman filter with the statistical moment matching minimization presents a new way of thinking about optimization in parameter estimation. Classically, optimization is performed by trying to fit the model solution with the experimental data. While this is successful in some cases, it gives no guarantee that the parameters will produce a solution that is statistically consistent with the data. In the repressilator example, for instance, the classical least squares fitting produces for the state <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000696.e393" xlink:type="simple"/></inline-formula> a variance that is too small compared to the one that was used to generated the simulated measurements (<xref ref-type="table" rid="pcbi-1000696-t006">Table 6</xref>). In this situation, one runs into the issue of overfitting, in which the fitted model seems to replicate very well the behavior suggested by the data but fails to be robust to perturbations, so whenever it is used for further investigation, its behavior exhibits large inaccuracies. In contrast, the approach proposed here aims to match the mean and the variance of the measurement noise instead of the data points themselves, and is therefore able to “look beyond the noise” to recover the model parameters.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000696.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.s001" xlink:type="simple"><label>Text S1</label><caption>
<p>Text supporting information file, with additional examples and discussion.</p>
<p>(0.29 MB PDF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000696.s002" mimetype="application/postscript" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000696.s002" xlink:type="simple"><label>Figure S1</label><caption>
<p>Estimation of 18 parameters in the repressilator model (measurement m<sub>3</sub>). The data points (green squares) are obtained by evaluating the true model solution (red dashed curve) at the chosen time points, and then adding white Gaussian noise. The blue solid line shows the reconstructed solution corresponding to the estimated parameters.</p>
<p>(0.42 MB EPS)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1000696-Ingram1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ingram</surname><given-names>PJ</given-names></name>
<name name-style="western"><surname>Stumpf</surname><given-names>MPH</given-names></name>
<name name-style="western"><surname>Stark</surname><given-names>J</given-names></name>
</person-group>             <year>2006</year>             <article-title>Network motifs: structure does not determine function.</article-title>             <source>BMC Genomics</source>             <volume>7</volume>             <fpage>108</fpage>          </element-citation></ref>
<ref id="pcbi.1000696-Mayo1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mayo</surname><given-names>AE</given-names></name>
<name name-style="western"><surname>Setty</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Shavit</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Zaslaver</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Alon</surname><given-names>U</given-names></name>
</person-group>             <year>2006</year>             <article-title>Plasticity of the <italic>cis</italic>-regulatory input function of a gene.</article-title>             <source>PLoS Biol</source>             <volume>4</volume>             <fpage>e45</fpage>          </element-citation></ref>
<ref id="pcbi.1000696-Mendes1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Mendes</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Kell</surname><given-names>D</given-names></name>
</person-group>             <year>1998</year>             <article-title>Non-linear optimization of biochemical pathways: applications to metabolic engineering and parameter estimation.</article-title>             <source>Bioinformatics</source>             <volume>14</volume>             <fpage>869</fpage>             <lpage>883</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Kirkpatrick1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kirkpatrick</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Gelatt</surname><given-names>CD</given-names></name>
<name name-style="western"><surname>Vecchi</surname><given-names>MP</given-names></name>
</person-group>             <year>1983</year>             <article-title>Optimization by simulated annealing.</article-title>             <source>Science</source>             <volume>220</volume>             <fpage>671</fpage>             <lpage>680</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Srinivas1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Srinivas</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Patnaik</surname><given-names>L</given-names></name>
</person-group>             <year>1994</year>             <article-title>Genetic algorithms: a survey.</article-title>             <source>Computer</source>             <volume>27</volume>             <fpage>17</fpage>             <lpage>26</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Ashyraliyev1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ashyraliyev</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Jaeger</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Blom</surname><given-names>J</given-names></name>
</person-group>             <year>2008</year>             <article-title>Parameter estimation and determinability analysis applied to <italic>Drosophila</italic> gap gene circuits.</article-title>             <source>BMC Systems Biology</source>             <volume>2</volume>          </element-citation></ref>
<ref id="pcbi.1000696-Moles1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Moles</surname><given-names>CG</given-names></name>
<name name-style="western"><surname>Mendes</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Banga</surname><given-names>JR</given-names></name>
</person-group>             <year>2003</year>             <article-title>Parameter Estimation in biochemical pathways: a comparison of global optimization methods.</article-title>             <source>Genome Research</source>             <volume>13</volume>             <fpage>2467</fpage>             <lpage>2474</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Wilkinson1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wilkinson</surname><given-names>DJ</given-names></name>
</person-group>             <year>2007</year>             <article-title>Bayesian methods in bioinformatics and computational systems biology.</article-title>             <source>Brief Bioinform</source>             <fpage>bbm007</fpage>          </element-citation></ref>
<ref id="pcbi.1000696-McAdams1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>McAdams</surname><given-names>HH</given-names></name>
<name name-style="western"><surname>Arkin</surname><given-names>A</given-names></name>
</person-group>             <year>1999</year>             <article-title>It's a noisy business! Genetic regulation at the nanomolar scale.</article-title>             <source>Trends in Genetics</source>             <volume>15</volume>             <fpage>65</fpage>             <lpage>69</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Toni1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Toni</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Welch</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Strelkowa</surname><given-names>N</given-names></name>
<name name-style="western"><surname>Ipsen</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Stumpf</surname><given-names>MPH</given-names></name>
</person-group>             <year>2009</year>             <article-title>Approximate Bayesian computation scheme for parameter inference and model selection in dynamical systems.</article-title>             <source>Journal of The Royal Society Interface</source>             <volume>6</volume>             <fpage>187</fpage>             <lpage>202</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Brooks1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brooks</surname><given-names>SP</given-names></name>
</person-group>             <year>1998</year>             <article-title>Markov chain Monte Carlo method and its application.</article-title>             <source>The Statistician</source>             <volume>47</volume>             <fpage>69</fpage>             <lpage>100</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Brown1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Brown</surname><given-names>KS</given-names></name>
<name name-style="western"><surname>Sethna</surname><given-names>JP</given-names></name>
</person-group>             <year>2003</year>             <article-title>Statistical mechanical approaches to models with many poorly known parameters.</article-title>             <source>Phys Rev E</source>             <volume>68</volume>             <fpage>021904</fpage>          </element-citation></ref>
<ref id="pcbi.1000696-Battogtokh1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Battogtokh</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Asch</surname><given-names>DK</given-names></name>
<name name-style="western"><surname>Case</surname><given-names>ME</given-names></name>
<name name-style="western"><surname>Arnold</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Schottler</surname><given-names>HB</given-names></name>
</person-group>             <year>2002</year>             <article-title>An ensemble method for identifying regulatory circuits with special reference to the <italic>qa</italic> gene cluster of <italic>Neurospora crassa</italic>.</article-title>             <source>PNAS</source>             <volume>99</volume>             <fpage>16904</fpage>             <lpage>16909</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Sisson1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sisson</surname><given-names>SA</given-names></name>
<name name-style="western"><surname>Fan</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Tanaka</surname><given-names>MM</given-names></name>
</person-group>             <year>2007</year>             <article-title>Sequential Monte Carlo without likelihoods.</article-title>             <source>PNAS</source>             <volume>104</volume>             <fpage>1760</fpage>             <lpage>1765</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Muller1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Muller</surname><given-names>TG</given-names></name>
<name name-style="western"><surname>Faller</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Timmer</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Swameye</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Sandra</surname><given-names>O</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Tests for cycling in a signalling pathway.</article-title>             <source>Journal of the Royal Statistical Society Series C</source>             <volume>53</volume>             <fpage>557</fpage>             <lpage>568</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Bortz1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bortz</surname><given-names>DM</given-names></name>
<name name-style="western"><surname>Nelson</surname><given-names>PW</given-names></name>
</person-group>             <year>2006</year>             <article-title>Model selection and mixed-effects modeling of HIV infection dynamics.</article-title>             <source>Bulletin of Mathematical Biology</source>             <volume>68</volume>             <fpage>2005</fpage>             <lpage>2025</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Hulhoven1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hulhoven</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Vande Wouwer</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Bogaerts</surname><given-names>P</given-names></name>
</person-group>             <year>2006</year>             <article-title>Hybrid extended Luenberger-asymptotic observer for bioprocess state estimation.</article-title>             <source>Chemical Engineering Science</source>             <volume>61</volume>             <fpage>7151</fpage>             <lpage>7160</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Wells1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wells</surname><given-names>CH</given-names></name>
</person-group>             <year>1971</year>             <article-title>Application of modern estimation and identification techniques to chemical processes.</article-title>             <source>AIChE Journal</source>             <volume>17</volume>             <fpage>966</fpage>             <lpage>973</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Lillacci1"><label>19</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lillacci</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Valigi</surname><given-names>P</given-names></name>
</person-group>             <year>2007</year>             <article-title>State observers for the estimation of mRNA and protein dynamics.</article-title>             <fpage>108</fpage>             <lpage>111</lpage>             <comment>In: 3rd IEEE-NIH Life Science Systems and Applications Workshop (LISSA07)</comment>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/LSSA.2007.4400896" xlink:type="simple">10.1109/LSSA.2007.4400896</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000696-Lillacci2"><label>20</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Lillacci</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Valigi</surname><given-names>P</given-names></name>
</person-group>             <year>2008</year>             <article-title>State estimation for a model of gene expression.</article-title>             <comment>In: IEEE International Symposium on Circuits and Systems (ISCAS08). doi:10.1109/ISCAS.2008.4541850</comment>          </element-citation></ref>
<ref id="pcbi.1000696-Bullinger1"><label>21</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bullinger</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Allgower</surname><given-names>F</given-names></name>
</person-group>             <year>1997</year>             <article-title>An adaptive high-gain observer for nonlinear systems.</article-title>             <fpage>4348</fpage>             <lpage>4353</lpage>             <comment>In: 36th IEEE Conference on Decision and Control (CDC97). volume 5</comment>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/CDC.1997.649541" xlink:type="simple">10.1109/CDC.1997.649541</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000696-Dochain1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Dochain</surname><given-names>D</given-names></name>
</person-group>             <year>2003</year>             <article-title>State and parameter estimation in chemical and biochemical processes: a tutorial.</article-title>             <source>Journal of Process Control</source>             <volume>13</volume>             <fpage>801</fpage>             <lpage>818</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Farina1"><label>23</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Farina</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Findeisen</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Bullinger</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Bittanti</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Allgower</surname><given-names>F</given-names></name>
<etal/></person-group>             <year>2006</year>             <article-title>Results towards identifiability properties of biochemical reaction networks.</article-title>             <fpage>2104</fpage>             <lpage>2109</lpage>             <comment>In: 45th IEEE Conference on Decision and Control (CDC06)</comment>             <comment>doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/CDC.2006.376925" xlink:type="simple">10.1109/CDC.2006.376925</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000696-Fey1"><label>24</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fey</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Findeisen</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Bullinger</surname><given-names>E</given-names></name>
</person-group>             <year>2008</year>             <article-title>Parameter estimation in kinetic reaction models using nonlinear observers is facilitated by model extensions.</article-title>             <comment>In: 17th IFAC World Congress</comment>          </element-citation></ref>
<ref id="pcbi.1000696-Sun1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sun</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Jin</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Xiong</surname><given-names>M</given-names></name>
</person-group>             <year>2008</year>             <article-title>Extended Kalman filter for estimation of parameters in nonlinear state-space models of biochemical networks.</article-title>             <source>PLoS ONE</source>             <volume>3</volume>             <fpage>e3758</fpage>          </element-citation></ref>
<ref id="pcbi.1000696-Wang1"><label>26</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wang</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>X</given-names></name>
<name name-style="western"><surname>Liu</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Liang</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Vinciotti</surname><given-names>V</given-names></name>
</person-group>             <year>2009</year>             <article-title>An extended Kalman filtering approach to modelling nonlinear dynamic gene regulatory networks via short gene expression time series.</article-title>             <comment>IEEE/ACM Transactions on Computational Biology and Bioinformatics advance online publication</comment>          </element-citation></ref>
<ref id="pcbi.1000696-Quach1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Quach</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Brunel</surname><given-names>N</given-names></name>
<name name-style="western"><surname>d'Alche Buc</surname><given-names>F</given-names></name>
</person-group>             <year>2007</year>             <article-title>Estimating parameters and hidden variables in non-linear state-space models based on ODEs for biological networks inference.</article-title>             <source>Bioinformatics</source>             <volume>23</volume>             <fpage>3209</fpage>             <lpage>3216</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Gutenkunst1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gutenkunst</surname><given-names>RN</given-names></name>
<name name-style="western"><surname>Waterfall</surname><given-names>JJ</given-names></name>
<name name-style="western"><surname>Casey</surname><given-names>FP</given-names></name>
<name name-style="western"><surname>Brown</surname><given-names>KS</given-names></name>
<name name-style="western"><surname>Myers</surname><given-names>CR</given-names></name>
<etal/></person-group>             <year>2007</year>             <article-title>Universally sloppy parameter sensitivities in systems biology models.</article-title>             <source>PLoS Comput Biol</source>             <volume>3</volume>             <fpage>e189</fpage>          </element-citation></ref>
<ref id="pcbi.1000696-Simon1"><label>29</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simon</surname><given-names>D</given-names></name>
</person-group>             <year>2006</year>             <source>Optimal State Estimation</source>             <publisher-name>Wiley</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000696-Simon2"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simon</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Chia</surname><given-names>TL</given-names></name>
</person-group>             <year>2002</year>             <article-title>Kalman filtering with state equality constraints.</article-title>             <source>IEEE Transactions on Aerospace and Electronic Systems</source>             <volume>38</volume>             <fpage>128</fpage>             <lpage>136</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Simon3"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simon</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Simon</surname><given-names>DL</given-names></name>
</person-group>             <year>2005</year>             <article-title>Aircraft turbofan engine health estimation using constrained Kalman filtering.</article-title>             <source>Journal of Engineering for Gas Turbines and Power</source>             <volume>127</volume>             <fpage>323</fpage>             <lpage>328</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Anderson1"><label>32</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Anderson</surname><given-names>BDO</given-names></name>
<name name-style="western"><surname>Moore</surname><given-names>JB</given-names></name>
</person-group>             <year>2005</year>             <source>Optimal filtering</source>             <publisher-name>Dover Publications</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000696-Coleman1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Coleman</surname><given-names>TF</given-names></name>
<name name-style="western"><surname>Li</surname><given-names>Y</given-names></name>
</person-group>             <year>1996</year>             <article-title>A reflective Newton method for minimizing a quadratic function subject to bounds on some of the variables.</article-title>             <source>SIAM Journal on Optimization</source>             <volume>6</volume>             <fpage>1040</fpage>             <lpage>1058</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Gill1"><label>34</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gill</surname><given-names>PE</given-names></name>
<name name-style="western"><surname>Murray</surname><given-names>W</given-names></name>
<name name-style="western"><surname>Wright</surname><given-names>MH</given-names></name>
</person-group>             <year>1982</year>             <source>Practical optimization</source>             <publisher-name>Academic Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000696-Papoulis1"><label>35</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Papoulis</surname><given-names>A</given-names></name>
</person-group>             <year>1991</year>             <source>Probability, random variables and stochastic processes</source>             <publisher-name>McGraw-Hill, third edition</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000696-Fletcher1"><label>36</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fletcher</surname><given-names>R</given-names></name>
</person-group>             <year>2000</year>             <source>Practical methods of optimization.</source>             <publisher-name>Wiley</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000696-ElSamad1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>El-Samad</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Prajna</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Papachristodoulou</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Doyle</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Khammash</surname><given-names>M</given-names></name>
</person-group>             <year>2006</year>             <article-title>Advanced methods and algorithms for biological networks analysis.</article-title>             <source>Proceedings of the IEEE</source>             <volume>94</volume>             <fpage>832</fpage>             <lpage>853</lpage>          </element-citation></ref>
<ref id="pcbi.1000696-Galassi1"><label>38</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Galassi</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Davies</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Theiler</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Gough</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Jungman</surname><given-names>G</given-names></name>
<etal/></person-group>             <year>2009</year>             <source>GNU Scientific Library reference manual</source>             <publisher-name>Network Theory, third edition</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000696-Elowitz1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Elowitz</surname><given-names>MB</given-names></name>
<name name-style="western"><surname>Leibler</surname><given-names>S</given-names></name>
</person-group>             <year>2000</year>             <article-title>A synthetic oscillatory network of transcriptional regulators.</article-title>             <source>Nature</source>             <volume>403</volume>             <fpage>335</fpage>             <lpage>338</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>