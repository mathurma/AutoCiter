<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01266</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003535</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer and information sciences</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Phylogenetic Quantification of Intra-tumour Heterogeneity</article-title>
<alt-title alt-title-type="running-head">Quantification of Tumour Heterogeneity</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Schwarz</surname><given-names>Roland F.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Trinh</surname><given-names>Anne</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Sipos</surname><given-names>Botond</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Brenton</surname><given-names>James D.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Goldman</surname><given-names>Nick</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Markowetz</surname><given-names>Florian</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>University of Cambridge, Cambridge, United Kingdom</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Cancer Research UK Cambridge Institute, Cambridge, United Kingdom</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>European Molecular Biology Laboratory, European Bioinformatics Institute, Hinxton, United Kingdom</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Department of Oncology, University of Cambridge, Cambridge, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Beerenwinkel</surname><given-names>Niko</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>ETH Zurich, Switzerland</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">rfs32@cam.ac.uk</email> (RFS); <email xlink:type="simple">florian.markowetz@cruk.cam.ac.uk</email> (FM)</corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: RFS JDB NG FM. Performed the experiments: RFS AT BS. Analyzed the data: RFS. Contributed reagents/materials/analysis tools: AT BS. Wrote the paper: RFS JDB NG FM.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>4</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>17</day><month>4</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>4</issue>
<elocation-id>e1003535</elocation-id>
<history>
<date date-type="received"><day>17</day><month>7</month><year>2013</year></date>
<date date-type="accepted"><day>5</day><month>2</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Schwarz et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" page="e1002972" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1002972"> <article-title>New Methods Section in PLOS Computational Biology</article-title></related-article>
<abstract>
<p>Intra-tumour genetic heterogeneity is the result of ongoing evolutionary change within each cancer. The expansion of genetically distinct sub-clonal populations may explain the emergence of drug resistance, and if so, would have prognostic and predictive utility. However, methods for objectively quantifying tumour heterogeneity have been missing and are particularly difficult to establish in cancers where predominant copy number variation prevents accurate phylogenetic reconstruction owing to horizontal dependencies caused by long and cascading genomic rearrangements. To address these challenges, we present MEDICC, a method for phylogenetic reconstruction and heterogeneity quantification based on a <bold>M</bold>inimum <bold>E</bold>vent <bold>D</bold>istance for <bold>I</bold>ntra-tumour <bold>C</bold>opy-number <bold>C</bold>omparisons. Using a transducer-based pairwise comparison function, we determine optimal phasing of major and minor alleles, as well as evolutionary distances between samples, and are able to reconstruct ancestral genomes. Rigorous simulations and an extensive clinical study show the power of our method, which outperforms state-of-the-art competitors in reconstruction accuracy, and additionally allows unbiased numerical quantification of tumour heterogeneity. Accurate quantification and evolutionary inference are essential to understand the functional consequences of tumour heterogeneity. The MEDICC algorithms are independent of the experimental techniques used and are applicable to both next-generation sequencing and array CGH data.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Cancer is a disease of random mutation and selection within the cellular genomes of an organism. As a result, when advanced disease is diagnosed, the cells comprising the tumour show a great amount of variability on the genomic level, a phenomenon termed intra-tumour genetic heterogeneity. Heterogeneity is thought to be one of the main reasons why tumors become resistant to therapy, and thus hinders personalised medicine approaches. If we want to understand tumour heterogeneity and its connection to resistance development we need to quantify it, which implies reconstructing the evolutionary history of cancer within the patient. Unfortunately, so far, methods for accurate reconstructions of these particular evolutionary trees and for quantification of heterogeneity have been missing. We here present MEDICC, a method that uses a minimum evolution criterion to compare cancer genomes based on genomic profiles of DNA content (copy-number profiles). It enables accurate reconstruction of the history of the disease and quantifies heterogeneity. It is specifically designed to deal with diploid human genomes, in that it disentangles genomic events on both parental alleles and includes a variety of accompanying algorithms to test for shapes of the evolutionary trees as well as the rate at which the cancer evolves.</p>
</abstract>
<funding-group><funding-statement>We acknowledge the support of Cancer Research UK (<ext-link ext-link-type="uri" xlink:href="http://www.cancerresearchuk.org/" xlink:type="simple">http://www.cancerresearchuk.org/</ext-link>), the University of Cambridge (<ext-link ext-link-type="uri" xlink:href="http://www.cam.ac.uk/" xlink:type="simple">http://www.cam.ac.uk/</ext-link>), National Institute for Health Research Cambridge Biomedical Research Centre (<ext-link ext-link-type="uri" xlink:href="http://www.cambridge-brc.org.uk/" xlink:type="simple">http://www.cambridge-brc.org.uk/</ext-link>), Cambridge Experimental Cancer Medicine Centre (<ext-link ext-link-type="uri" xlink:href="http://www.ecmcnetwork.org.uk/" xlink:type="simple">http://www.ecmcnetwork.org.uk/</ext-link>) and Hutchison Whampoa Limited (<ext-link ext-link-type="uri" xlink:href="http://www.hutchison-whampoa.com/" xlink:type="simple">http://www.hutchison-whampoa.com/</ext-link>). RFS and BS were supported by EMBL Interdisciplinary Postdoc (EIPOD) fellowships with Cofunding from Marie Curie Actions COFUND. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="11"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>The study of intra-tumour genetic heterogeneity (for short: heterogeneity) is now a major focus of cancer genomics research <xref ref-type="bibr" rid="pcbi.1003535-Khalique1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1003535-Gerlinger1">[12]</xref> due to its potential to provide prognostic information <xref ref-type="bibr" rid="pcbi.1003535-Cooke2">[13]</xref>–<xref ref-type="bibr" rid="pcbi.1003535-Park1">[15]</xref> and to explain mechanisms of drug resistance <xref ref-type="bibr" rid="pcbi.1003535-Cooke3">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1003535-Cowin1">[19]</xref>. Quantifying tumour heterogeneity and understanding its aetiology crucially depends on our ability to accurately reconstruct the evolutionary history of cancer cells within each patient. In many cancers, such as high-grade serous ovarian cancer (HGSOC), most of this heterogeneity is not reflected in point mutations but in genomic rearrangements and endoreduplications that lead to aberrant copy-number profiles <xref ref-type="bibr" rid="pcbi.1003535-Network1">[20]</xref>, <xref ref-type="bibr" rid="pcbi.1003535-Ng1">[21]</xref>. In these cases tree inference is hindered by unknown phasing of parental alleles and horizontal dependencies between adjacent genomic loci. Therefore heterogeneity and evolutionary divergence are typically quantified using ad-hoc thresholds <xref ref-type="bibr" rid="pcbi.1003535-Cowin1">[19]</xref> and tree inference is often done subjectively <xref ref-type="bibr" rid="pcbi.1003535-NikZainal1">[11]</xref>. Approaches developed to address this problem include a graph theoretical approach on signed reversals to order rearrangement events <xref ref-type="bibr" rid="pcbi.1003535-Greenman1">[22]</xref>, but this requires detailed annotation of rearrangements in the data that may not be available, and the algorithm does not generally infer global trees representing cancer evolution within a patient. The <italic>TuMult</italic> algorithm <xref ref-type="bibr" rid="pcbi.1003535-Letouz1">[23]</xref> deals with underlying computational complexity by considering only breakpoints — locations on the genome where the copy-number changes — and by using total copy-number without phasing of parental alleles. While simplifying the computational problem, this approach discards potentially informative data.</p>
<p>Our aim is to establish numerical quantification of tumour heterogeneity per patient from copy-number profiles that can routinely be acquired from clinical samples. To this end, we have developed MEDICC (Minimum Event Distance for Intra-tumour Copy-number Comparisons), a method for accurate inference of phylogenetic trees from unsigned integer copy-number profiles. MEDICC specifically addresses the following challenges associated with copy-number-based phylogeny estimation:<list list-type="order"><list-item>
<p>It makes use of the full copy-number information across both parental alleles by <italic>phasing</italic> copy-number variants, i.e. assigning them to one of the two physical alleles such that the overall evolutionary distance is minimal.</p>
</list-item><list-item>
<p>It estimates evolutionary distances, thereby dealing with <italic>horizontal dependencies</italic> between adjacent genomic loci and with multiple overlapping events by using efficient heuristics. It therefore works on complete copy-number profiles instead of breakpoints which allows the reconstruction of ancestral genomes.</p>
</list-item><list-item>
<p>It implements statistical tests for molecular clock (homogeneous branch lengths), star topology (phylogenetic structure) and tests for the relationship between clonal subpopulations to provide informative <italic>summary statistics</italic> for the reconstructed evolutionary histories and tumour heterogeneity.</p>
</list-item></list>MEDICC was designed to work on integer copy-number profiles that can routinely be obtained from single nucleotide polymorphism (SNP) arrays <xref ref-type="bibr" rid="pcbi.1003535-Greenman2">[24]</xref> or paired-end sequencing <xref ref-type="bibr" rid="pcbi.1003535-Korbel1">[25]</xref>,<xref ref-type="bibr" rid="pcbi.1003535-Yoon1">[26]</xref>. In both cases DNA content is quantified relative to a diploid normal in windows along the genome. SNPs distinguish the two parental alleles via the B-allelic frequency, i.e. the amount of DNA assigned to the B allele relative to the total DNA amount at that specific genomic locus. The resulting profile comprises two vectors of integer copy-numbers, representing the absolute number of copies of that particular genomic segment in the two alleles. However, without any external linkage information these vectors contain no information about which copy-numbers belong together on the same allele <xref ref-type="bibr" rid="pcbi.1003535-NikZainal1">[11]</xref>. By convention (and for each genomic segment independently), the larger of the two copy-numbers is termed the <italic>major</italic> and the other the <italic>minor</italic> copy-number (<xref ref-type="fig" rid="pcbi-1003535-g001">Figure 1</xref> left). The process of finding the correct assignment of major and minor copy-number to the two parental alleles is called <italic>phasing</italic>. In contrast to nucleotide substitution models where sites in a sequence are modelled as independent and identically distributed <xref ref-type="bibr" rid="pcbi.1003535-Felsenstein1">[27]</xref>, copy-number events often overlap and range across many adjacent genomic regions. Therefore, finding the correct phasing is essential to accurately estimate evolutionary distances (<xref ref-type="fig" rid="pcbi-1003535-g002">Figure 2A</xref>), which additionally requires a model capable of dealing with these horizontal dependencies.</p>
<fig id="pcbi-1003535-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003535.g001</object-id><label>Figure 1</label><caption>
<title>Evolutionary copy-number trees are reconstructed in three steps.</title>
<p>1) After segmentation and compression, major and minor alleles are phased using the minimum event criterion. 2) The tree topology is reconstructed from the pairwise distances between genomes. 3) Reconstruction of ancestral genomes yields the final branch lengths of the tree, which correspond to the number of events between genomes.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003535.g001" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003535-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003535.g002</object-id><label>Figure 2</label><caption>
<title>Parental alleles are phased using context-free grammars.</title>
<p>A) Allelic phasing is achieved by choosing consecutive segments from either the major or minor allele which minimise the pairwise distance between profiles. B) The set of all possible phasing choices is modelled by a context-free grammar. In this representation, the order of the regions' copy-number values on the second allele is reversed, in order to match the inside-out parsing scheme of CFGs. That way every possible parse tree of the grammar describes one possible phasing.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003535.g002" position="float" xlink:type="simple"/></fig>
<p>We developed MEDICC and successfully applied it to the analysis of a novel dataset of 170 copy-number profiles of patients undergoing neo-adjuvant chemotherapy for HGSOC as described in our accompanying clinical study <xref ref-type="bibr" rid="pcbi.1003535-Schwarz1">[28]</xref>. In the following we give a more detailed description of the data and problems that MEDICC addresses. We then introduce the MEDICC modelling framework that guides all steps of the algorithm and which is then explained in detail. We finish with a demonstration of MEDICC on a real-world example of a case of endometrioid cancer and give simulation results that compare it to competing methods.</p>
</sec><sec id="s3">
<title>Results</title>
<p>Given multiple such evolutionarily-related copy-number profiles, for example from distinct primary and metastatic sites of the same patient, phylogenetic inference in MEDICC then involves three steps: (i) allele-specific assignment of major and minor copy-numbers, (ii) estimation of evolutionary distances between samples followed by tree inference and (iii) reconstruction of ancestral genomes (<xref ref-type="fig" rid="pcbi-1003535-g001">Figure 1</xref>). All three steps are guided by a minimum evolution criterion. Similar to edit-distances for sequence analysis <xref ref-type="bibr" rid="pcbi.1003535-Levenshtein1">[29]</xref>, MEDICC counts the number of genomic events needed to transform one copy-number profile into another and searches for the tree that minimises this criterion.</p>
<sec id="s3a">
<title>MEDICC reconstructs evolutionary histories via a minimum evolution criterion</title>
<p>We model the evolution of copy-number profiles through a series of simple operations that increase or decrease copy-numbers by one (<xref ref-type="fig" rid="pcbi-1003535-g003">Figure 3A</xref>). They map to real genomic rearrangements that have an observable effect on copy-number profiles in the following way: terminal and interstitial deletions, as well as unbalanced translocations, are single deletion events; tandem and inverted duplications are single amplification events; and breakage fusion bridges are dual events involving a duplication and a deletion (copy number decrease on one locus and increase on the second) <xref ref-type="bibr" rid="pcbi.1003535-Greenman1">[22]</xref>. We use a finite-state automaton (FSA) representation of genomic profiles and finite-state transducers (FST) <xref ref-type="bibr" rid="pcbi.1003535-Mohri1">[30]</xref> for modelling and efficient computing of the minimum-event distance based on these genomic events (<xref ref-type="fig" rid="pcbi-1003535-g003">Figure 3B</xref>). Transducers have earlier been proposed as an efficient way of modeling indels on trees <xref ref-type="bibr" rid="pcbi.1003535-Bradley1">[31]</xref>–<xref ref-type="bibr" rid="pcbi.1003535-Schwarz2">[33]</xref>, a problem closely related to the one discussed here. Before going through the three steps of the reconstruction process in detail it is necessary to introduce some terminology; for a more thorough introduction into transducer theory see <xref ref-type="bibr" rid="pcbi.1003535-Mohri1">[30]</xref>, <xref ref-type="bibr" rid="pcbi.1003535-Mohri2">[34]</xref>, <xref ref-type="bibr" rid="pcbi.1003535-Droste1">[35]</xref> and references therein.</p>
<fig id="pcbi-1003535-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003535.g003</object-id><label>Figure 3</label><caption>
<title>Efficient distance calculation is enabled via a transducer architecture.</title>
<p>A) Overlapping genomic rearrangements modify the associated copy-number profiles in different ways. Amplifications are indicated in green, deletions in red. The blue rectangles indicate the previous event. B) The one-step minimum event transducer describes all possible edit operations achievable in one event. This FST is composed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e001" xlink:type="simple"/></inline-formula> times with itself to create the the full minimum event FST <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e002" xlink:type="simple"/></inline-formula>. Edge labels consist of an input symbol, a colon and the corresponding output symbol, followed by a slash and the weight associated with taking that transition. C) The minimum event FST <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e003" xlink:type="simple"/></inline-formula> is asymmetric and describes the evolution of a genomic profile from its ancestor. Composed with its inverse this yields the symmetric minimum event distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e004" xlink:type="simple"/></inline-formula>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003535.g003" position="float" xlink:type="simple"/></fig><sec id="s3a1">
<title>The MEDICC modelling framework</title>
<p>MEDICC models diploid genomic copy-number profiles as sequences over the alphabet <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e005" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e006" xlink:type="simple"/></inline-formula> represent integer copy-numbers (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e007" xlink:type="simple"/></inline-formula> is the maximum haploid copy-number) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e008" xlink:type="simple"/></inline-formula> is a special character that separates the two alleles on which events can happen independently. For example, the profile <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e009" xlink:type="simple"/></inline-formula> represents a chromosome with 7 regions distinguished, with the first region present in one copy on one allele and absent in the other allele; the second region present in one copy on each allele; and so on up to the seventh region present in two copies on each allele. This means that MEDICC deals with a maximum total copy-number of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e010" xlink:type="simple"/></inline-formula> in a diploid genome. By default <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e011" xlink:type="simple"/></inline-formula> which is the upper end of the dynamic range of SNP arrays, but the alphabet can be extended easily without changing the implementation. In this manuscript the terms “sequence” and “(copy-number) profile” are used interchangeably.</p>
<p>Copy-number profiles are implemented as acceptors, unweighted finite-state automata that can contain a single or multiple such profiles. The minimum-event distance is computed using a weighted finite-state transducer <xref ref-type="bibr" rid="pcbi.1003535-Mohri1">[30]</xref>. FSTs are an extension of FSAs with input and output symbols — like pair-HMMs, they emit or accept two sequences simultaneously, meaning they model the events transforming on sequence into another. Both FSAs and FSTs can be equipped with weights from a semiring, enabling calculations to be weighted according to some importance criterion. One of the most common semirings is the real semiring (e.g. the weights represent probabilities), where weights are multiplied along a path in the automaton and the total weight of a sequence (or pair of sequences) is the sum (total probability) over all possible paths generating that sequence. Equally popular is the tropical semiring, also known as the Viterbi path, where weights are summed along a path and the total weight is the minimum across all those paths. In this case weights are often “penalties” or negative log-probabilities for taking a certain path, similar to classical pairwise sequence alignment in which mismatches and indels are penalised with additive fixed scores.</p>
<p>MEDICC uses the tropical semiring for computing the minimum event distance, but the modularity of the framework allows us to smoothly transition to probabilities at a later stage by switching semirings without changing the algorithm. In this tropical semiring a FST <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e012" xlink:type="simple"/></inline-formula> then assigns a score to two sequences (represented as acceptors) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e013" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e014" xlink:type="simple"/></inline-formula> via<disp-formula id="pcbi.1003535.e015"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003535.e015" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e016" xlink:type="simple"/></inline-formula> is the set of all possible paths through the FST in which the input and output symbols match with the sequences <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e017" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e018" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e019" xlink:type="simple"/></inline-formula> is the weight of that path at position <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e020" xlink:type="simple"/></inline-formula> in the sequence. No score is returned for a pair of sequences for which no valid path in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e021" xlink:type="simple"/></inline-formula> exists. This leads to the definition of the minimum-event distance, which governs all three steps of the reconstruction process.</p>
</sec><sec id="s3a2">
<title>Constructing the minimum-event distance for copy-number profiles</title>
<p><xref ref-type="fig" rid="pcbi-1003535-g003">Figure 3B</xref> shows the one-step transducer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e022" xlink:type="simple"/></inline-formula> that we use to model single amplifications and deletions of arbitrary length and that counts one event each time the amplification or deletion state is entered. This is analogous to an affine gap cost model in classical sequence alignment <xref ref-type="bibr" rid="pcbi.1003535-Durbin1">[36]</xref>. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e023" xlink:type="simple"/></inline-formula> therefore assigns to each pair of sequences <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e024" xlink:type="simple"/></inline-formula> the minimum number of events necessary to transform one sequence into another. At this point, however, not all possible copy-number scenarios have a valid path (e.g. one event can amplify “1” to “2” but not “1” to “3”). To include all possible changes across multiple events, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e025" xlink:type="simple"/></inline-formula> is composed <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e026" xlink:type="simple"/></inline-formula> times with itself Mohri2004. In essence, composition describes the chaining of FSTs, where the total weight of the composed transducer is the total minimum score from the input sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e027" xlink:type="simple"/></inline-formula> via intermediate sequences <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e028" xlink:type="simple"/></inline-formula> to the target sequence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e029" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003535.e030"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003535.e030" xlink:type="simple"/></disp-formula>For example, to amplify a copy-number from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e031" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e032" xlink:type="simple"/></inline-formula> the shortest path goes via two intermediate sequences (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e033" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e034" xlink:type="simple"/></inline-formula>) totalling three events (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e035" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e036" xlink:type="simple"/></inline-formula>).</p>
<p>This composition gives rise to the FST <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e037" xlink:type="simple"/></inline-formula> that strictly adheres the modelled biological constraints such as no amplification from zero. We call <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e038" xlink:type="simple"/></inline-formula> the <italic>tree</italic> transducer: these biological constraints give it a direction, and it is not guaranteed to return a distance for any pair of copy-number profiles. For example, input profile <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e039" xlink:type="simple"/></inline-formula> can be transformed into <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e040" xlink:type="simple"/></inline-formula> via a single deletion, but not vice versa as once an allele has been lost it cannot be regained.</p>
<p>As we are interested in the minimum evolutionary distance between any two sequences <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e041" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e042" xlink:type="simple"/></inline-formula> via their last common ancestor (LCA) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e043" xlink:type="simple"/></inline-formula>, the final distance FST <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e044" xlink:type="simple"/></inline-formula> is formed by composing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e045" xlink:type="simple"/></inline-formula> with its inverse (<xref ref-type="fig" rid="pcbi-1003535-g003">Figure 3C</xref>, Schwarz2010), such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e046" xlink:type="simple"/></inline-formula> computes the distance from a leaf node to the LCA (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e047" xlink:type="simple"/></inline-formula>) and back (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e048" xlink:type="simple"/></inline-formula>) to the other leaf node:<disp-formula id="pcbi.1003535.e049"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003535.e049" xlink:type="simple"/></disp-formula>In the real semiring, and equipped with probabilities, this would be analogous to classical phylogenetic reconstructions where a reversible model of sequence evolution is used to compute the likelihood of the subtree containing sequences <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e050" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e051" xlink:type="simple"/></inline-formula> as the products of the individual likelihoods of seeing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e052" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e053" xlink:type="simple"/></inline-formula> given their ancestor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e054" xlink:type="simple"/></inline-formula> and summing over all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e055" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003535-Felsenstein2">[37]</xref>. In our case, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e056" xlink:type="simple"/></inline-formula> equivalently computes the minimum number of events from <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e057" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e058" xlink:type="simple"/></inline-formula> via their LCA. This distance is symmetric and is guaranteed to yield a valid distance for any pair of sequences. In the rest of the paper, “distance” refers to this minimum-event distance, unless stated otherwise.</p>
<p>MEDICC therefore computes an evolutionary distance between two genomes based on a minimum evolution criterion via their closest possible LCA. Due to composition of the tree transducer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e059" xlink:type="simple"/></inline-formula> with its inverse, the resulting distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e060" xlink:type="simple"/></inline-formula> is a dissimilarity score that at the same time is also (the logarithm of) the shortest-path approximation to a positive-semidefinite kernel score <xref ref-type="bibr" rid="pcbi.1003535-Cortes1">[38]</xref>, <xref ref-type="bibr" rid="pcbi.1003535-Schwarz2">[33]</xref>. That means that the pointwise exponential of the estimated distance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e061" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e062" xlink:type="simple"/></inline-formula>, is a positive-semidefinite similarity matrix (with all eigenvalues <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e063" xlink:type="simple"/></inline-formula>). The entries of this matrix are the values of the pairwise dot products of the sample genomes in a high-dimensional feature space. This feature space can be thought of as a space where every possible copy-number profile defines one dimension and sample genome <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e064" xlink:type="simple"/></inline-formula> is represented by a numerical feature vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e065" xlink:type="simple"/></inline-formula> that contains an evolutionary similarity score between the sample genome itself and each of these reference profiles. The entries of the kernel matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e066" xlink:type="simple"/></inline-formula> are then simply the dot products <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e067" xlink:type="simple"/></inline-formula> of the feature vectors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e068" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e069" xlink:type="simple"/></inline-formula>. We term this space the mutational landscape in which spatial distances correspond to evolutionary distances and on which we can directly apply explorative analyses like PCA, classification with support-vector machines and other machine learning techniques <xref ref-type="bibr" rid="pcbi.1003535-ShaweTaylor1">[39]</xref>. We use <italic>OpenFST</italic>, an efficient implementation of transducer algorithms <xref ref-type="bibr" rid="pcbi.1003535-Allauzen1">[40]</xref> to achieve exact distance computation in quadratic time.</p>
<p>Following the minimum evolution principle, the overall objective is to find a tree topology including ancestral states that minimises the total tree length, i.e. the total number of genomic events along the tree. In the following we will describe how MEDICC achieves this in its three step process.</p>
</sec><sec id="s3a3">
<title>Step 1: Evolutionary phasing of major and minor copy-numbers</title>
<p>As copy-number-changing events can independently occur on either or both of the parental alleles the phasing of major and minor copy-numbers heavily influences the minimum tree length objective. We use the evolutionary information between samples to solve these ambiguities. Using our distance measure we can choose a phasing between a pair of diploid profiles that minimises the pairwise distance between them (<xref ref-type="fig" rid="pcbi-1003535-g002">Figure 2A</xref>). This respects the distinct evolutionary histories of both alleles and finds a phasing scenario in which the evolutionary trajectories between both haploid pairs are minimal. From each pair of major and minor input sequences we can generate up to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e070" xlink:type="simple"/></inline-formula> possible phasing choices, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e071" xlink:type="simple"/></inline-formula> is the length of the input profile (both alleles have the same length). This is too many to evaluate exhaustively, so in order to achieve a compact representation of diploid profiles we make use of a context-free grammar (CFG). Our implementation is related to the use of CFGs to model RNA structures, where paired residues in stem regions are not independent <xref ref-type="bibr" rid="pcbi.1003535-Durbin1">[36]</xref>.</p>
<p>In our copy-number scenario a CFG represents different allele phasing choices (see <xref ref-type="fig" rid="pcbi-1003535-g002">Figure 2B</xref> right). At every position in the diploid profile we have a choice of using the major as the first allele and the minor as the second or (“<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e072" xlink:type="simple"/></inline-formula>”) vice versa (<xref ref-type="fig" rid="pcbi-1003535-g002">Figure 2B</xref> left). Each possible parse tree of the CFG then corresponds to one phasing scenario out of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e073" xlink:type="simple"/></inline-formula> possibilities. When the distance FST reads the separator it is forced to return to the match state (initial state), thus guaranteeing that the total distance to another profile equals the sum of the distances of the two alleles with no events spanning different alleles. We represent CFGs algorithmically by pushdown-automata in the FST library <xref ref-type="bibr" rid="pcbi.1003535-Allauzen2">[41]</xref>.</p>
<p>While this approach works well for finding phasing scenarios that minimise the distance between one pair of profiles, we aim to find phasing scenarios that jointly minimise the distances between all profiles in the dataset. To reduce the computational complexity of this task we have found it necessary to employ a heuristic. MEDICC searches for the single profile that has minimum sum of distances to all sample profiles, that is, the geometric median, through an iterative search. This profile is then compared again to each individual profile and the shortest path algorithm yields the choice of phasing that minimises the distance between each profile and the centre. This approach is not guaranteed to return a globally optimal phasing scenario, but has proven to perform very well in simulations (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e074" xlink:type="simple"/></inline-formula> correctly phased genomic loci; see simulation section).</p>
</sec><sec id="s3a4">
<title>Step 2: Distances and tree reconstruction</title>
<p>Once the alleles have been phased, pairwise evolutionary distances between samples can be computed as the sum of the pairwise distances between both alleles. MEDICC then uses the Fitch-Margoliash algorithm <xref ref-type="bibr" rid="pcbi.1003535-Fitch1">[42]</xref> for tree inference from a distance matrix with or without clock assumption. A test of clock-like events, available using functionality in the accompanying R package <italic>MEDICCquant</italic>, allows us to determine which tree reconstruction algorithm is most appropriate (see the section on quantification of heterogeneity).</p>
</sec><sec id="s3a5">
<title>Step 3: Ancestral reconstruction and branch lengths</title>
<p>From this point on we keep the topology of the tree fixed, and traverse from its leaves to the root to infer ancestral copy-number profiles and branch lengths. Ancestral reconstruction is possible because cancer trees are naturally rooted by the diploid normal from which the disease evolved. Reconstructing ancestral genomes allows us to investigate e.g. the genomic makeup of the cancer precursor, the LCA of all cancer samples in the patient. Events that across patients frequently occur between the root of the tree and the precursor are likely driver events of cancer progression. Ancestral reconstruction also determines the final branch lengths of the tree. MEDICC infers ancestral genomes for each allele independently using a variant of Felsenstein's Pruning algorithm <xref ref-type="bibr" rid="pcbi.1003535-Felsenstein1">[27]</xref>.</p>
<p>In Felsenstein's original algorithm the total score (likelihood/parsimony score) of the tree is computed in a downward pass towards the root and ancestral states are then fixed in a second upward pass, successively choosing the most likely/most parsimonious states. In our scenario, the algorithm begins by composing each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e075" xlink:type="simple"/></inline-formula> terminal nodes with the tree transducer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e076" xlink:type="simple"/></inline-formula>, which yields <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e077" xlink:type="simple"/></inline-formula> acceptors holding all sequences reachable from that terminal node and their respective distances. When moving up the tree to the LCA of the first two terminal nodes the corresponding acceptors are intersected. The resulting acceptor contains only those profiles that were contained in both input acceptors and their corresponding weights are set equal to the sum of the weights of the profiles in the input acceptors. In a probabilistic framework the resulting acceptor is equivalent to the conditional probability distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e078" xlink:type="simple"/></inline-formula><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e079" xlink:type="simple"/></inline-formula> for each possible LCA, where the sum of distances again is replaced by the product of the conditional probabilities of seeing a leaf node given its ancestor. This intersection will still contain the vast majority of all possible profiles, but each with a different total distance, and without those that are prohibited by biological constraints. For example, the ancestor cannot have a copy-number of zero at a position where any of its leaf nodes has copy-number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e080" xlink:type="simple"/></inline-formula>, as amplifications from zero are not allowed. Because after phasing each leaf node is represented by an acceptor containing exactly one diploid sequence, computing this set of possible ancestors is computationally feasible. However, because during tree traversal we need to compose these sets of possible profiles repeatedly with the tree transducer <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e081" xlink:type="simple"/></inline-formula>, the result would increase in size exponentially because it has to account for all possible events of arbitrary length at each position in all sequences. Therefore during tree traversal, when two internal nodes have to be joined in their LCA, MEDICC reduces each of them to a single sequence by choosing those two sequences with smallest distance to each other. This fixes the profiles for those two internal nodes. This procedure is continued until all internal nodes are resolved. Once all ancestral copy-number profiles have been reconstructed the final branch lengths are simply the distances between the nodes defining that branch in the tree.</p>
</sec></sec><sec id="s3b">
<title>MEDICC improves phylogenetic reconstruction accuracy</title>
<p>We assessed reconstruction accuracy using simulated data generated by the <italic>SimCopy</italic> R package <xref ref-type="bibr" rid="pcbi.1003535-Sipos1">[43]</xref> (see <xref ref-type="sec" rid="s5">Methods</xref>). Random coalescent trees were generated with <italic>APE</italic> <xref ref-type="bibr" rid="pcbi.1003535-Paradis1">[44]</xref>. To create an unbiased simulation scenario, genome evolution was simulated using increasing evolutionary rates on the sequence level using five basic genomic rearrangement events: deletion, duplication, inverted duplication, inversion and translocation (for details see <xref ref-type="sec" rid="s5">Methods</xref>). Once the simulations were complete, copy-numbers were counted for each genomic segment and these copy-number profiles were used for tree inference using the following three methods: i) BioNJ <xref ref-type="bibr" rid="pcbi.1003535-Gascuel1">[45]</xref> tree reconstruction on a matrix of Euclidean distances computed directly on the copy-numbers, ii) breakpoint-based tree-inference using the <italic>TuMult</italic> software <xref ref-type="bibr" rid="pcbi.1003535-Letouz1">[23]</xref> and iii) MEDICC. <italic>TuMult</italic> additionally requires array log-intensities as input. In order to keep the comparisons unbiased, noiseless log ratios simulating CGH array intensities for <italic>TuMult</italic> were directly computed from the copy-number profiles. To assess the relative abilities of the methods to correctly recover the evolutionary relationships of the simulated copy-number profiles, reconstruction accuracy was measured in quartet distance <xref ref-type="bibr" rid="pcbi.1003535-Mailund1">[46]</xref> between the true and the reconstructed tree. Quartet distance was chosen as it only considers topological differences; branch lengths have widely different meanings in the methods tested and as such are not comparable.</p>
<p>This simulation strategy is based on basic biological principles, independent of the methods compared and <italic>a priori</italic> does not favour any of them. All simulations were repeated to cover a wide parameter range, yielding qualitatively similar results.</p>
<p>The simulation results clearly show the improvement in reconstruction accuracy of MEDICC over naive approaches (BioNJ on Euclidean distances) and competing methods (TuMult) (<xref ref-type="fig" rid="pcbi-1003535-g004">Figure 4A</xref>). In general, reconstruction accuracies increase with increasing evolutionary rates. Especially when the amount of phylogenetic information is limited, MEDICC outperforms other methods by a significant margin. This may be because of two reasons: firstly, in contrast to other methods MEDICC is capable of phasing the parental alleles, thereby making much more effective use of the phylogenetic information compared to methods that work on total copy-number alone. Secondly, due to efficient and accurate heuristics, MEDICC can deal with the horizontal dependencies imposed by overlapping genomic events of arbitrary size and accurately computes distances between them.</p>
<fig id="pcbi-1003535-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003535.g004</object-id><label>Figure 4</label><caption>
<title>MEDICC improves reconstruction accuracy over competing methods.</title>
<p>A) Simulations results show the improvement of reconstruction accuracy for MEDICC over naive methods (BioNJ clustering on Euclidean distances between copy-number profiles, red) and competing algorithms (TuMult, green). B) Allele phasing accuracy across the simulated trees. On average 92.9% of all genomic loci were correctly assigned to the individual parental alleles. C) Density estimates of clonal expansion indices for neutrally evolving trees (red) and trees with induced long branches as created by clonal expansion processes (blue) show the ability of MEDICC to detect clonal expansion.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003535.g004" position="float" xlink:type="simple"/></fig>
<p>To assess the accuracy of the implemented CFG-based phasing method, for each reconstructed tree phased alleles were compared to the original simulated alleles. MEDICC correctly phased <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e082" xlink:type="simple"/></inline-formula> of all genomic loci across all simulations (<xref ref-type="fig" rid="pcbi-1003535-g004">Figure 4C</xref>). We additionally evaluated the runtime of the complete algorithm on our simulation scenario which consisted of 100 genomic segments after compression and found it to take on average 5 minutes for a full reconstruction on a UNIX based Intel(R) Xeon(R) CPU E5-2670 at 2.60 GHz.</p>
</sec><sec id="s3c">
<title>Evolutionary comparisons with MEDICC allow quantification of tumour heterogeneity</title>
<p>Intra-tumour heterogeneity is a loose concept that describes the amount of genomic difference between multiple cells or samples of the same tumour. Two types of heterogeneity often of interest are <italic>spatial</italic> and <italic>temporal</italic> heterogeneity. For example, spatial differences might be observed from separate biopsies of a primary cancer and a distant metastasis. Other changes may occur between different time points, for example before and after chemotherapy. Average distances between subsets of samples might be computed by any method that returns dissimilarities between samples by simple averaging. However, clinical datasets are often noisy due to normal contamination and immune response such as leukocyte infiltration. As for example a sample with exceptionally low cellularity can lead to errors during segmentation, more robust measures of distances between aggregated subsets of samples are desirable that are not easily skewed by outliers.</p>
<p>As described earlier, the matrix of pairwise minimum-event distances inferred by MEDICC can directly be transformed into a kernel matrix <xref ref-type="bibr" rid="pcbi.1003535-Cortes1">[38]</xref>, <xref ref-type="bibr" rid="pcbi.1003535-Schwarz2">[33]</xref> which maps samples to a high-dimensional mutational landscape. We reduce the dimensionality of this landscape through kernel principal components analysis <xref ref-type="bibr" rid="pcbi.1003535-Schlkopf1">[47]</xref> where we can use spatial statistics to derive numerical measures of heterogeneity for each patient.</p>
<sec id="s3c1">
<title>Temporal heterogeneity</title>
<p>We define temporal heterogeneity as the evolutionary distance between the average genomic profiles between any two time points (e.g. at biopsy before chemotherapy and at surgery after chemotherapy in the case of neo-adjuvant treatment). In the mutational landscape (see above) we are able to directly compute the centre of mass of a set of genomic profiles (which would not be possible by working with distances alone) (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e083" xlink:type="simple"/></inline-formula> in <xref ref-type="fig" rid="pcbi-1003535-g005">Figure 5D</xref>). The center of mass <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e084" xlink:type="simple"/></inline-formula> of a set of points <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e085" xlink:type="simple"/></inline-formula> in feature space is defined as<disp-formula id="pcbi.1003535.e086"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003535.e086" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e087" xlink:type="simple"/></inline-formula> is the feature space mapping of point <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e088" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e089" xlink:type="simple"/></inline-formula> is the number of points. We can then define temporal heterogeneity as the distance between the centres of mass of the samples from two time points. Consider the blue and orange sets in <xref ref-type="fig" rid="pcbi-1003535-g005">Figure 5D</xref>, named <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e090" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e091" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e092" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e093" xlink:type="simple"/></inline-formula> elements respectively. Without loss of generality we can assume our genomic profiles <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e094" xlink:type="simple"/></inline-formula> to be partitioned into the two sets such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e095" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e096" xlink:type="simple"/></inline-formula>. The squared distance between the centers of mass <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e097" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e098" xlink:type="simple"/></inline-formula> of the two sets of genomic profiles in our feature space, is then defined as:<disp-formula id="pcbi.1003535.e099"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003535.e099" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e100" xlink:type="simple"/></inline-formula> again is the kernel or similarity matrix. An advantage of this approach is that it is possible to replace <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e101" xlink:type="simple"/></inline-formula> with other robust measures of the centre of mass (e.g. ignoring the single most distant point). It should be noted that this general approach can be used for determining distances between any partitions of the samples in the dataset, for example between groups of samples taken from different organs as a measure of spatial heterogeneity.</p>
<fig id="pcbi-1003535-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003535.g005</object-id><label>Figure 5</label><caption>
<title>MEDICC quantifies heterogeneity from the locations of genomes on the mutational landscape.</title>
<p>A) If no or a homogeneous selection pressure is applied, cells proliferate and die randomly across the mutational landscape, leaving the surviving cells spatially unclustered. B) If the fitness landscape favours specific mutations (blue shaded areas), genomes inside those areas are more likely to survive, those outside more likely to die. The ability of a tumour for a clonal expansion into distant fitness pockets depends on its mutation potential per generation (long orange arrow). This leads to C) a situation where distinct subpopulations/clonal expansions are present in a tumour, indicating a generally high potential for a tumour to adapt to changing environments. D) The mutational landscape additionally allows estimates of average distance between two subgroups of samples, here before (blue) and after (orange) chemotherapy. The distance between the two subgroups is defined as the distance of the robust centres of mass (blue and orange X). This robust centre of mass is computed omitting the single most distant point of each subgroup (blue and orange samples in the orange and blue subgroups respectively), making the statistic more resistant towards outliers.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003535.g005" position="float" xlink:type="simple"/></fig></sec><sec id="s3c2">
<title>The clonal expansion index</title>
<p>Other complex aspects of heterogeneity that cannot be easily derived from distances alone include the ability of a tumour to undergo clonal expansions <xref ref-type="bibr" rid="pcbi.1003535-Cooke3">[16]</xref>. The model here is that if the majority of cancer cells are subject to strong selection pressure, such as from chemotherapy, minor subclones with a distinctive selective advantage may repopulate. This subpopulation would be expected to coalesce early and will show a greater than expected divergence (relative to neutral evolution) from other remaining clones. This model is similar to analyses of clonality in bacterial populations <xref ref-type="bibr" rid="pcbi.1003535-Smith1">[48]</xref>. Traditional tests for deviation from a neutral coalescent are typically based on single polymorphic sites and often require information about the number of generations <xref ref-type="bibr" rid="pcbi.1003535-Hartl1">[49]</xref>. As such information is not available for clinical cancer studies, we therefore make a spatial argument about clonal expansions. We assume that due to the large population sizes of cancer cells, genetic drift is not significant. In a setting of neutral evolution where all sequences have essentially the same fitness, sequences randomly move across the mutational landscape leading to a uniform distribution of sequences in that space (<xref ref-type="fig" rid="pcbi-1003535-g005">Figure 5A</xref>) with no selective sweeps or clonal expansions. If strong selective pressure favours specific mutations (<xref ref-type="fig" rid="pcbi-1003535-g005">Figure 5B</xref>), sequences are more likely to survive and be sampled from the favoured regions leading to local clustering of sequences on the mutational landscape (<xref ref-type="fig" rid="pcbi-1003535-g005">Figure 5C</xref>).</p>
<p>Besag's <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e102" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003535-Besag1">[50]</xref>, a variance-stabilised transformation of Ripley's <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e103" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003535-Ripley1">[51]</xref>, is a function used in spatial statistics to test for non-homogeneity, i.e. spatial clustering, of points in a plane. <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e104" xlink:type="simple"/></inline-formula> describes the expected number of additional random points within a distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e105" xlink:type="simple"/></inline-formula> of a typical random point of an underlying Poisson point process with intensity <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e106" xlink:type="simple"/></inline-formula>. The empirical estimate of Ripley's <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e107" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e108" xlink:type="simple"/></inline-formula> points with pairwise distances <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e109" xlink:type="simple"/></inline-formula> and average density <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e110" xlink:type="simple"/></inline-formula> is defined as<disp-formula id="pcbi.1003535.e111"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003535.e111" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e112" xlink:type="simple"/></inline-formula> is the indicator function. In case of complete spatial randomness (CSR), the expectation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e113" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e114" xlink:type="simple"/></inline-formula>. Besag's <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e115" xlink:type="simple"/></inline-formula> is defined as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e116" xlink:type="simple"/></inline-formula> and under CSR has expectation linear in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e117" xlink:type="simple"/></inline-formula>. Therefore plotting <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e118" xlink:type="simple"/></inline-formula> can be used as a graphical indication of deviation from CSR. We use a simulation approach to estimate significance bands for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e119" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003535-Baddeley1">[52]</xref>.</p>
<p>The clonal expansion index CE for a dataset (typically samples taken from a single patient) is then defined as the maximum ratio between the distance of the observed L-value (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e120" xlink:type="simple"/></inline-formula>) and the theoretical L-value under CSR (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e121" xlink:type="simple"/></inline-formula>) and one-half the width of the two-sided simulated significance band <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e122" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e123" xlink:type="simple"/></inline-formula> for upper significance band):<disp-formula id="pcbi.1003535.e124"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003535.e124" xlink:type="simple"/><label>(1)</label></disp-formula></p>
<p>A value of CE <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e125" xlink:type="simple"/></inline-formula> therefore suggests CSR in the point set, whereas a CE value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e126" xlink:type="simple"/></inline-formula> indicates local spatial clustering. We conducted coalescence simulations to confirm that the clonal expansion index distinguishes between trees with normal and elongated branch lengths between populations (black and red distributions, <xref ref-type="fig" rid="pcbi-1003535-g004">Figure 4B</xref>).</p>
</sec><sec id="s3c3">
<title>Testing for star topology and molecular clock</title>
<p>Tree reconstruction methods may or may not include assumption of a molecular clock, and this may significantly influence the reconstruction accuracy. It is of particular interest in cancer biology whether evolution is governed by constant or changing rates of evolutionary change. Furthermore, it is still debated whether disease progression follows a (structured) tree-like pattern of evolution or if subpopulations are emitted in radial (star-like) fashion from a small population of stem-like progenitors (see <xref ref-type="bibr" rid="pcbi.1003535-Adams1">[53]</xref>).</p>
<p>We implemented tests for tree-likeness and molecular clock in the <italic>MEDICCquant</italic> package to help answer these questions. We model genomic events <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e127" xlink:type="simple"/></inline-formula> as generated from a Poisson process <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e128" xlink:type="simple"/></inline-formula> with rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e129" xlink:type="simple"/></inline-formula>. The expected number of events is then linear in time: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e130" xlink:type="simple"/></inline-formula>. Assuming <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e131" xlink:type="simple"/></inline-formula>, where the process is not time-calibrated, the observed distance <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e132" xlink:type="simple"/></inline-formula> is the maximum likelihood estimate (MLE) for the time of divergence. Under asymptotic normality of the MLE we have that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e133" xlink:type="simple"/></inline-formula>. Given a star topology we find optimal branch lengths that minimise the residual sum of squares between the optimised pairwise distances <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e134" xlink:type="simple"/></inline-formula> and the measured pairwise distances <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e135" xlink:type="simple"/></inline-formula> for branch <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e136" xlink:type="simple"/></inline-formula>. Under the null hypothesis of star-like evolution this sum of squares<disp-formula id="pcbi.1003535.e137"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003535.e137" xlink:type="simple"/></disp-formula>is then <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e138" xlink:type="simple"/></inline-formula>-distributed with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e139" xlink:type="simple"/></inline-formula> degrees of freedom, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e140" xlink:type="simple"/></inline-formula> is the number of samples studied, i.e. the number of leaves in the tree. The degrees of freedom is derived from the difference between the numbers of freely estimated distances under the alternative hypothesis (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e141" xlink:type="simple"/></inline-formula> pairwise distances among the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e142" xlink:type="simple"/></inline-formula> samples) and the null hypothesis (one for each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e143" xlink:type="simple"/></inline-formula> branches in the star topology).</p>
<p>An analogous procedure can be used for testing whether a tree follows a molecular clock hypothesis, in which it exhibits constant evolutionary rates along all branches. In this case the distances <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e144" xlink:type="simple"/></inline-formula> of all leaf nodes from the diploid should be the same. We measure the deviation of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e145" xlink:type="simple"/></inline-formula> from their mean (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e146" xlink:type="simple"/></inline-formula>) by<disp-formula id="pcbi.1003535.e147"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003535.e147" xlink:type="simple"/></disp-formula></p>
<p>Because branch lengths do not need to be optimised to a specific topology, and we are only considering distances to the diploid, the distribution in this case has <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e148" xlink:type="simple"/></inline-formula> degrees of freedom (the difference between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e149" xlink:type="simple"/></inline-formula> such distances free to vary with no clock, and one distance when there is a molecular clock).</p>
</sec></sec><sec id="s3d">
<title>Progression and heterogeneity in a case of metastatic endometrioid adenocarcinoma</title>
<p>In the following section we demonstrate MEDICC on a case from the CTCR-OV03 clinical study <xref ref-type="bibr" rid="pcbi.1003535-Sala1">[54]</xref>. This case had advanced endometrioid ovarian carcinoma and was treated with platinum-based neoadjuvant chemotherapy. After three cycles of chemotherapy the patient had stable disease based on RECIST assessment, pre- and post-chemotherapy CT imaging and a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e150" xlink:type="simple"/></inline-formula> reduction of the tumour response marker CA125. She then underwent interval debulking surgery but had residual tumour of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e151" xlink:type="simple"/></inline-formula> cm at completion. After six moths she progressed with platinum-resistant disease and died one month later.</p>
<p>Out of 20 biopsy samples 18 satisfied quality control for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e152" xlink:type="simple"/></inline-formula> tumour cellularity and array quality. The dataset included 14 omentum samples, two samples from the vaginal vault (VV) and two samples from the external surface of the bladder (BL). The BL and VV samples were taken prior to chemotherapy and the omental samples were collected at interval-debulking surgery after three cycles of chemotherapy.</p>
<p>All samples were copy-number profiled with Affymetrix SNP 6.0 arrays and segmented and compressed using PICNIC <xref ref-type="bibr" rid="pcbi.1003535-Greenman2">[24]</xref> and CGHregions <xref ref-type="bibr" rid="pcbi.1003535-vandeWiel1">[55]</xref>. Pairwise evolutionary distances between all samples were estimated with MEDICC. The distance distribution was tested for the molecular clock hypothesis using MEDICCquant and showed strong non-clock like behaviour (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e153" xlink:type="simple"/></inline-formula>, <xref ref-type="fig" rid="pcbi-1003535-g006">Figure 6A</xref>). Tree reconstruction was performed by MEDICC using the Fitch-Margoliash algorithm Fitch1967. MEDICCquant detected a high degree of clonal expansion (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e154" xlink:type="simple"/></inline-formula>) as can be seen in the strong spatial clustering of samples on the mutational landscape (<xref ref-type="fig" rid="pcbi-1003535-g006">Figure 6B</xref>). MEDICC counted a median of 204 genomic events relative to the diploid and a median of 146 between all pairwise comparisons. Tree reconstruction showed good support values for the omental and BL/VV subclades, suggesting strong spatial heterogeneity. The patient also showed strong temporal heterogeneity, as there were large evolutionary distances between samples before and after neoadjuvant chemotherapy (temporal heterogeneity index 3.78, <xref ref-type="fig" rid="pcbi-1003535-g006">Figure 6B</xref>). However, temporal and spatial heterogeneity in this case are indistinguishable because the BL/VV samples coincide with the biopsy samples, whereas all omentum samples were taken at surgery.</p>
<fig id="pcbi-1003535-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003535.g006</object-id><label>Figure 6</label><caption>
<title>Application to a case of endometrioid cancer.</title>
<p>A) Evolutionary tree of the OV03-04 case reconstructed from whole genome copy-number profiles. Approximate support values indicate how often each split was observed in trees reconstructed after resampling of the distance matrix with added truncated Gaussian noise. MEDICC performs reconstruction of ancestral copy-number profiles. Here, the (compressed) ancestral profiles for chromosome 17 are given as an example and MEDICC depicts unresolved ambiguities in the form of sequence logos. A star indicates no change compared to its ancestor. B) Ordination of the samples using kPCA shows four clear clonal expansions, comprising three separate Omentum groups and the Bl/VV group. C) Circos plot of selected genomic profiles (marked in bold in the tree) shows the extent of chromosomal aberrations across the genome. The two phased parental alleles are indicated in red and blue.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003535.g006" position="float" xlink:type="simple"/></fig>
<p>Ancestral reconstructions using MEDICC showed loss-of-heterozygosity (LOH) events on chromosome 17q (see internal node profiles in <xref ref-type="fig" rid="pcbi-1003535-g006">Figure 6A</xref>) that often coincide with deleterious mutations in BRCA1 and TP53 <xref ref-type="bibr" rid="pcbi.1003535-Archibald1">[56]</xref>. The most prominent contributors to the clonal expansions of the subgroup surrounding sample S01 seemed to be chromosomal amplifications on chromosomes 6, 8, 11 and 14; as well as LOH on chromosome 15. We also detected large LOH events on chromosomes 4, 5, 9, 10, 13, 14, 16 and 17 (<xref ref-type="fig" rid="pcbi-1003535-g006">Figure 6C</xref>).</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>While significant progress has been made recently to understand tumour heterogeneity through extensive multiple sampling studies and experimental efforts, few algorithms have been developed to target the specific questions raised by such datasets. MEDICC is our contribution to better reconstruct the evolutionary histories of cancer within a patient and propose unbiased quantification of heterogeneity and the degree of clonal expansion.</p>
<p>We have shown the success of these efforts in simulations and their utility in the example discussed in this article. More detailed analyses of clinical cases that also elaborate on the connection between clonal expansions and patient outcome can be found in our clinical study <xref ref-type="bibr" rid="pcbi.1003535-Schwarz1">[28]</xref>.</p>
<p>It is important to note that both the clonal expansion index and the proposed measure for average evolutionary distance between subsets of samples are based solely on pairwise distances and the implicit feature space projection and not on the reconstructed trees. This is advantageous as e.g. for the temporal heterogeneity index the subsets of samples that are compared are not necessarily monophyletic clades in the tree.</p>
<p>As discussed above we attribute the increase in reconstruction accuracy mainly to two factors. First, MEDICC makes efficient use of the available phylogenetic information by phasing parental alleles using the minimum evolution criterion, which has to our knowledge not been attempted before. Second, MEDICC models actual genomic events that change copy-number and incorporates biological constraints such as loss-of heterozygosity, which is not the case in breakpoint-based approaches.</p>
<p>The loss of reconstruction accuracy of <italic>TuMult</italic> relative even to naive approaches using Euclidean distances is most likely due to the fact that <italic>TuMult</italic> was designed for fewer leaf nodes (typically around 4; <italic>Letouze, personal communication</italic>). It is worth stressing that, unlike its competitors, MEDICC is not linked to a specific data collection platform. Data from SNP arrays can be used, as well as sequencing-based datasets or any other method that returns absolute copy numbers. It is further worth noting that an increase in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e155" xlink:type="simple"/></inline-formula>, the maximum allelic copy-number, first of all increases the alphabet size but not the complexity of the algorithms. However, increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e156" xlink:type="simple"/></inline-formula> also increase the number of states in the tree FST <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e157" xlink:type="simple"/></inline-formula> and hence the memory demands on the elementary FST operations <italic>determinisation</italic> and <italic>minimisation</italic> <xref ref-type="bibr" rid="pcbi.1003535-Mohri2">[34]</xref> that are used when constructing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e158" xlink:type="simple"/></inline-formula>. This effectively caps <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e159" xlink:type="simple"/></inline-formula> at a value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e160" xlink:type="simple"/></inline-formula> for the time being.</p>
<p>Future work will focus on reductions of algorithmic complexity as well as the integration of SNV data into the reconstruction process. Another important aspect is subclonality within a physical sample which may not easily lead to integer-based copy number inference. Instead of fully clonal integer CN profiles we are working on an extension that allows for mixtures of cells to be represented effectively, allowing for the computation of expected sequence similarities between mixtures of cancer genomes.</p>
<p>Additionally, it would certainly be desirable to move from the current minimum-evolution approach to a full probabilistic model with specific probabilities for amplification and deletion events. Event probabilities could then be trained by expectation-maximisation. However, this significantly increases the computational complexity of the algorithm, which demands the development of new heuristics that constrain the size of intermediate results of the reconstruction process.</p>
<p>Another consequence of this minimum-evolution approach is that all events are weighted equally, independent of their size, while computing evolutionary distances. During ancestral reconstruction, however, if two possible ancestors would yield the same total number of events in the tree, the algorithm prefers shorter events over longer ones to reduce the ambiguity when determining ancestral genomes. Preferring shorter events is a direct consequence of our minimum evolution approach. However, if two genomes differ by a focal deletion in a key gene that confers a substantial fitness advantage, this fitness-increasing mutation will most likely not be visible when determining the clonal expansion index due to its relative small evolutionary distance to the other genomes. Future work might explore the possibility of weighting individual events based on their genomic position and the potential oncogenes and tumour suppressors contained therein.</p>
<p>Lastly, MEDICC is subject to the same limitations as classical algorithms for phylogenetic reconstructions. Strong convergent evolution, i.e. two genomes becoming similar due to selection even though they diverged early, can in theory mislead the reconstruction process. However, this problem is typically more pronounced for point mutations than for copy-number changes. Two convergent copy-number events that occurred independently must by chance have the same start and end locus on the genome to be considered identical, which is much less likely than two point mutations occurring by chance at the same genomic position, due to the far greater number of possible outcomes of each event.</p>
</sec><sec id="s5" sec-type="methods">
<title>Methods</title>
<p>SNP array data for the example from the OV03/04 study can be accessed at the NCBI Gene Expression Omnibus under accession number <italic>GSE40546</italic>.</p>
<sec id="s5a">
<title>Simulation of tumour evolution</title>
<p>Coalescent trees were simulated using the <italic>APE</italic> R package <xref ref-type="bibr" rid="pcbi.1003535-Paradis1">[44]</xref>. Simulation of genome evolution on these trees was performed by custom code, released as the <italic>SimCopy</italic> R package <xref ref-type="bibr" rid="pcbi.1003535-Sipos1">[43]</xref>. <italic>SimCopy</italic> relies on the <italic>PhyloSim</italic> package <xref ref-type="bibr" rid="pcbi.1003535-Sipos2">[57]</xref> in order to perform the simulations on the level of abstract “genomic regions”. The genomic regions are encoded in a sequence of integers, with the sign representing their orientation. The package then uses modified <italic>PhyloSim</italic> processes in order to simulate deletion, duplication, inversion, inverted duplication and translocation events happening with rates specified by the user. The number of genomic regions affected by each of these events is modelled by truncated Geometric+1 distributions. After simulating genome evolution, copy-number profiles are reported for leaf and internal nodes. Genomes were simulated using 15 leaf nodes, a root size of 100 segments and an average event length of 12 segments to allow for overlapping events. Event rates covered the following set: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e161" xlink:type="simple"/></inline-formula> Individual event rates were modified with the following factors: deletions: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e162" xlink:type="simple"/></inline-formula>, duplications: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e163" xlink:type="simple"/></inline-formula>, inverted duplications: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e164" xlink:type="simple"/></inline-formula>, inversions: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e165" xlink:type="simple"/></inline-formula>, translocations: <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003535.e166" xlink:type="simple"/></inline-formula>. All parameters were chosen such that the leaf node copy-number distributions are similar in shape to copy-number distributions from experimental data in the clinical study <xref ref-type="bibr" rid="pcbi.1003535-Schwarz1">[28]</xref>.</p>
</sec><sec id="s5b">
<title>Implementation of MEDICC</title>
<p>All FST and FSA algorithms were implemented using OpenFST <xref ref-type="bibr" rid="pcbi.1003535-Allauzen1">[40]</xref>. MEDICC was written in Python, while implementation of time-critical parts used C. For the Fitch-Margoliash implementations we used the Phylip package <xref ref-type="bibr" rid="pcbi.1003535-Felsenstein3">[58]</xref>. MEDICC is available at <ext-link ext-link-type="uri" xlink:href="https://bitbucket.org/rfs/medicc" xlink:type="simple">https://bitbucket.org/rfs/medicc</ext-link> and has been tested on Windows and UNIX-based systems.</p>
<p>The quantitative analysis of MEDICC results was done in R and all necessary functions are implemented in the <italic>MEDICCquant</italic> package included in the MEDICC distribution. Spatial statistics were computed using the <italic>spatstat</italic> package <xref ref-type="bibr" rid="pcbi.1003535-Baddeley1">[52]</xref>, and for kernel manipulations the <italic>kernlab</italic> package was used <xref ref-type="bibr" rid="pcbi.1003535-Karatzoglou1">[59]</xref>.</p>
</sec></sec></body>
<back>
<ack>
<p>The authors would like to thank Gonzalo Iglesias and Adria de Gispert from the Cambridge University Engineering Department for input on the FST implementations.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003535-Khalique1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khalique</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ayhan</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Weale</surname><given-names>ME</given-names></name>, <name name-style="western"><surname>Jacobs</surname><given-names>IJ</given-names></name>, <name name-style="western"><surname>Ramus</surname><given-names>SJ</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Genetic intra-tumour heterogeneity in epithelial ovarian cancer and its implications for molecular diagnosis of tumours</article-title>. <source>J Pathol</source> <volume>211</volume>: <fpage>286</fpage>–<lpage>295</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Khalique2"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Khalique</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ayhan</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Whittaker</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Singh</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Jacobs</surname><given-names>IJ</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>The clonal evolution of metastases from primary serous epithelial ovarian cancers</article-title>. <source>Int J Cancer</source> <volume>124</volume>: <fpage>1579</fpage>–<lpage>1586</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Cooke1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cooke</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Ng</surname><given-names>CKY</given-names></name>, <name name-style="western"><surname>Melnyk</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Garcia</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Hardcastle</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Genomic analysis of genetic heterogeneity and evolution in high-grade serous ovarian carcinoma</article-title>. <source>Oncogene</source> <volume>29</volume>: <fpage>4905</fpage>–<lpage>4913</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Navin1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Krasnitz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Rodgers</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Cook</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Meth</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Inferring tumor progression from genomic heterogeneity</article-title>. <source>Genome Res</source> <volume>20</volume>: <fpage>68</fpage>–<lpage>80</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Shah1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shah</surname><given-names>SP</given-names></name>, <name name-style="western"><surname>Morin</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Khattra</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Prentice</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Pugh</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Mutational evolution in a lobular breast tumour profiled at single nucleotide resolution</article-title>. <source>Nature</source> <volume>461</volume>: <fpage>809</fpage>–<lpage>813</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Campbell1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Campbell</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Yachida</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Mudie</surname><given-names>LJ</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Pleasance</surname><given-names>ED</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The patterns and dynamics of genomic instability in metastatic pancreatic cancer</article-title>. <source>Nature</source> <volume>467</volume>: <fpage>1109</fpage>–<lpage>1113</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Marusyk1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marusyk</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Almendro</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Polyak</surname><given-names>K</given-names></name> (<year>2012</year>) <article-title>Intra-tumour heterogeneity: a looking glass for cancer</article-title>? <source>Nat Rev Cancer</source> <volume>12</volume>: <fpage>323</fpage>–<lpage>334</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Navin2"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Kendall</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Troge</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Andrews</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Rodgers</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Tumour evolution inferred by single-cell sequencing</article-title>. <source>Nature</source> <volume>472</volume>: <fpage>90</fpage>–<lpage>94</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Vermaat1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vermaat</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Nijman</surname><given-names>IJ</given-names></name>, <name name-style="western"><surname>Koudijs</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Gerritse</surname><given-names>FL</given-names></name>, <name name-style="western"><surname>Scherer</surname><given-names>SJ</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Primary colorectal cancers and their subsequent hepatic metastases are genetically different: implications for selection of patients for targeted treatment</article-title>. <source>Clin Cancer Res</source> <volume>18</volume>: <fpage>688</fpage>–<lpage>699</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Wu1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Northcott</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Dubuc</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Dupuy</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Shih</surname><given-names>DJH</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Clonal selection drives genetic divergence of metastatic medulloblastoma</article-title>. <source>Nature</source> <volume>482</volume>: <fpage>529</fpage>–<lpage>533</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-NikZainal1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nik-Zainal</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Van Loo</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Wedge</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Alexandrov</surname><given-names>LB</given-names></name>, <name name-style="western"><surname>Greenman</surname><given-names>CD</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The life history of 21 breast cancers</article-title>. <source>Cell</source> <volume>149</volume>: <fpage>994</fpage>–<lpage>1007</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Gerlinger1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerlinger</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rowan</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Horswell</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Larkin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Endesfelder</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Intratumor heterogeneity and branched evolution revealed by multiregion sequencing</article-title>. <source>N Engl J Med</source> <volume>366</volume>: <fpage>883</fpage>–<lpage>892</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Cooke2"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cooke</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Temple</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Macarthur</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Zahra</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Tan</surname><given-names>LT</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Intra-tumour genetic heterogeneity and poor chemoradiotherapy response in cervical cancer</article-title>. <source>Br J Cancer</source> <volume>104</volume>: <fpage>361</fpage>–<lpage>368</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Maley1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maley</surname><given-names>CC</given-names></name>, <name name-style="western"><surname>Galipeau</surname><given-names>PC</given-names></name>, <name name-style="western"><surname>Finley</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Wongsurawat</surname><given-names>VJ</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>X</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Genetic clonal diversity predicts progression to esophageal adenocarcinoma</article-title>. <source>Nat Genet</source> <volume>38</volume>: <fpage>468</fpage>–<lpage>473</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Park1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Park</surname><given-names>SY</given-names></name>, <name name-style="western"><surname>Gönen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>HJ</given-names></name>, <name name-style="western"><surname>Michor</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Polyak</surname><given-names>K</given-names></name> (<year>2010</year>) <article-title>Cellular and genetic diversity in the progression of in situ human breast carcinomas to an invasive phenotype</article-title>. <source>J Clin Invest</source> <volume>120</volume>: <fpage>636</fpage>–<lpage>644</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Cooke3"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cooke</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Brenton</surname><given-names>JD</given-names></name> (<year>2011</year>) <article-title>Evolution of platinum resistance in high-grade serous ovarian cancer</article-title>. <source>Lancet Oncol</source> <volume>12</volume> (<issue>12</issue>) <fpage>1169</fpage>–<lpage>74</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Ding1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ding</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ellis</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Larson</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Genome remodelling in a basal-like breast cancer metastasis and xenograft</article-title>. <source>Nature</source> <volume>464</volume>: <fpage>999</fpage>–<lpage>1005</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Ding2"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ding</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ley</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Larson</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Koboldt</surname><given-names>DC</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing</article-title>. <source>Nature</source> <volume>481</volume>: <fpage>506</fpage>–<lpage>510</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Cowin1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cowin</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>George</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Fereday</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Loehrer</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Van Loo</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>LRP1B Deletion in High-Grade Serous Ovarian Cancers Is Associated with Acquired Chemotherapy Resistance to Liposomal Doxorubicin</article-title>. <source>Cancer Res</source> <volume>72</volume>: <fpage>4060</fpage>–<lpage>4073</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Network1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><collab xlink:type="simple">Network TCGAR</collab> (<year>2011</year>) <article-title>Integrated genomic analyses of ovarian carcinoma</article-title>. <source>Nature</source> <volume>474</volume>: <fpage>609</fpage>–<lpage>615</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Ng1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ng</surname><given-names>CKY</given-names></name>, <name name-style="western"><surname>Cooke</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Howe</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Xian</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The role of tandem duplicator phenotype in tumour evolution in high-grade serous ovarian cancer</article-title>. <source>J Pathol</source> <volume>226</volume>: <fpage>703</fpage>–<lpage>712</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Greenman1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greenman</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Pleasance</surname><given-names>ED</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Fu</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Estimation of rearrangement phylogeny for cancer genomes</article-title>. <source>Genome Res</source> <volume>22</volume>: <fpage>346</fpage>–<lpage>361</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Letouz1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Letouzé</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Allory</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Bollet</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Radvanyi</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Guyon</surname><given-names>F</given-names></name> (<year>2010</year>) <article-title>Analysis of the copy number profiles of several tumor samples from the same patient reveals the successive steps in tumorigenesis</article-title>. <source>Genome Biol</source> <volume>11</volume>: <fpage>R76</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Greenman2"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Greenman</surname><given-names>CD</given-names></name>, <name name-style="western"><surname>Bignell</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Butler</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Edkins</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hinton</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>PICNIC: an algorithm to predict absolute allelic copy number variation with microarray cancer data</article-title>. <source>Biostatistics</source> <volume>11</volume>: <fpage>164</fpage>–<lpage>175</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Korbel1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Korbel</surname><given-names>JO</given-names></name>, <name name-style="western"><surname>Urban</surname><given-names>AE</given-names></name>, <name name-style="western"><surname>Affourtit</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Godwin</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Grubert</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Paired-end mapping reveals extensive structural variation in the human genome</article-title>. <source>Science</source> <volume>318</volume>: <fpage>420</fpage>–<lpage>426</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Yoon1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yoon</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Xuan</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Makarov</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Ye</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Sebat</surname><given-names>J</given-names></name> (<year>2009</year>) <article-title>Sensitive and accurate detection of copy number variants using read depth of coverage</article-title>. <source>Genome Res</source> <volume>19</volume>: <fpage>1586</fpage>–<lpage>1592</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Felsenstein1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>2003</year>) <article-title>Inferring phylogenies</article-title>. <source>Sinauer Associates</source></mixed-citation>
</ref>
<ref id="pcbi.1003535-Schwarz1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwarz</surname><given-names>RF</given-names></name>, <name name-style="western"><surname>Ng</surname><given-names>CK</given-names></name>, <name name-style="western"><surname>Coooke</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Newman</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Temple</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Phylogenetic quantification of intra-tumor heterogeneity predicts time to relapse in high-grade serous ovarian cancer</article-title>. <source>PLoS Medicine</source> (in revision) -: -.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Levenshtein1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Levenshtein</surname><given-names>V</given-names></name> (<year>1966</year>) <article-title>Binary codes capable of correcting deletions, insertions, and reversals</article-title>. <source>Soviet Physics - Doklady</source> <volume>10</volume>: <fpage>707</fpage>–<lpage>710</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Mohri1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mohri</surname><given-names>M</given-names></name> (<year>2003</year>) <article-title>Edit-Distance of Weighted Automata: General Definitions and Algorithms</article-title>. <source>IJFCS</source> <volume>14</volume> (<issue>6</issue>) <fpage>957</fpage>–<lpage>982</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Bradley1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bradley</surname><given-names>RK</given-names></name>, <name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name> (<year>2007</year>) <article-title>Transducers: an emerging probabilistic framework for modeling indels on trees</article-title>. <source>Bioinformatics</source> <volume>23</volume>: <fpage>3258</fpage>–<lpage>3262</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Westesson1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Westesson</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Lunter</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Paten</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Holmes</surname><given-names>I</given-names></name> (<year>2012</year>) <article-title>Accurate reconstruction of insertion-deletion histories by statistical phylogenetics</article-title>. <source>PLoS One</source> <volume>7</volume>: <fpage>e34572</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Schwarz2"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwarz</surname><given-names>RF</given-names></name>, <name name-style="western"><surname>Fletcher</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Förster</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Merget</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Wolf</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Evolutionary distances in the twilight zone–a rational kernel approach</article-title>. <source>PLoS One</source> <volume>5</volume>: <fpage>e15788</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Mohri2"><label>34</label>
<mixed-citation publication-type="book" xlink:type="simple">Mohri M (2004) Weighted Finite-State Transducer Algorithms An Overview, Physica-Verlag.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Droste1"><label>35</label>
<mixed-citation publication-type="other" xlink:type="simple">Droste M, Kuich W, Vogler H, editors (2009) Handbook of Weighted Automata, Springer, chapter Weighted Automata Algorithms. pp. 1–45.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Durbin1"><label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">Durbin R, Eddy S, Krogh A, Mitchison G (1998) Biological Sequence Analysis. Cambridge University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Felsenstein2"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Felsenstein</surname><given-names>J</given-names></name> (<year>1981</year>) <article-title>Evolutionary trees from DNA sequences: a maximum likelihood approach</article-title>. <source>J Mol Evol</source> <volume>17</volume>: <fpage>368</fpage>–<lpage>376</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Cortes1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cortes</surname><given-names>Corinna</given-names></name>, <name name-style="western"><surname>Haffner</surname><given-names>Patrick</given-names></name>, <name name-style="western"><surname>Mohri</surname><given-names>Mehryar</given-names></name> (<year>2004</year>) <article-title>Rational Kernels: Theory and Algorithms</article-title>. <source>JMLR</source> <volume>1</volume>: <fpage>1</fpage>–<lpage>50</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-ShaweTaylor1"><label>39</label>
<mixed-citation publication-type="book" xlink:type="simple">Shawe-Taylor J, Cristianini N (2004) Kernel Methods for Pattern Analysis. Cambridge University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Allauzen1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Allauzen</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Riley</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Schalkwyk</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Skut</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Mohri</surname><given-names>M</given-names></name> (<year>2007</year>) <article-title>OpenFst: A General and E_cient Weighted Finite-State Transducer Library</article-title>. <source>Proceedings of the Ninth International Conference on Implementation and Application of Automata, (CIAA), in Lecture Notes in Computer Science</source> <volume>4783</volume>: <fpage>11</fpage>–<lpage>23</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Allauzen2"><label>41</label>
<mixed-citation publication-type="book" xlink:type="simple">Allauzen C, Riley M (2012) A Pushdown Transducer Extension for the OpenFst Library. In: Moreira N, Reis R, editors, CIAA. Springer, volume 7381 of Lecture Notes in Computer Science, pp. 66–77. URL <ext-link ext-link-type="uri" xlink:href="http://dblp.uni-trier.de/db/conf/wia/ciaa2012.html#AllauzenR12" xlink:type="simple">http://dblp.uni-trier.de/db/conf/wia/ciaa2012.html#AllauzenR12</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Fitch1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fitch</surname><given-names>WM</given-names></name>, <name name-style="western"><surname>Margoliash</surname><given-names>E</given-names></name> (<year>1967</year>) <article-title>Construction of phylogenetic trees</article-title>. <source>Science</source> <volume>155</volume>: <fpage>279</fpage>–<lpage>284</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Sipos1"><label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Sipos B (2013). SimCopy - a R package simulating the evolution of copy number profiles along a tree. URL <ext-link ext-link-type="uri" xlink:href="https://github.com/sbotond/simcopy" xlink:type="simple">https://github.com/sbotond/simcopy</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Paradis1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Paradis</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Claude</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Strimmer</surname><given-names>K</given-names></name> (<year>2004</year>) <article-title>APE: Analyses of Phylogenetics and Evolution in R language</article-title>. <source>Bioinformatics</source> <volume>20</volume>: <fpage>289</fpage>–<lpage>290</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Gascuel1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gascuel</surname><given-names>O</given-names></name> (<year>1997</year>) <article-title>BIONJ: an improved version of the NJ algorithm based on a simple model of sequence data</article-title>. <source>Mol Biol Evol</source> <volume>14</volume>: <fpage>685</fpage>–<lpage>695</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Mailund1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mailund</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Pedersen</surname><given-names>CNS</given-names></name> (<year>2004</year>) <article-title>QDist–quartet distance between evolutionary trees</article-title>. <source>Bioinformatics</source> <volume>20</volume>: <fpage>1636</fpage>–<lpage>1637</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Schlkopf1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schölkopf</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Smola</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Müller</surname><given-names>KR</given-names></name> (<year>1998</year>) <article-title>Nonlinear Component Analysis as a Kernel Eigenvalue Problem</article-title>. <source>Neural Computation</source> <volume>10</volume>: <fpage>1299</fpage>–<lpage>1319</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Smith1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>NH</given-names></name>, <name name-style="western"><surname>O'Rourke</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Spratt</surname><given-names>BG</given-names></name> (<year>1993</year>) <article-title>How clonal are bacteria</article-title>? <source>Proceedings of the National Academy of Sciences</source> <volume>90</volume>: <fpage>4384</fpage>–<lpage>4388</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Hartl1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hartl</surname><given-names>DL</given-names></name>, <name name-style="western"><surname>Clark</surname><given-names>AG</given-names></name> (<year>2007</year>) <article-title>Principles of Population Genetics</article-title>. <source>Sinauer Associates</source></mixed-citation>
</ref>
<ref id="pcbi.1003535-Besag1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Besag</surname><given-names>J</given-names></name> (<year>1977</year>) <article-title>Contribution to the discussion of Dr Ripley's paper</article-title>. <source>Journal of the Royal Statistical Society Series B</source> <volume>39</volume>: <fpage>193</fpage>–<lpage>195</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Ripley1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ripley</surname><given-names>B</given-names></name> (<year>1977</year>) <article-title>Modelling spatial patterns (with discussion)</article-title>. <source>Journal of the Royal Statistical Society Series B</source> <volume>39</volume>: <fpage>172</fpage>–<lpage>212</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Baddeley1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Baddeley</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Turner</surname><given-names>R</given-names></name> (<year>2005</year>) <article-title>Spatstat: an R package for analyzing spatial point patterns</article-title>. <source>Journal of Statistical Software</source> <volume>12</volume>: <fpage>1</fpage>–<lpage>42</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Adams1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adams</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Strasser</surname><given-names>A</given-names></name> (<year>2008</year>) <article-title>Is tumor growth sustained by rare cancer stem cells or dominant clones</article-title>? <source>Cancer Res</source> <volume>68</volume>: <fpage>4018</fpage>–<lpage>4021</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Sala1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sala</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Kataoka</surname><given-names>MY</given-names></name>, <name name-style="western"><surname>Priest</surname><given-names>AN</given-names></name>, <name name-style="western"><surname>Gill</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>McLean</surname><given-names>MA</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Advanced ovarian cancer: multiparametric MR imaging demonstrates response- and metastasis-specific effects</article-title>. <source>Radiology</source> <volume>263</volume>: <fpage>149</fpage>–<lpage>59</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-vandeWiel1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>van de Wiel</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>van Wieringen</surname><given-names>WN</given-names></name> (<year>2007</year>) <article-title>CGHregions: dimension reduction for array CGH data with minimal information loss</article-title>. <source>Cancer Inform</source> <volume>3</volume>: <fpage>55</fpage>–<lpage>63</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Archibald1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Archibald</surname><given-names>KM</given-names></name>, <name name-style="western"><surname>Kulbe</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Kwong</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Chakravarty</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Temple</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Sequential genetic change at the TP53 and chemokine receptor CXCR4 locus during transformation of human ovarian surface epithelium</article-title>. <source>Oncogene</source> <volume>31</volume>: <fpage>4987</fpage>–<lpage>4995</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Sipos2"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sipos</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Massingham</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Jordan</surname><given-names>GE</given-names></name>, <name name-style="western"><surname>Goldman</surname><given-names>N</given-names></name> (<year>2011</year>) <article-title>PhyloSim - Monte Carlo simulation of sequence evolution in the R statistical computing environment</article-title>. <source>BMC Bioinformatics</source> <volume>12</volume>: <fpage>104</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Felsenstein3"><label>58</label>
<mixed-citation publication-type="book" xlink:type="simple">Felsenstein J (2009). PHYLIP (Phylogeny Inference Package) version 3.6. Distributed by the author. Department of Genome Sciences, University of Washington, Seattle.</mixed-citation>
</ref>
<ref id="pcbi.1003535-Karatzoglou1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Karatzoglou</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Smola</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Hornik</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Zeileis</surname><given-names>A</given-names></name> (<year>2004</year>) <article-title>kernlab – An S4 Package for Kernel Methods in R</article-title>. <source>Journal of Statistical Software</source> <volume>11</volume>: <fpage>1</fpage>–<lpage>20</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>