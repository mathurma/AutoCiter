<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-00748</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006134</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Forecasting</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Viral diseases</subject><subj-group><subject>Influenza</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Earth sciences</subject><subj-group><subject>Seasons</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Epidemiology</subject><subj-group><subject>Disease surveillance</subject><subj-group><subject>Infectious disease surveillance</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Infectious diseases</subject><subj-group><subject>Infectious disease control</subject><subj-group><subject>Infectious disease surveillance</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Materials science</subject><subj-group><subject>Material properties</subject><subj-group><subject>Density</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Materials science</subject><subj-group><subject>Materials physics</subject><subj-group><subject>Density</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Materials physics</subject><subj-group><subject>Density</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kernel methods</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject><subj-group><subject>Kernel methods</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Information technology</subject><subj-group><subject>Data processing</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Nonmechanistic forecasts of seasonal influenza with iterative one-week-ahead distributions</article-title>
<alt-title alt-title-type="running-head">Nonmechanistic forecasts of seasonal influenza with iterative one-week-ahead distributions</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0877-4978</contrib-id>
<name name-style="western">
<surname>Brooks</surname> <given-names>Logan C.</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Farrow</surname> <given-names>David C.</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0377-897X</contrib-id>
<name name-style="western">
<surname>Hyun</surname> <given-names>Sangwon</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-2158-8304</contrib-id>
<name name-style="western">
<surname>Tibshirani</surname> <given-names>Ryan J.</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-3274-5862</contrib-id>
<name name-style="western">
<surname>Rosenfeld</surname> <given-names>Roni</given-names></name>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>School of Computer Science, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Statistics, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Viboud</surname> <given-names>Cecile</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>National Institutes of Health, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">lcbrooks@cs.cmu.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>6</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>15</day>
<month>6</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>6</issue>
<elocation-id>e1006134</elocation-id>
<history>
<date date-type="received">
<day>12</day>
<month>5</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>10</day>
<month>4</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Brooks et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006134"/>
<abstract>
<p>Accurate and reliable forecasts of seasonal epidemics of infectious disease can assist in the design of countermeasures and increase public awareness and preparedness. This article describes two main contributions we made recently toward this goal: a novel approach to probabilistic modeling of surveillance time series based on “delta densities”, and an optimization scheme for combining output from multiple forecasting methods into an adaptively weighted ensemble. Delta densities describe the probability distribution of the change between one observation and the next, conditioned on available data; chaining together nonparametric estimates of these distributions yields a model for an entire trajectory. Corresponding distributional forecasts cover more observed events than alternatives that treat the whole season as a unit, and improve upon multiple evaluation metrics when extracting key targets of interest to public health officials. Adaptively weighted ensembles integrate the results of multiple forecasting methods, such as delta density, using weights that can change from situation to situation. We treat selection of optimal weightings across forecasting methods as a separate estimation task, and describe an estimation procedure based on optimizing cross-validation performance. We consider some details of the data generation process, including data revisions and holiday effects, both in the construction of these forecasting methods and when performing retrospective evaluation. The delta density method and an adaptively weighted ensemble of other forecasting methods each improve significantly on the next best ensemble component when applied separately, and achieve even better cross-validated performance when used in conjunction. We submitted real-time forecasts based on these contributions as part of CDC’s 2015/2016 FluSight Collaborative Comparison. Among the fourteen submissions that season, this system was ranked by CDC as the most accurate.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Seasonal influenza is associated with 250 000 to 500 000 deaths worldwide each year (WHO estimates). In the United States and other temperate regions, seasonal influenza epidemics occur annually, but their timing and intensity varies significantly; accurate and reliable forecasts that quantify their uncertainty can assist policymakers when planning countermeasures such as vaccination campaigns, and increase awareness and preparedness of hospitals and the general public. Starting with the 2013/2014 flu season, CDC has solicited, collected, evaluated, and compared weekly forecasts from external research groups. We developed a new method for forecasting flu surveillance data, which stitches together models of changes that happen each week, and a way of combining its output with other forecasts. The resulting forecasting system produced the most accurate forecasts in CDC’s 2015/2016 FluSight comparison of fourteen forecasting systems. We describe our new forecasting methods, analyze their performance in the 2015/2016 comparison and on data from previous seasons, and describe idiosyncrasies of epidemiological data that should be considered when constructing and evaluating forecasting systems.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
<institution>National Institute of General Medical Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>U54 GM088491</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0877-4978</contrib-id>
<name name-style="western">
<surname>Brooks</surname> <given-names>Logan C.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000057</institution-id>
<institution>National Institute of General Medical Sciences</institution>
</institution-wrap>
</funding-source>
<award-id>U54 GM088491</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Farrow</surname> <given-names>David C.</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>DGE-1252522</award-id>
<principal-award-recipient>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-0877-4978</contrib-id>
<name name-style="western">
<surname>Brooks</surname> <given-names>Logan C.</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>LCB, DCF, and RR were supported by the National Institute Of General Medical Sciences of the National Institutes of Health under Award Number U54 GM088491. The content is solely the responsibility of the authors and does not necessarily represent the official views of the National Institutes of Health. This material is based upon work supported by the National Science Foundation Graduate Research Fellowship Program under Grant Nos. 0946825, DGE-1252522, and DGE-1745016. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the authors and do not necessarily reflect the views of the National Science Foundation. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="0"/>
<page-count count="29"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-07-06</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>The latest ILINet report is available from a Fluview Interactive web module (<ext-link ext-link-type="uri" xlink:href="https://gis.cdc.gov/grasp/fluview/fluportaldashboard.html" xlink:type="simple">https://gis.cdc.gov/grasp/fluview/fluportaldashboard.html</ext-link>). Past ILINet reports (in addition to the latest one) are available from our delphi-epidata API (<ext-link ext-link-type="uri" xlink:href="https://github.com/cmu-delphi/delphi-epidata" xlink:type="simple">https://github.com/cmu-delphi/delphi-epidata</ext-link>). (Past and current Delphi-Stat, Delphi-Epicast, and Delphi-Archefilter forecasts, as well as ILI-Nearby nowcasts, are also available from our delphi-epidata API (<ext-link ext-link-type="uri" xlink:href="https://github.com/cmu-delphi/delphi-epidata" xlink:type="simple">https://github.com/cmu-delphi/delphi-epidata</ext-link>).)</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Seasonal influenza epidemics cause widespread illness which is associated each year with an estimated 250 000 to 500 000 deaths worldwide [<xref ref-type="bibr" rid="pcbi.1006134.ref001">1</xref>] and 3000 to 56 000 deaths in the United States alone [<xref ref-type="bibr" rid="pcbi.1006134.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1006134.ref004">4</xref>]. In contrast to influenza “pandemics”, which are rare global outbreaks of especially novel influenza A viruses [<xref ref-type="bibr" rid="pcbi.1006134.ref005">5</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref006">6</xref>], seasonal epidemics (i.e., non-pandemics), while still having worldwide reach, occur annually in the United States and other countries with (generally) temperate climates. Time series of influenza prevalence in these areas are typically low and flat for the majority of the season, but trace a single, sharp peak sometime during winter, with significant variability in timing and intensity. Accurate and reliable forecasts of seasonal epidemics can help policymakers plan countermeasures such as vaccination campaigns, and increase awareness and preparedness of hospitals and the general public. The Centers for Disease Control and Prevention (CDC) monitors influenza prevalence with several well-established surveillance systems [<xref ref-type="bibr" rid="pcbi.1006134.ref007">7</xref>]; the recurring nature of seasonal epidemics and availability of historical data provide promising opportunities for the formation, evaluation, and application of statistical models. Starting with the 2013/2014 “Predict the Influenza Season Challenge” [<xref ref-type="bibr" rid="pcbi.1006134.ref008">8</xref>] and continuing each season thereafter as the Epidemic Prediction Initiative’s FluSight project [<xref ref-type="bibr" rid="pcbi.1006134.ref009">9</xref>], CDC has solicited and compiled forecasts of influenza-like illness (ILI) prevalence from external research groups and worked with them to develop standardized forecast formats and quantitative evaluation metrics.</p>
<p>Various approaches to influenza epidemic forecasting are summarized in literature reviews [<xref ref-type="bibr" rid="pcbi.1006134.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006134.ref012">12</xref>] and descriptions of the CDC comparisons [<xref ref-type="bibr" rid="pcbi.1006134.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref009">9</xref>]. Some common approaches are described below, with references to work applicable to the current FluSight project and related seasonal dengue forecasting tasks, emphasizing more recent work that may not be listed in the above three literature reviews:</p>
<list list-type="bullet">
<list-item>
<p><bold>Mechanistic models</bold>: describe the disease state and interaction between individuals with causal models, as well as the surveillance data generation process.
<list list-type="bullet"><list-item><p><bold>Compartmental models</bold> (e.g., [<xref ref-type="bibr" rid="pcbi.1006134.ref013">13</xref>–<xref ref-type="bibr" rid="pcbi.1006134.ref017">17</xref>]): break down the population into a number of discrete “compartments” describing their characteristics (e.g., age, location) and state (e.g., susceptible to, infectious with, or recovered from a particular disease), and describe how the occupancy of these compartments changes over time, either deterministically or probabilistically. In many of these models, this division describes solely the state with respect to a single disease, ignoring details regarding age, spatial dynamics, and mixtures of ILI diseases, but keeping the number of parameters to infer low.</p></list-item> <list-item><p><bold>Agent-based models</bold> (e.g., [<xref ref-type="bibr" rid="pcbi.1006134.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref018">18</xref>]): also known as individual-based models, these approaches use more detailed descriptions of disease state and/or individual characteristics and behavior, which are not easily simplified into a compartmental form, typically studied using computation-heavy simulations. These approaches usually include many more parameters than compartmental models, which may be set or inferred by heuristics, additional data sources and studies, or Monte Carlo procedures.</p></list-item></list></p>
</list-item>
<list-item>
<p><bold>Phenomenological models</bold>: also referred to as statistical models, these approaches describe the surveillance data without directly incorporating the epidemiological underpinnings.
<list list-type="bullet"><list-item><p><bold>Direct regression models</bold> (e.g., [<xref ref-type="bibr" rid="pcbi.1006134.ref019">19</xref>–<xref ref-type="bibr" rid="pcbi.1006134.ref022">22</xref>]): attempt to estimate future prevalence or targets of interest using various types of regression, including nonparametric statistical approaches and alternatives from machine learning literature.</p></list-item> <list-item><p><bold>Time series models</bold> (e.g., [<xref ref-type="bibr" rid="pcbi.1006134.ref023">23</xref>–<xref ref-type="bibr" rid="pcbi.1006134.ref031">31</xref>]): represent the expected value of (transformations of) observations and/or underlying latent state at a particular time as (typically linear) functions of these quantities at previous times and additional covariates, paired with Gaussian, Poisson, negative binomial, or other noise distributions. This category includes linear dynamical systems and frameworks such as SARIMAX.</p></list-item></list></p>
</list-item>
</list>
<p>We present a novel phenomenological approach to epidemiological forecasting using “delta densities”, which assumes an autoregressive dependency structure similar to those of some time series models, but uses a kernel density estimation approach to model these dependencies rather than the common choice of linear relationships plus Gaussian noise. This technique is similar to the method of analogues [<xref ref-type="bibr" rid="pcbi.1006134.ref019">19</xref>] in that it uses an instance-based, nonparametric estimation procedure, but provides distributional forecasts of entire trajectories rather than point predictions of individual observations. The kernel conditional density estimation (KCDE) forecasting method [<xref ref-type="bibr" rid="pcbi.1006134.ref022">22</xref>] attacks many of the same issues encountered when applying kernel density estimation methods to seasonal epidemic data, but models the dependency structure of future weeks with a copula, while delta density chains together 1-week-ahead simulations. Compared to approaches that treat the entire season as a unit, such as deterministic, single-strain, fully-mixed compartmental models [<xref ref-type="bibr" rid="pcbi.1006134.ref013">13</xref>] or our previous empirical Bayes approach based on modifying past seasons’ data [<xref ref-type="bibr" rid="pcbi.1006134.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref032">32</xref>], this method forms a larger library of possible trajectories by piecing together local models, which appears to help forecast performance, even though the trajectories considered may seem less reasonable on average.</p>
<p>Our second contribution is an adaptively weighted ensemble approach to combining the output of different forecasting methods given their historical and/or cross-validation forecasts. We first implemented this method in preparation for the 2014/2015 FluSight comparison, mixing together our empirical Bayes forecasting method with two baselines (a uniform distribution and an empirical distribution for each target), and later applied it while participating in the Dengue Forecasting project [<xref ref-type="bibr" rid="pcbi.1006134.ref033">33</xref>] and following FluSight comparisons (adding up to 9 additional components including delta density based methods), and found it improved our forecasts in all cases. Other epidemic forecasting teams have also reported success with concurrently or subsequently developed stacking generalization [<xref ref-type="bibr" rid="pcbi.1006134.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref035">35</xref>] ensemble approaches to the FluSight forecasting tasks using Bayesian model averaging [<xref ref-type="bibr" rid="pcbi.1006134.ref036">36</xref>], the fixed weighting scheme that we examine below [<xref ref-type="bibr" rid="pcbi.1006134.ref037">37</xref>], and alternative adaptive weighting schemes based on gradient tree boosting [<xref ref-type="bibr" rid="pcbi.1006134.ref037">37</xref>], as well as with earlier ensemble approaches to short-term point predictions [<xref ref-type="bibr" rid="pcbi.1006134.ref020">20</xref>]. Methodologically, our adaptively weighted ensemble framework differs from these alternatives in that it selects a weighting over components for a particular forecast using “plug-in” statistical estimators for the optimal weights given the context of the forecast being prepared. Like the adaptive approaches presented in [<xref ref-type="bibr" rid="pcbi.1006134.ref037">37</xref>], component weights for each forecast are selected using regression, but the type of regression used and the manner of incorporating additional information, such as the forecast week, are distinct.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Materials and methods</title>
<sec id="sec003">
<title>Surveillance data</title>
<p>Recording every case of influenza is not practicable; infections are often asymptomatic [<xref ref-type="bibr" rid="pcbi.1006134.ref038">38</xref>] or symptomatic but not clinically attended [<xref ref-type="bibr" rid="pcbi.1006134.ref039">39</xref>], laboratory testing may not be performed for clinically attended cases or give false negative results, and reporting of lab-confirmed cases is not mandatory in most instances. Forecast comparisons are instead based on syndromic clinical surveillance data from the U.S. Outpatient Influenza-like Illness Surveillance Network (ILINet) [<xref ref-type="bibr" rid="pcbi.1006134.ref007">7</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref040">40</xref>], a group of health care providers that voluntarily report statistics regarding ILI, where ILI is defined as a 100°F (37.8°C) fever with a cough and/or sore throat without a known cause other than influenza. CDC aggregates these reports and estimates the weekly percentage of patients seen that have ILI, %ILI, across all health care providers using a measure called weighted %ILI (wILI).</p>
<list list-type="bullet">
<list-item>
<p><bold>Geographical resolution</bold>: CDC reports wILI for each of the 10 U.S. Department of Health &amp; Human Services (HHS) regions, as well as for the nation as a whole; the wILI for each of these locations is a weighted average of the ILINet %ILI for state-level units based on population.</p>
</list-item>
<list-item>
<p><bold>Temporal resolution</bold>: wILI is available on a weekly basis; weeks begin on Sunday, end on Saturday, and are numbered according to the epidemiological week (epi week) convention in the United States.</p>
</list-item>
<list-item>
<p><bold>Timeliness</bold>: Initial wILI estimates for a given week are typically released on Friday of the following week; additional reports and revisions from participating health care providers are incorporated in updates throughout the season and after it ends.</p>
</list-item>
<list-item>
<p><bold>Specificity</bold>: Influenza is just one of many potential causes of ILI. Laboratory testing data [<xref ref-type="bibr" rid="pcbi.1006134.ref007">7</xref>] suggest that influenza is responsible for a significant portion of ILI cases during the flu season, especially for weeks when wILI is high, but only for a very small fraction of cases in the typical flu off-season. Much of the variance and “peakiness” in wILI can be associated with influenza epidemics, but wILI trajectories do not taper off to near-zero values as one might expect in a direct measurement of influenza prevalence.</p>
</list-item>
<list-item>
<p><bold>Influence of non-ILI cases</bold>: Since wILI depends on records of both ILI cases and total cases, patterns in non-ILI cases can impact wILI trajectories. We discuss one such pattern in the Holiday effects section.</p>
</list-item>
</list>
<p>CDC hosts the latest ILINet report and other types of surveillance data through Fluview Interactive, a collection of web modules [<xref ref-type="bibr" rid="pcbi.1006134.ref041">41</xref>]; we provide current and historical ILINet reports and some other data sources through our <monospace>delphi-epidata</monospace> API [<xref ref-type="bibr" rid="pcbi.1006134.ref042">42</xref>] and <monospace>epivis</monospace> visualizer [<xref ref-type="bibr" rid="pcbi.1006134.ref043">43</xref>].</p>
</sec>
<sec id="sec004">
<title>Forecasting targets</title>
<p>The FluSight project focuses on in-season distributional forecasts and point predictions of key targets of interest to public health officials:</p>
<list list-type="bullet">
<list-item>
<p><bold>Short-term wILI</bold>: the four wILI values following the last available observation (incorporating all data revisions through some week well after the season’s end)</p>
</list-item>
<list-item>
<p><bold>Season onset</bold>: the first week in the first run of at least three consecutive weeks with wILI values above a location- and season- specific baseline wILI level set by CDC [<xref ref-type="bibr" rid="pcbi.1006134.ref007">7</xref>], or “none” if no such runs exist; describes whether and when an influenza epidemic started in a given season</p>
</list-item>
<list-item>
<p><bold>Season peak percentage</bold>: the maximum of all wILI values for a given season</p>
</list-item>
<list-item>
<p><bold>Season peak week</bold>: the week or weeks in which wILI takes on its maximum value, or “none” if there was no onset in the 2015/2016 comparison</p>
</list-item>
</list>
<p>When making distributional forecasts, wILI values are discretized into CDC-specified bins and a probability assigned to each bin, forming a histogram over possible observations. The width of the bins was set at 0.5 %wILI for the 2015/2016 comparison and 0.1 %wILI for the 2016/2017 comparison; we use a width of 0.5 %wILI for analysis of the 2015/2016 comparison prospective forecasts, and a width of 0.1 %wILI for retrospective evaluation. CDC typically presents wILI values rounded to a resolution of 0.1 %wILI; some targets and evaluations are based on these rounded values.</p>
</sec>
<sec id="sec005">
<title>Evaluation metrics</title>
<p>We focus on three metrics for evaluating performance of a forecast for a given target:
<list list-type="bullet"><list-item><p><bold>Unibin log score</bold>: <inline-formula id="pcbi.1006134.e001"><alternatives><graphic id="pcbi.1006134.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006134.e002"><alternatives><graphic id="pcbi.1006134.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the probability assigned to <italic>i</italic>, the bin containing the observed value. We use this score for ensemble weight selection and most internal evaluation as it has ties to maximum likelihood estimation, and is “proper score” [<xref ref-type="bibr" rid="pcbi.1006134.ref044">44</xref>]. A score for a (reported) distributional prediction <inline-formula id="pcbi.1006134.e003"><alternatives><graphic id="pcbi.1006134.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is called “proper” if its expected value according to any (internal) distributional prediction <inline-formula id="pcbi.1006134.e004"><alternatives><graphic id="pcbi.1006134.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mover accent="true"><mml:mi>q</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is maximized when reporting <inline-formula id="pcbi.1006134.e005"><alternatives><graphic id="pcbi.1006134.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mi>q</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>, i.e., forecasters can maximize their expected scores by reporting their true beliefs. We refer to the “unibin log score” simply as the “log score” except for when comparing it with the multibin log score, which is defined next. The exponentiated mean log score is the (geometric) average probability assigned to events that were actually observed. The exponentiated difference in the mean log scores of method A and method B is an estimate of the (geometric) expected winnings of unit-sized bets of the form “this bin will hold the true value” when bets are placed optimally according to the forecasts of A, and (relative) prices are set optimally according to the forecasts of B.</p></list-item> <list-item><p><bold>Multibin log score</bold>: <inline-formula id="pcbi.1006134.e006"><alternatives><graphic id="pcbi.1006134.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mo form="prefix">log</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mspace width="4.pt"/><mml:mtext>near</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>observed</mml:mtext> <mml:mspace width="4.pt"/><mml:mtext>value</mml:mtext></mml:mrow></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where the <italic>i</italic>’s considered are typically bins within 0.5 %wILI of observed values for a wILI target, or within 1 week for a timing target. The multibin log score was designed by FluSight hosts in consultation with participants, and the judgment “near observed value” was selected as a level of error that would not significantly impact policymakers’ decisions. The exponentiated mean multibin log score is the (geometric) average amount of mass a forecaster placed within this margin for error of observed target values.</p></list-item> <list-item><p><bold>Absolute error</bold>: <inline-formula id="pcbi.1006134.e007"><alternatives><graphic id="pcbi.1006134.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mo>|</mml:mo> <mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mo>-</mml:mo> <mml:mi>y</mml:mi> <mml:mo>|</mml:mo></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006134.e008"><alternatives><graphic id="pcbi.1006134.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:mover accent="true"><mml:mi>y</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the point prediction and <italic>y</italic> is an observed value. (In the case of onset, we consider point predictions for the value of onset conditioned on the fact that an onset actually occurs. We do not consider absolute error for onset in instances where no onset occurred. Some methods considered would sometimes fail to produce such conditional onset point predictions when they were confident that there was no onset, but these methods are not included in any of the figures containing absolute errors.)</p></list-item></list></p>
<p>The FluSight 2015/2016 forecast comparison evaluations were based solely on the multibin log score [<xref ref-type="bibr" rid="pcbi.1006134.ref045">45</xref>].</p>
</sec>
<sec id="sec006">
<title>Terminology and notation</title>
<p>The “flu season” is typically defined as epi week 40 of one year through 20 of the next; we also include data from the rest of the year as part of the season for the purpose of fitting models. In all mathematical notation, we will number the first week of the season as 1 rather than using the corresponding epi week. Let
<list list-type="bullet">
<list-item><p><inline-formula id="pcbi.1006134.e009"><alternatives><graphic id="pcbi.1006134.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> denote the <italic>t</italic>-th CDC report of the current season, containing wILI values for weeks 1 through <italic>t</italic>, inclusive, which is normally published on Friday of week <italic>t</italic> + 1;</p></list-item>
<list-item><p><italic>T</italic> be the number of weeks in the current season (either 52 or 53); we omit all details regarding differing season lengths, presenting forecasting methods and labeling epi week plot axes as if all seasons were of length <italic>T</italic>;</p></list-item>
<list-item><p><italic>Y</italic><sub>1..<italic>T</italic></sub> be the ground truth wILI for the current season: the wILI values used for forecast evaluation, specifically the epi week 28 report for the FluSight comparison, or later revisions as they are available for cross-validation analysis;</p></list-item>
<list-item><p><inline-formula id="pcbi.1006134.e010"><alternatives><graphic id="pcbi.1006134.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> be the ground truth wILI for past season <italic>s</italic>; and</p></list-item>
<list-item><p><bold>Z</bold><sup><italic>t</italic></sup> be a vector containing the forecasting targets of interest at the <italic>t</italic>-th wILI report of the current season: <italic>Y</italic><sub><italic>t</italic>+1..<italic>t</italic>+4</sub> and the seasonal onset, peak week, and peak percentage; for the FluSight comparison, forecasts for these targets were typically due on Monday of week <italic>t</italic> + 2, and allowed to use ILINet and any other data released before the deadline.</p></list-item></list></p>
<p>Our goal is to forecast <bold>Z</bold><sup><italic>t</italic></sup> given <inline-formula id="pcbi.1006134.e011"><alternatives><graphic id="pcbi.1006134.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and previous reports. This can be broken down into multiple steps, such as:
<list list-type="order"><list-item><p>“Backcast” updates to the data through time <italic>t</italic>, producing a distribution over <italic>Y</italic><sub>1..<italic>t</italic></sub> based on the value of <inline-formula id="pcbi.1006134.e012"><alternatives><graphic id="pcbi.1006134.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and previous reports.</p></list-item>
<list-item><p>Connect the backcast for <italic>Y</italic><sub>1..<italic>t</italic></sub> with corresponding forecasts for <italic>Y</italic><sub><italic>t</italic>+1..<italic>T</italic></sub>, yielding a distribution for the entire trajectory <italic>Y</italic><sub>1..<italic>t</italic></sub>.</p></list-item>
<list-item><p>Calculate the distribution for <bold>Z</bold><sup><italic>t</italic></sup> corresponding to this distribution over <italic>Y</italic><sub>1..<italic>t</italic></sub>.</p></list-item></list></p>
<p>We first introduce the delta density method, which forecasts <italic>Y</italic><sub><italic>t</italic>+1..<italic>T</italic></sub> given <italic>Y</italic><sub>1..<italic>t</italic></sub> (step 2). We then discuss a separate procedure for combining multiple forecasts into an adaptively weighted ensemble, forecasting <bold>Z</bold><sup><italic>t</italic></sup> given either <italic>Y</italic><sub>1..<italic>t</italic></sub> or <inline-formula id="pcbi.1006134.e013"><alternatives><graphic id="pcbi.1006134.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (steps 2–3 or 1–3). We also outline a method for estimating the distribution of <italic>Y</italic><sub>1..<italic>t</italic></sub> given <inline-formula id="pcbi.1006134.e014"><alternatives><graphic id="pcbi.1006134.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> (step 1), and analyze its performance when used in conjunction with the delta density method.</p>
</sec>
<sec id="sec007">
<title>Delta density method</title>
<p>Consider the task of estimating the density function <inline-formula id="pcbi.1006134.e015"><alternatives><graphic id="pcbi.1006134.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> using an instance-based approach. Kernel density estimation and kernel regression use smoothing kernels to produce flexible estimates of the density of a random variable (e.g., <inline-formula id="pcbi.1006134.e016"><alternatives><graphic id="pcbi.1006134.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:msub><mml:mi>f</mml:mi> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup></mml:msub></mml:math></alternatives></inline-formula>) and the conditional expectation of one random variable given the value of another (e.g., <inline-formula id="pcbi.1006134.e017"><alternatives><graphic id="pcbi.1006134.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>[</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>), respectively; we can combine these two methods to obtain estimates of the conditional density of one random variable given another. One possible approach would be to use the straightforward estimate
<disp-formula id="pcbi.1006134.e018"><alternatives><graphic id="pcbi.1006134.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:msup><mml:mi>I</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mi>O</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>s</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>S</mml:mi></mml:msubsup> <mml:msup><mml:mi>I</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mphantom><mml:msup><mml:mi>O</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mphantom></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where {1..<italic>S</italic>} is the set of fully observed historical training seasons, and <italic>I</italic><sup>1..<italic>t</italic></sup> and <italic>O</italic><sup><italic>t</italic>+1..<italic>T</italic></sup> are smoothing kernels describing similarity between “input” trajectories and between “output” trajectories, respectively. However, while basic kernel smoothing methods can excel in low-dimensional settings, their performance scales very poorly with growing dimensionality. During most of the season, neither <italic>Y</italic><sub>1..<italic>t</italic></sub> nor <italic>Y</italic><sub><italic>t</italic>+1..<italic>T</italic></sub> is low-dimensional, and the current season’s observations are extremely unlikely to closely match any past <inline-formula id="pcbi.1006134.e019"><alternatives><graphic id="pcbi.1006134.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> or <inline-formula id="pcbi.1006134.e020"><alternatives><graphic id="pcbi.1006134.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>. This, in turn, can lead to kernel density estimates for <italic>Y</italic><sub><italic>t</italic>+1..<italic>T</italic></sub> based almost entirely on the single season <italic>s</italic> with the closest <inline-formula id="pcbi.1006134.e021"><alternatives><graphic id="pcbi.1006134.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> when conditioning on <italic>Y</italic><sub>1..<italic>t</italic></sub>, and excessively narrow density estimates for <italic>Y</italic><sub><italic>t</italic>+1..<italic>T</italic></sub> even without conditioning on <italic>Y</italic><sub>1..<italic>t</italic></sub>. So, instead of applying kernel density estimation directly, we first break the task down into a sequence of low-dimensional sub-tasks. We avoid the high-dimensional output problem by chaining together estimates of <inline-formula id="pcbi.1006134.e022"><alternatives><graphic id="pcbi.1006134.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mrow/><mml:mo>..</mml:mo><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> for each <italic>u</italic> from <italic>t</italic> + 1 to <italic>T</italic>, where Δ<italic>Y<sub>u</sub></italic> = <italic>Y<sub>u</sub></italic> − <italic>Y</italic><sub><italic>u</italic>−1</sub>; estimating these single-dimensional densities requires relatively little data. However, this reformulation exacerbates the high-dimensional input problem since we are conditioning on <italic>Y</italic><sub>1..<italic>u</italic>−1</sub>, which can be considerably longer than <italic>Y</italic><sub>1..<italic>t</italic></sub>. We address the high-dimensional input problem by approximating <inline-formula id="pcbi.1006134.e023"><alternatives><graphic id="pcbi.1006134.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mrow/><mml:mo>..</mml:mo><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1006134.e024"><alternatives><graphic id="pcbi.1006134.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:msub><mml:mi>f</mml:mi> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msup><mml:mi mathvariant="bold">R</mml:mi> <mml:mi>u</mml:mi></mml:msup></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, where <bold>R</bold><sup><italic>u</italic></sup> is some low-dimensional vector of features derived from <italic>Y</italic><sub>1..<italic>u</italic>−1</sub>. Smoothing kernel methods are used to approximate the conditional density functions using data from past seasons.</p>
<p>We use two sets of choices for the approximate conditional density function and summary features to form two versions of the method.</p>
<list list-type="bullet">
<list-item>
<p><bold>Markovian delta density</bold>: approximates the conditional density of Δ<italic>Y<sub>u</sub></italic> given <italic>Y</italic><sub>1..<italic>u</italic>−1</sub> with its conditional density given just the previous (real or simulated) observation, <italic>Y<sub>u</sub></italic>:
<disp-formula id="pcbi.1006134.e025"><alternatives><graphic id="pcbi.1006134.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>=</mml:mo> <mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>T</mml:mi></mml:munderover> <mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>s</mml:mi></mml:msub> <mml:msup><mml:mi>I</mml:mi> <mml:mi>u</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msup><mml:mi>O</mml:mi> <mml:mi>u</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>s</mml:mi></mml:msub> <mml:msup><mml:mi>I</mml:mi> <mml:mi>u</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mphantom><mml:mrow/><mml:mo>·</mml:mo> <mml:msup><mml:mi>O</mml:mi> <mml:mi>u</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mphantom></mml:mrow></mml:mfrac> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>I</italic><sup><italic>u</italic></sup> and <italic>O</italic><sup><italic>u</italic></sup> are Gaussian smoothing kernels. The first equality corresponds to the chain rule of probability on the actual (not estimated) densities; the second incorporates the Markov assumption (i.e., selects <bold>R</bold><sup><italic>u</italic></sup> = [<italic>Y</italic><sub><italic>u</italic>−1</sub>]); and the third gives our choice of estimators for the conditional densities <inline-formula id="pcbi.1006134.e026"><alternatives><graphic id="pcbi.1006134.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e026" xlink:type="simple"/><mml:math display="inline" id="M26"><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> for each <italic>u</italic>. The bandwidth of each <italic>I</italic><sup><italic>u</italic></sup> and <italic>O</italic><sup><italic>u</italic></sup> is chosen separately using bandwidth selection procedures for regular kernel density estimation of <italic>Y</italic><sub><italic>u</italic>−1</sub> and Δ<italic>Y<sub>u</sub></italic>, respectively. (Specifically, we use the <monospace>bw.SJ</monospace> function from the <monospace>R</monospace> [<xref ref-type="bibr" rid="pcbi.1006134.ref046">46</xref>] built-in <monospace>stats</monospace> package, with <monospace>bw.nrd0</monospace> as a fallback in the case of errors. These functions do not accept weights for the inputs; it may be possible to improve forecast performance by incorporating these weights or by using other approaches to select the bandwidths.) Note that density estimates for Δ<italic>Y<sub>u</sub></italic> are based on data from past seasons on week <italic>u</italic> only, allowing the method to incorporate seasonality and holiday effects (for holidays that consistently occur at the same time of year).</p>
<p>Forecasts are based on Monte Carlo simulations of <italic>Y</italic><sub><italic>t</italic>+1..<italic>T</italic></sub> ∣ <italic>Y</italic><sub>1..<italic>t</italic></sub>. The following procedure draws a single possibility for <italic>Y</italic><sub><italic>t</italic>+1..<italic>T</italic></sub>:</p>
<list list-type="order">
<list-item><p>Draw <inline-formula id="pcbi.1006134.e027"><alternatives><graphic id="pcbi.1006134.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e027" xlink:type="simple"/><mml:math display="inline" id="M27"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> from its conditional density estimate given <italic>Y</italic><sub>1..<italic>t</italic></sub>.</p></list-item>
<list-item><p>Draw <inline-formula id="pcbi.1006134.e028"><alternatives><graphic id="pcbi.1006134.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> from its conditional density estimate given <italic>Y</italic><sub>1..<italic>t</italic></sub> and <inline-formula id="pcbi.1006134.e029"><alternatives><graphic id="pcbi.1006134.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>t</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item>
<list-item><p>Continue in the same manner for all remaining weeks.</p></list-item>
</list>
<p>This process is illustrated in <xref ref-type="fig" rid="pcbi.1006134.g001">Fig 1</xref>. Repeating this procedure many times yields a sample from the model for <italic>Y</italic><sub><italic>t</italic>+1..<italic>T</italic></sub> ∣ <italic>Y</italic><sub>1..<italic>t</italic></sub>; stopping at 2000 draws seems sufficient for use in our ensemble forecasts, while at least 7000 are needed to smooth out noise when displaying distributional target forecasts for the delta density method in isolation. Any negative simulated wILI values in these trajectories are clipped off and replaced with zeroes.</p>
</list-item>
<list-item>
<p><bold>Extended delta density</bold>: approximates the conditional density of Δ<italic>Y<sub>u</sub></italic> given <italic>Y</italic><sub>1..<italic>u</italic> − 1</sub> with its conditional density given four features:
<list list-type="bullet"><list-item><p>the previous wILI value, <italic>Y</italic><sub><italic>u</italic>−1</sub>;</p></list-item>
<list-item><p>the sum of the previous <italic>k</italic><sup><italic>u</italic></sup> wILI values, roughly corresponding to the sum of wILI values for the current season;</p></list-item>
<list-item><p>an exponentially weighted sum of the previous <italic>k</italic><sup><italic>u</italic></sup> wILI; values, where the weight assigned to time <italic>v</italic> is 0.5<sup><italic>t</italic>′−<italic>v</italic></sup>; and</p></list-item>
<list-item><p>the previous change in wILI value, Δ<italic>Y</italic><sub><italic>u</italic>−1</sub>.</p></list-item></list></p>
<p>The approximate conditional density assigns each of these features a weight (0.5, 0.25, 0.25, and 0.5, respectively) in order to reduce overfitting and emphasize some relative to the others, and incorporates data from other weeks close to <italic>u</italic> (specifically, within<italic>l</italic><sup><italic>u</italic></sup> weeks; the choice of <italic>l</italic><sup><italic>u</italic></sup> is discussed in a later section) with a truncated Laplacian kernel. We selected these weights and other settings, such as kernel bandwidth selection rules, somewhat arbitrarily based on intuition and experimentation on out-of-sample data; a cross-validation subroutine could be used to make the selection as well, but would multiply the amount of computation required. In case the resulting product of Gaussian and Laplacian kernels is too narrow, we mix its results with a wide boxcar kernel which evenly weights all data from time <italic>u</italic> − <italic>l</italic><sup><italic>u</italic></sup> to <italic>u</italic> + <italic>l</italic><sup><italic>u</italic></sup>:
<disp-formula id="pcbi.1006134.e030"><alternatives><graphic id="pcbi.1006134.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>f</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo> <mml:mrow/><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>∣</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo> <mml:mrow/><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>9</mml:mn> <mml:mo>·</mml:mo> <mml:mfrac denomalign="left" numalign="left"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>s</mml:mi></mml:msub> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>=</mml:mo> <mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mi>u</mml:mi></mml:msup></mml:mrow> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>+</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mi>u</mml:mi></mml:msup></mml:mrow></mml:msubsup> <mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>7</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:mi>u</mml:mi></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>I</mml:mi> <mml:mn>1</mml:mn> <mml:mi>u</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:msup> <mml:mo>⋯</mml:mo> <mml:msup><mml:mi>O</mml:mi> <mml:mi>u</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>v</mml:mi> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>s</mml:mi></mml:msub> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>=</mml:mo> <mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mi>u</mml:mi></mml:msup></mml:mrow> <mml:msup><mml:mi>l</mml:mi> <mml:mi>u</mml:mi></mml:msup></mml:msubsup> <mml:mrow><mml:msup><mml:mrow><mml:mn>0</mml:mn><mml:mo>.</mml:mo><mml:mn>7</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mi>v</mml:mi><mml:mo>−</mml:mo><mml:mi>u</mml:mi></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>I</mml:mi> <mml:mn>1</mml:mn> <mml:mi>u</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:msup> <mml:mo>⋯</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>I</mml:mi> <mml:mn>4</mml:mn> <mml:mi>u</mml:mi></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd/><mml:mtd columnalign="left"><mml:mrow><mml:mo>+</mml:mo><mml:mspace width="4pt"/><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>1</mml:mn> <mml:mo>·</mml:mo> <mml:mfrac denomalign="left"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>s</mml:mi></mml:msub> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>=</mml:mo> <mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mi>u</mml:mi></mml:msup></mml:mrow> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>+</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mi>u</mml:mi></mml:msup></mml:mrow></mml:msubsup> <mml:msup><mml:mi>O</mml:mi> <mml:mi>u</mml:mi></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mi>u</mml:mi> <mml:mrow/></mml:msubsup> <mml:mo>,</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>v</mml:mi> <mml:mi>s</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mi>s</mml:mi></mml:msub> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>v</mml:mi> <mml:mo>=</mml:mo> <mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mi>u</mml:mi></mml:msup></mml:mrow> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>+</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mi>u</mml:mi></mml:msup></mml:mrow></mml:msubsup> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Using data from <italic>v</italic> ≠ <italic>u</italic> incorporates additional reasonable outcomes for Δ<italic>Y<sub>u</sub></italic> by incorporating past wILI patterns with different timing, but risks including some very unreasonable possibilities produced by repeatedly drawing from the same <italic>v</italic> rather than following seasonal trends with increasing <italic>v</italic>’s. For example, when a portion of a past season that is more similar to itself with a slight time shift than to any other past season, it may be selected for multiple consecutive <italic>u</italic>’s and produce an unreasonable trajectory. This could potentially occur when drawing data from the relatively flat regions of wILI trajectories of many seasons, or when incorporating observations around an unusually early, late, high, or low peak. To prevent this possibility, we combine the natural estimate for <italic>Y<sub>u</sub></italic> arising from the density estimate for Δ<italic>Y<sub>u</sub></italic> with a random draw <inline-formula id="pcbi.1006134.e031"><alternatives><graphic id="pcbi.1006134.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mtext>uncond</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> from the unconditional density estimate for <italic>Y<sub>u</sub></italic> (using a Gaussian kernel and only data from week <italic>u</italic>):
<disp-formula id="pcbi.1006134.e032"><alternatives><graphic id="pcbi.1006134.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mtext>sim</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>9</mml:mn> <mml:mo>·</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>u</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>+</mml:mo> <mml:mo>Δ</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mtext>sim</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>1</mml:mn> <mml:mo>·</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mi>u</mml:mi> <mml:mtext>uncond</mml:mtext></mml:msubsup> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
</list-item>
</list>
<fig id="pcbi.1006134.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006134.g001</object-id>
<label>Fig 1</label>
<caption>
<title>The delta density method conditions on real and simulated observations up to week <italic>u</italic> − 1 when building a probability distribution over the observation at week <italic>u</italic>.</title>
<p>This figure demonstrates the process for drawing a single trajectory from the Markovian delta density estimate, ignoring the data revision process. The latest ILINet report, <inline-formula id="pcbi.1006134.e033"><alternatives><graphic id="pcbi.1006134.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo><mml:mi>t</mml:mi></mml:mrow> <mml:mi>t</mml:mi> </mml:msubsup></mml:math></alternatives></inline-formula>, which incorporates observations through week 48, is shown in black. Kernel smoothing estimates for future values at times <italic>u</italic> from <italic>t</italic> + 1 to <italic>T</italic> are shown in blue, as are simulated observations drawn from these estimates. Past seasons’ trajectories are shown in red, with alpha values proportional to the weight they are assigned by the kernel <italic>I</italic><sup><italic>u</italic></sup>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec008">
<title>Residual density method</title>
<p>This same approach can be applied to estimate the distribution of residuals of a wILI point predictor. Suppose that we have observed</p>
<list list-type="bullet"><list-item><p><inline-formula id="pcbi.1006134.e034"><alternatives><graphic id="pcbi.1006134.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e034" xlink:type="simple"/><mml:math display="inline" id="M34"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo> <mml:mrow/><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow/></mml:msubsup></mml:math></alternatives></inline-formula>, the partial wILI trajectory up to time <italic>t</italic><sub>1</sub>, and</p></list-item>
<list-item><p><inline-formula id="pcbi.1006134.e035"><alternatives><graphic id="pcbi.1006134.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo> <mml:mrow/><mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow/></mml:msubsup></mml:math></alternatives></inline-formula>, point estimates of the trajectory up to some later time <italic>t</italic><sub>2</sub>;</p></list-item></list>
<p specific-use="continuation">our goal is to estimate the conditional distribution of</p>
<list list-type="bullet">
<list-item>
<p><inline-formula id="pcbi.1006134.e036">
<alternatives>
<graphic id="pcbi.1006134.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e036" xlink:type="simple"/>
<mml:math display="inline" id="M36">
<mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>Y</mml:mi>
<mml:mo>-</mml:mo>
<mml:mi>X</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mrow>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>1</mml:mn>
</mml:msub>
<mml:mo>+</mml:mo>
<mml:mn>1</mml:mn>
<mml:mo>.</mml:mo>
<mml:mo>.</mml:mo>
<mml:mrow/>
<mml:msub>
<mml:mi>t</mml:mi>
<mml:mn>2</mml:mn>
</mml:msub>
</mml:mrow>
<mml:mrow/>
</mml:msubsup>
</mml:math>
</alternatives>
</inline-formula>, the unknown residuals,</p>
</list-item>
</list>
<p specific-use="continuation">given <inline-formula id="pcbi.1006134.e037"><alternatives><graphic id="pcbi.1006134.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo> <mml:mrow/><mml:msub><mml:mi>t</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow> <mml:mrow/></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006134.e038"><alternatives><graphic id="pcbi.1006134.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo> <mml:mrow/><mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow/></mml:msubsup></mml:math></alternatives></inline-formula>, using data from past seasons. This can be achieved by chaining together draws from conditional density estimates of (<italic>Y</italic> − <italic>X</italic>)<sub><italic>u</italic></sub> ∣ <bold>R</bold><sup><italic>u</italic></sup> for <italic>u</italic> from <italic>t</italic><sub>1</sub> + 1 to <italic>t</italic><sub>2</sub>, where <bold>R</bold><sup><italic>u</italic></sup> is a function of <italic>Y</italic><sub>1..<italic>u</italic>−1</sub> and <inline-formula id="pcbi.1006134.e039"><alternatives><graphic id="pcbi.1006134.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mn>1</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo> <mml:mrow/><mml:msub><mml:mi>t</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow> <mml:mrow/></mml:msubsup></mml:math></alternatives></inline-formula>. The delta density method can be seen as a special case where <italic>t</italic><sub>1</sub> = <italic>t</italic>; <italic>t</italic><sub>2</sub> = <italic>T</italic>; <italic>X</italic><sub>1..<italic>t</italic></sub> = <italic>Y</italic><sub>1..<italic>t</italic></sub>, past values of <italic>Y</italic> which are treated as known and are simply duplicated in the simulated trajectories; and <italic>X</italic><sub><italic>t</italic>+1..<italic>T</italic></sub> = <italic>Y</italic><sub><italic>t..T</italic>−1</sub>, values of <italic>Y</italic> which begin as unknown but are filled in as needed by previous simulation steps, giving (<italic>Y</italic> − <italic>X</italic>)<sub><italic>t</italic>+1..<italic>T</italic></sub> = Δ<italic>Y</italic><sub><italic>t</italic>+1..<italic>T</italic></sub>. We use the residual density method to backcast <italic>Y</italic><sub>1..<italic>t</italic></sub> from <inline-formula id="pcbi.1006134.e040"><alternatives><graphic id="pcbi.1006134.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and as the basis for another forecaster in the ensemble.</p>
<p><xref ref-type="fig" rid="pcbi.1006134.g002">Fig 2</xref> shows sample forecasts over wILI trajectories generated by each of these approaches and compares them to some alternatives described in <xref ref-type="supplementary-material" rid="pcbi.1006134.s013">S1 Appendix</xref>.</p>
<fig id="pcbi.1006134.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006134.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Delta and residual density methods generate wider distributions over trajectories than methods that treat entire seasons as units.</title>
<p>These plots show sample forecasts of wILI trajectories generated from models that treat seasons as units (BR, Empirical Bayes) and from models incorporating delta and residual density methods. Yellow, the latest wILI report available for these forecasts; magenta, the ground truth wILI available at the beginning of the following season; black, a sample of 100 trajectories drawn from each model; cyan, the closest trajectory to the ground truth wILI from each sample of 100.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.g002" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Combining multiple methods: Stacking approach to model averaging</title>
<p>Forecasting systems that select effective combinations of predictions from multiple models can improve on the performance of the individual components, as demonstrated by their successful application in many domains. For each probability distribution and point prediction in a forecast, we treat the choice of an effective combination as a statistical estimation problem, and base each decision on the models’ behavior in leave-one-out cross-validation forecasts. Additional cross-validation analysis indicates that this approach achieves performance comparable to or better than the best individual component.</p>
<sec id="sec010">
<title>Background, motivation for combining forecasts</title>
<p>Methods that combine the output of different models, called “ensembles”, “multi-model ensembles”, “super-ensembles”, “model averages”, or various other names based on the domain and type of approach, have been applied successfully in many problem settings, improving upon the results of the best individual model. An ensemble approach is motivated in the context of seasonal epidemic forecasting by factors such as:
<list list-type="bullet"><list-item><p><bold>Model misspecification and overconfidence in distributional forecasts</bold>: Many methods overlook the possibility of a significant proportion of observed outcomes, or assign otherwise inappropriate probabilities. These omissions and other mistakes are not identical across models; the gaps left by one component can be filled in by another.</p></list-item>
<list-item><p><bold>Leveraging partially correlated errors in point predictions</bold>: The point prediction errors of individual methods can vary in magnitude and are often only partially correlated with each other, allowing ensemble methods to improve performance, e.g., by highly weighting more accurate predictors, or by reducing the variance when combining multiple unbiased estimators.</p></list-item>
<list-item><p><bold>Strengths and weaknesses in different targets</bold>: Some methods may work well for certain forecasting targets, but have poor performance or fail to produce predictions for others; model averages can be smoothly adjusted to account for different behaviors for different targets.</p></list-item>
<list-item><p><bold>Changes in performance within seasons</bold>: Making predictions at the beginning, middle, and end of a season can be seen as different tasks, and the relative performance characteristics of the components may change based on the time of season (or whether it is around a holiday). Just as ensemble methods can account for distinct patterns based on forecasting target, they can be tailored to account for changes in behavior within a season.</p></list-item></list></p>
<p>We developed an adaptively weighted model average that consistently outperforms the best individual component. Other teams submitting forecasts to the FluSight comparison have concurrently developed other ensemble systems and found similar success [<xref ref-type="bibr" rid="pcbi.1006134.ref036">36</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref037">37</xref>]. Our approach is distinguished from these other methods in that it very directly estimates the best model average weights for a given location, time, target, and evaluation metric.</p>
</sec>
<sec id="sec011">
<title>A stacking approach to model averaging</title>
<p>For each location <italic>l</italic>, week <italic>t</italic>, target <italic>i</italic>, and evaluation metric <italic>e</italic>, we choose a (weighted) model average as the final prediction: an ensemble forecast of the form <bold>X</bold><bold>w</bold>, where
<list list-type="bullet"><list-item><p><bold>X</bold> is the output of the <italic>m</italic> ensemble components—either (a) a row vector of point predictions with <italic>m</italic> entries, or (b) a matrix of distributional predictions with <italic>m</italic> columns—and</p></list-item>
<list-item><p><bold>w</bold> ∈ [0, 1]<sup><italic>m</italic></sup> is a (column) vector of weights, one per component, with <inline-formula id="pcbi.1006134.e041"><alternatives><graphic id="pcbi.1006134.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>m</mml:mi></mml:msubsup> <mml:msub><mml:mi>w</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p></list-item></list></p>
<p>Variants of the same models, or methods based on related approaches or assumptions, may at times produce similar forecasts that commit the same errors while producing a misleading impression of consensus; a successful ensemble may need to consider not only the performance of each individual component, but also the relationships between the raw output of the components. To this end, we use a “stacking generalization” approach [<xref ref-type="bibr" rid="pcbi.1006134.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref035">35</xref>], treating the selection of weights <bold>w</bold> for the current season, <italic>S</italic> + 1, as the task of frequentist estimation of the risk-optimal weight vector,
<disp-formula id="pcbi.1006134.e042"><alternatives><graphic id="pcbi.1006134.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e042" xlink:type="simple"/><mml:math display="block" id="M42"><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="2pt"/><mml:mtext>max</mml:mtext></mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mtext>Score</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
based on leave-one-season-out cross-validation:
<disp-formula id="pcbi.1006134.e043"><alternatives><graphic id="pcbi.1006134.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e043" xlink:type="simple"/><mml:math display="block" id="M43"><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mover accent="true"><mml:mi>w</mml:mi><mml:mo>^</mml:mo></mml:mover></mml:mstyle><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>e</mml:mi></mml:mstyle><mml:mrow><mml:mtext>uniform</mml:mtext></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:munder><mml:mrow><mml:mtext>arg</mml:mtext><mml:mspace width="2pt"/><mml:mtext>max</mml:mtext></mml:mrow><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo>∈</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>m</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mstyle></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:munder><mml:mstyle displaystyle="true" mathsize="140%"><mml:mo>∑</mml:mo></mml:mstyle><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mn>1..</mml:mn><mml:mi>S</mml:mi></mml:mrow> <mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:munder><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mtext>RelevanceWeight</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>;</mml:mo><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mi>l</mml:mi><mml:mo>,</mml:mo><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>e</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>·</mml:mo><mml:mtext>CrossValidationScore</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle mathsize="normal" mathvariant="bold"><mml:mi>w</mml:mi></mml:mstyle><mml:mo>,</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>l</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>i</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives></disp-formula>
where <italic>μ</italic> is an inflation factor that gives addition weight to the uniform component (<bold>e</bold><sub>uniform</sub> is a vector containing a 1 in the position corresponding to the uniform distribution component, and 0 in every other position). We changed the RelevanceWeight function used for real-time forecasts throughout the 2015/2016 season, but study only the following RelevanceWeight function in the cross-validation analysis of the adaptively weighted ensemble:
<disp-formula id="pcbi.1006134.e044"><alternatives><graphic id="pcbi.1006134.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e044" xlink:type="simple"/><mml:math display="block" id="M44"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>RelevanceWeight</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>e</mml:mi> <mml:mo>;</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>|</mml:mo> <mml:mi>t</mml:mi> <mml:mo>-</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>|</mml:mo> <mml:mo>≤</mml:mo> <mml:mn>4</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>i</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext> <mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>A larger collection of cross-validation data can be considered by assigning relevance weights of 1 to additional training instances; relevance weights can also be gradually decreased for less similar data rather than jumping down to zero.</p>
<p>When <italic>e</italic> is the unibin or multibin log score:
<list list-type="bullet"><list-item><p>Using the rule of three [<xref ref-type="bibr" rid="pcbi.1006134.ref047">47</xref>] to estimate the frequency of events that we haven’t seen before, we chose <inline-formula id="pcbi.1006134.e045"><alternatives><graphic id="pcbi.1006134.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:mi>μ</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>3</mml:mn> <mml:mrow><mml:mi>S</mml:mi> <mml:mo>·</mml:mo> <mml:mi>L</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula> for most submissions. (Prior to the submission for 2015 EW43, we used a constant <italic>μ</italic> = 0.01 to guarantee a certain minimum log score.)</p></list-item>
<list-item><p>The optimization problem is equivalent to fitting a mixture of distributions, and we can use the degenerate EM algorithm [<xref ref-type="bibr" rid="pcbi.1006134.ref048">48</xref>] to efficiently find the weights; convex optimization techniques such as the logarithmic barrier method are also appropriate.</p></list-item></list></p>
<p>When <italic>e</italic> is mean absolute error:
<list list-type="bullet"><list-item><p>We choose <italic>μ</italic> = 0 (and further, exclude the uniform distribution method from the ensemble entirely).</p></list-item>
<list-item><p>This optimization problem is referred to as least absolute deviation regression or median regression, with linear inequality and equality constraints on the coefficients; we reformulate the problem as a linear program and use the <monospace>lpSolve</monospace> package [<xref ref-type="bibr" rid="pcbi.1006134.ref049">49</xref>] to find a solution.</p></list-item></list></p>
<p>We compare the “adaptive” weighting scheme above to two alternatives:
<list list-type="bullet"><list-item><p><bold>Fixed-weightset-based stacking</bold>: the same approach as above, with the same <italic>μ</italic> selections but a different RelevanceWeight function:
<disp-formula id="pcbi.1006134.e046"><alternatives><graphic id="pcbi.1006134.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e046" xlink:type="simple"/><mml:math display="block" id="M46"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>RelevanceWeight</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>s</mml:mi> <mml:mo>,</mml:mo> <mml:mi>l</mml:mi> <mml:mo>,</mml:mo> <mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>e</mml:mi> <mml:mo>;</mml:mo> <mml:msup><mml:mi>s</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>l</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>t</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>i</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>e</mml:mi> <mml:mo>=</mml:mo> <mml:msup><mml:mi>e</mml:mi> <mml:mo>′</mml:mo></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>otherwise</mml:mtext> <mml:mo>;</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
and</p></list-item>
<list-item><p><bold>Uniform weights</bold>: does not use the above stacking scheme; instead, for every prediction, assigns each component the same weight in the ensemble, <inline-formula id="pcbi.1006134.e047"><alternatives><graphic id="pcbi.1006134.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>m</mml:mi></mml:mfrac></mml:math></alternatives></inline-formula> (replacing <inline-formula id="pcbi.1006134.e048"><alternatives><graphic id="pcbi.1006134.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:mover accent="true"><mml:mi mathvariant="bold">w</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1006134.e049"><alternatives><graphic id="pcbi.1006134.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>m</mml:mi></mml:mfrac> <mml:mover accent="true"><mml:mn>1</mml:mn> <mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>).</p></list-item></list></p>
<p>The ensemble and each of its components forecast the targets <bold>Z</bold><sup><italic>t</italic></sup> given a point or distributional estimate for <italic>Y</italic><sub>1..<italic>T</italic></sub>.</p>
</sec>
</sec>
<sec id="sec012">
<title>Considering details of the data generation process</title>
<p>Two important features of ILINet data to consider in models and forecast evaluation are 1. timeliness and accuracy of initial wILI values for each week and subsequent updates to these values, and 2. changes in behavior on and around major holidays. We examine these details of the data generation process, describe how they are addressed in the delta density model, and demonstrate the importance of considering the update procedure when performing retrospective evaluation and prospective forecasting.</p>
<sec id="sec013">
<title>Modeling backfill updates to past wILI</title>
<p>When a wILI value is reported for a given week, it is not set in stone; as ILINet members provide “backfill” reports or revisions for past weeks and data is cleaned, wILI observations are updated accordingly. When generating a retrospective forecast, it is important to use the version of the data that would have been available at the time rather than the final revision in order to get a more appropriate estimate of the future performance of a forecasting system. Furthermore, forecasting performance can be improved by modeling and “backcasting” these backfill updates, accounting for the following sources of error:
<list list-type="bullet"><list-item><p><bold>Biased early reports</bold>: earlier wILI versions are generally biased downwards early in the in-season, and upwards towards the end of the in-season, which may lead to forecasts of lower, later peaks early in the season, and of longer epidemic duration later in the season;</p></list-item>
<list-item><p><bold>Overconfident short-term distributional forecasts</bold>: since updates in wILI can cause “observed” data, e.g., of the wILI at the presumed peak week, to shift, ignoring backfill may lead to “thin”, overconfident forecast distributions;</p></list-item>
<list-item><p><bold>Revisions of “observed” seasonal targets</bold>: wILI updates sometimes cause large changes in the apparent onset week or peak week when there are bumps or multiple peaks in the trajectory: wILI updates can cause a measurement to change from above the CDC baseline to below (or vice versa), or for an earlier, lower peak to rise above a later peak (or vice versa); ignoring backfill updates can cause models to completely miss some possibilities when these targets appear to be determined. A similar type of error can arise from revisions to the peak height value (regardless of whether the peak week changes); even small updates can result in large unibin log score penalties.</p></list-item></list></p>
<p>We estimate the distribution of backfill updates using the residual density method with <italic>t</italic><sub>1</sub> = 0, <italic>t</italic><sub>2</sub> = <italic>t</italic>, <inline-formula id="pcbi.1006134.e050"><alternatives><graphic id="pcbi.1006134.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> the latest version of wILI available, <italic>Y</italic><sub>1..<italic>t</italic></sub> the corresponding final revisions, and <bold>R</bold><sup><italic>u</italic></sup> = [<italic>Y</italic><sub><italic>u</italic>−1</sub>]. The weight given to a historical nonfinal-to-final residual is based on three factors:
<list list-type="bullet"><list-item><p><bold>Lag amount</bold>: later revisions of wILI values tend to be closer to the final revision than earlier revisions are; thus, when estimating the distribution of <italic>n</italic>-week-old wILI to finalized wILI residuals, only <italic>n</italic>-week-old wILI to finalized wILI data is considered; backfill data for other lags is ignored (i.e., has zero weight);</p></list-item>
<list-item><p><bold>The current season’s nonfinal wILI value</bold>: historical backfill updates with nonfinal wILI values closer to the nonfinal wILI value from the current season are given greater weights according to a Gaussian kernel (with bandwidth based on a rule for kernel density estimation of the historical nonfinal wILI values);</p></list-item>
<list-item><p><bold>Epi week of observation</bold>: since the backfill pattern changes throughout a season, historical backfill updates corresponding to nearby epi weeks are weighted more highly than those from a different time of the season, using a Laplacian kernel (with an arbitrarily selected bandwidth).</p></list-item></list></p>
<p>The bandwidth of the density estimate is based on a kernel density estimate of the nonfinal-to-final residuals.</p>
<p>The backcasting method is modular and can combine with any forecaster expecting ground truth wILI as input. The straightforward approach is to sample a few thousand trajectories from the backfill simulator, feed each of these into the forecaster to obtain a trajectory or a distribution over targets, and aggregate the results. Some forecasting methods in the Delphi-Stat ensemble do not have a simple way to quickly generate single-trajectory forecasts, so we also use alternative approaches to reduce computation, such as randomly pairing backcasts and trajectory forecasts, where the trajectory forecasts are efficiently generated in batch, based on the pointwise mean of the backcasts.</p>
</sec>
<sec id="sec014">
<title>Latency of initial wILI value and “nowcasting”</title>
<p>The initial ILINet wILI value for a given “target” week (from Sunday to Saturday) is typically released on Friday of the following week. Data sources with lower latency and higher temporal resolution can be used to prepare wILI estimates (“nowcasts”) earlier in the following week or even during the target week itself. More generally, auxiliary data for past and current weeks can improve not only models of disease activity in these weeks but also forecasts of future disease activity. Given a backcaster than simulates finalized data for past weeks <italic>Y</italic><sub>1..<italic>t</italic></sub> given observed ILINet and auxiliary data, a nowcaster that simulates <italic>Y</italic><sub><italic>t</italic>+1</sub> given these observations and (a simulated) <italic>Y</italic><sub>1..<italic>t</italic></sub>, and a forecaster that simulates <italic>Y</italic><sub><italic>t</italic>+2..<italic>T</italic></sub> given these observations and (a simulated) <italic>Y</italic><sub>1..<italic>t</italic>+1</sub>, we can sample from an enhanced model of <italic>Y</italic><sub>1..<italic>T</italic></sub> (given the latest wILI observations <inline-formula id="pcbi.1006134.e051"><alternatives><graphic id="pcbi.1006134.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msubsup><mml:mi>W</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mi>t</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, previous versions of wILI, and auxiliary data) using the following procedure:
<list list-type="order"><list-item><p>Repeatedly draw a random value <inline-formula id="pcbi.1006134.e061"><alternatives><graphic id="pcbi.1006134.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> for <italic>Y</italic><sub>1..<italic>T</italic></sub> by:
<list list-type="order"><list-item><p>drawing a random value <inline-formula id="pcbi.1006134.e052"><alternatives><graphic id="pcbi.1006134.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> for <italic>Y</italic><sub>1..<italic>t</italic></sub> conditioned on the observed data, using the backcaster, then</p></list-item>
<list-item><p>drawing a random value <inline-formula id="pcbi.1006134.e053"><alternatives><graphic id="pcbi.1006134.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e053" xlink:type="simple"/><mml:math display="inline" id="M53"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> for <italic>Y</italic><sub><italic>t</italic>+1</sub> conditioned on the observed data and <inline-formula id="pcbi.1006134.e054"><alternatives><graphic id="pcbi.1006134.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, using the nowcaster, then</p></list-item>
<list-item><p>drawing a random value <inline-formula id="pcbi.1006134.e055"><alternatives><graphic id="pcbi.1006134.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e055" xlink:type="simple"/><mml:math display="inline" id="M55"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> for <italic>Y</italic><sub><italic>t</italic>+2..<italic>T</italic></sub> conditioned on the observed data and <inline-formula id="pcbi.1006134.e056"><alternatives><graphic id="pcbi.1006134.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e056" xlink:type="simple"/><mml:math display="inline" id="M56"><mml:mrow><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow/></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>, using the forecaster, then</p></list-item>
<list-item><p>combine <inline-formula id="pcbi.1006134.e057"><alternatives><graphic id="pcbi.1006134.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>t</mml:mi></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006134.e058"><alternatives><graphic id="pcbi.1006134.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e058" xlink:type="simple"/><mml:math display="inline" id="M58"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006134.e059"><alternatives><graphic id="pcbi.1006134.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn><mml:mo>.</mml:mo><mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> into a single (random) trajectory <inline-formula id="pcbi.1006134.e060"><alternatives><graphic id="pcbi.1006134.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mrow/><mml:mi>T</mml:mi></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, and</p></list-item></list></p></list-item>
<list-item><p>Collect these individual, randomly drawn trajectories into a list (i.e., a random sample).</p></list-item></list></p>
<p>As with the earlier method of combining backcasts and forecasts without a nowcaster, this procedure may be too computationally expensive for some implementations of some forecasters; we use these steps exactly with the delta density methods, for example, but consider modifications and approximations for some other forecasters.</p>
<p>This methodology can be applied in conjunction with one of many available nowcasters. We focus on ILI-Nearby [<xref ref-type="bibr" rid="pcbi.1006134.ref050">50</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref051">51</xref>], which produces nowcasts for wILI by fusing together several “sensors” using another type of stacked generalization, where each sensor is also a nowcast of wILI data; we reproduce a list of references from [<xref ref-type="bibr" rid="pcbi.1006134.ref050">50</xref>] on other methodologies for nowcasting and incorporating auxiliary data here [<xref ref-type="bibr" rid="pcbi.1006134.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref028">28</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref031">31</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref052">52</xref>–<xref ref-type="bibr" rid="pcbi.1006134.ref071">71</xref>] along with some more recent work [<xref ref-type="bibr" rid="pcbi.1006134.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref030">30</xref>], with special note of other work using multiple auxiliary data sources [<xref ref-type="bibr" rid="pcbi.1006134.ref029">29</xref>] or nowcasters [<xref ref-type="bibr" rid="pcbi.1006134.ref071">71</xref>]. We consider four distributional nowcasters:
<list list-type="bullet"><list-item><p><inline-formula id="pcbi.1006134.e062"><alternatives><graphic id="pcbi.1006134.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> produced by the forecaster, i.e., not using separate nowcasts at all—the basis for all performance estimates unless otherwise noted, as no nowcasts were incorporated into the Delphi-Stat forecasts for the 2015/2016 season;</p></list-item>
<list-item><p><inline-formula id="pcbi.1006134.e063"><alternatives><graphic id="pcbi.1006134.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e063" xlink:type="simple"/><mml:math display="inline" id="M63"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> following a normal distribution with mean and standard deviation given by the ILI-Nearby nowcasting system (ignoring the backcaster’s output);</p></list-item>
<list-item><p><inline-formula id="pcbi.1006134.e064"><alternatives><graphic id="pcbi.1006134.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006134.e064" xlink:type="simple"/><mml:math display="inline" id="M64"><mml:msubsup><mml:mi>Y</mml:mi> <mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> following a Student’s <italic>t</italic> distribution with two degrees of freedom, centrality parameter set to the ILI-Nearby point estimate, and scale parameter set to the ILI-Nearby standard deviation estimate, intended to be a wide-tailed variant of the above (ignoring the backcaster’s output);</p></list-item>
<list-item><p>an ensemble of first and third approaches, with associated weights (probabilities) of 15% and 85% respectively. (The choice of weights was inherited from a similar approach that mixed “1 wk ahead” delta density forecasts with nowcasts, rather than ensemble forecasts (including a uniform component) based on these two approaches; a nowcast weight of 85% was selected on a limited amount of out-of-sample (preseason) forecasts to maximize log score.)</p></list-item></list></p>
</sec>
<sec id="sec015">
<title>Holiday effects</title>
<p>On average, wILI tends to be higher on holidays and during the winter holiday season than would be expected based on interpolating observations from nearby weeks [<xref ref-type="bibr" rid="pcbi.1006134.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref050">50</xref>], as seen in <xref ref-type="fig" rid="pcbi.1006134.g003">Fig 3</xref>. Sharp rises and drops in wILI are common from early or mid-December to early January (roughly coinciding with a four week period beginning with epi week 50), with either the season’s peak or a lower, secondary peak commonly occurring on epi week 52. This pattern appears to arise from two factors:
<list list-type="bullet"><list-item><p>spikes downward in the number of non-ILI visits during the holiday season (corresponding to increases in wILI), perhaps caused by patients choosing not to visit the doctor for less serious issues on holidays, and</p></list-item>
<list-item><p>decreases in the average number of ILI visits at the end of the holidays, perhaps due to decreased transmission of ILI during holidays, which make the preceding increases in wILI appear even sharper.</p></list-item></list></p>
<fig id="pcbi.1006134.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006134.g003</object-id>
<label>Fig 3</label>
<caption>
<title>On average, wILI is higher on holidays than expected based on neighboring weeks.</title>
<p>Weekly trends in wILI values, as expressed by the contribution of a each week to a sum of wILI values from seasons 2003/2004 to 2015/2016, excluding 2008/2009 and 2009/2010 (which include portions of the 2009 influenza pandemic), show spikes and bumps upward on and around major holidays. (U.S. federal holidays are indicated with event lines.) The number of non-ILI visits to ILINet health care providers spikes downwards on holidays (disproportionately with any drops in the number of ILI visits), contributing to higher wILI. The number of ILI visits generally declines in the second half of the winter holiday season, causing winter holiday peaks to appear even higher relative to nearby weeks. In addition to holiday effects, we see that average ILINet participation jumps upward on epi week 40, and gradually tapers off later in the season and in the off-season.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.g003" xlink:type="simple"/>
</fig>
<p>Similarly, there are spikes or minor blips downward in the average number of non-ILI visits (which can result in small increases in wILI) associated with Thanksgiving Day; Labor Day; Independence Day; Memorial Day; Birthday of Martin Luther King, Jr.; Washington’s Birthday; Columbus Day; and perhaps other holidays. The spike upward in wILI at Thanksgiving can push wILI unexpectedly over the onset threshold, and holiday effects may help explain the surprising frequency at which peaks occur on epi week 7 but not neighboring weeks. Additional age-specific patterns may be obscured by this analysis of aggregate ILI and non-ILI visit counts.</p>
</sec>
<sec id="sec016">
<title>Impact of holiday effects on choice of kernels</title>
<p>Each holiday above occurs at roughly the same time of year every year, falling on one of two possible epi weeks. Thus, models that predict behavior at a given epi week by prioritizing or focusing solely on past behavior at that given epi week will automatically perform a rough adjustment for holiday effects. This factor informs our decision to use historical data only from corresponding weeks in the Markovian delta density method, and a truncated Laplacian kernel with narrower width near winter holidays in the extended delta density method. Specifically, for the extended delta density method, we choose the half-width of the kernel to be <italic>l</italic><sup><italic>u</italic></sup> = min{10, max{0, |<italic>u</italic> − 22| − 1}}, which assigns <italic>l</italic><sup><italic>u</italic></sup> = 0 for <italic>u</italic> within one week of epi week 52, and larger <italic>l</italic><sup><italic>u</italic></sup>’s the farther <italic>u</italic> is from this time period, up to a maximum value of 10.</p>
</sec>
</sec>
</sec>
<sec id="sec017" sec-type="results">
<title>Results</title>
<sec id="sec018">
<title>2015/2016 FluSight comparison</title>
<p>During the 2015/2016 FluSight comparison, we submitted weekly, prospective forecasts from three forecasting systems:
<list list-type="bullet"><list-item><p><bold>Delphi-Stat</bold>: an adaptively weighted ensemble of instance-based statistical forecasting methods, and the topic of this paper;</p></list-item>
<list-item><p><bold>Delphi-Archefilter</bold>: forms an empirical (rather than mechanistic) process model describing wILI trajectories, and incorporates both wILI and multiple forms of digital surveillance data using statistical filtering techniques [<xref ref-type="bibr" rid="pcbi.1006134.ref050">50</xref>]; and</p></list-item>
<list-item><p><bold>Delphi-Epicast</bold>: wisdom-of-crowds approach based on combining predictions submitted by several human participants [<xref ref-type="bibr" rid="pcbi.1006134.ref072">72</xref>].</p></list-item></list></p>
<p>Our past and ongoing forecasts, as well as <monospace>Python</monospace> [<xref ref-type="bibr" rid="pcbi.1006134.ref073">73</xref>] and <monospace>R</monospace> [<xref ref-type="bibr" rid="pcbi.1006134.ref046">46</xref>] code for components of the systems used to generate them, are publicly available online [<xref ref-type="bibr" rid="pcbi.1006134.ref074">74</xref>–<xref ref-type="bibr" rid="pcbi.1006134.ref076">76</xref>]. Changes made to Delphi-Stat throughout the 2015/2016 season are described in <xref ref-type="supplementary-material" rid="pcbi.1006134.s017">S5 Appendix</xref>. These three forecasting systems were ranked as the top three in the 2015/2016 comparison in terms of overall multibin score, with Delphi-Stat at the top. <xref ref-type="fig" rid="pcbi.1006134.g004">Fig 4</xref> shows the performance of the three Delphi forecasting systems, broken down by evaluation metric and forecasting target. <xref ref-type="supplementary-material" rid="pcbi.1006134.s001">S1</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006134.s002">S2</xref> Figs. show the multibin scores broken down by location and by forecasting week. Delphi-Stat had consistently strong aggregate multibin scores across different targets, locations, and forecasting weeks, and the best overall multibin log score of all FluSight 2015/2016 submissions. Delphi-Stat’s unibin log score evaluations relative to the other two Delphi systems seem similar to or better than the corresponding multibin log score evaluations, as Delphi-Stat has the best unibin score of the three for each target rather than just overall; this observation seems natural since Delphi-Stat was developed to optimize unibin log score, and may suggest that optimizing for multibin log score rather than unibin log score when selecting ensemble weights or as a post-processing step could produce multibin log score improvements. However, the system’s point predictions, while optimized for the mean absolute error metric, were less accurate than (but still competitive with) the other two when averaged across all predictions.</p>
<fig id="pcbi.1006134.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006134.g004</object-id>
<label>Fig 4</label>
<caption>
<title>The three Delphi systems had similar overall scores; Delphi-Stat gave the best distributional forecasts overall, while Delphi-Epicast gave the best point predictions overall.</title>
<p>These bar plots contain evaluations for the 2015/2016 season, averaged across 11 locations and 29 forecast weeks, for each target and evaluation metrics. Shorter bars indicate better performance. Each entry for a specific target is an average of 319 evaluations, giving a total of 2233 evaluations overall for each system. This figure’s data is shown in tabular form in <xref ref-type="supplementary-material" rid="pcbi.1006134.s014">S2 Appendix</xref>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.g004" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec019">
<title>Cross-validation analysis</title>
<p>Prospective forecast evaluation ensures that performance estimates are truly out-of-sample, not inflated by design decisions or model fits that are influenced by the evaluation data; however, such evaluation data is not readily generated, as it is expensive in terms of physical time: new wILI observations arrive once per week, and performance can vary significantly from season to season and from week to week. The evaluations from the 2015/2016 comparison may be noisy due to these season-to-season fluctuations. To address this issue, we use pseudo-out-of-sample retrospective analysis to provide more stable estimates of performance. Specifically, we use leave-one-season-out cross-validation: for each evaluation season <italic>s</italic>, we form and evaluate retrospective forecasts for <italic>s</italic> at every evaluation week using all training seasons except for <italic>s</italic> as inputs to the forecasting methods as if they were past seasons. (We exclude seasons prior to 2010/2011 from the evaluation set because records of HHS region ILINet data revisions are only available beginning in late 2009. We exclude seasons prior to 2003/2004 from the training set because year-round ILINet observations, which are required by some of the ensemble components, started in 2003. The 2009/2010 season—containing the peak of the 2009 pandemic according to our adjusted definition of “season”—is also removed from the training set. Finally, we do not include the season currently underway (<italic>S</italic> + 1) in evaluation or training as it has not been completely observed.) Using cross-validation prevents most direct model fitting to evaluation data, and basing design decisions on motivations other than the effects on cross-validation evaluation helps limit fitting through iterative design.</p>
<p><xref ref-type="fig" rid="pcbi.1006134.g005">Fig 5</xref> shows the distribution of log scores for several forecasting methods, described earlier in the text and in <xref ref-type="supplementary-material" rid="pcbi.1006134.s013">S1 Appendix</xref>, and the three ensemble approaches specified earlier in the text. Except for the uniform distribution and ensembles, all forecasting methods miss some possibilities completely, reporting unreasonable probabilities less than exp(−10) ≈ 0.0000454 for events that actually occurred. In these situations, the log score has been increased to the cap of −10 (as CDC does for multibin log scores). Delta and residual density forecasting methods (Delta density, Markovian; Delta density, extended; and BR, residual density) are less likely to commit these errors than other non-ensemble, non-uniform approaches, and have higher average log scores. Ensemble approaches combine forecasts of multiple components, missing fewer possibilities, and ensuring that a reasonable log score is obtained by incorporating the uniform distribution as a component. For the full Delphi-Stat ensemble, the main advantage of the ensemble over its best component appears to be successfully filling in possibilities missed by the best component with other models to avoid -10 and other low log scores appears, while for ensembles of subsets of the forecasting methods, there are other benefits; <xref ref-type="supplementary-material" rid="pcbi.1006134.s015">S3 Appendix</xref> shows the impact of these missed possibilities and the log score cap.</p>
<fig id="pcbi.1006134.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006134.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Delta and residual density methods cover more observed events and attain higher average log scores than alternatives operating on seasons as a unit; ensemble approaches can eliminate missed possibilities while retaining high confidence when justified.</title>
<p>This figure contains histograms of cross-validation log scores for a variety of forecasting methods, averaged across seasons 2010/2011 to 2015/2016, all locations, forecast weeks 40 to 20, and all forecasting targets. A solid black vertical line indicates the mean of the scores in each histogram, which we use as the primary figure of merit when comparing forecasting methods; a rough error bar for each of these mean scores is shown as a colored horizontal bar in the last panel, and as a black horizontal line at the bottom of the corresponding histogram if the error bar is wider than the thickness of the black vertical line.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.g005" xlink:type="simple"/>
</fig>
<p><xref ref-type="fig" rid="pcbi.1006134.g005">Fig 5</xref> also includes estimates of the mean log score for each method and rough error bars for these estimates. We expect there to be strong statistical dependence across evaluations for the same season and location, and weaker dependencies between different seasons and locations; thus, the most common approaches to calculating standard errors, confidence intervals, and hypothesis test results will be inappropriate. Properly accounting for such dependencies and calibrating intervals and tests is an important but difficult task and is left for future investigation. We use “rough standard error bars” on estimates of mean evaluations: first, the relevant data (e.g., all cross-validation evaluations for a particular method and evaluation metric) is summarized into one value for each season-location pair by taking the mean of all evaluations for that season-location pair; we then calculate the mean and standard error of the mean of these season-location values using standard calculations as if these values were independent. Under some additional assumptions which posit the existence of a single underlying true mean log score for each method, these individual error bars—or rough error bars for the mean difference in log scores between pairs of ethods—suggest that the observed data is unlikely to have been recorded if the true mean log score of the extended delta density method were greater than that of the adaptively weighted ensemble, or if the true mean log score of the “Empirical Bayes A” method were greater than the extended delta density method. The mean and rough standard error estimates in <xref ref-type="fig" rid="pcbi.1006134.g005">Fig 5</xref> also appear in tabular form in <xref ref-type="supplementary-material" rid="pcbi.1006134.s016">S4 Appendix</xref>.</p>
<p>Methods that model wILI trajectories and “pin” past wILI to its observed values have a large number of log scores near 0 because they are often able to confidently “forecast” many onsets and peaks that have already occurred; ensemble methods also have a large number of log scores near 0. Note that these scores are closer to 0 for ensembles that optimize weighting of different methods than for the ensemble with uniform weights. For this particular set of forecasting methods, targets, and evaluation seasons:
<list list-type="bullet"><list-item><p>the uniformly weighted ensemble has lower average log score than the best individual component (extended delta density),</p></list-item>
<list-item><p>using the stacking approach to assign weights to ensemble components improves ensemble performance significantly and gives higher average log score than the best individual component,</p></list-item>
<list-item><p>the adaptive weighting scheme does not provide a major benefit over a fixed-weight scheme using a single set of weights for each evaluation metric.</p></list-item></list></p>
<p>When given subsets of these forecasting methods as input, with regard to average performance:
<list list-type="bullet"><list-item><p>the uniformly weighted ensemble often outperforms the best individual, but is sometimes slightly (≈ 0.1 log score) worse;</p></list-item>
<list-item><p>the stacking approach improves upon the performance of the uniformly weighted ensemble; and</p></list-item>
<list-item><p>the adaptive weighting scheme’s performance is equal to or better than that of the fixed-weight scheme, sometimes improving on the log score by ≈ 0.1. The adaptive weighting scheme’s relative performance appears to improve with more input seasons, fewer ensemble components, and increased variety in underlying methodologies and component performance. These trends suggest that using wider RelevanceWeight kernels, regularizing the component weights, or considering additional data from 2003/2004 to 2009/2010, for which ground truth wILI but not weekly ILINet reports are available, may improve the performance of the adaptive weighting scheme. In addition to these avenues for possible improvement in ensemble weights for the components presented in <xref ref-type="fig" rid="pcbi.1006134.g005">Fig 5</xref>, the adaptive weighting scheme provides a natural way of incorporating forecasting methods that generate predictions for only a subset of all targets, forecast weeks, or forecast types (distributional forecast or point prediction). For example, in the 2015/2016 season, we incorporated a generalized additive model that provided point predictions (and later, distributional forecasts) for peak week and peak height given at least three weeks of observations from the current season.</p></list-item></list></p>
<p><xref ref-type="fig" rid="pcbi.1006134.g006">Fig 6</xref> shows a subset of the cross-validation data used to form the ensemble and evaluate the effectiveness of the ensemble method, for two sets of components: one using all the components of Delphi-Stat, and the other incorporating three of the lower-performance components and a uniform distribution for distributional forecasts. The Delphi-Stat ensemble near-uniformly dominates the best component, extended delta density, in terms of log score, and has comparable mean absolute error overall. The ensemble approach produces greater gains for the smaller subset of methods, surpassing not only its best components, but all forecasting methods in the wider Delphi-Stat ensemble except for the delta density approaches.</p>
<fig id="pcbi.1006134.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006134.g006</object-id>
<label>Fig 6</label>
<caption>
<title>The ensemble method matches or beats the best component overall, consistently improves log score across all times, and, for some sets of components, can provide significant improvements in both log score and mean absolute error.</title>
<p>These plots display cross-validation performance for two ensembles and some components broken down by evaluation metric, target type, and forecast week; each point is an average of cross-validation evaluations for all 11 locations, seasons 2010/2011 to 2015/2016, and all targets of the given target type; data from the appropriate ILINet reports is used as input for the left-out seasons, while finalized wILI is used for the training seasons. Top half: log score evaluations (higher is better); bottom half: mean absolute error, normalized by the standard deviation of each target (lower is better). Left side: full Delphi-Stat ensemble, which includes additional methods not listed in thelegend; right side: ensemble of the three methods listed in the legend, plus a uniform distribution component for distributional forecasts. Many components of the full ensemble are not displayed. The “Targets, uniform” method is excluded from any mean absolute error plots as it was not incorporated into the point prediction ensembles.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.g006" xlink:type="simple"/>
</fig>
<p><xref ref-type="fig" rid="pcbi.1006134.g007">Fig 7</xref> shows cross-validation performance estimates for the extended delta density method based on three evaluation schemes:
<list list-type="bullet"><list-item><p><bold>Ground truth, no nowcast</bold>: the ground truth wILI for the left-out season up to the forecast week is provided as input, resulting in an optimistic performance estimate;</p></list-item>
<list-item><p><bold>Real-time data, no nowcast</bold>: the appropriate wILI report is used for data from the left-out season, but no adjustment is made for possible updates; this performance estimate is valid, but we can improve upon the underlying method;</p></list-item>
<list-item><p><bold>Backcast, no nowcast</bold>: the appropriate wILI report is used for data from the left-out season, but we use a residual density method to “backcast” updates to this report; this performance estimate is valid, and the backcasting procedure significantly improves the log score;</p></list-item>
<list-item><p><bold>Backcast, Gaussian nowcast</bold>: same as “Backcast, no nowcast” but with another week of simulated data added to the forecast, based on a Gaussian-distributed nowcast; and</p></list-item>
<list-item><p><bold>Backcast, Student <italic>t</italic> nowcast</bold>: same as “Backcast, Gaussian nowcast” but using a Student <italic>t</italic>-distributed nowcast in place of the Gaussian nowcast.</p></list-item>
<list-item><p><bold>Backcast, ensemble nowcast</bold>: same as the previous two but using the ensemble nowcast (which combines “no nowcast” with “Student <italic>t</italic> nowcast”).</p></list-item></list></p>
<fig id="pcbi.1006134.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006134.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Using finalized data for evaluation leads to optimistic estimates of performance, particularly for seasonal targets, “backcasting” improves predictions for seasonal targets, and nowcasting can improve predictions for short-term targets.</title>
<p>Mean log score of the extended delta density method, averaged across seasons 2010/2011 to 2015/2016, all locations, all targets, and forecast weeks 40 to 20, both broken down by target and averaged across all targets (“Overall”). Rough standard error bars for the mean score for each target (or overall) appear on the right, in addition to the error bars at each epi week.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.g007" xlink:type="simple"/>
</fig>
<p>For every combination of target and forecast week, using ground truth as input rather than the appropriate version of these wILI observations produces either comparable or inflated performance estimates.</p>
<p>Using the “backcasting” method to model the difference between the ground truth and the available report helps close the gap between the update-ignorant method. The magnitude of the performance differences depends on the target and forecast week. Differences in mean scores for the short-term targets are small and may be reasonably explained by random chance alone; the largest potential difference appears to be an improvement in the “1 wk ahead” target by using backcasting. More significant differences appear in each of the seasonal targets following typical times for the corresponding onset or peak events; most of the improvement can be attributed to preventing the method from assigning inappropriately high probabilities (often 1) to events that look like they must or almost certainly will occur based on available wILI observations for past weeks, but which are ultimately not observed due to revisions of these observations. The magnitude of the mean log score improvement depends in part on the resolution of the log score bins; for example, wider bins for “Season peak percentage” may reduce the improvement in mean log score (but would also shrink the scale of all mean log scores). Similarly, the differences in scores may be reduced but not eliminated by use of multibin scores for evaluation or ensembles incorporating uniform components for forecasting.</p>
<p>Using the heavy-tailed Student <italic>t</italic> nowcasts or nowcast ensemble appears to improve on short-term forecasts without damaging performance on seasonal targets. The performance of the nowcast ensemble is further explored in <xref ref-type="supplementary-material" rid="pcbi.1006134.s005">S5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s006">S6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s007">S7</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s008">S8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s009">S9</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s010">S10</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s011">S11</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006134.s012">S12</xref> Figs. The Gaussian nowcast has a similar effect as the other nowcasters except on the “1 wk ahead” target that it directly predicts: its distribution is too thin-tailed, resulting in lower mean log scores than using the forecaster by itself on this target.</p>
</sec>
</sec>
<sec id="sec020" sec-type="conclusions">
<title>Discussion</title>
<p>Delphi-Stat forecasts submitted to the 2015/2016 comparison were based solely on wILI observations from the 2015/2016 “pre-season” (EW21–EW39) and season (EW40–EW20) and nonmechanistic models (with a majority of the ensemble weight assigned to the delta and residual density based methods). Additional data and mechanistic models dealing with categories of ILI or type and subtype of influenza, climate, digital surveillance, season-to-season patterns, spatial interaction, etc. were not incorporated. We do think that these types of data are useful, but analyzing their dynamics and effects on wILI is complicated by the fact that the smallest geographical units for which real-time wILI data is readily available for the entire US are HHS regions (on a weekly time scale). We expect that mechanistic components incorporating climate data and separating diseases, types, and subtypes will be more useful when we are able to model, forecast, and validate data at a finer geographical resolution, ideally at the metro area level. Similarly, we believe that digital surveillance data is useful; in fact, we currently use a sensor fusion framework to combine several such data sources and short-term forecasters to produce “nowcasts” for the current week [<xref ref-type="bibr" rid="pcbi.1006134.ref050">50</xref>, <xref ref-type="bibr" rid="pcbi.1006134.ref051">51</xref>], and improve the performance of forecasting methods by incorporating these nowcasts in a manner similar to the ILINet-based backcasts.</p>
<p>During development and throughout this manuscript, we have focused on (thresholded) unibin log score as a (near-)proper, simple-to-implement metric for distributional forecasts. CDC FluSight organizers, on the other hand, selected exponentiated mean thresholded multibin log scores over the entire influenza season as the evaluation metric for forecast comparisons to 1. encourage high-quality distributional predictions rather than point predictions, for better understanding of the risk of certain scenarios, 2. make the scoring metric more accessible to policymakers than unibin and non-exponentiated variants, and 3. avoid −∞ scores due to a single forecaster mistake or unmodeled data revisions. We believe that it is up to policymakers to decide whether these forecasts are ready for use in decision support at the current level of accuracy. For other potential users and forecast comparisons, we provide absolute error evaluations for all targets in 2015/2016 in <xref ref-type="fig" rid="pcbi.1006134.g004">Fig 4</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006134.s014">S2 Appendix</xref>, as well as absolute error and percent absolute error for short-term targets from cross-validation in <xref ref-type="supplementary-material" rid="pcbi.1006134.s005">S5</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s006">S6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s007">S7</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s008">S8</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s009">S9</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s010">S10</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006134.s011">S11</xref> and <xref ref-type="supplementary-material" rid="pcbi.1006134.s012">S12</xref> Figs.</p>
<sec id="sec021">
<title>Conclusion</title>
<p>The delta density forecasting method, stacking-based adaptively weighted ensemble, distributional “backcasts” of wILI updates, and nowcasts from ILI-Nearby provide significant improvements upon other individual forecasting approaches that we considered. Promising avenues for further improvements include refining the methodology to rely less on arbitrary and heuristic feature, kernel, bandwidth, and parameter selections, regularization of ensemble weights, incorporating conditional density estimators from statistical literature, and using additional data sources and finer-resolution data models.</p>
</sec>
</sec>
<sec id="sec022">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006134.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Multibin log scores for the 2015/2016 season—Averaged across 7 targets and 29 forecast weeks, broken down by location.</title>
<p>Smaller bars indicate better performance. Each bar is an average of 203 evaluations. This figure’s data is included in tabular form in <xref ref-type="supplementary-material" rid="pcbi.1006134.s014">S2 Appendix</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Multibin log scores for the 2015/2016 season—Averaged across 7 targets and 11 locations, broken down by forecast week.</title>
<p>Higher log scores indicated better performance. Each point is an average of 77 evaluations. This figure’s data is included in tabular form in <xref ref-type="supplementary-material" rid="pcbi.1006134.s014">S2 Appendix</xref>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Unibin log score of the delta density method with backcasting—Averaged across targets and locations, broken down by season and epi week.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Unibin log score of the delta density method with backcasting—Averaged across targets and seasons, broken down by location and epi week.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Mean absolute error of short-term wILI point predictions of the extended delta density method with backcasting and ensemble nowcasting, and of wILI reports—Averaged across seasons, locations, and epi weeks, broken down by timeliness of the estimates.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s006" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Empirical cumulative distribution function of the absolute error of short-term wILI point predictions of the extended delta density method with backcasting and ensemble nowcasting, and of wILI reports—Combined across seasons, locations, and epi weeks, broken down by timeliness of the estimates.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s007" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Mean absolute error of short-term wILI point predictions of the extended delta density method with backcasting and ensemble nowcasting, and of wILI reports—Averaged across seasons and epi weeks, broken down by location and timeliness of the estimates.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s008" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Empirical cumulative distribution function of the absolute error of short-term wILI point predictions of the extended delta density method with backcasting and ensemble nowcasting, and of wILI reports—Combined across seasons and epi weeks, broken down by location and timeliness of the estimates.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s009" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Mean absolute percent error of short-term wILI point predictions of the extended delta density method with backcasting and ensemble nowcasting, and of wILI reports—Averaged across seasons, locations, and epi weeks, broken down by timeliness of the estimates.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s010" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Empirical cumulative distribution function of the absolute percent error of short-term wILI point predictions of the extended delta density method with backcasting and ensemble nowcasting, and of wILI reports—Combined across seasons, locations, and epi weeks, broken down by timeliness of the estimates.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s011" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Mean absolute percent error of short-term wILI point predictions of the extended delta density method with backcasting and ensemble nowcasting, and of wILI reports—Averaged across seasons and epi weeks, broken down by location and timeliness of the estimates.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s012" xlink:type="simple">
<label>S12 Fig</label>
<caption>
<title>Empirical cumulative distribution function of the absolute percent error of short-term wILI point predictions of the extended delta density method with backcasting and ensemble nowcasting, and of wILI reports—Combined across seasons and epi weeks, broken down by location and timeliness of the estimates.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s013" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Description of all ensemble components in the 2015/2016 Delphi-Stat forecasting system.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s014" xlink:type="simple">
<label>S2 Appendix</label>
<caption>
<title>Tabular evaluations of 2015/2016 forecasts.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s015" xlink:type="simple">
<label>S3 Appendix</label>
<caption>
<title>“Missed possibilities” and -10 log score threshold.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s016" xlink:type="simple">
<label>S4 Appendix</label>
<caption>
<title>Tabular evaluations of CV forecasts.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006134.s017" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006134.s017" xlink:type="simple">
<label>S5 Appendix</label>
<caption>
<title>Log of changes to Delphi-Stat throughout the 2015/2016 season and for cross-validation analysis.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank CDC for organizing the infectious disease forecasting challenges and comparisons, and for their helpful advice, feedback, and encouragement.</p>
<p>Robert Tibshirani devised and provided an implementation of a “pinned spline” forecasting method, which evolved into the basis regression approaches presented. Shannon Gallagher constructed the generalized additive model for direct prediction of forecasting targets that was included in the 2015/2016 Delphi-Stat ensemble.</p>
<p>Robert Tibshirani, Shannon Gallagher, Daren Wang, and Zirui Wang provided helpful input and feedback during the process of devising the Delphi-Stat ensemble and nowcast analysis.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006134.ref001">
<label>1</label>
<mixed-citation publication-type="other" xlink:type="simple">World Health Organization. WHO | Influenza (Seasonal); 2016. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.who.int/mediacentre/factsheets/fs211/en/" xlink:type="simple">http://www.who.int/mediacentre/factsheets/fs211/en/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref002">
<label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Centers for Disease Control and Prevention, National Center for Immunization and Respiratory Diseases (NCIRD). Estimating Seasonal Influenza-Associated Deaths in the United States | Seasonal Influenza (Flu) |CDC; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/flu/about/disease/us_flu-related_deaths.htm" xlink:type="simple">https://www.cdc.gov/flu/about/disease/us_flu-related_deaths.htm</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thompson</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Shay</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bridges</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Burns</surname> <given-names>E</given-names></name>, <etal>et al</etal>. <article-title>Estimates of deaths associated with seasonal influenza—United States, 1976-2007</article-title>. <source>Morbidity and Mortality Weekly Report</source>. <year>2010</year>;<volume>59</volume>(<issue>33</issue>):<fpage>1057</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref004">
<label>4</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Rolfes</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Foppa</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Garg</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Flannery</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Brammer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Singleton</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <source>Estimated Influenza Illnesses, Medical Visits, Hospitalizations, and Deaths Averted by Vaccination in the United States</source>; <year>2016</year>. <ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/flu/about/disease/2015-16.htm" xlink:type="simple">https://www.cdc.gov/flu/about/disease/2015-16.htm</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref005">
<label>5</label>
<mixed-citation publication-type="other" xlink:type="simple">Centers for Disease Control and Prevention, National Center for Immunization and Respiratory Diseases (NCIRD). Pandemic Influenza | Pandemic Influenza (Flu) | CDC; 2017. <ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/flu/pandemic-resources/" xlink:type="simple">https://www.cdc.gov/flu/pandemic-resources/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref006">
<label>6</label>
<mixed-citation publication-type="other" xlink:type="simple">Centers for Disease Control and Prevention, National Center for Immunization and Respiratory Diseases (NCIRD). Pandemic Basics | Pandemic Influenza (Flu) | CDC; 2016. <ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/flu/pandemic-resources/basics/index.html" xlink:type="simple">https://www.cdc.gov/flu/pandemic-resources/basics/index.html</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref007">
<label>7</label>
<mixed-citation publication-type="other" xlink:type="simple">Centers for Disease Control and Prevention. Overview of influenza surveillance in the United States; 2013. <ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/flu/weekly/overview.htm" xlink:type="simple">https://www.cdc.gov/flu/weekly/overview.htm</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Biggerstaff</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Alper</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dredze</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fox</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Fung</surname> <given-names>ICH</given-names></name>, <name name-style="western"><surname>Hickmann</surname> <given-names>KS</given-names></name>, <etal>et al</etal>. <article-title>Results from the Centers for Disease Control and Prevention’s Predict the 2013–2014 Influenza Season Challenge</article-title>. <source>BMC Infectious Diseases</source>. <year>2016</year>;<volume>16</volume>:<fpage>357</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12879-016-1669-x" xlink:type="simple">10.1186/s12879-016-1669-x</ext-link></comment> <object-id pub-id-type="pmid">27449080</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref009">
<label>9</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Biggerstaff</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Johansson</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <source>Results from the second year of a collaborative effort to forecast influenza seasons in the United States</source>; <year>2017</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chretien</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>George</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Chitale</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>McKenzie</surname> <given-names>FE</given-names></name>. <article-title>Influenza forecasting in human populations: a scoping review</article-title>. <source>PloS one</source>. <year>2014</year>;<volume>9</volume>(<issue>4</issue>):<fpage>e94130</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0094130" xlink:type="simple">10.1371/journal.pone.0094130</ext-link></comment> <object-id pub-id-type="pmid">24714027</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nsoesie</surname> <given-names>EO</given-names></name>, <name name-style="western"><surname>Brownstein</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Ramakrishnan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Marathe</surname> <given-names>MV</given-names></name>. <article-title>A systematic review of studies on forecasting the dynamics of influenza outbreaks</article-title>. <source>Influenza and other respiratory viruses</source>. <year>2014</year>;<volume>8</volume>(<issue>3</issue>):<fpage>309</fpage>–<lpage>316</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/irv.12226" xlink:type="simple">10.1111/irv.12226</ext-link></comment> <object-id pub-id-type="pmid">24373466</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Unkel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Farrington</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Garthwaite</surname> <given-names>PH</given-names></name>, <name name-style="western"><surname>Robertson</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Andrews</surname> <given-names>N</given-names></name>. <article-title>Statistical methods for the prospective detection of infectious disease outbreaks: a review</article-title>. <source>Journal of the Royal Statistical Society: Series A (Statistics in Society)</source>. <year>2012</year>;<volume>175</volume>(<issue>1</issue>):<fpage>49</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.1467-985X.2011.00714.x" xlink:type="simple">10.1111/j.1467-985X.2011.00714.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>. <article-title>Forecasting seasonal outbreaks of influenza</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>50</issue>):<fpage>20425</fpage>–<lpage>20430</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1208772109" xlink:type="simple">10.1073/pnas.1208772109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Tamerius</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>. <article-title>Real-time influenza forecasts during the 2012–2013 season</article-title>. <source>Nature communications</source>. <year>2013</year>;<volume>4</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms3837" xlink:type="simple">10.1038/ncomms3837</ext-link></comment> <object-id pub-id-type="pmid">24302074</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hickmann</surname> <given-names>KS</given-names></name>, <name name-style="western"><surname>Fairchild</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Priedhorsky</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Generous</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Hyman</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Deshpande</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title>Forecasting the 2013–2014 Influenza Season Using Wikipedia</article-title>. <source>PLOS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>5</issue>):<fpage>e1004239</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004239" xlink:type="simple">10.1371/journal.pcbi.1004239</ext-link></comment> <object-id pub-id-type="pmid">25974758</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref016">
<label>16</label>
<mixed-citation publication-type="other" xlink:type="simple">Zhang Q, Perra N, Perrotta D, Tizzoni M, Paolotti D, Vespignani A. Forecasting seasonal influenza fusing digital indicators and a mechanistic disease model. In: Proceedings of the 26th International Conference on World Wide Web. International World Wide Web Conferences Steering Committee; 2017. p. 311–319.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kandula</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>. <article-title>Type-and Subtype-Specific Influenza Forecast</article-title>. <source>American journal of epidemiology</source>. <year>2017</year>; p. <fpage>1</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref018">
<label>18</label>
<mixed-citation publication-type="other" xlink:type="simple">Deodhar S, Chen J, Wilson M, Soundarapandian M, Bisset K, Lewis B, et al. Flu Caster: A Pervasive Web Application for High Resolution Situation Assessment and Forecasting of Flu Outbreaks. In: Healthcare Informatics (ICHI), 2015 International Conference on. IEEE; 2015. p. 105–114.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Viboud</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Boëlle</surname> <given-names>PY</given-names></name>, <name name-style="western"><surname>Carrat</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Valleron</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Flahault</surname> <given-names>A</given-names></name>. <article-title>Prediction of the spread of influenza epidemics by the method of analogues</article-title>. <source>American Journal of Epidemiology</source>. <year>2003</year>;<volume>158</volume>(<issue>10</issue>):<fpage>996</fpage>–<lpage>1006</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/aje/kwg239" xlink:type="simple">10.1093/aje/kwg239</ext-link></comment> <object-id pub-id-type="pmid">14607808</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref020">
<label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">Chakraborty P, Khadivi P, Lewis B, Mahendiran A, Chen J, Butler P, et al. Forecasting a moving target: Ensemble models for ILI case count predictions. In: Proceedings of the 2014 SIAM international conference on data mining. SIAM; 2014. p. 262–270.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Brooks</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Farrow</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Hyun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Rosenfeld</surname> <given-names>R</given-names></name>. <article-title>Flexible modeling of epidemics with an empirical Bayes framework</article-title>. <source>PLoS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>8</issue>):<fpage>e1004382</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004382" xlink:type="simple">10.1371/journal.pcbi.1004382</ext-link></comment> <object-id pub-id-type="pmid">26317693</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref022">
<label>22</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Ray</surname> <given-names>EL</given-names></name>, <name name-style="western"><surname>Sakrejda</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Lauer</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>Johansson</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>NG</given-names></name>. <source>Infectious disease prediction with kernel conditional density estimation</source>; Accessed 2017-05-02. <ext-link ext-link-type="uri" xlink:href="https://github.com/reichlab/article-disease-pred-with-kcde/raw/master/inst/article/infectious-disease-prediction-with-kcde.pdf" xlink:type="simple">https://github.com/reichlab/article-disease-pred-with-kcde/raw/master/inst/article/infectious-disease-prediction-with-kcde.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paul</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Dredze</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Broniatowski</surname> <given-names>D</given-names></name>. <article-title>Twitter improves influenza forecasting</article-title>. <source>PLOS Currents Outbreaks</source>. <year>2014</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/currents.outbreaks.90b9ed0f59bae4ccaa683a39865d9117" xlink:type="simple">10.1371/currents.outbreaks.90b9ed0f59bae4ccaa683a39865d9117</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref024">
<label>24</label>
<mixed-citation publication-type="other" xlink:type="simple">Höhle M, Meyer S, Paul M. surveillance: Temporal and Spatio-Temporal Modeling and Monitoring of Epidemic Phenomena; 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=surveillance" xlink:type="simple">https://CRAN.R-project.org/package=surveillance</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Martinez</surname> <given-names>EZ</given-names></name>, <name name-style="western"><surname>Silva</surname> <given-names>EASd</given-names></name>, <name name-style="western"><surname>Fabbro</surname> <given-names>ALD</given-names></name>. <article-title>A SARIMA forecasting model to predict the number of cases of dengue in Campinas, State of São Paulo, Brazil</article-title>. <source>Revista da Sociedade Brasileira de Medicina Tropical</source>. <year>2011</year>;<volume>44</volume>(<issue>4</issue>):<fpage>436</fpage>–<lpage>440</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1590/S0037-86822011000400007" xlink:type="simple">10.1590/S0037-86822011000400007</ext-link></comment> <object-id pub-id-type="pmid">21860888</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lowe</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Bailey</surname> <given-names>TC</given-names></name>, <name name-style="western"><surname>Stephenson</surname> <given-names>DB</given-names></name>, <name name-style="western"><surname>Jupp</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Graham</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Barcellos</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>The development of an early warning system for climate-sensitive disease risk with a focus on dengue epidemics in Southeast Brazil</article-title>. <source>Statistics in medicine</source>. <year>2013</year>;<volume>32</volume>(<issue>5</issue>):<fpage>864</fpage>–<lpage>883</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1002/sim.5549" xlink:type="simple">10.1002/sim.5549</ext-link></comment> <object-id pub-id-type="pmid">22927252</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lampos</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Crossan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stefansen</surname> <given-names>C</given-names></name>. <article-title>Advances in nowcasting influenza-like illness rates using search query logs</article-title>. <source>Scientific Reports</source>. <year>2015</year>;<volume>5</volume>:<fpage>12760</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep12760" xlink:type="simple">10.1038/srep12760</ext-link></comment> <object-id pub-id-type="pmid">26234783</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Santillana</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kou</surname> <given-names>SC</given-names></name>. <article-title>Accurate estimation of influenza epidemics using Google search data via ARGO</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2015</year>;<volume>112</volume>(<issue>47</issue>):<fpage>14473</fpage>–<lpage>14478</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1515373112" xlink:type="simple">10.1073/pnas.1515373112</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yang</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Santillana</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Brownstein</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Gray</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Richardson</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Kou</surname> <given-names>SC</given-names></name>. <article-title>Using electronic health records and Internet search information for accurate influenza forecasting</article-title>. <source>BMC Infectious Diseases</source>. <year>2017</year>;<volume>17</volume>:<fpage>332</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s12879-017-2424-7" xlink:type="simple">10.1186/s12879-017-2424-7</ext-link></comment> <object-id pub-id-type="pmid">28482810</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Johansson</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Reich</surname> <given-names>NG</given-names></name>, <name name-style="western"><surname>Hota</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Brownstein</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Santillana</surname> <given-names>M</given-names></name>. <article-title>Evaluating the performance of infectious disease forecasts: A comparison of climate-driven and seasonal dengue forecasts for Mexico</article-title>. <source>Scientific Reports</source>. <year>2016</year>;<volume>6</volume>:<fpage>33707</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/srep33707" xlink:type="simple">10.1038/srep33707</ext-link></comment> <object-id pub-id-type="pmid">27665707</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Generous</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Fairchild</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Deshpande</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Valle</surname> <given-names>SYD</given-names></name>, <name name-style="western"><surname>Priedhorsky</surname> <given-names>R</given-names></name>. <article-title>Global Disease Monitoring and Forecasting with Wikipedia</article-title>. <source>PLOS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>11</issue>):<fpage>e1003892</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003892" xlink:type="simple">10.1371/journal.pcbi.1003892</ext-link></comment> <object-id pub-id-type="pmid">25392913</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Panhuis</surname> <given-names>WG</given-names></name>, <name name-style="western"><surname>Hyun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Blaney</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Marques</surname> <given-names>ET</given-names> <suffix>Jr</suffix></name>, <name name-style="western"><surname>Coelho</surname> <given-names>GE</given-names></name>, <name name-style="western"><surname>Siqueira</surname> <given-names>JB</given-names> <suffix>Jr</suffix></name>, <etal>et al</etal>. <article-title>Risk of dengue for tourists and teams during the World Cup 2014 in Brazil</article-title>. <source>PLoS Negl Trop Dis</source>. <year>2014</year>;<volume>8</volume>(<issue>7</issue>):<fpage>e3063</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pntd.0003063" xlink:type="simple">10.1371/journal.pntd.0003063</ext-link></comment> <object-id pub-id-type="pmid">25079960</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref033">
<label>33</label>
<mixed-citation publication-type="other" xlink:type="simple">US Department of Commerce N. Dengue Forecasting; Accessed 2017-05-02. <ext-link ext-link-type="uri" xlink:href="http://dengueforecasting.noaa.gov/" xlink:type="simple">http://dengueforecasting.noaa.gov/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wolpert</surname> <given-names>DH</given-names></name>. <article-title>Stacked generalization</article-title>. <source>Neural networks</source>. <year>1992</year>;<volume>5</volume>(<issue>2</issue>):<fpage>241</fpage>–<lpage>259</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0893-6080(05)80023-1" xlink:type="simple">10.1016/S0893-6080(05)80023-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Breiman</surname> <given-names>L</given-names></name>. <article-title>Stacked regressions</article-title>. <source>Machine learning</source>. <year>1996</year>;<volume>24</volume>(<issue>1</issue>):<fpage>49</fpage>–<lpage>64</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yamana</surname> <given-names>TK</given-names></name>, <name name-style="western"><surname>Kandula</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>. <article-title>Superensemble forecasts of dengue outbreaks</article-title>. <source>Journal of The Royal Society Interface</source>. <year>2016</year>;<volume>13</volume>(<issue>123</issue>):<fpage>20160410</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsif.2016.0410" xlink:type="simple">10.1098/rsif.2016.0410</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref037">
<label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Ray EL, Reich NG. Prediction of infectious disease epidemics via weighted density ensembles. arXiv preprint arXiv:170310936. 2017;.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leung</surname> <given-names>NH</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ip</surname> <given-names>DK</given-names></name>, <name name-style="western"><surname>Cowling</surname> <given-names>BJ</given-names></name>. <source>Review Article: The Fraction of Influenza Virus Infections That Are Asymptomatic: A Systematic Review and Meta-analysis</source>.; <year>2015</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hayward</surname> <given-names>AC</given-names></name>, <name name-style="western"><surname>Fragaszy</surname> <given-names>EB</given-names></name>, <name name-style="western"><surname>Bermingham</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Copas</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Edmunds</surname> <given-names>WJ</given-names></name>, <etal>et al</etal>. <article-title>Comparative community burden and severity of seasonal and pandemic influenza: results of the Flu Watch cohort study</article-title>. <source>The Lancet Respiratory Medicine</source>. <year>2014</year>;<volume>2</volume>(<issue>6</issue>):<fpage>445</fpage>–<lpage>454</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S2213-2600(14)70034-7" xlink:type="simple">10.1016/S2213-2600(14)70034-7</ext-link></comment> <object-id pub-id-type="pmid">24717637</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref040">
<label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Brammer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Budd</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Finelli</surname> <given-names>L</given-names></name>. 12. In: <source>Seasonal and pandemic influenza surveillance</source>. <publisher-name>John Wiley &amp; Sons Ltd;</publisher-name> 2013. p. <fpage>200</fpage>–<lpage>210</lpage>. <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/9781118543504.ch16" xlink:type="simple">http://dx.doi.org/10.1002/9781118543504.ch16</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref041">
<label>41</label>
<mixed-citation publication-type="other" xlink:type="simple">Centers for Disease Control and Prevention, National Center for Immunization and Respiratory Diseases (NCIRD). FluView Interactive | Seasonal Influenza (Flu) | CDC; 2017. <ext-link ext-link-type="uri" xlink:href="https://www.cdc.gov/flu/weekly/fluviewinteractive.htm" xlink:type="simple">https://www.cdc.gov/flu/weekly/fluviewinteractive.htm</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref042">
<label>42</label>
<mixed-citation publication-type="other" xlink:type="simple">The Delphi Group at Carnegie Mellon University. The Delphi Epidemiological Data API; Accessed 2017-04-26. <ext-link ext-link-type="uri" xlink:href="https://github.com/cmu-delphi/delphi-epidata" xlink:type="simple">https://github.com/cmu-delphi/delphi-epidata</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref043">
<label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Farrow DC. EpiVis; Accessed 2017-04-26. <ext-link ext-link-type="uri" xlink:href="http://delphi.midas.cs.cmu.edu/epivis/epivis.html" xlink:type="simple">http://delphi.midas.cs.cmu.edu/epivis/epivis.html</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hendrickson</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Buehler</surname> <given-names>RJ</given-names></name>. <article-title>Proper scores for probability forecasters</article-title>. <source>The Annals of Mathematical Statistics</source>. <year>1971</year>; p. <fpage>1916</fpage>–<lpage>1921</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1214/aoms/1177693057" xlink:type="simple">10.1214/aoms/1177693057</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref045">
<label>45</label>
<mixed-citation publication-type="other" xlink:type="simple">Epidemic Prediction Initiative. Forecast Evaluation; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="https://predict.phiresearchlab.org/legacy/flu/evaluation.html" xlink:type="simple">https://predict.phiresearchlab.org/legacy/flu/evaluation.html</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref046">
<label>46</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>R Core Team</collab>. <source>R: A Language and Environment for Statistical Computing</source>; <year>2015</year>. <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/" xlink:type="simple">https://www.R-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Jovanovic</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Levy</surname> <given-names>PS</given-names></name>. <article-title>A look at the rule of three</article-title>. <source>The American Statistician</source>. <year>1997</year>;<volume>51</volume>(<issue>2</issue>):<fpage>137</fpage>–<lpage>139</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/00031305.1997.10473947" xlink:type="simple">10.1080/00031305.1997.10473947</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref048">
<label>48</label>
<mixed-citation publication-type="other" xlink:type="simple">Rosenfeld R. The “degenerate EM” algorithm for finding optimal linear interpolation coefficients λ<sub><italic>i</italic></sub>; Accessed 2017-03-21. <ext-link ext-link-type="uri" xlink:href="http://www.cs.cmu.edu/~roni/11761/Presentations/degenerateEM.pdf" xlink:type="simple">http://www.cs.cmu.edu/~roni/11761/Presentations/degenerateEM.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref049">
<label>49</label>
<mixed-citation publication-type="other" xlink:type="simple">Berkelaar M, others. lpSolve: Interface to ‘Lp_solve’ v. 5.5 to Solve Linear/Integer Programs; 2015. <ext-link ext-link-type="uri" xlink:href="http://CRAN.R-project.org/package=lpSolve" xlink:type="simple">http://CRAN.R-project.org/package=lpSolve</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref050">
<label>50</label>
<mixed-citation publication-type="other" xlink:type="simple">Farrow DC. Modeling the Past, Present, and Future of Influenza [PhD Thesis]. Carnegie Mellon University; 2016. Available from: <ext-link ext-link-type="uri" xlink:href="http://reports-archive.adm.cs.cmu.edu/anon/cbd/CMU-CB-16-101.pdf" xlink:type="simple">http://reports-archive.adm.cs.cmu.edu/anon/cbd/CMU-CB-16-101.pdf</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref051">
<label>51</label>
<mixed-citation publication-type="other" xlink:type="simple">Farrow DC, Rosenfeld R. Multiple Resolution Nowcasting of Influenza through Sensor Fusion; 2018. <italic>Manuscript in preparation</italic>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Soebiyanto</surname> <given-names>RP</given-names></name>, <name name-style="western"><surname>Adimi</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Kiang</surname> <given-names>RK</given-names></name>. <article-title>Modeling and Predicting Seasonal Influenza Transmission in Warm Regions Using Climatological Parameters</article-title>. <source>PLOS ONE</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>e9450</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0009450" xlink:type="simple">10.1371/journal.pone.0009450</ext-link></comment> <object-id pub-id-type="pmid">20209164</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>. <article-title>Forecasting seasonal outbreaks of influenza</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>50</issue>):<fpage>20425</fpage>–<lpage>20430</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1208772109" xlink:type="simple">10.1073/pnas.1208772109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shaman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karspeck</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Tamerius</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lipsitch</surname> <given-names>M</given-names></name>. <article-title>Real-time influenza forecasts during the 2012–2013 season</article-title>. <source>Nature Communications</source>. <year>2013</year>;<volume>4</volume>:<fpage>2837</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms3837" xlink:type="simple">10.1038/ncomms3837</ext-link></comment> <object-id pub-id-type="pmid">24302074</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Eysenbach</surname> <given-names>G</given-names></name>. <article-title>Infodemiology: Tracking Flu-Related Searches on the Web for Syndromic Surveillance</article-title>. <source>AMIA Annual Symposium Proceedings</source>. <year>2006</year>;<volume>2006</volume>:<fpage>244</fpage>–<lpage>248</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Polgreen</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Pennock</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>FD</given-names></name>, <name name-style="western"><surname>Weinstein</surname> <given-names>RA</given-names></name>. <article-title>Using Internet Searches for Influenza Surveillance</article-title>. <source>Clinical Infectious Diseases</source>. <year>2008</year>;<volume>47</volume>(<issue>11</issue>):<fpage>1443</fpage>–<lpage>1448</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1086/593098" xlink:type="simple">10.1086/593098</ext-link></comment> <object-id pub-id-type="pmid">18954267</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hulth</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Rydevik</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Linde</surname> <given-names>A</given-names></name>. <article-title>Web Queries as a Source for Syndromic Surveillance</article-title>. <source>PLOS ONE</source>. <year>2009</year>;<volume>4</volume>(<issue>2</issue>):<fpage>e4378</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0004378" xlink:type="simple">10.1371/journal.pone.0004378</ext-link></comment> <object-id pub-id-type="pmid">19197389</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ginsberg</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mohebbi</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Patel</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Brammer</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Smolinski</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Brilliant</surname> <given-names>L</given-names></name>. <article-title>Detecting influenza epidemics using search engine query data</article-title>. <source>Nature</source>. <year>2009</year>;<volume>457</volume>(<issue>7232</issue>):<fpage>1012</fpage>–<lpage>1014</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature07634" xlink:type="simple">10.1038/nature07634</ext-link></comment> <object-id pub-id-type="pmid">19020500</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dugas</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Jalalpour</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gel</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Levin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Torcaso</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Igusa</surname> <given-names>T</given-names></name>, <etal>et al</etal>. <article-title>Influenza Forecasting with Google Flu Trends</article-title>. <source>PLOS ONE</source>. <year>2013</year>;<volume>8</volume>(<issue>2</issue>):<fpage>e56176</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0056176" xlink:type="simple">10.1371/journal.pone.0056176</ext-link></comment> <object-id pub-id-type="pmid">23457520</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Araz</surname> <given-names>OM</given-names></name>, <name name-style="western"><surname>Bentley</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Muelleman</surname> <given-names>RL</given-names></name>. <article-title>Using Google Flu Trends data in forecasting influenza-like–illness related ED visits in Omaha, Nebraska</article-title>. <source>The American Journal of Emergency Medicine</source>. <year>2014</year>;<volume>32</volume>(<issue>9</issue>):<fpage>1016</fpage>–<lpage>1023</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajem.2014.05.052" xlink:type="simple">10.1016/j.ajem.2014.05.052</ext-link></comment> <object-id pub-id-type="pmid">25037278</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref061">
<label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Santillana</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>DW</given-names></name>, <name name-style="western"><surname>Althouse</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Ayers</surname> <given-names>JW</given-names></name>. <article-title>What Can Digital Disease Detection Learn from (an External Revision to) Google Flu Trends?</article-title> <source>American Journal of Preventive Medicine</source>. <year>2014</year>;<volume>47</volume>(<issue>3</issue>):<fpage>341</fpage>–<lpage>347</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.amepre.2014.05.020" xlink:type="simple">10.1016/j.amepre.2014.05.020</ext-link></comment> <object-id pub-id-type="pmid">24997572</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Preis</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Moat</surname> <given-names>HS</given-names></name>. <article-title>Adaptive nowcasting of influenza outbreaks using Google searches</article-title>. <source>Royal Society Open Science</source>. <year>2014</year>;<volume>1</volume>(<issue>2</issue>):<fpage>140095</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rsos.140095" xlink:type="simple">10.1098/rsos.140095</ext-link></comment> <object-id pub-id-type="pmid">26064532</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref063">
<label>63</label>
<mixed-citation publication-type="other" xlink:type="simple">Ritterman J, Osborne M, Klein E. Using prediction markets and Twitter to predict a swine flu pandemic. In: Proceedings of the 1st International Workshop on Mining Social Media. vol. 9; 2009. p. 9–17.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref064">
<label>64</label>
<mixed-citation publication-type="other" xlink:type="simple">Culotta A. Towards Detecting Influenza Epidemics by Analyzing Twitter Messages. In: Proceedings of the First Workshop on Social Media Analytics. SOMA’10. New York, NY, USA: ACM; 2010. p. 115–122. <ext-link ext-link-type="uri" xlink:href="http://doi.acm.org/10.1145/1964858.1964874" xlink:type="simple">http://doi.acm.org/10.1145/1964858.1964874</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Signorini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Segre</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Polgreen</surname> <given-names>PM</given-names></name>. <article-title>The Use of Twitter to Track Levels of Disease Activity and Public Concern in the U.S. during the Influenza A H1N1 Pandemic</article-title>. <source>PLOS ONE</source>. <year>2011</year>;<volume>6</volume>(<issue>5</issue>):<fpage>e19467</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0019467" xlink:type="simple">10.1371/journal.pone.0019467</ext-link></comment> <object-id pub-id-type="pmid">21573238</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref066">
<label>66</label>
<mixed-citation publication-type="other" xlink:type="simple">Achrekar H, Gandhe A, Lazarus R, Yu SH, Liu B. Predicting Flu Trends using Twitter data. In: 2011 IEEE Conference on Computer Communications Workshops (INFOCOM WKSHPS); 2011. p. 702–707.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Broniatowski</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Paul</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Dredze</surname> <given-names>M</given-names></name>. <article-title>National and Local Influenza Surveillance through Twitter: An Analysis of the 2012-2013 Influenza Epidemic</article-title>. <source>PLOS ONE</source>. <year>2013</year>;<volume>8</volume>(<issue>12</issue>):<fpage>e83672</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0083672" xlink:type="simple">10.1371/journal.pone.0083672</ext-link></comment> <object-id pub-id-type="pmid">24349542</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paul</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Dredze</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Broniatowski</surname> <given-names>D</given-names></name>. <article-title>Twitter Improves Influenza Forecasting</article-title>. <source>PLoS Currents</source>. <year>2014</year>;<volume>6</volume>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McIver</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Brownstein</surname> <given-names>JS</given-names></name>. <article-title>Wikipedia Usage Estimates Prevalence of Influenza-Like Illness in the United States in Near Real-Time</article-title>. <source>PLOS Computational Biology</source>. <year>2014</year>;<volume>10</volume>(<issue>4</issue>):<fpage>e1003581</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003581" xlink:type="simple">10.1371/journal.pcbi.1003581</ext-link></comment> <object-id pub-id-type="pmid">24743682</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref070">
<label>70</label>
<mixed-citation publication-type="other" xlink:type="simple">Dredze M, Cheng R, Paul MJ, Broniatowski D. HealthTweets.org: A Platform for Public Health Surveillance Using Twitter. In: Workshops at the Twenty-Eighth AAAI Conference on Artificial Intelligence; 2014. p. 593–596. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.aaai.org/ocs/index.php/WS/AAAIW14/paper/view/8723" xlink:type="simple">https://www.aaai.org/ocs/index.php/WS/AAAIW14/paper/view/8723</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Santillana</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Nguyen</surname> <given-names>AT</given-names></name>, <name name-style="western"><surname>Dredze</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Paul</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Nsoesie</surname> <given-names>EO</given-names></name>, <name name-style="western"><surname>Brownstein</surname> <given-names>JS</given-names></name>. <article-title>Combining Search, Social Media, and Traditional Data Sources to Improve Influenza Surveillance</article-title>. <source>PLOS Computational Biology</source>. <year>2015</year>;<volume>11</volume>(<issue>10</issue>):<fpage>e1004513</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1004513" xlink:type="simple">10.1371/journal.pcbi.1004513</ext-link></comment> <object-id pub-id-type="pmid">26513245</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Farrow</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Brooks</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Hyun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Burke</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Rosenfeld</surname> <given-names>R</given-names></name>. <article-title>A human judgment approach to epidemiological forecasting</article-title>. <source>PLOS Computational Biology</source>. <year>2017</year>;<volume>13</volume>(<issue>3</issue>):<fpage>e1005248</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005248" xlink:type="simple">10.1371/journal.pcbi.1005248</ext-link></comment> <object-id pub-id-type="pmid">28282375</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006134.ref073">
<label>73</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Van Rossum</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Drake</surname> <given-names>FL</given-names></name>. <chapter-title>Python language reference manual</chapter-title>. <source>Network Theory</source>; <year>2003</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref074">
<label>74</label>
<mixed-citation publication-type="other" xlink:type="simple">Reichek K, Gao L. CMU Delphi forecasts; Accessed 2017-04-26. <ext-link ext-link-type="uri" xlink:href="http://delphi.midas.cs.cmu.edu/forecast/" xlink:type="simple">http://delphi.midas.cs.cmu.edu/forecast/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref075">
<label>75</label>
<mixed-citation publication-type="other" xlink:type="simple">Carnegie Mellon University Delphi group. Delphi; Accessed 2017-04-26. <ext-link ext-link-type="uri" xlink:href="https://github.com/cmu-delphi" xlink:type="simple">https://github.com/cmu-delphi</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006134.ref076">
<label>76</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Brooks</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Farrow</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Hyun</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Rosenfeld</surname> <given-names>R</given-names></name>. <source>epiforecast: Tools for forecasting semi-regular seasonal epidemic curves and similar time series</source>; <year>2015</year>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>