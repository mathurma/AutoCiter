<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1005294</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-16-00859</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence alignment</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Computational techniques</subject><subj-group><subject>Split-decomposition method</subject><subj-group><subject>Multiple alignment calculation</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Markov models</subject><subj-group><subject>Hidden Markov models</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Salt bridges</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Electrochemistry</subject><subj-group><subject>Salt bridges</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Molecular biology</subject><subj-group><subject>Macromolecular structure analysis</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Protein structure</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Chemical compounds</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Amino acids</subject><subj-group><subject>Basic amino acids</subject><subj-group><subject>Arginine</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Chemistry</subject><subj-group><subject>Organic chemistry</subject><subj-group><subject>Organic compounds</subject><subj-group><subject>Amino acids</subject><subj-group><subject>Basic amino acids</subject><subj-group><subject>Arginine</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Proteins</subject><subj-group><subject>Amino acids</subject><subj-group><subject>Basic amino acids</subject><subj-group><subject>Arginine</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Biological databases</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject><subj-group><subject>Sequence databases</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Database and informatics methods</subject><subj-group><subject>Bioinformatics</subject><subj-group><subject>Sequence analysis</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Inference of Functionally-Relevant N-acetyltransferase Residues Based on Statistical Correlations</article-title>
<alt-title alt-title-type="running-head">Predicting Functionally-Relevant N-acetyltransferase Residues</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Neuwald</surname>
<given-names>Andrew F.</given-names>
</name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-2120-9631</contrib-id>
<name name-style="western">
<surname>Altschul</surname>
<given-names>Stephen F.</given-names>
</name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Institute for Genome Sciences and Department of Biochemistry &amp; Molecular Biology, University of Maryland School of Medicine, BioPark II, Room 617, Baltimore, MD, United States of America</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>National Center for Biotechnology Information, National Library of Medicine, National Institutes of Health, Bethesda, MD, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Punta</surname>
<given-names>Marco</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Center for Cancer Research, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con">
<p><list list-type="simple"> <list-item><p><bold>Conceptualization:</bold> AFN.</p></list-item> <list-item><p><bold>Formal analysis:</bold> AFN SFA.</p></list-item> <list-item><p><bold>Investigation:</bold> AFN.</p></list-item> <list-item><p><bold>Methodology:</bold> AFN SFA.</p></list-item> <list-item><p><bold>Project administration:</bold> AFN.</p></list-item> <list-item><p><bold>Software:</bold> AFN.</p></list-item> <list-item><p><bold>Validation:</bold> AFN.</p></list-item> <list-item><p><bold>Visualization:</bold> AFN.</p></list-item> <list-item><p><bold>Writing – original draft:</bold> AFN.</p></list-item> <list-item><p><bold>Writing – review &amp; editing:</bold> AFN SFA.</p></list-item></list>
</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">aneuwald@som.umaryland.edu</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>21</day>
<month>12</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="collection">
<month>12</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>12</issue>
<elocation-id>e1005294</elocation-id>
<history>
<date date-type="received">
<day>27</day>
<month>5</month>
<year>2016</year>
</date>
<date date-type="accepted">
<day>8</day>
<month>12</month>
<year>2016</year>
</date>
</history>
<permissions>
<license xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">
<license-p>This is an open access article, free of all copyright, and may be freely reproduced, distributed, transmitted, modified, built upon, or otherwise used by anyone for any lawful purpose. The work is made available under the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/publicdomain/zero/1.0/" xlink:type="simple">Creative Commons CC0</ext-link> public domain dedication.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1005294"/>
<abstract>
<p>Over evolutionary time, members of a superfamily of homologous proteins sharing a common structural core diverge into subgroups filling various functional niches. At the sequence level, such divergence appears as correlations that arise from residue patterns distinct to each subgroup. Such a superfamily may be viewed as a population of sequences corresponding to a complex, high-dimensional probability distribution. Here we model this distribution as hierarchical interrelated hidden Markov models (hiHMMs), which describe these sequence correlations implicitly. By characterizing such correlations one may hope to obtain information regarding functionally-relevant properties that have thus far evaded detection. To do so, we infer a hiHMM distribution from sequence data using Bayes’ theorem and <bold>Markov chain Monte Carlo (MCMC)</bold> sampling, which is widely recognized as the most effective approach for characterizing a complex, high dimensional distribution. Other routines then map correlated residue patterns to available structures with a view to hypothesis generation. When applied to N-acetyltransferases, this reveals sequence and structural features indicative of functionally important, yet generally unknown biochemical properties. Even for sets of proteins for which nothing is known beyond unannotated sequences and structures, this can lead to helpful insights. We describe, for example, a putative coenzyme-A-induced-fit substrate binding mechanism mediated by arginine residue switching between salt bridge and π-π stacking interactions. A suite of programs implementing this approach is available (<ext-link ext-link-type="uri" xlink:href="http://psed.igs.umaryland.edu" xlink:type="simple">psed.igs.umaryland.edu</ext-link>).</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Protein sequence data, when gathered in great quantity, contain important but implicit biological information manifest as statistical correlations. Here we describe an approach to access this information by comprehensively modeling and characterizing the distribution of sequences belonging to a major protein superfamily. This approach takes as input a large set of unaligned sequences belonging to the superfamily. By applying the minimum description length principle, it seeks the statistical model that best explains the sequences while avoiding over-fitting the data. It concurrently aligns the sequences and, to model evolutionary divergence, partitions them into subgroups that are hierarchically-arranged based upon correlated residue patterns. Auxiliary routines create PyMOL scripts to visualize the locations of correlated residues within available structures. Because these correlations likely arise from structural and biochemical constraints, they can help elucidate protein properties important for functional specificity. Comparing and contrasting sequence and structural features in this way may therefore suggest, in the light of published studies, plausible biological hypotheses for experimental investigation. We illustrate this approach with N-acetyltransferases.</p>
</abstract>
<funding-group>
<funding-statement>SFA was supported by the Intramural Research Program of the National Institutes of Health, National Library of Medicine. AFN received no specific funding for this work. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="8"/>
<table-count count="0"/>
<page-count count="30"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2017-01-10</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files or at <ext-link ext-link-type="uri" xlink:href="http://psed.igs.umaryland.edu" xlink:type="simple">psed.igs.umaryland.edu</ext-link>.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Mendel used statistics to infer the existence of genes [<xref ref-type="bibr" rid="pcbi.1005294.ref001">1</xref>], and other early geneticists to infer their linear arrangement when not independently assorted, thereby recognizing biological phenomena whose precise physical nature was illuminated only later. Statistics can continue to play an important role in biological discovery. Specific residues within homologous proteins are often conserved over long evolutionary time and across diverse organisms. For instance, putative orthologs of the NatA N-acetyltransferase catalytic subunit Naa10 from human (<bold><xref ref-type="fig" rid="pcbi.1005294.g001">Fig 1</xref></bold>) [<xref ref-type="bibr" rid="pcbi.1005294.ref002">2</xref>] contain many invariant or highly-conserved residues; indeed, natural selection has sometimes eliminated even the rearrangement of a side-chain methyl group or the removal of a hydroxyl group. Such conservation implies the participation of these protein residue positions in biologically critical functions or interactions. The steric or chemical constraints giving rise to this conservation are sometimes understood, but often the conservation remains unexplained, implying protein properties and functions that are still to be discovered. Moreover, many residues are conserved across different acetyltransferase families, which are associated with distinct cellular complexes, and which vary widely in their localization, turnover, inter-protein interactions and binding kinetics. Hence the roles of these residues presumably transcend functions specific to individual families and instead may involve multi-purpose mechanisms or interactions shared by otherwise functionally-distinct proteins. Similar comments also apply to many other protein superfamilies—defined as homologous proteins sharing detectable (albeit possibly very subtle) sequence similarity and a common core structure.</p>
<fig id="pcbi.1005294.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005294.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Residues, mostly of unknown function, that are highly conserved in putative orthologs of human Naa10 acetylase from metazoans (phyla indicated in red), fungi (brown), protozoans (cyan), and plants (green).</title>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.g001" xlink:type="simple"/>
</fig>
<sec id="sec002">
<title>Protein statistical inferences</title>
<p>Just as one may infer genetic information from phenotypic patterns among parents and offspring, so one may infer biochemical and structural information from patterns of amino acid conservation and divergence among related proteins. In either case, careful statistical analyses are of course essential to ensure the reliability of results, as serious errors in biomedical studies illustrate [<xref ref-type="bibr" rid="pcbi.1005294.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref004">4</xref>]. The inference of protein structural information has been illustrated recently through predictions using covariance analysis of <bold>multiple sequence alignments (MSAs)</bold> [<xref ref-type="bibr" rid="pcbi.1005294.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref007">7</xref>]. Although MSA covariance analyses had been performed previously, key breakthroughs only came through the application of more sophisticated approaches, such as Direct Coupling Analysis [<xref ref-type="bibr" rid="pcbi.1005294.ref008">8</xref>] and the pseudo-likelihood method [<xref ref-type="bibr" rid="pcbi.1005294.ref009">9</xref>]. An important contribution to DCA’s success is the avoidance of over-fitting using maximum entropy probability models [<xref ref-type="bibr" rid="pcbi.1005294.ref010">10</xref>].</p>
</sec>
<sec id="sec003">
<title>Functionally-relevant correlated residues</title>
<p>Rather than focusing on correlated residue pairs using a covariance matrix, our focus is on correlations more loosely defined as dependencies involving many residue positions. In particular, we seek to identify arbitrarily-long correlated residue patterns, which we hypothesize as due to protein functional divergence. Over evolutionary time members of a major protein superfamily diverge into subgroups, each of which fills a functional niche compatible with the common “core" structure defining the superfamily. Often a subgroup, <italic>G</italic>, is composed of smaller subgroups, each of which conserves both residues due to <italic>G</italic>’s functional constraints and other residues due to constraints imposed by its own, more specialized function. Repeated rounds of this evolutionary process have led to hierarchically-interrelated patterns of correlated residues. As a result, members of a protein superfamily tend to cluster into multiple subgroups where each subgroup tends to conserve distinctive residues at particular sequence positions. One consequence of this is that different amino acid residues may be conserved at the same positions among distinct subgroups. Our focus here is on defining, based on these residue patterns, a hierarchically nested series of multiple sequence alignments corresponding to such subgroups. Modeling correlations through the articulation of subgroups within a protein superfamily in this way provides an alternative formalism to the standard practice of using a covariance matrix to describe explicit correlations between pairs of positions (e.g., [<xref ref-type="bibr" rid="pcbi.1005294.ref005">5</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref007">7</xref>]). Note that our model does not assume any correlation between residues within a subgroup.</p>
</sec>
<sec id="sec004">
<title>The hiMSA sampler</title>
<p>Previously [<xref ref-type="bibr" rid="pcbi.1005294.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref019">19</xref>] we have used Bayesian <bold>Markov chain Monte Carlo (MCMC)</bold> sampling [<xref ref-type="bibr" rid="pcbi.1005294.ref020">20</xref>] to identify correlated residue patterns within a (static) MSA with a view to obtaining clues to underlying protein properties. This approach, termed <bold>Bayesian Partitioning with Pattern Selection (BPPS)</bold> [<xref ref-type="bibr" rid="pcbi.1005294.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref024">24</xref>], models correlated residues indirectly by hierarchically partitioning a MSA into subgroups based on residue patterns distinguishing each subgroup, <italic>G</italic>, from other subgroups comprising the next-higher-level subgroup to which <italic>G</italic> belongs. Here we extend this approach by sampling over both alignments and hierarchies—that is, over possible <bold>hierarchical interrelated MSAs (hiMSAs)</bold> and over corresponding <bold>hierarchical interrelated hidden Markov models (hiHMMs).</bold> We use simulated annealing [<xref ref-type="bibr" rid="pcbi.1005294.ref025">25</xref>] to facilitate convergence on the hiHMM most likely to have generated the input sequences; in this study, those belonging to the N-acetyltransferase superfamily. To ensure that pattern residues are due to persistent functional constraints rather than recent common descent, we focus on residues conserved across distinct phyla. We define “functional constraints” to include significant selective advantages imposed by <italic>any</italic> protein property, including catalytic and substrate-binding properties, other binding sites, folding and structural properties, and protein stability.</p>
</sec>
<sec id="sec005">
<title>FDR methods</title>
<p>Some methods align and classify protein sequences concurrently [<xref ref-type="bibr" rid="pcbi.1005294.ref026">26</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref032">32</xref>] and a wide variety of methods aim to identify protein <bold>function determining residues</bold> (<bold>FDRs</bold>) [<xref ref-type="bibr" rid="pcbi.1005294.ref033">33</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref053">53</xref>] However, we are unaware of a method that aligns and classifies sequences and identifies FDRs concurrently. Moreover, FDR methods differ from hiMSA sampling in four respects: (1) FDR methods generally focus on predicting specific, well-characterized residue functions, such as in catalysis and substrate recognition, that can be experimentally benchmarked [<xref ref-type="bibr" rid="pcbi.1005294.ref054">54</xref>]. However, as noted recently [<xref ref-type="bibr" rid="pcbi.1005294.ref055">55</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref056">56</xref>], we lack reliable gold standards due to the incompleteness of experimental annotations. Consequently, methods meeting these standards will score correlated residues involved in important but uncharacterized functions incorrectly as false positives and thus will fail to characterize correlated residues objectively, which is our goal here. (2) Many cannot handle large, diverse data sets and therefore cannot adequately model a major protein superfamily. Typically this limitation arises from focusing on residue changes within a phylogenetic tree, which, for hundreds of thousands of sequences, introduces more complexity than either is necessary or can be reliably inferred. Instead, the hiMSA sampler models a protein superfamily as a simpler hierarchy of related subgroups, each of which is defined by a correlated residue pattern (and presumably by corresponding protein properties). (3) Most FDR methods lack a rigorous statistical basis and thus a way to distinguish signals from noise and to assess significance. Doing so requires adjusting for the implicit number of alternative hypotheses considered during optimization, which is not trivial given real-valued parameters and the vastness of the search space. (4) FDR methods typically depend upon pre-computed input (e.g., a tree or alignment) that has been optimized using an objective function that is distinct from and often statistically inconsistent with that of the method itself. Moreover, phylogenetic and clustering programs will fail to adequately distinguish signals from noise insofar as they rely on conventional MSA programs (e.g., [<xref ref-type="bibr" rid="pcbi.1005294.ref057">57</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref062">62</xref>]), nearly all of which will align random sequences and that therefore over-fit the data.</p>
</sec>
<sec id="sec006">
<title>Advantages of hiMSA sampling</title>
<p>The hiMSA sampler constitutes a significant shift from existing methods. <bold>(1)</bold> It concurrently, comprehensively, and in a statistically coherent manner defines correlated residue patterns, corresponding hierarchically-arranged (and presumably functionally-divergent) sequence subgroups, and the extent of each subgroup's alignment. None of these elements are known <italic>a priori</italic>, and knowledge of each contributes to the proper recognition of the others. For example, each divergent subgroup needs to be defined and properly aligned to identify correlated residue patterns; however, such patterns are required to define each subgroup. Our approach avoids this chicken or egg dilemma by iteratively sampling each element in turn. <bold>(2)</bold> We find that MCMC sampling often exhibits a favorable time complexity [<xref ref-type="bibr" rid="pcbi.1005294.ref063">63</xref>], making it applicable even to very large data sets (e.g., 424,764 sequences in [<xref ref-type="bibr" rid="pcbi.1005294.ref064">64</xref>]). Finding an optimal or near-optimal hiHMM using maximum-likelihood as a criterion requires searching a very high-dimensional and complex space. Although rigorous optimization is intractable, Bayesian MCMC sampling [<xref ref-type="bibr" rid="pcbi.1005294.ref020">20</xref>] is widely recognized as the most effective method for locating near-optimal solutions in such circumstances. And, unlike deterministic methods, which may repeatedly return the same suboptimal result with no indication of uncertainty, MCMC sampling can reveal uncertainties and thereby the degree to which modeled features and parameters may be trusted. <bold>(3)</bold> It avoids modeling extraneous features and random noise by applying the <bold>minimum description length (MDL)</bold> principle [<xref ref-type="bibr" rid="pcbi.1005294.ref065">65</xref>], which provides a criterion for choosing among alternative models for describing a set of data. Conceptually, it suggests that the best model, among a set of alternatives, is that which minimizes the description length of the model, plus the maximum-likelihood description length of the data given the model. This adjusts for the implicit number of hypotheses considered while exploring possible models—thereby ensuring that sequence regions are aligned and that correlated residue patterns and corresponding subgroups are defined <italic>only</italic> when justified statistically. As is illustrated here, in the light of the literature and of available structural data [<xref ref-type="bibr" rid="pcbi.1005294.ref066">66</xref>], enhancing signal over noise in this way aids biological interpretation of hiMSA properties. <bold>(4)</bold> Finally, it explicitly models non-sub-classifiable sequences and identifies unrelated or aberrant sequences that may have been included inadvertently.</p>
</sec>
</sec>
<sec id="sec007" sec-type="results">
<title>Results</title>
<p><bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold> shows the specific steps used to obtain and analyze a hiMSA: <bold>(1)</bold> Search for and align database sequences belonging to a protein domain superfamily using MAPGAPS [<xref ref-type="bibr" rid="pcbi.1005294.ref067">67</xref>], which takes as the query either a curated MSA of representative sequences or an existing hiMSA; the MAPGAPS-generated MSA is improved via MCMC sampling [<xref ref-type="bibr" rid="pcbi.1005294.ref068">68</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref071">71</xref>] using GISMO [<xref ref-type="bibr" rid="pcbi.1005294.ref063">63</xref>]. <bold>(2)</bold> Partition the alignment into hierarchically-arranged subgroups based on correlated residue patterns using BPPS [<xref ref-type="bibr" rid="pcbi.1005294.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref024">24</xref>] (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2B and 2C</xref></bold>). <bold>(3)</bold> Using the hieraln program (first described here) create a hiMSA. <bold>(4)</bold> Visualize hiMSA-associated sequence and structural properties using the hierview program (first described here), and correlate these properties with other biological information to obtain clues to protein function as an aid to experimental design.</p>
<fig id="pcbi.1005294.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005294.g002</object-id>
<label>Fig 2</label>
<caption>
<title>hiMSA creation and analysis.</title>
<p><bold>A</bold>. Flow chart showing the steps required to create and interpret a hiMSA (as described in text). <bold>B</bold>. Schematic of a BPPS-generated “<bold>contrast alignment</bold>” that corresponds to node 8 of the hierarchy in (A). One such contrast alignment is created for each node in the hierarchy. Sequences assigned to node 8’s subtree (blue nodes in (A)) constitute a ‘foreground’ partition, those assigned to the most closely related nodes (red nodes in (A)) constitute a ‘background’ partition, and the remaining sequences constitute a non-participating partition. Horizontal bars represent sequences assigned to the similarly-colored corresponding nodes in (A). Blue vertical bars represent conserved foreground residue patterns (as shown below each bar); these diverge from (or contrast with) the background compositions at those positions (white vertical bars). Red vertical bars above the alignment quantify the degree of divergence. <bold>C</bold>. BPPS sampling explores the space of domain hierarchies by attaching or removing leaf nodes, moving subtrees, inserting or deleting internal nodes, moving sequences between nodes and, for each subtree, adding or deleting residue patterns based on how well they discriminate the foreground from the background (as shown in (B)). <bold>D</bold>. Schematic diagram of a hiMSA from the perspective of a leaf node. One such diagram could be created for each node in a hierarchy. (<italic>center</italic>) The node 6 lineage of the full hiMSA. Horizontal lines represent aligned sequences and are color-coded by level in the hierarchy. Thin light gray horizontal lines represent non-homologous and deleted regions. Vertical lines represent the contrasting pattern positions upon which the hierarchy is based and are similarly color-coded by levels. (<italic>left &amp; right sides</italic>) Subtrees corresponding to each level. The colored, gray and white nodes in each tree correspond, respectively, to their alignment foreground, background and non-participating partitions, the sequences of which are colored similarly. The background for the entire superfamily (lower right) consists of random sequences.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.g002" xlink:type="simple"/>
</fig>
<sec id="sec008">
<title>MSA sampling</title>
<p>In step 1 of <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold>, GISMO [<xref ref-type="bibr" rid="pcbi.1005294.ref063">63</xref>] improves the initial MSA by sampling over a <bold>hidden Markov Model (HMM)</bold> posterior probability distribution given the input sequence data and Dirichlet mixture priors [<xref ref-type="bibr" rid="pcbi.1005294.ref072">72</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref074">74</xref>]. An HMM [<xref ref-type="bibr" rid="pcbi.1005294.ref075">75</xref>] is a generative statistical model that, as applied here, defines a distribution of protein sequences. It can generate sequences by sampling paths between its start and end states (<bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s001">S1.1A Fig</xref></bold>), while “emitting” an amino acid residue for each match and insert state encountered along each path. Corresponding to an HMM-generated set of sequences is an MSA that defines the path taken for each sequence, where match and delete states correspond to aligned columns and insert states to insertions. Conversely, from an MSA may be inferred the states and the emission and transition probabilities for a corresponding HMM. GISMO improves an MSA by iterating between inferring a new HMM given a current MSA and sampling a new MSA given a current HMM. It similarly infers position-specific transition probabilities based on the transitions implied by the MSA. Given a sufficiently large number of input sequences, an accurate MSA and HMM for a protein superfamily may be inferred in this way.</p>
</sec>
<sec id="sec009">
<title>BPPS sampling</title>
<p>In Step 2 of <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold>, the BPPS sampler partitions the MSA into hierarchically-arranged subgroups based on correlated residues distinctive of each subgroup (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2B</xref></bold>). Starting from a single node, it samples new child nodes (each after a period of burn-in sampling that allows the Markov chain to approach its steady-state). This operation and ‘move’, ‘insert’ and ‘delete’ operations (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2C</xref></bold>) are sampled iteratively to explore possible hierarchies. Each hierarchy, in conjunction with specific sequence and pattern assignments, is sampled with probability proportional to the degree to which its pattern residues are more highly conserved in ‘foreground’ versus ‘background’ sequences (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2B</xref></bold>)—collectively, over all nodes in the hierarchy. Note that the probability distribution (as defined in <xref ref-type="disp-formula" rid="pcbi.1005294.e014">Eq 4</xref> of Methods) treats each column position as statistically independent; hence BPPS models correlations indirectly, based on the hierarchy. <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s005">S5 Fig</xref></bold> illustrates how BPPS sampling produces hierarchies that, based on measures of statistical significance, are generally superior to hierarchies created at the NCBI using a combination of phylogenetic analysis and manual-curation; for in-depth evaluations of protein domain hierarchies in this way, see [<xref ref-type="bibr" rid="pcbi.1005294.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref076">76</xref>].</p>
</sec>
<sec id="sec010">
<title>The hiMSA sampler</title>
<p>A simple MSA and corresponding HMM fails to model a major protein superfamily adequately due to insertions and deletions associated with functional divergence and specialization. Instead we model a superfamily as a hiHMM corresponding to a hiMSA (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2D</xref></bold>), and optimize it using a two-component hiMSA sampler (Step 3 in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold>), as follows. The BPPS component partitions a simple (non-hierarchical) alignment into hierarchically-arranged subgroups (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2C</xref></bold>) based upon patterns of conserved and divergent residues (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2B</xref></bold>), while the MSA component adjusts the sub-alignment associated with each subgroup to align regions conserved in the subgroup but not in the superfamily as a whole, thereby creating a hiMSA (step 3 of <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold>). Corresponding to this hiMSA is a hiHMM, which is defined as follows: A HMM is defined for each subgroup (i.e., subtree in the hierarchy) with <bold>lineage-specific emission probabilities</bold> for each match state (i.e., sub-alignment column). To understand what this entails, consider the lineage shown in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2D</xref></bold>: For a given node (e.g., node 6 in this figure), the hiMSA sampler assigns columns either to that node (blue columns), or to another node along the path back to the root (e.g., green, orange or red columns). For the HMM associated with leaf node 6, the emission probabilities corresponding to blue columns are inferred based solely on node-6-assigned sequences. The rationale for this is that the residue distributions for these column positions diverge from the distributions of the parental node. Likewise, the emission probabilities corresponding to green, orange and red discriminating columns in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2D</xref></bold> are inferred based solely on the sequences assigned, respectively, to subtrees rooted at nodes 4, 2 and 1 (see <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s001">S1.1C Fig</xref></bold>). In general, for a discriminating column <italic>C</italic> of node <italic>N</italic> the corresponding emission probabilities are based on all of the residues in that column of the subtree rooted at <italic>N</italic>. Finally, each of the HMMs within the hiHMM is assigned a weight proportional to the fraction of sequences (after down-weighting for redundancy [<xref ref-type="bibr" rid="pcbi.1005294.ref077">77</xref>]) assigned to each of the corresponding nodes. Together, these interrelated HMMs collectively define a hiHMM and the maximum-likelihood hiMSA, which we seek. To be biologically most useful the hiMSA sampler should find the hiHMM most likely to have generated the input sequences for a given protein domain superfamily. This, in turn, requires that the MSA and BPPS models be combined into a single, statistically-coherent model, that efficient strategies be devised for hiHMM sampling with simulated annealing, and that sampling be done over a sufficiently large sequence set.</p>
</sec>
<sec id="sec011">
<title>The MDL principle</title>
<p>The <bold>minimum description length (MDL)</bold> principle [<xref ref-type="bibr" rid="pcbi.1005294.ref065">65</xref>] provides criteria for combining the HMM and BPPS models into a single model and for choosing among alternative model architectures and parameters describing the sequence data. Conceptually, it suggests that the best model, among a set of alternatives, is that which minimizes the description length of the model, plus the maximum-likelihood description length of the data given the model. This penalizes the freedom that the sampler has to choose among model architectures and their parameters. In the context of this study, the MDL principle allows us to balance the improved prediction of residue frequencies that arises from the articulation of protein subgroups with the increased model complexity that such articulation implies. While the MDL principle allows homologous residues to be aligned at discriminating positions, it disfavors the unwarranted generation of merely artificial patterns and subgroups. This is analogous to ensuring that a MSA procedure both adds gaps to align homologous residues and avoids adding gaps to align similar but non-homologous residues. In this way we can ensure that increases in hiHMM architectural complexity through the alignment of dissimilar residues occurs only when justified statistically.</p>
<p>From an information theoretical perspective, applying the MDL principle to our hiHMM can be thought of as follows. Imagine that we seek to transmit 1,000 input sequences, each of which is 100 residues long, over a communication channel using a binary code. If the sequences are entirely random, then the most efficient way to do this is to base our coding upon the overall residue composition of the sequences. This would correspond to a null model consisting of a single insert state, where, for example, the most and least common residues use the shortest and longest bit strings, respectively. However, if the sequences are related over their entire lengths, we can use a more efficient coding based on a simple (100 match state) HMM that uses the optimal coding at each sequence position. In this case, however, we also need a longer description for the HMM. Doing this is justified only if the increased description length of the more complex model is offset by the decreased length of the transmitted sequence data.</p>
</sec>
<sec id="sec012">
<title>The MDL principle and simple HMMs</title>
<p>The MDL principle may be applied either in its information theoretical form just described or, alternatively, using a Bayesian approach that defines prior probabilities for the null and each of the possible non-null HMM architectures (i.e., possible number of states and thus of aligned columns in the corresponding MSA). To illustrate this approach, we first consider the simplest case of MCMC sampling over possible architectures for a single (non-hierarchical) HMM (<bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s001">S1.1A Fig</xref></bold>). In this case our goal is to best fit the HMM's architecture to a set of input sequences. The simplest such architecture corresponds to the null HMM consisting of a single insert state. More complicated architectures add additional sets of match, delete and insert states, so the architectures differ only in the total number of such sets. At its most elementary, selecting an architecture thus involves selecting a non-negative integer. Because we place no bound on this integer, we need to assign positive priors to the possible architectures that sum to one. A simple geometric series suffices, and choosing a geometric constant near one can render us essentially indifferent among architecture sizes. The MDL principle has its main effect when the input data must be fit to the various architectures.</p>
<p>Here, each additional set of states requires, for each input sequence, one additional choice in describing its path through the HMM. The information required to specify these choices can be offset only by the prediction of residue frequencies in a new match state that are sufficiently improved vis a vis an insert state. Other aspects of an optimal alignment remaining fixed, this is achieved only when the Bayesian Integral Log-odds (BILD) score [<xref ref-type="bibr" rid="pcbi.1005294.ref078">78</xref>] of the newly aligned residues is positive. The BILD score for an MSA column, <inline-formula id="pcbi.1005294.e001"><alternatives><graphic id="pcbi.1005294.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, is the log-odds ratio for observing <inline-formula id="pcbi.1005294.e002"><alternatives><graphic id="pcbi.1005294.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula> under two alternative hypotheses [<xref ref-type="bibr" rid="pcbi.1005294.ref078">78</xref>], <italic>H</italic><sub><italic>1</italic></sub> and <italic>H</italic><sub><italic>2</italic></sub>. Here, <italic>H</italic><sub><italic>1</italic></sub> is a Dirichlet mixture model for related proteins [<xref ref-type="bibr" rid="pcbi.1005294.ref072">72</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref074">74</xref>] and <italic>H</italic><sub><italic>2</italic></sub> is the null model of unrelated proteins.</p>
</sec>
<sec id="sec013">
<title>The MDL principle and hiHMMs</title>
<p>The complex, hierarchical structure of dependencies among most large protein families provides further opportunity for the reduction of total data description length using the MDL principle. In brief, sequence divergence at various positions among different protein subgroups coordinated with sequence conservation within each subgroup permits a hiHMM to describe the sequence data more compactly by tailoring the amino acid emission probabilities of HMM match states to each individual subgroup. This comes at the cost of the increased complexity, and thus description length, of hiHMMs, and the MDL principle allows us to balance these competing considerations. We consider here, in increasing order, the contributions of various hiHMM elements to the total description length: the number of nodes in the hiHMM hierarchy; the rooted tree defining this hierarchy; the discriminating columns for each node and their corresponding residue sets; the sequences assigned to each node; the number of states in each of the hierarchically-arranged HMMs, and the sequences' paths through these states. We will illustrate each of these description lengths with a specific example, and consider how the description lengths can be offset by a shorter description length for the sequence data.</p>
<p>First, the number of nodes in the hierarchy is again just a positive number. As before we can assign to these numbers prior probabilities that sum to one based on a slowly decaying geometric series, thereby rendering the selection of the number of nodes, <italic>n</italic>, nearly irrelevant to the total description length. Specifically, if we specify a geometric factor <italic>x</italic>, the description length of <italic>n</italic> will be −log<sub>2</sub>(1−<italic>x</italic>)−(<italic>n</italic>−1)log<sub>2</sub><italic>x</italic> bits. For example, if we choose <italic>x</italic> = 0.99, the description length of <italic>n</italic> = 1 would be approximately 6.6 bits, and for <italic>n</italic> = 250 would be about 10.2 bits, which as we will see is insignificant.</p>
<p>Second, the number of possible rooted trees on <italic>n</italic> nodes increases exponentially with <italic>n</italic>. Specifically, the number of distinct rooted, unlabeled (i.e., non-isomorphic, <italic>n</italic>-ary) trees on <italic>n</italic> nodes is given by the Catalan number [<xref ref-type="bibr" rid="pcbi.1005294.ref079">79</xref>]
<disp-formula id="pcbi.1005294.e003">
<alternatives>
<graphic id="pcbi.1005294.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e003" xlink:type="simple"/>
<mml:math display="block" id="M3">
<mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>!</mml:mo></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>!</mml:mo><mml:mi>n</mml:mi><mml:mo>!</mml:mo></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>For a given <italic>n</italic>, we can assign all these trees equal prior probability. Asymptotically, the Catalan numbers are approximately [<xref ref-type="bibr" rid="pcbi.1005294.ref080">80</xref>]
<disp-formula id="pcbi.1005294.e004">
<alternatives>
<graphic id="pcbi.1005294.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e004" xlink:type="simple"/>
<mml:math display="block" id="M4">
<mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>≈</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mn>4</mml:mn><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>n</mml:mi><mml:mrow><mml:mrow><mml:mn>3</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:msqrt><mml:mi>π</mml:mi></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
</disp-formula>
so that the description length of a specific tree is 2<italic>n</italic>−1.5log<sub>2</sub><italic>n</italic>−0.6 bits, or roughly 2<italic>n</italic> bits. For example the description length of a specific tree having <italic>n</italic> = 250 nodes is about 487.5 bits. As we will see, compared to other elements in the description length of a hiHMM model, this is again essentially insignificant. In practice, for both algorithmic and biological reasons, we limit the trees we consider to those having a height ≤ <italic>h</italic>, where <italic>h</italic> = 5 by default.</p>
<p>Third, for each node, we must describe the number of discriminating columns, and the residue set associated with each column. We allow only residues sets that have biologically sensible patterns, and further constrain the set specified for a column to include the consensus residue among the sequences aligned in that column. Let us assign a prior probability <italic>p</italic> to a column being discriminating, and assume there are about <italic>t</italic> allowable and equally probable residue patterns at each column, and <italic>c</italic> total columns in the HMM for a given node. Then the description length of the discriminating pattern for the node is approximately <italic>c</italic>[−(1−<italic>p</italic>)log<sub>2</sub>(1−<italic>p</italic>)−<italic>p</italic>log<sub>2</sub>(<italic>p</italic>/<italic>t</italic>)] bits. For example, if <italic>c</italic> = 200, <italic>t</italic> = 10, and we choose <italic>p</italic> = 0.1, this comes to about 160 bits per node. For <italic>n</italic> = 250 nodes, the description length of all discriminating columns and their associated patterns is about 40,000 bits. In practice, we limit the number of discriminating columns for each node to ≤ <italic>m</italic>, where <italic>m</italic> = 25 by default, and place decreasing prior probabilities on progressively larger residue sets, as previously described [<xref ref-type="bibr" rid="pcbi.1005294.ref022">22</xref>].</p>
<p>Fourth, we must assign each sequence to a node. Assuming all <italic>n</italic> nodes are equally probable, this requires log<sub>2</sub><italic>n</italic> bits per sequence. For <italic>n</italic> = 250, this is about 8 bits per sequence and for 25,000 effectively independent sequences (i.e., after down-weighting for redundancy), about 200,000 bits. In practice, to avoid excessively elaborate hierarchies, we require by default that at least 50 sequences be assigned to each leaf node and that each node contribute at least 7 bits of information.</p>
<p>The total description of the specific hiHMM considered above is approximately 240,000 bits. To justify such a complex model, the description length of the data requires an equivalent improvement. We have assumed a core alignment of <italic>c</italic> = 200 columns, and <italic>s</italic> = 25,000 sequences, which implies 5,000,000 residues in the core. If the average description length of these residues is decreased by over 0.048 bits/residue, it will justify the increased complexity of the model.</p>
<p>Finally, we have ignored so far that we may adjust the HMM architecture for each node. Any extra HMM states at a given node will require the description of the paths of the sequences assigned to that node or its descendants through the HMM, but this increased description length can be offset by positive BILD scores for the newly aligned residues. (Since the maximum likelihood parameter settings for the hiHMM are inferred from the hiMSA, these are implicitly defined by the hiMSA—that is, by each aligned sequence’s path through the HMM for the sequence’s assigned node. Therefore, we merely need to determine the MDL of the hiMSA instead of the hiHMM. This involves integrating out the hiHMM’s parameters given the hiMSA using a single set of fixed priors for hiHMM emission and transition probabilities. We recently applied the MDL principle in this way to an MSA [<xref ref-type="bibr" rid="pcbi.1005294.ref063">63</xref>], generalization of which to a hiMSA is straightforward.)</p>
<p>This basic approach may be modified in various ways. For example, the prior probabilities for the node assignments of individual sequences need not be equal, and may be defined to sum to 1 in various ways. To favor shallow hierarchies, a high prior probability may be assigned to the root node, and progressively lower probabilities to nodes lower in the hierarchy. To favor deeper hierarchies, all nodes (except perhaps the root) may be assigned equal prior probabilities. By default, we set the prior probability for the root node to 0.25, for a “reject node” to 0.70, and equally for each of the remaining nodes so as to sum to 0.05. The reject node corresponds to unrelated and thus unalignable sequences that lack features of the entire superfamily and that presumably were included inadvertently. Note that, given an input set of unrelated sequences, the MDL principle, as just applied, favors the “null hierarchy” consisting solely of this reject node.</p>
</sec>
<sec id="sec014">
<title>Sampling strategies</title>
<p>To search for a hiHMM optimally modeling the distribution implied by a large set of input sequences, our samplers do the following: <bold>(1)</bold> Construct an MSA using the GISMO sampler [<xref ref-type="bibr" rid="pcbi.1005294.ref063">63</xref>]. To speed up sampling over very large sequence sets, one may first align a representative subset and then sample in the remaining sequences after convergence. <bold>(2)</bold> Next the following substeps are performed (in arbitrary order) until the evolving hiHMM fails to improve after a specified number of cycles: <bold>(2.a)</bold> Nodes are sampled in and out of the hierarchy as illustrated in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2C</xref></bold>. <bold>(2.b)</bold> Discriminating patterns are sampled for each node. <bold>(2.c)</bold> Sequences are sampled between nodes. <bold>(3)</bold> Starting with each child node of the root and proceeding recursively to descendent nodes, the extent of each node’s sequence alignment is adjusted using the GISMO sampler [<xref ref-type="bibr" rid="pcbi.1005294.ref063">63</xref>] to include subgroup-specific regions (<bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s001">S1.2 Fig</xref></bold>). This generates the hiMSA. <bold>(4)</bold> Substep 2.b is applied to the hiMSA to identify correlated residue patterns within subgroup-specific regions. We use BPPS sampling to define the hierarchy based on those residue patterns that most discriminate between divergent subgroups; BILD scores [<xref ref-type="bibr" rid="pcbi.1005294.ref078">78</xref>] to assign aligned columns to specific nodes in the hierarchy; Dirichlet mixture priors [<xref ref-type="bibr" rid="pcbi.1005294.ref072">72</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref074">74</xref>] to accommodate small sequence sets; down-weighting for sequence redundancy [<xref ref-type="bibr" rid="pcbi.1005294.ref077">77</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref081">81</xref>]; and, after convergence, simulated annealing [<xref ref-type="bibr" rid="pcbi.1005294.ref025">25</xref>] to drop into an (ideally nearly global) optimum. In principle, finding the global optimum for all but the simplest hierarchies is nearly impossible. In practice, however, we find that the various hierarchies obtained from run to run generally share the biologically most important features of the superfamily [<xref ref-type="bibr" rid="pcbi.1005294.ref076">76</xref>] and that the features most difficult to model optimally are least important. Therefore, failing to find the global optimum often forfeits little of biological significance.</p>
</sec>
<sec id="sec015">
<title>Obtaining biological insight</title>
<p>The final step in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold> is to interpret the results biologically. This involves: (i) identifying and characterizing putative sequence determinants of subgroup-specific functions; (ii) interpreting these in the light of available structures and other biological information; and (iii) formulating hypotheses for experimental follow up. We illustrate this here for N-acetyltransferases.</p>
</sec>
</sec>
<sec id="sec016">
<title>Application</title>
<sec id="sec017">
<title>N-acetyltransferases (acetylases)</title>
<p>N-acetyltransferases constitute a large group of evolutionarily-related proteins that transfer an acetyl ((CH<sub>3</sub>)-(C = O)-) group or, more generally, an acyl (((CH<sub>3</sub>)-(CH<sub>2</sub>)<sub><italic>x</italic></sub>-(C = O)-)) group from bound acetyl-Coenzyme A (acetyl-CoA) to a bound substrate. They are implicated in a variety of functions, from bacterial antibiotic resistance to circadian rhythms in mammals. We applied our system to 200,573 protein sequences belonging to the N-acetyltransferases superfamily; this identified a hierarchy consisting of 124 nodes and 83 leaves (<bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3A</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s001">S1.3 Fig</xref></bold>) with most of the subgroups corresponding to hypothetical proteins. For this analysis, we required that at least 200 sequences be assigned to each leaf node in the hierarchy. Due to space limitations, we examine only a few aspects of our analysis; a comprehensive analysis will be published separately. Note that, in the following discussion, we use the more concise term “acetylase” interchangeably with “N-acetyltransferase”.</p>
<fig id="pcbi.1005294.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005294.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Hierarchy and key features of the acetylase superfamily.</title>
<p><bold>A</bold>. The acetylase hierarchy identified by the sampler. For clarity smaller subtrees not discussed in the text have been omitted; the complete hierarchy is given in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s001">S1.3 Fig</xref></bold>. Purple nodes are not discussed in the text. <bold>B</bold>. Root node “contrast alignment” highlighting conserved patterns most characteristic of acetylases as a whole. Shown are six representative sequences assigned to node-13 of the acetylase hierarchy in (A). These sequences correspond to an uncharacterized prokaryotic acetylase family that conserves all of the root node canonical residues. The sequences are labeled by their bacterial phyla except for the first (proteobacterial) sequence, the structure of which is shown in (C). Below the representative alignment is a summary of the most conserved amino acid residues at each position; the number of sequences (assigned to the foreground) is given in parentheses on the first line. The 1<sup>st</sup> to 3<sup>rd</sup> lines show up to three residues at each position that occur both most frequently and in ≥10% of the sequences. Directly below this, the frequencies of the designated residues are given in integer tenths; for example, an ‘8’ indicates that 80–90% of the sequences in the foreground alignment match the corresponding pattern residue. In column 88, for example, glycine occurs in 60–70% and alanine in 20–30% of the sequences. To highlight larger integers ‘5’ and ‘6’ are shown in black and ‘7’-‘9’ in red. The first of these lines (labeled as “wt_res_freqs” for “weighted residue frequencies”) reports the effective number of aligned sequences. In all of these cases, reported frequencies have been down-weighting for redundancy. The black dots above the alignment indicate the pattern positions that were identified by the sampler. Pattern-matching (correlated) residues are highlighted in color, with biochemically similar residues colored similarly. For example, acidic residues are shown in red, basic residue in cyan and hydrophobic residues in yellow; histidine, glycine and proline are each assigned a unique color. The height of the red bars above the alignment quantify (using a semi-logarithmic scale) the degree to which residue frequencies in the foreground diverge at each position from the corresponding positions in the background. In this case, the foreground corresponds to the root node, that is, to the entire tree and thus to all acetylases, and the background corresponds to all proteins unrelated to acetylases, which is represented by standard amino acid residue frequencies. <bold>C</bold>. The acetylase fold with canonical residues most characteristic of the superfamily. The structure show is that of an <italic>E</italic>. <italic>coli</italic> putative N-acetyltransferase assigned to node 13; the corresponding sequence to the first aligned in (B) (pdb_id: 2kcw). <bold>D-F</bold>. Residue positions likely responsible for acetylase functional specificity. <bold>D</bold>. Histogram of normalized average ∆-BILD scores over all column positions. Scores were linearly adjusted so that the lowest score is zero and the highest score is 100. Data points with scores greater than 50 are plotted above the histogram and are spread out vertically to avoid overlap. Histogram bars that are more than two standard deviations above the mean are colored red; corresponding data points are color coded (as explained in text) and enlarged to enhance visibility. Numbers next to data points correspond to the positions of the corresponding aligned columns within the main alignment (i.e., the root node alignment) shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s004">S4 Fig</xref>.</bold> <bold>E</bold>. Surface representation of the substrate binding pocket showing the locations of six of the residues in (F), which are color coded and numbered as in (D). See text for further details. <bold>F</bold>. Locations within the crystal structure of <italic>Pseudomonas syringae</italic> tabtoxin resistance protein complexed with acyl-CoA (pdb_id: 1gheB)[<xref ref-type="bibr" rid="pcbi.1005294.ref082">82</xref>] of the nine residues corresponding to the rightmost data points in (D); this protein was assigned to node 104. Residue sidechains are colored as are the data points in (D) and labeled by column positions in the core alignment. In addition, four consensus amino acid residues generally conserved in acetylases are shown in yellow; acyl-CoA is shown in cyan.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.g003" xlink:type="simple"/>
</fig>
<p>The residue patterns characteristic of the acetylase superfamily (i.e., across the hierarchy) are highlighted in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3B</xref></bold>. Except for an isolated salt bridge involving Arg6 and Glu12, these residues cluster within the coenzyme A (CoA)-binding region (<bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3C</xref></bold>) and correspond to the following acetylase structural features: (i) An arginine/glutamine (Arg 83 in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3C</xref></bold>) that forms a hydrogen bond with a backbone oxygen and that contacts bound CoA, which is required for the acetyltransferase reaction. This contact appears to involve a π-orbital stacking interaction between a CoA–CO-NH- group and either the <ext-link ext-link-type="uri" xlink:href="https://en.wikipedia.org/wiki/Guanidine" xlink:type="simple">guanidinium</ext-link> group of arginine or the–CO-NH2 group of glutamine. (ii) Two glycine residues (Gly86 and Gly88 in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3B</xref></bold>), the backbone atoms of which form hydrogen bonds with bound CoA. (iii) A tyrosine residue (Tyr117 in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3B and 3C</xref></bold>), which, for some acetylases, has been proposed to function as a general acid [<xref ref-type="bibr" rid="pcbi.1005294.ref082">82</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref083">83</xref>] facilitating transfer of the acetyl group from the sulfur atom of CoA to the substrate. (iv) A nearby asparagine residue (Asn110) that may assist in this process. (v) Two other (typically aromatic) pattern residues (Phe116 and Phe122) that pack against the tyrosine, one of which may form π-π stacking interactions with the (aromatic) adenine group of CoA. (vi) The remaining canonical residues form hydrophobic contacts that presumably facilitate the core structure of this superfamily.</p>
</sec>
<sec id="sec018">
<title>Most discriminating aligned column positions</title>
<p>In addition to the above mentioned known properties, our analysis reveals new information about underlying properties of acetylases. We identified, for example, those residue positions most likely responsible for functional specificity, as follows: For each major subgroup (i.e., each subtree directly attached to the root) at each column position, we computed the sum of two BILD scores: one score for that subgroup alone and another for the entire superfamily absent that subgroup. BILD scores quantify the information content within aligned columns based on the (weighted) amino acid residue counts. Next, we computed a Δ-BILD score, defined as the difference between this sum and the BILD score for the superfamily as a whole. Taking the difference between two BILD scores in this manner may be understood as constructing a BILD score from two alternative hypotheses of relatedness among the residues in a column [<xref ref-type="bibr" rid="pcbi.1005294.ref078">78</xref>]. In this context, a column’s Δ-BILD score will be positive when the sequences assigned to a major subgroup and those assigned to the rest of the tree have distinct residue compositions. Hence, each Δ-BILD score quantifies the degree to which a given subgroup amino acid composition diverges at a given column position from the composition of the superfamily as a whole. Finally, we compute the average Δ-BILD score for each column position. The histogram in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3D</xref></bold> plots these average scores over all columns within the acetylase core alignment. Those columns with the most extreme average Δ-BILD scores correspond to aligned residue positions that are most highly conserved within each major subgroup but that are poorly conserved in the superfamily as a whole—suggesting that residues at high-scoring positions are important for subgroup functional specialization.</p>
<p>Nine column positions stand out in this way (<bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3D</xref></bold>). As is illustrated in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3E and 3F</xref></bold>, which highlights the structural locations of these residues in a protein assigned to node-104 of our hierarchy (<bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3A</xref></bold>), residues in six of these positions line the substrate binding and catalytic sites. This is as expected, since residues in this region are likely to have a major influence on substrate and catalytic specificities. The two residues with the most extreme scores (which are colored red in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3E and 3F</xref></bold> and which correspond to columns 57 and 58) are directly adjacent to the substrate binding site. Structurally behind these two residues is another high scoring position (column 50 of the core alignment), the residue at which may be important for maintaining the sidechains of these other residues in a functionally-optimal conformation. Likewise, the residue at position 60 interacts both with the position 58 residue and with bound CoA, both of which may be important for orienting the substrate and CoA for enhanced catalytic efficiency and specificity. Three other high Δ-BILD positions (columns 93–95) likewise line the substrate binding pocket (<bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3E and 3F</xref></bold>). In particular, the column-94 threonine residue in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3F</xref></bold> forms a hydrogen bond with the CoA sulfur atom and thus may play a role in catalysis. The two remaining high Δ-BILD scoring positions (columns 18 and 22) neither line the substrate binding pocket nor interact with CoA, but may perform a currently unknown functional role (e.g., see subtree 35 analysis below).</p>
</sec>
<sec id="sec019">
<title>Structural partitioning into CoA- and substrate-associated subdomains</title>
<p>Just as residues characteristic of the acetylase superfamily as a whole cluster around the CoA-binding pocket (<bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3B and 3C</xref></bold>), major-subgroup-conserved residues tend to cluster together in another, distinct region of the domain, one that again appears to be associated with substrate and catalytic specificity. To illustrate this, the analysis in <bold><xref ref-type="fig" rid="pcbi.1005294.g004">Fig 4A and 4B</xref></bold> show both categories of correlated residues for representative sequences assigned to node-12 of the acetylase hierarchy. <bold><xref ref-type="fig" rid="pcbi.1005294.g005">Fig 5A</xref></bold> shows how these two types of residues structurally cluster into two halves of the acetylase domain [<xref ref-type="bibr" rid="pcbi.1005294.ref084">84</xref>]. Two node-12 residues, however, are outside of the main node 12 cluster; these correspond to Lys116 and Cys141 of <italic>Caenorhabditis elegans</italic> glucosamine-6-phosphate N-acetyltransferase (Gna1) (pdb_id: 4ag9). Lys116, which replaces the glycine residue typically found at this position in the acetylase superfamily, interacts with a phosphate group of CoA, thereby possibly helping position CoA for catalysis. Cys141 is an active site residue that covalently links to the sulfur atom of CoA [<xref ref-type="bibr" rid="pcbi.1005294.ref084">84</xref>]. Essentially all of the remaining node-12 residues are involved either in substrate binding or homodimer formation or both. As do other acetylase subgroups, this subgroup forms a homodimeric complex [<xref ref-type="bibr" rid="pcbi.1005294.ref084">84</xref>]. Node-12-conserved residues from both subunits together bind the substrate (<bold><xref ref-type="fig" rid="pcbi.1005294.g005">Fig 5B</xref></bold>). Some of these residues and nearly all of the remaining node-12 residues form the homodimeric interface (<bold><xref ref-type="fig" rid="pcbi.1005294.g005">Fig 5C</xref></bold>). Together these observations rationalize the conservation of node-12 residues and suggest that they form a structural and biochemical environment favoring specific acetylation of glucosamine-6-phosphate. The high Δ-BILD scores for columns 18 and 22 (<bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3D and 3F</xref></bold>) (corresponding to Leu40 and Thr44 in <xref ref-type="fig" rid="pcbi.1005294.g005">Fig 5C</xref>, respectively) might be rationalized, at least in this case, to their role in homodimerization; an additional rationalization for column 22 is binding to substrate, as this is seen for Thr44 in <xref ref-type="fig" rid="pcbi.1005294.g005">Fig 5B</xref>.</p>
<fig id="pcbi.1005294.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005294.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Correlated residue patterns associated with the node 12 lineage.</title>
<p>See the legend to <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3B</xref></bold> for an explanation of notation. The same representative node-12-assigned sequences are shown in both A and B, but highlight pattern residues most distinctive of the root (i.e., the superfamily) and of the node 12 subgroup, respectively. <bold>A</bold>. Contrast alignment corresponding to the root of the acetylase hierarchy. <bold>B</bold>. Contrast alignment corresponding to node 12 of the hierarchy. Here the foreground corresponds to sequences assigned to node-12 and the background to all other acetylase sequences. The highlighted columns below the red dots correspond to the residues shown in <bold><xref ref-type="fig" rid="pcbi.1005294.g005">Fig 5B</xref></bold>; note that the constraints imposed on these residues (i.e., the heights of the red bars above the dots) are generally higher than the constraints imposed on the other pattern residues.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.g004" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005294.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005294.g005</object-id>
<label>Fig 5</label>
<caption>
<title>The <italic>Caenorhabditis elegans</italic> glucosamine-6-phosphate N-acetyltransferase (Gna1) complexed with CoA and N-acetylglucosamine-6-phosphate (GlcNAc6p) (pdb_id: 4ag9) [<xref ref-type="bibr" rid="pcbi.1005294.ref084">84</xref>].</title>
<p>Gna1 was assigned to node 12 of the hierarchy. <bold>A</bold>. Structural locations of acetylase residues (yellow) and node 12-specific residues (red). <bold>B</bold>. Node 12-specific residues involved in substrate binding. These residue positions are indicated in <bold><xref ref-type="fig" rid="pcbi.1005294.g004">Fig 4</xref> </bold>(as red dots above column positions). <bold>C</bold>. Node 12-specific residues associated with the homodimeric interface.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec020">
<title>The Gna1 analysis compared with that of other methods</title>
<p>As just described, our analysis of the Gna1 subgroup identifies two categories of residues that are structurally partitioned (in a strikingly non-random manner) into two subdomains (<bold><xref ref-type="fig" rid="pcbi.1005294.g005">Fig 5A</xref></bold>). Moreover, functional roles for these pattern residues in dimerization, in substrate- and CoA-binding and in catalysis are easily rationalized based on their structural locations. Because no structural information was provided to our procedures (steps 1–3 in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold>), this indicates that the identified correlated residue patterns correspond to true biochemical properties important for protein function. Given these results, we investigated whether functional residue prediction programs specifically designed to identify catalytic, ligand-binding and subtype-specific residues yield similar results. <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s002">S2.1A–S2.1D Fig</xref></bold> compares our analysis of the Gna1 subgroup to that of two such programs: FRpred [<xref ref-type="bibr" rid="pcbi.1005294.ref043">43</xref>] and CLIPS-1D [<xref ref-type="bibr" rid="pcbi.1005294.ref045">45</xref>]. This reveals that the structural bipartitioning of residues is unique to our hiMSA analysis, which therefore, at least in this case, is finding protein structural features that these other methods fail to identify.</p>
</sec>
<sec id="sec021">
<title>Gna1 compared with other acetylases</title>
<p>The structural bi-partitioning phenomenon characteristic of the Gna1 subgroup is also observed within other subgroups of the acetylase superfamily. This is observed, for example, for a subgroup (node 56 in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3A</xref></bold>) that includes Hpa2 histone acetyltransferases (pdb_id: 1qsm; <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s002">S2.1E Fig</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s002">S2.2 Fig</xref></bold>) and for a subgroup (node 58 in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3A</xref></bold>) that includes the amino-terminal acetyltransferase catalytic subunit Naa10 (pdb_id: 4kvo)(<bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s002">S2.1F Fig</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s002">S2.3 Fig</xref></bold>). Hence, many acetylases appear to be composed of two components: a CoA-binding subdomain and, positioned next to this, a substrate binding and reaction chamber. Our analysis of the Naa10 subgroup also reveals a third category of pattern residues corresponding to a third structural partition that forms a surface layer over the two other partitions and that might mediate binding to other proteins.</p>
</sec>
<sec id="sec022">
<title>hiMSA analysis suggests an acetylase induced-fit mechanism</title>
<p>To further decompose the sequence determinants of protein function, hiMSA analysis expands major subgroup nodes into subtrees. Node-35 in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3A</xref></bold>, for example, has been expanded into a subtree consisting of 9 nodes. Contrast hierarchical alignments of sequences in the lineage from the root node to node-42 and from the root node to node-39 are shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s003">S3 Fig</xref></bold>. We may interpret these alignments probabilistically in terms of the underlying hiHMM distribution, as follows: The root pattern residues (highlighted in the upper alignment of <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s003">S3A Fig</xref></bold>) correspond to those sequence properties defining the main probability cloud of the sequence distribution for the acetylase superfamily. Likewise, the node-35 pattern residues (highlighted in the lower alignment of <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s003">S3A Fig</xref></bold>) define a probability subcloud within this main cloud. Note that, although the aligned sequences in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s003">S3A Fig</xref></bold> are assigned to distinct nodes (either node-42 or node-39) within the node-35 subtree, both categories of sequences conserve well the root and node-35 pattern residues. This presumably corresponds to their shared functional constraints. In contrast, the node-40 pattern residues highlighted in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s003">S3B Fig</xref></bold> are distinct from the node-36 pattern residues highlighted in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s003">S3C Fig</xref></bold>. We hypothesize that this reflects these subgroups’ functional divergence and corresponds to distinct subclouds within the node-35 cloud. Likewise the node-42 and node-39 pattern residues define sub-subclouds within these subclouds.</p>
<p>Examining these node-specific pattern residues within proteins of known structure suggests both shared and divergent functional and structural roles. For example, <bold>Figs <xref ref-type="fig" rid="pcbi.1005294.g006">6</xref>–<xref ref-type="fig" rid="pcbi.1005294.g008">8</xref> </bold>show the locations of pattern residues characterizing the lineage from node-35 to node-42 within CoA-bound and unbound structures. These structures are of an acetylase from <italic>Salmonella typhimurium</italic> that forms a homodimeric complex (pdb_ids: 3dr8 and 3dr6, respectively, determined in a Structural Genomics unpublished study) and that corresponds to the <italic>Salmonella enterica</italic> MddA (methionine derivative detoxifier) protein [<xref ref-type="bibr" rid="pcbi.1005294.ref085">85</xref>]. <bold><xref ref-type="fig" rid="pcbi.1005294.g006">Fig 6A</xref></bold> shows, within one dimeric subunit, the locations of the most discriminating pattern residues associated with nodes 35, 40 and 42. <bold><xref ref-type="fig" rid="pcbi.1005294.g006">Fig 6B</xref></bold> reveals that about half of the node-35 pattern residues (red sidechains) interact with the adjacent dimeric subunit, suggesting a role for these residues in dimer formation. This dimeric interface is strikingly different from the node-12 dimeric interface shown in <bold><xref ref-type="fig" rid="pcbi.1005294.g005">Fig 5C</xref></bold>—suggesting that subgroup-specific residues have evolved to accommodate different dimeric (and possibly higher-level multimeric) complexes. Two node-40 and one node-42 pattern residues also occur at this interface, about which more will be said below. The substrate pocket is formed by four of the node-40 pattern residues as well as by seven node-35 and seven node-42 pattern residues (<bold><xref ref-type="fig" rid="pcbi.1005294.g006">Fig 6C and 6D</xref></bold>), which together presumably contribute to substrate specificity. We conjecture that those residues associated with higher- and lower-level nodes (e.g., node-35 and node-42, respectively) recognize similar and distinct substrate features, respectively. The substrates for these proteins are currently unknown.</p>
<fig id="pcbi.1005294.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005294.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Pattern residues associated with the node 42 lineage.</title>
<p><bold>A</bold>. The structural locations of pattern residues corresponding to nodes 35, 40 and 42 (the sidechains of which are shown in red, orange and yellow, respectively) of the apo form of a putative acetylase from <italic>Salmonella typhimurium</italic> (pdb_id: 3dr6). This protein forms a homodimer, the two subunits of which are shown in blue and gray. Residues are shown within the bottom subunit of the homodimeric complex only. <bold>B</bold>. Pattern residues associated with interactions between dimeric subunits in the apo form (pdb_id: 3dr6). <bold>C</bold>. Pattern residues that line the substrate binding pocket within the CoA-bound form of the same acetylase as in (A) (pdb_id: 3dr8). CoA is shown in cyan. <bold>D</bold>. The corresponding surface plot of the pocket using the same color scheme.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.g006" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005294.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005294.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Node 35 structural features implicated in a proposed induced-fit mechanism.</title>
<p><bold>A-C</bold>. Conformational changes that involve two conserved residues and that mediate opening and closing of the substrate binding pocket of a putative acetylase from <italic>Salmonella typhimurium</italic> with and without bound acetyl-CoA (pdb_id: 3dr8 and 3dr6). <bold>A</bold>. (top) Surface view of the open conformation when CoA is bound to both subunits (pdb_id: 3dr8). The surface of Glu82 is shown in red, of Arg72 in yellow and of the rest of the substrate binding pocket (SBP) in green. (bottom) Close up view of Glu82 and Arg72 at the dimeric interface (pdb_id: 3dr8); the SBP is indicated. <bold>B</bold>. (top) Surface view of the closed conformation when neither subunit is bound to CoA (pdb_id: 3dr6). Note that the substrate binding pocket appears inaccessible. (bottom) Close up of the Glu82-Arg72 salt bridge formed at the subunit interface. <bold>C</bold>. (<italic>top left</italic>) Surface side view of the acetyl-CoA bound form (pdb_id: 3dr8) showing the locations of a cluster of Set42-specific residues (shaded yellow). CoA is shown in cyan. (<italic>bottom</italic>) The same view of 3dr8 as in A but rotated by 90 degrees to show a side view. The expanded box shows the node-42 pattern residue interactions forming a bridge between adjacent loop regions. (<italic>top right</italic>) A similar view of <italic>C</italic>. <italic>Elegans</italic> Gna1 (pdb_id: 4ag9) showing the adjacent locations of the CoA and substrate within a channel rather than a pocket as in (A). <bold>D-F</bold>. Differences between node 40 and node 36 pattern residues. Residues with red sidechains correspond to node 35 pattern residues. See <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s003">S3 Fig</xref></bold> for the contrast alignment showing pattern residues. <bold>D</bold>. Node 40 pattern residues (orange sidechains) within 3dr6 (an acetylase assigned to node 42). <bold>E</bold>. Node 40 pattern residues (orange sidechains) within 1vhs (an acetylase assigned to node 41). <bold>F</bold>. Node 36 pattern residues (light green sidechains) within 4jxr (an acetylase assigned to node 39).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.g007" xlink:type="simple"/>
</fig>
<fig id="pcbi.1005294.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1005294.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Opening and closing of the substrate binding pocket and movement of helix 2 based on superpositioning of bound and unbound acetylase domains.</title>
<p>Sidechains of the putative induced fit glutamate and arginine residues in the closed form are shown as red and yellow sticks, respectively. CoA within half-bound homodimers is shown as cyan colored sticks. <bold>A</bold>. Node 42 CoA-bound, CoA-unbound and CoA-half-bound structures. When bound to CoA, helix-2 moves outward relative to the unbound homodimer. The sidechain of the 3dr8 arginine residues (open conformation) for the 3dr8 vs 3dr6 superposition is shown as light blue sticks (compare with <xref ref-type="fig" rid="pcbi.1005294.g007">Fig 7A</xref>). <bold>B</bold>. Node 35 hierarchy with color coding. <bold>C</bold>. Node 41 unbound monomeric structure superimposed over the node 42 CoA-bound homodimer. Note that the proposed induced-fit arginine residue is replaced by a tyrosine, which could also form both a hydrogen bond to the glutamate residue and a π- π stacking interaction with this tyrosine from the other homodimeric subunit. <bold>D</bold>. Node 39 superpositions showing that, unlike sequences assigned to the node 40 subtree, helix 2 does not appear to move outward upon binding to CoA. This may be due to differences between node 40 and node 36 pattern residues associated with this helix (see <xref ref-type="fig" rid="pcbi.1005294.g007">Fig 7D–7F</xref>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.g008" xlink:type="simple"/>
</fig>
<p>A comparison between CoA-bound and unbound forms of MddA suggests a role for the second most striking node-42 pattern residue in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s003">S3 Fig</xref></bold>, namely Arg72. In the CoA-bound state (<bold><xref ref-type="fig" rid="pcbi.1005294.g007">Fig 7A</xref></bold>): (i) Arg72 forms a guanidinium-group π-π stacking interaction [<xref ref-type="bibr" rid="pcbi.1005294.ref086">86</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref088">88</xref>] with the same arginine from the other subunit; (ii) Glu82, a Node-35 pattern residue that corresponds to the column 57 residue in <bold><xref ref-type="fig" rid="pcbi.1005294.g003">Fig 3D</xref></bold> and thus may play a key role in substrate binding and/or catalysis, is free to bind to substrate; and (iii) Phe74, another Node-42 residue, is in an open, substrate-accessible configuration. However, in the unbound state (<bold><xref ref-type="fig" rid="pcbi.1005294.g007">Fig 7B</xref></bold>): (i) Arg72 forms a salt bridge with Glu82; and (ii) Phe74 undergoes a conformational change that blocks access to the substrate-binding pocket. The Arg-Glu salt-bridge interaction is also seen in unbound structures of related acetylases conserving this arginine residue (see below). Note that in this state the salt bridge blocks substrate access to Leu155 and Phe157, which line the substrate binding pocket. Together these changes appear to close the pocket, as surface views of the CoA-bound and unbound structures reveal (<bold><xref ref-type="fig" rid="pcbi.1005294.g007">Fig 7A and 7B</xref></bold>).</p>
<p>Note, however, that a substrate of MddA, namely L-methionine sulfoximine (MSX), binds to a related acetylase from <italic>Pseudomonas aeruginosa</italic> (PA4866; pdb_id: 2j8r) [<xref ref-type="bibr" rid="pcbi.1005294.ref089">89</xref>] in the absence of bound CoA and with the corresponding Arg-Glu salt bridge intact. Hence, in the absence of CoA the substrate binding pocket is sufficiently accessible to allow MSX binding in this case. Likewise, in another non-CoA-bound structure of the same protein, glycerol (which was used as a cryoprotectant) (pdb_id: 2j8m) [<xref ref-type="bibr" rid="pcbi.1005294.ref089">89</xref>] also binds to the substrate pocket.</p>
<p>Some acetylases form a CoA- and substrate-binding channel instead of a distinct substrate binding pocket (compare surface views of MddA and <italic>C</italic>. <italic>Elegans</italic> Gna1 in <bold><xref ref-type="fig" rid="pcbi.1005294.g007">Fig 7C</xref></bold>). It is perhaps for this reason that nine Node-42 pattern residues form a bridge across this channel (box in <bold><xref ref-type="fig" rid="pcbi.1005294.g007">Fig 7C</xref></bold>), thereby forming a donut-hole between the CoA and substrate binding sites and a closeable pocket essential for the proposed CoA-induced-fit substrate-binding mechanism. Other, non-node-42 subgroups of node-35 also form such a bridge, albeit utilizing different pattern residues and interactions suggesting functional divergence and specialization.</p>
</sec>
<sec id="sec023">
<title>Possible roles for helix-2 and Node 40 residues in an induced-fit mechanism</title>
<p>Ten of the Node-40 pattern residues are associated with helix-2 of the acetylase domain (<bold><xref ref-type="fig" rid="pcbi.1005294.g007">Fig 7D–7E</xref></bold>). This raises questions regarding the role of these residues and of helix-2. Upon binding to two CoA molecules, disruption of the Arg-Glu salt bridge, and opening of the substrate pocket, helix-2 of each dimeric subunit moves outward relative to helix-2 of the other subunit. This is seen in structural superposition of CoA-bound and unbound forms of Gna1 (<bold><xref ref-type="fig" rid="pcbi.1005294.g008">Fig 8A</xref></bold>). Corroborating this notion, the helix-2 pairs are also closer together within homodimeric structures of various unbound forms of Node-42 acetylases (<bold><xref ref-type="fig" rid="pcbi.1005294.g008">Fig 8A</xref></bold>). And when only one dimeric subunit is bound to CoA, helix-2 in that subunit moves outward, but not helix-2 in the other, unbound subunit (<bold><xref ref-type="fig" rid="pcbi.1005294.g008">Fig 8A</xref></bold>). In this half-bound state the pocket appears to open partially, but the Arg-Glu salt bridge remains intact. Thus the proposed induced-fit mechanism appears to require CoA binding to both subunits to allow substrate access to the binding site.</p>
<p>If movement of helix-2 is mediated by the ten Node-40 residues associated with this helix (at least in part), then we might expect acetylases assigned to both of its child nodes, namely nodes 41 and 42 (<bold><xref ref-type="fig" rid="pcbi.1005294.g008">Fig 8B</xref></bold>), to share this mechanism, but not other Node-35 acetylases. Consistent with this notion, for an unbound form of an acetylase assigned to Node-41, helix-2 exhibits an inward-shifted conformation (<bold><xref ref-type="fig" rid="pcbi.1005294.g008">Fig 8C</xref></bold>), as do unbound Node-42 acetylases (<bold><xref ref-type="fig" rid="pcbi.1005294.g008">Fig 8A</xref></bold>). In this Node-41 acetylase the induced-fit arginine residue is replaced by a tyrosine, which, nevertheless, could still form a hydrogen bond to the Glu residue in a closed conformation, and π-π stacking interactions with the corresponding tyrosine from the second dimeric subunit in an open conformation. Solving the crystal structures of CoA-bound forms of this and other Node-41 acetylases will test this hypothesis. In contrast, helix-2 of an acetylase assigned to Node 39 is associated with distinct pattern residues (<bold><xref ref-type="fig" rid="pcbi.1005294.g007">Fig 7F</xref></bold>). Upon binding to one CoA molecule, helix-2 of this acetylase fails to move outward (<bold><xref ref-type="fig" rid="pcbi.1005294.g008">Fig 8D</xref></bold>), which is not the case for the Node-42 CoA-half-bound acetylase mentioned above (<bold><xref ref-type="fig" rid="pcbi.1005294.g008">Fig 8A</xref></bold>). Taken together, these observations suggest that conformational changes in helix-2 mediated by Node-40 pattern residues may play a role in transitioning between the open and closed states. In particular, the two occurrences of this helix move further apart in the open, CoA-bound state thereby facilitating access to the substrate binding pocket. The node-40 pattern residues associated with helix-2 may ensure proper positioning of this helix upon transitioning into the open state.</p>
</sec>
</sec>
<sec id="sec024" sec-type="conclusions">
<title>Discussion</title>
<p>As illustrated here, a hiMSA analysis can help make sense of uncharacterized or poorly characterized protein sequences and structures. Identifying correlated features of the empirical sequence and structural properties in this way provides a more objective basis for genome annotation than attempting to predict unobserved biochemical properties. We have illustrated here how a hiMSA analysis can provide new biological insights into characterized proteins and how it complements other methods for characterizing pairwise correlated residues [<xref ref-type="bibr" rid="pcbi.1005294.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref090">90</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref093">93</xref>] by finding correlated residue patterns presumably associated with functional specialization. hiMSA analysis advances sequence-based analysis on three fronts, as follows:</p>
<p><bold>(1)</bold> It models both site-specific and correlated features of an entire major protein superfamily concurrently and in a statistically coherent manner. This is important because an ideal model should explain all relevant features of the input sequences; this, in turn, requires searching the space of possible models using, as the objective function, each model’s likelihood of having generated the input data. Rather than relying on separate programs to pre-compute a tree, an alignment, or domain profiles, it optimizes modeled features based on consistent, statistically-based criteria. One reason that ad hoc approaches are often used is that the likelihood distribution over possible models is highly complex: Proteins typically have evolved into hierarchically-arranged, functionally-divergent subgroups, each of which exhibits both properties unique to that subgroup and others shared with related subgroups or with the superfamily as a whole. Hence, optimization over a complex distribution using deterministic methods rapidly becomes intractable as the number of sequences increases. A hiMSA analysis overcomes these barriers by using MCMC sampling [<xref ref-type="bibr" rid="pcbi.1005294.ref020">20</xref>], which has widely proved to be the most effective approach for exploring a complex, high-dimensional and highly-correlated probability distribution. MCMC sampling accomplishes this by sampling iteratively according to the conditional distribution of each variable in turn.</p>
<p><bold>(2)</bold> It avoids modeling extraneous features and random noise. This is important because over-parameterized models are computationally inefficient and their parameters over-fitted and, of course, modeling noise yields spurious results. To address this, here we applied the MDL principle [<xref ref-type="bibr" rid="pcbi.1005294.ref065">65</xref>], which provides a criterion for choosing among alternative models for describing a set of data. This ensures, for example, that sequence regions are aligned and correlated patterns defined <italic>only</italic> when justified statistically. Likewise, for a major protein superfamily, which typically consists of more than 25,000 sequences, a phylogenetic tree is far too detailed and uncertain to be reliable. Instead, our analysis models each superfamily more simply, as hierarchically-arranged sequence subgroups, each of which is defined by the pattern that most distinguishes it from closely-related subgroups. At the same time, it adjusts posterior probabilities to account for differences in complexity between competing model architectures. This ensures creation of a hierarchical alignment only when justified statistically.</p>
<p><bold>(3)</bold> It allows the sequences themselves to reveal their statistically most striking features rather than attempting to identify predetermined types of residues. This is important because, due to the incompleteness of protein experimental annotations, training a program to recognize a predetermined subset of residues—namely those with characterized (and therefore annotated) roles, such as in catalysis and substrate recognition—biases it against correlated residue patterns with important but uncharacterized roles. Although programs trained in this way are useful, there is a need as well for the alternative approach described here. At the same time, hiMSA analysis may probabilistically predict protein function through co-classification with proteins of known function. In this way, it seeks to discover, through statistical inference, biological phenomena that thus far have evaded detection—as did classical genetic analyses.</p>
<p>In summary, hiMSA analysis comprehensively models an entire major protein superfamily in a statistically coherent manner while avoiding both under- and over-parameterization. This allows the sequences themselves to reveal biologically-relevant features, leading to the generation of plausible hypotheses for experimental follow up, as illustrated by the acetylase analysis described here.</p>
</sec>
<sec id="sec025" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec026" sec-type="intro">
<title>Background</title>
<p>This section reviews our previous MSA and BPPS statistical models used for hiMSA analysis.</p>
<p><italic>Notation and Definitions</italic>. The following notation is used for vectors <bold>v</bold> = (<italic>v</italic><sub>1</sub>,…,<italic>v</italic><sub><italic>n</italic></sub>)<sup><italic>T</italic></sup> and <bold>w</bold> = (<italic>w</italic><sub>1</sub>,…,<italic>w</italic><sub><italic>n</italic></sub>)<sup><italic>T</italic></sup>: |<bold>v</bold>| = |<italic>v</italic><sub>1</sub>|+…+|<italic>v</italic><sub><italic>n</italic></sub>|, <bold>v</bold> + <bold>w</bold> = (<italic>v</italic><sub>1</sub> + <italic>w</italic><sub>1</sub>,…,<italic>v</italic><sub><italic>n</italic></sub> + <italic>w</italic><sub><italic>n</italic></sub>)<sup><italic>T</italic></sup>, <bold>v</bold>/<bold>w</bold> = (<italic>v</italic><sub>1</sub>/<italic>w</italic><sub>1</sub>,…,<italic>v</italic><sub><italic>n</italic></sub>/<italic>w</italic><sub><italic>n</italic></sub>)<sup><italic>T</italic></sup>, <inline-formula id="pcbi.1005294.e005"><alternatives><graphic id="pcbi.1005294.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:msup><mml:mi mathvariant="bold">v</mml:mi><mml:mi mathvariant="bold">w</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mn>…</mml:mn><mml:msub><mml:mi>v</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:msub><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>, and Γ(<bold>v</bold>) = Γ(<italic>v</italic><sub>1</sub>)…Γ(<italic>v</italic><sub><italic>n</italic></sub>). Given <italic>K</italic> proteins, their sequences are defined by <inline-formula id="pcbi.1005294.e006"><alternatives><graphic id="pcbi.1005294.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:mn>…</mml:mn><mml:mo>,</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mi>K</mml:mi><mml:mi>T</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> where each vector <inline-formula id="pcbi.1005294.e007"><alternatives><graphic id="pcbi.1005294.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mn>…</mml:mn><mml:mo>,</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mi>k</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> corresponds to the <italic>k</italic>-th sequence, <italic>n</italic><sub><italic>k</italic></sub> is the <italic>k</italic>-th sequence’s length and the <italic>r</italic><sub><italic>k</italic>,<italic>i</italic></sub> corresponds to the <italic>i</italic>-th residue in that sequence. <bold>h</bold>( ) defines a counting function where, for example, <bold>h</bold>(<italic>R</italic><sub><italic>k</italic></sub>) returns a length 20 vector of the counts for the residue types in <italic>R</italic><sub><italic>k</italic></sub>; 〈.,.〉 denotes the inner product of 2 vectors.</p>
<p><italic>MSA sampling</italic>. Given a sequence alignment of <italic>w</italic> columns, the set of variables defining the sequence positions for column <italic>j</italic> is defined by <italic>A</italic><sub><italic>j</italic></sub> = {<italic>a</italic><sub>1,<italic>j</italic></sub>,…,<italic>a</italic><sub><italic>K</italic>,<italic>j</italic></sub>} so that the alignment is defined by the matrix <bold>A</bold> = (<italic>A</italic><sub>1</sub>,…,<italic>A</italic><sub><italic>w</italic></sub>)<sup><italic>T</italic></sup>. We define <italic>A</italic><sub><italic>j</italic>[−<italic>k</italic>]</sub> ≡ <italic>A</italic><sub><italic>j</italic></sub> − {<italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub>} to denote the set <italic>A</italic><sub><italic>j</italic></sub> without <italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub> and define {<bold>A</bold>} ≡ {<italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub>: <italic>k</italic> = 1,..,<italic>K</italic>, <italic>j</italic> = 1,…,<italic>w</italic>} to denote the set of residues indices for the alignment variable <bold>A</bold>. We represent the collection of residues indexed by elements in a set C as <bold>R</bold><sub><italic>C</italic></sub>. For instance, <bold>R</bold><sub>{<bold>A</bold>}</sub> = {<italic>a</italic><sub><italic>k</italic>,<italic>j</italic></sub>: <italic>k</italic> = 1,…,<italic>K</italic>; <italic>j</italic> = 1,…<italic>w</italic>} represents the set of residues in the alignment defined by <bold>A</bold>.</p>
<p>Ignoring insertions and deletions (indels), the MSA posterior distribution [<xref ref-type="bibr" rid="pcbi.1005294.ref069">69</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref071">71</xref>] is defined by:
<disp-formula id="pcbi.1005294.e008">
<alternatives>
<graphic id="pcbi.1005294.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e008" xlink:type="simple"/>
<mml:math display="block" id="M8">
<mml:mrow><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msup></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">β</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:munderover><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi mathvariant="bold">h</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi mathvariant="bold">β</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where <bold>X</bold> defines a <italic>w</italic> column alignment; <bold>R</bold> specifies the sequences; <inline-formula id="pcbi.1005294.e009"><alternatives><graphic id="pcbi.1005294.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi mathvariant="bold">X</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005294.e010"><alternatives><graphic id="pcbi.1005294.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e010" xlink:type="simple"/><mml:math display="inline" id="M10"><mml:mrow><mml:msub><mml:mi mathvariant="bold">R</mml:mi><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msup></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> specify the residues in column <italic>j</italic> of the alignment and outside of aligned columns, respectively; and <bold>β</bold><sub><italic>j</italic></sub> and <bold>β</bold><sub>0</sub> specify the numbers of pseudocounts in each column <italic>j</italic> and in the background, respectively. We model indels based on the <bold>hidden Markov model (HMM)</bold> shown in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s001">S1.1 Fig</xref></bold>. The sampler infers position-specific gap penalties, as follows: For a given alignment, each sequence is associated with a “path” through the HMM indicating its alignment against the model. We denote the collection of these paths by Λ, the total number of HMM transitions of type M→M, M→I, …, D→D at position <italic>j</italic> by <italic>N</italic><sub><italic>mm</italic></sub>[<italic>j</italic>], <italic>N</italic><sub><italic>mi</italic></sub>[<italic>j</italic>], …, <italic>N</italic><sub><italic>dd</italic></sub>[<italic>j</italic>], and corresponding prior pseudocounts by <italic>n</italic><sub><italic>mm</italic></sub>,…,<italic>n</italic><sub><italic>dd</italic></sub>. The contribution of implicit gap penalties to the overall probability, after integrating out position-specific transition probabilities (<inline-formula id="pcbi.1005294.e011"><alternatives><graphic id="pcbi.1005294.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:mrow><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math></alternatives></inline-formula>), is:
<disp-formula id="pcbi.1005294.e012">
<alternatives>
<graphic id="pcbi.1005294.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e012" xlink:type="simple"/>
<mml:math display="block" id="M12">
<mml:mtable><mml:mtr><mml:mtd><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∬</mml:mo><mml:mrow><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">|</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold">ι</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>d</mml:mi><mml:mover accent="true"><mml:mi mathvariant="bold">δ</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>w</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mo>×</mml:mo><mml:mfrac><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mi>j</mml:mi><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>⋅</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi mathvariant="normal">Γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>n</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>m</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>This gives rise to a new posterior distribution
<disp-formula id="pcbi.1005294.e013">
<alternatives>
<graphic id="pcbi.1005294.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e013" xlink:type="simple"/>
<mml:math display="block" id="M13">
<mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="bold">R</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="bold">X</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>×</mml:mo><mml:mi>π</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi mathvariant="normal">Λ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>,</mml:mo>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
for which the transition probability parameters need not be fixed or updated and which allows the gap penalties to be determined from the sequence data [<xref ref-type="bibr" rid="pcbi.1005294.ref063">63</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref071">71</xref>].</p>
<p><italic>BPPS sampling</italic>. A hierarchical alignment consists of a MSA, a tree—each node of which corresponds to a <bold>contrast alignment</bold> (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2B</xref></bold>)—and a set of labels assigning each aligned sequence to one of the nodes. Each contrast alignment consists of a pattern and a <bold>foreground</bold> or a <bold>background</bold> partition corresponding, respectively, to the subtree rooted at that node and to the rest of the subtree rooted at the parent of that node. By sampling over alternative sequence and pattern assignments, our BPPS sampler seeks to optimally partition the sequences into subgroups where the foreground sequences conserve a pattern that the background sequences do not [<xref ref-type="bibr" rid="pcbi.1005294.ref021">21</xref>]. MCMC sampling is required because, <italic>a priori</italic>, we know neither which sequences belong to each node, nor which positions are pattern positions, nor which residues are conserved at each pattern position. The sampler also seeks to optimize the number of nodes and the relationships between nodes (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2C</xref></bold>). Thus the sampler favors convergence on a hierarchy where the pattern and partitioning for each node best distinguishes its foreground from its background. The probability of the data given the parameters of the BPPS statistical model is defined (logarithmically) as:
<disp-formula id="pcbi.1005294.e014">
<alternatives>
<graphic id="pcbi.1005294.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e014" xlink:type="simple"/>
<mml:math display="block" id="M14">
<mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi mathvariant="bold">X</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi mathvariant="bold">H</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">S</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">A</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">α</mml:mi><mml:mo>,</mml:mo><mml:mi mathvariant="bold">Θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mi mathvariant="bold">H</mml:mi><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mi>h</mml:mi><mml:mo>+</mml:mo></mml:msubsup><mml:mo>∪</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mi>h</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mspace width="0.25em"/><mml:msub><mml:mi mathvariant="bold">θ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>∈</mml:mo><mml:msubsup><mml:mi>H</mml:mi><mml:mi>h</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>z</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>k</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>⟨</mml:mo><mml:mrow><mml:mi mathvariant="normal">log</mml:mi><mml:mfrac><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">θ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msub><mml:mi mathvariant="bold">θ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>⟩</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
where <bold>X</bold> defines a sequence alignment of <italic>k</italic> columns, the probability of which is defined by <bold>Eq (<xref ref-type="disp-formula" rid="pcbi.1005294.e013">3</xref>)</bold> and from which the BPPS sampler infers <bold>H</bold>,<bold>S</bold>,<bold>A</bold>,<bold>α</bold>, and <bold>Θ</bold>; <bold>H</bold> defines the hierarchy with <inline-formula id="pcbi.1005294.e015"><alternatives><graphic id="pcbi.1005294.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mi>h</mml:mi><mml:mo>+</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1005294.e016"><alternatives><graphic id="pcbi.1005294.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msubsup><mml:mi>H</mml:mi><mml:mi>h</mml:mi><mml:mo>−</mml:mo></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> denoting subgroup <italic>h</italic> foreground and background node sets, respectively; <bold>S</bold> specifies assigned sequence sets for each node; <bold>A</bold> defines foreground pattern residue sets where <inline-formula id="pcbi.1005294.e017"><alternatives><graphic id="pcbi.1005294.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>∅</mml:mo><mml:mo>→</mml:mo><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula> else <inline-formula id="pcbi.1005294.e018"><alternatives><graphic id="pcbi.1005294.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:msub><mml:mi mathvariant="bold-italic">I</mml:mi><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>; <bold>α</bold> specifies the fraction of background ‘contamination’ at pattern positions in the foreground; <bold>Θ</bold> specifies residue compositions with <inline-formula id="pcbi.1005294.e019"><alternatives><graphic id="pcbi.1005294.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1005294.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msubsup><mml:mi mathvariant="bold">θ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow></mml:msubsup><mml:mo>≡</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi mathvariant="bold">θ</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>α</mml:mi><mml:mi>h</mml:mi></mml:msub><mml:msub><mml:mi mathvariant="bold-italic">A</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> specifying the foreground and <bold>θ</bold><sub><italic>h</italic>,<italic>j</italic></sub> the background. See [<xref ref-type="bibr" rid="pcbi.1005294.ref021">21</xref>–<xref ref-type="bibr" rid="pcbi.1005294.ref024">24</xref>] for details.</p>
</sec>
<sec id="sec027">
<title>The hiHMM/hiMSA sampler</title>
<p>Steps 1 and 2 in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold> are accomplished using our recently described MSA [<xref ref-type="bibr" rid="pcbi.1005294.ref063">63</xref>] and BPPS [<xref ref-type="bibr" rid="pcbi.1005294.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref024">24</xref>] samplers, respectively. This results in a <italic>w</italic>-column alignment, the sequences of which are partitioned into hierarchically-arranged subgroups. Converting this into a hiMSA (Step 3 in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold>) involves the following: <bold>(i)</bold> Applying MSA sampling to refine the alignment of each set of subgroup sequences, starting with the root node’s child subtrees and recursively progressing to descendant subtrees. This will extend sub-alignments into subgroup-specific insert regions and will remove regions from each sub-alignment that are deleted relative to its corresponding super-alignment (see <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s001">S1.2 Fig</xref></bold>). To improve speed, all but one among each set of highly similar sequences (e.g., ≥ 95% identity) may be removed. <bold>(ii)</bold> The lineage-specific alignments are aligned to each other (based on the hierarchy) to construct a set of template alignments, as illustrated schematically in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s001">S1.2C Fig</xref></bold>. These templates define how each of the subtrees is aligned to its parent node, which is important for defining BPPS foreground and background frequencies (see Eq (<xref ref-type="disp-formula" rid="pcbi.1005294.e014">4</xref>)). <bold>(iii)</bold> Apply BPPS sampling to find additional pattern positions within subgroup-specific insert regions. Because these insert regions are absent from the background alignment, standard amino acid residue frequencies are used as the background. <bold>(iv)</bold> Finally, BPPS sampling is performed to further refine the hiMSA and thus the hiHMM.</p>
<p>This process creates a hierarchical alignment, for which the sequences assigned to each subtree in the hierarchy are more or less optimally aligned for that subtree. In other words, only those regions that are conserved across each subtree’s sequence set are aligned—as is illustrated schematically in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2D</xref></bold>. The hiHMM defined by this process can be used to search the protein database using MAPGAPS [<xref ref-type="bibr" rid="pcbi.1005294.ref067">67</xref>].</p>
</sec>
<sec id="sec028">
<title>Visualizing sequence information</title>
<p>Since the focus of our analysis is on large, functionally diverse protein superfamilies, hiHMM sampling produces a large amount of output. To make this output intelligible, several procedures are used to summarize the results. First, for each leaf node hierarchical contrast alignments (as shown schematically in <bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2B</xref></bold>) are created. This is illustrated in <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s002">S2.2, S2.3</xref></bold> and <bold><xref ref-type="supplementary-material" rid="pcbi.1005294.s003">S3</xref> Figs</bold>, which show the set of contrast alignments corresponding to the lineages from the root to various leaf nodes, with one contrast alignment for each node along the lineage. In essence, each lineage-contrast-alignment decomposes the constraints imposed on the sequences assigned to that leaf node. This is perhaps the most important information obtained from the analysis. These lineages, one for each of the leaf nodes, are concatenated into a single rich text format (rtf) file as output. Another previously-described [<xref ref-type="bibr" rid="pcbi.1005294.ref076">76</xref>] procedure evaluates the run-to-run consistency of the hierarchical alignment obtained.</p>
</sec>
<sec id="sec029">
<title>Implementation</title>
<p>The key steps of hiMSA analysis (<bold><xref ref-type="fig" rid="pcbi.1005294.g002">Fig 2A</xref></bold>) were implemented in the following C++ programs: MAPGAPS [<xref ref-type="bibr" rid="pcbi.1005294.ref067">67</xref>] identifies and initially aligns related sequences and the GISMO sampler [<xref ref-type="bibr" rid="pcbi.1005294.ref063">63</xref>] improves the alignment (step 1). The omcBPPS sampler [<xref ref-type="bibr" rid="pcbi.1005294.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1005294.ref024">24</xref>] classifies the aligned sequences into a hierarchy (step 2). The hieraln and hierview programs (first described here) create and optimize a hiMSA and output lineage-specific alignments, respectively (step 3). MAPGAPS can use an existing hiMSA to identify, align and hierarchically classify previously identified and new database sequences. Finally, the hierview program also creates output files for viewing key structural features using PyMOL (step 4), as was illustrated here.</p>
</sec>
</sec>
<sec id="sec030">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1005294.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>The hiHMM, hiMSA and full acetylase hierarchy.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005294.s002" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Gna1 hiMSA analysis compared to analyses using other methods and to hiMSA analyses of other acetylases</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005294.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.s003" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>hiMSA contrast hierarchical alignment of node-35 lineages.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005294.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.s004" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>NAT root node alignment consisting of the consensus residues in each column position for each node in the hierarchy.</title>
<p>The sequences used for the acetylase analysis are available at psed.igs.umaryland.edu.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1005294.s005" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1005294.s005" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Comparisons between BPPS-optimized and CDD-curated protein domain hierarchies.</title>
<p>These figures were adapted from [<xref ref-type="bibr" rid="pcbi.1005294.ref023">23</xref>].</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank L. Aravind for critical assessment of hiMSA analysis output and for helpful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1005294.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mendel</surname> <given-names>G</given-names></name>. <article-title>Versuche über Pflanzen Hybriden</article-title>. <source>Verhandlungen des Naturforschenden Vereines Brünn</source>. <year>1866</year>;<volume>4</volume>:<fpage>3</fpage>–<lpage>47</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arnesen</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Anderson</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Baldersheim</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lanotte</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Varhaug</surname> <given-names>JE</given-names></name>, <name name-style="western"><surname>Lillehaug</surname> <given-names>JR</given-names></name>. <article-title>Identification and characterization of the human ARD1-NATH protein acetyltransferase complex</article-title>. <source>Biochem J</source>. <year>2005</year>;<volume>386</volume>(<issue>Pt 3</issue>):<fpage>433</fpage>–<lpage>43</lpage>. PubMed Central PMCID: PMCPMC1134861. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1042/BJ20041071" xlink:type="simple">10.1042/BJ20041071</ext-link></comment> <object-id pub-id-type="pmid">15496142</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Parliament</surname> <given-names>MB</given-names></name>. <article-title>Radiogenomics: associations in all the wrong places?</article-title> <source>Lancet Oncol</source>. <year>2012</year>;<volume>13</volume>(<issue>1</issue>):<fpage>7</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1470-2045(11)70331-X" xlink:type="simple">10.1016/S1470-2045(11)70331-X</ext-link></comment> <object-id pub-id-type="pmid">22169270</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ioannidis</surname> <given-names>JP</given-names></name>. <article-title>Why most published research findings are false</article-title>. <source>PLoS Med</source>. <year>2005</year>;<volume>2</volume>(<issue>8</issue>):<fpage>e124</fpage>. PubMed Central PMCID: PMCPMC1182327. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pmed.0020124" xlink:type="simple">10.1371/journal.pmed.0020124</ext-link></comment> <object-id pub-id-type="pmid">16060722</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hayat</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Elofsson</surname> <given-names>A</given-names></name>. <article-title>All-atom 3D structure prediction of transmembrane beta-barrel proteins from sequences</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2015</year>;<volume>112</volume>(<issue>17</issue>):<fpage>5413</fpage>–<lpage>8</lpage>. PubMed Central PMCID: PMC4418893. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1419956112" xlink:type="simple">10.1073/pnas.1419956112</ext-link></comment> <object-id pub-id-type="pmid">25858953</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rost</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>. <article-title>Three-dimensional structures of membrane proteins from genomic sequencing</article-title>. <source>Cell</source>. <year>2012</year>;<volume>149</volume>(<issue>7</issue>):<fpage>1607</fpage>–<lpage>21</lpage>. PubMed Central PMCID: PMC3641781. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2012.04.012" xlink:type="simple">10.1016/j.cell.2012.04.012</ext-link></comment> <object-id pub-id-type="pmid">22579045</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morcos</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Hwa</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Onuchic</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>. <article-title>Direct coupling analysis for protein contact prediction</article-title>. <source>Methods Mol Biol</source>. <year>2014</year>;<volume>1137</volume>:<fpage>55</fpage>–<lpage>70</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-4939-0366-5_5" xlink:type="simple">10.1007/978-1-4939-0366-5_5</ext-link></comment> <object-id pub-id-type="pmid">24573474</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morcos</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Pagnani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Lunt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Bertolino</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2011</year>;<volume>108</volume>(<issue>49</issue>):<fpage>E1293</fpage>–<lpage>301</lpage>. PubMed Central PMCID: PMC3241805. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1111471108" xlink:type="simple">10.1073/pnas.1111471108</ext-link></comment> <object-id pub-id-type="pmid">22106262</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ekeberg</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lovkvist</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Lan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Weigt</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Aurell</surname> <given-names>E</given-names></name>. <article-title>Improved contact prediction in proteins: using pseudolikelihoods to infer Potts models</article-title>. <source>Phys Rev E Stat Nonlin Soft Matter Phys</source>. <year>2013</year>;<volume>87</volume>(<issue>1</issue>):<fpage>012707</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevE.87.012707" xlink:type="simple">10.1103/PhysRevE.87.012707</ext-link></comment> <object-id pub-id-type="pmid">23410359</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Stein</surname> <given-names>RR</given-names></name>, <name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>. <article-title>Inferring Pairwise Interactions from Biological Data Using Maximum-Entropy Probability Models</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>(<issue>7</issue>):<fpage>e1004182</fpage>. PubMed Central PMCID: PMCPMC4520494. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004182" xlink:type="simple">10.1371/journal.pcbi.1004182</ext-link></comment> <object-id pub-id-type="pmid">26225866</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kannan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Haste</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Taylor</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>The hallmark of AGC kinase functional divergence is its C-terminal tail, a cis-acting regulatory module</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2007</year>;<volume>104</volume>(<issue>4</issue>):<fpage>1272</fpage>–<lpage>7</lpage>. Epub 2007/01/18. 0610251104 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0610251104" xlink:type="simple">10.1073/pnas.0610251104</ext-link></comment> <object-id pub-id-type="pmid">17227859</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kannan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Evolutionary constraints associated with functional specificity of the CMGC protein kinases MAPK, CDK, GSK, SRPK, DYRK, and CK2{alpha}</article-title>. <source>Protein Sci</source>. <year>2004</year>;<volume>13</volume>(<issue>8</issue>):<fpage>2059</fpage>–<lpage>77</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1110/ps.04637904" xlink:type="simple">10.1110/ps.04637904</ext-link></comment> <object-id pub-id-type="pmid">15273306</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kannan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Did protein kinase regulatory mechanisms evolve through elaboration of a simple structural component?</article-title> <source>J Mol Biol</source>. <year>2005</year>;<volume>351</volume>(<issue>5</issue>):<fpage>956</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmb.2005.06.057" xlink:type="simple">10.1016/j.jmb.2005.06.057</ext-link></comment> <object-id pub-id-type="pmid">16051269</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Evolutionary clues to DNA polymerase III beta clamp structural mechanisms</article-title>. <source>Nucleic Acids Res</source>. <year>2003</year>;<volume>31</volume>(<issue>15</issue>):<fpage>4503</fpage>–<lpage>16</lpage>. <object-id pub-id-type="pmid">12888511</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Bayesian shadows of molecular mechanisms cast in the light of evolution</article-title>. <source>Trends Biochem Sciences</source>. <year>2006</year>;<volume>31</volume>(<issue>7</issue>):<fpage>374</fpage>–<lpage>82</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Gα-Gβγ dissociation may be due to retraction of a buried lysine and disruption of an aromatic cluster by a GTP-sensing Arg-Trp pair</article-title>. <source>Protein Science</source>. <year>2007</year>;<volume>16</volume>(<issue>11</issue>):<fpage>2570</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1110/ps.073098107" xlink:type="simple">10.1110/ps.073098107</ext-link></comment> <object-id pub-id-type="pmid">17962409</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>The glycine brace: a component of Rab, Rho, and Ran GTPases associated with hinge regions of guanine- and phosphate-binding loops</article-title>. <source>BMC Struct Biol</source>. <year>2009</year>;<volume>9</volume>:<fpage>11</fpage>. Epub 2009/03/07. 1472-6807-9-11 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1472-6807-9-11" xlink:type="simple">10.1186/1472-6807-9-11</ext-link></comment> <object-id pub-id-type="pmid">19265520</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>The charge-dipole pocket: a defining feature of signaling pathway GTPase on/off switches</article-title>. <source>J Mol Biol</source>. <year>2009</year>;<volume>390</volume>(<issue>1</issue>):<fpage>142</fpage>–<lpage>53</lpage>. Epub 2009/05/12. S0022-2836(09)00550-6 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmb.2009.05.001" xlink:type="simple">10.1016/j.jmb.2009.05.001</ext-link></comment> <object-id pub-id-type="pmid">19427324</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oruganty</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Talevich</surname> <given-names>EE</given-names></name>, <name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Kannan</surname> <given-names>N</given-names></name>. <article-title>Identification and classification of small molecule kinases: insights into substrate recognition and specificity</article-title>. <source>BMC Evol Biol</source>. <year>2016</year>;<volume>16</volume>(<issue>1</issue>):<fpage>7</fpage>. PubMed Central PMCID: PMCPMC4702295.</mixed-citation></ref>
<ref id="pcbi.1005294.ref020"><label>20</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>. <source>Monte Carlo Strategies in Scientific Computing</source>. <publisher-loc>New York</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>2008</year>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Kannan</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Poleksic</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hata</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>. <article-title>Ran's C-terminal, basic patch and nucleotide exchange mechanisms in light of a canonical structure for Rab, Rho, Ras and Ran GTPases</article-title>. <source>Genome Res</source>. <year>2003</year>;<volume>13</volume>(<issue>4</issue>):<fpage>673</fpage>–<lpage>92</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.862303" xlink:type="simple">10.1101/gr.862303</ext-link></comment> <object-id pub-id-type="pmid">12671004</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Surveying the manifold divergence of an entire protein class for statistical clues to underlying biochemical mechanisms</article-title>. <source>Statistical applications in genetics and molecular biology</source>. <year>2011</year>;<volume>10</volume>(<issue>1</issue>):<fpage>36</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>A Bayesian sampler for optimization of protein domain hierarchies</article-title>. <source>Journal of computational biology: a journal of computational molecular cell biology</source>. <year>2014</year>;<volume>21</volume>(<issue>3</issue>):<fpage>269</fpage>–<lpage>86</lpage>. PubMed Central PMCID: PMCPMC3948484.</mixed-citation></ref>
<ref id="pcbi.1005294.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Protein domain hierarchy Gibbs sampling strategies</article-title>. <source>Statistical applications in genetics and molecular biology</source>. <year>2014</year>;<volume>13</volume>(<issue>4</issue>):<fpage>497</fpage>–<lpage>517</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1515/sagmb-2014-0008" xlink:type="simple">10.1515/sagmb-2014-0008</ext-link></comment> <object-id pub-id-type="pmid">24988248</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kirkpatrick</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Gelatt</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Vecchi</surname> <given-names>MP</given-names></name>. <article-title>Optimization by simulated annealing</article-title>. <source>Science</source>. <year>1983</year>;<volume>220</volume>:<fpage>671</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.220.4598.671" xlink:type="simple">10.1126/science.220.4598.671</ext-link></comment> <object-id pub-id-type="pmid">17813860</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lunter</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Miklos</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Drummond</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Jensen</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Hein</surname> <given-names>J</given-names></name>. <article-title>Bayesian coestimation of phylogeny and sequence alignment</article-title>. <source>BMC Bioinformatics</source>. <year>2005</year>;<volume>6</volume>:<fpage>83</fpage>. Epub 2005/04/05. 1471-2105-6-83 [pii].PubMed Central PMCID: PMC1087833. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-6-83" xlink:type="simple">10.1186/1471-2105-6-83</ext-link></comment> <object-id pub-id-type="pmid">15804354</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Redelings</surname> <given-names>BD</given-names></name>, <name name-style="western"><surname>Suchard</surname> <given-names>MA</given-names></name>. <article-title>Joint Bayesian estimation of alignment and phylogeny</article-title>. <source>Syst Biol</source>. <year>2005</year>;<volume>54</volume>(<issue>3</issue>):<fpage>401</fpage>–<lpage>18</lpage>. Epub 2005/07/14. G84466WX373376N1 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1080/10635150590947041" xlink:type="simple">10.1080/10635150590947041</ext-link></comment> <object-id pub-id-type="pmid">16012107</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Suchard</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Redelings</surname> <given-names>BD</given-names></name>. <article-title>BAli-Phy: simultaneous Bayesian inference of alignment and phylogeny</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>16</issue>):<fpage>2047</fpage>–<lpage>8</lpage>. Epub 2006/05/09. btl175 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl175" xlink:type="simple">10.1093/bioinformatics/btl175</ext-link></comment> <object-id pub-id-type="pmid">16679334</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Novak</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Miklos</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Lyngso</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Hein</surname> <given-names>J</given-names></name>. <article-title>StatAlign: an extendable software package for joint Bayesian estimation of alignments and evolutionary trees</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>20</issue>):<fpage>2403</fpage>–<lpage>4</lpage>. Epub 2008/08/30. btn457 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn457" xlink:type="simple">10.1093/bioinformatics/btn457</ext-link></comment> <object-id pub-id-type="pmid">18753153</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hagopian</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Davidson</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Datta</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Samad</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Jarvis</surname> <given-names>GR</given-names></name>, <name name-style="western"><surname>Sjölander</surname> <given-names>K</given-names></name>. <article-title>SATCHMO-JS: a webserver for simultaneous protein multiple sequence alignment and phylogenetic tree construction</article-title>. <source>Nucleic Acids Res</source>. <year>2010</year>;<volume>38</volume>(Web Server issue):<fpage>W29</fpage>–<lpage>34</lpage>. Epub 2010/05/01. gkq298 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkq298" xlink:type="simple">10.1093/nar/gkq298</ext-link></comment> <object-id pub-id-type="pmid">20430824</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Herman</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Challis</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Novak</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hein</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Schmidler</surname> <given-names>SC</given-names></name>. <article-title>Simultaneous Bayesian estimation of alignment and phylogeny under a joint model of protein sequence and structure</article-title>. <source>Mol Biol Evol</source>. <year>2014</year>;<volume>31</volume>(<issue>9</issue>):<fpage>2251</fpage>–<lpage>66</lpage>. PubMed Central PMCID: PMC4137710. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/molbev/msu184" xlink:type="simple">10.1093/molbev/msu184</ext-link></comment> <object-id pub-id-type="pmid">24899668</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Warnow</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Holder</surname> <given-names>MT</given-names></name>, <name name-style="western"><surname>Nelesen</surname> <given-names>SM</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Stamatakis</surname> <given-names>AP</given-names></name>, <etal>et al</etal>. <article-title>SATe-II: very fast and accurate simultaneous estimation of multiple sequence alignments and phylogenetic trees</article-title>. <source>Syst Biol</source>. <year>2012</year>;<volume>61</volume>(<issue>1</issue>):<fpage>90</fpage>–<lpage>106</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/sysbio/syr095" xlink:type="simple">10.1093/sysbio/syr095</ext-link></comment> <object-id pub-id-type="pmid">22139466</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Casari</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Valencia</surname> <given-names>A</given-names></name>. <article-title>A method to predict functional residues in proteins</article-title>. <source>Nat Struct Biol</source>. <year>1995</year>;<volume>2</volume>(<issue>2</issue>):<fpage>171</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">7749921</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ye</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Feenstra</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Heringa</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ijzerman</surname> <given-names>AP</given-names></name>, <name name-style="western"><surname>Marchiori</surname> <given-names>E</given-names></name>. <article-title>Multi-RELIEF: a method to recognize specificity determining residues from multiple sequence alignments using a Machine-Learning approach for feature weighting</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>1</issue>):<fpage>18</fpage>–<lpage>25</lpage>. Epub 2007/11/21. btm537 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm537" xlink:type="simple">10.1093/bioinformatics/btm537</ext-link></comment> <object-id pub-id-type="pmid">18024975</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pirovano</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Feenstra</surname> <given-names>KA</given-names></name>, <name name-style="western"><surname>Heringa</surname> <given-names>J</given-names></name>. <article-title>Sequence comparison by sequence harmony identifies subtype-specific functional sites</article-title>. <source>Nucleic Acids Res</source>. <year>2006</year>;<volume>34</volume>(<issue>22</issue>):<fpage>6540</fpage>–<lpage>8</lpage>. PubMed Central PMCID: PMCPMC1702503. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkl901" xlink:type="simple">10.1093/nar/gkl901</ext-link></comment> <object-id pub-id-type="pmid">17130172</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kalinina</surname> <given-names>OV</given-names></name>, <name name-style="western"><surname>Mironov</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Gelfand</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Rakhmaninova</surname> <given-names>AB</given-names></name>. <article-title>Automated selection of positions determining functional specificity of proteins by comparative analysis of orthologous groups in protein families</article-title>. <source>Protein Sci</source>. <year>2004</year>;<volume>13</volume>(<issue>2</issue>):<fpage>443</fpage>–<lpage>56</lpage>. Epub 2004/01/24. 13/2/443 [pii]. PubMed Central PMCID: PMC2286703. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1110/ps.03191704" xlink:type="simple">10.1110/ps.03191704</ext-link></comment> <object-id pub-id-type="pmid">14739328</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hannenhalli</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Russell</surname> <given-names>RB</given-names></name>. <article-title>Analysis and prediction of functional sub-types from protein sequence alignments</article-title>. <source>J Mol Biol</source>. <year>2000</year>;<volume>303</volume>(<issue>1</issue>):<fpage>61</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.2000.4036" xlink:type="simple">10.1006/jmbi.2000.4036</ext-link></comment> <object-id pub-id-type="pmid">11021970</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Livingstone</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Barton</surname> <given-names>GJ</given-names></name>. <article-title>Identification of functional residues and secondary structure from protein multiple sequence alignment</article-title>. <source>Methods Enzymol</source>. <year>1996</year>;<volume>266</volume>:<fpage>497</fpage>–<lpage>512</lpage>. Epub 1996/01/01. <object-id pub-id-type="pmid">8743702</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mihalek</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Res</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Lichtarge</surname> <given-names>O</given-names></name>. <article-title>A family of evolution-entropy hybrid methods for ranking protein residues by importance</article-title>. <source>J Mol Biol</source>. <year>2004</year>;<volume>336</volume>(<issue>5</issue>):<fpage>1265</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jmb.2003.12.078" xlink:type="simple">10.1016/j.jmb.2003.12.078</ext-link></comment> <object-id pub-id-type="pmid">15037084</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mirny</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Gelfand</surname> <given-names>MS</given-names></name>. <article-title>Using orthologous and paralogous proteins to identify specificity determining residues</article-title>. <source>Genome Biol</source>. <year>2002</year>;<volume>3</volume>(<issue>3</issue>):<fpage>PREPRINT0002</fpage>. <object-id pub-id-type="pmid">11897020</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lichtarge</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Bourne</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>FE</given-names></name>. <article-title>An evolutionary trace method defines binding surfaces common to protein families</article-title>. <source>J Mol Biol</source>. <year>1996</year>;<volume>257</volume>(<issue>2</issue>):<fpage>342</fpage>–<lpage>58</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1006/jmbi.1996.0167" xlink:type="simple">10.1006/jmbi.1996.0167</ext-link></comment> <object-id pub-id-type="pmid">8609628</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sankararaman</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sjölander</surname> <given-names>K</given-names></name>. <article-title>INTREPID—INformation-theoretic TREe traversal for Protein functional site IDentification</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>21</issue>):<fpage>2445</fpage>–<lpage>52</lpage>. Epub 2008/09/09. btn474 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn474" xlink:type="simple">10.1093/bioinformatics/btn474</ext-link></comment> <object-id pub-id-type="pmid">18776193</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fischer</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Mayer</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Söding</surname> <given-names>J</given-names></name>. <article-title>Prediction of protein functional residues from sequence by probability density estimation</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>5</issue>):<fpage>613</fpage>–<lpage>20</lpage>. Epub 2008/01/05. btm626 [pii]. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btm626" xlink:type="simple">10.1093/bioinformatics/btm626</ext-link></comment> <object-id pub-id-type="pmid">18174181</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kalinina</surname> <given-names>OV</given-names></name>, <name name-style="western"><surname>Gelfand</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Russell</surname> <given-names>RB</given-names></name>. <article-title>Combining specificity determining and conserved residues improves functional site prediction</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>;<volume>10</volume>:<fpage>174</fpage>. Epub 2009/06/11. 1471-2105-10-174 [pii]. PubMed Central PMCID: PMC2709924. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-10-174" xlink:type="simple">10.1186/1471-2105-10-174</ext-link></comment> <object-id pub-id-type="pmid">19508719</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Janda</surname> <given-names>JO</given-names></name>, <name name-style="western"><surname>Busch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kuck</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Porfenenko</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Merkl</surname> <given-names>R</given-names></name>. <article-title>CLIPS-1D: analysis of multiple sequence alignments to deduce for residue-positions a role in catalysis, ligand-binding, or protein structure</article-title>. <source>BMC Bioinformatics</source>. <year>2012</year>;<volume>13</volume>:<fpage>55</fpage>. PubMed Central PMCID: PMC3391178. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-13-55" xlink:type="simple">10.1186/1471-2105-13-55</ext-link></comment> <object-id pub-id-type="pmid">22480135</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Janda</surname> <given-names>JO</given-names></name>, <name name-style="western"><surname>Popal</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bauer</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Busch</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Klocke</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Spitzer</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>H2rs: deducing evolutionary and functionally important residue positions by means of an entropy and similarity based analysis of multiple sequence alignments</article-title>. <source>BMC Bioinformatics</source>. <year>2014</year>;<volume>15</volume>:<fpage>118</fpage>. PubMed Central PMCID: PMC4021312. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-15-118" xlink:type="simple">10.1186/1471-2105-15-118</ext-link></comment> <object-id pub-id-type="pmid">24766829</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marttinen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Corander</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Toronen</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Holm</surname> <given-names>L</given-names></name>. <article-title>Bayesian search of functionally divergent protein subgroups and their function specific residues</article-title>. <source>Bioinformatics</source>. <year>2006</year>;<volume>22</volume>(<issue>20</issue>):<fpage>2466</fpage>–<lpage>74</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btl411" xlink:type="simple">10.1093/bioinformatics/btl411</ext-link></comment> <object-id pub-id-type="pmid">16870932</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kolesov</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Mirny</surname> <given-names>LA</given-names></name>. <article-title>Using evolutionary information to find specificity-determining and co-evolving residues</article-title>. <source>Methods Mol Biol</source>. <year>2009</year>;<volume>541</volume>:<fpage>421</fpage>–<lpage>48</lpage>. Epub 2009/04/22. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-59745-243-4_18" xlink:type="simple">10.1007/978-1-59745-243-4_18</ext-link></comment> <object-id pub-id-type="pmid">19381538</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilkins</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Erdin</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Lua</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Lichtarge</surname> <given-names>O</given-names></name>. <article-title>Evolutionary trace for prediction and redesign of protein functional sites</article-title>. <source>Methods Mol Biol</source>. <year>2012</year>;<volume>819</volume>:<fpage>29</fpage>–<lpage>42</lpage>. Epub 2011/12/21. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-61779-465-0_3" xlink:type="simple">10.1007/978-1-61779-465-0_3</ext-link></comment> <object-id pub-id-type="pmid">22183528</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chakraborty</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chakrabarti</surname> <given-names>S</given-names></name>. <article-title>A survey on prediction of specificity-determining sites in proteins</article-title>. <source>Brief Bioinform</source>. <year>2015</year>;<volume>16</volume>(<issue>1</issue>):<fpage>71</fpage>–<lpage>88</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bib/bbt092" xlink:type="simple">10.1093/bib/bbt092</ext-link></comment> <object-id pub-id-type="pmid">24413183</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Capra</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>M</given-names></name>. <article-title>Characterization and prediction of residues determining protein functional specificity</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>(<issue>13</issue>):<fpage>1473</fpage>–<lpage>80</lpage>. PubMed Central PMCID: PMCPMC2718669. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btn214" xlink:type="simple">10.1093/bioinformatics/btn214</ext-link></comment> <object-id pub-id-type="pmid">18450811</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gaucher</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Gu</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Miyamoto</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Benner</surname> <given-names>SA</given-names></name>. <article-title>Predicting functional divergence in protein evolution by site-specific rate shifts</article-title>. <source>Trends Biochem Sci</source>. <year>2002</year>;<volume>27</volume>(<issue>6</issue>):<fpage>315</fpage>–<lpage>21</lpage>. <object-id pub-id-type="pmid">12069792</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xin</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Radivojac</surname> <given-names>P</given-names></name>. <article-title>Computational methods for identification of functional residues in protein structures</article-title>. <source>Curr Protein Pept Sci</source>. <year>2011</year>;<volume>12</volume>(<issue>6</issue>):<fpage>456</fpage>–<lpage>69</lpage>. Epub 2011/07/27. CPPS-146 [pii]. <object-id pub-id-type="pmid">21787297</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chakrabarti</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Panchenko</surname> <given-names>AR</given-names></name>. <article-title>Ensemble approach to predict specificity determinants: benchmarking and validation</article-title>. <source>BMC Bioinformatics</source>. <year>2009</year>;<volume>10</volume>:<fpage>207</fpage>. Epub 2009/07/04. 1471-2105-10-207 [pii]. PubMed Central PMCID: PMC2716344. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1186/1471-2105-10-207" xlink:type="simple">10.1186/1471-2105-10-207</ext-link></comment> <object-id pub-id-type="pmid">19573245</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dessimoz</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Skunca</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Thomas</surname> <given-names>PD</given-names></name>. <article-title>CAFA and the open world of protein function predictions</article-title>. <source>Trends in genetics: TIG</source>. <year>2013</year>;<volume>29</volume>(<issue>11</issue>):<fpage>609</fpage>–<lpage>10</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2013.09.005" xlink:type="simple">10.1016/j.tig.2013.09.005</ext-link></comment> <object-id pub-id-type="pmid">24138813</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref056"><label>56</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jiang</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Clark</surname> <given-names>WT</given-names></name>, <name name-style="western"><surname>Friedberg</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Radivojac</surname> <given-names>P</given-names></name>. <article-title>The impact of incomplete knowledge on the evaluation of protein function prediction: a structured-output learning perspective</article-title>. <source>Bioinformatics</source>. <year>2014</year>;<volume>30</volume>(<issue>17</issue>):<fpage>i609</fpage>–<lpage>16</lpage>. PubMed Central PMCID: PMC4147924. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btu472" xlink:type="simple">10.1093/bioinformatics/btu472</ext-link></comment> <object-id pub-id-type="pmid">25161254</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref057"><label>57</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>MUSCLE: a multiple sequence alignment method with reduced time and space complexity</article-title>. <source>BMC Bioinformatics</source>. <year>2004</year>;<volume>5</volume>(<issue>1</issue>):<fpage>113</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref058"><label>58</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Misawa</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kuma</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Miyata</surname> <given-names>T</given-names></name>. <article-title>MAFFT: a novel method for rapid multiple sequence alignment based on fast Fourier transform</article-title>. <source>Nucleic Acids Res</source>. <year>2002</year>;<volume>30</volume>(<issue>14</issue>):<fpage>3059</fpage>–<lpage>66</lpage>. <object-id pub-id-type="pmid">12136088</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref059"><label>59</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Standley</surname> <given-names>DM</given-names></name>. <article-title>MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability</article-title>. <source>Mol Biol Evol</source>. <year>2013</year>. Epub 2013/01/19. mst010 [pii].</mixed-citation></ref>
<ref id="pcbi.1005294.ref060"><label>60</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Katoh</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Standley</surname> <given-names>DM</given-names></name>. <article-title>MAFFT: iterative refinement and additional methods</article-title>. <source>Methods Mol Biol</source>. <year>2014</year>;<volume>1079</volume>:<fpage>131</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-62703-646-7_8" xlink:type="simple">10.1007/978-1-62703-646-7_8</ext-link></comment> <object-id pub-id-type="pmid">24170399</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref061"><label>61</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sievers</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Higgins</surname> <given-names>DG</given-names></name>. <article-title>Clustal Omega, accurate alignment of very large numbers of sequences</article-title>. <source>Methods Mol Biol</source>. <year>2014</year>;<volume>1079</volume>:<fpage>105</fpage>–<lpage>16</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-62703-646-7_6" xlink:type="simple">10.1007/978-1-62703-646-7_6</ext-link></comment> <object-id pub-id-type="pmid">24170397</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref062"><label>62</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sievers</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Wilm</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dineen</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Gibson</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Karplus</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Fast, scalable generation of high-quality protein multiple sequence alignments using Clustal Omega</article-title>. <source>Mol Syst Biol</source>. <year>2011</year>;<volume>7</volume>:<fpage>539</fpage>. Epub 2011/10/13. msb201175 [pii].PubMed Central PMCID: PMC3261699. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2011.75" xlink:type="simple">10.1038/msb.2011.75</ext-link></comment> <object-id pub-id-type="pmid">21988835</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref063"><label>63</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>. <article-title>Bayesian Top-Down Protein Sequence Alignment with Inferred Position-Specific Gap Penalties</article-title>. <source>PLoS Comput Biol</source>. <year>2016</year>;<volume>12</volume>(<issue>5</issue>):<fpage>e1004936</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004936" xlink:type="simple">10.1371/journal.pcbi.1004936</ext-link></comment> <object-id pub-id-type="pmid">27192614</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref064"><label>64</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Lanczycki</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Marchler-Bauer</surname> <given-names>A</given-names></name>. <article-title>Automated hierarchical classification of protein domain subfamilies based on functionally-divergent residue signatures</article-title>. <source>BMC Bioinformatics</source>. <year>2012</year>;<volume>13</volume>(<issue>1</issue>):<fpage>144</fpage>. Epub 2012/06/26. 1471-2105-13-144 [pii].</mixed-citation></ref>
<ref id="pcbi.1005294.ref065"><label>65</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Grünwald</surname> <given-names>PD</given-names></name>. <source>The minimum description length principle</source>. <publisher-loc>Boston</publisher-loc>: <publisher-name>MIT Press</publisher-name>; <year>2007</year>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref066"><label>66</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dutta</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Burkhardt</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Young</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Swaminathan</surname> <given-names>GJ</given-names></name>, <name name-style="western"><surname>Matsuura</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Henrick</surname> <given-names>K</given-names></name>, <etal>et al</etal>. <article-title>Data deposition and annotation at the worldwide protein data bank</article-title>. <source>Mol Biotechnol</source>. <year>2009</year>;<volume>42</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>13</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/s12033-008-9127-7" xlink:type="simple">10.1007/s12033-008-9127-7</ext-link></comment> <object-id pub-id-type="pmid">19082769</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref067"><label>67</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Rapid detection, classification and accurate alignment of up to a million or more related protein sequences</article-title> <source>Bioinformatics</source>. <year>2009</year>;<volume>25</volume>(<issue>15</issue>):<fpage>1869</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btp342" xlink:type="simple">10.1093/bioinformatics/btp342</ext-link></comment> <object-id pub-id-type="pmid">19505947</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref068"><label>68</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lawrence</surname> <given-names>CE</given-names></name>, <name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Boguski</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Wootton</surname> <given-names>JC</given-names></name>. <article-title>Detecting subtle sequence signals: a Gibbs sampling strategy for multiple alignment</article-title>. <source>Science</source>. <year>1993</year>;<volume>262</volume>(<issue>5131</issue>):<fpage>208</fpage>–<lpage>14</lpage>. <object-id pub-id-type="pmid">8211139</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref069"><label>69</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>CE</given-names></name>. <article-title>Bayesian models for multiple local sequence alignment and Gibbs sampling strategies</article-title>. <source>J Am Stat Assoc</source>. <year>1995</year>;<volume>90</volume>(<issue>432</issue>):<fpage>1156</fpage>–<lpage>70</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref070"><label>70</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Lawrence</surname> <given-names>CE</given-names></name>. <article-title>Markovian structures in biological sequence alignments</article-title>. <source>JASA</source>. <year>1999</year>;<volume>94</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref071"><label>71</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>, <name name-style="western"><surname>Liu</surname> <given-names>JS</given-names></name>. <article-title>Gapped alignment of protein sequence motifs through Monte Carlo optimization of a hidden Markov model</article-title>. <source>BMC Bioinformatics</source>. <year>2004</year>;<volume>5</volume>(<issue>1</issue>):<fpage>157</fpage>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref072"><label>72</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hughey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Mian</surname> <given-names>IS</given-names></name>, <name name-style="western"><surname>Sjӧlander</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Haussler</surname> <given-names>D</given-names></name>. <article-title>Using Dirichlet mixture priors to derive hidden Markov models for protein families</article-title>. <source>Ismb</source>. <year>1993</year>;<volume>1</volume>:<fpage>47</fpage>–<lpage>55</lpage>. <object-id pub-id-type="pmid">7584370</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref073"><label>73</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nguyen</surname> <given-names>VA</given-names></name>, <name name-style="western"><surname>Boyd-Graber</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>. <article-title>Dirichlet mixtures, the Dirichlet process, and the structure of protein space</article-title>. <source>Journal of computational biology: a journal of computational molecular cell biology</source>. <year>2013</year>;<volume>20</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>18</lpage>. PubMed Central PMCID: PMC3541698.</mixed-citation></ref>
<ref id="pcbi.1005294.ref074"><label>74</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ye</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>YK</given-names></name>, <name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>. <article-title>On the inference of Dirichlet mixture priors for protein sequence comparison</article-title>. <source>Journal of computational biology</source>. <year>2011</year>;<volume>18</volume>(<issue>8</issue>):<fpage>941</fpage>–<lpage>54</lpage>. PubMed Central PMCID: PMCPMC3145951. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1089/cmb.2011.0040" xlink:type="simple">10.1089/cmb.2011.0040</ext-link></comment> <object-id pub-id-type="pmid">21702690</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref075"><label>75</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hughey</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Krogh</surname> <given-names>A</given-names></name>. <article-title>Hidden Markov models for sequence analysis: extension and analysis of the basic method</article-title>. <source>Comput Appl Biosci</source>. <year>1996</year>;<volume>12</volume>(<issue>2</issue>):<fpage>95</fpage>–<lpage>107</lpage>. <object-id pub-id-type="pmid">8744772</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref076"><label>76</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Neuwald</surname> <given-names>AF</given-names></name>. <article-title>Evaluating, comparing, and interpreting protein domain hierarchies</article-title>. <source>Journal of computational biology: a journal of computational molecular cell biology</source>. <year>2014</year>;<volume>21</volume>(<issue>4</issue>):<fpage>287</fpage>–<lpage>302</lpage>. PubMed Central PMCID: PMCPMC3962652.</mixed-citation></ref>
<ref id="pcbi.1005294.ref077"><label>77</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Henikoff</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Henikoff</surname> <given-names>JG</given-names></name>. <article-title>Position-based sequence weights</article-title>. <source>J Mol Biol</source>. <year>1994</year>;<volume>243</volume>(<issue>4</issue>):<fpage>574</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">7966282</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref078"><label>78</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Wootton</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Zaslavsky</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>YK</given-names></name>. <article-title>The construction and use of log-odds substitution scores for multiple sequence alignment</article-title>. <source>PLoS Comput Biol</source>. <year>2010</year>;<volume>6</volume>(<issue>7</issue>):<fpage>e1000852</fpage>. Epub 2010/07/27. PubMed Central PMCID: PMC2904766. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000852" xlink:type="simple">10.1371/journal.pcbi.1000852</ext-link></comment> <object-id pub-id-type="pmid">20657661</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref079"><label>79</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Koshy</surname> <given-names>T</given-names></name>. <source>Catalan numbers with applications</source>. <publisher-loc>Oxford; New York</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>; <year>2009</year>. <fpage>xiv</fpage>, 422 p. p.</mixed-citation></ref>
<ref id="pcbi.1005294.ref080"><label>80</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Vardi</surname> <given-names>I</given-names></name>. <source>Computational Recreations in Mathematica</source>. <publisher-loc>Redwood City, CA</publisher-loc>: <publisher-name>Addison-Wesley</publisher-name>; <year>1991</year>. p. <fpage>187</fpage>–<lpage>99</lpage>.</mixed-citation></ref>
<ref id="pcbi.1005294.ref081"><label>81</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Altschul</surname> <given-names>SF</given-names></name>, <name name-style="western"><surname>Madden</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Schäffer</surname> <given-names>AA</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>W</given-names></name>, <etal>et al</etal>. <article-title>Gapped BLAST and PSI-BLAST: a new generation of protein database search programs</article-title>. <source>Nucleic Acids Res</source>. <year>1997</year>;<volume>25</volume>(<issue>17</issue>):<fpage>3389</fpage>–<lpage>402</lpage>. <object-id pub-id-type="pmid">9254694</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref082"><label>82</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>He</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Ding</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Bartlam</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Sun</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Le</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Qin</surname> <given-names>X</given-names></name>, <etal>et al</etal>. <article-title>Crystal structure of tabtoxin resistance protein complexed with acetyl coenzyme A reveals the mechanism for beta-lactam acetylation</article-title>. <source>J Mol Biol</source>. <year>2003</year>;<volume>325</volume>(<issue>5</issue>):<fpage>1019</fpage>–<lpage>30</lpage>. <object-id pub-id-type="pmid">12527305</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref083"><label>83</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hegde</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Chandler</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Vetting</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Blanchard</surname> <given-names>JS</given-names></name>. <article-title>Mechanistic and structural analysis of human spermidine/spermine N1-acetyltransferase</article-title>. <source>Biochemistry</source>. <year>2007</year>;<volume>46</volume>(<issue>24</issue>):<fpage>7187</fpage>–<lpage>95</lpage>. PubMed Central PMCID: PMCPMC2518666. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/bi700256z" xlink:type="simple">10.1021/bi700256z</ext-link></comment> <object-id pub-id-type="pmid">17516632</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref084"><label>84</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dorfmueller</surname> <given-names>HC</given-names></name>, <name name-style="western"><surname>Fang</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Rao</surname> <given-names>FV</given-names></name>, <name name-style="western"><surname>Blair</surname> <given-names>DE</given-names></name>, <name name-style="western"><surname>Attrill</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>van Aalten</surname> <given-names>DM</given-names></name>. <article-title>Structural and biochemical characterization of a trapped coenzyme A adduct of Caenorhabditis elegans glucosamine-6-phosphate N-acetyltransferase 1</article-title>. <source>Acta Crystallogr D Biol Crystallogr</source>. <year>2012</year>;<volume>68</volume>(<issue>Pt 8</issue>):<fpage>1019</fpage>–<lpage>29</lpage>. PubMed Central PMCID: PMCPMC3413214. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1107/S0907444912019592" xlink:type="simple">10.1107/S0907444912019592</ext-link></comment> <object-id pub-id-type="pmid">22868768</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref085"><label>85</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hentchel</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Escalante-Semerena</surname> <given-names>JC</given-names></name>. <article-title>In Salmonella enterica, the Gcn5-related acetyltransferase MddA (formerly YncA) acetylates methionine sulfoximine and methionine sulfone, blocking their toxic effects</article-title>. <source>J Bacteriol</source>. <year>2015</year>;<volume>197</volume>(<issue>2</issue>):<fpage>314</fpage>–<lpage>25</lpage>. PubMed Central PMCID: PMCPMC4272598. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1128/JB.02311-14" xlink:type="simple">10.1128/JB.02311-14</ext-link></comment> <object-id pub-id-type="pmid">25368301</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref086"><label>86</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pednekar</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tendulkar</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Durani</surname> <given-names>S</given-names></name>. <article-title>Electrostatics-defying interaction between arginine termini as a thermodynamic driving force in protein-protein interaction</article-title>. <source>Proteins</source>. <year>2009</year>;<volume>74</volume>(<issue>1</issue>):<fpage>155</fpage>–<lpage>63</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/prot.22142" xlink:type="simple">10.1002/prot.22142</ext-link></comment> <object-id pub-id-type="pmid">18618701</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref087"><label>87</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vazdar</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Vymetal</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Heyda</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Vondrasek</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jungwirth</surname> <given-names>P</given-names></name>. <article-title>Like-charge guanidinium pairing from molecular dynamics and ab initio calculations</article-title>. <source>J Phys Chem A</source>. <year>2011</year>;<volume>115</volume>(<issue>41</issue>):<fpage>11193</fpage>–<lpage>201</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jp203519p" xlink:type="simple">10.1021/jp203519p</ext-link></comment> <object-id pub-id-type="pmid">21721561</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref088"><label>88</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vondrasek</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Mason</surname> <given-names>PE</given-names></name>, <name name-style="western"><surname>Heyda</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Collins</surname> <given-names>KD</given-names></name>, <name name-style="western"><surname>Jungwirth</surname> <given-names>P</given-names></name>. <article-title>The molecular origin of like-charge arginine-arginine pairing in water</article-title>. <source>J Phys Chem B</source>. <year>2009</year>;<volume>113</volume>(<issue>27</issue>):<fpage>9041</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/jp902377q" xlink:type="simple">10.1021/jp902377q</ext-link></comment> <object-id pub-id-type="pmid">19354258</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref089"><label>89</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Davies</surname> <given-names>AM</given-names></name>, <name name-style="western"><surname>Tata</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Beavil</surname> <given-names>RL</given-names></name>, <name name-style="western"><surname>Sutton</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Brown</surname> <given-names>PR</given-names></name>. <article-title>l-Methionine sulfoximine, but not phosphinothricin, is a substrate for an acetyltransferase (gene PA4866) from Pseudomonas aeruginosa: structural and functional studies</article-title>. <source>Biochemistry</source>. <year>2007</year>;<volume>46</volume>(<issue>7</issue>):<fpage>1829</fpage>–<lpage>39</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/bi0615238" xlink:type="simple">10.1021/bi0615238</ext-link></comment> <object-id pub-id-type="pmid">17253769</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref090"><label>90</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lockless</surname> <given-names>SW</given-names></name>, <name name-style="western"><surname>Ranganathan</surname> <given-names>R</given-names></name>. <article-title>Evolutionarily conserved pathways of energetic connectivity in protein families</article-title>. <source>Science</source>. <year>1999</year>;<volume>286</volume>(<issue>5438</issue>):<fpage>295</fpage>–<lpage>9</lpage>. Epub 1999/10/09. 7890 [pii]. <object-id pub-id-type="pmid">10514373</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref091"><label>91</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Halabi</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Rivoire</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Leibler</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ranganathan</surname> <given-names>R</given-names></name>. <article-title>Protein sectors: evolutionary units of three-dimensional structure</article-title>. <source>Cell</source>. <year>2009</year>;<volume>138</volume>(<issue>4</issue>):<fpage>774</fpage>–<lpage>86</lpage>. Epub 2009/08/26. S0092-8674(09)00963-5 [pii]. PubMed Central PMCID: PMC3210731. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2009.07.038" xlink:type="simple">10.1016/j.cell.2009.07.038</ext-link></comment> <object-id pub-id-type="pmid">19703402</object-id></mixed-citation></ref>
<ref id="pcbi.1005294.ref092"><label>92</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Scharfe</surname> <given-names>CP</given-names></name>, <name name-style="western"><surname>Rodrigues</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Green</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Kohlbacher</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Sequence co-evolution gives 3D contacts and structures of protein complexes</article-title>. <source>Elife</source>. <year>2014</year>;<volume>3</volume>. PubMed Central PMCID: PMCPMC4360534.</mixed-citation></ref>
<ref id="pcbi.1005294.ref093"><label>93</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marks</surname> <given-names>DS</given-names></name>, <name name-style="western"><surname>Hopf</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Sander</surname> <given-names>C</given-names></name>. <article-title>Protein structure prediction from sequence variation</article-title>. <source>Nat Biotechnol</source>. <year>2012</year>;<volume>30</volume>(<issue>11</issue>):<fpage>1072</fpage>–<lpage>80</lpage>. PubMed Central PMCID: PMC4319528. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nbt.2419" xlink:type="simple">10.1038/nbt.2419</ext-link></comment> <object-id pub-id-type="pmid">23138306</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>