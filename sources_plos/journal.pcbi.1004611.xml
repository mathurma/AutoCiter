<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE article PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article article-type="research-article" dtd-version="3.0" xml:lang="en" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00601</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004611</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biochemistry</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biochemical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Physics</subject><subj-group><subject>Biophysics</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Biophysical simulations</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Mathematical and statistical techniques</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Statistical methods</subject><subj-group><subject>Monte Carlo method</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Cell biology</subject><subj-group><subject>Cellular structures and organelles</subject><subj-group><subject>Vesicles</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Probability theory</subject><subj-group><subject>Probability distribution</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Specimen preparation and treatment</subject><subj-group><subject>Mechanical treatment of specimens</subject><subj-group><subject>Specimen disruption</subject><subj-group><subject>Vesicle fusion</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Synapses</subject><subj-group><subject>Neuromuscular junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Anatomy</subject><subj-group><subject>Nervous system</subject><subj-group><subject>Synapses</subject><subj-group><subject>Neuromuscular junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject><subj-group><subject>Neuromuscular junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Physiology</subject><subj-group><subject>Electrophysiology</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject><subj-group><subject>Neuromuscular junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Neurophysiology</subject><subj-group><subject>Synapses</subject><subj-group><subject>Neuromuscular junctions</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Unbiased Rare Event Sampling in Spatial Stochastic Systems Biology Models Using a Weighted Ensemble of Trajectories</article-title>
<alt-title alt-title-type="running-head">Rare Event Sampling in Spatial Stochastic Systems Biology Models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Donovan</surname> <given-names>Rory M.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Tapia</surname> <given-names>Jose-Juan</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Sullivan</surname> <given-names>Devin P.</given-names></name>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Faeder</surname> <given-names>James R.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Murphy</surname> <given-names>Robert F.</given-names></name>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dittrich</surname> <given-names>Markus</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Zuckerman</surname> <given-names>Daniel M.</given-names></name>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Joint CMU-Pitt Ph.D. Program in Computational Biology, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Computational and Systems Biology, School of Medicine, University of Pittsburgh, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Computational Biology Department, School of Computer Science, Carnegie Mellon University, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Pittsburgh Supercomputing Center, Pittsburgh, Pennsylvania, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Meier-Schellersheim</surname> <given-names>Martin</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>National Institutes of Health, UNITED STATES</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: RMD JRF RFM MD DMZ. Performed the experiments: RMD JJT DPS. Analyzed the data: RMD DMZ. Wrote the paper: RMD JJT DPS JRF RFM MD DMZ.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">ddmmzz@pitt.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>2</month>
<year>2016</year>
</pub-date>
<pub-date pub-type="epub">
<day>4</day>
<month>2</month>
<year>2016</year>
</pub-date>
<volume>12</volume>
<issue>2</issue>
<elocation-id>e1004611</elocation-id>
<history>
<date date-type="received">
<day>10</day>
<month>4</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>16</day>
<month>10</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2016</copyright-year>
<copyright-holder>Donovan et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004611"/>
<abstract>
<p>The long-term goal of connecting scales in biological simulation can be facilitated by scale-agnostic methods. We demonstrate that the weighted ensemble (WE) strategy, initially developed for molecular simulations, applies effectively to spatially resolved cell-scale simulations. The WE approach runs an ensemble of parallel trajectories with assigned weights and uses a statistical resampling strategy of replicating and pruning trajectories to focus computational effort on difficult-to-sample regions. The method can also generate unbiased estimates of non-equilibrium and equilibrium observables, sometimes with significantly less aggregate computing time than would be possible using standard parallelization. Here, we use WE to orchestrate particle-based kinetic Monte Carlo simulations, which include spatial geometry (e.g., of organelles, plasma membrane) and biochemical interactions among mobile molecular species. We study a series of models exhibiting spatial, temporal and biochemical complexity and show that although WE has important limitations, it can achieve performance significantly exceeding standard parallel simulation—by orders of magnitude for some observables.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Stochastic simulations (simulations where randomness plays a role) of even simple biological systems are often so computationally intensive that it is impossible, in practice, to simulate them exhaustively and gather good statistics about the likelihood of different outcomes. The difficulty is compounded for the observation of rare events in these simulations; unfortunately, rare events, such as state transitions and barrier crossings, are often those of particular interest. Using the weighted ensemble (WE) method, we are able to enhance the characterization of rare events in cell biology simulations, but in such a way that the statistics for these events remain unbiased. The histogram of outcomes that WE produces has the same shape as a naive one, but the resolution of events in the tails of the histogram is greatly improved. This improved resolution in rare event statistics can be used to infer unbiased estimates of long timescale dynamics from short simulations, and we show that using a weighted ensemble can result in a reduction in total simulation time needed to sample certain events of interest in spatial, stochastic models of biological systems.</p>
</abstract>
<funding-group>
<funding-statement>The authors gratefully acknowledge support from the National Science Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov" xlink:type="simple">www.nsf.gov</ext-link>) and National institute of Health (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov" xlink:type="simple">www.nih.gov</ext-link>), in the form of NSF Grant No. MCB-1119091, NIH Grant No. P41 GM103712, NIH Grant No. T32 EB009403, NIH Grant No. R01 GM090033, NSF Grant No. CNS-0926181, NSF Grant No. 1249546, NIH Grant No. R01 NS090644, and NIH Grant R01 GM115805. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="12"/>
<table-count count="0"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>All relevant data are within the paper and its Supporting Information files.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote><p>This is a PLOS Computational Biology Methods paper.</p></disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Stochastic effects are of crucial importance in many biological processes, from protein dynamics [<xref ref-type="bibr" rid="pcbi.1004611.ref001">1</xref>], to gene expression [<xref ref-type="bibr" rid="pcbi.1004611.ref002">2</xref>], to phenotypic heterogeneity [<xref ref-type="bibr" rid="pcbi.1004611.ref003">3</xref>]. Unfortunately, due to the high computational cost of simulating complex stochastic biological systems, the effects of stochasticity on system response remain under-studied in realistic biological models.</p>
<p>From molecular to cellular scales, simulations of biological systems push the limits of our computational resources [<xref ref-type="bibr" rid="pcbi.1004611.ref004">4</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref005">5</xref>]. Compromising between sampling power and model complexity will be a trade-off for the foreseeable future; for example, at atomistic resolution even the most powerful, specially designed supercomputers can simulate only modestly sized proteins at timescales that approach sufficiency for adequate sampling [<xref ref-type="bibr" rid="pcbi.1004611.ref006">6</xref>]. Similarly, models of cellular processes, though they omit entirely molecular-level details, are also constrained in complexity and realism by the need to perform adequate amounts of simulation in order to gather useful statistics [<xref ref-type="bibr" rid="pcbi.1004611.ref007">7</xref>]. Mixing scales in a simulation, though perhaps necessary for capturing the coupling across multi-scale networks, only makes this problem worse.</p>
<p>Enhanced sampling algorithms offer an attractive proposition: instead of compromising on model complexity in order to achieve well-sampled results, rather use simulation resources more effectively and extract more information given the same resources. Not surprisingly, there has been significant interest in sampling algorithms in the field of atomistic protein simulation, including umbrella and histogram sampling [<xref ref-type="bibr" rid="pcbi.1004611.ref008">8</xref>–<xref ref-type="bibr" rid="pcbi.1004611.ref010">10</xref>], path sampling methods, [<xref ref-type="bibr" rid="pcbi.1004611.ref011">11</xref>–<xref ref-type="bibr" rid="pcbi.1004611.ref017">17</xref>], and various flavors of replica exchange [<xref ref-type="bibr" rid="pcbi.1004611.ref018">18</xref>–<xref ref-type="bibr" rid="pcbi.1004611.ref021">21</xref>]. Arguably, such approaches have transformed the field of molecular simulation [<xref ref-type="bibr" rid="pcbi.1004611.ref006">6</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref023">23</xref>].</p>
<p>The essence of the present study is the extension of one successful enhanced sampling strategy for molecular simulation to spatially resolved cell-scale systems. Specifically, the weighted ensemble approach is a scale-agnostic method that is able to facilitate the enhanced sampling of a wide spectrum of stochastic simulations and non-Markovian processes [<xref ref-type="bibr" rid="pcbi.1004611.ref017">17</xref>], including Brownian dynamics [<xref ref-type="bibr" rid="pcbi.1004611.ref013">13</xref>], molecular dynamics [<xref ref-type="bibr" rid="pcbi.1004611.ref024">24</xref>], Monte-Carlo simulations of atomistic and coarse-grained protein dynamics [<xref ref-type="bibr" rid="pcbi.1004611.ref025">25</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref026">26</xref>], chemical reaction networks [<xref ref-type="bibr" rid="pcbi.1004611.ref027">27</xref>], and as we demonstrate here, the spatially resolved stochastic reaction-diffusion processes used to simulate cellular processes. Weighted ensemble achieves its enhanced sampling by dividing up a model’s state-space into bins and maintaining an ensemble of trajectories with different weights that evenly sample these bins. This weighted ensemble is created by resampling the distribution of trajectories at fixed time intervals, spawning new simulations from trajectories that have wandered into unexplored regions and pruning them away if a region is overpopulated, in order to maintain even coverage of the space. This resampling process is exact, in the sense that it induces no bias in the estimates of equilibrium and non-equilibrium observables [<xref ref-type="bibr" rid="pcbi.1004611.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref028">28</xref>]. Resampling at fixed time intervals lends the method some key benefits: it is trivially parallelizable, since trajectories run independently aside from interacting infrequently during resampling, and it is modular, needing no “under the hood” interaction with the underlying dynamics, rather requiring only intermittent reports of a progress coordinate.</p>
<p>Spatial heterogeneity can be crucial to accurately capturing the behavior of cell-scale biological systems, for instance in models of neuromuscular junction dynamics studied below [<xref ref-type="bibr" rid="pcbi.1004611.ref029">29</xref>]. Although simple models of biological signaling, where the molecules of interest are spatially homogeneous, or “well-mixed” are very common [<xref ref-type="bibr" rid="pcbi.1004611.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref031">31</xref>], the assumption of spatial homogeneity may not always be justified; certain biological systems, while suitable for ignoring molecular structure, are not amenable to being modeled as spatially homogenous. Indeed, high resolution microscopy images of single cells show distinct patterns of localization for a wide variety of biomolecules [<xref ref-type="bibr" rid="pcbi.1004611.ref032">32</xref>–<xref ref-type="bibr" rid="pcbi.1004611.ref034">34</xref>], leading one to speculate if the well-mixed regime is the exception rather than the rule.</p>
<p>Here, we apply the weighted ensemble sampling procedure to decrease the cost of simulating spatial stochastic systems. After introducing our methodology, we present results for a toy diffusive binding system and two more complex systems: a cross-compartmental signal transduction model in a realistic cellular geometry and a model of an active zone in a frog neuromuscular junction. The flexibility and power of the WE method make it ideally suited for enhancing the sampling of these three diverse models.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Methods</title>
<p>We employ the weighted ensemble sampling algorithm to manage multiple instances of particle-based kinetic Monte Carlo simulations of a given spatially resolved model of cellular signaling. We make use of a variety of software packages in our work, all of which are freely available via MMBioS.org.</p>
<sec id="sec003">
<title>Weighted Ensemble</title>
<sec id="sec004">
<title>Basic weighted ensemble</title>
<p>The weighted ensemble sampling strategy achieves enhanced sampling by maintaining an ensemble of simulations running in parallel, distributed evenly across the configuration or state space of a system. To do this, the configuration space of the system is typically divided into different region, or “bins”, according to the values of some progress coordinate(s). The parallel ensemble of simulations is periodically paused, and each simulation is inspected to ascertain which bin it inhabits. Simulations in overpopulated bins are pruned away until a desired population is reached, and simulations in underpopulated bins are duplicated until a sufficient population is reached. After this brief resampling process, the ensemble of trajectories is restarted, and the native dynamics of the system continues, until it comes time to pause and resample again. By assigning each trajectory a statistical weight and conserving this weight during pruning and cloning operations, the ensemble remains unbiased, while efficiently sampling otherwise difficult to reach regions of configurations space [<xref ref-type="bibr" rid="pcbi.1004611.ref013">13</xref>].</p>
<p>The essence of the weighted ensemble sampling procedure is encapsulated in <xref ref-type="fig" rid="pcbi.1004611.g001">Fig 1</xref>, where we have chosen to divide the example system along one coordinate into three bins, and have a target number of two trajectories in each bin. Before the simulation begins, the configuration space of the system must be considered, and typically a progress coordinate (or more than one) along which a trajectory can be tracked is selected. Although automated binning procedures have been developed [<xref ref-type="bibr" rid="pcbi.1004611.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref035">35</xref>], we do not use them in the studies reported here. The configuration space of the system is divided into non-overlapping bins of the selected progress coordinate(s) that completely cover the configuration space. This division is usually done ahead of time, but “on the fly” modifications are also permitted [<xref ref-type="bibr" rid="pcbi.1004611.ref017">17</xref>]. In <xref ref-type="fig" rid="pcbi.1004611.g001">Fig 1</xref>, a one-dimensional projection of a system is shown, and the space is divided into three bins, which remain the same throughout the simulation. For efficient sampling, the progress coordinates chosen should be associated with a set of slowly varying and uncorrelated processes; additional progress coordinates tend to increase computing cost without a sufficient “payoff” in sampling. Additional slowly varying progress coordinates can speed up sampling of slow/rare processes in the system, but choosing progress coordinates that are uncorrelated is also important, because correlated coordinates are redundant in the variation of the system that they capture. The expense of maintaining bins full of trajectories increases drastically with the number of progress coordinates used, making it essential to use additional progress coordinates only when they are crucial to capturing new information about the system.</p>
<fig id="pcbi.1004611.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Weighted ensemble algorithm.</title>
<p>One initial trajectory is iteratively resampled until its progeny trajectories are distributed equally around the state-space, according to user-defined bins. Excess trajectories are pruned if necessary. This process is statistically exact if the probabilistic weight of each trajectory is properly accounted for in the resampling (splitting/merging) process. In between splitting and merging events, each trajectory follows the natural dynamics of the system, and splitting events occur when a trajectory naturally wanders into an underpopulated region of space. Reprinted with permission from <italic>Efficient stochastic simulation of chemical kinetics networks using a weighted ensemble of trajectories, The Journal of Chemical Physics 139: 115105</italic>.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g001" xlink:type="simple"/>
</fig>
<p>In the basic weighted ensemble procedure, a number of replicate trajectories are initiated from a chosen initial state, with weights summing to one, and are simulated for a short time <italic>τ</italic>. After that short time, the simulations are paused and inspected for progress along the chosen progress coordinates. If a trajectory has wandered into a new, previously unpopulated bin, that trajectory is replicated, and the statistical weight of that trajectory is divided among these “daughter” trajectories. If a bin becomes over-populated, trajectories are pruned and their weights are reassigned. After this pause in dynamics for resampling, the trajectories are restarted, and the entire process is iterated as desired.</p>
<p>The resampling strategy of WE is exact for arbitrary types of stochastic dynamics in any number of dimensions [<xref ref-type="bibr" rid="pcbi.1004611.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref028">28</xref>]. Typically, when we divide the configuration space of the system into bins, we set a target number of trajectories for each bin; if, during one of the intermittent resampling events, the number of trajectories in that bin is greater or less than the target (but nonzero), we either up- or down-sample the trajectories in the bin to reach the target number, always accounting for the statistical weights of each trajectory. “Up-sampling” connotes spawning new trajectories, identical to the original but with the original trajectory’s statistical weight now split between the new and old trajectories. For instance, during the <italic>t</italic> = <italic>τ</italic> resampling event in <xref ref-type="fig" rid="pcbi.1004611.g001">Fig 1</xref>, the trajectory in bin 2, initially possessing a weight of 1/2, spawns an identical copy of itself, and the weight of the original trajectory is evenly divided so that the two resultant trajectories each have a weight of 1/4. “Down-sampling” is a pruning process, whereby trajectories are compared in a pairwise fashion and one is deleted based on a random process, with a likelihood of survival proportional to the statistical weight of the trajectory. For instance, during the <italic>t</italic> = 2<italic>τ</italic> resampling event in <xref ref-type="fig" rid="pcbi.1004611.g001">Fig 1</xref>, the three trajectories in bin 1 all have weight 1/4, so two of them are selected, and a random number draw (evenly weighted, since both trajectories have the same weight) decides which one remains. By these two simple processes, an ensemble of trajectories is created that evenly samples the state space of the system without bias [<xref ref-type="bibr" rid="pcbi.1004611.ref017">17</xref>].</p>
<p>The resampling process adds a small amount of computational overhead to the overall cost of sampling. This expense, however, is a small fraction of the total cost, provided that either the dynamics of the system are expensive to simulate, or the resampling interval is long compared to the timescale of the internal dynamics of the simulation, which we find is almost always the case in systems of interest. For instance, when using weighted ensemble to run simulations of molecular dynamics [<xref ref-type="bibr" rid="pcbi.1004611.ref024">24</xref>], large chemical kinetics networks [<xref ref-type="bibr" rid="pcbi.1004611.ref027">27</xref>], or the spatially resolved stochastic chemical kinetics studied here, the trajectories will typically run for a wall-clock time on the order of minutes or hours before being paused for resampling, while the resampling operation itself takes on the order of seconds. Indeed, the resampling arithmetic itself is trivial in complexity compared to the stochastic dynamics of the trajectories themselves, and most of the time spent during resampling is actually spent reading and writing to disk and starting and stopping trajectories (if the data are too large to store in memory). Like any enhanced sampling method, WE is worthwhile only for complex models exhibiting a wide variety of timescales.</p>
<p>The benefit of this resampling process is that it facilitates the efficient, exact sampling of the system along the binned progress coordinates. As illustrated schematically in <xref ref-type="fig" rid="pcbi.1004611.g002">Fig 2</xref>, in a naive “brute-force” approach, where a number of independent trajectories are simulated and then compiled into a histograms of outcomes, the sampling power of the ensemble is concentrated about the peak of the distribution.</p>
<fig id="pcbi.1004611.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Distribution of sampling power.</title>
<p>Brute-force sampling, by definition, concentrates sampling power on the most probable events. By contrast, weighted ensemble samples a distribution more evenly, and compared to brute-force it applies more resources to hard-to-sample regions of interest.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g002" xlink:type="simple"/>
</fig>
<p>By definition, the peak contains the most probable events. Thus, certain parts of the configuration space are destined to be poorly sampled; if the true probability of a state being occupied is less than the inverse of the number of trajectories simulated, it is unlikely to be sampled even once. On the other hand, weighted ensemble decouples the number of trajectories in a region of configuration space from the probability of a trajectory to be there, and allows for a more even coverage of all regions of the underlying distribution. It should be noted that an even coverage of configuration space lends itself to efficient sampling only if the coordinate(s) along which this coverage is distributed are useful in characterizing the observables of interest [<xref ref-type="bibr" rid="pcbi.1004611.ref017">17</xref>]. That is, the payoff of using weighted ensemble sampling depends on one’s choice of progress coordinate and bins, and efficiently sampling certain regions of configuration space may prove unrewarding.</p>
</sec>
<sec id="sec005">
<title>Calculation of mean first passage time with WE</title>
<p>The efficient sampling of low-probability regions of the (time-dependent) probability distribution of a stochastic system can be leveraged to extract unbiased estimates of long-timescale information about the system. Specifically, the Hill relation [<xref ref-type="bibr" rid="pcbi.1004611.ref036">36</xref>] provides a link between the mean first passage time (MFPT) between two states <italic>A</italic> and <italic>B</italic>, and the steady-state flux of probability (flow per unit time) between them:
<disp-formula id="pcbi.1004611.e001"><alternatives><graphic id="pcbi.1004611.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004611.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">MFPT</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>→</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo form="prefix">Flux</mml:mo> <mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>→</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where Flux(<italic>A</italic> → <italic>B</italic>) here refers to the probability (per unit time) that a trajectory, which at some point in the past originated in <italic>A</italic>, arrives at <italic>B</italic> for the first time. This relationship is exact (up to statistical noise) when the system exhibits a steady-state flow of probability from <italic>A</italic> to <italic>B</italic>. These two states <italic>A</italic> and <italic>B</italic> can be single micro-states, or large states composed of many smaller sub-states (e.g. weighted ensemble bins); they can also be arbitrarily defined independent of the WE bin boundaries.</p>
<p>A steady-state is achieved when the probability distribution of the system is constant in time. That is, for each sub-state <italic>i</italic> in the system, in a given time period the total flow of probability into <italic>i</italic> from the other sub-states is equal to the flow of probability out of <italic>i</italic> into other sub-states. In terms of the steady-state probabilities <italic>p</italic><sub><italic>i</italic></sub> of each sub-state, and the transition probabilities <italic>k</italic><sub><italic>ij</italic></sub> between sub-states (in an arbitrary, but fixed, time interval), the steady-state condition is given by
<disp-formula id="pcbi.1004611.e002"><alternatives><graphic id="pcbi.1004611.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004611.e002" xlink:type="simple"/><mml:math display="block" id="M2"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>∀</mml:mo> <mml:mi>i</mml:mi> <mml:mtext> </mml:mtext> <mml:mo>:</mml:mo> <mml:mspace width="0.277778em"/><mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mi>k</mml:mi> <mml:mrow><mml:mi>j</mml:mi> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>p</mml:mi> <mml:mi>j</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>j</mml:mi></mml:munder> <mml:msub><mml:mi>k</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mspace width="0.277778em"/><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula></p>
<p>The conditional probabilities <italic>k</italic><sub><italic>ij</italic></sub> can be estimated from WE, and the <italic>p</italic><sub><italic>i</italic></sub> values can then be inferred by solving the linear system in <xref ref-type="disp-formula" rid="pcbi.1004611.e002">Eq 2</xref>. The Flux(<italic>A</italic> → <italic>B</italic>) needed for the MFPT in <xref ref-type="disp-formula" rid="pcbi.1004611.e001">Eq 1</xref> is obtained by summing over all steady-state probability flow into <italic>B</italic>:
<disp-formula id="pcbi.1004611.e003"><alternatives><graphic id="pcbi.1004611.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1004611.e003" xlink:type="simple"/><mml:math display="block" id="M3"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo form="prefix">Flux</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>→</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>∉</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:munder> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>j</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>B</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>p</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:msub><mml:mi>k</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mi>j</mml:mi></mml:mrow></mml:msub> <mml:mspace width="0.277778em"/><mml:mspace width="0.277778em"/><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where the <italic>k</italic><sub><italic>ij</italic></sub> and <italic>p</italic><sub><italic>i</italic></sub> values are obtained solely from trajectories originating in <italic>A</italic>[<xref ref-type="bibr" rid="pcbi.1004611.ref028">28</xref>].</p>
<p>To accommodate a steady state, the boundary conditions of the weighted ensemble simulation described above must be slightly adjusted to induce a steady-state flow of probability from the initial state to the target state. This is accomplished by removing a trajectory from the ensemble whenever it enters the target state, and re-starting a new trajectory from the initial state with the same probabilistic weight as the one just removed. After a sufficient amount of time the system will relax into a steady flow of probability from one state to another, with probabilities in each bin maintained at a steady value. After this “burn-in” period, the Hill relation can be employed to estimate the MFPT.</p>
<p>Although not used in this report, we note that since the transition rates between bins can often be estimated accurately even before the probability distribution has relaxed to a steady state, a Markov-like transition matrix can be constructed and solved to infer long-timescale properties of the system, including the mean first passage time [<xref ref-type="bibr" rid="pcbi.1004611.ref028">28</xref>]. This approach is more efficient than waiting for the system to relax into a steady state when the probability mass itself is slow to relax, so long as there are sufficient transitions between bins, and the degrees of freedom orthogonal to the bins are either well-sampled or unimportant.</p>
</sec>
<sec id="sec006">
<title>WESTPA implementation of WE</title>
<p>Throughout this work, we use the WESTPA [<xref ref-type="bibr" rid="pcbi.1004611.ref037">37</xref>] implementation of the weighted ensemble algorithm, which is freely available and open source (github.com/WESTPA). This implementation is flexible and adaptable for use with any stochastic dynamics engine, and supports plugins for extended methods such as the steady-state approach noted above. Interfaces currently exist for use with Gromacs, NAMD, AMBER, BioNetGen, and the present work provides one for MCell [<xref ref-type="bibr" rid="pcbi.1004611.ref037">37</xref>].</p>
<p>In order to simplify the process of using weighted ensemble sampling techniques with systems biology models, we have constructed an automated service to convert MCell models into ready-to-go WESTPA simulations, available at weightedensemblizer.csb.pitt.edu).</p>
</sec>
<sec id="sec007">
<title>Comparing the efficiency of weighted ensemble and brute-force</title>
<p>There are different ways to characterize the gain in efficiency from using weighted ensemble instead of brute-force sampling. We find that a useful approach to evaluating efficiency, which is independent of specific computational architecture, is to take the sum of the simulated dynamics time in the weighted ensemble approach, and compare those results to simulating the same amount of dynamics in brute-force simulations. For instance, the single weighted ensemble run for the toy diffusive binding model presented in the Results section spawned a total of 610,704 trajectory segments in its 1000 iterations; as such, it is equivalent to simulating 610,704/1000 = 610.704 brute-force trajectories. Thus, always rounding up to give brute-force the benefit, we compare the weighted ensemble results to the results of running 611 brute-force simulations. The statistical precision exhibited by each method can then be compared on the basis of equal time spent simulating dynamics. As mentioned above, the overhead imposed by weighted ensemble resampling is very small compared to the time spent simulating dynamics for most systems of interest, so for models of even moderate complexity, we find this to be a fair comparison of efficiency.</p>
<p>Because WE trajectories, and hence observables, exhibit correlation within a single simulation, it can be important to perform multiple, independent weighted ensemble runs to ensure uncorrelated estimates of observables. When comparing the performance of brute-force sampling to multiple independent weighted ensemble runs, for each WE run we construct a brute-force ensemble of equivalent cost to each independent WE run, as described above. We can then compare the results of the multiple brute-force ensembles to the multiple independent WE runs on equal footing.</p>
</sec>
</sec>
<sec id="sec008">
<title>Kinetic Monte Carlo for spatial behavior of biochemically active species: MCell</title>
<p>All simulations in this report employ spatially resolved particle-based kinetic Monte Carlo dynamics, implemented in the MCell software package. MCell (Monte Carlo Cell) is an open source program (MCell.org) that uses spatially realistic 3D cellular models and specialized Monte Carlo algorithms to simulate the movements and reactions of molecules within and between cells, or what is referred to as “cellular microphysiology” [<xref ref-type="bibr" rid="pcbi.1004611.ref038">38</xref>]. MCell has been used to study a wide range of neuroscience questions such as neurotransmitter diffusion in the brain [<xref ref-type="bibr" rid="pcbi.1004611.ref039">39</xref>], the structure and function of synapses in the central [<xref ref-type="bibr" rid="pcbi.1004611.ref040">40</xref>] and peripheral [<xref ref-type="bibr" rid="pcbi.1004611.ref029">29</xref>] nervous system, and the effect of drugs on nervous system function [<xref ref-type="bibr" rid="pcbi.1004611.ref041">41</xref>]. MCell has also been employed to investigate general cellular phenomena such as calcium signaling [<xref ref-type="bibr" rid="pcbi.1004611.ref042">42</xref>] and the role of diffusion in cellular transport [<xref ref-type="bibr" rid="pcbi.1004611.ref043">43</xref>].</p>
<p>MCell combines rigorously validated and highly optimized stochastic Monte Carlo algorithms, particle-based random walk diffusion of (point particle) molecules in space and on surfaces, and stochastic biochemical state transitions. MCell models can contain arbitrarily complex 3D mesh geometries representing the biological system under consideration. These geometries are typically derived from reconstructions of biological tissue (typically from electron microscopy data) [<xref ref-type="bibr" rid="pcbi.1004611.ref044">44</xref>], or created in silico based on average geometries [<xref ref-type="bibr" rid="pcbi.1004611.ref029">29</xref>], e.g. via CellBlender software (github.com/mcellteam/cellblender) [<xref ref-type="bibr" rid="pcbi.1004611.ref045">45</xref>]. MCell features a flexible model description language and has the ability to checkpoint simulation trajectories at arbitrary output intervals or times.</p>
<p>MCell is a <italic>kinetic</italic> Monte Carlo scheme, in the sense that the time evolution of the system is explicitly modeled. The Monte Carlo moves that the system makes are not arbitrary trial moves, but are rather chosen according to the reaction and diffusion rates of the molecules being simulated. A constant time-step is employed in these simulations, during which the likelihood of reaction and diffusion processes are computed and stochastically sampled; by using appropriate time-steps, the dynamics of the underlying processes are faithfully recapitulated (for further details, see [<xref ref-type="bibr" rid="pcbi.1004611.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref046">46</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref047">47</xref>]).</p>
</sec>
<sec id="sec009">
<title>Complex model construction: CellOrganizer and BioNetGen</title>
<p>The construction of large, complex spatial models is facilitated by a combination of software that specializes in separate aspects of this task.</p>
<p>One of the limiting factors in performing spatially realistic cell simulations is the difficulty of obtaining cell geometries. This limitation can be addressed by learning generative models of cell organization directly from microscope images; these can be used to synthesize an unlimited number of realistic geometries. For instance, in the complex model in a realistic cellular geometry studied below, biochemical reaction networks, with corresponding compartments for organelles, are constructed using BioNetGen software [<xref ref-type="bibr" rid="pcbi.1004611.ref048">48</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref049">49</xref>], combined with cell geometry models generated by CellOrganizer software [<xref ref-type="bibr" rid="pcbi.1004611.ref050">50</xref>–<xref ref-type="bibr" rid="pcbi.1004611.ref058">58</xref>] using CellBlender [<xref ref-type="bibr" rid="pcbi.1004611.ref045">45</xref>] to create the MCell spatial simulations [<xref ref-type="bibr" rid="pcbi.1004611.ref059">59</xref>]. More information about this process of generating cellular instances with realistic cellular and subcellular organizations/morphologies is given below. The WESTPA software in turn manages ensembles of the MCell simulations, for either weighted ensemble or brute-force sampling.</p>
<p>CellOrganizer (CellOrganizer.org) is an open source tool for learning conditional generative models of cellular organization from images [<xref ref-type="bibr" rid="pcbi.1004611.ref050">50</xref>–<xref ref-type="bibr" rid="pcbi.1004611.ref058">58</xref>]. From these models, new cellular geometries can be generated from different parts of the “shape space” of the system. Currently CellOrganizer supports models for cell shape, nuclear shape, vesicle frequency, location and size, and microtubule length, number and distribution. Important for this work is CellOrganizer’s ability to produce realistic geometric instances of cells and subcellular components for use in modeling using the experimental spatial extension of the Systems Biology Markup Language (SBML) [<xref ref-type="bibr" rid="pcbi.1004611.ref060">60</xref>].</p>
<p>Biochemical reaction networks in our model of signaling in a realistic cellular geometry are built with the BioNetGen software package (BioNetGen.org), which is a framework for specifying and simulating rule-based models of biochemical kinetics [<xref ref-type="bibr" rid="pcbi.1004611.ref048">48</xref>]. The rule-based approach allows combinatorially large chemical reaction networks to be compactly described using a small set of rules that define the underlying molecular interactions [<xref ref-type="bibr" rid="pcbi.1004611.ref049">49</xref>]. Indirect simulation of rule-based models requires automated generation of the reaction network implied by the rule set. The generated reaction network can then be simulated using a variety of approaches including ordinary differential equations and stochastic simulation. BioNetGen has previously been used to model a wide range of processes including signal transduction, metabolic pathways, and genetic regulatory networks [<xref ref-type="bibr" rid="pcbi.1004611.ref049">49</xref>]. BioNetGen enables the cellular topology to be defined via compartments [<xref ref-type="bibr" rid="pcbi.1004611.ref061">61</xref>], but it does not provide for the specification of more detailed geometric information about these compartments or molecule locations. An automated process converts these rules to an exhaustive network of chemical reactions representing the chemical kinetics of the system (see <xref ref-type="fig" rid="pcbi.1004611.g003">Fig 3</xref>).</p>
<fig id="pcbi.1004611.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Software pipeline for realistic cell geometry simulations.</title>
<p>Geometries are learned from images by CellOrganizer. Chemical reaction networks are generated from rule-based models in BioNetGen. Geometries and reaction networks are imported to MCell via the CellBlender visual editor. The spatial stochastic model is then simulated in MCell, with WESTPA managing a weighted ensemble of MCell trajectories.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g003" xlink:type="simple"/>
</fig>
<p>The reaction network from BioNetGen is fed into CellOrganizer to obtain an appropriate cellular geometry, and the network and geometry are combined using the CellBlender package. In CellBlender, the reactions and geometry are merged, and exported to MCell. The system is then simulated as usual in MCell, either using weighted ensemble to manage the trajectories, or via brute-force.</p>
</sec>
</sec>
<sec id="sec010" sec-type="materials|methods">
<title>Models</title>
<p>We investigate three spatial models of cellular function: (1) a toy model of diffusive binding, (2) an idealized model of cellular signaling, and (3) a realistic model of a neuromuscular junction. All three particle-based kinetic Monte Carlo models are simulated in MCell (version 3.2.1), and are available in the supporting information.</p>
<sec id="sec011">
<title>Toy diffusive binding model</title>
<p>A highly simplified model of diffusive binding was constructed as an initial test of the utility of weighted ensemble sampling in a spatial system. The model geometry is depicted in <xref ref-type="fig" rid="pcbi.1004611.g004">Fig 4</xref>.</p>
<fig id="pcbi.1004611.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Toy model geometry.</title>
<p>This toy system has receptors at the top and bottom of a cubical “cell”. The receptors at the top are initially bound by ligands, that are free to unbind and diffuse around the cell, and bind to receptors at the bottom.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g004" xlink:type="simple"/>
</fig>
<p>In this toy model of diffusive binding, we define a cubical volume, of side length 2 microns, on the top of which 1000 ligands are initially bound to 1000 receptors at time <italic>t</italic> = 0. The volume also contains 1000 receptors at the bottom of the cube that are initially unbound. The ligands are then free to unbind (with a constant of 10<sup>3</sup>/sec), diffuse around the volume (with a diffusion constant of 10<sup>−6</sup>cm<sup>2</sup>/sec), and re-bind to receptors at the top, or to receptors at the bottom (with a constant of 10<sup>8</sup>/M/sec). We examine the probability density for the number of receptors at the bottom of the volume bound by ligands after simulating 10 milliseconds of dynamics.</p>
<sec id="sec012">
<title>WE simulation parameters</title>
<p>The toy model has an internal time step of 10 microseconds, and we perform weighted ensemble resampling at an interval that exactly coincides with the internal time step, or every 10 microseconds. We simulate the model for 10 milliseconds, or 1000 weighted ensemble iterations. The progress coordinate we use is the number of receptors bound at the bottom of the cube, with bins on this coordinate at integers on [0, 1000], and we simulate 16 trajectory segments in each bin.</p>
</sec>
</sec>
<sec id="sec013">
<title>Complex model in realistic cellular geometry</title>
<p>There is significant interest in the variation of cellular morphology and its association with cell fate/function [<xref ref-type="bibr" rid="pcbi.1004611.ref059">59</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref062">62</xref>–<xref ref-type="bibr" rid="pcbi.1004611.ref066">66</xref>], and here we employ a model that is a prototype for computationally investigating the effect of a specific geometry upon biological function. The system models protein production in response to an extracellular signal and highlights interesting aspects of signal transduction through different subcellular components, such as transport across membranes and feedback between molecules in different subcellular locations [<xref ref-type="bibr" rid="pcbi.1004611.ref059">59</xref>]. The model contains on the order of 10<sup>5</sup> reactive molecules, situated in a realistic cellular geometry. Because creating robust, high-quality complex models of cells is itself a challenging endeavor, we employ the model generation pipeline through BioNetGen and CellOrganizer described in the Methods section and Sullivan et al. [<xref ref-type="bibr" rid="pcbi.1004611.ref059">59</xref>].</p>
<p>We use the geometry shown in <xref ref-type="fig" rid="pcbi.1004611.g005">Fig 5</xref>, which is derived from three-dimensional images of HeLa cells using CellOrganizer. This geometry contains topologically distinct partitions: the extracellular region, the cytoplasm, the nucleus, and approximately 500 endosomes. The geometry also includes the membranes that partition these compartments, through which molecules must be transported when appropriate. Further details are included in the Supporting Information.</p>
<fig id="pcbi.1004611.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Cellular geometry.</title>
<p>Realistic cell geometry generated from microscopy images by CellOrganizer. The geometry explicitly models the compartmentalization of the cell, by forcing molecules to diffuse through membranes to transition from, for example, the cytoplasm (grey) to the nucleus (blue). Also modeled are endosomes (green), and the extracellular environment (transparent).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g005" xlink:type="simple"/>
</fig>
<p>We use the reaction schema illustrated in <xref ref-type="fig" rid="pcbi.1004611.g006">Fig 6</xref> to describe the reaction kinetics of the model. The BioNetGen rules for this model are included in the Supporting Information, and they produce a network of 354 chemical reactions between 78 species [<xref ref-type="bibr" rid="pcbi.1004611.ref061">61</xref>]. Briefly, the signaling network functions as follows. The system is initialized in a state of unbound receptors, and free extracellular ligands. The extracellular ligand binds to receptors on the cell membrane, facilitating receptor dimerization, which can be internalized to the endosomes. In the endosomes, receptor dimers can become phosphorylated and recruit a transcription factor, which upon phosphorylation can also dimerize and migrate to the nucleus. In the nucleus, the transcription factor initiates the transcription of mRNA1, which, when it migrates to the cytoplasm, produces protein P1. P1 can then migrate to the nucleus and act as a transcription factor for mRNA2, which, when it migrates to the cytoplasm, produces the final species in the cascade, protein P2. Although this reaction network is idealized, it embodies key aspects of the complexity expected in real signaling processes.</p>
<fig id="pcbi.1004611.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Signal transduction network.</title>
<p>This rule-based model is translated into a system of chemical kinetics reactions by BioNetGen, and then simulated in a spatially realistic geometry by MCell. Figure adapted from [<xref ref-type="bibr" rid="pcbi.1004611.ref061">61</xref>]. Rate constants and further details are given in the SI.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g006" xlink:type="simple"/>
</fig>
<sec id="sec014">
<title>WE simulation parameters</title>
<p>The weighted ensemble simulation of the spatial signaling model has an internal time step 100 microseconds, and we perform weighted ensemble resampling once every second, i.e. every 10<sup>4</sup> internal time steps. We simulate the model for 500 seconds, or 5 million internal MCell time steps, i.e. 500 weighted ensemble iterations. We use a single progress coordinate for this system, the total number of P2 molecules in the system. The bins on this coordinate are integers on [0, 25] and one bin from 25 to infinity. We simulate 48 trajectories in the bin containing 0, and 16 trajectory segments in each other bin. Note that many coordinates (e.g., P1, ligands, mRNA1 and mRNA2, etc) are not divided into bins, as is typical of WE simulations of complex systems.</p>
</sec>
</sec>
<sec id="sec015">
<title>Neuromuscular junction</title>
<p>The third model we study represents a single active zone of a frog neuromuscular junction (NMJ). Synapses are of crucial physiological importance in neural function, yet their detailed molecular behavior, particularly the way in which calcium triggers synaptic vesicle fusion still lacks a complete, molecular level, characterization. This is mainly due to the lack of experimental approaches that can probe synapses at the required spatial and temporal resolution. Computational models can provide critical microscopic insight into how calcium binding triggers vesicle fusion and release [<xref ref-type="bibr" rid="pcbi.1004611.ref029">29</xref>].</p>
<p>The geometry of the frog NMJ active zone model is detailed in <xref ref-type="fig" rid="pcbi.1004611.g007">Fig 7</xref> and has been described previously [<xref ref-type="bibr" rid="pcbi.1004611.ref029">29</xref>]. The active zone model consists of a double row of 26 synaptic vesicles and two rows of 26 voltage gated calcium channels (VGCCs) in the space between vesicles (see <xref ref-type="fig" rid="pcbi.1004611.g007">Fig 7</xref>). Thus each synaptic vesicle is associated with a single VGCC.</p>
<fig id="pcbi.1004611.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Schematic of the model of an active zone of a frog neuromuscular junction.</title>
<p>On the left is an example snapshot from a simulation, and on the right is a zoomed-in view of the model. Calcium is released into the presynaptic space and is free to diffuse around the geometry and bind to the synaptic vesicles at the bottom of the active zone.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g007" xlink:type="simple"/>
</fig>
<p>The system is initialized from a state of no free calcium in the active zone. During a simulation, VGCCs open stochastically, driven by a time-dependent action potential waveform [<xref ref-type="bibr" rid="pcbi.1004611.ref029">29</xref>]. Once open, VGCCs conduct calcium ions into the presynaptic space. Calcium ions can then freely diffuse and either bind to ∼10<sup>6</sup> static buffer molecules or one of eight calcium sensor proteins (synaptotagmin) on the synaptic vesicles. Since each synaptotagmin protein has five calcium binding sites, each synaptic vesicle contains a total of 40 calcium binding sites. A synaptotagmin protein is activated after binding at least two calcium ions, and vesicle fusion is triggered once three out of its eight synaptotagmin proteins have been activated. For each simulation we track the calcium binding events to synaptotagmin sites on synaptic vesicles and can thus determine the number of released vesicles and the time of release.</p>
<p>The NMJ model differs crucially from the two other systems studied here in that it possesses rate “constants” that vary in time. Specifically, the rates for the opening of and calcium conduction through VGCCs in the model are time dependent and are parameterized according to an experimentally measured action potential waveform. This time-dependent nature of vesicle release in synapses is critical for their physiological function [<xref ref-type="bibr" rid="pcbi.1004611.ref029">29</xref>]. Thus, the model, with its time-varying kinetics, cannot be treated using steady-state or equilibrium approaches and is only usefully simulated, even with a weighted ensemble, out of equilibrium and for a predetermined period of time.</p>
<sec id="sec016">
<title>WE simulation parameters</title>
<p>Weighted ensemble simulation of the NMJ model used an internal time step of 10 nanoseconds, and we performed weighted ensemble resampling at an interval of 6 microseconds for the low calcium conditions. In total, we simulate the model for 3 ms, i.e. 500 weighted ensemble iterations.</p>
<p>The progress-coordinate space for the NMJ system was two dimensional: one dimension was the total number of calcium ions bound to all synaptotagmin molecules on a vesicle, and the other was the number of activated synaptotagmin molecules on that vesicle. Since a vesicle fuses once three synaptotagmin molecules are active, the latter coordinate had integer bins from zero to three. For the coordinate tracking the number of bound calcium ions per synaptotagmin, the bins were integers on the interval [0, 20], and one bin from 20 to 40.</p>
<p>The NMJ progress coordinate was chosen to facilitate the observation of fusion events, in a manner that is somewhat complicated but also serves to illustrate the flexibility in the type of progress coordinates that WE accepts. Of the 26 vesicles in the simulation, the one that was closest to fusion was chosen at every WE iteration. That is, the vesicles were sorted in descending order by number of activated synaptotagmin proteins, and then by number of total calcium ions bound; the vesicle at the top of the list was chosen. This ranking was performed at every weighted ensemble resampling event, so in principle the vesicle in question could change during the simulation, but always in favor of progress towards a fusion event.</p>
<p>Due to the time dependent VGCC rate constants in the NMJ model, even weighted ensemble sampling can have difficulty efficiently filling up bins of state space. This is because some regions that are initially difficult to sample become easy to reach, and time spent populating intermediate bins is in some sense ill-spent—the model is still sampled, but the efficiency can be less than ideal if one attempts to always have all bins full of trajectories. To address this issue, instead of performing a single weighted ensemble run with a large number of trajectories, we perform many, less intensive weighted ensemble runs with fewer trajectories and average the results. Specifically, for the low calcium regimes of 0.5 and 0.3 mM in the Results Section for the NMJ model, we performed 100 independent weighted ensemble runs for each system. The 0.5 mM system maintained a target of 8 trajectory segments per bin, while the 0.3 mM system maintained a target of 16 trajectory segments per bin. As noted above, multiple independent weighted ensemble runs facilitate error estimation.</p>
</sec>
</sec>
</sec>
<sec id="sec017" sec-type="results">
<title>Results</title>
<p>We sampled the three spatially resolved cell-scale models of varying complexity using the weighted ensemble approach. The results from all three models demonstrate the ability of WE to sample rare events in models of varying spatial and biochemical complexity. The application of WE sampling to the NMJ model generated novel data about vesicle release in regimes of calcium concentration too difficult to sample well with conventional methods.</p>
<sec id="sec018">
<title>Toy diffusive binding model</title>
<p>Our studies of rare event sampling in spatial stochastic systems start with the toy model shown in <xref ref-type="fig" rid="pcbi.1004611.g004">Fig 4</xref> and described in detail in the Models section. Briefly, we simulate diffusing ligands unbinding from the top of a cubical volume and binding to the bottom for a short amount of time. In this time-span, it is rare for a large number of the ligands to bind at the bottom of the volume. Indeed, when we simulate the system 611 times via brute-force, we see that in most cases only about 10–20 receptors are bound at the bottom after 10 milliseconds. We simulated 611 brute-force trajectories in order to make a fair comparison of weighted ensemble sampling to a brute-force approach; the single weighted ensemble simulation we performed required computational resources equivalent to 610.7 brute-force simulations. Looking more closely at <xref ref-type="fig" rid="pcbi.1004611.g008">Fig 8</xref> (see inset), we see that it will be impossible to adequately characterize events rarer than 1/611 via the brute-force ensemble of simulations, since the rarest event one can see with brute-force is equal to the inverse of the number of trajectories. On the other hand, the weighted ensemble approach is able to sample the distribution over many orders of magnitude of probability with an equal amount of computational effort as the brute-force ensemble.</p>
<fig id="pcbi.1004611.g008" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g008</object-id>
<label>Fig 8</label>
<caption>
<title>Sampling rare states of the toy binding model.</title>
<p>Shown is the probability distribution of the number of bound receptors on the target side of the cell after 10 milliseconds of simulation. The weighted ensemble data (blue circles) is plotted with brute-force data (red squares) generated using equal computational effort, i.e. 611 brute-force runs. Brute-force sampling is confined to the peak of the distribution, whereas weighted ensemble sampling captures more of the full probability distribution. To compare both approaches to an authoritative value, an exhaustive set of 64 large weighted ensemble simulations was performed (grey circles), from which a bootstrapped 95% confidence interval for the mean probability distribution was calculated (dark grey bars).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g008" xlink:type="simple"/>
</fig>
<p>Since a toy model even this simple is too complex to solve exactly, we compare the data from both the single weighted ensemble simulation and the equivalent brute-force simulations to a more authoritative estimate of the probability distribution obtained by exhaustive (weighted ensemble) simulation. To obtain this reference value, we performed 64 independent weighted ensemble simulations with the same parameters as the single “test” weighted ensemble run (blue circles, <xref ref-type="fig" rid="pcbi.1004611.g008">Fig 8</xref>), except that each of the 64 runs had 32 trajectory segments per bin, rather than 16 for the test run (i.e. approximately 128 times the sampling power of the single run). From the 64 independent runs (gray circles, <xref ref-type="fig" rid="pcbi.1004611.g008">Fig 8</xref>), we then computed the 95% confidence interval for the mean probability distribution using 10,000 bootstrap samples at each progress coordinate, from 0 to 70. Even though the exhaustive weighted ensemble runs and the single test run use different weighted ensemble parameters (i.e trajectories per bin), this difference does not substantially affect the sampling quality of the ensembles. Note that the 95% confidence interval for the mean of the true distribution is significantly tighter than the variance of the distribution of weighted ensemble samples of that distribution; the fact that the single run falls outside this interval is typical of the stochastic noise inherent in a single WE sample.</p>
<p>As explained in the Methods section, weighted ensemble is able to sample more of the complete distribution by efficiently spreading out the sampling power of the ensemble of trajectories, allowing the characterization of rare-events by sacrificing some accuracy in the regime where brute-force samples well (see <xref ref-type="fig" rid="pcbi.1004611.g002">Fig 2</xref>). Examining <xref ref-type="fig" rid="pcbi.1004611.g008">Fig 8</xref>, we see that the brute-force distribution is smoother at the peak of the distribution—indicating less uncertainty—but only marginally so; the weighted ensemble estimate of the peak of the distribution is also reasonably smooth. By sacrificing unneeded resolution at the peak, WE is able to instead spread that sampling power more evenly throughout the state-space of the model, using it to sample the full probability distribution more comprehensively.</p>
</sec>
<sec id="sec019">
<title>Cross-compartmental signaling network in a realistic cell geometry</title>
<p>The model of cellular signal transduction shown in Figs <xref ref-type="fig" rid="pcbi.1004611.g005">5</xref> and <xref ref-type="fig" rid="pcbi.1004611.g006">6</xref> contains ∼10<sup>5</sup>, reactive molecules in a realistic geometry, and demonstrates the ability of the weighted ensemble sampling approach to scale to large, complex systems. We focus on characterizing the synthesis of protein P2. The production of P2, the last step in the cascade shown in <xref ref-type="fig" rid="pcbi.1004611.g006">Fig 6</xref>, is challenging to sample via brute-force. Nonetheless, it is a crucial quantity to calibrate if one is interested in the effects of spatial heterogeneity on the model, and we do so using weighted ensemble.</p>
<p>To begin our exploration of the signaling model, we initially examine the production of the protein P2 after 400 seconds of simulation (see <xref ref-type="fig" rid="pcbi.1004611.g009">Fig 9</xref>). The weighted ensemble data was produced by two independent runs, and the two resulting independent histograms are shown together. The independent runs allow us to roughly characterize the uncertainty in the estimated probability distribution by simply inspecting the vertical spread in the results.</p>
<fig id="pcbi.1004611.g009" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g009</object-id>
<label>Fig 9</label>
<caption>
<title>Accelerated sampling of high P2 levels.</title>
<p>After 400 simulated seconds (∼1 week of wall time for one trajectory), we plot the histogram of the number of P2 molecules in the cell. The blue and green circles are the result of two independent weighted ensemble simulations. Note that some data points are missing, because not all weighted ensemble bins are necessarily populated by trajectory segments at all times.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g009" xlink:type="simple"/>
</fig>
<p>Detailed exploration of the tail of a probability distribution, as shown in <xref ref-type="fig" rid="pcbi.1004611.g009">Fig 9</xref>, can be interesting in its own right, for instance to detect multimodality, or otherwise explore the state-space for rare but important events. We are also interested in using the high resolution characterization of the tail of the P2 distribution as leverage with which to facilitate estimation of the <italic>mean</italic> time to the production of five P2 molecules. The target of five P2 molecules was chosen to represent a modest but non-trivial level of P2 production.</p>
<p>To extract information about average P2 production time from short simulations, we work in a steady-state framework, as described in the Methods section. Using this methodology, we are able to infer the mean time to the creation of five P2 molecules, a relatively long timescale, from a weighted ensemble of short simulations. Shown in <xref ref-type="fig" rid="pcbi.1004611.g010">Fig 10</xref> is probability flux arriving at the target state of five P2 molecules at each WE iteration, as well as a running average of those instantaneous measurements, made using the most recent half of the data up to that time. When the system reaches a steady-state, the inverse of the probability flux into the target state, shown for on the right vertical axis of <xref ref-type="fig" rid="pcbi.1004611.g010">Fig 10</xref>, is equal to the mean time to reach the target state. In <xref ref-type="fig" rid="pcbi.1004611.g010">Fig 10</xref>, we see that the estimated time to the production of five P2 molecules is on the order of 5,000 seconds. This estimate will converge, within stochastic noise, to the true MFPT of the system when the flow of probability induced by the recycling process has relaxed to a steady state; see the Methods section for details.</p>
<fig id="pcbi.1004611.g010" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g010</object-id>
<label>Fig 10</label>
<caption>
<title>Steady-state estimate of time to produce five P2.</title>
<p>The last event in the complex signaling network of <xref ref-type="fig" rid="pcbi.1004611.g006">Fig 6</xref> is the production of P2. Using a steady-state approach, weighted ensemble is able to estimate the mean time to producing 5 molecules of P2 as approximately 5,000 seconds. The graph shows the probability flux arriving at the target state (left axis) in each iteration (points), and a running average of that flux computed from the most recent 50% of the data (lines). The mean time to reach the target state (right axis) is obtained via the Hill relation (<xref ref-type="disp-formula" rid="pcbi.1004611.e001">Eq 1</xref>), as the inverse of the steady-state flux. Note that during most iterations, zero weight reaches the target state, as evidenced by the nearly continuous band of points at the bottom of the figure. The running average of the flux is dominated by these uneventful iterations, and hence is less than the nonzero instantaneous values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g010" xlink:type="simple"/>
</fig>
<p>Although WE is extremely efficient at characterizing the P2 distribution (<xref ref-type="fig" rid="pcbi.1004611.g009">Fig 9</xref>), its performance for estimating the MFPT is not exceptional in this case. The two WE runs require 31,328 seconds (run 1) and 27,408 seconds (run 2) of aggregate simulation to reach the relatively steady estimation shown in <xref ref-type="fig" rid="pcbi.1004611.g010">Fig 10</xref> at <italic>t</italic> = 400 seconds. By comparison, to obtain five to ten events for estimating the MFPT by brute-force sampling would require ∼25,000 to ∼50,000 seconds based on the estimated MFPT of ∼5,000 seconds. Note that such long runs would not be able to benefit from parallelization.</p>
<p>The efficiency of the steady-state approach to measuring the mean first passage time depends on the time to convergence, and the noise of the sampling, once converged. The noise of the sampling can be reduced by a more densely sampled weighted ensemble, but the time to convergence is more difficult to characterize. In the approach used here, the latter timescale depends on the waiting time to typical transition events (e.g. about 200 seconds in <xref ref-type="fig" rid="pcbi.1004611.g010">Fig 10</xref>), and the time it takes the system to relax to a steady-state. If these timescales (multiplied by the number of WE trajectories) are close to the timescale of the mean first passage time, then the estimate may not be particularly efficient. It will, however be less variable than a brute-force estimate of equivalent sampling power, and more convenient, in that it explores events of very different likelihood, and efficiently explores the state-space while estimating a key observable.</p>
</sec>
<sec id="sec020">
<title>Time dependent kinetics: Neuromuscular junction</title>
<p>Finally, we apply weighted ensemble sampling to a model of the active zone of a frog neuromuscular junction. This system, shown in <xref ref-type="fig" rid="pcbi.1004611.g007">Fig 7</xref>, and described in detail in the Models section, simulates the dynamics of vesicle fusion in the presynaptic terminal. The MCell model used in this study is identical to the one described previously [<xref ref-type="bibr" rid="pcbi.1004611.ref029">29</xref>]. Briefly, calcium molecules are released into the active zone, and are free to diffuse and bind to the calcium binding sites on the synaptic vesicles in response to an action potential. When enough calcium binds to a vesicle in the proper arrangement, the vesicle is considered to have fused.</p>
<p>Calibrating and validating the response of the model against experimental data is of crucial importance, but at low calcium concentrations, it becomes highly inefficient to perform brute-force simulation to gather good statistics. In the neuromuscular junction system, the probability of vesicle fusion depends on the external calcium concentration and falls off sharply as the calcium concentration is decreased.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004611.g011">Fig 11</xref> shows the distribution of times to first fusion in the model, or first passage time (FPT) distribution to fusion, when the external calcium concentration is 0.5 mM and 0.3 mM. At each concentration, we plot the averaged results of 100 weighted ensemble runs, each of which was performed as specified in the Models section, as well as the averaged results of brute-force simulations, which in total required the same computational effort to simulate as the 100 weighted ensemble simulations (7545 brute-force simulations for the 0.3 mM system, 3513 for the 0.5 mM system). The difference with which the two approaches—weighted ensemble and brute-force —are able to capture the shape of the distribution, and the uncertainty in the estimation of it, is striking. We are unaware of any definitive methods of estimating error when the sample yield is extremely low, and hence have omitted error bars when only one or two samples were obtained.</p>
<fig id="pcbi.1004611.g011" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g011</object-id>
<label>Fig 11</label>
<caption>
<title>Enhanced sampling of the first fusion time distribution in the NMJ Model in low calcium conditions.</title>
<p>Shown are measurements of the first fusion (i.e., first passage) time distribution for calcium concentrations of 0.5 mM (left), and 0.3 mM (right). In both plots, weighted ensemble estimate of the distribution of first fusion times for the NMJ model (blue), are compared to brute-force estimates (red) made using the same computational power as the weighted ensemble estimate. Points at the bottom of the plot indicate no fusion events in that time period. Single points with no error bars indicate only one sample, yielding no ability to estimate uncertainties. Brute-force sampling sees very few events, and gives a poor estimate of the shape of the distribution and yields poor confidence intervals (it is unable to exclude zero from any time point at one standard error). Weighted ensemble is able to capture the shape of the fusion time distribution, as well as providing good estimates in the uncertainty of the measured values.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g011" xlink:type="simple"/>
</fig>
<p>At low calcium concentrations, the overwhelming majority of simulations do not result in a vesicle release, which is why brute-force sampling is so ineffective. Notice that the total area (i.e. the total probability of vesicle fusion) in the histogram for the 0.3 mM condition is only on the order of 10<sup>−4</sup>. One would have to perform on the order of 100/10<sup>−4</sup> = 10<sup>6</sup> simulations to start gathering meaningful statistics (100 samples) with which to compute the fusion time distribution. This amount of computing (∼20 years running in serial, if each simulation only takes a minute, or ∼20 weeks, running in parallel on a 48-core machine) is unfeasible to perform even once, let alone at all the different settings of model parameters of interest. Using weighted ensemble, however, it becomes practical to sample this model in the low-calcium regime, providing critical information for model validation and fitting purposes. The weighted ensemble sampling for the 0.3 mM condition shown in <xref ref-type="fig" rid="pcbi.1004611.g011">Fig 11</xref> took time equivalent to 7545 brute-force simulations, and runs in matter of hours in parallel on 48 cores.</p>
<p>
<xref ref-type="fig" rid="pcbi.1004611.g012">Fig 12</xref> summarizes NMJ results at five different experimentally relevant calcium concentrations. The data are a striking recapitulation of an experimentally demonstrated power-law dependence of probability to fuse as a function of calcium ion concentration [<xref ref-type="bibr" rid="pcbi.1004611.ref067">67</xref>]. Validating the model in low calcium regimes has been intractable with traditional sampling approaches. Using weighted ensemble, we are able to sample the model at all concentrations of interest.</p>
<fig id="pcbi.1004611.g012" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004611.g012</object-id>
<label>Fig 12</label>
<caption>
<title>Verification of empirical fusion rate law extended to low calcium regime.</title>
<p>The probability for the model to release a synaptic vesicle in the simulation window is plotted vs. the calcium concentration in the simulation. Weighted ensemble is able to efficiently estimate these probabilities in the low calcium regime (0.5 mM and below). WE data points and the power-law fit are shown with 1-<italic>σ</italic> confidence intervals.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.g012" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec021" sec-type="conclusions">
<title>Discussion</title>
<p>Spatial models of stochastic reaction-diffusion processes have found widespread use as tools in understanding the mechanics of biological processes on the cellular level and beyond [<xref ref-type="bibr" rid="pcbi.1004611.ref068">68</xref>–<xref ref-type="bibr" rid="pcbi.1004611.ref072">72</xref>]. Unfortunately, the effective sampling of large, realistic models, and the extraction of well-sampled values of experimentally relevant quantities are often beyond the realm of computational feasibility. We use a weighted ensemble approach to overcome this impediment and demonstrate speedups of orders of magnitude in sampling some observables in complex models of cellular behavior with spatial dependence. Weighted ensemble is an ideal approach to employ in addressing the issue of difficult to sample stochastic systems, and because of its efficiency and ease of use, we anticipate many further applications.</p>
<sec id="sec022">
<title>Strengths and weaknesses of WE</title>
<sec id="sec023">
<title>Strengths</title>
<p>Weighted ensemble is one of many enhanced sampling methods, and one of a smaller number that provides rigorous kinetics [<xref ref-type="bibr" rid="pcbi.1004611.ref017">17</xref>]. However, WE stands out from comparable approaches in its modularity, flexibility, and ease of use. Because weighted ensemble only performs resampling at fixed time intervals, and only when a trajectory transitions from one state-space bin to another, there is no need to catch trajectories in the act of crossing a state-space interface. This facilitates the implementation of weighted ensemble as a lightweight “wrapper code” around any number of simulation engines. A weighted ensemble approach also parallelizes trivially, as all trajectories are uncoupled while running, and are only compared intermittently during resampling. This efficiency in scaling has been demonstrated on simulations using over 2000 cores across many nodes on the Ranger supercomputer [<xref ref-type="bibr" rid="pcbi.1004611.ref037">37</xref>]. Additionally, a weighted ensemble of trajectories always follows the exact dynamics of the system; no biasing potentials, altered rate constants, change of measure, or other “hands on” tactics are necessary for efficient sampling.</p>
<p>A significant benefit of the WE approach is the ability to quickly find behaviors of a system that are very rare, or to detect the presence of multiple stable states of a system with high crossing barriers. As seen in our study of the cellular signaling model in a realistic geometry, efficient sampling via WE permits estimation of previously unknown long timescales using short simulations.</p>
</sec>
<sec id="sec024">
<title>Weaknesses</title>
<p>All unbiased enhanced sampling methods that sample systems preferentially along a set of progress coordinates, including weighted ensemble, are useful only insofar as the state space has been divided along progress coordinates sufficient to characterize processes of interest. This limitation amounts to employing all of the slow, uncorrelated, degrees of freedom in the system as progress coordinates. Fortunately, an exhaustive use of all slow degrees of freedom is not required, as most will be correlated, and thus redundant descriptors of slow processes. Hence a “curse of dimensionality” does not cripple these approaches, and exists only to the extent that a system has important slow degrees of freedom which are uncorrelated with binned coordinates, but sufficient sampling is never guaranteed.</p>
<p>Sampling coordinates orthogonal to the progress coordinate will, by definition, not happen at an enhanced rate, which places a lower limit on the shortest useful simulations that can be performed. For instance, the toy model we investigate has only one effective degree of freedom, and displays an enormous amount of speed-up in sampling along this coordinate, because there are no slow orthogonal degrees of freedom being sampled on a slow, “native” timescale. On the other hand, the signaling model in the realistic cellular geometry shows less enhancement, a factor of about 10<sup>5</sup> in sampling large amounts of P2, and less than that in estimating the mean time to production of five P2. This is because there are degrees of freedom in the system orthogonal to our progress coordinate that must relax to steady-state at an unenhanced rate, a process which occurs on a timescale uncoupled to weighted ensemble resampling.</p>
<p>A potential difficulty is that of correlation between trajectories. Since most WE trajectories share some history by construction, judging the degree to which related trajectories are independently sampling the space requires special care [<xref ref-type="bibr" rid="pcbi.1004611.ref024">24</xref>, <xref ref-type="bibr" rid="pcbi.1004611.ref025">25</xref>]. Estimating observables within a single WE run requires careful consideration of time correlation. Alternatively, as in the present study, multiple independent WE runs directly provide unambiguous information on statistical uncertainty.</p>
<p>Weighted ensemble is not guaranteed to enhance sampling for all observables. In essence, WE will be most useful for the observables that occur with low probabilities on the time scales of interest. For less challenging quantities, such as the mean first passage time of <xref ref-type="fig" rid="pcbi.1004611.g010">Fig 10</xref>, or the high calcium concentrations of <xref ref-type="fig" rid="pcbi.1004611.g012">Fig 12</xref>, WE may primarily offer the advantage of simple parallelization.</p>
</sec>
</sec>
<sec id="sec025">
<title>Summary and outlook</title>
<p>The multi-scale modeling problem posed by constructing accurate, physically realistic models of cellular level processes is considerable. We have demonstrated the utility of sampling spatially inhomogeneous stochastic simulations of cellular processes using a weighted ensemble (WE) approach. Although WE cannot estimate every quantity with high efficiency, estimates for some observables were obtained using orders of magnitude less overall computing than would have been required with conventional parallelization. We hope that these initial results will facilitate the study of more realistic and physically accurate spatial models of biological systems. As an ambitious example, integrating spatial models of stochastic processes with microscopy data of protein localization to predict phenotypic response to the perturbations of interactome networks is an attractive prospect for in silico drug development and personalized medicine. Currently, the bottlenecks in such a scheme are the lack of accurate models and the computational resources with which to simulate them. We hope that this work will contribute to the development of truly physiological computational models.</p>
</sec>
</sec>
<sec id="sec026">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004611.s001" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.s001" xlink:type="simple">
<label>S1 Model</label>
<caption>
<title>Toy model.</title>
<p>Files containing the model details and with which one can simulate the model in MCell.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004611.s002" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.s002" xlink:type="simple">
<label>S2 Model</label>
<caption>
<title>Cellular model in realistic geometry.</title>
<p>Files containing the model details and with which one can simulate the model in MCell.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004611.s003" mimetype="application/octet-stream" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.s003" xlink:type="simple">
<label>S3 Model</label>
<caption>
<title>Realistic cellular model reaction network.</title>
<p>BioNetGen file containing the details of the reaction network used in the model.</p>
<p>(BNGL)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004611.s004" mimetype="application/zip" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1004611.s004" xlink:type="simple">
<label>S4 Model</label>
<caption>
<title>Neuromuscular junction.</title>
<p>Files containing the model details and with which one can simulate the model in MCell.</p>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors gratefully acknowledge helpful conversations with Ernesto Suárez, Lillian Chong, Matthew Zwier, and Joshua Adelman.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004611.ref001">
<label>1</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Zuckerman</surname> <given-names>DM</given-names></name> (<year>2010</year>) <source>Statistical Physics of Biomolecules: An Introduction</source>. <publisher-name>Taylor &amp; Francis</publisher-name>.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Elowitz</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Levine</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Siggia</surname> <given-names>ED</given-names></name>, <name name-style="western"><surname>Swain</surname> <given-names>PS</given-names></name> (<year>2002</year>) <article-title>Stochastic gene expression in a single cell</article-title>. <source>Science</source> <volume>297</volume>: <fpage>1183</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1070919" xlink:type="simple">10.1126/science.1070919</ext-link></comment> <object-id pub-id-type="pmid">12183631</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Munsky</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Neuert</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>van Oudenaarden</surname> <given-names>A</given-names></name> (<year>2012</year>) <article-title>Using gene expression noise to understand gene regulation</article-title>. <source>Science</source> <volume>336</volume>: <fpage>183</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1216379" xlink:type="simple">10.1126/science.1216379</ext-link></comment> <object-id pub-id-type="pmid">22499939</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stefan</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Kennedy</surname> <given-names>MB</given-names></name> (<year>2014</year>) <article-title>Multi-state modeling of biomolecules</article-title>. <source>PLoS computational biology</source> <volume>10</volume>: <fpage>e1003844</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003844" xlink:type="simple">10.1371/journal.pcbi.1003844</ext-link></comment> <object-id pub-id-type="pmid">25254957</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref005">
<label>5</label>
<mixed-citation publication-type="other" xlink:type="simple">Shaw DE, Grossman J, Bank JA, Batson B, Butts JA, et al. (2014) Anton 2: Raising the Bar for Performance and Programmability in a Special-Purpose Molecular Dynamics Supercomputer. In: SC14: International Conference for High Performance Computing, Networking, Storage and Analysis. IEEE, pp. 41–53. 10.1109/SC.2014.9. URL <ext-link ext-link-type="uri" xlink:href="http://dl.acm.org/citation.cfm?id = 2683593.2683599" xlink:type="simple">http://dl.acm.org/citation.cfm?id = 2683593.2683599</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dror</surname> <given-names>RO</given-names></name>, <name name-style="western"><surname>Dirks</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Grossman</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Shaw</surname> <given-names>DE</given-names></name> (<year>2012</year>) <article-title>Biomolecular simulation: a computational microscope for molecular biology</article-title>. <source>Annual review of biophysics</source> <volume>41</volume>: <fpage>429</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev-biophys-042910-155245" xlink:type="simple">10.1146/annurev-biophys-042910-155245</ext-link></comment> <object-id pub-id-type="pmid">22577825</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Karr</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Sanghvi</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Macklin</surname> <given-names>DN</given-names></name>, <name name-style="western"><surname>Gutschow</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Jacobs</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A whole-cell computational model predicts phenotype from genotype</article-title>. <source>Cell</source> <volume>150</volume>: <fpage>389</fpage>–<lpage>401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2012.05.044" xlink:type="simple">10.1016/j.cell.2012.05.044</ext-link></comment> <object-id pub-id-type="pmid">22817898</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Torrie</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Valleau</surname> <given-names>J</given-names></name> (<year>1977</year>) <article-title>Nonphysical sampling distributions in Monte Carlo free-energy estimation: Umbrella sampling</article-title>. <source>Journal of Computational Physics</source> <volume>23</volume>: <fpage>187</fpage>–<lpage>199</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/0021-9991(77)90121-8" xlink:type="simple">10.1016/0021-9991(77)90121-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kumar</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rosenberg</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Bouzida</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Swendsen</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Kollman</surname> <given-names>PA</given-names></name> (<year>1992</year>) <article-title>THE weighted histogram analysis method for free-energy calculations on biomolecules. I. The method</article-title>. <source>Journal of Computational Chemistry</source> <volume>13</volume>: <fpage>1011</fpage>–<lpage>1021</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/jcc.540130812" xlink:type="simple">10.1002/jcc.540130812</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bussi</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Laio</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Parrinello</surname> <given-names>M</given-names></name> (<year>2006</year>) <article-title>Equilibrium Free Energies from Nonequilibrium Metadynamics</article-title>. <source>Physical Review Letters</source> <volume>96</volume>: <fpage>090601</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.96.090601" xlink:type="simple">10.1103/PhysRevLett.96.090601</ext-link></comment> <object-id pub-id-type="pmid">16606249</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Moroni</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>van Erp</surname> <given-names>TS</given-names></name>, <name name-style="western"><surname>Bolhuis</surname> <given-names>PG</given-names></name> (<year>2004</year>) <article-title>Investigating rare events by transition interface sampling</article-title>. <source>Physica A: Statistical Mechanics and its Applications</source> <volume>340</volume>: <fpage>395</fpage>–<lpage>401</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.physa.2004.04.033" xlink:type="simple">10.1016/j.physa.2004.04.033</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Allen</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Valeriani</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>ten Wolde</surname> <given-names>PR</given-names></name> (<year>2009</year>) <article-title>Forward flux sampling for rare event simulations</article-title>. <source>Journal of physics: Condensed matter</source> <volume>21</volume>: <fpage>463102</fpage>. <object-id pub-id-type="pmid">21715864</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huber</surname> <given-names>GA</given-names></name>, <name name-style="western"><surname>Kim</surname> <given-names>S</given-names></name> (<year>1996</year>) <article-title>Weighted-ensemble Brownian dynamics simulations for protein association reactions</article-title>. <source>Biophysical journal</source> <volume>70</volume>: <fpage>97</fpage>–<lpage>110</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(96)79552-8" xlink:type="simple">10.1016/S0006-3495(96)79552-8</ext-link></comment> <object-id pub-id-type="pmid">8770190</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dellago</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bolhuis</surname> <given-names>PG</given-names></name>, <name name-style="western"><surname>Csajka</surname> <given-names>FS</given-names></name>, <name name-style="western"><surname>Chandler</surname> <given-names>D</given-names></name> (<year>1998</year>) <article-title>Transition path sampling and the calculation of rate constants</article-title>. <source>The Journal of Chemical Physics</source> <volume>108</volume>: <fpage>1964</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.475562" xlink:type="simple">10.1063/1.475562</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Faradjian</surname> <given-names>AK</given-names></name>, <name name-style="western"><surname>Elber</surname> <given-names>R</given-names></name> (<year>2004</year>) <article-title>Computing time scales from reaction coordinates by milestoning</article-title>. <source>The Journal of chemical physics</source> <volume>120</volume>: <fpage>10880</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.1738640" xlink:type="simple">10.1063/1.1738640</ext-link></comment> <object-id pub-id-type="pmid">15268118</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Warmflash</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bhimalapuram</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dinner</surname> <given-names>AR</given-names></name> (<year>2007</year>) <article-title>Umbrella sampling for nonequilibrium processes</article-title>. <source>The Journal of chemical physics</source> <volume>127</volume>: <fpage>154112</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.2784118" xlink:type="simple">10.1063/1.2784118</ext-link></comment> <object-id pub-id-type="pmid">17949137</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Jasnow</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zuckerman</surname> <given-names>DM</given-names></name> (<year>2010</year>) <article-title>The “weighted ensemble” path sampling method is statistically exact for a broad class of stochastic processes and binning procedures</article-title>. <source>The Journal of chemical physics</source> <volume>132</volume>: <fpage>054107</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.3306345" xlink:type="simple">10.1063/1.3306345</ext-link></comment> <object-id pub-id-type="pmid">20136305</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Swendsen</surname> <given-names>RH</given-names></name>, <name name-style="western"><surname>Wang</surname> <given-names>JS</given-names></name> (<year>1986</year>) <article-title>Replica Monte Carlo Simulation of Spin-Glasses</article-title>. <source>Physical Review Letters</source> <volume>57</volume>: <fpage>2607</fpage>–<lpage>2609</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.57.2607" xlink:type="simple">10.1103/PhysRevLett.57.2607</ext-link></comment> <object-id pub-id-type="pmid">10033814</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hansmann</surname> <given-names>UH</given-names></name> (<year>1997</year>) <article-title>Parallel tempering algorithm for conformational studies of biological molecules</article-title>. <source>Chemical Physics Letters</source> <volume>281</volume>: <fpage>140</fpage>–<lpage>150</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0009-2614(97)01198-6" xlink:type="simple">10.1016/S0009-2614(97)01198-6</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sugita</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Okamoto</surname> <given-names>Y</given-names></name> (<year>1999</year>) <article-title>Replica-exchange molecular dynamics method for protein folding</article-title>. <source>Chemical Physics Letters</source> <volume>314</volume>: <fpage>141</fpage>–<lpage>151</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0009-2614(99)01123-9" xlink:type="simple">10.1016/S0009-2614(99)01123-9</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lyman</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Ytreberg</surname> <given-names>FM</given-names></name>, <name name-style="western"><surname>Zuckerman</surname> <given-names>DM</given-names></name> (<year>2006</year>) <article-title>Resolution Exchange Simulation</article-title>. <source>Physical Review Letters</source> <volume>96</volume>: <fpage>028105</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1103/PhysRevLett.96.028105" xlink:type="simple">10.1103/PhysRevLett.96.028105</ext-link></comment> <object-id pub-id-type="pmid">16486650</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scheraga</surname> <given-names>HA</given-names></name>, <name name-style="western"><surname>Khalili</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Liwo</surname> <given-names>A</given-names></name> (<year>2007</year>) <article-title>Protein-folding dynamics: overview of molecular simulation techniques</article-title>. <source>Annual review of physical chemistry</source> <volume>58</volume>: <fpage>57</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.physchem.58.032806.104614" xlink:type="simple">10.1146/annurev.physchem.58.032806.104614</ext-link></comment> <object-id pub-id-type="pmid">17034338</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zuckerman</surname> <given-names>DM</given-names></name> (<year>2011</year>) <article-title>Equilibrium sampling in biomolecular simulations</article-title>. <source>Annual review of biophysics</source> <volume>40</volume>: <fpage>41</fpage>–<lpage>62</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev-biophys-042910-155255" xlink:type="simple">10.1146/annurev-biophys-042910-155255</ext-link></comment> <object-id pub-id-type="pmid">21370970</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zwier</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Kaus</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Chong</surname> <given-names>LT</given-names></name> (<year>2011</year>) <article-title>Efficient Explicit-Solvent Molecular Dynamics Simulations of Molecular Association Kinetics: Methane/Methane, Na+/Cl-, Methane/Benzene, and K+/18-Crown-6 Ether</article-title>. <source>Journal of Chemical Theory and Computation</source> <volume>7</volume>: <fpage>1189</fpage>–<lpage>1197</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ct100626x" xlink:type="simple">10.1021/ct100626x</ext-link></comment> <object-id pub-id-type="pmid">26606365</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhang</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Jasnow</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zuckerman</surname> <given-names>DM</given-names></name> (<year>2007</year>) <article-title>Efficient and verified simulation of a path ensemble for conformational change in a united-residue model of calmodulin</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>104</volume>: <fpage>18043</fpage>–<lpage>8</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0706349104" xlink:type="simple">10.1073/pnas.0706349104</ext-link></comment> <object-id pub-id-type="pmid">17984047</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bhatt</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zuckerman</surname> <given-names>DM</given-names></name> (<year>2010</year>) <article-title>Heterogeneous path ensembles for conformational transitions in semi-atomistic models of adenylate kinase</article-title>. <source>Journal of chemical theory and computation</source> <volume>6</volume>: <fpage>3527</fpage>–<lpage>3539</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ct100406t" xlink:type="simple">10.1021/ct100406t</ext-link></comment> <object-id pub-id-type="pmid">21660120</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Donovan</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Sedgewick</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Faeder</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Zuckerman</surname> <given-names>DM</given-names></name> (<year>2013</year>) <article-title>Efficient stochastic simulation of chemical kinetics networks using a weighted ensemble of trajectories</article-title>. <source>The Journal of chemical physics</source> <volume>139</volume>: <fpage>115105</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4821167" xlink:type="simple">10.1063/1.4821167</ext-link></comment> <object-id pub-id-type="pmid">24070313</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Suárez</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Lettieri</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zwier</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Stringer</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Subramanian</surname> <given-names>SR</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Simultaneous Computation of Dynamical and Equilibrium Information Using a Weighted Ensemble of Trajectories</article-title>. <source>Journal of Chemical Theory and Computation</source> <volume>10</volume>: <fpage>2658</fpage>–<lpage>2667</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ct401065r" xlink:type="simple">10.1021/ct401065r</ext-link></comment> <object-id pub-id-type="pmid">25246856</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dittrich</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Pattillo</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>King</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Cho</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stiles</surname> <given-names>JR</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>An excess-calcium-binding-site model predicts neurotransmitter release at the neuromuscular junction</article-title>. <source>Biophysical journal</source> <volume>104</volume>: <fpage>2751</fpage>–<lpage>63</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2013.05.023" xlink:type="simple">10.1016/j.bpj.2013.05.023</ext-link></comment> <object-id pub-id-type="pmid">23790384</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gillespie</surname> <given-names>DT</given-names></name> (<year>2007</year>) <article-title>Stochastic simulation of chemical kinetics</article-title>. <source>Annual review of physical chemistry</source> <volume>58</volume>: <fpage>35</fpage>–<lpage>55</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.physchem.58.032806.104637" xlink:type="simple">10.1146/annurev.physchem.58.032806.104637</ext-link></comment> <object-id pub-id-type="pmid">17037977</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sneddon</surname> <given-names>MW</given-names></name>, <name name-style="western"><surname>Faeder</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Emonet</surname> <given-names>T</given-names></name> (<year>2011</year>) <article-title>Efficient modeling, simulation and coarse-graining of biological complexity with NFsim</article-title>. <source>Nature methods</source> <volume>8</volume>: <fpage>177</fpage>–<lpage>83</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.1546" xlink:type="simple">10.1038/nmeth.1546</ext-link></comment> <object-id pub-id-type="pmid">21186362</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huh</surname> <given-names>WK</given-names></name>, <name name-style="western"><surname>Falvo</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Gerke</surname> <given-names>LC</given-names></name>, <name name-style="western"><surname>Carroll</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Howson</surname> <given-names>RW</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>Global analysis of protein localization in budding yeast</article-title>. <source>Nature</source> <volume>425</volume>: <fpage>686</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature02026" xlink:type="simple">10.1038/nature02026</ext-link></comment> <object-id pub-id-type="pmid">14562095</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sprenger</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Lynn Fink</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Karunaratne</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hanson</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Hamilton</surname> <given-names>NA</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>LOCATE: a mammalian protein subcellular localization database</article-title>. <source>Nucleic acids research</source> <volume>36</volume>: <fpage>D230</fpage>–<lpage>3</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/nar/gkm950" xlink:type="simple">10.1093/nar/gkm950</ext-link></comment> <object-id pub-id-type="pmid">17986452</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Coelho</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Kangas</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Naik</surname> <given-names>AW</given-names></name>, <name name-style="western"><surname>Osuna-Highley</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Glory-Afshar</surname> <given-names>E</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Determining the subcellular location of new proteins from microscope images using local features</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>2343</fpage>–<lpage>2349</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/btt392" xlink:type="simple">10.1093/bioinformatics/btt392</ext-link></comment> <object-id pub-id-type="pmid">23836142</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Adelman</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Grabe</surname> <given-names>M</given-names></name> (<year>2013</year>) <article-title>Simulating rare events using a weighted ensemble-based string method</article-title>. <source>The Journal of chemical physics</source> <volume>138</volume>: <fpage>044105</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1063/1.4773892" xlink:type="simple">10.1063/1.4773892</ext-link></comment> <object-id pub-id-type="pmid">23387566</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref036">
<label>36</label>
<mixed-citation publication-type="other" xlink:type="simple">Hill TL (2004) Free Energy Transduction And Biochemical Cycle Kinetics. Dover Publications, 119 pp. URL <ext-link ext-link-type="uri" xlink:href="http://books.google.com/books?id=AqVsAAAACAAJ&amp;pgis=1" xlink:type="simple">http://books.google.com/books?id=AqVsAAAACAAJ&amp;pgis=1</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zwier</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Adelman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Kaus</surname> <given-names>JW</given-names></name>, <name name-style="western"><surname>Pratt</surname> <given-names>AJ</given-names></name>, <name name-style="western"><surname>Wong</surname> <given-names>KF</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <article-title>WESTPA: An interoperable, highly scalable software package for weighted ensemble simulation and analysis</article-title>. <source>Journal of Chemical Theory and Computation</source> <volume>11</volume>: <fpage>150113180903008</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1021/ct5010615" xlink:type="simple">10.1021/ct5010615</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kerr</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Kaminsky</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dittrich</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>JCJ</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Fast Monte Carlo Simulation Methods for Biological Reaction-Diffusion Systems in Solution and on Surfaces</article-title>. <source>SIAM journal on scientific computing</source> <volume>30</volume>: <fpage>3126</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1137/070692017" xlink:type="simple">10.1137/070692017</ext-link></comment> <object-id pub-id-type="pmid">20151023</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kinney</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Spacek</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Bajaj</surname> <given-names>CL</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>KM</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Extracellular sheets and tunnels modulate glutamate diffusion in hippocampal neuropil</article-title>. <source>Journal of Comparative Neurology</source> <volume>521</volume>: <fpage>448</fpage>–<lpage>464</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/cne.23181" xlink:type="simple">10.1002/cne.23181</ext-link></comment> <object-id pub-id-type="pmid">22740128</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Scimemi</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Diamond</surname> <given-names>JS</given-names></name> (<year>2012</year>) <article-title>The number and organization of Ca2+ channels in the active zone shapes neurotransmitter release from Schaffer collateral synapses</article-title>. <source>The Journal of neuroscience: the official journal of the Society for Neuroscience</source> <volume>32</volume>: <fpage>18157</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.3827-12.2012" xlink:type="simple">10.1523/JNEUROSCI.3827-12.2012</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dilger</surname> <given-names>JP</given-names></name> (<year>2013</year>) <article-title>Simulation of the kinetics of neuromuscular block: implications for speed of onset</article-title>. <source>Anesthesia and analgesia</source> <volume>117</volume>: <fpage>792</fpage>–<lpage>802</lpage>. <object-id pub-id-type="pmid">23456666</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fameli</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Ogunbayo</surname> <given-names>OA</given-names></name>, <name name-style="western"><surname>van Breemen</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Evans</surname> <given-names>AM</given-names></name> (<year>2014</year>) <article-title>Cytoplasmic nanojunctions between lysosomes and sarcoplasmic reticulum are required for specific calcium signaling</article-title>. <source>F1000Research</source> <volume>3</volume>: <fpage>93</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.12688/f1000research.3720.1" xlink:type="simple">10.12688/f1000research.3720.1</ext-link></comment> <object-id pub-id-type="pmid">25126414</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Regner</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Vučinić</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Domnisoru</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Hetzer</surname> <given-names>MW</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Anomalous diffusion of single particles in cytoplasm</article-title>. <source>Biophysical journal</source> <volume>104</volume>: <fpage>1652</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2013.01.049" xlink:type="simple">10.1016/j.bpj.2013.01.049</ext-link></comment> <object-id pub-id-type="pmid">23601312</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Coggan</surname> <given-names>JS</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Esquenazi</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Stiles</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Lamont</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2005</year>) <article-title>Evidence for ectopic neurotransmission at a neuronal synapse</article-title>. <source>Science (New York, NY)</source> <volume>309</volume>: <fpage>446</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1108239" xlink:type="simple">10.1126/science.1108239</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref045">
<label>45</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Dittrich</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Faeder</surname> <given-names>JR</given-names></name> (<year>2015</year>) <chapter-title>MCell</chapter-title>. In: <name name-style="western"><surname>Jaeger</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Jung</surname> <given-names>R</given-names></name>, editors, <source>Encyclopedia of Computational Neuroscience</source>, <publisher-loc>New York</publisher-loc>: <publisher-name>Springer</publisher-name>. pp. <fpage>1673</fpage>–<lpage>1676</lpage>. URL <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/referenceworkentry/10.1007/978-1-4614-7320-6_256-1" xlink:type="simple">http://link.springer.com/referenceworkentry/10.1007/978-1-4614-7320-6_256-1</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stiles</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Van Helden</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Salpeter</surname> <given-names>EE</given-names></name>, <name name-style="western"><surname>Salpeter</surname> <given-names>MM</given-names></name> (<year>1996</year>) <article-title>Miniature endplate current rise times less than 100 microseconds from improved dual recordings can be modeled with passive acetylcholine diffusion from a synaptic vesicle</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>93</volume>: <fpage>5747</fpage>–<lpage>52</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.93.12.5747" xlink:type="simple">10.1073/pnas.93.12.5747</ext-link></comment> <object-id pub-id-type="pmid">8650164</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref047">
<label>47</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Stiles</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>T</given-names></name> (<year>2001</year>) <chapter-title>Computational neuroscience: Realistic modeling for experimentalists</chapter-title>. In: <name name-style="western"><surname>De Schutter</surname> <given-names>E</given-names></name>, editor, <source>Computational Neuroscience: Realistic Modeling for Experimentalists</source>, <publisher-loc>Boca Raton</publisher-loc>: <publisher-name>CRC Press, chapter Monte Carl</publisher-name>. pp. <fpage>87</fpage>–<lpage>127</lpage>. URL <ext-link ext-link-type="uri" xlink:href="http://www.citeulike.org/user/wvangeit/article/1721805" xlink:type="simple">http://www.citeulike.org/user/wvangeit/article/1721805</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Faeder</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Blinov</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Hlavacek</surname> <given-names>WS</given-names></name> (<year>2009</year>) <article-title>Rule-based modeling of biochemical systems with BioNetGen</article-title>. <source>Methods in molecular biology</source> <volume>500</volume>: <fpage>113</fpage>–<lpage>67</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-59745-525-1_5" xlink:type="simple">10.1007/978-1-59745-525-1_5</ext-link></comment> <object-id pub-id-type="pmid">19399430</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chylek</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Harris</surname> <given-names>LA</given-names></name>, <name name-style="western"><surname>Tung</surname> <given-names>CS</given-names></name>, <name name-style="western"><surname>Faeder</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Lopez</surname> <given-names>CF</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Rule-based modeling: a computational approach for studying biomolecular site dynamics in cell signaling systems</article-title>. <source>Wiley Interdisciplinary Reviews: Systems Biology and Medicine</source> <volume>6</volume>: <fpage>13</fpage>–<lpage>36</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/wsbm.1245" xlink:type="simple">10.1002/wsbm.1245</ext-link></comment> <object-id pub-id-type="pmid">24123887</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>RF</given-names></name> (<year>2007</year>) <article-title>Automated learning of generative models for subcellular location: building blocks for systems biology</article-title>. <source>Cytometry</source> <volume>71A</volume>: <fpage>978</fpage>–<lpage>90</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/cyto.a.20487" xlink:type="simple">10.1002/cyto.a.20487</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref051">
<label>51</label>
<mixed-citation publication-type="other" xlink:type="simple">Rohde GK, Wang W, Peng T, Murphy RF (2008) Deformation-based nonlinear dimension reduction: Applications to nuclear morphometry. In: 2008 5th IEEE International Symposium on Biomedical Imaging: From Nano to Macro. IEEE, pp. 500–503. 10.1109/ISBI.2008.4541042. URL <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/articleDetails.jsp?arnumber = 4541042" xlink:type="simple">http://ieeexplore.ieee.org/articleDetails.jsp?arnumber = 4541042</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rohde</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Ribeiro</surname> <given-names>AJS</given-names></name>, <name name-style="western"><surname>Dahl</surname> <given-names>KN</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>RF</given-names></name> (<year>2008</year>) <article-title>Deformation-based nuclear morphometry: capturing nuclear shape variation in HeLa cells</article-title>. <source>Cytometry</source> <volume>73A</volume>: <fpage>341</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/cyto.a.20506" xlink:type="simple">10.1002/cyto.a.20506</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref053">
<label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Peng T, Wang W, Rohde GK, Murphy RF (2009) Instance-Based Generative Biological Shape Modeling. Proceedings / IEEE International Symposium on Biomedical Imaging: from nano to macro IEEE International Symposium on Biomedical Imaging 5193141: 690–693.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shariff</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Rohde</surname> <given-names>GK</given-names></name> (<year>2010</year>) <article-title>A generative model of microtubule distributions, and indirect estimation of its parameters from fluorescence microscopy images</article-title>. <source>Cytometry</source> <volume>77A</volume>: <fpage>457</fpage>–<lpage>66</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Peng</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>RF</given-names></name> (<year>2011</year>) <article-title>Image-derived, three-dimensional generative models of cellular organization</article-title>. <source>Cytometry</source> <volume>79A</volume>: <fpage>383</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/cyto.a.21066" xlink:type="simple">10.1002/cyto.a.21066</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Buck</surname> <given-names>TE</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Rohde</surname> <given-names>GK</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>RF</given-names></name> (<year>2012</year>) <article-title>Toward the virtual cell: automated approaches to building models of subcellular organization “learned” from microscopy images</article-title>. <source>BioEssays: news and reviews in molecular, cellular and developmental biology</source> <volume>34</volume>: <fpage>791</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1002/bies.201200032" xlink:type="simple">10.1002/bies.201200032</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Shariff</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Wiking</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lundberg</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Rohde</surname> <given-names>GK</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Estimating microtubule distributions from 2D immunofluorescence microscopy images reveals differences among human cultured cell lines</article-title>. <source>PloS one</source> <volume>7</volume>: <fpage>e50292</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pone.0050292" xlink:type="simple">10.1371/journal.pone.0050292</ext-link></comment> <object-id pub-id-type="pmid">23209697</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Murphy</surname> <given-names>RF</given-names></name> (<year>2012</year>) <article-title>CellOrganizer: Image-derived models of subcellular organization and protein distribution</article-title>. <source>Methods in cell biology</source> <volume>110</volume>: <fpage>179</fpage>–<lpage>93</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/B978-0-12-388403-9.00007-2" xlink:type="simple">10.1016/B978-0-12-388403-9.00007-2</ext-link></comment> <object-id pub-id-type="pmid">22482949</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref059">
<label>59</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Sullivan</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Tapia</surname> <given-names>JJ</given-names></name>, <name name-style="western"><surname>Arepally</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Murphy</surname> <given-names>RF</given-names></name>, <name name-style="western"><surname>Dittrich</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2015</year>) <chapter-title>Design Automation for Biological Models: A Pipeline that Incorporates Spatial and Molecular Complexity</chapter-title>. In: <source>GLSVLSI</source>.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref060">
<label>60</label>
<mixed-citation publication-type="other" xlink:type="simple">SBML-Spatial Working Group (2015). SBML Spatial Processes Specification. URL <ext-link ext-link-type="uri" xlink:href="http://sbml.org/Documents/Specifications/SBML_Level_3/Packages/spatial" xlink:type="simple">http://sbml.org/Documents/Specifications/SBML_Level_3/Packages/spatial</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref061">
<label>61</label>
<mixed-citation publication-type="other" xlink:type="simple">Harris La, Hogg JS, Faeder JR (2009) Compartmental rule-based modeling of biochemical systems. Proceedings of the 2009 Winter Simulation Conference (WSC): 908–919.</mixed-citation>
</ref>
<ref id="pcbi.1004611.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Folkman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Moscona</surname> <given-names>A</given-names></name> (<year>1978</year>) <article-title>Role of cell shape in growth control</article-title>. <source>Nature</source> <volume>273</volume>: <fpage>345</fpage>–<lpage>349</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/273345a0" xlink:type="simple">10.1038/273345a0</ext-link></comment> <object-id pub-id-type="pmid">661946</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McBeath</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Pirone</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Nelson</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Bhadriraju</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>CS</given-names></name> (<year>2004</year>) <article-title>Cell Shape, Cytoskeletal Tension, and RhoA Regulate Stem Cell Lineage Commitment</article-title>. <source>Developmental Cell</source> <volume>6</volume>: <fpage>483</fpage>–<lpage>495</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S1534-5807(04)00075-9" xlink:type="simple">10.1016/S1534-5807(04)00075-9</ext-link></comment> <object-id pub-id-type="pmid">15068789</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vogel</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Sheetz</surname> <given-names>M</given-names></name> (<year>2006</year>) <article-title>Local force and geometry sensing regulate cell functions</article-title>. <source>Nature reviews Molecular cell biology</source> <volume>7</volume>: <fpage>265</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nrm1890" xlink:type="simple">10.1038/nrm1890</ext-link></comment> <object-id pub-id-type="pmid">16607289</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref065">
<label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bakal</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Aach</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Church</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Perrimon</surname> <given-names>N</given-names></name> (<year>2007</year>) <article-title>Quantitative morphological signatures define local signaling networks regulating cell morphology</article-title>. <source>Science (New York, NY)</source> <volume>316</volume>: <fpage>1753</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1140324" xlink:type="simple">10.1126/science.1140324</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Neves</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Tsokas</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Sarkar</surname> <given-names>A</given-names></name> (<year>2008</year>) <article-title>Cell shape and negative links in regulatory motifs together control spatial information flow in signaling networks</article-title>. <source>Cell</source>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cell.2008.04.025" xlink:type="simple">10.1016/j.cell.2008.04.025</ext-link></comment> <object-id pub-id-type="pmid">18485874</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dodge</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Rahamimoff</surname> <given-names>R</given-names></name> (<year>1967</year>) <article-title>Co-operative action of calcium ions in transmitter release at the neuromuscular junction</article-title>. <source>The Journal of Physiology</source> <volume>193</volume>: <fpage>419</fpage>–<lpage>432</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1113/jphysiol.1967.sp008367" xlink:type="simple">10.1113/jphysiol.1967.sp008367</ext-link></comment> <object-id pub-id-type="pmid">6065887</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Slepchenko</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Schaff</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Carson</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Loew</surname> <given-names>LM</given-names></name> (<year>2002</year>) <article-title>Computational cell biology: spatiotemporal simulation of cellular events</article-title>. <source>Annual review of biophysics and biomolecular structure</source> <volume>31</volume>: <fpage>423</fpage>–<lpage>41</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1146/annurev.biophys.31.101101.140930" xlink:type="simple">10.1146/annurev.biophys.31.101101.140930</ext-link></comment> <object-id pub-id-type="pmid">11988477</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Franks</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Bartol</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Sejnowski</surname> <given-names>TJ</given-names></name> (<year>2002</year>) <article-title>A Monte Carlo model reveals independent signaling at central glutamatergic synapses</article-title>. <source>Biophysical journal</source> <volume>83</volume>: <fpage>2333</fpage>–<lpage>48</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/S0006-3495(02)75248-X" xlink:type="simple">10.1016/S0006-3495(02)75248-X</ext-link></comment> <object-id pub-id-type="pmid">12414671</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hattne</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Fange</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Elf</surname> <given-names>J</given-names></name> (<year>2005</year>) <article-title>Stochastic reaction-diffusion simulation with MesoRD</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>21</volume>: <fpage>2923</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bti431" xlink:type="simple">10.1093/bioinformatics/bti431</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref071">
<label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Andrews</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Addy</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Brent</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>AP</given-names></name> (<year>2010</year>) <article-title>Detailed simulations of cell biology with Smoldyn 2.1</article-title>. <source>PLoS computational biology</source> <volume>6</volume>: <fpage>e1000705</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1000705" xlink:type="simple">10.1371/journal.pcbi.1000705</ext-link></comment> <object-id pub-id-type="pmid">20300644</object-id></mixed-citation>
</ref>
<ref id="pcbi.1004611.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dilger</surname> <given-names>JP</given-names></name> (<year>2010</year>) <article-title>Monte Carlo Simulation of Buffered Diffusion into and out of a Model Synapse</article-title>. <source>Biophysical Journal</source> <volume>98</volume>: <fpage>959</fpage>–<lpage>967</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.bpj.2009.11.034" xlink:type="simple">10.1016/j.bpj.2009.11.034</ext-link></comment> <object-id pub-id-type="pmid">20303853</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>