<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01011</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003424</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology</subject><subj-group><subject>Computational biology</subject><subj-group><subject>Metabolic networks</subject><subject>Systems biology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Computer science</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></article-categories>
<title-group>
<article-title>Fast Reconstruction of Compact Context-Specific Metabolic Network Models</article-title>
<alt-title alt-title-type="running-head">Fast Reconstruction of Metabolic Network Models</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Vlassis</surname><given-names>Nikos</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Pacheco</surname><given-names>Maria Pires</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Sauter</surname><given-names>Thomas</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Luxembourg Centre for Systems Biomedicine, University of Luxembourg, Luxembourg City, Luxembourg</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Life Sciences Research Unit, University of Luxembourg, Luxembourg City, Luxembourg</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Ouzounis</surname><given-names>Christos A.</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>The Centre for Research and Technology, Hellas, Greece</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">nikos.vlassis@uni.lu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Developed the mathematical models and algorithms: NV. Wrote the Introduction and Methods sections: NV. Carried out the experiments: MPP. Wrote the Related work section and Text S1: MPP. Suggested the problem and initiated the research: TS. Contributed in the methodological and experimental parts of the paper: TS. Contributed in the development of the Software: NV MPP TS. Contributed to the writing of the remaining sections of the paper: NV MPP TS.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>1</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>16</day><month>1</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>1</issue>
<elocation-id>e1003424</elocation-id>
<history>
<date date-type="received"><day>6</day><month>6</month><year>2013</year></date>
<date date-type="accepted"><day>20</day><month>11</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Vlassis et al</copyright-holder><license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" vol="" page="e1002972" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1002972"> <article-title>New Methods Section in PLOS Computational Biology</article-title></related-article>
<abstract>
<p>Systemic approaches to the study of a biological cell or tissue rely increasingly on the use of context-specific metabolic network models. The reconstruction of such a model from high-throughput data can routinely involve large numbers of tests under different conditions and extensive parameter tuning, which calls for fast algorithms. We present <sc>fastcore</sc>, a generic algorithm for reconstructing context-specific metabolic network models from global genome-wide metabolic network models such as Recon X. <sc>fastcore</sc> takes as input a core set of reactions that are known to be active in the context of interest (e.g., cell or tissue), and it searches for a flux consistent subnetwork of the global network that contains all reactions from the core set and a minimal set of additional reactions. Our key observation is that a minimal consistent reconstruction can be defined via a set of sparse modes of the global network, and <sc>fastcore</sc> iteratively computes such a set via a series of linear programs. Experiments on liver data demonstrate speedups of several orders of magnitude, and significantly more compact reconstructions, over a rival method. Given its simplicity and its excellent performance, <sc>fastcore</sc> can form the backbone of many future metabolic network reconstruction algorithms.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Metabolism comprises all life-sustaining biochemical processes. It plays an essential role in various aspects of biology, including the development and progression of many diseases. As the metabolism of a living cell involves several thousands of small molecules and their conversion, a full analysis of such a metabolic network is only feasible using computational approaches. In addition, metabolism differs significantly from cell to cell and over different contexts. Therefore, the efficient generation of context-specific mathematical models is of high interest. We present <sc>fastcore</sc>, a fast algorithm for the reconstruction of compact context-specific metabolic network models. The algorithm takes as input a global metabolic model and a set of reactions that are known to be active in a given context, and it produces a context-specific model. <sc>fastcore</sc> is significantly faster than other algorithms, typically obtaining a genome-wide reconstruction in a few seconds. High-throughput model building will soon become a common procedure for the integration and analysis of omics data, and we foresee many future applications of <sc>fastcore</sc> in disease and patient specific metabolic modeling.</p>
</abstract>
<funding-group><funding-statement>The research was funded by the Luxembourg Centre for Systems Biomedicine and the Life Sciences Research Unit, University of Luxembourg. MPP was supported by fellowships from the National Research Foundation of Luxembourg (FNR; <ext-link ext-link-type="uri" xlink:href="http://www.fnr.lu" xlink:type="simple">http://www.fnr.lu</ext-link>) (AFR 6041230). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="10"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> <xref ref-type="sec" rid="s3">Methods</xref> article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>Cell metabolism is known to play a key role in the pathogenesis of various diseases <xref ref-type="bibr" rid="pcbi.1003424-DeBerardinis1">[1]</xref> such as Parkinson's disease <xref ref-type="bibr" rid="pcbi.1003424-Pourfar1">[2]</xref> and cancer <xref ref-type="bibr" rid="pcbi.1003424-Hiller1">[3]</xref>. The study of human metabolism has been greatly advanced by the development of computational models of metabolism, such as Recon 1 <xref ref-type="bibr" rid="pcbi.1003424-Duarte1">[4]</xref>, the Edinburgh human metabolic network <xref ref-type="bibr" rid="pcbi.1003424-Hao1">[5]</xref>, and Recon 2 <xref ref-type="bibr" rid="pcbi.1003424-Thiele1">[6]</xref>. These are genome-scale metabolic network models that have been reconstructed by combining various sources of ‘omics’ and literature data, and they involve a large set of biochemical reactions that can be active in different contexts, e.g., different cell types or tissues <xref ref-type="bibr" rid="pcbi.1003424-Thiele2">[7]</xref>.</p>
<p>To maximize the predictive power of a metabolic model when conditioning on a specific context, for instance the energy metabolism of a neuron or the metabolism of liver, recent efforts go into the development of <italic>context-specific</italic> metabolic models <xref ref-type="bibr" rid="pcbi.1003424-Becker1">[8]</xref>–<xref ref-type="bibr" rid="pcbi.1003424-Agren1">[13]</xref>. These are network models that are derived from global models like Recon 1, but they only contain a subset of reactions, namely, those reactions that are active in the given context. Such context-specific metabolic models are known to exhibit superior explanatory and predictive power than their global counterparts <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Folger1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Bordbar1">[15]</xref>.</p>
<p>Most algorithms for context-specific metabolic network reconstruction (see ‘Related work’ section for a short overview) first identify a relevant subset of reactions according to some ‘omics’ information (typically expression data and bibliomics), and then search for a subnetwork of the global network that satisfies some mathematical requirements and contains all (or most of) these reactions <xref ref-type="bibr" rid="pcbi.1003424-Becker1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Agren1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Shlomi1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1003424-Jensen1">[18]</xref>. The mathematical requirements are typically imposed via flux balance analysis, which characterizes the steady-state distribution of fluxes in a metabolic network via linear constraints that are derived from the stoichiometry of the network and physical conservation laws <xref ref-type="bibr" rid="pcbi.1003424-Schuster1">[19]</xref>–<xref ref-type="bibr" rid="pcbi.1003424-Fleming1">[23]</xref>. The search problem may target the optimization of a specific functionality of the model (e.g., biomass production) or some other objective <xref ref-type="bibr" rid="pcbi.1003424-Blazier1">[24]</xref>, and it may involve repeated tests under different conditions and parameter tuning <xref ref-type="bibr" rid="pcbi.1003424-Becker1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Folger1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Orth1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Wang1">[26]</xref>. The latter calls for fast algorithms.</p>
<p>We present <sc>fastcore</sc>, a generic algorithm for context-specific metabolic network reconstruction. <sc>fastcore</sc> takes as input a core set of reactions that are supported by strong evidence to be active in the context of interest. Then it searches for a <italic>flux consistent</italic> subnetwork of the global network that contains all reactions from the core set and a minimal set of additional reactions. Flux consistency implies that each reaction of the network is active (i.e., has nonzero flux) in at least one feasible flux distribution <xref ref-type="bibr" rid="pcbi.1003424-Schuster1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Acua1">[27]</xref>. An attractive feature of <sc>fastcore</sc> is its generality: As it only relies on a preselected set of reactions and a simple mathematical objective (flux consistency), it can be applied in different contexts and it allows the integration of different pieces of evidence (‘multi-omics’) into a single model.</p>
<p>Computing a minimal consistent reconstruction from a subset of reactions of a global network is, however, an NP-hard problem <xref ref-type="bibr" rid="pcbi.1003424-Acua1">[27]</xref>, and hence some approximation is in order. Our key observation is that a minimal consistent reconstruction can be defined via a set of <italic>sparse</italic> modes of the global network, and <sc>fastcore</sc> is designed to compute a minimal such set. Every iteration of the algorithm computes a new sparse mode via two linear programs that aim at maximizing the support of the mode inside the core set while minimizing that quantity outside the core set. <sc>fastcore</sc>'s search strategy is in marked contrast to related approaches, in which the search for a minimal consistent reconstruction involves, for instance, incremental network pruning <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>. <sc>fastcore</sc> is simple, devoid of free parameters, and its performance is excellent in practice: As we demonstrate on experiments with liver data, <sc>fastcore</sc> is several orders of magnitude faster, and produces much more compact reconstructions, than the main competing algorithm MBA <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>.</p>
</sec><sec id="s3" sec-type="methods">
<title>Methods</title>
<sec id="s3a">
<title>Background</title>
<p>A metabolic network of <italic>m</italic> metabolites and <italic>n</italic> reactions is represented by an <italic>m</italic>×<italic>n stoichiometric</italic> matrix <italic>S</italic>, where each entry <italic>S<sub>ij</sub></italic> contains the stoichiometric coefficient of metabolite <italic>i</italic> in reaction <italic>j</italic>. A <italic>flux</italic> vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e001" xlink:type="simple"/></inline-formula> is a tuple of reaction rates, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e002" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e003" xlink:type="simple"/></inline-formula> is the rate of reaction <italic>i</italic> in the network. Reactions are grouped into <italic>reversible</italic> ones (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e004" xlink:type="simple"/></inline-formula>) and <italic>irreversible</italic> ones (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e005" xlink:type="simple"/></inline-formula>). For a reaction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e006" xlink:type="simple"/></inline-formula> it holds that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e007" xlink:type="simple"/></inline-formula> this and other imposed flux bounds, e.g., lower and upper bounds per reaction, are collectively denoted by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e008" xlink:type="simple"/></inline-formula> (which defines a convex set). A flux vector is called <italic>feasible</italic> or a <italic>mode</italic> if it satisfies a set of steady-state mass-balance constraints that can be compactly expressed as:<disp-formula id="pcbi.1003424.e009"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e009" xlink:type="simple"/><label>(1)</label></disp-formula>An <italic>elementary</italic> mode is a feasible flux vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e010" xlink:type="simple"/></inline-formula> with minimal support, that is, there is no other feasible flux vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e011" xlink:type="simple"/></inline-formula> with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e012" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e013" xlink:type="simple"/></inline-formula> is the support (i.e., the set of nonzero entries) of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e014" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003424-Schuster1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Gagneur1">[22]</xref>. A reaction <italic>i</italic> is called <italic>blocked</italic> if it cannot be active under any mode, that is, there exists no mode <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e015" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e016" xlink:type="simple"/></inline-formula> (in practice <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e017" xlink:type="simple"/></inline-formula>, for some small positive threshold <italic>ε</italic>). A metabolic network model that contains no blocked reactions is called <italic>(flux) consistent</italic> <xref ref-type="bibr" rid="pcbi.1003424-Schuster1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Acua1">[27]</xref>.</p>
</sec><sec id="s3b">
<title>Network consistency testing</title>
<p>Given a metabolic network model with stoichiometric matrix <italic>S</italic>, a problem of interest is to test whether the network is consistent or not. Additionally, if the network is inconsistent, it would be desirable to have a method that detects all blocked reactions.</p>
<p>It has been suggested that network consistency can be detected by a single linear program (LP) <xref ref-type="bibr" rid="pcbi.1003424-Acua1">[27]</xref>. The idea is to first convert each reversible reaction into two irreversible reactions (and define a reversible flux as the difference of two irreversible fluxes), and then test if the minimum feasible flux on the new set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e018" xlink:type="simple"/></inline-formula> of irreversible-only reactions is strictly positive (in practice, at least <italic>ε</italic>). This is equivalent to testing if the following LP is feasible:<disp-formula id="pcbi.1003424.e019"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e019" xlink:type="simple"/><label>(LP - 2)</label></disp-formula>This test of consistency, however, can produce spurious solutions. In <xref ref-type="fig" rid="pcbi-1003424-g001">Figure 1</xref> we show a toy metabolic network comprising four metabolites (A,B,C,D) and six reactions annotated with corresponding fluxes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e020" xlink:type="simple"/></inline-formula>. Fluxes are bounded as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e021" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e022" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e023" xlink:type="simple"/></inline-formula>. All stoichiometric coefficients are equal to one, except for the reaction →2A. The only reversible reaction is A↔B, which is a dead-end reaction and therefore blocked, whereas all other reactions are irreversible and unblocked. After converting A↔B to a pair of irreversible reactions, LP-2 achieves optimal value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e024" xlink:type="simple"/></inline-formula>, which implies (wrongly) that the network is consistent. The test here fails because the two irreversible copies of A↔B have equal flux at the solution, thereby nullifying the actual net flux of A↔B.</p>
<fig id="pcbi-1003424-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003424.g001</object-id><label>Figure 1</label><caption>
<title>A metabolic network with one blocked reaction (A↔B).</title>
<p>Note that A appears with stoichiometric coefficient 2 in the boundary reaction →2A.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003424.g001" position="float" xlink:type="simple"/></fig>
<p>A straightforward solution to the problem would involve iterating through all reactions, computing the maximum and minimum feasible flux of each reaction via an LP that satisfies the constraints in (1). Reactions with minimum and maximum flux zero would then be blocked. This is the idea behind the FVA (Flux Variability Analysis) algorithm and the <italic>reduceModel</italic> function of the COBRA toolbox <xref ref-type="bibr" rid="pcbi.1003424-Mahadevan1">[28]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Schellenberger1">[29]</xref>. However, iterating through all reactions can be inefficient. A faster variant is fastFVA <xref ref-type="bibr" rid="pcbi.1003424-Gudmundsson1">[30]</xref>, which achieves acceleration over FVA via LP warm-starts. Another fast algorithm is CMC (CheckModelConsistency) <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>, which involves a series of LPs, where each LP maximizes the sum of fluxes over a subset <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e025" xlink:type="simple"/></inline-formula> of reactions:<disp-formula id="pcbi.1003424.e026"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e026" xlink:type="simple"/><label>(LP - 3)</label></disp-formula>The set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e027" xlink:type="simple"/></inline-formula> is initialized by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e028" xlink:type="simple"/></inline-formula> (all reactions in the network), and it is updated after each run of LP-3 so that it contains the reactions whose consistency has not been established yet. When <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e029" xlink:type="simple"/></inline-formula> cannot be reduced any further, we can reverse the signs of the columns of <italic>S</italic> corresponding to the reversible reactions in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e030" xlink:type="simple"/></inline-formula> and resume the iterations. Eventually, all remaining reactions may have to be tested one by one for consistency, as in FVA. Such an iterative scheme is complete, in the sense that it will always report consistency if the network is consistent, and if not, it will reveal the set of blocked reactions. However, as we will clarify in the next section, LP-3 is not optimizing the ‘correct’ function, which may result in unnecessarily many iterations. For example, when applied to the network of <xref ref-type="fig" rid="pcbi-1003424-g001">Figure 1</xref>, LP-3 will pick up the elementary mode that corresponds to the pathway A→C→D (because this pathway achieves maximum sum of fluxes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e031" xlink:type="simple"/></inline-formula>), and it will set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e032" xlink:type="simple"/></inline-formula>. To establish the consistency of the reaction A→D, an additional run of LP-3 would be needed, where the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e033" xlink:type="simple"/></inline-formula> would only involve the reactions A↔B and A→D. Hence, an iterative algorithm like CMC that relies on LP-3 would need two iterations to detect the consistent part of this network. However, one LP suffices to detect the consistent subnetwork in this example, as we explain in the next section. In more general problems involving larger and more realistic networks, CMC may involve unnecessarily many iterations, as we demonstrate in the experiments.</p>
</sec><sec id="s3c">
<title>Fast consistency testing</title>
<p>In most problems of interest there will be no single mode that renders the whole network consistent, and an iterative algorithm like the one described in the previous section must be used. For performance reasons it would therefore be desirable to be able to establish the consistency of as many reactions as possible in each iteration of the algorithm.</p>
<p>Since consistency implies nonzero fluxes, it is sufficient to optimize a function that just ‘pushes’ all fluxes away from zero. Formally, this amounts to searching for modes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e034" xlink:type="simple"/></inline-formula> whose <italic>cardinality</italic>—denoted by <italic>card(v)</italic> and defined as <italic>card(v) = #supp(v)</italic>, i.e., the number of nonzero entries of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e035" xlink:type="simple"/></inline-formula>—is as large as possible. Directly maximizing <italic>card(v)</italic> is, however, not straightforward, for the following reasons: First, the <italic>card</italic> function is quasiconcave only for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e036" xlink:type="simple"/></inline-formula> (the nonnegative orthant), and it is nonconvex for general <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e037" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003424-Boyd1">[31]</xref>. Second, even if we restrict attention to nonnegative fluxes in each iteration (which we can do without loss of generality by flipping the signs of the corresponding columns of <italic>S</italic>), it is not obvious how to efficiently maximize the quasiconcave <italic>card(v)</italic>. Third, in practice consistency implies fluxes that are <italic>ε</italic>-distant from zero, in which case some adaptation of the <italic>card</italic> function is in order.</p>
<p>Here we propose an approach to approximately maximize <italic>card(v)</italic> over a nonnegative flux subspace indexed by a set of reactions <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e038" xlink:type="simple"/></inline-formula>. First note that the cardinality function can be expressed as<disp-formula id="pcbi.1003424.e039"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e039" xlink:type="simple"/><label>(4)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e040" xlink:type="simple"/></inline-formula> is a step function:<disp-formula id="pcbi.1003424.e041"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e041" xlink:type="simple"/><label>(5)</label></disp-formula>The key idea is to approximate the function <italic>θ</italic> by a concave function that is the minimum of a linear function and a constant function:<disp-formula id="pcbi.1003424.e042"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e042" xlink:type="simple"/><label>(6)</label></disp-formula>where <italic>ε</italic> is the flux threshold. The problem of approximately maximizing <italic>card(v)</italic> can then be cast as an LP: We introduce an auxiliary variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e043" xlink:type="simple"/></inline-formula> for each flux variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e044" xlink:type="simple"/></inline-formula>, for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e045" xlink:type="simple"/></inline-formula>, and take epigraphs <xref ref-type="bibr" rid="pcbi.1003424-Boyd1">[31]</xref>, in which case maximizing <italic>card(v)</italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e046" xlink:type="simple"/></inline-formula> can be expressed as<disp-formula id="pcbi.1003424.e047"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e047" xlink:type="simple"/></disp-formula>Using (6) and assuming constant <italic>ε</italic>, this simplifies to<disp-formula id="pcbi.1003424.e048"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e048" xlink:type="simple"/><label>(LP-7)</label></disp-formula>Note that LP-7 tries to maximize the number of feasible fluxes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e049" xlink:type="simple"/></inline-formula> whose value is at least <italic>ε</italic> (contrast this with LP-2).</p>
<p>Returning to the network of <xref ref-type="fig" rid="pcbi-1003424-g001">Figure 1</xref>, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e050" xlink:type="simple"/></inline-formula> comprises all network reactions, then note that the flux vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e051" xlink:type="simple"/></inline-formula> is an optimal solution of LP-7. Hence, a single run of the latter can detect all unblocked reactions of that network. More generally, a single run of LP-7 on an arbitrary subset <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e052" xlink:type="simple"/></inline-formula> of a given network will typically detect all unblocked <italic>irreversible</italic> reactions of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e053" xlink:type="simple"/></inline-formula>. The intuition is that LP-7 prefers flux ‘splitting’ over flux ‘concentrating’ in order to maximize the number of participating reactions in the solution, which, in the case of irreversible reactions, corresponds to flux cardinality maximization.</p>
<p>By construction, the above approximation of the cardinality function applies only to nonnegative fluxes. In order to deal with reversible reactions that can also take negative fluxes, we can embed LP-7 in an iterative algorithm (as in the previous section), in which reversible reactions are first considered for positive flux via LP-7, and then they are considered for negative flux. The latter is possible by flipping the signs of the columns of the stoichiometric matrix that correspond to the reversible reactions under testing, in which case the fluxes of the transformed model are again all nonnegative, and the above approximation of the cardinality function can be used. This gives rise to an algorithm for detecting the consistent part of a network that we call <sc>fastcc</sc> (for fast consistency check). Since <sc>fastcc</sc> is just a variant of <sc>fastcore</sc>, we defer its detailed description until the next section.</p>
<p>Independently to this work, a similar approach to network consistency testing was recently proposed, called OnePrune <xref ref-type="bibr" rid="pcbi.1003424-Dreyfuss1">[32]</xref>. OnePrune first converts each reversible reaction into two irreversible reactions, forming an augmented set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e054" xlink:type="simple"/></inline-formula> of irreversible-only reactions (as in LP-2 above), and then it employs an LP that coincides with LP-7 for the above choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e055" xlink:type="simple"/></inline-formula> and <italic>ε</italic> = 1. However, such an approach is prone to the same drawback as LP-2, namely, that the two irreversible copies of a blocked reaction can carry equal positive flux at the solution of LP-7 due to the presence of cycles introduced by the transformation. The authors acknowledge this problem but they do not fully resolve it. In our case, we avoid this problem by working with the original reactions and a series of LPs with appropriate sign flips of the stoichiometric matrix, thereby guaranteeing the completeness of the algorithm.</p>
</sec><sec id="s3d">
<title>Context-specific network reconstruction</title>
<p>The reconstruction problem involves computing a minimal consistent network from a global network and a ‘core’ set of reactions that are known to be active in a given context. Formally, given (i) a <italic>consistent</italic> global network <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e056" xlink:type="simple"/></inline-formula> with reaction set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e057" xlink:type="simple"/></inline-formula> and stoichiometric matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e058" xlink:type="simple"/></inline-formula>, and (ii) a set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e059" xlink:type="simple"/></inline-formula>, the problem is to find the smallest set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e060" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e061" xlink:type="simple"/></inline-formula> and the subnetwork <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e062" xlink:type="simple"/></inline-formula> induced by the reaction set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e063" xlink:type="simple"/></inline-formula> is consistent. (By <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e064" xlink:type="simple"/></inline-formula> we denote the submatrix of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e065" xlink:type="simple"/></inline-formula> that contains only the columns indexed by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e066" xlink:type="simple"/></inline-formula>.) This problem is known to be NP-complete <xref ref-type="bibr" rid="pcbi.1003424-Acua1">[27]</xref>, suggesting that a practical solution should entail some approximation. (We note that Acuña et al. <xref ref-type="bibr" rid="pcbi.1003424-Acua1">[27]</xref> prove NP-completeness of this problem by noting that a special case involves <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e067" xlink:type="simple"/></inline-formula> being the empty set, in which case the problem comes down to finding the smallest elementary mode of the global network, which, as the authors show, is NP-complete. However, this leaves open the case of a nonempty core set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e068" xlink:type="simple"/></inline-formula>, since a solution to the minimal reconstruction problem need not constitute an elementary mode. We conjecture that the problem remains NP-hard when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e069" xlink:type="simple"/></inline-formula> is nonempty, but we are not pursuing this question here.)</p>
<p>Our approach hinges on the observation that a consistent induced subnetwork of the global network can be defined via a set of modes of the latter:</p>
<p><bold>Theorem 1.</bold> <italic>Let </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e070" xlink:type="simple"/></inline-formula><italic> be a set of modes of the global network </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e071" xlink:type="simple"/></inline-formula><italic>, and let </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e072" xlink:type="simple"/></inline-formula><italic>supp(v)</italic><italic> be the union of the supports of these modes. The induced subnetwork </italic><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e073" xlink:type="simple"/></inline-formula><italic> is consistent.</italic></p>
<p><italic>Proof.</italic> For each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e074" xlink:type="simple"/></inline-formula>, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e075" xlink:type="simple"/></inline-formula> be the ‘truncated’ <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e076" xlink:type="simple"/></inline-formula> after dropping all dimensions not indexed by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e077" xlink:type="simple"/></inline-formula>. Clearly, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e078" xlink:type="simple"/></inline-formula>, therefore each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e079" xlink:type="simple"/></inline-formula> is a mode in the reduced model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e080" xlink:type="simple"/></inline-formula>. By construction of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e081" xlink:type="simple"/></inline-formula>, each reaction in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e082" xlink:type="simple"/></inline-formula> is in the support of some <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e083" xlink:type="simple"/></inline-formula>, and hence also in the support of some mode <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e084" xlink:type="simple"/></inline-formula> of the reduced model. </p>
<p>This simple result allows one to cast the reconstruction problem as a search problem over sets of modes of the global network:<disp-formula id="pcbi.1003424.e085"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e085" xlink:type="simple"/><label>(NLP-8)</label></disp-formula>Note that this optimization problem involves searching for a set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e086" xlink:type="simple"/></inline-formula> of modes of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e087" xlink:type="simple"/></inline-formula>, such that the union of the support of these modes (the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e088" xlink:type="simple"/></inline-formula>) is a minimal-cardinality set that contains the core set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e089" xlink:type="simple"/></inline-formula>. In order to practically make use of this theorem, one has to define a search strategy over modes. Next we discuss two possibilities. The first gives rise to an exact algorithm, but this algorithm does not scale to large networks. The second is a scalable greedy approach that gives rise to <sc>fastcore</sc>.</p>
<sec id="s3d1">
<title>Exact reconstruction via mixed integer linear programming</title>
<p>Note that, without loss of generality, in NLP-8 we can restrict the search for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e090" xlink:type="simple"/></inline-formula> over all <italic>elementary modes</italic> of the global network, since the union of their supports covers the whole set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e091" xlink:type="simple"/></inline-formula>. As we show next, if all elementary modes are available, NLP-8 can be cast as a mixed integer linear program (MILP) and solved exactly. This MILP is defined as follows. Let <italic>r</italic> be the number of elementary modes, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e092" xlink:type="simple"/></inline-formula> be a set of length-<italic>n</italic> binary vectors, where each vector <italic>m<sub>j</sub></italic> captures the support of elementary mode <italic>j</italic> (so, its <italic>i</italic>th entry is 1 if reaction <italic>i</italic> is included in elementary mode <italic>j</italic>, and 0 otherwise). Also, let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e093" xlink:type="simple"/></inline-formula> be a length-<italic>n</italic> binary vector with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e094" xlink:type="simple"/></inline-formula> if reaction <italic>i</italic> is included in the core set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e095" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e096" xlink:type="simple"/></inline-formula> otherwise. The decision variables of the MILP are a length-<italic>n</italic> binary vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e097" xlink:type="simple"/></inline-formula> and a length-<italic>r</italic> real vector <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e098" xlink:type="simple"/></inline-formula>. At an optimal solution of the MILP, the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e099" xlink:type="simple"/></inline-formula> is defined as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e100" xlink:type="simple"/></inline-formula>.</p>
<p><bold>Theorem 2.</bold> <italic>When all elementary modes are available, the following MILP-9 solves NLP-</italic>8 <italic>exactly.</italic><disp-formula id="pcbi.1003424.e101"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e101" xlink:type="simple"/><label>(MILP-9)</label></disp-formula></p>
<p><italic>Proof.</italic> By definition, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e102" xlink:type="simple"/></inline-formula> implies that reaction <italic>i</italic> will be included in the reconstruction <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e103" xlink:type="simple"/></inline-formula>, hence the objective minimizes the cardinality of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e104" xlink:type="simple"/></inline-formula>. The sum <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e105" xlink:type="simple"/></inline-formula> is a vector whose support is the union of the supports of all selected elementary modes at the solution, where an elementary mode <italic>j</italic> is selected when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e106" xlink:type="simple"/></inline-formula>. The first constraint <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e107" xlink:type="simple"/></inline-formula> therefore imposes that the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e108" xlink:type="simple"/></inline-formula> must contain the union of the supports of the selected elementary modes at the solution. (The factor <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e109" xlink:type="simple"/></inline-formula> ensures that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e110" xlink:type="simple"/></inline-formula>). Since superfluous reactions are removed by the minimization of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e111" xlink:type="simple"/></inline-formula> in the objective, the above implies that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e112" xlink:type="simple"/></inline-formula> is precisely the union of the supports of the selected elementary modes at the solution. The second constraint <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e113" xlink:type="simple"/></inline-formula> imposes that the core set must be included in the union of the supports of the selected elementary modes at the solution, and hence the core set must be included in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e114" xlink:type="simple"/></inline-formula>. Therefore, all constraints of NLP-8 are satisfied at the optimal solution of MILP-9, and since the two programs minimize the same objective, an optimal solution of MILP-9 must be an optimal solution of NLP-8.</p>
<p>Note, however, that MILP-9 does not scale to large networks, for the following reasons: First, it requires computing all elementary modes of the global network, which can be a very large number <xref ref-type="bibr" rid="pcbi.1003424-Gagneur1">[22]</xref>. Second, the binary decision variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e115" xlink:type="simple"/></inline-formula> index all reactions of the global network, and therefore MILP-9 needs to search over a binary hypercube of dimension <italic>n</italic>, which can be prohibitive for large <italic>n</italic>. Nonetheless, it is reassuring to know that an exact solution to the context-specific network reconstruction problem is possible, albeit with high complexity. Next we describe <sc>fastcore</sc>, an approximate greedy algorithm that scales much better to large networks, and we compare it to MILP-9 in the <xref ref-type="sec" rid="s4">Results</xref> section.</p>
</sec><sec id="s3d2">
<title>Greedy approximation and the fastcore algorithm</title>
<p>An alternative search strategy for computing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e116" xlink:type="simple"/></inline-formula> in NLP-8 is a greedy approach, reminiscent of greedy heuristics for the related <italic>set covering problem</italic> <xref ref-type="bibr" rid="pcbi.1003424-Chvtal1">[33]</xref>. This is the idea behind the proposed <sc>fastcore</sc> algorithm: We build up the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e117" xlink:type="simple"/></inline-formula> in a greedy fashion, by computing in each iteration a new mode of the global network. Further, as a means to approximately minimize <italic>card(A)</italic>, each added mode is constrained to have <italic>sparse</italic> support outside <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e118" xlink:type="simple"/></inline-formula>. This is implemented via <italic>L</italic><sub>1</sub>-norm minimization, which is a standard approach to computing sparse solutions to (convex) optimization problems <xref ref-type="bibr" rid="pcbi.1003424-Boyd1">[31]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Julius1">[34]</xref>.</p>
<p>The overall <sc>fastcore</sc> algorithm is shown in <xref ref-type="sec" rid="pcbi-1003424-box001">Box 1</xref>. The algorithm maintains a set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e119" xlink:type="simple"/></inline-formula> that is initialized with the irreversible reactions in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e120" xlink:type="simple"/></inline-formula>, and a ‘penalty’ set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e121" xlink:type="simple"/></inline-formula> that contains all reactions outside <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e122" xlink:type="simple"/></inline-formula> that have not been added yet to the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e123" xlink:type="simple"/></inline-formula>. Each iteration adds to the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e124" xlink:type="simple"/></inline-formula> the support of a mode that is dense in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e125" xlink:type="simple"/></inline-formula> (i.e., contains as many nonzero fluxes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e126" xlink:type="simple"/></inline-formula> as possible) and sparse in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e127" xlink:type="simple"/></inline-formula> (i.e., contains as many zero fluxes in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e128" xlink:type="simple"/></inline-formula> as possible), computed by the function F<sc>ind</sc>S<sc>parse</sc>M<sc>ode</sc> (<xref ref-type="sec" rid="pcbi-1003424-box002">Box 2</xref>). This function first applies an LP-7 to compute an active subset <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e129" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e130" xlink:type="simple"/></inline-formula>, and then it applies the following <italic>L</italic><sub>1</sub>-norm minimization LP constrained by the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e131" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003424.e132"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003424.e132" xlink:type="simple"/><label>(LP-10)</label></disp-formula>The LP-10 minimizes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e133" xlink:type="simple"/></inline-formula>, the <italic>L</italic><sub>1</sub> norm of fluxes in the penalty set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e134" xlink:type="simple"/></inline-formula> (expressed via epigraphs), subject to a minimum flux constraint on the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e135" xlink:type="simple"/></inline-formula>. However, some care is needed to preempt false negative solutions arising from the minimization of <italic>L</italic><sub>1</sub> norm in LP-10. For example, suppose in the network of <xref ref-type="fig" rid="pcbi-1003424-g001">Figure 1</xref> that the global network comprises all reactions except A↔B, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e136" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e137" xlink:type="simple"/></inline-formula>. In this case, LP-3 could settle to a solution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e138" xlink:type="simple"/></inline-formula>. The flux <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e139" xlink:type="simple"/></inline-formula>, being below <italic>ε</italic>, would be treated as zero by F<sc>ind</sc>S<sc>parse</sc>M<sc>ode</sc>, in which case the reaction →2A would be erroneously excluded from the reconstruction. A simple way to avoid this is to use a scaled version of <italic>ε</italic> (we used 10<sup>5</sup><italic>ε</italic>) in the second constraint of LP-10, with an equal scaling of all flux bounds in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e140" xlink:type="simple"/></inline-formula>.</p>
<boxed-text id="pcbi-1003424-box001" position="float"><sec id="s3d2a1">
<title>Box 1. The fastcore Algorithm for Context-Specific Metabolic Network Reconstruction</title>
<p>Input: A consistent metabolic network model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e141" xlink:type="simple"/></inline-formula> and a reaction set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e142" xlink:type="simple"/></inline-formula>.</p>
<p>Output: A consistent induced subnetwork <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e143" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e144" xlink:type="simple"/></inline-formula> such that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e145" xlink:type="simple"/></inline-formula>.</p>
<list list-type="order"><list-item>
<p> <bold>function</bold> <sc>fastcore</sc>(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e146" xlink:type="simple"/></inline-formula>)</p>
</list-item><list-item>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e147" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e148" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e149" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e150" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e151" xlink:type="simple"/></inline-formula>F<sc>IND</sc>S<sc>PARSE</sc>M<sc>ODE</sc><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e152" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e153" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>  <bold>while</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e154" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e155" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e156" xlink:type="simple"/></inline-formula>F<sc>IND</sc>S<sc>PARSE</sc>M<sc>ODE</sc><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e157" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>   <bold>if</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e158" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>    <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e159" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e160" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>  <bold>else</bold></p>
</list-item><list-item>
<p>    <bold>if</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e161" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>     <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e162" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e163" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>    <bold>else</bold></p>
</list-item><list-item>
<p>     <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e164" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>     <bold>if</bold> <italic>singleton</italic></p>
</list-item><list-item>
<p>      <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e165" xlink:type="simple"/></inline-formula> (the first element of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e166" xlink:type="simple"/></inline-formula>)</p>
</list-item><list-item>
<p>     <bold>else</bold></p>
</list-item><list-item>
<p>      <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e167" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>    <bold>end if</bold></p>
</list-item><list-item>
<p>    <bold>for each</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e168" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>     flip the sign of the <italic>i</italic>'th column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e169" xlink:type="simple"/></inline-formula> and</p>
</list-item><list-item>
<p>     swap the upper and lower bounds of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e170" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>    <bold>end for</bold></p>
</list-item><list-item>
<p>    <bold>end if</bold></p>
</list-item><list-item>
<p>   <bold>end if</bold></p>
</list-item><list-item>
<p>  <bold>end while</bold></p>
</list-item><list-item>
<p>  <bold>return</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e171" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p> <bold>end function</bold></p>
</list-item></list>
</sec></boxed-text><boxed-text id="pcbi-1003424-box002" position="float"><sec id="s3d2b1">
<title>Box 2. The FindSparseMode Function</title>
<p>Input: A set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e172" xlink:type="simple"/></inline-formula>, a penalty set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e173" xlink:type="simple"/></inline-formula>, and the <italic>singleton</italic> flag.</p>
<p>Output: The support of a mode that is dense in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e174" xlink:type="simple"/></inline-formula> and sparse in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e175" xlink:type="simple"/></inline-formula>.</p>
<list list-type="order"><list-item>
<p> <bold>function</bold> F<sc>ind</sc>S<sc>parse</sc>M<sc>ode</sc>(<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e176" xlink:type="simple"/></inline-formula>)</p>
</list-item><list-item>
<p>  <bold>if</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e177" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>   <bold>return</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e178" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>  <bold>end if</bold></p>
</list-item><list-item>
<p>  <bold>if</bold> <italic>singleton</italic></p>
</list-item><list-item>
<p>   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e179" xlink:type="simple"/></inline-formula> LP-7 on set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e180" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>  <bold>else</bold></p>
</list-item><list-item>
<p>   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e181" xlink:type="simple"/></inline-formula> LP-7 on set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e182" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>  <bold>end if</bold></p>
</list-item><list-item>
<p>  <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e183" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>  <bold>if</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e184" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>   <bold>return</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e185" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>   <bold>end if</bold></p>
</list-item><list-item>
<p>   <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e186" xlink:type="simple"/></inline-formula> LP-10on sets <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e187" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p>   <bold>return</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e188" xlink:type="simple"/></inline-formula></p>
</list-item><list-item>
<p> <bold>end function</bold></p>
</list-item></list>
</sec></boxed-text>
<p>The <sc>fastcore</sc> algorithm first goes through the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e189" xlink:type="simple"/></inline-formula> reactions (step 2), and then through the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e190" xlink:type="simple"/></inline-formula> ones (and eventually through each individual reversible reaction in the core set; when <italic>singleton</italic> = <italic>True</italic>). The <italic>flipped</italic> variable ensures that a reversible reaction is tested in both the forward and negative direction. The algorithm terminates when all reactions in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e191" xlink:type="simple"/></inline-formula> have been added to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e192" xlink:type="simple"/></inline-formula>, which is guaranteed since in the main loop the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e193" xlink:type="simple"/></inline-formula> never expands (step 10) and the global network is consistent. Note that <sc>fastcore</sc> has no free parameters besides the flux threshold <italic>ε</italic>.</p>
<p>The <sc>fastcc</sc> algorithm for detecting the consistent part of an input network (see previous section) can be viewed as a variant of <sc>fastcore</sc> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e194" xlink:type="simple"/></inline-formula> in which the steps 10–14 of F<sc>ind</sc>S<sc>parse</sc>M<sc>ode</sc> are omitted (and there is no <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e195" xlink:type="simple"/></inline-formula> set). It is easy to verify that <sc>fastcc</sc> is complete, in the sense that it will always report consistency if the network is consistent, and if not, it will reveal the set of blocked reactions.</p>
</sec></sec><sec id="s3e">
<title>Related work</title>
<p>Several algorithms have been published in the last years for extracting condition-specific models from generic genome-wide models like Recon 1. Among them, mCADRE <xref ref-type="bibr" rid="pcbi.1003424-Wang1">[26]</xref>, INIT <xref ref-type="bibr" rid="pcbi.1003424-Agren1">[13]</xref>, iMAT <xref ref-type="bibr" rid="pcbi.1003424-Zur1">[35]</xref>, MBA <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref> and GIMME <xref ref-type="bibr" rid="pcbi.1003424-Becker1">[8]</xref> are the most commonly used (see <xref ref-type="table" rid="pcbi-1003424-t001">Table 1</xref> for an overview). Here we provide a short outline of the different algorithms, and refer to <xref ref-type="bibr" rid="pcbi.1003424-Blazier1">[24]</xref> for a more extensive overview. For GIMME, iMAT, and MBA, we briefly discuss some notable differences to <sc>fastcore</sc>.</p>
<table-wrap id="pcbi-1003424-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003424.t001</object-id><label>Table 1</label><caption>
<title>Summary of the main characteristics of GIMME <xref ref-type="bibr" rid="pcbi.1003424-Becker1">[8]</xref>, MBA <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>, iMAT <xref ref-type="bibr" rid="pcbi.1003424-Zur1">[35]</xref>, mCADRE <xref ref-type="bibr" rid="pcbi.1003424-Wang1">[26]</xref>, INIT <xref ref-type="bibr" rid="pcbi.1003424-Agren1">[13]</xref>, and <sc>fastcore</sc> (this paper) reconstruction algorithms.</title>
</caption><alternatives><graphic id="pcbi-1003424-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003424.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">GIMME</td>
<td align="left" rowspan="1" colspan="1">MBA</td>
<td align="left" rowspan="1" colspan="1">iMAT</td>
<td align="left" rowspan="1" colspan="1">mCADRE</td>
<td align="left" rowspan="1" colspan="1">INIT</td>
<td align="left" rowspan="1" colspan="1">FASTCORE</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Optimization</td>
<td align="left" rowspan="1" colspan="1">LP</td>
<td align="left" rowspan="1" colspan="1">MILP</td>
<td align="left" rowspan="1" colspan="1">MILP</td>
<td align="left" rowspan="1" colspan="1">MILP</td>
<td align="left" rowspan="1" colspan="1">MILP</td>
<td align="left" rowspan="1" colspan="1">LP</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Computational cost</td>
<td align="left" rowspan="1" colspan="1">low</td>
<td align="left" rowspan="1" colspan="1">high</td>
<td align="left" rowspan="1" colspan="1">high</td>
<td align="left" rowspan="1" colspan="1">high</td>
<td align="left" rowspan="1" colspan="1">high</td>
<td align="left" rowspan="1" colspan="1">low</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Function required</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">no</td>
<td align="left" rowspan="1" colspan="1">no</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">no</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Omics required</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">optional</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">no</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Code available</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">yes</td>
<td align="left" rowspan="1" colspan="1">no</td>
<td align="left" rowspan="1" colspan="1">yes</td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>GIMME <xref ref-type="bibr" rid="pcbi.1003424-Becker1">[8]</xref> takes as input microarray data and a biological function to optimize for, such as biomass production. GIMME starts by removing reactions with associated expression levels below a user-defined threshold, and then it optimizes for the specified biological function using linear programming. In case the pruning steps compromise the input biological function, GIMME reintroduces some previously removed reactions that are in minimal disagreement with the expression data. Since GIMME has not been designed to include all core reactions in the solution (as <sc>fastcore</sc> does), the reconstructions obtained by GIMME and <sc>fastcore</sc> can differ significantly: Running the <italic>createTissueSpecific</italic> function of the COBRA toolbox on a set of liver core reactions (see ‘<xref ref-type="sec" rid="s4">Results</xref>’ section) treating them as expressed reactions (and adding a biomass reaction <xref ref-type="bibr" rid="pcbi.1003424-Wang1">[26]</xref> and a sink reaction for glycogen to be used as optimization function), only about 50% of the core reactions of the GIMME model were consistent at the solution. A fairer comparison would require adapting <sc>fastcore</sc> to explicitly deal with omics data, which is outside the scope of the current work.</p>
<p>iMAT <xref ref-type="bibr" rid="pcbi.1003424-Zur1">[35]</xref> was originally designed for the integration of transcriptomic data. iMAT optimizes for the consistency between the experimental data and the activity state of the model reactions. iMAT tries to include modes composed of reactions associated to genes with high expression value, and therefore a threshold needs to be chosen to segregate between low, medium, and highly expressed genes. The computational demands of iMAT are high due to the repeated use of mixed integer linear programming. As with GIMME, direct comparison of iMAT to <sc>fastcore</sc> is problematic. Nevertheless, we applied iMAT (own implementation) on the liver problem (see ‘<xref ref-type="sec" rid="s4">Results</xref>’ section), by setting the liver core reactions to RH (reaction high) and all non-core reactions to RL (reaction low). iMAT determined 549 core reactions as active, while 182 and 338 reactions were classified as undetermined and inactive, respectively. This means that about 50% of the core reactions were lost during iMAT model building. As with GIMME, this demonstrates the difficulty of directly comparing <sc>fastcore</sc> to algorithms that optimize different objectives.</p>
<p>mCADRE <xref ref-type="bibr" rid="pcbi.1003424-Wang1">[26]</xref> is similar to MBA, except that the pruning order is not random, but it depends on the tissue-specific expression evidence and weighted connectivity to other reactions of the network. Reactions that are associated to genes that are never tagged as expressed and which are not connected to reactions associated to highly expressed genes are first evaluated in the pruning step. Reactions are effectively removed if the removal does not impair core reactions and metabolic functions to carry a flux (mCADRE removes core reactions if the core/non-core reaction ratio is below a user-given threshold). mCADRE uses mixed integer linear programming and therefore it does not scale up to large networks (but it is in general faster than MBA).</p>
<p>INIT <xref ref-type="bibr" rid="pcbi.1003424-Agren1">[13]</xref> uses data retrieved from public databases in order to assess the presence of a certain reaction-respective metabolites in the cell type of interest. INIT uses mixed integer linear programming to build a model in which all reactions can carry a flux. Contrary to other algorithms, INIT does not rely on the assumption of a steady state, but it allows small net accumulation of all metabolites of the model.</p>
<p>The closest algorithm to <sc>fastcore</sc> is the MBA algorithm of Jerby et al. <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>. MBA takes as input two core sets of reactions, and it searches for a consistent network that contains all reactions from the first set, a maximum number of reactions from the second set (for a given tradeoff), and a minimal number of reactions from the global network. (<sc>fastcore</sc> can be easily adapted to work with multiple core sets, by introducing a set of weights that reflect the confidence of each reaction to be active in the given context, and adding appropriate regularization terms in the objective functions of LP-7 and LP-10 that capture the given tradeoff. We will address this variant in future work.) Both <sc>fastcore</sc> and MBA involve a search for a minimal consistent subnetwork, however the search strategy of <sc>fastcore</sc> is very different to MBA: Whereas <sc>fastcore</sc> iteratively expands the active set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e196" xlink:type="simple"/></inline-formula> starting with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e197" xlink:type="simple"/></inline-formula>, MBA starts with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e198" xlink:type="simple"/></inline-formula> and iteratively prunes the set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e199" xlink:type="simple"/></inline-formula> by checking whether the removal of each individual reaction (selected in random order) compromises network consistency. As the pruning order affects the output model, this step of MBA is repeated multiple times. MBA builds a final model by adding one by one non-core reactions with the highest presence rate over all pruning runs, and it stops when a consistent final model is obtained. Due to the multiple pruning runs, MBA has very high computational demands. Consistency testing in MBA is carried out with the CMC algorithm that is based on LP-3, as explained earlier. Hence, <sc>fastcore</sc>'s search strategy differs to MBA in two key aspects: First, consistency testing in fastcore involves the maximization of flux cardinality (LP-7) instead of sum of fluxes (LP-3), which results in fewer LP iterations. Second, the search for compact solutions in <sc>fastcore</sc> involves <italic>L</italic><sub>1</sub>-norm minimization instead of pruning. The advantage of the former is that it can be encoded by a single LP, resulting in significant overall speedups (see ‘<xref ref-type="sec" rid="s4">Results</xref>’ section).</p>
</sec></sec><sec id="s4">
<title>Results</title>
<p>Generic metabolic reconstructions like Recon 2 are inconsistent models as they contain reactions that are not able to carry nonzero flux due to gaps in the network (see next section). The first step towards obtaining a consistent context-specific reconstruction is therefore to extract the consistent part of a global generic model. This can be achieved by <sc>fastcc</sc> or other similar methods (see ‘Network consistency testing’ section). The consistent global model serves then as input for the context-specific reconstruction with <sc>fastcore</sc>. In <xref ref-type="fig" rid="pcbi-1003424-g002">Figure 2</xref> we show a flowchart of the overall pipeline.</p>
<fig id="pcbi-1003424-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003424.g002</object-id><label>Figure 2</label><caption>
<title>Flowchart of the overall pipeline for generating consistent context-specific models.</title>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003424.g002" position="float" xlink:type="simple"/></fig>
<p>We report results on two sets of problems, the first involving consistency verification of an input model, and the second involving the reconstruction of a context-specific model from an input model and a core set of reactions. The <sc>fastcore</sc> algorithm was implemented in the COBRA toolbox <xref ref-type="bibr" rid="pcbi.1003424-Schellenberger1">[29]</xref>, using Matlab 2013a and the IBM CPLEX solver (version 12.5.0.0). Test runs were performed on a standard 1.8 GHz Intel Core i7 laptop with 4 GB RAM running Mac OS X 10.7.5. In all experiments we used flux threshold <italic>ε</italic> = 1e-4. The software is available from bio.uni.lu/systems_biology/software</p>
<sec id="s4a">
<title>Consistency testing</title>
<p>In the first set of experiments we applied <sc>fastcc</sc>, the consistency testing variant of <sc>fastcore</sc>, for consistency verification of four input models, and compared it against the FastFVA algorithm of Gudmundsson and Thiele <xref ref-type="bibr" rid="pcbi.1003424-Gudmundsson1">[30]</xref>, and an own implementation (based on <sc>fastcc</sc> but with LP-3 replacing LP-7) of the CMC algorithm of Jerby et al. <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>. We also tested the FVA algorithm of the <italic>reduceModel</italic> function of the COBRA toolbox <xref ref-type="bibr" rid="pcbi.1003424-Schellenberger1">[29]</xref>, and the MIRAGE algorithm of Vitkin and Shlomi <xref ref-type="bibr" rid="pcbi.1003424-Vitkin1">[36]</xref>, but we do not include them in the results as they performed worse than the reported ones. The input models were the following:</p>
<list list-type="bullet"><list-item>
<p>c-Yeast (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e200" xlink:type="simple"/></inline-formula>), the consistent part of a yeast model <xref ref-type="bibr" rid="pcbi.1003424-Zomorrodi1">[37]</xref>.</p>
</list-item><list-item>
<p>c-Ecoli (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e201" xlink:type="simple"/></inline-formula>), the consistent part of an <italic>E. coli</italic> model <xref ref-type="bibr" rid="pcbi.1003424-Orth1">[25]</xref>. (Here we set to 1000 the upper bounds of all fluxes that were fixed to zero, and we multiplied all bounds by 1000 to avoid numerical issues.)</p>
</list-item><list-item>
<p>c-Recon1 (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e202" xlink:type="simple"/></inline-formula>), the consistent part of Recon 1 <xref ref-type="bibr" rid="pcbi.1003424-Duarte1">[4]</xref>. (Recon 1 was found to contain 1273 blocked reactions.)</p>
</list-item><list-item>
<p>c-Recon2 (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e203" xlink:type="simple"/></inline-formula>), the consistent part of Recon 2 <xref ref-type="bibr" rid="pcbi.1003424-Thiele1">[6]</xref>. (Recon 2 was found to contain 1606 blocked reactions.)</p>
</list-item></list>
<p>The results are shown in <xref ref-type="table" rid="pcbi-1003424-t002">Table 2</xref>. <sc>fastcc</sc> is faster and it uses much fewer LPs than the other two algorithms. We note that fastFVA is based on an optimized Matlab/C++ implementation with LP warm-starts, while <sc>fastcc</sc> is based on standard Matlab. These results confirm the appropriateness of flux cardinality (LP-7) as a metric for network consistency testing, in agreement with the theoretical analysis and the discussions above.</p>
<table-wrap id="pcbi-1003424-t002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003424.t002</object-id><label>Table 2</label><caption>
<title>Comparing <sc>fastcc</sc> to fastFVA <xref ref-type="bibr" rid="pcbi.1003424-Gudmundsson1">[30]</xref> and CMC <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref> on four input models.</title>
</caption><alternatives><graphic id="pcbi-1003424-t002-2" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003424.t002" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="2" align="left" rowspan="1">c-Yeast</td>
<td colspan="2" align="left" rowspan="1">c-Ecoli</td>
<td colspan="2" align="left" rowspan="1">c-Recon1</td>
<td colspan="2" align="left" rowspan="1">c-Recon2</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1">#LPs</td>
<td align="left" rowspan="1" colspan="1">time<xref ref-type="table-fn" rid="nt101">*</xref></td>
<td align="left" rowspan="1" colspan="1">#LPs</td>
<td align="left" rowspan="1" colspan="1">time</td>
<td align="left" rowspan="1" colspan="1">#LPs</td>
<td align="left" rowspan="1" colspan="1">time</td>
<td align="left" rowspan="1" colspan="1">#LPs</td>
<td align="left" rowspan="1" colspan="1">time</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">fastFVA</td>
<td align="left" rowspan="1" colspan="1">2408</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">3436</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">4938</td>
<td align="left" rowspan="1" colspan="1">9</td>
<td align="left" rowspan="1" colspan="1">11668</td>
<td align="left" rowspan="1" colspan="1">207</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">CMC</td>
<td align="left" rowspan="1" colspan="1">18</td>
<td align="left" rowspan="1" colspan="1">0.5</td>
<td align="left" rowspan="1" colspan="1">25</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">49</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">42</td>
<td align="left" rowspan="1" colspan="1">11</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><sc>fastcc</sc></td>
<td align="left" rowspan="1" colspan="1">7</td>
<td align="left" rowspan="1" colspan="1">0.1</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">0.2</td>
<td align="left" rowspan="1" colspan="1">9</td>
<td align="left" rowspan="1" colspan="1">0.4</td>
<td align="left" rowspan="1" colspan="1">19</td>
<td align="left" rowspan="1" colspan="1">5</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt101"><label/><p>in seconds.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s4b">
<title>Reconstruction of a liver model</title>
<p>In the second set of experiments, we used the <sc>fastcore</sc> algorithm to reconstruct a liver specific metabolic network model from the consistent part of Recon 1 (c-Recon1, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e204" xlink:type="simple"/></inline-formula>), and we compared against an own implementation of the MBA algorithm of Jerby et al. <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>. We applied the two algorithms in two settings. The first setting involves the liver specific input reaction set of Jerby et al. <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>, which is based on 779 ‘high’ core and 290 ‘medium’ core reactions (the latter set is supported by weaker biological evidence than the former). To allow a comparison with <sc>fastcore</sc>, we defined a single core set as the union of the high and medium core reaction sets, and we applied the two algorithms on this core set. The second setting uses the ‘strict’ liver model of Jerby et al. <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>, which contains 1083 high core reactions and no medium core reactions, and therefore allows a direct comparison with <sc>fastcore</sc>.</p>
<p>The results for the two settings are shown in <xref ref-type="table" rid="pcbi-1003424-t003">Table 3</xref>. We note that for MBA, the reported number of LPs and the runtime refer to a single pruning iteration of the algorithm, whereas the size of each reconstruction refers to the final model after 1000 pruning iterations. In both settings, <sc>fastcore</sc> is several orders of magnitude faster than MBA, achieving a full reconstruction of a liver specific model in about one second, using a much smaller number of LPs. As MBA employs a greedy pruning strategy for optimization, the number of LPs that it uses and its total runtime can be very high, as also indicated by Wang et al. <xref ref-type="bibr" rid="pcbi.1003424-Wang1">[26]</xref> who reported runtime of a single pruning pass of MBA in the order of 10 hours on a 2.34 GHz CPU computer.</p>
<table-wrap id="pcbi-1003424-t003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003424.t003</object-id><label>Table 3</label><caption>
<title>Comparing <sc>fastcore</sc> to MBA <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref> on liver model reconstruction from c-Recon1.</title>
</caption><alternatives><graphic id="pcbi-1003424-t003-3" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003424.t003" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td colspan="4" align="left" rowspan="1">liver core set (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e205" xlink:type="simple"/></inline-formula>)</td>
<td colspan="4" align="left" rowspan="1">strict liver core set (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e206" xlink:type="simple"/></inline-formula>)</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e207" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">IR<xref ref-type="table-fn" rid="nt102">*</xref></td>
<td align="left" rowspan="1" colspan="1">#LPs</td>
<td align="left" rowspan="1" colspan="1">time<xref ref-type="table-fn" rid="nt103">†</xref></td>
<td align="left" rowspan="1" colspan="1"><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e208" xlink:type="simple"/></inline-formula></td>
<td align="left" rowspan="1" colspan="1">IR</td>
<td align="left" rowspan="1" colspan="1">#LPs</td>
<td align="left" rowspan="1" colspan="1">time</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">MBA</td>
<td align="left" rowspan="1" colspan="1">1826</td>
<td align="left" rowspan="1" colspan="1">1573</td>
<td align="left" rowspan="1" colspan="1">72279</td>
<td align="left" rowspan="1" colspan="1">7383</td>
<td align="left" rowspan="1" colspan="1">1887</td>
<td align="left" rowspan="1" colspan="1">1630</td>
<td align="left" rowspan="1" colspan="1">71546</td>
<td align="left" rowspan="1" colspan="1">6730</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><sc>fastcore</sc></td>
<td align="left" rowspan="1" colspan="1">1746</td>
<td align="left" rowspan="1" colspan="1">1546</td>
<td align="left" rowspan="1" colspan="1">20</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">1818</td>
<td align="left" rowspan="1" colspan="1">1627</td>
<td align="left" rowspan="1" colspan="1">20</td>
<td align="left" rowspan="1" colspan="1">1</td>
</tr>
</tbody>
</table>
</alternatives><table-wrap-foot><fn id="nt102"><label/><p>number of intracellular reactions.</p></fn><fn id="nt103"><label/><p>the reported time (in seconds), as well as the number of LPs, refer to a single pruning step of MBA, whereas <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e209" xlink:type="simple"/></inline-formula> and IR refer to the full MBA.</p></fn></table-wrap-foot></table-wrap>
<p>The reconstructed models by <sc>fastcore</sc> are also more compact than those obtained by MBA, with a difference of 70–80 non-core reactions. For the standard liver model, 1687 out of the 1746 reactions (96%) of the <sc>fastcore</sc> reconstruction appear also in the MBA reconstruction, whereas for the strict liver model the common reactions are 1739 out of 1818 (95%). The two algorithms turned out to use alternative transporters to connect the core reactions: In the standard liver model, 46 out of 59 reactions that are present exclusively in the <sc>fastcore</sc> reconstruction are transporter reactions or other reactions which are not associated to a specific gene and thus are not sufficiently supported in the core set, whereas in MBA the corresponding numbers are 116 out of 139 reactions. (In <xref ref-type="supplementary-material" rid="pcbi.1003424.s001">Text S1</xref> we provide more details on the reconstructions obtained by the two methods.) Note that both MBA and <sc>fastcore</sc> try to minimize the number of added non-core reactions in order to obtain a compact consistent model. The above difference in the number of added non-core reactions between MBA and <sc>fastcore</sc> is the result of the different optimization approaches taken by the two algorithms, and no biological relevance should be attributed to each reconstruction other than the one implied by the makeup of the core set. From this point of view, <sc>fastcore</sc> performs in general better than MBA, as it tends to add fewer unnecessary reactions.</p>
<p>We also compared <sc>fastcore</sc>'s reconstructions to the exact solutions obtained from MILP-9, using core sets that are randomly generated from a consistent subset of <italic>E. coli core</italic> <xref ref-type="bibr" rid="pcbi.1003424-Orth2">[38]</xref>. This is a small model with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e210" xlink:type="simple"/></inline-formula> and 414 elementary modes (unfortunately, the dependence of the MILP-9 model on the number of elementary modes did not allow testing larger models). In <xref ref-type="fig" rid="pcbi-1003424-g003">Figure 3</xref> we show the size of the reconstructed models (mean values) obtained with the MILP formulation vs. <sc>fastcore</sc>, as a function of the size of the core set. <sc>fastcore</sc> is capable of obtaining very good approximations to the optimal solutions, which improve with the size of the core set.</p>
<fig id="pcbi-1003424-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003424.g003</object-id><label>Figure 3</label><caption>
<title>Comparing <sc>fastcore</sc> to an exact MILP solver on a small <italic>E. coli</italic> model <xref ref-type="bibr" rid="pcbi.1003424-Orth2">[38]</xref>.</title>
<p>Shown are mean values of sizes of reconstructed models (over 50 repetitions for each core set; standard deviations were small and are omitted to avoid clutter) as a function of the size of the core set. <sc>fastcore</sc> computes near-optimal reconstructions, which improve with the size of the core set.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003424.g003" position="float" xlink:type="simple"/></fig>
<p>To evaluate <sc>fastcore</sc>'s performance in correctly identifying liver reactions, we performed repeated random sub-sampling validation in which <sc>fastcore</sc> was used to reconstruct the liver metabolism based on a reduced, randomly selected ‘subcore’ set of 80% of the original core reactions. As in <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>, we wanted to test whether <sc>fastcore</sc> is able to recover a significant number of the 20% left-out core reactions. To test for the enrichment of the left-out core reactions in the reconstructed model, we used a hypergeometric test, in which the total population is defined by all non-subcore reactions in the global network, the number of draws is defined as the number of non-subcore reactions included in the reconstruction, and the left-out core reactions are the ‘successes’. Under the null-hypothesis that there is no enrichment for the left-out core reactions when reconstructing the liver model based on the subcore set, we can compute a p-value for including at least the number of observed left-out core reactions in the reconstruction. We repeated this random sub-sampling procedure 500 times and computed the corresponding p-values. The median of these p-values was 0.0025, indicating the ability of <sc>fastcore</sc> to capture liver-specific reactions that were included in the original core set.</p>
<p>As argued above, the reconstructions obtained by <sc>fastcore</sc> need not optimize for cellular functions other than the ones implied by the composition of the input core set, and it is an interesting research question how to modify <sc>fastcore</sc> so that it can explicitly capture functional requirements in its reconstructions. Nevertheless, it is of interest to test whether the current version of <sc>fastcore</sc> can produce reconstructions that <italic>are</italic> functionally relevant, perhaps for slight variations of the core set. To this end, as in <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>, we checked whether the (standard) liver model reconstructed by <sc>fastcore</sc> can perform gluconeogenesis from glucogenic amino acids, glycerol, and lactate (altogether 21 metabolites). If not yet included, transporters from the extracellular medium to the cytosol were added to the model (glycerol, glutamate, glycine, glutamine, and serine). This was necessary as the transport reactions were not sufficiently supported in the core set. This ‘extended’ liver model was able to convert 17/21 metabolites (vs 12/21 metabolites of the non-extended model). The extended liver model was then used to simulate the liver disorders hyperammonemia and hyperglutamenia, which affect the capacity to metabolize dietary amino acids into urea <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref>. Loss of function mutations of three enzyme-coding genes, argininosuccinate synthetase (ASS), argininosuccinate lyase (ASL), and ornithine transcarbamylase (OTC) were identified in patients suffering from these disorders. The rates of the reactions controlled by the three genes were fixed to 500, 250, or zero, to mimic the healthy homozygote (no mutation), heterozygote (loss of one allele), and the complete loss of function, respectively. To allow for a comparison with the experimental study of Lee et al. <xref ref-type="bibr" rid="pcbi.1003424-Lee1">[39]</xref> where labeled 15N-glutamine was administrated to patients suffering from inborn errors affecting the three genes, we explicitly shut down the influx of other potential nitrogen sources in the liver model, thereby simulating only the uptake and metabolism of glutamine. By allowing the influx of only one nitrogen source, the fate of the latter could be determined exactly in the model. The ratio of urea secretion level over glutamine absorption was computed by sampling over the feasible space <xref ref-type="bibr" rid="pcbi.1003424-Price1">[21]</xref>. In accordance with the wet lab observations <xref ref-type="bibr" rid="pcbi.1003424-Lee1">[39]</xref>, the severity of the disorders, characterized by the mean urea over glutamine ratio, increased with the level of loss of function of the three genes ASS, ASL, and OTC (see <xref ref-type="fig" rid="pcbi-1003424-g004">Figure 4</xref>). Null patients showed no native production of urea. Overall, the ratios predicted by the <sc>fastcore</sc> model faithfully match the experimentally observed ones <xref ref-type="bibr" rid="pcbi.1003424-Lee1">[39]</xref>. (The corresponding ratios reported by Jerby et al. when using the MBA algorithm <xref ref-type="bibr" rid="pcbi.1003424-Jerby1">[10]</xref> matched less well the experimental observations, probably because of the cross-feeding of nitrogen to urea from multiple nitrogen sources. By running the above procedure on the MBA model, we noticed that both models attained comparable urea/glutamine flux ratios.) To summarize, the above experiments demonstrate that, by an informed choice of the core set and influx bounds, <sc>fastcore</sc> can indeed give rise to functionally relevant models.</p>
<fig id="pcbi-1003424-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003424.g004</object-id><label>Figure 4</label><caption>
<title>Mean urea/glutamine ratio in the extended liver model obtained by <sc>fastcore</sc>.</title>
<p>Healthy (normal homozygote), partial (heterozygote) and full knock-out cases. See text for details.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003424.g004" position="float" xlink:type="simple"/></fig></sec><sec id="s4c">
<title>Reconstruction of a murine macrophage model</title>
<p>We also used the <sc>fastcore</sc> algorithm to build a cell-type specific murine macrophage model from the consistent part of Recon1bio (comprising <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e211" xlink:type="simple"/></inline-formula> reactions). Recon1bio (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003424.e212" xlink:type="simple"/></inline-formula>) is a modified Recon 1 model that contains three extra reactions (biomass, NADPOX, and a sink reaction to balance the glycogenin self-glucosylation reaction) <xref ref-type="bibr" rid="pcbi.1003424-Bordbar1">[15]</xref>. We used a core set comprising 300 (out of 382) proteomics derived Raw264.7 macrophage reactions, as described by Bordbar et al. <xref ref-type="bibr" rid="pcbi.1003424-Bordbar1">[15]</xref>. (The remaining 82 reactions could not be added to the core set as they are situated in an inconsistent region of Recon 1 and therefore carry a permanent zero net flux.) For their macrophage reconstruction, Bordbar et al. used, among other methods, GIMMEp—a variant of the GIMME algorithm <xref ref-type="bibr" rid="pcbi.1003424-Becker1">[8]</xref> that is similar to the MBA algorithm—and they obtained a network model containing 1026 intracellular reactions. Our main interest was to investigate whether <sc>fastcore</sc> can obtain a functional network that is at least as compact as the one obtained with GIMMEp. <sc>fastcore</sc> generated (in about one second and using 11 LPs) a consistent network model of 953 reactions, 831 of which are intracellular reactions. This is a much more compact model than the one obtained with GIMMEp.</p>
</sec></sec><sec id="s5">
<title>Discussion</title>
<p><sc>fastcore</sc> is a generic algorithm for context-specific metabolic network reconstruction from genome-wide metabolic models, and it was motivated by requirements of fast computation and compactness of the output model.</p>
<p>The key advantage of having a fast reconstruction algorithm is that it permits the execution of multiple runs in order to optimize for extra parameters or test different core sets extracted from the input data <xref ref-type="bibr" rid="pcbi.1003424-Folger1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Wang1">[26]</xref>. For example, when working with gene expression data, the definition of the core set may depend on the threshold used to segregate between high expression genes (core reactions) and low expression genes (non-core reactions) <xref ref-type="bibr" rid="pcbi.1003424-Becker1">[8]</xref>. As the choice of threshold is rather arbitrary, a practical approach could involve evaluating the robustness of the output model as a function of the chosen threshold. <sc>fastcore</sc> can perform this analysis in a few minutes, whereas for the same problem other algorithms would need hours or days. (Algorithms like GIMME or GIMMEp that require manual curation and assembly of subnetworks, would also fail in this kind of task.) Another example where fast computation is imperative is cross-validation. In the current study (see ‘<xref ref-type="sec" rid="s4">Results</xref>’ section) we ran a random sub-sampling validation procedure 500 times, an operation that took a few minutes with <sc>fastcore</sc> but that would barely be manageable with other reconstruction algorithms. Other examples where fast computation is important are time-course experiments or experiments involving different patients or conditions <xref ref-type="bibr" rid="pcbi.1003424-Jerby2">[40]</xref>. There <sc>fastcore</sc> could more easily identify differential models over time and/or input conditions.</p>
<p>Compactness is a key concept in various research areas of biology, such as the minimal genome <xref ref-type="bibr" rid="pcbi.1003424-Morowitz1">[41]</xref>, <xref ref-type="bibr" rid="pcbi.1003424-Maniloff1">[42]</xref>. Notwithstanding, the requirement of model compactness seems to be in disagreement with the observation that biological systems are fairly redundant and this redundancy serves a specific purpose, namely, the fast adaptation to changes in the environment. Alternative pathways that perform similar functions are known to be expressed in different environmental conditions, allowing for instance to metabolize another type of sugar when glucose is not available <xref ref-type="bibr" rid="pcbi.1003424-Suckow1">[43]</xref>. At any rate, the pursuit of compactness in metabolic network reconstruction need not be in conflict with the notion of redundancy. Alternative pathways will be included in a reconstructed model as long as ‘redundant’ reactions that are supported by biological evidence are included in the core set.</p>
</sec><sec id="s6">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003424.s001" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003424.s001" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Detailed comparison of the liver models generated with MBA and FASTCORE.</bold> (See main text, Section ‘Reconstruction of a liver model’).</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We would like to thank Ines Thiele, Ronan Fleming, Nils Christian, Evangelos Symeonidis, Nathan Price, and Rudi Balling for their feedback.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003424-DeBerardinis1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>DeBerardinis</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Thompson</surname><given-names>CB</given-names></name> (<year>2012</year>) <article-title>Cellular metabolism and disease: what do metabolic outliers teach us?</article-title> <source>Cell</source> <volume>148</volume>: <fpage>1132</fpage>–<lpage>1144</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Pourfar1"><label>2</label>
<mixed-citation publication-type="other" xlink:type="simple">Pourfar M, Niethammer M, Eidelberg D (2013) Metabolic networks in Parkinson's disease. In: Grimaldi G, Manto M, editors, Mechanisms and Emerging Therapies in Tremor Disorders, Springer New York, Contemporary Clinical Neuroscience. pp. 403–415. doi:10.1007/978-1-4614-4027-7 22. Available: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1007/978-1-4614-4027-7" xlink:type="simple">http://dx.doi.org/10.1007/978-1-4614-4027-7</ext-link> 22.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Hiller1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hiller</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Metallo</surname><given-names>CM</given-names></name> (<year>2013</year>) <article-title>Profiling metabolic networks to study cancer metabolism</article-title>. <source>Current Opinion in Biotechnology</source> <volume>24</volume>: <fpage>60</fpage>–<lpage>68</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Duarte1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Duarte</surname><given-names>NC</given-names></name>, <name name-style="western"><surname>Becker</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Jamshidi</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Mo</surname><given-names>ML</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Global reconstruction of the human metabolic network based on genomic and bibliomic data</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>104</volume>: <fpage>1777</fpage>–<lpage>1782</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Hao1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hao</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Ma</surname><given-names>HW</given-names></name>, <name name-style="western"><surname>Zhao</surname><given-names>XM</given-names></name>, <name name-style="western"><surname>Goryanin</surname><given-names>I</given-names></name> (<year>2010</year>) <article-title>Compartmentalization of the Edinburgh human metabolic network</article-title>. <source>BMC bioinformatics</source> <volume>11</volume>: <fpage>393</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Thiele1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Swainston</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name>, <name name-style="western"><surname>Hoppe</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sahoo</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>A community-driven global reconstruction of human metabolism</article-title>. <source>Nature biotechnology</source> <comment>(doi:<ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/101038/nbt2488)" xlink:type="simple">101038/nbt2488)</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003424-Thiele2"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name> (<year>2010</year>) <article-title>A protocol for generating a high-quality genome-scale metabolic reconstruction</article-title>. <source>Nature protocols</source> <volume>5</volume>: <fpage>93</fpage>–<lpage>121</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Becker1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Becker</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name> (<year>2008</year>) <article-title>Context-specific metabolic networks are consistent with experiments</article-title>. <source>PLoS computational biology</source> <volume>4</volume>: <fpage>e1000082</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Christian1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Christian</surname><given-names>N</given-names></name>, <name name-style="western"><surname>May</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Kempa</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Handorf</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Ebenhöh</surname><given-names>O</given-names></name> (<year>2009</year>) <article-title>An integrative approach towards completing genome-scale metabolic networks</article-title>. <source>Mol BioSyst</source> <volume>5</volume>: <fpage>1889</fpage>–<lpage>1903</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Jerby1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jerby</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Shlomi</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Ruppin</surname><given-names>E</given-names></name> (<year>2010</year>) <article-title>Computational reconstruction of tissue-specific metabolic models: Application to human liver metabolism</article-title>. <source>Molecular Systems Biology</source> <volume>6</volume>: <fpage>401</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Chang1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chang</surname><given-names>RL</given-names></name>, <name name-style="western"><surname>Xie</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Xie</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Bourne</surname><given-names>PE</given-names></name>, <name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name> (<year>2010</year>) <article-title>Drug off-target effects predicted using structural analysis in the context of a metabolic network model</article-title>. <source>PLoS Computational Biology</source> <volume>6</volume>: <fpage>e1000938</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Lewis1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lewis</surname><given-names>NE</given-names></name>, <name name-style="western"><surname>Schramm</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Bordbar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Schellenberger</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Andersen</surname><given-names>MP</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Large-scale in silico modeling of metabolic interactions between cell types in the human brain</article-title>. <source>Nature biotechnology</source> <volume>28</volume>: <fpage>1279</fpage>–<lpage>1285</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Agren1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Agren</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bordel</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Mardinoglu</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Pornputtapong</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Nookaew</surname><given-names>I</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Reconstruction of genome-scale active metabolic networks for 69 human cell types and 16 cancer types using INIT</article-title>. <source>PLoS Computational Biology</source> <volume>8</volume>: <fpage>e1002518</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Folger1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Folger</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Jerby</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Frezza</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Gottlieb</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Ruppin</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Predicting selective drug targets in cancer through metabolic networks</article-title>. <source>Molecular systems biology</source> <volume>7</volume>: <fpage>501</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Bordbar1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bordbar</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Mo</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Nakayasu</surname><given-names>ES</given-names></name>, <name name-style="western"><surname>Schrimpe-Rutledge</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Kim</surname><given-names>YM</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Model-driven multi-omic data analysis elucidates metabolic immunomodulators of macrophage activation</article-title>. <source>Molecular Systems Biology</source> <volume>8</volume>: <fpage>558</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Shlomi1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shlomi</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Cabili</surname><given-names>MN</given-names></name>, <name name-style="western"><surname>Herrgård</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name>, <name name-style="western"><surname>Ruppin</surname><given-names>E</given-names></name> (<year>2008</year>) <article-title>Network-based prediction of human tissue-specific metabolism</article-title>. <source>Nature biotechnology</source> <volume>26</volume>: <fpage>1003</fpage>–<lpage>1010</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Chandrasekaran1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chandrasekaran</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Price</surname><given-names>ND</given-names></name> (<year>2010</year>) <article-title>Probabilistic integrative modeling of genome-scale metabolic and regulatory networks in Escherichia coli and Mycobacterium tuberculosis</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>107</volume>: <fpage>17845</fpage>–<lpage>17850</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Jensen1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jensen</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Papin</surname><given-names>JA</given-names></name> (<year>2011</year>) <article-title>Functional integration of a metabolic network model and expression data without arbitrary thresholding</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>541</fpage>–<lpage>547</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Schuster1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schuster</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Hilgetag</surname><given-names>C</given-names></name> (<year>1994</year>) <article-title>On elementary flux modes in biochemical reaction systems at steady state</article-title>. <source>Journal of Biological Systems</source> <volume>2</volume>: <fpage>165</fpage>–<lpage>182</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Stephanopoulos1"><label>20</label>
<mixed-citation publication-type="book" xlink:type="simple">Stephanopoulos G, Aristidou AA, Nielsen J (1998) Metabolic engineering: principles and methodologies. San Diego: Academic Press.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Price1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Price</surname><given-names>ND</given-names></name>, <name name-style="western"><surname>Reed</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name> (<year>2004</year>) <article-title>Genome-scale models of microbial cells: evaluating the consequences of constraints</article-title>. <source>Nature Reviews Microbiology</source> <volume>2</volume>: <fpage>886</fpage>–<lpage>897</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Gagneur1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gagneur</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Klamt</surname><given-names>S</given-names></name> (<year>2004</year>) <article-title>Computation of elementary modes: a unifying framework and the new binary approach</article-title>. <source>BMC bioinformatics</source> <volume>5</volume>: <fpage>175</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Fleming1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name>, <name name-style="western"><surname>Maes</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Ye</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Saunders</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Palsson</surname><given-names>BØ</given-names></name> (<year>2012</year>) <article-title>A variational principle for computing nonequilibrium fluxes and potentials in genome-scale biochemical networks</article-title>. <source>Journal of Theoretical Biology</source> <volume>292</volume>: <fpage>71</fpage>–<lpage>77</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Blazier1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Blazier</surname><given-names>AS</given-names></name>, <name name-style="western"><surname>Papin</surname><given-names>JA</given-names></name> (<year>2012</year>) <article-title>Integration of expression data in genome-scale metabolic network reconstructions</article-title>. <source>Frontiers in Physiology</source> <volume>3</volume>: <fpage>299</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Orth1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Orth</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Conrad</surname><given-names>TM</given-names></name>, <name name-style="western"><surname>Na</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lerman</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Nam</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>A comprehensive genome-scale reconstruction of Escherichia coli metabolism</article-title>. <source>Molecular systems biology</source> <volume>7</volume>: <fpage>535</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Wang1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Eddy</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Price</surname><given-names>ND</given-names></name> (<year>2012</year>) <article-title>Reconstruction of genome-scale metabolic models for 126 human tissues using mCADRE</article-title>. <source>BMC Systems Biology</source> <volume>6</volume>: <fpage>153</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Acua1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Acuña</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Chierichetti</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Lacroix</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Marchetti-Spaccamela</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Sagot</surname><given-names>MF</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Modes and cuts in metabolic networks: Complexity and algorithms</article-title>. <source>Biosystems</source> <volume>95</volume>: <fpage>51</fpage>–<lpage>60</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Mahadevan1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mahadevan</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Schilling</surname><given-names>CH</given-names></name> (<year>2003</year>) <article-title>The effects of alternate optimal solutions in constraint-based genome-scale metabolic models</article-title>. <source>Metabolic engineering</source> <volume>5</volume>: <fpage>264</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Schellenberger1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schellenberger</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Que</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Fleming</surname><given-names>RMT</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Orth</surname><given-names>JD</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Quantitative prediction of cellular metabolism with constraint-based models: the COBRA Toolbox v2.0</article-title>. <source>Nat Protoc</source> <volume>6</volume>: <fpage>1290</fpage>–<lpage>1307</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Gudmundsson1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gudmundsson</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Thiele</surname><given-names>I</given-names></name> (<year>2010</year>) <article-title>Computationally efficient flux variability analysis</article-title>. <source>BMC bioinformatics</source> <volume>11</volume>: <fpage>489</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Boyd1"><label>31</label>
<mixed-citation publication-type="book" xlink:type="simple">Boyd S, Vandenberghe L (2004) Convex Optimization. Cambridge, UK: Cambridge University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Dreyfuss1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dreyfuss</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Zucker</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Hood</surname><given-names>HM</given-names></name>, <name name-style="western"><surname>Ocasio</surname><given-names>LR</given-names></name>, <name name-style="western"><surname>Sachs</surname><given-names>MS</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Reconstruction and validation of a genome-scale metabolic model for the filamentous fungus Neurospora crassa using FARM</article-title>. <source>PLoS Comput Biol</source> <volume>9</volume>: <fpage>e1003126</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Chvtal1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chvátal</surname><given-names>V</given-names></name> (<year>1979</year>) <article-title>A greedy heuristic for the set-covering problem</article-title>. <source>Mathematics of operations research</source> <volume>4</volume>: <fpage>233</fpage>–<lpage>235</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Julius1"><label>34</label>
<mixed-citation publication-type="other" xlink:type="simple">Julius AA, Imielinski M, Pappas GJ (2008) Metabolic networks analysis using convex optimization. In: 47th IEEE Conference on Decision and Control. pp. 762–767.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Zur1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zur</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Ruppin</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Shlomi</surname><given-names>T</given-names></name> (<year>2010</year>) <article-title>iMAT: an integrative metabolic analysis tool</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>3140</fpage>–<lpage>3142</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Vitkin1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vitkin</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Shlomi</surname><given-names>T</given-names></name> (<year>2012</year>) <article-title>MIRAGE: a functional genomics-based approach for metabolic network model reconstruction and its application to cyanobacteria networks</article-title>. <source>Genome biology</source> <volume>13</volume>: <fpage>R111</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Zomorrodi1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Zomorrodi</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Maranas</surname><given-names>CD</given-names></name> (<year>2010</year>) <article-title>Improving the iMM904 S.cerevisiae metabolic model using essentiality and synthetic lethality data</article-title>. <source>BMC systems biology</source> <volume>4</volume>: <fpage>178</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Orth2"><label>38</label>
<mixed-citation publication-type="book" xlink:type="simple">Orth JD, Fleming RMT, Palsson BØ (2010) Reconstruction and use of microbial metabolic networks: the core <italic>Escherichia coli</italic> metabolic model as an educational guide. In: Böck A, Curtiss III R, Kaper JB, Karp PD, Neidhardt FC, <etal>et al</etal>.., editors, <italic>Escherichia coli</italic> and Salmonella: Cellular and Molecular Biology, Washington, DC: ASM Press. doi:10.1128/ecosal.10.2.1.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Lee1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lee</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Jahoor</surname><given-names>F</given-names></name>, <name name-style="western"><surname>O'Brien</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Beaudet</surname><given-names>AL</given-names></name>, <etal>et al</etal>. (<year>2000</year>) <article-title>In vivo urea cycle flux distinguishes and correlates with phenotypic severity in disorders of the urea cycle</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>97</volume>: <fpage>8021</fpage>–<lpage>8026</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Jerby2"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jerby</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ruppin</surname><given-names>E</given-names></name> (<year>2012</year>) <article-title>Predicting drug targets and biomarkers of cancer via genome-scale metabolic modeling</article-title>. <source>Clinical Cancer Research</source> <volume>18</volume>: <fpage>5572</fpage>–<lpage>5584</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Morowitz1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morowitz</surname><given-names>HJ</given-names></name> (<year>1984</year>) <article-title>The completeness of molecular biology</article-title>. <source>Israel journal of medical sciences</source> <volume>20</volume>: <fpage>750</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Maniloff1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Maniloff</surname><given-names>J</given-names></name> (<year>1996</year>) <article-title>The minimal cell genome: “on being the right size”</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>93</volume>: <fpage>10004</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003424-Suckow1"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Suckow</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Markiewicz</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Kleina</surname><given-names>LG</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kisters-Woike</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>1996</year>) <article-title>Genetic studies of the Lac repressor. XV: 4000 single amino acid substitutions and analysis of the resulting phenotypes on the basis of the protein structure</article-title>. <source>Journal of molecular biology</source> <volume>261</volume>: <fpage>509</fpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>