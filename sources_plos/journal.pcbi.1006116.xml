<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01647</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006116</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject><subj-group><subject>Human learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Cognitive science</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Social sciences</subject><subj-group><subject>Psychology</subject><subj-group><subject>Cognitive psychology</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Neuroscience</subject><subj-group><subject>Learning and memory</subject><subj-group><subject>Learning</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Agent-based modeling</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Systems science</subject><subj-group><subject>Agent-based modeling</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Systems science</subject><subj-group><subject>Agent-based modeling</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Behavior</subject></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Applied mathematics</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Research and analysis methods</subject><subj-group><subject>Simulation and modeling</subject><subj-group><subject>Algorithms</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Theoretical ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Ecology and environmental sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Theoretical ecology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Approximation methods</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Behavior</subject><subj-group><subject>Human performance</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Compositional clustering in task structure learning</article-title>
<alt-title alt-title-type="running-head">Compositional clustering in task structure learning</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-4657-9690</contrib-id>
<name name-style="western">
<surname>Franklin</surname> <given-names>Nicholas T.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Frank</surname> <given-names>Michael J.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Department of Psychology, Harvard University, Cambridge, Massachusetts, United States of America</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Department of Cognitive, Linguistic &amp; Psychological Sciences, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Brown Institute for Brain Science, Brown University, Providence, Rhode Island, United States of America</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Daunizeau</surname> <given-names>Jean</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>Brain and Spine Institute (ICM), FRANCE</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">nfranklin@fas.harvard.edu</email> (NTF); <email xlink:type="simple">michael_frank@brown.edu</email> (MJF)</corresp>
</author-notes>
<pub-date pub-type="collection">
<month>4</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>19</day>
<month>4</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>4</issue>
<elocation-id>e1006116</elocation-id>
<history>
<date date-type="received">
<day>2</day>
<month>10</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>3</day>
<month>4</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Franklin, Frank</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006116"/>
<abstract>
<p>Humans are remarkably adept at generalizing knowledge between experiences in a way that can be difficult for computers. Often, this entails generalizing constituent pieces of experiences that do not fully overlap, but nonetheless share useful similarities with, previously acquired knowledge. However, it is often unclear how knowledge gained in one context should generalize to another. Previous computational models and data suggest that rather than learning about each individual context, humans build latent abstract structures and learn to link these structures to arbitrary contexts, facilitating generalization. In these models, task structures that are more popular across contexts are more likely to be revisited in new contexts. However, these models can only re-use policies as a whole and are unable to transfer knowledge about the transition structure of the environment even if only the goal has changed (or vice-versa). This contrasts with ecological settings, where some aspects of task structure, such as the transition function, will be shared between context separately from other aspects, such as the reward function. Here, we develop a novel non-parametric Bayesian agent that forms independent latent clusters for transition and reward functions, affording separable transfer of their constituent parts across contexts. We show that the relative performance of this agent compared to an agent that jointly clusters reward and transition functions depends environmental task statistics: the mutual information between transition and reward functions and the stochasticity of the observations. We formalize our analysis through an information theoretic account of the priors, and propose a meta learning agent that dynamically arbitrates between strategies across task domains to optimize a statistical tradeoff.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>A musician may learn to generalize behaviors across instruments for different purposes, for example, reusing hand motions used when playing classical on the flute to play jazz on the saxophone. Conversely, she may learn to play a single song across many instruments that require completely distinct physical motions, but nonetheless transfer knowledge between them. This degree of compositionality is often absent from computational frameworks of learning, forcing agents either to generalize entire learned policies or to learn new policies from scratch. Here, we propose a solution to this problem that allows an agent to generalize components of a policy independently and compare it to an agent that generalizes components as a whole. We show that the degree to which one form of generalization is favored over the other is dependent on the features of task domain, with independent generalization of task components favored in environments with weak relationships between components or high degrees of noise and joint generalization of task components favored when there is a clear, discoverable relationship between task components. Furthermore, we show that the overall meta structure of the environment can be learned and leveraged by an agent that dynamically arbitrates between these forms of structure learning.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000025</institution-id>
<institution>National Institute of Mental Health</institution>
</institution-wrap>
</funding-source>
<award-id>R01MH080066</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Frank</surname> <given-names>Michael J</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>1460604</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Frank</surname> <given-names>Michael J</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>This work was supported in part by the National Institute of Mental Health Award number R01MH080066 to MJF as well as the National Science Foundation Proposal 1460604 to MJF. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="6"/>
<table-count count="0"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta>
<meta-name>PLOS Publication Stage</meta-name>
<meta-value>vor-update-to-uncorrected-proof</meta-value>
</custom-meta>
<custom-meta>
<meta-name>Publication Update</meta-name>
<meta-value>2018-05-01</meta-value>
</custom-meta>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>Our paper exclusively uses simulation all of which are available online, in complete form with accompanying code in our GitHub repository: github.com/nicktfranklin/IndependentClusters.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Compared to artificial agents, humans exhibit remarkable flexibility in our ability to rapidly, spontaneously and appropriately learn to behave in unfamiliar situations, by generalizing past experience and performing symbolic-like operations on constituent components of knowledge [<xref ref-type="bibr" rid="pcbi.1006116.ref001">1</xref>]. Formal models of human learning have cast generalization as an inference problem in which people learn a shared (latent) task structure across multiple contexts and then infer which causal structure best suits the current scenario [<xref ref-type="bibr" rid="pcbi.1006116.ref002">2</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>]. In these models, a context, typically an observable (or partially observable) feature of the environment, is linked to a learnable set of task statistics or rules. Based on statistics and the opportunity for generalization, the learner has to infer which environmental features (stimulus dimensions, episodes, etc.) should constitute the context that signals the overall task structure, and, simultaneously, which features are indicative of the specific appropriate behaviors for the inferred task structure. This learning strategy is well captured by Bayesian nonparametric models, and neural network approximations thereof, that impose a hierarchical clustering process onto learning task structures [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref004">4</xref>]. A learner infers the probability that two contexts are members of the same task cluster via Bayesian inference, and in novel situations, has a prior to reapply the task structures that have been more popular across disparate contexts, while also allowing for the potential to create a new structure as needed. Empirical studies have provided evidence that humans spontaneously impute such hierarchical structure, which facilitates future transfer, whether or not it is immediately beneficial—and, indeed, even if it is costly—to initial learning [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1006116.ref005">5</xref>].</p>
<p>These clustering models can account for aspects of human generalization that are not well explained by standard models of learning. This approach to generalization, treating multiple contexts as sharing a common task structure, is similar to artificial agents that reuse previously learned policies in novel tasks when the statistics are sufficiently similar [<xref ref-type="bibr" rid="pcbi.1006116.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006116.ref009">9</xref>]. However, a key limitation to these clustering models of generalization is that policies of the agent are generalized as a unit. That is, in a new context, a previously learned policy can either be reused or a new policy must be learned from scratch. This can be problematic as policies are often not robust to untrained variation in task structure [<xref ref-type="bibr" rid="pcbi.1006116.ref010">10</xref>–<xref ref-type="bibr" rid="pcbi.1006116.ref012">12</xref>]. Thus, a previously learned policy can lead to a poor outcome in a new context even if there is a substantial degree of shared structure.</p>
<p>Because task structures are either reused or not as a whole, the ability to reuse and share component parts of knowledge is limited; that is, they are not <italic>compositional</italic>. Compositionality, or the ability to bind (compose) information together in a rule governed way, has long been thought to be a core aspect of human cognition [<xref ref-type="bibr" rid="pcbi.1006116.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref013">13</xref>]. Importantly, ecological contexts often share a partial structure, limiting the applicability of previously learned policies but nonetheless providing a generalization advantage to a compositional agent.</p>
<p>To provide a naturalistic example, an adept musician can transfer a learned song between a piano and a guitar, even as the two instruments require completely different physical movements, implying that goals can be generalized and reused independently of the actions needed to achieve them. A clustering model that generalizes entire task structures cannot account for this behavior, and would require instead that an agent would need to relearn a song from scratch to play it on a new instrument. Worse, this clustering scheme would predict an unlikely interference effect where the similar outcome of playing the same song on two instruments results in the model incorrectly pooling motor policies across instruments.</p>
<p>Here, we propose a framework to address one aspect of compositionality by decomposing task structures—and their separable potential for clustering—into reward functions and transition functions. These two independent functions of a Markov decision process are suitable units of generalization: if we assume that an agent has knowledge of a state-space and the set of available actions, then the reward and transition functions are sufficient to determine the optimal policy. In real-world scenarios, a reward function may correspond to the objective of an agent (what it would like to achieve and the environmental states that produce these goals). A transition function determines how the agent’s actions affect its environment (i.e., the subsequent states). For example, when playing music a reward function might correspond to the desired sequence of notes (a scale, or a song) while the transition function might correspond to the actions needed to produce notes on an instrument. When picking up a new form of guitar, it may be sufficient for a musician to play one or two strings which may then afford inference of the entire transition functions (the tuning: strings and frets needed to obtain each note). Here, we are concerned with how the inference of one (reward or transition) function affects generalization of the other.</p>
<p>We consider two approaches to clustering and compare their relative generalization advantages as a function of environmental statistics. The <italic>independent clustering</italic> agent supports generalization by clustering contexts into independent sets defined by the reward and transition statistics, respectively. In contrast, the <italic>joint clustering</italic> agent clusters contexts into a single set of clusters that binds together the transition and reward functions (hence amounting to previous models of task-set structure that cluster and re-use policies [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>–<xref ref-type="bibr" rid="pcbi.1006116.ref005">5</xref>]). Necessarily, independent clustering is compositional and requires the binding of two independent functions.</p>
<p>We show that these two models lead to different predictions depending on the task environment, and we provide an information theoretic analysis to formalize and quantify the bounds of these advantages/disadvantages. In environments where there is a clear, discoverable relationship between transitions and rewards, joint clustering facilitates generalization by allowing an agent to infer one function based on observations that are informative about the other. Nonetheless, we show that independent clustering can lead to superior generalization even in such cases when the transition-reward relationship is weak, difficult to discover, or costly to do so. Finally, we develop a meta-structure learning agent that can infer whether the overall environment is better described by independent or joint statistics.</p>
</sec>
<sec id="sec002" sec-type="materials|methods">
<title>Models</title>
<p>To provide a test-bed for characterizing the effects compositional structure, we consider a series of navigation tasks by utilizing grid worlds as a simplification of real-world environments. In these grid worlds, an agent learns to navigate by learning transition functions (the consequences of its actions in terms of subsequent states) and separately learns a reward function (the reward values of locations, or goals) as it navigates. At each point in time, the agent is given a state tuple <italic>s</italic> = &lt; <italic>x</italic>, <italic>c</italic> &gt; where <inline-formula id="pcbi.1006116.e001"><alternatives><graphic id="pcbi.1006116.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e001" xlink:type="simple"/><mml:math display="inline" id="M1"><mml:mrow><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>d</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is a vector of state variables (for example, a location vector in coordinate space) and <inline-formula id="pcbi.1006116.e002"><alternatives><graphic id="pcbi.1006116.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:msup><mml:mi mathvariant="double-struck">R</mml:mi> <mml:mi>n</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> is a context vector. Here, we define “context” as a vector denoting some mutable property of the world (for example, the presence or absence of rain, an episodic period of time, etc.) that constrain the statistics of the task domain, whereby these task statistics are consistent for each context that cues the relevant task. Formally, for each context we can define a Markov decision process (MDP) with state variables <italic>x</italic> ∈ <italic>X</italic>, actions <italic>a</italic> ∈ <italic>A</italic>, a reward function mapping state variables and actions to a real valued number <inline-formula id="pcbi.1006116.e003"><alternatives><graphic id="pcbi.1006116.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:mi>R</mml:mi> <mml:mo>:</mml:mo> <mml:mi>X</mml:mi> <mml:mo>×</mml:mo> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="double-struck">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, and a transition function mapping state variables and actions to a probability distribution over successors <inline-formula id="pcbi.1006116.e004"><alternatives><graphic id="pcbi.1006116.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mrow><mml:mi>T</mml:mi> <mml:mo>:</mml:mo> <mml:mi>X</mml:mi> <mml:mo>×</mml:mo> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>→</mml:mo> <mml:mo>Π</mml:mo> <mml:mo>(</mml:mo> <mml:mi>X</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>For the purpose of simplicity, we assume that the agent knows the spatial relationship between states (i.e., it has access to a spatial map of its current position and adjacent positions) but has to learn how its actions take it from one state to another. Specifically, we assume the agent knows a set of <italic>cardinal movements</italic> <inline-formula id="pcbi.1006116.e005"><alternatives><graphic id="pcbi.1006116.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">A</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, where each cardinal movement is a vector that defines a change in the state variables with regard to the known spatial structure per unit time. (For example, in a two dimensional grid world we can define North = 〈<italic>dx</italic>/<italic>dt</italic>, <italic>dy</italic>/<italic>dt</italic>〉 = 〈0, 1〉 as a cardinal movement). We can thus define a transition function in terms of cardinal movements <italic>T</italic>(<italic>x</italic>, <italic>A</italic>, <italic>x</italic>′|<italic>c</italic>) = Pr(<italic>x</italic>′|<italic>x</italic>, <italic>A</italic>, <italic>c</italic>) and cast the navigation problem as the learning of some function that maps primitive actions to cardinal movements <inline-formula id="pcbi.1006116.e006"><alternatives><graphic id="pcbi.1006116.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:mrow><mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mo>:</mml:mo> <mml:mi mathvariant="script">A</mml:mi> <mml:mo>→</mml:mo> <mml:msub><mml:mi mathvariant="script">A</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, which we assume to be independent of location.</p>
<p>This simplifying assumption has the benefit of providing a model of human navigation, whom we assume understand spatial structure. Note that the function mapping motor actions onto cardinal movements can depend on environmental conditions, and thus, context (for example, wind condition can change the relationship between primitive actions and movements in space for an aerial drone). A similar mapping between arbitrary button presses and movements in the “finger sailing” task has been used to provided evidence for model-based action planning in human subjects [<xref ref-type="bibr" rid="pcbi.1006116.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref015">15</xref>]. Similarly, we can express the reward function in terms of cardinal movements based on a location in space, <italic>R</italic><sub><italic>c</italic></sub>(<italic>x</italic>, <italic>A</italic>) = Pr(<italic>r</italic>|<italic>x</italic>, <italic>A</italic>, <italic>c</italic>). This allows us to consider how the agent receives reward as it moves through coordinate space (as opposed to how it receives reward as a function of its actions). Alternatively, we can express the reward function as <italic>R</italic>(<italic>x</italic>, <italic>x</italic>′) or more simply as <italic>R</italic>(<italic>x</italic>′). The key assumption here is that the reward function is not a function of the agent’s actions but is a function of the consequences of those actions.</p>
<p>The task of the agent is to generate a policy (a function mapping state variables to primitive actions, for each context; <inline-formula id="pcbi.1006116.e007"><alternatives><graphic id="pcbi.1006116.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mrow><mml:msup><mml:mi>π</mml:mi> <mml:mo>*</mml:mo></mml:msup> <mml:mrow><mml:mo>|</mml:mo> <mml:mi>c</mml:mi> <mml:mo>:</mml:mo> <mml:mi>X</mml:mi> <mml:mo>→</mml:mo> <mml:mi mathvariant="script">A</mml:mi></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) that maximizes its expected future discounted reward [<xref ref-type="bibr" rid="pcbi.1006116.ref016">16</xref>]. Given a known transition function and reward function, the optimal policy given this task can be defined as:
<disp-formula id="pcbi.1006116.e008"><alternatives><graphic id="pcbi.1006116.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e008" xlink:type="simple"/><mml:math display="block" id="M8"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>c</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>arg</mml:mtext> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi>a</mml:mi></mml:munder> <mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>A</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">A</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:mi>X</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>T</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>[</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:msub><mml:mi>V</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula>
where <italic>V</italic><sub><italic>c</italic></sub>(<italic>x</italic>) is the optimal value function is defined by the Bellman equation:
<disp-formula id="pcbi.1006116.e009"><alternatives><graphic id="pcbi.1006116.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e009" xlink:type="simple"/><mml:math display="block" id="M9"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>V</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi>A</mml:mi></mml:munder> <mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:mi>X</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>T</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>[</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:msub><mml:mi>V</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>]</mml:mo> <mml:mspace width="4pt"/><mml:mo>∀</mml:mo> <mml:mspace width="4pt"/><mml:mi>x</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>X</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
As the relationship between locations in space, <italic>T</italic><sub><italic>c</italic></sub>, is known to the agent, it is sufficient to learn the cardinal <italic>mapping function</italic> <italic>ϕ</italic><sub><italic>c</italic></sub>(<italic>a</italic>, <italic>A</italic>) and <italic>reward function</italic> <italic>R</italic><sub><italic>c</italic></sub>(<italic>x</italic>, <italic>A</italic>) to determine an optimal policy.</p>
<p>While the optimal policy is dependent on both the mapping function and reward function, crucially, the optimal value function is not: it is dependent only on the reward function (and the known transition function <italic>T</italic><sub><italic>c</italic></sub>). Consequently, an agent can determine an optimal policy as a function of movements through space:
<disp-formula id="pcbi.1006116.e010"><alternatives><graphic id="pcbi.1006116.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>π</mml:mi> <mml:mi>c</mml:mi> <mml:mo>*</mml:mo></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>arg</mml:mtext> <mml:munder><mml:mo form="prefix" movablelimits="true">max</mml:mo> <mml:mi>A</mml:mi></mml:munder> <mml:mo>[</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:mi>X</mml:mi></mml:mrow></mml:munder> <mml:msub><mml:mi>T</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>[</mml:mo> <mml:mi>R</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:msub><mml:mi>V</mml:mi> <mml:mi>c</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
This allows the agent to learn how it can take an action to move through space—the mapping function <italic>ϕ</italic><sub><italic>c</italic></sub>(<italic>a</italic>, <italic>A</italic>)—independently from the desirability of the consequences of these moves <italic>R</italic><sub><italic>c</italic></sub>(<italic>x</italic>′). This distinction allows for compositionality during generalization, as we will discuss in the following section.</p>
<sec id="sec003">
<title>Context clustering as generalization</title>
<p>A common strategy to support task generalization is to cluster contexts together, assuming they share the same task statistics, if doing so leads to an acceptable degree of error [<xref ref-type="bibr" rid="pcbi.1006116.ref007">7</xref>]. This logic underlies models of animal Pavlovian learning and transfer [<xref ref-type="bibr" rid="pcbi.1006116.ref002">2</xref>], human instrumental learning and transfer [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref004">4</xref>], and category learning [<xref ref-type="bibr" rid="pcbi.1006116.ref017">17</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref018">18</xref>]. Clustering models of human generalization typically rely on a non-parametric Dirichlet process, commonly known as the Chinese restaurant process (CRP), which acts as a clustering prior in a Bayesian inference process. Used in this way, the CRP enforces popularity-based clustering to partition observations, so that the agent will be most likely to reuse those tasks that have been most popular across disparate contexts (as opposed to across experiences; [<xref ref-type="bibr" rid="pcbi.1006116.ref004">4</xref>]), and has the attractive property of being a non-parametric model that grows with the data [<xref ref-type="bibr" rid="pcbi.1006116.ref019">19</xref>]. Consequently, it is not necessary to know the number of partitions <italic>a priori</italic> and the CRP will tend to parsimoniously favor a smaller number of partitions.</p>
<p>As in prior work, we model generalization as the process of inferring the assignment of contexts <italic>k</italic> = {<italic>c</italic><sub>1:<italic>n</italic></sub>} into clusters that share common task statistics. But here, we decompose these task statistics to consider the possibility that that all contexts <italic>c</italic> ∈ <italic>k</italic> share either the same reward function and/or mapping function, such that <italic>R</italic><sub><italic>k</italic></sub>(<italic>x</italic>, <italic>A</italic>) = <italic>R</italic><sub><italic>c</italic></sub>(<italic>x</italic>, <italic>A</italic>) ∀ <italic>c</italic> ∈ <italic>k</italic> and/or <italic>ϕ</italic><sub><italic>k</italic></sub>(<italic>a</italic>, <italic>A</italic>) = <italic>ϕ</italic><sub><italic>c</italic></sub>(<italic>a</italic>, <italic>A</italic>) ∀ <italic>c</italic> ∈ <italic>k</italic>. (We return to the “and/or” distinction, which affects whether clustering is independent or joint across reward and mapping functions, in the following section). Formally, we define generalization as the inference
<disp-formula id="pcbi.1006116.e011"><alternatives><graphic id="pcbi.1006116.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e011" xlink:type="simple"/><mml:math display="block" id="M11"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>k</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo> <mml:mo>∝</mml:mo> <mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo> <mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(4)</label></disp-formula>
where <inline-formula id="pcbi.1006116.e012"><alternatives><graphic id="pcbi.1006116.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the likelihood of the observed data <inline-formula id="pcbi.1006116.e013"><alternatives><graphic id="pcbi.1006116.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mi mathvariant="script">D</mml:mi></mml:math></alternatives></inline-formula> given cluster <italic>k</italic>, and Pr(<italic>c</italic> ∈ <italic>k</italic>) is a prior over the clustering assignment. As in previous models of generalization, we use the CRP as the cluster prior. If contexts {<italic>c</italic><sub>1:<italic>n</italic></sub>} are clustered into <italic>N</italic> ≤ <italic>n</italic> clusters, then the prior probability for any new context <italic>c</italic><sub><italic>n</italic>+1</sub> ∉ {<italic>c</italic><sub>1:<italic>n</italic></sub>} is:
<disp-formula id="pcbi.1006116.e014"><alternatives><graphic id="pcbi.1006116.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e014" xlink:type="simple"/><mml:math display="block" id="M14"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:mo>∈</mml:mo> <mml:mi>k</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:msub><mml:mi>N</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>k</mml:mi> <mml:mo>≤</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mfrac><mml:mi>α</mml:mi> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mtext>if</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>k</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>K</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(5)</label></disp-formula>
where <italic>N</italic><sub><italic>k</italic></sub> is the number of contexts associated with cluster <italic>k</italic> and <italic>K</italic><sub><italic>n</italic></sub> is the number of unique clusters associated with the n observed contexts. If <italic>k</italic> ≤ <italic>K</italic><sub><italic>n</italic></sub>, then <italic>k</italic> is a previously encountered cluster, whereas if <italic>k</italic> = <italic>K</italic><sub><italic>n</italic></sub> + 1, then <italic>k</italic> is a new cluster. The parameter <italic>α</italic> governs the propensity to assign a new context to a new cluster, that is to create a new task. Higher values of <italic>α</italic> lead to a greater prior probability that a new cluster is created and favors a more expanded task space overall, leading to reduced likelihood of reusing old tasks. Thus, the prior probability that a new context is assigned to an old cluster is proportional to the number of contexts in that cluster (popularity), and the probability that it is assigned to a new cluster is proportional to <italic>α</italic>. As a non-parametric generative process, the prior allows the number of clusters to grow as new contexts are observed. This process is exchangeable, and as such, the order of observation does not alter the inference of the agent [<xref ref-type="bibr" rid="pcbi.1006116.ref019">19</xref>], though approximate inference algorithms can induce order effects.</p>
</sec>
<sec id="sec004">
<title>Independent and joint clustering</title>
<p>As we noted above, there are two key functions the agent learns when navigating in a context: <italic>ϕ</italic><sub><italic>c</italic></sub>(<italic>a</italic>, <italic>A</italic>) and <italic>R</italic><sub><italic>c</italic></sub>(<italic>x</italic>, <italic>A</italic>). These functions imply that the agent could cluster <italic>ϕ</italic><sub><italic>c</italic></sub>(<italic>a</italic>, <italic>A</italic>) and <italic>R</italic><sub><italic>c</italic></sub>(<italic>x</italic>, <italic>A</italic>) jointly, or it could cluster them independently, such that it learns the popularity of each marginalizing over the other. Formally, the <italic>independent clustering</italic> agent (<xref ref-type="fig" rid="pcbi.1006116.g001">Fig 1</xref>, left) assigns each context <italic>c</italic> into two clusters via Bayesian inference as in (<xref ref-type="disp-formula" rid="pcbi.1006116.e011">Eq 4</xref>) and using the CRP prior for each cluster (<xref ref-type="disp-formula" rid="pcbi.1006116.e014">Eq 5</xref>). The likelihood function for the two assignments are the mapping and reward functions
<disp-formula id="pcbi.1006116.e015"><alternatives><graphic id="pcbi.1006116.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e015" xlink:type="simple"/><mml:math display="block" id="M15"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>ϕ</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(6)</label></disp-formula>
and
<disp-formula id="pcbi.1006116.e016"><alternatives><graphic id="pcbi.1006116.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e016" xlink:type="simple"/><mml:math display="block" id="M16"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>k</mml:mi> <mml:mi>R</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>R</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(7)</label></disp-formula>
respectively. Conversely, the <italic>joint clustering</italic> agent (<xref ref-type="fig" rid="pcbi.1006116.g001">Fig 1</xref>, right) assigns each context <italic>c</italic> into a single cluster <italic>k</italic> via Bayesian inference (<xref ref-type="disp-formula" rid="pcbi.1006116.e011">Eq 4</xref>) and, like the independent clustering agent, uses the CRP as the prior over assignments (<xref ref-type="disp-formula" rid="pcbi.1006116.e014">Eq 5</xref>). The likelihood function for the context-cluster assignment is the product of the mapping and reward functions
<disp-formula id="pcbi.1006116.e017"><alternatives><graphic id="pcbi.1006116.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e017" xlink:type="simple"/><mml:math display="block" id="M17"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mi>R</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(8)</label></disp-formula></p>
<fig id="pcbi.1006116.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006116.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Schematic example of independent and joint clustering agents.</title>
<p><italic>Top Left</italic>: The independent clustering agent groups each context into two clusters, associated with a reward (<italic>R</italic>) and mapping (<italic>ϕ</italic>) function, respectively. Planning involves combining these functions to generate a policy. The clustering prior induces a parsimony bias such that new contexts are more likely to be assigned to more popular clusters. Arrows denote assignment of context into clusters and creation of policies from component functions. <italic>Top Right</italic>: The joint clustering agent assigns each context into a cluster linked to both functions (i.e., assumes a holistic task structure), and hence the policy is determined by this cluster assignment. In this example, both agents generate the same two policies for the three contexts but the independent clustering agent generalizes the reward function across all three contexts. <italic>Bottom</italic>: An example mapping (<italic>left</italic>) and reward function (<italic>right</italic>) for a gridworld task.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.g001" xlink:type="simple"/>
</fig>
<p>The joint clustering agent is highly similar to previous non-compositional models of task structure learning and generalization, which have previously been shown to account for human behavior (but without specifically assessing the compositionality issue) [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref004">4</xref>]. For the purpose of comparison with the independent clustering agent, here the joint clustering agent separately learns the functions <italic>R</italic> and <italic>ϕ</italic>. Previous models, in contrast, have learned model-free policies directly. In the general case, joint clustering does not require the separate representation of policy components (<italic>R</italic> and <italic>ϕ</italic>) nor does it require a binding operation in the form of planning. However, independent clustering does require the separate representation of policy components that must be bound via planning. Hence, one potential difference between the two approaches is algorithmic complexity, where joint clustering may permit a less complex and computationally costly learning algorithm than independent clustering. In the simulations below, we have equated the agents for algorithmic complexity and examine how inferring the reward and transition functions separately or together affect performance across task domains.</p>
</sec>
</sec>
<sec id="sec005" sec-type="results">
<title>Results</title>
<p>We first consider two minimal sets of simulations to illustrate the complementary advantages afforded by the two sorts of clustering agents depending on the statistics of the task domain, using a common set of parameters. A third simulation explores how the benefits of compositional clustering can compound in a modified form of the <italic>Rooms</italic> problems previously used to motivate hierarchical RL approaches [<xref ref-type="bibr" rid="pcbi.1006116.ref020">20</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref021">21</xref>]. We show that our independent clustering model with hierarchical decomposition of the state space can facilitate more rapid transfer than that afforded by standard approaches. Finally, we conduct an information theoretic analysis to formalize the more general conditions under which each scheme is more beneficial. Code for all of the simulations presented here have been made available in our GitHub repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/nicktfranklin/IndependentClusters" xlink:type="simple">https://github.com/nicktfranklin/IndependentClusters</ext-link>.</p>
<sec id="sec006">
<title>Simulation 1: Independence of task statistics</title>
<p>In the first set of simulations, we simulated a task domain in which four contexts involving different combinations of reward and transition functions. In every trial, a “goal” location was hidden in a 6x6 grid world. Agents were randomly placed in the grid world and explored action selection until the goal was reached, at which point the trial ended and the next trial began, with the agent again randomized to a new location. The agent’s task is to find the goal location (encoded as +1 reward for finding the goal and a 0 reward otherwise) as quickly as possible. The agents had a set of eight actions available to them <inline-formula id="pcbi.1006116.e018"><alternatives><graphic id="pcbi.1006116.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e018" xlink:type="simple"/><mml:math display="inline" id="M18"><mml:mrow><mml:mi mathvariant="script">A</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mn>8</mml:mn></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, which could be mapped onto one of four cardinal movements <inline-formula id="pcbi.1006116.e019"><alternatives><graphic id="pcbi.1006116.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e019" xlink:type="simple"/><mml:math display="inline" id="M19"><mml:mrow><mml:msub><mml:mi mathvariant="script">A</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mtext>North</mml:mtext> <mml:mo>,</mml:mo> <mml:mtext>South</mml:mtext> <mml:mo>,</mml:mo> <mml:mtext>East</mml:mtext> <mml:mo>,</mml:mo> <mml:mtext>West</mml:mtext> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. The agents were exposed to four trials, in which goal locations and mappings were stationary, for each context. Each of the four contexts had a unique combination of one of two goal locations and one of two mappings (<xref ref-type="fig" rid="pcbi.1006116.g002">Fig 2A</xref>), and hence knowledge about the reward function or mapping function for any context was not informative about the other function. However, because the reward and mapping functions were each common across two contexts, the independent clustering agent can leverage the structure to improve generalization without being bound to the joint distribution of mappings and rewards.</p>
<fig id="pcbi.1006116.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006116.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Simulation 1.</title>
<p><italic>A</italic>: Schematic representation of the task domain. Four contexts (blue circles) were simulated, each paired with a unique combination of one of two goal locations (reward functions) and one of two mappings. <italic>B</italic>: Number of steps taken by each agent shown across trials within a single context (left) and over all trials (right). Fewer steps reflect better performance. <italic>C</italic>: KL-divergence of the models’ estimates of the reward (left) and mapping (right) functions as a function of time. Lower KL-divergence represents better function estimates. Time shown as the number of trials in a context (left) and the number of steps in a context collapsed across trials (right) for clarity.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.g002" xlink:type="simple"/>
</fig>
<p>In addition to the independent and joint clustering agents, for comparison, we also simulated a “flat” (non-hierarchical decomposition of “context” and “state”) agent that does not cluster contexts at all and hence has to learn anew in each context. (The flat agent is a special case of both the independent and joint clustering agents such that <italic>k</italic><sub><italic>i</italic></sub> = {<italic>c</italic><sub><italic>i</italic></sub>} ∀ <italic>i</italic>). We used hypothesis-based inference, where each hypothesis comprised a proposal assignment of contexts in to clusters, <italic>h</italic>: <italic>c</italic> ∈ <italic>k</italic>, defined generatively, such that when a new context is encountered the hypothesis space is augmented. For each hypothesis, maximum likelihood estimation was used to generate the estimates <inline-formula id="pcbi.1006116.e020"><alternatives><graphic id="pcbi.1006116.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e020" xlink:type="simple"/><mml:math display="inline" id="M20"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mtext>Pr</mml:mtext> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>|</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006116.e021"><alternatives><graphic id="pcbi.1006116.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e021" xlink:type="simple"/><mml:math display="inline" id="M21"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mover accent="true"><mml:mtext>Pr</mml:mtext> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. To encourage optimistic exploration, <inline-formula id="pcbi.1006116.e022"><alternatives><graphic id="pcbi.1006116.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e022" xlink:type="simple"/><mml:math display="inline" id="M22"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> was initialized to the maximum observable reward (Pr(<italic>r</italic>|<italic>x</italic>) = 1) with a low confidence prior using a conjugate beta distribution of Beta(0.01, 0).</p>
<p>The belief distribution over the hypothesis space is defined by the posterior probability of the clustering assignments (<xref ref-type="disp-formula" rid="pcbi.1006116.e011">Eq 4</xref>). Calculating the posterior distribution over the full hypothesis space is computationally intractable, as the size of the hypothesis space grows combinatorially with the number of contexts. As an approximation, we pruned hypotheses with small probability (less than 1/10x posterior probability of the maximum <italic>a posteriori</italic> (MAP) hypothesis) from the hypothesis space. We further approximated the inference problem by using the MAP hypothesis, rather than sampling from the entire distribution, during action selection [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref022">22</xref>]. Value iteration was used to solve the system of equations defined by (<xref ref-type="disp-formula" rid="pcbi.1006116.e010">Eq 3</xref>) using the values of <inline-formula id="pcbi.1006116.e023"><alternatives><graphic id="pcbi.1006116.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006116.e024"><alternatives><graphic id="pcbi.1006116.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> associated with the MAP hypothesis(es). A state-action value function, defined here in terms of cardinal movements
<disp-formula id="pcbi.1006116.e025"><alternatives><graphic id="pcbi.1006116.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e025" xlink:type="simple"/><mml:math display="block" id="M25"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>+</mml:mo> <mml:mi>γ</mml:mi> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>∈</mml:mo> <mml:mi>X</mml:mi></mml:mrow></mml:munder> <mml:mi>T</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mover accent="true"><mml:mi>V</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>x</mml:mi> <mml:mo>′</mml:mo></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(9)</label></disp-formula>
was used with a softmax action selection policy to select cardinal movements:
<disp-formula id="pcbi.1006116.e026"><alternatives><graphic id="pcbi.1006116.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>β</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup> <mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>A</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">A</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub> <mml:msup><mml:mi>e</mml:mi> <mml:mrow><mml:mi>β</mml:mi> <mml:msub><mml:mover accent="true"><mml:mi>Q</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(10)</label></disp-formula>
where <italic>β</italic> is an inverse temperature parameter that determines the tendency of the agents to exploit the highest estimated valued actions or to explore. Lower level primitive actions (needed to obtain the desired cardinal movement) were sampled using the mapping function:
<disp-formula id="pcbi.1006116.e027"><alternatives><graphic id="pcbi.1006116.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>A</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi mathvariant="script">A</mml:mi> <mml:mrow><mml:mi>c</mml:mi> <mml:mi>a</mml:mi> <mml:mi>r</mml:mi> <mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munder> <mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mi>k</mml:mi></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>|</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(11)</label></disp-formula>
We first simulated the independent and joint clustering agents as well as the flat agent on 150 random task domains using the parameter values <italic>γ</italic> = 0.75, <italic>β</italic> = 5.0 and <italic>α</italic> = 1.0 (below we consider a more general parameter-independent analysis). Each of the four contexts was repeated 4 times for a total of 16 trials. The independent clustering agent completed the task more quickly than either other agent, completing all trials in an average of 205.2 (s = 20.2) steps in comparison to 267.4 (s = 22.4) and 263.5 (s = 17.4) steps for the joint clustering and flat agents, respectively (<xref ref-type="fig" rid="pcbi.1006116.g002">Fig 2B</xref>). (We confirmed here and elsewhere that these differences were highly significant (e.g., here, the relevant comparisons are a minimum of <italic>p</italic> &lt; 1<italic>e</italic>−77)). Repeating these simulations with agents required to estimate the full transition function (instead of just the mapping function) led to the same pattern of results, with the independent clustering agent completing the tasks in fewer steps than either the joint clustering or flat agents (<xref ref-type="supplementary-material" rid="pcbi.1006116.s003">S1 Text</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006116.s001">S1 Fig</xref>).</p>
<p>In this case, the performance advantage of independent clustering is largely driven by faster learning of the reward function, as indexed by the KL-divergence between the agents’ estimates of the reward function compared to a flat learner (<xref ref-type="fig" rid="pcbi.1006116.g002">Fig 2C</xref>, left). In contrast, both joint and independent clustering show generalization benefit when learning the mapping function (<xref ref-type="fig" rid="pcbi.1006116.g002">Fig 2C</xref>, right). This difference reflects an information asymmetry: in a new context, more information is available earlier to an agent about the mappings than the rewards, given that the latter are largely experienced when reaching a goal. (For example, in these environments, the first action in a novel context yields 2 bits of information about the mappings and an average of 0.07 bits of information about the rewards). As a consequence of this asymmetry, observing an element of a mapping can facilitate generalization of the rest of the mapping via the likelihood function, whereas observing unrewarded squares in the grid world tells the agent little about the location of rewarded squares.</p>
<p>In sum, as expected, independent clustering exhibited advantages over joint clustering in a task environment for which the transition and reward functions were orthogonally linked across contexts.</p>
</sec>
<sec id="sec007">
<title>Simulation 2: Dependence in task statistics</title>
<p>We next simulated all three agents on separate task domain in which there was a discoverable relationship between the reward and mapping functions across contexts, such that knowledge about one function is informative about the other. There were with four orthogonal reward functions and four orthogonal mappings across eight contexts, with each pairing of a reward and mapping function repeated across two contexts, permitting generalization (<xref ref-type="fig" rid="pcbi.1006116.g003">Fig 3A</xref>). As before, 150 random task domains were simulated for each model using the parameter values <italic>γ</italic> = 0.75, <italic>β</italic> = 5.0 and <italic>α</italic> = 1.0. Each of the eight contexts was repeated 4 times for a total of 32 trials. In these simulations, both clustering agents show a generalization benefit, completing the task more quickly than the flat agent (<xref ref-type="fig" rid="pcbi.1006116.g003">Fig 3B</xref>). The joint clustering agent showed the largest generalization benefit, completing all trials in average of 384.2 (s = 23.6) steps in comparison to 441.5 (s = 33.4) for the independent clustering agent and 526.0 (s = 26.4) steps for the flat agents. Again, these differences were highly significant and the agents that estimated the full transition function displayed the same pattern of results (<xref ref-type="supplementary-material" rid="pcbi.1006116.s003">S1 Text</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006116.s001">S1 Fig</xref>).</p>
<fig id="pcbi.1006116.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006116.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Simulation 2.</title>
<p>A: Schematic representation of the second task domain. Eight contexts (blue circles) were simulated, each paired with a combination of one of four orthogonal reward functions and one of four mappings, such that each pairing was repeated across two contexts, providing a discoverable relationship. B: Number of steps taken by each agent shown across trials within a single context (left) and over all trials (right). C: KL-divergence of the models’ estimates of the reward (left) and mapping (right) functions as a function of time.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.g003" xlink:type="simple"/>
</fig>
<p>As is the previous simulations, the differences in performance between the clustering agents was largely driven by learning of the reward function. Both the independent and joint clustering agents had similar estimates of mapping functions across time (<xref ref-type="fig" rid="pcbi.1006116.g003">Fig 3C</xref>, right) whereas the independent clustering agent uniquely shows an initial deficit in generalization of the reward function, as measured by KL divergence in the first trial in a context (<xref ref-type="fig" rid="pcbi.1006116.g003">Fig 3C</xref>, left). The difference in performance between the two clustering models largely occurs for the first trial in a new in a new context, during which time the joint clustering agent had a better estimate of the reward function. As before, this reflects an information asymmetry between mappings and rewards.</p>
</sec>
<sec id="sec008">
<title>Simulation 3: Compounding effects in the “diabolical rooms” problem</title>
<p>Generalization is almost synonymous with a reduction of exploration costs: if an agent generalizes effectively, it can determine a suitable policy without fully exploring a new context. In the above simulations, exploration costs were uniform across all contexts. But in real world situations, the cost of exploring can compound as a person progresses through a task. Exploration can become more costly as resources get scarce: for example, on a long drive it is far more costly to drive around looking for a gas station with an empty tank than with a full one because running out of gas is more likely. Likewise, in a video game where taking a wrong action can mean starting over, it is more costly for an RL agent to randomly explore near the end of the game than at the beginning. Thus, the benefits and costs of generalization can compound in task with a sequential structure over multiple subgoals in ways that are not often apparent in a more restricted task domain. Here, we consider a set of task domains in which each context has a different exploration cost, which increases across time.</p>
<p>We define a modified ‘rooms’ problem as a task domain in which an agent has to navigate a series of rooms (individual grid worlds) to reach a goal location in the last room (<xref ref-type="fig" rid="pcbi.1006116.g004">Fig 4A</xref>). In each room, the agent must choose one of three doors, one of which will advance the agent to the next room, whereas the other two doors will return the agent to the starting position of the very first room (hence the ‘diabolical’ descriptor). Additionally, the mappings that link actions to cardinal movements can vary from room to room, such that the agent has to discover this mapping function separately from the location of the reward (goal door). All of the rooms are visited in order such that if an agent chooses a door that returns it to the starting location, it will need to visit each room before it can explore a new door. Consequently, the cost of exploring a door in a new room increases with each newly encountered room.</p>
<fig id="pcbi.1006116.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006116.g004</object-id>
<label>Fig 4</label>
<caption>
<title>“Diabolic rooms problem”.</title>
<p><italic>A</italic>: Schamatic diagram of rooms problem. Agents enter a room and choose a door to navigate to the next room. Choosing the correct door (green) leads to the next room while choosing the other two doors leads to the start of the task. The agent learns three mappings across rooms <italic>B</italic>: Distribution of steps taken to solve the task by the three agents (left) and median of the distributions (right). <italic>C,D</italic>: Regression of the number of steps to complete the task as a function of grid area (C) and the number of rooms in the task (D) for the joint and independent clustering agents.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.g004" xlink:type="simple"/>
</fig>
<p>Botvinick et al. [<xref ref-type="bibr" rid="pcbi.1006116.ref021">21</xref>] have previously used the original ‘rooms’ problem introduced by Sutton et al. [<xref ref-type="bibr" rid="pcbi.1006116.ref020">20</xref>] to motivate the benefit of the “options” hierarchical RL framework as a method of reducing computational steps. However, in the traditional options framework, there is no method for reusing options across different parts of the state-space (for example, from room to room). Each option needs to be independently defined for the portion of the state-space it covers. In contrast, hierarchical clustering agents that decompose the state space can facilitate generalization in the rooms problem by reusing task structures when appropriate [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>]. However, because it was a joint clustering agent, this previous work would not allow for separate re-use of mapping and reward functions.</p>
<p>In this new, diabolical, variant of the rooms problem, we have afforded the opportunity for reuse of subgoals across rooms, but have modified the task not only to allow for different mapping functions, but where there is a large cost when the appropriately learned subgoal (choosing the correct door) is not reused, and where this cost is varied parametrically by changing the size or number of the rooms. The rooms problem here is qualitatively similar to the “RAM combination-lock environments” used by Leffler and colleagues [<xref ref-type="bibr" rid="pcbi.1006116.ref009">9</xref>] to show that organizing states into classes with reusable properties (analogous to clusters presented in the present work) can drastically reduce exploration costs. In the RAM combination-lock environments, agents navigated through a linear series of states, in which one action would take agents to the next state, another to a goal state, and all others back to the start. The rooms task environment presented here is highly similar but allows us to vary the cost of exploring each room parametrically by varying its size.</p>
<p>We simulated an independent clustering agent, a joint clustering agent, and a flat agent on a series of rooms problems with the parameters <italic>α</italic> = 1.0, <italic>γ</italic> = 0.80 and <italic>β</italic> = 5.0. Each room was represented as a new context (for example, to simulate differences in surface features). There were three doors in the corners of the room, and the same door advanced the agent to the next room for every room (for simplicity, but without loss of generality—i.e., the same conclusions apply if the rewarded door would change across contexts). Agents received a binary reward for selecting the door that advanced to the next room.</p>
<p>In the first set of simulations, we simulated the agents in 6 rooms, each comprising a 6x6 grid world, with three mappings <italic>ϕ</italic><sub><italic>c</italic></sub> ∈ {<italic>ϕ</italic><sub>1</sub>, <italic>ϕ</italic><sub>2</sub>, <italic>ϕ</italic><sub>3</sub>}, each repeated once. Because the cost of exploration compounds as an agent progresses through a task, the ordering of the rooms affects the exploration costs. For simplicity, we simulated a fixed order of the mappings encountered by rooms, defined by the sequence <italic>X</italic><sup><italic>ϕ</italic></sup> = <italic>ϕ</italic><sub>1</sub><italic>ϕ</italic><sub>1</sub><italic>ϕ</italic><sub>2</sub><italic>ϕ</italic><sub>2</sub><italic>ϕ</italic><sub>3</sub><italic>ϕ</italic><sub>3</sub>. In this task domain, independent clustering performed the best with both clustering agents show a generalization benefit as compared to the flat agent (<xref ref-type="fig" rid="pcbi.1006116.g004">Fig 4B</xref>), with the flat agent completing the task in approximately 1.9x and 4.5x more total steps than joint and independent clustering, respectively.</p>
<p>We further explored how these exploration costs change parametrically with the geometry of the environment. First, we varied the dimensions of each room from 3x3 to 12x12. While both clustering models show increased exploration costs as the area of the grid world increases, the exploration costs for the joint clustering model grow at a faster exponential rate than the independent clustering model (<xref ref-type="fig" rid="pcbi.1006116.g004">Fig 4C</xref>). Similarly, we can increase the exploration costs by increasing the number of rooms in the task domain. We varied the number of rooms in the rooms in the task domain from 3 to 27 in increments of three. As before, the same door in all rooms advanced the agent and three mappings were repeated across the rooms. The order of the mappings encountered is defined by the sequence <inline-formula id="pcbi.1006116.e028"><alternatives><graphic id="pcbi.1006116.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e028" xlink:type="simple"/><mml:math display="inline" id="M28"><mml:mrow><mml:msup><mml:mi>X</mml:mi> <mml:mi>ϕ</mml:mi></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mn>2</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mn>3</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>k</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msubsup> <mml:mspace width="3.33333pt"/><mml:mtext>for</mml:mtext> <mml:mspace width="4.pt"/><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>.</mml:mo> <mml:mo>,</mml:mo> <mml:mn>9</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>k</italic> is the number of times a mapping is repeated. Again, both clustering agents experience an increased cost of exploration as the number of rooms increases, but the cost of exploration increases at a faster linear rate for the joint clustering agent than the independent clustering agent (<xref ref-type="fig" rid="pcbi.1006116.g004">Fig 4D</xref>).</p>
<p>Thus, in environments where the benefits of generalization compound across time, difference between strategies can be dramatic. Here, we have simulated an environment in which independent clustering leads to better generalization than joint clustering but we could equivalently create an example in which joint clustering leads to better performance (for example, joint clustering would do better if each mapping uniquely predicted the correct door). Consequently, any fixed strategy has the potential to face an exploration costs that grows exponentially with the complexity of the task domain.</p>
</sec>
<sec id="sec009">
<title>Information theoretic analysis</title>
<p>Thus far, we have examined the performance of hierarchical clustering variants in specific situations in order to demonstrate a tradeoff between strategies. However, while these examples are illustrative, they impose strong assumptions about the task domain, the agents’ knowledge of its structure, exploration policies and planning. In contrast, we are more concerned with the suitability of generalization across ecological environments, rather than the specific task domains we have simulated and the assumptions of planning and exploration.</p>
<p>To make a more general normative claim, it is desirable to abstract away the implementation and strictly address the normative basis of context-popularity based clustering as a generalization algorithm by itself. While addressing optimality requires knowledge of the generative process of ecological environments, which is beyond the scope of the current work, we can more formally and generally assess when, and under what conditions, each of the clustering models might be more suitable than the other.</p>
<p>To do so, we can frame generalization as a classification problem and quantify how well an agent correctly identifies the cluster in which a context belongs without regard to learning the associated task statistics. This simplifying assumption allows us to examine the CRP as a mechanism for generalization and abstracts away the effect of the likelihood function on generalization. Let <inline-formula id="pcbi.1006116.e029"><alternatives><graphic id="pcbi.1006116.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e029" xlink:type="simple"/><mml:math display="inline" id="M29"><mml:mrow><mml:mi>k</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">K</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> be a cluster associated with a Markov decision problem and let context <inline-formula id="pcbi.1006116.e030"><alternatives><graphic id="pcbi.1006116.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e030" xlink:type="simple"/><mml:math display="inline" id="M30"><mml:mrow><mml:mi>c</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">C</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> be a context experienced by the agent. Given a history of experienced contexts and associated clusters {<italic>c</italic><sub>1:<italic>n</italic></sub>, <italic>k</italic><sub>1:<italic>m</italic></sub>}, we cast the problem of generalization as learning the classification function <italic>k</italic> = <italic>f</italic>(<italic>c</italic>) that minimizes the risk of misclassification. (Misclassification risk here is loosely defined: some misclassification errors are worse than others and misidentifying a cluster, and consequently, its MDP, may or may not result in a poor policy if the underlying MDPs are sufficiently similar. As such, the loss function in ecological settings can be a highly non-linear, domain specific function, as we demonstrate with the diabolical rooms problem.)</p>
<p>More formally, we define risk as the expectation <inline-formula id="pcbi.1006116.e031"><alternatives><graphic id="pcbi.1006116.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mo>[</mml:mo> <mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>,</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo> <mml:mo>]</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, where <italic>L</italic>(<italic>p</italic>, <italic>f</italic>) is the loss function for misclassification and <italic>p</italic> is the generative distribution over new contexts <italic>p</italic> = Pr(<italic>k</italic>|<italic>c</italic><sub><italic>t</italic>+1</sub>). For our purposes here, we will abstract away domain specificity in the loss function <italic>L</italic>(<italic>p</italic>, <italic>f</italic>). Because the CRP is a probability distribution, a reasonable domain-independent loss function is the information gain between the CRP’s estimate of the probability of <italic>k</italic> and the realized outcome, or
<disp-formula id="pcbi.1006116.e032"><alternatives><graphic id="pcbi.1006116.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e032" xlink:type="simple"/><mml:math display="block" id="M32"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>,</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mtext>log</mml:mtext> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>q</mml:mi> <mml:mi>K</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(12)</label></disp-formula>
where <italic>q</italic><sub><italic>k</italic></sub> is the CRP’s estimate of the probability of the observed cluster <italic>k</italic> in context <italic>c</italic>. The misclassification risk is thus the cross entropy between the CRP and the generative distribution:
<disp-formula id="pcbi.1006116.e033"><alternatives><graphic id="pcbi.1006116.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e033" xlink:type="simple"/><mml:math display="block" id="M33"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mrow><mml:mo>[</mml:mo> <mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>,</mml:mo> <mml:mi>f</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mrow><mml:mo>[</mml:mo> <mml:mo>-</mml:mo> <mml:msub><mml:mtext>log</mml:mtext> <mml:mn>2</mml:mn></mml:msub> <mml:mi>q</mml:mi> <mml:mo>]</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>p</mml:mi> <mml:mo>,</mml:mo> <mml:mi>q</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(13)</label></disp-formula></p>
<p>Thus, by casting generalization as classification and assuming information gain as a domain-general loss function, we are in effect evaluating the degree to which the CRP estimates the generative distribution. Risk is minimized when <italic>q</italic> = <italic>p</italic>, that is, when the CRP perfectly estimates the generative process. There is no upper bound to poor performance, but in many task domains it is possible to make a naïve guess over the space of clusters (for example, a uniform distribution over a known set of clusters). Because any useful generalization model will be better than a naïve guess, we can evaluate whether the CRP will lead to lower information gain than a naïve estimate in different task domains as a function of their statistics. We consider this more quantitatively in the appendix (<xref ref-type="supplementary-material" rid="pcbi.1006116.s004">S2 Text</xref>), but the result is intuitive: overall, the CRP will facilitate generalization when the generalization process is more predictable (less entropic) and the CRP can lead to worse than chance performance in sufficiently unpredictable domains (<xref ref-type="supplementary-material" rid="pcbi.1006116.s002">S2 Fig</xref>).</p>
<sec id="sec010">
<title>Independent vs joint clustering</title>
<p>A question of primary interest is under what conditions is it better to cluster aspects of the task structure (such as reward functions and transition or mapping functions) independently or jointly. To do so, we rely on the assumption that a reward function is typically substantially sparser than a transition function: as an agent interacts with a task it will gain more information about the transition function early in the task than it will about the reward function (unless the environment is very rich with rewards at most locations, in which case any random agent would perform well).</p>
<p>Consequently, for an agent that clusters rewards and transitions together, the information gained about transitions will dominate the likelihood function, such that the inference of rewards can be thought of as approximately conditional on knowledge of the transition structure. Conversely, an agent that clusters rewards and transition independently will not consider the mapping information when it predicts the reward function. Thus, we can compare the two agents by evaluating the consequences of clustering rewards conditional on transitions as compared to clustering rewards independent of transitions. Formally, we can consider the comparison of independent and joint clustering as the comparison between two different classifiers, <italic>R</italic> = <italic>f</italic>(<italic>c</italic>) and <italic>R</italic> = <italic>f</italic>(<italic>c</italic>, <italic>T</italic>), one of which classifies reward functions solely as a function of contexts and the other as a function of contexts and observed transition statistics.</p>
<p>Interestingly, this approximation leads to the conclusion that independent clustering is a simpler statistical model than joint clustering. Estimating a marginal distribution is a simpler statistical problem than estimating its composing set of conditional distributions. As such, we might expect a tradeoff where independent clustering provides better generalization with little experience whereas joint clustering provides better generalization asymptotically. We can evaluate the latter claim by noting that given random variables <italic>R</italic> and <italic>T</italic>, <italic>H</italic>(<italic>R</italic>|<italic>T</italic>) ≤ <italic>H</italic>(<italic>R</italic>). This statement implies that given a known joint distribution between two random variables, knowledge of one of the random variables cannot increase the uncertainty of the other; an agent can simply learn when there is no relation between the two, in which case the joint distribution doesn’t hurt. Intuitively, this claim is based on the notion that more information is always better (or at least, no worse) in the long run.</p>
<p>Note that this relationship is only guaranteed if the true generative process is known and as such, experience in the task domain plays an important role. As we discuss in the following section, there needs to be sufficient experience to determine whether the joint distribution is useful or not (and in fact, assuming conditional dependence when there is no such relationship can slow down learning dramatically). Nonetheless, the CRP prior will converge asymptotically on the conditional and marginal distributions, Pr(<italic>R</italic>|<italic>T</italic>) and Pr(<italic>R</italic>), for the joint and independent clustering agents, respectively. If we consider the CRP to be an estimator, we can define its bias as
<disp-formula id="pcbi.1006116.e034"><alternatives><graphic id="pcbi.1006116.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mtext>Bias</mml:mtext> <mml:mi>p</mml:mi></mml:msub> <mml:mo>[</mml:mo> <mml:mi>q</mml:mi> <mml:mo>]</mml:mo> <mml:mo>≡</mml:mo> <mml:msub><mml:mi mathvariant="double-struck">E</mml:mi> <mml:mi>p</mml:mi></mml:msub> <mml:mo>[</mml:mo> <mml:mi>q</mml:mi> <mml:mo>]</mml:mo> <mml:mo>-</mml:mo> <mml:mi>p</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>-</mml:mo> <mml:mi>α</mml:mi></mml:mrow> <mml:mrow><mml:mi>α</mml:mi> <mml:mo>+</mml:mo> <mml:msub><mml:mi>N</mml:mi> <mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(14)</label></disp-formula>
where <italic>N</italic><sub><italic>c</italic></sub> is the total number of contexts observed and <italic>α</italic> is the concentration parameter governing new clusters. Asymptotically, the CRP is unbiased as lim<sub><italic>N</italic><sub><italic>c</italic></sub>→∞</sub> Bias<sub><italic>p</italic></sub>[<italic>q</italic>] = 0 and the CRP converges to the generative distribution. As a consequence, joint clustering has lower information gain than independent clustering asymptotically as the CRP for a joint clustering agent will converge to the conditional distribution Pr(<italic>R</italic>|<italic>T</italic>) whereas the CRP for an independent clustering agent will converge to the marginal distribution Pr(<italic>R</italic>).</p>
</sec>
<sec id="sec011">
<title>Mutual information</title>
<p>As alluded to above, that joint clustering is guaranteed to produce a better estimate is only true as <italic>N</italic><sub><italic>c</italic></sub> → ∞ whereas here we are concerned with task domains in which an agent has little experience. Intuitively, we might expect independent clustering to be favorable in task domains where there is no relationship between transitions and rewards. Conversely, we might expect joint clustering to be more favorable when there is relationship between transition and rewards. While we considered two extremes of these cases in simulations 1 and 2, we can also vary the relationship parametrically. Formally, we can consider the relationship between transitions and rewards with mutual information. Let each context <italic>c</italic> be associated with a reward function <inline-formula id="pcbi.1006116.e035"><alternatives><graphic id="pcbi.1006116.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e035" xlink:type="simple"/><mml:math display="inline" id="M35"><mml:mrow><mml:mi>R</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">R</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and a transition function <inline-formula id="pcbi.1006116.e036"><alternatives><graphic id="pcbi.1006116.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e036" xlink:type="simple"/><mml:math display="inline" id="M36"><mml:mrow><mml:mi>T</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> and let Pr(<italic>R</italic>, <italic>T</italic>) be the joint distribution of <italic>R</italic> and <italic>T</italic> in unobserved contexts. The mutual information between <italic>R</italic> and <italic>T</italic> is defined
<disp-formula id="pcbi.1006116.e037"><alternatives><graphic id="pcbi.1006116.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e037" xlink:type="simple"/><mml:math display="block" id="M37"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>;</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>R</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">R</mml:mi> <mml:mo>,</mml:mo> <mml:mi>T</mml:mi> <mml:mo>∈</mml:mo> <mml:mi mathvariant="script">T</mml:mi></mml:mrow></mml:munder> <mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>,</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:msub><mml:mtext>log</mml:mtext> <mml:mn>2</mml:mn></mml:msub> <mml:mfrac><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>,</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>)</mml:mo> <mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>T</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(15)</label></disp-formula>
Mutual information represents the degree to which knowledge of either variable reduces the uncertainty (entropy) of the other, and can be used as a metric of the degree to which a task environment should be considered independent or not. As such, it satisfies 0 ≤ <italic>I</italic>(<italic>R</italic>;<italic>T</italic>) ≤ min(<italic>H</italic>(<italic>R</italic>), <italic>H</italic>(<italic>T</italic>))</p>
<p>To evaluate how mutual information affects the relative performance of independent and joint clustering, we constructed a series of task domains that allow us to monotonically increase <italic>I</italic>(<italic>R</italic>;<italic>T</italic>) by with a single parameter <italic>m</italic> while holding all else constant. We define <inline-formula id="pcbi.1006116.e038"><alternatives><graphic id="pcbi.1006116.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:mi mathvariant="script">R</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mi>A</mml:mi> <mml:mo>,</mml:mo> <mml:mi>B</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006116.e039"><alternatives><graphic id="pcbi.1006116.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:mi mathvariant="script">T</mml:mi> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and we define two sequences <italic>X</italic><sup><italic>R</italic></sup> and <italic>X</italic><sup><italic>T</italic></sup> such that <inline-formula id="pcbi.1006116.e040"><alternatives><graphic id="pcbi.1006116.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e040" xlink:type="simple"/><mml:math display="inline" id="M40"><mml:msubsup><mml:mi>X</mml:mi> <mml:mi>i</mml:mi> <mml:mi>R</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006116.e041"><alternatives><graphic id="pcbi.1006116.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:msubsup><mml:mi>X</mml:mi> <mml:mi>i</mml:mi> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are the reward and transition function for context <italic>c</italic><sub><italic>i</italic></sub>. We define the sequence <italic>X</italic><sup><italic>R</italic></sup> = <italic>A</italic><sup>(2<italic>n</italic>)</sup><italic>B</italic><sup>(2<italic>n</italic>)</sup>, where <italic>A</italic><sup>(<italic>k</italic>)</sup> refers to a <italic>k</italic> repeats of <italic>A</italic>, and the sequence <italic>X</italic><sup><italic>T</italic></sup> = 1<sup>(<italic>n</italic>+<italic>m</italic>)</sup>2<sup>(2<italic>n</italic>)</sup>1<sup>(<italic>n</italic>−<italic>m</italic>)</sup>, where 1<sup>(<italic>k</italic>)</sup> refers to <italic>k</italic> repeats of 1. To provide a concrete example, if <italic>n</italic> = 2 and <italic>m</italic> = 0, the sequence <italic>X</italic><sup><italic>R</italic></sup> = <italic>AAAABBBB</italic> and the sequence <italic>X</italic><sup><italic>T</italic></sup> = 11222211. Similarity, if <italic>n</italic> = 2 and <italic>m</italic> = 2, then the sequence <italic>X</italic><sup><italic>R</italic></sup> is unchanged while <italic>X</italic><sup><italic>T</italic></sup> is now 11112222. Critically, these sequences have the property that <italic>I</italic>(<italic>R</italic>;<italic>T</italic>) = 0 if and only if <italic>m</italic> = 0 and that <italic>I</italic>(<italic>R</italic>;<italic>T</italic>) monotonically increases with <italic>m</italic>. In other words, the residual uncertainty of <italic>R</italic> given <italic>T</italic>, <italic>H</italic>(<italic>R</italic>|<italic>T</italic>), declines as a function of <italic>m</italic>. This allows us to vary <italic>I</italic>(<italic>R</italic>;<italic>T</italic>) independently of all other factors by changing the value of <italic>m</italic>.</p>
<p>We evaluated the relative performance of the independent and joint clustering agents by using the CRP to predict the sequence <italic>X</italic><sup><italic>R</italic></sup>, either independent of <italic>X</italic><sup><italic>T</italic></sup> (modeling independent clustering), or conditionally dependent on <italic>X</italic><sup><italic>T</italic></sup> (modeling joint clustering) for values of <italic>n</italic> = 5 and <italic>m</italic> = [0, 5]. For these simulations, we first assume both sequences <italic>X</italic><sup><italic>R</italic></sup> and <italic>X</italic><sup><italic>T</italic></sup> are noiseless, but below we show that noise parametrically affects these conclusions. For low values of <italic>m</italic> (<italic>m</italic> ≤ 2), independent clustering provides a larger generalization benefit (<xref ref-type="fig" rid="pcbi.1006116.g005">Fig 5</xref>, left). This has the intuitive explanation that as the features of the domain becomes more independent, independent clustering provides better generalization. Importantly, there are cases in which independent clustering provides a better evidence even thought there is non-zero mutual information [0 &lt; <italic>I</italic>(<italic>R</italic>; <italic>T</italic>) ≲ 0.2bits].</p>
<fig id="pcbi.1006116.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006116.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Performance of independent vs. joint clustering in predicting a sequence <italic>X</italic><sup><italic>R</italic></sup>, measured in bits of information gained by observation of each item.</title>
<p><italic>Left</italic>: Relative performance of independent clustering over joint clustering as a function of mutual information between the rewards and transitions. <italic>Right</italic>: Noise in observation of <italic>X</italic><sup><italic>T</italic></sup> sequences parametrically increases advantage for independent clustering. Green line shows relative performance in sequences with no residual uncertainty in <italic>R</italic> given <italic>T</italic> (perfect correspondence), orange line shows relative performance for a sequence with residual uncertainty <italic>H</italic>(<italic>R</italic>|<italic>T</italic>) &gt; 0bits.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.g005" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec012">
<title>Noise in observation of transition functions</title>
<p>Above, we assumed that transition functions were fully observable with no uncertainty. But in many real-world scenarios, the relevant state variables are only partially observable and the transition functions may be stochastic. In this section, we therefore relax this noiseless assumption to characterize the effect of noisy observations on inference and generalization. As before, we model generalization as the degree of predictability of <inline-formula id="pcbi.1006116.e042"><alternatives><graphic id="pcbi.1006116.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> given <inline-formula id="pcbi.1006116.e043"><alternatives><graphic id="pcbi.1006116.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>:</mml:mo> <mml:mi>i</mml:mi></mml:mrow> <mml:mi>R</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> either independent of <italic>X</italic><sup><italic>T</italic></sup> (independent clustering) or conditionally on <italic>X</italic><sup><italic>T</italic></sup> (joint clustering).</p>
<p>We first construct reward and transition sequences in which knowledge of the transition function completely reduces the uncertainty about the reward function (<italic>I</italic>(<italic>R</italic>;<italic>T</italic>) = <italic>H</italic>(<italic>R</italic>), and hence <italic>H</italic>(<italic>R</italic>|<italic>T</italic>) = 0). Consider <italic>X</italic><sup><italic>R</italic></sup> = <italic>A</italic><sup>(20)</sup><italic>BCD</italic> and <italic>X</italic><sup><italic>T</italic></sup> = 1<sup>(20)</sup>234, where <italic>A</italic><sup>(20)</sup> and 1<sup>(20)</sup> refer to 20 repeats of <italic>A</italic> and 1, respectively. As such, we would expect joint clustering to produce better generalization than independent clustering if observations are noiseless. To simulate noise / partial observability, we assume each observation of <inline-formula id="pcbi.1006116.e044"><alternatives><graphic id="pcbi.1006116.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:msubsup><mml:mi>X</mml:mi> <mml:mi>i</mml:mi> <mml:mi>T</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is mis-identified as some new function <italic>T</italic>* ∉ {1, 2, 3, 4} with some probability. Importantly, this simulation has the desideratum that noise does not affect <italic>I</italic>(<italic>R</italic>;<italic>T</italic>) or <italic>H</italic>(<italic>R</italic>) themselves (the true generative functions). We compare the inference of <italic>X</italic><sup><italic>R</italic></sup> independent of <italic>X</italic><sup><italic>T</italic></sup> (modeling independent clustering) or conditionally dependent on <italic>X</italic><sup><italic>T</italic></sup> (modeling joint clustering) for various noise levels <italic>σ</italic> = [0, 1.0]. When noise is sufficiently high (<italic>σ</italic> &gt; 0.71), independent clustering produces a better estimate of <italic>X</italic><sup><italic>R</italic></sup> than joint clustering (<xref ref-type="fig" rid="pcbi.1006116.g005">Fig 5</xref>, right, green line) even for this extreme case where the two functions have perfect mutual information.</p>
<p>Next, we assessed how mutual information and noise interact by decreasing the correspondence of the sequences. As noted above, in the sequences used above (<italic>X</italic><sup><italic>R</italic></sup> = <italic>A</italic><sup>(20)</sup><italic>BCD</italic> and <italic>X</italic><sup><italic>T</italic></sup> = 1<sup>(20)</sup>234), there is no residual uncertainty of <italic>R</italic> given <italic>T</italic>. We can decrease the correspondence between the two sequences by shifting <italic>X</italic><sup><italic>T</italic></sup> by one to <inline-formula id="pcbi.1006116.e045"><alternatives><graphic id="pcbi.1006116.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mtext>new</mml:mtext></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mn>1</mml:mn> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>19</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:msup> <mml:mn>2341</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, and thus decrease the mutual information [<italic>I</italic>(<italic>X</italic><sup><italic>R</italic></sup>;<italic>X</italic><sup><italic>T</italic></sup>) ≈ 0.77; <inline-formula id="pcbi.1006116.e046"><alternatives><graphic id="pcbi.1006116.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:mi>I</mml:mi> <mml:mo>(</mml:mo> <mml:msup><mml:mi>X</mml:mi> <mml:mi>R</mml:mi></mml:msup> <mml:mo>;</mml:mo> <mml:msubsup><mml:mi>X</mml:mi> <mml:mrow><mml:mtext>new</mml:mtext></mml:mrow> <mml:mi>T</mml:mi></mml:msubsup> <mml:mo>)</mml:mo> <mml:mo>≈</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>52</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>]. As we have previously noted, this decline in mutual information reduces the benefit of joint clustering, <italic>ceteris paribus</italic>. Nonetheless, there is still a strong relationship between rewards and transition that can be leveraged by joint clustering.</p>
<p>Simulating independent and joint clustering on these new sequences as a function of <italic>σ</italic> = [0, 1.0] reveals a lower level of noise needed to see a benefit of independent clustering (<xref ref-type="fig" rid="pcbi.1006116.g005">Fig 5</xref>, right). As expected, joint clustering provides a better estimate in the no-noise case, as well as for low noise levels (<italic>σ</italic> &lt; 0.33), as it can take advantage of the shared structure, while independent clustering results in a better estimate for larger noise levels. Importantly, these effect are cumulative; in ecological settings where observations are noisy and there is only weak mutual information, independent clustering will likely provide a better estimate of the prior over rewards.</p>
</sec>
</sec>
<sec id="sec013">
<title>Meta-agent</title>
<p>Given that the optimality of each fixed strategy varies as a function of the statistics of the task domain, a natural question is whether a single agent could optimize its choice of strategy effectively by somehow tracking those statistics. In other words, can an agent infer whether the overall statistics are more indicative of a joint or independent structure and capitalize accordingly? Here, we address this question by implementing a meta-agent that infers the correct policy across the two strategies (below we also consider a simple model-free RL heuristic for arbitrating between agents, which produces qualitatively similar results).</p>
<p>For any given fixed strategy, the optimal policy maximizes the expected discounted future rewards and is defined by <xref ref-type="disp-formula" rid="pcbi.1006116.e008">Eq 1</xref>. Let <inline-formula id="pcbi.1006116.e047"><alternatives><graphic id="pcbi.1006116.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:msubsup><mml:mi>π</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> be the optimal policy for model <italic>m</italic>. We are interested in whether <inline-formula id="pcbi.1006116.e048"><alternatives><graphic id="pcbi.1006116.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msubsup><mml:mi>π</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> is the global optimal policy <italic>π</italic>*, which we can define probabilistically as
<disp-formula id="pcbi.1006116.e049"><alternatives><graphic id="pcbi.1006116.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e049" xlink:type="simple"/><mml:math display="block" id="M49"><mml:mtext>Pr</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>π</mml:mi><mml:mi>m</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mo>*</mml:mo></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:msubsup><mml:mi>π</mml:mi><mml:mi>m</mml:mi><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>π</mml:mi><mml:mo>*</mml:mo></mml:msub><mml:mo>|</mml:mo><mml:mi>m</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext>Pr</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mi>m</mml:mi><mml:mo>|</mml:mo><mml:mi mathvariant="script">D</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:math></alternatives> <label>(16)</label></disp-formula>
<disp-formula id="pcbi.1006116.e050"><alternatives><graphic id="pcbi.1006116.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e050" xlink:type="simple"/><mml:math display="block" id="M50"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd/><mml:mtd><mml:mrow><mml:mo>=</mml:mo> <mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(17)</label></disp-formula>
where <inline-formula id="pcbi.1006116.e051"><alternatives><graphic id="pcbi.1006116.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the Bayesian model evidence and where <inline-formula id="pcbi.1006116.e052"><alternatives><graphic id="pcbi.1006116.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>π</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mo>*</mml:mo></mml:msubsup> <mml:mo>=</mml:mo> <mml:msub><mml:mi>π</mml:mi> <mml:mo>*</mml:mo></mml:msub> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo> <mml:mo>≡</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. The Bayesian model evidence is, as usual,
<disp-formula id="pcbi.1006116.e053"><alternatives><graphic id="pcbi.1006116.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>Z</mml:mi></mml:mfrac> <mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(18)</label></disp-formula>
where <inline-formula id="pcbi.1006116.e054"><alternatives><graphic id="pcbi.1006116.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the likelihood of observations under the model, Pr(<italic>m</italic>) is the prior over models and Z is the normalizing constant. The likelihood function for the independent and joint clustering models is the product of the mapping and reward functions (as defined conditionally for a cluster in Eqs <xref ref-type="disp-formula" rid="pcbi.1006116.e015">6</xref>, <xref ref-type="disp-formula" rid="pcbi.1006116.e016">7</xref> and <xref ref-type="disp-formula" rid="pcbi.1006116.e017">8</xref>). However, estimates of the mapping function is highly similar for both models (Figs <xref ref-type="fig" rid="pcbi.1006116.g002">2C</xref> and <xref ref-type="fig" rid="pcbi.1006116.g003">3C</xref>). Thus, as a simplifying assumption, we can approximate the model evidence with how well each model predicts reward:
<disp-formula id="pcbi.1006116.e055"><alternatives><graphic id="pcbi.1006116.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≈</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>Z</mml:mi></mml:mfrac> <mml:mo>(</mml:mo> <mml:munderover><mml:mo>∏</mml:mo> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>∞</mml:mi></mml:munderover> <mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(19)</label></disp-formula>
where <italic>r</italic><sub><italic>t</italic></sub> is the reward collected at time <italic>t</italic>. Independent and joint clustering can be interpreted as special cases of this meta-learning agent with the strong prior Pr(<italic>m</italic>) = 1. Under a uniform prior over the models, this strategy reduces to choosing the agent based on how well it predicts reward, an approach repeatedly used in meta-learning agents [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref023">23</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref024">24</xref>].</p>
<p>We simulated the meta-learning agent with a uniform prior over the two models and used Thompson sampling [<xref ref-type="bibr" rid="pcbi.1006116.ref025">25</xref>] to sample a policy from joint and independent clustering at the beginning of each trial (<xref ref-type="fig" rid="pcbi.1006116.g006">Fig 6A</xref>). In the first task domain, where independent clustering results in better performance than joint clustering, the performance of the meta-agent more closely matched the performance of the independent clustering agent (<xref ref-type="fig" rid="pcbi.1006116.g006">Fig 6B</xref>). The meta-agent completed the task in an average of 235.2 (s = 35.3) steps compared to 205.2 (s = 20.2) and 267.5 (s = 22.4) steps for the independent and joint clustering agents. In addition, the meta-agent became more likely to choose the policy of the independent clustering agent over time (<xref ref-type="fig" rid="pcbi.1006116.g006">Fig 6D</xref>). In the second task domain, where joint clustering outperformed independent clustering, the meta-agent completed the task in an average of 417.5 (s = 42.0) steps compared to an average of 384.2 (s = 21.2) and 441.6 (s = 35.9) steps for the joint and independent clustering agents, respectively. Likewise, overtime the meta-agent was more likely to choose the policy of the joint clustering agent (<xref ref-type="fig" rid="pcbi.1006116.g006">Fig 6E</xref>).</p>
<fig id="pcbi.1006116.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006116.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Meta-agent.</title>
<p><italic>A</italic>: On each trial, the meta-agent samples the policy of joint or independent actor based on model evidence for each strategy. Both agents, and their model evidences, are updated at each time step. <italic>B</italic>: Overall performance of independent, joint and meta agents on simulation 1 <italic>C</italic>: Overall performance of independent, joint and meta agents on simulation 2 <italic>D,E</italic>: Probability of the selecting the policy joint clustering over time in simulation 1 (<italic>D</italic>) and simulation 2 (<italic>E</italic>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.g006" xlink:type="simple"/>
</fig>
<p>A computationally simple approximation to estimating the model responsibilities is to select agents as a function of their estimated value. In this approximation, a reward prediction error learning rule estimates the value for each model, <italic>Q</italic><sub><italic>m</italic></sub>, according to the updating rule:
<disp-formula id="pcbi.1006116.e056"><alternatives><graphic id="pcbi.1006116.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>Q</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>←</mml:mo> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:mi>η</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>t</mml:mi></mml:msub> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(20)</label></disp-formula>
where <italic>η</italic> is a learning rate and <inline-formula id="pcbi.1006116.e057"><alternatives><graphic id="pcbi.1006116.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e057" xlink:type="simple"/><mml:math display="inline" id="M57"><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>t</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> is the reward predicted by the model at time <italic>t</italic>. These values can be used to sample the models via a softmax decision rule
<disp-formula id="pcbi.1006116.e058"><alternatives><graphic id="pcbi.1006116.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>m</mml:mi> <mml:mo>∼</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mi>Z</mml:mi></mml:mfrac> <mml:mtext>exp</mml:mtext> <mml:mrow><mml:mo>{</mml:mo> <mml:mi>β</mml:mi> <mml:msub><mml:mi>Q</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(21)</label></disp-formula>
Simulation with this arbitration strategy with the parameter values <italic>β</italic> = 5.0, <italic>η</italic> = 0.2 led to a qualitatively similar pattern of results. Performance in both simulations 1 and 2 were not distinguishable from the Bayesian meta agent, with the agent completing simulation 1 in 237.2 (s = 41.2) steps as compared to the 235.2 (s = 35.3) found for the Bayesian implementation (<italic>p</italic> &lt; 0.65) and completing simulation 2 in 418.7 (s = 45.9) steps as compared to 417.5 (s = 42.0) steps for the Bayesian agent (<italic>p</italic> &lt; .81).</p>
<p>Thus, while for both inference and RL versions, the meta-agent did not equal the performance of the best agent in either environment, it outperformed the worse of the two agents in both environments. Normatively, this is a useful property if an agent cares about minimizing the worst possible outcome across unknown task domains (as opposed to maximizing their performance within a single domain), similar to a minimax decision rule in decision theory [<xref ref-type="bibr" rid="pcbi.1006116.ref026">26</xref>]. This can be advantageous if agent has little information about the distribution of task domains and if the costs of choosing the wrong strategy are large as in the ‘diabolical rooms’ problem. Furthermore, while we have used a uniform prior over the two strategies, varying the prior may result in a better strategy for a given set of task domains.</p>
<p>In our information theoretic analysis above, we showed that the task statistics determines the normative strategy depending on which agent is more efficacious in reducing Bayesian surprise about reward. The meta-learning agent capitalizes on this same intuition by using predicted rewards to arbitrate among strategies. More specifically, we argued that the normative value of each strategy varies with mutual information between rewards and mappings. Thus, we assessed whether the the meta-learning agent is also sensitive to mutual information, without calculating it directly, and hence be more likely to choose joint clustering when the mutual information is higher.</p>
<p>In simulations 1 and 2 above, we calculated the mutual information each time a new context was added and used this to predict the probability of selecting the joint agent at the end of that trial. Specifically, we define
<disp-formula id="pcbi.1006116.e059"><alternatives><graphic id="pcbi.1006116.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e059" xlink:type="simple"/><mml:math display="block" id="M59"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>I</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>;</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>-</mml:mo> <mml:mi>H</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>Pr</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(22)</label></disp-formula>
where <inline-formula id="pcbi.1006116.e060"><alternatives><graphic id="pcbi.1006116.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is the probability each location is rewarded across all contexts seen so far and <inline-formula id="pcbi.1006116.e061"><alternatives><graphic id="pcbi.1006116.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:mrow><mml:mtext>Pr</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>|</mml:mo> <mml:mi>ϕ</mml:mi> <mml:mo>=</mml:mo> <mml:msub><mml:mi>ϕ</mml:mi> <mml:mi>k</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is conditioned on the current mapping. Using logistic regression, we find that <inline-formula id="pcbi.1006116.e062"><alternatives><graphic id="pcbi.1006116.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006116.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:mrow><mml:mi>I</mml:mi> <mml:mo>(</mml:mo> <mml:mi>R</mml:mi> <mml:mo>;</mml:mo> <mml:mo>Φ</mml:mo> <mml:mo>|</mml:mo> <mml:mi mathvariant="script">D</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> positively correlates with the probability of selecting the joint agent across both simulations, consistent with expectations [Simulation 1: <italic>β</italic> = 3.3, <italic>p</italic> &lt; 0.003; Simulation 2: <italic>β</italic> = 9.4, <italic>p</italic> &lt; 5 × 10<sup>−41</sup>].</p>
</sec>
</sec>
<sec id="sec014" sec-type="conclusions">
<title>Discussion</title>
<p>In this paper, we provide two alternative models of context-based clustering for the purpose of generalization, a <italic>joint clustering</italic> agent generalizes reward and transition functions together and an <italic>independent clustering</italic> agent that separately generalizes reward and transition functions. These models are motivated by human learning and performance, which is thought to be structured and compositional [<xref ref-type="bibr" rid="pcbi.1006116.ref027">27</xref>–<xref ref-type="bibr" rid="pcbi.1006116.ref029">29</xref>].</p>
<p>Generalization can be seen as a solution to a dimensionality problem. In real-world problems, perceptual space is typically high-dimensional. In order to learn a policy, agents need to learn a mapping between the high-dimensional perceptual space and the effector space. Learning this mapping can require a large set of training data, perhaps much larger than a human would have access to [<xref ref-type="bibr" rid="pcbi.1006116.ref012">12</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref021">21</xref>]. Clustering can reduce the dimensionality by projecting the perceptual space onto a lower dimensional latent space in which multiple percepts share the same latent representation. Thus, an agent does not need to learn a policy over the full state space but over the lower dimensional latent space. This is an explicit assumption of the models presented here as well as in other clustering models of human generalization, allowing agents to collapse across irrelevant features and preventing interference between stimulus-response mappings across latent distinct rules [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref023">23</xref>]. Related principles have been explored in lifelong learning [<xref ref-type="bibr" rid="pcbi.1006116.ref006">6</xref>–<xref ref-type="bibr" rid="pcbi.1006116.ref008">8</xref>], object-based, and symbol-based approaches [<xref ref-type="bibr" rid="pcbi.1006116.ref011">11</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref030">30</xref>–<xref ref-type="bibr" rid="pcbi.1006116.ref033">33</xref>].</p>
<p>Incorporating compositionality takes this argument further, as multiple policies often share component features. For example, playing the saxophone involves the use of the same movements to produce the same notes for different effect in different songs. Learning a policy as a direct mapping from the low level effector space to reward values fails to take advantage of the structure, even if that policy can be reused as a whole with another instrument. Thus, learning at the component level as opposed to the policy level reduces a high-dimensional problem into multiple lower-dimensional problems. While this adds the additional complexity of the choice of a good set of component features, here we argue the Markov decision process provides a natural decomposition into reward and transition functions. Importantly, this decomposition of the task structure is not equivalent to a decomposition of the policy, which is itself dependent on the joint reward and transition functions. Of course, other decompositions are also possible and useful (and not mutually exclusive). For example, the state-outcome and action-dependent state transition functions of the active inference framework can both be decomposed into “what” and “where” aspects [<xref ref-type="bibr" rid="pcbi.1006116.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref035">35</xref>]. While these functions, analogous to reward and transition functions, are linked by a shared latent state representation, this decomposition facilitate generalization across states that share features.</p>
<p>Regardless of the choice of component features, a compositional generalization model needs to make assumptions about the relationship between components. We argue here that the proper choice depends on the generative structure, which as an empirical matter, is largely unknown for the ecological environments faced by humans and artificial agents. As we demonstrated in the grid-world simulations above, when there is a strong relationship between components, an agent that assumes as much outperforms an agent that assumes no relationship, and vice-versa (Figs <xref ref-type="fig" rid="pcbi.1006116.g002">2</xref> and <xref ref-type="fig" rid="pcbi.1006116.g003">3</xref>). With sufficient (and stationary) experience, we might expect a model that assumes a learnable relationship between components (joint clustering) to perform better in new contexts, since assuming a potential relationship between goals and mappings can be no worse asymptotically than assuming independence (i.e., the agent can simply learn that the correlation is zero). Nonetheless, how much experience is sufficient for joint clustering to provide a better model is difficult to define in general, and will depend on the statistics of the relationships and the combinatorial explosion of the state space that arises. Furthermore, noise or partial observability further complicates the picture: even when there is exploitable mutual information, independent clustering can yield a better estimate when experience is limited (<xref ref-type="fig" rid="pcbi.1006116.g005">Fig 5</xref>).</p>
<p>Why is this the case? It may appear puzzling given the asymptotic assurances that joint clustering will be no worse in stationary environments. Here, the comparison between classification and generalization is instructive. We can think of joint clustering in terms of estimating a joint distribution of the generative process and independent clustering in terms of estimating the marginal distribution for each component independently (similar to a naïve Bayes classifier). In this interpretation, independent clustering trades off an asymptotically worse estimate of the generative process for lower variance, with a bias equal to the mutual information between mappings and goals. In problems with limited experience, such as the type presented here, a biased classifier will often perform better than an asymptotically more accurate estimator because misclassification risk is more sensitive to variance than bias [<xref ref-type="bibr" rid="pcbi.1006116.ref036">36</xref>]. Thus, by ignoring the correlation structure and increasing the bias to generalize goals that are most popular overall, independent clustering may minimize its overall loss.</p>
<p>Intuitively, we can think of joint clustering as being potentially overly sensitive to noise. While over infinite time it is always better to estimate the correlations between components, in practice it may not be worth the cost of doing so. This happens when the correlations between transitions and rewards is weak or difficult to determine. For a human learner, an example might be the relationship between how hungry a person is and how heavy it is to carry a plate of food from a buffet. Learning this relationship is guaranteed to be asymptotically better than ignoring it but given the triviality of the benefit and the frequency of the context, it probably isn’t worth the exploration cost.</p>
<p>Previous models of compositional generalization have attempted to decompose the space of policies, rather than task structure, in to reusable pieces that can be re-executed [<xref ref-type="bibr" rid="pcbi.1006116.ref034">34</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref037">37</xref>]. Because learned policies depend on both the reward and transition functions of a specific task, this decomposition implicitly generalizes these two sources of information together, and thus does not address the set of issues considered here (i.e., when the transition function is independent of the reward function across contexts). The same issue applies to the options framework and other hierarchical task representations [<xref ref-type="bibr" rid="pcbi.1006116.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref032">32</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref038">38</xref>–<xref ref-type="bibr" rid="pcbi.1006116.ref040">40</xref>]. As a consequence, reusing policy components will cause the agent to explore regions of the state space that have had high reward value in other contexts, which as we have shown may or may not be an adaptive strategy. For example, successful generalization in the “diabolical rooms” problem presented here, and the “finger sailing” task presented by Fermin and colleagues [<xref ref-type="bibr" rid="pcbi.1006116.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref015">15</xref>], requires a separation of reward from movement statistics. Indeed, the generalization of policy-dependent successor state representations works well only under small deviations of the reward or transition function [<xref ref-type="bibr" rid="pcbi.1006116.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref039">39</xref>]. Thus, the choice of components should be influenced by the robustness to changes in the reward and transition function, which will not necessarily linked to an individual policy.</p>
<p>From the perspective of human cognition, compositional representation provides the flexibility to create novel policies in a novel domains in a rule-governed manner. This flexibility, also known as <italic>systematicity</italic> or <italic>generativity</italic>, has long been thought to be a key feature of cognition [<xref ref-type="bibr" rid="pcbi.1006116.ref029">29</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref041">41</xref>]. As Lake and colleagues note, a person can re-use the learned knowledge of the structure of a task to accomplish an arbitrary number of goals, such as winning a specific number of points in a video game [<xref ref-type="bibr" rid="pcbi.1006116.ref012">12</xref>]. Strongly linking component properties may impede the potential for systematicity by limiting the flexibility to recombine knowledge. As we have argued above, recombining reward and transition information may be particularly valuable, such that agents that can only generalize policies and reward-sensitive policy components may lack systematicity.</p>
<p>An altogether different possibility is that a mix of strategies is appropriate. While we argue that independent clustering is a simpler statistical problem than joint clustering, there are clearly cases where joint clustering is advantageous. As noted before, generalization of successor-state representation partially links transitions and rewards and is nonetheless sufficiently flexible to handle small deviations in policy [<xref ref-type="bibr" rid="pcbi.1006116.ref010">10</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref039">39</xref>]. Furthermore, joint clustering support simpler algorithms, such as the form of temporal difference learning algorithms thought to underlie human fronto-striatal learning [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref042">42</xref>] as well as the proposed successor state representations recently proposed to underlie hippocampal-based planning [<xref ref-type="bibr" rid="pcbi.1006116.ref038">38</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref043">43</xref>]. As we have suggested with the meta-learning agent, trading off between joint and independent clustering can reduce the risk of the decision problem.</p>
<p>Furthermore, it is not known what a human learner would typically consider to constitute a higher order context variable separate from lower order state variables [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref042">42</xref>]. Ecologically, the number of contexts a human could potentially encounter is quite high, in which case they would be able to form a more accurate estimate of the correlation structure between components over time. If this speculation is true, then one potential adaptive strategy would be to assume a weak relationship between components early in learning and increasingly relying on the correlation structure as the evidence supports it.</p>
<p>Thus, a hybrid system is supported by both computational and algorithmic considerations. From the perspective of biological implementation, the inference required for context-clustering based generalization can be approximated by a hierarchical cortico-basal ganglia learning system [<xref ref-type="bibr" rid="pcbi.1006116.ref003">3</xref>]. This framework could be extended to account for independent clustering by allowing for multiple cortical clusters separately representing reward and mapping functions, each of which is learnable by a neural network model [<xref ref-type="bibr" rid="pcbi.1006116.ref044">44</xref>]. Because joint clustering results in the same policy generalized to each context in a cluster, joint clustering does not require separately estimating the reward and transition functions and instead learned policies (such as stimulus-action values) can be generalized directly. This can obviate planning, a challenge for any biological model of any model-based control. Nonetheless, multiple lines of research suggest humans engage in model-based control [<xref ref-type="bibr" rid="pcbi.1006116.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref039">39</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref045">45</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref046">46</xref>] and human subjects can re-use arbitrary action-movement mappings (highly similar to the ones proposed here) for model-based control, suggesting a compositional representation potentially mediated by the dorsolateral prefrontal cortex, dorsomedial striatum and cerebellum [<xref ref-type="bibr" rid="pcbi.1006116.ref014">14</xref>, <xref ref-type="bibr" rid="pcbi.1006116.ref015">15</xref>].</p>
<p>Finally, while we have presented independent clustering as motivated by human capabilities for generalization, the question of whether human learning is better accounted for by independent or joint clustering, or a mixture of the two, remains an open question. While models are a generalization of previous models used to account for human behavior [<xref ref-type="bibr" rid="pcbi.1006116.ref002">2</xref>–<xref ref-type="bibr" rid="pcbi.1006116.ref004">4</xref>], they make separate testable predictions for human behavior. Joint clustering predicts that in a generalization task, human subjects will use transition formation to infer the location of an unknown goal. Independent clustering, in contrast, predicts human subjects will ignore transition information when searching for goals, and ignore goals when inferring the transition function. By providing humans subjects an initial set of contexts where the popularity of reward function varies across contexts as a function of the mapping, a novel set of test contexts can be chosen to differentiate the model predictions. Future work will address these predictions and the underlying brain mechanisms.</p>
</sec>
<sec id="sec015">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006116.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.s001" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title/>
<p><italic>A</italic>. Agents’ performance learning full transition function in Simulation 1. <italic>A</italic>, <italic>Left</italic>: Cumulative number of steps taken by each model as a function of trials. Fewer steps represents better performance. <italic>A</italic>, <italic>Right</italic>: Distribution of total number of steps required to complete the task for each agent. <italic>B</italic>. Agents’ performance function in Simulation 2.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006116.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.s002" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Performance of the CRP as a function of task domain structure.</title>
<p><italic>Left</italic>: Relative information gain of a naïve guess over the CRP as function of sequence entropy for a CRP with an optimized alpha parameter (green) or fixed at <italic>α</italic> = 1.0. <italic>Right</italic>: Optimized alpha value (log scale) as a function of sequence entropy.</p>
<p>(TIF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006116.s003" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.s003" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Grid world simulations with unknown transition functions.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006116.s004" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006116.s004" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>CRP performance as a function of task structure.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="pcbi.1006116.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marcus</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Marblestone</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Dean</surname> <given-names>T</given-names></name>. <article-title>The atoms of neural computation</article-title>. <source>Science</source>. <year>2014</year> <month>Oct</month> <day>31</day>;<volume>346</volume>(<issue>6209</issue>):<fpage>551</fpage>–<lpage>2</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1261661" xlink:type="simple">10.1126/science.1261661</ext-link></comment> <object-id pub-id-type="pmid">25359953</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Blei</surname> <given-names>DM</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>. <article-title>Context, learning, and extinction</article-title>. <source>Psychological review</source>. <year>2010</year> <month>Jan</month>;<volume>117</volume>(<issue>1</issue>):<fpage>197</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/a0017808" xlink:type="simple">10.1037/a0017808</ext-link></comment> <object-id pub-id-type="pmid">20063968</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Collins</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>. <article-title>Cognitive control over learning: creating, clustering, and generalizing task-set structure</article-title>. <source>Psychological review</source>. <year>2013</year> <month>Jan</month>;<volume>120</volume>(<issue>1</issue>):<fpage>190</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/a0030852" xlink:type="simple">10.1037/a0030852</ext-link></comment> <object-id pub-id-type="pmid">23356780</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Collins</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>. <article-title>Neural signature of hierarchically structured expectations predicts clustering and transfer of rule sets in reinforcement learning</article-title>. <source>Cognition</source>. <year>2016</year> <month>Jul</month> <day>31</day>;<volume>152</volume>:<fpage>160</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cognition.2016.04.002" xlink:type="simple">10.1016/j.cognition.2016.04.002</ext-link></comment> <object-id pub-id-type="pmid">27082659</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Collins</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Cavanagh</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>. <article-title>Human EEG uncovers latent generalizable rule structure during learning</article-title>. <source>Journal of Neuroscience</source>. <year>2014</year> <month>Mar</month> <day>26</day>;<volume>34</volume>(<issue>13</issue>):<fpage>4677</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3900-13.2014" xlink:type="simple">10.1523/JNEUROSCI.3900-13.2014</ext-link></comment> <object-id pub-id-type="pmid">24672013</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosman</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Hawasly</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ramamoorthy</surname> <given-names>S</given-names></name>. <article-title>Bayesian policy reuse</article-title>. <source>Machine Learning</source>. <year>2016</year> <month>Jul</month> <day>1</day>;<volume>104</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>127</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s10994-016-5547-y" xlink:type="simple">10.1007/s10994-016-5547-y</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref007">
<label>7</label>
<mixed-citation publication-type="other" xlink:type="simple">Mahmud MM, Hawasly M, Rosman B, Ramamoorthy S. Clustering markov decision processes for continual transfer. arXiv preprint arXiv:1311.3959. 2013 Nov 15.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref008">
<label>8</label>
<mixed-citation publication-type="other" xlink:type="simple">Wilson A, Fern A, Tadepalli P. Transfer learning in sequential decision problems: A hierarchical bayesian approach. In Proceedings of ICML Workshop on Unsupervised and Transfer Learning 2012 Jun 27 (pp. 217-227).</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref009">
<label>9</label>
<mixed-citation publication-type="other" xlink:type="simple">Leffler BR, Littman ML, Edmunds T. Efficient reinforcement learning with relocatable action models. In AAAI 2007 Jul 22 (Vol. 7, pp. 572-577).</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref010">
<label>10</label>
<mixed-citation publication-type="other" xlink:type="simple">Lehnert L, Tellex S, Littman ML. Advantages and Limitations of using Successor Features for Transfer in Reinforcement Learning. arXiv preprint arXiv:1708.00102. 2017 Jul 31.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref011">
<label>11</label>
<mixed-citation publication-type="other" xlink:type="simple">Kansky K, Silver T, Mély DA, Eldawy M, Lázaro-Gredilla M, Lou X, Dorfman N, Sidor S, Phoenix S, George D. Schema Networks: Zero-shot Transfer with a Generative Causal Model of Intuitive Physics. arXiv preprint arXiv:1706.04317. 2017 Jun 14.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lake</surname> <given-names>BM</given-names></name>, <name name-style="western"><surname>Ullman</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>. <article-title>Building machines that learn and think like people</article-title>. <source>Behavioral and Brain Sciences</source>. <year>2016</year> <month>Nov</month>:<fpage>1</fpage>–<lpage>01</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref013">
<label>13</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>James</surname> <given-names>W</given-names></name>. <source>The principles of psychology</source> (<volume>Vol. 1</volume>). <publisher-loc>New York</publisher-loc>: <publisher-name>Holt</publisher-name>. <year>1890</year>;<fpage>474</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fermin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Yoshida</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Ito</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yoshimoto</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>. <article-title>Evidence for model-based action planning in a sequential finger movement task</article-title>. <source>J Mot Behav</source>. <year>2010</year>;<volume>42</volume>(<issue>6</issue>):<fpage>371</fpage>–<lpage>9</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1080/00222895.2010.526467" xlink:type="simple">10.1080/00222895.2010.526467</ext-link></comment> <object-id pub-id-type="pmid">21184355</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fermin</surname> <given-names>ASR</given-names></name>, <name name-style="western"><surname>Yoshida</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Yoshimoto</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Ito</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Tanaka</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>. <article-title>Model-based action planning involves cortico-cerebellar and basal ganglia networks</article-title>. <source>Sci Rep</source>. <year>2016</year>;<volume>6</volume>(<issue>July</issue>):<fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kaelbling</surname> <given-names>LP</given-names></name>, <name name-style="western"><surname>Littman</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>AW</given-names></name>. <article-title>Reinforcement learning: A survey</article-title>. <source>Journal of artificial intelligence research</source>. <year>1996</year>;<volume>4</volume>:<fpage>237</fpage>–<lpage>85</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sanborn</surname> <given-names>AN</given-names></name>, <name name-style="western"><surname>Griffiths</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Navarro</surname> <given-names>DJ</given-names></name>. <article-title>Rational approximations to rational models: alternative algorithms for category learning</article-title>. <source>Psychological review</source>. <year>2010</year> <month>Oct</month>;<volume>117</volume>(<issue>4</issue>):<fpage>1144</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1037/a0020511" xlink:type="simple">10.1037/a0020511</ext-link></comment> <object-id pub-id-type="pmid">21038975</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shafto</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Kemp</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Mansinghka</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>. <article-title>A probabilistic model of cross-categorization</article-title>. <source>Cognition</source>. <year>2011</year> <month>Jul</month> <day>31</day>;<volume>120</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>25</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cognition.2011.02.010" xlink:type="simple">10.1016/j.cognition.2011.02.010</ext-link></comment> <object-id pub-id-type="pmid">21377146</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref019">
<label>19</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Aldous</surname> <given-names>DJ</given-names></name>. <chapter-title>Exchangeability and related topics</chapter-title>. In <source>École d’Été de Probabilités de Saint-Flour XIII—1983</source> <year>1985</year> (pp. <fpage>1</fpage>–<lpage>198</lpage>). <publisher-name>Springer</publisher-name>, <publisher-loc>Berlin, Heidelberg</publisher-loc>.</mixed-citation></ref>
<ref id="pcbi.1006116.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sutton</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Precup</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Singh</surname> <given-names>S</given-names></name>. <article-title>Between MDPs and semi-MDPs: A framework for temporal abstraction in reinforcement learning</article-title>. <source>Artificial intelligence</source>. <year>1999</year> <month>Aug</month> <day>1</day>;<volume>112</volume>(<issue>1-2</issue>):<fpage>181</fpage>–<lpage>211</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0004-3702(99)00052-1" xlink:type="simple">10.1016/S0004-3702(99)00052-1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AC</given-names></name>. <article-title>Hierarchically organized behavior and its neural foundations: a reinforcement learning perspective</article-title>. <source>Cognition</source>. <year>2009</year> <month>Dec</month> <day>31</day>;<volume>113</volume>(<issue>3</issue>):<fpage>262</fpage>–<lpage>80</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cognition.2008.08.011" xlink:type="simple">10.1016/j.cognition.2008.08.011</ext-link></comment> <object-id pub-id-type="pmid">18926527</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref022">
<label>22</label>
<mixed-citation publication-type="other" xlink:type="simple">Sanborn AN, Griffiths TL, Navarro DJ. A More Rational Model of Categorization. Proc 28th Annu Conf Cogn Sci Soc. 2006;1–6.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref023">
<label>23</label>
<mixed-citation publication-type="other" xlink:type="simple">Frank MJ, Badre D. Mechanisms of hierarchical reinforcement learning in corticostriatal circuits 1: computational analysis. Cereb Cortex 2012 Mar</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Doya</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Samejima</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Katagiri</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Kawato</surname> <given-names>M</given-names></name>. <article-title>Multiple model-based reinforcement learning</article-title>. <source>Neural Comput</source>. <year>2002</year> <month>Jun</month>;<volume>14</volume>(<issue>6</issue>):<fpage>1347</fpage>–<lpage>69</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1162/089976602753712972" xlink:type="simple">10.1162/089976602753712972</ext-link></comment> <object-id pub-id-type="pmid">12020450</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thompson</surname> <given-names>WR</given-names></name>. <article-title>On the likelihood that one unknown probability exceeds another in view of the evidence of two samples</article-title>. <source>Biometrika</source>. <year>1933</year> <month>Dec</month> <day>1</day>;<volume>25</volume>(<issue>3/4</issue>):<fpage>285</fpage>–<lpage>94</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.2307/2332286" xlink:type="simple">10.2307/2332286</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref026">
<label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Berger</surname> <given-names>JO</given-names></name>. <source>Statistical decision theory and Bayesian analysis</source>. <edition>2nd ed</edition>. <publisher-loc>New York, NY</publisher-loc>: <publisher-name>Springer-Verlag</publisher-name>; <year>1985</year>.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Griffiths</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Chater</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Kemp</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Perfors</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tenenbaum</surname> <given-names>JB</given-names></name>. <article-title>Probabilistic models of cognition: exploring representations and inductive biases</article-title>. <source>Trends Cogn Sci</source>. <year>2010</year>;<volume>14</volume>(<issue>8</issue>):<fpage>357</fpage>–<lpage>64</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tics.2010.05.004" xlink:type="simple">10.1016/j.tics.2010.05.004</ext-link></comment> <object-id pub-id-type="pmid">20576465</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reverberi</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Görgen</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Haynes</surname> <given-names>J-D</given-names></name>. <article-title>Compositionality of Rule Representations in Human Prefrontal Cortex</article-title>. <source>Cereb Cortex</source>. <year>2012</year>;<volume>22</volume>(<issue>6</issue>):<fpage>1237</fpage>–<lpage>46</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/cercor/bhr200" xlink:type="simple">10.1093/cercor/bhr200</ext-link></comment> <object-id pub-id-type="pmid">21817092</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kriete</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Noelle</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Cohen</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>O’Reilly</surname> <given-names>RC</given-names></name>. <article-title>Indirection and symbol-like processing in the prefrontal cortex and basal ganglia</article-title>. <source>Proc Natl Acad Sci</source>. <year>2013</year>;<volume>110</volume>(<issue>41</issue>):<fpage>16390</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1303547110" xlink:type="simple">10.1073/pnas.1303547110</ext-link></comment> <object-id pub-id-type="pmid">24062434</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref030">
<label>30</label>
<mixed-citation publication-type="other" xlink:type="simple">Diuk C, Cohen A, Littman ML. An object-oriented representation for efficient reinforcement learning. InProceedings of the 25th international conference on Machine learning 2008 Jul 5 (pp. 240-247). ACM.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Konidaris</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>A</given-names></name>. <article-title>Building portable options: Skill transfer in reinforcement learning</article-title>. <source>IJCAI Int Jt Conf Artif Intell</source>. <year>2007</year>;<fpage>895</fpage>–<lpage>900</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref032">
<label>32</label>
<mixed-citation publication-type="other" xlink:type="simple">Konidaris G. Constructing Abstraction Hierarchies Using a Skill-Symbol Loop. In: IJCAI International Joint Conference on Artificial Intelligence. 2016. p. 1648–1654.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Solway</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Diuk</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Córdova</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Yee</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Optimal Behavioral Hierarchy</article-title>. <source>PLoS Comput Biol [Internet]</source>. <year>2014</year>;<volume>10</volume>(<issue>8</issue>):<fpage>e1003779</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1003779" xlink:type="simple">10.1371/journal.pcbi.1003779</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mirza</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <article-title>Scene Construction, Visual Foraging, and Active Inference</article-title>. <source>Front Comput Neurosci</source>. <year>2016</year> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fncom.2016.00056" xlink:type="simple">10.3389/fncom.2016.00056</ext-link></comment> <object-id pub-id-type="pmid">27378899</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mirza</surname> <given-names>MB</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>RA</given-names></name>, <name name-style="western"><surname>Mathys</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Friston</surname> <given-names>KJ</given-names></name>. <article-title>Human visual exploration reduces uncertainty about the sensed world</article-title>. <source>PloS one</source>. <year>2018</year> <month>Jan</month> <day>5</day>;<volume>13</volume>(<issue>1</issue>):<fpage>e0190429</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0190429" xlink:type="simple">10.1371/journal.pone.0190429</ext-link></comment> <object-id pub-id-type="pmid">29304087</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friedman</surname> <given-names>JH</given-names></name>. <article-title>On Bias, Variance, 0 / 1—Loss, and the Curse-of-Dimensionality</article-title>. <source>Data Min Knowl Discov</source>. <year>1997</year>;<volume>77</volume>:<fpage>55</fpage>–<lpage>6</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1023/A:1009778005914" xlink:type="simple">10.1023/A:1009778005914</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref037">
<label>37</label>
<mixed-citation publication-type="other" xlink:type="simple">Wingate D, Diuk C, Donnell TO, Tenenbaum JB, Gershman S, Labs L, et al. Compositional Policy Priors Compositional Policy Priors. 2013</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Russek</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Momennejad</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>. <article-title>Predictive representations can link model—based reinforcement learning to model—free mechanisms</article-title>. <source>PLoS Computational Biology</source>. <year>2017</year>. <fpage>1</fpage>–<lpage>35</lpage> p.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Momennejad</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Russek</surname> <given-names>EM</given-names></name>, <name name-style="western"><surname>Cheong</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>. <article-title>The successor representation in human reinforcement learning</article-title>. <source>Nature Human Behaviour</source>. <year>2017</year> <month>Sep</month>;<volume>1</volume>(<issue>9</issue>):<fpage>680</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41562-017-0180-8" xlink:type="simple">10.1038/s41562-017-0180-8</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref040">
<label>40</label>
<mixed-citation publication-type="other" xlink:type="simple">Machado MC, Bellemare MG, Bowling M. A Laplacian Framework for Option Discovery in Reinforcement Learning. arXiv preprint arXiv:1703.00956. 2017 Mar 2.</mixed-citation>
</ref>
<ref id="pcbi.1006116.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fodor</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Pylyshyn</surname> <given-names>Z</given-names></name>. <article-title>Connectionism and cognitive architecture: A critical analysis</article-title>. <source>Cognition</source>. <year>1988</year> <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/0010-0277(88)90031-5" xlink:type="simple">10.1016/0010-0277(88)90031-5</ext-link></comment> <object-id pub-id-type="pmid">2450716</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Collins</surname> <given-names>AGE</given-names></name>, <name name-style="western"><surname>Cavanagh</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Frank</surname> <given-names>MJ</given-names></name>. <article-title>Human EEG Uncovers Latent Generalizable Rule Structure during Learning</article-title>. <source>J Neurosci</source>. <year>2014</year>;<volume>34</volume>(<issue>13</issue>):<fpage>4677</fpage>–<lpage>85</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1523/JNEUROSCI.3900-13.2014" xlink:type="simple">10.1523/JNEUROSCI.3900-13.2014</ext-link></comment> <object-id pub-id-type="pmid">24672013</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stachenfeld</surname> <given-names>KL</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>. <article-title>The hippocampus as a predictive map</article-title>. <source>Nat Neurosci</source>. <year>2017</year>;<volume>20</volume>(<issue>11</issue>):<fpage>1643</fpage>–<lpage>53</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nn.4650" xlink:type="simple">10.1038/nn.4650</ext-link></comment> <object-id pub-id-type="pmid">28967910</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref044">
<label>44</label>
<mixed-citation publication-type="other" xlink:type="simple">Nagabandi A, Kahn G, Fearing RS, Levine S. Neural Network Dynamics for Model-Based Deep Reinforcement Learning with Model-Free Fine-Tuning. 2017; Available from: <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1708.02596" xlink:type="simple">http://arxiv.org/abs/1708.02596</ext-link></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gläscher</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>. <article-title>States versus rewards: Dissociable neural prediction error signals underlying model-based and model-free reinforcement learning</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>66</volume>(<issue>4</issue>):<fpage>585</fpage>–<lpage>95</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.neuron.2010.04.016" xlink:type="simple">10.1016/j.neuron.2010.04.016</ext-link></comment> <object-id pub-id-type="pmid">20510862</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006116.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Huys</surname> <given-names>QJM</given-names></name>, <name name-style="western"><surname>Eshel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>O’Nions</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Roiser</surname> <given-names>JP</given-names></name>. <article-title>Bonsai trees in your head: How the pavlovian system sculpts goal-directed choices by pruning decision trees</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>(<issue>3</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002410" xlink:type="simple">10.1371/journal.pcbi.1002410</ext-link></comment> <object-id pub-id-type="pmid">22412360</object-id></mixed-citation>
</ref>
</ref-list>
</back>
</article>