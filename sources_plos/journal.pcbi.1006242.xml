<!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Publishing DTD v1.1d3 20150301//EN" "http://jats.nlm.nih.gov/publishing/1.1d3/JATS-journalpublishing1.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.1d3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-17-01566</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1006242</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
<subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Organisms</subject><subj-group><subject>Bacteria</subject><subj-group><subject>Gut bacteria</subject><subj-group><subject>Bacteroides</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Phylogenetic analysis</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Animal phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Animal phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Computer and information sciences</subject><subj-group><subject>Data management</subject><subj-group><subject>Taxonomy</subject><subj-group><subject>Evolutionary systematics</subject><subj-group><subject>Phylogenetics</subject><subj-group><subject>Animal phylogenetics</subject></subj-group></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Zoology</subject><subj-group><subject>Animal phylogenetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Clinical medicine</subject><subj-group><subject>Clinical immunology</subject><subj-group><subject>Autoimmune diseases</subject><subj-group><subject>Crohn's disease</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Clinical immunology</subject><subj-group><subject>Autoimmune diseases</subject><subj-group><subject>Crohn's disease</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Immunology</subject><subj-group><subject>Clinical immunology</subject><subj-group><subject>Autoimmune diseases</subject><subj-group><subject>Crohn's disease</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Medicine and health sciences</subject><subj-group><subject>Gastroenterology and hepatology</subject><subj-group><subject>Inflammatory bowel disease</subject><subj-group><subject>Crohn's disease</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Microbiology</subject><subj-group><subject>Microbial genomics</subject><subj-group><subject>Microbiome</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Metagenomics</subject></subj-group></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v3"><subject>Biology and life sciences</subject><subj-group><subject>Evolutionary biology</subject><subj-group><subject>Evolutionary processes</subject><subj-group><subject>Speciation</subject><subj-group><subject>Species delimitation</subject></subj-group></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Phylogeny-corrected identification of microbial gene families relevant to human gut colonization</article-title>
<alt-title alt-title-type="running-head">Phylogenetic modeling of gut colonization</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0002-9231-8344</contrib-id>
<name name-style="western">
<surname>Bradley</surname> <given-names>Patrick H.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Formal analysis</role>
<role content-type="http://credit.casrai.org/">Investigation</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Validation</role>
<role content-type="http://credit.casrai.org/">Visualization</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Nayfach</surname> <given-names>Stephen</given-names></name>
<role content-type="http://credit.casrai.org/">Data curation</role>
<role content-type="http://credit.casrai.org/">Resources</role>
<role content-type="http://credit.casrai.org/">Software</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff002"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Pollard</surname> <given-names>Katherine S.</given-names></name>
<role content-type="http://credit.casrai.org/">Conceptualization</role>
<role content-type="http://credit.casrai.org/">Funding acquisition</role>
<role content-type="http://credit.casrai.org/">Methodology</role>
<role content-type="http://credit.casrai.org/">Project administration</role>
<role content-type="http://credit.casrai.org/">Supervision</role>
<role content-type="http://credit.casrai.org/">Writing – original draft</role>
<role content-type="http://credit.casrai.org/">Writing – review &amp; editing</role>
<xref ref-type="aff" rid="aff001"><sup>1</sup></xref>
<xref ref-type="aff" rid="aff003"><sup>3</sup></xref>
<xref ref-type="aff" rid="aff004"><sup>4</sup></xref>
<xref ref-type="corresp" rid="cor001">*</xref>
</contrib>
</contrib-group>
<aff id="aff001">
<label>1</label>
<addr-line>Gladstone Institute of Data Science and Biotechnology, San Francisco, CA, USA</addr-line>
</aff>
<aff id="aff002">
<label>2</label>
<addr-line>Environmental Genomics and Systems Biology Division, Lawrence Berkeley National Laboratory, Berkeley, CA, USA</addr-line>
</aff>
<aff id="aff003">
<label>3</label>
<addr-line>Department of Epidemiology &amp; Biostatistics, Institute for Human Genetics, Quantitative Biology Institute and Institute for Computational Health Sciences, University of California, San Francisco, San Francisco, CA, USA</addr-line>
</aff>
<aff id="aff004">
<label>4</label>
<addr-line>Chan-Zuckerberg Biohub, San Francisco, CA, USA</addr-line>
</aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Langille</surname> <given-names>Morgan</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1">
<addr-line>DAL, CANADA</addr-line>
</aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">katherine.pollard@gladstone.ucsf.edu</email></corresp>
</author-notes>
<pub-date pub-type="collection">
<month>8</month>
<year>2018</year>
</pub-date>
<pub-date pub-type="epub">
<day>9</day>
<month>8</month>
<year>2018</year>
</pub-date>
<volume>14</volume>
<issue>8</issue>
<elocation-id>e1006242</elocation-id>
<history>
<date date-type="received">
<day>23</day>
<month>11</month>
<year>2017</year>
</date>
<date date-type="accepted">
<day>29</day>
<month>5</month>
<year>2018</year>
</date>
</history>
<permissions>
<copyright-year>2018</copyright-year>
<copyright-holder>Bradley et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1006242"/>
<abstract>
<p>The mechanisms by which different microbes colonize the healthy human gut versus other body sites, the gut in disease states, or other environments remain largely unknown. Identifying microbial genes influencing fitness in the gut could lead to new ways to engineer probiotics or disrupt pathogenesis. We approach this problem by measuring the statistical association between a species having a gene and the probability that the species is present in the gut microbiome. The challenge is that closely related species tend to be jointly present or absent in the microbiome and also share many genes, only a subset of which are involved in gut adaptation. We show that this phylogenetic correlation indeed leads to many false discoveries and propose phylogenetic linear regression as a powerful solution. To apply this method across the bacterial tree of life, where most species have not been experimentally phenotyped, we use metagenomes from hundreds of people to quantify each species’ prevalence in and specificity for the gut microbiome. This analysis reveals thousands of genes potentially involved in adaptation to the gut across species, including many novel candidates as well as processes known to contribute to fitness of gut bacteria, such as acid tolerance in Bacteroidetes and sporulation in Firmicutes. We also find microbial genes associated with a preference for the gut over other body sites, which are significantly enriched for genes linked to fitness in an <italic>in vivo</italic> competition experiment. Finally, we identify gene families associated with higher prevalence in patients with Crohn’s disease, including Proteobacterial genes involved in conjugation and fimbria regulation, processes previously linked to inflammation. These gene targets may represent new avenues for modulating host colonization and disease. Our strategy of combining metagenomics with phylogenetic modeling is general and can be used to identify genes associated with adaptation to any environment.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author summary</title>
<p>Why do certain microbes and not others colonize our gut, and why do they differ between healthy and sick people? One explanation is the genes in their genomes. If we can find microbial genes involved in gut adaptation, we may be able to keep out pathogens and encourage the growth of beneficial microbes. One could look for genes that were present more often in prevalent microbes, and less often in rare ones. However, this ignores that related species are more likely to share an environment and also share many unrelated phenotypes simply because of common ancestry. To solve this problem, we used a method from ecology that accounts for phylogenetic relatedness. We first calculated gut prevalence for thousands of species using a compendium of shotgun sequencing data, then tested for genes associated with prevalence, adjusting for phylogenetic relationships. We found genes that are associated with overall gut prevalence, with a preference for the gut over other body sites, and with the gut in Crohn’s disease versus health. Many of these findings have biological plausibility based on existing literature. We also showed agreement with the results of a previously published high-throughput screen of bacterial gene knockouts in mice. These results, and this type of analysis, may eventually lead to new strategies for maintaining gut health.</p>
</abstract>
<funding-group>
<award-group id="award001">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>DMS-1069303</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Pollard</surname> <given-names>Katherine S</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award002">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000001</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>DMS-1563159</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Pollard</surname> <given-names>Katherine S</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award003">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100000936</institution-id>
<institution>Gordon and Betty Moore Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>3300</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Pollard</surname> <given-names>Katherine S</given-names></name>
</principal-award-recipient>
</award-group>
<award-group id="award004">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="funder-id">http://dx.doi.org/10.13039/100008072</institution-id>
<institution>Gladstone Institutes</institution>
</institution-wrap>
</funding-source>
<award-id>institutional funding</award-id>
<principal-award-recipient>
<name name-style="western">
<surname>Pollard</surname> <given-names>Katherine S</given-names></name>
</principal-award-recipient>
</award-group>
<funding-statement>Funding for this research was provided by NSF grants DMS-1069303 and DMS-1563159 (<ext-link ext-link-type="uri" xlink:href="http://www.nsf.gov" xlink:type="simple">www.nsf.gov</ext-link>), Gordon &amp; Betty Moore Foundation grant #3300 (moore.org), and institutional funds from the Gladstone Institutes (gladstone.org). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="4"/>
<table-count count="1"/>
<page-count count="41"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability">
<meta-name>Data Availability</meta-name>
<meta-value>For this study, we used published data obtained from the NCBI SRA database; accession IDs are provided as <xref ref-type="supplementary-material" rid="pcbi.1006242.s004">S3 Table</xref>. We also used the MIDAS v1.0 database (<ext-link ext-link-type="uri" xlink:href="http://lighthouse.ucsf.edu/MIDAS/midas_db_v1.0.tar.gz" xlink:type="simple">http://lighthouse.ucsf.edu/MIDAS/midas_db_v1.0.tar.gz</ext-link>).</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Microbes that colonize the human gastrointestinal (GI) tract have a wide variety of effects on their hosts, ranging from beneficial to harmful. Increasing evidence shows that commensal gut microbes are responsible for training and modulating the immune system [<xref ref-type="bibr" rid="pcbi.1006242.ref001">1</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref002">2</xref>], protecting against inflammation [<xref ref-type="bibr" rid="pcbi.1006242.ref003">3</xref>] and pathogen invasion (reviewed in Sassone-Corsi and Raffatellu [<xref ref-type="bibr" rid="pcbi.1006242.ref004">4</xref>]), affecting GI motility [<xref ref-type="bibr" rid="pcbi.1006242.ref005">5</xref>], maintaining the intestinal barrier [<xref ref-type="bibr" rid="pcbi.1006242.ref006">6</xref>], and potentially even affecting mood [<xref ref-type="bibr" rid="pcbi.1006242.ref007">7</xref>]. In contrast, pathogens (and conditionally-pathogenic microbes, or “pathobionts”) can induce and worsen inflammation [<xref ref-type="bibr" rid="pcbi.1006242.ref008">8</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref009">9</xref>], increase the risk of cancer in mouse models [<xref ref-type="bibr" rid="pcbi.1006242.ref010">10</xref>], and cause potentially life-threatening infections [<xref ref-type="bibr" rid="pcbi.1006242.ref011">11</xref>]. Additionally, the transplantation of microbes from a healthy host (fecal microbiota transplant, or FMT) is also a highly effective therapy for some gut infections [<xref ref-type="bibr" rid="pcbi.1006242.ref012">12</xref>], although it is still an active area of investigation why certain microbes from the donor persist long-term and others do not [<xref ref-type="bibr" rid="pcbi.1006242.ref013">13</xref>], and how pre-existing inflammatory disease affects FMT efficacy [<xref ref-type="bibr" rid="pcbi.1006242.ref014">14</xref>]. Which microbes are able to persist in the GI tract, and why some persist instead of others, is therefore a question with consequences that directly impact human health.</p>
<p>Because of this, we are interested in the specific mechanisms by which microbes colonize the gut, avoiding other potential fates such as being killed in the harsh stomach environment, simply passing through the GI tract transiently, or being outcompeted by other gut microbes. Understanding these mechanisms could yield opportunities to design better probiotics and to prevent invasion of the gut community by pathogens. In particular, creating new therapies, whether those are drugs, engineered bacterial strains, or rationally designed communities, will likely require an understanding of gut colonization at the level of individual microbial genes. We also anticipate that these mechanisms may vary in health vs. disease, since, for example, different selective pressures are known to be present in inflamed versus healthy guts [<xref ref-type="bibr" rid="pcbi.1006242.ref015">15</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref016">16</xref>].</p>
<p>One approach that has been used to link genetic features to a phenotype is to correlate the two using observational data. Most typically, this approach is applied in the form of genome-wide association mapping, in which phenotypes are correlated with genetic markers across individuals in a population. While we are interested in comparing phenotypes and genetic features <italic>across</italic>, rather than within species, the approach we take in this paper is conceptually similar. In order to perform association mapping, it is necessary to account for population structure, that is, dependencies resulting from common ancestry; otherwise, spurious discoveries can be made in genome-wide association studies [<xref ref-type="bibr" rid="pcbi.1006242.ref017">17</xref>]. Analogously, we expected it to be important to choose a method that can account for the confounding effect of phylogeny when testing for associations across species.</p>
<p>There is increasing interest in using phylogenetic information to make better inferences about associations between microbes and quantities of interest. For example, co-conservation patterns of genes (“correlogs”) have been used to assign functions to microbial genes [<xref ref-type="bibr" rid="pcbi.1006242.ref018">18</xref>], and genome-wide association studies have been applied within a genus of soil bacteria [<xref ref-type="bibr" rid="pcbi.1006242.ref019">19</xref>] as well as across strains of <italic>Neisseria meningitidis</italic> [<xref ref-type="bibr" rid="pcbi.1006242.ref020">20</xref>]. Recent publications have also described techniques that use information from the taxonomic tree to more accurately link clades in compositional taxonomic data to covariates [<xref ref-type="bibr" rid="pcbi.1006242.ref021">21</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref022">22</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref023">23</xref>]. However, so far, only one study has attempted to associate genes with a preference for the gut [<xref ref-type="bibr" rid="pcbi.1006242.ref024">24</xref>]. That study introduced a valuable method based on UniFrac and gene-count distances, which compares how well gut- vs. non-gut-associated microbes cluster on the species tree compared to a composite gene tree. This study also provides an important insight in the form of evidence of convergence of glycoside hydrolase and glycosyltransferase repertoires among gut bacteria, suggesting horizontal gene transfer within the gut community to deal with a common evolutionary pressure. The method described in that study, though, requires a binary phenotype of gut presence vs. absence. Deciding which microbes are “gut” vs. “non-gut” requires manual curation and can be somewhat subjective, as microbes have a continuous range of prevalences and can appear in multiple environments; this binarization could also potentially decrease power by excluding microbes with intermediate phenotypes. The method also requires multiple sequence alignments and trees to be built for every gene family under analysis, which are computationally intensive to generate over a large set of genomes.</p>
<p>We take a complementary approach and use a flexible technique, known as phylogenetic linear modeling, to detect associations between microbial genotype and phenotype while accounting for the fact that microbes are related to one another by vertical descent. Phylogenetic linear models have an extensive history in the ecology literature dating back to seminal works by Felsenstein [<xref ref-type="bibr" rid="pcbi.1006242.ref025">25</xref>] and Grafen [<xref ref-type="bibr" rid="pcbi.1006242.ref026">26</xref>]. However, despite their power, genome-scale applications of these models are still few in number [<xref ref-type="bibr" rid="pcbi.1006242.ref027">27</xref>] and, with the exception of one recent study that applied phylogenetic linear modeling to newly-sequenced isolate genomes from plant-associated microbial communities [<xref ref-type="bibr" rid="pcbi.1006242.ref028">28</xref>], have typically been used to relate traits of macroorganisms (e.g., anole lizards [<xref ref-type="bibr" rid="pcbi.1006242.ref029">29</xref>]) to their genotypes. While there is a growing appreciation for the need to explicitly account for phylogeny in microbial community analyses [<xref ref-type="bibr" rid="pcbi.1006242.ref027">27</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref030">30</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref031">31</xref>], we believe ours is the first study to directly apply this class of methods to metagenomic data.</p>
<p>This approach to accounting for phylogenetic relationships is general and could be applied to measure association of any quantitative phenotype with genotypes or other binary or quantitative characteristics. In this study, we focus on phenotypes related to the ability of bacteria to colonize the human gut: 1. overall prevalence in the guts of hosts from a specific population (e.g., post-industrialized countries), which we expect to capture ease of transmission, how cosmopolitan microbes are, and how efficiently they colonize the gut; 2. a preference for the gut over other human body sites in the same hosts, which we expect to capture gut colonization more specifically; and 3. a preference for the gut in disease (e.g., Crohn’s disease) versus health. We present a novel analytic pipeline in which we estimate these quantitative phenotypes for thousands of bacterial species directly from existing shotgun metagenomics data, both obviating the need for us to draw a cutoff between “gut” and “non-gut” microbes, and also giving us the necessary power to detect associations (<xref ref-type="supplementary-material" rid="pcbi.1006242.s007">S2 Fig</xref>). Coupling these phenotype estimates with phylogenetic linear models, we generate a compendium of thousands of bacterial genes whose functions may be involved in colonizing the human gut.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>We present a phylogeny-aware method for modeling associations between the presence of specific genes in bacterial genomes and quantitative phenotypes that measure how common these species are in the human microbiome. To apply phylogenetic linear modeling to the microbiome, we needed to solve three problems. First, we had to show that these models controlled false positives and had reasonable power on large bacterial phylogenies. Second, we needed to develop estimators that captured meaningful phenotypes related to bacterial colonization of humans for thousands of diverse bacterial species, most of which have never been studied in isolation, much less experimentally assayed for their abilities to colonize a mammalian body site. The third problem was to estimate genotypes (e.g., gene presence-absence) for each species. The analysis framework we describe is quite general and could be easily extended to link other phenotypes to genotypes across the tree of life.</p>
<sec id="sec003">
<title>Phylogenetic linear models solve the problem of high false positive rates when testing for associations on bacterial phylogenies</title>
<p>To test for associations between quantitative phenotypes and binary genotypes across species, we use models with the following form:
<disp-formula id="pcbi.1006242.e001"><alternatives><graphic id="pcbi.1006242.e001g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e001" xlink:type="simple"/><mml:math display="block" id="M1"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(1)</label></disp-formula> <inline-formula id="pcbi.1006242.e002"><alternatives><graphic id="pcbi.1006242.e002g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e002" xlink:type="simple"/><mml:math display="inline" id="M2"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is a vector of quantitative phenotypes of interest, assessed in one environment <italic>e</italic><sub><italic>x</italic></sub> out of a set of possible environments <italic>E</italic>, normalizing out a set of study effects <italic>D</italic>, estimated from the dataset <italic>A</italic>. The elements of the vector <inline-formula id="pcbi.1006242.e003"><alternatives><graphic id="pcbi.1006242.e003g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e003" xlink:type="simple"/><mml:math display="inline" id="M3"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are <italic>ϕ</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic>,<italic>D</italic></sub>(<italic>A</italic>), the phenotype value for microbe <italic>m</italic>. <italic>β</italic><sub>0,<italic>g</italic></sub> is a baseline phenotype value, <italic>β</italic><sub>1,<italic>g</italic></sub> is the effect of gene <italic>g</italic> on <inline-formula id="pcbi.1006242.e004"><alternatives><graphic id="pcbi.1006242.e004g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e004" xlink:type="simple"/><mml:math display="inline" id="M4"><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006242.e005"><alternatives><graphic id="pcbi.1006242.e005g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e005" xlink:type="simple"/><mml:math display="inline" id="M5"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is a vector whose elements <italic>I</italic><sub><italic>m</italic>,<italic>g</italic></sub> are 0 if gene <italic>g</italic> is absent in species <italic>m</italic> and 1 if present, and <inline-formula id="pcbi.1006242.e006"><alternatives><graphic id="pcbi.1006242.e006g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e006" xlink:type="simple"/><mml:math display="inline" id="M6"><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the remaining unmodeled variation in <inline-formula id="pcbi.1006242.e007"><alternatives><graphic id="pcbi.1006242.e007g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e007" xlink:type="simple"/><mml:math display="inline" id="M7"><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. We fit one model per gene <italic>g</italic>. The distribution of the residuals <inline-formula id="pcbi.1006242.e008"><alternatives><graphic id="pcbi.1006242.e008g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e008" xlink:type="simple"/><mml:math display="inline" id="M8"><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is the key difference between standard and phylogenetic linear models. In the standard model, the residuals are assumed to be independent and normally distributed. In the phylogenetic model, however, the residuals covary, with more closely-related species having greater covariance (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Modeling gene-phenotype associations” and “Fitting linear vs. phylogenetic models”; for a glossary of notation, see <xref ref-type="supplementary-material" rid="pcbi.1006242.s001">S1 Appendix</xref>).</p>
<p>To explore the potential pitfalls of failing to correct for phylogenetic structure in cross-species association tests, we generated a species tree for thousands of bacteria with genome sequences (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Phylogenetic-tree-construction”). In order to have a consistent operational definition of a microbial species, we used a set of previously defined bacterial taxonomic units with approximately 95% pairwise average nucleotide identity across the entire genome [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>]. The methods we describe can be applied to other taxonomic levels or with other species definitions. Using this species tree, we performed simulations (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Worked example.”) for each of the four major bacterial phyla in the human gut (Bacteroidetes, Firmicutes, Proteobacteria, and Actinobacteria [<xref ref-type="bibr" rid="pcbi.1006242.ref033">33</xref>]). Specifically, we generated simulated phenotypes along the species tree, and then, for each phenotype, simulated a binary genotype for each species that covaried with the phenotype to varying degrees, including no association. We used levels of covariation spanning those we observed empirically between prevalence of species in gut metagenomes and presence-absence of genes (see below). (An effect size of 0.5 corresponds approximately to a 50% increase in prevalence, while an effect size of 1.0 corresponds approximately to a 72% increase in prevalence: see <xref ref-type="supplementary-material" rid="pcbi.1006242.s013">S8 Fig</xref>). These binary genotypes also had varying levels of overall phylogenetic signal (as measured using Ives-Garland <italic>α</italic> [<xref ref-type="bibr" rid="pcbi.1006242.ref034">34</xref>]).</p>
<p>We then fit phylogenetic and standard linear models to the simulated data and tested for a relationship between each binary genotype and its corresponding continuous phenotype. For both standard and phylogenetic linear models, separate models were fit for each of the four phyla. The results were used to estimate false positive rate (Type I error) and power (1—Type II error) for the two methods across different effect sizes.</p>
<p>These analyses showed that standard linear models result in many false positive associations. When the binary genotype was specified to be wholly uncorrelated (i.e., under the null), <italic>p</italic>-values from the linear model showed a strong anticonservative bias (<xref ref-type="fig" rid="pcbi.1006242.g001">Fig 1B and 1D</xref>) with many more significant <italic>p</italic>-values than expected under no correlation. While lower levels of phylogenetic signal (larger Ives-Garland <italic>α</italic>) did result in less bias in the standard linear model, the average false positive rate ranged between 20% and 68% at <italic>p</italic> = 0.05. In contrast, the phylogenetic linear model <italic>p</italic>-value distribution was flat and Type I error was controlled appropriately (<xref ref-type="fig" rid="pcbi.1006242.g001">Fig 1A and 1C</xref>). This means that at the same <italic>p</italic>-value threshold, linear models will identify many spurious relationships compared to phylogenetic linear models. Further, our simulations with non-zero associations showed that the phylogenetic model has high power when applied to gut bacterial phyla, even for small effect sizes (<xref ref-type="fig" rid="pcbi.1006242.g001">Fig 1E</xref>; see <xref ref-type="sec" rid="sec011">Methods</xref>, “Power-analysis”). These results emphasize the importance of using models that account for phylogenetic relationships in cross-species association testing and demonstrate the feasibility of applying phylogenetic linear models to the human microbiome.</p>
<fig id="pcbi.1006242.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006242.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Failing to account for tree structure results in an elevated false positive rate.</title>
<p>Continuous phenotypes and binary genotypes were simulated across the trees for the four phyla under consideration. A-D show results for the null of no true phenotype-genotype correlation. A-B) Histogram of <italic>p</italic>-values for simulated phenotypes and genotypes on the Bacteroidetes tree, using (A) phylogenetic or (B) standard linear models. The phylogenetic model distribution was similar to a uniform distribution, while the standard model was very anticonservative, having an excess of small <italic>p</italic>-values. C-D) False positive rates (Type I error rates) at <italic>p</italic> = 0.05 for the C) phylogenetic and D) standard models, across varying levels of true phylogenetic signal (Ives-Garland <italic>α</italic>). E) Traits with varying levels of “true” association spanning values we observed in real data were simulated, and power (y-axis) was computed using phylogenetic linear models.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.g001" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec004">
<title>Estimating quantitative phenotypes from shotgun data</title>
<p>To apply phylogenetic linear modeling to the microbiome we sought to define meaningful phenotypes for thousands of bacterial species, all of which have genome sequences but most of which have never been experimentally tested for, e.g., their abilities to grow on particular substrates or to colonize a model mammalian gut. We hypothesized that the prevalence and specificity of bacterial species in an environment, such as the human gut, should relate to their ability to colonize that environment and to how well adapted they are to persist there. These quantities can be thought of as phenotypes that can be estimated directly from shotgun metagenomics data. The precise taxonomic composition of a healthy gut microbiome can vary significantly from person to person [<xref ref-type="bibr" rid="pcbi.1006242.ref035">35</xref>], indicating that the ability of a microbe to colonize the gut is quantitative (and likely context-dependent, and stochastic). This phentoype can be conceptualized differently depending on which aspects of colonization one wishes to capture. We present metagenome-based estimators for two different types of colonization phenotpyes. These are described in the context of our goal of studying the gut microbiome, but the approach is general and could be used to quantify how well a given genotype discriminates species found in or specific to any environment.</p>
<p>The first phenotype is the probability of observing a microbial species <italic>m</italic> in an environment <italic>e</italic><sub><italic>x</italic></sub>, that is, its <italic>overall prevalence</italic> <italic>P</italic>(<italic>m</italic>|<italic>e</italic><sub><italic>x</italic></sub>). Both genes relating to survival in the GI tract and genes relating to survival, persistence, and dispersal in the outside environment are expected to correlate with overall prevalence. Prevalence can be estimated by the frequency with which the species is observed in a sample from the environment, for example, using a logit transform to enable linear modeling and pseudocounts to avoid estimates of 0 or 1 (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Estimating the prevalence phenotype”).</p>
<p>The second type of quantitative phenotype is the <italic>environmental specificity</italic> of a microbial species, which we define as the conditional probability that a sample is derived from one environment in a set of environments, given that the species is present in the sample. This parameter captures the power of a given microbe as a marker to discriminate between two or more different environments, such as different body sites or types of hosts (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Estimating environmental specificity scores”). This is distinct from its overall prevalence in the environment.</p>
<p>We developed an estimator for environmental specificity and applied it to two separate gut microbial phenotypes. First, we considered a phenotype defined as the conditional probability that a given body site is the gut and not another body site, given that a particular species is present. The physical distance between body sites is much smaller than the distance between hosts, and microbes from one body site are likely to be transiently introduced to others. Hence, enrichment of a species in one body site over others is stronger evidence for selection (versus dispersal) than is overall prevalence in that body site alone. We estimate this parameter with a <italic>body-site specificity score</italic> that uses metagenomics data to measure how predictive a particular microbe is for the gut versus other body sites (e.g., skin, urogenital tract, oropharynx, or lung).</p>
<p>The second type of environmental specificity we considered is the conditional probability that a host has a disease given that a particular species is present. This <italic>disease-specific specificity score</italic> is estimated in a similar way to the body-site specificity score (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Estimating environmental specificity scores”). We focus on Crohn’s disease, a type of inflammatory bowel disease known to be associated with dramatic shifts in the gut microbiota and in gut-immune interactions [<xref ref-type="bibr" rid="pcbi.1006242.ref036">36</xref>]. Genes associated with this disease-specific prevalence could illuminate differences in selective pressures between healthy vs. diseased gut environments. Both scores are based on maximum <italic>a posteriori</italic> (MAP) estimates of the conditional probability of a sample being from the gut given that a microbe is observed in the sample. To account for sampling noise, we use a shrunken estimate with a Laplace prior (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Estimating environmental specificity scores”).</p>
</sec>
<sec id="sec005">
<title>Genes associated with species prevalence in healthy human gut metagenomes</title>
<p>We assembled a compendium of published DNA sequencing data from healthy human stool microbiomes across five studies in North America, Europe, and China (426 subjects total). Using the MIDAS database and pipeline [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>], we mapped metagenomic sequencing reads from each run to a panel of phylogenetic marker genes, and from these, estimated the relative abundances of species. Multiple runs corresponding to the same individual were averaged. We then estimated the prevalence (probability of non-zero abundance) of each species across these subjects, weighting each study equally and adding pseudocounts to avoid probabilities of exactly 0 or 1 (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Estimating the prevalence phenotype”). Finally, we determined whether genes (here, we take “genes” to mean members of a FIGfam protein family, which are designed to approximate “isofunctional homologs” [<xref ref-type="bibr" rid="pcbi.1006242.ref037">37</xref>]) were present or absent in the pangenomes of each species, based on sequenced genomes included in the MIDAS database, such that any FIGfam annotated in at least one sequenced isolate was considered to be present in the pangenome. This approach to genotyping could be extended to additionally include single-amplified genomes and metagenome-assembled genomes (see <xref ref-type="sec" rid="sec010">Discussion</xref>). Our analysis framework can also be applied to genotypes other than gene presence-absence (e.g., nucleotide or amino acid changes). We note that while the FIGfam database does include many hypothetical protein families of unknown function, many bacterial genes lack even this level of annotation, so a more comprehensive grouping of genes into orthologous or functionally homologous groups could reveal yet more novel associations.</p>
<p>As expected, the most prevalent species overall included <italic>Bacteroides vulgatus</italic>, <italic>Bacteroides ovatus</italic>, and <italic>Faecalibacterium prausnitzii</italic>, while the least prevalent included halophiles and thermophiles (<xref ref-type="supplementary-material" rid="pcbi.1006242.s002">S1 Table</xref>). Gut prevalence had a strong phylogenetic signal (Pagel’s λ = 0.97, likelihood-ratio <italic>p</italic> &lt; 10<sup>−22</sup>), meaning that it was strongly correlated with the evolutionary relatedness of species. This emphasizes the need for phylogeny-aware modeling so that signal linking genes to prevalence will not be drowned out by shared variation in gene content between closely-related species.</p>
<p>To demonstrate the effect of phylogenetic correlation empirically, we fit both a standard linear model and a phylogenetic linear model for each of the four common gut phyla and all genes present in that phylum. These models relate logit-transformed estimates of the prevalence of different species in a phylum to a gene’s presence-absence in those species’ pangenomes. Recall that the residual variation in logit-prevalence is independent and normally distributed in the standard linear model, but has a distribution encoding correlations proportional to species relatedness in the phylogenetic linear model (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Fitting linear vs. phylogenetic models”). For both standard and phylogenetic linear models, separate models were fit for each phylum. While this means that genes weakly-associated across the entire tree of life may have been missed by this approach, it has the advantage of both reducing the memory needed to store the gene presence-absence matrix and allowing for phylum-specific rates of evolution for our phenotype of interest. We modeled associations for 144,651 genes total across the four phyla, fitting 190,923 models total (since some genes are present in multiple phyla).</p>
<p>We used the parameter estimates and their standard errors from fitted models to test null hypotheses of the form <italic>H</italic><sub>0</sub>: <italic>β</italic><sub>1,<italic>g</italic></sub> = 0, meaning gene <italic>g</italic> is not associated with gut prevalence of species in a particular phylum. The <italic>p</italic>-values were adjusted for multiple testing using the false discovery rate (FDR) (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Fitting linear vs. phylogenetic models”). We found 9,455 FIGfam gene families positively associated with logit-prevalence within at least one phylum (FDR <italic>q</italic> ≤ 0.05) using phylogenetic linear models, 47% of which had no annotated function. We observed that 75% of the significant genes from these tests had effect sizes larger than (Bacteroidetes) 0.95, (Firmicutes) 1.09, (Proteobacteria) 0.35, and (Actinobacteria) 2.08, which are within the range of effect sizes for which phylogenetic linear models showed good performance in simulations (see above).</p>
<p>With standard linear models our tests identified 25,226 genes positively associated with gut prevalence, substantially more than with phylogenetic linear models (17.4% versus 6.5% of total). Based on our simulations, these likely included many false positives. The top results of phylogenetic versus standard linear models (<xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2</xref>) illustrate the pitfalls of not correcting for phylogenetic correlation. Using the standard model, we recover associations such as those seen in <xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2A and 2B</xref>: a subunit of dihydroorotate dehydrogenase in Bacteroidetes (<xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2B</xref>) and in Firmicutes, a particular type of glutamine synthetase (<xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2A</xref>). While these associations might look reasonable at a first glance, on closer inspection, they depend on the fact that these genes are near-uniformly present in entire clades of bacteria. These clades are, in general, more prevalent in the gut compared to the rest of the species in the tree. However, any finer structure relating to differences between close neighbors is lost. For example, dihydroorotate dehydrogenase (<xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2B</xref>) is found not only in the human gut commensal <italic>Bacteroides caccae</italic>, but also in its relative <italic>Bacteroides reticulotermitis</italic>, which was not only low-prevalence in our samples but was indeed isolated from the gut of a subterranean termite [<xref ref-type="bibr" rid="pcbi.1006242.ref038">38</xref>].</p>
<fig id="pcbi.1006242.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006242.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Examples of hits from standard linear (blue highlights) and phylogenetic (orange highlights) models.</title>
<p>In each panel, the tree on the left is colored by species prevalence (black to orange), while the tree on the right is colored by gene presence-absence (blue to black). Selected species are displayed in the middle; lines link species with the leaves to which they refer. The color of the line matches the color of the leaf. A-B) The standard model recovered hits that matched large clades but without recapitulating fine structure. C-D) The phylogenetic model recovered associations for which more of the fine structure was mirrored between the left-hand and right-hand trees, as exemplified by the species labeled in the middle. E) Violin plots of Ives-Garland <italic>α</italic>, a summary of the rate of gain and loss of a binary trait across a tree, for genes significantly associated with prevalence in the standard (left, blue) and phylogenetic (right, orange) linear models. Horizontal lines mark the median of the distributions. The phylogenetic (orange) and standard linear (blue) models were significantly different for each phylum (Wilcox test for Bacteroidetes: 8.2 × 10<sup>−41</sup>; Firmicutes: 7.6 × 10<sup>−279</sup>; Proteobacteria: 1.8 × 10<sup>−235</sup>; Actinobacteria: 9.0 × 10<sup>−133</sup>).</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.g002" xlink:type="simple"/>
</fig>
<p>While this alone does not necessarily constitute evidence <italic>against</italic> these genes having adaptive functions in the human gut, we do expect that matched pheno- and genotypic differences between close phylogenetic neighbors offer stronger evidence for an association. An analogy can be drawn with genome-wide association mapping in humans: models that do not account for correlations between sites caused by population structure, as opposed to selective pressure, will tend to identify more spurious associations. In contrast, because the phylogenetic null model “expects” phenotypic correlations to scale with the evolutionary distance between species, this approach will tend to upweight cases where phylogenetically close relatives have different phenotypes and where distant relatives have similar phenotypes. This leads to the identification of candidate genes that capture more variation between close neighbors (<xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2C and 2D</xref>). Thus, phylogenetic linear models will identify genes whose presence in genomes is more frequently changing between sister taxa in association with a phenotype.</p>
<p>We provided further evidence that this trend is true in general by calculating the phylogenetic signal of the top hits from each model using Ives and Garland’s <italic>α</italic> [<xref ref-type="bibr" rid="pcbi.1006242.ref034">34</xref>]. This statistic captures the rate of transitions between having and not having a binary trait (here, a gene) across a tree; higher values therefore correspond to more disagreement between closely related species and lower values correspond to more agreement. Indeed, across all four phyla, the linear model identified gene families with significantly lower Ives-Garland <italic>α</italic> than the phylogenetic model (<xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2E</xref>, linear model <italic>p</italic> &lt; 10<sup>−16</sup>), indicating that these genes’ presence versus absence tended to be driven more by clade-to-clade differences (i.e., shared evolution).</p>
<p>These results suggest that standard linear models can identify genes that are truly important for colonizing an environment, such as the healthy human gut, but in addition will identify other genes that may simply be common in clades associated with that environment. The latter set will likely include many false positive associations from the perspective of understanding functions necessary for living in the environment. Phylogenetic linear models overcome this problem by adding the expectation that closely-related species will have similar phenotypes and distantly-related species will have less similar phenotypes, effectively upweighting instances where this is not the case. These conclusions are supported by our simulations and by an <italic>in vivo</italic> functional screen (see <xref ref-type="sec" rid="sec002">Results</xref>, “Deletion of gut-specific genes lowers fitness in the mouse microbiome”).</p>
</sec>
<sec id="sec006">
<title>Gene families associated with gut prevalence provide insight into colonization biology</title>
<p>Several of the gene families that we observed to be associated with gut prevalence have previously been linked to gut colonization efficiency. For example, in Firmicutes, we noticed that several top hits were annotated as sporulation proteins (e.g., “Stage 0 sporulation two-component response regulator”, <xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2C</xref>). Sporulation is known to be a strategy for surviving harsh environments (such as acid, alcohol, and oxygen exposure) that is used by many, but not all, members of Firmicutes. Resistance to oxygen (aerotolerance) is particularly important because many gut Firmicutes are strict anaerobes [<xref ref-type="bibr" rid="pcbi.1006242.ref039">39</xref>], sporulation is known to be an important mechanism of transmission and survival in the environment (reviewed in Swick et al. [<xref ref-type="bibr" rid="pcbi.1006242.ref040">40</xref>]), and sporulation ability has been linked to transmission patterns of gut microbes [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>]. Our result associating sporulation proteins to gut prevalence provides further evidence for sporulation as a strategy that is generally important for the propagation and fitness of gut microbes.</p>
<p>In Bacteroidetes, we observed an association between gut prevalence and the presence of a pair of gene families putatively assigned to the GAD operon, namely, the glutamate decarboxylase <italic>gadB</italic> and the glutamate/gamma-aminobutyric acid (GABA) antiporter <italic>gadC</italic>. These genes show a complex pattern of presence that is strongly correlated with gut prevalence (<xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2D</xref>, <xref ref-type="supplementary-material" rid="pcbi.1006242.s010">S5 Fig</xref>). Results from research in Proteobacteria, where these genes were first described, shows that their products participate in acid tolerance. L-glutamate must be protonated in order to be decarboxylated to GABA; export of GABA coupled to import of fresh L-glutamate therefore allows the net export of protons, raising intracellular pH [<xref ref-type="bibr" rid="pcbi.1006242.ref041">41</xref>]. It was previously hypothesized that this acid tolerance mechanism allowed bacteria to survive the harshly acidic conditions in the stomach: indeed, if disrupted in the pathogen <italic>Edwardsiella tarda</italic>, gut colonization in a fish model is impaired [<xref ref-type="bibr" rid="pcbi.1006242.ref042">42</xref>]. <italic>Listeria monocytogenes</italic> with disrupted GAD systems also become sensitive to porcine gastric fluid [<xref ref-type="bibr" rid="pcbi.1006242.ref043">43</xref>]. However, while it has previously been shown that gut <italic>Bacteroides</italic> do contain homologs for at least one of these genes [<xref ref-type="bibr" rid="pcbi.1006242.ref041">41</xref>], their functional importance has not yet been demonstrated in this phylum. Our results provide preliminary evidence that this system may be important in Bacteroidetes as well as in Proteobacteria.</p>
</sec>
<sec id="sec007">
<title>Using body sites as a control allows us to differentiate general dispersal from a specific gut advantage</title>
<p>The previous analyses have focused on modeling the phenotype of overall prevalence in the human gut. However, microbes could be prevalent in the gut for at least two main reasons. First, they could be specifically well-adapted to the human gut; second, they could simply be very common in the environment (i.e., highly dispersed). The presence or absence of a gene family could enhance either of these properties. Some genes might, for example, confer improved stress tolerance that was adaptive across a range of harsh conditions, while others might allow, for example, uptake and catabolism of metabolic substrates that were more common in the human gut than in other environments.</p>
<p>With this in mind, we analyzed the relative enrichment of microbes in the gut over other human body sites in 127 individuals from the Human Microbiome Project (HMP) study [<xref ref-type="bibr" rid="pcbi.1006242.ref035">35</xref>]. We chose other body sites as a control because the physical distance between sites within a host is much smaller than the distance between people, and microbes from one body site are likely to be commonly, if transiently, introduced to other body sites (e.g., skin to oral cavity). To find specifically gut-associated genes, we used the phylogenetic linear model to regress gene presence-absence on the logit-transformed conditional probability <italic>P</italic>(<italic>e</italic><sub>Gut</sub>|<italic>m</italic>), i.e., the probability that a body site was the human gut given that a particular species <italic>m</italic> was observed, which we estimated using Laplace regularization (see <xref ref-type="sec" rid="sec011">Methods</xref>, “Estimating-environmental-specificity”). We identified 4,274 genes whose presence in bacterial genomes was positively associated with those species being present in the gut versus other body sites in at least one phylum (374 in Bacteroidetes, 1,515 in Firmicutes, 1,194 in Proteobacteria, and 1,255 in Actinobacteria).</p>
<p>Overall, the effect sizes for genes learned from this body site-specific model correlated only moderately with those learned from the “gut prevalence” models (median <italic>r</italic> = 0.26, range 0.14–0.35), indicating that these two quantitative phenotypes describe distinct phenomena. Additionally, the overlap between significant (<italic>q</italic> ≤ 0.05) hits for both models was usually small (median Jaccard index 0.056, range 0.035–0.343). These results are not surprising given that our regularized estimates of gut specificity were only moderately correlated with overall gut prevalence (Spearman’s <italic>ρ</italic> = −0.06, Pearson’s <italic>r</italic> = 0.31, <xref ref-type="supplementary-material" rid="pcbi.1006242.s006">S1 Fig</xref>), even when prevalence was calculated only from HMP gut samples (Spearman’s <italic>ρ</italic> = 0.05, Pearson’s <italic>r</italic> = 0.40). This may arise from different genes being involved in dispersal or adaptation to many different environments versus those involved in adaptation specifically to the gut.</p>
<p>Indeed, when we compare the enrichments for genes significant in either the body site or overall prevalence models, we observe large functional shifts (<xref ref-type="fig" rid="pcbi.1006242.g003">Fig 3</xref>). For example, in the gut prevalence model, but not the body site-specific model, Firmicutes were strongly enriched for “dormancy and sporulation” (<italic>q</italic> = 4.4 × 10<sup>−5</sup>). Because sporulation is likely useful in a wide range of environments beyond the gut, this result seems intuitive. Body site-specific results for Firmicutes were instead enriched for genes involved in “phosphorus metabolism” (<italic>q</italic> = 0.14) and in particular the term “high affinity phosphate transporter and control of PHO regulon” (<italic>q</italic> = 0.058).</p>
<fig id="pcbi.1006242.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006242.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of results from the overall prevalence and body-site specific models for Firmicutes.</title>
<p>FDR-corrected significance (as −log<sub>10</sub>(<italic>q</italic>)) of the overall model is plotted on the horizontal axis, whereas the same quantity for the body-site-specific model is plotted on the vertical axis. All FIGfams significant (<italic>q</italic> ≤ 0.05) in at least one of the two models are plotted as contour lines: FIGfams significant in the overall prevalence model (and possibly also the gut specific model) are plotted in orange, while FIGfams significant in the gut specific model (and possibly also the overall prevalence model) are plotted in blue. Selected SEED subsystems are displayed as colored points (legend), and selected individual genes are plotted as black points.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.g003" xlink:type="simple"/>
</fig>
<p>We also observed biologically-justified individual gene families that were significant in the body site-specific model (<italic>q</italic> ≤ 0.05) but not the overall gut prevalence model (<italic>q</italic> &gt; 0.5 and/or wrong sign of effect size). In Firmicutes, for example, carnitine dehydratase and bile acid 7-alpha dehydratase were both significant only in the body site-specific model, suggesting a specific role for these genes within the gut environment. Indeed, bile acids are metabolites of cholesterol that are produced by vertebrates and thus unlikely to be encountered outside of the host. While the metabolite L-carnitine is made and used in organisms spanning the tree of life, it is particularly concentrated in animal tissue and especially red meat, and cannot be further catabolized by humans [<xref ref-type="bibr" rid="pcbi.1006242.ref044">44</xref>], making it available to intestinal microbes. Bile acid transformation by gut commensals is a well-established function of the gut microbiome, with complex influences on health (reviewed in Staley et al. [<xref ref-type="bibr" rid="pcbi.1006242.ref045">45</xref>]).</p>
<p>In Bacteroidetes, we found that a homolog of the autoinducer 2 aldolase <italic>lsrF</italic> was significant only in the body site-specific model. Autoinducer 2 is a small signaling molecule produced by a wide range of bacteria that is involved in interspecies quorum sensing. The protein <italic>lsrF</italic>, specifically, is part of an operon whose function in <italic>Escherichia coli</italic> is to “quench” or destroy the AI-2 signal [<xref ref-type="bibr" rid="pcbi.1006242.ref046">46</xref>]. Further, an increase of the AI-2 signal has been shown to decrease the Bacteroidetes/Firmicutes ratio <italic>in vivo</italic> in the intestines of streptomycin-treated mice [<xref ref-type="bibr" rid="pcbi.1006242.ref047">47</xref>]. Degrading this molecule is therefore a plausible gut-specific colonization strategy for gut Bacteroidetes. These discovered associations make the genes involved, including many genes without known functions or roles in gut biology, excellent candidates for understanding how bacteria adapt to the gut environment.</p>
</sec>
<sec id="sec008">
<title>Deletion of gut-specific genes lowers fitness in the mouse microbiome</title>
<p>Beyond finding evidence for the plausibility of individual genes based on the literature, we were interested in whether more high-throughput experimental evidence supported the associations we found between gut colonization and gene presence. To interrogate this, we used results from an <italic>in vivo</italic> transposon-insertion screen of four strains of <italic>Bacteroides</italic>. This screen identified many genes whose disruption caused a competitive disadvantage in gnotobiotic mice, as revealed by time-course high-throughput sequencing; 79 gene families significantly affected microbial fitness across all four strains tested [<xref ref-type="bibr" rid="pcbi.1006242.ref048">48</xref>]. Determining agreement with this screen is somewhat complicated by the fact that we associated gene presence to gut specificity across all members of the phylum Bacteroidetes, and not only within the <italic>Bacteroides</italic> genus. Significance of overlap therefore depends on what we take as the null “background” set, the cutoff used for significance, and the set of results from the screen we choose as true positives (<xref ref-type="supplementary-material" rid="pcbi.1006242.s004">S3 Table</xref>).</p>
<p>Despite these complications, this analysis clearly showed that the 79 genes whose disruption led to lower fitness in the murine gut across all four <italic>Bacteroides</italic> species were over-represented among our predictions for gut-specific genes (odds ratio = 4.67, <italic>q</italic> = 6.7 × 10<sup>−3</sup>), and remained so if we only considered the gene families that were present in all <italic>Bacteroides</italic> species (odds ratio = 7.02, <italic>q</italic> = 3.4 × 10<sup>−3</sup>) (<xref ref-type="table" rid="pcbi.1006242.t001">Table 1</xref>). Interestingly, we observed the opposite pattern for the overall prevalence model: the prevalence-associated genes we identified were actually depleted for genes found to be important <italic>in vivo</italic> (odds ratio = 0.18, <italic>q</italic> = 1.1 × 10<sup>−2</sup>). We believe that this is because the body-site-specific model, like the experiment, focused specifically on colonization efficiency, while the overall gut prevalence model would have included genes involved in persistence and dispersal in the environment and transfer between hosts. This experimental evidence supports the idea that environment-specific phylogenetic linear models truly identify genes that are important for bacteria to colonize an environment.</p>
<table-wrap id="pcbi.1006242.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006242.t001</object-id>
<label>Table 1</label>
<caption>
<title>Assessment of agreement between the <italic>in vivo</italic> results from Wu et al. [<xref ref-type="bibr" rid="pcbi.1006242.ref048">48</xref>] and gut-specific (“bodysite”) vs. gut prevalence (“overall”) phylogenetic models.</title>
<p>The background sets for enrichment tests were defined as follows: “all tested” (all gene families for which a phylogenetic model was fit), “Bacteroides (core or variable)” (all gene families with at least one representative in <italic>Bacteroides</italic> genome cluster pangenomes), “Bacteroides (core only)” (gene families that were present in all <italic>Bacteroides</italic> genome cluster pangenomes), “Bacteroides (variable only)” (gene families present in some but not all <italic>Bacteroides</italic> genomes clusters), and “Bacteroides thetaiotaomicron only” (only gene families present in <italic>Bacteroides thetaiotaomicron</italic>). The “all tested” background sets are further classified as “all tested (overall)” and “all tested (body site)” since the set of genes tested differed slightly. The <italic>p</italic>-values are from Fisher’s exact tests. These comparisons have been excerpted from the full set, which can be seen in <xref ref-type="supplementary-material" rid="pcbi.1006242.s004">S3 Table</xref>; <italic>q-</italic> values were calculated based on this full set of tests using the Benjamini-Hochberg method [<xref ref-type="bibr" rid="pcbi.1006242.ref089">89</xref>].</p>
</caption>
<alternatives>
<graphic id="pcbi.1006242.t001g" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.t001" xlink:type="simple"/>
<table border="0" frame="box" rules="all">
<colgroup>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
<col align="left" valign="middle"/>
</colgroup>
<thead>
<tr>
<th align="center" style="border-bottom:thick">Background set</th>
<th align="center" style="border-bottom:thick">FDR</th>
<th align="center" style="border-bottom:thick">MODEL</th>
<th align="center" style="border-bottom:thick"><italic>p</italic> -value</th>
<th align="center" style="border-bottom:thick">odds ratio</th>
<th align="center" style="border-bottom:thick"><italic>q</italic> -value</th>
<th align="center" style="border-bottom:thick">significant</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><bold>All tested</bold></td>
<td align="center"><bold>5%</bold></td>
<td align="center"><bold>overall</bold></td>
<td align="center">4.86 × 10<sup>−3</sup></td>
<td align="char" char="."><bold>0.18</bold></td>
<td align="center">1.12 × 10<sup>−2</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center"><bold>Bacteroides (core or variable)</bold></td>
<td align="center"><bold>5%</bold></td>
<td align="center"><bold>overall</bold></td>
<td align="center">5.32 × 10<sup>−12</sup></td>
<td align="char" char="."><bold>0.05</bold></td>
<td align="center">5.32 × 10<sup>−11</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center">Bacteroides (core only)</td>
<td align="center">5%</td>
<td align="center">overall</td>
<td align="center">1.00</td>
<td align="char" char=".">0.00</td>
<td align="center">1.00</td>
<td align="center">FALSE</td>
</tr>
<tr>
<td align="center"><bold>Bacteroides (variable only)</bold></td>
<td align="center"><bold>5%</bold></td>
<td align="center"><bold>overall</bold></td>
<td align="center">8.03 × 10<sup>−4</sup></td>
<td align="char" char="."><bold>0.14</bold></td>
<td align="center">2.54 × 10<sup>−3</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center"><bold>Bacteroides thetaiotaomicron only</bold></td>
<td align="center"><bold>5%</bold></td>
<td align="center"><bold>overall</bold></td>
<td align="center">4.89 × 10<sup>−6</sup></td>
<td align="char" char="."><bold>0.10</bold></td>
<td align="center">2.10 × 10<sup>−5</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center"><bold>All tested</bold></td>
<td align="center"><bold>25%</bold></td>
<td align="center"><bold>overall</bold></td>
<td align="center">2.30 × 10<sup>−3</sup></td>
<td align="char" char="."><bold>0.25</bold></td>
<td align="center">6.28 × 10<sup>−3</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center"><bold>Bacteroides (core or variable)</bold></td>
<td align="center"><bold>25%</bold></td>
<td align="center"><bold>overall</bold></td>
<td align="center">2.85 × 10<sup>−15</sup></td>
<td align="char" char="."><bold>0.06</bold></td>
<td align="center">3.43 × 10<sup>−14</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center">Bacteroides (core only)</td>
<td align="center">25%</td>
<td align="center">overall</td>
<td align="center">2.49 × 10<sup>−1</sup></td>
<td align="char" char=".">0.00</td>
<td align="center">3.65 × 10<sup>−1</sup></td>
<td align="center">FALSE</td>
</tr>
<tr>
<td align="center"><bold>Bacteroides (variable only)</bold></td>
<td align="center"><bold>25%</bold></td>
<td align="center"><bold>overall</bold></td>
<td align="center">4.96 × 10<sup>−4</sup></td>
<td align="char" char="."><bold>0.19</bold></td>
<td align="center">1.65 × 10<sup>−3</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center"><bold>Bacteroides thetaiotaomicron only</bold></td>
<td align="center"><bold>25%</bold></td>
<td align="center"><bold>overall</bold></td>
<td align="center">4.20 × 10<sup>−8</sup></td>
<td align="char" char="."><bold>0.12</bold></td>
<td align="center">2.80 × 10<sup>−7</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center"><bold>All tested</bold></td>
<td align="center"><bold>5%</bold></td>
<td align="center"><bold>bodysite</bold></td>
<td align="center">2.67 × 10<sup>−3</sup></td>
<td align="char" char="."><bold>4.67</bold></td>
<td align="center">6.68 × 10<sup>−3</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center">Bacteroides (core or variable)</td>
<td align="center">5%</td>
<td align="center">bodysite</td>
<td align="center">6.43 × 10<sup>−2</sup></td>
<td align="char" char=".">2.23</td>
<td align="center">1.20 × 10<sup>−1</sup></td>
<td align="center">FALSE</td>
</tr>
<tr>
<td align="center"><bold>Bacteroides (core only)</bold></td>
<td align="center"><bold>5%</bold></td>
<td align="center"><bold>bodysite</bold></td>
<td align="center">1.14 × 10<sup>−3</sup></td>
<td align="char" char="."><bold>7.02</bold></td>
<td align="center">3.43 × 10<sup>−3</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center">Bacteroides (variable only)</td>
<td align="center">5%</td>
<td align="center">bodysite</td>
<td align="center">1.00</td>
<td align="char" char=".">0.00</td>
<td align="center">1.00</td>
<td align="center">FALSE</td>
</tr>
<tr>
<td align="center">Bacteroides thetaiotaomicron only</td>
<td align="center">5%</td>
<td align="center">bodysite</td>
<td align="center">1.67 × 10<sup>−1</sup></td>
<td align="char" char=".">1.79</td>
<td align="center">2.69 × 10<sup>−1</sup></td>
<td align="center">FALSE</td>
</tr>
<tr>
<td align="center"><bold>All tested</bold></td>
<td align="center"><bold>25%</bold></td>
<td align="center"><bold>bodysite</bold></td>
<td align="center">2.67 × 10<sup>−3</sup></td>
<td align="char" char="."><bold>3.36</bold></td>
<td align="center">6.68 × 10<sup>−3</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center">Bacteroides (core or variable)</td>
<td align="center">25%</td>
<td align="center">bodysite</td>
<td align="center">1.80 × 10<sup>−1</sup></td>
<td align="char" char=".">1.69</td>
<td align="center">2.77 × 10<sup>−1</sup></td>
<td align="center">FALSE</td>
</tr>
<tr>
<td align="center"><bold>Bacteroides (core only)</bold></td>
<td align="center"><bold>25%</bold></td>
<td align="center"><bold>bodysite</bold></td>
<td align="center">1.09 × 10<sup>−2</sup></td>
<td align="char" char="."><bold>3.47</bold></td>
<td align="center">2.41 × 10<sup>−2</sup></td>
<td align="center"><bold>TRUE</bold></td>
</tr>
<tr>
<td align="center">Bacteroides (variable only)</td>
<td align="center">25%</td>
<td align="center">bodysite</td>
<td align="center">7.14 × 10<sup>−1</sup></td>
<td align="char" char=".">1.06</td>
<td align="center">8.40 × 10<sup>−1</sup></td>
<td align="center">FALSE</td>
</tr>
<tr>
<td align="center">Bacteroides thetaiotaomicron only</td>
<td align="center">25%</td>
<td align="center">bodysite</td>
<td align="center">5.56 × 10<sup>−1</sup></td>
<td align="char" char=".">1.23</td>
<td align="center">7.41 × 10<sup>−1</sup></td>
<td align="center">FALSE</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec009">
<title>We identify Proteobacterial gene families associated with microbes that are more prevalent in Crohn’s disease</title>
<p>The above analyses were performed with respect to the gut of healthy individuals from the mainly post-industrial populations of North America, Europe and China. However, we also know that taxonomic shifts are common between healthy guts versus the guts of individuals from the same population with diseases such as type 2 diabetes, colorectal cancer, rheumatoid arthritis, and inflammatory bowel disease (reviewed in Wang et al. [<xref ref-type="bibr" rid="pcbi.1006242.ref049">49</xref>]). One explanation for these results is that sick hosts select for specific microbial taxa, as with the links previously observed between Proteobacteria and the inflammation that accompanies many disease states [<xref ref-type="bibr" rid="pcbi.1006242.ref050">50</xref>]. Since gut microbes have also been implicated in altering disease progression (reviewed in Lynch and Pedersen [<xref ref-type="bibr" rid="pcbi.1006242.ref051">51</xref>]), identifying genes associated with colonizing diseased individuals may afford us new opportunities for intervention.</p>
<p>To identify microbiome functions that could be involved in disease-specific adaptation to the gut, we looked for genes that were present more often in microbes that discriminated case from control subjects. Specifically, we compared <italic>n</italic> = 38 healthy controls from the MetaHIT consortium to <italic>n</italic> = 13 individuals with Crohn’s disease [<xref ref-type="bibr" rid="pcbi.1006242.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref053">53</xref>]. Similar to our analysis of gut versus other body sites, we used the conditional probability that a subject had Crohn’s disease <italic>given</italic> that we observed a particular microbe in their gut microbiome <italic>P</italic>(<italic>e</italic><sub><italic>CD</italic></sub>|<italic>M</italic>) (see <xref ref-type="sec" rid="sec011">Methods</xref>). We identified 1,841 genes whose presence in bacterial genomes was associated with Crohn’s after correcting for phylogenetic relationships in at least one phylum (796 in Bacteroidetes, 278 in Firmicutes, 467 in Proteobacteria, and 340 in Actinobacteria).</p>
<p>Eleven of our top Proteobacterial associations were annotated as fimbrial proteins, including one predicted to be involved specifically in the biosynthesis of type 1 fimbriae, or pili (FimI, association <italic>q</italic> = 2.8 × 10<sup>−3</sup>), cell surface structures involved in attachment and invasion. Crohn’s pathology has been linked to an immune response to invasive bacteria, and adherent-invasive <italic>E. coli</italic> (AIEC) appear to be overrepresented in ileal Crohn’s [<xref ref-type="bibr" rid="pcbi.1006242.ref054">54</xref>]. In an AIEC <italic>E. coli</italic> strain isolated from the ileum of a Crohn’s patient, type 1 pili were required for this adherent-invasive phenotype [<xref ref-type="bibr" rid="pcbi.1006242.ref055">55</xref>]. Chronic infection by AIEC strains was also observed to lead to chronic inflammation, and to an increase in Th17 cells and a decrease in CD8<sup>+</sup> T cells similar to that observed in Crohn’s patients [<xref ref-type="bibr" rid="pcbi.1006242.ref056">56</xref>].</p>
<p>An additional striking feature of the results was the number of Proteobacterial proteins associated with greater risk of Crohn’s that were annotated as being involved in type IV secretion and conjugative transfer systems (Fisher’s test <italic>q</italic> = 4.9 × 10<sup>−4</sup>). Conjugative transfer is a process by which gram-negative bacteria in direct physical contact share genetic material. More specifically, many of these genes, including one annotated as TraR (<xref ref-type="fig" rid="pcbi.1006242.g004">Fig 4</xref>), were homologs of those involved in an “F-type” conjugal system for transferring IncF plasmids, which can be classified as a variety of type IV secretion system [<xref ref-type="bibr" rid="pcbi.1006242.ref057">57</xref>]. Previously, in a mouse model, gut inflammation was shown to stimulate efficient horizontal gene transfer in Proteobacteria by promoting blooms of <italic>Enterobacteriaceae</italic> and thus facilitating cell-to-cell contact [<xref ref-type="bibr" rid="pcbi.1006242.ref058">58</xref>]. Future work will be required to determine whether this increased conjugation is a neutral consequence of inflammation, a causative factor, or provides a selective advantage in the inflamed gut.</p>
<fig id="pcbi.1006242.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1006242.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Genes involved in conjugative transfer are associated with Crohn’s disease-enriched species.</title>
<p>The conjugation transcriptional regulator <italic>traR</italic> is plotted as an example. The left-hand tree is colored by each species’ disease specificity score, i.e., the conditional probability of Crohn’s given the observation of a given species (grey, which represents the prior, to red, which represents a higher conditional probability). The right-hand tree is colored by gene presence-absence (grey, meaning absent, or blue, meaning present). The mirrored patterns drive the phylogeny-corrected correlation.</p>
</caption>
<graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.g004" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec010" sec-type="conclusions">
<title>Discussion</title>
<p>The present analyses represent a first look into what can be learned by combining shotgun metagenomics with phylogenetically-aware models. Several extensions to our work could be made in the future. First, in addition to modeling prevalence, for instance, we could model abundance using a phylogenetic linear model with random effects [<xref ref-type="bibr" rid="pcbi.1006242.ref059">59</xref>], potentially allowing us to learn what controls the steady-state abundance of species in the gut. Additionally, we could also use these models to screen for epistatic interactions, which would be near-intractable even in systems with well-characterized genetic tools, but for which a subset of hypotheses could be validated by, e.g., comparing the fitness of wild-type microbes with double knockouts. While controlling the total number of tests would still be important to preserve power, an automated, computational approach to detecting gene interactions would still offer important savings in time and expense over developing a genome-wide experimental library of multiple knockouts per organism under investigation.</p>
<p>Currently, these analyses estimate species abundance and gene presence-absence from available sequenced isolate genomes. However, it has been estimated that on average 51% of genomes in the gut are from novel species [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>]. Especially for case/control comparisons, using information from metagenomic assemblies could enable quantification of species with no sequenced representatives, and would yield a more accurate estimate of the complement of genes in the pangenome for species that do have sequenced representatives. This would be particularly helpful in gut communities from individuals in non-industrialized societies that are enriched for novel microbial species [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>]. In fact, genes then could be treated as quantitative variables (e.g., coverage or prevalence) rather than binary, which is possible for covariates in phylogenetic linear models and simply changes the interpretation of the association coefficient <italic>β</italic><sub>1,<italic>g</italic></sub>.</p>
<p>Another potential extension would be to model prevalence and environment-specific prevalence for taxa other than the species clusters analyzed in this study. We focused on four prevalent and abundant phyla of bacteria, but our methods could be applied more broadly as long as quantitative phenotypes and genotypes could be accurately estimated. Phylogenetic linear modeling could also be applied directly to genera or higher taxonomic groups, although both phenotypes and genotypes would be averaged over more diverse sets of genomes, which could result in associations with different signs canceling out. As more genome and metagenome data is generated for microbial populations over time, extensions of phylogenetic linear modeling (e.g., with random effects [<xref ref-type="bibr" rid="pcbi.1006242.ref059">59</xref>]) may also be useful for studying associations between phenotypes and evolving gene copy number and single nucleotide variants at the strain level. This application would require accurate trees with strains as leaves, each with estimates of a phenotype and genotype. Additionally, our current definition of species approximates a 95% average nucleotide identity (ANI) cutoff; while this approach is a standard bioinformatic approach [<xref ref-type="bibr" rid="pcbi.1006242.ref060">60</xref>], and appears to be a “natural boundary” in analyses of genome compendia [<xref ref-type="bibr" rid="pcbi.1006242.ref061">61</xref>], the precise definition of a bacterial species remains a matter of active debate, and in the future may include phenotypic information [<xref ref-type="bibr" rid="pcbi.1006242.ref062">62</xref>] or information about gene flow [<xref ref-type="bibr" rid="pcbi.1006242.ref063">63</xref>]. Beyond prevalence, other phenotypes will also be interesting to investigate, especially experimentally measured phenotypes from high throughput screens and other techniques that complement genomics.</p>
<p>In summary, using phylogenetic linear models, we were able to discover thousands of specific gene families associated with quantitative phenotypes calculated directly from data: overall gut prevalence, a specificity score for the gut over other body sites, and a specificity score for the gut in Crohn’s disease versus health. Importantly, we have shown through simulation and real examples that standard linear models are inadequate for this task because of an unacceptably high false-positive rate under realistic conditions. Furthermore, many of the results we found also have biological plausibility, both from the literature on specific microbial pathways and from a high-throughput <italic>in vivo</italic> screen directly measuring colonization efficiency. In addition to these expected discoveries, we also found thousands of novel candidates for understanding and potentially manipulating gut colonization. These results illustrate the potential of integrating phylogeny with shotgun metagenomic data to deepen our understanding of the factors determining which microbes come to constitute our gut microbiota in health and disease.</p>
</sec>
<sec id="sec011" sec-type="materials|methods">
<title>Methods</title>
<p>A graphical overview of our statistical methods can be found in <xref ref-type="supplementary-material" rid="pcbi.1006242.s007">S2 Fig</xref>. Additionally, we provide a glossary of mathematical notation used in this section in <xref ref-type="supplementary-material" rid="pcbi.1006242.s001">S1 Appendix</xref>.</p>
<sec id="sec012">
<title>Species definition</title>
<p>We utilized the previously published clustering of 31,007 high-quality bacterial genomes into 5,952 species from the MIDAS 1.0 database [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>] (<ext-link ext-link-type="uri" xlink:href="http://lighthouse.ucsf.edu/MIDAS/midas_db_v1.0.tar.gz" xlink:type="simple">http://lighthouse.ucsf.edu/MIDAS/midas_db_v1.0.tar.gz</ext-link>). These species clusters are sets of genomes with high pairwise sequence similarity across a panel of 30 universal, single-copy genes. The genomes in each species clustering have approximately 95% average genome-wide nucleotide identity, a common “gold-standard” definition of bacterial and archaeal species [<xref ref-type="bibr" rid="pcbi.1006242.ref064">64</xref>]. These species-level taxonomic units are similar to, but can differ from, operational taxonomic units (OTUs) defined solely on the basis of the 16S rRNA gene.</p>
<p>Taxonomic annotations for each species were drawn from the MIDAS 1.0 database. Some taxonomic annotations of species in the MIDAS database were incomplete; these were fixed by searching the NCBI Taxonomy database using their web API via the <monospace>rentrez</monospace> package [<xref ref-type="bibr" rid="pcbi.1006242.ref065">65</xref>] and retrieving the full set of taxonomic annotations.</p>
</sec>
<sec id="sec013">
<title>Pangenomes</title>
<p>Pangenomes for all species used in this study were downloaded from the MIDAS 1.0 database. As previously described [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>], pangenomes were constructed by clustering the DNA sequences of the genes found across all strains of each species at 95% sequence identity using UCLUST [<xref ref-type="bibr" rid="pcbi.1006242.ref066">66</xref>]. Pangenomes were functionally annotated based on the FIGfams [<xref ref-type="bibr" rid="pcbi.1006242.ref037">37</xref>] which were included in the MIDAS databases and originally obtained from the PATRIC [<xref ref-type="bibr" rid="pcbi.1006242.ref067">67</xref>] database. Thus, each pangenome represents the set of known, non-redundant genes from each bacterial species with at least one sequenced isolate.</p>
</sec>
<sec id="sec014">
<title>Phylogenetic tree construction</title>
<p>The tree used for phylogenetic analyses was based on the tree from Nayfach et al. [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>] based on an approximate maximum likelihood using FastTree 2 [<xref ref-type="bibr" rid="pcbi.1006242.ref068">68</xref>] on a concatenated alignment (using MUSCLE [<xref ref-type="bibr" rid="pcbi.1006242.ref069">69</xref>]) of thirty universal genes. Thus, each tip in the tree represents the phylogenetic placement for one bacterial species. For the current analyses, the tree was rooted using the cyanobacterium <italic>Prochlorococcus marinus</italic> as an outgroup, and the tree was then divided by phylum, retaining the four most prevalent phyla in the human gut (Bacteroidetes, Firmicutes, Actinobacteria, and Proteobacteria). One Actinobacterial species cluster, the radiation-resistant bacterium <italic>Kineococcus radiotolerans</italic>, was dropped from the tree because it had an extremely long branch length, indicating an unusual degree of divergence. Finally, phylum-specific trees were made ultrametric using the <monospace>chronos</monospace> function in the R package <monospace>ape</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref070">70</xref>], assuming the default “correlated rates” model of substitution rate variation. We performed this step because first, our taxa were contemporaneously sampled, and second, we assumed that our phenotypes of interest varied with divergence time, as opposed to the number of substitutions per site separating marker gene sequences [<xref ref-type="bibr" rid="pcbi.1006242.ref071">71</xref>].</p>
</sec>
<sec id="sec015">
<title>Estimating species abundance across human associated metagenomes</title>
<p>Metagenome samples were drawn from subjects in the Human Microbiome Project (HMP) [<xref ref-type="bibr" rid="pcbi.1006242.ref035">35</xref>], the MetaHIT consortium [<xref ref-type="bibr" rid="pcbi.1006242.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref053">53</xref>], a study of glucose control [<xref ref-type="bibr" rid="pcbi.1006242.ref072">72</xref>], and a study of type 2 diabetes [<xref ref-type="bibr" rid="pcbi.1006242.ref073">73</xref>]. Accession numbers were identified using the aid of SRAdb [<xref ref-type="bibr" rid="pcbi.1006242.ref074">74</xref>] and downloaded from the Sequence Read Archive (SRA) [<xref ref-type="bibr" rid="pcbi.1006242.ref075">75</xref>]. The relative abundance of bacterial species in the metagenomes was estimated using MIDAS v1.0 [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>], which maps reads to a panel of 15 phylogenetic marker genes. Species relative abundances are computed as previously described [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>] (“Species abundance estimation”): essentially, they are normalized counts of reads mapping to bacterial species, with non-uniquely mapped reads assigned probabilistically.</p>
<p>Accession IDs used can be found in <xref ref-type="supplementary-material" rid="pcbi.1006242.s005">S4 Table</xref>. For prevalence estimates, we used healthy subjects from all four cohorts; for body site comparisons, we used only healthy subjects from HMP [<xref ref-type="bibr" rid="pcbi.1006242.ref035">35</xref>], and for the Crohn’s case-control comparison, we used only subjects from the MetaHIT consortium [<xref ref-type="bibr" rid="pcbi.1006242.ref052">52</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref053">53</xref>].</p>
</sec>
<sec id="sec016">
<title>Modeling gene-phenotype associations</title>
<p>The basic design is the same for all models that we fit: we model the effect of a categorical variable, gene (specifically, FIGfam family) presence vs. absence, on a particular phenotype estimated for many microbes from data.</p>
<p>Here, let <inline-formula id="pcbi.1006242.e009"><alternatives><graphic id="pcbi.1006242.e009g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e009" xlink:type="simple"/><mml:math display="inline" id="M9"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> refer to a vector whose elements <italic>ϕ</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic>[,<italic>D</italic>]</sub>(<italic>A</italic>) refer to an estimate of the phenotype <italic>ϕ</italic> for a microbe <italic>m</italic>, in an environment <italic>e</italic><sub><italic>x</italic></sub> from a set of <italic>k</italic> environments <italic>E</italic> = {<italic>e</italic><sub>1</sub>, …<italic>e</italic><sub><italic>k</italic></sub>}, optionally also adjusting for potential dataset effects <italic>D</italic>, based on a matrix of microbial presence-absence data <italic>A</italic>. We then model the effect on this phenotype of having vs. lacking each particular gene <italic>g</italic>, fitting one model per gene:
<disp-formula id="pcbi.1006242.e010"><alternatives><graphic id="pcbi.1006242.e010g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e010" xlink:type="simple"/><mml:math display="block" id="M10"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>g</mml:mi></mml:mrow></mml:msub> <mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>β</italic><sub>0</sub> is a baseline intercept value, <italic>β</italic><sub>1,<italic>g</italic></sub> is the effect size of gene <italic>g</italic>, <inline-formula id="pcbi.1006242.e011"><alternatives><graphic id="pcbi.1006242.e011g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e011" xlink:type="simple"/><mml:math display="inline" id="M11"><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub></mml:math></alternatives></inline-formula> is a binary vector whose elements <italic>I</italic><sub><italic>g</italic>,<italic>m</italic></sub> are 1 when microbe <italic>m</italic>’s pangenome contains the gene <italic>g</italic> and 0 otherwise, and <inline-formula id="pcbi.1006242.e012"><alternatives><graphic id="pcbi.1006242.e012g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e012" xlink:type="simple"/><mml:math display="inline" id="M12"><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are the residuals. We then test the null hypothesis <italic>H</italic><sub>0</sub>: <italic>β</italic><sub>1,<italic>g</italic></sub> = 0, yielding one <italic>p</italic>-value per gene; the resulting genewise <italic>p</italic>-values are finally corrected for multiple testing using an adaptive false discovery rate approach (<italic>q</italic>-value estimation).</p>
<p>The differences in the models we fit concern only how we obtain phenotype estimates <inline-formula id="pcbi.1006242.e013"><alternatives><graphic id="pcbi.1006242.e013g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e013" xlink:type="simple"/><mml:math display="inline" id="M13"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>[</mml:mo> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi> <mml:mo>]</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and our assumptions about how the residuals <inline-formula id="pcbi.1006242.e014"><alternatives><graphic id="pcbi.1006242.e014g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e014" xlink:type="simple"/><mml:math display="inline" id="M14"><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub></mml:math></alternatives></inline-formula> are distributed.</p>
</sec>
<sec id="sec017">
<title>Fitting linear vs. phylogenetic models</title>
<p>The phylogenetic and standard linear models are very similar, except for the assumptions about the distribution of the residuals. In the standard linear model, the residuals are assumed to be independently and identically distributed as a normal distribution, i.e., <inline-formula id="pcbi.1006242.e015"><alternatives><graphic id="pcbi.1006242.e015g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e015" xlink:type="simple"/><mml:math display="inline" id="M15"><mml:mrow><mml:msub><mml:mi>ϵ</mml:mi> <mml:mrow><mml:mi>g</mml:mi> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> or using multivariate notation <inline-formula id="pcbi.1006242.e016"><alternatives><graphic id="pcbi.1006242.e016g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e016" xlink:type="simple"/><mml:math display="inline" id="M16"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>ϵ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>g</mml:mi></mml:msub> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mi>I</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. In the phylogenetic model, in contrast, the residuals are not independent: rather, they are correlated based on the phylogenetic relatedness of the species. They are therefore distributed <inline-formula id="pcbi.1006242.e017"><alternatives><graphic id="pcbi.1006242.e017g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e017" xlink:type="simple"/><mml:math display="inline" id="M17"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>Σ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, with the following covariance matrix:
<disp-formula id="pcbi.1006242.e018"><alternatives><graphic id="pcbi.1006242.e018g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e018" xlink:type="simple"/><mml:math display="block" id="M18"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>Σ</mml:mo> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mtd> <mml:mtd><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mo>⋯</mml:mo></mml:mtd> <mml:mtd><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd/><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd/><mml:mtd/><mml:mtd><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>i</italic> is the number of species, <italic>σ</italic><sup>2</sup> is the overall variance, and <italic>σ</italic><sub>1,2</sub> is the covariance between species 1 and species 2. Under the assumption of the phylogenetic model (evolution of a continuous phenotype according to Brownian motion), this covariance is proportional to the distance between the last common ancestor of species 1 and 2 and the root of the tree. Thus, very closely-related species have a common ancestor that is far from the root, while the last common ancestor of two unrelated species is the root node itself. This method was first described in Grafen [<xref ref-type="bibr" rid="pcbi.1006242.ref026">26</xref>]; for this study, we use the implementation in the phylolm R package [<xref ref-type="bibr" rid="pcbi.1006242.ref076">76</xref>].</p>
<p><italic>β</italic><sub>1</sub> parameters were tested for a significant difference from 0 and the resulting <italic>p</italic>-values were converted to <italic>q</italic>-values using Storey and Tibshirani’s FDR correction procedure [<xref ref-type="bibr" rid="pcbi.1006242.ref077">77</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref078">78</xref>].</p>
</sec>
<sec id="sec018">
<title>Metagenomic presence-absence data</title>
<p>We use binary presence-absence data to calculate the phenotypes of interest. More formally, we conceptualize the metagenomic data as a matrix <italic>A</italic> of microbial presence-absence with dimensions <italic>i</italic> × <italic>j</italic>, where <italic>i</italic> is the number of microbes and <italic>j</italic> is the number of samples, and <italic>a</italic><sub><italic>m</italic>,<italic>n</italic></sub> is 1 if the relative abundance of microbe <italic>m</italic> (calculated using MIDAS’s taxonomic profiling [<xref ref-type="bibr" rid="pcbi.1006242.ref032">32</xref>]) is greater than 0, and 0 otherwise:
<disp-formula id="pcbi.1006242.e019"><alternatives><graphic id="pcbi.1006242.e019g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e019" xlink:type="simple"/><mml:math display="block" id="M19"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>A</mml:mi> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mo>⋯</mml:mo></mml:mtd> <mml:mtd><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd/><mml:mtd><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd/><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd> <mml:mtd><mml:mo>⋮</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub></mml:mtd> <mml:mtd><mml:mo>⋯</mml:mo></mml:mtd> <mml:mtd><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>i</mml:mi> <mml:mo>,</mml:mo> <mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>We conceptualize each <italic>e</italic><sub>1</sub>, <italic>e</italic><sub>2</sub>, …, <italic>e</italic><sub><italic>k</italic></sub> ∈ <italic>E</italic> as a set of indices, referring to samples collected from that environment, e.g., the oropharynx in healthy subjects, or the gut in subjects with Crohn’s disease, such that for all <italic>e</italic><sub><italic>x</italic></sub> ∈ <italic>E</italic>, <italic>e</italic><sub><italic>x</italic></sub> ⊆ {1, 2, …, <italic>j</italic>}. Because one environment may be tested in multiple studies, for our prevalence estimates, we also define a similar mapping of samples to datasets <italic>d</italic><sub>1</sub>, <italic>d</italic><sub>2</sub>, …, <italic>d</italic><sub><italic>l</italic></sub> ∈ <italic>D</italic> such that for all <italic>d</italic><sub><italic>y</italic></sub> ∈ <italic>D</italic>, <italic>d</italic><sub><italic>y</italic></sub> ⊆ {1, 2, …, <italic>j</italic>}. (For calculating environmental specificity scores, to avoid having to correct for unbalanced designs, we only use single datasets that measured all environments to be compared.) We also assume that <italic>E</italic> and <italic>D</italic> are partitions of {1, 2, …, <italic>j</italic>}, such that every sample is covered and no sample belongs to multiple <italic>e</italic><sub><italic>x</italic></sub> or <italic>d</italic><sub><italic>y</italic></sub>.</p>
</sec>
<sec id="sec019">
<title>Estimating the prevalence phenotype</title>
<p>The first phenotype we consider is prevalence, <italic>p</italic>. Prevalence is usually defined as the fraction of samples in which a particular taxon is observed. Using the formulation above, the prevalence of microbe <italic>m</italic> in environment <italic>e</italic><sub><italic>x</italic></sub> and study <italic>d</italic><sub><italic>y</italic></sub> would be equal to:
<disp-formula id="pcbi.1006242.e020"><alternatives><graphic id="pcbi.1006242.e020g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e020" xlink:type="simple"/><mml:math display="block" id="M20"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where we denote the quantity <inline-formula id="pcbi.1006242.e197"><alternatives><graphic id="pcbi.1006242.e197g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e197" xlink:type="simple"/><mml:math display="inline" id="M197"><mml:mrow><mml:msub><mml:mrow><mml:mo>∑</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>∈</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>(1), yielding the number of samples in the intersection of environment <italic>e</italic><sub><italic>x</italic></sub> and study <italic>d</italic><sub><italic>y</italic></sub>, as ||<italic>e</italic><sub><italic>x</italic></sub> ∩ <italic>d</italic><sub><italic>y</italic></sub>||.</p>
<p>We now take a slightly more general definition, such that a particular taxon’s true prevalence <italic>p</italic><sub><italic>m</italic>,(<italic>e</italic><sub><italic>x</italic></sub> ∩ <italic>d</italic><sub><italic>y</italic></sub>)</sub> is the probability of observing a particular microbe <italic>m</italic> in a set of samples (<italic>e</italic><sub><italic>x</italic></sub> ∩ <italic>d</italic><sub><italic>y</italic></sub>), <italic>P</italic>(<italic>m</italic>|(<italic>e</italic><sub><italic>x</italic></sub> ∩ <italic>d</italic><sub><italic>y</italic></sub>)). More specifically, we can say that <inline-formula id="pcbi.1006242.e198"><alternatives><graphic id="pcbi.1006242.e198g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e198" xlink:type="simple"/><mml:math display="inline" id="M198"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is the probability parameter of the Bernoulli random variable <italic>a</italic><sub><italic>m</italic>,<italic>n</italic></sub>, <italic>n</italic> ∈ (<italic>e</italic><sub><italic>x</italic></sub> ∩ <italic>d</italic><sub><italic>y</italic></sub>), which generates the values in our data matrix <italic>A</italic>:
<disp-formula id="pcbi.1006242.e021"><alternatives><graphic id="pcbi.1006242.e021g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e021" xlink:type="simple"/><mml:math display="block" id="M21"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mtext>Bernoulli</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mspace width="4pt"/><mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
The maximum likelihood estimator of <inline-formula id="pcbi.1006242.e199"><alternatives><graphic id="pcbi.1006242.e199g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e199" xlink:type="simple"/><mml:math display="inline" id="M199"><mml:mrow><mml:msub><mml:mrow><mml:mi>p</mml:mi></mml:mrow><mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>∩</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mi>y</mml:mi></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> given the data matrix <italic>A</italic> is then, as above, the fraction of subjects in <italic>F</italic> in which microbe <italic>m</italic> was observed:
<disp-formula id="pcbi.1006242.e022"><alternatives><graphic id="pcbi.1006242.e022g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e022" xlink:type="simple"/><mml:math display="block" id="M22"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>ML</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Because <italic>p</italic> is a proportion or probability, it is bounded between 0 and 1. The distribution of <italic>p</italic> is therefore highly non-normal, potentially violating assumptions of our regression model. We will therefore use logit(<italic>p</italic>) as our phenotype. However, this now introduces a problem because <inline-formula id="pcbi.1006242.e023"><alternatives><graphic id="pcbi.1006242.e023g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e023" xlink:type="simple"/><mml:math display="inline" id="M23"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mrow><mml:mtext>MLE</mml:mtext></mml:mrow></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula> can take the values 0 and 1, leading to infinite estimates of <inline-formula id="pcbi.1006242.e024"><alternatives><graphic id="pcbi.1006242.e024g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e024" xlink:type="simple"/><mml:math display="inline" id="M24"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We therefore instead use a shrunken estimate of <inline-formula id="pcbi.1006242.e025"><alternatives><graphic id="pcbi.1006242.e025g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e025" xlink:type="simple"/><mml:math display="inline" id="M25"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo stretchy="false">(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Shrinkage estimators reduce the variance in the estimate of a parameter by combining it with prior information. These priors can be estimated from data (as in empirical Bayes approaches), estimated from independent information about the distribution of the parameter, or selected to be uninformative. Here, we use an uninformative prior, in this case a uniform distribution:
<disp-formula id="pcbi.1006242.e026"><alternatives><graphic id="pcbi.1006242.e026g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e026" xlink:type="simple"/><mml:math display="block" id="M26"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mtext>Bernoulli</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:mo>∼</mml:mo> <mml:mtext>Beta</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Mechanistically, this is equivalent to performing additive smoothing, which effectively adds one pseudocount to the numbers of absences and presences:
<disp-formula id="pcbi.1006242.e027"><alternatives><graphic id="pcbi.1006242.e027g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e027" xlink:type="simple"/><mml:math display="block" id="M27"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:msub> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>+</mml:mo> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Finally, we note that this estimate of prevalence is only valid within a single study <italic>d</italic><sub><italic>y</italic></sub>. However, what we really want is an estimator of prevalence that depends only on the environment <italic>e</italic><sub><italic>x</italic></sub>. We therefore marginalize out the effect of <italic>d</italic><sub><italic>y</italic></sub>:
<disp-formula id="pcbi.1006242.e028"><alternatives><graphic id="pcbi.1006242.e028g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e028" xlink:type="simple"/><mml:math display="block" id="M28"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>y</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:munder><mml:mo>∑</mml:mo> <mml:mi>y</mml:mi></mml:munder> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where we let the prior probability <italic>P</italic>(<italic>d</italic><sub><italic>y</italic></sub>) simply be the inverse of the number of datasets present:
<disp-formula id="pcbi.1006242.e029"><alternatives><graphic id="pcbi.1006242.e029g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e029" xlink:type="simple"/><mml:math display="block" id="M29"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>‖</mml:mo> <mml:mi>D</mml:mi> <mml:mo>‖</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Effectively, this weights each dataset inverse-proportionally to the number of samples, so that the study with the largest number of samples does not dominate our estimates of prevalence. (An alternative weighting could use, for example, the square root of the sample size, as is sometimes performed in fixed-effect meta-analyses.)</p>
<p>To avoid effects from additive smoothing dominating our estimates (as might happen if the same smoothing were applied to samples with different numbers of samples), we first obtain a marginalized version of the maximum-likelihood estimator, then perform additive smoothing on these marginalized estimates:
<disp-formula id="pcbi.1006242.e030"><alternatives><graphic id="pcbi.1006242.e030g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e030" xlink:type="simple"/><mml:math display="block" id="M30"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>ADDW</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>y</mml:mi></mml:msub> <mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>ML</mml:mtext></mml:msubsup> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>‖</mml:mo> <mml:mi>D</mml:mi> <mml:mo>‖</mml:mo></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Finally, we use the logit of this estimate, i.e., <inline-formula id="pcbi.1006242.e031"><alternatives><graphic id="pcbi.1006242.e031g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e031" xlink:type="simple"/><mml:math display="inline" id="M31"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>ADDW</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, as the elements <inline-formula id="pcbi.1006242.e032"><alternatives><graphic id="pcbi.1006242.e032g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e032" xlink:type="simple"/><mml:math display="inline" id="M32"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> of our first phenotype <inline-formula id="pcbi.1006242.e033"><alternatives><graphic id="pcbi.1006242.e033g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e033" xlink:type="simple"/><mml:math display="inline" id="M33"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>:
<disp-formula id="pcbi.1006242.e034"><alternatives><graphic id="pcbi.1006242.e034g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e034" xlink:type="simple"/><mml:math display="block" id="M34"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mtext>logit</mml:mtext> <mml:mo>(</mml:mo> <mml:mfrac><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>y</mml:mi></mml:msub> <mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>ML</mml:mtext></mml:msubsup> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mo>‖</mml:mo> <mml:mi>D</mml:mi> <mml:mo>‖</mml:mo></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo> <mml:mo>(</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>∩</mml:mo> <mml:msub><mml:mi>d</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mrow><mml:mo>‖</mml:mo></mml:mrow> <mml:mo>)</mml:mo> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:mfrac> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>To recapitulate, we use a logit-transformed, shrunken estimate of prevalence in a given environment, weighted so that each study contributes equally.</p>
</sec>
<sec id="sec020">
<title>Estimating environmental specificity scores</title>
<sec id="sec021">
<title>Formulating the specificity score</title>
<p>Prevalence gives us information about how commonly a microbe is seen in a particular environment. While useful, this concept does not address the difference between microbes that are specific for a given environment and those that have a cosmopolitan distribution. We therefore wanted to design a statistic capturing this environmental specificity. We define this statistic in terms of how <italic>predictive</italic> a particular microbe is for one out of a set of possible environments. (For simplicity, we only consider cases in which all environments were measured within a single study, and therefore drop <italic>D</italic> from these equations. This estimator could be extended in the future to account for study effects as above.)</p>
<p>Recall that prevalence can be defined as the probability <italic>P</italic>(<italic>m</italic>|<italic>e</italic><sub><italic>x</italic></sub>), i.e., the probability of observing microbe <italic>m</italic> in environment <italic>e</italic><sub><italic>x</italic></sub>. To avoid potential sources of confounding error, we only consider environments both measured within the same study. We therefore let the environmental specificity score <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub> equal the probability of observing a particular environment <italic>e</italic><sub><italic>x</italic></sub> out of a set of <italic>k</italic> environments <italic>E</italic> = {<italic>e</italic><sub>1</sub>, <italic>e</italic><sub>2</sub>, …, <italic>e</italic><sub><italic>k</italic></sub>}, given that we observe microbe <italic>m</italic>:
<disp-formula id="pcbi.1006242.e035"><alternatives><graphic id="pcbi.1006242.e035g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e035" xlink:type="simple"/><mml:math display="block" id="M35"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
which, by application of Bayes’ rule and then marginalization, becomes:
<disp-formula id="pcbi.1006242.e036"><alternatives><graphic id="pcbi.1006242.e036g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e036" xlink:type="simple"/><mml:math display="block" id="M36"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>|</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>P</italic>(<italic>m</italic>|<italic>e</italic><sub><italic>x</italic></sub>) is the prevalence <inline-formula id="pcbi.1006242.e037"><alternatives><graphic id="pcbi.1006242.e037g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e037" xlink:type="simple"/><mml:math display="inline" id="M37"><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> of microbe <italic>m</italic> in environment <italic>e</italic><sub><italic>x</italic></sub> ∈ <italic>E</italic>, and <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>) is the prior probability of observing environment <italic>e</italic><sub><italic>x</italic></sub>. The priors <italic>P</italic>(<italic>e</italic>) can be uninformative, in which case <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>) = 1/<italic>k</italic> for all <italic>x</italic>, meaning that all environments are equally likely. This is the approach we take for body site comparisons. Alternatively, for a disease state, they could be drawn from actual epidemiological data about the frequency of that disease in the population of interest. This is the approach we take for the Crohn’s disease comparisons, taking <italic>P</italic>(<italic>e</italic><sub>CD</sub>) = 0.002 [<xref ref-type="bibr" rid="pcbi.1006242.ref079">79</xref>], since in a Crohn’s case-control study, the fraction of individuals with Crohn’s will be much higher than the true prevalence of this disease in the population. In either case, the <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>) values do not depend on the values in the dataset <italic>A</italic>. An intriguing third possibility that would depend on <italic>A</italic> would be to estimate the priors <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>) based on the average observed <italic>α</italic>-diversity within environment <italic>e</italic><sub><italic>x</italic></sub>, such that more diverse environments would be modeled as <italic>a priori</italic> more likely to contain any particular microbe.</p>
</sec>
<sec id="sec022">
<title>Motivating a shrunken estimator of <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub>(<italic>A</italic>)</title>
<p>One simple way to estimate <inline-formula id="pcbi.1006242.e038"><alternatives><graphic id="pcbi.1006242.e038g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e038" xlink:type="simple"/><mml:math display="inline" id="M38"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> would be to simply plug in our estimates of <inline-formula id="pcbi.1006242.e039"><alternatives><graphic id="pcbi.1006242.e039g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e039" xlink:type="simple"/><mml:math display="inline" id="M39"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, yielding:
<disp-formula id="pcbi.1006242.e040"><alternatives><graphic id="pcbi.1006242.e040g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e040" xlink:type="simple"/><mml:math display="block" id="M40"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
However, for cases in which the number of total observations of a microbe <inline-formula id="pcbi.1006242.e041"><alternatives><graphic id="pcbi.1006242.e041g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e041" xlink:type="simple"/><mml:math display="inline" id="M41"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula> is low (imagine, e.g., a microbe that is observed once in environment <italic>e</italic><sub>1</sub> and zero times in <italic>e</italic><sub>2</sub>), even the shrunken estimate <inline-formula id="pcbi.1006242.e042"><alternatives><graphic id="pcbi.1006242.e042g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e042" xlink:type="simple"/><mml:math display="inline" id="M42"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> will have relatively high variance. This is particularly problematic here because both the numerator and denominator of <inline-formula id="pcbi.1006242.e043"><alternatives><graphic id="pcbi.1006242.e043g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e043" xlink:type="simple"/><mml:math display="inline" id="M43"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> depend on <inline-formula id="pcbi.1006242.e044"><alternatives><graphic id="pcbi.1006242.e044g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e044" xlink:type="simple"/><mml:math display="inline" id="M44"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, so as <italic>p</italic><sub><italic>m</italic>,1,<italic>E</italic></sub> → 0, the standard error of <inline-formula id="pcbi.1006242.e045"><alternatives><graphic id="pcbi.1006242.e045g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e045" xlink:type="simple"/><mml:math display="inline" id="M45"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> will tend to increase. This means that the microbes with the least-confidently estimated prevalences will tend to have high leverages in the regression, distorting the results. The confounding between the magnitude of <inline-formula id="pcbi.1006242.e046"><alternatives><graphic id="pcbi.1006242.e046g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e046" xlink:type="simple"/><mml:math display="inline" id="M46"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and its standard error also leads to heteroskedasticity, or unequal variance across the residuals, violating one of the main linear model assumptions.</p>
<p>To account for these issues, we construct a more aggressively-shrunk estimator of <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub>. We assume that most microbes do not differ substantially between environments, and therefore shrink estimates of <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub> = <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>|<italic>m</italic>) towards the prior probability <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>), indicating that that this microbe is uninformative about the environment. To accomplish this, we use a maximum <italic>a posteriori</italic> (MAP) estimator, <inline-formula id="pcbi.1006242.e047"><alternatives><graphic id="pcbi.1006242.e047g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e047" xlink:type="simple"/><mml:math display="inline" id="M47"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>MAP</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, with a Laplace prior centered on <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>). Laplace priors are also used in the Bayesian lasso to make parameter estimates more sparse, by shrinking them to zero. However, critically, we are not using the Laplace prior to perform model selection, since the exact same model is fit as in <xref ref-type="disp-formula" rid="pcbi.1006242.e001">Eq (1)</xref>; we are only using it to reduce the variance in estimating <inline-formula id="pcbi.1006242.e048"><alternatives><graphic id="pcbi.1006242.e048g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e048" xlink:type="simple"/><mml:math display="inline" id="M48"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>; unlike the Bayesian lasso, we therefore use no information about the independent variable (gene presence-absence) in obtaining estimates of <inline-formula id="pcbi.1006242.e049"><alternatives><graphic id="pcbi.1006242.e049g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e049" xlink:type="simple"/><mml:math display="inline" id="M49"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec023">
<title>An estimator of <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub> using Laplace shrinkage</title>
<p>We are interested in estimating the specificity score <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub> of a microbe <italic>m</italic> in environment <italic>e</italic><sub><italic>x</italic></sub>, given observations of microbial presence or absence <italic>a</italic><sub><italic>m</italic>,<italic>n</italic></sub> where <italic>n</italic> is a sample, a mapping of samples to environments <italic>E</italic>, and the prior probability <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>) of choosing the environment <italic>e</italic><sub><italic>x</italic></sub> ∈ <italic>E</italic>. In order to do this, we construct a model of the data that depends on <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub>, then maximize the posterior probability of observing the data given the model.</p>
<p>Previously, we modeled the presence-absence data <italic>a</italic><sub><italic>m</italic>,<italic>n</italic></sub> in terms of prevalence <inline-formula id="pcbi.1006242.e050"><alternatives><graphic id="pcbi.1006242.e050g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e050" xlink:type="simple"/><mml:math display="inline" id="M50"><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. It is therefore useful to define a function of our parameter of interest <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub> that yields <inline-formula id="pcbi.1006242.e051"><alternatives><graphic id="pcbi.1006242.e051g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e051" xlink:type="simple"/><mml:math display="inline" id="M51"><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. We first restate the definition of the specificity score <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub>, noting that it depends on the prevalences <inline-formula id="pcbi.1006242.e052"><alternatives><graphic id="pcbi.1006242.e052g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e052" xlink:type="simple"/><mml:math display="inline" id="M52"><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> of microbe <italic>m</italic> across all <italic>k</italic> environments <italic>e</italic><sub><italic>y</italic></sub> ∈ <italic>E</italic>, ||<italic>E</italic>|| = <italic>k</italic>, and the prior probabilities of these environments <italic>P</italic>(<italic>e</italic><sub><italic>y</italic></sub>):
<disp-formula id="pcbi.1006242.e053"><alternatives><graphic id="pcbi.1006242.e053g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e053" xlink:type="simple"/><mml:math display="block" id="M53"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Rearranging this equation to get the prevalence in an environment <inline-formula id="pcbi.1006242.e054"><alternatives><graphic id="pcbi.1006242.e054g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e054" xlink:type="simple"/><mml:math display="inline" id="M54"><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> in terms of specificity <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub>, we get:
<disp-formula id="pcbi.1006242.e055"><alternatives><graphic id="pcbi.1006242.e055g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e055" xlink:type="simple"/><mml:math display="block" id="M55"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We then define the function <italic>h</italic>(<italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub>) as the function that transforms specificity scores into prevalences:
<disp-formula id="pcbi.1006242.e056"><alternatives><graphic id="pcbi.1006242.e056g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e056" xlink:type="simple"/><mml:math display="block" id="M56"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Next we consider the Laplace distribution that we use as the prior for our specificity score <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub>. This distribution has two parameters, a mean and a width. The mean is given by the prior probability of environment <italic>e</italic><sub><italic>x</italic></sub>, <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>). For the moment, we assume that we have chosen a width <italic>b</italic>, which governs the amount of shrinkage. We can then model the environmental specificity score as follows:
<disp-formula id="pcbi.1006242.e057"><alternatives><graphic id="pcbi.1006242.e057g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e057" xlink:type="simple"/><mml:math display="block" id="M57"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Laplace</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="0.222222em"/><mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Bernoulli</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We can then obtain an estimate of <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub> given the prior probability of environment <italic>e</italic><sub><italic>x</italic></sub> (<italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>)), our observed data <italic>a</italic><sub><italic>m</italic>,<italic>n</italic></sub>, and a Laplace width <italic>b</italic>, by maximizing the posterior probability of our data <italic>a</italic><sub><italic>m</italic>,<italic>n</italic></sub>. This maximum <italic>a posteriori</italic> (MAP) estimate takes the following form:
<disp-formula id="pcbi.1006242.e058"><alternatives><graphic id="pcbi.1006242.e058g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e058" xlink:type="simple"/><mml:math display="block" id="M58"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>MAP</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>;</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mtext>argmax</mml:mtext> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:msub> <mml:mi>ℒ</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>|</mml:mo> <mml:mi>h</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo> <mml:mi>f</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>|</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(2)</label></disp-formula>
where <inline-formula id="pcbi.1006242.e059"><alternatives><graphic id="pcbi.1006242.e059g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e059" xlink:type="simple"/><mml:math display="inline" id="M59"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is the parameter being estimated, <italic>A</italic> represents our data matrix with elements <italic>a</italic><sub><italic>m</italic>,<italic>n</italic></sub>, <italic>ℒ</italic> represents the likelihood function of the distribution from which the data is assumed to be drawn, <italic>f</italic> represents the density function of our Laplace prior on <italic>s</italic> (without which the estimator reduces to the maximum-likelihood estimator), and <italic>b</italic> is the given width parameter as above.</p>
<p>In order to calculate <italic>h</italic>(<italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub>), we need to know the prevalences across all environments <inline-formula id="pcbi.1006242.e060"><alternatives><graphic id="pcbi.1006242.e060g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e060" xlink:type="simple"/><mml:math display="inline" id="M60"><mml:mrow><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>∈</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, which are not given. However, we can estimate them as before from <italic>a</italic><sub><italic>m</italic>,<italic>n</italic></sub>. We let <italic>h</italic><sup>ML</sup> be the function <italic>h</italic> where the values of <inline-formula id="pcbi.1006242.e061"><alternatives><graphic id="pcbi.1006242.e061g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e061" xlink:type="simple"/><mml:math display="inline" id="M61"><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> come from the maximum-likelihood estimates <inline-formula id="pcbi.1006242.e062"><alternatives><graphic id="pcbi.1006242.e062g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e062" xlink:type="simple"/><mml:math display="inline" id="M62"><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow> <mml:mtext>ML</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, so that:
<disp-formula id="pcbi.1006242.e063"><alternatives><graphic id="pcbi.1006242.e063g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e063" xlink:type="simple"/><mml:math display="block" id="M63"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mi>h</mml:mi> <mml:mtext>ML</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>k</mml:mi></mml:msubsup> <mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi></mml:mrow> <mml:mtext>ML</mml:mtext></mml:msubsup> <mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mi>P</mml:mi> <mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>We can now expand this to give the final maximization:
<disp-formula id="pcbi.1006242.e064"><alternatives><graphic id="pcbi.1006242.e064g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e064" xlink:type="simple"/><mml:math display="block" id="M64"><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mrow><mml:mtext>MAP</mml:mtext></mml:mrow></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>A</mml:mi> <mml:mo>;</mml:mo> <mml:mi>b</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msub><mml:mrow><mml:mtext>argmax</mml:mtext></mml:mrow> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow> <mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msubsup><mml:mrow/> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mrow><mml:mo>‖</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>‖</mml:mo></mml:mrow></mml:msubsup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msup><mml:mi>h</mml:mi> <mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup> <mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>−</mml:mo> <mml:msup><mml:mi>h</mml:mi> <mml:mrow><mml:mtext>ML</mml:mtext></mml:mrow></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>,</mml:mo> <mml:mi>A</mml:mi></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mrow><mml:mo>‖</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub> <mml:mo>‖</mml:mo> <mml:mo>−</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mrow><mml:mi>o</mml:mi> <mml:mi>b</mml:mi> <mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msup></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>×</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow/></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mn>2</mml:mn> <mml:mi>b</mml:mi></mml:mrow></mml:mfrac> <mml:mtext>exp</mml:mtext> <mml:mo stretchy="false">(</mml:mo> <mml:mo>−</mml:mo> <mml:mfrac><mml:mrow><mml:mo>|</mml:mo> <mml:mtext>logit</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>s</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>−</mml:mo> <mml:mtext>logit</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo stretchy="false">)</mml:mo> <mml:mo>|</mml:mo></mml:mrow> <mml:mi>b</mml:mi></mml:mfrac></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives> <label>(3)</label></disp-formula>
where <italic>n</italic><sub><italic>obs</italic></sub> refers to <inline-formula id="pcbi.1006242.e065"><alternatives><graphic id="pcbi.1006242.e065g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e065" xlink:type="simple"/><mml:math display="inline" id="M65"><mml:mrow><mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>x</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:msub><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:math></alternatives></inline-formula>, i.e., the number of times microbe <italic>m</italic> was observed in environment <italic>e</italic><sub><italic>x</italic></sub>.</p>
</sec>
<sec id="sec024">
<title>Choosing the Laplace width parameter</title>
<p>We have assumed above that we are given the Laplace width parameter <italic>b</italic>. To choose appropriate, dataset-specific values of <italic>b</italic>, which controls how much <inline-formula id="pcbi.1006242.e066"><alternatives><graphic id="pcbi.1006242.e066g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e066" xlink:type="simple"/><mml:math display="inline" id="M66"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>MAP</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>;</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is shrunk back to the prior, we performed simulations. We chose a simulation-based approach instead of, for example, cross-validation because we lacked labeled examples of microbes that truly differed between environments. Instead, we constructed datasets <italic>A</italic>′ with elements <inline-formula id="pcbi.1006242.e067"><alternatives><graphic id="pcbi.1006242.e067g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e067" xlink:type="simple"/><mml:math display="inline" id="M67"><mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> where we “knew” that some microbes (<italic>m</italic> ∈ <italic>M</italic><sub>0</sub>) were not informative about the environment and others (<italic>m</italic> ∉ <italic>M</italic><sub>0</sub>) had “true” differences, by simulating data with the following model:
<disp-formula id="pcbi.1006242.e068"><alternatives><graphic id="pcbi.1006242.e068g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e068" xlink:type="simple"/><mml:math display="block" id="M68"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Bernoulli</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>p</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>q</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>≠</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mtext>logistic</mml:mtext> <mml:mo>(</mml:mo> <mml:mtext>logit</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>q</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>+</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>=</mml:mo> <mml:mi>x</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mi>z</mml:mi> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>·</mml:mo> <mml:mo>(</mml:mo> <mml:mtext>Bernoulli</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>r</mml:mi> <mml:mo>)</mml:mo> <mml:mo>)</mml:mo> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>∉</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>∈</mml:mo> <mml:msub><mml:mi>M</mml:mi> <mml:mn>0</mml:mn></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>q</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Beta</mml:mtext> <mml:mo>(</mml:mo> <mml:mi>a</mml:mi> <mml:mo>,</mml:mo> <mml:mi>b</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>In other words, for each species <italic>m</italic> in different environments <italic>e</italic><sub><italic>y</italic></sub> ∈ <italic>E</italic>, presence-absence <inline-formula id="pcbi.1006242.e069"><alternatives><graphic id="pcbi.1006242.e069g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e069" xlink:type="simple"/><mml:math display="inline" id="M69"><mml:msubsup><mml:mi>a</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mi>y</mml:mi></mml:msub></mml:mrow> <mml:mo>′</mml:mo></mml:msubsup></mml:math></alternatives></inline-formula> was modeled as a Bernoulli random variable. The success parameter from this Bernoulli was drawn from a Beta distribution with parameters <italic>a</italic> and <italic>b</italic>, which were fit from a single environment in the corresponding real dataset using maximum-likelihood, thus ensuring that the simulated species had similar baseline prevalences as real species. In species with no difference between environments <italic>m</italic> ∈ <italic>M</italic><sub>0</sub>, the true prevalence <italic>p</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub> was set to be equal between the environment of interest <italic>e</italic><sub><italic>x</italic></sub> and all other environments; in species with true differences between environments (<italic>m</italic> ∉ <italic>M</italic><sub>0</sub>), in contrast, the effect size <italic>z</italic> was either added or subtracted from the logit-prevalence (with the parameter <italic>r</italic> controlling the proportion of positive true effects). The number of null species ||<italic>M</italic><sub>0</sub>|| was set to 25% of the total number of simulated species ||<italic>M</italic>||, which was matched to the real dataset.</p>
<p>For a given simulated dataset and value of <italic>b</italic>, the false positive rate (<italic>FPR</italic><sub><italic>b</italic></sub>) and the true positive rates for <italic>F</italic> &gt; 0 and <italic>F</italic> &lt; 0 (<italic>TPR</italic><sub><italic>pos</italic></sub> and <italic>TPR</italic><sub><italic>neg</italic></sub>, respectively) were calculated:
<disp-formula id="pcbi.1006242.e070"><alternatives><graphic id="pcbi.1006242.e070g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e070" xlink:type="simple"/><mml:math display="block" id="M70"><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>#</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow> <mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>&gt;</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo>‖</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>‖</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>p</mml:mi><mml:mi>o</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>#</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>m</mml:mi></mml:msub></mml:mrow><mml:mo>&gt;</mml:mo></mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo>#</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>T</mml:mi><mml:mi>P</mml:mi><mml:msub><mml:mi>R</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mi>e</mml:mi><mml:msub><mml:mi>g</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:mtd><mml:mtd columnalign="left"><mml:mrow><mml:mo>=</mml:mo><mml:mo>#</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>e</mml:mi><mml:mi>x</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mrow><mml:mo>&lt;</mml:mo> <mml:mrow><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>&gt;</mml:mo></mml:mrow><mml:mi>ϵ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mo>#</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>m</mml:mi></mml:msub><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Since we are using numerical optimization, posterior probabilities are not always shrunk exactly to the prior; we therefore use a tolerance parameter <italic>δ</italic> set at <italic>P</italic>(<italic>e</italic><sub><italic>x</italic></sub>) ⋅ 0.005 to account for numerical error. The tuning parameter <italic>b</italic> was then optimized according to the following piecewise continuous function, which increases from 0 to 1 until the false positive rate drops to 0.05 or lower (in order to guide the optimizer), and then increases above 1 in proportion to the average (geometric mean) of the positive and negative effect true positive rates:
<disp-formula id="pcbi.1006242.e071"><alternatives><graphic id="pcbi.1006242.e071g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e071" xlink:type="simple"/><mml:math display="block" id="M71"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msub><mml:mi>b</mml:mi> <mml:mtext>optim</mml:mtext></mml:msub> <mml:mo>=</mml:mo> <mml:msub><mml:mtext>argmax</mml:mtext> <mml:mi>b</mml:mi></mml:msub> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:mi>F</mml:mi> <mml:mi>P</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi> <mml:mi>P</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mrow><mml:mn>1</mml:mn> <mml:mo>+</mml:mo> <mml:msqrt><mml:mrow><mml:mi>T</mml:mi> <mml:mi>P</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>p</mml:mi> <mml:mi>o</mml:mi> <mml:msub><mml:mi>s</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub> <mml:mo>×</mml:mo> <mml:mi>T</mml:mi> <mml:mi>P</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mrow><mml:mi>n</mml:mi> <mml:mi>e</mml:mi> <mml:msub><mml:mi>g</mml:mi> <mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mi>F</mml:mi> <mml:mi>P</mml:mi> <mml:msub><mml:mi>R</mml:mi> <mml:mi>b</mml:mi></mml:msub> <mml:mo>≤</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>05</mml:mn></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>Given <italic>z</italic> = 2 and <italic>r</italic> = 0.5, for Crohn’s disease, <italic>b</italic><sub>optim</sub> was estimated at <italic>b</italic> = 0.16 and for the body site specificity, <italic>b</italic><sub>optim</sub> was estimated at <italic>b</italic> = 0.282. (Changing <italic>z</italic> to 1 or 0.5, or changing <italic>r</italic> to 0.1 or 0.9, resulted in very similar estimates of <italic>b</italic><sub>optim</sub>. Additionally, <italic>b</italic><sub>optim</sub> estimates were consistent across several orders of magnitude of <italic>ϵ</italic>; see <xref ref-type="supplementary-material" rid="pcbi.1006242.s009">S4 Fig</xref>).</p>
</sec>
<sec id="sec025">
<title>Worked example</title>
<p>An example showing the effect of this procedure on real data can be seen in <xref ref-type="supplementary-material" rid="pcbi.1006242.s008">S3 Fig</xref>. The microbe <italic>Bacillus subtilis</italic> is detected once in the healthy cohort and once in the Crohn’s cohort, while <italic>Bacteroides fragilis</italic> is present in 24/38 healthy subjects but 13/13 Crohn’s subjects (<xref ref-type="supplementary-material" rid="pcbi.1006242.s008">S3A Fig</xref>). The maximum-likelihood values of <inline-formula id="pcbi.1006242.e072"><alternatives><graphic id="pcbi.1006242.e072g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e072" xlink:type="simple"/><mml:math display="inline" id="M72"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>CD</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006242.e073"><alternatives><graphic id="pcbi.1006242.e073g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e073" xlink:type="simple"/><mml:math display="inline" id="M73"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>CD</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> are therefore much higher for <italic>B. subtilis</italic> than for <italic>B. fragilis</italic>, even though the evidence for a difference across environments in the prevalence of <italic>B. subtilis</italic> is much weaker (<xref ref-type="supplementary-material" rid="pcbi.1006242.s008">S3B and S3C Fig</xref>). In contrast, the Laplace prior (<xref ref-type="supplementary-material" rid="pcbi.1006242.s008">S3D Fig</xref>) successfully shrinks the estimate of the <italic>B. subtilis</italic> specificity score back to the baseline (<italic>P</italic>(<italic>e</italic><sub>CD</sub>) = 0.002), while the evidence for <italic>B. fragilis</italic> overcomes this prior and yields an estimate close to the maximum-likelihood value (0.0031; <xref ref-type="supplementary-material" rid="pcbi.1006242.s008">S3E Fig</xref>).</p>
</sec>
</sec>
<sec id="sec026">
<title>Alternatives to shrinkage estimation of environmental specificity scores</title>
<p>An alternative to using the Laplace shrinkage estimator would be to allow all taxa to contribute to the regression, but to downweight taxa with less-confidently measured phenotypes. In generalized least squares (GLS), this is typically accomplished by scaling the variance-covariance matrix of the residuals by the variances of the estimators. This in effect says that the residuals are expected to be more dispersed around the regression line when the variance of the estimator is high: equivalently, this procedure weights each point in least-squares by the inverse of the estimator’s variance. We represent these variances as <inline-formula id="pcbi.1006242.e074"><alternatives><graphic id="pcbi.1006242.e074g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e074" xlink:type="simple"/><mml:math display="inline" id="M74"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>≡</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mi>S</mml:mi> <mml:mi>E</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. The covariance matrix is then:
<disp-formula id="pcbi.1006242.e075"><alternatives><graphic id="pcbi.1006242.e075g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e075" xlink:type="simple"/><mml:math display="block" id="M75"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mo>Σ</mml:mo> <mml:mtext>WLS</mml:mtext></mml:msup> <mml:mo>=</mml:mo> <mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:msub> <mml:msqrt><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mtd> <mml:mtd><mml:mo>⋯</mml:mo></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>m</mml:mi></mml:mrow></mml:msub> <mml:msqrt><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:msqrt><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mo>⋮</mml:mo></mml:mtd> <mml:mtd/><mml:mtd><mml:mo>⋱</mml:mo></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:msub> <mml:msqrt><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mtd> <mml:mtd/><mml:mtd/><mml:mtd><mml:mrow><mml:msub><mml:mi>σ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:msub><mml:mi>v</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <italic>σ</italic> values are as above. (Off-diagonal elements are weighted by the geometric mean of the variances, thus giving the same correlation structure as before.)</p>
<p>Because we have the data matrix <italic>A</italic> from which <inline-formula id="pcbi.1006242.e076"><alternatives><graphic id="pcbi.1006242.e076g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e076" xlink:type="simple"/><mml:math display="inline" id="M76"><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> was estimated, we can estimate the variances of these estimates by bootstrapping. Denoting the <inline-formula id="pcbi.1006242.e077"><alternatives><graphic id="pcbi.1006242.e077g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e077" xlink:type="simple"/><mml:math display="inline" id="M77"><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> estimates derived from bootstrap sample <italic>c</italic> as <inline-formula id="pcbi.1006242.e078"><alternatives><graphic id="pcbi.1006242.e078g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e078" xlink:type="simple"/><mml:math display="inline" id="M78"><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula>, where <italic>c</italic> ∈ {1, <italic>C</italic>} and <italic>C</italic> is the number of bootstraps, and letting the mean across bootstrap samples be <inline-formula id="pcbi.1006242.e079"><alternatives><graphic id="pcbi.1006242.e079g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e079" xlink:type="simple"/><mml:math display="inline" id="M79"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, then <inline-formula id="pcbi.1006242.e080"><alternatives><graphic id="pcbi.1006242.e080g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e080" xlink:type="simple"/><mml:math display="inline" id="M80"><mml:mrow><mml:msub><mml:mi>v</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>C</mml:mi> <mml:mo>-</mml:mo> <mml:mn>1</mml:mn></mml:mrow></mml:mfrac> <mml:msubsup><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>Both approaches (Laplace shrinkage estimation and WLS) account for variability in the accuracy of estimating <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub>, but in different ways. We would expect them to agree more when <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub> values were more confidently estimated (meaning the evidence for difference from the prior would be stronger and the extent of downweighting would be lower), and when more of the <italic>s</italic><sub><italic>m</italic>,<italic>x</italic>,<italic>E</italic></sub> values diverged substantially from the prior (leading to less sparsity in <inline-formula id="pcbi.1006242.e081"><alternatives><graphic id="pcbi.1006242.e081g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e081" xlink:type="simple"/><mml:math display="inline" id="M81"><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>Laplace</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>). Indeed, when comparing body site specificities, which are based on higher numbers of samples and involve comparisons across highly divergent environments, both approaches yield more similar estimates, and become more concordant when the effect sizes are calculated only over significantly-different gene families. In contrast, for the Crohn’s disease comparison, in which the environments (healthy vs. diseased gut) are more closely related and the number of samples is smaller, the two methods tend to disagree more, especially in phyla where most taxa are shrunk back to the prior (<xref ref-type="supplementary-material" rid="pcbi.1006242.s003">S2 Table</xref>). (We implemented WLS using the <monospace>gls</monospace> function provided by the <monospace>nlme</monospace> R package [<xref ref-type="bibr" rid="pcbi.1006242.ref080">80</xref>].)</p>
<p>These results reflect the different underlying assumptions of each estimator: Laplace shrinkage assumes that taxa are not truly varying across environments without strong evidence, while WLS uses information from all taxa but downweights less-confidently-observed species. For the purposes of this manuscript, we focused on the results based on Laplace shrinkage estimation, since we believe the assumption that most taxa do not change is appropriate when comparing the same body site in health and disease. However, either approach may be preferable depending on the precise scenario being studied. It could also be possible to combine the two approaches by, for example, using the full posterior distribution of <inline-formula id="pcbi.1006242.e082"><alternatives><graphic id="pcbi.1006242.e082g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e082" xlink:type="simple"/><mml:math display="inline" id="M82"><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> to derive weights.</p>
</sec>
<sec id="sec027">
<title>Power analysis</title>
<p>To test the power and false positive rate of our method, we used parametric simulations, either under the null hypothesis in which a gene had no effect on the phenotype, or under the alternative hypothesis in which it had a defined effect. These involved generating one binary genotype and one continuous phenotype per simulation. These were parameterized as follows:</p>
<list list-type="bullet">
<list-item>
<p>The continuous phenotype <inline-formula id="pcbi.1006242.e083"><alternatives><graphic id="pcbi.1006242.e083g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e083" xlink:type="simple"/><mml:math display="inline" id="M83"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Sim</mml:mtext></mml:msup></mml:math></alternatives></inline-formula> is simulated according to a Brownian motion model with parameters <italic>β</italic><sub>0</sub> corresponding to the ancestral state of the phenotype and <italic>σ</italic><sup>2</sup> corresponding to the phenotype’s overall variance (i.e., the diagonal of Σ in the phylogenetic model).</p>
</list-item>
<list-item>
<p>The binary genotype <inline-formula id="pcbi.1006242.e084"><alternatives><graphic id="pcbi.1006242.e084g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e084" xlink:type="simple"/><mml:math display="inline" id="M84"><mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Sim</mml:mtext></mml:msup></mml:math></alternatives></inline-formula> is generated from a Markov process as in Ives and Garland [<xref ref-type="bibr" rid="pcbi.1006242.ref034">34</xref>], with parameters <italic>α</italic> and <italic>β</italic><sub>1</sub>. <italic>α</italic> gives the sum of the transition probabilities going from 0 to 1 and from 1 to 0. <italic>β</italic><sub>1</sub> gives the effect size: that is, how much the simulated phenotype influences the binary genotype (in logit space).</p>
</list-item>
</list>
<p>We perform the following process, given a choice of <italic>α</italic> and <italic>β</italic><sub>1</sub>, for each phylum <italic>h</italic>:</p>
<list list-type="order">
<list-item>
<p>Estimate the parameters <inline-formula id="pcbi.1006242.e085"><alternatives><graphic id="pcbi.1006242.e085g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e085" xlink:type="simple"/><mml:math display="inline" id="M85"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006242.e086"><alternatives><graphic id="pcbi.1006242.e086g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e086" xlink:type="simple"/><mml:math display="inline" id="M86"><mml:mover accent="true"><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> by fitting the following intercept-only phylogenetic model to the real prevalence phenotype:
<disp-formula id="pcbi.1006242.e087">
<alternatives>
<graphic id="pcbi.1006242.e087g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e087" xlink:type="simple"/>
<mml:math display="block" id="M87">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:msubsup>
<mml:mover accent="true">
<mml:mi>ϕ</mml:mi>
<mml:mo>→</mml:mo>
</mml:mover>
<mml:mrow>
<mml:mi>x</mml:mi>
<mml:mo>,</mml:mo>
<mml:mi>E</mml:mi>
</mml:mrow>
<mml:mtext>Prev</mml:mtext>
</mml:msubsup>
<mml:mrow>
<mml:mo>(</mml:mo>
<mml:mi>A</mml:mi>
<mml:mo>)</mml:mo>
</mml:mrow>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mi>β</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:mtext>Prev</mml:mtext>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:mover accent="true">
<mml:mi>ϵ</mml:mi>
<mml:mo>→</mml:mo>
</mml:mover>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
</disp-formula>
where <inline-formula id="pcbi.1006242.e088"><alternatives><graphic id="pcbi.1006242.e088g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e088" xlink:type="simple"/><mml:math display="inline" id="M88"><mml:mrow><mml:mi>ϵ</mml:mi> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mo>Σ</mml:mo> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and Diag(Σ) = <italic>σ</italic><sup>2</sup>.</p>
</list-item>
<list-item>
<p>For each of <italic>B</italic> simulations:</p>
<list list-type="alpha-lower">
<list-item>
<p>Generate a continuous phenotype <inline-formula id="pcbi.1006242.e089"><alternatives><graphic id="pcbi.1006242.e089g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e089" xlink:type="simple"/><mml:math display="inline" id="M89"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Sim</mml:mtext></mml:msup></mml:math></alternatives></inline-formula> according to a Brownian motion process, evolving along the tree of phylum <italic>h</italic>, with parameters <inline-formula id="pcbi.1006242.e090"><alternatives><graphic id="pcbi.1006242.e090g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e090" xlink:type="simple"/><mml:math display="inline" id="M90"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006242.e091"><alternatives><graphic id="pcbi.1006242.e091g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e091" xlink:type="simple"/><mml:math display="inline" id="M91"><mml:mover accent="true"><mml:msup><mml:mi>σ</mml:mi> <mml:mn>2</mml:mn></mml:msup> <mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Generate a binary genotype <inline-formula id="pcbi.1006242.e092"><alternatives><graphic id="pcbi.1006242.e092g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e092" xlink:type="simple"/><mml:math display="inline" id="M92"><mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Sim</mml:mtext></mml:msup></mml:math></alternatives></inline-formula> according to an Ives-Garland Markov process with parameters <italic>α</italic> and <italic>β</italic><sub>1</sub> and a covariate <inline-formula id="pcbi.1006242.e093"><alternatives><graphic id="pcbi.1006242.e093g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e093" xlink:type="simple"/><mml:math display="inline" id="M93"><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>Sim</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>.</p>
</list-item>
<list-item>
<p>Fit the following regression equation:
<disp-formula id="pcbi.1006242.e094"><alternatives><graphic id="pcbi.1006242.e094g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e094" xlink:type="simple"/><mml:math display="block" id="M94"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Sim</mml:mtext></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup> <mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Sim</mml:mtext></mml:msup> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
using either a standard linear model or the phylogenetic model (as specified in Methods, “Fitting linear vs. phylogenetic models”).</p>
</list-item>
<list-item>
<p>Return the <italic>p</italic>-value for the test of the null hypothesis <inline-formula id="pcbi.1006242.e095"><alternatives><graphic id="pcbi.1006242.e095g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e095" xlink:type="simple"/><mml:math display="inline" id="M95"><mml:mrow><mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</list-item>
</list>
</list-item>
<list-item>
<p>The fraction of <italic>p</italic>-values ≤ 0.05 yields the power (when given <italic>β</italic><sub>1</sub> &gt; 0) or the false positive rate (when given <italic>β</italic><sub>1</sub> = 0) of the test.</p>
</list-item>
</list>
<p>The binary genotype effect size <italic>β</italic><sub>1</sub> is not a linear function of the effect of the gene on prevalence. A more intuitive description of the effect size might be the (average) fold-change in prevalence associated with a gene’s presence. Because the parameters <italic>β</italic><sup><italic>Test</italic></sup> are on a logit scale, this quantity would be equal to:
<disp-formula id="pcbi.1006242.e096"><alternatives><graphic id="pcbi.1006242.e096g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e096" xlink:type="simple"/><mml:math display="block" id="M96"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mi>F</mml:mi> <mml:mo>=</mml:mo> <mml:mfrac><mml:mrow><mml:mtext>logistic</mml:mtext> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mrow><mml:mtext>logistic</mml:mtext> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mfrac></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
This quantity will depend on the amount of phylogenetic signal in the binary genotype <italic>α</italic>, the tree along which genotypes and phenotypes are simulated, and the “input” effect size <italic>β</italic><sub>1</sub>. Accordingly, we simulated sets of 50 binary genotypes with given effect sizes <italic>β</italic><sub>1</sub> ∈ {0, 0.5, 0.75, 1.0, 1.25} and values of <italic>α</italic> ∈ {0, 25, 50}. While there is substantial variation, in general an “input” effect size (i.e., <italic>β</italic><sub>1</sub>) of 1.0 approximately corresponds to <italic>F</italic> ≈ 1.72, a 72% increase in prevalence, and an “input” effect size of 0.5 corresponds to <italic>F</italic> ≈ 1.5, a 50% increase (<xref ref-type="supplementary-material" rid="pcbi.1006242.s013">S8 Fig</xref>).</p>
</sec>
<sec id="sec028">
<title>Assessing the potential impact of sampling with left-censoring</title>
<p>One potential pitfall with applying linear methods occurs when the distribution of the response variable (here, our phenotype) has a minimum value. This arises because, within a particular dataset, the lowest possible value of <inline-formula id="pcbi.1006242.e097"><alternatives><graphic id="pcbi.1006242.e097g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e097" xlink:type="simple"/><mml:math display="inline" id="M97"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is equal to (||<italic>e</italic><sub><italic>x</italic></sub>|| + 2)<sup>−1</sup>, where ||<italic>e</italic><sub><italic>x</italic></sub>|| is the number of samples in environment <italic>e</italic><sub><italic>x</italic></sub>. This phenomenon is referred to as “left-censoring.” (Some may have encountered the term “left-censoring” in the context of participants who join a study having already experienced an event of interest. The time they experienced this event is therefore lower by an unknown amount than the lowest-possible measured value. While the domain and application are different, the statistical phenomenon is the same.) Left-censoring can result in inaccurate <italic>p</italic>-values because the variance is mis-estimated for the data points below the limit of detection. We therefore empirically assessed the impact of left-censoring in simulation, and also created extensions of the method to be used when its impact is noticeable.</p>
<p>Empirically, our prevalence phenotype <inline-formula id="pcbi.1006242.e098"><alternatives><graphic id="pcbi.1006242.e098g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e098" xlink:type="simple"/><mml:math display="inline" id="M98"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> displays substantial left-censoring (<xref ref-type="supplementary-material" rid="pcbi.1006242.s011">S6A Fig</xref>). The distribution of this phenotype fits well to a normal with left-censoring at the limit of detection, in this case approximately −0.50 standard deviations below the mean (AIC using truncated normal and censoring: 20844.82; AIC using standard normal: 21833.38).</p>
<p>We therefore repeated the simulation process above, but after using our continuous phenotype to generate the binary genotype in step 2.b, we truncated the continuous phenotype <inline-formula id="pcbi.1006242.e099"><alternatives><graphic id="pcbi.1006242.e099g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e099" xlink:type="simple"/><mml:math display="inline" id="M99"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Sim</mml:mtext></mml:msup></mml:math></alternatives></inline-formula> artificially at a specified number of standard deviations <italic>K</italic> below the mean, yielding <inline-formula id="pcbi.1006242.e100"><alternatives><graphic id="pcbi.1006242.e100g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e100" xlink:type="simple"/><mml:math display="inline" id="M100"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Cens</mml:mtext></mml:msup></mml:math></alternatives></inline-formula>. We then replaced <inline-formula id="pcbi.1006242.e101"><alternatives><graphic id="pcbi.1006242.e101g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e101" xlink:type="simple"/><mml:math display="inline" id="M101"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Sim</mml:mtext></mml:msup></mml:math></alternatives></inline-formula> with <inline-formula id="pcbi.1006242.e102"><alternatives><graphic id="pcbi.1006242.e102g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e102" xlink:type="simple"/><mml:math display="inline" id="M102"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Cens</mml:mtext></mml:msup></mml:math></alternatives></inline-formula> in the regression in step 2.c.</p>
<p>Using this simulation framework, we benchmarked three different ways to test the significance of <inline-formula id="pcbi.1006242.e103"><alternatives><graphic id="pcbi.1006242.e103g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e103" xlink:type="simple"/><mml:math display="inline" id="M103"><mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> in the phylogenetic model. We computed p-values in one of the following three ways:</p>
<list list-type="order">
<list-item>
<p><sc>t</sc>-<sc>statistic</sc>: Return the <italic>p</italic>-value of a <italic>t</italic>-test of the null hypothesis that <inline-formula id="pcbi.1006242.e104"><alternatives><graphic id="pcbi.1006242.e104g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e104" xlink:type="simple"/><mml:math display="inline" id="M104"><mml:mrow><mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:mn>0</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>, as in Methods, “Modeling gene-phenotype association”.</p>
</list-item>
<list-item>
<p>P<sc>arametric</sc> B<sc>ootstrap</sc>: Simulate a number <italic>C</italic> of null binary genotypes <inline-formula id="pcbi.1006242.e105"><alternatives><graphic id="pcbi.1006242.e105g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e105" xlink:type="simple"/><mml:math display="inline" id="M105"><mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>c</mml:mi></mml:msup></mml:math></alternatives></inline-formula> with <italic>β</italic><sub>1</sub> = 0, where <italic>c</italic> ∈ {1, …, <italic>C</italic>′}, and collect the estimates <inline-formula id="pcbi.1006242.e106"><alternatives><graphic id="pcbi.1006242.e106g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e106" xlink:type="simple"/><mml:math display="inline" id="M106"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> based on the following phylogenetic linear model:
<disp-formula id="pcbi.1006242.e107"><alternatives><graphic id="pcbi.1006242.e107g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e107" xlink:type="simple"/><mml:math display="block" id="M107"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Sim</mml:mtext></mml:msup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>0</mml:mn></mml:mrow> <mml:mtext>c</mml:mtext></mml:msubsup> <mml:mo>+</mml:mo> <mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>c</mml:mtext></mml:msubsup> <mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>c</mml:mi></mml:msup> <mml:mo>+</mml:mo> <mml:mi>ϵ</mml:mi></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
Then compute the fraction that are at least as extreme as the test statistic <inline-formula id="pcbi.1006242.e108"><alternatives><graphic id="pcbi.1006242.e108g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e108" xlink:type="simple"/><mml:math display="inline" id="M108"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and return this as a <italic>p</italic>-value:
<disp-formula id="pcbi.1006242.e109"><alternatives><graphic id="pcbi.1006242.e109g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e109" xlink:type="simple"/><mml:math display="block" id="M109"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>C</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:munderover> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≥</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mtext>Test</mml:mtext></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1006242.e110"><alternatives><graphic id="pcbi.1006242.e110g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e110" xlink:type="simple"/><mml:math display="inline" id="M110"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the mean of <inline-formula id="pcbi.1006242.e111"><alternatives><graphic id="pcbi.1006242.e111g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e111" xlink:type="simple"/><mml:math display="inline" id="M111"><mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> values. To save computation time on high <italic>p</italic>-values, we use early stopping: after every 25 such simulations, if the resulting <italic>p</italic>-value would already be guaranteed to exceed 0.05, we stop and return the <italic>p</italic>-value based on the current number of simulations.</p>
</list-item>
<list-item>
<p>M<sc>ock</sc>-U<sc>ncensored</sc> B<sc>ootstrap</sc>: As #2, simulate a number <italic>C</italic> of additional binary genotypes with <italic>β</italic><sub>1</sub> = 0. Instead of calculating <italic>p</italic>-values as in #2, however:</p>
<list list-type="alpha-lower">
<list-item>
<p>Simulate the same number <italic>C</italic> of “uncensored” versions of the continuous phenotype <inline-formula id="pcbi.1006242.e112"><alternatives><graphic id="pcbi.1006242.e112g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e112" xlink:type="simple"/><mml:math display="inline" id="M112"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mtext>Unc</mml:mtext> <mml:mi>c</mml:mi></mml:msup></mml:msup></mml:math></alternatives></inline-formula>, in effect “filling in” or imputing the censored values with random values from the predicted tail of the distribution (see <xref ref-type="supplementary-material" rid="pcbi.1006242.s011">S6B and S6C Fig</xref> for an illustration):</p>
<list list-type="roman-lower">
<list-item>
<p>First, fit a left-truncated normal distribution to the part of <inline-formula id="pcbi.1006242.e113"><alternatives><graphic id="pcbi.1006242.e113g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e113" xlink:type="simple"/><mml:math display="inline" id="M113"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mtext>Cens</mml:mtext></mml:msup></mml:math></alternatives></inline-formula> that is above the lowest value (assumed to be the limit of detection) by maximum likelihood (using <monospace>fitdistcens</monospace> in R package <monospace>fitdistrplus</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref081">81</xref>]), yielding mean <italic>μ</italic><sup>Trunc</sup>, standard deviation <inline-formula id="pcbi.1006242.e114"><alternatives><graphic id="pcbi.1006242.e114g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e114" xlink:type="simple"/><mml:math display="inline" id="M114"><mml:msup><mml:mi>σ</mml:mi> <mml:msup><mml:mn>2</mml:mn> <mml:mtext>Trunc</mml:mtext></mml:msup></mml:msup></mml:math></alternatives></inline-formula>, and lower truncation point <inline-formula id="pcbi.1006242.e115"><alternatives><graphic id="pcbi.1006242.e115g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e115" xlink:type="simple"/><mml:math display="inline" id="M115"><mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mtext>Cens</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> statistics (e.g., <xref ref-type="supplementary-material" rid="pcbi.1006242.s011">S6B Fig</xref>).</p>
</list-item>
<list-item>
<p>Next, for <italic>c</italic> ∈ {1, …, <italic>C</italic>}, generate a vector <inline-formula id="pcbi.1006242.e116"><alternatives><graphic id="pcbi.1006242.e116g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e116" xlink:type="simple"/><mml:math display="inline" id="M116"><mml:msup><mml:mover accent="true"><mml:mi>T</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>c</mml:mi></mml:msup></mml:math></alternatives></inline-formula> whose elements <inline-formula id="pcbi.1006242.e117"><alternatives><graphic id="pcbi.1006242.e117g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e117" xlink:type="simple"/><mml:math display="inline" id="M117"><mml:msubsup><mml:mi>T</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> are realizations of the random variable <inline-formula id="pcbi.1006242.e118"><alternatives><graphic id="pcbi.1006242.e118g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e118" xlink:type="simple"/><mml:math display="inline" id="M118"><mml:mrow><mml:mi>T</mml:mi> <mml:mo>∼</mml:mo> <mml:msup><mml:mi>N</mml:mi> <mml:mtext>RTrunc</mml:mtext></mml:msup> <mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mi>μ</mml:mi> <mml:mtext>Trunc</mml:mtext></mml:msup> <mml:mo>,</mml:mo> <mml:msup><mml:mi>σ</mml:mi> <mml:msup><mml:mn>2</mml:mn> <mml:mtext>Trunc</mml:mtext></mml:msup></mml:msup> <mml:mo>,</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mtext>Cens</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here, <italic>N</italic><sup>RTrunc</sup> represents a right-truncated normal distribution, having mean <italic>μ</italic><sup>Trunc</sup>, variance <inline-formula id="pcbi.1006242.e119"><alternatives><graphic id="pcbi.1006242.e119g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e119" xlink:type="simple"/><mml:math display="inline" id="M119"><mml:msup><mml:mi>σ</mml:mi> <mml:msup><mml:mn>2</mml:mn> <mml:mtext>Trunc</mml:mtext></mml:msup></mml:msup></mml:math></alternatives></inline-formula>, and upper truncation point <inline-formula id="pcbi.1006242.e120"><alternatives><graphic id="pcbi.1006242.e120g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e120" xlink:type="simple"/><mml:math display="inline" id="M120"><mml:mrow><mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mtext>Cens</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>). Then generate the “uncensored” vector <inline-formula id="pcbi.1006242.e121"><alternatives><graphic id="pcbi.1006242.e121g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e121" xlink:type="simple"/><mml:math display="inline" id="M121"><mml:msup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:msup><mml:mtext>Unc</mml:mtext> <mml:mi>c</mml:mi></mml:msup></mml:msup></mml:math></alternatives></inline-formula> with elements <inline-formula id="pcbi.1006242.e122"><alternatives><graphic id="pcbi.1006242.e122g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e122" xlink:type="simple"/><mml:math display="inline" id="M122"><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:msup><mml:mtext>Unc</mml:mtext> <mml:mi>c</mml:mi></mml:msup></mml:msubsup></mml:math></alternatives></inline-formula> as follows:
<disp-formula id="pcbi.1006242.e123"><alternatives><graphic id="pcbi.1006242.e123g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e123" xlink:type="simple"/><mml:math display="block" id="M123"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:msup><mml:mtext>Unc</mml:mtext> <mml:mi>c</mml:mi></mml:msup></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mtext>Cens</mml:mtext></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mtext>Cens</mml:mtext></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mtext>Cens</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:msub><mml:mi>T</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mtext>Cens</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:mo form="prefix" movablelimits="true">min</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mi>ϕ</mml:mi> <mml:mrow><mml:mi>m</mml:mi></mml:mrow> <mml:mtext>Cens</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
(An example can be seen in <xref ref-type="supplementary-material" rid="pcbi.1006242.s011">S6C Fig</xref>).</p>
</list-item>
</list>
</list-item>
<list-item>
<p>For each <italic>c</italic> ∈ {1, …, <italic>C</italic>}:</p>
<list list-type="roman-lower">
<list-item>
<p>estimate a test statistic <inline-formula id="pcbi.1006242.e124"><alternatives><graphic id="pcbi.1006242.e124g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e124" xlink:type="simple"/><mml:math display="inline" id="M124"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mtext>Test</mml:mtext> <mml:mi>c</mml:mi></mml:msup></mml:msubsup></mml:math></alternatives></inline-formula> by fitting the following phylogenetic linear model:
<disp-formula id="pcbi.1006242.e125">
<alternatives>
<graphic id="pcbi.1006242.e125g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e125" xlink:type="simple"/>
<mml:math display="block" id="M125">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:msup>
<mml:mover accent="true">
<mml:mi>ϕ</mml:mi>
<mml:mo>→</mml:mo>
</mml:mover>
<mml:msup>
<mml:mtext>Unc</mml:mtext>
<mml:mi>c</mml:mi>
</mml:msup>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mi>β</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:msup>
<mml:mtext>Test</mml:mtext>
<mml:mi>c</mml:mi>
</mml:msup>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mi>β</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:msup>
<mml:mtext>Test</mml:mtext>
<mml:mi>c</mml:mi>
</mml:msup>
</mml:msubsup>
<mml:msup>
<mml:mover accent="true">
<mml:mi>I</mml:mi>
<mml:mo>→</mml:mo>
</mml:mover>
<mml:mtext>Sim</mml:mtext>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mi>ϵ</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
</disp-formula>
</p></list-item>
<list-item>
<p>estimate a null test statistic <inline-formula id="pcbi.1006242.e126"><alternatives><graphic id="pcbi.1006242.e126g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e126" xlink:type="simple"/><mml:math display="inline" id="M126"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> by fitting the following phylogenetic linear model:
<disp-formula id="pcbi.1006242.e127">
<alternatives>
<graphic id="pcbi.1006242.e127g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e127" xlink:type="simple"/>
<mml:math display="block" id="M127">
<mml:mtable displaystyle="true">
<mml:mtr>
<mml:mtd columnalign="right">
<mml:mrow>
<mml:msup>
<mml:mover accent="true">
<mml:mi>ϕ</mml:mi>
<mml:mo>→</mml:mo>
</mml:mover>
<mml:msup>
<mml:mtext>Unc</mml:mtext>
<mml:mi>c</mml:mi>
</mml:msup>
</mml:msup>
<mml:mo>=</mml:mo>
<mml:msubsup>
<mml:mi>β</mml:mi>
<mml:mrow>
<mml:mn>0</mml:mn>
</mml:mrow>
<mml:msup>
<mml:mtext>Test</mml:mtext>
<mml:mi>c</mml:mi>
</mml:msup>
</mml:msubsup>
<mml:mo>+</mml:mo>
<mml:msubsup>
<mml:mi>β</mml:mi>
<mml:mrow>
<mml:mn>1</mml:mn>
</mml:mrow>
<mml:mi>c</mml:mi>
</mml:msubsup>
<mml:msup>
<mml:mover accent="true">
<mml:mi>I</mml:mi>
<mml:mo>→</mml:mo>
</mml:mover>
<mml:mtext>c</mml:mtext>
</mml:msup>
<mml:mo>+</mml:mo>
<mml:mi>ϵ</mml:mi>
</mml:mrow>
</mml:mtd>
</mml:mtr>
</mml:mtable>
</mml:math>
</alternatives>
</disp-formula></p>
</list-item>
</list>
</list-item>
<list-item>
<p>Calculate <italic>p</italic>-values as follows:
<disp-formula id="pcbi.1006242.e128"><alternatives><graphic id="pcbi.1006242.e128g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e128" xlink:type="simple"/><mml:math display="block" id="M128"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn> <mml:mi>C</mml:mi></mml:mfrac> <mml:munderover><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>c</mml:mi> <mml:mo>=</mml:mo> <mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:munderover> <mml:mo>{</mml:mo> <mml:mtable><mml:mtr><mml:mtd columnalign="left"><mml:mn>1</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≥</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mtext>Test</mml:mtext> <mml:mi>C</mml:mi></mml:msup></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="left"><mml:mn>0</mml:mn></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>(</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>&lt;</mml:mo> <mml:msup><mml:mrow><mml:mo>(</mml:mo> <mml:mrow><mml:mo>(</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:msup><mml:mtext>Test</mml:mtext> <mml:mi>C</mml:mi></mml:msup></mml:msubsup> <mml:mo>-</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow> <mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo/></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where <inline-formula id="pcbi.1006242.e129"><alternatives><graphic id="pcbi.1006242.e129g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e129" xlink:type="simple"/><mml:math display="inline" id="M129"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the mean of the <inline-formula id="pcbi.1006242.e130"><alternatives><graphic id="pcbi.1006242.e130g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e130" xlink:type="simple"/><mml:math display="inline" id="M130"><mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> values and <inline-formula id="pcbi.1006242.e131"><alternatives><graphic id="pcbi.1006242.e131g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e131" xlink:type="simple"/><mml:math display="inline" id="M131"><mml:msubsup><mml:mover accent="true"><mml:mi>β</mml:mi> <mml:mo>¯</mml:mo></mml:mover> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>C</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the mean of the <inline-formula id="pcbi.1006242.e132"><alternatives><graphic id="pcbi.1006242.e132g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e132" xlink:type="simple"/><mml:math display="inline" id="M132"><mml:msubsup><mml:mi>β</mml:mi> <mml:mrow><mml:mn>1</mml:mn></mml:mrow> <mml:mi>c</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> values.</p>
</list-item>
</list>
</list-item>
</list>
<p>Intuitively, the second method generates a null distribution via simulation, while the third method additionally reduces the impact of data points at the limit of detection, by randomly imputing them from the best-fit normal distribution. We then calculated power and FPR for each of these three methods, varying the amount of censoring <italic>K</italic> and the effect size <italic>β</italic><sub>1</sub> (see <xref ref-type="supplementary-material" rid="pcbi.1006242.s012">S7 Fig</xref>). Interestingly, for the level of censoring in our data (<italic>K</italic> = −0.50), the false-positive rate in all three methods remained well-controlled, although power dropped. The mock-uncensored bootstrap had lower power overall and became more conservative, especially in the case where the phylogenetic signal was highest (<italic>α</italic> = 0) and where the level of censorship <italic>K</italic> was highest.</p>
<p>Another common approach to this problem is the tobit model: the true value of the response variable is treated as a hidden variable, and expectation-maximization is used to fit the regression parameters based on the observed censored values. Given that the degree of censoring we observed did not appear to inflate the false positive rate in any of the methods we tested, we opted not to construct a phylogenetic tobit model; however, this could be an interesting area of future research.</p>
</sec>
<sec id="sec029">
<title>Assessing the impact of compositionality</title>
<p>Because relative abundances are compositional (i.e., sum to 1), changes in highly abundant taxa combined with read sampling can lead to skewed estimates of relative abundance. For example, if a very abundant microbe exhibits large changes in relative abundance across samples, other microbes will appear to become less abundant simply because they make up a smaller proportion of the total reads, regardless of whether their level has actually changed [<xref ref-type="bibr" rid="pcbi.1006242.ref082">82</xref>]. This necessitates the use of compositional data analysis methods such as fitting intrinsically compositional distributions to the data (e.g., multinomial [<xref ref-type="bibr" rid="pcbi.1006242.ref083">83</xref>]) or transforming them such that they no longer lie on a simplex (e.g., the clr-transform [<xref ref-type="bibr" rid="pcbi.1006242.ref084">84</xref>]). However, the impact of compositionality on prevalence was <italic>a priori</italic> less clear, because while prevalences are based on presence versus absence, which could be affected by sampling, prevalences themselves do not have to sum to any particular value. Nonetheless, since we compute prevalence from relative abundance, we undertook a simulation based investigation of prevalence estimation accuracy as a function of various study design and biological parameters.</p>
<p>To directly compare the degree to which spurious correlation in prevalence and relative abundance could be induced by compositionality, we simulated correlated absolute abundances of microbes with no true correlations between them, then converted these uncorrelated absolute abundances to relative abundances. To look for spurious correlation, we plotted the distribution of pairwise microbial correlations in absolute and relative abundances. We next used relative abundance to compute prevalence. Since there is only one prevalence measurement per microbe per data matrix, we repeated the simulation multiple times with the same parameters, then assessed microbial correlations across simulation runs, again starting from both absolute and relative abundances.</p>
<sec id="sec030">
<title>Simulating data</title>
<p>For each of 25 simulations <italic>i</italic> ∈ <italic>I</italic>, we assumed each of 1000 simulated microbes <italic>m</italic> ∈ <italic>M</italic> had absolute abundances <inline-formula id="pcbi.1006242.e133"><alternatives><graphic id="pcbi.1006242.e133g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e133" xlink:type="simple"/><mml:math display="inline" id="M133"><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, over a set of 100 simulated samples <italic>n</italic> ∈ <italic>N</italic>. These were independently log-normally distributed, centered on microbe-specific average values <italic>μ</italic><sub><italic>m</italic></sub> that were themselves log-normally distributed. We also assumed a microbe-specific prevalence <italic>z</italic><sub><italic>m</italic></sub> drawn from a logistic-normal distribution:
<disp-formula id="pcbi.1006242.e134"><alternatives><graphic id="pcbi.1006242.e134g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e134" xlink:type="simple"/><mml:math display="block" id="M134"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>log</mml:mtext> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>·</mml:mo> <mml:msub><mml:mi>c</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>c</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Bernoulli</mml:mtext> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>log</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>μ</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mn>3</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>4</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula></p>
<p>We converted the resulting absolute abundance matrices <inline-formula id="pcbi.1006242.e135"><alternatives><graphic id="pcbi.1006242.e135g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e135" xlink:type="simple"/><mml:math display="inline" id="M135"><mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> to relative abundances in two different ways. First, we simply column-normalized, yielding a matrix <inline-formula id="pcbi.1006242.e136"><alternatives><graphic id="pcbi.1006242.e136g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e136" xlink:type="simple"/><mml:math display="inline" id="M136"><mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relCN</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> with elements <inline-formula id="pcbi.1006242.e137"><alternatives><graphic id="pcbi.1006242.e137g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e137" xlink:type="simple"/><mml:math display="inline" id="M137"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>relCN</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup> <mml:mo>/</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>M</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>. Second, we first generated compositional count data <inline-formula id="pcbi.1006242.e138"><alternatives><graphic id="pcbi.1006242.e138g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e138" xlink:type="simple"/><mml:math display="inline" id="M138"><mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>Counts</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, with column vectors <inline-formula id="pcbi.1006242.e139"><alternatives><graphic id="pcbi.1006242.e139g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e139" xlink:type="simple"/><mml:math display="inline" id="M139"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Counts</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Counts</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="0.222222em"/><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Counts</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="0.222222em"/><mml:mo>…</mml:mo> <mml:mspace width="0.222222em"/><mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mrow><mml:mo>‖</mml:mo> <mml:mi>M</mml:mi> <mml:mo>‖</mml:mo> <mml:mo>,</mml:mo></mml:mrow> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Counts</mml:mtext></mml:msubsup> <mml:mo>]</mml:mo></mml:mrow> <mml:mi>t</mml:mi></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> simulated as follows:
<disp-formula id="pcbi.1006242.e140"><alternatives><graphic id="pcbi.1006242.e140g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e140" xlink:type="simple"/><mml:math display="block" id="M140"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msubsup><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Counts</mml:mtext></mml:msubsup></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Multinomial</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:msub><mml:mi>θ</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>θ</mml:mi> <mml:msub><mml:mi>n</mml:mi> <mml:mi>i</mml:mi></mml:msub></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Dirichlet</mml:mtext> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="0.222222em"/><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mn>2</mml:mn> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup> <mml:mo>,</mml:mo> <mml:mspace width="0.222222em"/><mml:mo>…</mml:mo> <mml:mspace width="0.222222em"/><mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mo>‖</mml:mo> <mml:mi>M</mml:mi> <mml:mo>‖</mml:mo> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>r</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>DiscreteUniform</mml:mtext> <mml:mo>(</mml:mo> <mml:msup><mml:mn>10</mml:mn> <mml:mn>5</mml:mn></mml:msup> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msup><mml:mn>10</mml:mn> <mml:mn>6</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
We then converted these counts to relative abundances <inline-formula id="pcbi.1006242.e141"><alternatives><graphic id="pcbi.1006242.e141g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e141" xlink:type="simple"/><mml:math display="inline" id="M141"><mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> such that <inline-formula id="pcbi.1006242.e142"><alternatives><graphic id="pcbi.1006242.e142g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e142" xlink:type="simple"/><mml:math display="inline" id="M142"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup> <mml:mo>=</mml:mo> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>i</mml:mi></mml:msub></mml:mrow> <mml:mtext>Counts</mml:mtext></mml:msubsup> <mml:mo>/</mml:mo> <mml:msub><mml:mo>∑</mml:mo> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>M</mml:mi></mml:mrow></mml:msub> <mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mtext>Counts</mml:mtext></mml:msubsup></mml:mrow></mml:math></alternatives></inline-formula>.</p>
</sec>
<sec id="sec031">
<title>Evaluating extent of spurious correlation for relative abundance</title>
<p>For each ||<italic>M</italic>|| × ||<italic>N</italic>|| matrix <italic>B</italic>, we obtained a set of correlations <inline-formula id="pcbi.1006242.e143"><alternatives><graphic id="pcbi.1006242.e143g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e143" xlink:type="simple"/><mml:math display="inline" id="M143"><mml:mrow><mml:mi>L</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msub><mml:mi>ρ</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>B</mml:mi></mml:msub></mml:msub> <mml:mo>:</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mi>y</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>x</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, where <inline-formula id="pcbi.1006242.e144"><alternatives><graphic id="pcbi.1006242.e144g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e144" xlink:type="simple"/><mml:math display="inline" id="M144"><mml:msub><mml:mi>ρ</mml:mi> <mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>B</mml:mi></mml:msub></mml:msub></mml:math></alternatives></inline-formula> is the Pearson correlation between the row-vectors <inline-formula id="pcbi.1006242.e145"><alternatives><graphic id="pcbi.1006242.e145g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e145" xlink:type="simple"/><mml:math display="inline" id="M145"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006242.e146"><alternatives><graphic id="pcbi.1006242.e146g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e146" xlink:type="simple"/><mml:math display="inline" id="M146"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>N</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>. <italic>L</italic>(<italic>A</italic>) can also be thought of as the entries in the lower-triangular part of the correlation matrix of a given <italic>B</italic>.</p>
<p>To show that compositionality is enough to induce spurious correlation in abundances, we computed the correlations from absolute abundances <inline-formula id="pcbi.1006242.e147"><alternatives><graphic id="pcbi.1006242.e147g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e147" xlink:type="simple"/><mml:math display="inline" id="M147"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and compared them with the correlation matrices derived from relative abundances, <inline-formula id="pcbi.1006242.e148"><alternatives><graphic id="pcbi.1006242.e148g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e148" xlink:type="simple"/><mml:math display="inline" id="M148"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relCN</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006242.e149"><alternatives><graphic id="pcbi.1006242.e149g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e149" xlink:type="simple"/><mml:math display="inline" id="M149"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. Because discrete sampling introduces many more zeros into the matrix <inline-formula id="pcbi.1006242.e150"><alternatives><graphic id="pcbi.1006242.e150g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e150" xlink:type="simple"/><mml:math display="inline" id="M150"><mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>, we also made the further comparison of pairwise correlations calculated using only non-zero elements of <inline-formula id="pcbi.1006242.e151"><alternatives><graphic id="pcbi.1006242.e151g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e151" xlink:type="simple"/><mml:math display="inline" id="M151"><mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>. We denote this non-zero correlation as <inline-formula id="pcbi.1006242.e152"><alternatives><graphic id="pcbi.1006242.e152g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e152" xlink:type="simple"/><mml:math display="inline" id="M152"><mml:mrow><mml:mi>L</mml:mi> <mml:mi>Z</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>B</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:mrow><mml:mo>{</mml:mo> <mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>B</mml:mi></mml:msub></mml:mrow> <mml:mi>Z</mml:mi></mml:msubsup> <mml:mo>:</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="4pt"/><mml:mi>y</mml:mi> <mml:mo>&lt;</mml:mo> <mml:mi>x</mml:mi> <mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Here, <inline-formula id="pcbi.1006242.e153"><alternatives><graphic id="pcbi.1006242.e153g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e153" xlink:type="simple"/><mml:math display="inline" id="M153"><mml:msubsup><mml:mi>ρ</mml:mi> <mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo> <mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>y</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mi>B</mml:mi></mml:msub></mml:mrow> <mml:mi>Z</mml:mi></mml:msubsup></mml:math></alternatives></inline-formula> is the Pearson correlation between the row-vectors <inline-formula id="pcbi.1006242.e154"><alternatives><graphic id="pcbi.1006242.e154g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e154" xlink:type="simple"/><mml:math display="inline" id="M154"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula> and <inline-formula id="pcbi.1006242.e155"><alternatives><graphic id="pcbi.1006242.e155g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e155" xlink:type="simple"/><mml:math display="inline" id="M155"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>y</mml:mi> <mml:mo>,</mml:mo> <mml:mi>v</mml:mi> <mml:mo>∈</mml:mo> <mml:mi>V</mml:mi></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>, and <italic>V</italic> is the set of samples in which both microbes <italic>x</italic> and <italic>y</italic> have non-zero abundance, i.e., <italic>V</italic> = {<italic>v</italic>: (<italic>b</italic><sub><italic>x</italic>,<italic>v</italic></sub> &gt; 0, <italic>b</italic><sub><italic>y</italic>,<italic>v</italic></sub> &gt; 0)}.</p>
<p>The correlation matrices of simulated absolute abundance data, as expected, are centered on zero. In contrast, the correlation matrix for the relative abundances <inline-formula id="pcbi.1006242.e156"><alternatives><graphic id="pcbi.1006242.e156g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e156" xlink:type="simple"/><mml:math display="inline" id="M156"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relCN</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> is shifted markedly to the right (<xref ref-type="supplementary-material" rid="pcbi.1006242.s014">S9A Fig</xref>). While this seems to improve when plotting the results of the Dirichlet-Multinomial simulations, <inline-formula id="pcbi.1006242.e157"><alternatives><graphic id="pcbi.1006242.e157g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e157" xlink:type="simple"/><mml:math display="inline" id="M157"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, when correlations are calculated over only non-zero elements, we see that they once again are shifted to the right by the same degree. These simulations show that relative abundance estimates are biased due to compositionality, consistent with previous work [<xref ref-type="bibr" rid="pcbi.1006242.ref085">85</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref086">86</xref>], but that a high proportion of zeros (i.e., microbe not detected) can reduce this effect.</p>
</sec>
<sec id="sec032">
<title>Evaluating extent of spurious correlation for prevalence</title>
<p>While relative abundance can be measured for each microbe in each sample, prevalence must be measured over a set of samples. To assess the impact of compositionality on prevalence, we therefore repeated the above simulation for 100 simulations <italic>i</italic> ∈ <italic>I</italic>, but this time held <italic>μ</italic><sub><italic>m</italic></sub> and <italic>z</italic><sub><italic>m</italic></sub> constant across runs of the simulation to make them comparable.</p>
<p>Mirroring the procedure we used to estimate prevalence in real data, we binarized our <italic>B</italic><sub><italic>i</italic></sub> abundance matrices to yield corresponding presence-absence matrices <italic>A</italic><sub><italic>i</italic></sub>, and then calculated estimated prevalence of each microbe <italic>m</italic>, <inline-formula id="pcbi.1006242.e158"><alternatives><graphic id="pcbi.1006242.e158g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e158" xlink:type="simple"/><mml:math display="inline" id="M158"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, from our absolute abundances <inline-formula id="pcbi.1006242.e159"><alternatives><graphic id="pcbi.1006242.e159g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e159" xlink:type="simple"/><mml:math display="inline" id="M159"><mml:msubsup><mml:mi>A</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> and from the derived relative abundances <inline-formula id="pcbi.1006242.e160"><alternatives><graphic id="pcbi.1006242.e160g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e160" xlink:type="simple"/><mml:math display="inline" id="M160"><mml:msubsup><mml:mi>A</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula>. We performed this for every simulation <italic>i</italic> ∈ <italic>I</italic>, forming two matrices of prevalences Π<sup>Abs</sup> and Π<sup>relDM</sup>, each with ||<italic>M</italic>|| rows, ||<italic>I</italic>|| columns, and elements <inline-formula id="pcbi.1006242.e161"><alternatives><graphic id="pcbi.1006242.e161g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e161" xlink:type="simple"/><mml:math display="inline" id="M161"><mml:mrow><mml:msub><mml:mi>π</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>i</mml:mi></mml:mrow></mml:msub> <mml:mo>=</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We also investigated the impact of defining prevalence as absolute abundance over a low but non-zero threshold of detection, which we defined as Π<sup>AbsThresh</sup>. We chose a threshold of <inline-formula id="pcbi.1006242.e162"><alternatives><graphic id="pcbi.1006242.e162g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e162" xlink:type="simple"/><mml:math display="inline" id="M162"><mml:mrow><mml:msubsup><mml:mi>b</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup> <mml:mo>&gt;</mml:mo> <mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. We then plotted densities of the lower-triangular part of the microbial correlation matrices <italic>L</italic>(Π<sup>Abs</sup>), <italic>L</italic>(Π<sup>AbsThresh</sup>), and <italic>L</italic>(Π<sup>relDM</sup>), analogously to above. (We did not compute <italic>L</italic>(Π<sup>relCN</sup>) because it should always be equal to <italic>L</italic>(Π<sup>Abs</sup>).)</p>
<p>In contrast to what we observed for relative abundance, the distributions of prevalences were almost identical when based on absolute abundances versus resampled relative abundances (<xref ref-type="supplementary-material" rid="pcbi.1006242.s014">S9B Fig</xref>). This strongly suggests that compositionality does not induce spurious correlations between taxon prevalences in the same way, or to the same degree, as it does for relative abundances.</p>
</sec>
<sec id="sec033">
<title>Other sources of error in prevalence</title>
<p>Another source of error in prevalence estimates, which is related to our discussion of left-censoring, is the distinction between “structural” versus “sampling” zeros in relative abundance data [<xref ref-type="bibr" rid="pcbi.1006242.ref087">87</xref>]. Structural zeros arise from samples in which a microbe is really not present, whereas sampling zeros arise when a microbe is present but does not happen to be sampled. The fewer the number of samples, and the fewer reads per sample, the more likely sampling zeros are to occur.</p>
<p>To get a better sense of when prevalence estimates are likely to be reliable, we simulated relative abundance data, varying the number of samples and reads, and then calculated the correlation between the true and the estimated prevalences. Our simulation framework can be thought of as a zero-inflated multinomial, with details as follows (using ⊙ to mean element-wise multiplication):
<disp-formula id="pcbi.1006242.e163"><alternatives><graphic id="pcbi.1006242.e163g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e163" xlink:type="simple"/><mml:math display="block" id="M163"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mover accent="true"><mml:mi>b</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mi>n</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Multinomial</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>,</mml:mo> <mml:mi>θ</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>⊙</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>c</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>M</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>c</mml:mi> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>n</mml:mi></mml:mrow></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Bernoulli</mml:mtext> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>-</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>4</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>θ</mml:mi> <mml:mi>n</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>Dirichlet</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>α</mml:mi> <mml:mn>1</mml:mn></mml:msub> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>…</mml:mo> <mml:mspace width="0.166667em"/><mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msub><mml:mi>α</mml:mi> <mml:mrow><mml:mo>‖</mml:mo> <mml:mi>M</mml:mi> <mml:mo>‖</mml:mo></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:msub><mml:mi>α</mml:mi> <mml:mi>m</mml:mi></mml:msub></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mtext>DiscreteUniform</mml:mtext> <mml:mo>(</mml:mo> <mml:mn>1</mml:mn> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:msup><mml:mn>10</mml:mn> <mml:mn>5</mml:mn></mml:msup> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mtext>log</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mi>r</mml:mi> <mml:mi>n</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mtd> <mml:mtd columnalign="left"><mml:mrow><mml:mo>∼</mml:mo> <mml:mi>N</mml:mi> <mml:mo>(</mml:mo> <mml:mi>q</mml:mi> <mml:mo>,</mml:mo> <mml:mspace width="0.166667em"/><mml:mn>0</mml:mn> <mml:mo>.</mml:mo> <mml:mn>5</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
In other words, we randomly simulate one Dirichlet “meta-community” with ||<italic>M</italic>|| = 6000 uniformly-distributed <italic>α</italic> parameters (matching the approximate number of taxa measured in MIDAS). For each sample <italic>n</italic>, we then draw a multinomial <italic>θ</italic><sub><italic>n</italic></sub> from this Dirichlet, then draw reads from that multinomial, given a number of total reads <italic>r</italic><sub><italic>n</italic></sub>. These total reads are log-normally distributed around a central value <italic>q</italic>. We then draw random prevalences <italic>z</italic><sub><italic>m</italic></sub> with a logit-normal distribution, then draw structural zeros <italic>c</italic><sub><italic>m</italic>,<italic>n</italic></sub> based on these (sampling zeros arise from the sampling inherent in the multinomial distribution). Element-wise multiplication with the vector of structural zeros therefore leads to counts from a multinomial with excess zeros.</p>
<p>Our simulation varies <italic>q</italic>, the average (geometric mean) number of reads across samples, and ||<italic>N</italic>||, the total number of samples. After constructing a simulated abundance matrix <inline-formula id="pcbi.1006242.e164"><alternatives><graphic id="pcbi.1006242.e164g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e164" xlink:type="simple"/><mml:math display="inline" id="M164"><mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>Counts</mml:mtext></mml:msubsup></mml:math></alternatives></inline-formula> from each simulation, we binarize it to obtain a presence-absence matrix <italic>A</italic><sub><italic>i</italic></sub>, then compute estimated prevalences for each microbe <italic>m</italic>, <inline-formula id="pcbi.1006242.e165"><alternatives><graphic id="pcbi.1006242.e165g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e165" xlink:type="simple"/><mml:math display="inline" id="M165"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow> <mml:mtext>ADD</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>A</mml:mi> <mml:mi>i</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We finally calculate the correlation of logit(<italic>z</italic><sub><italic>m</italic></sub>) and <inline-formula id="pcbi.1006242.e166"><alternatives><graphic id="pcbi.1006242.e166g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e166" xlink:type="simple"/><mml:math display="inline" id="M166"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, as well as the fraction of censoring that we observe (i.e., the fraction of values of <inline-formula id="pcbi.1006242.e167"><alternatives><graphic id="pcbi.1006242.e167g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e167" xlink:type="simple"/><mml:math display="inline" id="M167"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>≤</mml:mo> <mml:mtext>min</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:mtext>logit</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>), and the correlation over only the non-censored values (i.e., for <inline-formula id="pcbi.1006242.e168"><alternatives><graphic id="pcbi.1006242.e168g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e168" xlink:type="simple"/><mml:math display="inline" id="M168"><mml:mrow><mml:mo>{</mml:mo> <mml:mi>m</mml:mi> <mml:mo>:</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub> <mml:mo>&gt;</mml:mo> <mml:mfrac><mml:mn>1</mml:mn> <mml:mrow><mml:mi>N</mml:mi> <mml:mo>+</mml:mo> <mml:mn>2</mml:mn></mml:mrow></mml:mfrac> <mml:mo>}</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>).</p>
<p>In these simulations, the factor with the greatest effect on prevalence reliability is the number of samples, not read depth (<xref ref-type="supplementary-material" rid="pcbi.1006242.s015">S10 Fig</xref>). While this might initially seem counter-intuitive, we are assuming in this simulation that most taxa have low prevalences (the mean of logit(<italic>z</italic><sub><italic>m</italic></sub>) is −4, corresponding to ∼2% prevalence), much like what we observed in real data. In this setting, structural zeros will tend to outweigh sampling zeros, so increasing the sampling depth will not necessarily improve estimates of prevalence. In this setting, having fewer than 50 samples increases the level of censoring above approximately 50%; this amount of censoring (zero standard deviations below the mean in <xref ref-type="supplementary-material" rid="pcbi.1006242.s012">S7 Fig</xref>) does not increase the false discovery rate in our simulations, but does lower the power to detect associations. However, the taxa that were not left-censored remained reliably-measured even at the shallowest total read depths (<italic>r</italic> &gt; 0.9) for ||<italic>N</italic>|| ≥ 100.</p>
<p>We were curious as to whether read depth became more important when the ratio of structural to sampling zeros was lowered. To this end, we repeated this simulation with a distribution of prevalences centered on 0.5, so that <inline-formula id="pcbi.1006242.e169"><alternatives><graphic id="pcbi.1006242.e169g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e169" xlink:type="simple"/><mml:math display="inline" id="M169"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Since it would probably not be realistic for nearly every microbe in the MIDAS database to have a prevalence above 5%, we lowered the number of taxa ||<italic>M</italic>|| to 1000. Indeed, under these assumptions, read depth became significantly more important (<xref ref-type="supplementary-material" rid="pcbi.1006242.s016">S11 Fig</xref>). This is not surprising, since with these assumptions true structural zeros should be less common than above. With these assumptions, censoring does not vary substantially across conditions (censored percentage ≤ 1%), but at least 50,000 reads per sample, on average, were necessary to reach a correlation of <italic>r</italic> &gt; 0.9 for those microbes whose prevalences were above the limit of detection.</p>
<p>Taken together, these simulations suggest that read depth, sample size, and true prevalence values affect the accuracy of prevalence estimates. Read depth becomes most important when most true prevalences are relatively large (5 − 95%). In contrast, when most prevalences are low, sample size is likely the most important consideration. Finally, when the sample size is sufficiently high (||<italic>N</italic>|| &gt; 100) and most prevalences are low, microbes with prevalences above the limit of detection tend to be estimated accurately. These results provide guidelines for when the methods in this manuscript will be most accurate if applied to metagenomes from environments with different characteristics from human stool samples.</p>
</sec>
</sec>
<sec id="sec034">
<title>Enrichment analysis</title>
<p>Enrichment analysis was performed using SEED subsystem annotations for FIGfams [<xref ref-type="bibr" rid="pcbi.1006242.ref088">88</xref>, <xref ref-type="bibr" rid="pcbi.1006242.ref037">37</xref>]. Each subsystem was tested for a significant overlap with significant hits from the linear models (<italic>q</italic> ≤ 0.05), given the set of FIGfams tested, by Fisher’s exact test. For each gene set, a 2 × 2 contingency table was constructed with the following form:
<disp-formula id="pcbi.1006242.e170"><alternatives><graphic id="pcbi.1006242.e170g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e170" xlink:type="simple"/><mml:math display="block" id="M170"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>‖</mml:mo> <mml:mtext>(subsys</mml:mtext> <mml:mo>∩</mml:mo> <mml:mtext>signif</mml:mtext> <mml:mo>)</mml:mo> <mml:mo>∩</mml:mo> <mml:mtext>BG</mml:mtext> <mml:mo>‖</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>‖</mml:mo> <mml:mtext>(subsys</mml:mtext> <mml:mo>\</mml:mo> <mml:mtext>signif</mml:mtext> <mml:mo>)</mml:mo> <mml:mo>∩</mml:mo> <mml:mtext>BG</mml:mtext> <mml:mo>‖</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>‖</mml:mo> <mml:mo>(</mml:mo> <mml:mtext>signif</mml:mtext> <mml:mo>\</mml:mo> <mml:mtext>subsys</mml:mtext> <mml:mo>)</mml:mo> <mml:mo>∩</mml:mo> <mml:mtext>BG</mml:mtext> <mml:mo>‖</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>‖</mml:mo> <mml:mtext>BG</mml:mtext> <mml:mo>\</mml:mo> <mml:mo>(</mml:mo> <mml:mtext>subsys</mml:mtext> <mml:mo>∪</mml:mo> <mml:mtext>signif</mml:mtext> <mml:mo>)</mml:mo> <mml:mo>‖</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where “subsys” is the set of FIGfams in a given SEED subsystem, “signif” is the set of FIGfams in a particular phylum that were significant hits, and “BG” is the set of all FIGfams tested in that phylum. Two-tailed <italic>p</italic>-values were corrected using the Benjamini-Hochberg procedure [<xref ref-type="bibr" rid="pcbi.1006242.ref089">89</xref>] and an FDR of 25% was set for detecting significant enrichment and depletion (only enrichment is reported). We used this significance threshold in accordance with accepted practice for gene set enrichment analysis [<xref ref-type="bibr" rid="pcbi.1006242.ref090">90</xref>]. We used the Benjamini-Hochberg procedure since unlike the <italic>q</italic>-value method it does not require the estimation of the proportion of true nulls, which is more difficult with small numbers of tests.</p>
</sec>
<sec id="sec035">
<title>Overlap with <italic>in vivo</italic> results</title>
<p>Results of the screen were obtained from the Supplemental Material of Wu et al. (downloaded on 2017 May 3) [<xref ref-type="bibr" rid="pcbi.1006242.ref048">48</xref>]. Genes were mapped to FIGfams by matching identifiers in the Supplemental Material to genome annotations from PATRIC [<xref ref-type="bibr" rid="pcbi.1006242.ref067">67</xref>]. Significance of overlap between these genes and the results for the Bacteroidetes phylum from the body-site-specific or overall models was determined by Fisher’s exact test.</p>
<p>This test depends both on how we determine which genes from the <italic>in vivo</italic> screen count as true positives, and on the choice of the “background set,” i.e., which genes would be possible to find in the <italic>in vivo</italic> study. Rather than committing to one method of picking the “true positive” and “background” sets, we instead enumerated several possibilities, performed all possible combinations (<xref ref-type="supplementary-material" rid="pcbi.1006242.s004">S3 Table</xref>), and corrected for multiple comparisons. The options we tested for true positive sets were 1. genes in the screen that were significantly associated with fitness in all four <italic>Bacteroides</italic> strains tested, 2. <italic>Bacteroides thetaiotaomicron</italic> genes significantly associated with diet-independent fitness effects, and 3. <italic>B. thetaiotaomicron</italic> genes associated with either diet-dependent or -independent effects. The background sets we tested were 1. all gene families for which a phylogenetic model was fit, 2. all gene families appearing at least once in a <italic>Bacteroides</italic> genome cluster pangenome, 3. all gene families present in all <italic>Bacteroides</italic> pangenomes, 4. gene families present in some but not all <italic>Bacteroides</italic> pangenomes, and 5. gene families present in <italic>Bacteroides thetaiotaomicron</italic>. Similarly to our approach to gene set enrichment analysis, for each test we assembled a 2x2 contingency table as follows:
<disp-formula id="pcbi.1006242.e171"><alternatives><graphic id="pcbi.1006242.e171g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e171" xlink:type="simple"/><mml:math display="block" id="M171"><mml:mtable displaystyle="true"><mml:mtr><mml:mtd columnalign="right"><mml:mrow><mml:mo>[</mml:mo> <mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>‖</mml:mo> <mml:mo>{</mml:mo> <mml:mtext>pos</mml:mtext> <mml:mo>∩</mml:mo> <mml:mtext>signif</mml:mtext> <mml:mo>}</mml:mo> <mml:mo>∩</mml:mo> <mml:mtext>BG</mml:mtext> <mml:mo>‖</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>‖</mml:mo> <mml:mo>{</mml:mo> <mml:mtext>pos</mml:mtext> <mml:mo>\</mml:mo> <mml:mtext>signif</mml:mtext> <mml:mo>}</mml:mo> <mml:mo>∩</mml:mo> <mml:mtext>BG</mml:mtext> <mml:mo>‖</mml:mo></mml:mrow></mml:mtd></mml:mtr> <mml:mtr><mml:mtd><mml:mrow><mml:mo>‖</mml:mo> <mml:mo>{</mml:mo> <mml:mtext>signif</mml:mtext> <mml:mo>\</mml:mo> <mml:mtext>pos</mml:mtext> <mml:mo>}</mml:mo> <mml:mo>∩</mml:mo> <mml:mtext>BG</mml:mtext> <mml:mo>‖</mml:mo></mml:mrow></mml:mtd> <mml:mtd><mml:mrow><mml:mo>‖</mml:mo> <mml:mtext>BG</mml:mtext> <mml:mo>\</mml:mo> <mml:mo>{</mml:mo> <mml:mtext>pos</mml:mtext> <mml:mo>∪</mml:mo> <mml:mtext>signif</mml:mtext> <mml:mo>}</mml:mo> <mml:mo>‖</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math></alternatives></disp-formula>
where “pos” refers to the true positive FIGfam set, “signif” refers to the set of significant FIGfam hits from the phylogenetic model, and “BG” refers to the background FIGfam set. The full results are depicted in <xref ref-type="supplementary-material" rid="pcbi.1006242.s004">S3 Table</xref>, with the results for true positive set #1 excerpted from this full comparison in <xref ref-type="table" rid="pcbi.1006242.t001">Table 1</xref>.</p>
</sec>
<sec id="sec036">
<title>Codebase</title>
<p>The analyses were carried out using R [<xref ref-type="bibr" rid="pcbi.1006242.ref091">91</xref>]. The code used to perform these analyses is available at <ext-link ext-link-type="uri" xlink:href="http://www.bitbucket.com/pbradz/plr" xlink:type="simple">http://www.bitbucket.com/pbradz/plr</ext-link> in the form of an Rmarkdown notebook [<xref ref-type="bibr" rid="pcbi.1006242.ref092">92</xref>].</p>
<p>Other R packages used include <monospace>phylolm</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref076">76</xref>], <monospace>phyloseq</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref093">93</xref>], <monospace>rentrez</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref065">65</xref>], <monospace>pbapply</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref094">94</xref>], <monospace>XML</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref095">95</xref>], <monospace>qvalue</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref077">77</xref>], <monospace>magrittr</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref096">96</xref>], <monospace>compiler</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref091">91</xref>], <monospace>phytools</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref097">97</xref>], <monospace>ggtree</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref098">98</xref>], <monospace>gridExtra</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref099">99</xref>], <monospace>MASS</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref100">100</xref>], <monospace>nlme</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref080">80</xref>], <monospace>fitdistrplus</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref081">81</xref>], <monospace>truncnorm</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref101">101</xref>], <monospace>ape</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref102">102</xref>], <monospace>geiger</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref103">103</xref>], <monospace>MCMCpack</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref104">104</xref>], <monospace>knitr</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref105">105</xref>], <monospace>data.table</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref106">106</xref>], <monospace>parallel</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref091">91</xref>], and <monospace>dplyr</monospace> [<xref ref-type="bibr" rid="pcbi.1006242.ref107">107</xref>].</p>
</sec>
</sec>
<sec id="sec037">
<title>Supporting information</title>
<supplementary-material id="pcbi.1006242.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s001" xlink:type="simple">
<label>S1 Appendix</label>
<caption>
<title>Glossary of terms.</title>
<p>Reference material giving definitions of mathematical symbols used in the Methods.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s002" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s002" xlink:type="simple">
<label>S1 Table</label>
<caption>
<title>Species prevalences, gut specificities, and Crohn’s disease specificities for all genome clusters (species) tested.</title>
<p>logit.Prevalence, logit.BodySite, and logit.Crohns column titles refer to our estimates of <inline-formula id="pcbi.1006242.e172"><alternatives><graphic id="pcbi.1006242.e172g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e172" xlink:type="simple"/><mml:math display="inline" id="M172"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, <inline-formula id="pcbi.1006242.e173"><alternatives><graphic id="pcbi.1006242.e173g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e173" xlink:type="simple"/><mml:math display="inline" id="M173"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mtext>Gut</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>Spec</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, and <inline-formula id="pcbi.1006242.e174"><alternatives><graphic id="pcbi.1006242.e174g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e174" xlink:type="simple"/><mml:math display="inline" id="M174"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mtext>CD</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>Spec</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, respectively. Row labels (5-digit numbers) correspond to MIDAS taxon IDs.</p>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s003" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s003" xlink:type="simple">
<label>S2 Table</label>
<caption>
<title>Concordance of <italic>β</italic><sub>1,<italic>g</italic></sub> estimates for weighted least squares vs. Laplace shrinkage procedures.</title>
<p>Pearson’s correlation coefficient <italic>r</italic> comparing estimates of <italic>β</italic><sub>1,<italic>g</italic></sub> for the weighted phylogenetic least squares procedure with the unweighted phylogenetic least squares using Laplace-shrunken estimates of specificity scores were computed across: all tested genes (all), all genes significant in either the weighted or shrunken phylogenetic model (one significant), or all genes significant in both models (both significant). Comparisons were performed for both body site environmental specificity scores (bodysite) and Crohn’s disease (Crohn’s). Additionally, the number of taxa not shrunk back to the prior by Laplace shrinkage for each environmental specificity score are given (non-shrunk).</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s004" mimetype="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s004" xlink:type="simple">
<label>S3 Table</label>
<caption>
<title>Full assessment of whether genes linked to microbial fitness in an <italic>in vivo</italic> experiment [<xref ref-type="bibr" rid="pcbi.1006242.ref048">48</xref>] were enriched for significant hits of the body site-specific and overall gut prevalence models.</title>
<p>The different sets of true positives were defined as: “Bacteroides” (genes in the screen significantly associated with fitness in all four strains), “BthetaDietIndep” (genes present in <italic>Bacteroides thetaiotaomicron</italic> that had diet-independent fitness effects in the screen), and “BthetaAny” (same, but for diet-dependent as well as -independent effects). The “background sets” were defined as follows: “all tested” (all gene families for which a phylogenetic model was fit), “Bacteroides (core or variable)” (all gene families with at least one representative in <italic>Bacteroides</italic> genome cluster pangenomes), “Bacteroides (core only)” (gene families that were present in all <italic>Bacteroides</italic> genome cluster pangenomes), “Bacteroides (variable only)” (gene families present in some but not all <italic>Bacteroides</italic> genomes clusters), and “Bacteroides thetaiotaomicron only” (only gene families present in <italic>Bacteroides thetaiotaomicron</italic>). Two false discovery rates for each model were tested (5% and 25%). Fisher tests yielded <italic>p</italic>-values that were then converted to <italic>q</italic>-values using the Benjamini-Hochberg approach [<xref ref-type="bibr" rid="pcbi.1006242.ref089">89</xref>].</p>
<p>(XLSX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s005" mimetype="text/csv" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s005" xlink:type="simple">
<label>S4 Table</label>
<caption>
<title>SRA accession IDs used to estimate prevalence and environmental specificity scores.</title>
<p>(CSV)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s006" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s006" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Estimates of logit-gut prevalence (x-axis) vs. logit-gut environmental specificity score (y-axis), showing only modest correlation.</title>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s007" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s007" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Method overview.</title>
<p>Using MIDAS, we calculate species relative abundances from shotgun sequencing data. These are binarized to yield a matrix of microbial presence/absence, with rows corresponding to microbes and columns corresponding to samples. Samples are organized into environments (i.e., the environments from which the sample was collected) and into datasets (corresponding to samples collected as part of the same project). Using the presence/absence matrix together with these metadata, we estimate phenotype vectors <inline-formula id="pcbi.1006242.e175"><alternatives><graphic id="pcbi.1006242.e175g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e175" xlink:type="simple"/><mml:math display="inline" id="M175"><mml:mrow><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, whose elements are estimates of microbial phenotypes. These phenotypes fall into two groups: prevalence (<inline-formula id="pcbi.1006242.e176"><alternatives><graphic id="pcbi.1006242.e176g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e176" xlink:type="simple"/><mml:math display="inline" id="M176"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>) and environmental specificity scores (<inline-formula id="pcbi.1006242.e177"><alternatives><graphic id="pcbi.1006242.e177g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e177" xlink:type="simple"/><mml:math display="inline" id="M177"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>Spec</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>). Separately, we use the whole genomes incorporated into the MIDAS database to assemble a matrix of gene presence/absence in the pangenome of microbes, and to construct a phylogenetic species tree based on previously-validated single-copy marker genes. We subset this tree to yield four phylum-specific trees. The inputs to our phylogenetic models are a phenotype vector, a gene presence-absence vector, and a phylogenetic tree. Based on these models, we estimate <italic>p</italic>-values for a non-zero effect of the gene on the phenotype, then convert these <italic>p</italic>-values into <italic>q</italic>-values to obtain predicted gene-phenotype interactions at a given false discovery rate (here, 5%).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s008" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s008" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Laplacian regularization reduces noise in estimating <inline-formula id="pcbi.1006242.e178"><alternatives><graphic id="pcbi.1006242.e178g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e178" xlink:type="simple"/><mml:math display="inline" id="M178"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>CD</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</title>
<p>Two species are compared, one that was infrequently observed in both Crohn’s disease cases and controls (<italic>Bacillus subtilis</italic>, left) and one with a significant bias for Crohn’s disease cases (<italic>Bacteroides fragilis</italic>, right). A) Total counts across subjects for <italic>Bacillus subtilis</italic> and <italic>Bacteroides fragilis</italic>. B) Likelihood function for <inline-formula id="pcbi.1006242.e179"><alternatives><graphic id="pcbi.1006242.e179g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e179" xlink:type="simple"/><mml:math display="inline" id="M179"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>CD</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, or prevalence in Crohn’s disease. The maximum-likelihood value is given in the inset. C) Unregularized likelihood for <inline-formula id="pcbi.1006242.e180"><alternatives><graphic id="pcbi.1006242.e180g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e180" xlink:type="simple"/><mml:math display="inline" id="M180"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>CD</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow></mml:msub> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, or the environmental specificity of the microbe. Note that the maximum-likelihood value (inset) was actually almost twice as large for <italic>Bacillus subtilis</italic> as for <italic>Bacteroides fragilis</italic> despite the relative paucity of data for <italic>B. subtilis</italic> (compare Y-axes, which show that the distribution for <italic>B. subtilis</italic> is flatter). D) Laplace prior around <italic>P</italic>(<italic>e</italic><sub>CD</sub>) = 0.002 with width parameter <italic>b</italic> = 0.16 (optimized using simulation). E) Log-likelihood plot for the posterior <inline-formula id="pcbi.1006242.e181"><alternatives><graphic id="pcbi.1006242.e181g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e181" xlink:type="simple"/><mml:math display="inline" id="M181"><mml:mrow><mml:mi>P</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>e</mml:mi> <mml:mtext>CD</mml:mtext></mml:msub> <mml:mo>|</mml:mo> <mml:mi>m</mml:mi> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>=</mml:mo> <mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>CD</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>MAP</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, obtained by taking the product of the prior distribution and the unregularized distribution. The maximum <italic>a posteriori</italic> (MAP) estimates are the modes of these distributions (inset).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s009" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s009" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Sensitivity plot for <italic>ϵ</italic> tolerance parameter in Laplace shrinkage.</title>
<p>Y-axis gives the best <italic>b</italic><sub>optim</sub> value obtained given a particular log<sub>10</sub>(<italic>ϵ</italic>) selected when performing Laplace shrinkage of <inline-formula id="pcbi.1006242.e182"><alternatives><graphic id="pcbi.1006242.e182g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e182" xlink:type="simple"/><mml:math display="inline" id="M182"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>s</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mtext>CD</mml:mtext> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi></mml:mrow> <mml:mtext>MAP</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> estimates. The value of <italic>ϵ</italic> used in the manuscript (0.005) is highlighted with a vertical dashed line.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s010" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s010" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Illustration showing logit-prevalence vs. the pattern of glutamate-GABA decarboxylase (<italic>gadC</italic>) inheritance in Bacteroidetes.</title>
<p>As in <xref ref-type="fig" rid="pcbi.1006242.g002">Fig 2</xref>, the tree on the left is colored by species prevalence (black to orange), while the tree on the right is colored by gene presence-absence (blue to black), with selected species called out in the middle, and lines linking species labels to leaves that match leaf color.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s011" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s011" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Distribution of estimated logit-prevalence <inline-formula id="pcbi.1006242.e183"><alternatives><graphic id="pcbi.1006242.e183g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e183" xlink:type="simple"/><mml:math display="inline" id="M183"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, showing impact of censoring.</title>
<p>A) Density of estimated logit-prevalence distribution, <inline-formula id="pcbi.1006242.e184"><alternatives><graphic id="pcbi.1006242.e184g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e184" xlink:type="simple"/><mml:math display="inline" id="M184"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>, showing pile-up of values at the limit of detection <italic>K</italic>. B) Density of a normal distribution with mean and standard deviation obtained from best-fit of truncated normal to <inline-formula id="pcbi.1006242.e185"><alternatives><graphic id="pcbi.1006242.e185g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e185" xlink:type="simple"/><mml:math display="inline" id="M185"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. C) “Uncensored” version of <inline-formula id="pcbi.1006242.e186"><alternatives><graphic id="pcbi.1006242.e186g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e186" xlink:type="simple"/><mml:math display="inline" id="M186"><mml:mrow><mml:msubsup><mml:mover accent="true"><mml:mi>ϕ</mml:mi> <mml:mo>→</mml:mo></mml:mover> <mml:mrow><mml:mi>x</mml:mi> <mml:mo>,</mml:mo> <mml:mi>E</mml:mi> <mml:mo>,</mml:mo> <mml:mi>D</mml:mi></mml:mrow> <mml:mtext>Prev</mml:mtext></mml:msubsup> <mml:mrow><mml:mo>(</mml:mo> <mml:mi>A</mml:mi> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. Data points at or below <italic>K</italic> have been replaced by random sampling from a truncated normal, with mean and standard deviation as in B and with <italic>K</italic> as upper truncation point.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s012" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s012" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Impact of left-censoring on the false positive rate and power of phylogenetic tests.</title>
<p>Bars give replicate measurements of false positive rate (left, effect size of 0) and power (right, effect size of 0.75) across the different phyla (colors), based on simulating binary genotypes and continuous phenotypes as in Methods, “Power analysis”, with varying levels of left-censoring (“censoring point”), and obtaining <italic>p</italic>-values with the three methods described in Methods, “Assessing the potential impact of sampling with left-censoring.” Horizontal dashed lines give a rate of 0.05. Binary genotypes had varying levels of Ives-Garland <italic>α</italic> (0, 25, 50), representing high to low phylogenetic signal.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s013" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s013" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Simulations showing the prevalence ratios <italic>F</italic> corresponding to various effect sizes.</title>
<p>To give a more intuitive sense of scale for simulated effect sizes, simulations were performed as in Methods, “Power analysis”, with effect sizes <italic>β</italic><sub>1</sub> ranging from 0 to 1.25. After fitting phylogenetic models to the simulated phenotypes and genotypes, the average prevalences with the simulated gene, logistic(<italic>β</italic><sub>1,<italic>g</italic></sub> + <italic>β</italic><sub>0,<italic>g</italic></sub>), and without, logistic(<italic>β</italic><sub>0,<italic>g</italic></sub>), were computed, and their ratio <italic>F</italic> was taken. log<sub>2</sub>(<italic>F</italic>) is plotted here, such that a value of 1 means the gene conferred (on average) a 2-fold change in prevalence. Violin plots were made of 50 simulations.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s014" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s014" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Results of simulations illustrating compositionality artifacts in relative abundances, but not prevalence estimates.</title>
<p>Lines are density plots of all pairwise correlations (either over all samples or over only non-zero values) for (A), the relative abundance of microbes within a simulation, and (B), the prevalence of simulated microbes across simulations with the same <italic>μ</italic><sub><italic>m</italic></sub> (mean) and <italic>z</italic><sub><italic>m</italic></sub> (zero-inflation) values. A) Pairwise correlations for absolute abundances <inline-formula id="pcbi.1006242.e187"><alternatives><graphic id="pcbi.1006242.e187g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e187" xlink:type="simple"/><mml:math display="inline" id="M187"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (black), column-normalized relative abundances <inline-formula id="pcbi.1006242.e188"><alternatives><graphic id="pcbi.1006242.e188g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e188" xlink:type="simple"/><mml:math display="inline" id="M188"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relCN</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> (blue), and relative abundances obtained through Dirichlet-Multinomial sampling <inline-formula id="pcbi.1006242.e189"><alternatives><graphic id="pcbi.1006242.e189g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e189" xlink:type="simple"/><mml:math display="inline" id="M189"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are shown, along with pairwise correlations over non-zero elements of relative abundances obtained through Dirichlet-Multinomial sampling <inline-formula id="pcbi.1006242.e190"><alternatives><graphic id="pcbi.1006242.e190g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e190" xlink:type="simple"/><mml:math display="inline" id="M190"><mml:mrow><mml:mi>L</mml:mi> <mml:mi>Z</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mi>B</mml:mi> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. B) Pairwise correlations for true prevalences <inline-formula id="pcbi.1006242.e191"><alternatives><graphic id="pcbi.1006242.e191g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e191" xlink:type="simple"/><mml:math display="inline" id="M191"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mo>Π</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>Abs</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, for true prevalences above a sampling floor <inline-formula id="pcbi.1006242.e192"><alternatives><graphic id="pcbi.1006242.e192g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e192" xlink:type="simple"/><mml:math display="inline" id="M192"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mo>Π</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>AbsThresh</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, and for prevalences calculated from relative abundances obtained through Dirichlet-Multinomial sampling <inline-formula id="pcbi.1006242.e193"><alternatives><graphic id="pcbi.1006242.e193g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e193" xlink:type="simple"/><mml:math display="inline" id="M193"><mml:mrow><mml:mi>L</mml:mi> <mml:mo>(</mml:mo> <mml:msubsup><mml:mo>Π</mml:mo> <mml:mrow><mml:mi>i</mml:mi></mml:mrow> <mml:mtext>relDM</mml:mtext></mml:msubsup> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula> are compared.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s015" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s015" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Reliability of prevalence estimates, assuming that most microbes are low-prevalence in the given environment.</title>
<p>We simulated microbiome data using Dirichlet-Multinomial sampling combined with zero inflation. Here, we assumed that true prevalences were distributed <inline-formula id="pcbi.1006242.e194"><alternatives><graphic id="pcbi.1006242.e194g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e194" xlink:type="simple"/><mml:math display="inline" id="M194"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mo>-</mml:mo> <mml:mn>4</mml:mn> <mml:mo>,</mml:mo> <mml:mn>2</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>. We then plotted (blue contours) the true logit-prevalence <italic>z</italic><sub><italic>m</italic></sub> (x-axis) versus the calculated logit-prevalence from the simulation <inline-formula id="pcbi.1006242.e195"><alternatives><graphic id="pcbi.1006242.e195g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e195" xlink:type="simple"/><mml:math display="inline" id="M195"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mo>(</mml:mo> <mml:msub><mml:mover accent="true"><mml:mi>p</mml:mi> <mml:mo>^</mml:mo></mml:mover> <mml:mrow><mml:mi>m</mml:mi> <mml:mo>,</mml:mo> <mml:mi>N</mml:mi></mml:mrow></mml:msub> <mml:mo>)</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>, for varying geometric-mean read depths <italic>r</italic><sub><italic>n</italic></sub> (columns) and sample sizes ||<italic>N</italic>|| (rows). The values given for each sample size and read depth are the Pearson correlation <italic>r</italic>, the Pearson correlation over non-censored microbes only <italic>r</italic><sub>unc</sub>, and the percent of microbes with censored prevalences (“cens”).</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1006242.s016" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1006242.s016" xlink:type="simple">
<label>S11 Fig</label>
<caption>
<title>Reliability of prevalence estimates, assuming that microbial prevalence is centered on 50% in the given environment.</title>
<p>As in <xref ref-type="supplementary-material" rid="pcbi.1006242.s015">S10 Fig</xref>, but with <inline-formula id="pcbi.1006242.e196"><alternatives><graphic id="pcbi.1006242.e196g" mimetype="image" position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1006242.e196" xlink:type="simple"/><mml:math display="inline" id="M196"><mml:mrow><mml:mtext>logit</mml:mtext> <mml:mrow><mml:mo>(</mml:mo> <mml:msub><mml:mi>z</mml:mi> <mml:mi>m</mml:mi></mml:msub> <mml:mo>)</mml:mo></mml:mrow> <mml:mo>∼</mml:mo> <mml:mi mathvariant="script">N</mml:mi> <mml:mrow><mml:mo>(</mml:mo> <mml:mn>0</mml:mn> <mml:mo>,</mml:mo> <mml:mn>1</mml:mn> <mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula>.</p>
<p>(PDF)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors would like to thank Joshua Ladau, Nandita Garud, and other members of the Pollard and Turnbaugh groups, attendees of the 2017 Keystone meeting on the Microbiome in Health and Disease, and attendees of the Second Workshop in Statistics and Algorithmic Challenges in Microbiome Data Analysis (SACMDA2) for helpful suggestions and discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1006242.ref001">
<label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Slack</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Hapfelmeier</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Stecher</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Velykoredko</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Stoel</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Lawson</surname> <given-names>MAE</given-names></name>, <etal>et al</etal>. <article-title>Innate and adaptive immunity cooperate flexibly to maintain host-microbiota mutualism</article-title>. <source>Science</source>. <year>2009</year>;<volume>325</volume>(<issue>5940</issue>):<fpage>617</fpage>–<lpage>620</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1172747" xlink:type="simple">10.1126/science.1172747</ext-link></comment> <object-id pub-id-type="pmid">19644121</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref002">
<label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Atarashi</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Tanoue</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Shima</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Imaoka</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Kuwahara</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Momose</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Induction of colonic regulatory T cells by indigenous <italic>Clostridium</italic> species</article-title>. <source>Science</source>. <year>2011</year>;<volume>331</volume>(<issue>6015</issue>):<fpage>337</fpage>–<lpage>341</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.1198469" xlink:type="simple">10.1126/science.1198469</ext-link></comment> <object-id pub-id-type="pmid">21205640</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref003">
<label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Mazmanian</surname> <given-names>SK</given-names></name>, <name name-style="western"><surname>Round</surname> <given-names>JL</given-names></name>, <name name-style="western"><surname>Kasper</surname> <given-names>DL</given-names></name>. <article-title>A microbial symbiosis factor prevents intestinal inflammatory disease</article-title>. <source>Nature</source>. <year>2008</year>;<volume>453</volume>(<issue>7195</issue>):<fpage>620</fpage>–<lpage>625</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature07008" xlink:type="simple">10.1038/nature07008</ext-link></comment> <object-id pub-id-type="pmid">18509436</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref004">
<label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sassone-Corsi</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Raffatellu</surname> <given-names>M</given-names></name>. <article-title>No vacancy: how beneficial microbes cooperate with immunity to provide colonization resistance to pathogens</article-title>. <source>Journal of Immunology</source>. <year>2015</year>;<volume>194</volume>(<issue>9</issue>):<fpage>4081</fpage>–<lpage>7</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.4049/jimmunol.1403169" xlink:type="simple">10.4049/jimmunol.1403169</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref005">
<label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yano</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Yu</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Donaldson</surname> <given-names>GP</given-names></name>, <name name-style="western"><surname>Shastri</surname> <given-names>GG</given-names></name>, <name name-style="western"><surname>Ann</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ma</surname> <given-names>L</given-names></name>, <etal>et al</etal>. <article-title>Indigenous bacteria from the gut microbiota regulate host serotonin biosynthesis</article-title>. <source>Cell</source>. <year>2015</year>;<volume>161</volume>(<issue>2</issue>):<fpage>264</fpage>–<lpage>76</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2015.02.047" xlink:type="simple">10.1016/j.cell.2015.02.047</ext-link></comment> <object-id pub-id-type="pmid">25860609</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref006">
<label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Peng</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>ZR</given-names></name>, <name name-style="western"><surname>Green</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Holzman</surname> <given-names>IR</given-names></name>, <name name-style="western"><surname>Lin</surname> <given-names>J</given-names></name>. <article-title>Butyrate enhances the intestinal barrier by facilitating tight junction assembly via activation of AMP-activated protein kinase in Caco-2 cell monolayers</article-title>. <source>Journal of Nutrition</source>. <year>2009</year>;<volume>139</volume>(<issue>9</issue>):<fpage>1619</fpage>–<lpage>1625</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3945/jn.109.104638" xlink:type="simple">10.3945/jn.109.104638</ext-link></comment> <object-id pub-id-type="pmid">19625695</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref007">
<label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Reber</surname> <given-names>SO</given-names></name>, <name name-style="western"><surname>Siebler</surname> <given-names>PH</given-names></name>, <name name-style="western"><surname>Donner</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Morton</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>DG</given-names></name>, <name name-style="western"><surname>Kopelman</surname> <given-names>JM</given-names></name>, <etal>et al</etal>. <article-title>Immunization with a heat-killed preparation of the environmental bacterium <italic>Mycobacterium vaccae</italic> promotes stress resilience in mice</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2016</year>;<volume>113</volume>(<issue>22</issue>):<fpage>E3130</fpage>–<lpage>E3139</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1600324113" xlink:type="simple">10.1073/pnas.1600324113</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref008">
<label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Garrett</surname> <given-names>WS</given-names></name>, <name name-style="western"><surname>Gallini</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Yatsunenko</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Michaud</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>DuBois</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Delaney</surname> <given-names>ML</given-names></name>, <etal>et al</etal>. <article-title><italic>Enterobacteriaceae</italic> act in concert with the gut microbiota to induce spontaneous and maternally transmitted colitis</article-title>. <source>Cell Host &amp; Microbe</source>. <year>2010</year>;<volume>8</volume>(<issue>3</issue>):<fpage>292</fpage>–<lpage>300</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chom.2010.08.004" xlink:type="simple">10.1016/j.chom.2010.08.004</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref009">
<label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kullberg</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Ward</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Gorelick</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Caspar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hieny</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cheever</surname> <given-names>A</given-names></name>, <etal>et al</etal>. <article-title><italic>Helicobacter hepaticus</italic> triggers colitis in specific-pathogen-free interleukin-10 (IL-10)-deficient mice through an IL-12- and gamma interferon-dependent mechanism</article-title>. <source>Infection and Immunity</source>. <year>1998</year>;<volume>66</volume>(<issue>11</issue>):<fpage>5157</fpage>–<lpage>66</lpage>. <object-id pub-id-type="pmid">9784517</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref010">
<label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kostic</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chun</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Robertson</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Glickman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Gallini</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Michaud</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title><italic>Fusobacterium nucleatum</italic> potentiates intestinal tumorigenesis and modulates the tumor-immune microenvironment</article-title>. <source>Cell Host &amp; Microbe</source>. <year>2013</year>;<volume>14</volume>(<issue>2</issue>):<fpage>207</fpage>–<lpage>215</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chom.2013.07.007" xlink:type="simple">10.1016/j.chom.2013.07.007</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref011">
<label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Bartlett</surname> <given-names>JG</given-names></name>. <article-title><italic>Clostridium difficile</italic>-associated enteric disease</article-title>. <source>Current Infectious Disease Reports</source>. <year>2002</year>;<volume>4</volume>(<issue>6</issue>):<fpage>477</fpage>–<lpage>483</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s11908-002-0032-0" xlink:type="simple">10.1007/s11908-002-0032-0</ext-link></comment> <object-id pub-id-type="pmid">12433321</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref012">
<label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>van Nood</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Vrieze</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nieuwdorp</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Fuentes</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zoetendal</surname> <given-names>EG</given-names></name>, <name name-style="western"><surname>de Vos</surname> <given-names>WM</given-names></name>, <etal>et al</etal>. <article-title>Duodenal infusion of donor feces for recurrent <italic>Clostridium difficile</italic></article-title>. <source>New England Journal of Medicine</source>. <year>2013</year>;<volume>368</volume>(<issue>5</issue>):<fpage>407</fpage>–<lpage>415</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1056/NEJMoa1205037" xlink:type="simple">10.1056/NEJMoa1205037</ext-link></comment> <object-id pub-id-type="pmid">23323867</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref013">
<label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weingarden</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>González</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vázquez-Baeza</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Humphry</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Berg-Lyons</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Dynamic changes in short- and long-term bacterial composition following fecal microbiota transplantation for recurrent <italic>Clostridium difficile</italic> infection</article-title>. <source>Microbiome</source>. <year>2015</year>;<volume>3</volume>(<issue>1</issue>):<fpage>10</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s40168-015-0070-0" xlink:type="simple">10.1186/s40168-015-0070-0</ext-link></comment> <object-id pub-id-type="pmid">25825673</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref014">
<label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Khanna</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Vazquez-Baeza</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>González</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Weiss</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schmidt</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Muñiz-Pedrogo</surname> <given-names>DA</given-names></name>, <etal>et al</etal>. <article-title>Changes in microbial ecology after fecal microbiota transplantation for recurrent <italic>C. difficile</italic> infection affected by underlying inflammatory bowel disease</article-title>. <source>Microbiome</source>. <year>2017</year>;<volume>5</volume>(<issue>1</issue>):<fpage>55</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/s40168-017-0269-3" xlink:type="simple">10.1186/s40168-017-0269-3</ext-link></comment> <object-id pub-id-type="pmid">28506317</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref015">
<label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Carvalho</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Koren</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Goodrich</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Johansson</surname> <given-names>MV</given-names></name>, <name name-style="western"><surname>Nalbantoglu</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Aitken</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Transient inability to manage Proteobacteria promotes chronic gut inflammation in TLR5-deficient mice</article-title>. <source>Cell Host &amp; Microbe</source>. <year>2012</year>;<volume>12</volume>(<issue>2</issue>):<fpage>139</fpage>–<lpage>152</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chom.2012.07.004" xlink:type="simple">10.1016/j.chom.2012.07.004</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref016">
<label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Chassaing</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Koren</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Carvalho</surname> <given-names>FA</given-names></name>, <name name-style="western"><surname>Ley</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Gewirtz</surname> <given-names>AT</given-names></name>. <article-title>AIEC pathobiont instigates chronic colitis in susceptible hosts by altering microbiota composition</article-title>. <source>Gut</source>. <year>2014</year>;<volume>63</volume>(<issue>7</issue>):<fpage>1069</fpage>–<lpage>1080</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1136/gutjnl-2013-304909" xlink:type="simple">10.1136/gutjnl-2013-304909</ext-link></comment> <object-id pub-id-type="pmid">23896971</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref017">
<label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Vilhjálmsson</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Nordborg</surname> <given-names>M</given-names></name>. <article-title>The nature of confounding in genome-wide association studies</article-title>. <source>Nature Reviews Genetics</source>. <year>2012</year>;<volume>14</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>2</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrg3382" xlink:type="simple">10.1038/nrg3382</ext-link></comment> <object-id pub-id-type="pmid">23165185</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref018">
<label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kim</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Price</surname> <given-names>ND</given-names></name>. <article-title>Genetic co-occurrence network across sequenced microbes</article-title>. <source>PLoS Computational Biology</source>. <year>2011</year>;<volume>7</volume>(<issue>12</issue>):<fpage>e1002340</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002340" xlink:type="simple">10.1371/journal.pcbi.1002340</ext-link></comment> <object-id pub-id-type="pmid">22219725</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref019">
<label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Porter</surname> <given-names>SS</given-names></name>, <name name-style="western"><surname>Chang</surname> <given-names>PL</given-names></name>, <name name-style="western"><surname>Conow</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Dunham</surname> <given-names>JP</given-names></name>, <name name-style="western"><surname>Friesen</surname> <given-names>ML</given-names></name>. <article-title>Association mapping reveals novel serpentine adaptation gene clusters in a population of symbiotic <italic>Mesorhizobium</italic></article-title>. <source>The ISME Journal</source>. <year>2017</year>;<volume>11</volume>(<issue>1</issue>):<fpage>248</fpage>–<lpage>262</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ismej.2016.88" xlink:type="simple">10.1038/ismej.2016.88</ext-link></comment> <object-id pub-id-type="pmid">27420027</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref020">
<label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Collins</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>. <article-title>A phylogenetic method to perform genome-wide association studies in microbes that accounts for population structure and recombination</article-title>. <source>PLoS Computational Biology</source>. <year>2018</year>;<volume>14</volume>(<issue>2</issue>):<fpage>e1005958</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1005958" xlink:type="simple">10.1371/journal.pcbi.1005958</ext-link></comment> <object-id pub-id-type="pmid">29401456</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref021">
<label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhao</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Carroll</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Ringel-Kulka</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Epstein</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Zhou</surname> <given-names>H</given-names></name>, <etal>et al</etal>. <article-title>Testing in microbiome-profiling studies with MiRKAT, the microbiome regression-based kernel association test</article-title>. <source>The American Journal of Human Genetics</source>. <year>2015</year>;<volume>96</volume>(<issue>5</issue>):<fpage>797</fpage>–<lpage>807</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.ajhg.2015.04.003" xlink:type="simple">10.1016/j.ajhg.2015.04.003</ext-link></comment> <object-id pub-id-type="pmid">25957468</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref022">
<label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Silverman</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Washburne</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Mukherjee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>David</surname> <given-names>LA</given-names></name>. <article-title>A phylogenetic transform enhances analysis of compositional microbiota data</article-title>. <source>eLife</source>. <year>2017</year>;<volume>6</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.21887" xlink:type="simple">10.7554/eLife.21887</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref023">
<label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Tang</surname> <given-names>ZZ</given-names></name>, <name name-style="western"><surname>Chen</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Alekseyenko</surname> <given-names>AV</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>H</given-names></name>. <article-title>A general framework for association analysis of microbial communities on a taxonomic tree</article-title>. <source>Bioinformatics</source>. <year>2016</year>;<volume>33</volume>(<issue>9</issue>):<fpage>btw804</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btw804" xlink:type="simple">10.1093/bioinformatics/btw804</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref024">
<label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lozupone</surname> <given-names>CA</given-names></name>, <name name-style="western"><surname>Hamady</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Cantarel</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Coutinho</surname> <given-names>PM</given-names></name>, <name name-style="western"><surname>Henrissat</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gordon</surname> <given-names>JI</given-names></name>, <etal>et al</etal>. <article-title>The convergence of carbohydrate active gene repertoires in human gut microbes</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2008</year>;<volume>105</volume>(<issue>39</issue>):<fpage>15076</fpage>–<lpage>15081</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0807339105" xlink:type="simple">10.1073/pnas.0807339105</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref025">
<label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Felsenstein</surname> <given-names>J</given-names></name>. <article-title>Phylogenies and the comparative method</article-title>. <source>The American Naturalist</source>. <year>1985</year>;. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1086/284325" xlink:type="simple">10.1086/284325</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref026">
<label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Grafen</surname> <given-names>A</given-names></name>. <article-title>The phylogenetic regression</article-title>. <source>Philosophical Transactions of the Royal Society of London Series B, Biological Sciences</source>. <year>1989</year>;<volume>326</volume>(<issue>1233</issue>):<fpage>119</fpage>–<lpage>57</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.1989.0106" xlink:type="simple">10.1098/rstb.1989.0106</ext-link></comment> <object-id pub-id-type="pmid">2575770</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref027">
<label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Dunn</surname> <given-names>CW</given-names></name>, <name name-style="western"><surname>Zapata</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Munro</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Siebert</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Hejnol</surname> <given-names>A</given-names></name>. <article-title>Pairwise comparisons across species are problematic when analyzing functional genomic data</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2018</year>;<volume>115</volume>(<issue>3</issue>):<fpage>E409</fpage>–<lpage>E417</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1707515115" xlink:type="simple">10.1073/pnas.1707515115</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref028">
<label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Levy</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Salas Gonzalez</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Mittelviefhaus</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Clingenpeel</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Herrera Paredes</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Miao</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Genomic features of bacterial adaptation to plants</article-title>. <source>Nature Genetics</source>. <year>2018</year>;<volume>50</volume>(<issue>1</issue>):<fpage>138</fpage>–<lpage>150</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41588-017-0012-9" xlink:type="simple">10.1038/s41588-017-0012-9</ext-link></comment> <object-id pub-id-type="pmid">29255260</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref029">
<label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ord</surname> <given-names>TJ</given-names></name>, <name name-style="western"><surname>Martins</surname> <given-names>EP</given-names></name>. <article-title>Tracing the origins of signal diversity in anole lizards: phylogenetic approaches to inferring the evolution of complex behaviour</article-title>. <source>Animal Behaviour</source>. <year>2006</year>;<volume>71</volume>(<issue>6</issue>):<fpage>1411</fpage>–<lpage>1429</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.anbehav.2005.12.003" xlink:type="simple">10.1016/j.anbehav.2005.12.003</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref030">
<label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zaneveld</surname> <given-names>JRR</given-names></name>, <name name-style="western"><surname>Parfrey</surname> <given-names>LW</given-names></name>, <name name-style="western"><surname>Van Treuren</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lozupone</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Clemente</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Knights</surname> <given-names>D</given-names></name>, <etal>et al</etal>. <article-title>Combined phylogenetic and genomic approaches for the high-throughput study of microbial habitat adaptation</article-title>. <source>Trends in Microbiology</source>. <year>2011</year>;<volume>19</volume>(<issue>10</issue>):<fpage>472</fpage>–<lpage>82</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tim.2011.07.006" xlink:type="simple">10.1016/j.tim.2011.07.006</ext-link></comment> <object-id pub-id-type="pmid">21872475</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref031">
<label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Washburne</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Morton</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Sanders</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>McDonald</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Oliverio</surname> <given-names>AM</given-names></name>, <etal>et al</etal>. <article-title>Methods for phylogenetic analysis of microbiome data</article-title>. <source>Nature Microbiology</source>. <year>2018</year>;<volume>3</volume>(<issue>6</issue>):<fpage>652</fpage>–<lpage>661</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41564-018-0156-0" xlink:type="simple">10.1038/s41564-018-0156-0</ext-link></comment> <object-id pub-id-type="pmid">29795540</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref032">
<label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nayfach</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Rodriguez-Mueller</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Garud</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Pollard</surname> <given-names>KS</given-names></name>. <article-title>An integrated metagenomics pipeline for strain profiling reveals novel patterns of bacterial transmission and biogeography</article-title>. <source>Genome Research</source>. <year>2016</year>;<volume>26</volume>(<issue>11</issue>):<fpage>1612</fpage>–<lpage>1625</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/gr.201863.115" xlink:type="simple">10.1101/gr.201863.115</ext-link></comment> <object-id pub-id-type="pmid">27803195</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref033">
<label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Turnbaugh</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Hamady</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Yatsunenko</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Cantarel</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Duncan</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ley</surname> <given-names>RE</given-names></name>, <etal>et al</etal>. <article-title>A core gut microbiome in obese and lean twins</article-title>. <source>Nature</source>. <year>2009</year>;<volume>457</volume>(<issue>7228</issue>):<fpage>480</fpage>–<lpage>4</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature07540" xlink:type="simple">10.1038/nature07540</ext-link></comment> <object-id pub-id-type="pmid">19043404</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref034">
<label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ives</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Garland</surname> <given-names>T</given-names></name>. <article-title>Phylogenetic logistic regression for binary dependent variables</article-title>. <source>Systematic Biology</source>. <year>2010</year>;<volume>59</volume>(<issue>1</issue>):<fpage>9</fpage>–<lpage>26</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/sysbio/syp074" xlink:type="simple">10.1093/sysbio/syp074</ext-link></comment> <object-id pub-id-type="pmid">20525617</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref035">
<label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<collab>Human Microbiome Project Consortium</collab>. <article-title>Structure, function and diversity of the healthy human microbiome</article-title>. <source>Nature</source>. <year>2012</year>;<volume>486</volume>(<issue>7402</issue>):<fpage>207</fpage>–<lpage>14</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11234" xlink:type="simple">10.1038/nature11234</ext-link></comment> <object-id pub-id-type="pmid">22699609</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref036">
<label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gevers</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Kugathasan</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Denson</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Vázquez-Baeza</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Van Treuren</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Ren</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>The treatment-naive microbiome in new-onset Crohn’s disease</article-title>. <source>Cell Host &amp; Microbe</source>. <year>2014</year>;<volume>15</volume>(<issue>3</issue>):<fpage>382</fpage>–<lpage>392</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.chom.2014.02.005" xlink:type="simple">10.1016/j.chom.2014.02.005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref037">
<label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Meyer</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Overbeek</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Rodriguez</surname> <given-names>A</given-names></name>. <article-title>FIGfams: yet another set of protein families</article-title>. <source>Nucleic Acids Research</source>. <year>2009</year>;<volume>37</volume>(<issue>20</issue>):<fpage>6643</fpage>–<lpage>54</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkp698" xlink:type="simple">10.1093/nar/gkp698</ext-link></comment> <object-id pub-id-type="pmid">19762480</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref038">
<label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Sakamoto</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ohkuma</surname> <given-names>M</given-names></name>. <article-title><italic>Bacteroides reticulotermitis</italic> sp. nov., isolated from the gut of a subterranean termite (<italic>Reticulitermes speratus</italic>)</article-title>. <source>International Journal of Systematic and Evolutionary Microbiology</source>. <year>2013</year>;<volume>63</volume>(<issue>Pt 2</issue>):<fpage>691</fpage>–<lpage>695</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1099/ijs.0.040931-0" xlink:type="simple">10.1099/ijs.0.040931-0</ext-link></comment> <object-id pub-id-type="pmid">22544795</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref039">
<label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Browne</surname> <given-names>HP</given-names></name>, <name name-style="western"><surname>Forster</surname> <given-names>SC</given-names></name>, <name name-style="western"><surname>Anonye</surname> <given-names>BO</given-names></name>, <name name-style="western"><surname>Kumar</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Neville</surname> <given-names>BA</given-names></name>, <name name-style="western"><surname>Stares</surname> <given-names>MD</given-names></name>, <etal>et al</etal>. <article-title>Culturing of “unculturable” human microbiota reveals novel taxa and extensive sporulation</article-title>. <source>Nature</source>. <year>2016</year>;<volume>533</volume>(<issue>7604</issue>):<fpage>543</fpage>–<lpage>546</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature17645" xlink:type="simple">10.1038/nature17645</ext-link></comment> <object-id pub-id-type="pmid">27144353</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref040">
<label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Swick</surname> <given-names>MC</given-names></name>, <name name-style="western"><surname>Koehler</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Driks</surname> <given-names>A</given-names></name>. <article-title>Surviving between hosts: sporulation and transmission</article-title>. <source>Microbiology Spectrum</source>. <year>2016</year>;<volume>4</volume>(<issue>4</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/microbiolspec.VMBF-0029-2015" xlink:type="simple">10.1128/microbiolspec.VMBF-0029-2015</ext-link></comment> <object-id pub-id-type="pmid">27726794</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref041">
<label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>De Biase</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Pennacchietti</surname> <given-names>E</given-names></name>. <article-title>Glutamate decarboxylase-dependent acid resistance in orally acquired bacteria: function, distribution and biomedical implications of the <italic>gadBC</italic> operon</article-title>. <source>Molecular Microbiology</source>. <year>2012</year>;<volume>86</volume>(<issue>4</issue>):<fpage>770</fpage>–<lpage>786</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/mmi.12020" xlink:type="simple">10.1111/mmi.12020</ext-link></comment> <object-id pub-id-type="pmid">22995042</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref042">
<label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Srinivasa Rao</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Lim</surname> <given-names>TM</given-names></name>, <name name-style="western"><surname>Leung</surname> <given-names>KY</given-names></name>. <article-title>Functional genomics approach to the identification of virulence genes involved in <italic>Edwardsiella tarda</italic> pathogenesis</article-title>. <source>Infection and Immunity</source>. <year>2003</year>;<volume>71</volume>(<issue>3</issue>):<fpage>1343</fpage>–<lpage>51</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/IAI.71.3.1343-1351.2003" xlink:type="simple">10.1128/IAI.71.3.1343-1351.2003</ext-link></comment> <object-id pub-id-type="pmid">12595451</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref043">
<label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cotter</surname> <given-names>PD</given-names></name>, <name name-style="western"><surname>Gahan</surname> <given-names>CG</given-names></name>, <name name-style="western"><surname>Hill</surname> <given-names>C</given-names></name>. <article-title>A glutamate decarboxylase system protects <italic>Listeria monocytogenes</italic> in gastric fluid</article-title>. <source>Molecular Microbiology</source>. <year>2001</year>;<volume>40</volume>(<issue>2</issue>):<fpage>465</fpage>–<lpage>75</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1046/j.1365-2958.2001.02398.x" xlink:type="simple">10.1046/j.1365-2958.2001.02398.x</ext-link></comment> <object-id pub-id-type="pmid">11309128</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref044">
<label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wargo</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Meadows</surname> <given-names>JA</given-names></name>. <article-title>Carnitine in bacterial physiology and metabolism</article-title>. <source>Microbiology</source>. <year>2015</year>;<volume>161</volume>(<issue>6</issue>):<fpage>1161</fpage>–<lpage>1174</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1099/mic.0.000080" xlink:type="simple">10.1099/mic.0.000080</ext-link></comment> <object-id pub-id-type="pmid">25787873</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref045">
<label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Staley</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Weingarden</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Khoruts</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sadowsky</surname> <given-names>MJ</given-names></name>. <article-title>Interaction of gut microbiota with bile acid metabolism and its influence on disease states</article-title>. <source>Applied Microbiology and Biotechnology</source>. <year>2017</year>;<volume>101</volume>(<issue>1</issue>):<fpage>47</fpage>–<lpage>64</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1007/s00253-016-8006-6" xlink:type="simple">10.1007/s00253-016-8006-6</ext-link></comment> <object-id pub-id-type="pmid">27888332</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref046">
<label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Marques</surname> <given-names>JC</given-names></name>, <name name-style="western"><surname>Oh</surname> <given-names>IK</given-names></name>, <name name-style="western"><surname>Ly</surname> <given-names>DC</given-names></name>, <name name-style="western"><surname>Lamosa</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Ventura</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Miller</surname> <given-names>ST</given-names></name>, <etal>et al</etal>. <article-title>LsrF, a coenzyme A-dependent thiolase, catalyzes the terminal step in processing the quorum sensing signal autoinducer-2</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2014</year>;<volume>111</volume>(<issue>39</issue>):<fpage>14235</fpage>–<lpage>14240</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1408691111" xlink:type="simple">10.1073/pnas.1408691111</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref047">
<label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Thompson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Oliveira</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Djukovic</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Ubeda</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Xavier</surname> <given-names>K</given-names></name>. <article-title>Manipulation of the quorum sensing signal ai-2 affects the antibiotic-treated gut microbiota</article-title>. <source>Cell Reports</source>. <year>2015</year>;<volume>10</volume>(<issue>11</issue>):<fpage>1861</fpage>–<lpage>1871</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.celrep.2015.02.049" xlink:type="simple">10.1016/j.celrep.2015.02.049</ext-link></comment> <object-id pub-id-type="pmid">25801025</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref048">
<label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wu</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>McNulty</surname> <given-names>NP</given-names></name>, <name name-style="western"><surname>Rodionov</surname> <given-names>DA</given-names></name>, <name name-style="western"><surname>Khoroshkin</surname> <given-names>MS</given-names></name>, <name name-style="western"><surname>Griffin</surname> <given-names>NW</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Genetic determinants of in vivo fitness and diet responsiveness in multiple human gut <italic>Bacteroides</italic></article-title>. <source>Science</source>. <year>2015</year>;<volume>350</volume>(<issue>6256</issue>):<fpage>aac5992</fpage>–<lpage>aac5992</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1126/science.aac5992" xlink:type="simple">10.1126/science.aac5992</ext-link></comment> <object-id pub-id-type="pmid">26430127</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref049">
<label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wang</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jia</surname> <given-names>H</given-names></name>. <article-title>Metagenome-wide association studies: fine-mining the microbiome</article-title>. <source>Nature Reviews Microbiology</source>. <year>2016</year>;<volume>14</volume>(<issue>8</issue>):<fpage>508</fpage>–<lpage>522</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nrmicro.2016.83" xlink:type="simple">10.1038/nrmicro.2016.83</ext-link></comment> <object-id pub-id-type="pmid">27396567</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref050">
<label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Shin</surname> <given-names>NR</given-names></name>, <name name-style="western"><surname>Whon</surname> <given-names>TW</given-names></name>, <name name-style="western"><surname>Bae</surname> <given-names>JW</given-names></name>. <article-title>Proteobacteria: microbial signature of dysbiosis in gut microbiota</article-title>. <source>Trends in Biotechnology</source>. <year>2015</year>;<volume>33</volume>(<issue>9</issue>):<fpage>496</fpage>–<lpage>503</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.tibtech.2015.06.011" xlink:type="simple">10.1016/j.tibtech.2015.06.011</ext-link></comment> <object-id pub-id-type="pmid">26210164</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref051">
<label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lynch</surname> <given-names>SV</given-names></name>, <name name-style="western"><surname>Pedersen</surname> <given-names>O</given-names></name>. <article-title>The human intestinal microbiome in health and disease</article-title>. <source>The New England Journal of Medicine</source>. <year>2016</year>;<volume>375</volume>(<issue>24</issue>):<fpage>2369</fpage>–<lpage>2379</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1056/NEJMra1600266" xlink:type="simple">10.1056/NEJMra1600266</ext-link></comment> <object-id pub-id-type="pmid">27974040</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref052">
<label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Nielsen</surname> <given-names>HB</given-names></name>, <name name-style="western"><surname>Almeida</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Juncker</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Rasmussen</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Sunagawa</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>Identification and assembly of genomes and genetic elements in complex metagenomic samples without using reference genomes</article-title>. <source>Nature Biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>8</issue>):<fpage>822</fpage>–<lpage>828</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.2939" xlink:type="simple">10.1038/nbt.2939</ext-link></comment> <object-id pub-id-type="pmid">24997787</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref053">
<label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Li</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Jia</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Zhong</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Feng</surname> <given-names>Q</given-names></name>, <name name-style="western"><surname>Sunagawa</surname> <given-names>S</given-names></name>, <etal>et al</etal>. <article-title>An integrated catalog of reference genes in the human gut microbiome</article-title>. <source>Nature Biotechnology</source>. <year>2014</year>;<volume>32</volume>(<issue>8</issue>):<fpage>834</fpage>–<lpage>841</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nbt.2942" xlink:type="simple">10.1038/nbt.2942</ext-link></comment> <object-id pub-id-type="pmid">24997786</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref054">
<label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Glasser</surname> <given-names>AL</given-names></name>, <name name-style="western"><surname>Boudeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Barnich</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Perruchot</surname> <given-names>MH</given-names></name>, <name name-style="western"><surname>Colombel</surname> <given-names>JF</given-names></name>, <name name-style="western"><surname>Darfeuille-Michaud</surname> <given-names>A</given-names></name>. <article-title>Adherent invasive <italic>Escherichia coli</italic> strains from patients with Crohn’s disease survive and replicate within macrophages without inducing host cell death</article-title>. <source>Infection and Immunity</source>. <year>2001</year>;<volume>69</volume>(<issue>9</issue>):<fpage>5529</fpage>–<lpage>37</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1128/IAI.69.9.5529-5537.2001" xlink:type="simple">10.1128/IAI.69.9.5529-5537.2001</ext-link></comment> <object-id pub-id-type="pmid">11500426</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref055">
<label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Barnich</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Boudeau</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Claret</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Darfeuille-Michaud</surname> <given-names>A</given-names></name>. <article-title>Regulatory and functional co-operation of flagella and type 1 pili in adhesive and invasive abilities of AIEC strain LF82 isolated from a patient with Crohn’s disease</article-title>. <source>Molecular Microbiology</source>. <year>2003</year>;<volume>48</volume>(<issue>3</issue>):<fpage>781</fpage>–<lpage>794</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1046/j.1365-2958.2003.03468.x" xlink:type="simple">10.1046/j.1365-2958.2003.03468.x</ext-link></comment> <object-id pub-id-type="pmid">12694621</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref056">
<label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Small</surname> <given-names>CLN</given-names></name>, <name name-style="western"><surname>Reid-Yu</surname> <given-names>SA</given-names></name>, <name name-style="western"><surname>McPhee</surname> <given-names>JB</given-names></name>, <name name-style="western"><surname>Coombes</surname> <given-names>BK</given-names></name>. <article-title>Persistent infection with Crohn’s disease-associated adherent-invasive <italic>Escherichia coli</italic> leads to chronic inflammation and intestinal fibrosis</article-title>. <source>Nature Communications</source>. <year>2013</year>;<volume>4</volume>:<fpage>1957</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms2957" xlink:type="simple">10.1038/ncomms2957</ext-link></comment> <object-id pub-id-type="pmid">23748852</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref057">
<label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Lawley</surname> <given-names>TD</given-names></name>, <name name-style="western"><surname>Klimke</surname> <given-names>WA</given-names></name>, <name name-style="western"><surname>Gubbins</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Frost</surname> <given-names>LS</given-names></name>. <article-title>F factor conjugation is a true type IV secretion system</article-title>. <source>FEMS Microbiology Letters</source>. <year>2003</year>;<volume>224</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>15</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/S0378-1097(03)00430-0" xlink:type="simple">10.1016/S0378-1097(03)00430-0</ext-link></comment> <object-id pub-id-type="pmid">12855161</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref058">
<label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Stecher</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Denzler</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Maier</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Bernet</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Sanders</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Pickard</surname> <given-names>DJ</given-names></name>, <etal>et al</etal>. <article-title>Gut inflammation can boost horizontal gene transfer between pathogenic and commensal <italic>Enterobacteriaceae</italic></article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>;<volume>109</volume>(<issue>4</issue>):<fpage>1269</fpage>–<lpage>1274</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1113246109" xlink:type="simple">10.1073/pnas.1113246109</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref059">
<label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Ives</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Helmus</surname> <given-names>MR</given-names></name>. <article-title>Generalized linear mixed models for phylogenetic analyses of community structure</article-title>. <source>Ecological Monographs</source>. <year>2011</year>;<volume>81</volume>(<issue>3</issue>):<fpage>511</fpage>–<lpage>525</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1890/10-1264.1" xlink:type="simple">10.1890/10-1264.1</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref060">
<label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Konstantinidis</surname> <given-names>KT</given-names></name>, <name name-style="western"><surname>Tiedje</surname> <given-names>JM</given-names></name>. <article-title>Genomic insights that advance the species definition for prokaryotes</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2005</year>;<volume>102</volume>(<issue>7</issue>):<fpage>2567</fpage>–<lpage>72</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0409727102" xlink:type="simple">10.1073/pnas.0409727102</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref061">
<label>61</label>
<mixed-citation publication-type="other" xlink:type="simple">Jain C, Rodriguez-R LM, Phillippy AM, Konstantinidis KT, Aluru S. High-throughput ANI analysis of 90K prokaryotic genomes reveals clear species boundaries. bioRxiv. 2017; p. 225342.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref062">
<label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Rosselló-Móra</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Amann</surname> <given-names>R</given-names></name>. <article-title>Past and future species definitions for Bacteria and Archaea</article-title>. <source>Systematic and Applied Microbiology</source>. <year>2015</year>;<volume>38</volume>(<issue>4</issue>):<fpage>209</fpage>–<lpage>216</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.syapm.2015.02.001" xlink:type="simple">10.1016/j.syapm.2015.02.001</ext-link></comment> <object-id pub-id-type="pmid">25747618</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref063">
<label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Cadillo-Quiroz</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Didelot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Held</surname> <given-names>NL</given-names></name>, <name name-style="western"><surname>Herrera</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Darling</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Reno</surname> <given-names>ML</given-names></name>, <etal>et al</etal>. <article-title>Patterns of gene flow define species of thermophilic archaea</article-title>. <source>PLoS Biology</source>. <year>2012</year>;<volume>10</volume>(<issue>2</issue>):<fpage>e1001265</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pbio.1001265" xlink:type="simple">10.1371/journal.pbio.1001265</ext-link></comment> <object-id pub-id-type="pmid">22363207</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref064">
<label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Richter</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Rosselló-Móra</surname> <given-names>R</given-names></name>. <article-title>Shifting the genomic gold standard for the prokaryotic species definition</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>;<volume>106</volume>(<issue>45</issue>):<fpage>19126</fpage>–<lpage>31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0906412106" xlink:type="simple">10.1073/pnas.0906412106</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref065">
<label>65</label>
<mixed-citation publication-type="other" xlink:type="simple">Winter DJ. rentrez: An R package for the NCBI eUtils API. PeerJ Preprints. 2017</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref066">
<label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source>. <year>2010</year>;<volume>26</volume>(<issue>19</issue>):<fpage>2460</fpage>–<lpage>2461</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btq461" xlink:type="simple">10.1093/bioinformatics/btq461</ext-link></comment> <object-id pub-id-type="pmid">20709691</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref067">
<label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Wattam</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Abraham</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Dalay</surname> <given-names>O</given-names></name>, <name name-style="western"><surname>Disz</surname> <given-names>TL</given-names></name>, <name name-style="western"><surname>Driscoll</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Gabbard</surname> <given-names>JL</given-names></name>, <etal>et al</etal>. <article-title>PATRIC, the bacterial bioinformatics database and analysis resource</article-title>. <source>Nucleic Acids Research</source>. <year>2014</year>;<volume>42</volume>(<issue>Database issue</issue>):<fpage>D581</fpage>–<lpage>91</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkt1099" xlink:type="simple">10.1093/nar/gkt1099</ext-link></comment> <object-id pub-id-type="pmid">24225323</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref068">
<label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Price</surname> <given-names>MN</given-names></name>, <name name-style="western"><surname>Dehal</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Arkin</surname> <given-names>AP</given-names></name>. <article-title>FastTree 2–approximately maximum-likelihood trees for large alignments</article-title>. <source>PLoS ONE</source>. <year>2010</year>;<volume>5</volume>(<issue>3</issue>):<fpage>e9490</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0009490" xlink:type="simple">10.1371/journal.pone.0009490</ext-link></comment> <object-id pub-id-type="pmid">20224823</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref069">
<label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Edgar</surname> <given-names>RC</given-names></name>. <article-title>MUSCLE: multiple sequence alignment with high accuracy and high throughput</article-title>. <source>Nucleic Acids Research</source>. <year>2004</year>;<volume>32</volume>(<issue>5</issue>):<fpage>1792</fpage>–<lpage>1797</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkh340" xlink:type="simple">10.1093/nar/gkh340</ext-link></comment> <object-id pub-id-type="pmid">15034147</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref070">
<label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paradis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Claude</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Strimmer</surname> <given-names>K</given-names></name>. <article-title>APE: Analyses of Phylogenetics and Evolution in R language</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>(<issue>2</issue>):<fpage>289</fpage>–<lpage>290</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btg412" xlink:type="simple">10.1093/bioinformatics/btg412</ext-link></comment> <object-id pub-id-type="pmid">14734327</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref071">
<label>71</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Garamszegi</surname> <given-names>LZ</given-names></name>, <name name-style="western"><surname>Gonzalez-Voyer</surname> <given-names>A</given-names></name>. <chapter-title>Working with the tree of life in comparative studies: how to build and tailor phylogenies to interspecific datasets</chapter-title>. In: <source>Modern phylogenetic comparative methods and their application in evolutionary biology</source>. <publisher-loc>Berlin, Heidelberg</publisher-loc>: <publisher-name>Springer</publisher-name> <publisher-loc>Berlin Heidelberg</publisher-loc>; <year>2014</year>. p. <fpage>19</fpage>–<lpage>48</lpage>. Available from: <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/10.1007/978-3-662-43550-2_2" xlink:type="simple">http://link.springer.com/10.1007/978-3-662-43550-2_2</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref072">
<label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Karlsson</surname> <given-names>FH</given-names></name>, <name name-style="western"><surname>Tremaroli</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Nookaew</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Bergström</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Behre</surname> <given-names>CJ</given-names></name>, <name name-style="western"><surname>Fagerberg</surname> <given-names>B</given-names></name>, <etal>et al</etal>. <article-title>Gut metagenome in European women with normal, impaired and diabetic glucose control</article-title>. <source>Nature</source>. <year>2013</year>;<volume>498</volume>(<issue>7452</issue>):<fpage>99</fpage>–<lpage>103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature12198" xlink:type="simple">10.1038/nature12198</ext-link></comment> <object-id pub-id-type="pmid">23719380</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref073">
<label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Qin</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Cai</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhang</surname> <given-names>F</given-names></name>, <etal>et al</etal>. <article-title>A metagenome-wide association study of gut microbiota in type 2 diabetes</article-title>. <source>Nature</source>. <year>2012</year>;<volume>490</volume>(<issue>7418</issue>):<fpage>55</fpage>–<lpage>60</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/nature11450" xlink:type="simple">10.1038/nature11450</ext-link></comment> <object-id pub-id-type="pmid">23023125</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref074">
<label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Zhu</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Stephens</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Meltzer</surname> <given-names>PS</given-names></name>, <name name-style="western"><surname>Davis</surname> <given-names>SR</given-names></name>. <article-title>SRAdb: query and use public next-generation sequencing data from within R</article-title>. <source>BMC Bioinformatics</source>. <year>2013</year>;<volume>14</volume>(<issue>1</issue>):<fpage>19</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/1471-2105-14-19" xlink:type="simple">10.1186/1471-2105-14-19</ext-link></comment> <object-id pub-id-type="pmid">23323543</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref075">
<label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Leinonen</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Akhtar</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Birney</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bower</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Cerdeno-Tarraga</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cheng</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>The European Nucleotide Archive</article-title>. <source>Nucleic Acids Research</source>. <year>2011</year>;<volume>39</volume>(<issue>Database</issue>):<fpage>D28</fpage>–<lpage>D31</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gkq967" xlink:type="simple">10.1093/nar/gkq967</ext-link></comment> <object-id pub-id-type="pmid">20972220</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref076">
<label>76</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>si Tung Ho</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Ané</surname> <given-names>C</given-names></name>. <article-title>A linear-time algorithm for Gaussian and non-Gaussian trait evolution models</article-title>. <source>Systematic Biology</source>. <year>2014</year>;<volume>63</volume>(<issue>3</issue>):<fpage>397</fpage>–<lpage>408</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/sysbio/syu005" xlink:type="simple">10.1093/sysbio/syu005</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref077">
<label>77</label>
<mixed-citation publication-type="other" xlink:type="simple">Storey JD, Bass AJ, Dabney A, Robinson D. qvalue: Q-value estimation for false discovery rate control; 2015. Available from: <ext-link ext-link-type="uri" xlink:href="http://github.com/jdstorey/qvalue" xlink:type="simple">http://github.com/jdstorey/qvalue</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref078">
<label>78</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Storey</surname> <given-names>JD</given-names></name>, <name name-style="western"><surname>Tibshirani</surname> <given-names>R</given-names></name>. <article-title>Statistical significance for genomewide studies</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2003</year>;<volume>100</volume>(<issue>16</issue>):<fpage>9440</fpage>–<lpage>5</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.1530509100" xlink:type="simple">10.1073/pnas.1530509100</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref079">
<label>79</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Kappelman</surname> <given-names>MD</given-names></name>, <name name-style="western"><surname>Rifas-Shiman</surname> <given-names>SL</given-names></name>, <name name-style="western"><surname>Kleinman</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Ollendorf</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bousvaros</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Grand</surname> <given-names>RJ</given-names></name>, <etal>et al</etal>. <article-title>The prevalence and geographic distribution of Crohn’s disease and ulcerative colitis in the United States</article-title>. <source>Clinical Gastroenterology and Hepatology</source>. <year>2007</year>;<volume>5</volume>(<issue>12</issue>):<fpage>1424</fpage>–<lpage>1429</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cgh.2007.07.012" xlink:type="simple">10.1016/j.cgh.2007.07.012</ext-link></comment> <object-id pub-id-type="pmid">17904915</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref080">
<label>80</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Pinheiro</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Bates</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>DebRoy</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Sarkar</surname> <given-names>D</given-names></name>, <collab>R Core Team</collab>. <source>nlme: Linear and Nonlinear Mixed Effects Models</source>; <year>2018</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=nlme" xlink:type="simple">https://CRAN.R-project.org/package=nlme</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref081">
<label>81</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Delignette-Muller</surname> <given-names>ML</given-names></name>, <name name-style="western"><surname>Dutang</surname> <given-names>C</given-names></name>. <article-title>fitdistrplus: An R Package for Fitting Distributions</article-title>. <source>Journal of Statistical Software</source>. <year>2015</year>;<volume>64</volume>(<issue>4</issue>):<fpage>1</fpage>–<lpage>34</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v064.i04" xlink:type="simple">10.18637/jss.v064.i04</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref082">
<label>82</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Gloor</surname> <given-names>GB</given-names></name>, <name name-style="western"><surname>Macklaim</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>Pawlowsky-Glahn</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Egozcue</surname> <given-names>JJ</given-names></name>. <article-title>Microbiome datasets are compositional: and this is not optional</article-title>. <source>Frontiers in Microbiology</source>. <year>2017</year>;<volume>8</volume>:<fpage>2224</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3389/fmicb.2017.02224" xlink:type="simple">10.3389/fmicb.2017.02224</ext-link></comment> <object-id pub-id-type="pmid">29187837</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref083">
<label>83</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Fernandes</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Reid</surname> <given-names>JN</given-names></name>, <name name-style="western"><surname>Macklaim</surname> <given-names>JM</given-names></name>, <name name-style="western"><surname>McMurrough</surname> <given-names>TA</given-names></name>, <name name-style="western"><surname>Edgell</surname> <given-names>DR</given-names></name>, <name name-style="western"><surname>Gloor</surname> <given-names>GB</given-names></name>. <article-title>Unifying the analysis of high-throughput sequencing datasets: characterizing RNA-seq, 16S rRNA gene sequencing and selective growth experiments by compositional data analysis</article-title>. <source>Microbiome</source>. <year>2014</year>;<volume>2</volume>(<issue>1</issue>):<fpage>15</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1186/2049-2618-2-15" xlink:type="simple">10.1186/2049-2618-2-15</ext-link></comment> <object-id pub-id-type="pmid">24910773</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref084">
<label>84</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Aitchison</surname> <given-names>J</given-names></name>. <article-title>The statistical analysis of compositional data</article-title>. <source>Journal of the Royal Statistical Society, Series B (Methodological)</source>. <year>1982</year>;<volume>44</volume>(<issue>2</issue>):<fpage>139</fpage>–<lpage>177</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref085">
<label>85</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Alm</surname> <given-names>EJ</given-names></name>. <article-title>Inferring correlation networks from genomic survey data</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pcbi.1002687" xlink:type="simple">10.1371/journal.pcbi.1002687</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref086">
<label>86</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Weiss</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Van Treuren</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Lozupone</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Faust</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Friedman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Deng</surname> <given-names>Y</given-names></name>, <etal>et al</etal>. <article-title>Correlation detection strategies in microbial data sets vary widely in sensitivity and precision</article-title>. <source>ISME J</source>. <year>2016</year>;<volume>10</volume>(<issue>7</issue>). <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ismej.2015.235" xlink:type="simple">10.1038/ismej.2015.235</ext-link></comment> <object-id pub-id-type="pmid">26905627</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref087">
<label>87</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Xu</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Paterson</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Turpin</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Xu</surname> <given-names>W</given-names></name>. <article-title>Assessment and selection of competing models for zero-inflated microbiome data</article-title>. <source>PLoS ONE</source>. <year>2015</year>;<volume>10</volume>(<issue>7</issue>):<fpage>e0129606</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0129606" xlink:type="simple">10.1371/journal.pone.0129606</ext-link></comment> <object-id pub-id-type="pmid">26148172</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref088">
<label>88</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Overbeek</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Begley</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Butler</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Choudhuri</surname> <given-names>JV</given-names></name>, <name name-style="western"><surname>Chuang</surname> <given-names>HY</given-names></name>, <name name-style="western"><surname>Cohoon</surname> <given-names>M</given-names></name>, <etal>et al</etal>. <article-title>The subsystems approach to genome annotation and its use in the project to annotate 1000 genomes</article-title>. <source>Nucleic Acids Research</source>. <year>2005</year>;<volume>33</volume>(<issue>17</issue>):<fpage>5691</fpage>–<lpage>5702</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/nar/gki866" xlink:type="simple">10.1093/nar/gki866</ext-link></comment> <object-id pub-id-type="pmid">16214803</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref089">
<label>89</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Hochberg</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Benjamini</surname> <given-names>Y</given-names></name>. <article-title>Controlling the false discovery rate: a practical and powerful approach to multiple testing</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source>. <year>1995</year>;<volume>1</volume>:<fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref090">
<label>90</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Subramanian</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Tamayo</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Mootha</surname> <given-names>VK</given-names></name>, <name name-style="western"><surname>Mukherjee</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Ebert</surname> <given-names>BL</given-names></name>, <name name-style="western"><surname>Gillette</surname> <given-names>MA</given-names></name>, <etal>et al</etal>. <article-title>Gene set enrichment analysis: a knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2005</year>;<volume>102</volume>(<issue>43</issue>):<fpage>15545</fpage>–<lpage>50</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1073/pnas.0506580102" xlink:type="simple">10.1073/pnas.0506580102</ext-link></comment> <object-id pub-id-type="pmid">16199517</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref091">
<label>91</label>
<mixed-citation publication-type="book" xlink:type="simple">
<collab>R Core Team</collab>. <source>R: A language and environment for statistical computing</source>; <year>2017</year>. Available from: <ext-link ext-link-type="uri" xlink:href="https://www.R-project.org/" xlink:type="simple">https://www.R-project.org/</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref092">
<label>92</label>
<mixed-citation publication-type="other" xlink:type="simple">Allaire J, Xie Y, McPherson J, Luraschi J, Ushey K, Atkins A, et al. rmarkdown: Dynamic Documents for R; 2018. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=rmarkdown" xlink:type="simple">https://CRAN.R-project.org/package=rmarkdown</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref093">
<label>93</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>McMurdie</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Holmes</surname> <given-names>S</given-names></name>. <article-title>phyloseq: An R package for reproducible interactive analysis and graphics of microbiome census data</article-title>. <source>PLoS ONE</source>. <year>2013</year>;<volume>8</volume>(<issue>4</issue>):<fpage>e61217</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1371/journal.pone.0061217" xlink:type="simple">10.1371/journal.pone.0061217</ext-link></comment> <object-id pub-id-type="pmid">23630581</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref094">
<label>94</label>
<mixed-citation publication-type="other" xlink:type="simple">Solymos P, Zawadzki Z. pbapply: Adding Progress Bar to’*apply’ Functions; 2018. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=pbapply" xlink:type="simple">https://CRAN.R-project.org/package=pbapply</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref095">
<label>95</label>
<mixed-citation publication-type="other" xlink:type="simple">Lang DT, the CRAN Team. XML: Tools for Parsing and Generating XML Within R and S-Plus; 2018. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=XML" xlink:type="simple">https://CRAN.R-project.org/package=XML</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref096">
<label>96</label>
<mixed-citation publication-type="other" xlink:type="simple">Bache SM, Wickham H. magrittr: A Forward-Pipe Operator for R; 2014. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=magrittr" xlink:type="simple">https://CRAN.R-project.org/package=magrittr</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref097">
<label>97</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Revell</surname> <given-names>LJ</given-names></name>. <article-title>phytools: An R package for phylogenetic comparative biology (and other things)</article-title>. <source>Methods in Ecology and Evolution</source>. <year>2012</year>;<volume>3</volume>:<fpage>217</fpage>–<lpage>223</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/j.2041-210X.2011.00169.x" xlink:type="simple">10.1111/j.2041-210X.2011.00169.x</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref098">
<label>98</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Yu</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Smith</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Zhu</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Guan</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lam</surname> <given-names>TTY</given-names></name>. <article-title>ggtree: an R package for visualization and annotation of phylogenetic trees with their covariates and other associated data</article-title>. <source>Methods in Ecology and Evolution</source>. <year>2017</year>;<volume>8</volume>:<fpage>28</fpage>–<lpage>36</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1111/2041-210X.12628" xlink:type="simple">10.1111/2041-210X.12628</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref099">
<label>99</label>
<mixed-citation publication-type="other" xlink:type="simple">Auguie B. gridExtra: miscellaneous functions for “<monospace>grid</monospace>” graphics; 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=gridExtra" xlink:type="simple">https://CRAN.R-project.org/package=gridExtra</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref100">
<label>100</label>
<mixed-citation publication-type="other" xlink:type="simple">Venables WN, Ripley BD. Modern Applied Statistics with S. 4th ed. New York: Springer; 2002. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.stats.ox.ac.uk/pub/MASS4" xlink:type="simple">http://www.stats.ox.ac.uk/pub/MASS4</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref101">
<label>101</label>
<mixed-citation publication-type="other" xlink:type="simple">Mersmann O, Trautmann H, Steuer D, Bornkamp B. truncnorm: truncated normal distribution; 2018. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=truncnorm" xlink:type="simple">https://CRAN.R-project.org/package=truncnorm</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref102">
<label>102</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Paradis</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Claude</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Strimmer</surname> <given-names>K</given-names></name>. <article-title>APE: analyses of phylogenetics and evolution in R language</article-title>. <source>Bioinformatics</source>. <year>2004</year>;<volume>20</volume>:<fpage>289</fpage>–<lpage>290</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btg412" xlink:type="simple">10.1093/bioinformatics/btg412</ext-link></comment> <object-id pub-id-type="pmid">14734327</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref103">
<label>103</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Harmon</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Weir</surname> <given-names>JT</given-names></name>, <name name-style="western"><surname>Brock</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Glor</surname> <given-names>RE</given-names></name>, <name name-style="western"><surname>Challenger</surname> <given-names>W</given-names></name>. <article-title>GEIGER: investigating evolutionary radiations</article-title>. <source>Bioinformatics</source>. <year>2008</year>;<volume>24</volume>:<fpage>129</fpage>–<lpage>131</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/bioinformatics/btm538" xlink:type="simple">10.1093/bioinformatics/btm538</ext-link></comment> <object-id pub-id-type="pmid">18006550</object-id></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref104">
<label>104</label>
<mixed-citation publication-type="journal" xlink:type="simple">
<name name-style="western"><surname>Martin</surname> <given-names>AD</given-names></name>, <name name-style="western"><surname>Quinn</surname> <given-names>KM</given-names></name>, <name name-style="western"><surname>Park</surname> <given-names>JH</given-names></name>. <article-title>MCMCpack: Markov Chain Monte Carlo in R</article-title>. <source>Journal of Statistical Software</source>. <year>2011</year>;<volume>42</volume>(<issue>9</issue>):<fpage>22</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.18637/jss.v042.i09" xlink:type="simple">10.18637/jss.v042.i09</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1006242.ref105">
<label>105</label>
<mixed-citation publication-type="book" xlink:type="simple">
<name name-style="western"><surname>Xie</surname> <given-names>Y</given-names></name>. <chapter-title>knitr: A comprehensive tool for reproducible research in R</chapter-title>. In: <name name-style="western"><surname>Stodden</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Leisch</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Peng</surname> <given-names>RD</given-names></name>, editors. <source>Implementing reproducible computational research</source>. <publisher-name>Chapman and Hall/CRC</publisher-name>; <year>2014</year>. Available from: <ext-link ext-link-type="uri" xlink:href="http://www.crcpress.com/product/isbn/9781466561595" xlink:type="simple">http://www.crcpress.com/product/isbn/9781466561595</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref106">
<label>106</label>
<mixed-citation publication-type="other" xlink:type="simple">Dowle M, Srinivasan A. data.table: Extension of ‘data.frame‘; 2018. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=data.table" xlink:type="simple">https://CRAN.R-project.org/package=data.table</ext-link>.</mixed-citation>
</ref>
<ref id="pcbi.1006242.ref107">
<label>107</label>
<mixed-citation publication-type="other" xlink:type="simple">Wickham H, Francois R, Henry L, Müller K. dplyr: a grammar of data manipulation; 2017. Available from: <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=dplyr" xlink:type="simple">https://CRAN.R-project.org/package=dplyr</ext-link>.</mixed-citation>
</ref>
</ref-list>
</back>
</article>