<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">08-PLCB-RA-0526R2</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000254</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Computational Biology/Computational Neuroscience</subject><subject>Computer Science/Applications</subject><subject>Neuroscience/Behavioral Neuroscience</subject><subject>Neuroscience/Cognitive Neuroscience</subject></subj-group></article-categories><title-group><article-title>Game Theory of Mind</article-title><alt-title alt-title-type="running-head">Game Theory of Mind</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Yoshida</surname><given-names>Wako</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Dolan</surname><given-names>Ray J.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Friston</surname><given-names>Karl J.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
</contrib-group><aff id="aff1">          <addr-line>The Wellcome Trust Centre for Neuroimaging, University College London, United Kingdom</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Behrens</surname><given-names>Tim</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">John Radcliffe Hospital, United Kingdom</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">w.yoshida@fil.ion.ucl.ac.uk</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: WY RJD KJF. Performed the experiments: WY. Analyzed the data: WY KJF. Contributed reagents/materials/analysis tools: WY RJD KJF. Wrote the paper: WY RJD KJF.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>12</month><year>2008</year></pub-date><pub-date pub-type="epub"><day>26</day><month>12</month><year>2008</year></pub-date><volume>4</volume><issue>12</issue><elocation-id>e1000254</elocation-id><history>
<date date-type="received"><day>2</day><month>7</month><year>2008</year></date>
<date date-type="accepted"><day>13</day><month>11</month><year>2008</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2008</copyright-year><copyright-holder>Yoshida et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>This paper introduces a model of ‘theory of mind’, namely, how we represent the intentions and goals of others to optimise our mutual interactions. We draw on ideas from optimum control and game theory to provide a ‘game theory of mind’. First, we consider the representations of goals in terms of value functions that are prescribed by utility or rewards. Critically, the joint value functions and ensuing behaviour are optimised recursively, under the assumption that I represent your value function, your representation of mine, your representation of my representation of yours, and so on ad infinitum. However, if we assume that the degree of recursion is bounded, then players need to estimate the opponent's degree of recursion (i.e., sophistication) to respond optimally. This induces a problem of inferring the opponent's sophistication, given behavioural exchanges. We show it is possible to deduce whether players make inferences about each other and quantify their sophistication on the basis of choices in sequential games. This rests on comparing generative models of choices with, and without, inference. Model comparison is demonstrated using simulated and real data from a ‘stag-hunt’. Finally, we note that exactly the same sophisticated behaviour can be achieved by optimising the utility function itself (through prosocial utility), producing unsophisticated but apparently altruistic agents. This may be relevant ethologically in hierarchal game theory and coevolution.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>The ability to work out what other people are thinking is essential for effective social interactions, be they cooperative or competitive. A widely used example is cooperative hunting: large prey is difficult to catch alone, but we can circumvent this by cooperating with others. However, hunting can pit <italic>private</italic> goals to catch smaller prey that can be caught alone against <italic>mutually beneficial</italic> goals that require <italic>cooperation</italic>. Understanding how we work out optimal strategies that balance cooperation and competition has remained a central puzzle in game theory. Exploiting insights from computer science and behavioural economics, we suggest a model of ‘theory of mind’ using ‘recursive sophistication’ in which my model of your goals includes a model of your model of my goals, and so on ad infinitum. By studying experimental data in which people played a computer-based group hunting game, we show that the model offers a good account of individual decisions in this context, suggesting that such a formal ‘theory of mind’ model can cast light on how people build internal representations of other people in social interactions.</p>
</abstract><funding-group><funding-statement>This work was supported by Wellcome Trust Programme Grants to RJD and KJF.</funding-statement></funding-group><counts><page-count count="14"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>This paper is concerned with modelling the intentions and goals of others in the context of social interactions; in other words, how do we represent the behaviour of others in order to optimise our own behaviour? Its aim is to elaborate a simple model of ‘theory of mind’ <xref ref-type="bibr" rid="pcbi.1000254-Frith1">[1]</xref>,<xref ref-type="bibr" rid="pcbi.1000254-Premack1">[2]</xref> that can be inverted to make inferences about the likely strategies subjects adopt in cooperative games. Critically, as these strategies entail inference about other players, this means the model itself has to embed inference about others. The model tries to reduce the problem of representing the goals of others to its bare essentials by drawing from optimum control theory and game theory.</p>
<p>We consider ‘theory of mind’ at two levels. The first concerns how the goals and intentions of another agent or player are <italic>represented</italic>. We use optimum control theory to reduce the problem to representing value-functions of the states that players can be in. These value-functions prescribe optimal behaviours and are specified by the utility, payoff or reward associated with navigating these states. However, the value-function of one player depends on the behaviour of another and, implicitly, their value-function. This induces a second level of theory of mind; namely the problem of <italic>inference</italic> on another's value-function. The particular problem that arises here is that inferring on another player who is inferring your value-function leads to an infinite regress. We resolve this dilemma by invoking the idea of ‘bounded rationality’ <xref ref-type="bibr" rid="pcbi.1000254-Simon1">[3]</xref>,<xref ref-type="bibr" rid="pcbi.1000254-Kahneman1">[4]</xref> to constrain inference through priors. This subverts the pitfall of infinite regress and enables tractable inference about the ‘type’ of player one is playing with.</p>
<p>Our paper comprises three sections. The first deals with a theoretical formulation of ‘theory of mind’. This section describes the basics of representing goals in terms of high-order value-functions and policies; it then considers inferring the unknown order of an opponent's value-function (i.e., sophistication or type) and introduces priors on their sophistication that finesse this inference. In the second section, we apply the model to empirical behavioural data, obtained while subjects played a sequential game, namely a ‘stag-hunt’. We compare different models of behaviour to quantify the likelihood that players are making inferences about each other and their degree of sophistication. In the final section, we revisit optimisation of behaviour under inferential theory of mind and note that one can get exactly the same equilibrium behaviour without inference, if the utility or payoff functions are themselves optimised. The ensuing utility functions have interesting properties that speak to a principled emergence of ‘inequality aversion’ <xref ref-type="bibr" rid="pcbi.1000254-Fehr1">[5]</xref> and ‘types’ in social game theory. We discuss the implications of this in the context of evolution and hierarchical game theory.</p>
</sec><sec id="s2">
<title>Model</title>
<p>Here, we describe the optimal value-function from control theory, its evaluation in the context of one agent and then generalise the model for interacting agents. This furnishes models that can be compared using observed actions in sequential games. These models differ in the degree of recursion used to construct one agent's value-function, as a function of another's. This degree or order is bounded by the <italic>sophistication</italic> of agents, which determines their optimum <italic>strategy</italic>; i.e., the optimum policy given the policy of the opponent. Note that we will refer to the policy on the space of policies as a strategy and reserve policy for transitions on the space of states. Effectively, we are dealing with a policy hierarchy where we call a second-level policy a strategy. We then address inference on the policy another agent is using and optimisation under the implicit unobservable states. We explore these schemes using a stag-hunt, a game with two Nash equilibria, one that is risk-dominant and another that is payoff-dominant. This is important because we show that the transition from one to the other rests on sophisticated, high-order representations of an opponent's value-function.</p>
<sec id="s2a">
<title>Policies and Value Functions</title>
<p>Let the admissible states of an agent be the set <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e001" xlink:type="simple"/></inline-formula>, where the state at any time or trial <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e002" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e003" xlink:type="simple"/></inline-formula>. We consider environments under Markov assumptions, where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e004" xlink:type="simple"/></inline-formula> is the probability of going from state <italic>j</italic> to state <italic>i</italic>. This transition probability defines the agent's policy as a function of value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e005" xlink:type="simple"/></inline-formula>. We can summarise this policy in terms of a matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e006" xlink:type="simple"/></inline-formula>, with elements <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e007" xlink:type="simple"/></inline-formula>. In what follows, will use <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e008" xlink:type="simple"/></inline-formula> to denote a probability transition matrix that depends on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e009" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e010" xlink:type="simple"/></inline-formula> for a probability on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e011" xlink:type="simple"/></inline-formula>. The value of a state is defined as utility or payoff, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e012" xlink:type="simple"/></inline-formula> expected under iterations of the policy and can be defined recursively as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e013" xlink:type="simple"/><label>(1)</label></disp-formula>The notion of value assumes the existence of a state-dependent quantity that the agent optimises by moving from one state to another. In Markov environments with <italic>n</italic> = |<italic>S</italic>| states, the value over states, encoded in the row vector <italic>v</italic>∈ℜ<sup>1×<italic>n</italic></sup>, is simply the payoff at the current state ℓ∈ℜ<sup>1×<italic>n</italic></sup> plus the payoff expected on the next move, ℓ<italic>P</italic>, the subsequent move ℓ<italic>P</italic><sup>2</sup> and so on. In short, value is the reward expected in the future and satisfies the Bellman equation <xref ref-type="bibr" rid="pcbi.1000254-Bellman1">[6]</xref> from optimal control theory; this is the standard equation of dynamic programming<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e014" xlink:type="simple"/><label>(2)</label></disp-formula>We will assume a policy is fully specified by value and takes the form<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e015" xlink:type="simple"/><label>(3a)</label></disp-formula>Under this assumption, value plays the role of an energy function, where <italic>λ</italic> is an inverse temperature or precision; assumed to take a value of one in the simulations below. Using the formalism of Todorov <xref ref-type="bibr" rid="pcbi.1000254-Todorov1">[7]</xref>, the matrix <italic>P</italic>(0) encodes autonomous (uncontrolled) transitions that would occur when, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e016" xlink:type="simple"/></inline-formula>. These probabilities define admissible transitions and the nature of the state-space the agent operates in, where inadmissible transitions are encoded with <italic>P</italic>(0)<italic><sub>ij</sub></italic> = 0. The uncontrolled transition probability matrix <italic>P</italic>(0) plays an important role in the general setting of Markov decision processes (MDP). This is because certain transitions may not be allowed (e.g., going though a wall). Furthermore, there may be transitions, even in the absence of control, which the agent is obliged to make (e.g., getting older). These constraints and obligatory transitions are encoded in <italic>P</italic>(0). The reader is encouraged to read Ref. <xref ref-type="bibr" rid="pcbi.1000254-Todorov1">[7]</xref> for a useful treatment of optimal control problems and related approximation strategies.</p>
<p>Equation 3a is intuitive, in that admissible states with relatively high value will be visited with greater probability. Under some fairly sensible assumptions about the utility function (i.e., assuming a control cost based on the divergence between controlled and uncontrolled transition probabilities), Equation 3 is the optimum policy.</p>
<p>This policy connects our generative model of action to economics and behavioural game theory <xref ref-type="bibr" rid="pcbi.1000254-Camerer1">[8]</xref>, where the softmax or logit function (Equation 3) is a ubiquitous model of transitions under value or attraction; for example, a logit response rule is used to map attractions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e017" xlink:type="simple"/></inline-formula> to transition probabilities:<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e018" xlink:type="simple"/><label>(3b)</label></disp-formula>In this context, <italic>λ</italic> is known as response <italic>sensitivity</italic>; see Camerer <xref ref-type="bibr" rid="pcbi.1000254-Camerer1">[8]</xref> for details. Furthermore, a logit mapping is also consistent with stochastic perturbations of value, which leads to quantal response equilibria (QRE). QRE are a game-theoretical formulation <xref ref-type="bibr" rid="pcbi.1000254-McKelvey1">[9]</xref>, which converges to the Nash equilibrium when <italic>λ</italic> goes to infinity. In most applications, it is assumed that perturbations are drawn from an extreme value distribution, yielding the familiar and convenient logit choice probabilities in Equation 3 (see <xref ref-type="bibr" rid="pcbi.1000254-Haile1">[10]</xref> for details). Here, <italic>λ</italic> relates to precision of random fluctuations on value.</p>
<p>Critically, Equation 3 prescribes a probabilistic policy that is necessary to define the likelihood of observed behaviour for model comparison. Under this fixed-form policy, the problem reduces to optimising the value-function (i.e., solving the nonlinear self-consistent Bellman equations). These are solved simply and quickly by using a Robbins-Monro or stochastic iteration algorithm <xref ref-type="bibr" rid="pcbi.1000254-Benveniste1">[11]</xref><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e019" xlink:type="simple"/><label>(4)</label></disp-formula>At convergence, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e020" xlink:type="simple"/></inline-formula> becomes the optimal value-function, which is an analytic function of payoff; <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e021" xlink:type="simple"/></inline-formula>. From now on, we will assume <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e022" xlink:type="simple"/></inline-formula> is the solution to the relevant Bellman equation. This provides an optimum value-function for any state-space and associated payoff, encoded in a ‘game’.</p>
<p>Clearly, this is not the only way to model behaviour. However, the Todorov formalism greatly simplifies the learning problem and provides closed-form solutions for optimum value: In treatments based on Markov decision processes, in which the state transition matrix depends on an action, <italic>both</italic> the value-function and policy are optimised iteratively. However, by assuming that value effectively prescribes the transition probabilities (Equation 3), we do not have to define ‘action’ and avoid having to optimise the policy <italic>per se</italic>. Furthermore, as the optimal value is well-defined we do not have to worry about learning the value-function. In other words, because the value-function can be derived analytically from the loss-function (irrespective of the value-learning scheme employed by the agent), we do not need to model <italic>how</italic> the agent comes to acquire it; provided it learns the veridical value-function (which in many games is reasonably straightforward). This learning could use dynamic programming <xref ref-type="bibr" rid="pcbi.1000254-Sutton1">[12]</xref>, or Q-learning <xref ref-type="bibr" rid="pcbi.1000254-Watkins1">[13]</xref>, or any biologically plausible scheme.</p>
</sec><sec id="s2b">
<title>A Toy Example</title>
<p>The example in <xref ref-type="fig" rid="pcbi-1000254-g001">Figure 1</xref> illustrates the nature and role of the quantities described above. We used a one-dimensional state-space with <italic>n</italic> = 16 states, where an agent can move only to adjacent states (<xref ref-type="fig" rid="pcbi-1000254-g001">Figure 1A</xref>). This restriction is encoded in the uncontrolled transition probabilities. We assumed the agent is equally likely to move, or not move, when uncontrolled; i.e., the probability of remaining in a state is equal to the sum of transitions to other states (<xref ref-type="fig" rid="pcbi-1000254-g001">Figure 1B</xref>). To make things interesting, we considered a payoff function that has two maxima; a local maximum at state four and the global maximum at state twelve (<xref ref-type="fig" rid="pcbi-1000254-g001">Figure 1C</xref>). In effect, this means the optimum policy has to escape the local maximum to reach the global maximum. <xref ref-type="fig" rid="pcbi-1000254-g001">Figure 1D</xref> shows the successive value-function approximations as Equation 4 is iterated from <italic>τ</italic> = 1 to 32. Initially, the local maximum captures state-trajectories but as the value-function converges to the optimal value-function, it draws paths through the local maximum, toward the global maximum. Instead of showing example trajectories under the optimal value-function, we shows the density of an ensemble of agents, <italic>ρ</italic>(<italic>s</italic>,<italic>t</italic>), as a function of time, starting with a uniform distribution on state-space, <italic>ρ</italic>(<italic>s</italic>,0) = 1/<italic>n</italic> (<xref ref-type="fig" rid="pcbi-1000254-g001">Figure 1E</xref>). The ensemble density dynamics are given simply by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e023" xlink:type="simple"/></inline-formula>. It can be seen that nearly all agents have found their goal by about <italic>t</italic> = 18 ‘moves’.</p>
<fig id="pcbi-1000254-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000254.g001</object-id><label>Figure 1</label><caption>
<title>Toy example using a one-dimensional maze.</title>
<p>(A) The agent (red circle) moves to the adjacent states from any given state to reach a goal. There are two goals, where the agent obtains a small payoff (small square at state 4) or a big payoff (big square at state 12). (B) The uncontrolled state transition matrix. (C) The payoff-function over the states with a local and global maximum. (D) Iterative approximations to the optimal value-function. In early iterations, the value-function is relatively flat and shows a high value at the local maximum. With a sufficient number of iterations, <italic>τ</italic>≥24, the value-function converges to the optimum (the red line) which induces paths toward the global maximum at state 12. (E) The dynamics of an ensemble density, under the optimal value-function. The density is uniform on state-space at the beginning, <italic>t</italic> = 1, and develops a sharp peak at the global maximum over time.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.g001" xlink:type="simple"/></fig>
<p>In summary, we can compute an optimal value-function for any game, <italic>G</italic>(ℓ,<italic>P</italic>(0)) specified in terms of payoffs and constraints. This function specifies the conditional transition probabilities that define an agent's policy, in terms of the probability of emitting a sequence of moves or state-transitions. In the next section, we examine how value-functions are elaborated when several agents play the same game.</p>
</sec><sec id="s2c">
<title>Games and Multiple Agents</title>
<p>When dealing with two agents the state-space becomes the Cartesian product of the admissible states of both agents, <italic>S</italic> = <italic>S</italic><sub>1</sub>×<italic>S</italic><sub>2</sub> (Note that all that follows can be extended easily to over <italic>m</italic> agents.). This means that the payoff <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e024" xlink:type="simple"/></inline-formula> and value <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e025" xlink:type="simple"/></inline-formula> are defined on a joint-space for each agent <italic>k</italic>. The payoff for the first agent ℓ<sub>1</sub>(<italic>i</italic>, <italic>j</italic>) occurs when it is in state <italic>i</italic> and the second is in state <italic>j</italic>. This can induce cooperation or competition, unless the payoff for one agent does not depend on the state of the other: i.e., ∀<italic>j</italic>,<italic>k</italic> : ℓ<sub>1</sub>(<italic>i</italic>, <italic>j</italic>) = ℓ<sub>1</sub>(<italic>i</italic>, <italic>k</italic>). Furthermore, the uncontrolled probabilities for one agent now become a function of the other agent's value, because one agent cannot control the other. This presents an interesting issue of how one agent represents the policy of the other.</p>
<p>In what follows, we consider policies that are specified by an order: first-order policies discount the policies of other agents (i.e., I will ignore your goals). Second-order policies are optimised under the assumption that you are using a first-order policy (i.e., you are ignoring my goals). Third-order policies pertain when I assume that you assume I am using a first-order policy and so on. This construction is interesting, because it leads to an infinite regress: I model your value-function but your value-function models mine, which includes my model of yours, which includes my model of your model of mine and so on <italic>ad infinitum</italic>. We will denote the <italic>i</italic>-th order value-function for the <italic>k</italic>-th agent by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e026" xlink:type="simple"/></inline-formula>. We now consider how to compute these value-functions.</p>
</sec><sec id="s2d">
<title>Sequential Games</title>
<p>In a sequential game, each agent takes a turn in a fixed order. Let player one move first. Here, the transition probabilities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e027" xlink:type="simple"/></inline-formula> now cover the Cartesian product <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e028" xlink:type="simple"/></inline-formula> of the states of both agents and the joint transition-matrix <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e029" xlink:type="simple"/></inline-formula> factorises into agent-specific terms. These are given by<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e030" xlink:type="simple"/><label>(5)</label></disp-formula>where Π<italic><sub>k</sub></italic>(0) specifies uncontrolled transitions in the joint-space, given the uncontrolled transitions <italic>P<sub>k</sub></italic>(0) in the space of the <italic>k</italic>-th agent. Their construction using the Kronecker tensor product ⊗ ensures that the transition of one agent does not change the state of the other. Furthermore, it assumes that the uncontrolled transitions of one agent do not depend on the state of the other; they depend only on the uncontrolled transitions <italic>P<sub>k</sub></italic>(0) among the <italic>k</italic>-th agent's states. The row vectors <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e031" xlink:type="simple"/></inline-formula> are the vectorised versions of the two dimensional value-functions for the <italic>k</italic>-th agent, covering the joint states. We will use a similar notation for the payoffs, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e032" xlink:type="simple"/></inline-formula>. Critically, both agents have a value-function on every joint-state but can only change their own state. These value-functions can now be evaluated through recursive solutions of the Bellman equations<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e033" xlink:type="simple"/><label>(6)</label></disp-formula>This provides a simple way to evaluate the optimal value-functions for both agents, to any arbitrary order. The optimal value-function for the first agent, when the second is using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e034" xlink:type="simple"/></inline-formula> is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e035" xlink:type="simple"/></inline-formula>. Similarly, the optimal value under <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e036" xlink:type="simple"/></inline-formula> for the second is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e037" xlink:type="simple"/></inline-formula>. It can be seen that under an optimum strategy (i.e., a second-level policy) each agent should increase its order over the other until a QRE obtains when <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e038" xlink:type="simple"/></inline-formula> for both agents. However, it is interesting to consider equilibria under non-optimal strategies, when both agents use low-order policies in the mistaken belief that the other agent is using an even lower order. It is easy to construct examples where low-order strategies result in risk-dominant policies, which turn into payoff-dominant policies as high-order strategies are employed; as illustrated next.</p>
</sec><sec id="s2e">
<title>A Stag-Hunt</title>
<p>In this example, we used a simple two-player stag-hunt game where two hunters can either jointly hunt a stag or pursue a rabbit independently <xref ref-type="bibr" rid="pcbi.1000254-Skyrms1">[14]</xref>. <xref ref-type="table" rid="pcbi-1000254-t001">Table 1</xref> provides the respective payoffs for this game as a normal form representation. If an agent hunts a stag, he must have the cooperation of his partner in order to succeed. An agent can catch a rabbit by himself, but a rabbit is worth less than a stag. This furnishes two pure-strategy equilibria: one is risk-dominant with low-payoff states that can be attained without cooperation (i.e., catching a rabbit) and the other is payoff dominant; high-payoff states that require cooperation (i.e., catching a stag). We assumed the state-space of each agent is one-dimensional with <italic>n</italic><sub>1</sub> = <italic>n</italic><sub>2</sub> = 16 possible states. This allows us to depict the value-functions on the joint space as two-dimensional images. The dimensionality of the state-space is not really important; however, a low-dimensional space imposes sparsity on the transition matrices, because only a small number of neighbouring states can be visited from any given state. These constraints reduce the computational load considerably. The ‘rabbit’ and ‘stag’ do not move; the rabbit is at state four and the stag at state twelve. The key difference is that the payoff for the ‘stag’ is accessed only when both players occupy that state (or nearby), whereas the payoff for the ‘rabbit’ does not depend on the other agent's state. <xref ref-type="fig" rid="pcbi-1000254-g002">Figure 2A</xref> shows the characteristic payoff functions for both agents. The ensuing value-functions for the order <italic>i</italic> = 1,…,4 from Equation 6 are shown in <xref ref-type="fig" rid="pcbi-1000254-g002">Figure 2B</xref>. It can be seen that first-order strategies defined by <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e039" xlink:type="simple"/></inline-formula> regard the ‘stag’ as valuable, but only when the other agent is positioned appropriately. Conversely, high-order strategies focus exclusively on the stag. As one might intuit, the equilibrium densities of an ensemble of agents acting under first or high-order strategies have qualitatively different forms. Low-order strategies result in both agents hunting the ‘rabbit’ and high-order schemes lead to a cooperative focus on the ‘stag’. <xref ref-type="fig" rid="pcbi-1000254-g002">Figure 2C</xref> shows the joint and marginal equilibrium ensemble densities <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e040" xlink:type="simple"/></inline-formula> for <italic>t</italic> = 128 (i.e., after 128 moves) and a uniform starting distribution; for matched strategies, <italic>i</italic> = 1,…,4.</p>
<fig id="pcbi-1000254-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000254.g002</object-id><label>Figure 2</label><caption>
<title>Stag-hunt game with two agents.</title>
<p>(A) The payoff-functions for the first (the left panel) and the second agent (the right panel) over the joint state-space. The red colour indicates a higher payoff. The payoff of the ‘stag’ (state 12) is higher than the ‘rabbit’ (state 4). (B) Optimal value-functions of first, second, third and fourth order (from the top to the bottom) for both agents. The low-order value-functions focus on the risk-dominant states, while high-order functions lead to payoff dominant states that require cooperation. (C) The equilibrium densities of an ensemble of agents after 128 moves, when both agents use matched value-functions in (B). The left and right panels show the joint and marginal equilibrium densities over the joint state-space and the state of the first agent, respectively.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.g002" xlink:type="simple"/></fig><table-wrap id="pcbi-1000254-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000254.t001</object-id><label>Table 1</label><caption>
<title>Normal-form representation of a stag-hunt in terms of payoffs in which the following relations hold: <italic>A</italic>&gt;<italic>B</italic>≥<italic>C</italic>&gt;<italic>D</italic> and <italic>a</italic>&gt;<italic>b</italic>≥<italic>c</italic>&gt;<italic>d</italic>.</title>
</caption><!--===== Grouping alternate versions of objects =====--><alternatives><graphic id="pcbi-1000254-t001-1" mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.t001" xlink:type="simple"/><table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" colspan="2" rowspan="1"/>
<td align="left" colspan="2" rowspan="1">Hunter 2</td>
</tr>
<tr>
<td align="left" colspan="2" rowspan="1"/>
<td align="left" colspan="1" rowspan="1">Stag</td>
<td align="left" colspan="1" rowspan="1">Rabbit</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" colspan="1" rowspan="1"><bold>Hunter 1</bold></td>
<td align="left" colspan="1" rowspan="1"><bold>Stag</bold></td>
<td align="left" colspan="1" rowspan="1">A, a</td>
<td align="left" colspan="1" rowspan="1">C, b</td>
</tr>
<tr>
<td align="left" colspan="1" rowspan="1"/>
<td align="left" colspan="1" rowspan="1"><bold>Rabbit</bold></td>
<td align="left" colspan="1" rowspan="1">B, c</td>
<td align="left" colspan="1" rowspan="1">D, d</td>
</tr>
</tbody>
</table></alternatives><table-wrap-foot><fn id="nt101"><label/><p>Upper-case letters represent the payoffs for the first hunter and lower-case letters represent the payoffs for the second.</p></fn></table-wrap-foot></table-wrap></sec><sec id="s2f">
<title>Inferring an Agent's Strategy</title>
<p>In contrast to single-player games, polices in multi-player games have an order, where selecting the optimal order depends on the opponent. This means we have to consider how players evaluate the probability that an opponent is using a particular policy or how we, as experimenters, make inferences about the policies players use during sequential games. This can be done using the evidence for a particular policy, given the choices made. In the course of a game, the trajectory of choices or states <italic>y</italic> = <italic>s</italic><sub>1</sub>,<italic>s</italic><sub>2</sub>,…,<italic>s<sub>T</sub></italic> is observed directly such that, under Markov assumptions<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e041" xlink:type="simple"/><label>(7)</label></disp-formula>Where <italic>m</italic>∈<italic>M</italic> represents a model of the agents and entails the quantities needed to specify their policies. The probability of a particular model, under flat priors on the models, is simply<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e042" xlink:type="simple"/><label>(8)</label></disp-formula>To illustrate inference on strategy, consider the situation in which the strategy (i.e., the policy order <italic>k</italic><sub>1</sub>) of the first agent is known. This could be me and I might be trying to infer your policy, to optimise mine; or the first agent could be a computer and the second a subject, whose policy we are trying to infer experimentally. In this context, the choices are the sequence of joint-states over trials, <italic>y</italic>∈<italic>S</italic>, where there are <italic>n</italic><sub>1</sub>×<italic>n</italic><sub>2</sub> possible states; note that each joint state subsumes both ‘moves’ of each agent. From Equation 8 we can evaluate the probability of the second agent's strategy, under the assumption it entails a fixed and ‘pure’ policy of order <italic>k</italic><sub>2</sub><disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e043" xlink:type="simple"/><label>(9)</label></disp-formula>Here, the model is specified by the unknown policy order, <italic>m</italic> = <italic>k</italic><sub>2</sub> of the second agent. Equation 9 uses the joint transition probabilities on the moves of all players; however, one gets exactly the same result using just the moves and transition matrix from the player in question. This is because, the contributions of the other players cancel, when the evidence is normalised. We use the redundant form in Equation 9 so that it can be related more easily to inference on the joint strategies of all agents in Equation 8. An example of this inference is provided in <xref ref-type="fig" rid="pcbi-1000254-g003">Figure 3</xref>. In <xref ref-type="fig" rid="pcbi-1000254-g003">Figure 3A and 3B</xref>, we used unmatched and matched strategies to generate samples using the probability transition matrices <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e044" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e045" xlink:type="simple"/></inline-formula>; starting in the first state (i.e., both agents in state 1) respectively. These simulated games comprised four consecutive 32-move trials of the stag-hunt game specified in <xref ref-type="fig" rid="pcbi-1000254-g002">Figure 2</xref>. The ensuing state trajectories are shown in the left panels. We then inverted the sequence using Equation 9 and a model-space of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e046" xlink:type="simple"/></inline-formula>. The results for <italic>T</italic> = 1,…,128 are shown in the right panels. For both simulations, the correct strategy discloses itself after about sixty moves, in terms of conditional inference on the second agent's policy. It takes this number of trials because, initially, the path in joint state-space is ambiguous; as it moves towards both the rabbit and stag.</p>
<fig id="pcbi-1000254-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000254.g003</object-id><label>Figure 3</label><caption>
<title>Inference on agent's strategy in the stag-hunt game.</title>
<p>We assumed agents used unmatched strategies, in which the first agent used a fourth order strategy and the second agent used a first order strategy (A), and matched strategies - both agents used the fourth order strategy (B). The left panels show four state trajectories of 32 moves simulated using (or generated from) value-functions in <xref ref-type="fig" rid="pcbi-1000254-g002">Figure 2B</xref>. The right panels show the conditional probabilities of the second agent's strategy over a model-space of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e047" xlink:type="simple"/></inline-formula> as a function of time.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.g003" xlink:type="simple"/></fig></sec><sec id="s2g">
<title>Bounded Rationality</title>
<p>We have seen how an <italic>N</italic>-player game is specified completely by a set of utility functions and a set of constraints on state-transitions. These two quantities define, recursively, optimal value-functions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e048" xlink:type="simple"/></inline-formula> of increasing order and their implicit policies. Given these policies, one can infer the strategies employed by agents, in terms of which policies they are using, given a sequence of transitions. In two-player games, when the opponent uses policy <italic>k</italic>, the optimum strategy is to use policy <italic>k</italic>+1. This formulation accounts for the representation of another's goals and optimising both policies and strategies. However, it induces a problem; to optimise ones own strategy, one has to know the opponent's policy. Under rationality assumptions, this is not really a problem because rational players will, by induction, use policies of sufficiently high order to ensure <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e049" xlink:type="simple"/></inline-formula>. This is because each player will use a policy with an order that is greater than the opponent and knows a rational opponent will do the same. The interesting issues arise when we consider bounds or constraints on the strategies available to each player and their prior expectations about these constraints.</p>
<p>Here, we deal with optimisation under bounded rationality <xref ref-type="bibr" rid="pcbi.1000254-Kahneman1">[4]</xref> that obliges players to make inferences about each other. We consider bounds, or constraints, that lead to inference on the opponent's strategy. As intimated above, it is these bounds that lead to interesting interactions between players and properly accommodate the fact that real players do not have unbounded computing resources to attain a QRE by using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e050" xlink:type="simple"/></inline-formula>. These constraints are formulated in terms of the policy <italic>k<sub>i</sub></italic> of the <italic>i</italic>-th player, which specifies the corresponding value-function and policy <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e051" xlink:type="simple"/></inline-formula>. The constraints we consider are:</p>
<list list-type="bullet"><list-item>
<p>The <italic>i</italic>-th player uses an approximate conditional density <italic>q<sub>i</sub></italic>(<italic>k<sub>j</sub></italic>) on the strategy of the <italic>j</italic>-th player that is a point mass at the conditional mode, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e052" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Each player has priors <italic>p<sub>i</sub></italic>(<italic>k<sub>j</sub></italic>), which place an upper bound on the opponents sophistication; ∀<italic>k<sub>j</sub></italic>&gt;<italic>K<sub>i</sub></italic> : <italic>p<sub>i</sub></italic>(<italic>k<sub>j</sub></italic>) = 0</p>
</list-item></list>
<p>These assumptions have a number of important implications. First, because <italic>q<sub>i</sub></italic>(<italic>k<sub>j</sub></italic>) is a point mass at the mode <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e053" xlink:type="simple"/></inline-formula>, each player will assume every other player is using a pure strategy, as opposed to a strategy based on a mixture of value-functions. Second, under this assumption, each player will respond optimally with another <italic>pure</italic> strategy, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e054" xlink:type="simple"/></inline-formula>. Third, because there is an upper bound on <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e055" xlink:type="simple"/></inline-formula> imposed by an agent's priors, they will never call upon strategies more sophisticated than <italic>k<sub>i</sub></italic> = <italic>K<sub>i</sub></italic>+1. In this way, <italic>K<sub>i</sub></italic> bounds both the prior assumptions about other players and the sophistication of the player <italic>per se</italic>. This defines a ‘type’ of player <xref ref-type="bibr" rid="pcbi.1000254-Smith1">[15]</xref> and is the central feature of the bounded rationality under which this model is developed. Critically, type is an attribute of a player's prior assumptions about others. The nature of this bound means that any player cannot represent the goals or intentions of another player who is more sophisticated; in other words, it precludes any player ‘knowing the mind of God’ <xref ref-type="bibr" rid="pcbi.1000254-Davies1">[16]</xref>.</p>
</sec><sec id="s2h">
<title>Representing the Goals of Another</title>
<p>Under flat priors on the bounded support of the priors <italic>p<sub>i</sub></italic>(<italic>k<sub>j</sub></italic>), the mode can be updated with each move using Equation 9. Here, player one would approximate the conditional density on the opponent's strategy with the mode<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e056" xlink:type="simple"/><label>(10)</label></disp-formula>And optimise its strategy accordingly, by using <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e057" xlink:type="simple"/></inline-formula>. This scheme assumes the opponent uses a fixed strategy and consequently accumulates evidence for each strategy over the duration of the game. <xref ref-type="fig" rid="pcbi-1000254-g004">Figure 4</xref> illustrates the conditional dependencies of the choices and strategies; it tries to highlight the role of the upper bounds in precluding recursive escalation of <italic>k<sub>i</sub></italic>(<italic>t</italic>). Note, that although each player assumes the other is using a stationary strategy, the players own policy is updated after every move.</p>
<fig id="pcbi-1000254-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000254.g004</object-id><label>Figure 4</label><caption>
<title>Schematic detailing inference on an opponent's strategy.</title>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.g004" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1000254-g005">Figure 5A</xref> shows a realization of a simulated stag-hunt using two types of player with asymmetric bounds <italic>K</italic><sub>1</sub> = 4 and <italic>K</italic><sub>2</sub> = 3 (both starting with <italic>k<sub>i</sub></italic>(1) = 1). Both players strive for an optimum strategy using Equation 10. We generated four consecutive 32-move trials; 128 trials in total, starting in the first state with both agents in state one. After 20 moves, the first, more sophisticated, player has properly inferred the upper bound of the second and plays at one level above it. The second player has also optimised its strategy, which is sufficiently sophisticated to support cooperative play. The lower panels show the implicit density on the opponent's strategy, <italic>p</italic>(<italic>k</italic><sub>2</sub>|<italic>y</italic>,<italic>k</italic><sub>1</sub>); similarly for the second player. The mode of this density is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e058" xlink:type="simple"/></inline-formula> in Equation 10.</p>
<fig id="pcbi-1000254-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000254.g005</object-id><label>Figure 5</label><caption>
<title>Inference on opponent's types in the stag-hunt game.</title>
<p>Two players with asymmetric types <italic>K</italic><sub>1</sub> = 4 and <italic>K</italic><sub>2</sub> = 3 used an optimum strategy based on the inferred opponent's strategy. (A) The top panel shows the strategies of both agents over time. The middle and bottom panels show the implicit densities of the opponent's strategy for the first and the second player, respectively. The densities for both agents converge on the correct opponent's strategies after around 20 moves. (B) The posterior probabilities over fixed and theory of mind (ToM) models. The left graph shows the likelihood over fixed models using <italic>k</italic><sub>1</sub>,<italic>k</italic><sub>2</sub> = 1,…,5 and the right graph shows the likelihood of ToM models with <italic>K</italic><sub>1</sub>,<italic>K</italic><sub>2</sub> = 0,…,4. The veridical model (dark blue bar) shows model with the maximum likelihood, among 50 models.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.g005" xlink:type="simple"/></fig></sec><sec id="s2i">
<title>Inferring Theory of Mind</title>
<p>We conclude this section by asking if we, as experimenters, can infer <italic>post hoc</italic> on the ‘type’ of players, given just their choice behaviours. This is relatively simple and entails accumulating evidence for different models in exactly the same way that the players do. We will consider fixed-strategy models in which both players use a fixed <italic>k<sub>i</sub></italic> or theory of mind models, in which players infer on each other, to optimise <italic>k<sub>i</sub></italic>(<italic>t</italic>) after each move. The motivation for considering fixed models is that they provide a reference model, under which the policy is not updated and therefore there is no need to infer the opponent's policy. Fixed models also relate to an alternative [prosocial] scheme for optimising behaviour, reviewed in the discussion. The evidence for fixed models is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e059" xlink:type="simple"/><label>(11)</label></disp-formula>Whereas the evidence for theory of mind models is<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e060" xlink:type="simple"/><label>(12)</label></disp-formula>where <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e061" xlink:type="simple"/></inline-formula> are inferred under the appropriate priors specified by <italic>K<sub>i</sub></italic>. The key difference between these models is that the policy changes adaptively in the theory of mind model, in contrast to the fixed model.</p>
<p>Under flat model priors, the posterior, <italic>p</italic>(<italic>m<sub>i</sub></italic>|<italic>y</italic>) (Equation 8) can be used for inference on model-space. We computed the posterior probabilities of fifty models, using Equation 11 and 12. Half of these models were fixed models using <italic>k</italic><sub>1</sub>,<italic>k</italic><sub>2</sub> = 1,…,5 and the remaining were theory of mind models with <italic>K</italic><sub>1</sub>,<italic>K</italic><sub>2</sub> = 0,…,4. <xref ref-type="fig" rid="pcbi-1000254-g005">Figure 5B</xref> shows the results of this model comparison using the simulated data shown in <xref ref-type="fig" rid="pcbi-1000254-g005">Figure 5A</xref>. We evaluated the posterior probability of theory of mind by marginalising over the bi-partition of fixed and theory of mind models, and it can be seen that the likelihood of the theory of mind model is substantially higher than the fixed model. Furthermore, the model with types <italic>K</italic><sub>1</sub> = 4 and <italic>K</italic><sub>2</sub> = 3 supervenes, yielding a 94.5% confidence that this is the correct model. The implicit densities used by the players on each others strategy <italic>p</italic>(<italic>k</italic><sub>2</sub>|<italic>y</italic>,<italic>k</italic><sub>1</sub>) and <italic>p</italic>(<italic>k</italic><sub>1</sub>|<italic>y</italic>,<italic>k</italic><sub>2</sub>) (see Equation 11) are exactly the same as in <xref ref-type="fig" rid="pcbi-1000254-g005">Figure 5A</xref> because the veridical model was selected.</p>
<p>Because we assumed the model is stationary over trials, the conditional confidence level increases with the number of trials; although this increase depends on the information afforded by the particular sequence. On the other hand, the posterior distribution over models tends to be flatter as the model-space expands because the difference between successive value-functions, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e062" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e063" xlink:type="simple"/></inline-formula> becomes smaller with increasing order. For the stag-hunt game in <xref ref-type="fig" rid="pcbi-1000254-g002">Figure 2</xref>, value-functions with <italic>k</italic>≥4 are nearly identical. This means that we could only infer with confidence that, <italic>K<sub>i</sub></italic>≥5 (see <xref ref-type="supplementary-material" rid="pcbi.1000254.s001">Figure S1</xref>).</p>
</sec></sec><sec id="s3">
<title>Results</title>
<p>In this section, we apply the modelling and inference procedures of the preceding section to behavioural data obtained while real subjects played a stag-hunt game with a computer. In this experiment, subjects navigated a grid maze to catch stags or rabbits. When successful, subjects accrued points that were converted into money at the end of the experiment. First, we inferred the model used by subjects, under the known policies of their computer opponents. This allowed us to establish whether they were using theory of mind or fixed models and, under theory of mind models, how sophisticated the subjects were. Using Equation 10 we then computed the subjects' conditional densities on the opponent's strategies, under their maximum <italic>a posteriori</italic> sophistication.</p>
<sec id="s3a">
<title>Experimental Procedures</title>
<p>The subject's goal was to negotiate a two-dimensional grid maze in order to catch a stag or rabbit (<xref ref-type="fig" rid="pcbi-1000254-g006">Figure 6</xref>). There was one stag and two rabbits. The rabbits remained at the same grid location and consequently were easy to catch without help from the opponent. If one hunter moved to the same location as a rabbit, he/she caught the rabbit and received ten points. In contrast, the stag could move to escape the hunters. The stag could only be caught if both hunters moved to the locations adjacent to the stag (in a co-operative pincer movement), after which they both received twenty points. Note that as the stag could escape optimally, it was impossible for a hunter to catch the stag alone. The subjects played the game with one of two types of computer agents; A and B. Agent A adopted a lower-order (competitive) strategy and tried to catch a rabbit by itself, provided both hunters were not close to the stag. On the other hand, agent B used a higher-order (cooperative) strategy and chased the stag even if it was close to a rabbit. At each trial, both hunters and the stag moved one grid location sequentially; the stag moved first, the subject moved next, and the computer moved last. The subjects chose to move to one of four adjacent grid locations (up, down, left, or right) by pressing a button; after which they moved to the selected grid. Each move lasted two seconds and if the subjects did not press a key within this period, they remained at the same location until the next trial.</p>
<fig id="pcbi-1000254-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000254.g006</object-id><label>Figure 6</label><caption>
<title>Stag-hunt game with two hunters: a human subject and a computer agent.</title>
<p>The aim of the hunters (red and green circles) is to catch stag (big square) or rabbit (small squares). The hunters and the stag can move to adjacent states, while the rabbits are stationary. At each trial, both hunters and the stag move sequentially; the stag moved first, the subject moved next, and the computer moved last. Each round finishes when either of the hunters caught a prey or when a maximum number of moves had expired.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.g006" xlink:type="simple"/></fig>
<p>Subjects lost one point on each trial (even if they did not move). Therefore, to maximise the total number of points, it was worth trying to catch a prey as quickly as possible. The round finished when either of the hunters caught a prey <italic>or</italic> when a certain number of trials (15±5) had expired. To prevent subjects changing their behaviour, depending on the inferred number of moves remaining, the maximum number of moves was randomised for each round. In practice, this manipulation was probably unnecessary because the minimum number of moves required to catch a stag was at most nine (from any initial state). Furthermore, the number of ‘time out’ rounds was only four out of a total 240 rounds (1.7%). At the beginning of each round the subjects were given fifteen points, which decreased by one point per trial, continuing below zero beyond fifteen trials. For example, if the subject caught a rabbit on trial five, he/she got the ten points for catching the rabbit, plus the remaining time points: 10 = 15−5 points, giving 20 points in total, whereas the other player received only their remaining time points; i.e., 10 points. If the hunters caught a stag at trial eight, both received the remaining 7 = 15−8 time points plus 20 points for catching the stag, giving 27 points in total. The remaining time points for both hunters were displayed on each trial and the total number of points accrued was displayed at the end of each round.</p>
<p>We studied six (normal young) subjects (three males) and each played four blocks with both types of computer agent in alternation. Each block comprised ten rounds; so that they played forty rounds in total. The start positions of all agents; the hunters and the stag, were randomised on every round, under the constraint that the initial distances between each hunter and the stag were more than four grids points.</p>
</sec><sec id="s3b">
<title>Modelling Value Functions</title>
<p>We applied our theory of mind model to compute the optimal value-functions for the hunters and <italic>stag</italic>. As hunters should optimise their strategies based not only on the other hunter's behaviour but also the stag's, we modelled the hunt as a game with three agents; two hunters and a stag. Here state-space became the Cartesian product of the admissible states of all agents, and the payoff was defined on a joint space for each agent; i.e., on a |<italic>S</italic><sub>1</sub>|×|<italic>S</italic><sub>2</sub>|×|<italic>S</italic><sub>3</sub>| array. The payoff for the stag was minus one when both hunters were at the same location as the stag and zero for the other states. For the hunters, the payoff of catching a stag was one and accessed only when both the hunters' states were next to the stag. The payoff for catching a rabbit was one half and did not depend on the other hunter's state. For the uncontrolled transition probabilities, we assumed that all agents would choose allowable actions (including no-move) with equal probability and allowed co-occupied locations; i.e., two or more agents could be in the same state. Allowable moves were constrained by obstacles in the maze (see <xref ref-type="fig" rid="pcbi-1000254-g006">Figure 6</xref>).</p>
<p>We will refer to the stag, subject, and computer as the 1st, 2nd, and 3rd agent, respectively. The transition probability at each trial is <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e064" xlink:type="simple"/></inline-formula>. The <italic>i</italic>-th order value-function for the <italic>j</italic>-th agent, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e065" xlink:type="simple"/></inline-formula>, was evaluated through recursive solutions of the Bellman equations by generalising Equation 6 to three players<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e066" xlink:type="simple"/><label>(13)</label></disp-formula>Notice that the first agent's (stag's) value-function is fixed at first-order. This is because we assumed that the hunters believed, correctly, that the stag was not sophisticated. We used a convergence criterion of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e067" xlink:type="simple"/></inline-formula> to calculate the optimal value-functions, using Equation 4. For simplicity, we assumed the sensitivity <italic>λ</italic> of each player was one. A maximum likelihood estimation of the subjects' sensitivities, using the observed choices from all subjects together, showed that the optimal value was <italic>λ</italic> = 1.6. Critically, the dependency of the likelihood on strategy did not change much with sensitivity, which means our inferences about strategy are fairly robust to deviations from <italic>λ</italic> = 1 (see <xref ref-type="supplementary-material" rid="pcbi.1000254.s002">Figure S2</xref>). When estimated individually for each subject, the range was 1.5≤<italic>λ</italic>≤1.8, suggesting our approximation was reasonable and enabled us to specify the policy for each value-function and solve Equation 13 recursively.</p>
<p>The ensuing optimal value-functions of the subject, <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e068" xlink:type="simple"/></inline-formula>, for <italic>i</italic> = 1,…,4 are shown in <xref ref-type="fig" rid="pcbi-1000254-g007">Figure 7</xref>. To depict the three-dimensional value-functions of one agent in two-dimensional state-space, we fixed the positions of the other two agents for each value-function. Here, we show the value-functions of the subject for three different positions of the computer and the stag (three examples of four value-functions of increasing order). The locations of the computer and stag are displayed as a red circle and square respectively. One can interpret these functions as encoding the average direction the subject would choose from any location. This direction is the one that increases value (lighter grey in the figures). It can be seen that the subject's policy (whether to chase a stag or a rabbit) depends on the order of value-functions <italic>and</italic> the positions of the other agents. The first-order policy regards the rabbits as valuable because it assumes that other agents move around the maze in an uncontrolled fashion, without any strategies, and are unlikely to help catch the stag. Conversely, if subjects account for the opponent's value-functions (i.e., using the second or higher order policies), they behave cooperatively (to catch a stag), provided the opponent is sufficiently close to the stag. Furthermore, with the highest order value-function, even if the other hunter is far away from the stag, the subject still tries to catch the stag (top right panel in <xref ref-type="fig" rid="pcbi-1000254-g007">Figure 7</xref>). For all orders of value-functions, the stag's value becomes higher than the rabbits', when the other hunter is sufficiently close to the stag (the middle row). However, interestingly, the policies here are clearly different; in the first-order function, value is higher for the states which are closer to the stag and the two states next to the stag have about the same value. Thus, if the subject was in the middle of the maze, he/she would move downward to minimize the distance to the stag. In contrast, in the second and higher-order functions, the states leading to the right of the stag are higher than the left, where the other hunter is. This is not because that the right side states are closer to another payoff, such as a rabbit. In fact, even when the other hunter is on the right side of the stag and very close to the rabbit, the states leading to the other (left) side are higher in the fourth-order function (bottom right panel). These results suggest that sophisticated subjects will anticipate the behaviour of other agents and use this theory of mind to compute effective ways to catch the stag, even if this involves circuitous or paradoxical behaviour.</p>
<fig id="pcbi-1000254-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000254.g007</object-id><label>Figure 7</label><caption>
<title>The optimal value-functions of the subjects for four different orders (columns) and for three different positions (rows).</title>
<p>The circles are the computer agent's locations, and the big and small squares are the locations of the stags and the rabbits, respectively. Brighter colours indicate higher values.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.g007" xlink:type="simple"/></fig></sec><sec id="s3c">
<title>Modelling Strategy</title>
<p>Using these optimal value-functions, we applied the model comparison procedures above to infer the types of the subjects. We calculated the evidence for each subject acting under a fixed or theory of mind model using <italic>k</italic><sub>2</sub> = <italic>k</italic><sub>sub</sub> = 1,…,8 and <italic>K</italic><sub>2</sub> = <italic>K</italic><sub>sub</sub> = 1,…,8 and data pooled from all their sessions. We used the true order of the other players' policies for the model comparison; i.e., <italic>k</italic><sub>1</sub> = <italic>k</italic><sub>stag</sub> = 1 for the stag, <italic>k</italic><sub>3</sub> = <italic>k</italic><sub>com</sub> = 1 for the agent A and <italic>k</italic><sub>com</sub> = 5 for the agent B (<xref ref-type="supplementary-material" rid="pcbi.1000254.s003">Figure S3</xref>). Although, as mentioned above, these values do not affect inference on the subject's model. This entailed optimising <italic>k</italic><sub>sub</sub> and <italic>K</italic><sub>sub</sub> with respect to the evidence, for fixed models<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e069" xlink:type="simple"/><label>(14a)</label></disp-formula>and theory of mind models<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e070" xlink:type="simple"/><label>(14b)</label></disp-formula><xref ref-type="fig" rid="pcbi-1000254-g008">Figure 8A</xref> shows the normalized posterior probabilities over the sixteen models. It can be immediately seen that the theory of mind model has a higher likelihood than the fixed model. Under theory of mind models, we inferred the most likely sophistication level of the subjects was <italic>K</italic><sub>sub</sub> = 5. This is reasonable, because the subjects did not have to use policies higher than <italic>k</italic><sub>sub</sub> = 6, given the computer agent policies never exceeded five. Among the fixed models, even though the likelihood was significantly lower, the optimal model, <italic>k</italic><sub>sub</sub> = 6, was inferred.</p>
<fig id="pcbi-1000254-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000254.g008</object-id><label>Figure 8</label><caption>
<title>Results of the empirical stag-hunt game.</title>
<p>(A) Model comparison. The posterior probabilities over the 16 models; eight fixed models with <italic>k</italic><sub>sub</sub> = 1,…,8 and eight theory of mind (ToM) models with <italic>K</italic><sub>sub</sub> = 1,…,8. The marginalized likelihood of the ToM models is higher than that of the fixed models (the left panel). Within the ToM model-space, the subject level is inferred as <italic>K</italic><sub>sub</sub> = 5. (B) The upper panels shows the inference on the subject's strategy over time in the sessions when the subjects played with the agent A (the left panel) and B (the right panel). The lower panels show the subject's densities on the computer's strategy.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.g008" xlink:type="simple"/></fig>
<p>Using the inferred sophistication of the subjects, <italic>K</italic><sub>sub</sub> = 5, we then examined the implicit conditional density on their opponent's policy using Equation 11. <xref ref-type="fig" rid="pcbi-1000254-g008">Figure 8B</xref> show a typical example from one subject. The upper panels show the actual policies used when playing agent A (the left panel) and agent B (the right panel) and the lower panels show the subject's densities on the opponent's strategies. For both computer agents, the subject has properly inferred the strategy of the agent and plays at a level above it; i.e., the subject behaved rationally. This is a pleasing result, in that we can quantify our confidence that subjects employ theory of mind to optimise their choices and, furthermore, we can be very confident that they do so with a high level of sophistication. In what follows, we relate our game theory of mind to related treatments in behavioural economics and consider the mechanisms that may underpin sophisticated behaviour.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<sec id="s4a">
<title>Models in Behavioural Economics</title>
<p>Games with iterated or repeated play can differ greatly from one-shot games, in the sense that they engender a range of equilibria and can induce the notion of ‘reputation’, when there is uncertainty about opponents <xref ref-type="bibr" rid="pcbi.1000254-Wilson1">[17]</xref>. These games address important issues concerning how people learn to play optimally given recurrent encounters with their opponents. It has been shown that reputation formation can be formulated as a Bayesian updating of types to explain choices in repeated games with simultaneous moves <xref ref-type="bibr" rid="pcbi.1000254-Kreps1">[18]</xref>,<xref ref-type="bibr" rid="pcbi.1000254-Milgrom1">[19]</xref> and non-simultaneous moves <xref ref-type="bibr" rid="pcbi.1000254-Fudenberg1">[20]</xref>. An alternative approach to reputation formation is teaching <xref ref-type="bibr" rid="pcbi.1000254-Fudenberg2">[21]</xref>. In repeated games, sophisticated players often have an incentive to ‘teach’ their opponents by choosing strategies with poor short-run payoffs that will change what the opponents do; in a way that benefits the sophisticated player in the long run. Indeed, Camerer et al <xref ref-type="bibr" rid="pcbi.1000254-Camerer2">[22]</xref> showed that strategic teaching in their EWA model could select one of many repeated-game equilibria and give rise to reputation formation without updating of types. The crucial difference between these approaches is that in the type-based model, reputation is the attribute of a particular <italic>player</italic>, while in the teaching model, a <italic>strategy</italic> attains a reputation. In our approach, types are described in terms of bounds on strategy; the sophistication level. This contrasts with treatments that define types in terms of unobserved payoff functions, which model strategic differences using an attribute of the agent; e.g., normal or honest type.</p>
<p>Recursive or hierarchical approaches to multi-player games have been adopted in behavioural economics <xref ref-type="bibr" rid="pcbi.1000254-Stahl1">[23]</xref>,<xref ref-type="bibr" rid="pcbi.1000254-CostaGomes1">[24]</xref> and artificial intelligence <xref ref-type="bibr" rid="pcbi.1000254-Gmytrasiewicz1">[25]</xref>, in which individual decision policies systematically exploit embedded levels of inference. For instance, some studies have assumed that subject's decisions follow one of a small set of <italic>a priori</italic> plausible types, which include non-strategic and strategic forms. Under these assumptions, inference based on decisions in one-shot (non-iterated) games suggests that while policies may be heterogeneous, the level of sophistication may be equivalent to an approximate value of <italic>k</italic>; two or three. Camerer and colleagues <xref ref-type="bibr" rid="pcbi.1000254-Camerer3">[26]</xref> have suggested a ‘cognitive hierarchy’ model, in which subjects generate a form of cognitive hierarchy over each other's level of reciprocal thinking. In this model ‘<italic>k</italic>’ corresponds to the depth of tree-search, and when estimated over a collection of games such as the <italic>p</italic>-beauty game, yields values of around one and a half to two. Note that ‘steps of strategic thinking’ are not the same as the levels of sophistication in this paper. The sophistication addressed here pertains to the recursive representation of an opponent's goals, and can be applied to any iterated extensive form game. Despite this, studies in behavioural economics suggest lower levels of sophistication than ours. One reason for this may be that most games employed in previous studies have been one-shot games, which place less emphasis on planning for future interactions that rest on accurate models of an opponent's strategy.</p>
<p>In the current treatment, we are not suggesting that players actually compute their optimal strategy explicitly; or indeed are aware of any implicit inference on the opponent's policy. Our model is phenomenological and is designed to allow model comparison and predictions (under any particular model) of brain states that may encode the quantities necessary to optimize behaviour. It may be that the mechanisms of this optimization are at a very low level (e.g., at the level of synaptic plasticity) and have been shaped by evolutionary pressure. In other words, we do not suppose that subjects engage in explicit cognitive operations but are sufficiently tuned to interactions with con-specifics that their choice behaviour is sophisticated. We now pursue this perspective from the point of view of evolutionary optimization of the policies themselves.</p>
</sec><sec id="s4b">
<title>Prosocial Utility</title>
<p>Here, we revisit the emergence of cooperative equilibria and ask whether sophisticated strategies are really necessary. Hitherto, we have assumed that the utility functions ℓ<italic><sub>i</sub></italic> are fixed for any game. This is fine in an experimental setting but in an evolutionary setting, ℓ<italic><sub>i</sub></italic> may be optimised themselves. In this case, there is a fundamental equivalence between different types of agents, in terms of their choices. This is because exactly the same equilibrium behaviour can result from interaction between sophisticated agents with empathy (i.e., theory of mind) and unsophisticated agents with altruistic utility-functions. In what follows, we show why this is the case:</p>
<p>The recursive solutions for high-order value-functions in Equation 6 can be regarded as a Robbins-Monro scheme for optimising the joint value-functions over <italic>N</italic> players. One could regard this as optimising the behaviour of the group of players collectively, as opposed to optimising the behaviour of any single player. Once the joint value-functions have been optimized, such that <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e071" xlink:type="simple"/></inline-formula>, they satisfy the Bellman equations<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e072" xlink:type="simple"/><label>(15)</label></disp-formula>However, these value-functions also satisfy<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e073" xlink:type="simple"/><label>(16)</label></disp-formula>This rearrangement is quite fundamental because we can interpret <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e074" xlink:type="simple"/></inline-formula> as optimal utility-functions, under the assumption that neither player represents the goals of the other. In other words, if two unsophisticated players were endowed with optimal utility-functions, one would observe exactly the same value-functions and behaviour exhibited by two very sophisticated players at equilibrium. These optimal <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e075" xlink:type="simple"/></inline-formula> are trivial to compute, given the optimal value-functions from Equation 6; although this inverse reinforcement learning is not trivial in all situations (e.g., <xref ref-type="bibr" rid="pcbi.1000254-Ng1">[27]</xref>). It is immediately obvious that the optimal utility <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e076" xlink:type="simple"/></inline-formula> from Equation 16 has a much richer structure than the payoff ℓ<italic><sub>i</sub></italic> (<xref ref-type="supplementary-material" rid="pcbi.1000254.s004">Figure S4</xref>). Critically, states that afford payoff to the opponent now become attractive, as if ‘what is good for you is good for me’. This ‘altruism’ <xref ref-type="bibr" rid="pcbi.1000254-Fehr2">[28]</xref> arises because <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e077" xlink:type="simple"/></inline-formula> has become context-sensitive, and depends on the other player's payoff. An interesting example is when the optimised utility of state with a local payoff is greater when the opponent occupies states close to their payoff (see <xref ref-type="supplementary-material" rid="pcbi.1000254.s004">Figure S4</xref>). In other words, a payoff that does not depend on the opponent has less utility, when the opponent's payoff is low (c.f., guilt).</p>
</sec><sec id="s4c">
<title>Altruism and Inequity Aversion</title>
<p>This sort of phenomenon has been associated with ‘inequity aversion’. Inequity aversion is the preference for fairness <xref ref-type="bibr" rid="pcbi.1000254-Nelson1">[29]</xref> or resistance to inequitable outcomes; and has been formulated in terms of context-sensitive utility functions. For example, Fehr and Schmidt <xref ref-type="bibr" rid="pcbi.1000254-Fehr1">[5]</xref> postulate that people make decisions, which minimize inequity and consider <italic>N</italic> individuals who receive payoffs ℓ<italic><sub>i</sub></italic>. They then model the utility to the <italic>j</italic>-th player as<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e078" xlink:type="simple"/><label>(17)</label></disp-formula>where <italic>α</italic> parameterises distaste for disadvantageous inequality and <italic>β</italic> parameterises the distaste for advantageous inequality. Although a compelling heuristic, this utility function is an <italic>ad hoc</italic> nonlinear mixture of payoffs and has been critiqued for its rhetorical nature <xref ref-type="bibr" rid="pcbi.1000254-Avner1">[30]</xref>. An optimal nonlinear mixture is given by substituting Equation 15 into Equation 16 to give<disp-formula><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e079" xlink:type="simple"/><label>(18)</label></disp-formula>These equalities express the optimal utility functions in terms of payoff and a ‘prosocial’ utility (the second terms), which allow unsophisticated agents to optimise their social exchanges. The prosocial utility of any state is simply the difference in value expected after the next move with a sophisticated, relative to an unsophisticated, opponent. Equation 15 might provide a principled and quantitative account of inequity aversion, which holds under rationality assumptions.</p>
<p>One might ask, what is the relevance of an optimised utility function for game theory? The answer lies in the hierarchal co-evolution of agents (e.g., <xref ref-type="bibr" rid="pcbi.1000254-Smith1">[15]</xref>,<xref ref-type="bibr" rid="pcbi.1000254-Traulsen1">[31]</xref>), where the prosocial part of <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e080" xlink:type="simple"/></inline-formula> may be subject to selective pressure. In this context, the unit of selection is not the player but the group of payers involved in a game (e.g., a mother and offspring). In this context, optimising <inline-formula><inline-graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1000254.e081" xlink:type="simple"/></inline-formula> over a group of unsophisticated players can achieve exactly the same result (in terms of equilibrium behaviour) as evolving highly sophisticated agents with theory of mind (c.f., <xref ref-type="bibr" rid="pcbi.1000254-Smith2">[32]</xref>). For example, in ethological terms, it is more likely that the nurturing behaviour of birds is accounted for by selective pressure on ℓ<sup>•</sup> than invoking birds with theory of mind. This speaks to ‘survival of the nicest’ and related notions of prosocial behaviour (e.g., <xref ref-type="bibr" rid="pcbi.1000254-Gintis1">[33]</xref>,<xref ref-type="bibr" rid="pcbi.1000254-Gintis2">[34]</xref>). Selective pressure on prosocial utility simply means, for example, that the innate reward associated with consummatory behaviour is supplemented with rewards associated with nursing behaviour. We have exploited the interaction between innate and acquired value previously in an attempt to model the neurobiology of reinforcement learning <xref ref-type="bibr" rid="pcbi.1000254-Friston1">[35]</xref>.</p>
<p>In summary, exactly the same equilibrium behaviour can emerge from sophisticated players with theory of mind, who act entirely out of self-interest and from unsophisticated players who have prosocial altruism, furnished by hierarchical optimisation of their joint-utility function. It is possible that prosocial utility might produce apparently irrational behaviour, in an experimental setting, if it is ignored: Gintis <xref ref-type="bibr" rid="pcbi.1000254-Gintis1">[33]</xref> reviews the evidence for empirically identifiable forms of prosocial behaviour in humans, (strong reciprocity), that may in part explain human sociality. “A strong reciprocator is predisposed to cooperate with others and punish non co-operators, even when this behaviour cannot be justified in terms of extended kinship or reciprocal altruism”. In line with this perspective, provisional fMRI evidence suggests that altruism may not be a cognitive faculty that engages theory of mind but is hard-wired and inherently pleasurable, activating subgenual cortex and septal regions; structures intimately related to social attachment and bonding in other species <xref ref-type="bibr" rid="pcbi.1000254-Moll1">[36]</xref>. In short, bounds on the sophistication of agents can be circumvented by endowing utility with prosocial components, in the context of hierarchical optimisation.</p>
<p>Critically, the equivalence between prosocial and sophisticated behaviour is only at equilibrium. This means that prosocially altruistic agents will adapt the same strategy throughout an iterated game; however, sophisticated agents will optimise their strategy on the basis of the opponent's behaviour, until equilibrium is attained. These strategic changes make it possible to differentiate between the two sorts of agents empirically, using observed responses. To disambiguate between theory of mind dependent optimisation and prosocial utility it is sufficient to establish that players infer on each other. This is why we included fixed models without such inference in our model comparisons of the preceding sections. In the context of the stag-hunt game examined here, we can be fairly confident that subjects employed inference and theory of mind.</p>
<p>Finally, it should be noted that, although a duality in prosocial and sophisticated equilibria may exist for games with strong cooperative equilibria, there may be other games in which this is less clearly the case; where sophisticated agents and unsophisticated altruistic agents diverge in their behaviour. For example, in some competitive games (such as Cournot duopolys and Stackelberg games), a (selfish) understanding the other players response to payoff (empathy) produces a very different policy than one in which that payoff is inherently (altruistically) valued.</p>
</sec><sec id="s4d">
<title>Conclusion</title>
<p>This paper has introduced a model of ‘theory of mind’ (ToM) based on optimum control and game theory to provide a ‘game theory of mind’. We have considered the representations of goals in terms of value-functions that are prescribed by utility or rewards. We have shown it is possible to deduce whether players make inferences about each other and quantify their sophistication using choices in sequential games. This rests on comparing generative models of choices with and without inference. Model comparison was demonstrated using simulated and real data from a ‘stag-hunt’. Finally, we noted that exactly the same sophisticated equilibrium behaviour can be achieved by optimising the utility-function itself, producing unsophisticated but altruistic agents. This may be relevant ethologically in hierarchal game theory and co-evolution.</p>
<p>In this paper, we focus on the essentials of the model and its inversion using behavioural data, such as subject choices in a stag-hunt. Future work will try to establish the predictive validity of the model by showing a subject's type or sophistication is fairly stable across different games. Furthermore, the same model will be used to generate predictions about neuronal responses, as measured with brain imaging, so that we can characterise the functional anatomy of these implicit processes. In the present model, although players infer the opponent's level of sophistication, they assume the opponents are rational and that their strategies are pure and fixed. However, the opponent's strategy could be inferred under the assumption the opponent was employing ToM to optimise their strategy. It would be possible to relax the assumption that the opponent uses a fixed and pure strategy and test the ensuing model against the current model. However, this relaxation entails a considerable computational expense (which the brain may not be in a position to pay). This is because modeling the opponent's inference induces an infinite recursion; that we resolved by specifying the bounds on rationality. Having said this, to model things like deception, it will be necessary to model hierarchical representations of not just the goals of another (as in this paper) but the optimization schemes used to attain those goals by assuming agent's represent the opponent's optimization of a changing and possibly mixed strategy. This would entail specifying different bounds to finesse the ensuing infinite recursion. Finally, although QRE have become the dominant approach to modelling human behaviour in, e.g., auctions, it remains to be established that convergence is always guaranteed (c.f., the negative results on convergence of fictitious play to Nash equilibria).</p>
<p>Recent interest in the computational basis of ToM has motivated neuroimaging experiments that test the hypothesis that putative subcomponents of mentalizing might correlate with cortical brain activity, particularly in regions implicated in ToM by psychological studies <xref ref-type="bibr" rid="pcbi.1000254-McCabe1">[37]</xref>,<xref ref-type="bibr" rid="pcbi.1000254-Gallagher1">[38]</xref>. In particular, Hampton and colleagues <xref ref-type="bibr" rid="pcbi.1000254-Hampton1">[39]</xref> report compelling data that suggest decision values and update signals are indeed in represented in putative ToM regions. These parameters were derived from a model based on ‘fictitious play’, which is a simple, non-hierarchical learning model of two-player inference. This model provided a better account of choice behaviour, relative to error-based reinforcement learning alone; providing support for the notion that apparent ToM behaviour arises from more than prosocial preferences alone. Clearly, neuroimaging offers a useful method for future exploration of whether key subcomponents of formal ToM models predict brain activity in ToM regions and may allow one to adjudicate between competing accounts.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000254.s001" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.s001" xlink:type="simple"><label>Figure S1</label><caption>
<p>A. Log [Euclidean] distance between the value-functions in <xref ref-type="fig" rid="pcbi-1000254-g002">Figure 2B</xref>. B. Inference of opponent's types using the same simulated data used in <xref ref-type="fig" rid="pcbi-1000254-g005">Figure 5</xref>. Two players with asymmetric types <italic>K</italic><sub>1</sub> = 4 and <italic>K</italic><sub>2</sub> = 3. The left graph shows the likelihood over fixed models using <italic>k</italic><sub>1</sub>,<italic>k</italic><sub>2</sub> = 1,…,6 and the right graph shows the likelihood of theory of mind models with <italic>K</italic><sub>1</sub>,<italic>K</italic><sub>2</sub> = 0,…,5. The veridical model (dark blue bar) showed the maximum likelihood among 72 models.</p>
<p>(0.63 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000254.s002" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.s002" xlink:type="simple"><label>Figure S2</label><caption>
<p>Maximum likelihood estimation over the subject's type and payoff sensitivity. We used the models using <italic>K</italic><sub>sub</sub> = 0,…,5 and λ = 0.5,…,3.0 and data pooled from all subjects.</p>
<p>(0.72 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000254.s003" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.s003" xlink:type="simple"><label>Figure S3</label><caption>
<p>Inference of computer agent's policy: canonical inference using all subjects' data (A) and mean and standard deviation over six subjects (B). The order of agent A's policy is inferred as <italic>k</italic><sub>com</sub> = 1 and the agent B's order is inferred as <italic>k</italic><sub>com</sub> = 5.</p>
<p>(0.75 MB TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1000254.s004" mimetype="image/tiff" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000254.s004" xlink:type="simple"><label>Figure S4</label><caption>
<p>The left panels show payoff functions for sophisticated agents who have theory of mind. The right panels show optimal utility functions for unsophisticated agents who do not represent opponent's goal: they assume opponent's policy is naïve.</p>
<p>(4.17 MB TIF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We are also grateful to Peter Dayan, Debajyori Ray, Jean Daunizeau, and Ben Seymour for useful discussions and suggestions and to Peter Dayan for critical comments on the manuscript. We also acknowledge the substantial guidance and suggestions of our three reviewers.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000254-Frith1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Frith</surname><given-names>U</given-names></name>
<name name-style="western"><surname>Frith</surname><given-names>CD</given-names></name>
</person-group>             <year>2003</year>             <article-title>Development and neurophysiology of mentalizing.</article-title>             <source>Philos Trans R Soc Lond Ser B Biol Sci</source>             <volume>358</volume>             <fpage>459</fpage>             <lpage>473</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Premack1"><label>2</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Premack</surname><given-names>DG</given-names></name>
<name name-style="western"><surname>Woodruff</surname><given-names>G</given-names></name>
</person-group>             <year>1978</year>             <article-title>Does the chimpanzee have a theory of mind?</article-title>             <source>Behavioral Brain Sci</source>             <volume>1</volume>             <fpage>515</fpage>             <lpage>526</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Simon1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Simon</surname><given-names>HA</given-names></name>
</person-group>             <year>1990</year>             <article-title>A mechanism for social selection and successful altruism.</article-title>             <source>Science</source>             <volume>250</volume>             <fpage>1665</fpage>             <lpage>1668</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Kahneman1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kahneman</surname><given-names>D</given-names></name>
</person-group>             <year>2003</year>             <article-title>Maps of bounded rationality: psychology for behavioral economics.</article-title>             <source>Am Econ Rev</source>             <volume>93</volume>             <fpage>1449</fpage>             <lpage>1475</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Fehr1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fehr</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Schmidt</surname><given-names>KM</given-names></name>
</person-group>             <year>1999</year>             <article-title>A theory of fairness, competition, and cooperation.</article-title>             <source>Q J Econ</source>             <volume>114</volume>             <fpage>817</fpage>             <lpage>868</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Bellman1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bellman</surname><given-names>R</given-names></name>
</person-group>             <year>1952</year>             <article-title>On the theory of dynamic programming.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>38</volume>             <fpage>716</fpage>             <lpage>719</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Todorov1"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Todorov</surname><given-names>E</given-names></name>
</person-group>             <year>2006</year>             <article-title>Linearly-solvable Markov decision problems.</article-title>             <source>Adv Neural Inf Process <italic>Syst</italic></source>             <volume>19</volume>             <fpage>1369</fpage>             <lpage>1376</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Camerer1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Camerer</surname><given-names>CF</given-names></name>
</person-group>             <year>2003</year>             <article-title>Behavioural studies of strategic thinking in games.</article-title>             <source>Trends Cogn Sci</source>             <volume>7</volume>             <fpage>225</fpage>             <lpage>231</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-McKelvey1"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>McKelvey</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Palfrey</surname><given-names>T</given-names></name>
</person-group>             <year>1995</year>             <article-title>Quantal response equilibria for normal form games.</article-title>             <source>Games Econ Behav</source>             <volume>10</volume>             <fpage>6</fpage>             <lpage>38</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Haile1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Haile</surname><given-names>PA</given-names></name>
<name name-style="western"><surname>Hortacsu</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Kosenok</surname><given-names>G</given-names></name>
</person-group>             <year>2008</year>             <article-title>On the empirical content of quantal response equilibrium.</article-title>             <source>Am Econ Rev</source>             <volume>98</volume>             <fpage>180</fpage>             <lpage>200</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Benveniste1"><label>11</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Benveniste</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Metivier</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Prourier</surname><given-names>P</given-names></name>
</person-group>             <year>1990</year>             <source>Adaptive Algorithms and Stochastic Approximations</source>             <publisher-loc>Berlin</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000254-Sutton1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sutton</surname><given-names>RS</given-names></name>
<name name-style="western"><surname>Barto</surname><given-names>AG</given-names></name>
</person-group>             <year>1981</year>             <article-title>Toward a modern theory of adaptive networks: expectation and prediction.</article-title>             <source>Psychol Rev</source>             <volume>88</volume>             <fpage>135</fpage>             <lpage>170</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Watkins1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Watkins</surname><given-names>CJCH</given-names></name>
<name name-style="western"><surname>Dayan</surname><given-names>P</given-names></name>
</person-group>             <year>1992</year>             <article-title>Q-Learning.</article-title>             <source>Mach Learn</source>             <volume>8</volume>             <fpage>279</fpage>             <lpage>292</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Skyrms1"><label>14</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Skyrms</surname><given-names>B</given-names></name>
</person-group>             <year>2003</year>             <source>The Stag Hunt and the Evolution and Social Structure</source>             <publisher-loc>Cambridge, UK</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000254-Smith1"><label>15</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>JM</given-names></name>
</person-group>             <year>1982</year>             <source><italic>Evolution and the Theory of Games</italic></source>             <publisher-loc>Cambridge</publisher-loc>             <publisher-name>Cambridge University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000254-Davies1"><label>16</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Davies</surname><given-names>P</given-names></name>
</person-group>             <year>1992</year>             <source>Mind of God: The Scientific Basis for a Rational World</source>             <publisher-loc>New York</publisher-loc>             <publisher-name>Simon &amp; Schuster</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000254-Wilson1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wilson</surname><given-names>D</given-names></name>
</person-group>             <year>1985</year>             <article-title>An integrated modle of buyer-seller relationship.</article-title>             <source>J Acad Mark Sci</source>             <volume>23</volume>             <fpage>335</fpage>             <lpage>345</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Kreps1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Kreps</surname><given-names>DM</given-names></name>
<name name-style="western"><surname>Wilson</surname><given-names>R</given-names></name>
</person-group>             <year>1982</year>             <article-title>Reputation and imperfect information.</article-title>             <source>J Econ Theory</source>             <volume>27</volume>             <fpage>253</fpage>             <lpage>279</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Milgrom1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Milgrom</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Roberts</surname><given-names>J</given-names></name>
</person-group>             <year>1982</year>             <article-title>Predation, Reputation, and Entry Deterrence.</article-title>             <source>J Econ Theory</source>             <volume>27</volume>             <fpage>280</fpage>             <lpage>312</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Fudenberg1"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fudenberg</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Levine</surname><given-names>DK</given-names></name>
</person-group>             <year>1989</year>             <article-title>Reputation and equilibrium selection in games with a patient player.</article-title>             <source>Econometrica</source>             <volume>57</volume>             <fpage>759</fpage>             <lpage>778</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Fudenberg2"><label>21</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fudenberg</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Levine</surname><given-names>D</given-names></name>
</person-group>             <year>1998</year>             <source>The Theory of Learning in Games</source>             <publisher-loc>Cambridge, MA</publisher-loc>             <publisher-name>MIT Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000254-Camerer2"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Camerer</surname><given-names>CF</given-names></name>
<name name-style="western"><surname>Ho</surname><given-names>TH</given-names></name>
<name name-style="western"><surname>Chong</surname><given-names>JK</given-names></name>
</person-group>             <year>2002</year>             <article-title>Sophisticated experience-weighted attraction learning and strategic teaching in repeated games.</article-title>             <source>J Econ Theory</source>             <volume>104</volume>             <fpage>137</fpage>             <lpage>188</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Stahl1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stahl</surname><given-names>DO</given-names></name>
<name name-style="western"><surname>Wilson</surname><given-names>PW</given-names></name>
</person-group>             <year>1995</year>             <article-title>On players models of other players - Theory and experimental-evidence.</article-title>             <source>Games Econ Behav</source>             <volume>10</volume>             <fpage>218</fpage>             <lpage>254</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-CostaGomes1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Costa-Gomes</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Crawford</surname><given-names>VP</given-names></name>
<name name-style="western"><surname>Broseta</surname><given-names>B</given-names></name>
</person-group>             <year>2001</year>             <article-title>Cognition and behavior in normal-form games: an experimental study.</article-title>             <source>Econometrica</source>             <volume>69</volume>             <fpage>1193</fpage>             <lpage>1235</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Gmytrasiewicz1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gmytrasiewicz</surname><given-names>PJ</given-names></name>
<name name-style="western"><surname>Doshi</surname><given-names>P</given-names></name>
</person-group>             <year>2005</year>             <article-title>A framework for sequential planning in multi-agent settings.</article-title>             <source>J Artif Intell Res</source>             <volume>24</volume>             <fpage>49</fpage>             <lpage>79</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Camerer3"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Camerer</surname><given-names>CF</given-names></name>
<name name-style="western"><surname>Ho</surname><given-names>TH</given-names></name>
<name name-style="western"><surname>Chong</surname><given-names>JK</given-names></name>
</person-group>             <year>2004</year>             <article-title>A cognitive hierarchy model of games.</article-title>             <source>Q J Econ</source>             <volume>119</volume>             <fpage>861</fpage>             <lpage>898</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Ng1"><label>27</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ng</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Russell</surname><given-names>S</given-names></name>
</person-group>             <year>2000</year>             <article-title>Algorithms for inverse reinforcement learning.</article-title>             <source>Proceeding of the 17th International Conference on Machine Learning</source>             <publisher-loc>San Francisco, CA</publisher-loc>             <publisher-name>Morgan Kaufmann Publishers</publisher-name>             <fpage>663</fpage>             <lpage>670</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Fehr2"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Fehr</surname><given-names>E</given-names></name>
<name name-style="western"><surname>Fischbacher</surname><given-names>U</given-names></name>
</person-group>             <year>2003</year>             <article-title>The nature of human altruism.</article-title>             <source>Nature</source>             <volume>425</volume>             <fpage>785</fpage>             <lpage>791</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Nelson1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Nelson</surname><given-names>W</given-names></name>
</person-group>             <year>2001</year>             <article-title>Incorporating fairness into game theory and economics: Comment.</article-title>             <source>The Am Economic Rev</source>             <volume>91</volume>             <fpage>1180</fpage>             <lpage>1183</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Avner1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Avner</surname><given-names>S</given-names></name>
</person-group>             <year>2005</year>             <article-title>The rhetoric of inequity aversion.</article-title>             <source>NAJ Econ</source>             <volume>8</volume>             <comment><ext-link ext-link-type="uri" xlink:href="http://www.najecon.org/naj/cache/666156000000000612.pdf" xlink:type="simple">http://www.najecon.org/naj/cache/666156000000000612.pdf</ext-link></comment>          </element-citation></ref>
<ref id="pcbi.1000254-Traulsen1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Traulsen</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Claussen</surname><given-names>JC</given-names></name>
<name name-style="western"><surname>Hauert</surname><given-names>C</given-names></name>
</person-group>             <year>2006</year>             <article-title>Coevolutionary dynamics in large, but finite populations.</article-title>             <source>Phys Rev E</source>             <volume>74</volume>             <fpage>011901</fpage>          </element-citation></ref>
<ref id="pcbi.1000254-Smith2"><label>32</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Smith</surname><given-names>JM</given-names></name>
</person-group>             <year>1974</year>             <article-title>The theory of games and the evolution of animal conflicts.</article-title>             <source>J Theor Biol</source>             <volume>47</volume>             <fpage>209</fpage>             <lpage>221</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Gintis1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gintis</surname><given-names>H</given-names></name>
</person-group>             <year>2000</year>             <article-title>Strong reciprocity and human sociality.</article-title>             <source>J Theor Biol</source>             <volume>206</volume>             <fpage>169</fpage>             <lpage>179</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Gintis2"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gintis</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Bowles</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Boyd</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Fehr</surname><given-names>E</given-names></name>
</person-group>             <year>2003</year>             <article-title>Explaining altruistic behavior in humans.</article-title>             <source>Evol Hum Behav</source>             <volume>24</volume>             <fpage>153</fpage>             <lpage>172</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Friston1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Friston</surname><given-names>KJ</given-names></name>
<name name-style="western"><surname>Tononi</surname><given-names>G</given-names></name>
<name name-style="western"><surname>Reeke</surname><given-names>GN</given-names></name>
<name name-style="western"><surname>Sporns</surname><given-names>O</given-names></name>
<name name-style="western"><surname>Edelman</surname><given-names>GM</given-names></name>
</person-group>             <year>1994</year>             <article-title>Value-dependent selection in the brain: simulation in a synthetic neural model.</article-title>             <source>Neuroscience</source>             <volume>59</volume>             <fpage>229</fpage>             <lpage>243</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Moll1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Moll</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Krueger</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Zahn</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Pardini</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Oliveira-Souzat</surname><given-names>R</given-names></name>
<name name-style="western"><surname>Grafman</surname><given-names>J</given-names></name>
</person-group>             <year>2006</year>             <article-title>Human fronto-mesolimbic networks guide decisions about charitable donation.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>103</volume>             <fpage>15623</fpage>             <lpage>15628</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-McCabe1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>McCabe</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Houser</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Ryan</surname><given-names>L</given-names></name>
<name name-style="western"><surname>Smith</surname><given-names>V</given-names></name>
<name name-style="western"><surname>Trouard</surname><given-names>T</given-names></name>
</person-group>             <year>2001</year>             <article-title>A functional imaging study of cooperation in two-person reciprocal exchange.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>98</volume>             <fpage>11832</fpage>             <lpage>11835</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Gallagher1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Gallagher</surname><given-names>HL</given-names></name>
<name name-style="western"><surname>Jack</surname><given-names>AI</given-names></name>
<name name-style="western"><surname>Roepstorff</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Frith</surname><given-names>CD</given-names></name>
</person-group>             <year>2002</year>             <article-title>Imaging the intentional stance in a competitive game.</article-title>             <source>Neuroimage</source>             <volume>16</volume>             <fpage>814</fpage>             <lpage>821</lpage>          </element-citation></ref>
<ref id="pcbi.1000254-Hampton1"><label>39</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Hampton</surname><given-names>AN</given-names></name>
<name name-style="western"><surname>Bossaerts</surname><given-names>P</given-names></name>
<name name-style="western"><surname>O'Doherty</surname><given-names>JP</given-names></name>
</person-group>             <year>2008</year>             <article-title>Neural correlates of mentalizing-related computations during strategic interactions in humans.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>105</volume>             <fpage>6741</fpage>             <lpage>6746</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>