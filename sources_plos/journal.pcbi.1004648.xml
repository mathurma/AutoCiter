<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004648</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-15-00990</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Simple Plans or Sophisticated Habits? State, Transition and Learning Interactions in the Two-Step Task</article-title>
<alt-title alt-title-type="running-head">Sophisticated Habits in the Two-Step Task</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Akam</surname>
<given-names>Thomas</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Costa</surname>
<given-names>Rui</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Dayan</surname>
<given-names>Peter</given-names>
</name>
<xref rid="aff003" ref-type="aff"><sup>3</sup></xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Champalimaud Neuroscience Program, Champalimaud Centre for the Unknown, Lisbon, Portugal</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Experimental Psychology, University of Oxford, Oxford, United Kingdom</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>Gatsby Computational Neuroscience Unit, UCL, London, United Kingdom</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Daunizeau</surname>
<given-names>Jean</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Brain and Spine Institute (ICM), FRANCE</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Analyzed the data: TA. Wrote the paper: TA RC PD. Concieved and designed the simulations: TA RC PD. Performed the simulations: TA.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">thomas.akam@neuro.fchampalimaud.org</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>11</day>
<month>12</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>12</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>12</issue>
<elocation-id>e1004648</elocation-id>
<history>
<date date-type="received">
<day>18</day>
<month>6</month>
<year>2015</year>
</date>
<date date-type="accepted">
<day>9</day>
<month>11</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Akam et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004648" xlink:type="simple"/>
<abstract>
<p>The recently developed ‘two-step’ behavioural task promises to differentiate model-based from model-free reinforcement learning, while generating neurophysiologically-friendly decision datasets with parametric variation of decision variables. These desirable features have prompted its widespread adoption. Here, we analyse the interactions between a range of different strategies and the structure of transitions and outcomes in order to examine constraints on what can be learned from behavioural performance. The task involves a trade-off between the need for stochasticity, to allow strategies to be discriminated, and a need for determinism, so that it is worth subjects’ investment of effort to exploit the contingencies optimally. We show through simulation that under certain conditions model-free strategies can masquerade as being model-based. We first show that seemingly innocuous modifications to the task structure can induce correlations between action values at the start of the trial and the subsequent trial events in such a way that analysis based on comparing successive trials can lead to erroneous conclusions. We confirm the power of a suggested correction to the analysis that can alleviate this problem. We then consider model-free reinforcement learning strategies that exploit correlations between where rewards are obtained and which actions have high expected value. These generate behaviour that appears model-based under these, and also more sophisticated, analyses. Exploiting the full potential of the two-step task as a tool for behavioural neuroscience requires an understanding of these issues.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Planning is the use of a predictive model of the consequences of actions to guide decision making. Planning plays a critical role in human behaviour, but isolating its contribution is challenging because it is complemented by control systems which learn values of actions directly from the history of reinforcement, resulting in automatized mappings from states to actions often termed habits. Our study examined a recently developed behavioural task which uses choices in a multi-step decision tree to differentiate planning from value-based control. We compared various strategies using simulations, showing a range that produce behaviour that resembles planning but in fact arises as a fixed mapping from particular sorts of states to action. These results show that when a planning problem is faced repeatedly, sophisticated automatization strategies may be developed which identify that there are in fact a limited number of relevant states of the world each with an appropriate fixed or habitual response. Understanding such strategies is important for the design and interpretation of tasks which aim to isolate the contribution of planning to behaviour. Such strategies are also of independent scientific interest as they may contribute to automatization of behaviour in complex environments.</p>
</abstract>
<funding-group>
<funding-statement>TA was funded by the Wellcome Trust (<ext-link ext-link-type="uri" xlink:href="http://www.wellcome.ac.uk" xlink:type="simple">http://www.wellcome.ac.uk</ext-link>), grant number WT096193AIA. RC was funded by the European Research Council (<ext-link ext-link-type="uri" xlink:href="http://erc.europa.eu/" xlink:type="simple">http://erc.europa.eu/</ext-link>), grant number ERC COG 617142 and the Howard Hughes Medical Institute (<ext-link ext-link-type="uri" xlink:href="https://www.hhmi.org" xlink:type="simple">https://www.hhmi.org</ext-link>), grant number HHMI IEC 55007415. PD was funded by the Gatsby Charitable Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.gatsby.org.uk" xlink:type="simple">www.gatsby.org.uk</ext-link>). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="5"/>
<table-count count="1"/>
<page-count count="25"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>Full code used to produce the paper figures is included in supplementary material.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Humans and other animals are thought to use a mixture of different strategies to learn to choose actions that lead to positive outcomes and prevent negative outcomes [<xref rid="pcbi.1004648.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1004648.ref002" ref-type="bibr">2</xref>]. Much interest is currently focused on the distinction between control systems which employ model-based and (value-based) model-free reinforcement learning (RL) [<xref rid="pcbi.1004648.ref003" ref-type="bibr">3</xref>–<xref rid="pcbi.1004648.ref014" ref-type="bibr">14</xref>]. Model-based RL works by learning a predictive model of the specific consequences of actions, and planning by using this model to evaluate the different options prospectively. By contrast, model-free RL directly learns the value of actions through prediction errors, which quantify the difference in worth between actual and expected outcomes. These different strategies offer distinct advantages and disadvantages. Model-based RL is computationally costly and time consuming, because of the demands of planning many steps into the future before action. However, it can, in principle, use information efficiently, particularly in the face of a changing environment. This is because the implications that a change has for control in other parts of the environment can be evaluated immediately using the model without having to be directly experienced. Model-free RL incurs little computational cost and supports rapid action selection. However, it is statistically inefficient as it discards information about the specific outcomes of actions, and learns by propagating initially incorrect predictions from states to their sequential predecessors.</p>
<p>Dissociating the contributions of model-based and model-free RL to behaviour is challenging because under many circumstances, including most laboratory based reward guided decision making tasks, they are expected to produce similar behaviour. Outcome devaluation (or, more generally, revaluation) has traditionally been used as a gold-standard test to demonstrate the use of a simple forward model predicting the specific outcomes of actions [<xref rid="pcbi.1004648.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1004648.ref015" ref-type="bibr">15</xref>,<xref rid="pcbi.1004648.ref016" ref-type="bibr">16</xref>]. In an outcome devaluation experiment, the subject is trained to perform two different actions, each of which obtains a different reward, e.g. pressing left or right levers for pellets of two different flavours. One reward is then devalued, for example by pairing it with illness in another context. The impact of this devaluation on the subjects’ propensity to press the levers is then tested in extinction, i.e., without any longer providing the outcomes. Model-based lever-pressing depends on a representation of the outcome to which the pressing leads, implying that subjects would prefer the lever associated with the non-devalued outcome. However, model-free lever-pressing is based on past experience of its utility, implying that subjects would not differentiate between the two levers. Use of two levers controls for general motivational effects of devaluation and extinction. In psychological terms, model-based behaviour is considered goal-directed, and model-free, habitual [<xref rid="pcbi.1004648.ref001" ref-type="bibr">1</xref>,<xref rid="pcbi.1004648.ref017" ref-type="bibr">17</xref>].</p>
<p>Research using outcome devaluation paradigms has established that learnt actions are initially specified by model-based RL, but can transition to being devaluation insensitive given extensive training under appropriate conditions [<xref rid="pcbi.1004648.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1004648.ref018" ref-type="bibr">18</xref>]. This has been interpreted as a shift to model-free RL [<xref rid="pcbi.1004648.ref004" ref-type="bibr">4</xref>]. Distinct sets of brain regions have been identified as necessary for devaluation sensitive and devaluation insensitive behaviour [<xref rid="pcbi.1004648.ref019" ref-type="bibr">19</xref>–<xref rid="pcbi.1004648.ref030" ref-type="bibr">30</xref>], a finding that has been taken as implying that model-based and model-free RL are implemented by partially separate neural circuits.</p>
<p>Recent approaches to behavioural neuroscience derive substantial explanatory value from parametric variation of decision variables in the context of large decision datasets. It is therefore desirable to develop tasks which achieve these ends, but also exhibit the critical feature of outcome devaluation–namely the wherewithal to discriminate model-based and model-free RL. The two-step task [<xref rid="pcbi.1004648.ref007" ref-type="bibr">7</xref>] represents one recently popular approach to creating such a task, attracting a substantial number of human studies [<xref rid="pcbi.1004648.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1004648.ref011" ref-type="bibr">11</xref>,<xref rid="pcbi.1004648.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1004648.ref031" ref-type="bibr">31</xref>–<xref rid="pcbi.1004648.ref043" ref-type="bibr">43</xref>]. The task is so named because each trial consists of two distinct steps (see task diagram, <xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1A</xref>). At the first step the subject chooses between two actions, termed action A and action B. After making this choice the subject reaches one of two second-step states termed state <italic>a</italic> and state <italic>b</italic>. Action A normally leads to state <italic>a</italic>, and action B normally leads to state <italic>b</italic>; however, on a randomly selected 30% of trials, a rare transition occurs, such that action A leads to state <italic>b</italic> and action B to state <italic>a</italic>. In each second-step state two further actions are available. The subject chooses one of these actions and either receives or not a reward before starting the next trial. The reward probabilities for each of the four second-step actions (two in each second-step state), vary over time as reflecting Gaussian random walks on the range 0.25–0.75 (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1C</xref>).</p>
<fig id="pcbi.1004648.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004648.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Original and reduced versions of the two-step task.</title>
<p>(<bold>A, B</bold>) Diagram of task structure for original (<bold>A</bold>) and reduced (<bold>B</bold>) two step tasks. (<bold>C</bold>, <bold>D</bold>) Example reward probability trajectories for the second-step actions in each task. (<bold>E—H</bold>) Stay probability plots for <italic>Q</italic>(1) (<bold>E</bold>,<bold>G</bold>) and model-based (<bold>F, H</bold>) agents on the two task versions. Plots show the fraction of trials on which the agent repeated its choice following rewarded and non-rewarded trials with common and rare transitions (SEM error bars shown in red). (<bold>I, J</bold>) Performance (fraction of trials rewarded) achieved by <italic>Q</italic>(1) and model based agents, and by an agent which chooses randomly at the first step. Agent parameters in (<bold>I</bold>,<bold>J</bold>) have been optimised to maximise the fraction of rewarded trials.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.g001" position="float" xlink:type="simple"/>
</fig>
<p>Rewards obtained (or not) at the second step modify the subjects estimates of the values of the second-step states, which are themselves the outcomes of the first step actions. On trials with rare transitions, the second-step state whose value is changed by obtaining or not a reward is normally reached from the first-step action that was not chosen. This suggests that a model-based agent which understands the true mapping between first-step actions and second-step states will behave differently from a model-free agent which does not use this knowledge. Model-based and model-free control can indeed be dissociated by evaluating how the events on one trial, specifically the transition (common or rare) and outcome (rewarded or not), affect the probability of repeating the same choice at the first step on subsequent trials.</p>
<p>Three sorts of analysis of these effects are in common use. The simplest is to look directly at the probability of repeating the first-step choice on just the next trial–this is called the ‘stay’ probability. A model-free strategy in which the value of the chosen first step action is updated directly by the trial outcome produces a pattern in which the subject tends to stay following rewarded and switch following non-rewarded trials, with no effect of transition (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1E</xref>). By contrast a model-based strategy in which the subject understands the transition structure linking the first step actions to second-step states produces a pattern of stay probabilities which show a transition x outcome interaction, i.e. rewards increase stay probability following common transitions and decrease stay probability following rare transitions (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1F</xref>). A second, more sophisticated version of this analysis is to perform multiple logistic regression of the probability of choice on one trial based on facets of choice and outcomes on one or more previous trials. RL algorithms imply that events can have an impact multiple trials into the future; this analysis can test this. We will also see that using extra regressors can alleviate potential confounds in the differentiation of MB and MF strategies. Finally, a third analysis is to fit RL models to behaviour using likelihood-based methods, and to compare directly their quality of fit.</p>
<p>There is strong evidence that human subjects who have been explicitly told in advance about the transition structure and drifting reward probabilities, gamely pursue model based strategies, potentially integrating them with MF influences [<xref rid="pcbi.1004648.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1004648.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1004648.ref034" ref-type="bibr">34</xref>]. Given the unique set of attractive features offered by the two-step task, versions suitable for animal subjects would be desirable, and several groups are currently pursuing work in this direction (Miller at al. Soc. Neurosci. Abstracts 2013, 855.13, Groman et al. Soc. Neurosci. Abstracts 2014, 558.19, Miranda et al. Soc. Neurosci. Abstracts 2014 756.09, Akam et al. Cosyne Abstracts 2015, II-15). However, an informal observation, that we formalize below, is that the stochasticity of the conventional version of the task means that even optimised model-based strategies perform little better than chance level and do not outperform simple model-free strategies. Animal subjects are less tolerant when complex strategies have only limited advantages, and often switch to strategies such as always choosing the same option, or alternation, which obtain rewards at chance level with minimal cognitive effort. It will therefore likely prove necessary to increase the contrast between good and bad options in order to use the task with animal subjects, and our understanding is this is being done in the current crop of animal studies.</p>
<p>Here we consider a stripped down version of the task which substantially improves the payoff for model-based strategies relative to chance level and model-free control. We show that seemingly innocuous changes to the task induce correlations between events which can allow model-free RL to masquerade as model-based. We first show that correlation between action values at the start of trials and the subsequent trial events can cause the stay probability analysis, when applied to the behaviour of purely model-free agents, to exhibit the transition-outcome interaction classically interpreted as indicative of model-based RL. We further show that a previously proposed modification to the analysis [<xref rid="pcbi.1004648.ref034" ref-type="bibr">34</xref>] accurately corrects for these correlations.</p>
<p>A second, and more pernicious, issue arises from the correlation between where rewards are obtained (second-step state <italic>a</italic> or <italic>b</italic>), and the expected value of choosing action A or B at the first step. We explore the behaviour of two agents which exploit this correlation. The first uses the trial outcome and location on the previous trial as a discriminative stimulus for the state of the world, using model-free RL to learn separate values for actions A and B following each combination of outcome (rewarded or not) and second-step state (<italic>a</italic> or <italic>b</italic>) reached on the previous trial. The agent develops a fixed mapping from one trial’s events to the next trial’s choice (e.g. reward in state <italic>a</italic> ➔ choose action A), that generates behaviour that would be assessed as being model-based by either classical or improved stay probability analysis. The representation underlying the second agent makes explicit the latent or hidden state of the world–i.e. which second-step state has higher reward probability. The agent infers this hidden state by observing where it obtains rewards, and uses a fixed mapping from its estimate of the latent state to action. This agent produces behaviour which is qualitatively very similar to that of a model-based agent. Both agents outperform classical model-free strategies in terms of the fraction of rewarded trials; this provides an incentive for the acquisition of these alternative representations via the ample statistical evidence available particularly to over-trained animal subjects of the correlations that underpin them. These strategies can also in principle generate seemingly model-based behaviour on the original version of the task used in the human literature, and may play a role in the automatization of apparently model-based control recently reported to occur with extended training on the original task [<xref rid="pcbi.1004648.ref042" ref-type="bibr">42</xref>].</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>The original two-step task and a simplified version with enhanced contrast between good and bad options, termed the reduced two step task, are shown in <xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1</xref>. There are three differences between the original and reduced task; firstly the probability of a common transition is increased from 0.7 to 0.8, secondly there is no choice at the second step but rather a single action available in each state, thirdly the reward probabilities in the two second-step states alternate between blocks with reward probabilities of 0.8/0.2 and blocks with reward probabilities of 0.2/0.8 in states <italic>a</italic>/<italic>b</italic> (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1D</xref>).</p>
<p>We initially simulated the behaviour of a model-free and a model-based agent on both versions of the task. The model-free agent (strictly speaking a <italic>Q</italic>(1) agent, termed a Direct Reinforcement agent in [<xref rid="pcbi.1004648.ref007" ref-type="bibr">7</xref>]) updated the value of the chosen action (A or B) based on the prediction error between the trial outcome and its current estimate of the action value, using a fixed learning rate. This agent therefore only used information about whether or not the trial was rewarded, and did not use information either about whether a common or rare transition occurred or about the second-step state from which the outcome was received. By contrast, the model-based agent calculated the value of each action A or B as the weighted sum of the values of states <italic>a</italic> and <italic>b</italic>, where the weights were determined by the (known) conditional probabilities of reaching those states after choosing that action. In the original task, the value of the second-step states used by the model based agent was the higher of the two action values available in each state. In the reduced task the state value was the value of the single action available in that state. Both agents updated the value of the chosen second-step action based on the prediction error between the current estimate of its value and the trial outcome.</p>
<p>As reported previously for the original two-step task [<xref rid="pcbi.1004648.ref007" ref-type="bibr">7</xref>], the behaviour of <italic>Q</italic>(1) and model-based agents could be differentiated by looking at how the transition (common or rare) and outcome (rewarded or not) influenced the stay probability, which is the frequency with which the agent repeated the same action on the subsequent trial (Fig <xref rid="pcbi.1004648.g001" ref-type="fig">1E and 1F</xref>). As the action value update used by the <italic>Q</italic>(1) agent is only sensitive to the outcome and not the transition, the stay probability was higher for rewarded than non-rewarded trials, but was not influenced by whether a common or rare transition occurred (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1E</xref>). For the model-based agent (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1F</xref>), a reward following a rare transition increases the value of the state that is more commonly reached from the action that was <italic>not</italic> chosen on that trial. This increases the probability that the agent switches its choice on the subsequent trial. Stay probabilities for the model-based agent therefore showed an interaction between outcome and transition, such that rewards increased stay probability (i.e., were reinforcing) after common transitions, but reduced stay probability after rare transitions.</p>
<p>We evaluated the performance, i.e. the fraction of rewarded trials, achieved by the model-based and <italic>Q</italic>(1) agents on the original version of the task when their parameter values were optimised (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1I</xref>). The <italic>Q</italic>(1) agent obtained rewards on a fraction 0.558 ± 0.006 of trials while the model-based agent obtained reward on 0.557 ± 0.005 of trials (mean ± SEM). The difference in performance between the agents was not significant (P = 0.91) and the performance of neither agent was significantly different from that of an agent which chose randomly at the first step and used model-free RL at the second step (P &gt; 0.52). Both agents (modestly) outperformed a purely stochastic agent that chooses randomly at both steps, and so receives reward on 0.5 of trials. These results show that the stochasticity of the original task imposes a low ceiling on achievable performance, preventing model-based control from outperforming simple model-free strategies. By contrast, on the reduced version of the task the <italic>Q</italic>(1) agent with optimised parameters obtained rewards on 0.594 ± 0.002 of trials while the model based agent obtained rewards on 0.649 ± 0.003 if trials (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1J</xref>). This performance difference was significant (P &lt; 10<sup>−6</sup>), confirming that the modifications made in the reduced task increased the contrast between good and bad options and differentiated the performance achieved by different strategies.</p>
<sec id="sec003">
<title>Action values at trial start affect stay probabilities</title>
<p>Behaviour simulated from the <italic>Q</italic>(1) agent on the reduced version of the task showed a strikingly different pattern of stay probabilities from that seen in the original task (<xref rid="pcbi.1004648.g002" ref-type="fig">Fig 2G</xref>, repeated for convenient comparison in <xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3A</xref>). Stay probabilities showed a clear interaction between transition and outcome. A logistic regression analysis predicting stay probability as a function of outcome, transition, and transition-outcome interaction confirmed that transition-outcome interaction predicted stay probability (P &lt; 10<sup>−10</sup>, t-test for non-zero predictor loading) (<xref rid="pcbi.1004648.g002" ref-type="fig">Fig 2A</xref>), and this predictive relationship held true over a wide range of agent parameter values (<xref rid="pcbi.1004648.s001" ref-type="supplementary-material">S1A Fig</xref>). This result is counter-intuitive because by construction, the action values and hence choice probabilities of the <italic>Q</italic>(1) agent are unaffected by whether a common or rare transition occurred. The difference in stay probability between trials with the same outcome but different transitions therefore cannot be accounted for by a difference in the action value update that occurred on that trial, as the update is identical irrespective of the transition. Instead, the reason why the action values of the chosen and non-chosen option are (on average) different following trials with the same outcome but different transitions must be that the action values at the start of the trial are (on average) different. This can indeed be seen (<xref rid="pcbi.1004648.g002" ref-type="fig">Fig 2B</xref>); the mean difference between the action values for the chosen and not chosen option at the start of the trial was larger for common-rewarded and rare-not rewarded trials than for common-not rewarded and rare-rewarded trials.</p>
<fig id="pcbi.1004648.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004648.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Stay probability transition-outcome interaction for <italic>Q</italic>(1) agent due to trial start action values.</title>
<p>(<bold>A</bold>) Predictor loadings for logistic regression model predicting whether the <italic>Q</italic>(1) agent will repeat the same choice as a function of 4 predictors; Stay–a tendency to repeat the same choice irrespective of trial events, Outcome–a tendency to repeat the same choice following a rewarded trial, Transition—a tendency to repeat the same choice following common transitions, Transition x outcome interaction–a tendency to repeat the same choice dependent on the interaction between transition (common/rare) and outcome (rewarded/not). (<bold>B</bold>) Action values at the start of the trial for the chosen and not chosen action shown separately for trials with different transitions (common or rare) and outcomes (rewarded or not). Yellow error bars show SEM across sessions. (<bold>C</bold>) Predictor loadings for logistic regression model with additional predictor capturing tendency to repeat correct choices, i.e. choices whose common transition lead to the state which currently has high reward probability. (<bold>D</bold>) Across trial correlation between predictors in logistic regression analysis shown in (<bold>C</bold>).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.g002" position="float" xlink:type="simple"/>
</fig>
<fig id="pcbi.1004648.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004648.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparison of agents’ behaviour–reduced task.</title>
<p>Comparison of the behaviour of all agents types discussed in the paper on the reduced task. Far left panels–Stay probability plots. Centre left panels—Predictor loadings for logistic regression model predicting whether the agent will repeat the same choice as a function of 4 predictors; Stay–a tendency to repeat the same choice irrespective of trial events, Outcome–a tendency to repeat the same choice following a rewarded trial, Transition—a tendency to repeat the same choice following common transitions, Transition x outcome interaction–a tendency to repeat the same choice dependent on the interaction between transition (common/rare) and outcome (rewarded/not). Centre right panels–Predictor loadings for logistic regression analysis with additional ‘correct’ predictor which captures a tendency to repeat correct choices. Right panels—Predictor loadings for lagged logistic regression model. The model uses a set of 4 predictors at each lag, each of which captures how a given combination of transition (common/rare) and outcome (rewarded/not) predicts whether the agent will repeat the choice a given number of trials in the future, e.g, the ‘rewarded, rare’ predictor at lag -2 captures the extent to which receiving a reward following a rare transition predicts that the agent will choose the same action two trials later. Legend for right panels is at bottom of figure. Error bars in all plots show SEM across sessions. Agent types: (<bold>A-D</bold>) <italic>Q</italic>(1), (<bold>E-H</bold>) Model-based, (<bold>I-L</bold>) <italic>Q</italic>(0), (<bold>M-P</bold>) Reward-as-cue, (<bold>Q-T</bold>) Latent-state.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.g003" position="float" xlink:type="simple"/>
</fig>
<p>Why are action values at the start of the trial correlated with subsequent trial events, specifically the transition-outcome interaction? There are two steps in the argument. First, the difference in action values between chosen and not-chosen action is on average larger for trials where the agent chooses the correct action, i.e. that which commonly leads to the state with high reward probability, than for trials where the agent choses the incorrect option. When the difference in action values is small, the agent has little evidence that one option is better than the other, and is more likely to choose the incorrect action. Additionally, due to the stochastic softmax decision rule the agent sometimes chooses the action with lower subjective value, and such ‘exploratory’ choices are more likely to be incorrect. Second, choosing the correct, rather than incorrect, action changes the probabilities of observing different combinations of trial events. Rewarded common transitions and unrewarded rare transitions are more likely to occur following a correct action than they are to occur following an incorrect action. Conversely, rewarded rare transitions and unrewarded common transitions are more likely to occur following an incorrect action.</p>
<p>To summarise; the difference in action values going into the trial correlates with the probability of choosing the correct option. Whether the agent chooses the correct option determines the probability of observing each combination of subsequent trial events. Therefore when trials are divided into groups by outcome and transition, the action values at the start of the trial show a transition-outcome interaction (<xref rid="pcbi.1004648.g002" ref-type="fig">Fig 2B</xref>), which is then also observed for the stay probabilities (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1G</xref>), even though the agent did not use any information about the transition in its action value update.</p>
<p>This effect is not restricted to block based reward probabilities; it can also be observed when reward probabilities change as random walks (<xref rid="pcbi.1004648.s002" ref-type="supplementary-material">S2A and S2B</xref> Fig), or with static fixed reward probabilities of 0.8 / 0.2 in states <italic>a</italic> / <italic>b</italic> (<xref rid="pcbi.1004648.s002" ref-type="supplementary-material">S2F and S2G</xref> Fig). When reward probabilities in the two second-step states are fixed and equal (<xref rid="pcbi.1004648.s002" ref-type="supplementary-material">S2H and S2I</xref> Fig), the <italic>Q</italic>(1) agent shows no transition-outcome interaction as action values at the start of the trial differ only through stochastic fluctuations in the experienced outcomes and are therefore not correlated with subsequent trial events.</p>
<p>Data simulated from the <italic>Q</italic>(1) agent on the original version of the task does in fact show a significant (P = 0.01) albeit very small positive loading on the transition-outcome interaction predictor (<xref rid="pcbi.1004648.s003" ref-type="supplementary-material">S3B Fig</xref>) due to the mechanism outlined above. The effect is radically weaker than in the reduced task because the greater stochasticity in the state transitions and reward delivery in the original task greatly reduce the strength of correlation between action values at the first step and subsequent trial events. As this effect is so weak in the original task we do not consider it to have any implication for the stay probability analyses in the existing human literature.</p>
</sec>
<sec id="sec004">
<title>Correction to stay probability analysis</title>
<p>It is possible to modify the logistic regression analysis of stay probabilities to prevent differences in action values at the start of the trial from appearing as a spurious loading on the transition-outcome interaction predictor. This can be done by including an additional ‘correct’ predictor which captures the tendency of the agent to repeat correct choices, as originally suggested in [<xref rid="pcbi.1004648.ref034" ref-type="bibr">34</xref>]. Including this additional predictor completely removed loading on the transition-outcome interaction predictor for the <italic>Q</italic>(1) agent (P = 0.67, t-test for non-zero predictor loading) (<xref rid="pcbi.1004648.g002" ref-type="fig">Fig 2C</xref>; repeated for convenient comparison in <xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3C</xref>), correctly revealing that only the trial outcome affected the agent’s subsequent choice. For the model-based agent this extended logistic regression analysis showed positive loading on the transition-outcome interaction predictor (P &lt; 10<sup>−12</sup>) (<xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3G</xref>) reflecting the true importance of this interaction to the action value update used by the agent. Including the correct predictor did reduce loading on the interaction predictor for the model-based agent by 32.3%, indicating that trial start action values also contributed to the pattern of stay probabilities for this agent. The addition of a correct predictor works because the correlation between actions values at the start of a trial and the subsequent transition-outcome interaction is entirely mediated by the correlation between these action values and whether the agent chose the correct action on that trial. Explicitly including a predictor for repeating correct choices absorbs the variance due to action values at the trial start which would otherwise be absorbed by the transition-outcome interaction predictor due to correlation between these two predictors (<xref rid="pcbi.1004648.g002" ref-type="fig">Fig 2D</xref>).</p>
<p>Including the correct predictor reduced, but failed to completely remove, loading on the transition-outcome interaction predictor for the <italic>Q</italic>(1) agent simulated on the reduced task version with random walk reward probabilities (P &lt; 10<sup>−3</sup>, t-test for non-zero predictor loading) (<xref rid="pcbi.1004648.s002" ref-type="supplementary-material">S2D Fig</xref>). We hypothesised that the correct predictor failed to correctly compensate for trial start action values because it did not reflect the magnitude of the difference in reward probabilities between the two second-step states. We therefore tried using a continuous valued correct predictor whose magnitude was given by this difference. Including this predictor completely removed loading from the transition-outcome interaction predictor (P = 0.78, t-test for non-zero predictor loading) (<xref rid="pcbi.1004648.s002" ref-type="supplementary-material">S2E Fig</xref>).</p>
<p>An alternative way of differentiating model-based and model-free strategies is a lagged logistic regression analysis which examines the effect on choice probability of trial events at different lags relative to the current trial (Miller at al. Soc. Neurosci. Abstracts 2013, 855.13). Fig <xref rid="pcbi.1004648.g003" ref-type="fig">3D and 3H</xref> show a lagged logistic regression analysis for <italic>Q</italic>(1) and model-based agents. The analysis evaluated how different combinations of outcome and transition predict that the agent will repeat the same choice a given number of trials in the future. For example, the ‘rewarded, rare’ predictor at lag -2 captures the extent to which receiving a reward following a rare transition predicted that the agent will choose the same action two trials later. This analysis is therefore an extension of the classical stay probability analysis to include the effect of earlier trials. For the <italic>Q</italic>(1) agent (<xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3D</xref>), obtaining a reward predicted that the agent will repeat the same choice irrespective of the transition, with a smoothly decreasing predictive weight at increasing lag. For the model-based agent (<xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3H</xref>), rewarded-common transitions and non-rewarded rare transitions predicted the agent will repeat the same choice, while rewarded-rare and non-rewarded common transitions predict the agent will not repeat the same choice, again with the predictive weight smoothly decreasing with increasing lag.</p>
</sec>
<sec id="sec005">
<title>Model-based and model free agent variants</title>
<p>Various other factors have been suggested as influencing strategies, including eligibility traces for MF algorithms, the possibilities of continual learning of the transition probabilities, and also outcome- and transition-independent perseveration. We also considered the effects of all of these on the statistics of choice.</p>
<p>Although a <italic>Q</italic>(1) agent is typically used to illustrate model-free behaviour on the two-step task, it represents one end of a spectrum of model-free agents differentiated by the extent to which the action value update at the first step depends on either the trial outcome or second-step action values. This spectrum is parameterized by the eligibility trace parameter conventionally called <italic>λ</italic>. The update used by the <italic>Q</italic>(1) agent depends only on the trial outcome and not at all on the values of the second-step state (or second-step actions in the original two-step task [<xref rid="pcbi.1004648.ref007" ref-type="bibr">7</xref>]). At the other end of the spectrum is the <italic>Q</italic>(0) agent which updates the value of the first step action based only on the value of the second-step state, with no direct influence of the trial outcome. The value of the second-step state is then updated based on the trial outcome. The behaviour of a <italic>Q</italic>(0) agent on the simplified two-step task is shown in <xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3I–3L</xref>, and on the original task in <xref rid="pcbi.1004648.s003" ref-type="supplementary-material">S3I–S3L Fig</xref>. The behaviour on the reduced task of model-free agents which use mixtures of the <italic>Q</italic>(1) and <italic>Q</italic>(0) updates are shown in <xref rid="pcbi.1004648.s004" ref-type="supplementary-material">S4 Fig</xref>. The one trial back extended logistic regression analysis for the <italic>Q</italic>(0) agent (<xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3K</xref>) shows positive loading on the transition and outcome predictors and negative loading on the transition-outcome interaction predictor. Loading on the transition-outcome interaction predictor in the extended logistic regression analysis distinguishes the model-based agent from model-free agents across the range of values of <italic>λ</italic>, none of which shows positive loading on this predictor. The lagged logistic regression for the <italic>Q</italic>(0) agent shows a complex pattern in which the predictive weight of each combination of trial events does not decay smoothly at increasing lags.</p>
<p>It is typically assumed that subjects on the two-step task understand that the transition probabilities linking the first step actions to second-step states are fixed, and hence do not update their estimates of these based on the transitions they experience trial to trial. As this assumption may not be valid for subjects who do not have prior information about the task structure, we evaluated the behaviour of a model-based agent which learned the transition matrix online by updating its estimate of the transition probabilities for the chosen action on each trial based on the experienced transition (<xref rid="pcbi.1004648.s005" ref-type="supplementary-material">S5 Fig</xref>). With a low transition learning rate, such that the estimates of the transition probabilities averaged over many prior trials, the behaviour of the agent was similar to that of the model-based agent with fixed transition probabilities (<xref rid="pcbi.1004648.s005" ref-type="supplementary-material">S5A–S5D Fig</xref>). At higher transition learning rates, loading on the transition-outcome interaction predictor decreased, while loading on the outcome and transition predictors increased (<xref rid="pcbi.1004648.s005" ref-type="supplementary-material">S5G Fig</xref>). At high transition learning rates where the agent’s estimate of the transition probabilities was dominated by the most recently experienced transition, loading on both the outcome and transition predictors was substantially higher than that on the transition-outcome interaction predictor (<xref rid="pcbi.1004648.s005" ref-type="supplementary-material">S5L Fig</xref>).</p>
<p>Human subjects typically show a perseveration bias on the two-step task [<xref rid="pcbi.1004648.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1004648.ref008" ref-type="bibr">8</xref>], i.e. a tendency to repeat first step choices independent of the trial events. We therefore tested how a perseveration bias affected behaviour on the reduced task for Q(1) and model-based agents (<xref rid="pcbi.1004648.s006" ref-type="supplementary-material">S6 Fig</xref>). Perseveration bias increased stay probability (<xref rid="pcbi.1004648.s006" ref-type="supplementary-material">S6A and S6E Fig</xref>) and loading on the stay predictor (<xref rid="pcbi.1004648.s006" ref-type="supplementary-material">S6C and S6G Fig</xref>), but did not change the characteristic pattern of positive loading on the outcome predictor for the Q(1) agent and the transition-outcome interaction predictor for the model-based agent (<xref rid="pcbi.1004648.s006" ref-type="supplementary-material">S6C and S6G Fig</xref>).</p>
</sec>
<sec id="sec006">
<title>Extended state representations</title>
<p>We have so far considered only agents whose state representation corresponds to that used by the experimenter to define the task. However, identifying those states that are relevant for behaviour is a substantial component of the real control problem faced by organisms and there is no guarantee that when faced with a decision task, subjects will adopt the same state representation conceived by the experimenter. In the two-step task there is an underlying latent state that is relevant to behaviour–whether the reward probabilities are higher in state <italic>a</italic> or <italic>b</italic>. This induces correlation between where rewards are obtained and the true expected value of first step actions. It turns out that model-free agents that exploit these correlations or even attempt to learn this full latent structure, can produce behaviour similar to that of a model-based agent without using the prospective action evaluation that is the hallmark of classical model-based RL.</p>
<p>We first consider a simple way of exploiting the correlations. The two-step task has a circular structure in which subjects cycle repeatedly through the decision state, second-step states and trial outcomes. This repeating structure provides opportunities for subjects to learn predictive relationships between events on one trial and the actions that are likely to lead to reward on the subsequent trial. One such predictive relationship is that the location where reward is obtained on one trial predicts which choice on the next trial is likely to lead to reward. That is, if a reward is obtained in state <italic>a</italic>, the reward probability is higher for choosing action A on the subsequent trial, while if reward is obtained in state <italic>b</italic> the reward probability is higher for choosing action B on the subsequent trial. Note that this predictive relationship holds true across reversals in which second-step state has higher reward probability. The locations where reward is obtained, and conversely where non-rewards are obtained, can therefore, in principle, be used as discriminative stimuli to guide choice on the next trial. We therefore considered the behaviour of a ‘reward-as-cue’ agent which uses the location of reward as a discriminative stimulus for the state of the world. Specifically, the reward-as-cue agent treated the choice between actions A and B as occurring in one of 4 distinct states on each trial, defined by whether a reward or non-reward was obtained in state <italic>a</italic> or <italic>b</italic> at the end of the previous trial. The agent used model-free RL to learn independent values of actions A and B in each of these 4 states. Like the <italic>Q</italic>(1) agent, the reward-as-cue agent updated the value of the chosen action dependent on reward prediction error between its current estimate of the action value and the trial outcome, without using the action value at the second step in the update. The agent learned action values which produced the strategy of choosing action A following rewards in state <italic>a</italic>, action B following rewards in state <italic>b</italic>, action B following no reward in state <italic>a</italic> and action A following no reward in state <italic>b</italic>. This corresponds to a strong stay probability transition-outcome interaction (<xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3M–3O</xref>). Unlike the other agents considered so far, the reward-as-cue agent does not adapt to changes in the reward probabilities across blocks through changes in its action values. Rather, the action values are stable across blocks and reflect a fixed mapping between where reward is obtained and which action should be taken on the next trial.</p>
<p>It is plausible that over-trained animals could learn to use the location of reward as a discriminative stimulus to guide choice on the next trial, as animals straightforwardly learn to use discriminative sensory stimuli of various sorts as cues for the best action to take next [<xref rid="pcbi.1004648.ref044" ref-type="bibr">44</xref>–<xref rid="pcbi.1004648.ref047" ref-type="bibr">47</xref>]. Once learnt, this strategy would be minimally cognitively demanding as it is essentially a fixed stimulus-response habit with only a limited demand on working memory. However, although the reward-as-cue agent gives behaviour on the one trial back stay probability analysis which is qualitatively similar to that of a model-based agent, it shows a very different pattern of loadings in the lagged logistic regression analysis (<xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3P</xref>). Rather than the smooth drop off of predictive weight with increasing lag observed for the model-based agent, only the previous trial events are predictive of the reward-as-cue agent’s behaviour.</p>
<p>For all the agents in <xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3</xref>, we chose parameters determined by a maximum likelihood fit to the behaviour of the model-based agent, so that they would all have comparable average behaviour; see <xref rid="sec008" ref-type="sec">materials and methods</xref>). For the reward-as-cue agent, this suggested a very low learning rate (0.003). If, instead, we chose parameters for all agents that maximized the fraction of trials that are rewarded, the reward-as-cue agent outperformed both <italic>Q</italic>(1) and <italic>Q</italic>(0) model-free agents (<xref rid="pcbi.1004648.g004" ref-type="fig">Fig 4B</xref>).</p>
<fig id="pcbi.1004648.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004648.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparison of agents’ performance.</title>
<p>Performance achieved by different agent types in the original (<bold>A</bold>) and reduced (<bold>B</bold>) tasks, with parameter values optimised to maximise the fraction of trials rewarded. For the reward as cue agent, performance is shown for a fixed strategy of choosing action A (B) following reward in state <italic>a</italic> (<italic>b</italic>) and action B (A) following non-reward in state <italic>a</italic> (<italic>b</italic>). SEM error bars shown in red. Significant differences indicated by *: 5 &lt; 0.05, ** P &lt; 10<sup>−5</sup>.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.g004" position="float" xlink:type="simple"/>
</fig>
<p>As noted, the reward-as-cue strategy works because there is in fact a latent, unobservable state of the world that is important to the decision problem–whether the reward probability is higher in state <italic>a</italic> or <italic>b</italic>. The location where reward is obtained is correlated with, and hence informative about, this latent state, and therefore can be utilised as a discriminative stimulus to guide behaviour. However, because the reward-as-cue strategy uses only the most recent reward as a discriminative stimulus, it is far from optimal. We therefore evaluated the behaviour of a different agent we term ‘latent-state’ which understands that the world is always in one of two latent states, one in which the reward probability is high in state <italic>a</italic> and low in state <italic>b</italic>, and the other in which the reward probability is high in state <italic>b</italic> and low in state <italic>a</italic>. At the end of each trial the latent-state agent performed a Bayesian update of its estimate of the probabilities that world is in each latent state based on the observed trial events. In updating the probabilities the agent also assumed that there is a small probability (the inverse of the mean block length) that the state of the world switches between trials. This amounts to the assumption that the block lengths are exponentially distributed, rather than being of fixed length, as generally employed. We did not explicitly model the learning of action values in each of these latent states, but rather assumed asymptotic behaviour in which the agent chose action A with high probability in the latent state where state <italic>a</italic> had high reward probability and action B with high probability in the latent state where state <italic>b</italic> had high reward probability.</p>
<p>The behaviour of the latent-state agent looked qualitatively very similar to that of the model-based agent. The one trial back stay probability analyses showed a transition-outcome interaction (<xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3Q–3T</xref>). As for the model-based agent (<xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3H</xref>), the lagged logistic regression analysis for the latent-state agent (<xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3T</xref>) showed a tendency to repeat choices that were followed by rewarded common and non-rewarded rare transitions, and to not repeat choices that were followed by non-rewarded common and rewarded rare transitions, with a gradually decreasing predictive weight at increasing lag. However, the behaviour of the latent-state and model-based agents could be discriminated using model fitting, with data simulated by the model-based agent being fit with higher likelihood by the model-based agent (<xref rid="pcbi.1004648.g005" ref-type="fig">Fig 5C</xref>) and data simulated by the latent-state agent being fit with higher likelihood by the latent-state agent (<xref rid="pcbi.1004648.g005" ref-type="fig">Fig 5E</xref>). Data simulated from either latent-state or model-based agents was better fit by both of these agents than by either the <italic>Q</italic>(0) or <italic>Q</italic>(1) model-free agents. All agents on the reduced task had the same number of parameters, so model comparison using data likelihood directly, without correction for model complexity, is appropriate.</p>
<fig id="pcbi.1004648.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004648.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Likelihood comparison.</title>
<p>Data likelihood for maximum likelihood fits of different agent types (indicated by x-axis labels; MB–Model based, RC–Reward-as-cue, LS–Latent-state) to data simulated from each agent type (indicted by labels above axes) on the reduced (<bold>A-E</bold>) and original (<bold>F-J</bold>) tasks. All differences in data likelihood between different agents fit to the same data are significant at P &lt; 10<sup>−4</sup> except for that between the fit of the reward-as-cue and latent-state agents to data simulated from the reward-as-cue agent which is significant at P = 0.027.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.g005" position="float" xlink:type="simple"/>
</fig>
<p>With parameters optimized to maximize reward, the latent-state agent achieved performance that was not significantly different from the model-based agent (<xref rid="pcbi.1004648.g005" ref-type="fig">Fig 5B</xref>).</p>
<p>Finally, we evaluated the behaviour of agents using the reward-as-cue and latent-state strategies on the original version of the task (<xref rid="pcbi.1004648.s003" ref-type="supplementary-material">S3M–S3T Fig</xref>). The reward-as-cue strategy produced a weak but significant (P = 0.01) transition-outcome interaction effect on stay probability (<xref rid="pcbi.1004648.s003" ref-type="supplementary-material">S3M and S3O</xref> Fig). The transition-outcome interaction is much weaker than that observed for the reduced task because the location where rewards are obtained is more weakly correlated with the expected value of the first step actions–obtaining a reward in state <italic>a</italic> is in fact only weakly correlated with a high expected value of action A. For the latent-state strategy we assumed the agent believed that at any point in time, reward probability in one second-step state is 0.625 (the 75th percentile of the range of reward probabilities) and in the other 0.375 (the 25th percentile). This agent produced behaviour that was qualitatively very similar to the model-based agent (<xref rid="pcbi.1004648.s003" ref-type="supplementary-material">S3Q–S3T Fig</xref>). No significant difference was observed in the performance (fraction of trials rewarded) achievable by any of the different strategies considered on the original task version (<xref rid="pcbi.1004648.g005" ref-type="fig">Fig 5A</xref>). As in the reduced task, data simulated from each agent was fit with higher likelihood (<xref rid="pcbi.1004648.g005" ref-type="fig">Fig 5F–5J</xref>), and lower BIC score (<xref rid="pcbi.1004648.s007" ref-type="supplementary-material">S7 Fig</xref>), by that agent than by any of the other agents.</p>
</sec>
</sec>
<sec id="sec007" sec-type="conclusions">
<title>Discussion</title>
<p>We have provided a detailed analysis of the performance of a number of different RL strategies on variants of the two-step task. Since in the original task, complex and taxing strategies only garner modestly more reward than simple ones, it might seem attractive to alter the task to enhance the discrimination. We showed some dangers inherent in this idea, in that induced correlations can make discrimination harder. We also generalized this analysis to more complicated model-free strategies.</p>
<p>In particular, we identified two ways in which behaviour on the two-step task could, under certain conditions, be incorrectly identified as arising from prospective model-based evaluation of actions. The first issue is with the stay probability analysis commonly used as a metric of subjects’ strategies. We showed that rather than reflecting only the action value update occurring on a given trial, which is distinct for model-based and model-free action evaluation, stay probabilities can also be affected by action values at the start of the trial. This can cause the behaviour of a model-free agent to exhibit a stay probability transition-outcome interaction, which is classically interpreted as a signature of model-based behaviour. The second issue is the existence of alternative strategies which use different state representations from the basic states that define the task structure and produce behaviour which is similar to that of a model-based agent though not dependent on prospective evaluation of the outcome of actions.</p>
<p>The possibility that purely model-free agents can exhibit a transition-outcome interaction effect on stay probability has been discussed in two prior studies using the original two-step task [<xref rid="pcbi.1004648.ref012" ref-type="bibr">12</xref>,<xref rid="pcbi.1004648.ref034" ref-type="bibr">34</xref>]. Both studies suggested this can occur when the reward probabilities at the second step change slowly, with [<xref rid="pcbi.1004648.ref012" ref-type="bibr">12</xref>] further stating that a large initial difference in reward probabilities between the two second-step states contributes to the effect. Our analysis clarifies the mechanism by demonstrating that it is due to correlation between action values at start of the trial, specifically the difference in action values between the chosen and not chosen action, and subsequent trial events. The effect is very weak in the original task where both the state transitions and reward delivery are highly stochastic, and hence decorrelate action values and subsequent trial events. Our results show the effect can be strong even when reward probabilities change rapidly, as the reduced task version with random walks showed a strong effect (<xref rid="pcbi.1004648.s002" ref-type="supplementary-material">S2A–S2E Fig</xref>) even though the standard deviation of random walk step sizes was 4 times larger than in the original task.</p>
<p>The effect of trial start action values can be corrected for in a logistic regression analysis of stay probabilities by including a predictor which captures the tendency to choose the action which was correct on the previous trial, i.e. to repeat correct choices. Such a modification to the regression analysis was proposed in [<xref rid="pcbi.1004648.ref034" ref-type="bibr">34</xref>] and our results demonstrate its efficacy. We suggest this modified stay probability analysis will be a useful tool for evaluating the influence of trial events on subsequent choice in task variants where the classical stay probability analysis gives misleading results. One cost of using this additional predictor is that, as it is correlated with the transition-outcome predictor (<xref rid="pcbi.1004648.g002" ref-type="fig">Fig 2E</xref>), the relative loadings on these two predictors will be sensitive to fluctuations in the data, potentially requiring larger datasets to achieve reliable results.</p>
<p>The second issue we have identified with the two-step task is that, due to its repeating structure, subjects could, in principle, learn to exploit correlations between where rewards are obtained and the expected value of first step actions, to produce behavioural strategies that look similar to model-based behaviour but do not use prospective evaluation of actions. One simple strategy which we termed ‘reward-as-cue’ learns a fixed mapping between events on one trial and choice on the next trial (e.g. reward in state <italic>a</italic> → choose action A). Notably, it outperformed classical model-free strategies in terms of acquiring reward. The attraction of this strategy from the point of view of the subject is that once learned it requires no further updating of action values to adjust to changes in reward probability in the two second-step states, and hence can be fully automatized into a stimulus-response habit. Though this strategy produces a strong stay probability transition-outcome interaction, it can be distinguished from model-based behaviour as only the most recent trial influences choice. However behaviour strikingly similar to that of a model-based agent was generated by a more sophisticated strategy we termed ‘latent-state’, which uses the location of recent rewards as a discriminative stimulus for which of two latent states the world is in (high reward probability in state <italic>a</italic>, or high reward probability in state <italic>b</italic>), and follows a fixed mapping from the latent state of the world to choice.</p>
<p>On the large simulated datasets used in this study, behaviour simulated from latent-state and model-based agents could be differentiated by model-comparison, and this probably represents the best approach to doing so in experimental data. Data simulated from the latent-state agent was fit with higher likelihood (Fig <xref rid="pcbi.1004648.g005" ref-type="fig">5E and 5J</xref>) and lower BIC score (<xref rid="pcbi.1004648.s007" ref-type="supplementary-material">S7E Fig</xref>) by this agent than by the model-based agent, and vice versa. Though the differences were small, particularly on the original task, they were highly significant (P &lt; 10<sup>−5</sup>). However, several factors will make this discrimination more difficult when working with experimental data. Firstly; the size of experimental datasets is typically substantially smaller, reducing the resolution of model comparison approaches. Secondly, the quantitative details of fitted models are unlikely to exactly match subject’s strategies. Thirdly, subject’s behaviour may be generated by a mixture of interacting control systems using different strategies. Whether latent-state and model-based strategies can be discriminated using model comparison in a given behavioural dataset is ultimately an empirical question.</p>
<p>Is it plausible that subjects could learn latent-state type strategies in the two-step task? Many paradigms for humans and animals show evidence of aspects of this. It is apparent in probabilistic reversal learning tasks, in which humans [<xref rid="pcbi.1004648.ref048" ref-type="bibr">48</xref>] and monkeys [<xref rid="pcbi.1004648.ref049" ref-type="bibr">49</xref>] learn that there are in fact two distinct latent states of the world and use inference about the current latent state to guide their behaviour. Further, the huge wealth of tasks involving integration of noisy sensory evidence such as random dot motion discrimination and the Poisson clicks auditory discrimination task [<xref rid="pcbi.1004648.ref044" ref-type="bibr">44</xref>,<xref rid="pcbi.1004648.ref046" ref-type="bibr">46</xref>]. Take the former. Here, the latent state concerns which of two directions of motion is more prevalent in the input. Noisy sensory evidence is accumulated to draw this conclusion. In our task, the latent state is which of two states (<italic>a</italic> or <italic>b</italic>) is associated with a higher prevalence of reward. Noisy evidence, in the form of actual rewards, can be accumulated to draw an equivalent conclusion. Certainly there are important differences between these tasks; the timescale of integration is longer in the two-step and spans multiple trials, the discriminative stimuli in the two-step are themselves rewards, and the subjects take an active role in sampling the two information streams. However the inferential commonality is striking.</p>
<p>Both the reward-as-cue and latent-state strategies (termed collectively ‘extended-state’ strategies) work by exploiting the regularity in the task structure that the location where rewards are obtained correlates with which first step action has higher reward probability. Evidence for this regularity accrues slowly as it is only across multiple reversals in the reward probabilities that the correlation becomes apparent. It therefore seems probable that if subjects do learn to exploit this regularity, the strategy would only arise after extended experience with the task. In the original version of the task used typically in the human literature, subjects do a total of ~200 trials. The limited number of trials performed, and the fact that human subjects have been trained to understand the true task structure—presumably priming the use of a model-based strategy—both argue against the possibility that the apparently model-based behaviour reported in the bulk of the human literature in fact arises from extended-state strategies. Indeed, it is only after substantial additional training [<xref rid="pcbi.1004648.ref042" ref-type="bibr">42</xref>] that apparently model-based human two-step behaviour becomes resistant to inference from cognitive load from a demanding secondary task performed in parallel [<xref rid="pcbi.1004648.ref011" ref-type="bibr">11</xref>]. This training might lead to the creation of an extended-state strategy in which prospective model-based evaluation is replaced by a process of latent state inference with static state-action mappings, and thereby apparent automatization.</p>
<p>Latent state strategies go beyond classical model-free RL and are interesting in their own right. Indeed, although they do not use a model which predicts future state given chosen action, which following [<xref rid="pcbi.1004648.ref003" ref-type="bibr">3</xref>] we take as the definition of model-based RL, the latent state representation is a form of world model which allows the agent to approximate the behaviour generated by planning without the computational costs of simulating behavioural trajectories. In this respect it is similar to the successor representation [<xref rid="pcbi.1004648.ref050" ref-type="bibr">50</xref>], which generalises between actions based on the similarity of their experienced successor states, and can also approximate planning at reduced computational cost. Strategies like this illustrate the observation that the distinction between model-based and model-free RL is perhaps better thought of as a spectrum than a binary classification [<xref rid="pcbi.1004648.ref051" ref-type="bibr">51</xref>]. Nonetheless, the distinction between strategies that do and do not utilise a prospective model for predicting the future state given the chosen action is of interest, and we therefore suggest that in the design and interpretation of versions of tasks like the two-step, the possibility subjects may utilise extended-state strategies should be considered. This is of particular importance for versions intended for animal subjects, since the extensive training that typically precedes recordings or manipulations provides ample opportunity for task regularities to be learnt. Further, adaptations of the task to create sufficient contrast between good and bad options to offer sufficient incentive can provide stronger statistical evidence for the regularity that underpins extended-state strategies.</p>
<p>Various options exist to minimise the probability that apparently model-based behaviour is in fact due to such strategies. One would be to avoid overtraining subjects, limiting the total number of trials they perform. However, this precludes generating very large behavioural datasets to better quantify the effect of manipulations or the relationship between behaviour and neural activity. A second possibility is to accept that it may be difficult to disambiguate extended-state from classical model-based strategies purely from behaviour, and use neural data to try and disambiguate the strategy used by subjects. A final potential option is to modify the two-step task to introduce reversals into the transition matrix which maps the first step choice to second-step state. In this task variant, not only does the reward probability in each second-step state change over time, but the action which must be chosen to reach a given second-step state also changes. Model-based control that performs incremental learning of the current transition probabilities (one of the variants discussed above), can adjust in a straightforward manner to this change; one could even imagine coupling simple latent state inference for just the transition structure (as in conventional probabilistic reversal learning) to model-based RL. However, the task modification substantially increases the complexity of pure latent state strategies. Reversals in the transition matrix break the fixed predictive relationship in the original task between where reward is obtained and which action at the first step is likely to lead to reward. To solve this version through a fixed mapping from an inferred latent state to action requires latent states that are non-linear combinations of where rewards have been obtained and which actions have led to which states.</p>
<p>The possibility we have identified here for model-free strategies to masquerade as model-based mirrors proposals that apparently model-free behaviour on the two-step task may in fact be due to model-based selection applied to action sequences [<xref rid="pcbi.1004648.ref012" ref-type="bibr">12</xref>]. Though very different in their underlying mechanisms, both indicate the complexity of cleanly dissociating the contribution of different learning strategies to behaviour.</p>
<p>The two-step task latent state strategy provides an example of how agents may turn a planning problem into a set of automatized state-response mappings if there is a limited set of relevant states of the world, each with their own appropriate response. Even if the planning problem is large, with a great diversity of possible solutions, e.g. navigating from home to work, with experience the decision may be automatized to a mapping from a small number of relevant states of the world, e.g. is it rush hour, to a set of options which are known to work best in each condition. Such automatization is more sophisticated than stimulus-response habits as typically envisioned; the states of the world that evoke the response may be high level abstractions rather than directly observable stimuli, and the responses may be action sequences, or options in the hierarchical RL formalism [<xref rid="pcbi.1004648.ref052" ref-type="bibr">52</xref>]. However, as cached state–action mappings learnt through a history of reinforcement, such strategies have commonalities with classical habits and may be learnt using similar model-free RL algorithms applied to higher level state and action representations, perhaps instantiated in cortical-basal ganglia loops involving higher level cortices and associative and limbic striatal sub-regions. These considerations bring to the forefront the question of what state representations are learned and used [<xref rid="pcbi.1004648.ref053" ref-type="bibr">53</xref>,<xref rid="pcbi.1004648.ref054" ref-type="bibr">54</xref>], something known to be central to the speed with which agents learn to solve decision problems.</p>
</sec>
<sec id="sec008" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="sec009">
<title>Simulations</title>
<p>All simulations and analysis were conducted in Python. Full code used to produce the paper figures is included in supplementary material (<xref rid="pcbi.1004648.s008" ref-type="supplementary-material">S1 Code</xref>). For each agent, 10 sessions of length 10000 trials were simulated. All trials were included in analyses. Where errorbars are used these show standard error of the mean across session.</p>
</sec>
<sec id="sec010">
<title>Tasks</title>
<p>All tasks used in the paper shared the common structure that on each trial an initial choice between two actions, termed action A and action B, led probabilistically to one of two states, termed state <italic>a</italic> and state <italic>b</italic> (see diagrams; Fig <xref rid="pcbi.1004648.g001" ref-type="fig">1A and 1B</xref>). Action A normally lead to state <italic>a</italic> and action <italic>B</italic> normally lead to state <italic>b</italic>, but with fixed probability on each trial, a rare transition could occur such that action A lead to state <italic>b</italic> and action B to state <italic>a</italic>.</p>
<p>The following variants of the two-step task were used in the simulations:</p>
<sec id="sec011">
<title>Original task</title>
<p>Version of the task described in [<xref rid="pcbi.1004648.ref007" ref-type="bibr">7</xref>] and used in the majority of human studies. The probability of common/rare transitions was 0.7/03. Two actions were available in each second-step state and the subject chose one of these on each trial. The reward probabilities for the 4 second-step actions changed over time as a reflecting Gaussian random walk on the range 0.25–0.75, with the standard deviation of step size on each trial set to 0.025 (<xref rid="pcbi.1004648.g001" ref-type="fig">Fig 1C</xref>).</p>
</sec>
<sec id="sec012">
<title>Reduced task</title>
<p>The probability of common/rare transitions was 0.8/0.2. There was one action available in each second-step state. Except where stated otherwise, reward probabilities alternated every 50 trials between blocks with reward probability 0.8/0.2 in states <italic>a</italic>/<italic>b</italic> and bocks with reward probability 0.2/0.8 in states <italic>a</italic>/<italic>b</italic>. <xref rid="pcbi.1004648.s002" ref-type="supplementary-material">S2 Fig</xref> used variants of the reduced task with different reward probability distributions in the second steps. In <xref rid="pcbi.1004648.s002" ref-type="supplementary-material">S2A–S2E Fig</xref> reward probabilities varied as Gaussian random walks on the range 0–1 with step size standard deviation of 0.1. In Fig <xref rid="pcbi.1004648.g002" ref-type="fig">2F and 2G</xref> reward probabilities in states <italic>a</italic> and <italic>b</italic> were fixed at 0.2 and 0.8. In Fig <xref rid="pcbi.1004648.g002" ref-type="fig">2H and 2I</xref> reward probabilities in states <italic>a</italic> and <italic>b</italic> were fixed at 0.5 and 0.5.</p>
</sec>
</sec>
<sec id="sec013">
<title>Agents</title>
<p>In describing the action value updates used by the different agents we use the following variables:</p>
<p><italic>Q</italic>(<italic>s</italic><sub>1</sub>, <italic>a</italic><sub>1</sub>): The value of the first step action chosen on the trial.</p>
<p><italic>Q</italic>(<italic>s</italic><sub>2</sub>, <italic>a</italic><sub>2</sub>): The value of the second-step action chosen on the trial.</p>
<p><italic>r</italic>: The trial outcome (1 for reward, 0 for non-reward).</p>
<p><italic>α</italic>: The agent’s learning rate.</p>
<p>All agents used a softmax decision rule with inverse temperature parameter <italic>T</italic> to determine choice probabilities as a function of action values except for the first step choice of the latent state agent.</p>
<p>The update rules used by the agents were as follows:</p>
<sec id="sec014">
<title><italic>Q</italic>(<italic>λ</italic>) agents</title>
<p>The action value update rules used by the <italic>Q</italic>(<italic>λ</italic>) agents (including <italic>Q</italic>(0) and <italic>Q</italic>(1) agents) were:
<disp-formula id="pcbi.1004648.e001">
<alternatives>
<graphic id="pcbi.1004648.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.e001" xlink:type="simple"/>
<mml:math display="block" id="M1" overflow="scroll">
<mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>←</mml:mo><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mi>α</mml:mi><mml:mspace width="0.25em"/><mml:mrow><mml:mo>(</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mi>λ</mml:mi><mml:mspace width="0.25em"/><mml:mo stretchy="false">(</mml:mo><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
<disp-formula id="pcbi.1004648.e002">
<alternatives>
<graphic id="pcbi.1004648.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.e002" xlink:type="simple"/>
<mml:math display="block" id="M2" overflow="scroll">
<mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>←</mml:mo><mml:mspace width="0.5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mi>α</mml:mi><mml:mspace width="0.25em"/><mml:mi>r</mml:mi></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Where <italic>λ</italic> is the eligibility trace parameter (0 for the <italic>Q</italic>(0) agent and 1 for the <italic>Q</italic>(1) agent). Action value updates for <italic>Q</italic>(<italic>s</italic><sub>1</sub>, <italic>a</italic><sub>1</sub>) and <italic>Q</italic>(<italic>s</italic><sub>2</sub>, <italic>a</italic><sub>2</sub>) were applied sequentially at the end of each trial.</p>
</sec>
<sec id="sec015">
<title>Model-based agent</title>
<p>At the start of each trial the model-based agent computed action values for the first step actions as:
<disp-formula id="pcbi.1004648.e003">
<alternatives>
<graphic id="pcbi.1004648.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.e003" xlink:type="simple"/>
<mml:math display="block" id="M3" overflow="scroll">
<mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mi>∑</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mspace width="0.15em"/><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>V</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Where <italic>Q</italic>(<italic>s</italic><sub>1</sub>, <italic>a</italic><sub><italic>i</italic></sub>) is the value of first-step action <italic>i</italic>, <italic>V</italic>(<italic>s</italic><sub><italic>j</italic></sub>) is the value of the second-step state <italic>j</italic>, and <italic>P</italic>(<italic>s</italic><sub><italic>j</italic></sub>|<italic>a</italic><sub><italic>i</italic></sub>) is the true probability of reaching second-step state <italic>j</italic> after choosing action <italic>i</italic>. In the original task with a choice between two actions at the second step, the second-step state value <italic>V</italic>(<italic>s</italic><sub><italic>j</italic></sub>) was the maximum of the two action values available in that state; <italic>V</italic>(<italic>s</italic><sub><italic>j</italic></sub>) = max<sub><italic>l</italic></sub> (<italic>Q</italic>(<italic>s</italic><sub><italic>j</italic></sub>, <italic>a</italic><sub><italic>l</italic></sub>)). In the reduced task the second-step state value <italic>V</italic>(<italic>s</italic><sub><italic>j</italic></sub>) was the value of the one action available in that state; <italic>V</italic>(<italic>s</italic><sub><italic>j</italic></sub>) = <italic>Q</italic>(<italic>s</italic><sub><italic>j</italic></sub>, <italic>a</italic>)</p>
<p>The action value update rule used by the model-based agent at the end of each trial was:
<disp-formula id="pcbi.1004648.e004">
<alternatives>
<graphic id="pcbi.1004648.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.e004" xlink:type="simple"/>
<mml:math display="block" id="M4" overflow="scroll">
<mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>←</mml:mo><mml:mspace width="0.5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mi>α</mml:mi><mml:mspace width="0.25em"/><mml:mi>r</mml:mi></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>In <xref rid="pcbi.1004648.s005" ref-type="supplementary-material">S5 Fig</xref>, a version of the model-based agent was used in which the transition probabilities <italic>P</italic>(<italic>s</italic><sub><italic>j</italic></sub>|<italic>a</italic><sub><italic>i</italic></sub>) linking the first-step actions to the second-step states was learnt online from experienced transitions. The update rule for the agents estimate of transition probabilities was:
<disp-formula id="pcbi.1004648.e005">
<alternatives>
<graphic id="pcbi.1004648.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.e005" xlink:type="simple"/>
<mml:math display="block" id="M5" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>←</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>η</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mi>η</mml:mi><mml:mi>X</mml:mi></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Where <inline-formula id="pcbi.1004648.e006"><alternatives><graphic id="pcbi.1004648.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.e006" xlink:type="simple"/><mml:math display="inline" id="M6" overflow="scroll"><mml:mrow><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:math></alternatives></inline-formula> is the agents estimate of the probability of reaching state <italic>x</italic> ∈ (<italic>a</italic>, <italic>b</italic>) after choosing action <italic>a</italic><sub>1</sub>, <italic>η</italic> is the transition probability learning rate, and <italic>X</italic> = 1 if the second-step state reached on the trial was <italic>x</italic> and <italic>X</italic> = 0 otherwise.</p>
</sec>
<sec id="sec016">
<title>Agents with perseveration bias</title>
<p>In <xref rid="pcbi.1004648.s006" ref-type="supplementary-material">S6 Fig</xref>, versions of the Q(1) and model based agents with an additional perseveration bias were simulated on the reduced task. The perseveration bias was implemented as a transient increase to the value of the first-step action chosen on the previous trial. This boost to the action value was only used in determining choice probabilities and did not contribute to the action value update following the choice. The strength of perseveration bias used was 0.4.</p>
</sec>
<sec id="sec017">
<title>Reward-as-cue agent</title>
<p>The reward-as-cue agent treated the choice between actions A and B as occurring in one of four different states on each trial, corresponding to the 4 combinations of the outcome (1 or 0) and second-step state (<italic>a</italic> or <italic>b</italic>) that occurred on the previous trial. The action value update used was:
<disp-formula id="pcbi.1004648.e007">
<alternatives>
<graphic id="pcbi.1004648.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.e007" xlink:type="simple"/>
<mml:math display="block" id="M7" overflow="scroll">
<mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>←</mml:mo><mml:mspace width="0.3em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mi>α</mml:mi><mml:mspace width="0.25em"/><mml:mi>r</mml:mi></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>Where <italic>Q</italic>(<italic>s</italic><sub>1</sub>, <italic>a</italic><sub>1</sub>) is the value of the action chosen at the first step in the relevant state. In the original task where there was a choice at the second-step, action values for the second step actions were updated as:
<disp-formula id="pcbi.1004648.e008">
<alternatives>
<graphic id="pcbi.1004648.e008g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.e008" xlink:type="simple"/>
<mml:math display="block" id="M8" overflow="scroll">
<mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>←</mml:mo><mml:mspace width="0.5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mi>α</mml:mi><mml:mspace width="0.25em"/><mml:mi>r</mml:mi></mml:mrow>
</mml:math>
</alternatives>
</disp-formula></p>
<p>The reward as cue agent on the original task used separate softmax inverse temperatures and learning rates at the first and second steps.</p>
</sec>
<sec id="sec018">
<title>Latent-state agent</title>
<p>The latent-state agent believed there were two states of the world, one of which had reward probabilities of (<italic>P</italic><sub><italic>good</italic></sub>, <italic>P</italic><sub><italic>bad</italic></sub>) in second-step states <italic>a</italic> and <italic>b</italic> respectively, and the other with reward probabilities of (<italic>P</italic><sub><italic>bad</italic></sub>, <italic>P</italic><sub><italic>good</italic></sub>) in second-step states <italic>a</italic> and <italic>b</italic> respectively. On the reduced task version <italic>P</italic><sub><italic>good</italic></sub> = 0.8 and <italic>P</italic><sub><italic>bad</italic></sub> = 0.2. On the original task version <italic>P</italic><sub><italic>good</italic></sub> = 0.625 and <italic>P</italic><sub><italic>bad</italic></sub> = 0.375.</p>
<p>At the start of each trial the agent performed a Bayesian update of the probability that the world was in each of these states based on the previous trial events. The agent then updated the probability that the world was in each state to account for the possibility that the world reversed in state between the previous and current trial, which was assumed to occur with probability ω. The agent used a probabilistic mapping from its estimate of the state of the world to choice, choosing with probability (1 – ε) the action with higher reward probability in the most probable state, and with probability ε the action with higher reward probability in the less probable state. On the original task where there was a choice at the second-step, action values for the second step actions were updated as:
<disp-formula id="pcbi.1004648.e009">
<alternatives>
<graphic id="pcbi.1004648.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.e009" xlink:type="simple"/>
<mml:math display="block" id="M9" overflow="scroll">
<mml:mrow><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>←</mml:mo><mml:mspace width="0.5em"/><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>Q</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:mspace width="0.25em"/><mml:mi>α</mml:mi><mml:mspace width="0.25em"/><mml:mi>r</mml:mi></mml:mrow>
</mml:math>
</alternatives>
</disp-formula>
and the agent chose between the second-step actions using the softmax decision rule.</p>
</sec>
</sec>
<sec id="sec019">
<title>Parameter values</title>
<p>The parameter values of the model-based agent on both tasks were set to: <italic>α</italic> = 0.5, <italic>T</italic> = 5</p>
<p>To ensure that average behaviour for the different agents was comparable, the parameters of the other agents were set by maximum likelihood fitting to data simulated from the model-based agent. This resulted in the following agent parameters:</p>
<table-wrap id="pcbi.1004648.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004648.t001</object-id>
<alternatives>
<graphic id="pcbi.1004648.t001g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004648.t001" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Original task:</td>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Q</italic>(0) agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> = 0.384, <italic>T</italic> = 4.09</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Q</italic>(1) agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> = 0.398, <italic>T</italic> = 2.72</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Reward-as-cue agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic><sub><italic>first step</italic></sub>=0.00184, <italic>T</italic><sub><italic>first step</italic></sub> = 4.82, <italic>α</italic><sub><italic>second step</italic></sub> = 0.499, <italic>T</italic><sub><italic>first step</italic></sub> = 4.98</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Latent-state agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>ω</italic> = 0.0882, ε = 0.368, <italic>α</italic> = 0.509, <italic>T</italic> = 4.96</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Reduced task:</td>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Q</italic>(0) agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> = 0.501, <italic>T</italic> = 2.96</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Q</italic>(1) agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> = 0.334, <italic>T</italic> = 3.22</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Q</italic>(0.25) agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> = 0.499, <italic>T</italic>=3.48</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Q</italic>(0.5) agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> = 0.477, <italic>T</italic>=3.57</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Q</italic>(0.75) agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> = 0.409, <italic>T</italic> = 3.42</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Reward-as-cue agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>α</italic> = 0.00344, <italic>T</italic> = 4.46</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Latent-state agent:</td>
<td align="left" rowspan="1" colspan="1"><italic>ω</italic> = 0.0326, ε = 0.188</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="sec020">
<title>Comparing agent performance</title>
<p>To evaluate the performance of the different agents in <xref rid="pcbi.1004648.g004" ref-type="fig">Fig 4</xref>, agent parameter values were optimised using Powell’s method [<xref rid="pcbi.1004648.ref055" ref-type="bibr">55</xref>]. To reduce fluctuations in the objective function due to stochastic task and agent behaviour, the random seed was set to the same value at the start of every simulation in a given optimisation run. Each optimisation run was repeated 10 times from randomised initial parameter values to avoid local maxima. To prevent overestimation of performance due to overfitting to the specific pattern of behaviour generated by a given random seed, once parameters had been found which maximised performance for a given random seed, performance was evaluated with these parameters but a different random seed and this value was taken. For each agent, performance was evaluated for 10 sessions each of 10000 trials, with a different random seed used during the optimisation for each session. For those agents with only two parameters we separately optimised the performance using a brute force grid search. Performance evaluated using the Powell and grid search optimisation methods did not differ significantly for any agent. Values reported in the paper are from the Powell optimisation. For the Reward-as-cue agent we used the performance of a deterministic reward-as-cue strategy which choose option A following reward in state <italic>a</italic>, option B following reward in state <italic>b</italic>, choose option A following non-reward in state <italic>b</italic>, option B following non-reward in state <italic>a</italic>.</p>
</sec>
<sec id="sec021">
<title>Logistic regression analysis</title>
<p>In all logistic regression analyses, the dependent variable was the subject’s choice, coded as stay vs switch, such that positive values of the predictor promote staying with the previous choice. Predictors used in the analysis took the following values as a function of trial events:</p>
<p><italic>Stay</italic>: +1 for all trials.</p>
<p><italic>Outcome</italic>: +0.5 for rewarded trials, -0.5 for non-rewarded trials.</p>
<p><italic>Transition</italic>: +0.5 for common transition trials, -0.5 for rare transition trials.</p>
<p><italic>Transition-outcome interaction</italic>: +0.5 for common transition rewarded and rare transitions non-rewarded trials, -0.5 for rare transition rewarded and common transition non-rewarded trials.</p>
<p><italic>Correct—binary</italic>: +0.5 for choosing option which led commonly to state with higher reward probability, -0.5 for choosing option which led commonly to state with lower reward probability. In the original task the higher reward probability of the two actions available in each second step state was taken as the states reward probability.</p>
<p><italic>Correct-continuous</italic>: Difference between reward probability in the state commonly reached from the chosen action and reward probability in the state commonly reached from the not-chosen action.</p>
<p><italic>Rewarded-common</italic>: +0.5 for rewarded trials with common transition, 0 otherwise.</p>
<p><italic>Rewarded-rare</italic>: +0.5 for rewarded trials with rare transition, 0 otherwise.</p>
<p><italic>Non-rewarded common</italic>: +0.5 for non-rewarded trials with common transition, 0 otherwise.</p>
<p><italic>Non-rewarded rare</italic>: +0.5 for non-rewarded trials with rare transition, 0 otherwise.</p>
</sec>
</sec>
<sec id="sec022">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004648.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004648.s001" mimetype="application/eps" position="float" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Interaction predictor loading as a function of agent parameter values.</title>
<p>Loading on the transition-outcome interaction predictor as a function of agent parameter values for behaviour simulated from different agent types on the reduced version of the task. Agent types: (<bold>A</bold>) <italic>Q</italic>(1), (<bold>B</bold>) <italic>Q</italic>(0), (<bold>C</bold>) Model-based, (<bold>D</bold>) Reward-as-cue, (<bold>E</bold>) Latent-state. The regression used predictors; stay, outcome, transition, transition-outcome interaction (as in <xref rid="pcbi.1004648.g003" ref-type="fig">Fig 3</xref> centre left panels).</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004648.s002" xlink:href="info:doi/10.1371/journal.pcbi.1004648.s002" mimetype="application/eps" position="float" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Reduced task with different reward probability distributions.</title>
<p>(<bold>A-E</bold>) Simulation of <italic>Q</italic>(1) agent on version of reduced task with random walk reward probabilities. (<bold>A</bold>) Example of random walk reward probabilities in states <italic>a</italic> and <italic>b</italic>. (<bold>B</bold>) Stay probability plot. (<bold>C</bold>) Predictor loading for logistic regression analysis using predictors; stay, outcome, transition, transition-outcome interaction. (<bold>D</bold>) Predictor loadings for logistic regression using additional binary valued correct predictor. (<bold>E</bold>) Predictor loadings for logistic regression using additional continuous valued correct predictor. (<bold>F</bold>, <bold>G</bold>) Simulation of <italic>Q</italic>(1) agent on version of reduced task with fixed 0.2, 0.8 reward probabilities. (<bold>H</bold>, <bold>I</bold>) Simulation of <italic>Q</italic>(1) agent on version of reduced task with fixed 0.5, 0.5 reward probabilities.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004648.s003" xlink:href="info:doi/10.1371/journal.pcbi.1004648.s003" mimetype="application/eps" position="float" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Comparison of agents’ behaviour–original task.</title>
<p>Comparison of the behaviour of all agents types discussed in the paper on the original task. Far left panels–Stay probability plots. Centre left panels—Predictor loadings for logistic regression model predicting whether the agent will repeat the same choice as a function predictors; stay, outcome, transition, transition-outcome interaction. Centre right panels–Predictor loadings for logistic regression analysis with additional ‘correct’ predictor. Right panels—Predictor loadings for lagged logistic regression model. Error bars in all plots show SEM across sessions. Agent types: (<bold>A-D</bold>) <italic>Q</italic>(1), (<bold>E-H</bold>) Model-based, (<bold>I-L</bold>) <italic>Q</italic>(0), (<bold>M-P</bold>) Reward-as-cue, (<bold>Q-T</bold>) Latent-state.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004648.s004" xlink:href="info:doi/10.1371/journal.pcbi.1004648.s004" mimetype="application/eps" position="float" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Intermediate values of lambda.</title>
<p>Comparison of behaviour simulated on reduced task by agents with intermediate values of the lambda parameter that controls the relative contribution of the <italic>Q</italic>(1) update and TD0 update; (<bold>A</bold>-<bold>D</bold>) lambda = 0.25, (<bold>E</bold>-<bold>H</bold>) lambda = 0.5, (<bold>I</bold>-<bold>L</bold>) lambda = 0.75. Far left panels–Stay probability plots. Centre left panels—Predictor loadings for logistic regression model predicting whether the agent will repeat the same choice as a function predictors; stay, outcome, transition, transition-outcome interaction. Centre right panels–Predictor loadings for logistic regression analysis with additional ‘correct’ predictor. Right panels—Predictor loadings for lagged logistic regression model. Error bars in all plots show SEM across sessions.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004648.s005" xlink:href="info:doi/10.1371/journal.pcbi.1004648.s005" mimetype="application/eps" position="float" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Effect of transition matrix learning.</title>
<p>Comparison of behaviour simulated on reduced task by model based agent that learned the transition probabilities online from the experienced transitions. (<bold>A</bold>-<bold>D</bold>) transition learning rate = 0.1, (<bold>E</bold>-<bold>H</bold>) transition learning rate = 0.5, (<bold>I</bold>-<bold>L</bold>) transition learning rate = 0.75. Far left panels–Stay probability plots. Centre left panels—Predictor loadings for logistic regression model predicting whether the agent will repeat the same choice as a function predictors; stay, outcome, transition, transition-outcome interaction. Centre right panels–Predictor loadings for logistic regression analysis with additional ‘correct’ predictor. Right panels—Predictor loadings for lagged logistic regression model. Error bars in all plots show SEM across sessions.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004648.s006" xlink:href="info:doi/10.1371/journal.pcbi.1004648.s006" mimetype="application/eps" position="float" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Effect of perseveration parameter.</title>
<p>Comparison of behaviour simulated on reduced task by (<bold>A</bold>-<bold>D</bold>) <italic>Q</italic>(1) and (<bold>E</bold>-<bold>H</bold>) Model-based agents with an additional perseveration parameter which biases them to repeat choices. Far left panels–Stay probability plots. Centre left panels—Predictor loadings for logistic regression model predicting whether the agent will repeat the same choice as a function predictors; stay, outcome, transition, transition-outcome interaction. Centre right panels–Predictor loadings for logistic regression analysis with additional ‘correct’ predictor. Right panels—Predictor loadings for lagged logistic regression model. Error bars in all plots show SEM across sessions.</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004648.s007" xlink:href="info:doi/10.1371/journal.pcbi.1004648.s007" mimetype="application/eps" position="float" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>BIC score comparison–original task.</title>
<p>BIC scores for maximum likelihood fits of different agent types (indicated by x-axis labels; MB–Model based, RC–Reward-as-cue, LS–Latent-state) to data simulated from each agent type (indicted by labels above axes; (<bold>A</bold>) <italic>Q</italic>(1) agent, (<bold>B</bold>) Q(0) agent, (<bold>C</bold>) Model-based agent, (<bold>D</bold>) Reward-as-cue agent, (<bold>E</bold>) Latent-state agent).</p>
<p>(EPS)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004648.s008" xlink:href="info:doi/10.1371/journal.pcbi.1004648.s008" mimetype="application/zip" position="float" xlink:type="simple">
<label>S1 Code</label>
<caption>
<title>Simulation code.</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>The authors thank Evan Russek, Kevin Miller, Bruno Miranda, Eric DeWitt, Nathaniel Daw and Anthony Dickinson for useful discussions.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004648.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>A</given-names></name>. <article-title>Goal-directed instrumental action: contingency and incentive learning and their cortical substrates</article-title>. <source>Neuropharmacology</source>. <year>1998</year>;<volume>37</volume>: <fpage>407</fpage>–<lpage>419</lpage>. <object-id pub-id-type="pmid">9704982</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Goals and Habits in the Brain</article-title>. <source>Neuron</source>. <year>2013</year>;<volume>80</volume>: <fpage>312</fpage>–<lpage>325</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2013.09.007" xlink:type="simple">10.1016/j.neuron.2013.09.007</ext-link></comment> <object-id pub-id-type="pmid">24139036</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref003"><label>3</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Sutton</surname> <given-names>RS</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AG</given-names></name>. <chapter-title>Reinforcement learning: An introduction</chapter-title>. <publisher-name>The MIT press</publisher-name>; <year>1998</year>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Uncertainty-based competition between prefrontal and dorsolateral striatal systems for behavioral control</article-title>. <source>Nat Neurosci</source>. <year>2005</year>;<volume>8</volume>: <fpage>1704</fpage>–<lpage>11</lpage>. doi:nn1560 <object-id pub-id-type="pmid">16286932</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gläscher</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>. <article-title>States versus Rewards: Dissociable Neural Prediction Error Signals Underlying Model-Based and Model-Free Reinforcement Learning</article-title>. <source>Neuron</source>. <year>2010</year>;<volume>66</volume>: <fpage>585</fpage>–<lpage>595</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2010.04.016" xlink:type="simple">10.1016/j.neuron.2010.04.016</ext-link></comment> <object-id pub-id-type="pmid">20510862</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Keramati</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dezfouli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Piray</surname> <given-names>P</given-names></name>. <article-title>Speed/accuracy trade-off between the habitual and the goal-directed processes</article-title>. <source>PLoS Comput Biol</source>. <year>2011</year>;<volume>7</volume>: <fpage>e1002055</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002055" xlink:type="simple">10.1371/journal.pcbi.1002055</ext-link></comment> <object-id pub-id-type="pmid">21637741</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Seymour</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Model-based influences on humans’ choices and striatal prediction errors</article-title>. <source>Neuron</source>. <year>2011</year>;<volume>69</volume>: <fpage>1204</fpage>–<lpage>1215</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2011.02.027" xlink:type="simple">10.1016/j.neuron.2011.02.027</ext-link></comment> <object-id pub-id-type="pmid">21435563</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wunderlich</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Smittenaar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Dopamine Enhances Model-Based over Model-Free Choice Behavior</article-title>. <source>Neuron</source>. <year>2012</year>;<volume>75</volume>: <fpage>418</fpage>–<lpage>424</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2012.03.042" xlink:type="simple">10.1016/j.neuron.2012.03.042</ext-link></comment> <object-id pub-id-type="pmid">22884326</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wunderlich</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Mapping value based planning and extensively trained choice in the human brain</article-title>. <source>Nat Neurosci</source>. <year>2012</year></mixed-citation></ref>
<ref id="pcbi.1004648.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huys</surname> <given-names>QJM</given-names></name>, <name name-style="western"><surname>Eshel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>O’Nions</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sheridan</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Roiser</surname> <given-names>JP</given-names></name>. <article-title>Bonsai trees in your head: how the Pavlovian system sculpts goal-directed choices by pruning decision trees</article-title>. <source>PLoS Comput Biol</source>. <year>2012</year>;<volume>8</volume>: <fpage>e1002410</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002410" xlink:type="simple">10.1371/journal.pcbi.1002410</ext-link></comment> <object-id pub-id-type="pmid">22412360</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Otto</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Markman</surname> <given-names>AB</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>The Curse of Planning Dissecting Multiple Reinforcement-Learning Systems by Taxing the Central Executive</article-title>. <source>Psychol Sci</source>. <year>2013</year>;<volume>24</volume>: <fpage>751</fpage>–<lpage>761</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1177/0956797612463080" xlink:type="simple">10.1177/0956797612463080</ext-link></comment> <object-id pub-id-type="pmid">23558545</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dezfouli</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Actions, Action Sequences and Habits: Evidence That Goal-Directed and Habitual Action Control Are Hierarchically Organized</article-title>. <source>PLoS Comput Biol</source>. <year>2013</year>;<volume>9</volume>: <fpage>e1003364</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1003364" xlink:type="simple">10.1371/journal.pcbi.1003364</ext-link></comment> <object-id pub-id-type="pmid">24339762</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pezzulo</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Rigoli</surname> <given-names>F</given-names></name>, <name name-style="western"><surname>Chersi</surname> <given-names>F</given-names></name>. <article-title>The Mixed Instrumental Controller: Using Value of Information to Combine Habitual Choice and Mental Simulation</article-title>. <source>Front Psychol</source>. <year>2013</year>;<volume>4</volume>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huys</surname> <given-names>QJ</given-names></name>, <name name-style="western"><surname>Lally</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Faulkner</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Eshel</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Seifritz</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <etal>et al</etal>. <article-title>Interplay of approximate planning strategies</article-title>. <source>Proc Natl Acad Sci</source>. <year>2015</year>;<volume>112</volume>: <fpage>3098</fpage>–<lpage>3103</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1414219112" xlink:type="simple">10.1073/pnas.1414219112</ext-link></comment> <object-id pub-id-type="pmid">25675480</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Adams</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>A</given-names></name>. <article-title>Instrumental responding following reinforcer devaluation</article-title>. <source>Q J Exp Psychol Sect B</source>. <year>1981</year>;<volume>33</volume>: <fpage>109</fpage>–<lpage>121</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Colwill</surname> <given-names>RM</given-names></name>, <name name-style="western"><surname>Rescorla</surname> <given-names>RA</given-names></name>. <article-title>Postconditioning devaluation of a reinforcer affects instrumental responding</article-title>. <source>J Exp Psychol Anim Behav Process</source>. <year>1985</year>;<volume>11</volume>: <fpage>120</fpage>–<lpage>132</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dickinson</surname> <given-names>A</given-names></name>. <article-title>Actions and habits: the development of behavioural autonomy</article-title>. <source>Philos Trans R Soc B Biol Sci</source>. <year>1985</year>;<volume>308</volume>: <fpage>67</fpage>–<lpage>78</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dickinson</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Nicholas</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Adams</surname> <given-names>CD</given-names></name>. <article-title>The effect of the instrumental training contingency on susceptibility to reinforcer devaluation</article-title>. <source>Q J Exp Psychol</source>. <year>1983</year>;<volume>35</volume>: <fpage>35</fpage>–<lpage>51</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Killcross</surname> <given-names>AS</given-names></name>, <name name-style="western"><surname>Dickinson</surname> <given-names>A</given-names></name>. <article-title>The Effect of Lesions of the Basolateral Amygdala on Instrumental Conditioning</article-title>. <source>J Neurosci</source>. <year>2003</year>;<volume>23</volume>: <fpage>666</fpage>–<lpage>675</lpage>. <object-id pub-id-type="pmid">12533626</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Corbit</surname> <given-names>LH</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>The role of prelimbic cortex in instrumental conditioning</article-title>. <source>Behav Brain Res</source>. <year>2003</year>;<volume>146</volume>: <fpage>145</fpage>–<lpage>157</lpage>. <object-id pub-id-type="pmid">14643467</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Killcross</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Coutureau</surname> <given-names>E</given-names></name>. <article-title>Coordination of Actions and Habits in the Medial Prefrontal Cortex of Rats</article-title>. <source>Cereb Cortex</source>. <year>2003</year>;<volume>13</volume>: <fpage>400</fpage>–<lpage>408</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/cercor/13.4.400" xlink:type="simple">10.1093/cercor/13.4.400</ext-link></comment> <object-id pub-id-type="pmid">12631569</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Coutureau</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Killcross</surname> <given-names>S</given-names></name>. <article-title>Inactivation of the infralimbic prefrontal cortex reinstates goal-directed responding in overtrained rats</article-title>. <source>Behav Brain Res</source>. <year>2003</year>;<volume>146</volume>: <fpage>167</fpage>–<lpage>174</lpage>. <object-id pub-id-type="pmid">14643469</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yin</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Knowlton</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Lesions of dorsolateral striatum preserve outcome expectancy but disrupt habit formation in instrumental learning</article-title>. <source>Eur J Neurosci</source>. <year>2004</year>;<volume>19</volume>: <fpage>181</fpage>–<lpage>189</lpage>. <object-id pub-id-type="pmid">14750976</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yin</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Knowlton</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Blockade of NMDA receptors in the dorsomedial striatum prevents action–outcome learning in instrumental conditioning</article-title>. <source>Eur J Neurosci</source>. <year>2005</year>;<volume>22</volume>: <fpage>505</fpage>–<lpage>512</lpage>. <object-id pub-id-type="pmid">16045503</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yin</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Ostlund</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Knowlton</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>The role of the dorsomedial striatum in instrumental conditioning</article-title>. <source>Eur J Neurosci</source>. <year>2005</year>;<volume>22</volume>: <fpage>513</fpage>–<lpage>523</lpage>. <object-id pub-id-type="pmid">16045504</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yin</surname> <given-names>HH</given-names></name>, <name name-style="western"><surname>Knowlton</surname> <given-names>BJ</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Inactivation of dorsolateral striatum enhances sensitivity to changes in the action-outcome contingency in instrumental conditioning</article-title>. <source>Behav Brain Res</source>. <year>2006</year>;<volume>166</volume>: <fpage>189</fpage>–<lpage>196</lpage>. <object-id pub-id-type="pmid">16153716</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ostlund</surname> <given-names>SB</given-names></name>, <name name-style="western"><surname>Balleine</surname> <given-names>BW</given-names></name>. <article-title>Lesions of medial prefrontal cortex disrupt the acquisition but not the expression of goal-directed learning</article-title>. <source>J Neurosci</source>. <year>2005</year>;<volume>25</volume>: <fpage>7763</fpage>. <object-id pub-id-type="pmid">16120777</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hilario</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Holloway</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Jin</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>RM</given-names></name>. <article-title>Different dorsal striatum circuits mediate action discrimination and action generalization</article-title>. <source>Eur J Neurosci</source>. <year>2012</year>;<volume>35</volume>: <fpage>1105</fpage>–<lpage>1114</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/j.1460-9568.2012.08073.x" xlink:type="simple">10.1111/j.1460-9568.2012.08073.x</ext-link></comment> <object-id pub-id-type="pmid">22487040</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gremel</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>RM</given-names></name>. <article-title>Orbitofrontal and striatal circuits dynamically encode the shift between goal-directed and habitual actions</article-title>. <source>Nat Commun</source>. <year>2013</year>;<volume>4</volume>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gremel</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Costa</surname> <given-names>RM</given-names></name>. <article-title>Premotor cortex is critical for goal-directed actions</article-title>. <source>Front Comput Neurosci</source>. <year>2013</year>;<volume>7</volume>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref031"><label>31</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Otto</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Raio</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Chiang</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Phelps</surname> <given-names>EA</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>Working-memory capacity protects model-based learning from stress</article-title>. <source>Proc Natl Acad Sci</source>. <year>2013</year>;<volume>110</volume>: <fpage>20941</fpage>–<lpage>20946</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1312011110" xlink:type="simple">10.1073/pnas.1312011110</ext-link></comment> <object-id pub-id-type="pmid">24324166</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref032"><label>32</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Skatova</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Chan</surname> <given-names>PA</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>Extraversion differentiates between model-based and model-free strategies in a reinforcement learning task</article-title>. <source>Front Hum Neurosci</source>. <year>2013</year>;<volume>7</volume>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref033"><label>33</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eppinger</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Walter</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Heekeren</surname> <given-names>HR</given-names></name>, <name name-style="western"><surname>Li</surname> <given-names>S-C</given-names></name>. <article-title>Of goals and habits: age-related and individual differences in goal-directed decision-making</article-title>. <source>Front Neurosci</source>. <year>2013</year>;<volume>7</volume>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref034"><label>34</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smittenaar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>FitzGerald</surname> <given-names>THB</given-names></name>, <name name-style="western"><surname>Romei</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Wright</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Disruption of Dorsolateral Prefrontal Cortex Decreases Model-Based in Favor of Model-free Control in Humans</article-title>. <source>Neuron</source>. <year>2013</year></mixed-citation></ref>
<ref id="pcbi.1004648.ref035"><label>35</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Otto</surname> <given-names>AR</given-names></name>, <name name-style="western"><surname>Skatova</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Madlon-Kay</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>. <article-title>Cognitive control predicts use of model-based reinforcement learning</article-title>. <source>J Cogn Neurosci</source>. <year>2014</year></mixed-citation></ref>
<ref id="pcbi.1004648.ref036"><label>36</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sebold</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Deserno</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Nebe</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Schad</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Garbusow</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Hägele</surname> <given-names>C</given-names></name>, <etal>et al</etal>. <article-title>Model-Based and Model-Free Decisions in Alcohol Dependence</article-title>. <source>Neuropsychobiology</source>. <year>2014</year>;<volume>70</volume>: <fpage>122</fpage>–<lpage>131</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1159/000362840" xlink:type="simple">10.1159/000362840</ext-link></comment> <object-id pub-id-type="pmid">25359492</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref037"><label>37</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smittenaar</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Prichard</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>FitzGerald</surname> <given-names>THB</given-names></name>, <name name-style="western"><surname>Diedrichsen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Transcranial Direct Current Stimulation of Right Dorsolateral Prefrontal Cortex Does Not Affect Model-Based or Model-Free Reinforcement Learning in Humans</article-title>. <source>PLoS ONE</source>. <year>2014</year></mixed-citation></ref>
<ref id="pcbi.1004648.ref038"><label>38</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schad</surname> <given-names>DJ</given-names></name>, <name name-style="western"><surname>Jünger</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sebold</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Garbusow</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Bernhardt</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Javadi</surname> <given-names>A-H</given-names></name>, <etal>et al</etal>. <article-title>Processing speed enhances model-based over model-free reinforcement learning in the presence of high working memory functioning</article-title>. <source>Front Psychol</source>. <year>2014</year>;<volume>5</volume>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref039"><label>39</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Voon</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Derbyshire</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Rück</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Irvine</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Worbe</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Enander</surname> <given-names>J</given-names></name>, <etal>et al</etal>. <article-title>Disorders of compulsivity: a common bias towards learning habits</article-title>. <source>Mol Psychiatry</source>. <year>2015</year>;<volume>20</volume>: <fpage>345</fpage>–<lpage>352</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/mp.2014.44" xlink:type="simple">10.1038/mp.2014.44</ext-link></comment> <object-id pub-id-type="pmid">24840709</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref040"><label>40</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Radenbach</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Reiter</surname> <given-names>AMF</given-names></name>, <name name-style="western"><surname>Engert</surname> <given-names>V</given-names></name>, <name name-style="western"><surname>Sjoerds</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Villringer</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Heinze</surname> <given-names>H-J</given-names></name>, <etal>et al</etal>. <article-title>The interaction of acute and chronic stress impairs model-based behavioral control</article-title>. <source>Psychoneuroendocrinology</source>. <year>2015</year>;<volume>53</volume>: <fpage>268</fpage>–<lpage>280</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.psyneuen.2014.12.017" xlink:type="simple">10.1016/j.psyneuen.2014.12.017</ext-link></comment> <object-id pub-id-type="pmid">25662093</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref041"><label>41</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Deserno</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Huys</surname> <given-names>QJM</given-names></name>, <name name-style="western"><surname>Boehme</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Buchert</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Heinze</surname> <given-names>H-J</given-names></name>, <name name-style="western"><surname>Grace</surname> <given-names>AA</given-names></name>, <etal>et al</etal>. <article-title>Ventral striatal dopamine reflects behavioral and neural signatures of model-based control during sequential decision making</article-title>. <source>Proc Natl Acad Sci</source>. <year>2015</year>;<volume>112</volume>: <fpage>1595</fpage>–<lpage>1600</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.1417219112" xlink:type="simple">10.1073/pnas.1417219112</ext-link></comment> <object-id pub-id-type="pmid">25605941</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref042"><label>42</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Economides</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Kurth-Nelson</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Lübbert</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Guitart-Masip</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Dolan</surname> <given-names>RJ</given-names></name>. <article-title>Model-Based Reasoning in Humans Becomes Automatic with Training</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>;<volume>11</volume>: <fpage>e1004463</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1004463" xlink:type="simple">10.1371/journal.pcbi.1004463</ext-link></comment> <object-id pub-id-type="pmid">26379239</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref043"><label>43</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Worbe</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Palminteri</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Savulich</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Fernandez-Egea</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Robbins</surname> <given-names>TW</given-names></name>, <etal>et al</etal>. <article-title>Valence-dependent influence of serotonin depletion on model-based choice strategy</article-title>. <source>Mol Psychiatry</source>. <year>2015</year></mixed-citation></ref>
<ref id="pcbi.1004648.ref044"><label>44</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Salzman</surname> <given-names>CD</given-names></name>, <name name-style="western"><surname>Britten</surname> <given-names>KH</given-names></name>, <name name-style="western"><surname>Newsome</surname> <given-names>WT</given-names></name>. <article-title>Cortical microstimulation influences perceptual judgements of motion direction</article-title>. <source>Nature</source>. <year>1990</year>;<volume>346</volume>: <fpage>174</fpage>–<lpage>177</lpage>. <object-id pub-id-type="pmid">2366872</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref045"><label>45</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Uchida</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Mainen</surname> <given-names>ZF</given-names></name>. <article-title>Speed and accuracy of olfactory discrimination in the rat</article-title>. <source>Nat Neurosci</source>. <year>2003</year>;<volume>6</volume>: <fpage>1224</fpage>–<lpage>1229</lpage>. <object-id pub-id-type="pmid">14566341</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref046"><label>46</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brunton</surname> <given-names>BW</given-names></name>, <name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Brody</surname> <given-names>CD</given-names></name>. <article-title>Rats and humans can optimally accumulate evidence for decision-making</article-title>. <source>Science</source>. <year>2013</year>;<volume>340</volume>: <fpage>95</fpage>–<lpage>98</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1233912" xlink:type="simple">10.1126/science.1233912</ext-link></comment> <object-id pub-id-type="pmid">23559254</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref047"><label>47</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Znamenskiy</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Zador</surname> <given-names>AM</given-names></name>. <article-title>Corticostriatal neurons in auditory cortex drive decisions during auditory discrimination</article-title>. <source>Nature</source>. <year>2013</year>;<volume>497</volume>: <fpage>482</fpage>–<lpage>485</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nature12077" xlink:type="simple">10.1038/nature12077</ext-link></comment> <object-id pub-id-type="pmid">23636333</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref048"><label>48</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hampton</surname> <given-names>AN</given-names></name>, <name name-style="western"><surname>Bossaerts</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>O’Doherty</surname> <given-names>JP</given-names></name>. <article-title>The Role of the Ventromedial Prefrontal Cortex in Abstract State-Based Inference during Decision Making in Humans</article-title>. <source>J Neurosci</source>. <year>2006</year>;<volume>26</volume>: <fpage>8360</fpage>–<lpage>8367</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1010-06.2006" xlink:type="simple">10.1523/JNEUROSCI.1010-06.2006</ext-link></comment> <object-id pub-id-type="pmid">16899731</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref049"><label>49</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Costa</surname> <given-names>VD</given-names></name>, <name name-style="western"><surname>Tran</surname> <given-names>VL</given-names></name>, <name name-style="western"><surname>Turchi</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Averbeck</surname> <given-names>BB</given-names></name>. <article-title>Reversal Learning and Dopamine: A Bayesian Perspective</article-title>. <source>J Neurosci</source>. <year>2015</year>;<volume>35</volume>: <fpage>2407</fpage>–<lpage>2416</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.1989-14.2015" xlink:type="simple">10.1523/JNEUROSCI.1989-14.2015</ext-link></comment> <object-id pub-id-type="pmid">25673835</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref050"><label>50</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>Improving generalization for temporal difference learning: The successor representation</article-title>. <source>Neural Comput</source>. <year>1993</year>;<volume>5</volume>: <fpage>613</fpage>–<lpage>624</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004648.ref051"><label>51</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Daw</surname> <given-names>ND</given-names></name>, <name name-style="western"><surname>Dayan</surname> <given-names>P</given-names></name>. <article-title>The algorithmic anatomy of model-based evaluation</article-title>. <source>Philos Trans R Soc B Biol Sci</source>. <year>2014</year>;<volume>369</volume>: <fpage>20130478</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1098/rstb.2013.0478" xlink:type="simple">10.1098/rstb.2013.0478</ext-link></comment></mixed-citation></ref>
<ref id="pcbi.1004648.ref052"><label>52</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Botvinick</surname> <given-names>MM</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Barto</surname> <given-names>AC</given-names></name>. <article-title>Hierarchically organized behavior and its neural foundations: A reinforcement learning perspective</article-title>. <source>Cognition</source>. <year>2009</year>;<volume>113</volume>: <fpage>262</fpage>–<lpage>280</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.cognition.2008.08.011" xlink:type="simple">10.1016/j.cognition.2008.08.011</ext-link></comment> <object-id pub-id-type="pmid">18926527</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref053"><label>53</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gershman</surname> <given-names>SJ</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>. <article-title>Learning latent structure: carving nature at its joints</article-title>. <source>Curr Opin Neurobiol</source>. <year>2010</year>;<volume>20</volume>: <fpage>251</fpage>–<lpage>256</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.conb.2010.02.008" xlink:type="simple">10.1016/j.conb.2010.02.008</ext-link></comment> <object-id pub-id-type="pmid">20227271</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref054"><label>54</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Takahashi</surname> <given-names>YK</given-names></name>, <name name-style="western"><surname>Schoenbaum</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Niv</surname> <given-names>Y</given-names></name>. <article-title>Orbitofrontal Cortex as a Cognitive Map of Task Space</article-title>. <source>Neuron</source>. <year>2014</year>;<volume>81</volume>: <fpage>267</fpage>–<lpage>279</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.neuron.2013.11.005" xlink:type="simple">10.1016/j.neuron.2013.11.005</ext-link></comment> <object-id pub-id-type="pmid">24462094</object-id></mixed-citation></ref>
<ref id="pcbi.1004648.ref055"><label>55</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Powell</surname> <given-names>MJ</given-names></name>. <article-title>An efficient method for finding the minimum of a function of several variables without calculating derivatives</article-title>. <source>Comput J</source>. <year>1964</year>;<volume>7</volume>: <fpage>155</fpage>–<lpage>162</lpage>.</mixed-citation></ref>
</ref-list>
</back>
</article>