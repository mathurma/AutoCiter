<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01815</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003531</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Ecology</subject><subj-group><subject>Microbial ecology</subject></subj-group></subj-group><subj-group><subject>Microbiology</subject><subj-group><subject>Medical microbiology</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Physical sciences</subject><subj-group><subject>Mathematics</subject><subj-group><subject>Statistics (mathematics)</subject><subj-group><subject>Biostatistics</subject><subject>Contingency tables</subject><subject>Statistical methods</subject></subj-group></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Waste Not, Want Not: Why Rarefying Microbiome Data Is Inadmissible</article-title>
<alt-title alt-title-type="running-head">Rarefying Microbiome Data Is Inadmissible</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>McMurdie</surname><given-names>Paul J.</given-names></name><xref ref-type="aff" rid="aff1"/></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Holmes</surname><given-names>Susan</given-names></name><xref ref-type="aff" rid="aff1"/><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><addr-line>Statistics Department, Stanford University, Stanford, California, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>McHardy</surname><given-names>Alice Carolyn</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Heinrich Heine University, Germany</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">susan@stat.stanford.edu</email></corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: PJM SH. Performed the experiments: PJM. Analyzed the data: PJM SH. Contributed reagents/materials/analysis tools: PJM SH. Wrote the paper: PJM SH.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>4</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>3</day><month>4</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>4</issue>
<elocation-id>e1003531</elocation-id>
<history>
<date date-type="received"><day>18</day><month>10</month><year>2013</year></date>
<date date-type="accepted"><day>3</day><month>2</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>McMurdie, Holmes</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><related-article id="RA1" related-article-type="companion" ext-link-type="uri" page="e1002972" xlink:type="simple" xlink:href="info:doi/10.1371/journal.pcbi.1002972"> <article-title>New Methods Section in PLOS Computational Biology</article-title></related-article>
<abstract>
<p>Current practice in the normalization of microbiome count data is inefficient in the statistical sense. For apparently historical reasons, the common approach is either to use simple proportions (which does not address heteroscedasticity) or to use <italic>rarefying</italic> of counts, even though both of these approaches are inappropriate for detection of differentially abundant species. Well-established statistical theory is available that simultaneously accounts for library size differences and biological variability using an appropriate mixture model. Moreover, specific implementations for DNA sequencing read count data (based on a Negative Binomial model for instance) are already available in RNA-Seq focused R packages such as edgeR and DESeq. Here we summarize the supporting statistical theory and use simulations and empirical data to demonstrate substantial improvements provided by a relevant mixture model framework over simple proportions or rarefying. We show how both proportions and rarefied counts result in a high rate of false positives in tests for species that are differentially abundant across sample classes. Regarding microbiome sample-wise clustering, we also show that the rarefying procedure often discards samples that can be accurately clustered by alternative methods. We further compare different Negative Binomial methods with a recently-described zero-inflated Gaussian mixture, implemented in a package called <italic>metagenomeSeq</italic>. We find that metagenomeSeq performs well when there is an adequate number of biological replicates, but it nevertheless tends toward a higher false positive rate. Based on these results and well-established statistical theory, we advocate that investigators avoid rarefying altogether. We have provided microbiome-specific extensions to these tools in the R package, phyloseq.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>The term <italic>microbiome</italic> refers to the ecosystem of microbes that live in a defined environment. The decreasing cost and increasing speed of DNA sequencing technology has recently provided scientists with affordable and timely access to the genes and genomes of microbiomes that inhabit our planet and even our own bodies. In these investigations many microbiome samples are sequenced at the same time on the same DNA sequencing machine, but often result in total numbers of sequences per sample that are vastly different. The common procedure for addressing this difference in sequencing effort across samples – different <italic>library sizes</italic> – is to either (1) base analyses on the proportional abundance of each species in a library, or (2) <italic>rarefy</italic>, throw away sequences from the larger libraries so that all have the same, smallest size. We show that both of these <italic>normalization methods</italic> can work when comparing obviously-different whole microbiomes, but that neither method works well when comparing the relative proportions of each bacterial species across microbiome samples. We show that alternative methods based on a statistical <italic>mixture model</italic> perform much better and can be easily adapted from a separate biological sub-discipline, called RNA-Seq analysis.</p>
</abstract>
<funding-group><funding-statement>This work was supported by the NIH (<ext-link ext-link-type="uri" xlink:href="http://www.nih.gov" xlink:type="simple">http://www.nih.gov</ext-link>) under grant number NIH R01-GM086884. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="12"/></counts></article-meta>
</front>
<body><sec id="s1">
<title/>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods article.</p>
</disp-quote></sec><sec id="s2">
<title>Introduction</title>
<p>Modern, massively parallel DNA sequencing technologies have changed the scope and technique of investigations across many fields of biology <xref ref-type="bibr" rid="pcbi.1003531-Shendure1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Shendure2">[2]</xref>. In gene expression studies the standard measurement technique has shifted away from microarray hybridization to direct sequencing of cDNA, a technique often referred to as <italic>RNA-Seq</italic> <xref ref-type="bibr" rid="pcbi.1003531-Mortazavi1">[3]</xref>. Analogously, culture independent <xref ref-type="bibr" rid="pcbi.1003531-Pace1">[4]</xref> microbiome research has migrated away from detection of species through microarray hybridization of small subunit rRNA gene PCR amplicons <xref ref-type="bibr" rid="pcbi.1003531-Wilson1">[5]</xref> to direct sequencing of highly-variable regions of these amplicons <xref ref-type="bibr" rid="pcbi.1003531-Huse1">[6]</xref>, or even direct <italic>shotgun</italic> sequencing of microbiome metagenomic DNA <xref ref-type="bibr" rid="pcbi.1003531-Riesenfeld1">[7]</xref>. Even though the statistical methods available for analyzing microarray data have matured to a high level of sophistication <xref ref-type="bibr" rid="pcbi.1003531-Allison1">[8]</xref>, these methods are not directly applicable because DNA sequencing data consists of discrete counts of sequence <italic>reads</italic> rather than continuous values derived from the fluorescence intensity of hybridized probes. In recent generation DNA sequencing the total reads per sample (<italic>library size</italic>; sometimes referred to as <italic>depths of coverage</italic>) can vary by orders of magnitude within a single sequencing run. Comparison across samples with different library sizes requires more than a simple linear or logarithmic scaling adjustment because it also implies different levels of uncertainty, as measured by the sampling variance of the proportion estimate for each feature (a feature is a gene in the RNA-Seq context, and is a species or <underline>O</underline>perational <underline>T</underline>axonomic <underline>U</underline>nit, OTU, in the context of microbiome sequencing). In this article we are primarily concerned with optimal methods for addressing differences in library sizes from microbiome sequencing data.</p>
<p>Variation in the read counts of features between technical replicates have been adequately modeled by Poisson random variables <xref ref-type="bibr" rid="pcbi.1003531-Marioni1">[9]</xref>. However, we are usually interested in understanding the variation of features among biological replicates in order to make inferences that are relevant to the corresponding population; in which case a mixture model is necessary to account for the added uncertainty <xref ref-type="bibr" rid="pcbi.1003531-Lu1">[10]</xref>. Taking a hierarchical model approach with the Gamma-Poisson has provided a satisfactory fit to RNA-Seq data <xref ref-type="bibr" rid="pcbi.1003531-Robinson1">[11]</xref>, as well as a valid regression framework that leverages the power of generalized linear models <xref ref-type="bibr" rid="pcbi.1003531-Cameron1">[12]</xref>. A Gamma mixture of Poisson variables gives the negative binomial (NB) distribution <xref ref-type="bibr" rid="pcbi.1003531-Lu1">[10]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Robinson1">[11]</xref> and several RNA-Seq analysis packages now model the counts, <italic>K</italic>, for gene <italic>i</italic>, in sample <italic>j</italic> according to:<disp-formula id="pcbi.1003531.e001"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003531.e001" xlink:type="simple"/><label>(1)</label></disp-formula>where <italic>s<sub>j</sub></italic> is a linear scaling factor for sample <italic>j</italic> that accounts for its library size, <italic>μ<sub>i</sub></italic> is the mean proportion for gene <italic>i</italic>, and <italic>φ<sub>i</sub></italic> is the dispersion parameter for gene <italic>i</italic>. The variance is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e002" xlink:type="simple"/></inline-formula>, with the NB distribution becoming Poisson when <italic>φ</italic> = 0. Recognizing that <italic>φ</italic>&gt;0 and estimating its value is necessary in gene-level tests in order to control the rate of false positive genes. Many false positive genes appear significantly differentially expressed between experimental conditions under the assumption of a Poisson distribution, but are nevertheless not-significant in tests that account for the larger variance that results from non-zero dispersion.</p>
<p>The uncertainty in estimating <italic>φ<sub>i</sub></italic> for every gene when there is a small number of samples — or a small number of biological replicates — can be mitigated by sharing information across the thousands of genes in an experiment, leveraging a systematic trend in the mean-dispersion relationship <xref ref-type="bibr" rid="pcbi.1003531-Robinson1">[11]</xref>. This approach substantially increases the power to detect differences in proportions (differential expression) while still adequately controlling for false positives <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref>. Many R packages implementing this model of RNA-Seq data are now available, differing mainly in their approach to modeling dispersion across genes <xref ref-type="bibr" rid="pcbi.1003531-Yu1">[14]</xref>. Although DNA sequencing-based microbiome investigations use the same sequencing machines and represent the processed sequence data in the same manner — a feature-by-sample contingency table where the features are OTUs instead of genes — to our knowledge the modeling and normalization methods currently used in RNA-Seq analysis have not been transferred to microbiome research <xref ref-type="bibr" rid="pcbi.1003531-DiBella1">[15]</xref>–<xref ref-type="bibr" rid="pcbi.1003531-NavasMolina1">[17]</xref>.</p>
<p>Instead, microbiome analysis workflows often begin with an <italic>ad hoc</italic> library size normalization by random subsampling without replacement, or so-called <italic>rarefying</italic> <xref ref-type="bibr" rid="pcbi.1003531-NavasMolina1">[17]</xref>–<xref ref-type="bibr" rid="pcbi.1003531-Koren1">[19]</xref>. There is confusion in the literature regarding terminology, and sometimes this normalization approach is conflated with a non-parametric resampling technique — called <italic>rarefaction</italic> <xref ref-type="bibr" rid="pcbi.1003531-Sanders1">[20]</xref>, or <italic>individual-based taxon re-sampling curves</italic> <xref ref-type="bibr" rid="pcbi.1003531-Gotelli1">[21]</xref> — that can be justified for coverage analysis or species richness estimation in some settings <xref ref-type="bibr" rid="pcbi.1003531-Gotelli1">[21]</xref>, though in other settings it can perform worse than parametric methods <xref ref-type="bibr" rid="pcbi.1003531-Mao1">[22]</xref>. Here we emphasize the distinction between taxon re-sampling curves and normalization by strictly adhering to the terms <italic>rarefying</italic> or <italic>rarefied counts</italic> when referring to the normalization procedure, respecting the original definition for <italic>rarefaction</italic>. Rarefying is most often defined by the following steps <xref ref-type="bibr" rid="pcbi.1003531-Hughes1">[18]</xref>.</p>
<list list-type="order"><list-item>
<p>Select a minimum library size, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e003" xlink:type="simple"/></inline-formula>. This has also been called the <italic>rarefaction level</italic> <xref ref-type="bibr" rid="pcbi.1003531-NavasMolina1">[17]</xref>, though we will not use the term here.</p>
</list-item><list-item>
<p>Discard libraries (microbiome samples) that have fewer reads than <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e004" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Subsample the remaining libraries without replacement such that they all have size <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e005" xlink:type="simple"/></inline-formula>.</p>
</list-item></list>
<p>Often <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e006" xlink:type="simple"/></inline-formula> is chosen to be equal to the size of the smallest library that is not considered <italic>defective</italic>, and the process of identifying defective samples comes with a risk of subjectivity and bias. In many cases researchers have also failed to repeat the random subsampling step (3) or record the pseudorandom number generation seed/process — both of which are essential for reproducibility. To our knowledge, rarefying was first recommended for microbiome counts in order to moderate the sensitivity of the UniFrac distance <xref ref-type="bibr" rid="pcbi.1003531-Lozupone1">[23]</xref> to library size, especially differences in the presence of rare OTUs <xref ref-type="bibr" rid="pcbi.1003531-Lozupone2">[24]</xref>. In these and similar studies the principal objective is an exploratory/descriptive comparison of microbiome samples, often from different environmental/biological sources; a research task that is becoming increasingly accessible with declining sequencing costs and the ability to sequence many samples in parallel using barcoded primers <xref ref-type="bibr" rid="pcbi.1003531-Hamady1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Liu1">[26]</xref>. Rarefying is now an exceedingly common precursor to microbiome multivariate workflows that seek to relate sample covariates to sample-wise distance matrices <xref ref-type="bibr" rid="pcbi.1003531-Koren1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Hamady2">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Yatsunenko1">[28]</xref>; for example, integrated as a recommended option in QIIME's <xref ref-type="bibr" rid="pcbi.1003531-Caporaso1">[29]</xref> beta_diversity_through_plots.py workflow, in Sub.sample in the mothur software library <xref ref-type="bibr" rid="pcbi.1003531-Schloss1">[30]</xref>, in daisychopper.pl <xref ref-type="bibr" rid="pcbi.1003531-Gilbert1">[31]</xref>, and is even supported in phyloseq's rarefy_even_depth function <xref ref-type="bibr" rid="pcbi.1003531-McMurdie1">[32]</xref> (though not recommended in its documentation). The perception in the microbiome literature of “rarefying to even sampling depth” as a standard normalization procedure appears to explain why rarefied counts are also used in studies that attempt to detect <italic>differential abundance</italic> of OTUs between predefined classes of samples <xref ref-type="bibr" rid="pcbi.1003531-Charlson1">[33]</xref>–<xref ref-type="bibr" rid="pcbi.1003531-Kang1">[37]</xref>, in addition to studies that use proportions directly <xref ref-type="bibr" rid="pcbi.1003531-Segata2">[38]</xref>. It should be noted that we have adopted the recently coined term <italic>differential abundance</italic> <xref ref-type="bibr" rid="pcbi.1003531-White1">[39]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Paulson1">[40]</xref> as a direct analogy to <italic>differential expression</italic> from RNA-Seq. Like differentially expressed genes, a species/OTU is considered differentially abundant if its mean proportion is significantly different between two or more sample classes in the experimental design.</p>
<sec id="s2a">
<title>Statistical motivation</title>
<p>Despite its current popularity in microbiome analyses <bold>rarefying biological count data is statistically inadmissible</bold> because it requires the omission of available valid data. This holds even if repeated rarefying trials are compared for stability as previously suggested <xref ref-type="bibr" rid="pcbi.1003531-NavasMolina1">[17]</xref>. In this article we demonstrate the applicability of a variance stabilization technique based on a mixture model of microbiome count data. This approach simultaneously addresses both problems of (1) DNA sequencing libraries of widely different sizes, and (2) OTU (feature) count proportions that vary more than expected under a Poisson model. We utilize the most popular implementations of this approach currently used in RNA-Seq analysis, namely edgeR <xref ref-type="bibr" rid="pcbi.1003531-Robinson2">[41]</xref> and DESeq <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref>, adapted here for microbiome data. This approach allows valid comparison across OTUs while substantially improving both power and accuracy in the detection of differential abundance. We also compare the performance of the Gamma-Poisson mixture model against a method that models OTU proportions using a zero-inflated Gaussian distribution, implemented in a recently-released package called metagenomeSeq <xref ref-type="bibr" rid="pcbi.1003531-Paulson1">[40]</xref>.</p>
<p>A mathematical proof of the sub-optimality of the rarefying approach is presented in the supplementary material (<xref ref-type="supplementary-material" rid="pcbi.1003531.s002">Text S1</xref>). To help explain why rarefying is statistically inadmissible, especially with regards to variance stabilization, we start with the following minimal example. Suppose we want to compare two different samples, called <italic>A</italic> and <italic>B</italic>, comprised of 100 and 1000 DNA sequencing reads, respectively. In statistical terms, these library sizes are also equivalent to the number of trials in a sampling experiment. In practice, the library size associated with each biological sample is a random number generated by the technology, often varying from hundreds to millions. For our example, we imagine the simplest possible case where the samples can only contain two types of microbes, called <italic>OTU1</italic> and <italic>OTU2</italic>. The results of this hypothetical experiment are represented in the <italic>Original Abundance</italic> section of <xref ref-type="fig" rid="pcbi-1003531-g001">Figure 1</xref>. Formally comparing the two proportions according to a standard test could technically be done either using a <italic>χ</italic><sup>2</sup> test (equivalent to a two sample proportion test here) or a Fisher exact test. By first rarefying (<xref ref-type="fig" rid="pcbi-1003531-g001">Figure 1</xref>, <italic>Rarefied Abundance</italic> section) so that both samples have the same library size before doing the tests, we are no longer able to differentiate the samples (<xref ref-type="fig" rid="pcbi-1003531-g001">Figure 1</xref>, tests). This loss of power is completely attributable to reducing the size of <italic>B</italic> by a factor of 10, which also increases the width of the confidence intervals corresponding to each proportion such that they are no longer distinguishable from those in <italic>A</italic> even though they are distinguishable in the original data.</p>
<fig id="pcbi-1003531-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003531.g001</object-id><label>Figure 1</label><caption>
<title>A minimal example of the effect of rarefying on statistical power.</title>
<p>Hypothetical abundance data in its original (Top-Left) and rarefied (Top-Right) form, with corresponding formal test results for differentiation (Bottom).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003531.g001" position="float" xlink:type="simple"/></fig>
<p>The variance of the proportion's estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e007" xlink:type="simple"/></inline-formula> is multiplied by 10 when the total count is divided by 10. In this binomial example the variance of the proportion estimate is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e008" xlink:type="simple"/></inline-formula>, a function of the mean. This is a common occurrence and one that is traditionally dealt with in statistics by applying variance-stabilizing transformations. We show in <xref ref-type="supplementary-material" rid="pcbi.1003531.s002">Text S1</xref> that the relation between the variance and the mean for microbiome count data can be estimated and the model used to find the optimal variance-stabilizing transformation. As illustrated by this simple example, it is inappropriate to compare the proportions of OTU <italic>i</italic>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e009" xlink:type="simple"/></inline-formula>, without accounting for differences in the denominator value (the library size, <italic>s<sub>j</sub></italic>) because they have unequal variances. This problem of unequal variances is called <italic>heteroscedasticity</italic>. In other words, the <italic>uncertainty</italic> associated with each value in the table is fundamentally linked to the total number of observations (or reads), which can vary even more widely than a 10-fold difference. In practice we will be observing hundreds of different OTUs instead of two, often with dependendency between the counts. Nevertheless, the difficulty caused by unequal library sizes still pertains.</p>
<p>The uncertainty with which each proportion is estimated must be considered when testing for a difference between proportions (one OTU), or sets of proportions (a microbial community). Although rarefying does equalize variances, it does so only by inflating the variances in all samples to the largest (worst) value among them at the cost of discriminating power (increased uncertainty). Rarefying also adds artificial uncertainty through the random subsampling step, such that <xref ref-type="fig" rid="pcbi-1003531-g001">Figure 1</xref> shows the best-case, achieved only with a sufficient number of <italic>repeated</italic> rarefying trials (See <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>, minimal example). In this sense alone, the random step in rarefying is unnecessary. Each count value could be transformed to a <italic>common-scale</italic> by rounding <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e010" xlink:type="simple"/></inline-formula>. Although this common-scale approach is an improvement over the rarefying method here defined, both methods suffer from the same problems related to lost data.</p>
</sec></sec><sec id="s3" sec-type="methods">
<title>Methods</title>
<p>In order to quantify the relative statistical costs of rarefying, and to illustrate the relative benefits of an appropriate mixture model, we created two microbiome simulation workflows based on repeated subsampling from empirical data. These workflows were organized according to <xref ref-type="fig" rid="pcbi-1003531-g002">Figure 2</xref>. Because the correct answer in every simulation is known, we were able to evaluate the resulting power and accuracy of each statistical method, and thus quantify the improvements one method provided over another under a given set of conditions. In both simulation types we varied the library size and effect size across a range of values that are relevant for recently-published microbiome investigations, and followed with commonly used statistical analyses from the microbiome and/or RNA-Seq literature.</p>
<fig id="pcbi-1003531-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003531.g002</object-id><label>Figure 2</label><caption>
<title>Graphical summary of the two simulation frameworks.</title>
<p>Both <italic>Simulation A</italic> (clustering) and <italic>Simulation B</italic> (differential abundance) are represented. All simulations begin with real microbiome count data from a survey experiment referred to here as “the Global Patterns dataset” <xref ref-type="bibr" rid="pcbi.1003531-Caporaso2">[48]</xref>. Tables of integers with multiple columns represent an abundance count matrix (“OTU table”), while a single-column of integers represents a multinomial of OTU counts/proportions. In both simulation illustrations an <italic>effect size</italic> is explained and given an example value of 10 for easy mental computation, but its meaning is different for each simulation. Note that <italic>effect size</italic> is altogether different than <italic>library size</italic>, the latter being equivalent to both the column sums and the number of reads per sample. A grey highlight indicates count values for which an effect has been applied in <italic>Simulation B</italic>. <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref> includes the complete source code used to compute the example values shown here, as well as the full simulations discussed below.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003531.g002" position="float" xlink:type="simple"/></fig><sec id="s3a">
<title>Simulation A</title>
<p>Simulation A is a simple example of a descriptive experiment in which the main goal is to distinguish patterns of relationships between whole microbiome samples through normalization followed by the calculation of sample-wise distances. Many early microbiome investigations are variants of Simulation A, and also used rarefying prior to calculating UniFrac distances <xref ref-type="bibr" rid="pcbi.1003531-Hamady2">[27]</xref>. Microbiome studies often graphically represent the results of their pairwise sample distances using multidimensional scaling <xref ref-type="bibr" rid="pcbi.1003531-Gower1">[42]</xref> (also called <italic>Principal Coordinate Analysis</italic>, PCoA), which is useful if the desired effects are clearly evident among the first two or three ordination axes. In some cases, formal testing of sample covariates is also done using a permutation MANOVA (e.g. <monospace>vegan::adonis</monospace> in R <xref ref-type="bibr" rid="pcbi.1003531-Oksanen1">[43]</xref>) with the (squared) distances and covariates as response and linear predictors, respectively <xref ref-type="bibr" rid="pcbi.1003531-Anderson1">[44]</xref>. However, in this case we are not interested in creating summary graphics or testing the explanatory power of sample covariates, but rather we are interested in precisely evaluating the relative discriminating capability of each combination of normalization method and distance measure. We will use clustering results as a quantitative proxy for the broad spectrum of approaches taken to interpret microbiome sample distances.</p>
<sec id="s3a1">
<title>Normalizations in Simulation A</title>
<p>For each simulated experiment we used the following normalization methods prior to calculating sample-wise distances.</p>
<list list-type="order"><list-item>
<p><bold>DESeqVS</bold>. Variance Stabilization implemented in the DESeq package <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref>.</p>
</list-item><list-item>
<p><bold>None</bold>. Counts not transformed. Differences in total library size could affect the values of some distance metrics.</p>
</list-item><list-item>
<p><bold>Proportion</bold>. Counts are divided by total library size.</p>
</list-item><list-item>
<p><bold>Rarefy</bold>. Rarefying is performed as defined in the introduction, using rarefy_even_depth implemented in the phyloseq package <xref ref-type="bibr" rid="pcbi.1003531-McMurdie1">[32]</xref>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e011" xlink:type="simple"/></inline-formula> set to the 15<italic><sup>th</sup></italic>-percentile of library sizes within each simulated experiment.</p>
</list-item><list-item>
<p><bold>UQ-logFC</bold>. The <italic>Upper-Quartile Log-Fold Change</italic> normalization implemented in the edgeR package <xref ref-type="bibr" rid="pcbi.1003531-Robinson2">[41]</xref>, coupled with the <italic>top-MSD</italic> distance (see below).</p>
</list-item></list>
</sec><sec id="s3a2">
<title>Distances in Simulation A</title>
<p>For each of the previous normalizations we calculated sample-wise distance/dissimilarity matrices using the following methods, if applicable.</p>
<list list-type="order"><list-item>
<p><bold>Bray-Curtis</bold>. The Bray-Curtis dissimilarity first defined in 1957 for forest ecology <xref ref-type="bibr" rid="pcbi.1003531-Bray1">[45]</xref>.</p>
</list-item><list-item>
<p><bold>Euclidean</bold>. The euclidean distance treating each OTU as a dimension. This has the form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e012" xlink:type="simple"/></inline-formula>, for the distance between samples 1 and 2, with <italic>K</italic> and <italic>i</italic> as defined in the <xref ref-type="sec" rid="s2">Introduction</xref> and <italic>n</italic> the number of distinct OTUs.</p>
</list-item><list-item>
<p><bold>PoissonDist</bold>. Our abbreviation of PoissonDistance, a sample-wise distance implemented in the PoiClaClu package <xref ref-type="bibr" rid="pcbi.1003531-Witten1">[46]</xref>.</p>
</list-item><list-item>
<p><bold>top-MSD</bold>. The mean squared difference of top OTUs, as implemented in edgeR <xref ref-type="bibr" rid="pcbi.1003531-Robinson2">[41]</xref>.</p>
</list-item><list-item>
<p><bold>UniFrac-u</bold>. The Unweighted UniFrac distance <xref ref-type="bibr" rid="pcbi.1003531-Lozupone1">[23]</xref>.</p>
</list-item><list-item>
<p><bold>UniFrac-w</bold>. The Weighted UniFrac distance <xref ref-type="bibr" rid="pcbi.1003531-Lozupone3">[47]</xref>.</p>
</list-item></list>
<p>In order to consistently evaluate performance in this regard, we generated microbiome counts by sampling from two different multinomials that were based on either the <italic>Ocean</italic> or <italic>Feces</italic> microbiomes of the <italic>Global Patterns</italic> empirical dataset <xref ref-type="bibr" rid="pcbi.1003531-Caporaso2">[48]</xref>. An equal number of simulated microbiome samples was generated from each multinomial for each simulated experiment. The <italic>Ocean</italic> and <italic>Feces</italic> sample classes were chosen because they have negligible overlapping OTUs, and mixing them by a defined proportion allows arbitrary control over the difficulty of the subsequent sample clustering task from trivial (no mixing) to impossible (both multinomials evenly mixed). See <xref ref-type="fig" rid="pcbi-1003531-g002">Figure 2</xref> for a simplified example of a single simulated experiment, generated using a small subset of the empirical data with corresponding simplified code provided in the <italic>simulation-design</italic> section of <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>.</p>
<p>Clustering was performed independently for each combination of simulated experiment, normalization method, and distance measure using partitioning around medoids (PAM <xref ref-type="bibr" rid="pcbi.1003531-Kaufman1">[49]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Reynolds1">[50]</xref>, an alternative to k-means that is considered more robust) with the number of clusters fixed at two. The accuracy in the clustering results was defined as the fraction of simulated samples correctly clustered; with the worst possible accuracy being 50% if all samples are clustered. Note that the rarefying procedure omits samples, so its accuracy can be below 50% under this definition. Alternative clustering methods, hierarchical clustering and k-means, were also performed and their results are included in <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>.</p>
<p>The number of samples (40) to include for each template in Simulation A was chosen arbitrarily after some exploration of preliminary simulations. It was apparent that the classification results from Simulation A were most informative when we included enough samples per simulated experiment to achieve stable results, but not so many that it was experimentally unrealistic and prohibitively slow to compute. Conversely, preliminary trials of Simulation A that included only a few samples per experiment resulted in a large variance on each performance measure that was difficult to interpret.</p>
</sec></sec><sec id="s3b">
<title>Simulation B</title>
<p>Simulation B is a simple example of microbiome experiments in which the goal is to detect microbes that are differentially abundant between two pre-determined classes of samples. This experimental design appears in many clinical settings (health/disease, target/control, etc.), and other settings for which there is sufficient <italic>a priori</italic> knowledge about the microbiological conditions, and we want to enumerate the OTUs that are different between these microbiomes, along with a measure of confidence that the proportions differ. For this form of analysis, the microbiome counts for each simulated experiment are generated by sampling from a single multinomial derived from the OTU proportions observed in one environment of the Global Patterns dataset. To create an effect, the simulated samples of an experiment were divided into two equally-sized classes, test and null, and a perturbation was applied (multiplication by a defined value) to the count values of a random subset of OTUs in the test class only. See part B of <xref ref-type="fig" rid="pcbi-1003531-g002">Figure 2</xref> for a simple example. Each of the randomly perturbed OTUs is differentially abundant between the classes, and the performance of downstream tests can be evaluated on how well these OTUs are detected without falsely selecting OTUs for which no perturbation occurred (false positives). False negatives are perturbed OTUs that went undetected. This approach for generating simulated experiments with a defined effect size (in the form of multiplicative factor) was repeated for each combination of median library size, number of samples per class, and the nine microbial environments included in the Global Patterns dataset. Each simulated experiment was subjected to various approaches for normalization/noise-modeling and differential abundance testing.</p>
<sec id="s3b1">
<title>Normalization/Modeling in Simulation B</title>
<p>For each simulated experiment, we used the following normalization/modeling methods prior to testing for differential abundance.</p>
<list list-type="order"><list-item>
<p><bold>Model/None</bold>. A parametric model was applied to the data, or, in the case of the t-test, no normalization was applied (note: the t-test without normalization can only work with a high degree of balance between classes, and is provided here for comparison but is not recommended in general).</p>
</list-item><list-item>
<p><bold>Rarefied</bold>. Rarefying is performed as defined in the introduction, using rarefy_even_depth implemented in the phyloseq package <xref ref-type="bibr" rid="pcbi.1003531-McMurdie1">[32]</xref>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e013" xlink:type="simple"/></inline-formula> set to the 15<italic><sup>th</sup></italic>-percentile of library sizes within each simulated experiment.</p>
</list-item><list-item>
<p><bold>Proportion</bold>. Counts are divided by total library size.</p>
</list-item></list>
</sec><sec id="s3b2">
<title>Testing in Simulation B</title>
<p>For each OTU of each simulated experiment we used the following to test for differential abundance.</p>
<list list-type="order"><list-item>
<p><bold>two sided Welch t-test</bold>. A two-sided t-test with unequal variances, using the mt wrapper in phyloseq <xref ref-type="bibr" rid="pcbi.1003531-McMurdie1">[32]</xref> of the mt.maxT method in the multtest package <xref ref-type="bibr" rid="pcbi.1003531-Pollard1">[51]</xref>.</p>
</list-item><list-item>
<p><bold>edgeR - exactTest</bold>. An exact binomial test (see base R's stats::binom.test) generalized for overdispersed counts <xref ref-type="bibr" rid="pcbi.1003531-Robinson1">[11]</xref> and implemented in the exactTest method of the edgeR package <xref ref-type="bibr" rid="pcbi.1003531-Robinson2">[41]</xref>.</p>
</list-item><list-item>
<p><bold>DESeq - nbinomTest</bold>. A Negative Binomial conditioned test similar to the edgeR test above, implemented in the nbinomTest method of the DESeq package <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref>. See the subsection <italic>Testing for differential expression</italic> in Anders and Huber, 2010 <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref> for the precise definition.</p>
</list-item><list-item>
<p><bold>DESeq2 - nbinomWaldTest</bold>. A Negative Binomial Wald Test using standard maximum likelihood estimates for GLM coefficients assuming a zero-mean normal prior distribution, implemented in the nbinomWaldTest method of the DESeq2 package.</p>
</list-item><list-item>
<p><bold>metagenomeSeq - fitZig</bold>. An Expectation-Maximization estimate of the posterior probabilities of differential abundance based on a <italic>Zero Inflated Gaussian</italic> model, implemented in the fitZig method of the metagenomeSeq package <xref ref-type="bibr" rid="pcbi.1003531-Paulson1">[40]</xref>.</p>
</list-item></list>
<p>All tests were corrected for multiple inferences using the Benjamini-Hochberg method to control the False Discovery Rate <xref ref-type="bibr" rid="pcbi.1003531-Benjamini1">[52]</xref>. Please note that in the context of these simulations <italic>library size</italic> is altogether different from <italic>effect size</italic>; the former being equivalent to both the column sums and the number of reads per sample. The library sizes for both categories of simulation were randomly sampled from the original distribution of library sizes in the Global Patterns dataset, and then scaled according to the prescribed median library size of each simulated experiment.</p>
<p>We have included in <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref> the complete source code for computing the survey, simulations, normalizations, and performance assessments described in this article. This includes the code to acquire publicly available data via the phyloseq interface to the microbio.me/qiime server, a function called microbio_me_qiime <xref ref-type="bibr" rid="pcbi.1003531-McMurdie1">[32]</xref>. Where applicable, this code includes the RNG seed so that the simulations and random resampling procedures can be reproduced <italic>exactly</italic>. Interested investigators can inspect and modify this code, change the random seed and other parameters, and observe the results (including figures). For ease of inspection, we have authored the source code in <italic>R flavored markdown</italic> <xref ref-type="bibr" rid="pcbi.1003531-Allaire1">[53]</xref>, through which we have generated HTML5 files for each simulation that include our extensive comments interleaved with code, results, and both intermediate and final figures. Our simulation output can be optionally-modified and re-executed using the the <monospace>knit2html</monospace> function in the knitr package. This function will take the location of the simulation source files as input, evaluate its R code in sequence, generate graphics and markdown, and produce the complete HTML5 output file that can be viewed in any modern web browser. These simulations, analyses, and graphics rely upon the cluster <xref ref-type="bibr" rid="pcbi.1003531-Maechler1">[54]</xref>, foreach <xref ref-type="bibr" rid="pcbi.1003531-Revolution1">[55]</xref>, ggplot2 <xref ref-type="bibr" rid="pcbi.1003531-Wickham1">[56]</xref>, metagenomeSeq <xref ref-type="bibr" rid="pcbi.1003531-Paulson1">[40]</xref>, phyloseq <xref ref-type="bibr" rid="pcbi.1003531-McMurdie1">[32]</xref>, plyr <xref ref-type="bibr" rid="pcbi.1003531-Wickham2">[57]</xref>, reshape2 <xref ref-type="bibr" rid="pcbi.1003531-Wickham3">[58]</xref>, and ROCR <xref ref-type="bibr" rid="pcbi.1003531-Sing1">[59]</xref> R packages; in addition to the DESeq(2) <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref>, edgeR <xref ref-type="bibr" rid="pcbi.1003531-Robinson2">[41]</xref>, and PoiClaClu <xref ref-type="bibr" rid="pcbi.1003531-Witten1">[46]</xref> R packages for RNA-Seq data, and tools available in the standard R distribution <xref ref-type="bibr" rid="pcbi.1003531-R1">[60]</xref>. The Global Patterns <xref ref-type="bibr" rid="pcbi.1003531-Caporaso2">[48]</xref> dataset included in phyloseq was used as empirical microbiome template data for simulations.</p>
</sec></sec></sec><sec id="s4">
<title>Results/Discussion</title>
<p>We surveyed various publicly available microbiome count data to evaluate the variance-mean relationship for OTUs among sets of biological replicates, a few examples of which are shown here (<xref ref-type="fig" rid="pcbi-1003531-g003">Figure 3</xref>). In every instance the variances were larger than could be expected under a Poisson model (overdispersed, <italic>φ</italic>&gt;0), especially at larger values of the common-scale mean. By definition, these OTUs are the most abundant, and receive the greatest interest in many studies. For rarefied counts the absolute scales are decreased and there are many fewer OTUs that pass filtering, but overdispersion is present in both cases and follows a clear sample-wide trend. See the <italic>dispersion-survey</italic> section of <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref> for additional examples of overdispersed microbiome counts. The consistent (though non-linear) relationship between variance and mean indicates that parameters of a NB model, especially <italic>φ<sub>i</sub></italic>, can be adequately estimated among biological replicates of microbiome data, despite a previous weak assertion to the contrary <xref ref-type="bibr" rid="pcbi.1003531-White1">[39]</xref>.</p>
<fig id="pcbi-1003531-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003531.g003</object-id><label>Figure 3</label><caption>
<title>Examples of overdispersion in microbiome data.</title>
<p>Common-Scale Variance versus Mean for Microbiome Data. Each point in each panel represents a different OTU's mean/variance estimate for a biological replicate and study. The data in this figure come from the <italic>Global Patterns</italic> survey <xref ref-type="bibr" rid="pcbi.1003531-Caporaso2">[48]</xref> and the <italic>Long-Term Dietary Patterns</italic> study <xref ref-type="bibr" rid="pcbi.1003531-Wu1">[75]</xref>, with results from additional studies included in <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>. (Right) Variance versus mean abundance for rarefied counts. (Left) Common-scale variances and common-scale means, estimated according to Equations 6 and 7 from Anders and Huber <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref>, implemented in the DESeq package (<xref ref-type="supplementary-material" rid="pcbi.1003531.s002">Text S1</xref>). The dashed gray line denotes the <italic>σ</italic><sup>2</sup> = <italic>μ</italic> case (Poisson; <italic>φ</italic> = 0). The cyan curve denotes the fitted variance estimate using DESeq <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref>, with method = ‘pooled’, sharingMode = ‘fit-only’, fitType = ‘local’.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003531.g003" position="float" xlink:type="simple"/></fig>
<p>In simulations evaluating clustering accuracy, we found that rarefying undermined the performance of downstream clustering methods. This was the result of omitted read counts, added noise from the random sampling step in rarefying, as well as omitted microbiome samples with small library sizes that were accurately clustered by alternative procedures on the same simulated data (<xref ref-type="fig" rid="pcbi-1003531-g004">Figure 4</xref>). The extent to which the rarefying procedure performed worse depended on the effect-size (ease of clustering), as well as the typical library size of the samples in the simulation and the choice of threshold for the minimum library size (<xref ref-type="fig" rid="pcbi-1003531-g005">Figure 5</xref>). We also evaluated the performance of alternative clustering methods, k-means and hierarchical clustering, on the same tasks and found similar overall results (<xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>).</p>
<fig id="pcbi-1003531-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003531.g004</object-id><label>Figure 4</label><caption>
<title>Clustering accuracy in simulated two-class mixing.</title>
<p><italic>Partitioning around medoids</italic> <xref ref-type="bibr" rid="pcbi.1003531-Kaufman1">[49]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Reynolds1">[50]</xref> clustering accuracy (vertical axis) that results following different normalization and distance methods. Points denote the mean values of replicates, with a vertical bar representing one standard deviation above and below. Normalization method is indicated by both shade and shape, while panel columns and panel rows indicate the distance metric and median library size (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e014" xlink:type="simple"/></inline-formula>), respectively. The horizontal axis is the effect size, which in this context is the ratio of target to non-target values in the multinomials that were used to simulate microbiome counts. Each multinomial is derived from two microbiomes that have negligible overlapping OTUs (Fecal and Ocean microbiomes in the Global Patterns dataset <xref ref-type="bibr" rid="pcbi.1003531-Caporaso2">[48]</xref>). Higher values of effect size indicate an easier clustering task. For simulation details and precise definitions of abbreviations see <italic>Simulation A</italic> of the <xref ref-type="sec" rid="s3">Methods</xref> section.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003531.g004" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003531-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003531.g005</object-id><label>Figure 5</label><caption>
<title>Normalization by rarefying only, dependency on library size threshold.</title>
<p>Unlike the analytical methods represented in <xref ref-type="fig" rid="pcbi-1003531-g004">Figure 4</xref>, here rarefying is the only normalization method used, but at varying values of the minimum library size threshold, shown as library-size quantile (horizontal axis). Panel columns, panel rows, and point/line shading indicate effect size (ES), median library size (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e015" xlink:type="simple"/></inline-formula>), and distance method applied after rarefying, respectively. Because discarded samples cannot be accurately clustered, the line <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e016" xlink:type="simple"/></inline-formula> is the maximum achievable accuracy.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003531.g005" position="float" xlink:type="simple"/></fig>
<p>In additional rarefying simulations we investigated the dependency of clustering performance on the choice of minimum library threshold, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e017" xlink:type="simple"/></inline-formula>. We found that samples were trivial to cluster for the largest library sizes using most distance methods, even with the threshold set to the smallest library in the simulation (no samples discarded, all correctly clustered). However, at more modest library sizes typical of highly-parallel experimental designs the optimum choice of size threshold is less clear. A small threshold implies retaining more samples but with a smaller number of reads (less information) per sample; whereas a larger threshold implies more discarded samples, but with larger libraries for the samples that remain. In our simulations the optimum choice of threshold hovered around the 15<italic><sup>th</sup></italic>-percentile of library sizes for most simulations and normalization/distance procedures (<xref ref-type="fig" rid="pcbi-1003531-g005">Figure 5</xref>), but this value is not generalizable to other data. Regions within <xref ref-type="fig" rid="pcbi-1003531-g005">Figure 5</xref> in which all distances have converged to the same line (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e018" xlink:type="simple"/></inline-formula>) are regions for which the minimum library threshold completely controls clustering accuracy (all samples not discarded are accurately clustered). Regions to the left of this convergence indicate a compromise between discarding fewer samples and retaining enough counts per sample for accurate clustering.</p>
<p>In simulations evaluating performance in the detection of differential abundance, we found an improvement in sensitivity and specificity when normalization and subsequent tests are based upon a relevant mixture model (<xref ref-type="fig" rid="pcbi-1003531-g006">Figure 6</xref>). Multiple t-tests with correction for multiple inference did not perform well on this data, whether on rarefied counts or on proportions. A direct comparison of the performance of more sophisticated parametric methods applied to both original and rarefied counts demonstrates the strong potential of these methods and large improvements in sensitivity and specificity if rarefying is not used at all.</p>
<fig id="pcbi-1003531-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003531.g006</object-id><label>Figure 6</label><caption>
<title>Performance of differential abundance detection with and without rarefying.</title>
<p>Performance summarized here by the “Area Under the Curve” (AUC) metric of a Receiver Operator Curve (ROC) <xref ref-type="bibr" rid="pcbi.1003531-Sing1">[59]</xref> (vertical axis). Briefly, the AUC value varies from 0.5 (random) to 1.0 (perfect), incorporating both sensitivity and specificity. The horizontal axis indicates the effect size, shown as the actual multiplication factor applied to OTU counts in the test class to simulate a differential abundance. Each curve traces the respective normalization method's mean performance of that panel, with a vertical bar indicating a standard deviation in performance across all replicates and microbiome templates. The right-hand side of the panel rows indicates the median library size, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e019" xlink:type="simple"/></inline-formula>, while the darkness of line shading indicates the number of samples per simulated experiment. Color shade and shape indicate the normalization method. See <xref ref-type="sec" rid="s3">Methods</xref> section for the definitions of each normalization and testing method. For all methods, detection among multiple tests was defined using a False Discovery Rate (Benjamini-Hochberg <xref ref-type="bibr" rid="pcbi.1003531-Benjamini1">[52]</xref>) significance threshold of 0.05.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003531.g006" position="float" xlink:type="simple"/></fig>
<p>In general, the rate of false positives from tests based on proportions or rarefied counts was unacceptably high, and increased with the effect size. This is an undesirable phenomenon in which the increased relative abundance of the true-positive OTUs (the effect) is large enough that the null (unmodified) OTUs appear significantly more abundant in the null samples than in the test samples. This explanation is easily verified by the sign of the test statistics of the false positive OTU abundances, which was uniformly positive (<xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>). Importantly, this <italic>side-effect</italic> of a strong differential abundance was observed rarely in edgeR performance results under TMM normalization (not shown) but not with RLE normalization (shown), and was similarly absent in DESeq(2) results. The false positive rate for edgeR and DESeq(2) was near zero under most conditions, with no obvious correlation between false positive rate and effect size. Although rarefied counts and proportions both performed relatively poorly, count proportions outperformed rarefied counts in most simulations due to better sensitivity, but also suffered from a higher rate of false positives at larger values of effect size (<xref ref-type="fig" rid="pcbi-1003531-g006">Figure 6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>).</p>
<p>The rarefying normalization procedure was associated with performance costs in both sample-clustering and differential abundance statistical evaluations, enumerated in the following.</p>
<list list-type="order"><list-item>
<p>Rarefied counts represent only a small fraction of the original data, implying an increase in Type-II error – often referred to as <italic>a loss of power</italic> or <italic>decreased sensitivity</italic> (<xref ref-type="fig" rid="pcbi-1003531-g001">Figure 1</xref>). In sample-wise comparisons, this lost power is evident through two separate phenomena, (1) samples that cannot be classified because they were discarded, (2) samples that are poorly distinguishable because of the discarded fraction of the original library (<xref ref-type="fig" rid="pcbi-1003531-g005">Figure 5</xref>). Differential abundance analyses that include moderate to rare OTUs are even more sensitive to this loss of power, where rarefied counts perform worse in every analysis method we attempted (<xref ref-type="fig" rid="pcbi-1003531-g006">Figure 6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>).</p>
</list-item><list-item>
<p>Rarefied counts remain overdispersed relative to a Poisson model, implying an increase in Type-I error (decreased specificity). Overdispersion is theoretically expected for counts of this nature, and we unambiguously detected overdispersion in our survey of publicly available microbiome counts (<xref ref-type="fig" rid="pcbi-1003531-g003">Figure 3</xref>). Estimating overdispersion is also more difficult after rarefying because of the lost information (<xref ref-type="fig" rid="pcbi-1003531-g006">Figure 6</xref>). In our simulations, Type-I error was much worse for rarefied counts than original counts (<xref ref-type="fig" rid="pcbi-1003531-g006">Figure 6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>).</p>
</list-item><list-item>
<p>Rarefying counts requires an arbitrary selection of a library size minimum threshold that affects downstream inference (<xref ref-type="fig" rid="pcbi-1003531-g005">Figure 5</xref>), but for which an optimal value cannot be known for new empirical data <xref ref-type="bibr" rid="pcbi.1003531-NavasMolina1">[17]</xref>.</p>
</list-item><list-item>
<p>The random step in rarefying is unnecessary and adds artificial uncertainty (<xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>, minimal example, bottom). A superior transformation (though still inadmissible) is to instead round the expected value of each count at the new smaller library size, that is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003531.e020" xlink:type="simple"/></inline-formula>, avoiding the additional sampling error as well as the need to repeat the random step <xref ref-type="bibr" rid="pcbi.1003531-Lozupone2">[24]</xref> and publish the random seed/process.</p>
</list-item></list>
<p>Due to these demonstrated limitations and proven sub-optimality, we advocate that <bold>rarefying should not be used</bold>. In special cases the costs listed above may be acceptable for sample-comparison experiments in which the effect-size(s) and the original library sizes are large enough to withstand the loss of data. Many early descriptive studies fall into this category – for example comparing functionally distinct human body sites or environments <xref ref-type="bibr" rid="pcbi.1003531-Caporaso2">[48]</xref> – and the ability to accurately distinguish those vastly-different microbiome samples is not in question, even with rarefied counts. However, for new empirical data the effect size(s) are unknown and may be subtle; and consequently, rarefying may undermine downstream analyses.</p>
<p>In the case of differential abundance detection, it seems unlikely that the cost of rarefying is ever acceptable. In our simulations, both rarefied counts and sample proportions resulted in an unacceptably high rate of false positive OTUs. As we described theoretically in the introduction, this is explained by differences among biological replicates that manifest as overdispersion, leading to a subsequent underestimate of the true variance if a relevant mixture model is not used. We detected overdispersion among biological replicates in all publicly available microbiome count datasets that we surveyed (<xref ref-type="fig" rid="pcbi-1003531-g003">Figure 3</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>). Failure to account for this overdispersion – by using proportions or rarefied counts – results in a systematic bias that increases the Type-I error rate even after correcting for multiple-hypotheses (<italic>e.g.</italic> Benjamini-Hochberg <xref ref-type="bibr" rid="pcbi.1003531-Benjamini1">[52]</xref>). In other words, if overdispersion has not been addressed, we predict many of the reported differentially abundant OTUs are false positives attributable to an underestimate of uncertainty.</p>
<p>In our simulations this propensity for Type-I error <italic>increased</italic> with the effect size, <italic>e.g.</italic> the fold-change in OTU abundance among the true-positive OTUs. For rarefied counts, we also detected a simultaneous increase in Type-II error attributable to the forfeited data. It may be tempting to imagine that the increased variance estimate due to rarefying could be counterbalanced by the variance underestimate that results from omitting a relevant mixture model. However, such a scenario constitutes an unlikely special case, and false positives will not compensate for the false negatives in general. In our simulations both Type-I and Type-II error increased for rarefied counts (<xref ref-type="fig" rid="pcbi-1003531-g006">Figure 6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>).</p>
<p>Fortunately, we have demonstrated that strongly-performing alternative methods for normalization and inference are already available. In particular, an analysis that models counts with the Negative Binomial – as implemented in DESeq2 <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref> or in edgeR <xref ref-type="bibr" rid="pcbi.1003531-Robinson2">[41]</xref> with RLE normalization – was able to accurately and specifically detect differential abundance over the full range of effect sizes, replicate numbers, and library sizes that we simulated (<xref ref-type="fig" rid="pcbi-1003531-g006">Figure 6</xref>). DESeq-based analyses are routinely applied to more complex tests and experimental designs using the generalized linear model interface in R <xref ref-type="bibr" rid="pcbi.1003531-Hastie1">[61]</xref>, and so are not limited to a simple two-class design. We also verified an improvement in differential abundance performance over rarefied counts or proportions by using an alternative mixture model based on the zero-inflated Gaussian, as implemented in the metagenomeSeq package <xref ref-type="bibr" rid="pcbi.1003531-Paulson1">[40]</xref>. However, we did not find that metagenomeSeq's AUC values were uniformly highest, as Negative Binomial methods had higher AUC values when biological replicate samples were low. Furthermore, while metagenomeSeq's AUC values were marginally higher than Negative Binomial methods at larger numbers of biological replicates, this was generally accompanied with a much higher rate of false positives (<xref ref-type="fig" rid="pcbi-1003531-g006">Figure 6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>).</p>
<p>Based on our simulation results and the widely enjoyed success for highly similar RNA-Seq data, we recommend using DESeq2 or edgeR to perform analysis of differential abundance in microbiome experiments. It should be noted that we did not comprehensively explore all available RNA-Seq analysis methods, which is an active area of research. Comparisons of many of these methods on empirical <xref ref-type="bibr" rid="pcbi.1003531-Nookaew1">[62]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Bullard1">[63]</xref> and simulated <xref ref-type="bibr" rid="pcbi.1003531-Yu1">[14]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Sun1">[64]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Soneson1">[65]</xref> data find consistently effective performance for detection of differential expression. One minor exception is an increased Type-I error for edgeR compared to later methods <xref ref-type="bibr" rid="pcbi.1003531-Nookaew1">[62]</xref>, which was also detected in our results relative to DESeq and DESeq2 when TMM normalization was used (not shown) – but not after switching to RLE normalization (<xref ref-type="fig" rid="pcbi-1003531-g006">Figure 6</xref>, <xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>). Generally speaking, the reported performance improvements between these methods are incremental relative to the large gains attributable to applying a relevant mixture model of the noise with shared-strength across OTUs. However, some of these alternatives from the RNA-Seq community may outperform DESeq2 on microbiome data meeting special conditions, for example a large proportion of true positives and sufficient replicates <xref ref-type="bibr" rid="pcbi.1003531-Hardcastle1">[66]</xref>, small sample sizes <xref ref-type="bibr" rid="pcbi.1003531-Yu1">[14]</xref>, or extreme values <xref ref-type="bibr" rid="pcbi.1003531-Ozer1">[67]</xref>.</p>
<p>Although we did not explore the topic in the simulations here described, a procedure for further improving differential expression detection performance, called <italic>Independent Filtering</italic> <xref ref-type="bibr" rid="pcbi.1003531-Bourgon1">[68]</xref>, also applies to microbial differential abundance. Some heuristics for filtering low-abundance OTUs are already described in the documentation of various microbiome analysis workflows <xref ref-type="bibr" rid="pcbi.1003531-Caporaso1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Schloss1">[30]</xref>, and in many cases these can be classified as forms of Independent Filtering. More effort is needed to optimize Independent Filtering for differential abundance detection, and rigorously define the theoretical basis and heuristics applicable to microbiome data. Ideally a formal application of Independent Filtering of OTUs would replace many of the current <italic>ad hoc</italic> approaches that often include poor reproducibility, poor justification, and the opportunity to introduce bias.</p>
<p>Some of the justification for the rarefying procedure has originated from exploratory sample-wise comparisons of microbiomes for which it was observed that a larger library size also results in additional observations of rare species, leading to a library size dependent increase in estimates of both alpha- and beta-diversity <xref ref-type="bibr" rid="pcbi.1003531-Lozupone2">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Chao1">[69]</xref>, especially UniFrac <xref ref-type="bibr" rid="pcbi.1003531-Schloss2">[70]</xref>. It should be emphasized that this represents a failure of the implementation of these methods to properly account for rare species and not evidence that diversity depends on library size. Rarefying is far from the optimal method for addressing rare species, even when analysis is restricted solely to sample-wise comparisons. As we demonstrate here, it is more data-efficient to model the noise and address extra species using statistical normalization methods based on variance stabilization and robustification/filtering. Though beyond the scope of this work, a Bayesian approach to species abundance estimation would allow the inclusion of pseudo-counts from a Dirichlet prior that should also substantially increase robustness to rare species.</p>
<p>Our results have substantial implications for past and future microbiome analyses, particularly regarding the interpretation of differential abundance. Most microbiome studies utilizing high-throughput DNA sequencing to acquire culture-independent counts of species/OTUs have used either proportions or rarefied counts to address widely varying library sizes. Left alone, both of these approaches suffer from a failure to address overdispersion among biological replicates, with rarefied counts also suffering from a loss of power, and proportions failing to account for heteroscedasticity. Previous reports of differential abundance based on rarefied counts or proportions bear a strong risk of bias toward false positives, and may warrant re-evaluation. Current and future investigations into microbial differential abundance should instead model uncertainty using a hierarchical mixture, such as the Poisson-Gamma or Binomial-Beta models, and normalization should be done using the relevant variance-stabilizing transformations. This can easily be put into practice using powerful implementations in R, like DESeq2 and edgeR, that performed well on our simulated microbiome data. We have provided wrappers for edgeR, DESeq, DESeq2, and metagenomeSeq that are tailored for microbiome count data and can take common microbiome file formats through the relevant interfaces in the phyloseq package <xref ref-type="bibr" rid="pcbi.1003531-McMurdie1">[32]</xref>. These wrappers are included with the complete code and documentation necessary to exactly reproduce the simulations, analyses, surveys, and examples shown here, including all figures (<xref ref-type="supplementary-material" rid="pcbi.1003531.s001">Protocol S1</xref>). This example of fully reproducible research can and should be applied to future publication of microbiome analyses <xref ref-type="bibr" rid="pcbi.1003531-Gentleman1">[71]</xref>–<xref ref-type="bibr" rid="pcbi.1003531-Donoho1">[73]</xref>.</p>
</sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003531.s001" mimetype="application/zip" xlink:href="info:doi/10.1371/journal.pcbi.1003531.s001" position="float" xlink:type="simple"><label>Protocol S1</label><caption>
<p><bold>A zip file containing all supplementary source files.</bold> This includes the Rmd source code, HTML output, and all related documentation and code to completely and exactly recreate every results figure in this article.</p>
<p>(ZIP)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003531.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003531.s002" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>A supplemental appendix of the statistical mathematics described in the article.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We would like to thank the developers of the open source packages leveraged here for improved insights into microbiome data, in particular Gordon Smyth and his group for edgeR <xref ref-type="bibr" rid="pcbi.1003531-Robinson2">[41]</xref>, to Mihai Pop and his team for metagenomeSeq <xref ref-type="bibr" rid="pcbi.1003531-Paulson1">[40]</xref> and Wolfgang Huber and his team for DESeq and DESeq2 <xref ref-type="bibr" rid="pcbi.1003531-Anders1">[13]</xref>; whose useful documentation and continued support have been invaluable. The Bioconductor and <italic>R</italic> teams <xref ref-type="bibr" rid="pcbi.1003531-R1">[60]</xref>, <xref ref-type="bibr" rid="pcbi.1003531-Gentleman2">[74]</xref> have provided valuable support for our development and release of code related to microbiome analysis in R. We would also like to thank Rob Knight, J. Gregory Caporaso, and the QIIME development team for QIIME <xref ref-type="bibr" rid="pcbi.1003531-Caporaso1">[29]</xref>, which has drastically decreased the time required to get from raw phylogenetic sequence data to OTU counts. Hadley Wickham created and continues to support the ggplot2 <xref ref-type="bibr" rid="pcbi.1003531-Wickham1">[56]</xref> and reshape <xref ref-type="bibr" rid="pcbi.1003531-Wickham3">[58]</xref> /plyr <xref ref-type="bibr" rid="pcbi.1003531-Wickham2">[57]</xref> packages that have proven useful for graphical representation and manipulation of data, respectively. RStudio and GitHub have provided immensely useful and free applications that were used in the respective development and versioning of the source code published with this manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003531-Shendure1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shendure</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Lieberman Aiden</surname><given-names>E</given-names></name> (<year>2012</year>) <article-title>The expanding scope of DNA sequencing</article-title>. <source>Nature Biotechnology</source> <volume>30</volume>: <fpage>1084</fpage>–<lpage>1094</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Shendure2"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shendure</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ji</surname><given-names>H</given-names></name> (<year>2008</year>) <article-title>Next-generation DNA sequencing</article-title>. <source>Nature Biotechnology</source> <volume>26</volume>: <fpage>1135</fpage>–<lpage>1145</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Mortazavi1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mortazavi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>BA</given-names></name>, <name name-style="western"><surname>McCue</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Schaeffer</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Wold</surname><given-names>B</given-names></name> (<year>2008</year>) <article-title>Mapping and quantifying mammalian transcriptomes by RNA-Seq</article-title>. <source>Nature Methods</source> <volume>5</volume>: <fpage>621</fpage>–<lpage>628</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Pace1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pace</surname><given-names>NR</given-names></name> (<year>1997</year>) <article-title>A molecular view of microbial diversity and the biosphere</article-title>. <source>Science</source> <volume>276</volume>: <fpage>734</fpage>–<lpage>740</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Wilson1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wilson</surname><given-names>KH</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>WJ</given-names></name>, <name name-style="western"><surname>Radosevich</surname><given-names>JL</given-names></name>, <name name-style="western"><surname>DeSantis</surname><given-names>TZ</given-names></name>, <name name-style="western"><surname>Viswanathan</surname><given-names>VS</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>High-Density Microarray of Small-Subunit Ribosomal DNA Probes</article-title>. <source>Appl Environ Microbiol</source> <volume>68</volume>: <fpage>2535</fpage>–<lpage>2541</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Huse1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huse</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Dethlefsen</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Welch</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Relman</surname><given-names>DA</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Exploring microbial diversity and taxonomy using SSU rRNA hypervariable tag sequencing</article-title>. <source>PLoS Genetics</source> <volume>4</volume>: <fpage>e1000255</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Riesenfeld1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Riesenfeld</surname><given-names>CS</given-names></name>, <name name-style="western"><surname>Schloss</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Handelsman</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>Metagenomics: genomic analysis of microbial communities</article-title>. <source>Annual Review of Genetics</source> <volume>38</volume>: <fpage>525</fpage>–<lpage>552</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Allison1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Allison</surname><given-names>DB</given-names></name>, <name name-style="western"><surname>Cui</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Page</surname><given-names>GP</given-names></name>, <name name-style="western"><surname>Sabripour</surname><given-names>M</given-names></name> (<year>2006</year>) <article-title>Microarray Data Analysis: from Disarray to Consolidation and Consensus</article-title>. <source>Nature Reviews Genetics</source> <volume>7</volume>: <fpage>55</fpage>–<lpage>65</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Marioni1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Marioni</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Mason</surname><given-names>CE</given-names></name>, <name name-style="western"><surname>Mane</surname><given-names>SM</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gilad</surname><given-names>Y</given-names></name> (<year>2008</year>) <article-title>RNA-Seq: an assessment of technical reproducibility and comparison with gene expression arrays</article-title>. <source>Genome Research</source> <volume>18</volume>: <fpage>1509</fpage>–<lpage>1517</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Lu1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lu</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Tomfohr</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Kepler</surname><given-names>TB</given-names></name> (<year>2005</year>) <article-title>Identifying differential expression in multiple SAGE libraries: an overdispersed log-linear model approach</article-title>. <source>BMC Bioinformatics</source> <volume>6</volume>: <fpage>165</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Robinson1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Smyth</surname><given-names>GK</given-names></name> (<year>2007</year>) <article-title>Small-sample estimation of negative binomial dispersion, with applications to SAGE data</article-title>. <source>Biostatistics (Oxford, England)</source> <volume>9</volume>: <fpage>321</fpage>–<lpage>332</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Cameron1"><label>12</label>
<mixed-citation publication-type="book" xlink:type="simple">Cameron AC, Trivedi P (2013) Regression analysis of count data, volume 53. Cambridge University Press.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Anders1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anders</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>W</given-names></name> (<year>2010</year>) <article-title>Differential expression analysis for sequence count data</article-title>. <source>Genome Biology</source> <volume>11</volume>: <fpage>R106</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Yu1"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yu</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Vitek</surname><given-names>O</given-names></name> (<year>2013</year>) <article-title>Shrinkage estimation of dispersion in Negative Binomial models for RNASeq experiments with small sample size</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>29</volume>: <fpage>1275</fpage>–<lpage>1282</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-DiBella1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Di Bella</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Bao</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Gloor</surname><given-names>GB</given-names></name>, <name name-style="western"><surname>Burton</surname><given-names>JP</given-names></name>, <name name-style="western"><surname>Reid</surname><given-names>G</given-names></name> (<year>2013</year>) <article-title>High throughput sequencing methods and analysis for microbiome research</article-title>. <source>Journal of Microbiological Methods</source> <volume>95</volume>: <fpage>401</fpage>–<lpage>414</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Segata1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segata</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Boernigen</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Tickle</surname><given-names>TL</given-names></name>, <name name-style="western"><surname>Morgan</surname><given-names>XC</given-names></name>, <name name-style="western"><surname>Garrett</surname><given-names>WS</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Computational meta'omics for microbial community studies</article-title>. <source>Molecular Systems Biology</source> <volume>9</volume>: <fpage>666</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-NavasMolina1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navas-Molina</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Peralta-Sánchez</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>González</surname><given-names>A</given-names></name>, <name name-style="western"><surname>McMurdie</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Vázquez-Baeza</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Advancing Our Understanding of the Human Microbiome Using QIIME</article-title>. <source>Methods in Enzymology</source> <volume>531</volume>: <fpage>371</fpage>–<lpage>444</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Hughes1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hughes</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Hellmann</surname><given-names>JJ</given-names></name> (<year>2005</year>) <article-title>The application of rarefaction techniques to molecular inventories of microbial diversity</article-title>. <source>Methods in Enzymology</source> <volume>397</volume>: <fpage>292</fpage>–<lpage>308</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Koren1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koren</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Knights</surname><given-names>D</given-names></name>, <name name-style="western"><surname>González</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Waldron</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Segata</surname><given-names>N</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>A guide to enterotypes across the human body: meta-analysis of microbial community structures in human microbiome datasets</article-title>. <source>PLoS Computational Biology</source> <volume>9</volume>: <fpage>e1002863</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Sanders1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sanders</surname><given-names>HL</given-names></name> (<year>1968</year>) <article-title>Marine benthic diversity: A comparative study</article-title>. <source>The American Naturalist</source> <volume>102</volume>: <fpage>243</fpage>–<lpage>282</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Gotelli1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gotelli</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Colwell</surname><given-names>RK</given-names></name> (<year>2001</year>) <article-title>Quantifying biodiversity: procedures and pitfalls in the measurement and comparison of species richness</article-title>. <source>Ecology Letters</source> <volume>4</volume>: <fpage>379</fpage>–<lpage>391</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Mao1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mao</surname><given-names>CX</given-names></name>, <name name-style="western"><surname>Colwell</surname><given-names>RK</given-names></name> (<year>2005</year>) <article-title>Estimation of Species Richness: Mixture Models, the Role of Rare Species, and Inferential Challenges</article-title>. <source>Ecology</source> <volume>86</volume>: <fpage>1143</fpage>–<lpage>1153</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Lozupone1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lozupone</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name> (<year>2005</year>) <article-title>UniFrac: a new phylogenetic method for comparing microbial communities</article-title>. <source>Applied and Environmental Microbiology</source> <volume>71</volume>: <fpage>8228</fpage>–<lpage>8235</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Lozupone2"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lozupone</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Lladser</surname><given-names>ME</given-names></name>, <name name-style="western"><surname>Knights</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Stombaugh</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name> (<year>2011</year>) <article-title>UniFrac: an effective distance metric for microbial community comparison</article-title>. <source>The ISME Journal</source> <volume>5</volume>: <fpage>169</fpage>–<lpage>172</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Hamady1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Walker</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Harris</surname><given-names>JK</given-names></name>, <name name-style="western"><surname>Gold</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Error-correcting barcoded primers for pyrosequencing hundreds of samples in multiplex</article-title>. <source>Nature Methods</source> <volume>5</volume>: <fpage>235</fpage>–<lpage>237</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Liu1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>DeSantis</surname><given-names>TZ</given-names></name>, <name name-style="western"><surname>Andersen</surname><given-names>GL</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name> (<year>2008</year>) <article-title>Accurate taxonomy assignments from 16S rRNA sequences produced by highly parallel pyrosequencers</article-title>. <source>Nucleic Acids Research</source> <volume>36</volume>: <fpage>e120</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Hamady2"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lozupone</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Fast UniFrac: facilitating high-throughput phylogenetic analyses of microbial communities including analysis of pyrosequencing and PhyloChip data</article-title>. <source>The ISME Journal</source> <volume>4</volume>: <fpage>17</fpage>–<lpage>27</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Yatsunenko1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yatsunenko</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Rey</surname><given-names>FE</given-names></name>, <name name-style="western"><surname>Manary</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Trehan</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Dominguez-Bello</surname><given-names>MG</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Human gut microbiome viewed across age and geography</article-title>. <source>Nature</source> <volume>486</volume>: <fpage>222</fpage>–<lpage>227</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Caporaso1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Caporaso</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Kuczynski</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Stombaugh</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Bittinger</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Bushman</surname><given-names>F</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>QIIME allows analysis of high-throughput community sequencing data</article-title>. <source>Nature Methods</source> <volume>7</volume>: <fpage>335</fpage>–<lpage>336</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Schloss1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schloss</surname><given-names>PD</given-names></name>, <name name-style="western"><surname>Westcott</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Ryabin</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hall</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Hartmann</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Introducing mothur: Open-Source, Platform-Independent, Community-Supported Software for Describing and Comparing Microbial Communities</article-title>. <source>Applied and Environmental Microbiology</source> <volume>75</volume>: <fpage>7537</fpage>–<lpage>7541</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Gilbert1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gilbert</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Field</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Swift</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Newbold</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Oliver</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>The seasonal structure of microbial communities in the Western English Channel</article-title>. <source>Environmental Microbiology</source> <volume>11</volume>: <fpage>3132</fpage>–<lpage>3139</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-McMurdie1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>McMurdie</surname><given-names>PJ</given-names></name>, <name name-style="western"><surname>Holmes</surname><given-names>S</given-names></name> (<year>2013</year>) <article-title>phyloseq: an R package for reproducible interactive analysis and graphics of microbiome census data</article-title>. <source>PLoS ONE</source> <volume>8</volume>: <fpage>e61217</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Charlson1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Charlson</surname><given-names>ES</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Custers-Allen</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Bittinger</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Disordered microbial communities in the upper respiratory tract of cigarette smokers</article-title>. <source>PLoS ONE</source> <volume>5</volume>: <fpage>e15216</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Price1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Price</surname><given-names>LB</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Johnson</surname><given-names>KE</given-names></name>, <name name-style="western"><surname>Aziz</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lau</surname><given-names>MK</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>The effects of circumcision on the penis microbiome</article-title>. <source>PLoS ONE</source> <volume>5</volume>: <fpage>e8422</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Kembel1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kembel</surname><given-names>SW</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Kline</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Northcutt</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Stenson</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Architectural design influences the diversity and structure of the built environment microbiome</article-title>. <source>The ISME Journal</source> <volume>6</volume>: <fpage>1469</fpage>–<lpage>1479</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Flores1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Flores</surname><given-names>GE</given-names></name>, <name name-style="western"><surname>Bates</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Caporaso</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Lauber</surname><given-names>CL</given-names></name>, <name name-style="western"><surname>Leff</surname><given-names>JW</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Diversity, distribution and sources of bacteria in residential kitchens</article-title>. <source>Environmental Microbiology</source> <volume>15</volume>: <fpage>588</fpage>–<lpage>596</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Kang1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kang</surname><given-names>DW</given-names></name>, <name name-style="western"><surname>Park</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Ilhan</surname><given-names>ZE</given-names></name>, <name name-style="western"><surname>Wallstrom</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Labaer</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Reduced incidence of Prevotella and other fermenters in intestinal microflora of autistic children</article-title>. <source>PLoS ONE</source> <volume>8</volume>: <fpage>e68322</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Segata2"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Segata</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Haake</surname><given-names>SK</given-names></name>, <name name-style="western"><surname>Mannon</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lemon</surname><given-names>KP</given-names></name>, <name name-style="western"><surname>Waldron</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Composition of the adult digestive tract bacterial microbiome based on seven mouth surfaces, tonsils, throat and stool samples</article-title>. <source>Genome Biology</source> <volume>13</volume>: <fpage>R42</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-White1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>White</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Nagarajan</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M</given-names></name> (<year>2009</year>) <article-title>Statistical methods for detecting differentially abundant features in clinical metagenomic samples</article-title>. <source>PLoS Computational Biology</source> <volume>5</volume>: <fpage>e1000352</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Paulson1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Paulson</surname><given-names>JN</given-names></name>, <name name-style="western"><surname>Stine</surname><given-names>OC</given-names></name>, <name name-style="western"><surname>Bravo</surname><given-names>HC</given-names></name>, <name name-style="western"><surname>Pop</surname><given-names>M</given-names></name> (<year>2013</year>) <article-title>Differential abundance analysis for microbial marker-gene surveys</article-title>. <source>Nature Methods</source> <volume>10</volume>: <fpage>1200</fpage>–<lpage>1202</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Robinson2"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>McCarthy</surname><given-names>DJ</given-names></name>, <name name-style="western"><surname>Smyth</surname><given-names>GK</given-names></name> (<year>2009</year>) <article-title>edgeR: a Bioconductor package for differential expression analysis of digital gene expression data</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>26</volume>: <fpage>139</fpage>–<lpage>140</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Gower1"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gower</surname><given-names>JC</given-names></name> (<year>1966</year>) <article-title>Some distance properties of latent root and vector methods used in multivariate analysis</article-title>. <source>Biometrika</source> <volume>53</volume>: <fpage>325</fpage>–<lpage>338</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Oksanen1"><label>43</label>
<mixed-citation publication-type="other" xlink:type="simple">Oksanen J, Blanchet FG, Kindt R, Legendre P, O'Hara RB, <etal>et al</etal>.. (2011) vegan: Community Ecology Package. R package version 1.17-10.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Anderson1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Anderson</surname><given-names>M</given-names></name> (<year>2001</year>) <article-title>A new method for non-parametric multivariate analysis of variance</article-title>. <source>Austral Ecology</source> <volume>26</volume>: <fpage>32</fpage>–<lpage>46</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Bray1"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bray</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Curtis</surname><given-names>JT</given-names></name> (<year>1957</year>) <article-title>An Ordination of the Upland Forest Communities of Southern Wisconsin</article-title>. <source>Ecological Monographs</source> <volume>27</volume>: <fpage>325</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Witten1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Witten</surname><given-names>DM</given-names></name> (<year>2011</year>) <article-title>Classification and clustering of sequencing data using a Poisson model</article-title>. <source>The Annals of Applied Statistics</source> <volume>5</volume>: <fpage>2493</fpage>–<lpage>2518</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Lozupone3"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lozupone</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Hamady</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kelley</surname><given-names>ST</given-names></name>, <name name-style="western"><surname>Knight</surname><given-names>R</given-names></name> (<year>2007</year>) <article-title>Quantitative and qualitative beta diversity measures lead to different insights into factors that structure microbial communities</article-title>. <source>Applied and Environmental Microbiology</source> <volume>73</volume>: <fpage>1576</fpage>–<lpage>1585</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Caporaso2"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Caporaso</surname><given-names>JG</given-names></name>, <name name-style="western"><surname>Lauber</surname><given-names>CL</given-names></name>, <name name-style="western"><surname>Walters</surname><given-names>WA</given-names></name>, <name name-style="western"><surname>Berg-Lyons</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Lozupone</surname><given-names>CA</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Global patterns of 16S rRNA diversity at a depth of millions of sequences per sample</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>108</volume>: <fpage>4516</fpage>–<lpage>4522</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Kaufman1"><label>49</label>
<mixed-citation publication-type="other" xlink:type="simple">Kaufman L, Rousseeuw PJ (1990) Finding Groups in Data: An Introduction to Cluster Analysis, JohnWiley &amp; Sons, chapter 2.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Reynolds1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reynolds</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Richards</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Iglesia</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Rayward-Smith</surname><given-names>V</given-names></name> (<year>2006</year>) <article-title>Clustering rules: A comparison of partitioning and hierarchical clustering algorithms</article-title>. <source>Journal of Mathematical Modelling and Algorithms</source> <volume>5</volume>: <fpage>475</fpage>–<lpage>504</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Pollard1"><label>51</label>
<mixed-citation publication-type="other" xlink:type="simple">Pollard KS, Gilbert HN, Ge Y, Taylor S, Dudoit S (2010) multtest: Resampling-based multiple hypothesis testing. R package version 2.4.0.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Benjamini1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Benjamini</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Hochberg</surname><given-names>Y</given-names></name> (<year>1995</year>) <article-title>Controlling the False Discovery Rate: A Practical and Powerful Approach to Multiple Testing</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source> <volume>57</volume>: <fpage>289</fpage>–<lpage>300</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Allaire1"><label>53</label>
<mixed-citation publication-type="other" xlink:type="simple">Allaire J, Horner J, Marti V, Porte N (2014) markdown: Markdown rendering for R. R package version 0.6.4.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Maechler1"><label>54</label>
<mixed-citation publication-type="other" xlink:type="simple">Maechler M, Rousseeuw P, Struyf A, Hubert M, Hornik K (2013) cluster: Cluster Analysis Basics and Extensions.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Revolution1"><label>55</label>
<mixed-citation publication-type="other" xlink:type="simple">Revolution Analytics (2011) foreach: Foreach looping construct for R. R package version 1.3.2.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Wickham1"><label>56</label>
<mixed-citation publication-type="book" xlink:type="simple">Wickham H (2009) ggplot2: elegant graphics for data analysis. Springer New York.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Wickham2"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name> (<year>2011</year>) <article-title>The split-apply-combine strategy for data analysis</article-title>. <source>Journal of Statistical Software</source> <volume>40</volume>: <fpage>1</fpage>–<lpage>29</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Wickham3"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wickham</surname><given-names>H</given-names></name> (<year>2007</year>) <article-title>Reshaping data with the reshape package</article-title>. <source>Journal of Statistical Software</source> <volume>21</volume>: <fpage>1</fpage>–<lpage>20</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Sing1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sing</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Sander</surname><given-names>O</given-names></name>, <name name-style="western"><surname>Beerenwinkel</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Lengauer</surname><given-names>T</given-names></name> (<year>2005</year>) <article-title>ROCR: visualizing classifier performance in R</article-title>. <source>Bioinformatics (Oxford, England)</source> <volume>21</volume>: <fpage>3940</fpage>–<lpage>3941</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-R1"><label>60</label>
<mixed-citation publication-type="book" xlink:type="simple">R Development Core Team (2011) R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing, Vienna, Austria. ISBN 3-900051-07-0.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Hastie1"><label>61</label>
<mixed-citation publication-type="book" xlink:type="simple">Hastie TJ, Pregibon D (1992) Generalized linear models. In: Chambers JM, Hastie TJ, editors, Statistical Models in S, Chapman &amp; Hall/CRC, <volume>chapter 6</volume>..</mixed-citation>
</ref>
<ref id="pcbi.1003531-Nookaew1"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nookaew</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Papini</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Pornputtapong</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Scalcinati</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Fagerberg</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A comprehensive comparison of RNA-Seq-based transcriptome analysis from reads to differential gene expression and crosscomparison with microarrays: a case study in Saccharomyces cerevisiae</article-title>. <source>Nucleic Acids Research</source> <volume>40</volume>: <fpage>10084</fpage>–<lpage>10097</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Bullard1"><label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bullard</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Purdom</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Hansen</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Dudoit</surname><given-names>S</given-names></name> (<year>2010</year>) <article-title>Evaluation of statistical methods for normalization and differential expression in mRNA-Seq experiments</article-title>. <source>BMC Bioinformatics</source> <volume>11</volume>: <fpage>94</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Sun1"><label>64</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sun</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Nishiyama</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Shimizu</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Kadota</surname><given-names>K</given-names></name> (<year>2013</year>) <article-title>TCC: an R package for comparing tag count data with robust normalization strategies</article-title>. <source>BMC Bioinformatics</source> <volume>14</volume>: <fpage>219</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Soneson1"><label>65</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Soneson</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Delorenzi</surname><given-names>M</given-names></name> (<year>2013</year>) <article-title>A comparison of methods for differential expression analysis of RNA-Seq data</article-title>. <source>BMC Bioinformatics</source> <volume>14</volume>: <fpage>91</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Hardcastle1"><label>66</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hardcastle</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Kelly</surname><given-names>KA</given-names></name> (<year>2010</year>) <article-title>baySeq: empirical Bayesian methods for identifying differential expression in sequence count data</article-title>. <source>BMC Bioinformatics</source> <volume>11</volume>: <fpage>422</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Ozer1"><label>67</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ozer</surname><given-names>HG</given-names></name>, <name name-style="western"><surname>Parvin</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Huang</surname><given-names>K</given-names></name> (<year>2012</year>) <article-title>DFI: gene feature discovery in RNA-Seq experiments from multiple sources</article-title>. <source>BMC Genomics</source> <volume>13 Suppl 8</volume>: <fpage>S11</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Bourgon1"><label>68</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bourgon</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Gentleman</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Huber</surname><given-names>W</given-names></name> (<year>2010</year>) <article-title>Independent filtering increases detection power for highthroughput experiments</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>107</volume>: <fpage>9546</fpage>–<lpage>9551</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Chao1"><label>69</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chao</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Chazdon</surname><given-names>RL</given-names></name>, <name name-style="western"><surname>Colwell</surname><given-names>RK</given-names></name>, <name name-style="western"><surname>Shen</surname><given-names>TJ</given-names></name> (<year>2005</year>) <article-title>A new statistical approach for assessing similarity of species composition with incidence and abundance data</article-title>. <source>Ecology Letters</source> <volume>8</volume>: <fpage>148</fpage>–<lpage>159</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Schloss2"><label>70</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schloss</surname><given-names>PD</given-names></name> (<year>2008</year>) <article-title>Evaluating different approaches that test whether microbial communities have the same structure</article-title>. <source>The ISME Journal</source> <volume>2</volume>: <fpage>265</fpage>–<lpage>275</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Gentleman1"><label>71</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gentleman</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Temple Lang</surname><given-names>D</given-names></name> (<year>2004</year>) <article-title>Statistical analyses and reproducible research</article-title>. <source>Bioconductor Project Working Papers</source> <volume>1</volume>: <fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Peng1"><label>72</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Peng</surname><given-names>RD</given-names></name> (<year>2011</year>) <article-title>Reproducible research in computational science</article-title>. <source>Science</source> <volume>334</volume>: <fpage>1226</fpage>–<lpage>1227</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Donoho1"><label>73</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Donoho</surname><given-names>DL</given-names></name> (<year>2010</year>) <article-title>An invitation to reproducible computational research</article-title>. <source>Biostatistics (Oxford, England)</source> <volume>11</volume>: <fpage>385</fpage>–<lpage>388</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Gentleman2"><label>74</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gentleman</surname><given-names>RC</given-names></name>, <name name-style="western"><surname>Carey</surname><given-names>VJ</given-names></name>, <name name-style="western"><surname>Bates</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Bolstad</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Dettling</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Bioconductor: open software development for computational biology and bioinformatics</article-title>. <source>Genome Biology</source> <volume>5</volume>: <fpage>R80</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003531-Wu1"><label>75</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wu</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Hoffmann</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Bittinger</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>YY</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Linking long-term dietary patterns with gut microbial enterotypes</article-title>. <source>Science</source> <volume>334</volume>: <fpage>105</fpage>–<lpage>108</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>