<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="EN">
<front>
<journal-meta><journal-id journal-id-type="publisher-id">plos</journal-id><journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id><journal-id journal-id-type="pmc">ploscomp</journal-id><!--===== Grouping journal title elements =====--><journal-title-group><journal-title>PLoS Computational Biology</journal-title></journal-title-group><issn pub-type="ppub">1553-734X</issn><issn pub-type="epub">1553-7358</issn><publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher></journal-meta>
<article-meta><article-id pub-id-type="publisher-id">09-PLCB-RA-1306R3</article-id><article-id pub-id-type="doi">10.1371/journal.pcbi.1000877</article-id><article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline"><subject>Biophysics/Theory and Simulation</subject><subject>Computational Biology/Computational Neuroscience</subject><subject>Developmental Biology/Morphogenesis and Cell Biology</subject><subject>Neuroscience/Theoretical Neuroscience</subject></subj-group></article-categories><title-group><article-title>One Rule to Grow Them All: A General Theory of Neuronal Branching and Its Practical Application</article-title><alt-title alt-title-type="running-head">Probing the Basis of Neuronal Branching</alt-title></title-group><contrib-group>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Cuntz</surname><given-names>Hermann</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Forstner</surname><given-names>Friedrich</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Borst</surname><given-names>Alexander</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Häusser</surname><given-names>Michael</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
</contrib-group><aff id="aff1"><label>1</label><addr-line>Wolfson Institute for Biomedical Research and Department of Neuroscience, Physiology and Pharmacology, University College London, London, United Kingdom</addr-line>       </aff><aff id="aff2"><label>2</label><addr-line>Department of Systems and Computational Neurobiology, Max-Planck Institute of Neurobiology, Martinsried, Germany</addr-line>       </aff><contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Morrison</surname><given-names>Abigail</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group><aff id="edit1">RIKEN Brain Science Institute, Japan</aff><author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">h.cuntz@ucl.ac.uk</email></corresp>
<fn fn-type="con"><p>Conceived and designed the experiments: HC FF AB MH. Performed the experiments: HC FF. Analyzed the data: HC FF. Wrote the paper: HC FF AB MH.</p></fn>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn></author-notes><pub-date pub-type="collection"><month>8</month><year>2010</year></pub-date><pub-date pub-type="epub"><day>5</day><month>8</month><year>2010</year></pub-date><volume>6</volume><issue>8</issue><elocation-id>e1000877</elocation-id><history>
<date date-type="received"><day>27</day><month>10</month><year>2009</year></date>
<date date-type="accepted"><day>1</day><month>7</month><year>2010</year></date>
</history><!--===== Grouping copyright info into permissions =====--><permissions><copyright-year>2010</copyright-year><copyright-holder>Cuntz et al</copyright-holder><license><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions><abstract>
<p>Understanding the principles governing axonal and dendritic branching is essential for unravelling the functionality of single neurons and the way in which they connect. Nevertheless, no formalism has yet been described which can capture the general features of neuronal branching. Here we propose such a formalism, which is derived from the expression of dendritic arborizations as locally optimized graphs. Inspired by Ramón y Cajal's laws of conservation of cytoplasm and conduction time in neural circuitry, we show that this graphical representation can be used to optimize these variables. This approach allows us to generate synthetic branching geometries which replicate morphological features of any tested neuron. The essential structure of a neuronal tree is thereby captured by the density profile of its spanning field and by a single parameter, a balancing factor weighing the costs for material and conduction time. This balancing factor determines a neuron's electrotonic compartmentalization. Additions to this rule, when required in the construction process, can be directly attributed to developmental processes or a neuron's computational role within its neural circuit. The simulations presented here are implemented in an open-source software package, the “TREES toolbox,” which provides a general set of tools for analyzing, manipulating, and generating dendritic structure, including a tool to create synthetic members of any particular cell group and an approach for a model-based supervised automatic morphological reconstruction from fluorescent image stacks. These approaches provide new insights into the constraints governing dendritic architectures. They also provide a novel framework for modelling and analyzing neuronal branching structures and for constructing realistic synthetic neural networks.</p>
</abstract><abstract abstract-type="summary"><title>Author Summary</title>
<p>More than a century has passed since Ramón y Cajal presented a set of fundamental biological laws of neuronal branching. He described how the shape of the core elements of the neural circuitry – axons and dendrites – are constrained by physical parameters such as space, cytoplasmic volume, and conduction time. The existence of these laws enabled him to organize his histological observations, to formulate the neuron doctrine, and to infer directionality in signal flow in the nervous system. We show that Cajal's principles can be used computationally to generate synthetic neural circuits. These principles rigorously constrain the shape of real neuronal structures, providing direct validation of his theories. At the same time, this strategy provides us with a powerful set of tools for generating synthetic neurons, as well as a model-based approach for automated reconstructions of neuronal trees from confocal image stacks.</p>
</abstract><funding-group><funding-statement>This work was supported by the Gatsby Charitable Foundation, the Wellcome Trust, the Alexander von Humboldt Foundation, the Max-Planck Society, and the ENI-Net. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="14"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Neuronal circuits are composed of a large variety of branched structures – axons and dendrites – forming a highly entangled web, reminiscent of a stochastic fractal <xref ref-type="bibr" rid="pcbi.1000877-Luczak1">[1]</xref>. Despite this apparent chaos, more than a century ago Ramón y Cajal was able to extract order from this neuroanatomical complexity, formulating fundamental anatomical principles of nerve cell organization <xref ref-type="bibr" rid="pcbi.1000877-RamonyCajal1">[2]</xref>. Cajal described three biological laws of neuronal architecture (Chapter V, p.115–125, in <xref ref-type="bibr" rid="pcbi.1000877-RamonyCajal1">[2]</xref>): optimization principles for conservation of space, cytoplasm and conduction time in the neural circuitry. These principles helped him to classify his observations and allowed him to postulate a wide variety of theories of functionality and directionality of signal flow in various brain areas. In the meantime, many of these ideas have been substantiated by applying more rigorous statistical analysis: circuitry and connectivity considerations as well as simple wire-packing constraints have been shown to determine the statistics of dendritic morphology <xref ref-type="bibr" rid="pcbi.1000877-Chklovskii1">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1000877-Cherniak1">[5]</xref>. It has also been shown mathematically that the specific organization and architecture of many parts of the brain reflect the selection pressure to reduce wiring costs for the circuitry <xref ref-type="bibr" rid="pcbi.1000877-Klyachko1">[6]</xref>–<xref ref-type="bibr" rid="pcbi.1000877-Wen2">[9]</xref>.</p>
<p>In parallel, the development of compartmental modelling techniques based on the theories of Wilfrid Rall have highlighted the importance of a neuron's precise branching morphology for its electrophysiological properties <xref ref-type="bibr" rid="pcbi.1000877-Rall1">[10]</xref>, and have shown that dendrites can play an important role in the computations performed on the inputs to the cell <xref ref-type="bibr" rid="pcbi.1000877-Segev1">[11]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-London1">[12]</xref>. In fact, requirements for highly selective connectivity <xref ref-type="bibr" rid="pcbi.1000877-Ohki1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Watt1">[14]</xref>, coherent topographic mapping, sophisticated computation or signal compartmentalization at the level of the single cell <xref ref-type="bibr" rid="pcbi.1000877-Poirazi1">[15]</xref> and the network could all contribute to this observed intricacy of brain wiring.</p>
<p>These two lines of investigation raise the question as to whether computation plays the determining role in shaping the morphological appearance of neuronal branching structures. Alternatively, the simple laws of material and conduction time preservation of Ramón y Cajal could have more influence.</p>
<p>Using computational techniques it has become possible to construct synthetic neuronal structures <italic>in silico</italic> governed by the simulation of physical and biological constraints <xref ref-type="bibr" rid="pcbi.1000877-Luczak1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Ascoli1">[16]</xref>–<xref ref-type="bibr" rid="pcbi.1000877-Koene1">[21]</xref>. In two recent papers <xref ref-type="bibr" rid="pcbi.1000877-Cuntz1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Cuntz2">[20]</xref>, we derived a growth algorithm for building dendritic arborisations following closely the constraints previously described by Ramón y Cajal. The algorithm builds tree structures which minimize the total amount of wiring and the path from the root to all points on the tree, corresponding to material and conduction time conservation respectively. Synthetic insect dendrite morphologies were faithfully reproduced in terms of their visual appearance and their branching parameters in this way.</p>
<p>Here we explore the algorithm's general applicability and its potential to describe any type of dendritic branching. If the algorithm is sufficient to accurately mimic the essential structure of neuronal circuitry we can resolve the relative importance of computation and wiring constraints in shaping neuronal morphology. We can then claim that Ramón y Cajal's laws are sufficient for shaping neuronal morphology. Specific computation will then only play a subordinate role in determining a neuron's branching pattern. We show here that while Cajal's laws do represent a strict constraint on neuronal branching, a neuronal morphology has a certain freedom to operate within these constraints. Firstly, by adjusting the balance between the two wiring costs, a dendrite can efficiently set its electrotonic compartmentalization, a quantity attributable to computation. Secondly, the density profile of the spanning field in which a dendrite grows determines its shape dramatically. Thirdly, a few weaker constraints such as the suppression of multifurcations, the addition of spatial jitter or the sequential growth of sub-regions of a dendrite are helpful for reproducing the dendritic branching patterns of particular preparations. These additional constraints might shed light on further functional, computational, developmental or network determinants for certain dendritic structures, and more of these will follow when applying our method to many more preparations. Moreover, the simple principles presented in this study can be used to efficiently edit, visualize, and analyze neuronal trees. Finally, these approaches allow one to generate highly realistic synthetic branched structures, and to automatically reconstruct neuronal branching from microscopy image stacks.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>The neuronal tree as a graph</title>
<p>Before generating complex neuronal morphologies, a simple formalism is required to compare and assess natural and synthetic neuronal trees. We derive such a formalism from graph theory: a neuronal tree is a graph which connects a set of labelled nodes via directed edges away from a root labelled “1” (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1A</xref>). This distinct directionality is useful since properties describing a neuron's branching typically relate to the root of the tree, e.g. the branch order which increases after each branch point away from the root. In general, the graph describing a specific neuronal tree should be entirely unique in order to be used to compare two trees topologically (their branching properties) or electrotonically (their functional properties). To achieve this, a unique labelling of the nodes is required. We constrain labelling by imposing a hierarchical order (node label values increase with distance from the root), continuous labelling within sub-trees (see for example nodes “6”, “7”, “8” and “9”, which form a sub-tree, <xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1A</xref>) and a topological sorting in which at any branch point the sub-tree with a higher topological depth is labelled first (see <xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1A</xref> and “label sorting” section in <xref ref-type="sec" rid="s4">Methods</xref>). Apart from requiring unique labelling, a unique representation of a tree requires its nodes to be precisely distributed along its geometry. The process of manual reconstruction assigns node locations in an arbitrary manner (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1B</xref>, original tree). We introduce a process we term resampling, in which nodes are redistributed on the same tree structure, assigning homogeneous inter-nodal distances (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1B</xref> shows 10 and 20 µm resampling; see “resampling” section in <xref ref-type="sec" rid="s4">Methods</xref>).</p>
<fig id="pcbi-1000877-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000877.g001</object-id><label>Figure 1</label><caption>
<title>The topological and electrotonic identity of a neuronal tree.</title>
<p>(A) The tree consists of cylinders or frusta (red) connecting each two nodes along the directed edges (away from the root node, arrows). Branch points and termination points represent the topology (topological points). A branch is a set of continuation points between two topological points. The labelling of the nodes is unique following three principles: hierarchical sorting, continuous labelling preserving sub-tree consistency and topological sorting (see text). (B) Rearrangement of node locations on a sample tree. Examples of equidistant node redistribution resulting in 10 or 20 µm resampling and a 20 µm resampling including length conservation (see text and “resampling” section of <xref ref-type="sec" rid="s4">Methods</xref>). (C–E) Unique representations of topology and electrotonic properties from sample tree from (B). (C) Applying topological sorting, a unique electrotonic equivalent tree can be constructed by mapping node label hierarchy on the branch angle (equivalent tree). (D) The adjacency matrix depicts the connectivity between the nodes of a tree. The corresponding electrotonic signature (current transfer from a node to another, i.e. the potential difference measured in one node as a result of a current injection into another) describes the dendritic compartmentalization (see text). The electrotonic signature corresponding to the 20 µm resampled tree preserves the compartmentalization of the original tree. (E) A one-dimensional string fully describes the topology once the nodes of a tree are sorted topologically. Green pieces represent branches ending with a branch point while black pieces end with a termination point. Branch lengths correspond to real metric length and their order follows the node label sorting. Because all representations observe the same continuous labelling, they preserve the sub-tree structure (a red transparent patch highlights one such sub-tree throughout all representations in (C–E)).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.g001" xlink:type="simple"/></fig>
<p>When node labelling and distribution are attributed in a distinct manner, a unique representation of the tree is provided. By rearranging the node locations of a sample tree (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1C</xref>, sample tree) based on its label order while preserving segment lengths, one obtains a unique electrotonic equivalent (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1C</xref>, equivalent tree; see “Electrotonic equivalent” section in <xref ref-type="sec" rid="s4">Methods</xref>). Dendritic structure can then also be described by a single unique adjacency matrix, which indicates for each node its direct parent node (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1D</xref>, adjacency matrix). Consistent with the adjacency matrix, a matrix containing the current transfer from any node to any other in the tree is a good representation of its electrotonic properties (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1D</xref>, electrotonic signature). As a result of the continuous node labelling within sub-trees, electrotonic compartmentalization expresses itself as square sub-regions with high reciprocal current transfer. Because of the unique graphical representation, the electrotonic signature is independent of the reconstruction procedure. Note that simplified tree structures, which preserve the electrotonic compartmentalization, can be obtained by a coarser resampling (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1D</xref>, electrotonic signature of the same tree as in <xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1B</xref> with 20 µm sampling). Computing current flow in a corresponding compartmental model is much faster since the number of nodes is decreased drastically (from 297 to 39 in the example of <xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1D</xref>). Finally, a simple and unique one-dimensional string can be used to describe the topology of the tree entirely, which we term the “topological gene”. In this string each branch is described in the order of its node labels by its length value followed by a “B” if the branch ends in a branch point or by a “T” if it ends in a termination point. The “topological gene” can be displayed as a sequence of green (“B”) and black (“T”) pieces (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1E</xref>). If diameter values for each node are known, the electrotonic signature can be reconstructed solely from this one-dimensional string, since segment lengths and topology are conserved.</p>
</sec><sec id="s2b">
<title>Optimized graphs for implementing Cajal's laws</title>
<p>In order to incorporate Cajal's hypotheses about wiring optimization in our theoretical description of a neuronal tree, we implemented optimization procedures known from graph theory. This approach was previously shown to be successful for generating synthetic dendritic structures of fly interneurons <xref ref-type="bibr" rid="pcbi.1000877-Cuntz1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Cuntz2">[20]</xref> as well as recently for neocortical axons <xref ref-type="bibr" rid="pcbi.1000877-Budd1">[22]</xref>. We now generalize it to more arbitrary neuronal geometries. <xref ref-type="fig" rid="pcbi-1000877-g002">Figure 2A</xref> exemplifies the general approach of assembling a set of unconnected carrier points to such an optimized graph. A greedy algorithm based on the minimum spanning tree algorithm <xref ref-type="bibr" rid="pcbi.1000877-Prim1">[23]</xref> starts at the root with an empty tree and connects unconnected carrier points (red dots) one by one to the nodes of the tree (black dots). At each step, the unconnected carrier point which is the point closest to the tree according to a cost function connects to the node in the tree to which it is nearest. The distance cost is composed of two factors: 1) A wiring cost represented by the Euclidean distance between the carrier point and the node in the tree (red dashed lines show three sample segment distances for point <italic>P</italic>); this quantity loosely corresponds to the material conservation constraint by Cajal; 2) A path length cost of the path along the tree from the root (large black node) to the carrier point; this quantity is consistent with the conduction time conservation constraint by Cajal. In the example here, even though <italic>P</italic> is closer to node <italic>5</italic> in Euclidean terms, the additional cost of path length (adding node <italic>5</italic> on the path) might tip the balance in favour of node <italic>4</italic>. A balancing factor <italic>bf</italic>, which weighs these two costs against each other in the cost function (<italic>total cost = wiring cost +bf </italic><bold><italic>·</italic></bold><italic> path length cost</italic>), represents the one and only parameter of the model.</p>
<fig id="pcbi-1000877-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000877.g002</object-id><label>Figure 2</label><caption>
<title>Generating neuronal branching structures using optimized graphs.</title>
<p>(A) The growth described by an extended minimum spanning tree algorithm (see text). Unconnected carrier points (red) are connected one by one to the nodes of a tree (black). Red dashed lines indicate three sample Euclidean distances to the nodes of the tree for sample point <italic>P</italic>. (B) Example trees grown on homogeneously distributed random carrier points in a circular hull starting from a root located at its centre (see top). Plotted as a function of the balancing factor <italic>bf</italic>, the trees range from perfect minimum spanning trees (left) to almost direct connections from the root to any point (right).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.g002" xlink:type="simple"/></fig>
<p><xref ref-type="fig" rid="pcbi-1000877-g002">Figure 2B</xref> illustrates the approach for neuronal trees grown on homogeneously distributed random carrier points in a circular envelope when the root is located at its centre. Since the two constraints (minimizing wiring and minimizing path length to the root) are weighted according to the balancing factor <italic>bf</italic> determining the contribution of the second constraint, the synthetic trees range along the dimension of that parameter from a pure minimum spanning tree, which grows in a wide spiral, to a purely stellate architecture (<xref ref-type="fig" rid="pcbi-1000877-g002">Figure 2B</xref>, from left to right).</p>
<p>In the following, we will apply this method of creating optimized graphs to reproduce morphologies in various neuronal preparations. The main effort will be to obtain an adequate set of carrier points for the application of the algorithm; this will prove to depend strongly on the density profile of the spanning field in the respective geometries. When additional constraints will be required in generating neurons in specific brain areas, this will provide clues pointing to actual computational or functional features of neuronal morphology.</p>
</sec><sec id="s2c">
<title>A geometric approach for generating neuronal trees</title>
<p>Whereas our previous work was limited to insect dendrites <xref ref-type="bibr" rid="pcbi.1000877-Cuntz1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Cuntz2">[20]</xref>, here we explored whether the algorithm is also able to reproduce a variety of neuronal structures. We first investigated the simple case of a planar neuron: the starburst amacrine cell of the mammalian retina. Its root is invariably located at the centre of a circular planar structure (data from <xref ref-type="bibr" rid="pcbi.1000877-Bloomfield1">[24]</xref>; <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3A</xref>). This arrangement provides a common geometrical context for these cells. In order to best generate synthetic starburst amacrine cell-like neurites, random carrier points were distributed according to a ring-shaped density function around the centre in the root, limited by a simple circular hull (<xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3B</xref>). The locus of increased density most likely corresponds to the area where an increased number of connections is being made in the real cell, with directional selectivity probably being computed there <xref ref-type="bibr" rid="pcbi.1000877-Vaney1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Demb1">[26]</xref>. <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3C</xref> demonstrates that this process successfully generates a synthetic neurite. The right balance between the two optimization constraints plays a crucial role, as is evident from a synthetic tree grown with a different balancing factor (<italic>bf</italic> = 0.2, <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3D</xref>). An appropriate balancing factor was determined by quantitatively comparing total cable length, mean path length to the root and number of branch points to the original real tree (<xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3E</xref>). Using the corresponding balancing factor resulted in realistic distributions of branch order and path length values as well as a realistic Sholl plot <xref ref-type="bibr" rid="pcbi.1000877-Sholl1">[27]</xref>, which counts the number of intersections of the tree with root-centred concentric spheres of increasing diameter values (<xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3F–H</xref>). The starburst amacrine cell neurite required a higher <italic>bf</italic> than did the insect dendrites (0.6 versus 0.4, see <xref ref-type="bibr" rid="pcbi.1000877-Cuntz1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Cuntz2">[20]</xref>). Additionally, suppressing multifurcations improved the growth process (compare <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3CD</xref> with <xref ref-type="fig" rid="pcbi-1000877-g002">Figure 2B</xref>). This was generally beneficial for all neurons studied here, and might reflect a constraint for the underlying developmental growth process. To better reproduce the appearance of reconstructions of real neurons, spatial jitter was added in all cases in the form of low-pass filtered spatial noise applied directly on the coordinates of the nodes in the resulting tree. Note that homogeneous noise application was only possible after the tree was resampled to a fixed segment length. Spatial noise in real reconstructions is partly due to fixation (e.g. shrinkage or reconstruction artefacts) and should therefore not necessarily be reproduced by the synthetic morphologies. However, wriggly paths in neuronal branching, corresponding to a spatial jitter along the branches, can be a result of obstacle avoidance and therefore can be associated with space packing issues <xref ref-type="bibr" rid="pcbi.1000877-Chklovskii1">[3]</xref>, relating to the third law described by Ramón y Cajal. In this study, however, we do not model volumetric optimization or space packing of other neuronal and non-neuronal structures in the tissue. We thus simply note here that in order to fully reproduce starburst amacrine cell reconstructions, multifurcations were suppressed and spatial jitter was added.</p>
<fig id="pcbi-1000877-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000877.g003</object-id><label>Figure 3</label><caption>
<title>Generating dendritic structures by constructing geometric spanning fields: I. the retinal starburst amacrine cell.</title>
<p>(A) Reconstruction of a starburst amacrine cell in the inner plexiform layer of the rabbit retina (data from <xref ref-type="bibr" rid="pcbi.1000877-Bloomfield1">[24]</xref>). (B) Synthetic starburst amacrine cell morphologies can be best obtained by distributing random carrier points along a density ring limited by a circular hull. (C) An example tree grown on random carrier points distributed according to B following the algorithm described in <xref ref-type="fig" rid="pcbi-1000877-g002">Figure 2</xref>. Spatial jitter was added to reproduce the wriggliness of the original structure. (D) A tree grown on exactly the same points as (C) with a lower balancing factor. (E) The number of randomly distributed carrier points and the balancing factor <italic>bf</italic> determine the synthetically generated morphology. Here, the areas are plotted in which the synthetic trees match the original according to certain criteria (blue: total cable length ±200 µm; red: total number of branch points ±5; green: mean path length to the root ±3 µm). The area of overlap corresponds to a reasonable parameter set for the synthetic trees. (F–H) Branch order distribution, path length distribution and Sholl intersections are compared for the original tree (red) and for one sample synthetic tree (grey).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.g003" xlink:type="simple"/></fig>
<p>We next studied dendrites of hippocampal granule cells, which fill a three-dimensional volume rather than a plane (template data from <xref ref-type="bibr" rid="pcbi.1000877-Rihn1">[28]</xref>; see sample cells in <xref ref-type="fig" rid="pcbi-1000877-g004">Figure 4A</xref>). We first centred the original cell reconstructions on the soma location and rotated them manually in all three dimensions to produce axial symmetry with respect to each axis. Then, the dendrites were scaled to the average limits over the population of real morphologies for each of the three dimensions. Surprisingly, the spanning fields overlapped delineating again a common context for all cells (<xref ref-type="fig" rid="pcbi-1000877-g004">Figure 4B</xref>). A geometric approach to describing the envelope of the dendrites is to intersect an elliptical cone with a sphere whose centre lies outside beyond the tip of the cone along the cone's central axis. The density profile of topological points (branch and termination points only) seemed to increase close to the origin of the volume and again further out at the rim (<xref ref-type="fig" rid="pcbi-1000877-g004">Figure 4B</xref>). Growing synthetic trees on random carrier points distributed according to this type of density profile within the constructed cone-like volume resulted in realistic dendritic structures (see examples in <xref ref-type="fig" rid="pcbi-1000877-g004">Figure 4C</xref>). Again, altering the balancing factor resulted in significant changes in branching behaviour (<xref ref-type="fig" rid="pcbi-1000877-g004">Figure 4D</xref>). This could be used to determine an appropriate balancing factor, which was higher for these cells. For comparison, full distributions of branching statistics are shown for synthetic granule cells and real counterparts in <xref ref-type="fig" rid="pcbi-1000877-g004">Figure 4E–G</xref> in analogy to <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3F–H</xref>. The two cases indicate that adequately balancing the costs for wiring with the costs for path length distances to the root is crucial to describing the dendritic morphology.</p>
<fig id="pcbi-1000877-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000877.g004</object-id><label>Figure 4</label><caption>
<title>Generating dendritic structures by constructing geometric spanning fields: II. the hippocampal dentate gyrus granule cell.</title>
<p>(A) Reconstructions of four sample hippocampal granule cells (data from <xref ref-type="bibr" rid="pcbi.1000877-Rihn1">[28]</xref>). (B) After centring, rotating and scaling all cells adequately, the 50 µm iso-distance volume hulls (black lines) around the set of all topological points (black dots) overlap in all dimensions. Left, xy-projection; Middle, xz-projection; Right; yz-projection. Overlay colours represent local density with same colormap as in <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3</xref>. (C) Examples of synthetically generated granule cells (based on the data in AB) with <italic>bf</italic> = 0.85. (D) Third cell from the left in C was grown on the same carrier points with different balancing factors to show the effect of <italic>bf</italic> here. (E–G) Overlaid branch order distributions, path length distributions and Sholl intersections for original trees (red) and for synthetic trees with suitable parameter <italic>bf</italic> = 0.85 (black).</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.g004" xlink:type="simple"/></fig></sec><sec id="s2d">
<title>A generalized approach for generating neuronal trees</title>
<p>The two cases described in <xref ref-type="fig" rid="pcbi-1000877-g003">Figures 3</xref> and <xref ref-type="fig" rid="pcbi-1000877-g004">4</xref> used a geometrical construction to produce the density profile from which the carrier points were obtained, i.e. a ring-like density confined by a circle or a bimodal density profile within a volume obtained by intersecting a cone with a sphere. We next tried to generalize the approach taken with hippocampal granule cells to all neuron types. We derived context and spanning fields for a wide variety of existing cell types using a common feature that we observed in hippocampal granule cells: their scalability. This scalability is consistent with the fact that neuronal trees can be described as fractal-like structures in terms of their resolution (or complexity) within the field in which they span rather than by their real dimensions (see <xref ref-type="bibr" rid="pcbi.1000877-Luczak1">[1]</xref>). Based on the assumption that the principles of scalability hold true, we applied the following procedure on various dendritic structures: after all dendritic trees were centred around their somata, they were rotated manually such as to maximize the dendritic overlap. This was straightforward for cortical pyramidal cells and hippocampal granule cells where the main axis is obvious. Others, such as hippocampal pyramidal cells which will be discussed briefly further below, did not overlap since their precise branching contours depended greatly on the context and the location within the neuronal circuit. After rotating the cells into a common context, the limits of the spanning fields were measured separately for each region of the neuronal branching structure (apical and basal dendrite for example). In <xref ref-type="fig" rid="pcbi-1000877-g005">Figure 5A</xref> such limits are shown for apical and basal dendrites of layer 2/3, layer 4 and layer 5 pyramidal cells of the developing somatosensory cortex (data from <xref ref-type="bibr" rid="pcbi.1000877-Wang1">[29]</xref>). The coordinates of all nodes belonging to an individual region were scaled to the mean limits of that region within each group of cells. This resulted in size-normalized cells. Surprisingly, the scaling of the different individual region limits did not typically correlate with each other, i.e. a large apical dendrite did not necessarily mean a large basal dendrite. After scaling, the topological points belonging to one specific region could all be lumped together and a bounded density cloud was calculated (exemplary density clouds for the cells as a whole are overlaid in <xref ref-type="fig" rid="pcbi-1000877-g005">Figure 5A</xref>). This procedure can be applied not only to different types of cells but also to different developmental stages of one particular cell type (data from perirhinal cortical pyramidal cells <xref ref-type="bibr" rid="pcbi.1000877-Furtak1">[30]</xref>; see <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3B</xref>). Carrier points were then distributed randomly according to the density distributions of each region one by one and connected by the growth algorithm. The number of carrier points used was increased for each synthetic tree until it matched a target branch point number picked from the distribution observed in the real cells. In pyramidal cells, it was necessary to split the apical dendrite in a tuft region and a lower oblique dendrite region, hinting possibly to a functional or developmental requirement. The tuft was grown first and resampled to 5 µm segments to provide attaching points along the main branch for the lower part of the apical dendrite to grow on. The basal dendrite was grown separately and the resulting cells subsequently subjected to spatial jitter, soma diameter mapping and dendritic diameter tapering (see <xref ref-type="fig" rid="pcbi-1000877-g005">Figure 5C</xref> and “Extended minimum spanning tree” section of <xref ref-type="sec" rid="s4">Methods</xref> as well as <xref ref-type="supplementary-material" rid="pcbi.1000877.s001">Protocol S1</xref> for more details).</p>
<fig id="pcbi-1000877-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000877.g005</object-id><label>Figure 5</label><caption>
<title>A general strategy for generating synthetic morphologies: Cortical pyramidal cells.</title>
<p>(A) After rotating rat somatosensory cortex layer 2/3, 4 and 5 pyramidal cells to overlap, the limits of their individual regions were extracted: black shaded boxes show the mean limits in XY for the apical region; the black empty boxes delineate one standard deviation away from the mean. Corresponding red boxes duplicate this procedure for the basal dendrites. Cells are then scaled region-by-region to the mean limits of each region. Overlay colours describe local density (colormap see <xref ref-type="fig" rid="pcbi-1000877-g002">Figure 2D</xref>) of lumped topological points of scaled trees. (B) Same procedure for three groups of cortical pyramidal cells during development. (C) Construction stages of a sample layer 5 pyramidal cell according to spanning fields described in A. First the apical tuft is constructed, then oblique dendrites and finally the basal dendrite. Spatial jitter and diameter values are added subsequently.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.g005" xlink:type="simple"/></fig>
<p>Using this approach, dendritic morphologies of different pyramidal cells (<xref ref-type="fig" rid="pcbi-1000877-g006">Figure 6A–C</xref>: layer 2/3, layer 4 and layer 5, all <italic>bf</italic> = 0.7) were generated based on the spanning fields of <xref ref-type="fig" rid="pcbi-1000877-g005">Figure 5A</xref>. In this case, a wide range of suitable balancing factors (<italic>bf</italic> = 0.4–0.7) matched the distributions of total cable length and average path lengths in the resulting synthetic morphologies leading to realistic branching statistics (see below). In contrast to obtaining the density profiles for distributing random carrier points by a geometrical construction, these synthetic dendrite morphologies were obtained directly from scaled density plots from the real reconstructions. This increases the parameter space describing the generation of synthetic cells considerably. With this additional restriction, we obtain synthetic cells that are indistinguishable by eye from their real counterparts. The same approach can be used to generate pyramidal cells at different developmental stages (<xref ref-type="fig" rid="pcbi-1000877-g006">Figure 6D</xref> <italic>bf</italic> = 0.7, from the spanning fields of <xref ref-type="fig" rid="pcbi-1000877-g005">Figure 5B</xref>). We note that apart from the different spanning fields shown in <xref ref-type="fig" rid="pcbi-1000877-g005">Figure 5AB</xref>, different diameters and spatial jitter, all pyramidal cell clones were constructed according to the exact same procedure. In conclusion, Cajal's laws impose a general constraint on dendritic branching in all preparations and at all developmental stages we have investigated.</p>
<fig id="pcbi-1000877-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000877.g006</object-id><label>Figure 6</label><caption>
<title>Sample cells grown using the general strategy.</title>
<p>(A), (B) and (C) show sample synthetically generated model cells of layer 2/3, layer 4 and layer 5 cortical pyramidal cells respectively, all grown using the general strategy described in <xref ref-type="fig" rid="pcbi-1000877-g005">Figure 5</xref>. In A and B, all dendrites were thickened by 1 µm over all cells for clarity purposes. (D) When data from developing neurons was binned into three groups (P0–5, P8–12, P36–44), synthetically generated cortical pyramidal cells could be generated for the different developmental stages. Vertical or horizontal locations of the cells are purely for layout purposes in all cases.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.g006" xlink:type="simple"/></fig>
<p>Distributions of branching parameters to compare the synthetic pyramidal cells with their real counterparts are shown in <xref ref-type="fig" rid="pcbi-1000877-g007">Figure 7A–I</xref>. As mentioned above, because of a higher variability between pyramidal cells than for example hippocampal granule cells, branching statistics lose their informative value. Note however, that, as observed previously for insect dendrites <xref ref-type="bibr" rid="pcbi.1000877-Cuntz2">[20]</xref>, path length distributions are similar to Sholl intersections for both real and synthetic geometries, which is a direct consequence of minimizing conduction times (since path lengths along the tree are kept to tightly match direct Euclidean distances). Synthetic pyramidal cells grown with a non-optimal balancing factor on the other hand were clearly flawed, as illustrated by the example of layer 5 pyramidal neuron clones (<xref ref-type="fig" rid="pcbi-1000877-g007">Figure 7K</xref>, compare <italic>bf</italic> = 0 and <italic>bf</italic> = 0.2 with more adequate <italic>bf</italic> = 0.7). The electrotonic signature, developed in <xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1</xref> to compare electrotonic compartmentalization between neuronal trees, revealed the deficiencies of the synthetic dendrites with wrong balancing factor. When the balancing factor was too low, the electrotonic signature exhibited a distorted compartmentalization compared to an original tree (<xref ref-type="fig" rid="pcbi-1000877-g007">Figure 7L</xref>, leftmost). This can be loosely quantified by measuring the average size of an electrotonic compartment in real morphologies compared to synthetic ones with different balancing factors (<xref ref-type="fig" rid="pcbi-1000877-g007">Figure 7M</xref>). This quantity for a compartment size was obtained by averaging dendritic length exceeding 60% of the maximal potential deflection for current injections in all nodes one at a time. Thus, the balancing factor determines the degree of compartmentalization of the neuronal tree. This is expected, since a more stellate-like morphology associated with a higher balancing factor (<xref ref-type="fig" rid="pcbi-1000877-g002">Figure 2B</xref>, right side) should exhibit greater electrotonic segregation in its sub-trees.</p>
<fig id="pcbi-1000877-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000877.g007</object-id><label>Figure 7</label><caption>
<title>Validating synthetic branching structures of pyramidal cells.</title>
<p>While branching statistics of starburst amacrine cells and hippocampal granule cells were moderately homogeneous, pyramidal cells exhibited stronger variations. Balancing factors leading to reasonable branching statistics ranged from 0.4 to 0.7. In the following we compare branching parameter distributions as in <xref ref-type="fig" rid="pcbi-1000877-g004">Figure 4</xref> for synthetic (black) and original dendrites (red) of layer 2/3 (A–C), layer 4 (D–F) and layer 5 (G–I) pyramidal cells grown with a balancing factor <italic>bf</italic> = 0.7, 0.6 and 0.5 respectively. (K) Representative layer 5 pyramidal cells grown with different balancing factors <italic>bf</italic> = 0, <italic>bf</italic> = 0.2, <italic>bf</italic> = 0.7. (L) Representative electrotonic signatures of these synthetically generated dendrites and of one original layer 5 pyramidal cell for comparison. (M) Simple relationship between electrotonic compartmentalization and balancing factor. Straight line connects averages of each 100 model dendrites at different balancing factor values. Dashed line shows average compartment size of real reconstructions.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.g007" xlink:type="simple"/></fig></sec><sec id="s2e">
<title>Relationship between the growth process and the network context</title>
<p>The local circuitry ultimately determines the context in which neuronal trees grow. There are global boundaries given by the neural tissue such as layers, topography or physical borders. However, competition for inputs between neighbouring neurons also seems to play a major role. Competition is easily implementable in the greedy growth algorithm introduced here because of the iterative nature of the algorithm. This can then be considered as a greedy extension of the growth algorithm and should be applicable in the network context. When grown under competitive conditions in which trees connect to a carrier point one after the other, the immediate consequence is spatial tiling. This can be seen in 2D for example when trees were grown from starting points on a spatial grid in a homogeneous substrate of random carrier points (<xref ref-type="fig" rid="pcbi-1000877-g008">Figure 8A</xref>). In fact, both Cajal's material cost and his conduction time cost independently lead to this type of tiling, which does not happen in the case of random wiring (not shown). Competitive dendrite growth can directly reproduce the sharp borders observed in Purkinje cell dendrites of the cerebellum. Using the geometric approach described in <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3</xref> and <xref ref-type="fig" rid="pcbi-1000877-g004">4</xref>, 16 cells were grown on random carrier points distributed homogeneously in a ring-shaped area in a competitive manner. As was the case for the apical tuft of pyramidal cells, Purkinje cell dendrites required to be grown in two stages: first the thick primary dendrites and then the thinner ones covered in spines (three sample cells are displayed in <xref ref-type="fig" rid="pcbi-1000877-g008">Figure 8B</xref>). The sharp borders of Purkinje cell dendrites could well be reproduced but whether this actually is a result of tiling in sagittal planes of the cerebellum remains to be determined experimentally. Cajal's laws can therefore explain more than just the inner branching rule: tiling between cells can emerge directly from his suggested optimization principles applied at the network level.</p>
<fig id="pcbi-1000877-g008" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000877.g008</object-id><label>Figure 8</label><caption>
<title>The interactions between neuronal branching and the network context.</title>
<p>(A) Nine synthetic neuronal trees grown competitively on a sample square substrate of homogeneously distributed random carrier points: the competitive greedy growth results automatically in tiling of the available space. (B) Three out of 16 neuronal trees grown competitively on random carrier points distributed on a ring: this simulates well the sharp borders of Purkinje cells in the cerebellum. Whether Purkinje cell dendrites actually tile in sagittal planes of the cerebellum remains to be determined. (C) Hippocampal granule cells from <xref ref-type="fig" rid="pcbi-1000877-g004">Figure 4</xref> were scaled and positioned along the contours of a human dentate gyrus obtained from a sketch by Camillo Golgi <xref ref-type="bibr" rid="pcbi.1000877-Golgi1">[31]</xref>. Growing synthetic CA3 hippocampal pyramidal cells competitively with the limits from the template resulted in realistic hippocampal pyramidal cells affected by mutual avoidance. Synthetic dendrites were overlaid on the background of the original sketch. (D) Bipolar cells (black) in the retina were grown competitively to connect an array of photoreceptors (yellow) to an array of starburst amacrine cells (green, obtained using the algorithm in <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3</xref>). In such a case the full morphology of bipolar cells is determined by the context of the circuitry, after prescribing soma locations of the bipolar cells. For all panels of <xref ref-type="fig" rid="pcbi-1000877-g008">Figure 8</xref> precise scale bars would depend on the details of the preparations and were therefore omitted.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.g008" xlink:type="simple"/></fig>
<p>As mentioned above, the network context also plays a major role in governing neuronal spanning fields and their density profiles. Arranging the hippocampal granule cells developed in <xref ref-type="fig" rid="pcbi-1000877-g004">Figure 4</xref> onto the contours of the dentate gyrus should for example fully determine their scaling variability (<xref ref-type="fig" rid="pcbi-1000877-g008">Figure 8C</xref>). Growing CA3 hippocampal pyramidal cells in a context-dependent manner (here in a competitive growth process bounded by the CA3 contours of the hippocampus, from Golgi, see Ref. <xref ref-type="bibr" rid="pcbi.1000877-Golgi1">[31]</xref>) might determine the variability in neuronal branching seen in the reconstructions. This is the right place to express a caveat regarding the use of branching statistics to compare dendritic structures. The branching statistics of two synthetic hippocampal pyramidal cells grown on both extremities of the CA3 region will differ entirely because of the different network context. This is the case even though these were grown using the exact same growth rule, they belong to the same cell class and they resemble their real counterparts. The idea that the network context determines a neuron's branching can be followed further: both input and output locations can serve as direct constraints for the cell morphology, as is the case when an array of photoreceptors (<xref ref-type="fig" rid="pcbi-1000877-g008">Figure 8D</xref>, yellow) in the retina connects to an array of starburst amacrine cells (<xref ref-type="fig" rid="pcbi-1000877-g008">Figure 8D</xref>, green obtained as in <xref ref-type="fig" rid="pcbi-1000877-g003">Figure 3</xref>) via a set of bipolar cells. In such a case, the input-output topography of the connection determines the morphology of bipolar cells given that these grow in a competitive manner (<xref ref-type="fig" rid="pcbi-1000877-g008">Figure 8D</xref>, black).</p>
<p>Finally, as shown previously <xref ref-type="bibr" rid="pcbi.1000877-Cuntz2">[20]</xref>, the growth algorithm can serve as a tool for automatic reconstruction of neuronal trees from tiled image stacks containing fluorescently labelled neurons. <xref ref-type="fig" rid="pcbi-1000877-g009">Figure 9A</xref> displays an example of such a tiled image stack from a small part of an insect interneuron dendrite. In order to obtain the carrier points necessary to grow the tree, the image stack is first subjected to a local threshold (blue overlay) which is then 3D skeletonised (all green dots). The green dots are sparsened (only larger green dots with black surround) and a starting point is chosen (red dot). Apart from the cost functions described above, additional costs can be implemented here to connect the carrier points according to the image stack information (indicated by yellow lines between the dots). Connecting the carrier points results in a tree that can be further processed (<xref ref-type="fig" rid="pcbi-1000877-g009">Figure 9A</xref>, bottom, green tree structure). The procedure can be applied competitively and in an automated or semi-automated way to recover multiple trees such as the three entangled pyramidal cells and one interneuron from a set of tiled image stacks (<xref ref-type="fig" rid="pcbi-1000877-g009">Figure 9BC</xref>). Note that manual post-processing was required to obtain these clean reconstructions. But the simple representation of the cost function in the growth algorithm allows it to be easily extended to a state-of-the-art model-based reconstruction tool.</p>
<fig id="pcbi-1000877-g009" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1000877.g009</object-id><label>Figure 9</label><caption>
<title>Automated reconstruction of multiple cells using the greedy algorithm.</title>
<p>(A) Example of an additional application of the algorithm: automated model-based tree reconstruction from image stacks. Maximum intensity projection of tiled image stacks containing a sample sub-tree of a fluorescently labelled neuronal tree. Blue overlay in top panel corresponds to the output of a non-linear thresholding. The resulting binary matrix is then reduced to single points in space (green dots) via a skeletonization procedure. After a distance graph is obtained which describes the probability of a connection between these points due to the image data the points are used as carrier points for the growth algorithm to obtain the corresponding tree using the distance graph as an additional cost factor. After unlikely branches are removed the underlying tree structure is captured (green tree structure in the lower panel, see text for more detail; note absence of scale bar since this a sample image stack). (B) Maximum intensity projections of tiled 2-photon fluorescent image stacks acquired at 820 nm from primary visual cortex of a p13 JAX transgenic mouse (strain #007677, <xref ref-type="bibr" rid="pcbi.1000877-Chattopadhyaya1">[38]</xref>) expressing GFP in parvalbumin interneurons, of which one is present. Three further layer 5 pyramidal neurons are also imaged; all cells were filled with a fluorescent dye Alexa 594 via whole cell patch-clamp recording. Data courtesy of Kate Buchanan and Jesper Sjöström. (C) Corresponding reconstructions (with the interneuron in green) grown in a competitive manner on the image stacks after manual post-processing.</p>
</caption><graphic mimetype="image" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.g009" xlink:type="simple"/></fig></sec></sec><sec id="s3">
<title>Discussion</title>
<p>We present a new framework for understanding dendritic branching in neurons based on the use of graph theory. Our results demonstrate that the laws of conservation of cytoplasm and conduction time formulated by Ramón y Cajal from simple observation represent a fundamental constraint to dendritic branching. Generation of synthetic tree structures using a simple algorithm derived from these constraints creates highly realistic neuronal branching structures across a wide range of neuronal types. Nevertheless, there remains flexibility within these natural constraints. Notably, the weighting of both components, the balancing factor – which determines a neuron's electrotonic compartmentalization – is an adjustable parameter and can differ from one cell type to the next. Within these constraints, neuronal processes can grow and adapt depending on their specific functionality. Most strikingly, the spanning field and density profile are key determinants of nerve cell individuality and depend on the sharp physical boundaries of the tissue and on the network input-output topography. Finally, additions to this rule are required in certain cases such as the suppression of multifurcations and the addition of spatial jitter. These might relate to the developmental bio-mechanistic growth process or specific computational features and we are confident we will find many more in further preparations.</p>
<sec id="s3a">
<title>Relating computation and morphology</title>
<p>The spanning field in which a dendrite grows plays a major role in defining the computational and functional features of axons and dendrites. This is reflected in its importance in the process of accurately reproducing single cell morphologies. Furthermore, to replicate dendrite regions such as the apical tuft of layer 5 pyramidal neurons or the primary dendrites of Purkinje cells, a timed growth process was required in which subparts of a region were grown in a second step. This could indicate a functional constraint governing neuronal outgrowth in these cells. However, two limitations of the greedy algorithm must be considered. Firstly, the growth process does not guarantee a global optimum since it is based on an algorithm which optimizes at the local level, adding carrier points one by one. Secondly, it does not involve volumetric considerations. Both cable diameter when optimizing the amount of material used and space packing issues in conjunction with axons and dendrites of other neurons as well as with glia cells are known to play a role in determining wiring properties in the brain <xref ref-type="bibr" rid="pcbi.1000877-Chklovskii1">[3]</xref>. It is likely that some of these restrictions are responsible for the extra steps necessary in the construction of synthetic neuronal branching structures. These two possible extensions are good starting points for subsequent studies.</p>
</sec><sec id="s3b">
<title>Spanning fields and the network context</title>
<p>We show that spatial tiling as observed in many dendritic structures (<xref ref-type="fig" rid="pcbi-1000877-g008">Figure 8</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Eccles1">[32]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Parrish1">[33]</xref>) is a direct consequence of Cajal's laws when applied at the network level. Indeed, network structure in general is expected to be determined by the same optimization principles, a feature which Cajal highlighted throughout his work. We have implemented this directly with the example of bipolar cells, whose carrier points were directly obtained from arrays of other existing input and output neurons rather than indirectly from its individual spanning field and its respective density profiles. By optimally arranging input and output locations, the spanning field, the major contributor to shaping the synthetic neuronal trees we have presented here, was strictly constrained by the same wiring and conduction time costs. Defining starting locations (e.g. somata) and synaptic target partners should therefore generally suffice to fully determine the architecture of a network. This is most likely to be a general principle and should be investigated further in future work.</p>
</sec><sec id="s3c">
<title>Methods derived from analyzing neuronal trees as graphs</title>
<p>Based on the formalisms of optimized graphs, we have derived several new ways of representing dendritic structure and function. First, we show that graph resampling and labelling order lead to an objective representation for electrotonic compartmentalization. Simplified models which still faithfully represent the compartmentalization behaviour can be obtained with such a process. Second, taking advantage of their scalability, we derived generalized spanning fields and their density profile descriptions. These representations may be useful for comparing branching structures of different neuronal cell types. We show here how these can be useful for generating synthetic neuronal tree clones. Finally, as mentioned previously <xref ref-type="bibr" rid="pcbi.1000877-Cuntz2">[20]</xref> after extracting carrier points directly from image stacks, the greedy algorithm is capable of a model-based automated reconstruction of neuronal trees from microscopy data. The simplicity of the algorithm and the fact that the cost factors are arbitrarily adjustable render this method an easily extendable tool. This could be crucial for combining the wide existing set of various approaches <xref ref-type="bibr" rid="pcbi.1000877-Losavio1">[34]</xref>–<xref ref-type="bibr" rid="pcbi.1000877-Vasilkoski1">[37]</xref> in one process. For example, costs for segment orientation <xref ref-type="bibr" rid="pcbi.1000877-Vasilkoski1">[37]</xref> can be integrated into the cost function directly.</p>
</sec><sec id="s3d">
<title>Conclusion</title>
<p>In summary, we find that a simple growth algorithm which optimizes total cable length and the path length from any point to the root in an iterative fashion can generate synthetic dendritic trees that are indistinguishable from their real counterparts for a wide variety of neurons. This represents a direct validation of the fundamental constraints on neuronal circuit organization described originally by Cajal. Furthermore, this approach provides a new framework for understanding dendritic tiling, which is a direct consequence of using this algorithm. The availability of these tools in a comprehensive software package (the TREES toolbox; see <xref ref-type="supplementary-material" rid="pcbi.1000877.s001">Protocol S1</xref>) should now allow these principles to be applied to any arbitrary dendritic or axonal architecture, and permit synthetic neurons and neural networks to be generated with high precision.</p>
</sec></sec><sec id="s4" sec-type="methods">
<title>Methods</title>
<p>We have developed a software toolbox, the TREES toolbox (deposited at <ext-link ext-link-type="uri" xlink:href="http://www.treestoolbox.org" xlink:type="simple">www.treestoolbox.org</ext-link>), written in MATLAB (Mathworks, Natick, MA), with corresponding extensive documentation. All methods used in this paper are based on applications from this toolbox and are only explained briefly here; detailed documentation regarding the toolbox is presented in Supplementary Information (<xref ref-type="supplementary-material" rid="pcbi.1000877.s001">Protocol S1</xref>). Dendritic morphologies were obtained from the neuromorpho database (<ext-link ext-link-type="uri" xlink:href="http://www.neuromorpho.org" xlink:type="simple">www.neuromorpho.org</ext-link>, see <xref ref-type="bibr" rid="pcbi.1000877-Ascoli1">[16]</xref>).</p>
<sec id="s4a">
<title>Label sorting</title>
<p>The labelling of the nodes of a tree should be unique in order to, for example, compare the graphs of two trees topologically or electrotonically. In order to obtain such a unique labelling, nodes were first sorted according to their topological depth, chosen here to be the sum of the path length values of all children. Each node was then inserted in that order into a one-dimensional string, one-by-one directly behind its direct parent node. Subsequently, the resulting string of labels was mapped back onto the nodes of the tree. We refer to the Supplementary Information for more details on this subject (<xref ref-type="supplementary-material" rid="pcbi.1000877.s001">Protocol S1</xref>).</p>
</sec><sec id="s4b">
<title>Resampling</title>
<p>The direct comparison of two trees along strict criteria also requires a unique distribution of node locations on the graph. We redistributed nodes on a tree structure with equal inter-nodal distances, a process we termed resampling. Each terminal branch was first lengthened by half the sampling distance. Then, starting at the root, extra nodes were positioned at integer multiples of the sampling distance along the path of the tree. All other nodes were then removed while maintaining the connectivity. During this process all segments become shorter or remain the same length; this is because a wriggly path is simplified by a straight line (which is by definition always shorter). In order to preserve the total branching length and the electrotonic properties all segments were then elongated to the given sampling length (<xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1B</xref>, length conservation).</p>
</sec><sec id="s4c">
<title>Electrotonic equivalent</title>
<p>Rearranging the metrics of a tree after sorting the labels leads to generation of its unique electrotonic equivalent tree. To obtain the equivalent tree, its metrics were rearranged according to a circular dendrogram where the angle towards which a segment is directed within a circle around the root corresponds to the value of the label of its target node.</p>
</sec><sec id="s4d">
<title>Electrotonic signature</title>
<p>To obtain the electrotonic signature, the conductance matrix describing the axial conductances along the edges of the graph (following the adjacency matrix structure) and the membrane leak conductances (on the diagonal of the matrix) was simply inverted. The result is a potential matrix (in mV) corresponding to the resulting steady-state potential in one node when 1 nA current was injected in another node, i.e. the current transfer from any node to another. The passive axial and membrane conductances were 100 Ωcm and 2000 Ωcm<sup>2</sup> for the sample insect dendrite sub-tree in <xref ref-type="fig" rid="pcbi-1000877-g001">Figure 1</xref> and 100 Ωcm and 20000 Ωcm<sup>2</sup> for the layer 5 pyramidal cells in <xref ref-type="fig" rid="pcbi-1000877-g007">Figure 7</xref>.</p>
</sec><sec id="s4e">
<title>Extended minimum spanning tree</title>
<p>The branching growth was implemented as a greedy algorithm <xref ref-type="bibr" rid="pcbi.1000877-Prim1">[23]</xref> as in <xref ref-type="bibr" rid="pcbi.1000877-Cuntz1">[19]</xref>, <xref ref-type="bibr" rid="pcbi.1000877-Cuntz2">[20]</xref>. In some cases (<xref ref-type="fig" rid="pcbi-1000877-g005">Figure 5C</xref> rightmost, and all morphologies in <xref ref-type="fig" rid="pcbi-1000877-g006">Figures 6</xref>, <xref ref-type="fig" rid="pcbi-1000877-g007">7</xref> and <xref ref-type="fig" rid="pcbi-1000877-g008">8</xref>), quadratic diameter decay was mapped on the resulting trees <xref ref-type="bibr" rid="pcbi.1000877-Cuntz1">[19]</xref> and a soma-like increase of diameters was obtained by applying a cosine function to the diameters in close vicinity of the root (see <xref ref-type="supplementary-material" rid="pcbi.1000877.s001">Protocol S1</xref> for exact methods).</p>
</sec><sec id="s4f">
<title>Automated reconstruction</title>
<p>Two-photon microscopy 3D image stacks containing neurons filled with a fluorescent dye or expressing a fluorescent protein were subject to local brightness level thresholding. After 3D skeletonization and sparsening of the resulting carrier points, these were submitted to the same greedy algorithm (started at a user defined dendrite root location) as used for obtaining synthetic dendrites. In the case of multiple entangled neurons as in <xref ref-type="fig" rid="pcbi-1000877-g009">Fig. 9BC</xref>, manual cleaning was required using the user interface provided by the TREES toolbox. See Supplementary Information for more information including the software implementing these algorithms (<xref ref-type="supplementary-material" rid="pcbi.1000877.s001">Protocol S1</xref>).</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1000877.s001" mimetype="application/pdf" position="float" xlink:href="info:doi/10.1371/journal.pcbi.1000877.s001" xlink:type="simple"><label>Protocol S1</label><caption>
<p>The TREES toolbox documentation.</p>
<p>(6.97 MB PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>We thank Karl Farrow, Yihwa Kim, Philipp Rautenberg, Martin O'Reilly and Sarah Rieubland for testing parts of the TREES toolbox software package; Kate Buchanan and Jesper Sjöström for providing the filled neurons in <xref ref-type="fig" rid="pcbi-1000877-g009">Figure 9BC</xref>; Arnd Roth for comments on the manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1000877-Luczak1"><label>1</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Luczak</surname><given-names>A</given-names></name>
</person-group>             <year>2006</year>             <article-title>Spatial embedding of neuronal trees modeled by diffusive growth.</article-title>             <source>J Neurosci Methods</source>             <volume>157</volume>             <fpage>132</fpage>             <lpage>141</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-RamonyCajal1"><label>2</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ramon y Cajal</surname><given-names>S</given-names></name>
</person-group>             <year>1995</year>             <source>Histology of the Nervous System of Man and Vertebrates.</source>             <publisher-name>Oxford University Press</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000877-Chklovskii1"><label>3</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chklovskii</surname><given-names>DB</given-names></name>
</person-group>             <year>2004</year>             <article-title>Synaptic connectivity and neuronal morphology: two sides of the same coin.</article-title>             <source>Neuron</source>             <volume>43</volume>             <fpage>609</fpage>             <lpage>617</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Shepherd1"><label>4</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Shepherd</surname><given-names>GM</given-names></name>
<name name-style="western"><surname>Stepanyants</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Bureau</surname><given-names>I</given-names></name>
<name name-style="western"><surname>Chklovskii</surname><given-names>D</given-names></name>
<name name-style="western"><surname>Svoboda</surname><given-names>K</given-names></name>
</person-group>             <year>2005</year>             <article-title>Geometric and functional organization of cortical circuits.</article-title>             <source>Nat Neurosci</source>             <volume>8</volume>             <fpage>782</fpage>             <lpage>790</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Cherniak1"><label>5</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cherniak</surname><given-names>C</given-names></name>
</person-group>             <year>1992</year>             <article-title>Local optimization of neuron arbors.</article-title>             <source>Biol Cybern</source>             <volume>66</volume>             <fpage>503</fpage>             <lpage>510</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Klyachko1"><label>6</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Klyachko</surname><given-names>VA</given-names></name>
<name name-style="western"><surname>Stevens</surname><given-names>CF</given-names></name>
</person-group>             <year>2003</year>             <article-title>Connectivity optimization and the positioning of cortical areas.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>100</volume>             <fpage>7937</fpage>             <lpage>7941</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Chklovskii2"><label>7</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chklovskii</surname><given-names>DB</given-names></name>
<name name-style="western"><surname>Koulakov</surname><given-names>AA</given-names></name>
</person-group>             <year>2004</year>             <article-title>Maps in the brain: what can we learn from them?</article-title>             <source>Annu Rev Neurosci</source>             <volume>27</volume>             <fpage>369</fpage>             <lpage>392</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Wen1"><label>8</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wen</surname><given-names>Q</given-names></name>
<name name-style="western"><surname>Chklovskii</surname><given-names>DB</given-names></name>
</person-group>             <year>2008</year>             <article-title>A cost-benefit analysis of neuronal morphology.</article-title>             <source>J Neurophysiol</source>             <volume>99</volume>             <fpage>2320</fpage>             <lpage>2328</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Wen2"><label>9</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wen</surname><given-names>Q</given-names></name>
<name name-style="western"><surname>Stepanyants</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Elston</surname><given-names>GN</given-names></name>
<name name-style="western"><surname>Grosberg</surname><given-names>AY</given-names></name>
<name name-style="western"><surname>Chklovskii</surname><given-names>DB</given-names></name>
</person-group>             <year>2009</year>             <article-title>Maximization of the connectivity repertoire as a statistical principle governing the shapes of dendritic arbors.</article-title>             <source>Proc Natl Acad Sci U S A</source>             <volume>100</volume>             <fpage>12536</fpage>             <lpage>12541</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Rall1"><label>10</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rall</surname><given-names>W</given-names></name>
</person-group>             <year>1962</year>             <article-title>Electrophysiology of a dendritic neuron model.</article-title>             <source>Biophys J</source>             <volume>2</volume>             <fpage>145</fpage>             <lpage>167</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Segev1"><label>11</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Segev</surname><given-names>I</given-names></name>
<name name-style="western"><surname>London</surname><given-names>M</given-names></name>
</person-group>             <year>2000</year>             <article-title>Untangling dendrites with quantitative models.</article-title>             <source>Science</source>             <volume>290</volume>             <fpage>744</fpage>             <lpage>750</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-London1"><label>12</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>London</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Hausser</surname><given-names>M</given-names></name>
</person-group>             <year>2005</year>             <article-title>Dendritic computation.</article-title>             <source>Annu Rev Neurosci</source>             <volume>28</volume>             <fpage>503</fpage>             <lpage>532</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Ohki1"><label>13</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ohki</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Chung</surname><given-names>S</given-names></name>
<name name-style="western"><surname>Ch'ng</surname><given-names>YH</given-names></name>
<name name-style="western"><surname>Kara</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Reid</surname><given-names>RC</given-names></name>
</person-group>             <year>2005</year>             <article-title>Functional imaging with cellular resolution reveals precise micro-architecture in visual cortex.</article-title>             <source>Nature</source>             <volume>433</volume>             <fpage>597</fpage>             <lpage>603</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Watt1"><label>14</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Watt</surname><given-names>AJ</given-names></name>
<name name-style="western"><surname>Cuntz</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Mori</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Nusser</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Sjöström</surname><given-names>PJ</given-names></name>
<name name-style="western"><surname>Häusser</surname><given-names>M</given-names></name>
</person-group>             <year>2009</year>             <article-title>Traveling waves in developing cerebellar cortex mediated by asymmetrical Purkinje cell connectivity.</article-title>             <source>Nat Neurosci</source>             <volume>12</volume>             <fpage>463</fpage>             <lpage>473</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Poirazi1"><label>15</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Poirazi</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Brannon</surname><given-names>T</given-names></name>
<name name-style="western"><surname>Mel</surname><given-names>BW</given-names></name>
</person-group>             <year>2003</year>             <article-title>Arithmetic of subthreshold synaptic summation in a model CA1 pyramidal cell.</article-title>             <source>Neuron</source>             <volume>37</volume>             <fpage>977</fpage>             <lpage>987</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Ascoli1"><label>16</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Ascoli</surname><given-names>GA</given-names></name>
</person-group>             <year>1999</year>             <article-title>Progress and perspectives in computational neuroanatomy.</article-title>             <source>Anat Rec</source>             <volume>257</volume>             <fpage>195</fpage>             <lpage>207</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Stiefel1"><label>17</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Stiefel</surname><given-names>KM</given-names></name>
<name name-style="western"><surname>Sejnowski</surname><given-names>TJ</given-names></name>
</person-group>             <year>2007</year>             <article-title>Mapping function onto neuronal morphology.</article-title>             <source>J Neurophysiol</source>             <volume>98</volume>             <fpage>513</fpage>             <lpage>526</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Donohue1"><label>18</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Donohue</surname><given-names>DE</given-names></name>
<name name-style="western"><surname>Ascoli</surname><given-names>GA</given-names></name>
</person-group>             <year>2008</year>             <article-title>A comparative computer simulation of dendritic morphology.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000089</fpage>          </element-citation></ref>
<ref id="pcbi.1000877-Cuntz1"><label>19</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cuntz</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Borst</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Segev</surname><given-names>I</given-names></name>
</person-group>             <year>2007</year>             <article-title>Optimization principles of dendritic structure.</article-title>             <source>Theor Biol Med Model</source>             <volume>4</volume>             <fpage>21</fpage>          </element-citation></ref>
<ref id="pcbi.1000877-Cuntz2"><label>20</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Cuntz</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Forstner</surname><given-names>F</given-names></name>
<name name-style="western"><surname>Haag</surname><given-names>J</given-names></name>
<name name-style="western"><surname>Borst</surname><given-names>A</given-names></name>
</person-group>             <year>2008</year>             <article-title>The morphological identity of insect dendrites.</article-title>             <source>PLoS Comput Biol</source>             <volume>4</volume>             <fpage>e1000251</fpage>          </element-citation></ref>
<ref id="pcbi.1000877-Koene1"><label>21</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Koene</surname><given-names>RA</given-names></name>
<name name-style="western"><surname>Tijms</surname><given-names>B</given-names></name>
<name name-style="western"><surname>van Hees</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Postma</surname><given-names>F</given-names></name>
<name name-style="western"><surname>de Ridder</surname><given-names>A</given-names></name>
<etal/></person-group>             <year>2009</year>             <article-title>NETMORPH: a framework for the stochastic generation of large scale neuronal networks with realistic neuron morphologies.</article-title>             <source>Neuroinformatics</source>             <volume>7</volume>             <fpage>195</fpage>             <lpage>210</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Budd1"><label>22</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Budd</surname><given-names>JML</given-names></name>
<name name-style="western"><surname>Kovacs</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Ferecsko</surname><given-names>AS</given-names></name>
<name name-style="western"><surname>Buzas</surname><given-names>P</given-names></name>
<name name-style="western"><surname>Eysel</surname><given-names>UT</given-names></name>
<etal/></person-group>             <year>2010</year>             <article-title>Neocortical Axon Arbors Trade-off Material and Conduction Delay Conservation.</article-title>             <source>PLoS Comput Biol</source>             <volume>6</volume>             <fpage>e1000711</fpage>          </element-citation></ref>
<ref id="pcbi.1000877-Prim1"><label>23</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Prim</surname><given-names>RC</given-names></name>
</person-group>             <year>1957</year>             <article-title>Shortest connection networks and some generalizations.</article-title>             <source>Bell System Technical Journal</source>             <fpage>1389</fpage>             <lpage>1401</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Bloomfield1"><label>24</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Bloomfield</surname><given-names>SA</given-names></name>
<name name-style="western"><surname>Miller</surname><given-names>RF</given-names></name>
</person-group>             <year>1986</year>             <article-title>A functional organization of ON and OFF pathways in the rabbit retina.</article-title>             <source>J Neurosci</source>             <volume>6</volume>             <fpage>1</fpage>             <lpage>13</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Vaney1"><label>25</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Vaney</surname><given-names>DI</given-names></name>
<name name-style="western"><surname>Taylor</surname><given-names>WR</given-names></name>
</person-group>             <year>2002</year>             <article-title>Direction selectivity in the retina.</article-title>             <source>Curr Opin Neurobiol</source>             <volume>12</volume>             <fpage>405</fpage>             <lpage>410</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Demb1"><label>26</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Demb</surname><given-names>JB</given-names></name>
</person-group>             <year>2007</year>             <article-title>Cellular mechanisms for direction selectivity in the retina.</article-title>             <source>Neuron</source>             <volume>55</volume>             <fpage>179</fpage>             <lpage>186</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Sholl1"><label>27</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Sholl</surname><given-names>DA</given-names></name>
</person-group>             <year>1953</year>             <article-title>Dendritic organization in the neurons of the visual and motor cortices of the cat.</article-title>             <source>J Anat</source>             <volume>87</volume>             <fpage>387</fpage>             <lpage>406</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Rihn1"><label>28</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Rihn</surname><given-names>LL</given-names></name>
<name name-style="western"><surname>Claiborne</surname><given-names>BJ</given-names></name>
</person-group>             <year>1990</year>             <article-title>Dendritic growth and regression in rat dentate granule cells during late postnatal development.</article-title>             <source>Brain Res Dev Brain Res</source>             <volume>54</volume>             <fpage>115</fpage>             <lpage>124</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Wang1"><label>29</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Wang</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Gupta</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Toledo-Rodriguez</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Wu</surname><given-names>CZ</given-names></name>
<name name-style="western"><surname>Markram</surname><given-names>H</given-names></name>
</person-group>             <year>2002</year>             <article-title>Anatomical, physiological, molecular and circuit properties of nest basket cells in the developing somatosensory cortex.</article-title>             <source>Cereb Cortex</source>             <volume>12</volume>             <fpage>395</fpage>             <lpage>410</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Furtak1"><label>30</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Furtak</surname><given-names>SC</given-names></name>
<name name-style="western"><surname>Moyer</surname><given-names>JR</given-names><suffix>Jr</suffix></name>
<name name-style="western"><surname>Brown</surname><given-names>TH</given-names></name>
</person-group>             <year>2007</year>             <article-title>Morphology and ontogeny of rat perirhinal cortical neurons.</article-title>             <source>J Comp Neurol</source>             <volume>505</volume>             <fpage>493</fpage>             <lpage>510</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Golgi1"><label>31</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Golgi</surname><given-names>C</given-names></name>
<name name-style="western"><surname>Bentivoglio</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Swanson</surname><given-names>L</given-names></name>
</person-group>             <year>2001</year>             <article-title>On the fine structure of the pes Hippocampi major (with plates XIII-XXIII). 1886.</article-title>             <source>Brain Res Bull</source>             <volume>54</volume>             <fpage>461</fpage>             <lpage>483</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Eccles1"><label>32</label><element-citation publication-type="other" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Eccles</surname><given-names>JC</given-names></name>
<name name-style="western"><surname>Ito</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Szentagothai</surname><given-names>J</given-names></name>
</person-group>             <year>1967</year>             <source>The Cerebellum as a Neuronal Machine</source>             <publisher-loc>Oxford, England</publisher-loc>             <publisher-name>Springer-Verlag</publisher-name>          </element-citation></ref>
<ref id="pcbi.1000877-Parrish1"><label>33</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Parrish</surname><given-names>JZ</given-names></name>
<name name-style="western"><surname>Emoto</surname><given-names>K</given-names></name>
<name name-style="western"><surname>Kim</surname><given-names>MD</given-names></name>
<name name-style="western"><surname>Jan</surname><given-names>YN</given-names></name>
</person-group>             <year>2007</year>             <article-title>Mechanisms that regulate establishment, maintenance, and remodeling of dendritic fields.</article-title>             <source>Annu Rev Neurosci</source>             <volume>30</volume>             <fpage>399</fpage>             <lpage>423</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Losavio1"><label>34</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Losavio</surname><given-names>BE</given-names></name>
<name name-style="western"><surname>Liang</surname><given-names>Y</given-names></name>
<name name-style="western"><surname>Santamaria-Pang</surname><given-names>A</given-names></name>
<name name-style="western"><surname>Kakadiaris</surname><given-names>IA</given-names></name>
<name name-style="western"><surname>Colbert</surname><given-names>CM</given-names></name>
<name name-style="western"><surname>Saggau</surname><given-names>P</given-names></name>
</person-group>             <year>2008</year>             <article-title>Live neuron morphology automatically reconstructed from multiphoton and confocal imaging data.</article-title>             <source>J Neurophysiol</source>             <volume>100</volume>             <fpage>2422</fpage>             <lpage>2429</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Oberlaender1"><label>35</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Oberlaender</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Bruno</surname><given-names>RM</given-names></name>
<name name-style="western"><surname>Sakmann</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Broser</surname><given-names>PJ</given-names></name>
</person-group>             <year>2007</year>             <article-title>Transmitted light brightfield mosaic microscopy for three-dimensional tracing of single neuron morphology.</article-title>             <source>J Biomed Opt</source>             <volume>12</volume>             <fpage>064029</fpage>          </element-citation></ref>
<ref id="pcbi.1000877-Helmstaedter1"><label>36</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Helmstaedter</surname><given-names>M</given-names></name>
<name name-style="western"><surname>Briggman</surname><given-names>KL</given-names></name>
<name name-style="western"><surname>Denk</surname><given-names>W</given-names></name>
</person-group>             <year>2008</year>             <article-title>3D structural imaging of the brain with photons and electrons.</article-title>             <source>Curr Opin Neurobiol</source>             <volume>18</volume>             <fpage>633</fpage>             <lpage>641</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Vasilkoski1"><label>37</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Vasilkoski</surname><given-names>Z</given-names></name>
<name name-style="western"><surname>Stepanyants</surname><given-names>A</given-names></name>
</person-group>             <year>2009</year>             <article-title>Detection of the optimal neuron traces in confocal microscopy images.</article-title>             <source>J Neurosci Methods</source>             <volume>178</volume>             <fpage>197</fpage>             <lpage>204</lpage>          </element-citation></ref>
<ref id="pcbi.1000877-Chattopadhyaya1"><label>38</label><element-citation publication-type="journal" xlink:type="simple">             <person-group person-group-type="author">
<name name-style="western"><surname>Chattopadhyaya</surname><given-names>B</given-names></name>
<name name-style="western"><surname>Di</surname><given-names>CG</given-names></name>
<name name-style="western"><surname>Higashiyama</surname><given-names>H</given-names></name>
<name name-style="western"><surname>Knott</surname><given-names>GW</given-names></name>
<name name-style="western"><surname>Kuhlman</surname><given-names>SJ</given-names></name>
<etal/></person-group>             <year>2004</year>             <article-title>Experience and activity-dependent maturation of perisomatic GABAergic innervation in primary visual cortex during a postnatal critical period.</article-title>             <source>J Neurosci</source>             <volume>24</volume>             <fpage>9598</fpage>             <lpage>9611</lpage>          </element-citation></ref>
</ref-list>

</back>
</article>