<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-00305</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003284</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group></article-categories>
<title-group>
<article-title>A Brain-Machine Interface for Control of Medically-Induced Coma</article-title>
<alt-title alt-title-type="running-head">Brain-Machine Interface to Control Medical Coma</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Shanechi</surname><given-names>Maryam M.</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Chemali</surname><given-names>Jessica J.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Liberman</surname><given-names>Max</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Solt</surname><given-names>Ken</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Brown</surname><given-names>Emery N.</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="aff" rid="aff5"><sup>5</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>School of Electrical and Computer Engineering, Cornell University, Ithaca, New York, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Department of Electrical Engineering and Computer Science, University of California, Berkeley, California, United States of America</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Anesthesia, Critical Care and Pain Medicine, Massachusetts General Hospital, Boston, Massachusetts, United States of America</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Institute for Medical Engineering and Science, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<aff id="aff5"><label>5</label><addr-line>Department of Brain and Cognitive Sciences, Massachusetts Institute of Technology, Cambridge, Massachusetts, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Sporns</surname><given-names>Olaf</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Indiana University, United States of America</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">shanechi@cornell.edu</email> (MMS); <email xlink:type="simple">enb@neurostat.mit.edu</email> (ENB)</corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: MMS JJC ENB. Performed the experiments: MMS JJC. Analyzed the data: MMS JJC. Contributed reagents/materials/analysis tools: MMS JJC ML KS. Wrote the paper: MMS ENB.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>10</month><year>2013</year></pub-date>
<pub-date pub-type="epub"><day>31</day><month>10</month><year>2013</year></pub-date>
<volume>9</volume>
<issue>10</issue>
<elocation-id>e1003284</elocation-id>
<history>
<date date-type="received"><day>19</day><month>2</month><year>2013</year></date>
<date date-type="accepted"><day>7</day><month>8</month><year>2013</year></date>
</history>
<permissions>
<copyright-year>2013</copyright-year>
<copyright-holder>Shanechi et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the Creative Commons Attribution License, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Medically-induced coma is a drug-induced state of profound brain inactivation and unconsciousness used to treat refractory intracranial hypertension and to manage treatment-resistant epilepsy. The state of coma is achieved by continually monitoring the patient's brain activity with an electroencephalogram (EEG) and manually titrating the anesthetic infusion rate to maintain a specified level of burst suppression, an EEG marker of profound brain inactivation in which bursts of electrical activity alternate with periods of quiescence or suppression. The medical coma is often required for several days. A more rational approach would be to implement a brain-machine interface (BMI) that monitors the EEG and adjusts the anesthetic infusion rate in real time to maintain the specified target level of burst suppression. We used a stochastic control framework to develop a BMI to control medically-induced coma in a rodent model. The BMI controlled an EEG-guided closed-loop infusion of the anesthetic propofol to maintain precisely specified dynamic target levels of burst suppression. We used as the control signal the burst suppression probability (BSP), the brain's instantaneous probability of being in the suppressed state. We characterized the EEG response to propofol using a two-dimensional linear compartment model and estimated the model parameters specific to each animal prior to initiating control. We derived a recursive Bayesian binary filter algorithm to compute the BSP from the EEG and controllers using a linear-quadratic-regulator and a model-predictive control strategy. Both controllers used the estimated BSP as feedback. The BMI accurately controlled burst suppression in individual rodents across dynamic target trajectories, and enabled prompt transitions between target levels while avoiding both undershoot and overshoot. The median performance error for the BMI was 3.6%, the median bias was -1.4% and the overall posterior probability of reliable control was 1 (95% Bayesian credibility interval of [0.87, 1.0]). A BMI can maintain reliable and accurate real-time control of medically-induced coma in a rodent model suggesting this strategy could be applied in patient care.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Brain-machine interfaces (BMI) for closed-loop control of anesthesia have the potential to enable fully automated and precise control of brain states in patients requiring anesthesia care. Medically-induced coma is one such drug-induced state in which the brain is profoundly inactivated and unconscious and the electroencephalogram (EEG) pattern consists of bursts of electrical activity alternating with periods of suppression, termed burst suppression. Medical coma is induced to treat refractory intracranial hypertension and uncontrollable seizures. The state of coma is often required for days, making accurate manual control infeasible. We develop a BMI that can automatically and precisely control the level of burst suppression in real time in individual rodents. The BMI consists of novel estimation and control algorithms that take as input the EEG activity, estimate the burst suppression level based on this activity, and use this estimate as feedback to control the drug infusion rate in real time. The BMI maintains precise control and promptly changes the level of burst suppression while avoiding overshoot or undershoot. Our work demonstrates the feasibility of automatic reliable and accurate control of medical coma that can provide considerable therapeutic benefits.</p>
</abstract>
<funding-group><funding-statement>Support was provided by NIH Director's Pioneer Award DP1-OD003646 and NIH Director's Transformative Award R01 GM104948 (to ENB) and NIH K08-GM094394 (to KS) from the National Institutes of Health, Bethesda, Maryland, and by the Department of Anesthesia, Critical Care, and Pain Medicine, Massachusetts General Hospital, Boston, Massachusetts. The funders had no role in study design, data collection and analysis, decision to publish,or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="17"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Medically-induced coma (also referred to as medical coma) is a drug-induced state of profound brain inactivation and unconsciousness used to treat refractory intracranial hypertension and status epilepticus, i.e., epilepsy that is refractory to standard medical therapies <xref ref-type="bibr" rid="pcbi.1003284-Rossetti1">[1]</xref>–<xref ref-type="bibr" rid="pcbi.1003284-Hunter1">[3]</xref>. Following a traumatic brain injury, an anesthetic drug such as a barbiturate or propofol, is administered continuously to provide brain protection by decreasing the cerebral metabolism and blood flow, and thereby, intracranial hypertension <xref ref-type="bibr" rid="pcbi.1003284-Doyle1">[2]</xref>. In the treatment of status epilepticus the anesthetic is administered to directly inhibit activity in the seizure foci <xref ref-type="bibr" rid="pcbi.1003284-Hunter1">[3]</xref>. For treating both refractory intracranial hypertension and status epilepticus, the state of medical coma is achieved by continually monitoring the patient's brain activity with the electroencephalogram (EEG) and titrating the anesthetic drug infusion rate to maintain a specified level of burst suppression. Burst suppression is an EEG pattern characterized by intervals of electrical bursts that alternate with isoelectric or quiescent intervals termed suppressions <xref ref-type="bibr" rid="pcbi.1003284-Amzica1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Ching1">[5]</xref> and is an EEG marker of profound brain inactivation. In most cases, once burst suppression is achieved, it can be controlled by decreasing or increasing the infusion rate of the anesthetic to decrease or increase the suppression level.</p>
<p>No guidelines have been set to define what level of burst suppression should be achieved to maintain a medical coma <xref ref-type="bibr" rid="pcbi.1003284-Hunter1">[3]</xref>. A common practice is for the intensive care unit team to agree upon a target level of burst suppression, monitor continually the EEG and adjust manually the infusion rate of the anesthetic to maintain the target level. In most cases, the medical coma is required for at least 24 hours and frequently longer. It is not realistic to expect intensive care unit staff to maintain reliable and accurate control of a patient's brain state for such a long period by manually changing the infusion rate of the anesthetic in response to changes in the EEG observed in the bedside monitor. A more rational approach would be to define numerically a target level of burst suppression and implement a computer controlled system or a brain-machine interface (BMI) that monitors the actual level of burst suppression based on the brain's EEG activity and adjusts the rate of the anesthetic infusion pump as needed in real time to maintain the target level.</p>
<p>When used to control the delivery of anesthetic drugs, BMIs are often termed closed loop anesthetic delivery (CLAD) systems. During the last 60 years considerable work has been done on the development of CLAD systems for maintenance of general anesthesia and sedation (see <xref ref-type="sec" rid="s4">Discussion</xref>). Interest in CLAD systems has grown driven by attempts to design more efficient, cost-effective ways to administer anesthesia care. To date, no CLAD system has been developed to manage medical coma. Systems to control burst suppression have only been studied in rodent models. Vijn and Sneyd implemented a CLAD system in a rodent model to establish a paradigm for testing new anesthetics <xref ref-type="bibr" rid="pcbi.1003284-Vijn1">[6]</xref>. Cotten and colleagues used the Vijn and Sneyd paradigm to study new etomidate-derived anesthetics in a rodent model <xref ref-type="bibr" rid="pcbi.1003284-Cotten1">[7]</xref>. Both studies reported average control results rather than results for individual animals and controlled constant target levels of burst suppression rather than time-varying target levels. Here we present a BMI using a stochastic control framework for control of time-varying burst suppression target trajectories in individual rodents. Our study uses a rodent model to establish the feasibility of automatic control of burst suppression as a way to eventually achieve real-time control of medical coma for therapeutic purposes in humans. We show that for individual rodents the BMI enables accurate maintenance of multiple desired target levels within the same experimental session, enables prompt transitions between target levels without overshoot or undershoot, and allows specific constraints to be formally imposed over the infusion rates or the vital states (see <xref ref-type="sec" rid="s4">Discussion</xref>).</p>
<p>The presented BMI applies an EEG-guided, closed-loop infusion of propofol to control the level of burst suppression in medically-induced coma in a rodent model using a stochastic control framework. In this framework, we use the concept of the burst suppression probability (BSP) to define the brain's instantaneous probability of being in the suppressed state and quantify the burst suppression level. We use a two-dimensional linear compartment model to characterize the effect of propofol on the EEG. For each animal, we estimate the parameters of the compartment model by nonlinear least-squares in an experiment prior to initiating control. The BMI consists of two main components: an estimator and a controller. We derive a two-dimensional state-space algorithm to estimate the BSP in real time from the EEG thresholded and segmented into a binary time-series. Taking the BSP estimate as the control signal, we derive controllers using both a linear-quadratic-regulator (LQR) and a model predictive control strategy. We first verify the performance of the developed stochastic control framework in a simulation study based on the model parameters estimated from the actual experimental data. We then illustrate the application of our BMI system by demonstrating its ability to maintain precise control of time-varying target levels of burst suppression and to promptly transition between changing target levels without overshoot or undershoot in individual rodents.</p>
</sec><sec id="s2" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s2a">
<title>Animal Care and Use and Ethics Statement</title>
<p>Animal studies were approved by the Subcommittee on Research Animal Care, Massachusetts General Hospital, Boston, Massachusetts, which serves as our Institutional Animal Care and Use Committee. Animals were kept on a standard day-night cycle (lights on at 7:00 AM, and off at 7:00 PM), and all experiments were performed during the day.</p>
</sec><sec id="s2b">
<title>BMI Design</title>
<sec id="s2b1">
<title>Overview</title>
<p>We use a stochastic optimal control paradigm to design a real-time BMI to control medical coma using burst suppression (<xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1a</xref>). As our measure of the burst suppression level, we use the burst suppression probability (BSP), a number between 0 and 1, which defines the instantaneous probability of the EEG being suppressed. The BSP is computed in one-second intervals in real time by filtering and thresholding the EEG to convert it into binary observations (<xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1b</xref>). To estimate the BSP from the binary observations we first formulate a two-dimensional compartment model that relates the BSP to the concentrations of the anesthetic in the central compartment and the effect site compartment (<xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1c</xref>). We next estimate the parameters of the compartment model based on the EEG observations recorded in a systems identification experiment conducted prior to initiating real-time control (<xref ref-type="fig" rid="pcbi-1003284-g002">Figure 2</xref>). We carry out our stochastic control framework by developing from the two-dimensional compartment model a recursive Bayesian estimator of the concentration states and consequently of the BSP from the binary observations in real time (14)–(17). We develop a LQR controller that takes the concentration estimates as feedback and determines the drug infusion rate in real time (25). In addition to the LQR control strategy, we also implement a model predictive controller (MPC) that allows us to explicitly impose constraints on the anesthetic infusion rates (27). We present the mathematical details of the system identification, formulation of the Bayesian estimator and the two controllers for the interested readers below. These mathematical details in this subsection are not necessary to follow the remainder of the paper beginning with the <xref ref-type="sec" rid="s3">Results</xref>.</p>
<fig id="pcbi-1003284-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003284.g001</object-id><label>Figure 1</label><caption>
<title>The BMI system.</title>
<p>(a) The BMI records the EEG, segments the EEG into a binary time-series by filtering and thresholding, estimates the BSP or equivalently the effect-site concentration level based on the binary-time series, and then uses this estimate as feedback to control the drug infusion rate. (b) A sample burst suppression EEG trace. Top panel shows the EEG signal, middle panel shows the corresponding filtered EEG magnitude signal (orange) and the threshold (blue) used to detect the burst suppression events, and bottom panel shows the corresponding binary time-series with black indicating the suppression and white indicating the burst events. (c) The two-compartmental model used by the BMI to characterize the effect of propofol on the EEG.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003284.g001" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003284-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003284.g002</object-id><label>Figure 2</label><caption>
<title>System identification.</title>
<p>(a) and (b) show two sample fitted system responses. The measured BSP trace in response to a preliminary bolus of propofol is shown in grey and the response of the second-order system model in (2) fitted using nonlinear least-squares is shown in red.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003284.g002" position="float" xlink:type="simple"/></fig></sec><sec id="s2b2">
<title>Problem formulation</title>
<p>Our goal is to control the anesthetic state of the brain in burst suppression, which depends on the effect-site (i.e., brain) drug concentration. The burst suppression state or the effect-site concentration, however, are not directly observable. What we observe is the EEG signal, a stochastic process that depends on the burst suppression state. To design the closed-loop BMI, we present a certainty-equivalent optimal feedback control approach <xref ref-type="bibr" rid="pcbi.1003284-Bertsekas1">[8]</xref> by deriving an estimator for the burst suppression state based on the EEG observations and designing an optimal feedback controller that takes this estimate as a feedback signal to control the drug infusion rate in real time (<xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1a</xref>).</p>
<p>As our measure of the burst suppression state, we use the burst suppression probability (BSP) by filtering and thresholding the EEG signal in small intervals to identify the activity in each interval as a burst or a suppression event (see Experimental Procedure; <xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1b</xref>). BSP is then defined as the brain's instantaneous probability of being in the suppressed state at a given time interval. We denote the BSP at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e001" xlink:type="simple"/></inline-formula> by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e002" xlink:type="simple"/></inline-formula>. The BSP is in turn related to the effect-site drug concentration. Since higher levels of effect-site concentration should result in higher levels of BSP and since BSP should be a number between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e003" xlink:type="simple"/></inline-formula>, in this work we relate the BSP to a measure of the effect-site concentration, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e004" xlink:type="simple"/></inline-formula>, using a hyperbolic transform<disp-formula id="pcbi.1003284.e005"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e005" xlink:type="simple"/><label>(1)</label></disp-formula>Hence our goal is to control the BSP, or equivalently to control this measure of effect-site concentration, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e006" xlink:type="simple"/></inline-formula>.</p>
<p>To develop the estimator and the controller, we construct a state model for the drug concentration state that describes its dynamics in response to propofol infusion. Pharmacokinetic models characterize the dynamics of a drug's absorption, distribution, and elimination in the body (e.g. <xref ref-type="bibr" rid="pcbi.1003284-Schnider1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Arden1">[10]</xref>). We adapt a simplified two-compartment linear pharmacokinetic model <xref ref-type="bibr" rid="pcbi.1003284-Liberman1">[11]</xref> to describe the anesthetic drug's dynamics in burst suppression. In this model, one compartment represents the central plasma and the other compartment represents the effect-site or brain (<xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1c</xref>). The anesthetic drug enters the body and is eliminated from the body through the central compartment, and can flow in both directions between the two compartments. In the <xref ref-type="sec" rid="s3">Results</xref> section we show that this model is sufficient to achieve reliable and accurate control of burst suppression.</p>
<p>Given the two compartments in the model, the concentration state is two-dimensional and is denoted by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e007" xlink:type="simple"/></inline-formula>, where as before, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e008" xlink:type="simple"/></inline-formula> is the brain's anesthetic concentration and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e009" xlink:type="simple"/></inline-formula> is a measure of the central plasma concentration at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e010" xlink:type="simple"/></inline-formula>. Denoting the sequence of drug infusion rates by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e011" xlink:type="simple"/></inline-formula>, the sequence of anesthetic concentration states in the two-compartment model, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e012" xlink:type="simple"/></inline-formula>, are generated according to the linear dynamical system<disp-formula id="pcbi.1003284.e013"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e013" xlink:type="simple"/><label>(2)</label></disp-formula>where<disp-formula id="pcbi.1003284.e014"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e014" xlink:type="simple"/><label>(3)</label></disp-formula><disp-formula id="pcbi.1003284.e015"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e015" xlink:type="simple"/><label>(4)</label></disp-formula><disp-formula id="pcbi.1003284.e016"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e016" xlink:type="simple"/><label>(5)</label></disp-formula>Here <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e017" xlink:type="simple"/></inline-formula> is the discretization time step, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e018" xlink:type="simple"/></inline-formula> (or equivalently <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e019" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e020" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e021" xlink:type="simple"/></inline-formula>) are parameters of the two-compartment model that we need to estimate (<xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1c</xref>). We estimate this model for each animal from the EEG data prior to initiating real-time control as discussed in detail in the System Identification section.</p>
<p>We first derive a recursive Bayesian estimator of the burst suppression level from the EEG thresholded and segmented into a binary time-series. We then derive an optimal feedback-controller that uses this estimate as a feedback signal to decide on the drug infusion rate in real time.</p>
</sec><sec id="s2b3">
<title>Recursive Bayesian estimator</title>
<p>We now develop a recursive Bayesian estimator for the drug concentrations and consequently for the BSP based on the binary observations of the thresholded EEG signal. Since the drug concentration state, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e022" xlink:type="simple"/></inline-formula>, is a positive variable, we estimate its logarithm, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e023" xlink:type="simple"/></inline-formula>, from the EEG signal instead.</p>
<p>A recursive Bayesian estimator consists of two probabilistic models: the prior model on the time sequence of the concentration states, and the observation model relating the EEG signal to these states <xref ref-type="bibr" rid="pcbi.1003284-Brown1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Smith1">[13]</xref>. Using the two compartment model in (2), we write the prior model for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e024" xlink:type="simple"/></inline-formula> as<disp-formula id="pcbi.1003284.e025"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e025" xlink:type="simple"/><label>(6)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e026" xlink:type="simple"/></inline-formula> is a zero-mean white Gaussian noise with covariance matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e027" xlink:type="simple"/></inline-formula> and summarizes the uncertainties in the state model, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e028" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e029" xlink:type="simple"/></inline-formula>th component of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e030" xlink:type="simple"/></inline-formula>. At time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e031" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e032" xlink:type="simple"/></inline-formula> is the known drug infusion rate used by the BMI in the previous time step. Note that our prior state model is nonlinear.</p>
<p>The observation in the estimator is the binary time-series of the burst suppression events obtained by thresholding the EEG (see Experimental Procedure; <xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1b</xref>). To construct the observation model, we assume that in each time interval <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e033" xlink:type="simple"/></inline-formula> there can be at most <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e034" xlink:type="simple"/></inline-formula> suppression events and that the number of such suppression events is binomially distributed with burst suppression probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e035" xlink:type="simple"/></inline-formula>. Denoting the number of suppression events by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e036" xlink:type="simple"/></inline-formula>, the observation model is given by<disp-formula id="pcbi.1003284.e037"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e037" xlink:type="simple"/><label>(7)</label></disp-formula>where we have indicated the dependence of the BSP, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e038" xlink:type="simple"/></inline-formula>, on the states, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e039" xlink:type="simple"/></inline-formula>, explicitly.</p>
<p>Using the prior and observation models in (6) and (7), we now derive the recursive Bayesian estimator. The estimator's goal is to causally and recursively find the minimum mean-square error (MMSE) estimate of the state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e040" xlink:type="simple"/></inline-formula> at each time step, which is given by the mean of the posterior density at that time step, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e041" xlink:type="simple"/></inline-formula>. To derive the recursions and denoting the sequence of suppression counts by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e042" xlink:type="simple"/></inline-formula>, using the Bayes rule we can write the posterior as<disp-formula id="pcbi.1003284.e043"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e043" xlink:type="simple"/><label>(8)</label></disp-formula>which states the posterior density as a function of prediction density, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e044" xlink:type="simple"/></inline-formula>. Note that we have used <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e045" xlink:type="simple"/></inline-formula>, since we assume that the observations of the EEG at a given time step only depend on the concentration states at that time step and hence are conditionally independent of the previous EEG observations. Using the Chapman-Kolmogorov equation, we can in turn write the prediction density as<disp-formula id="pcbi.1003284.e046"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e046" xlink:type="simple"/><label>(9)</label></disp-formula>Here we have used the conditional independence, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e047" xlink:type="simple"/></inline-formula>, which comes from the prior model in (6). Now the second term inside the integral is just the posterior density from the previous time step. Hence substituting (9) into (8) generates the recursion. The exact expression in (8) is in general complicated and not easy to find analytically. In the special case when both the prior and observation models are linear and Gaussian, these recursions have exact analytical solutions and result in the celebrated Kalman filter. In our case, however, first, the prior model is nonlinear and second, the observation model is not Gaussian but binomial. Hence we make two approximations at every time step to compute the recursions. First, similar to the case of the extended Kalman filter, we make a linear approximation to the prior model at each time step. Second, we make a Gaussian approximation to the posterior at each time step.</p>
<p>We denote the mean of the posterior, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e048" xlink:type="simple"/></inline-formula>, by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e049" xlink:type="simple"/></inline-formula> and its covariance matrix by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e050" xlink:type="simple"/></inline-formula>. Similarly, we denote the mean of the one step prediction density, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e051" xlink:type="simple"/></inline-formula>, by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e052" xlink:type="simple"/></inline-formula> and its covariance matrix by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e053" xlink:type="simple"/></inline-formula>. As the first approximation, we linearize the prior model in (6) around the posterior mean, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e054" xlink:type="simple"/></inline-formula>. Doing so we have<disp-formula id="pcbi.1003284.e055"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e055" xlink:type="simple"/><label>(10)</label></disp-formula>where<disp-formula id="pcbi.1003284.e056"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e056" xlink:type="simple"/><label>(11)</label></disp-formula><disp-formula id="pcbi.1003284.e057"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e057" xlink:type="simple"/><label>(12)</label></disp-formula>with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e058" xlink:type="simple"/></inline-formula> denoting the evaluation of the inside expression at value <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e059" xlink:type="simple"/></inline-formula> and with<disp-formula id="pcbi.1003284.e060"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e060" xlink:type="simple"/><label>(13)</label></disp-formula></p>
<p>As the second approximation, we make a Gaussian approximation to the posterior density. Doing so, from (9) the prediction density will be approximately Gaussian since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e061" xlink:type="simple"/></inline-formula> is approximately Gaussian from (10). Using (10) we can find the prediction mean and covariance as<disp-formula id="pcbi.1003284.e062"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e062" xlink:type="simple"/><label>(14)</label></disp-formula><disp-formula id="pcbi.1003284.e063"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e063" xlink:type="simple"/><label>(15)</label></disp-formula>This is the prediction step of the estimator. Now making the Gaussian approximation we get the update step (see Supporting <xref ref-type="supplementary-material" rid="pcbi.1003284.s002">Text S1</xref> for details)<disp-formula id="pcbi.1003284.e064"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e064" xlink:type="simple"/><label>(16)</label></disp-formula><disp-formula id="pcbi.1003284.e065"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e065" xlink:type="simple"/><label>(17)</label></disp-formula>where again <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e066" xlink:type="simple"/></inline-formula> indicates the evaluation of the inside expression at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e067" xlink:type="simple"/></inline-formula> and<disp-formula id="pcbi.1003284.e068"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e068" xlink:type="simple"/><label>(18)</label></disp-formula><disp-formula id="pcbi.1003284.e069"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e069" xlink:type="simple"/><label>(19)</label></disp-formula>with<disp-formula id="pcbi.1003284.e070"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e070" xlink:type="simple"/><label>(20)</label></disp-formula></p>
<p>Hence (14)–(17) give the estimator recursions. The estimator finds the MMSE estimate of the state or equivalently the posterior mean at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e071" xlink:type="simple"/></inline-formula> in two steps: first, before data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e072" xlink:type="simple"/></inline-formula> is observed, it uses the prior model in (6) to make a prediction on the state, i.e., find <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e073" xlink:type="simple"/></inline-formula> given <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e074" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e075" xlink:type="simple"/></inline-formula>—this is the prediction step in (14) and (15). Once data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e076" xlink:type="simple"/></inline-formula> is observed, it combines the observation model in (7) with the prediction density to find the posterior mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e077" xlink:type="simple"/></inline-formula>—this is the update step in (16) and (17). Consequently since <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e078" xlink:type="simple"/></inline-formula>, we find the concentration state estimate as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e079" xlink:type="simple"/></inline-formula>, and since the BSP is related to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e080" xlink:type="simple"/></inline-formula> by a hyperbolic transform in (1), we estimate it as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e081" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2b4">
<title>Optimal feedback-controller</title>
<p>The recursive Bayesian estimator derived above provides us with a real-time estimate of the concentration states at each time step. We now design a real-time optimal feedback-controller that takes as feedback this state estimate and decides on the sequence of drug infusion rates <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e082" xlink:type="simple"/></inline-formula> to control the BSP. To find <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e083" xlink:type="simple"/></inline-formula> in the optimal control framework, we need to quantify the goal of the controller in a cost function that will then be minimized by selecting the optimal <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e084" xlink:type="simple"/></inline-formula>. For the linear state model in (2), if we pick the cost function as a quadratic function of the state and control signals given by<disp-formula id="pcbi.1003284.e085"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e085" xlink:type="simple"/><label>(21)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e086" xlink:type="simple"/></inline-formula> is the time duration of anesthesia, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e087" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e088" xlink:type="simple"/></inline-formula> are positive semidefinite and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e089" xlink:type="simple"/></inline-formula> is positive, then the optimal control signal at any time, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e090" xlink:type="simple"/></inline-formula>, is simply a linear feedback of the state at that time given by <xref ref-type="bibr" rid="pcbi.1003284-Bertsekas1">[8]</xref><disp-formula id="pcbi.1003284.e091"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e091" xlink:type="simple"/><label>(22)</label></disp-formula>where the feedback matrices, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e092" xlink:type="simple"/></inline-formula>, can be found recursively and offline <xref ref-type="bibr" rid="pcbi.1003284-Bertsekas1">[8]</xref>. This is the linear-quadratic-regulator (LQR) solution. Moreover, when the state model <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e093" xlink:type="simple"/></inline-formula> is controllable (as is the case in our problem using the experimental fits; see <xref ref-type="sec" rid="s3">Results</xref>), there exists a steady-state solution, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e094" xlink:type="simple"/></inline-formula>, for the feedback matrix in (22). This steady-state feedback matrix is the solution to the discrete form of the famous algebraic Riccati equation given by <xref ref-type="bibr" rid="pcbi.1003284-Bertsekas1">[8]</xref><disp-formula id="pcbi.1003284.e095"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e095" xlink:type="simple"/><label>(23)</label></disp-formula>where<disp-formula id="pcbi.1003284.e096"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e096" xlink:type="simple"/><label>(24)</label></disp-formula></p>
<p>In the general LQR formulation above, however, the goal is to derive the states close to <italic>zero</italic>—while limiting the total amount of control—as evident from the cost function in (21). In the control of burst suppression, our goal is to achieve a desired <italic>non-zero</italic> target BSP level, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e097" xlink:type="simple"/></inline-formula>, or equivalently to take the effect-site concentration state close to a non-zero target level <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e098" xlink:type="simple"/></inline-formula>, using as little drug as possible. Hence to find the solution, we additionally shift the origin of the state-space to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e099" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003284-Kwakernaak1">[14]</xref>. This way, the control goal is equivalent to deriving the shifted state variable close to zero, as in the classical LQR formulation. We show in the Supporting <xref ref-type="supplementary-material" rid="pcbi.1003284.s002">Text S1</xref> that, in our problem, it is possible to shift the origin and the optimal drug infusion rate is in turn given by<disp-formula id="pcbi.1003284.e100"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e100" xlink:type="simple"/><label>(25)</label></disp-formula>where<disp-formula id="pcbi.1003284.e101"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e101" xlink:type="simple"/><label>(26)</label></disp-formula>The value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e102" xlink:type="simple"/></inline-formula> at each time step is provided by the estimator.</p>
<p>Note that the LQR formulation does not impose any constraints, such as positivity of the control variables. In practice we can impose these constraints by bounding the LQR control solution in (25) appropriately (for example if the solution is negative, use zero instead). Another way to solve optimal control problems with constraints is to use a model predictive control approach as we develop next.</p>
</sec><sec id="s2b5">
<title>Model predictive controller</title>
<p>One approach to solve the optimal control problem while explicitly imposing constraints on the state and control variables is to use a model predictive controller that approximately solves the constrained optimal control problem at each time step <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e103" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003284-Bertsekas1">[8]</xref>. In model predictive control, at every time step <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e104" xlink:type="simple"/></inline-formula> we solve the optimization problem<disp-formula id="pcbi.1003284.e105"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e105" xlink:type="simple"/><label>(27)</label></disp-formula><disp-formula id="pcbi.1003284.e106"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e106" xlink:type="simple"/><label>(28)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e107" xlink:type="simple"/></inline-formula> is a finite control horizon, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e108" xlink:type="simple"/></inline-formula> is a convex set of permissible control values, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e109" xlink:type="simple"/></inline-formula> is the input to the optimization problem at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e110" xlink:type="simple"/></inline-formula> and is given by the estimator (i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e111" xlink:type="simple"/></inline-formula>). If needed, we can also add constraints on the permissible state variables in the optimization problem, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e112" xlink:type="simple"/></inline-formula>. Hence in every time step, we solve one quadratic optimization problem over the state and control variables. Since solving this constrained optimization problem over the entire time course is computationally expensive, smaller time horizons, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e113" xlink:type="simple"/></inline-formula>, are selected in practice. Solving this optimization problem and denoting the solutions by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e114" xlink:type="simple"/></inline-formula>, the model predictive controller takes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e115" xlink:type="simple"/></inline-formula> as the drug infusion rate at time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e116" xlink:type="simple"/></inline-formula>. Note that again the optimal control or drug infusion rate is a function of the value of the current state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e117" xlink:type="simple"/></inline-formula>, though a complicated function (i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e118" xlink:type="simple"/></inline-formula>). This process gets repeated for every time step.</p>
<p>In our BMI, we implement both the bounded LQR controller and the model predictive controller in which such constraints (such as positivity of drug infusion rates) are explicitly imposed in the formulation. We show that in our problem, in which there are only constraints on the drug infusion rate or equivalently the control variable, the two approaches yield approximately the same infusion rates. However, as we expand on in the <xref ref-type="sec" rid="s4">Discussion</xref> section, the recursive Bayesian estimator combined with the implemented model predictive controller could solve more general problems in which constraints are also required on the state variables and could extend our framework to the joint control of the anesthetic state and other vital states such as blood pressure.</p>
</sec></sec><sec id="s2c">
<title>Experimental Setup and Signal Acquisition</title>
<p>Surface EEG recordings were collected using extradural electroencephalogram electrodes that were surgically implanted at the following 4 stereotactic coordinates relative to lambda: A (Anterior) 0 mm L (Lateral) 0 mm, A6L3, A6L-3, and A10L2 <xref ref-type="bibr" rid="pcbi.1003284-Vijn1">[6]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Chemali1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Solt1">[16]</xref>. During implantation, general anesthesia was induced with isoflurane. At the above four stereotactic coordinates, four holes were made using a microdrill (Patterson Dental Supply Inc., Wilmington, MA). An electrode with mounting screw and socket (Plastics One, Roanoke, VA) was screwed into each of these four holes. The sockets were in turn inserted in a pedestal. Dental acrylic cement was used to permanently fix the screws, sockets and pedestal. Recording began after at least 7 days of recovery following implantation.</p>
<p>During the experiment, the potential difference between electrodes A0L0 and A6L3 was recorded and the signal was referenced to A10L2 and recorded using a QP511 Quad AC Amplifier System (Grass Instruments, West Warwick, RI) and a USB-6009 14-bit data acquisition board (National Instruments, Austin, TX). The binary signal was acquired at a sampling rate of 500 Hz and fed into our BMI. Our algorithm was implemented in a simulink-matlab framework on a HP Probook 5430 s laptop. This setup controlled a Physio 22 syringe pump (Harvard Apparatus, Holliston, MA) to deliver the propofol infusion rate. A 24 gauge intravenous catheter was placed in a lateral tail vein during brief general anesthesia with isoflurane (2% to 3%) in oxygen, and then the animal was allowed to fully recover from the isoflurane general anesthetic in room air before the start of the experiment. The temperature of the animal was monitored and maintained in the normothermic range for the duration of the experiment.</p>
</sec><sec id="s2d">
<title>Experimental Procedure</title>
<p>For all experiments, the magnitude of the raw EEG signal was low-pass filtered below 5 Hz and then thresholded to convert it into a binary signal. At the start of an experiment, the threshold level was empirically chosen based on visual inspection of the BSP and the corresponding binary data and based on the values of the filtered EEG over the bursts and suppressions. <xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1b</xref> shows the burst-suppression raw EEG, filtered EEG and threshold, and the resulting binary signal. The segmentation algorithm was run in real time. Several preliminary boluses of propofol were administered to each rat and the obtained BSP traces were used for system identification in each animal (see System Identification section below). The experiment was then conducted by giving the rat a manual propofol bolus to induce a burst suppression state, and the real-time BMI control experiment started once the BSP dropped to a level of 0.1–0.3. In the real-time BMI experiments, the goal was to acquire, maintain, and transition between three target BSP levels (low, medium, high). The order of the target levels was randomized. Each real-time BMI control experiment was conducted for an average of 62 min. Three rats were available for the experiments, weighing 366, 391, and 422 gr respectively. Each rat was used for two real-time experiments, resulting in six real-time experiments.</p>
</sec><sec id="s2e">
<title>System Identification</title>
<p>Our system identification procedure is conducted prior to real-time BMI control for each animal in a preliminary experiment and consists of two steps. First, a BSP signal is estimated from the binary thresholded EEG trace using a special case of our recursive Bayesian estimator in which we take the state to be the scalar variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e119" xlink:type="simple"/></inline-formula>. Hence the corresponding state model in the estimator imposes a smoothness constraint on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e120" xlink:type="simple"/></inline-formula> using a first-order linear Gaussian process <xref ref-type="bibr" rid="pcbi.1003284-Chemali2">[17]</xref>. Specifically, we use a special case of (10) as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e121" xlink:type="simple"/></inline-formula>. Second, the corresponding BSP estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e122" xlink:type="simple"/></inline-formula> is fitted using a non-linear least-squares procedure to minimize the sum-squared-error between the model predicted BSP and the estimated BSP. The system parameters are thus the solution to<disp-formula id="pcbi.1003284.e123"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e123" xlink:type="simple"/><label>(29)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e124" xlink:type="simple"/></inline-formula> is the model predicted BSP given the values for the system parameters (see <xref ref-type="sec" rid="s3">Results</xref> and <xref ref-type="fig" rid="pcbi-1003284-g002">Figure 2</xref>).</p>
</sec><sec id="s2f">
<title>Experimental Performance Metrics</title>
<p>To characterize the performance of the BMI at steady state, we compute the error between the target BSP at each time, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e125" xlink:type="simple"/></inline-formula>, and the controlled BSP, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e126" xlink:type="simple"/></inline-formula>, as<disp-formula id="pcbi.1003284.e127"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e127" xlink:type="simple"/><label>(30)</label></disp-formula></p>
<p>We use the error to calculate multiple standard metrics <xref ref-type="bibr" rid="pcbi.1003284-Varvel1">[18]</xref> of performance. These metrics are the median absolute deviation (MAD)<disp-formula id="pcbi.1003284.e128"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e128" xlink:type="simple"/><label>(31)</label></disp-formula>the median prediction error (MDPE)<disp-formula id="pcbi.1003284.e129"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e129" xlink:type="simple"/><label>(32)</label></disp-formula>and the median absolute performance error (MDAPE)<disp-formula id="pcbi.1003284.e130"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e130" xlink:type="simple"/><label>(33)</label></disp-formula>The MDPE is a measure of bias at steady state and the MDAPE is a measure of normalized error. We compute these metrics for low, medium, and high target BSP levels and across all levels for each experiment. The median is computed across data points at steady state. Finally we compute the median of all these measures across all experiments to quantify the overall performance of the BMI.</p>
<p>To characterize the performance of the BMI in transitioning between target BSP levels, we calculate the rise time for an upward transition and the fall time for a downward transition. These are defined as the time it takes, once the target is changed, for the BSP to reach within 0.05 BSP units of the new target BSP. We then find the rate of BSP change defined as<disp-formula id="pcbi.1003284.e131"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003284.e131" xlink:type="simple"/><label>(34)</label></disp-formula>and calculate the median of this rate across all upward transitions and also across all downward transitions.</p>
</sec><sec id="s2g">
<title>Bayesian Analysis of BMI Performance</title>
<p>In addition to calculating the steady-state error metrics above for the low, medium, and high levels in each experiment, across all levels for each experiment, and across all experiments (<xref ref-type="table" rid="pcbi-1003284-t001">Table 1</xref>), we also performed specific statistical assessments based on the error distribution at each level to examine the reliability of the BMI overall <xref ref-type="bibr" rid="pcbi.1003284-Ching2">[19]</xref>. In particular, we considered the BMI to be reliable at each level if its absolute error measure, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e132" xlink:type="simple"/></inline-formula>, was lower than a specified value with high probability. Experimentally we found that the absolute error at any time step in our BMI system was almost always below <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e133" xlink:type="simple"/></inline-formula>. Therefore we considered the BMI to be reliable at a given level if its absolute error at that level was less than 0.15 with probability ≥0.95 and <italic>highly</italic> reliable if the absolute error at each level was less than 0.10 with probability ≥0.95. This is equivalent to the 95th percentile of the absolute error distribution at a given level being less than 0.15 and 0.10, respectively. Hence we can compute from the absolute error distribution at each level the 95th percentile and consequently identify the BMI performance at each level as reliable or not.</p>
<table-wrap id="pcbi-1003284-t001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003284.t001</object-id><label>Table 1</label><caption>
<title>Performance metrics across experiments.</title>
</caption><alternatives><graphic id="pcbi-1003284-t001-1" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003284.t001" xlink:type="simple"/>
<table><colgroup span="1"><col align="left" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/><col align="center" span="1"/></colgroup>
<thead>
<tr>
<td align="left" rowspan="1" colspan="1">Experiment #</td>
<td align="left" rowspan="1" colspan="1">1</td>
<td align="left" rowspan="1" colspan="1">2</td>
<td align="left" rowspan="1" colspan="1">3</td>
<td align="left" rowspan="1" colspan="1">4</td>
<td align="left" rowspan="1" colspan="1">5</td>
<td align="left" rowspan="1" colspan="1">6</td>
<td align="left" rowspan="1" colspan="1">Median</td>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Low Level</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Abs. Dev.</td>
<td align="left" rowspan="1" colspan="1">0.027</td>
<td align="left" rowspan="1" colspan="1">0.043</td>
<td align="left" rowspan="1" colspan="1">0.017</td>
<td align="left" rowspan="1" colspan="1">0.032</td>
<td align="left" rowspan="1" colspan="1">0.034</td>
<td align="left" rowspan="1" colspan="1">0.031</td>
<td align="left" rowspan="1" colspan="1"><bold>0.032</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Abs. Perf. Error</td>
<td align="left" rowspan="1" colspan="1">5.43</td>
<td align="left" rowspan="1" colspan="1">10.72</td>
<td align="left" rowspan="1" colspan="1">4.90</td>
<td align="left" rowspan="1" colspan="1">11.44</td>
<td align="left" rowspan="1" colspan="1">8.47</td>
<td align="left" rowspan="1" colspan="1">6.18</td>
<td align="left" rowspan="1" colspan="1"><bold>7.32</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Pred. Error</td>
<td align="left" rowspan="1" colspan="1">−0.80</td>
<td align="left" rowspan="1" colspan="1">10.72</td>
<td align="left" rowspan="1" colspan="1">1.79</td>
<td align="left" rowspan="1" colspan="1">−11.44</td>
<td align="left" rowspan="1" colspan="1">−8.47</td>
<td align="left" rowspan="1" colspan="1">−3.04</td>
<td align="left" rowspan="1" colspan="1"><bold>−1.92</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Mid Level</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Abs. Dev.</td>
<td align="left" rowspan="1" colspan="1">0.018</td>
<td align="left" rowspan="1" colspan="1">0.016</td>
<td align="left" rowspan="1" colspan="1">0.019</td>
<td align="left" rowspan="1" colspan="1">0.017</td>
<td align="left" rowspan="1" colspan="1">0.052</td>
<td align="left" rowspan="1" colspan="1">0.019</td>
<td align="left" rowspan="1" colspan="1"><bold>0.019</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Abs. Perf. Error</td>
<td align="left" rowspan="1" colspan="1">2.62</td>
<td align="left" rowspan="1" colspan="1">2.32</td>
<td align="left" rowspan="1" colspan="1">3.80</td>
<td align="left" rowspan="1" colspan="1">3.35</td>
<td align="left" rowspan="1" colspan="1">7.37</td>
<td align="left" rowspan="1" colspan="1">2.68</td>
<td align="left" rowspan="1" colspan="1"><bold>3.02</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Pred. Error</td>
<td align="left" rowspan="1" colspan="1">1.75</td>
<td align="left" rowspan="1" colspan="1">1.00</td>
<td align="left" rowspan="1" colspan="1">−0.40</td>
<td align="left" rowspan="1" colspan="1">−1.45</td>
<td align="left" rowspan="1" colspan="1">−7.37</td>
<td align="left" rowspan="1" colspan="1">−0.06</td>
<td align="left" rowspan="1" colspan="1"><bold>−0.23</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">High Level</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Abs. Dev.</td>
<td align="left" rowspan="1" colspan="1">0.012</td>
<td align="left" rowspan="1" colspan="1">0.016</td>
<td align="left" rowspan="1" colspan="1">0.031</td>
<td align="left" rowspan="1" colspan="1">0.038</td>
<td align="left" rowspan="1" colspan="1">0.043</td>
<td align="left" rowspan="1" colspan="1">0.017</td>
<td align="left" rowspan="1" colspan="1"><bold>0.024</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Abs. Perf. Error</td>
<td align="left" rowspan="1" colspan="1">1.35</td>
<td align="left" rowspan="1" colspan="1">1.75</td>
<td align="left" rowspan="1" colspan="1">3.69</td>
<td align="left" rowspan="1" colspan="1">4.35</td>
<td align="left" rowspan="1" colspan="1">4.81</td>
<td align="left" rowspan="1" colspan="1">1.87</td>
<td align="left" rowspan="1" colspan="1"><bold>2.78</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Pred. Error</td>
<td align="left" rowspan="1" colspan="1">−0.81</td>
<td align="left" rowspan="1" colspan="1">−1.73</td>
<td align="left" rowspan="1" colspan="1">−3.69</td>
<td align="left" rowspan="1" colspan="1">−4.35</td>
<td align="left" rowspan="1" colspan="1">−4.81</td>
<td align="left" rowspan="1" colspan="1">−1.84</td>
<td align="left" rowspan="1" colspan="1"><bold>−2.77</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">All Levels</td>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
<td align="left" rowspan="1" colspan="1"/>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Abs. Dev.</td>
<td align="left" rowspan="1" colspan="1">0.019</td>
<td align="left" rowspan="1" colspan="1">0.022</td>
<td align="left" rowspan="1" colspan="1">0.021</td>
<td align="left" rowspan="1" colspan="1">0.032</td>
<td align="left" rowspan="1" colspan="1">0.041</td>
<td align="left" rowspan="1" colspan="1">0.022</td>
<td align="left" rowspan="1" colspan="1"><bold>0.022</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Abs. Perf. Error</td>
<td align="left" rowspan="1" colspan="1">2.82</td>
<td align="left" rowspan="1" colspan="1">3.01</td>
<td align="left" rowspan="1" colspan="1">4.14</td>
<td align="left" rowspan="1" colspan="1">4.98</td>
<td align="left" rowspan="1" colspan="1">5.61</td>
<td align="left" rowspan="1" colspan="1">3.07</td>
<td align="left" rowspan="1" colspan="1"><bold>3.61</bold></td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Median Pred. Error</td>
<td align="left" rowspan="1" colspan="1">−0.13</td>
<td align="left" rowspan="1" colspan="1">0.99</td>
<td align="left" rowspan="1" colspan="1">−1.24</td>
<td align="left" rowspan="1" colspan="1">−4.87</td>
<td align="left" rowspan="1" colspan="1">−5.60</td>
<td align="left" rowspan="1" colspan="1">−1.63</td>
<td align="left" rowspan="1" colspan="1"><bold>−1.44</bold></td>
</tr>
</tbody>
</table>
</alternatives></table-wrap>
<p>After evaluating the reliability of the BMI at each level separately, we use a Bayesian analysis to identify the reliability of the BMI across all levels. To do so, we combine the results of the reliability assessments across all levels to compute an overall assessment of reliability for the experiment. In our experiments, we tested the BMI over 20 levels with the time duration at each level between target transitions being 18.6 minutes on average. For the purpose of steady-state error calculation, we remove 5 minutes of data after an upward transition and 7 minutes of data after a downward transition to ensure that the system is at steady-state and to ensure approximate independence between levels. The independence assumption between levels is justified because if we assume even a high first-order serial correlation of 0.98 between adjacent data points separated by one second and we allow between 5 to 7 minutes for the transition between levels before making the steady-state error calculations, then the maximum correlation between the closest two points in immediately adjacent levels is between <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e134" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e135" xlink:type="simple"/></inline-formula> min <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e136" xlink:type="simple"/></inline-formula> data point per minute and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e137" xlink:type="simple"/></inline-formula> minutes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e138" xlink:type="simple"/></inline-formula> data points per minute. Because these maximum correlations are effectively 0, assuming independence between levels is highly reasonable (we acknowledge that lack of correlation is not equivalent to independence). Hence the data between levels within animals are approximately independent so that the 20 levels serve as the unit of analysis in the overall assessments of reliability.</p>
<p>Denoting the probability that the BMI system is reliable at any level by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e139" xlink:type="simple"/></inline-formula>, the total number of reliably controlled levels, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e140" xlink:type="simple"/></inline-formula>, is binomially distributed with success probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e141" xlink:type="simple"/></inline-formula> out of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e142" xlink:type="simple"/></inline-formula> independent levels. The number of successes <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e143" xlink:type="simple"/></inline-formula> is in turn equal to the number of levels for which the BMI is identified as reliable as described above. Given the binomial likelihood and taking the prior distribution for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e144" xlink:type="simple"/></inline-formula> to be the uniform distribution on the interval (0, 1), it follows that the posterior distribution for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e145" xlink:type="simple"/></inline-formula> is the beta distribution with parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e146" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e147" xlink:type="simple"/></inline-formula> <xref ref-type="bibr" rid="pcbi.1003284-Chemali1">[15]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-DeGroot1">[20]</xref>. We thus estimate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e148" xlink:type="simple"/></inline-formula> as the mode of this beta distribution and consider the BMI system reliable overall if the leftmost point of the 95% credibility interval for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e149" xlink:type="simple"/></inline-formula> is greater than 0.</p>
</sec></sec><sec id="s3">
<title>Results</title>
<p>To test our closed-loop BMI system for control of medical coma, we perform both simulation-based verification as well as real-time <italic>in vivo</italic> experiments in rats. In both cases, we implement the recursive Bayesian estimator combined with both the bounded LQR controller as well as the model predictive controller. Using both validation methods, we show that the closed-loop BMI system can accurately control time-varying target levels of burst suppression in real time.</p>
<sec id="s3a">
<title>System Identification</title>
<p>For each experiment, we first performed the system identification step for each animal using the scalar filtering and the nonlinear least-squares model fitting (see <xref ref-type="sec" rid="s2">Materials and Methods</xref>). <xref ref-type="fig" rid="pcbi-1003284-g002">Figure 2</xref> shows two sample BSP traces in response to boluses of propofol administered in preliminary experiments prior to BMI control, and the fitted system response of the second-order system in (2). The estimated parameters for <xref ref-type="fig" rid="pcbi-1003284-g002">Figures 2a and 2b</xref> are <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e150" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e151" xlink:type="simple"/></inline-formula>, respectively. Once the system model was fitted, the real-time BMI control experiments were conducted. We use the fitted system model in <xref ref-type="fig" rid="pcbi-1003284-g002">Figure 2b</xref> for our simulation-based verification below.</p>
</sec><sec id="s3b">
<title>Simulations</title>
<p>We first perform a set of simulations to verify the performance of the closed-loop BMI system. In our simulations, we assume that the anesthesia drug delivery period is a total of 45 minutes and that the goal is to keep the BSP at three desired target levels, 0.4, 0.7, 0.9, each for 15 minutes. We simulate all 6 possible order permutations of these levels. To run the simulations, we use the estimated system model in <xref ref-type="fig" rid="pcbi-1003284-g002">Figure 2b</xref>. Note that all the fitted system models in our experiments were controllable.</p>
<p>To specify the cost function (see (27) and Supporting Text (S.18)), we take <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e152" xlink:type="simple"/></inline-formula>. We choose this <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e153" xlink:type="simple"/></inline-formula> since the main goal is to have the effect-site concentration close to the target value and since the effect-site concentration is the observable through the EEG. The choice of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e154" xlink:type="simple"/></inline-formula> in turn depends on how fast we desire the controller response to be. Smaller values of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e155" xlink:type="simple"/></inline-formula> result in faster controller response since the cost on the amount of drug infusion is reduced. Here we pick <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e156" xlink:type="simple"/></inline-formula> for our desired response.</p>
<p>We take the discretization step to be <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e157" xlink:type="simple"/></inline-formula> sec. This means that the closed-loop system updates its estimate of the BSP and its drug infusion rate every second. To simulate a trial of the closed-loop controlled system response, at each time <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e158" xlink:type="simple"/></inline-formula> we use <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e159" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e160" xlink:type="simple"/></inline-formula> to find <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e161" xlink:type="simple"/></inline-formula> using (2) with initial condition <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e162" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e163" xlink:type="simple"/></inline-formula>. To get the binary output of the thresholded EEG within this time step, we generate a realization of the binomial distribution in (7) with mean <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e164" xlink:type="simple"/></inline-formula> and using a sampling rate of 10 Hz (i.e., taking <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e165" xlink:type="simple"/></inline-formula>). Given this binomial realization, we use the recursive Bayesian estimator to estimate the concentration state <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e166" xlink:type="simple"/></inline-formula>, and then use this estimate as feedback in the controller to decide on the infusion rate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e167" xlink:type="simple"/></inline-formula>.</p>
<p>We impose the constraints on the control (i.e., drug infusion rate) by first finding the unconstrained control solution from (25) and then using the closest value to it in the constrained feasible set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e168" xlink:type="simple"/></inline-formula>. For example, to impose positivity and for negative control solutions we use zero instead. We can similarly do this for constraints on the maximum drug infusion rate.</p>
<p><xref ref-type="fig" rid="pcbi-1003284-g003">Figure 3</xref> shows sample closed-loop controlled BSP traces for each of the 6 possible permutations of the desired target trajectories. Here the only imposed constraint is positivity of the drug infusion rates. In each subfigure, the top panel shows the BSP traces and the bottom panel shows the drug infusion rate. The stochastic control framework can achieve successful control of burst-suppression. The framework is particularly successful in changing the BSP level without overshoot or undershoot.</p>
<fig id="pcbi-1003284-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003284.g003</object-id><label>Figure 3</label><caption>
<title>Simulated closed-loop controlled BSP traces.</title>
<p>In each subfigure, the top panel shows the BSP traces and the bottom panel shows the drug infusion rate. In the top panels, sample trials of the closed-loop controlled BSP traces are shown in black and the corresponding estimated BSP traces are shown in grey. The time-varying target BSP level is shown in green. The bottom panel shows the corresponding controller infusion rates. Each subfigure (a–f) corresponds to one possible permutation of the 3 BSP target levels.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003284.g003" position="float" xlink:type="simple"/></fig>
<p>We also tested the model predictive controller with various time horizons, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e169" xlink:type="simple"/></inline-formula>. In the model predictive controller, we impose the constraints on the control inputs (i.e., drug infusion rates) explicitly in the formulation and thus find the constrained (approximately) optimal solution. Since our goal is to compare the bounded LQR and MPC control strategies in this set of simulations, we assume that both controllers know the BSP perfectly at each time (i.e., we use the true <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e170" xlink:type="simple"/></inline-formula> as feedback in the controller). We compare the MPC drug infusion rate with the bounded LQR infusion rate in <xref ref-type="fig" rid="pcbi-1003284-g004">Figure 4</xref>, where the constraint is positivity on the drug infusion rate. As we increase the optimization horizon, the two solutions converge. This shows that, in this problem, solving the unconstrained LQR and then bounding it is approximately optimal. The controlled BSP in <xref ref-type="fig" rid="pcbi-1003284-g003">Figure 3</xref> is noisier than in <xref ref-type="fig" rid="pcbi-1003284-g004">Figure 4</xref> because in the former the BSP is estimated from a stochastic binary time-series emulating the segmented EEG (<xref ref-type="fig" rid="pcbi-1003284-g001">Figure 1b</xref>) and in the latter BSP is assumed to be perfectly known to the controllers. We can also show that, similarly, when an upper-bound on the drug infusion rate is desired, the two solutions again converge (<xref ref-type="fig" rid="pcbi-1003284-g005">Figure 5</xref>). It is important to note, however, that in our problem no constraints are placed on the state. Our recursive Bayesian estimator combined with the implemented real-time MPC can extend our framework to solving more complex problems with constraints also on the state variables, such as blood pressure (see <xref ref-type="sec" rid="s4">Discussion</xref>).</p>
<fig id="pcbi-1003284-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003284.g004</object-id><label>Figure 4</label><caption>
<title>Comparison of the bounded LQR and MPC strategies.</title>
<p>In each subfigure, the top panel shows the closed-loop controlled BSP traces using the bounded LQR control strategy and using the MPC strategy with various time horizons, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e171" xlink:type="simple"/></inline-formula> time samples (seconds). The bottom panel shows the corresponding drug infusion rates. The only constraint imposed here is non-negativity of the drug infusion rate. Each subfigure (a–f) corresponds to one possible permutation of the 3 BSP target levels.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003284.g004" position="float" xlink:type="simple"/></fig><fig id="pcbi-1003284-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003284.g005</object-id><label>Figure 5</label><caption>
<title>Comparison of the bounded LQR and MPC strategies with upper-bound constraints on the drug infusion rates.</title>
<p>In each subfigure, the top panel shows the closed-loop controlled BSP traces using the bounded LQR control strategy and using the MPC strategy with various time horizons, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e172" xlink:type="simple"/></inline-formula> time samples (seconds). The bottom panel shows the corresponding drug infusion rates. In addition to being non-negative, here the drug infusion rate is required to be less than 2.4 mg/min. Here we have shown two example permutations of the target levels but the bounded LQR and the MPC drug infusion rates converge with increasing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e173" xlink:type="simple"/></inline-formula> in all cases.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003284.g005" position="float" xlink:type="simple"/></fig>
<p>Even though simulation-based validations are helpful in assessing the behavior of the BMI, the true test of the BMI is in <italic>in vivo</italic> experiments as we present below.</p>
</sec><sec id="s3c">
<title>BMI for Closed-Loop Control of Medical Coma in Rodents</title>
<p>We implemented our BMI in experiments with rodents and tested it for controlling the level of burst suppression in real time. The BMI used the recursive Bayesian estimator combined with either the bounded LQR controller or the MPC. The BMI in both cases could successfully and accurately control the BSP level in rodents in real time.</p>
<p>The control sessions lasted an average of 62 minutes and consisted of at least 3 target BSP levels, thus requiring at least 3 transitions. <xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6</xref> shows the BSP and the drug infusion rate in 6 closed-loop BMI sessions that were run in real time in rodents (see also Supporting <xref ref-type="supplementary-material" rid="pcbi.1003284.s001">Figure S1</xref> that shows the evolution of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e174" xlink:type="simple"/></inline-formula> in these experiments). <xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6a–e</xref> were run with the bounded LQR controller and <xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6f</xref> was run with the MPC. All experiments except for the one in <xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6e</xref> consisted of 3 target levels, identified as low, medium, and high levels for the purpose of metric calculation. The experiment in <xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6e</xref> consisted of 5 target BSP levels and hence we identify the lowest two levels as the low level and the highest two levels as the high level to calculate the metrics.</p>
<fig id="pcbi-1003284-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003284.g006</object-id><label>Figure 6</label><caption>
<title><italic>In vivo</italic> real-time BMI control of burst suppression in individual rodents.</title>
<p>In each subfigure, the top panel shows the estimated closed-loop controlled BSP trace (black) and the time-varying target level (green), and the bottom panel shows the corresponding BMI drug infusion rate using the bounded LQR strategy (a–e) and the MPC strategy (f).</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003284.g006" position="float" xlink:type="simple"/></fig>
<p>As is evident in <xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6</xref>, the BMI could successfully and promptly transition between levels and accurately maintain the BSP at a desired target level. At steady state, the BMI-controlled BSP closely followed the target BSP level. The real-time variations in the drug infusion rate at higher levels of BSP, e.g., at 0.9, were larger than at the lower levels since larger amounts of propofol are needed to keep the EEG in suppression 90% of the time while allowing for the bursts 10% of the time (this can also be seen from (1) by observing that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e175" xlink:type="simple"/></inline-formula> is monotonically increasing with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e176" xlink:type="simple"/></inline-formula>). The MDAPE (measure of normalized error) across all experiments for the low, medium, and high target BSP levels was only 7.32%, 3.02%, and 2.78%, respectively. When considering all levels, the MDAPE was only 3.61% (<xref ref-type="table" rid="pcbi-1003284-t001">Table 1</xref>). Moreover, the deviation between the target BSP level and the BMI-controlled BSP, measured through MAD, was 0.03 BSP units or less for any level. Across all levels the MAD was only 0.02 BSP units (<xref ref-type="table" rid="pcbi-1003284-t001">Table 1</xref>), a negligible error in practice. Finally, the MDPE was small across all levels. Together, these results demonstrate that the BMI achieved precise control of multiple target burst suppression levels at steady state within the same experimental session.</p>
<p>We also performed a Bayesian analysis to assess overall reliability of the BMI based on the steady state error distributions at each of the 20 levels used in the experiments (<xref ref-type="sec" rid="s2">Materials and Methods</xref>). The data at different levels within animal are approximately independent so that the 20 levels serve as the unit of analysis in the overall assessment of reliability. The 95th percentile of the absolute error distribution at each of the 20 levels was less than 0.15 giving a mode of the posterior density for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e177" xlink:type="simple"/></inline-formula> (probability that the BMI is reliable at any level) of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e178" xlink:type="simple"/></inline-formula> and a 95% credibility (Bayesian confidence) interval for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e179" xlink:type="simple"/></inline-formula> of (0.87 to 1.00) (<xref ref-type="fig" rid="pcbi-1003284-g007">Figure 7</xref>). The lower bound of the 95% credibility interval of 0.87 is well above 0, the point of no control. These findings establish that the system is reliable. In addition, for 17 out of 20 of the levels the 95th percentile of the absolute error distribution was less than 0.1, giving a mode of the posterior density for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e180" xlink:type="simple"/></inline-formula> of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e181" xlink:type="simple"/></inline-formula> and a 95% credibility interval for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e182" xlink:type="simple"/></inline-formula> of (0.67 to 1.00) (<xref ref-type="fig" rid="pcbi-1003284-g007">Figure 7</xref>). This finding suggests that furthermore the BMI system meets our definition of being <italic>highly</italic> reliable overall. We therefore conclude that the BMI system is highly reliable for real-time control of medical coma using burst suppression across dynamic targets.</p>
<fig id="pcbi-1003284-g007" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003284.g007</object-id><label>Figure 7</label><caption>
<title>Reliability of the real-time BMI.</title>
<p>Each subfigure (a–f) corresponds to one of the six real-time BMI experiments (<xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6</xref>) and shows the modified boxplot summaries for the absolute error distribution at each of the levels used in that experiment. The lower and upper end of the boxes represent the 25th and 75th percentiles of the absolute error distribution and the middle line in each box represents the median. Whiskers represent the 95th percentile of the absolute error distribution at each level. The BMI is reliable (95th percentile of the absolute error &lt;0.15) at all 20 levels. Additionally, the BMI is <italic>highly</italic> reliable (95th percentile of the absolute error &lt;0.1) at 17 of the 20 levels.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003284.g007" position="float" xlink:type="simple"/></fig>
<p>In addition to accurate and reliable control at steady state, the BMI was especially successful in promptly transitioning between target BSP levels. The BMI could increase the level of BSP rapidly, while avoiding overshoot. To increase the BSP, the BMI immediately increased the drug infusion rate once the target was increased, and then gradually reduced the infusion rate until the BSP approached the new target level. The rate at which the BMI increased the BSP level was 0.32 BSP units per minute. The median rise time in our experiments was under a minute (49 seconds).</p>
<p>The BMI was also able to decrease the BSP level without undershoot. To decrease the BSP, the BMI first stopped the drug infusion and then gradually restarted it once the BSP approached the lower target BSP level. The rate at which the BMI could decrease the BSP level was 0.11 BSP units per minute. In decreasing the level of BSP, the time response of the BMI is mainly governed by the clearance rate in the pharmacokinetic model of the rat. Hence although the controller stopped the drug infusion immediately once the target was dropped, it took a few minutes for the BSP to go down to the desired target level. The median fall time in our experiments was 4.45 minutes.</p>
<p>These results thus demonstrate the feasibility of automatic reliable and accurate control of medically-induced coma using a BMI.</p>
</sec></sec><sec id="s4">
<title>Discussion</title>
<p>To study the feasibility of automating control of medically-induced coma, we developed a BMI to control burst suppression in a rodent model. Our BMI system reliably and accurately controlled burst suppression in individual rodents across dynamic target trajectories. The BMI promptly changed the BSP in response to a change in target level without overshoot or undershoot and accurately maintained a desired target BSP level with a median performance error of 3.6% and a percent bias of -1.4%.</p>
<sec id="s4a">
<title>BMI Development for Control of Anesthesia-Induced Brain States</title>
<p>Our work contributes to the extensive BMI research in anesthesiology aimed at controlling brain states under general anesthesia. This field began in the 1950s <xref ref-type="bibr" rid="pcbi.1003284-Bickford1">[21]</xref>–<xref ref-type="bibr" rid="pcbi.1003284-Mayo1">[23]</xref> and developed further in the 1980s <xref ref-type="bibr" rid="pcbi.1003284-Schwilden1">[24]</xref>. BMI systems for control of sedation are now commercially available <xref ref-type="bibr" rid="pcbi.1003284-Rinehart1">[25]</xref> and have been recently approved for use in the United States. The most commonly used control signal is the Bispectral Index (BIS) <xref ref-type="bibr" rid="pcbi.1003284-Struys1">[26]</xref>–<xref ref-type="bibr" rid="pcbi.1003284-Ionescu1">[40]</xref>. Other control signals include an auditory evoked potential index <xref ref-type="bibr" rid="pcbi.1003284-Kenny1">[41]</xref>, the spectrogram median frequency <xref ref-type="bibr" rid="pcbi.1003284-Schwilden1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Schwilden2">[42]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Schwilden3">[43]</xref>, a wavelet-based index <xref ref-type="bibr" rid="pcbi.1003284-Hahn1">[44]</xref> and an entropy measure <xref ref-type="bibr" rid="pcbi.1003284-Liu3">[45]</xref>. Both standard and non-standard control paradigms <xref ref-type="bibr" rid="pcbi.1003284-Schwilden1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Puri1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-DeSmet2">[35]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Kenny1">[41]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Liu3">[45]</xref> have been used in these systems with the principal objective being control of unconsciousness <xref ref-type="bibr" rid="pcbi.1003284-Schwilden1">[24]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Struys1">[26]</xref>–<xref ref-type="bibr" rid="pcbi.1003284-Liu2">[32]</xref>, . A recent report controlled both antinociception and unconsciousness <xref ref-type="bibr" rid="pcbi.1003284-Liu3">[45]</xref>. Although several criteria have been established for successful control, a criterion used in BIS studies has been maintaining BIS not at a specific value but in the broad range between 40 to 60 <xref ref-type="bibr" rid="pcbi.1003284-Struys1">[26]</xref>–<xref ref-type="bibr" rid="pcbi.1003284-Mortier1">[39]</xref>. Vijn and Sneyd <xref ref-type="bibr" rid="pcbi.1003284-Vijn1">[6]</xref> and Cotten et al. <xref ref-type="bibr" rid="pcbi.1003284-Cotten1">[7]</xref> controlled constant target levels of burst suppression in rodent models and reported average control results over rodents. Schwilden demonstrated control of median frequency in individual human subjects <xref ref-type="bibr" rid="pcbi.1003284-Schwilden1">[24]</xref>. None of these studies considered control of dynamic time-varying trajectories.</p>
<p>We developed a BMI for real-time control of burst suppression across time-varying target levels in individual rodents using a stochastic control framework. Our stochastic control framework consists of a two-dimensional state estimator and an optimal feedback controller. In our formulation, we assumed a stochastic form of the log transformed version of our system to incorporate both the two-dimensional system model and noise in our estimates and to ensure non-negative concentration estimates (<xref ref-type="disp-formula" rid="pcbi.1003284.e013">Eqs. (2)</xref> and <xref ref-type="disp-formula" rid="pcbi.1003284.e025">(6)</xref>). This model-based two-dimensional state estimator is one major reason that the current BMI largely avoided overshoot and undershoot. By incorporating the two-dimensional stochastic dynamic model and computing both <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e183" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e184" xlink:type="simple"/></inline-formula> at each update (<xref ref-type="disp-formula" rid="pcbi.1003284.e062">Eqs. (14)</xref>–<xref ref-type="disp-formula" rid="pcbi.1003284.e065">(17)</xref>), the estimator predicted the effect of the real-time drug infusion rate on the BSP. In upward transitions, this avoided underestimating the BSP in response to drug infusion that would result in overestimating the required amount of drug and hence in an overshoot. This similarly prevented undershoot in downward transitions. Our framework is thus analogous to maintaining control in a navigation system by estimating both position and velocity.</p>
<p>In addition to the two-dimensional estimation algorithm, the BMI consists of LQR and MPC controllers. Controllers using MPC and LQR strategies have been used successfully in many applications. We recently demonstrated the success of a LQR paradigm to control a motor neuroprosthetic device using point process observations of spiking activity and a linear Gaussian kinematic state model <xref ref-type="bibr" rid="pcbi.1003284-Shanechi1">[46]</xref>–<xref ref-type="bibr" rid="pcbi.1003284-Shanechi5">[50]</xref>. MPC has been widely used in process control and chemical industries <xref ref-type="bibr" rid="pcbi.1003284-Morari1">[51]</xref>–<xref ref-type="bibr" rid="pcbi.1003284-Camponogara1">[53]</xref> and has been previously applied to closed-loop administration of analgesics <xref ref-type="bibr" rid="pcbi.1003284-Gentilini1">[54]</xref>, for sedation control using the BIS as the control signal <xref ref-type="bibr" rid="pcbi.1003284-Sawaguchi1">[55]</xref> and in a simulation study for control of BIS during surgery <xref ref-type="bibr" rid="pcbi.1003284-Ionescu1">[40]</xref>. The LQR and MPC controllers are both formulated in an optimal feedback control framework <xref ref-type="bibr" rid="pcbi.1003284-Bertsekas1">[8]</xref>. They specify the control objective as a cost function to be minimized by selecting the optimal infusion rates. We can therefore adjust the behavior of these controllers, for example the speed of transitions, by adjusting the penalty on various terms in the cost function. While our LQR implementation imposes constraints on the drug infusion rates by bounding the control solution, our MPC implementation allows us to impose explicitly any required constraints on both the states and the drug infusion rates, such as non-negative or bounded infusion rates, by solving a constrained optimization problem at each time step in real time. For example, if the BMI system always needed to keep the drug infusion rate below a specified maximum level, the MPC controller could impose this explicitly in the solution. Since the only constraints in our problem were on the control variable (i.e., the infusion rate), the LQR and MPC strategies performed similarly (<xref ref-type="fig" rid="pcbi-1003284-g005">Figure 5</xref>). However, the recursive Bayesian estimator combined with the real-time MPC strategy can be used to solve problems that require constraints on the state variables as well. This situation could arise in problems requiring joint control of multiple state variables, such as controlling simultaneously the anesthetic level and other physiological variables such as blood pressure and heart rate.</p>
<p>Other approaches can also be used for anesthesia control. We recently reported successful control of burst suppression using a proportional-integral (PI) controller in simulated rodent <xref ref-type="bibr" rid="pcbi.1003284-Liberman1">[11]</xref>, simulated human <xref ref-type="bibr" rid="pcbi.1003284-Liberman1">[11]</xref>, and actual rodent experiments <xref ref-type="bibr" rid="pcbi.1003284-Ching2">[19]</xref>. The experimental studies differed from the ones presented here in that the transitions between target levels were carried out in 5 to 10 minutes ramps. Also, the BSP estimation algorithm in those studies was one rather than two dimensional. Given the stochastic two-dimensional dynamic model and the EEG signal, here we used a stochastic control paradigm consisting of a two-dimensional estimator and an optimal feedback controller in place of the one dimensional estimator and the deterministic PI controller. The model-based two-dimensional state estimator in our framework is one major reason that the current BMI can both make prompt and reliable transitions between levels (median rise time of 49 seconds and fall time of 4.45 minutes) and avoids BSP overshoots and undershoots in any transitions. The stochastic control framework also offers tremendous flexibility. In particular, the MPC allows us to extend the BMI to control with constraints on the control variable and a vital variable such as blood pressure. The stochastic optimal formulation also provides a framework for adjusting the behavior of the BMI by simply modifying the cost function. Finally, while the mathematical derivation for the stochastic framework may be more complex, the final infusion rate solution is straight forward. The LQR solution is given simply by a linear function of the state estimate at each time. The MPC controller optimization problem is convex and can be solved using existing convex optimization software. Indeed we ran the MPC in real-time in our rodent experiments on a standard laptop (<xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6f</xref>).</p>
</sec><sec id="s4b">
<title>A BMI System for Control of Burst Suppression</title>
<p>We chose levels of burst suppression as a control target because it is a physiologically defined brain state <xref ref-type="bibr" rid="pcbi.1003284-Amzica1">[4]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Ching1">[5]</xref> with a well-defined EEG signature that can be readily characterized in real time for the purpose of control. The linear two-dimensional state model (<xref ref-type="disp-formula" rid="pcbi.1003284.e013">Eq. (2)</xref>) is the simplest pharmacokinetics representation for relating the concentrations of anesthetic in the blood and in the brain to BSP (<xref ref-type="disp-formula" rid="pcbi.1003284.e005">Eq. (1)</xref>) computed from burst suppression in the EEG. This simplified two-compartment model was sufficient in our experiments to achieve reliable and accurate control of burst suppression.</p>
<p>Our Bayesian state estimator (<xref ref-type="disp-formula" rid="pcbi.1003284.e062">Eqs. (14)</xref>–<xref ref-type="disp-formula" rid="pcbi.1003284.e065">(17)</xref>) computes the central compartment and the effect-site concentrations in real time from the EEG converted into binary observations. Here, both the prior state model (<xref ref-type="disp-formula" rid="pcbi.1003284.e025">Eq. (6)</xref>) and the binomial observation model (<xref ref-type="disp-formula" rid="pcbi.1003284.e037">Eq. (7)</xref>) are non-linear functions of the state. We thus use two approximations at each time step to derive the estimator recursions, a linear approximation to the prior model at that step and a Gaussian approximation to the posterior model. Gaussian Laplace-type approximations have been successfully used in many applications for example in our previous work estimating states with linear prior models from point process observations of neural spiking activity <xref ref-type="bibr" rid="pcbi.1003284-Brown1">[12]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Smith1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Shanechi2">[47]</xref>–<xref ref-type="bibr" rid="pcbi.1003284-Shanechi5">[50]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Eden1">[56]</xref>–<xref ref-type="bibr" rid="pcbi.1003284-Smith4">[59]</xref>. Our system identification procedure used the one-dimensional version of the binary filter, coupled with a non-linear least squares procedure to estimate model parameters (<xref ref-type="disp-formula" rid="pcbi.1003284.e013">Eq. (2)</xref>) for each animal and thereby, implement individually tailored control strategies. Future work can extend this system identification procedure to an efficient expectation-maximization (EM) algorithm by replacing the one-dimensional binary filter algorithm with the current Bayesian state estimator <xref ref-type="bibr" rid="pcbi.1003284-Smith1">[13]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Dempster1">[60]</xref>, or can design an adaptive estimator that not only computes the BSP but also updates the system parameters during the several hours of real-time control.</p>
<p>We demonstrated in a rodent model that the BMI achieved reliable and accurate control of burst suppression. It would also be valuable as a next step to test this BMI in a rodent model of refractory seizures or intractable intracranial hypertension prior to testing it in humans.</p>
</sec><sec id="s4c">
<title>A BMI System for Control of Medically-Induced Coma and States of General Anesthesia</title>
<p>A BMI system to automatically control medically-induced coma could provide considerable cost-saving and therapeutic benefits. Although the state of medical coma is often required for several days, it is achieved by manually adjusting the anesthetic infusion rate to maintain a specified level of burst suppression assessed by continual visual inspection of the EEG. Automated control would allow much more efficient use of intensive care unit personnel as a single nurse per shift would not have to be solely dedicated to the task of manually managing the drug infusion of a single patient for several days. Hence even assuming the same patient outcomes between automated and manual control, there could be important savings in intensive care unit resources under the automated control regimen.</p>
<p>In addition to the inefficient use of the intensive care unit staff, manual manipulation of the infusion rate does not approximate the infusion rate changes of an automatic controller (<xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6</xref>). Similarly, visual inspection of the EEG does not provide an accurate estimate of the state of burst suppression. The current work establishes the feasibility of implementing automated, accurate and reliable control of medical coma in a rodent model suggesting that a BMI could be developed to study whether such accurate control improves patient outcomes. For example, reliable and accurate control of medical coma could offer the possibility of ensuring adequate brain protection for intracranial hypertension and adequate therapy for status epilepticus while using the least amount of anesthetic and minimizing overshoots when transitioning to a desired level of burst suppression. Reliable and accurate control would also make it easier to induce periodic arousals to conduct neurological assessments and prevent anesthetic overdose syndrome <xref ref-type="bibr" rid="pcbi.1003284-Kam1">[61]</xref>. To establish these potential therapeutic benefits of reliable and accurate control of medical coma, outcome studies in rodent models of intracranial pressure and status epilepticus will be required before proceeding to human investigations.</p>
<p>We have also shown that other states of general anesthesia have well defined EEG signatures <xref ref-type="bibr" rid="pcbi.1003284-Lewis1">[62]</xref>, <xref ref-type="bibr" rid="pcbi.1003284-Purdon1">[63]</xref>. Therefore, the ability of our BMI to track accurately changing target levels of burst suppression further suggests that it could be adapted to control states of general anesthesia and sedation for patients requiring surgical or non-surgical procedures. Our stochastic estimation paradigm and model predictive controller could also be used to control jointly the state of general anesthesia and physiological variables such as blood pressure. These investigations will be the topics of future reports.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003284.s001" mimetype="image/tiff" xlink:href="info:doi/10.1371/journal.pcbi.1003284.s001" position="float" xlink:type="simple"><label>Figure S1</label><caption>
<p><bold>Evolution of </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e185" xlink:type="simple"/></inline-formula><bold> and </bold><inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e186" xlink:type="simple"/></inline-formula><bold> in real-time BMI experiments.</bold> Each subfigure shows the estimated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e187" xlink:type="simple"/></inline-formula> (top panel) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003284.e188" xlink:type="simple"/></inline-formula> (bottom panel) in the six real-time BMI experiments (<xref ref-type="fig" rid="pcbi-1003284-g006">Figure 6</xref>) using the bounded LQR strategy (a–e) and the MPC strategy (f).</p>
<p>(TIF)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003284.s002" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003284.s002" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><bold>Derivation of the update step of the recursive Bayesian estimator and the optimal feedback control solution.</bold></p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back><ref-list>
<title>References</title>
<ref id="pcbi.1003284-Rossetti1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rossetti</surname><given-names>AO</given-names></name>, <name name-style="western"><surname>Reichhart</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Schaller</surname><given-names>MD</given-names></name>, <name name-style="western"><surname>Despland</surname><given-names>PA</given-names></name>, <name name-style="western"><surname>Bogousslavsky</surname><given-names>J</given-names></name> (<year>2004</year>) <article-title>Propofol treatment of refractory status epilepticus: a study of 31 episodes</article-title>. <source>Epilepsia</source> <volume>45</volume>: <fpage>757</fpage>–<lpage>763</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Doyle1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Doyle</surname><given-names>PW</given-names></name>, <name name-style="western"><surname>Matta</surname><given-names>BF</given-names></name> (<year>1999</year>) <article-title>Burst suppression or isoelectric encephalogram for cerebral protection: evidence from metabolic suppression studies</article-title>. <source>Br J Anaesth</source> <volume>83</volume>: <fpage>580</fpage>–<lpage>584</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Hunter1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hunter</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Young</surname><given-names>GB</given-names></name> (<year>2012</year>) <article-title>Status epilepticus: a review, with emphasis on refractory cases</article-title>. <source>Can J Neurol Sci</source> <volume>39</volume>: <fpage>157</fpage>–<lpage>169</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Amzica1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Amzica</surname><given-names>F</given-names></name> (<year>2009</year>) <article-title>Basic physiology of burst-suppression</article-title>. <source>Epilepsia</source> <volume>50</volume> (<issue>Suppl 12</issue>) <fpage>38</fpage>–<lpage>39</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Ching1"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ching</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Purdon</surname><given-names>PL</given-names></name>, <name name-style="western"><surname>Vijayan</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Kopell</surname><given-names>NJ</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name> (<year>2012</year>) <article-title>A neurophysiological-metabolic model for burst suppression</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>109</volume>: <fpage>3095</fpage>–<lpage>3100</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Vijn1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Vijn</surname><given-names>PCM</given-names></name>, <name name-style="western"><surname>Sneyd</surname><given-names>JR</given-names></name> (<year>1998</year>) <article-title>I.v. anesthesia and EEG burst suppression in rats: bolus injections and closed-loop infusions</article-title>. <source>Br J Anaesth</source> <volume>81</volume>: <fpage>415</fpage>–<lpage>421</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Cotten1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Cotten</surname><given-names>JF</given-names></name>, <name name-style="western"><surname>Ge</surname><given-names>RL</given-names></name>, <name name-style="western"><surname>Banacos</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Pejo</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Husain</surname><given-names>SS</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Closed-loop continuous infusions of etomidate and etomidate analogs in rats: A comparative study of dosing and the impact on adrenocortical function</article-title>. <source>Anesthesiology</source> <volume>115</volume>: <fpage>764</fpage>–<lpage>773</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Bertsekas1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bertsekas</surname><given-names>D</given-names></name> (<year>2005</year>) <article-title>Dynamic Programming and Optimal Control</article-title>. <source>Athena Scientific</source></mixed-citation>
</ref>
<ref id="pcbi.1003284-Schnider1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schnider</surname><given-names>TW</given-names></name>, <name name-style="western"><surname>Minto</surname><given-names>CF</given-names></name>, <name name-style="western"><surname>Gambus</surname><given-names>PL</given-names></name>, <name name-style="western"><surname>Andresen</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Goodale</surname><given-names>DB</given-names></name>, <etal>et al</etal>. (<year>1998</year>) <article-title>The influence of method of administration and covariates on the pharmacokinetics of propofol in adult volunteers</article-title>. <source>Anesthesiology</source> <volume>88</volume>: <fpage>1170</fpage>–<lpage>1182</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Arden1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Arden</surname><given-names>JR</given-names></name>, <name name-style="western"><surname>Holley</surname><given-names>FO</given-names></name>, <name name-style="western"><surname>Stanski</surname><given-names>DR</given-names></name> (<year>1986</year>) <article-title>Increased sensitivity to etomidate in the elderly: initial distribution versus altered brain response</article-title>. <source>Anesthesiology</source> <volume>65</volume>: <fpage>19</fpage>–<lpage>27</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Liberman1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liberman</surname><given-names>MY</given-names></name>, <name name-style="western"><surname>Ching</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Chemali</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name> (<year>2013</year>) <article-title>A closed-loop anesthetic delivery system for real-time control of burst suppression</article-title>. <source>J Neural Eng</source> <volume>10</volume>: <fpage>046004</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Brown1"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>, <name name-style="western"><surname>Frank</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Tang</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Quirk</surname><given-names>MC</given-names></name>, <name name-style="western"><surname>Wilson</surname><given-names>MA</given-names></name> (<year>1998</year>) <article-title>A statistical paradigm for neural spike train decoding applied to position prediction from ensemble firing patterns of rat hippocampal place cells</article-title>. <source>J Neurosci</source> <volume>18</volume>: <fpage>7411</fpage>–<lpage>7425</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Smith1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name> (<year>2003</year>) <article-title>Estimating a state-space model from point process observations</article-title>. <source>Neural Comput</source> <volume>15</volume>: <fpage>965</fpage>–<lpage>991</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Kwakernaak1"><label>14</label>
<mixed-citation publication-type="other" xlink:type="simple">Kwakernaak K, Sivan R (1972) Linear Optimal Control Systems. New York, NY: Wiley- Interscience.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Chemali1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chemali</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Dort</surname><given-names>CV</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Solt</surname><given-names>K</given-names></name> (<year>2012</year>) <article-title>Active emergence from propofol general anesthesia is induced by methylphenidate</article-title>. <source>Anesthesiology</source> <volume>116</volume>: <fpage>998</fpage>–<lpage>1005</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Solt1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Solt</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Cotten</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Cimenser</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Wong</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Chemali</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Methylphenidate actively induces emergence from general anesthesia</article-title>. <source>Anesthesiology</source> <volume>115</volume>: <fpage>791</fpage>–<lpage>803</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Chemali2"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chemali</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Ching</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Purdon</surname><given-names>PL</given-names></name>, <name name-style="western"><surname>Solt</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name> (<year>2013</year>) <article-title>Burst suppression probability algorithms: state-space methods for tracking EEG burst suppression</article-title>. <source>J Neural Eng</source> <volume>10</volume>: <fpage>056017</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Varvel1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Varvel</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Donoho</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Shafer</surname><given-names>S</given-names></name> (<year>1992</year>) <article-title>Measuring the predictive performance of computer-controlled infusion pumps</article-title>. <source>J Pharmacokinet Biopharm</source> <volume>20</volume>: <fpage>63</fpage>–<lpage>94</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Ching2"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ching</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Liberman</surname><given-names>MY</given-names></name>, <name name-style="western"><surname>Chemali</surname><given-names>JJ</given-names></name>, <name name-style="western"><surname>Westover</surname><given-names>MB</given-names></name>, <name name-style="western"><surname>Kenny</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Real-time closed-loop control in a rodent model of medically induced coma using burst suppression</article-title>. <source>Anesthesiology</source> [Epub ahead of print].</mixed-citation>
</ref>
<ref id="pcbi.1003284-DeGroot1"><label>20</label>
<mixed-citation publication-type="other" xlink:type="simple">DeGroot M, Schervish M (2002) Probability and Statistics. Boston, MA: Addison-Wesley.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Bickford1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bickford</surname><given-names>RG</given-names></name> (<year>1950</year>) <article-title>Automatic electroencephalographic control of general anesthesia</article-title>. <source>EEG Clin Neurophysiol</source> <volume>2</volume>: <fpage>93</fpage>–<lpage>96</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Bickford2"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bickford</surname><given-names>RG</given-names></name> (<year>1951</year>) <article-title>Use of frequency discrimination in the automatic electroencephalographic control of anesthesia (servo-anesthesia)</article-title>. <source>EEG Clin Neurophysiol</source> <volume>3</volume>: <fpage>83</fpage>–<lpage>86</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Mayo1"><label>23</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mayo</surname><given-names>CW</given-names></name>, <name name-style="western"><surname>Bickford</surname><given-names>RG</given-names></name>, <name name-style="western"><surname>Jr</surname><given-names>AF</given-names></name> (<year>1950</year>) <article-title>Electroencephalographically controlled anesthesia in abdominal surgery</article-title>. <source>J Am Med Assoc</source> <volume>144</volume>: <fpage>1081</fpage>–<lpage>1083</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Schwilden1"><label>24</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwilden</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Schüttler</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Stoeckel</surname><given-names>H</given-names></name> (<year>1987</year>) <article-title>Closed-loop feedback control of methohexital anesthesia by quantitative EEG analysis in humans</article-title>. <source>Anesthesiology</source> <volume>67</volume>: <fpage>341</fpage>–<lpage>347</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Rinehart1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rinehart</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Liu</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Alexander</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Cannesson</surname><given-names>M</given-names></name> (<year>2012</year>) <article-title>Review article: closed-loop systems in anesthesia: is there a potential for closed-loop uid management and hemodynamic optimization?</article-title> <source>Anesth Analg</source> <volume>114</volume>: <fpage>130</fpage>–<lpage>143</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Struys1"><label>26</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Struys</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>De Smet</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Versichelen</surname><given-names>LF</given-names></name>, <name name-style="western"><surname>Velde</surname><given-names>SVD</given-names></name>, <name name-style="western"><surname>den Broecke</surname><given-names>RV</given-names></name>, <etal>et al</etal>. (<year>2001</year>) <article-title>Comparison of closed-loop controlled administration of propofol using bispectral index as the controlled variable versus “standard practice” controlled administration</article-title>. <source>Anesthesiology</source> <volume>95</volume>: <fpage>6</fpage>–<lpage>17</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Puri1"><label>27</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Puri</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Kumar</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Aveek</surname><given-names>J</given-names></name> (<year>2007</year>) <article-title>Closed-loop anaesthesia delivery system (CLADS) using bispectral index: a performance assessment study</article-title>. <source>Anaesthesia and intensive care</source> <volume>35</volume>: <fpage>357</fpage>–<lpage>362</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Agarwal1"><label>28</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Agarwal</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Puri</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Mathew</surname><given-names>PJ</given-names></name> (<year>2009</year>) <article-title>Comparison of closed loop vs. manual administration of propofol using the bispectral index in cardiac surgery</article-title>. <source>Acta anaesthesiologica Scandinavia</source> <volume>53</volume>: <fpage>390</fpage>–<lpage>397</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-DeSmet1"><label>29</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>De Smet</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Struys</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Neckebroek</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>den Hauwe</surname><given-names>KV</given-names></name>, <name name-style="western"><surname>Bonte</surname><given-names>S</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>The accuracy and clinical feasibility of a new bayesian-based closed-loop control system for propofol administration using the bispectral index as a controlled variable</article-title>. <source>Anesthesia and analgesia</source> <volume>107</volume>: <fpage>1200</fpage>–<lpage>1210</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Hemmerling1"><label>30</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hemmerling</surname><given-names>TM</given-names></name>, <name name-style="western"><surname>Charabati</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Zaouter</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Minardi</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Mathieu</surname><given-names>PA</given-names></name> (<year>2010</year>) <article-title>A randomized controlled trial demonstrates that a novel closed-loop propofol system performs better hypnosis control than manual administration</article-title>. <source>J Can Anesth</source> <volume>57</volume>: <fpage>725</fpage>–<lpage>735</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Liu1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Chazot</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Trillat</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Michel-Cherqui</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Marandon</surname><given-names>JY</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Closed-loop control of consciousness during lung transplantation: an observational study</article-title>. <source>Journal of cardiothoracic and vascular anesthesia</source> <volume>22</volume>: <fpage>611</fpage>–<lpage>615</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Liu2"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Chazot</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Genty</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Landais</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Restoux</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Titration of propofol for anesthetic induction and maintenance guided by the bispectral index: closed-loop versus manual control: a prospective, randomized, multicenter study</article-title>. <source>Anesthesiology</source> <volume>104</volume>: <fpage>686</fpage>–<lpage>695</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Absalom1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Absalom</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Kenny</surname><given-names>GN</given-names></name> (<year>2003</year>) <article-title>Closed-loop control of propofol anaesthesia using bispectral index: performance assessment in patients receiving computer-controlled propofol and manually controlled remifentanil infusions for minor surgery</article-title>. <source>British Journal of Anaesthesia</source> <volume>90</volume>: <fpage>737</fpage>–<lpage>741</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Absalom2"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Absalom</surname><given-names>AR</given-names></name>, <name name-style="western"><surname>Sutcliffe</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Kenny</surname><given-names>GN</given-names></name> (<year>2002</year>) <article-title>Closed-loop control of anesthesia using bispectral index: performance assessment in patients undergoing major orthopedic surgery under combined general and regional anesthesia</article-title>. <source>Anesthesiology</source> <volume>96</volume>: <fpage>67</fpage>–<lpage>73</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-DeSmet2"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>De Smet</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Struys</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Greenwald</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Mortier</surname><given-names>EP</given-names></name>, <name name-style="western"><surname>Shafer</surname><given-names>SL</given-names></name> (<year>2007</year>) <article-title>Estimation of optimal modeling weights for a bayesian-based closed-loop system for propofol administration using the bispectral index as a controlled variable: a simulation study</article-title>. <source>Anesthesia and analgesia</source> <volume>105</volume>: <fpage>1629</fpage>–<lpage>1638</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Haddad1"><label>36</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Haddad</surname><given-names>WM</given-names></name>, <name name-style="western"><surname>Bailey</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Hayakawa</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Hovakimyan</surname><given-names>N</given-names></name> (<year>2007</year>) <article-title>Neural network adaptive output feedback control for intensive care unit sedation and intraoperative anesthesia</article-title>. <source>IEEE Transactions on Neural Networks/a publication of the IEEE Neural Networks Council</source> <volume>18</volume>: <fpage>1049</fpage>–<lpage>1066</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Hegde1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hegde</surname><given-names>HV</given-names></name>, <name name-style="western"><surname>Puri</surname><given-names>GD</given-names></name>, <name name-style="western"><surname>Kumar</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Behera</surname><given-names>A</given-names></name> (<year>2009</year>) <article-title>Bi-spectral index guided closed-loop anaesthesia delivery system (CLADS) in pheochromocytoma</article-title>. <source>Journal of clinical monitoring and computing</source> <volume>23</volume>: <fpage>189</fpage>–<lpage>196</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Morley1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morley</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Derrick</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Mainland</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>BB</given-names></name>, <name name-style="western"><surname>Short</surname><given-names>TG</given-names></name> (<year>2000</year>) <article-title>Closed loop control of anaesthesia: an assessment of the bispectral index as the target of control</article-title>. <source>Anaesthesia</source> <volume>55</volume>: <fpage>953</fpage>–<lpage>959</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Mortier1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mortier</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Struys</surname><given-names>M</given-names></name>, <name name-style="western"><surname>De Smet</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Versichelen</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Rolly</surname><given-names>G</given-names></name> (<year>1998</year>) <article-title>Closed-loop controlled administration of propofol using bispectral analysis</article-title>. <source>Anaesthesia</source> <volume>53</volume>: <fpage>749</fpage>–<lpage>754</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Ionescu1"><label>40</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ionescu</surname><given-names>CM</given-names></name>, <name name-style="western"><surname>Keyser</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Torrico</surname><given-names>BC</given-names></name>, <name name-style="western"><surname>De Smet</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Struys</surname><given-names>MM</given-names></name>, <etal>et al</etal>. (<year>2008</year>) <article-title>Robust predictive control strategy applied for propofol dosing using BIS as a controlled variable during anesthesia</article-title>. <source>IEEE Trans Biomed Eng</source> <volume>55</volume>: <fpage>2161</fpage>–<lpage>2170</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Kenny1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kenny</surname><given-names>GN</given-names></name>, <name name-style="western"><surname>Mantzaridis</surname><given-names>H</given-names></name> (<year>1999</year>) <article-title>Closed-loop control of propofol anaesthesia</article-title>. <source>British journal of anaesthesia</source> <volume>83</volume>: <fpage>223</fpage>–<lpage>228</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Schwilden2"><label>42</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwilden</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Stoeckel</surname><given-names>H</given-names></name> (<year>1993</year>) <article-title>Closed-loop feedback controlled administration of alfentanil during alfentanil-nitrous oxide anaesthesia</article-title>. <source>British journal of anaesthesia</source> <volume>70</volume>: <fpage>389</fpage>–<lpage>393</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Schwilden3"><label>43</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwilden</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Stoeckel</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Schuttler</surname><given-names>J</given-names></name> (<year>1989</year>) <article-title>Closed-loop feedback control of propofol anaesthesia by quantitative EEG analysis in humans</article-title>. <source>British journal of anaesthesia</source> <volume>62</volume>: <fpage>290</fpage>–<lpage>296</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Hahn1"><label>44</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hahn</surname><given-names>JO</given-names></name>, <name name-style="western"><surname>Dumont</surname><given-names>GA</given-names></name>, <name name-style="western"><surname>Ansermino</surname><given-names>JM</given-names></name> (<year>2011</year>) <article-title>Closed-loop anesthetic drug concentration estimation using clinical-effect feedback</article-title>. <source>IEEE Transactions on Biomedical Engineering</source> <volume>58</volume>: <fpage>3</fpage>–<lpage>6</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Liu3"><label>45</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Liu</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Guen</surname><given-names>ML</given-names></name>, <name name-style="western"><surname>Benabbes-Lambert</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Chazot</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Trillat</surname><given-names>B</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Feasibility of closed-loop titration of propofol and remifentanil guided by the spectral M-Entropy monitor</article-title>. <source>Anesthesiology</source> <volume>116</volume>: <fpage>286</fpage>–<lpage>295</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Shanechi1"><label>46</label>
<mixed-citation publication-type="other" xlink:type="simple">Shanechi MM, Wornell GW, Williams ZM, Brown EN (2010) A parallel point-process filter for estimation of goal-directed movements from neural signals. In: Proc. IEEE international conference on acoustics, speech, and signal processing (ICASSP). Dallas, TX, pp. 521–524.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Shanechi2"><label>47</label>
<mixed-citation publication-type="other" xlink:type="simple">Shanechi MM, Williams ZM, Wornell GW, Brown EN (2011) A brain-machine interface combining target and trajectory information using optimal feedback control. In: Computational and Systems Neuroscience (COSYNE) Meeting. Salt Lake City, USA.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Shanechi3"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shanechi</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Wornell</surname><given-names>GW</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>ZM</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name> (<year>2012</year>) <article-title>Feedback-controlled parallel point process filter for estimation of goal-directed movements from neural signals</article-title>. <source>IEEE Trans Neural Syst Rehabil Eng</source> <volume>21</volume> (<issue>1</issue>) <fpage>129</fpage>–<lpage>40</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1109/TNSRE.2012.2221743" xlink:type="simple">10.1109/TNSRE.2012.2221743</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003284-Shanechi4"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shanechi</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Hu</surname><given-names>RC</given-names></name>, <name name-style="western"><surname>Powers</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Wornell</surname><given-names>GW</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Neural population partitioning and a concurrent brain-machine interface for sequential motor function</article-title>. <source>Nat Neurosci</source> <volume>15</volume>: <fpage>1715</fpage>–<lpage>1722</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Shanechi5"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shanechi</surname><given-names>MM</given-names></name>, <name name-style="western"><surname>Williams</surname><given-names>ZM</given-names></name>, <name name-style="western"><surname>Wornell</surname><given-names>GW</given-names></name>, <name name-style="western"><surname>Hu</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Powers</surname><given-names>M</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>A real-time brain-machine interface combining motor target and trajectory intent using an optimal feedback control design</article-title>. <source>PLOS ONE</source> <volume>8</volume>: <fpage>e59049</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Morari1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Morari</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lee</surname><given-names>JH</given-names></name> (<year>1999</year>) <article-title>Model predictive control: past, present and future</article-title>. <source>Computers and Chemical Engineering</source> <volume>23</volume>: <fpage>667</fpage>–<lpage>682</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Mayne1"><label>52</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mayne</surname><given-names>DQ</given-names></name>, <name name-style="western"><surname>Rawlings</surname><given-names>JB</given-names></name>, <name name-style="western"><surname>Rao</surname><given-names>CV</given-names></name>, <name name-style="western"><surname>Scokaert</surname><given-names>POM</given-names></name> (<year>2000</year>) <article-title>Constrained model predictive control: Stability and optimality</article-title>. <source>Automatica</source> <volume>36</volume>: <fpage>789</fpage>–<lpage>814</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Camponogara1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Camponogara</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Jia</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Krogh</surname><given-names>BH</given-names></name>, <name name-style="western"><surname>Talukdar</surname><given-names>S</given-names></name> (<year>2002</year>) <article-title>Distributed model predictive control</article-title>. <source>IEEE Control Systems Magazine</source> <volume>22</volume>: <fpage>44</fpage>–<lpage>52</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Gentilini1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gentilini</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Schaniel</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Morari</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Bieniok</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wymann</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2002</year>) <article-title>A new paradigm for the closed-loop intraoperative administration of analgesics in humans</article-title>. <source>IEEE Trans Biomed Eng</source> <volume>49</volume>: <fpage>289</fpage>–<lpage>299</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Sawaguchi1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Sawaguchi</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Furutani</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Shirakami</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Araki</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Fukuda</surname><given-names>K</given-names></name> (<year>2008</year>) <article-title>Model-predictive hypnosis control system under total intravenous anesthesia</article-title>. <source>IEEE Trans Biomed Eng</source> <volume>55</volume>: <fpage>874</fpage>–<lpage>887</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Eden1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Eden</surname><given-names>UT</given-names></name>, <name name-style="western"><surname>Frank</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Barbieri</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Solo</surname><given-names>V</given-names></name>, <name name-style="western"><surname>Brown</surname><given-names>EN</given-names></name> (<year>2004</year>) <article-title>Dynamic analysis of neural encoding by point process adaptive filtering</article-title>. <source>Neural Comput</source> <volume>16</volume>: <fpage>971</fpage>–<lpage>998</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Smith2"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Frank</surname><given-names>LM</given-names></name>, <name name-style="western"><surname>Wirth</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yanike</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Hu</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Dynamic analysis of learning in behavioral experiments</article-title>. <source>J Neurosci</source> <volume>24</volume>: <fpage>447</fpage>–<lpage>461</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Smith3"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Shah</surname><given-names>SA</given-names></name>, <name name-style="western"><surname>Hudson</surname><given-names>AE</given-names></name>, <name name-style="western"><surname>Purpura</surname><given-names>KP</given-names></name>, <name name-style="western"><surname>Victor</surname><given-names>JD</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>A Bayesian statistical analysis of behavioral facilitation associated with deep brain stimulation</article-title>. <source>J Neurosci Meth</source> <volume>183</volume>: <fpage>267</fpage>–<lpage>276</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Smith4"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>AC</given-names></name>, <name name-style="western"><surname>Scalon</surname><given-names>JD</given-names></name>, <name name-style="western"><surname>Wirth</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Yanike</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Suzuki</surname><given-names>WA</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>State-space algorithms for estimating spike rate functions</article-title>. <source>Computational Intelligence and Neuroscience</source> <volume>2010</volume>: <fpage>426539</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Dempster1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dempster</surname><given-names>AP</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name> (<year>1977</year>) <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>J Roy Statist Soc B</source> <volume>39</volume>: <fpage>1</fpage>–<lpage>38</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Kam1"><label>61</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kam</surname><given-names>PC</given-names></name>, <name name-style="western"><surname>Cardone</surname><given-names>D</given-names></name> (<year>2007</year>) <article-title>Propofol infusion syndrome</article-title>. <source>Anaesthesia</source> <volume>62</volume>: <fpage>690</fpage>–<lpage>701</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Lewis1"><label>62</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lewis</surname><given-names>LD</given-names></name>, <name name-style="western"><surname>Weiner</surname><given-names>VS</given-names></name>, <name name-style="western"><surname>Mukamel</surname><given-names>EA</given-names></name>, <name name-style="western"><surname>Donoghue</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Eskandar</surname><given-names>EN</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Rapid fragmentation of neuronal networks at the onset of propofol-induced unconsciousness</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>109</volume>: <fpage>E3377</fpage>–<lpage>E3386</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003284-Purdon1"><label>63</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Purdon</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Pierce</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Mukamel</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Prerau</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Walsh</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Electroencephalogram signatures of loss and recovery of consciousness from propofol</article-title>. <source>Proc Natl Acad Sci USA</source> <volume>105</volume>: <fpage>E1142</fpage>–<lpage>E1151</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>