<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004204</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01101</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Power Laws for Heavy-Tailed Distributions: Modeling Allele and Haplotype Diversity for the National Marrow Donor Program</article-title>
<alt-title alt-title-type="running-head">On Modeling Allele and Haplotype Diversity</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Slater</surname>
<given-names>Noa</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple">
<name name-style="western">
<surname>Louzoun</surname>
<given-names>Yoram</given-names>
</name>
<xref rid="aff001" ref-type="aff"><sup>1</sup></xref>
<xref rid="aff002" ref-type="aff"><sup>2</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Gragert</surname>
<given-names>Loren</given-names>
</name>
<xref rid="aff003" ref-type="aff"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Maiers</surname>
<given-names>Martin</given-names>
</name>
<xref rid="aff003" ref-type="aff"><sup>3</sup></xref>
</contrib>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Chatterjee</surname>
<given-names>Ansu</given-names>
</name>
<xref rid="aff004" ref-type="aff"><sup>4</sup></xref>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Albrecht</surname>
<given-names>Mark</given-names>
</name>
<xref rid="aff003" ref-type="aff"><sup>3</sup></xref>
<xref rid="cor001" ref-type="corresp">*</xref>
</contrib>
</contrib-group>
<aff id="aff001"><label>1</label> <addr-line>Gonda Brain Research Center, Bar-Ilan University, Ramat Gan, Israel</addr-line></aff>
<aff id="aff002"><label>2</label> <addr-line>Department of Mathematics, Bar-Ilan University, Ramat Gan, Israel</addr-line></aff>
<aff id="aff003"><label>3</label> <addr-line>National Marrow Donor Program, Minneapolis, Minnesota, United States of America</addr-line></aff>
<aff id="aff004"><label>4</label> <addr-line>School of Statistics, University of Minnesota, Minneapolis, Minnesota, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Asquith</surname>
<given-names>Becca</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Imperial College London, UNITED KINGDOM</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: YL MA. Performed the experiments: NS. Analyzed the data: NS YL MA. Contributed reagents/materials/analysis tools: LG MM AC MA. Wrote the paper: NS YL MM MA.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">malbrech@nmdp.org</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>22</day>
<month>4</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>4</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>4</issue>
<elocation-id>e1004204</elocation-id>
<history>
<date date-type="received">
<day>19</day>
<month>6</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>19</day>
<month>2</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Slater et al</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004204" xlink:type="simple"/>
<abstract>
<p>Measures of allele and haplotype diversity, which are fundamental properties in population genetics, often follow heavy tailed distributions. These measures are of particular interest in the field of hematopoietic stem cell transplant (HSCT). Donor/Recipient suitability for HSCT is determined by Human Leukocyte Antigen (HLA) similarity. Match predictions rely upon a precise description of HLA diversity, yet classical estimates are inaccurate given the heavy-tailed nature of the distribution. This directly affects HSCT matching and diversity measures in broader fields such as species richness. We, therefore, have developed a power-law based estimator to measure allele and haplotype diversity that accommodates heavy tails using the concepts of regular variation and occupancy distributions. Application of our estimator to 6.59 million donors in the Be The Match Registry revealed that haplotypes follow a heavy tail distribution across all ethnicities: for example, 44.65% of the European American haplotypes are represented by only 1 individual. Indeed, our discovery rate of all U.S. European American haplotypes is estimated at 23.45% based upon sampling 3.97% of the population, leaving a large number of unobserved haplotypes. Population coverage, however, is much higher at 99.4% given that 90% of European Americans carry one of the 4.5% most frequent haplotypes. Alleles were found to be less diverse suggesting the current registry represents most alleles in the population. Thus, for HSCT registries, haplotype discovery will remain high with continued recruitment to a very deep level of sampling, but population coverage will not. Finally, we compared the convergence of our power-law versus classical diversity estimators such as Capture recapture, Chao, ACE and Jackknife methods. When fit to the haplotype data, our estimator displayed favorable properties in terms of convergence (with respect to sampling depth) and accuracy (with respect to diversity estimates). This suggests that power-law based estimators offer a valid alternative to classical diversity estimators and may have broad applicability in the field of population genetics.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>The distribution of haplotypes and species tend to be heavy tailed. The heavy tail is expected from theoretical considerations and is observed in most populations. Accurate measures of diversity are difficult to achieve given that a limited number of common haplotypes represent the majority of the population, whereas the major contributor to haplotype diversity comes from unique haplotypes that are “rare” and present in only a fraction of the population. A major issue for unrelated HSCT donor registries is estimating population coverage with respect to servicing the public need. We here use a power-law methodology that accommodates heavy-tails to estimate both the population coverage by ethnicity in the US and the genetic diversity of alleles and haplotypes. For the European American population, which has the deepest sampling amongst ethnicities, we show that registry population coverage is better than 99%, but the diversity of this sample only represents 40% of the unique haplotypes expected to be found in the population. Population coverage for other ethnicities was poorer and ranged down to 92% as was the case for Native Americans that had the worst coverage. We further show that the formalism developed here produces better estimates of the population properties than existing methods.</p>
</abstract>
<funding-group>
<funding-statement>MA, MM, LG, AC were funded by a grant from the Office of Naval Research (Grant number N00014-13-1-0039). The URL of the funder is: <ext-link ext-link-type="uri" xlink:href="http://www.onr.navy.mil/" xlink:type="simple">http://www.onr.navy.mil/</ext-link>. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="4"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>The authors confirm that all data underlying the findings are fully available without restriction. Data is from the Be The Match Registry study whose authors may be contacted at <email xlink:type="simple">malbrech@nmdp.org</email>. HLA haplotype frequencies are available through <ext-link ext-link-type="uri" xlink:href="http://www.allelefrequencies.net/" xlink:type="simple">http://www.allelefrequencies.net/</ext-link>. Code for the estimation of U(R) and a test set is available in the Supp. Mat.</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Allele and Haplotype diversity are fundamental properties in the domain of population genetics for describing the general characteristics of any population of diploid organisms. In the context of hematopoietic stem cell transplant (HSCT) matching, proper estimates of allele and haplotype diversity are essential for describing the population genetics that govern the clinical suitability of a donor/patient match. Matching algorithms scan large unrelated donor registries to identify suitable matches based upon individual Human Leukocyte Antigen (HLA) genetic typings. HLA is defined by the super locus of genes contained in the major histocompatibility complex (MHC) on the 6<sup>th</sup> chromosome that encodes proteins governing the adaptive immune system response [<xref rid="pcbi.1004204.ref001" ref-type="bibr">1</xref>]. Successful transplantation requires careful matching of donor/recipient HLA to avoid adverse immune reactions that result in graft rejection or graft versus host disease [<xref rid="pcbi.1004204.ref002" ref-type="bibr">2</xref>,<xref rid="pcbi.1004204.ref003" ref-type="bibr">3</xref>]. The ambiguous nature of HLA typing, however, presents challenges for transplant matching, given that donor registries contain a range of typing methods and allele definitions that have evolved since the 1980’s. This “mixed resolution” data contains uncertainties regarding the exact alleles each donor has and their phase on the chromosome. The standard approach for resolving these uncertainties is to impute each donor’s HLA typing to a common allele resolution and set chromosomal phase using expectation maximization (EM) algorithms [<xref rid="pcbi.1004204.ref004" ref-type="bibr">4</xref>]. Given a proper candidate set of haplotypes, EM algorithms work well to estimate the distribution of this defined population, which becomes the reference data for computing accurate donor/patient match predictions.</p>
<p>However, we often do not know what constitutes a complete or reasonable candidate set of haplotypes describing the clinically relevant variation among individuals. This problem arises due to the following main reasons: <bold>Lack of Adequate Sampling Depth—</bold>the MHC region has the highest allele diversity within the human genome, so even a large sample relative to the population is unlikely to observe all clinically relevant haplotypes. For example, in the European American population 44.65% of haplotypes in the Be The Match registry are singletons (i.e. are represented by only one individual), yet the most frequent haplotype represents 6.11% of the sample so one might falsely conclude that variation is lower than it really is. This motivates the need to develop reliable methods for assessing sampling depth and the benefits of continued sampling; <bold>Ambiguous Nature of HLA Typing—</bold>true haplotype variation is confounded by ambiguous typing methods, which describe each individual as a set of possible alleles at each loci (consistent with HLA typing). When candidate haplotypes are constructed from cross-combinations of these possible alleles, an intractably large set results due to the “curse of dimensionality”[<xref rid="pcbi.1004204.ref005" ref-type="bibr">5</xref>]. Currently, this exhaustive set of haplotypes is heavily trimmed prior to estimation with the EM algorithm, but the trimming strategies are not quantitatively informed; <bold>Variation in Diversity Among Populations—</bold>ancestral migration patterns have resulted in different patterns of allele and haplotype diversity among ethnic groups, implying that sampling depth requirements are likely to vary by population. Clearly, there is a need to develop quantitative estimates of allele and haplotype diversity.</p>
<p>More formally, let <bold>A</bold> denote the number of unique HLA alleles in a population and <bold>H</bold> the number of unique HLA haplotypes (see <xref rid="pcbi.1004204.t001" ref-type="table">Table 1</xref> for all symbols used). Estimating <bold>A</bold> and <bold>H</bold> is a difficult problem given that we do not directly observe all alleles and haplotypes in the population. Instead, we must establish and extrapolate a relationship between the number of kinds we observe and the frequency of each kind. Mathematical frameworks for describing this relationship have been developed in the study of species richness and occupancy. Capture-recapture methods have been adapted from ecology to genetics for estimating the total number of different alleles/haplotypes [<xref rid="pcbi.1004204.ref006" ref-type="bibr">6</xref>]. Such methods could be applied to estimate <bold>A</bold> and <bold>H</bold> by tagging resamples of alleles and haplotypes. Although interesting, these capture recapture methods require a very large sampling depth for heavy tailed distributions, as will be shown. Occupancy distributions [<xref rid="pcbi.1004204.ref007" ref-type="bibr">7</xref>]offer a more natural representation of our data sampling process and use the mathematical concept of regular variation to extrapolate <bold>A</bold> and <bold>H</bold> using a power law function that describes the distribution of allele and haplotype frequencies in the population [<xref rid="pcbi.1004204.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1004204.ref008" ref-type="bibr">8</xref>]. The power law relationship was constructed under the assumption that an infinite number of categories (or kinds) exist in the population; so for our purposes we apply a boundary constraint to estimate a finite number of categories under this general framework.</p>
<table-wrap id="pcbi.1004204.t001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.t001</object-id>
<label>Table 1</label> <caption><title>List of symbols used.</title></caption>
<alternatives>
<graphic id="pcbi.1004204.t001g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.t001" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Symbol</th>
<th align="left" rowspan="1" colspan="1">Definition</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>p</italic> <sub><italic>j</italic></sub></td>
<td align="left" rowspan="1" colspan="1">Apriori probability of choosing a haplotype <italic>j</italic> for a person in the population.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>N</italic><sub>totd</sub></td>
<td align="left" rowspan="1" colspan="1">Total population size.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>H</italic> = <italic>N</italic> <sub><italic>hap</italic></sub> = <italic>K</italic> <sub><italic>N total</italic></sub></td>
<td align="left" rowspan="1" colspan="1">Number of unique haplotypes. The range of j in <italic>p</italic><sub><italic>j</italic></sub> is from 1 to <bold>H</bold>.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>A</bold></td>
<td align="left" rowspan="1" colspan="1">Total number of unique alleles in the population.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>U</italic>(<italic>R</italic>)</td>
<td align="left" rowspan="1" colspan="1">Expected number of unique haplotypes in a sample size of R.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>α</italic></td>
<td align="left" rowspan="1" colspan="1">Power of distribution.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">C</td>
<td align="left" rowspan="1" colspan="1">Normalization factor.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>X</italic><sub>min</sub></td>
<td align="left" rowspan="1" colspan="1">Minimal value of non zero <italic>p</italic><sub><italic>j</italic></sub>.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>X</italic><sub>max</sub></td>
<td align="left" rowspan="1" colspan="1">Maximal value of non zero <italic>p</italic><sub><italic>j</italic></sub>.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>R</italic></td>
<td align="left" rowspan="1" colspan="1">Sample size.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>Z</italic>(<italic>R</italic>)</td>
<td align="left" rowspan="1" colspan="1">Expected probability for an unobserved haplotype in a sample of size R.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>X</italic><sub>0</sub></td>
<td align="left" rowspan="1" colspan="1">Point at which slope of distribution changes.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>V</italic><sub><italic>H</italic></sub>(<italic>x</italic>)</td>
<td align="left" rowspan="1" colspan="1">Exceedance function of the haplotype frequency distribution.</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><italic>μ</italic><sub><italic>H</italic></sub> <italic>(x)</italic></td>
<td align="left" rowspan="1" colspan="1">Density of <italic>p</italic><sub><italic>j</italic></sub> values—the number of haplotypes in a region = the number of haplotypes between x and x+dx (the integral over <italic>μ</italic><sub><italic>H</italic></sub> <italic>(x)</italic> from x to infinity is <italic>V</italic><sub><italic>H</italic></sub>(<italic>x</italic>)).</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><inline-formula id="pcbi.1004204.e001"><alternatives><graphic id="pcbi.1004204.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e001" xlink:type="simple"/><mml:math display="inline" id="M1" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>H</mml:mi><mml:mtext> </mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>H</mml:mi></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula></td>
<td rowspan="1" colspan="1">Density distribution function for the probability of observing a clone of frequency <italic>x</italic>.</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<p>In the medical field of HSCT, estimates of <bold>A</bold> are largely catalog based; unique HLA genomic sequences are stored in databases as alleles using locus-specific nomenclature (the best known being the IMGT/HLA database cataloging 10,653 allele definitions at the time of writing [<xref rid="pcbi.1004204.ref009" ref-type="bibr">9</xref>]). Further information on the prevalence of specific HLA alleles in the general population is provided by the Common and Well Documented (CWD) allele list [<xref rid="pcbi.1004204.ref010" ref-type="bibr">10</xref>]. Estimates of <bold>H</bold> are typically based on EM derived HLA haplotype frequencies, which represent nomenclature-based allele combinations that are likely to be found in the population. These estimates take into account that genetic information is inherited in blocks making the true value of <bold>H</bold> much smaller than the expansion of all possible allele combinations. For example, estimates of <bold>H</bold> within the United States population in 2013 identified over 160,000 unique 6-locus haplotypes in the Be The Match Registry, where 99% of the time <bold>H</bold> was comprised of combinations of “common” alleles and roughly 90% of the known IMGT documented alleles (<bold>A</bold>) were absent from the haplotype frequencies [<xref rid="pcbi.1004204.ref011" ref-type="bibr">11</xref>]. Thus, current methods for estimating of <bold>A</bold> and <bold>H</bold> rely upon direct observation of a given allele or haplotype. For estimating the “common” portions of <bold>A</bold> and <bold>H</bold>, this is a reliable strategy for sufficient observational data is likely to exist. However, such an approach is unsuitable for estimating the “rare” portion of <bold>A</bold> and <bold>H</bold> lacking direct observational data. Evidence for the existence of a large number of “rare” alleles and haplotypes in the overall population is outlined by Klitz [<xref rid="pcbi.1004204.ref012" ref-type="bibr">12</xref>], who modeled the effects of gene conversion, point mutations, and recombination to establish the heavy tailed nature of allele and haplotype distributions.</p>
<p>To estimate <bold>A</bold> and <bold>H</bold>, we, therefore, construct a heavy tail relationship based upon occupancy distributions and the properties of regular variation. This power-law framework is useful for modeling the probability mass (and number) of <bold>A</bold> and <bold>H</bold> that are unseen in the sample and represented by the “invisible” tail of the distribution. We perform this on 6-locus HLA data (A~C~B~DRBX~DRB1~DQB1; where DRBX = DRB3/4/5) from the Be The Match Registry, which is one of the largest data sets characterizing human HLA population genetics containing the typing information for 6.59 million donors [<xref rid="pcbi.1004204.ref011" ref-type="bibr">11</xref>]. We also assess registry coverage, which is the proportion of the total population occupied by the observed haplotypes, of <bold>A</bold> and <bold>H</bold> with respect to the potential base of patients seeking HSCT to inform donor recruitment strategies. Last, we discuss broader applications of the power-law methodology outside HSCT for modeling species richness in the field of ecology, which is characterized by similar heavy-tailed distributions.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<sec id="sec003">
<title>Haplotype Distribution Formalism</title>
<p>In order to estimate the total number of unique haplotypes <bold>H</bold> having probability <italic>p</italic><sub><italic>j</italic></sub> for haplotype j 1≤<italic>j</italic>≤<italic>H</italic>,0≤<italic>p</italic><sub><italic>j</italic></sub>≤1, we define a counting function (<italic>v</italic><sub>H</sub> (<italic>x</italic>)),also denoted an exceedance function, representing the number of haplotypes with a relative frequency (i.e. <italic>p</italic><sub><italic>j</italic></sub>) above or equal to <italic>x</italic>. Observations suggest that <italic>v</italic><sub>H</sub> (<italic>x</italic>) can be approximated by a scale free function:
<disp-formula id="pcbi.1004204.e002">
<alternatives>
<graphic id="pcbi.1004204.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e002" xlink:type="simple"/>
<mml:math display="block" id="M2" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>∝</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
Note that in reality, <italic>v</italic><sub><italic>H</italic></sub> <italic>(x)</italic> can only take discrete values. However, we here take a continuous approximation of.<italic>V</italic><sub><italic>H</italic></sub> (<italic>x</italic>) This approximation stops being valid at some maximal and minimal haplotype relative frequencies (<italic>X</italic><sub>min</sub> and <italic>X</italic><sub>max</sub>) Obviously, a (unique) haplotype cannot have a frequency of less than 1 and, thus, a relative frequency of less than1 / <italic>N</italic><sub><italic>total</italic></sub> (<italic>X</italic><sub>min</sub> ≥ 1 / <italic>N</italic><sub><italic>total</italic></sub>), where <italic>N</italic><sub><italic>total</italic></sub> is the total number of haplotypes in the population (twice the total population size since each sampled person has two sets of haplotypes). <italic>N</italic><sub><italic>total</italic></sub> is typically much larger than the number of unique haplotypes, <bold>H.</bold></p>
<p>Similarly, above a given relative frequency, <italic>v</italic><sub><italic>H</italic></sub> (<italic>x</italic>) becomes smaller than 1, and the approximation stops being valid. The total number of unique haplotypes in this formalism is <italic>H</italic> = <italic>V</italic><sub><italic>H</italic></sub> (<italic>X</italic><sub>min</sub>).</p>
<p>Given the continuous formalism, one can also define a haplotype count density (which is not a formal density function, since it is not normalized to 1), representing the number of unique haplotypes <bold>H</bold> in a given relative frequency interval of <italic>dx</italic>:
<disp-formula id="pcbi.1004204.e003">
<alternatives>
<graphic id="pcbi.1004204.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e003" xlink:type="simple"/>
<mml:math display="block" id="M3" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula>
Based on the definition of <italic>v</italic><sub><italic>H</italic></sub>(<italic>x</italic>), <italic>μ</italic><sub><italic>H</italic></sub>(<italic>x</italic>) obeys:
<disp-formula id="pcbi.1004204.e004">
<alternatives>
<graphic id="pcbi.1004204.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e004" xlink:type="simple"/>
<mml:math display="block" id="M4" overflow="scroll">
<mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:munderover><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:munderover><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
Moreover, if <italic>v</italic><sub><italic>H</italic></sub> (<italic>x</italic>) is a scale free function, so is <italic>μ</italic><sub><italic>H</italic></sub> (<italic>x</italic>):
<disp-formula id="pcbi.1004204.e005">
<alternatives>
<graphic id="pcbi.1004204.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e005" xlink:type="simple"/>
<mml:math display="block" id="M5" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>∝</mml:mo><mml:msup><mml:mi>x</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mtext> where </mml:mtext><mml:mi>α</mml:mi><mml:mtext>=</mml:mtext><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
<italic>μ</italic><sub><italic>H</italic></sub> (<italic>x</italic>)is not a probability density function (PDF). However it can be normalized, by defining:
<disp-formula id="pcbi.1004204.e006">
<alternatives>
<graphic id="pcbi.1004204.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e006" xlink:type="simple"/>
<mml:math display="block" id="M6" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mi>H</mml:mi></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula>
which is a proper density distribution function. Thus, <italic>p</italic><sub><italic>H</italic></sub>(<italic>x</italic>) provides a description of how common (i.e. the density) each <italic>p</italic><sub><italic>j</italic></sub> is in the population. Further, a proper cumulative distribution function (CDF) for the <italic>p</italic><sub><italic>j</italic></sub>’<italic>s</italic> (the relative haplotype frequencies) can be derived by normalizing <italic>V</italic><sub><italic>H</italic></sub>(<italic>x</italic>) where <inline-formula id="pcbi.1004204.e007"><alternatives><graphic id="pcbi.1004204.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e007" xlink:type="simple"/><mml:math display="inline" id="M7" overflow="scroll"><mml:mrow><mml:mtext>Pr(</mml:mtext><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>≤</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>v</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></alternatives></inline-formula>, since <inline-formula id="pcbi.1004204.e008"><alternatives><graphic id="pcbi.1004204.e008g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e008" xlink:type="simple"/><mml:math display="inline" id="M8" overflow="scroll"><mml:mrow><mml:msub><mml:mi>v</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>/</mml:mo><mml:mi>H</mml:mi></mml:mrow></mml:math></alternatives></inline-formula> represents the complementary CDF (i.e.1-Pr(<italic>p</italic><sub><italic>j</italic></sub>≤<italic>x</italic>)). Also, as noted above, the power law exponent of <italic>μ</italic><sub><italic>H</italic></sub>(<italic>x</italic>) is 1 unit greater than the power law exponent of <italic>V</italic><sub><italic>H</italic></sub>(<italic>x</italic>)since these two quantities share the properties linking CDFs to PDFs, namely that a PDF is proportional to the first derivative of its CDF.</p>
<p>Previous models of haplotype frequency using slowly varying distributions assumed unlimited population size and the existence of an infinite number of unique haplotypes <bold>H</bold> [<xref rid="pcbi.1004204.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1004204.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1004204.ref013" ref-type="bibr">13</xref>,<xref rid="pcbi.1004204.ref014" ref-type="bibr">14</xref>]. In order to estimate the properties of the real population haplotype distribution, a parallel theory is required for finite populations. The finite population affects the upper and lower bounds of the distribution. The lower bound is determined by the absence of relative frequencies smaller than 1 / <italic>N</italic><sub><italic>total</italic></sub> and is common to all types of distributions. The upper bound is specific to heavy tail distributions. In such distributions, the contribution of the right tail to the overall probability mass is considerable. As such, the normalization constant of the distribution is greatly affected by the maximal relative frequency in the population (<italic>X</italic><sub>max</sub>).</p>
<p>We here expand these methods to finite sized populations (and not only finite samples of an infinite population). In order to incorporate the finite size of the population, minimal and maximal relative haplotype frequencies are defined (<italic>X</italic><sub>min</sub> and <italic>X</italic><sub>max</sub>). As mentioned, the minimal frequency for a haplotype cannot be less than one person in the whole <italic>N</italic><sub><italic>total</italic></sub> population that carries one copy of this haplotype (<italic>X</italic><sub><italic>min</italic></sub>≥<italic>N</italic><sub><italic>total</italic></sub><sup><italic>-1</italic></sup>). However, in many realistic cases, the scale free distribution only starts at a higher value than that.</p>
<p>The upper cutoff (<italic>X</italic><sub>max</sub>) can be determined by the total population <italic>N</italic><sub><italic>total</italic></sub>in the following way: Let us separate the values of <italic>x</italic> into bins. As mentioned, the minimum difference between relative frequencies is <italic>N</italic><sub><italic>total</italic></sub><sup>-1</sup>. We can thus define <italic>N</italic><sub><italic>total</italic></sub><sup>-1</sup>to be the minimal bin size. Per definition, at the largest ‘x’ value, there is typically one unique haplotype. Thus,<italic>v</italic><sub><italic>H</italic></sub>(<italic>x</italic><sub>max</sub>) = 1, leading to:
<disp-formula id="pcbi.1004204.e009">
<alternatives>
<graphic id="pcbi.1004204.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e009" xlink:type="simple"/>
<mml:math display="block" id="M9" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>μ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>⇒</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>≤</mml:mo><mml:mn>1</mml:mn><mml:mo>⇒</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mi>H</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>≤</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>H</mml:mi></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
Assuming <italic>X</italic><sub>max</sub> is an upper threshold, we have the equal sign in the equation and in this case <italic>X</italic><sub>max</sub> can then be numerically extracted from <xref rid="pcbi.1004204.e009" ref-type="disp-formula">Eq 6</xref>. In many realistic cases, the scale free distribution has an exponential cutoff, starting at much lower values and <italic>X</italic><sub>max</sub> can be lower (see <xref rid="pcbi.1004204.s002" ref-type="supplementary-material">S2 Text</xref>).</p>
</sec>
<sec id="sec004">
<title>Estimates of H (Number of Unique Haplotypes)</title>
<p>The observed portion of <bold>H</bold> has been growing over the years, yet there is still a significant portion that remains unobserved. It is thus of interest to estimate the total size of <bold>H</bold>, and the relation between the sampling size and the portion of <bold>H</bold> that we actually observe. If the haplotype relative frequency distribution <italic>p</italic><sub><italic>H</italic></sub> (<italic>x</italic>) was light tailed, most haplotypes would have the same order of frequency. In such a case, it would have been enough to sample a limited part of the population to detect the vast majority of different haplotypes and estimate <bold>H</bold>. More specifically, if the sample would be at least an order larger than <bold>H</bold>, most unique haplotypes would be detected. However, in heavy tailed distributions (such as power-law distributions) the vast majority of haplotypes are very rare. A deep sampling is thus required for a precise estimate of <bold>H</bold> and a very deep sample is required to observe all unique haplotypes. On the other hand, the contribution of these rare haplotypes to the coverage is often negligible since most of the population has common haplotypes. The precise balance between these two phenomena is determined by the power exponent of the distribution (<italic>α</italic>).</p>
<p>Formally, the expected number of unique haplotypes (<italic>U</italic>(<italic>R</italic>)) in a sample size (<italic>R</italic>) can be estimated, assuming a truncated power law formalism as defined above, to be (see <xref rid="pcbi.1004204.s001" ref-type="supplementary-material">S1</xref>–<xref rid="pcbi.1004204.s003" ref-type="supplementary-material">S3</xref> Texts):
<disp-formula id="pcbi.1004204.e010">
<alternatives>
<graphic id="pcbi.1004204.e010g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e010" xlink:type="simple"/>
<mml:math display="block" id="M10" overflow="scroll">
<mml:mrow><mml:mi>U</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>H</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
where γ is the partial gamma function. The total number of unique haplotypes can be computed to be:
<disp-formula id="pcbi.1004204.e011">
<alternatives>
<graphic id="pcbi.1004204.e011g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e011" xlink:type="simple"/>
<mml:math display="block" id="M11" overflow="scroll">
<mml:mrow><mml:mi>H</mml:mi><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>m</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(8)</label>
</disp-formula></p>
</sec>
<sec id="sec005">
<title>Estimates of the Distribution Properties</title>
<p>The estimates above require the slope of the distribution (<italic>α</italic>). Many methods have been proposed to estimate this slope, including a fit of the CDF or the PDF, or a fit of the power of the Zipf plot [<xref rid="pcbi.1004204.ref015" ref-type="bibr">15</xref>]. However, such methods have been argued to be flawed, as discussed in an excellent review by Clauset et al. [<xref rid="pcbi.1004204.ref016" ref-type="bibr">16</xref>]. The same authors have proposed estimates for the slope of the scale free distribution for either continuous [<xref rid="pcbi.1004204.ref017" ref-type="bibr">17</xref>] (<xref rid="pcbi.1004204.e012" ref-type="disp-formula">Eq 9</xref>) or discrete (<xref rid="pcbi.1004204.e013" ref-type="disp-formula">Eq 10</xref>) distributions:
<disp-formula id="pcbi.1004204.e012">
<alternatives>
<graphic id="pcbi.1004204.e012g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e012" xlink:type="simple"/>
<mml:math display="block" id="M12" overflow="scroll">
<mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mn>l</mml:mn><mml:mtext>n</mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula>
<disp-formula id="pcbi.1004204.e013">
<alternatives>
<graphic id="pcbi.1004204.e013g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e013" xlink:type="simple"/>
<mml:math display="block" id="M13" overflow="scroll">
<mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>l</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mn>1</mml:mn><mml:mtext>n</mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula>
where <italic>n</italic> is the total number of observed haplotypes, <italic>p</italic><sub><italic>j</italic></sub>'s are the haplotype relative frequencies, <italic>p</italic><sub><italic>min</italic></sub> is the relative frequency of the rarest observed haplotype, <italic>y's</italic> are the parallel values in absolute frequencies for the discrete case and <italic>y</italic><sub>min</sub> is the minimal absolute frequency.</p>
<p>Another estimator based on the asymptotic properties of regular variation was proposed by Ohannessian et al. for <italic>α</italic>∈[1,2] [<xref rid="pcbi.1004204.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1004204.ref018" ref-type="bibr">18</xref>]:<inline-formula id="pcbi.1004204.e014"><alternatives><graphic id="pcbi.1004204.e014g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e014" xlink:type="simple"/><mml:math display="inline" id="M14" overflow="scroll"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>n</mml:mi><mml:mo>,</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math></alternatives></inline-formula>. This estimator is based on the ratio between <italic>K</italic><sub><italic>n</italic>,1</sub>—the number of haplotypes which appear only once in the sample, and <italic>K</italic><sub><italic>n</italic></sub>—the total number of unique haplotypes in the sample. Note that this estimator was derived for the CDF and <italic>β</italic> = <italic>α</italic>-1, which is 1 less than our PDF based estimator. While these methods are precise for a full power law distribution, they do not converge to the proper value when the distribution is truncated either from above or from below (<xref rid="pcbi.1004204.g001" ref-type="fig">Fig 1A</xref>). We also checked the convergence of <xref rid="pcbi.1004204.e013" ref-type="disp-formula">Eq 10</xref> when using minimal absolute frequency <italic>y</italic>*which is larger or equal to <italic>y</italic><sub>min</sub>mentioned above:<inline-formula id="pcbi.1004204.e015"><alternatives><graphic id="pcbi.1004204.e015g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e015" xlink:type="simple"/><mml:math display="inline" id="M15" overflow="scroll"><mml:mrow><mml:mi>α</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>n</mml:mi><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mn>l</mml:mn><mml:mtext>n</mml:mtext><mml:mfrac><mml:mrow><mml:msub><mml:mi>y</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>y</mml:mi><mml:mo>*</mml:mo><mml:mo>−</mml:mo><mml:mn>0.5</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula>. This truncated power law estimate does converge to the right value, but very slowly (<xref rid="pcbi.1004204.g001" ref-type="fig">Fig 1A</xref> orange circles). Formally, we estimated the fit to the distribution using a Kolmogorov Smirnov test, and used the lower cutoff <italic>J</italic><sub>min</sub> producing the best fit.</p>
<fig id="pcbi.1004204.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Estimation of <italic>α</italic> and of haplotype number for different sample sizes.</title>
<p><bold>A.</bold> Convergence of estimates of the power of distribution <italic>α</italic> to real value in samples from a simulated scale free distribution with a lower cutoff. The real value is the black line with the 'x' signs. The estimate using our method quickly converges to the proper value—1.5 (purple line with diamonds). The estimates using either the discrete (red line with squares) or continuous (blue lines with circles) Clauset estimates, or the Ohannessian et al. estimate (green lines with circles) do not converge, even when more than half the distribution is sampled. A Clauset discrete estimate with a minimal cutoff (orange line with circles) converges almost as well as our algorithm. <bold>B.</bold> Comparison of haplotype number estimate as a function of the sample size, using a capture recapture method (red squares), Jackknife estimators and the parametric estimate proposed here (blue diamonds), using the same simulation as above. The real number is a black full line with 'x' signs. One can clearly see that the parametric estimate developed here converges to a good estimate, even for a very small sample.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.g001" position="float" xlink:type="simple"/>
</fig>
<p>We have thus adopted a different approach based on a numerical fit of the observed value of <italic>U</italic>(<italic>R</italic>) to <xref rid="pcbi.1004204.e010" ref-type="disp-formula">Eq 7</xref>–<xref rid="pcbi.1004204.e011" ref-type="disp-formula">8</xref> for different values of R. We compute <italic>U</italic>(<italic>R</italic>)from the observed data for different <italic>R</italic> values and find the parameters leading to a best fit between <xref rid="pcbi.1004204.e010" ref-type="disp-formula">Eq 7</xref>–<xref rid="pcbi.1004204.e011" ref-type="disp-formula">8</xref> and the observed data. The parameters are bounded by <xref rid="pcbi.1004204.e009" ref-type="disp-formula">Eq 6</xref> for <italic>X</italic><sub>max</sub> and <italic>N</italic><sub><italic>total</italic></sub><sup>-1</sup> for <italic>X</italic><sub>min</sub>. The numerical minimization is initialized with <italic>X</italic><sub>max</sub> from the observed data, <italic>X</italic><sub>min</sub> at its boundary value, and <italic>α</italic> as it is computed from <xref rid="pcbi.1004204.e012" ref-type="disp-formula">Eq 9</xref> (for a schematic figure see <xref rid="pcbi.1004204.g002" ref-type="fig">Fig 2</xref>). The value of <italic>α</italic> computed using this estimate converges to the proper value at limited sampling depth (<xref rid="pcbi.1004204.g001" ref-type="fig">Fig 1A</xref>).</p>
<fig id="pcbi.1004204.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Schematic figure.</title>
<p>(A) We observe a population with different haplotypes. From the population we extract two measures—the haplotype frequency distribution (B) and the number of unique haplotypes as a function of the sample size (C). We assume that the frequency distribution (B) is a scale free distribution with upper and lower cutoff values <italic>X</italic><sub>min</sub>≤<italic>x</italic>≤<italic>X</italic><sub>max</sub>. For the sake of simplicity, we assume a zero probability to observe haplotypes with frequencies beyond these values. We provide an initial guess for the lower cutoff to be limited by the total population size, and the upper cutoff, we limit by an upper estimate from the total population size (Eq B6). We use an initial guess of <italic>X</italic><sub>min</sub> at its boundary, the Clauset estimate for the slope, and the observed highest frequency <italic>X</italic> 0 <sub>max</sub>. We then fit the observed unique haplotype curve (C) with an analytical formula for the expected shape (D) with a cost function of <inline-formula id="pcbi.1004204.e016"><alternatives><graphic id="pcbi.1004204.e016g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e016" xlink:type="simple"/><mml:math display="inline" id="M16" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mtext>R'</mml:mtext></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>U(R')-log(observed (R')</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mstyle><mml:mo>*</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>observed (R'))</mml:mtext></mml:mrow></mml:math></alternatives></inline-formula> for different values of sample sizes R'. Finally, we extract the optimal parameters (E) and produce an estimate of the number of unique haplotypes for any population size N, where N is the target population size.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.g002" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec006">
<title>Methodology Validation</title>
<p>To validate the correctness of the haplotype number estimate in Eq <xref rid="pcbi.1004204.e010" ref-type="disp-formula">7</xref> and <xref rid="pcbi.1004204.e011" ref-type="disp-formula">8</xref>, we did multiple validations as follows: As a first validation, we chose values of <italic>X</italic><sub>max</sub>, <italic>X</italic><sub>min</sub> and <italic>α</italic>, and then calculated <bold>H</bold> using <xref rid="pcbi.1004204.e011" ref-type="disp-formula">Eq 8</xref>. We generated <italic>H</italic> haplotypes with relative frequencies (<italic>p</italic><sub><italic>j</italic></sub> ’ <italic>s</italic>) taken from a pure power law distribution with exponent of <italic>α</italic>. Next, we generated samples of different sizes (R) based on the <italic>p</italic><sub><italic>j</italic></sub> ’ <italic>s</italic> values. We compared the expected value of <italic>U</italic> (<italic>R</italic>)(<xref rid="pcbi.1004204.e010" ref-type="disp-formula">Eq 7</xref>) to the actual number of different unique haplotypes that we got in the sample, with an excellent fit (less than 1% deviation—<xref rid="pcbi.1004204.s005" ref-type="supplementary-material">S1 Fig</xref>). A similar analysis with a truncated power law gave similar results.</p>
<p>We then compared the convergence rate of our method with other frameworks for estimating <bold>H</bold>. We used a simulated population from a truncated power law, as described above and formed sub samples of incremental size. We then generated estimates of <bold>H</bold> as a function of increasing sub-sample size.</p>
<p>We compared our method with a capture-recapture formula [<xref rid="pcbi.1004204.ref006" ref-type="bibr">6</xref>]. This method was adapted to compute the total number of different alleles instead of the total population as is performed in ecology. In order to compute the capture recapture estimate, we divided each sub-sample into two smaller sub samples: <italic>A</italic> and <italic>B</italic>. We then computed the ratio between the product of the number of different alleles/haplotypes in A and B and the number of different alleles/haplotypes in their intersection:<inline-formula id="pcbi.1004204.e017"><alternatives><graphic id="pcbi.1004204.e017g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e017" xlink:type="simple"/><mml:math display="inline" id="M17" overflow="scroll"><mml:mrow><mml:mo>|</mml:mo><mml:mi>U</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>*</mml:mo><mml:mo>|</mml:mo><mml:mi>u</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>/</mml:mo><mml:mo>|</mml:mo><mml:mi>U</mml:mi><mml:mi>n</mml:mi><mml:mi>i</mml:mi><mml:mi>q</mml:mi><mml:mi>u</mml:mi><mml:mi>e</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>A</mml:mi><mml:mo>∪</mml:mo><mml:mi>B</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:math></alternatives></inline-formula>. We further compared our method with a Jackknife based estimator [<xref rid="pcbi.1004204.ref019" ref-type="bibr">19</xref>]. Capture-recapture and power-law estimates were found to converge to the true value of <bold>H,</bold> but the capture-recapture method required a very deep sample of the population to attain accuracy whereas the power-law method converged quickly and offered accurate estimates, even with limited sampling (<xref rid="pcbi.1004204.g001" ref-type="fig">Fig 1B</xref>). The Jackknife based estimator did not converge to the proper value.</p>
<p>The field of species richness estimation is very wide and a large number of methods to estimate species richness have been proposed (e.g. [<xref rid="pcbi.1004204.ref020" ref-type="bibr">20</xref>] and supplementary material therein). Many of these methods have been merged into the CatchAll software [<xref rid="pcbi.1004204.ref021" ref-type="bibr">21</xref>]. To further compare our method, with existing state of the art methods, we have tested these measures on the same samples. All methods proposed by CatchAll showed a very slow convergence, or actually no convergence (<xref rid="pcbi.1004204.g003" ref-type="fig">Fig 3</xref>).</p>
<fig id="pcbi.1004204.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Comparisons of methods to evaluate the haplotype number.</title>
<p>We compare the Bunge and Barger (2008) method as implemented in the Catchall model using a population with scale free frequency distribution of haplotypes with a slope of -1.5 and compare the estimated species richness as supplied by the Catchall software for all models where the software converges to a result. These models include parametric predictions procedures, such as Mixture-of-two-exponentials-mixed Poisson and Mixture-of-three-exponentials-mixed Poisson on the observed species richness or on their log values and non-parametric procedures, such as the ACE (Abundance-based Coverage Estimator) ACE1 (Abundance-based Coverage Estimator for highly heterogeneous cases) and different versions of the Chao-Bunge gamma-Poisson estimator. Each line represents the estimated number of haplotypes using one of the Catchall methods. The black line represents the real simulated species number. The purple line with diamonds represents our estimates. Our estimates converge much faster and to a much more precise estimate of the real haplotype number than any of the methods proposed by Catchall.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.g003" position="float" xlink:type="simple"/>
</fig>
<p>In order to further validate the methodology in a realistic regime, we used 7.8 million samples from Be the Match Registry, which identified 88,621 haplotypes as estimated in the EM algorithm from the European American population, and used a sub-sample of half a million haplotypes to estimate the parameters of the distribution (<italic>X</italic><sub>max</sub>, <italic>X</italic><sub>min</sub> and <italic>α</italic>). We then validated that the resulting values fit the observed distribution all the way to the full sample size (7.8e6) and extrapolated it to the total European American population as defined by the Census [<xref rid="pcbi.1004204.ref022" ref-type="bibr">22</xref>]. The final value is an estimate of the total number of haplotypes in the European American population in the US (<xref rid="pcbi.1004204.g004" ref-type="fig">Fig 4</xref>; see <xref rid="pcbi.1004204.s006" ref-type="supplementary-material">S2 Fig</xref> for the other populations). When we estimated <italic>X</italic><sub>min</sub>, <italic>X</italic><sub>max</sub> and <italic>α</italic> from the distribution (purple full line) an excellent fit was obtained.</p>
<fig id="pcbi.1004204.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Comparison of computed and observed expected number of haplotypes in a sample of size R</title>
<p>: <italic>U</italic>(<italic>R</italic>)for the European American population for different sample sizes R. The gray squares are observations. All estimates were performed using 10% of the sample. The lines are an estimation of <italic>U</italic>(<italic>R</italic>) with all free parameters (full purple), maximal <italic>Xmax</italic> and free <italic>α</italic> (dashed green line), free <italic>Xmax</italic> and free <italic>α</italic> but fixed <italic>Xmin</italic> (dashed black line) and free boundaries but <italic>α</italic> based on the Clauset estimate (double dashed red line). The inset shows the ratio between the computed number of haplotypes and the real one.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.g004" position="float" xlink:type="simple"/>
</fig>
<p>To investigate the sensitivity of the model to parameter estimates of <italic>X</italic><sub>min</sub>, <italic>X</italic><sub>max</sub> and <italic>α</italic>, we fixed the value of <italic>α</italic> based on the <xref rid="pcbi.1004204.e012" ref-type="disp-formula">Eq 9</xref>, and optimized <italic>X</italic><sub>min</sub> and x<sub>max</sub> or fixed one of these variables at their extreme values and optimized <italic>α</italic>. The fit diverges from the observed result (<xref rid="pcbi.1004204.g004" ref-type="fig">Fig 4</xref> and <xref rid="pcbi.1004204.s006" ref-type="supplementary-material">S2 Fig</xref>). The strongest deviation is for a fixed <italic>α</italic>, and the smallest is for a fixed <italic>X</italic><sub>min</sub>. A fixed <italic>X</italic><sub>min</sub> is expected to have the smallest effect, since its estimate is closest to the reality in the studied distributions.</p>
<p>To summarize, the method above has been shown to converge properly in simulated and sampled data. However, for accurate estimates, it is recommended to treat all parameters <italic>X</italic><sub>min</sub>, <italic>X</italic><sub>max</sub> and <italic>α</italic> as free parameters to be estimated in the model.</p>
</sec>
<sec id="sec007">
<title>Haplotype Numbers in US Sub-populations</title>
<p>The resulting total number of haplotypes (<bold>H</bold>) in the European American population in the US is 286,787. Values for other sub-populations are given in <xref rid="pcbi.1004204.t002" ref-type="table">Table 2</xref>. For most populations, the haplotype frequency distribution follows a power law with exponent α of the PDF between 1.4 and 1.9. Further, estimates of the power law exponent converged before the full sample size was analyzed (<xref rid="pcbi.1004204.t003" ref-type="table">Table 3</xref> and <xref rid="pcbi.1004204.s007" ref-type="supplementary-material">S3</xref>–<xref rid="pcbi.1004204.s012" ref-type="supplementary-material">S8</xref> Figs).</p>
<table-wrap id="pcbi.1004204.t002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.t002</object-id>
<label>Table 2</label> <caption><title>Analysis of the five combined populations (African-Americans, Asian and Pacific Islanders, European Americans, Hispanic and Native Americans).</title></caption>
<alternatives>
<graphic id="pcbi.1004204.t002g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.t002" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Population</th>
<th align="left" rowspan="1" colspan="1">African Americans</th>
<th align="left" rowspan="1" colspan="1">Asian / Pacific Islander</th>
<th align="left" rowspan="1" colspan="1">European American</th>
<th align="left" rowspan="1" colspan="1">Hispanic</th>
<th align="left" rowspan="1" colspan="1">Native Americans</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">Size of population in Census</td>
<td align="left" rowspan="1" colspan="1">3.77E+07</td>
<td align="left" rowspan="1" colspan="1">1.49E+07</td>
<td align="left" rowspan="1" colspan="1">1.97E+08</td>
<td align="left" rowspan="1" colspan="1">4.52E+07</td>
<td align="left" rowspan="1" colspan="1">2.25E+06</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Exponent value (Value of alpha)</td>
<td align="left" rowspan="1" colspan="1">1.47</td>
<td align="left" rowspan="1" colspan="1">1.54</td>
<td align="left" rowspan="1" colspan="1">1.52</td>
<td align="left" rowspan="1" colspan="1">1.52</td>
<td align="left" rowspan="1" colspan="1">1.68</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Current sample size (R)</td>
<td align="left" rowspan="1" colspan="1">1.01E+06</td>
<td align="left" rowspan="1" colspan="1">1.14E+06</td>
<td align="left" rowspan="1" colspan="1">7.82E+06</td>
<td align="left" rowspan="1" colspan="1">1.43E+06</td>
<td align="left" rowspan="1" colspan="1">9.23E+04</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Current fraction of population covered</td>
<td align="left" rowspan="1" colspan="1">0.983</td>
<td align="left" rowspan="1" colspan="1">0.985</td>
<td align="left" rowspan="1" colspan="1">0.994</td>
<td align="left" rowspan="1" colspan="1">0.984</td>
<td align="left" rowspan="1" colspan="1">0.934</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Current number of known haplotypes</td>
<td align="left" rowspan="1" colspan="1">3.72E+04</td>
<td align="left" rowspan="1" colspan="1">3.69E+04</td>
<td align="left" rowspan="1" colspan="1">8.86E+04</td>
<td align="left" rowspan="1" colspan="1">4.45E+04</td>
<td align="left" rowspan="1" colspan="1">1.00E+04</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1"><bold>H</bold></td>
<td align="left" rowspan="1" colspan="1">1.42E+05</td>
<td align="left" rowspan="1" colspan="1">9.98E+04</td>
<td align="left" rowspan="1" colspan="1">3.16E+05</td>
<td align="left" rowspan="1" colspan="1">1.77E+05</td>
<td align="left" rowspan="1" colspan="1">4.70E+04</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">U(R) for current sample size</td>
<td align="left" rowspan="1" colspan="1">3.89E+04</td>
<td align="left" rowspan="1" colspan="1">3.83E+04</td>
<td align="left" rowspan="1" colspan="1">9.45E+04</td>
<td align="left" rowspan="1" colspan="1">4.73E+04</td>
<td align="left" rowspan="1" colspan="1">1.08E+04</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">U(R) for the whole population</td>
<td align="left" rowspan="1" colspan="1">1.30E+05</td>
<td align="left" rowspan="1" colspan="1">9.02E+04</td>
<td align="left" rowspan="1" colspan="1">2.87E+05</td>
<td align="left" rowspan="1" colspan="1">1.61E+05</td>
<td align="left" rowspan="1" colspan="1">4.17E+04</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Target sample size in order to get to 99.4% coverage</td>
<td align="left" rowspan="1" colspan="1">4.89E+06</td>
<td align="left" rowspan="1" colspan="1">3.88E+06</td>
<td align="left" rowspan="1" colspan="1">7.76E+06</td>
<td align="left" rowspan="1" colspan="1">6.16E+06</td>
<td align="left" rowspan="1" colspan="1">1.66E+06</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t002fn001"><p>The first row is the total size of the sub-population in the census, the second row is the estimate of <italic>α</italic> from <italic>U</italic>(<italic>R</italic>). The third row is the sample size. The following rows are fraction of the population covered, current known haplotypes number, estimate of maximal haplotype number, estimate of observed haplotype number according to the <italic>U</italic>(<italic>R</italic>) estimation. The following row (eighth row) is the estimated number of haplotypes for the entire census population. The last row is the required population size to get coverage similar to the European American population.</p></fn>
</table-wrap-foot>
</table-wrap>
<table-wrap id="pcbi.1004204.t003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.t003</object-id>
<label>Table 3</label> <caption><title>The values of <italic>α</italic> obtained from the 21 detailed US populations studied here.</title></caption>
<alternatives>
<graphic id="pcbi.1004204.t003g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.t003" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1"/>
<th align="left" rowspan="1" colspan="1">Number of Samples</th>
<th align="left" rowspan="1" colspan="1">Clauset</th>
<th align="left" rowspan="1" colspan="1">Estimate with half population</th>
<th align="left" rowspan="1" colspan="1">Estimate with full population</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">1. African American</td>
<td align="left" rowspan="1" colspan="1">8.33E+05</td>
<td align="char" char="." rowspan="1" colspan="1">1.75</td>
<td align="char" char="." rowspan="1" colspan="1">1.46</td>
<td align="char" char="." rowspan="1" colspan="1">1.45</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">2. Caribbean Indian</td>
<td align="left" rowspan="1" colspan="1">2.87E+04</td>
<td align="char" char="." rowspan="1" colspan="1">2.49</td>
<td align="char" char="." rowspan="1" colspan="1">1.62</td>
<td align="char" char="." rowspan="1" colspan="1">1.79</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">3. African</td>
<td align="left" rowspan="1" colspan="1">5.71E+04</td>
<td align="char" char="." rowspan="1" colspan="1">2.17</td>
<td align="char" char="." rowspan="1" colspan="1">1.58</td>
<td align="char" char="." rowspan="1" colspan="1">1.56</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">4. European American</td>
<td align="left" rowspan="1" colspan="1">7.82E+06</td>
<td align="char" char="." rowspan="1" colspan="1">1.78</td>
<td align="char" char="." rowspan="1" colspan="1">1.62</td>
<td align="char" char="." rowspan="1" colspan="1">1.60</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">5. Chinese</td>
<td align="left" rowspan="1" colspan="1">1.99E+05</td>
<td align="char" char="." rowspan="1" colspan="1">1.96</td>
<td align="char" char="." rowspan="1" colspan="1">1.59</td>
<td align="char" char="." rowspan="1" colspan="1">1.58</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">6. South Asian</td>
<td align="left" rowspan="1" colspan="1">3.71E+05</td>
<td align="char" char="." rowspan="1" colspan="1">1.86</td>
<td align="char" char="." rowspan="1" colspan="1">1.59</td>
<td align="char" char="." rowspan="1" colspan="1">1.58</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">7. Filipino</td>
<td align="left" rowspan="1" colspan="1">1.01E+05</td>
<td align="char" char="." rowspan="1" colspan="1">2.08</td>
<td align="char" char="." rowspan="1" colspan="1">1.60</td>
<td align="char" char="." rowspan="1" colspan="1">1.59</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">8. South/Cntrl Amer. Hisp.</td>
<td align="left" rowspan="1" colspan="1">2.93E+05</td>
<td align="char" char="." rowspan="1" colspan="1">1.94</td>
<td align="char" char="." rowspan="1" colspan="1">1.55</td>
<td align="char" char="." rowspan="1" colspan="1">1.54</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">9. American Indian South or Central American</td>
<td align="left" rowspan="1" colspan="1">1.19E+04</td>
<td align="char" char="." rowspan="1" colspan="1">2.86</td>
<td align="char" char="." rowspan="1" colspan="1">1.61</td>
<td align="char" char="." rowspan="1" colspan="1">1.60</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">10. Hawaiian or other Pacific Islander</td>
<td align="left" rowspan="1" colspan="1">2.30E+04</td>
<td align="char" char="." rowspan="1" colspan="1">2.49</td>
<td align="char" char="." rowspan="1" colspan="1">1.66</td>
<td align="char" char="." rowspan="1" colspan="1">1.65</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">11. Black South or Central America</td>
<td align="left" rowspan="1" colspan="1">9.78E+03</td>
<td align="char" char="." rowspan="1" colspan="1">2.87</td>
<td align="char" char="." rowspan="1" colspan="1">1.65</td>
<td align="char" char="." rowspan="1" colspan="1">1.63</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">12. Alaska Native or Aleut</td>
<td align="left" rowspan="1" colspan="1">2.75E+03</td>
<td align="char" char="." rowspan="1" colspan="1">3.27</td>
<td align="char" char="." rowspan="1" colspan="1">1.79</td>
<td align="char" char="." rowspan="1" colspan="1">1.77</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">13. Japanese</td>
<td align="left" rowspan="1" colspan="1">4.92E+04</td>
<td align="char" char="." rowspan="1" colspan="1">2.04</td>
<td align="char" char="." rowspan="1" colspan="1">1.55</td>
<td align="char" char="." rowspan="1" colspan="1">1.55</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">14. Other Southeast Asian</td>
<td align="left" rowspan="1" colspan="1">5.59E+04</td>
<td align="char" char="." rowspan="1" colspan="1">2.21</td>
<td align="char" char="." rowspan="1" colspan="1">1.84</td>
<td align="char" char="." rowspan="1" colspan="1">1.84</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">15. North American Indian</td>
<td align="left" rowspan="1" colspan="1">7.16E+04</td>
<td align="char" char="." rowspan="1" colspan="1">2.12</td>
<td align="char" char="." rowspan="1" colspan="1">1.53</td>
<td align="char" char="." rowspan="1" colspan="1">1.52</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">16. Korean</td>
<td align="left" rowspan="1" colspan="1">1.55E+05</td>
<td align="char" char="." rowspan="1" colspan="1">1.85</td>
<td align="char" char="." rowspan="1" colspan="1">1.51</td>
<td align="char" char="." rowspan="1" colspan="1">1.50</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">17. Vietnamese</td>
<td align="left" rowspan="1" colspan="1">8.71E+04</td>
<td align="char" char="." rowspan="1" colspan="1">1.99</td>
<td align="char" char="." rowspan="1" colspan="1">1.60</td>
<td align="char" char="." rowspan="1" colspan="1">1.59</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">18. Black Caribbean</td>
<td align="left" rowspan="1" colspan="1">6.67E+04</td>
<td align="char" char="." rowspan="1" colspan="1">2.16</td>
<td align="char" char="." rowspan="1" colspan="1">1.60</td>
<td align="char" char="." rowspan="1" colspan="1">1.58</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">19. MidEast/No. Coast of Africa</td>
<td align="left" rowspan="1" colspan="1">1.42E+05</td>
<td align="char" char="." rowspan="1" colspan="1">2.08</td>
<td align="char" char="." rowspan="1" colspan="1">1.58</td>
<td align="char" char="." rowspan="1" colspan="1">1.57</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">20. Caribbean Hispanic</td>
<td align="left" rowspan="1" colspan="1">2.31E+05</td>
<td align="char" char="." rowspan="1" colspan="1">1.94</td>
<td align="char" char="." rowspan="1" colspan="1">1.54</td>
<td align="char" char="." rowspan="1" colspan="1">1.54</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">21. Mexican or Chicano</td>
<td align="left" rowspan="1" colspan="1">5.22E+05</td>
<td align="char" char="." rowspan="1" colspan="1">1.88</td>
<td align="char" char="." rowspan="1" colspan="1">1.55</td>
<td align="char" char="." rowspan="1" colspan="1">1.54</td>
</tr>
</tbody>
</table>
</alternatives>
<table-wrap-foot>
<fn id="t003fn001"><p>The second column is the number of samples used for these populations. The following columns are <italic>α</italic> estimates, based on the Clauset estimator (third column) and our parametric method, using half the sample or the full sample (last two columns).</p></fn>
</table-wrap-foot>
</table-wrap>
<p>An important aspect of <xref rid="pcbi.1004204.e010" ref-type="disp-formula">Eq 7</xref> is that it does not saturate until the sample size is close to the full population size. We therefore expect that haplotypes discovery rate should remain appreciable with continued sampling given that the current sample size is about 3.97% of the European American populations. In contrast, if the distribution were light-tailed, we would be expected to detect all of the haplotypes that exist. Since the distribution is heavy tailed, we estimate to have detected only 30% of <bold>H</bold> that exist in the US population (<xref rid="pcbi.1004204.t002" ref-type="table">Table 2</xref>).</p>
</sec>
<sec id="sec008">
<title>Population Coverage</title>
<p>An important aspect of the low value of α (<italic>α</italic> ≤ 2 in most cases) is that there is a large difference between the fraction of observed haplotypes and the population coverage, defined as the fraction of samples (two per person) with a known haplotype. When α is close to 1, most of the haplotypes have practically no contribution to the coverage. Actually only very few haplotypes in the right hand tail of <italic>v</italic><sub><italic>H</italic></sub>(<italic>x</italic>) (the larger values of <italic>x</italic>) contribute to the population coverage. For example, in the European American population, the most frequent 1% of haplotypes provide 73.18% of the coverage.</p>
<p>The fraction of the population with haplotypes which have already been identified can be computed to be (see <xref rid="pcbi.1004204.s004" ref-type="supplementary-material">S4 Text</xref>):
<disp-formula id="pcbi.1004204.e018">
<alternatives>
<graphic id="pcbi.1004204.e018g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e018" xlink:type="simple"/>
<mml:math display="block" id="M18" overflow="scroll">
<mml:mrow><mml:mi>F</mml:mi><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>c</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>o</mml:mi><mml:mi>n</mml:mi><mml:mi>C</mml:mi><mml:mi>o</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mrow/><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
where γ is the partial gamma function. As was the case for <xref rid="pcbi.1004204.e010" ref-type="disp-formula">Eq 7</xref>, we compared the values obtained from this calculation to the values obtained in the simulation mentioned above, and obtained an excellent fit (<xref rid="pcbi.1004204.s013" ref-type="supplementary-material">S9 Fig</xref>).</p>
<p>One can apply <xref rid="pcbi.1004204.e011" ref-type="disp-formula">Eq 8</xref> to the European American population, for example, and obtain that only around 88,620 haplotypes are identified today, out of over 286,787 haplotypes that are estimated to exist in the total population (<xref rid="pcbi.1004204.g005" ref-type="fig">Fig 5A</xref> and <xref rid="pcbi.1004204.t002" ref-type="table">Table 2</xref>). However, the coverage of these 88,620 haplotypes is about 99.4% (<xref rid="pcbi.1004204.g005" ref-type="fig">Fig 5C</xref> and <xref rid="pcbi.1004204.t002" ref-type="table">Table 2</xref>). The relationship between the coverage and the number of haplotypes depends on α, and varies among the studied populations. We analyzed 5 combined populations, for which clear census based estimates of the total population size are available (African-Americans—AFA, Asian Pacific Islanders—API, European Americans—CAU, Hispanic—HIS and Native Americans—NAM), and calculated the sample size needed in order to have the same percent coverage of the European American population (<xref rid="pcbi.1004204.g005" ref-type="fig">Fig 5D</xref> and <xref rid="pcbi.1004204.t002" ref-type="table">Table 2</xref>). The combined populations have similar distributions (<xref rid="pcbi.1004204.g005" ref-type="fig">Fig 5A</xref>), with the European American population having the flattest distribution (least diverse, or most contribution from frequent haplotypes), and the Native American having the steepest slope (most diverse, and the least contribution from frequent haplotypes). However, since as mentioned above the number of haplotypes (<bold>H</bold>) is affected by the total population size, the Native American population is actually the least diverse, while the European American population is the most diverse, when <bold>H</bold> is taken as a measure of the diversity (<xref rid="pcbi.1004204.g005" ref-type="fig">Fig 5B</xref>). While most haplotypes are not sampled, most individuals in the population carry known haplotypes. As mentioned earlier, 99.4% of the European American population is covered by observed haplotypes (<xref rid="pcbi.1004204.g005" ref-type="fig">Fig 5C</xref>). Coverage is also more than 98% for the Hispanic, African-American and Asian/Pacific Islander populations. Coverage is less for the Native American population at 93.4% percent. In order to reach the percent coverage that currently exists for the European American population, 1 to 6 million additional donors would need to be recruited for each of the other populations (<xref rid="pcbi.1004204.g005" ref-type="fig">Fig 5D</xref>). This represents a factor between the required and existing sample size of around 3 for the Asian Pacific Islanders, but up to 15 for Native Americans, as summarized in <xref rid="pcbi.1004204.t002" ref-type="table">Table 2</xref>.</p>
<fig id="pcbi.1004204.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Properties for haplotypes frequency distribution for 5 populations</title>
<p>: Native Americans (NAM), European Americans (CAU), Hispanic (HIS), African-Americans (AFA) and Asian Pacific Islanders (API). (A) Histogram of haplotype relative frequency distribution for the five combined populations: Native Americans (NAM, black circles), European Americans (CAU, gray triangles), Hispanic (HIS, green diamonds), African-Americans (AFA, purple circles) and Asian Pacific Islanders (API, red circles). (B) Estimated (black) and currently observed (white) total number of haplotypes. (C) Fraction of non-covered population for the five combined populations. (D) Current sample size (white) and estimated sample size required to get coverage similar to the European American population (black) for the five combined populations. Note that if the fit to a truncated power law would be precise, the required and observed population size would be precisely equal for the Caucasian population. However, there are some limited deviations in the fit, and the required population from the theoretical analysis is 7.76E+06, while the observed population size is 7.82E6 (a difference of less than 1%).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.g005" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec009">
<title>Probability of New Haplotype Discovery</title>
<p>The contrast between the small fraction of haplotypes known and the large coverage implies that the frequency of each undiscovered haplotype is expected to be very small. The probability that a haplotype from a newly sampled host is not present in the current sample of size R is (see <xref rid="pcbi.1004204.s004" ref-type="supplementary-material">S4 Text</xref>):
<disp-formula id="pcbi.1004204.e019">
<alternatives>
<graphic id="pcbi.1004204.e019g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e019" xlink:type="simple"/>
<mml:math display="block" id="M19" overflow="scroll">
<mml:mrow><mml:mi>Z</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>R</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>R</mml:mi><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula>
where γ is the partial gamma function. We validated the accuracy of our analytical equation using simulation (<xref rid="pcbi.1004204.s014" ref-type="supplementary-material">S10 Fig</xref>). This function decreases slowly as a function of sample size <italic>R</italic>, which explains the high degree of population coverage achieved even with limited discovery of all haplotypes in the population. Additionally, this value could be used to assign an expected frequency to missing haplotypes, which in turn could be used in HSCT matching to assign haplotype frequencies to newly discovered haplotypes not covered by the EM haplotype frequencies.</p>
</sec>
<sec id="sec010">
<title>Estimates of A (Number of Unique Alleles)</title>
<p>A similar analysis can be performed on the observed portion of <bold>A</bold>. Each haplotype is composed of alleles at 6 genetic loci: ‘A’,’B’,’C’,’DQB1’,’DRB1’,’DRBX’. We separated the haplotype data and generated allele distributions for each of the 6 loci. Our assumptions about the alleles are just the same as for the haplotypes, and a similar analysis was performed on each loci. We fit the expected number of alleles <italic>U</italic>(<italic>R</italic>) as a function of the sample size <italic>R</italic> to the actual number of unique alleles in partial samples of the data we have for alleles (see <xref rid="sec012" ref-type="sec">Methods</xref>) to obtain the values of <italic>X</italic><sub>min</sub>, <italic>X</italic><sub>max</sub> and <italic>α</italic>.</p>
<p>The allele distribution by loci is very flat with powers approaching 1 (<xref rid="pcbi.1004204.t004" ref-type="table">Table 4</xref>). Such powers give most of the importance to the frequent alleles and reduce the total number of alleles for a given population size. Indeed, estimates of <bold>A</bold> according to the current sample for the data of the five combined populations are not much higher than the observed number of alleles (<xref rid="pcbi.1004204.g006" ref-type="fig">Fig 6</xref> left plot).</p>
<table-wrap id="pcbi.1004204.t004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.t004</object-id>
<label>Table 4</label> <caption><title>Estimate of <italic>α</italic> for the allele frequency distribution for all allele types and for each combined sub population.</title></caption>
<alternatives>
<graphic id="pcbi.1004204.t004g" position="float" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.t004" xlink:type="simple"/>
<table>
<colgroup span="1">
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
<col align="left" valign="middle" span="1"/>
</colgroup>
<thead>
<tr>
<th align="left" rowspan="1" colspan="1">Population</th>
<th align="left" rowspan="1" colspan="1">A</th>
<th align="left" rowspan="1" colspan="1">B</th>
<th align="left" rowspan="1" colspan="1">C</th>
<th align="left" rowspan="1" colspan="1">DQB1</th>
<th align="left" rowspan="1" colspan="1">DRB1</th>
<th align="left" rowspan="1" colspan="1">DRBX</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" rowspan="1" colspan="1">African Americans</td>
<td align="char" char="." rowspan="1" colspan="1">1.19</td>
<td align="char" char="." rowspan="1" colspan="1">1.21</td>
<td align="char" char="." rowspan="1" colspan="1">1.17</td>
<td align="char" char="." rowspan="1" colspan="1">1.01</td>
<td align="char" char="." rowspan="1" colspan="1">1.05</td>
<td align="char" char="." rowspan="1" colspan="1">1.03</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Asian / Pacific Islander</td>
<td align="char" char="." rowspan="1" colspan="1">1.15</td>
<td align="char" char="." rowspan="1" colspan="1">1.17</td>
<td align="char" char="." rowspan="1" colspan="1">1.16</td>
<td align="char" char="." rowspan="1" colspan="1">0.93</td>
<td align="char" char="." rowspan="1" colspan="1">1.09</td>
<td align="char" char="." rowspan="1" colspan="1">0.99</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">European American</td>
<td align="char" char="." rowspan="1" colspan="1">1.28</td>
<td align="char" char="." rowspan="1" colspan="1">1.29</td>
<td align="char" char="." rowspan="1" colspan="1">1.23</td>
<td align="char" char="." rowspan="1" colspan="1">0.97</td>
<td align="char" char="." rowspan="1" colspan="1">1.15</td>
<td align="char" char="." rowspan="1" colspan="1">1.07</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Hispanic</td>
<td align="char" char="." rowspan="1" colspan="1">1.20</td>
<td align="char" char="." rowspan="1" colspan="1">1.14</td>
<td align="char" char="." rowspan="1" colspan="1">1.15</td>
<td align="char" char="." rowspan="1" colspan="1">0.99</td>
<td align="char" char="." rowspan="1" colspan="1">1.11</td>
<td align="char" char="." rowspan="1" colspan="1">1.02</td>
</tr>
<tr>
<td align="left" rowspan="1" colspan="1">Native Americans</td>
<td align="char" char="." rowspan="1" colspan="1">1.13</td>
<td align="char" char="." rowspan="1" colspan="1">1.18</td>
<td align="char" char="." rowspan="1" colspan="1">1.07</td>
<td align="char" char="." rowspan="1" colspan="1">1.04</td>
<td align="char" char="." rowspan="1" colspan="1">1.06</td>
<td align="char" char="." rowspan="1" colspan="1">0.98</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<fig id="pcbi.1004204.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Alleles results.</title>
<p>(left) Known (colored) vs. total alleles (transparent) for the five combined populations. The fraction of known alleles is between 50 and 100%. (right) Fraction of uncovered population per allele and combined population. These fractions are much lower than for haplotypes and never reach more than 0.1%.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.g006" position="float" xlink:type="simple"/>
</fig>
<p>Consequentially, the fraction of uncovered population is much smaller for the alleles than for the haplotypes reaching 0.1% in the worst case (Native Americans for HLA—B which is the most diverse locus (<xref rid="pcbi.1004204.g006" ref-type="fig">Fig 6</xref> right plot)). As expected by their reported diversity [<xref rid="pcbi.1004204.ref009" ref-type="bibr">9</xref>], Class I HLA alleles have a slightly higher power exponent (1.2–1.3) than class II (around 1) (<xref rid="pcbi.1004204.t004" ref-type="table">Table 4</xref>). The class II power exponents, which are all close 1, are expected from neutral evolution model [<xref rid="pcbi.1004204.ref023" ref-type="bibr">23</xref>], highlighting that if selection occurs, it is mainly focused on class I or it is occurring at the haplotype level.</p>
<p>Surprisingly, the discovery rate for new alleles in the IMGT database appears to be increasing, in contrast with the conclusion that most alleles are known, raising the suspicion that the total number of existing alleles is much larger than current estimates. However, the estimates above propose that most alleles are currently known.</p>
<p>To better understand this contradiction, we computed allele sample sizes during the years 1987–2011 and calculated the expected number of alleles based on these sample sizes, using the α, <italic>X</italic><sub><italic>min</italic></sub> and <italic>X</italic><sub><italic>max</italic></sub> values obtained for the largest sample. We plotted the expected number of alleles as a function of time and compared it to the number of alleles which were identified by that date in the IMGT (<xref rid="pcbi.1004204.g007" ref-type="fig">Fig 7</xref>). In analyzing the entire US population as a whole, a comparison between the expected number of alleles <italic>U</italic>(<italic>R</italic>) and those actually observed presents a contradiction: Initially, the number of observed alleles was significantly less than expected based upon sample size; presently, it is much larger than expected.</p>
<fig id="pcbi.1004204.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004204.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Comparison between expected and observed number of alleles for each locus.</title>
<p>The black circles represent the numbers computed from the <italic>U</italic>(<italic>R</italic>) based estimate. The green diamonds represent the alleles in the registry, the gray triangles represent all alleles in the IMGT. The analysis is on all samples combined. Each subplot represents a different locus.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.g007" position="float" xlink:type="simple"/>
</fig>
<p>The explanation for this contradiction appears to be two-fold: First, false allele discovery represents a known source of error common with PCR when crossover products occur [<xref rid="pcbi.1004204.ref022" ref-type="bibr">22</xref>] and could contribute to the observed discrepancy. Second and more importantly, the transition to sequencing-based typing (SBT) changed the fundamental nature of allele definitions and improved capacity for allele discovery. With a much larger definition of alleles and a higher discovery rate, the fundamental power law relationship would be expected to change at some point in time as the data sources move towards SBT versus older oligo or serology based methods. For example, a recent data submission from a single SBT laboratory resulted in a 30% increase in the number of observed alleles [<xref rid="pcbi.1004204.ref024" ref-type="bibr">24</xref>]. Thus, our current power-law methodology appears flawed for providing accurate estimates for the number of unique alleles and requires future modifications to accommodate the mixed data sources.</p>
</sec>
</sec>
<sec id="sec011" sec-type="conclusions">
<title>Discussion</title>
<p>In this analysis, we developed a quantitative methodology for measuring haplotype and allele diversity with a particular application in mind of estimating <bold>A</bold> and <bold>H</bold> in the United States population to inform HSCT matching. Quantitative estimates of <bold>A</bold> and <bold>H</bold> are important for assessing whether typed donor cohorts have sufficient sampling depth to capture the clinically relevant HLA variation among individuals. Estimates of <bold>A</bold> and <bold>H</bold> for the Be The Match Registry suggest that current registry sampling depth is sufficient to represent only 52–100% of <bold>A</bold> and 21–30% of <bold>H</bold> across the 5 main racial populations assessed. The number of “rare” alleles and haplotypes, however, is small compared to the number of “common” ones suggesting that the current diversity of our registry is sufficient to describe 99.94–100% and 93.4–99.4% of the overall United States population with respect to allele and haplotype coverage. Further, the estimation methods developed in this article quickly converged—with limited sampling depth—to accurate estimates of allele and haplotype diversity in the presence of heavy-tailed distributions. Popular methods intended for measuring diversity with bell shaped distributions were shown to require deep samples before achieving meaningful convergence, as was the case for capture-recapture models, or failed outright to converge toward accurate estimates. A detailed comparison of our methodology with state of the art species richness estimates, as performed by the CatchAll software, show a much faster and more precise convergence to the real haplotype number using our methodology.</p>
<p>The methodology we developed is closely aligned with the broader fields of ecology, computation, and statistics as they relate to describing species richness, language diversity, data base storage, and occupancy. The common thread among these problems is the need to understand the behavior of “rare” events in a population with a heavy tail distribution: this can be problematic because “rare” events represent critical patterns that have minimal, if any, representation within the sample. Appropriate statistical methodologies for “rare” events recognize that light tailed distributions (often having the characteristic bell shape) are inappropriate for adequately describing population diversity. The assumption of a light tailed distribution implies that a relatively small sample is enough to detect and fully describe the population (i.e. captures all species or haplotype diversity). This intuition stems from the absence of extremely rare events, which is an untrue assumption for a heavy tail distribution. For example, in most realistic species distributions, the majority of species are very rare, and thus a very deep sample is required to detect most species. Moreover, if the tail is flat enough, another element should be incorporated, which is the extreme contribution of the most frequent species to the distribution. In such cases, most of the population will belong to a very small number of species.</p>
<p>Therefore, we built our model around a truncated power-law for estimating the properties of infinite discrete distributions with regularly varying heavy tails [<xref rid="pcbi.1004204.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1004204.ref008" ref-type="bibr">8</xref>,<xref rid="pcbi.1004204.ref014" ref-type="bibr">14</xref>]. The properties of our data fit these assumptions, which require an index of variation <italic>α</italic> ∈ (1,2) for the PDF of frequencies: our index of variation ranged from 1.45 to 1.85 across the 21 populations. We note that to support the interpretability of our results, we modeled the PDF of frequencies whereas others have modeled the CDF of frequencies where values of <italic>α</italic> will be <italic>α</italic> - 1 units smaller. It is important to note that the convergence to the proper values of <italic>α</italic> occurred for a limited sample size. Thus, our method may be applicable for other surveys where the sample size is much smaller. Moreover, beyond the need to estimate the total number of different haplotype, the proposed method can be used to properly estimate <italic>α</italic> for small population sizes.</p>
<p>In the infinite case, one ignores the right hand side behavior because the “common” events offer a negligible contribution to overall diversity. Eventually, one might consider a more complex model where we define <inline-formula id="pcbi.1004204.e025"><alternatives><graphic id="pcbi.1004204.e025g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e025" xlink:type="simple"/><mml:math display="inline" id="M25" overflow="scroll"><mml:mi>v</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>x</mml:mi></mml:mrow></mml:mfenced><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mi>C</mml:mi><mml:msup><mml:mrow><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mo>-</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mi>L</mml:mi><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>, with <italic>L</italic> (<italic>X</italic>) being a general function with the property that v(x) = <italic>Cx</italic><sup>-<italic>α</italic></sup><italic>L</italic>(<italic>x</italic>). Such a function would account more smoothly for the different slopes in the left hand part and the right hand part of the distribution. Note however, that in realistic situations, the most frequent haplotypes (or species) are well known, and their frequency is well estimated. Thus, a simpler approach could be to split the population into frequency known haplotypes and rare haplotypes, and focus on the distribution of the rare haplotypes, taking into account that their contribution to the population coverage may be very limited, even if they constitute the vast majority of the diversity.</p>
<p>While we have here focused on the HLA haplotype distribution, the same formalism can be applied to other domains of ecology and population genetics, where the species richness distributions have heavy tails [<xref rid="pcbi.1004204.ref025" ref-type="bibr">25</xref>,<xref rid="pcbi.1004204.ref026" ref-type="bibr">26</xref>,<xref rid="pcbi.1004204.ref027" ref-type="bibr">27</xref>,<xref rid="pcbi.1004204.ref028" ref-type="bibr">28</xref>], see [<xref rid="pcbi.1004204.ref029" ref-type="bibr">29</xref>] for a review. In ecological scenarios, since most species are very rare, the current shrinking of the wildlife population is equivalent to a dramatic reduction in the total diversity. While in normal distributions we expect species to disappear and diversity to be significantly reduced only when the total population is close to extinction, the heavy tailed distribution of species frequencies leads to opposite conclusions. For example, assuming parameters similar to the ones obtained here, a 10 fold reduction in the total population would be equivalent to a 17–18% reduction in the number of species.</p>
<p>Note that in ecological scenarios, it is not appropriate to assume that all species are equally detectable at the level of the individual. Certain species are less detectable based on experimental or behavioral elements (e.g. speed of movement). A future development of such methods should be the introduction of a frequency bias in the detection probability.</p>
<p>Regarding validation, we compared our estimates of <bold>A</bold> and <bold>H—</bold>based upon subsamples of the data—to counts obtained by enumerating the complete data set. Although our predictions aligned reasonably with the absolute frequencies, we are concerned with the fact that the underlying data may be biased towards over-representing common alleles and haplotypes; thus, our estimates of <bold>A</bold> and <bold>H</bold> may under-represent the true population diversity. Our concern is based upon the mechanics of the EM algorithm, which trim the tail of the haplotype frequency distribution numerous times during the estimation process to generate a parsimonious and tractable candidate set; without trimming the number of potential haplotypes that greatly exceeds the number of donors. Further, expected changes in typing technology (that are already underway) from SBT to next generation sequencing (NGS) may also re-define allele definitions and increase the capacity for allele discovery. For example, NGS has the ability to detect allelic variants previously “hidden” behind genotypes that only differ by recombination [<xref rid="pcbi.1004204.ref030" ref-type="bibr">30</xref>]. In short, EM and typing technology factors could increase estimates for <bold>A</bold> and <bold>H</bold> by changing the fundamental nature of the power law relationship.</p>
</sec>
<sec id="sec012" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec013">
<title>Haplotype and Allele Frequency Data</title>
<p>Six-locus high resolution HLA A~C~B~DRBX~DRB1~DQB1 (where DRBX = DRB3/4/5) haplotype frequencies were estimated across 21 race groups using an EM algorithm and 6.59 million donor HLA typings from the Be The Match Registry: complete details regarding the data and estimation are provided by Gragert [<xref rid="pcbi.1004204.ref011" ref-type="bibr">11</xref>]. In brief, an EM algorithm was utilized to resolve uncertainties in allele and chromosomal phase for a mixed resolution set of donor HLA typings (serology, sequence-specific oligonucleotide/primer, and sequence based typing). The only notable change from the Gragert methodology was that in the last iteration of the EM algorithm, a winner-take-all approach was applied where each donor contributed 1 unit of probability mass to their most likely pair of haplotypes; this is opposed to each donor assigning 1 unit of probability mass across a range of haplotype pairs—consistent with their HLA typing—in proportion to their conditional likelihood. Allele frequencies were derived as marginal sums of the haplotype frequencies.</p>
</sec>
<sec id="sec014">
<title>Methodology Validation</title>
<p>We have performed simulations with chosen <italic>α</italic> and <italic>N</italic><sub><italic>total</italic></sub>. For each set of <italic>α</italic> and <italic>N</italic><sub><italic>total</italic></sub> values, we set <italic>X</italic><sub>min</sub> to be <inline-formula id="pcbi.1004204.e027"><alternatives><graphic id="pcbi.1004204.e027g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e027" xlink:type="simple"/><mml:math display="inline" id="M27" overflow="scroll"><mml:mrow><mml:mfrac bevelled="true"><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>t</mml:mi><mml:mi>o</mml:mi><mml:mi>t</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:math></alternatives></inline-formula>, and calculated the maximum value possible for <italic>X</italic><sub>max</sub> using numerical solution of <italic>x</italic><sup><italic>2</italic></sup>(1-<italic>x</italic><sup>α-2</sup>)-<italic>C</italic> = 0 where <italic>C</italic> = (2-<italic>α</italic>)<italic>N</italic><sub><italic>total</italic></sub> (see Eq B6 in <xref rid="pcbi.1004204.s002" ref-type="supplementary-material">S2 Text</xref>). We then calculated the number of unique haplotypes expected in the total population (<bold>H</bold>). Next, we generated <bold>H</bold> <italic>p</italic><sub><italic>j</italic></sub><italic>’s</italic> for the distribution (see <xref rid="pcbi.1004204.s001" ref-type="supplementary-material">S1 Text</xref>) by inverting the CDF, obtaining: <inline-formula id="pcbi.1004204.e028"><alternatives><graphic id="pcbi.1004204.e028g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e028" xlink:type="simple"/><mml:math display="inline" id="M28" overflow="scroll"><mml:mrow><mml:msub><mml:mi>p</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mtext>X</mml:mtext><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msub><mml:mtext>X</mml:mtext><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mi>r</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>+</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mtext>X</mml:mtext><mml:mrow><mml:mi>min</mml:mi></mml:mrow></mml:msub><mml:msup><mml:mrow/><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mfrac bevelled="true"><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:math></alternatives></inline-formula> where <italic>rand</italic>(0,1) is a uniform random number between 0 and 1. We checked that the sum of all <italic>p</italic><sub><italic>j</italic></sub><italic>’s</italic> indeed equals 1, and very limited deviations were observed. We normalized the results to overcome the imprecise sum. We then produced a random population with these a priori probabilities, and compared the expected frequency of a haplotype unobserved in a sample (<italic>Z</italic>(<italic>R</italic>)), the expected number of unique haplotypes in the population (<italic>U</italic>(<italic>R</italic>)) and the fraction of the population covered by these haplotypes to the simulations results. Code for the estimation of <italic>U</italic>(<italic>R</italic>) and a test set are available in the Supp. Mat.</p>
</sec>
<sec id="sec015">
<title>Numerical Optimization</title>
<p>Given an observed population's haplotype frequency distribution, we assume that the frequency distribution is a scale free distribution with upper and lower cutoff values: <italic>X</italic><sub>min</sub>≤<italic>x</italic>≤<italic>X</italic><sub>max</sub>. We assume a zero probability of observing haplotypes with frequencies beyond these values. In order to estimate the properties of the distribution, the values of <italic>α</italic>, <italic>X</italic><sub>min</sub> and <italic>X</italic><sub>max</sub> should be estimated. We provide boundaries for <italic>X</italic><sub><italic>min</italic></sub> and <italic>X</italic><sub><italic>max</italic></sub> using Eq B1 and B6 in <xref rid="pcbi.1004204.s002" ref-type="supplementary-material">S2 Text</xref>. We then perform a numerical fit of the observed and expected (<xref rid="pcbi.1004204.e011" ref-type="disp-formula">Eq 8</xref>) unique haplotypes, with a cost function of <inline-formula id="pcbi.1004204.e029"><alternatives><graphic id="pcbi.1004204.e029g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004204.e029" xlink:type="simple"/><mml:math display="inline" id="M29" overflow="scroll"><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>R</mml:mi><mml:mo>'</mml:mo></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>U(R')-log(observed(R')</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>*</mml:mo><mml:mi>log</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>observed(R'))</mml:mtext></mml:mrow></mml:mstyle></mml:mrow></mml:math></alternatives></inline-formula> for different values of sample sizes <italic>R</italic><sup>’</sup>. We use an initial guess of the parameter above using Eq B1 for <italic>X</italic><sub><italic>min</italic></sub>, the highest observed frequency <italic>X</italic>0<sub>max</sub>, and the estimate of <italic>α</italic>, based on <xref rid="pcbi.1004204.e012" ref-type="disp-formula">Eq 9</xref>. We then extract the optimal parameters (<italic>α</italic>, <italic>X</italic><sub>max,</sub> <italic>X</italic><sub>max</sub>), calculate the expected total number of unique haplotypes <bold>H</bold> and produce an estimate of the number of unique haplotypes for any population size U(R).</p>
</sec>
</sec>
<sec id="sec016">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004204.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S1 Text</label>
<caption>
<title>Normalization for haplotype frequency density function.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s002" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s002" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S2 Text</label>
<caption>
<title>Range for haplotype frequency density function.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s003" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s003" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S3 Text</label>
<caption>
<title>Expected number of haplotypes.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s004" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s004" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S4 Text</label>
<caption>
<title>Calculation of probability that a haplotype is not observed and the fraction of the population covered with current observations.</title>
<p>(DOCX)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s005" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s005" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Ratio of analytical estimated <italic>U</italic>(<italic>R</italic>) values divided by simulation results for different values of sample size and <italic>α</italic> (Inset: Analytical estimation (gray solid line) and simulation values (black circles) of U(R) (black circles) for <italic>α</italic> = 1.5).</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s006" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s006" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S2 Fig</label>
<caption>
<title>Comparison of computed and observed expected number of haplotypes in a sample of size R</title>
<p>: <italic>U</italic>(<italic>R</italic>)for four different American populations for different sample sizes R. The gray squares are observations. All estimates were performed using 10% of the sample. The lines are an estimation of <italic>U</italic>(<italic>R</italic>)with all free parameters (full purple), maximal <italic>Xmax</italic> and free <italic>α</italic> (dashed green line), free <italic>Xmax</italic> and free <italic>α</italic> but fixed <italic>Xmin</italic> (dashed black line) and free boundaries but <italic>α</italic> based on the Clauset estimator (double dashed red line).</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s007" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s007" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S3 Fig</label>
<caption>
<title>Haplotype relative frequency distribution for the African-American, Japanese, Black Caribbean and South/Central American Hispanic populations.</title>
<p>Observations are in gray dashed lines with triangles, and black solid lines with circles are the linear regressions.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s008" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s008" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S4 Fig</label>
<caption>
<title>Haplotype relative frequency distribution for the African, Korean, Caribbean Hispanic and Black South or Central America populations.</title>
<p>Observations are in gray dashed lines with triangles, and black solid lines with circles are the linear regressions.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s009" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s009" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S5 Fig</label>
<caption>
<title>Haplotype relative frequency distribution for the Other Southeast Asian, Caribbean Indian, South Asian and MidEast/North Coast of Africa populations.</title>
<p>Observations are in gray dashed lines with triangles, and black solid lines with circles are the linear regressions.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s010" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s010" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S6 Fig</label>
<caption>
<title>Haplotype relative frequency distribution for the American Indian South or Central America, Mexican or Chicano, European American and Vietnamese populations.</title>
<p>Observations are in gray dashed lines with triangles, and black solid lines with circles are the linear regressions.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s011" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s011" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S7 Fig</label>
<caption>
<title>Haplotype relative frequency distribution for Alaska Native or Aleut, North American Indian, Filipino and Hawaiian or other Pacific Islander populations.</title>
<p>Observations are in gray dashed lines with triangles, and black solid lines with circles are the linear regressions.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s012" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s012" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S8 Fig</label>
<caption>
<title>Haplotype relative frequency distribution for the Chinese population.</title>
<p>Observations are in gray dashed lines with triangles, and black solid lines with circles are the linear regressions.</p>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s013" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s013" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S9 Fig</label>
<caption>
<title>Ratio of analytical estimated fraction of covered population values divided by simulation results for different values of sample size and <italic>α</italic> (Inset: Analytical estimation (gray solid line) and simulation values (black circles) of fraction of covered population for <italic>α</italic> = 1.5.).</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s014" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s014" mimetype="image/tiff" position="float" xlink:type="simple">
<label>S10 Fig</label>
<caption>
<title>Ratio of analytical estimated values of the probability that there exists at least one unobserved haplotype divided by simulations results for different values of sample size and <italic>α</italic> (Inset: Analytical estimation (gray solid line) and simulation values (black circles) of the probability that there exists at least one unobserved haplotype for <italic>α</italic> = 1.5.).</title>
<p>(TIFF)</p>
</caption>
</supplementary-material>
<supplementary-material id="pcbi.1004204.s015" xlink:href="info:doi/10.1371/journal.pcbi.1004204.s015" mimetype="application/zip" position="float" xlink:type="simple">
<label>S1 Code</label>
<caption>
<title>Matlab code for estimation of U(R).</title>
<p>(ZIP)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>Thanks to Abeer Madbouly for her helpful edits and advice that helped improve the manuscript presentation. We thank Miriam Beller for the text editing of the current manuscript.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004204.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dunn</surname> <given-names>GP</given-names></name>, <name name-style="western"><surname>Old</surname> <given-names>LJ</given-names></name>, <name name-style="western"><surname>Schreiber</surname> <given-names>RD</given-names></name> (<year>2004</year>) <article-title>The immunobiology of cancer immunosurveillance and immunoediting</article-title>. <source>Immunity</source> <volume>21</volume>: <fpage>137</fpage>–<lpage>148</lpage>. <object-id pub-id-type="pmid">15308095</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hansen</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Yamamoto</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Petersdorf</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Sasazuki</surname> <given-names>T</given-names></name> (<year>1998</year>) <article-title>The role of HLA matching in hematopoietic cell transplantation</article-title>. <source>Reviews in immunogenetics</source> <volume>1</volume>: <fpage>359</fpage>–<lpage>373</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004204.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Petersdorf</surname> <given-names>EW</given-names></name>, <name name-style="western"><surname>Anasetti</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Martin</surname> <given-names>PJ</given-names></name>, <name name-style="western"><surname>Gooley</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Radich</surname> <given-names>J</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Limits of HLA mismatching in unrelated hematopoietic cell transplantation</article-title>. <source>Blood</source> <volume>104</volume>: <fpage>2976</fpage>–<lpage>2980</lpage>. <object-id pub-id-type="pmid">15251989</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Kollman</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Maiers</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Gragert</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Müller</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Setterholm</surname> <given-names>M</given-names></name>, <etal>et al</etal>. (<year>2007</year>) <article-title>Estimation of HLA-A,-B,-DRB1 haplotype frequencies using mixed resolution data from a national registry with selective retyping of volunteers</article-title>. <source>Human immunology</source> <volume>68</volume>: <fpage>950</fpage>–<lpage>958</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.humimm.2007.10.009" xlink:type="simple">10.1016/j.humimm.2007.10.009</ext-link></comment> <object-id pub-id-type="pmid">18191722</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Friedman</surname> <given-names>JH</given-names></name> (<year>1997</year>) <article-title>On bias, variance, 0/1—loss, and the curse-of-dimensionality</article-title>. <source>Data mining and knowledge discovery</source> <volume>1</volume>: <fpage>55</fpage>–<lpage>77</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004204.ref006"><label>6</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Glanville</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Zhai</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Berka</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Telman</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Huerta</surname> <given-names>G</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Precise determination of the diversity of a combinatorial antibody library gives insight into the human immunoglobulin repertoire</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>106</volume>: <fpage>20216</fpage>–<lpage>20221</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1073/pnas.0909775106" xlink:type="simple">10.1073/pnas.0909775106</ext-link></comment> <object-id pub-id-type="pmid">19875695</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ohannessian</surname> <given-names>MI</given-names></name>, <name name-style="western"><surname>Dahleh</surname> <given-names>MA</given-names></name> (<year>2012</year>) <article-title>Rare Probability Estimation under Regularly Varying Heavy Tails</article-title>. <source>Journal of Machine Learning Research-Proceedings Track</source> <volume>23</volume>: <fpage>21.21</fpage>–<lpage>21.24</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004204.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gnedin</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Hansen</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Pitman</surname> <given-names>J</given-names></name> (<year>2007</year>) <article-title>Notes on the occupancy problem with infinitely many boxes: general asymptotics and power laws</article-title>. <source>Probab Surv</source> <volume>4</volume>: <fpage>146</fpage>–<lpage>171</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004204.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Waller</surname> <given-names>MJ</given-names></name>, <name name-style="western"><surname>Parham</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>de Groot</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Bontrop</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2003</year>) <article-title>IMGT/HLA and IMGT/MHC: sequence databases for the study of the major histocompatibility complex</article-title>. <source>Nucleic acids research</source> <volume>31</volume>: <fpage>311</fpage>–<lpage>314</lpage>. <object-id pub-id-type="pmid">12520010</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mack</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Cano</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Hollenbach</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>He</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Hurley</surname> <given-names>C</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Common and well‐documented HLA alleles: 2012 update to the CWD catalogue</article-title>. <source>Tissue antigens</source> <volume>81</volume>: <fpage>194</fpage>–<lpage>203</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/tan.12093" xlink:type="simple">10.1111/tan.12093</ext-link></comment> <object-id pub-id-type="pmid">23510415</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref011"><label>11</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gragert</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Madbouly</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Freeman</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Maiers</surname> <given-names>M</given-names></name> (<year>2013</year>) <article-title>Six-locus high resolution HLA haplotype frequencies derived from mixed-resolution DNA typing for the entire US donor registry</article-title>. <source>Human immunology</source> <volume>74</volume>: <fpage>1313</fpage>–<lpage>1320</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.humimm.2013.06.025" xlink:type="simple">10.1016/j.humimm.2013.06.025</ext-link></comment> <object-id pub-id-type="pmid">23806270</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Klitz</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Hedrick</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Louis</surname> <given-names>EJ</given-names></name> (<year>2012</year>) <article-title>New reservoirs of HLA alleles: pools of rare variants enhance immune defense</article-title>. <source>Trends in Genetics</source> <volume>28</volume>: <fpage>480</fpage>–<lpage>486</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.tig.2012.06.007" xlink:type="simple">10.1016/j.tig.2012.06.007</ext-link></comment> <object-id pub-id-type="pmid">22867968</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref013"><label>13</label><mixed-citation publication-type="other" xlink:type="simple">Cooke RM, Nieboer D (2011) Heavy-Tailed Distributions: Data, Diagnostics, and New Developments. Resources for the Future Discussion Paper.</mixed-citation></ref>
<ref id="pcbi.1004204.ref014"><label>14</label><mixed-citation publication-type="other" xlink:type="simple">Gnedin A, Iksanov A, Marynych A (2010) The Bernoulli sieve: an overview. arXiv preprint arXiv:10055705.</mixed-citation></ref>
<ref id="pcbi.1004204.ref015"><label>15</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Adamic</surname> <given-names>LA</given-names></name> (<year>2000</year>) <source>Zipf, power-laws, and pareto-a ranking tutorial</source>. <publisher-name>Xerox Palo Alto Research Center</publisher-name>, <publisher-loc>Palo Alto, CA</publisher-loc>, <ext-link ext-link-type="uri" xlink:href="http://ginger" xlink:type="simple">http://ginger</ext-link> hpl hp com/shl/papers/ranking/ranking html.</mixed-citation></ref>
<ref id="pcbi.1004204.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Clauset</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Shalizi</surname> <given-names>CR</given-names></name>, <name name-style="western"><surname>Newman</surname> <given-names>ME</given-names></name> (<year>2009</year>) <article-title>Power-law distributions in empirical data</article-title>. <source>SIAM review</source> <volume>51</volume>: <fpage>661</fpage>–<lpage>703</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004204.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Muniruzzaman</surname> <given-names>A</given-names></name> (<year>1957</year>) <article-title>On measures of location and dispersion and tests of hypotheses on a Pareto population</article-title>. <source>Bulletin of the Calcuta Statistical Association</source> <volume>7</volume>: <fpage>115</fpage>–<lpage>123</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004204.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Karlin</surname> <given-names>S</given-names></name> (<year>1967</year>) <article-title>Central limit theorems for certain infinite urn schemes</article-title>. <source>J Math Mech</source> <volume>17</volume>: <fpage>373</fpage>–<lpage>401</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004204.ref019"><label>19</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Gotelli</surname> <given-names>NJ</given-names></name>, <name name-style="western"><surname>Colwell</surname> <given-names>RK</given-names></name> (<year>2011</year>) <chapter-title>Estimating species richness</chapter-title>. <source>Biological diversity: frontiers in measurement and assessment</source>: <fpage>39</fpage>–<lpage>54</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004204.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>ter Steege</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Pitman</surname> <given-names>NC</given-names></name>, <name name-style="western"><surname>Sabatier</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Baraloto</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Salomão</surname> <given-names>RP</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Hyperdominance in the Amazonian tree flora</article-title>. <source>Science</source> <volume>342</volume>: <fpage>1243092</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1126/science.1243092" xlink:type="simple">10.1126/science.1243092</ext-link></comment> <object-id pub-id-type="pmid">24136971</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bunge</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Woodard</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Böhning</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Foster</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Connolly</surname> <given-names>S</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Estimating population diversity with CatchAll</article-title>. <source>Bioinformatics</source> <volume>28</volume>: <fpage>1045</fpage>–<lpage>1047</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/bioinformatics/bts075" xlink:type="simple">10.1093/bioinformatics/bts075</ext-link></comment> <object-id pub-id-type="pmid">22333246</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Holcomb</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Rastrou</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Williams</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Goodridge</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Lazaro</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Next-generation sequencing can reveal in vitro-generated PCR crossover products: some artifactual sequences correspond to HLA alleles in the IMGT/HLA database</article-title>. <source>Tissue antigens</source> <volume>83</volume>: <fpage>32</fpage>–<lpage>40</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/tan.12269" xlink:type="simple">10.1111/tan.12269</ext-link></comment> <object-id pub-id-type="pmid">24355006</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ewens</surname> <given-names>WJ</given-names></name> (<year>1972</year>) <article-title>The sampling theory of selectively neutral alleles</article-title>. <source>Theoretical population biology</source> <volume>3</volume>: <fpage>87</fpage>–<lpage>112</lpage>. <object-id pub-id-type="pmid">4667078</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hernández-Frederick</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Giani</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Cereb</surname> <given-names>N</given-names></name>, <name name-style="western"><surname>Sauter</surname> <given-names>J</given-names></name>, <name name-style="western"><surname>Silva-González</surname> <given-names>R</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Identification of 2127 new HLA class I alleles in potential stem cell donors from Germany, the United States and Poland</article-title>. <source>Tissue antigens</source> <volume>83</volume>: <fpage>184</fpage>–<lpage>189</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1111/tan.12304" xlink:type="simple">10.1111/tan.12304</ext-link></comment> <object-id pub-id-type="pmid">24571476</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref025"><label>25</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Magurran</surname> <given-names>AE</given-names></name> (<year>1988</year>) <source>Ecological diversity and its measurement</source>: <publisher-name>Springer</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004204.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Barabasi</surname> <given-names>A-L</given-names></name>, <name name-style="western"><surname>Oltvai</surname> <given-names>ZN</given-names></name> (<year>2004</year>) <article-title>Network biology: understanding the cell's functional organization</article-title>. <source>Nature Reviews Genetics</source> <volume>5</volume>: <fpage>101</fpage>–<lpage>113</lpage>. <object-id pub-id-type="pmid">14735121</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koonin</surname> <given-names>EV</given-names></name>, <name name-style="western"><surname>Wolf</surname> <given-names>YI</given-names></name>, <name name-style="western"><surname>Karev</surname> <given-names>GP</given-names></name> (<year>2002</year>) <article-title>The structure of the protein universe and genome evolution</article-title>. <source>Nature</source> <volume>420</volume>: <fpage>218</fpage>–<lpage>223</lpage>. <object-id pub-id-type="pmid">12432406</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Huynen</surname> <given-names>MA</given-names></name>, <name name-style="western"><surname>Van Nimwegen</surname> <given-names>E</given-names></name> (<year>1998</year>) <article-title>The frequency distribution of gene family sizes in complete genomes</article-title>. <source>Molecular biology and evolution</source> <volume>15</volume>: <fpage>583</fpage>–<lpage>589</lpage>. <object-id pub-id-type="pmid">9580988</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref029"><label>29</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koonin</surname> <given-names>EV</given-names></name> (<year>2011</year>) <article-title>Are there laws of genome evolution?</article-title> <source>PLoS computational biology</source> <volume>7</volume>: <fpage>e1002173</fpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1371/journal.pcbi.1002173" xlink:type="simple">10.1371/journal.pcbi.1002173</ext-link></comment> <object-id pub-id-type="pmid">21901087</object-id></mixed-citation></ref>
<ref id="pcbi.1004204.ref030"><label>30</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lind</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Ferriola</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Mackiewicz</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Papazoglou</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Sasson</surname> <given-names>A</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Filling the gaps–The generation of full genomic sequences for 15 common and well-documented HLA class I alleles using next-generation sequencing technology</article-title>. <source>Human immunology</source> <volume>74</volume>: <fpage>325</fpage>–<lpage>329</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.humimm.2012.12.007" xlink:type="simple">10.1016/j.humimm.2012.12.007</ext-link></comment> <object-id pub-id-type="pmid">23246585</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>