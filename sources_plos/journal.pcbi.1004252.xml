<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id>
<journal-title-group>
<journal-title>PLOS Computational Biology</journal-title>
</journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, CA USA</publisher-loc>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1004252</article-id>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-14-01939</article-id>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Research Article</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Quantifying Spike Train Oscillations: Biases, Distortions and Solutions</article-title>
<alt-title alt-title-type="running-head">Oscillations in Spike Trains</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" xlink:type="simple">
<name name-style="western">
<surname>Matzner</surname>
<given-names>Ayala</given-names>
</name>
<xref rid="aff001" ref-type="aff"/>
</contrib>
<contrib contrib-type="author" corresp="yes" xlink:type="simple">
<name name-style="western">
<surname>Bar-Gad</surname>
<given-names>Izhar</given-names>
</name>
<xref rid="cor001" ref-type="corresp">*</xref>
<xref rid="aff001" ref-type="aff"/>
</contrib>
</contrib-group>
<aff id="aff001"><addr-line>The Leslie &amp; Susan Goldschmied (Gonda) Multidisciplinary Brain Research Center, Bar-Ilan University, Ramat-Gan, Israel</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple">
<name name-style="western">
<surname>Einhäuser</surname>
<given-names>Wolfgang</given-names>
</name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/>
</contrib>
</contrib-group>
<aff id="edit1"><addr-line>Philipps-University Marburg, GERMANY</addr-line></aff>
<author-notes>
<fn fn-type="conflict" id="coi001">
<p>The authors have declared that no competing interests exist.</p>
</fn>
<fn fn-type="con" id="contrib001">
<p>Conceived and designed the experiments: AM IBG. Performed the experiments: AM IBG. Analyzed the data: AM IBG. Wrote the paper: AM IBG.</p>
</fn>
<corresp id="cor001">* E-mail: <email xlink:type="simple">izhar.bar-gad@biu.ac.il</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>24</day>
<month>4</month>
<year>2015</year>
</pub-date>
<pub-date pub-type="collection">
<month>4</month>
<year>2015</year>
</pub-date>
<volume>11</volume>
<issue>4</issue>
<elocation-id>e1004252</elocation-id>
<history>
<date date-type="received">
<day>22</day>
<month>10</month>
<year>2014</year>
</date>
<date date-type="accepted">
<day>21</day>
<month>3</month>
<year>2015</year>
</date>
</history>
<permissions>
<copyright-year>2015</copyright-year>
<copyright-holder>Matzner, Bar-Gad</copyright-holder>
<license xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">
<license-p>This is an open access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="info:doi/10.1371/journal.pcbi.1004252" xlink:type="simple"/>
<abstract>
<p>Estimation of the power spectrum is a common method for identifying oscillatory changes in neuronal activity. However, the stochastic nature of neuronal activity leads to severe biases in the estimation of these oscillations in single unit spike trains. Different biological and experimental factors cause the spike train to differentially reflect its underlying oscillatory rate function. We analyzed the effect of factors, such as the mean firing rate and the recording duration, on the detectability of oscillations and their significance, and tested these theoretical results on experimental data recorded in Parkinsonian non-human primates. The effect of these factors is dramatic, such that in some conditions, the detection of existing oscillations is impossible. Moreover, these biases impede the comparison of oscillations across brain regions, neuronal types, behavioral states and separate recordings with different underlying parameters, and lead inevitably to a gross misinterpretation of experimental results. We introduce a novel objective measure, the "modulation index", which overcomes these biases, and enables reliable detection of oscillations from spike trains and a direct estimation of the oscillation magnitude. The modulation index detects a high percentage of oscillations over a wide range of parameters, compared to classical spectral analysis methods, and enables an unbiased comparison between spike trains recorded from different neurons and using different experimental protocols.</p>
</abstract>
<abstract abstract-type="summary">
<title>Author Summary</title>
<p>Neuronal oscillations play a key role in normal behavior and during multiple pathological conditions. In this manuscript, we expose major biases and distortions which arise from the quantification of neuronal spike train oscillations. These, previously neglected, biases hinder the comparison of oscillations across brain regions, neuronal types and behavioral states, leading inevitably to severe misinterpretation of experimental results. We demonstrate the biases computationally, formulate them analytically and validate their appearance and magnitude in an experimental dataset recorded from Parkinsonian non-human primates. Next, following a formulation of the distortions, we introduce a novel objective measure, the "modulation index", which overcomes these biases, and enables a reliable detection of oscillations from spike trains and a direct estimation of the oscillation magnitude. The modulation index is validated on the same experimental data demonstrating the unbiased detection of beta oscillation in the globus pallidus during Parkinsonism. The manuscript provides a solid infrastructure for oscillation analysis which benefits multiple neuroscience fields ranging from basic science to clinical studies, moreover its results may be expanded to encompass additional fields in biology which require the spectral analysis of point process data.</p>
</abstract>
<funding-group>
<funding-statement>This study was supported by Israel Science Foundation (<ext-link ext-link-type="uri" xlink:href="http://www.isf.org.il" xlink:type="simple">www.isf.org.il</ext-link>) grant (743/13) (IBG). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement>
</funding-group>
<counts>
<fig-count count="7"/>
<table-count count="0"/>
<page-count count="21"/>
</counts>
<custom-meta-group>
<custom-meta id="data-availability" xlink:type="simple">
<meta-name>Data Availability</meta-name>
<meta-value>The code and data associated with the manuscript are available on our site: <ext-link ext-link-type="uri" xlink:href="http://neurint.ls.biu.ac.il" xlink:type="simple">http://neurint.ls.biu.ac.il</ext-link></meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<disp-quote>
<p>This is a <italic>PLOS Computational Biology</italic> Methods paper</p>
</disp-quote>
<sec id="sec001" sec-type="intro">
<title>Introduction</title>
<p>Neuronal oscillations play a key role in normal behavior and in different pathological conditions [<xref rid="pcbi.1004252.ref001" ref-type="bibr">1</xref>–<xref rid="pcbi.1004252.ref003" ref-type="bibr">3</xref>]. Neuronal oscillations are typically classified into a range of frequencies including the delta (1–4Hz), theta (4–8Hz), alpha (8–12Hz), beta (12–30 Hz), and gamma (30–80Hz) bands [<xref rid="pcbi.1004252.ref003" ref-type="bibr">3</xref>]. Enhanced expression of specific oscillatory frequencies or oscillations in a broader band is perceived as indicative of different normal functions, such as the enhanced gamma preceding movement [<xref rid="pcbi.1004252.ref001" ref-type="bibr">1</xref>] and different pathological conditions such as the enhanced beta associated with Parkinsonism [<xref rid="pcbi.1004252.ref004" ref-type="bibr">4</xref>]. Analysis of the power spectrum is a common method for identifying enhanced (or reduced) oscillations in neuronal data, and is widely used on a variety of brain signals spanning multiple orders of magnitude, such as electroencephalograms (EEG), local field potentials (LFP), multiunit activity (MUA), single unit spike trains and cellular membrane potentials [<xref rid="pcbi.1004252.ref005" ref-type="bibr">5</xref>–<xref rid="pcbi.1004252.ref008" ref-type="bibr">8</xref>].</p>
<p>The time of occurrence of action potentials emitted by a single neuron; i.e., single unit spike trains, are a major source of neurophysiological data stemming from both intracellular and extracellular recordings. These neuronal spike trains may be viewed as a stochastic point process where a discrete event represents each action potential [<xref rid="pcbi.1004252.ref009" ref-type="bibr">9</xref>]. The generation of each spike within the train is assumed to be dependent on an underlying instantaneous firing rate. The resultant point process reflects the originating rhythm only partially since the individual events are stochastically generated from the rate function [<xref rid="pcbi.1004252.ref010" ref-type="bibr">10</xref>]. Thus, despite an underlying oscillatory firing rate, in most cases the neuron will skip a large portion of the oscillation cycle or even entire cycles [<xref rid="pcbi.1004252.ref011" ref-type="bibr">11</xref>]. The most simplistic statistical spike train model assumes that the generation of each spike is dependent solely on the underlying instantaneous firing rate, and is independent of all other previous spikes. This model is termed the inhomogeneous Poisson process when the instantaneous firing rate changes over time. Spectral analysis of an experimentally recorded spike train under this assumption is thus assumed to reflect the oscillations of the underlying instantaneous rate directly. However, different properties of the neuron or the experiment can cause the spike train to reflect its underlying oscillatory firing rate well or poorly, and hence can facilitate or impede the detection of an underlying oscillation [<xref rid="pcbi.1004252.ref007" ref-type="bibr">7</xref>,<xref rid="pcbi.1004252.ref010" ref-type="bibr">10</xref>].</p>
<p>In this paper, we address the problem of oscillation detection in spike trains. First, we quantify the influence of different biological and experimental factors on the detection of the spectral peak and its significance. We then analytically derive a solution for the modulation index of an oscillatory Poissonian neuron and present a novel objective measure that enables reliable detection of oscillations in spike trains. We investigate the oscillations in experimentally recorded neurons from Parkinsonian primates, and compare these experimental results to our numerical and analytic findings. Finally, we derive a solution for the evaluation of the actual recording duration required for the detection of spike train oscillations in experimental data.</p>
</sec>
<sec id="sec002" sec-type="results">
<title>Results</title>
<p>The spiking activity of oscillatory neurons can be modeled as an inhomogeneous Poisson process whose rate λ(<italic>t</italic>) is modulated by a cosine function (<xref rid="pcbi.1004252.g001" ref-type="fig">Fig 1A</xref>):
<disp-formula id="pcbi.1004252.e001">
<alternatives>
<graphic id="pcbi.1004252.e001g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e001" xlink:type="simple"/>
<mml:math display="block" id="M1" overflow="scroll">
<mml:mo>λ</mml:mo><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mtext>cos</mml:mtext><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(1)</label>
</disp-formula>
where <italic>r</italic><sub>0</sub> is the baseline firing rate, 0 ≤ <italic>m</italic> ≤ 1 is the modulation index, and <italic>f</italic><sub>0</sub> is the oscillation frequency. Classically, the oscillatory nature of the neuronal activity is assessed using spectral estimation methods. The power spectrum of this rate function enables the identification of the oscillation base frequency (<italic>f</italic><sub>0</sub>) which appears as a clear peak in that frequency, while all the other frequencies have no power (<xref rid="pcbi.1004252.g001" ref-type="fig">Fig 1B</xref>). However, estimation of the power spectrum of the Poisson generated spike train, ρ(t), from this rate function (<xref rid="pcbi.1004252.g001" ref-type="fig">Fig 1C</xref>) results in a reduced peak at the base frequency and increased power in all the other frequencies, such that detection of the base frequency is not straightforward (<xref rid="pcbi.1004252.g001" ref-type="fig">Fig 1D</xref>). The power spectrum can be normalized to reflect the signal—to—noise ratio (SNR) in standard deviations of the power in each frequency relative to the mean power in the 100–500 Hz frequency band of the spike train which serves as a noise baseline for different values of the baseline rate (<xref rid="pcbi.1004252.g001" ref-type="fig">Fig 1E</xref>–<xref rid="pcbi.1004252.g001" ref-type="fig">1G</xref>). The power spectrum of this generated spike train presents an increased peak at <italic>f</italic><sub>0</sub> relative to the baseline. The SNR of these simulated neurons varies linearly as a function of the base firing rate of the neuron (<xref rid="pcbi.1004252.g001" ref-type="fig">Fig 1H</xref>). As a result, the detection of significant oscillations crossing a specific SNR threshold is not possible for a neuron with a low baseline firing rate (<xref rid="pcbi.1004252.g001" ref-type="fig">Fig 1E</xref>), compared to neurons with higher firing rates (<xref rid="pcbi.1004252.g001" ref-type="fig">Fig 1F</xref>–<xref rid="pcbi.1004252.g001" ref-type="fig">1G</xref>), which have a higher SNR and are therefore identified as oscillatory.</p>
<fig id="pcbi.1004252.g001" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004252.g001</object-id>
<label>Fig 1</label>
<caption>
<title>Limited representation of oscillations following a rate to spike train transformation.</title>
<p>(A) A short (1 second) segment taken from an oscillatory rate function (<italic>f</italic><sub>0</sub> = 12 Hz, <italic>r</italic><sub>0</sub> = 5 sp/s and <italic>m</italic> = 0.5). (B) Power spectrum of a 5 minute segment taken from the rate function. The dashed vertical line indicates <italic>f<sub>0</sub></italic>. (C) A short (1 second) example of a Poisson generated spike train from the same rate function. (D) Power spectrum of the 5 minute spike train. (E-G) The power spectrum normalized to SNR units, when the base firing rate is (E) 5 sp/s, (F) 15 sp/s, and (G) 30 sp/s. (H) The peak oscillation amplitude as a function of the mean firing rates. The circles indicate the <italic>f<sub>0</sub></italic> oscillations shown in examples E-G, and the solid line indicates the fitted linear function.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.g001" position="float" xlink:type="simple"/>
</fig>
<p>Simulated neurons can illustrate the potential firing rate induced bias in the assessment of spectral activity. To examine the effect of the mean firing rate on the detection of oscillations in experimentally recorded data, we calculated the power spectrum of globus pallidus internus (GPi) neurons recorded in four non-human primates (NHPs) following injections of 1-methyl-4-phenyl-1,2,3,6-tetrahydropyridine (MPTP) which led to the appearance of Parkinsonian symptoms. The firing pattern of a large proportion of the GPi neurons in the Parkinsonian NHP resembles Poissonian firing, which is modulated in an oscillatory manner at a base frequency in the beta band (10–15 Hz) [<xref rid="pcbi.1004252.ref012" ref-type="bibr">12</xref>–<xref rid="pcbi.1004252.ref014" ref-type="bibr">14</xref>] (<xref rid="pcbi.1004252.g002" ref-type="fig">Fig 2A</xref>). In the experimental dataset (229 neurons), which consisted of neurons with firing rate in the wide range of 20 to 180 spikes/s and a positive corrected SNR value, the SNR of the highest peak within the beta band varied considerably but exhibited a linear relation with the firing rate (<xref rid="pcbi.1004252.g002" ref-type="fig">Fig 2B</xref>). Thus, the fraction of neurons identified as oscillatory; i.e., neurons with a SNR≥5, increased with the firing rate of the neurons (<xref rid="pcbi.1004252.g002" ref-type="fig">Fig 2C</xref>). This implies that in real experimental data, naïve usage of the power spectrum results in a biased detection of oscillatory activity that can easily lead to misinterpretation of the experimental dataset.</p>
<fig id="pcbi.1004252.g002" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004252.g002</object-id>
<label>Fig 2</label>
<caption>
<title>Spike train oscillations—Experimental results.</title>
<p>GPi neurons (n = 229) recorded in MPTP treated non-human primates that display typical beta band oscillations (A) Extracellular high pass filtered signal depicting a single GPi neuron (top), and the extracted spike train (bottom). (B) The effect of the firing rate on the SNR (R<sup>2</sup> = 0.06, p &lt;0.001). (C) Spectral peak detection as a function of the firing rate. The significance level for peak detection was set to 5 STDs. The number of neurons in each group is shown in brackets.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.g002" position="float" xlink:type="simple"/>
</fig>
<p>Simulations were next used to quantify the effect of different biological (mean firing rate, oscillation's modulation magnitude) and experimental factors (recording duration) on the SNR. The values of each condition were obtained from 1000 simulated Poisson spike trains generated from a single oscillatory (<italic>f</italic><sub>0</sub> = 12 Hz) rate function. When the duration was fixed, and the SNR was estimated over a range of firing rates and modulations, the simulations showed that the SNR had a linear relation to the baseline firing rate (<xref rid="pcbi.1004252.g003" ref-type="fig">Fig 3A</xref>), and a squared relation to the modulation index (<xref rid="pcbi.1004252.g003" ref-type="fig">Fig 3B</xref>). When the modulation index was fixed, and the SNR was estimated over varying firing rates and durations, the simulations indicated a linear relation of the SNR to the firing rate (<xref rid="pcbi.1004252.g003" ref-type="fig">Fig 3C</xref>), and a square root relation to the total length of the recording (<xref rid="pcbi.1004252.g003" ref-type="fig">Fig 3D</xref>). These relations suggest a dependence on these factors that impacts the detection of significant oscillatory activity (<xref rid="pcbi.1004252.g003" ref-type="fig">Fig 3E</xref>–<xref rid="pcbi.1004252.g003" ref-type="fig">3F</xref>). Increases in the firing rate, modulation index (<xref rid="pcbi.1004252.g003" ref-type="fig">Fig 3E</xref>) and recording duration (<xref rid="pcbi.1004252.g003" ref-type="fig">Fig 3F</xref>) result in increased detection of the spectral peak. This dependence on biological and experimental variables thus shows that the ability to objectively detect a peak in the power spectrum is limited. This dependence hinders the comparison of different behavioral states or brain areas and leaves them prone to biases. The formulation of an objective method of measuring oscillations is thus a necessity to enable unbiased comparisons of spike trains arising from different biological and experimental sources.</p>
<fig id="pcbi.1004252.g003" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004252.g003</object-id>
<label>Fig 3</label>
<caption>
<title>Factors determining the spectral peak magnitude.</title>
<p>(A) Effect of the rate modulation (<italic>m</italic>) in different base firing rates (<italic>r</italic><sub>0</sub>) over a fixed recording period (<italic>T</italic> = 1 minute). The solid lines indicate the mean SNRs; the shaded areas indicate ±1 STD of the SNR. (B) A squared fitting function for the SNR slopes (R<sup>2</sup> = 1, p &lt;0.001). (C) Effect of the recording period duration <italic>(T)</italic> in different firing rates during a fixed firing modulation (<italic>m</italic> = 0.25). (D) A square root fitting function for the SNR slopes (R<sup>2</sup> = 0.99). (E-F) The detection of a significant peak (SNR&gt;5) is affected by the rates for different (E) rate modulations and (F) recording durations.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.g003" position="float" xlink:type="simple"/>
</fig>
<p>The power spectrum of an inhomogeneous spike train over a period (<italic>T</italic>) is (see <xref rid="sec004" ref-type="sec">methods</xref>: <italic>power spectrum of a finite inhomogeneous Poisson process</italic>):
<disp-formula id="pcbi.1004252.e002">
<alternatives>
<graphic id="pcbi.1004252.e002g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e002" xlink:type="simple"/>
<mml:math display="block" id="M2" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(2)</label>
</disp-formula></p>
<p>In the specific case of cosine rate modulation over a base frequency (<italic>f</italic><sub>0</sub>) (<xref rid="pcbi.1004252.e001" ref-type="disp-formula">Eq 1</xref>) the power spectrum is: (see <italic><xref rid="sec004" ref-type="sec">methods</xref>: power spectrum of an inhomogeneous Poisson process with an oscillatory rate function</italic>)</p>
<disp-formula id="pcbi.1004252.e003">
<alternatives>
<graphic id="pcbi.1004252.e003g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e003" xlink:type="simple"/>
<mml:math display="block" id="M3" overflow="scroll">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>=</mml:mo><mml:mspace width="1pt"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>m</mml:mi><mml:mspace width="1pt"/><mml:mtext>sinc</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mspace width="1pt"/><mml:msup><mml:mtext>sinc</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mspace width="1pt"/><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mspace width="1pt"/><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="2pt"/><mml:mo>+</mml:mo><mml:mspace width="2pt"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:msup><mml:mtext>sinc</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:msup><mml:mtext>sinc</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(3)</label>
</disp-formula>
<p>The term <italic>sinc(fT)</italic> decays as <italic>1/T</italic>. Thus, for large enough values of <italic>T</italic>, most of the <italic>sinc</italic> terms will decay (e.g., for oscillations at 12 Hz, sinc(2 <italic>f</italic><sub>0</sub> <italic>T</italic>) is negligible within a few seconds of recordings), except for the case when the frequency term inside the <italic>sinc</italic> is zero (<italic>i</italic>.<italic>e</italic>. <italic>f-f</italic><sub><italic>0</italic></sub> = <italic>0</italic>), and then <italic>sinc(0)</italic> equals 1 for every <italic>T</italic>. Consequently, the formulation may be simplified for the case of the base frequency (<italic>f</italic> = <italic>f</italic><sub>0</sub>); i.e., the peak power, to:
<disp-formula id="pcbi.1004252.e004">
<alternatives>
<graphic id="pcbi.1004252.e004g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e004" xlink:type="simple"/>
<mml:math display="block" id="M4" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mi> </mml:mi><mml:mi> </mml:mi>
</mml:math>
</alternatives>
<label>(4)</label>
</disp-formula>
And for all other frequencies (<italic>f</italic> ≠ <italic>f</italic><sub>0</sub>); i.e., the baseline power, to:
<disp-formula id="pcbi.1004252.e005">
<alternatives>
<graphic id="pcbi.1004252.e005g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e005" xlink:type="simple"/>
<mml:math display="block" id="M5" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>≠</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub>
</mml:math>
</alternatives>
<label>(5)</label>
</disp-formula></p>
<p>The magnitude of the peak power and its relation to the baseline power are dependent on multiple factors; namely r<sub>0</sub>, T, m. Thus, a measure that is independent of subjective properties is required which we term the modulation index (<inline-formula id="pcbi.1004252.e006"><alternatives><graphic id="pcbi.1004252.e006g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e006" xlink:type="simple"/><mml:math display="inline" id="M6" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>). This measure can be extracted from the simplified equation of the peak power (<xref rid="pcbi.1004252.e004" ref-type="disp-formula">Eq 4</xref>)</p>
<disp-formula id="pcbi.1004252.e007">
<alternatives>
<graphic id="pcbi.1004252.e007g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e007" xlink:type="simple"/>
<mml:math display="block" id="M7" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>⋅</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:msqrt><mml:mi>T</mml:mi></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(6)</label>
</disp-formula>
<p>This equation enables the extraction of the modulation index for any frequency. When there is a real underlying oscillation in that frequency, the outcome of the equation will be the described modulation index. However, when there is no underlying oscillation in that frequency, the result will tend to be zero, as the value of <italic>S</italic><sub><italic>ρ</italic><sub><italic>T</italic></sub></sub><italic>(f</italic> ≠ <italic>f</italic><sub>0</sub>) approaches <italic>r</italic><sub>0</sub>, as shown in <xref rid="pcbi.1004252.e005" ref-type="disp-formula">Eq 5</xref>. Through this measure, we can reconstruct the rate function of an inhomogeneous Poissonian oscillatory spike train (<xref rid="pcbi.1004252.g004" ref-type="fig">Fig 4A</xref>, top). First, the power spectrum is estimated, and the peak power is extracted (<xref rid="pcbi.1004252.g004" ref-type="fig">Fig 4A</xref>, middle). Then, by using the estimated peak power (<inline-formula id="pcbi.1004252.e009"><alternatives><graphic id="pcbi.1004252.e009g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e009" xlink:type="simple"/><mml:math display="inline" id="M9" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msub><mml:mrow><mml:mi>ρ</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mfenced separators="|"><mml:mrow><mml:mi>f</mml:mi><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:mfenced></mml:math></alternatives></inline-formula>), the mean firing rate (<inline-formula id="pcbi.1004252.e010"><alternatives><graphic id="pcbi.1004252.e010g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e010" xlink:type="simple"/><mml:math display="inline" id="M10" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>) and the total recording time (<italic>T</italic>), the modulation index is extracted, and the estimated rate function (<inline-formula id="pcbi.1004252.e011"><alternatives><graphic id="pcbi.1004252.e011g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e011" xlink:type="simple"/><mml:math display="inline" id="M11" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi mathvariant="normal">λ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>) can be fully described (<xref rid="pcbi.1004252.g004" ref-type="fig">Fig 4A</xref>, bottom).</p>
<fig id="pcbi.1004252.g004" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004252.g004</object-id>
<label>Fig 4</label>
<caption>
<title>Reconstruction of the rate modulation index.</title>
<p>(A) Reconstruction of the rate function of a single GPi neuron. Top—1 second from the neuron's spike train. Middle—power spectrum of the spike train, presenting a peak at ~14 Hz. Bottom—the reconstructed rate function <inline-formula id="pcbi.1004252.e012"><alternatives><graphic id="pcbi.1004252.e012g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e012" xlink:type="simple"/><mml:math display="inline" id="M12" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>λ</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula>. (B) The analytically reconstructed rate modulation index (<inline-formula id="pcbi.1004252.e014"><alternatives><graphic id="pcbi.1004252.e014g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e014" xlink:type="simple"/><mml:math display="inline" id="M14" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>), as a function of the estimated baseline firing rate <italic>(<inline-formula id="pcbi.1004252.e015"><alternatives><graphic id="pcbi.1004252.e015g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e015" xlink:type="simple"/><mml:math display="inline" id="M15" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>)</italic>. The solid lines indicate the mean estimated modulation; the shaded areas indicate ±1 STD of the reconstructed modulation, and the dashed line indicates the original modulation. (C) The modulation index detection. The significance level was set according to the simulation results in B; i.e., the mean result for the modulation index of zero at a specific firing rate + 2 STDs. (D) Comparison of the difference between the detections by the modulation index and the spectral peak. (E) Reconstruction of the modulation index of GPi neurons. The results are shown for 98 (of 229) neurons that had a modulation index greater than zero (R<sup>2</sup> = 0.02, p &gt; 0.1).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.g004" position="float" xlink:type="simple"/>
</fig>
<p>We calculated the modulation index for the simulation described above. For each of the 1000 generated spike trains we calculated the mean peak power, corrected it for comparison with Welch′s estimator, which is a common method for estimating the power spectrum, (see <italic><xref rid="sec004" ref-type="sec">methods</xref>: correction for the power estimated by Welch's method</italic>), and used it for the calculation of the modulation index. Comparison of the estimated modulation and the original modulation demonstrated that the modulation index was constant across a wide range of parameters over the simulated data (<xref rid="pcbi.1004252.g004" ref-type="fig">Fig 4B</xref>). The significance level for detecting oscillatory neurons using the modulation index depends on the firing rate, and is defined as the mean result for the modulation index of zero at a specific firing rate + 2 standard deviations, as revealed by the simulations. The results of the detection of oscillatory neurons using the modulation index indicate that it is dependent on the baseline rate, such that the detection is better for higher firing rates (<xref rid="pcbi.1004252.g004" ref-type="fig">Fig 4C</xref>). For example, when the modulation is 0.4, and the required detection probability is 80%, the firing rate should be higher than 15 spikes/s. However, for all firing rates, the detection using the modulation index was better than the detection using the spectral peak (<xref rid="pcbi.1004252.g004" ref-type="fig">Fig 4D</xref>). We applied the modulation index to the recordings from the GPi of the Parkinsonian NHP (<xref rid="pcbi.1004252.g004" ref-type="fig">Fig 4E</xref>) and obtained a constant modulation index (<inline-formula id="pcbi.1004252.e016"><alternatives><graphic id="pcbi.1004252.e016g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e016" xlink:type="simple"/><mml:math display="inline" id="M16" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mn>0.23</mml:mn><mml:mo>±</mml:mo><mml:mn>0.13</mml:mn><mml:mi> </mml:mi></mml:math></alternatives></inline-formula> mean ± SD). In our experimental dataset, 98 neurons were modulated; i.e., had a modulation index greater than zero, and 78 of these were significant, according to the aforementioned significance test. The results for all neurons revealed that the oscillation modulation was independent of the firing rate (R<sup>2</sup> = 0.02, p &gt;0.1), unlike the results obtained using the power spectrum (<xref rid="pcbi.1004252.g002" ref-type="fig">Fig 2B</xref>).</p>
<p>The modulation index was derived above for an inhomogeneous Poisson spike train where the power spectrum exhibits equal power in all frequencies except for the base frequency. However, real neurons deviate from the Poisson model, primarily as a result of the refractory period. Refractoriness prevents the neuron from firing two successive spikes within a short interval, and thus the spike train is never a true Poisson process. In the case of an oscillatory spike train, refractoriness distorts the oscillation, and the modulation appears to be smaller than the real modulation of its rate function (<xref rid="pcbi.1004252.g005" ref-type="fig">Fig 5A</xref>). This occurs due to the larger effect of the refractory period around the peak of the oscillation as more spikes are expected at that time. This underestimation of the modulation index is more prominent for high firing rates due to the increased effect of the refractory period (<xref rid="pcbi.1004252.g005" ref-type="fig">Fig 5B</xref>). The modulation index can however be corrected to accommodate for the refractory period (see <xref rid="sec004" ref-type="sec">methods</xref>). The correction procedure reconstructs the modulation index (<inline-formula id="pcbi.1004252.e018"><alternatives><graphic id="pcbi.1004252.e018g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e018" xlink:type="simple"/><mml:math display="inline" id="M18" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) of the rate function that will result in the analytically calculated modulation index, which is smaller than expected as a result of the refractory period, and thus extracting the "true" modulation of the driving rate function (<xref rid="pcbi.1004252.g005" ref-type="fig">Fig 5C</xref>). We applied this correction to GPi spike trains. This resulted in higher modulation index values (<inline-formula id="pcbi.1004252.e020"><alternatives><graphic id="pcbi.1004252.e020g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e020" xlink:type="simple"/><mml:math display="inline" id="M20" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mn>0.35</mml:mn><mml:mo>±</mml:mo><mml:mn>0.12</mml:mn><mml:mi> </mml:mi></mml:math></alternatives></inline-formula> mean ± SD) that are independent from the firing rate (R<sup>2</sup> = 0.0005, p &gt;0.5) (<xref rid="pcbi.1004252.g005" ref-type="fig">Fig 5D</xref>). The percentage of significantly modulated neurons (97/229, 42%) was significantly larger than the percentage of neurons that were identified as significantly oscillatory by the SNR measure (64/229, 28%) (<italic>x</italic><sup>2</sup> test, <italic>p</italic> &lt; 0.01).</p>
<fig id="pcbi.1004252.g005" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004252.g005</object-id>
<label>Fig 5</label>
<caption>
<title>Correction of the modulation index for deviations from the Poisson model.</title>
<p>(A) A short segment (0.5 s) taken from: Top—an oscillatory rate function (<italic>f</italic><sub>0</sub> = 12 Hz, <italic>r</italic><sub>0</sub> = 60 sp/s and <italic>m</italic> = 0.5). Middle—an example of a Poisson generated spike train from this rate function, without refractory period. Bottom—an example of a Poisson generated spike train with refractory period of 2 ms. The red lines in the middle spike train indicate the missing spikes in the bottom spike train, due to the refractory period. (B) The analytically reconstructed modulation index (<inline-formula id="pcbi.1004252.e022"><alternatives><graphic id="pcbi.1004252.e022g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e022" xlink:type="simple"/><mml:math display="inline" id="M22" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>), as a function of the estimated baseline firing rate (<inline-formula id="pcbi.1004252.e023"><alternatives><graphic id="pcbi.1004252.e023g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e023" xlink:type="simple"/><mml:math display="inline" id="M23" overflow="scroll"><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:math></alternatives></inline-formula>), for spike trains with refractory period. The solid lines indicate the mean estimated modulation; the shaded areas indicate ±1 STD of the reconstructed modulation, and the dashed line indicates the original modulation. (C) The corrected modulation index (<inline-formula id="pcbi.1004252.e024"><alternatives><graphic id="pcbi.1004252.e024g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e024" xlink:type="simple"/><mml:math display="inline" id="M24" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) for the same spike trains in B. (D) Reconstruction of the modulation index of GPi neurons after correction of the modulation index. The black line is the linear regression for all the neurons (n = 98, R<sup>2</sup> = 0.0005, p &gt;0.5).</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.g005" position="float" xlink:type="simple"/>
</fig>
<p>The detection of oscillatory activity depends on a critical experimental factor—the total recording duration <italic>(T)</italic>. This factor must be set prior to the experiment itself to avoid a case of failed detection due to the experiment′s time constraint (<xref rid="pcbi.1004252.g003" ref-type="fig">Fig 3F</xref>) rather than an actual lack of oscillations. The analogous analytic SNR is defined as:
<disp-formula id="pcbi.1004252.e025">
<alternatives>
<graphic id="pcbi.1004252.e025g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e025" xlink:type="simple"/>
<mml:math display="block" id="M25" overflow="scroll">
<mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(7)</label>
</disp-formula>
And for <italic>f</italic> = <italic>f</italic><sub>0</sub>:
<disp-formula id="pcbi.1004252.e026">
<alternatives>
<graphic id="pcbi.1004252.e026g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e026" xlink:type="simple"/><mml:math display="block" id="M26" overflow="scroll"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mo>[</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mtext>sinc</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mtext> </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>m</mml:mi><mml:mtext> sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>m</mml:mi><mml:mtext> sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mo> </mml:mo><mml:mo>+</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mtext>sinc</mml:mtext></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>]</mml:mo><mml:mo>/</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mtext> sinc</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math></alternatives><label>(8)</label></disp-formula>
And for large enough T:
<disp-formula id="pcbi.1004252.e027">
<alternatives>
<graphic id="pcbi.1004252.e027g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e027" xlink:type="simple"/>
<mml:math display="block" id="M27" overflow="scroll">
<mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(9)</label>
</disp-formula></p>
<p>The expected analytic SNR and the numerical estimated <inline-formula id="pcbi.1004252.e028"><alternatives><graphic id="pcbi.1004252.e028g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e028" xlink:type="simple"/><mml:math display="inline" id="M28" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> are similar, so we can replace the analytic <italic>SNR</italic> with the desired <inline-formula id="pcbi.1004252.e029"><alternatives><graphic id="pcbi.1004252.e029g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e029" xlink:type="simple"/><mml:math display="inline" id="M29" overflow="scroll"><mml:mi> </mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, such that:
<disp-formula id="pcbi.1004252.e030">
<alternatives>
<graphic id="pcbi.1004252.e030g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e030" xlink:type="simple"/>
<mml:math display="block" id="M30" overflow="scroll">
<mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mi>T</mml:mi><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>4</mml:mn></mml:mrow></mml:mfrac>
</mml:math>
</alternatives>
<label>(10)</label>
</disp-formula></p>
<p>This equation is true when no windows are used. When using Welch's method, the SNR must be multiplied by the root of the number of windows used (see <italic><xref rid="sec004" ref-type="sec">methods</xref>: effect of the window size on the SNR</italic>), which is defined as:
<disp-formula id="pcbi.1004252.e031">
<alternatives>
<graphic id="pcbi.1004252.e031g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e031" xlink:type="simple"/>
<mml:math display="block" id="M31" overflow="scroll">
<mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>T</mml:mi><mml:mo>/</mml:mo><mml:mi>w</mml:mi><mml:mi>l</mml:mi>
</mml:math>
</alternatives>
<label>(11)</label>
</disp-formula>
where <italic>wl</italic> is the window length, and <italic>N</italic><sub><italic>wins</italic></sub> is the number of windows used.</p>
<p>From this equation, the required time for significance of the <inline-formula id="pcbi.1004252.e032"><alternatives><graphic id="pcbi.1004252.e032g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e032" xlink:type="simple"/><mml:math display="inline" id="M32" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> is:
<disp-formula id="pcbi.1004252.e033">
<alternatives>
<graphic id="pcbi.1004252.e033g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e033" xlink:type="simple"/>
<mml:math display="block" id="M33" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mi>T</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:mn>16</mml:mn><mml:mo>⋅</mml:mo><mml:msup><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo stretchy="true">^</mml:mo></mml:mover></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>l</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>r</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mn>4</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(12)</label>
</disp-formula></p>
<p>We calculated the required recording time for a window length of 1 second for various firing rates, for a <inline-formula id="pcbi.1004252.e034"><alternatives><graphic id="pcbi.1004252.e034g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e034" xlink:type="simple"/><mml:math display="inline" id="M34" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> of 1 to 7 while the modulation was fixed at 0.25 (<xref rid="pcbi.1004252.g006" ref-type="fig">Fig 6A</xref>), and for a fixed <inline-formula id="pcbi.1004252.e035"><alternatives><graphic id="pcbi.1004252.e035g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e035" xlink:type="simple"/><mml:math display="inline" id="M35" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>S</mml:mi><mml:mi>N</mml:mi><mml:mi>R</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula> of 5 for various modulations (<xref rid="pcbi.1004252.g006" ref-type="fig">Fig 6B</xref>). High firing rates as well as high modulation index values will result in a shortening of the required recording duration. In addition, setting the significance of the SNR to lower values will shorten the required recording duration. Thus, for example, for a GPi neuron with a mean firing rate of 75 spike/s and an estimated modulation index of 0.25, less than half a minute of recording will suffice to detect a spectral peak with SNR of 5. However, in order to detect a spectral peak with SNR of 7 for the same neuron, about 1 minute of recording is necessary.</p>
<fig id="pcbi.1004252.g006" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004252.g006</object-id>
<label>Fig 6</label>
<caption>
<title>Estimating the required recording duration.</title>
<p>Analytic results for the required recording duration, (A) over different firing rates and for increasing SNR, with modulation of 0.25 and (B) over different firing rates and for various modulations, calculated for a SNR of 5.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.g006" position="float" xlink:type="simple"/>
</fig>
</sec>
<sec id="sec003" sec-type="conclusions">
<title>Discussion</title>
<p>Classical oscillation estimation methods for neuronal data represent the magnitude of oscillatory activity in terms of elevated peaks in a specific frequency, as compared to the baseline defined over other frequencies. In the first part of this study we quantified the dependence of the magnitude of the spike train oscillation, as revealed by power spectrum estimation, on different biological and experimental factors. We showed that in both simulated and experimental data, the estimated magnitude of the oscillation depends highly on the mean firing rate of the spike train. We used simulations to quantify this dependence and investigated the influence of these factors on the detectability of oscillatory spike trains.</p>
<p>In the second part of this study, we introduced a novel method for assessing the oscillatory nature of a spike train by calculating the modulation index of the oscillation. The modulation index can be estimated on the basis of the mean firing rate, the total recording duration, and the magnitude of the peak in the power spectrum, and provides an objective measure of the oscillation magnitude. We applied this measure to the simulated spike trains, and showed that the measure produces a correct estimation over a wide range of biologically plausible parameters. The application of this measure to experimental data recorded from GPi neurons in the Parkinsonian NHP revealed that the modulation index is independent of the firing rate. We introduced the corrections that need to be applied to the estimated power revealed by Welch's method, to compare the index to the analytically calculated power. Furthermore, we presented adaptations to the modulation index to account for deviations from the Poisson process assumptions. Explicitly, we show its usage in an inhomogeneous Poisson process with an absolute refractory period, which dramatically alters the spectrum of real neurons. Finally, we proposed a practical method for estimating the recording time required to accurately detect oscillations in neurophysiological experiments.</p>
<p>The effect of the firing rate on the size of the spectral peak is dramatic. In the mammalian brain, the range of firing rates between brain areas and neuronal types is considerable, and even within a specific brain region and a specific neuronal type, the heterogeneity of firing rates within the population is large. For example, the firing rates of the GPi neurons in the Parkinsonian NHP used in our dataset ranged from 25 spikes/s to over 100 spikes/s. Furthermore, the rate distribution can vary between behavioral states: in the normal state, firing rates increase when attention is directed toward a stimulus [<xref rid="pcbi.1004252.ref015" ref-type="bibr">15</xref>] and changes in the firing rates of hippocampal neurons occur as the result of experience [<xref rid="pcbi.1004252.ref016" ref-type="bibr">16</xref>]. Pathological conditions influence firing rates as well, as shown in the firing rate changes throughout the basal ganglia over the course of Parkinson's disease [<xref rid="pcbi.1004252.ref017" ref-type="bibr">17</xref>,<xref rid="pcbi.1004252.ref018" ref-type="bibr">18</xref>]. These differences consequently lead to a situation in which identification of oscillations using the spectral peak may be difficult in some conditions, and moreover, bias the comparison across different brain areas, neuron types and behavioral states. Nonetheless, most studies do not take different firing rates into account when inferring their spectral results. For example, previous studies of the Parkinsonian primate have shown that there is a larger fraction of oscillating neurons as well as an increased magnitude of oscillations in the GPi relative to the globus pallidus externus (GPe) [<xref rid="pcbi.1004252.ref014" ref-type="bibr">14</xref>,<xref rid="pcbi.1004252.ref019" ref-type="bibr">19</xref>]. These studies neglected to take the substantially different firing rates between the two brain areas during parkinsonism into account: the mean firing rate of GPe neurons in the MPTP treated NHP is 45 spikes/s, whereas the mean firing rate of the GPi neurons is 75 spikes/s [<xref rid="pcbi.1004252.ref019" ref-type="bibr">19</xref>]. According to our simulation results (<xref rid="pcbi.1004252.g003" ref-type="fig">Fig 3E</xref>), the detection of significant oscillations in neurons with a realistic modulation index of 0.25 and a firing rate of 45 spikes/s is less than 20%, whereas when the firing rate is 75 spikes/s the detection is about 80%. Thus, the conclusions relating to different oscillatory activities may be derived from the firing rates themselves and not from the oscillatory nature of the neurons.</p>
<p>The firing rate effect on the spectral peak is also a major caveat in the interpretation of the oscillatory nature of MUA. Previous studies have reported that MUA appears to be more oscillatory than single-unit activity (SUA) [<xref rid="pcbi.1004252.ref014" ref-type="bibr">14</xref>,<xref rid="pcbi.1004252.ref020" ref-type="bibr">20</xref>]. However, this phenomenon is affected to a large extent by the higher firing rate of the MUA that contains more than one spike train, such that the comparison between the spectral peak of SUA and MUA is problematic and may lead to a misinterpretation of the results.</p>
<p>An additional factor that biases the spectral peak estimation considerably is not dependent on the neuronal properties but rather on an experimental property: the duration of the recording. As the total recording duration increases, the SNR will increase. Yet, most studies are not aware of this bias when comparing the results of spectral analyses of recordings with different durations. Moreover, in some situations, the duration of the recording can be extremely short, such as recordings in the operation room which can only yield a few seconds of recording [<xref rid="pcbi.1004252.ref020" ref-type="bibr">20</xref>], and thus are not long enough for the detection of a spectral peak despite an underlying oscillatory rate function. Even worse, transient changes in the oscillatory activity of a neuron in response to a behavioral task might prevent the detection of a spectral peak which is unique to the transient period. Such transient changes occur for instance in the gamma frequency in relation to movement [<xref rid="pcbi.1004252.ref001" ref-type="bibr">1</xref>].</p>
<p>Thus, a measure quantifying oscillations is needed that goes beyond the identification of significant spectral peaks. Several methods for the estimation of oscillatory activity in spike trains have been suggested based on the auto-correlation function [<xref rid="pcbi.1004252.ref010" ref-type="bibr">10</xref>,<xref rid="pcbi.1004252.ref021" ref-type="bibr">21</xref>] and analysis of the power spectrum [<xref rid="pcbi.1004252.ref007" ref-type="bibr">7</xref>]. As the spectrum may be defined as the Fourier transform of the auto-correlation function (Wiener-Khinchin theorem), these two groups of methods are biased. The bias could be visualized by the auto-correlation function of the spike trains as well as in its power spectrum (<xref rid="pcbi.1004252.s001" ref-type="supplementary-material">S1A</xref>–<xref rid="pcbi.1004252.s001" ref-type="supplementary-material">S1F Fig</xref>). As in the power spectrum, the SNR of the auto-correlation function is dependent on the firing rate, such that when the firing rate is higher, the oscillatory nature of the spike train is more evident in the auto-correlation function, while during low firing rate, the oscillation cannot readily be seen (<xref rid="pcbi.1004252.s001" ref-type="supplementary-material">S1G Fig</xref>). In order to overcome the bias in the auto-correlation, one of the methods defines an oscillatory score that is less sensitive to the firing rate [<xref rid="pcbi.1004252.ref010" ref-type="bibr">10</xref>] but still depends on the frequency band, where higher bands yield higher scores. Other methods have dealt with the problem of finite recording durations by applying corrections to the confidence limits of the spectral estimations [<xref rid="pcbi.1004252.ref007" ref-type="bibr">7</xref>] but have not handled the different firing rates explicitly.</p>
<p>The major drawback in the standard methods of assessing spike train oscillations were addressed in consecutive steps within this manuscript. Initially, we quantified the factors that bias the magnitude of the spectral peak. Next, we introduced a measure that overcomes these factors, and leads to a reliable detection of oscillations and a direct estimation of the strength of oscillations: the modulation index. This method is simple and fast, and can be customized to accommodate the size of the window and the spectral smoothing applied prior to the spectral estimation. Finally, a practical method for estimating the required recording duration was proposed, based on the mean firing rate, the evaluated modulation index and the desirable SNR. In order to evaluate the mean firing rate and the modulation index, a few short preliminary recordings can be performed, and these two parameters can be grossly assessed. The significance levels for the SNR have to be chosen, and then, the required recording duration may be estimated. In other situations, where the recording duration is fixed, and cannot be adjusted, the experimenter should be aware of the limitations of detecting oscillations from the recordings and use our analytic results to estimate the fraction of unidentified oscillatory neurons.</p>
<p>Throughout most of this study we assumed that the spiking activity of single neurons follows a Poisson distribution [<xref rid="pcbi.1004252.ref022" ref-type="bibr">22</xref>–<xref rid="pcbi.1004252.ref024" ref-type="bibr">24</xref>], i.e. they fire stochastically and the probability of generating a spike at a certain time depends solely on the underlying rate function. In real neurons, there are deviations from the Poisson model. The most prominent deviation, the refractory period, was addressed in this study by correcting the estimation of the modulation index. The correction procedure is based on information extracted from the given spike train, and on the underlying rate function, including the deviation from the Poisson process. The process numerically finds the original modulation index of the rate function that results in the modulation index calculated analytically from the recorded data. For the case of refractory period, we modeled the rate function with an absolute refractory period following a spike. However, in some unique cases, when the refractory period causes the oscillation frequency peak to be too small, which results in a modulation index of zero, the correction procedure will not be able to reveal the original modulation. In this situation, a shuffling procedure on the first order ISI's could compensate for the distortion of the spectrum caused by the refractoriness and lead to an increased accuracy of the peak detection [<xref rid="pcbi.1004252.ref025" ref-type="bibr">25</xref>]. The general rate function model could be expanded to accommodate for other deviations from the Poisson model, such as relative refractory period and bursting activity; i.e., an elevated firing probability immediately after the refractory period.</p>
<p>In conclusion, the modulation index can provide an objective quantification of spike train oscillations, and thus an unbiased comparison across brain regions, behavioral states and separate recordings with different recording lengths. Using this quantification method can expand our understanding of neural oscillations, and their role in normal and pathological states.</p>
<p>All the code required for the estimation of the modulation index and the required recording time is available as custom MATLAB code (compatible with versions 2007B-2014A) on our website: <ext-link ext-link-type="uri" xlink:href="http://neurint.ls.biu.ac.il/software/" xlink:type="simple">http://neurint.ls.biu.ac.il/software/</ext-link></p>
</sec>
<sec id="sec004" sec-type="materials|methods">
<title>Methods</title>
<sec id="sec005">
<title>Ethics statement</title>
<p>The neuronal recordings were taken from four Cynomologus monkeys (Macaca Fascicularis), that underwent 1-methyl-4-phenyl-1,2,3,6-tetrahydropyridine (MPTP) injections leading to a stable Parkinsonian state. The monkeys’ water and food consumption and weight were checked daily and their health was monitored by a veterinarian. All procedures were in accordance with the National Institutes of Health Guide for the Care and Use of Laboratory Animals, Bar-Ilan University Guidelines for the Use and Care of Laboratory Animals in Research and the recommendations of the Weatherall Report. All procedures were approved and supervised by the Institutional Animal Care and Use Committee (IACUC). These procedures were approved by the National Committee for Experiments on Laboratory Animals at the Ministry of Health (permit number BIU150605). Full details of the experimental protocol appear elsewhere [<xref rid="pcbi.1004252.ref014" ref-type="bibr">14</xref>,<xref rid="pcbi.1004252.ref026" ref-type="bibr">26</xref>].</p>
</sec>
<sec id="sec006">
<title>Spike train simulations</title>
<p>The spike trains were simulated with a resolution of Δt = 1 ms. The spike trains were modeled as an inhomogeneous Poisson process, whose rate is modulated by a 12 Hz cosine function. Spike trains with refractory period were modeled by setting the instantaneous firing rate to zero for 2 ms following a spike.</p>
</sec>
<sec id="sec007">
<title>Power spectrum</title>
<p>The power spectrum was estimated based on Welch's method [<xref rid="pcbi.1004252.ref027" ref-type="bibr">27</xref>] for spectral estimation using non-overlapping segments. In all spectral calculations, the 1000 bin segments (see <italic><xref rid="sec004" ref-type="sec">methods</xref>: Effect of the window size on the SNR</italic>) were windowed using a Hamming window. The power spectral densities of each segment were calculated, and were then averaged. The bin size (Δt) of both the experimental and simulated data was 1 ms, leading to a spectral resolution of 1 Hz and a maximal frequency of 500 Hz.</p>
</sec>
<sec id="sec008">
<title>Power spectrum of a finite inhomogeneous Poisson process</title>
<p>The following is based on the general formulation by Pinhasi and Lurie [<xref rid="pcbi.1004252.ref028" ref-type="bibr">28</xref>]: Let's consider a Poisson process of occurring delta functions, with a non-constant and time dependent rate λ(<italic>t</italic>). A portion of the process realization in the time interval [0 <italic>T</italic>] is given by the finite summation:
<disp-formula id="pcbi.1004252.e036">
<alternatives>
<graphic id="pcbi.1004252.e036g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e036" xlink:type="simple"/>
<mml:math display="block" id="M36" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:mi>δ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(13)</label>
</disp-formula>
where <italic>t</italic><sub><italic>i</italic></sub> are the successive firing instances, <italic>k</italic>(<italic>t</italic>) is a random variable that counts the number of delta functions occurring during the time interval T, with an expected value of:
<disp-formula id="pcbi.1004252.e037">
<alternatives>
<graphic id="pcbi.1004252.e037g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e037" xlink:type="simple"/>
<mml:math display="block" id="M37" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow>
</mml:math>
</alternatives>
<label>(14)</label>
</disp-formula></p>
<p>The event appearance <italic>t</italic><sub><italic>i</italic></sub> is an independent random variable with the probability density function:
<disp-formula id="pcbi.1004252.e038">
<alternatives>
<graphic id="pcbi.1004252.e038g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e038" xlink:type="simple"/>
<mml:math display="block" id="M38" overflow="scroll">
<mml:mrow><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mrow><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow>
</mml:math>
</alternatives>
<label>(15)</label>
</disp-formula></p>
<p>The Fourier transform of <italic>ρ<sub>T</sub></italic>(<italic>t</italic>) is:
<disp-formula id="pcbi.1004252.e039">
<alternatives>
<graphic id="pcbi.1004252.e039g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e039" xlink:type="simple"/>
<mml:math display="block" id="M39" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow>
</mml:math>
</alternatives>
<label>(16)</label>
</disp-formula></p>
<p>The power spectral density can be calculated:
<disp-formula id="pcbi.1004252.e040">
<alternatives>
<graphic id="pcbi.1004252.e040g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e040" xlink:type="simple"/>
<mml:math display="block" id="M40" overflow="scroll">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mi>T</mml:mi></mml:mfrac><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mover accent="true"><mml:mrow><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo> </mml:mo><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munderover><mml:mn>1</mml:mn></mml:mstyle></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo> </mml:mo><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>≠</mml:mo><mml:mi>c</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo> </mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mo> </mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo> </mml:mo><mml:mo>⋅</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mo> </mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo> </mml:mo><mml:mo>⋅</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(17)</label>
</disp-formula></p>
<p>In a Poisson process: <inline-formula id="pcbi.1004252.e041"><alternatives><graphic id="pcbi.1004252.e041g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e041" xlink:type="simple"/><mml:math display="inline" id="M41" overflow="scroll"><mml:msup><mml:mrow><mml:msub><mml:mrow><mml:mi>σ</mml:mi></mml:mrow><mml:mrow><mml:mi>k</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mfenced separators="|"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfenced><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mfenced separators="|"><mml:mrow><mml:mi>T</mml:mi></mml:mrow></mml:mfenced></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:math></alternatives></inline-formula>, and thus, the second moment is:
<disp-formula id="pcbi.1004252.e042">
<alternatives>
<graphic id="pcbi.1004252.e042g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e042" xlink:type="simple"/>
<mml:math display="block" id="M42" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>K</mml:mi></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>.</mml:mo></mml:mrow>
</mml:math>
</alternatives>
<label>(18)</label>
</disp-formula></p>
<p>Inserting this in <xref rid="pcbi.1004252.e040" ref-type="disp-formula">Eq 17</xref> yields:
<disp-formula id="pcbi.1004252.e043">
<alternatives>
<graphic id="pcbi.1004252.e043g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e043" xlink:type="simple"/>
<mml:math display="block" id="M43" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mo> </mml:mo><mml:mrow><mml:mo>{</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo> </mml:mo><mml:mo>⋅</mml:mo><mml:mo> </mml:mo><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow> <mml:mo>}</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(19)</label>
</disp-formula></p>
<p>The statistical average:
<disp-formula id="pcbi.1004252.e044">
<alternatives>
<graphic id="pcbi.1004252.e044g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e044" xlink:type="simple"/>
<mml:math display="block" id="M44" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:msup><mml:mi>c</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:msub></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>*</mml:mo></mml:msup><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mfrac><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>+</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow></mml:msup><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:msub><mml:mi>t</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow>
</mml:math>
</alternatives>
<label>(20)</label>
</disp-formula></p>
<p>Leading to the power spectrum formulation as:
<disp-formula id="pcbi.1004252.e045">
<alternatives>
<graphic id="pcbi.1004252.e045g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e045" xlink:type="simple"/>
<mml:math display="block" id="M45" overflow="scroll">
<mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(21)</label>
</disp-formula>
where the first term in brackets is the statistical average of the number of events over T, and the second term is the power spectrum of the instantaneous rate function λ(<italic>t</italic>) in the interval [0 <italic>T</italic>].</p>
</sec>
<sec id="sec009">
<title>Power spectrum of an inhomogeneous Poisson process with an oscillatory rate function</title>
<p>For a rate function defined as:
<disp-formula id="pcbi.1004252.e046">
<alternatives>
<graphic id="pcbi.1004252.e046g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e046" xlink:type="simple"/>
<mml:math display="block" id="M46" overflow="scroll">
<mml:mo>λ</mml:mo><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mo>(</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mo>·</mml:mo><mml:mtext>cos</mml:mtext><mml:mo>(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(22)</label>
</disp-formula></p>
<p>The expected number of spikes within a period <italic>T</italic> is:
<disp-formula id="pcbi.1004252.e047">
<alternatives>
<graphic id="pcbi.1004252.e047g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e047" xlink:type="simple"/>
<mml:math display="block" id="M47" overflow="scroll">
<mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>k</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mn>1</mml:mn><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:mi>m</mml:mi><mml:mtext> sinc</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mrow>
</mml:math>
</alternatives>
<label>(23)</label>
</disp-formula></p>
<p>The Fourier transform of the instantaneous rate in the time interval [0 <italic>T</italic>] for a large <italic>T</italic> is:
<disp-formula id="pcbi.1004252.e048">
<alternatives>
<graphic id="pcbi.1004252.e048g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e048" xlink:type="simple"/>
<mml:math display="block" id="M48" overflow="scroll">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mo> </mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac bevelled="true"><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>m</mml:mi><mml:mi>cos</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac bevelled="true"><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac bevelled="true"><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo> </mml:mo><mml:mtext> </mml:mtext><mml:mo>+</mml:mo><mml:mtext> </mml:mtext><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mfrac bevelled="true"><mml:mrow><mml:mo>−</mml:mo><mml:mi>T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow><mml:mrow><mml:mfrac bevelled="true"><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:msubsup><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>m</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>m</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mo> </mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>m</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(24)</label>
</disp-formula>
And:
<disp-formula id="pcbi.1004252.e049">
<alternatives>
<graphic id="pcbi.1004252.e049g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e049" xlink:type="simple"/>
<mml:math display="block" id="M49" overflow="scroll">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow> <mml:mo>|</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mspace width="1pt"/><mml:mo>=</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="1pt"/><mml:msup><mml:mtext>sinc</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="2pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="1pt"/><mml:mi>m</mml:mi><mml:mspace width="1pt"/><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mspace width="1pt"/><mml:mi>m</mml:mi><mml:mspace width="1pt"/><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:msup><mml:mtext>sinc</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:msup><mml:mtext>sinc</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(25)</label>
</disp-formula></p>
<p>Resulting in the power spectrum of the inhomogeneous Poisson process:
<disp-formula id="pcbi.1004252.e050">
<alternatives>
<graphic id="pcbi.1004252.e050g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e050" xlink:type="simple"/>
<mml:math display="block" id="M50" overflow="scroll">
<mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>T</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>f</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>=</mml:mo><mml:mspace width="1pt"/><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msup><mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>T</mml:mi></mml:msubsup><mml:mo>λ</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>f</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>m</mml:mi><mml:mspace width="1pt"/><mml:mtext>sinc</mml:mtext><mml:mo stretchy="false">(</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>T</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mspace width="1pt"/><mml:msup><mml:mtext>sinc</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mspace width="1pt"/><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mspace width="1pt"/><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:mi>m</mml:mi><mml:mspace width="1pt"/><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mi>T</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:msup><mml:mtext>sinc</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>4</mml:mn></mml:mfrac><mml:mspace width="1pt"/><mml:msup><mml:mtext>sinc</mml:mtext><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow/><mml:mn>2</mml:mn></mml:msup><mml:mi>T</mml:mi><mml:msup><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>−</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mtext>sinc</mml:mtext><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>f</mml:mi><mml:mspace width="1pt"/><mml:mo>+</mml:mo><mml:mspace width="1pt"/><mml:msub><mml:mi>f</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>T</mml:mi></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mspace width="1pt"/></mml:mtd></mml:mtr></mml:mtable>
</mml:math>
</alternatives>
<label>(26)</label>
</disp-formula></p>
</sec>
<sec id="sec010">
<title>Correction for the power estimated by Welch's method</title>
<p>The power as estimated by Welch′s method, which calculates the average of the spectra of windowed segments, needs to be scaled to the analytically calculated power; i.e., the power calculated for the signal as a single non-windowed segment. To do so, Welch's power needs to be multiplied first by the sampling frequency, and then divided by 2. Then, a correction due to the lower spectral resolution of Welch's power needs to be made: first multiply the power by the number of windows, and then subtract from it the baseline power multiplied by the number of windows minus 1. Finally, a correction due to the windowing needs to be applied: the correction term is the mean of the window multiplied by the length of the window, and then divided by the power of the window. This is expressed in the final formulation:
<disp-formula id="pcbi.1004252.e051">
<alternatives>
<graphic id="pcbi.1004252.e051g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e051" xlink:type="simple"/>
<mml:math display="block" id="M51" overflow="scroll">
<mml:mi>P</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>y</mml:mi><mml:mi>t</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mo>[</mml:mo><mml:mo>(</mml:mo><mml:mi>P</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:msub><mml:mrow><mml:mi>k</mml:mi></mml:mrow><mml:mrow><mml:mi>W</mml:mi><mml:mi>e</mml:mi><mml:mi>l</mml:mi><mml:mi>c</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:mfrac><mml:mrow><mml:mi>F</mml:mi><mml:mi>s</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn></mml:mrow></mml:mfrac><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mo>(</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>-</mml:mo><mml:mn>1</mml:mn><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub><mml:mo>]</mml:mo><mml:mo>·</mml:mo><mml:mo>[</mml:mo><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:mo>·</mml:mo><mml:mi>w</mml:mi><mml:mi>l</mml:mi><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:msup><mml:mrow><mml:mi>w</mml:mi></mml:mrow><mml:mrow><mml:mi>'</mml:mi></mml:mrow></mml:msup><mml:mo>·</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo><mml:mo>]</mml:mo>
</mml:math>
</alternatives>
<label>(27)</label>
</disp-formula>
where <italic>Fs</italic> is the sampling frequency, <italic>N</italic><sub><italic>wins</italic></sub> is the number of windows used, <italic>w</italic> is the window, and <italic>wl</italic> is the length of the window.</p>
</sec>
<sec id="sec011">
<title>Correction of the modulation index for deviations from the Poisson model</title>
<p>The deviation of the spike train from the Poisson model results in an incorrect estimation of the modulation index. A correction process could compensate for this: (1) The firing rate of the spike train assuming a true Poisson process (<inline-formula id="pcbi.1004252.e052"><alternatives><graphic id="pcbi.1004252.e052g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e052" xlink:type="simple"/><mml:math display="inline" id="M52" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) is calculated using the recorded spike train. (2) An oscillatory rate function is generated of length <italic>T</italic> and baseline rate which is set to <inline-formula id="pcbi.1004252.e053"><alternatives><graphic id="pcbi.1004252.e053g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e053" xlink:type="simple"/><mml:math display="inline" id="M53" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>. The modulation of the rate function (<italic>m</italic><sub><italic>p</italic></sub>) is set to the analytically calculated modulation index (<inline-formula id="pcbi.1004252.e054"><alternatives><graphic id="pcbi.1004252.e054g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e054" xlink:type="simple"/><mml:math display="inline" id="M54" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> of the spike train. (3) From this rate function, multiple new Poisson-like spike trains are generated, including the given deviations from the Poisson model. The modulation index measure of each spike train is estimated (<inline-formula id="pcbi.1004252.e055"><alternatives><graphic id="pcbi.1004252.e055g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e055" xlink:type="simple"/><mml:math display="inline" id="M55" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:math></alternatives></inline-formula>), and the mean modulation index is calculated (<inline-formula id="pcbi.1004252.e056"><alternatives><graphic id="pcbi.1004252.e056g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e056" xlink:type="simple"/><mml:math display="inline" id="M56" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:math></alternatives></inline-formula>). (4) The mean simulated modulation index is compared to the original modulation index of the spike train. If the simulated modulation index is different from the original modulation index (<inline-formula id="pcbi.1004252.e057"><alternatives><graphic id="pcbi.1004252.e057g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e057" xlink:type="simple"/><mml:math display="inline" id="M57" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo></mml:mover><mml:mo>≠</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>), increase (in the case of an underestimation) or decrease (in the case of an overestimation) the modulation of the rate function (<italic>m</italic><sub><italic>p</italic></sub>), and repeat step 3. If the simulated modulation index is similar to the original modulation index (<inline-formula id="pcbi.1004252.e058"><alternatives><graphic id="pcbi.1004252.e058g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e058" xlink:type="simple"/><mml:math display="inline" id="M58" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>-</mml:mo></mml:mover><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) within the required error boundaries, the Poisson equivalent modulation index is the modulation of the rate function (<inline-formula id="pcbi.1004252.e059"><alternatives><graphic id="pcbi.1004252.e059g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e059" xlink:type="simple"/><mml:math display="inline" id="M59" overflow="scroll"><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>p</mml:mi></mml:msub></mml:math></alternatives></inline-formula>).</p>
</sec>
<sec id="sec012">
<title>Correction of the modulation index for the refractory period</title>
<p>The correction process was explicitly implemented to compensate for the underestimation of the modulation index arising from the refractory period: (1) The firing rate of the spike train assuming no refractory period is calculated using the properties of the recorded spike train: the number of spikes (<italic>N</italic><sub><italic>spikes</italic></sub>), the recording duration (<italic>T</italic>) and the refractory period (<italic>τ</italic><sub><italic>ref</italic></sub>), which could be extracted from the interspike interval (ISI) histogram:
<disp-formula id="pcbi.1004252.e060">
<alternatives>
<graphic id="pcbi.1004252.e060g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e060" xlink:type="simple"/>
<mml:math display="block" id="M60" overflow="scroll">
<mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>/</mml:mo><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>-</mml:mo><mml:msub><mml:mrow><mml:mi>τ</mml:mi></mml:mrow><mml:mrow><mml:mi>r</mml:mi><mml:mi>e</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mo>·</mml:mo><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>i</mml:mi><mml:mi>k</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>)</mml:mo>
</mml:math>
</alternatives>
<label>(28)</label>
</disp-formula>
(2) The oscillatory rate function is generated of length <italic>T</italic> using a baseline rate (<inline-formula id="pcbi.1004252.e061"><alternatives><graphic id="pcbi.1004252.e061g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e061" xlink:type="simple"/><mml:math display="inline" id="M61" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>r</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>) and the modulation index (<inline-formula id="pcbi.1004252.e062"><alternatives><graphic id="pcbi.1004252.e062g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e062" xlink:type="simple"/><mml:math display="inline" id="M62" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover><mml:mo>)</mml:mo></mml:math></alternatives></inline-formula> calculated from the spike train. (3) From this rate function, 100 new Poisson spike trains are generated using a refractory period of <italic>τ</italic><sub><italic>ref</italic></sub>, and their mean modulation index is calculated (<inline-formula id="pcbi.1004252.e063"><alternatives><graphic id="pcbi.1004252.e063g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e063" xlink:type="simple"/><mml:math display="inline" id="M63" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo></mml:mover></mml:math></alternatives></inline-formula>). (4) If the simulated modulation index is smaller than the original modulation index (<inline-formula id="pcbi.1004252.e064"><alternatives><graphic id="pcbi.1004252.e064g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e064" xlink:type="simple"/><mml:math display="inline" id="M64" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo></mml:mover><mml:mo>&lt;</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>), increase the modulation of the rate function (<italic>m</italic><sub><italic>p</italic></sub>), and repeat step 3. If the simulated modulation index is similar to the original modulation index (<inline-formula id="pcbi.1004252.e065"><alternatives><graphic id="pcbi.1004252.e065g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e065" xlink:type="simple"/><mml:math display="inline" id="M65" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>m</mml:mi><mml:mo>^</mml:mo></mml:mover><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>-</mml:mo></mml:mover><mml:mo>≥</mml:mo><mml:mover accent="true"><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>), the corrected modulation index is the modulation of the rate function (<inline-formula id="pcbi.1004252.e066"><alternatives><graphic id="pcbi.1004252.e066g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e066" xlink:type="simple"/><mml:math display="inline" id="M66" overflow="scroll"><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mrow><mml:mi>p</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>^</mml:mo></mml:mover></mml:math></alternatives></inline-formula>).</p>
</sec>
<sec id="sec013">
<title>Effect of the window size on the SNR</title>
<p>The window size must be chosen as a function of the resolution of the frequency of the underlying oscillation. When the frequency of the oscillation is stable and tightly locked to a specific frequency, a longer window will yield a more precise power spectrum (<xref rid="pcbi.1004252.g007" ref-type="fig">Fig 7A</xref>). However, when the frequency jitters, using a window with a resolution smaller than the jitter size will not lead to a more precise spectrum, but rather to a spread of the power over the entire frequency jitter range (<xref rid="pcbi.1004252.g007" ref-type="fig">Fig 7B</xref>). Real neurons are not perfect oscillators in a single precise frequency, but instead are oscillatory within a jittered frequency range, which in the GPi of the Parkinsonian NHP is about 1 Hz (<xref rid="pcbi.1004252.g007" ref-type="fig">Fig 7C</xref>), justifying a window size of around the jitter size (a window length of 1000 leads to a 1Hz resolution). The length of the window affects the SNR, such that the SNR grows like <inline-formula id="pcbi.1004252.e067"><alternatives><graphic id="pcbi.1004252.e067g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e067" xlink:type="simple"/><mml:math display="inline" id="M67" overflow="scroll"><mml:msqrt><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msqrt><mml:mi> </mml:mi><mml:mo>=</mml:mo><mml:mi> </mml:mi><mml:msqrt><mml:mfrac><mml:mrow><mml:mi>T</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>l</mml:mi></mml:mrow></mml:mfrac></mml:msqrt><mml:mi mathvariant="normal"> </mml:mi></mml:math></alternatives></inline-formula>(<xref rid="pcbi.1004252.g007" ref-type="fig">Fig 7D</xref>).</p>
<fig id="pcbi.1004252.g007" position="float">
<object-id pub-id-type="doi">10.1371/journal.pcbi.1004252.g007</object-id>
<label>Fig 7</label>
<caption>
<title>Selection of window size for the calculation of the power spectrum.</title>
<p>(A) Power spectrum of a Poisson spike train generated from a pure oscillatory rate function (<italic>f</italic><sub>0</sub> = 12 Hz, <italic>r</italic><sub>0</sub> = 40 sp/s and <italic>m</italic> = 0.5). Left, power spectrum calculated with a resolution of 1 Hz. Right, power spectrum with a resolution of 0.1 Hz. (B) Power spectrum of a Poisson spike train generated from a jittered oscillatory rate function (<italic>f</italic><sub>0</sub> = 11.5–12.5 Hz, <italic>r</italic><sub>0</sub> = 40 sp/s and <italic>m</italic> = 0.5). Left, 1 Hz resolution. Right, 0.1 Hz resolution. (C) An example of a single GPi neuron showing a peak with a width of ~1 Hz. (D) The effect of window size and resolution in the power spectrum at different recording durations during a fixed firing rate and a fixed firing modulation. The SNR increases on a scale of <inline-formula id="pcbi.1004252.e068"><alternatives><graphic id="pcbi.1004252.e068g" position="anchor" mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.e068" xlink:type="simple"/><mml:math display="inline" id="M68" overflow="scroll"><mml:msqrt><mml:msub><mml:mrow><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>n</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub></mml:msqrt></mml:math></alternatives></inline-formula>. The dotted black lines indicate the square root fit.</p>
</caption>
<graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1004252.g007" position="float" xlink:type="simple"/>
</fig>
</sec>
</sec>
<sec id="sec014">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1004252.s001" xlink:href="info:doi/10.1371/journal.pcbi.1004252.s001" mimetype="application/vnd.openxmlformats-officedocument.wordprocessingml.document" position="float" xlink:type="simple">
<label>S1 Fig</label>
<caption>
<title>Reflection of the oscillatory activity in the auto-correlation function and the ISI histogram.</title>
<p>Normalized power spectrum of 5 minutes simulated spike train generated from an oscillatory rate function (<italic>f</italic><sub>0</sub> = 12 Hz, <italic>m</italic> = 0.5), when the base rate is (A) 5 sp/s, (B) 15 sp/s, (C) 30 sp/s. (D-F) The auto-correlation function of the same spike trains as in A-C. (G) The SNR of the peak in the auto-correlation as a function of the mean firing rates. The SNR is defined as the number of STDs from the mean of the auto-correlation function to the first peak near the zero point. The circles indicate the SNR of the peak shown in examples D-F, and the solid line indicates the fitted linear function. (H-J) The first order ISI histograms of the same spike trains shown in A-C. The dashed vertical lines indicate the 1/<italic>f</italic><sub>0</sub> ISI.</p>
<p>(DOCX)</p>
</caption>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<p>We thank Yosef Pinhasi for help with the initial formulation, Moshe Abeles, Dorin Yael and Edward Stein for helpful comments, Anan Moran, Yaara Erez and Hadass Tischler for the experimental data.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1004252.ref001"><label>1</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Engel</surname> <given-names>a K</given-names></name>, <name name-style="western"><surname>Fries</surname> <given-names>P</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name> (<year>2001</year>) <article-title>Dynamic predictions: oscillations and synchrony in top-down processing</article-title>. <source>Nat Rev Neurosci</source> <volume>2</volume>: <fpage>704</fpage>–<lpage>716</lpage>. <object-id pub-id-type="pmid">11584308</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref002"><label>2</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hutchison</surname> <given-names>WD</given-names></name>, <name name-style="western"><surname>Dostrovsky</surname> <given-names>JO</given-names></name>, <name name-style="western"><surname>Walters</surname> <given-names>JR</given-names></name>, <name name-style="western"><surname>Courtemanche</surname> <given-names>R</given-names></name>, <name name-style="western"><surname>Boraud</surname> <given-names>T</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Neuronal oscillations in the basal ganglia and movement disorders: evidence from whole animal and human recordings</article-title>. <source>J Neurosci</source> <volume>24</volume>: <fpage>9240</fpage>–<lpage>9243</lpage>. <object-id pub-id-type="pmid">15496658</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref003"><label>3</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Draguhn</surname> <given-names>A</given-names></name> (<year>2004</year>) <article-title>Neuronal oscillations in cortical networks</article-title>. <source>Science</source> <volume>304</volume>: <fpage>1926</fpage>–<lpage>1929</lpage>. <object-id pub-id-type="pmid">15218136</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref004"><label>4</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bergman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Wichmann</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Karmon</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>DeLong</surname> <given-names>MR</given-names></name> (<year>1994</year>) <article-title>The primate subthalamic nucleus. II. Neuronal activity in the MPTP model of parkinsonism</article-title>. <source>J Neurophysiol</source> <volume>72</volume>: <fpage>507</fpage>–<lpage>520</lpage>. <object-id pub-id-type="pmid">7983515</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref005"><label>5</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gray</surname> <given-names>CM</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name> (<year>1989</year>) <article-title>Stimulus-specific neuronal oscillations in orientation columns of cat visual cortex</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>86</volume>: <fpage>1698</fpage>–<lpage>1702</lpage>. <object-id pub-id-type="pmid">2922407</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref006"><label>6</label><mixed-citation publication-type="book" xlink:type="simple"><name name-style="western"><surname>Buzsáki</surname> <given-names>G</given-names></name> (<year>2006</year>) <source>Rhythms of the Brain</source>. <publisher-loc>Oxford</publisher-loc>: <publisher-name>Oxford University Press</publisher-name>.</mixed-citation></ref>
<ref id="pcbi.1004252.ref007"><label>7</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jarvis</surname> <given-names>MR</given-names></name>, <name name-style="western"><surname>Mitra</surname> <given-names>PP</given-names></name> (<year>2001</year>) <article-title>Sampling properties of the spectrum and coherency of sequences of action potentials</article-title>. <source>Neural Comput</source> <volume>13</volume>: <fpage>717</fpage>–<lpage>749</lpage>. <object-id pub-id-type="pmid">11255566</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref008"><label>8</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moran</surname> <given-names>a</given-names></name>, <name name-style="western"><surname>Bar-Gad</surname> <given-names>I</given-names></name> (<year>2010</year>) <article-title>Revealing neuronal functional organization through the relation between multi-scale oscillatory extracellular signals</article-title>. <source>J Neurosci Methods</source> <volume>186</volume>: <fpage>116</fpage>–<lpage>129</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.jneumeth.2009.10.024" xlink:type="simple">10.1016/j.jneumeth.2009.10.024</ext-link></comment> <object-id pub-id-type="pmid">19900473</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref009"><label>9</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Perkel</surname> <given-names>DH</given-names></name>, <name name-style="western"><surname>Gerstein</surname> <given-names>GL</given-names></name>, <name name-style="western"><surname>Moore</surname> <given-names>GP</given-names></name> (<year>1967</year>) <article-title>Neuronal spike trains and stochastic point processes. I. The single spike train</article-title>. <source>Biophys J</source> <volume>7</volume>: <fpage>391</fpage>–<lpage>418</lpage>. <object-id pub-id-type="pmid">4292791</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref010"><label>10</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mureşan</surname> <given-names>RC</given-names></name>, <name name-style="western"><surname>Jurjuţ</surname> <given-names>OF</given-names></name>, <name name-style="western"><surname>Moca</surname> <given-names>V V</given-names></name>, <name name-style="western"><surname>Singer</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Nikolić</surname> <given-names>D</given-names></name> (<year>2008</year>) <article-title>The oscillation score: an efficient method for estimating oscillation strength in neuronal activity</article-title>. <source>J Neurophysiol</source> <volume>99</volume>: <fpage>1333</fpage>–<lpage>1353</lpage>. <object-id pub-id-type="pmid">18160427</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref011"><label>11</label><mixed-citation publication-type="other" xlink:type="simple">Nikolic D (2009) Model this! Seven empirical phenomena missing in the models of cortical oscillatory dynamics. Proceedings of the International Joint Conference on Neural Networks. pp. 2272–2279.</mixed-citation></ref>
<ref id="pcbi.1004252.ref012"><label>12</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nini</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Feingold</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Slovin</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bergman</surname> <given-names>H</given-names></name> (<year>1995</year>) <article-title>Neurons in the globus pallidus do not show correlated activity in the normal monkey, but phase-locked oscillations appear in the MPTP model of parkinsonism</article-title>. <source>J Neurophysiol</source> <volume>74</volume>: <fpage>1800</fpage>–<lpage>1805</lpage>. <object-id pub-id-type="pmid">8989416</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref013"><label>13</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Raz</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Vaadia</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Bergman</surname> <given-names>H</given-names></name> (<year>2000</year>) <article-title>Firing patterns and correlations of spontaneous discharge of pallidal neurons in the normal and the tremulous 1-methyl-4-phenyl-1,2,3,6-tetrahydropyridine vervet model of parkinsonism</article-title>. <source>J Neurosci</source> <volume>20</volume>: <fpage>8559</fpage>–<lpage>8571</lpage>. <object-id pub-id-type="pmid">11069964</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref014"><label>14</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moran</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Stein</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Tischler</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bar-Gad</surname> <given-names>I</given-names></name> (<year>2012</year>) <article-title>Decoupling neuronal oscillations during subthalamic nucleus stimulation in the parkinsonian primate</article-title>. <source>Neurobiol Dis</source> <volume>45</volume>: <fpage>583</fpage>–<lpage>590</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.nbd.2011.09.016" xlink:type="simple">10.1016/j.nbd.2011.09.016</ext-link></comment> <object-id pub-id-type="pmid">22001603</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref015"><label>15</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Reynolds</surname> <given-names>JH</given-names></name>, <name name-style="western"><surname>Chelazzi</surname> <given-names>L</given-names></name> (<year>2004</year>) <article-title>Attentional modulation of visual processing</article-title>. <source>Annu Rev Neurosci</source> <volume>27</volume>: <fpage>611</fpage>–<lpage>647</lpage>. <object-id pub-id-type="pmid">15217345</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref016"><label>16</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mizuseki</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Buzsaki</surname> <given-names>G</given-names></name> (<year>2013</year>) <article-title>Preconfigured, skewed distribution of firing rates in the hippocampus and entorhinal cortex</article-title>. <source>Cell Rep</source> <volume>4</volume>: <fpage>1010</fpage>–<lpage>1021</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.celrep.2013.07.039" xlink:type="simple">10.1016/j.celrep.2013.07.039</ext-link></comment> <object-id pub-id-type="pmid">23994479</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref017"><label>17</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Boraud</surname> <given-names>T</given-names></name>, <name name-style="western"><surname>Bezard</surname> <given-names>E</given-names></name>, <name name-style="western"><surname>Guehl</surname> <given-names>D</given-names></name>, <name name-style="western"><surname>Bioulac</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Gross</surname> <given-names>C</given-names></name> (<year>1998</year>) <article-title>Effects of L-DOPA on neuronal activity of the globus pallidus externalis (GPe) and globus pallidus internalis (GPi) in the MPTP-treated monkey</article-title>. <source>Brain Res</source> <volume>787</volume>: <fpage>157</fpage>–<lpage>160</lpage>. <object-id pub-id-type="pmid">9518590</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref018"><label>18</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Drouot</surname> <given-names>X</given-names></name>, <name name-style="western"><surname>Oshino</surname> <given-names>S</given-names></name>, <name name-style="western"><surname>Jarraya</surname> <given-names>B</given-names></name>, <name name-style="western"><surname>Besret</surname> <given-names>L</given-names></name>, <name name-style="western"><surname>Kishima</surname> <given-names>H</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Functional recovery in a primate model of Parkinson’s disease following motor cortex stimulation</article-title>. <source>Neuron</source> <volume>44</volume>: <fpage>769</fpage>–<lpage>778</lpage>. <object-id pub-id-type="pmid">15572109</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref019"><label>19</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Heimer</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bar-Gad</surname> <given-names>I</given-names></name>, <name name-style="western"><surname>Goldberg</surname> <given-names>JA</given-names></name>, <name name-style="western"><surname>Bergman</surname> <given-names>H</given-names></name> (<year>2002</year>) <article-title>Dopamine replacement therapy reverses abnormal synchronization of pallidal neurons in the 1-methyl-4-phenyl-1,2,3,6-tetrahydropyridine primate model of parkinsonism</article-title>. <source>J Neurosci</source> <volume>22</volume>: <fpage>7850</fpage>–<lpage>7855</lpage>. <object-id pub-id-type="pmid">12223537</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref020"><label>20</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moran</surname> <given-names>A</given-names></name>, <name name-style="western"><surname>Bergman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Israel</surname> <given-names>Z</given-names></name>, <name name-style="western"><surname>Bar-Gad</surname> <given-names>I</given-names></name> (<year>2008</year>) <article-title>Subthalamic nucleus functional organization revealed by parkinsonian neuronal oscillations and synchrony</article-title>. <source>Brain</source> <volume>131</volume>: <fpage>3395</fpage>–<lpage>3409</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1093/brain/awn270" xlink:type="simple">10.1093/brain/awn270</ext-link></comment> <object-id pub-id-type="pmid">18986993</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref021"><label>21</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Konig</surname> <given-names>P</given-names></name> (<year>1994</year>) <article-title>A method for the quantification of synchrony and oscillatory properties of neuronal activity</article-title>. <source>J Neurosci Methods</source> <volume>54</volume>: <fpage>31</fpage>–<lpage>37</lpage>. <object-id pub-id-type="pmid">7815817</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref022"><label>22</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bair</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>O’Keefe</surname> <given-names>LP</given-names></name> (<year>1998</year>) <article-title>The influence of fixational eye movements on the response of neurons in area MT of the macaque</article-title>. <source>Vis Neurosci</source> <volume>15</volume>: <fpage>779</fpage>–<lpage>786</lpage>. <object-id pub-id-type="pmid">9682878</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref023"><label>23</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Softky</surname> <given-names>WR</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name> (<year>1993</year>) <article-title>The highly irregular firing of cortical cells is inconsistent with temporal integration of random EPSPs</article-title>. <source>J Neurosci</source> <volume>13</volume>: <fpage>334</fpage>–<lpage>350</lpage>. <object-id pub-id-type="pmid">8423479</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref024"><label>24</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bair</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Koch</surname> <given-names>C</given-names></name>, <name name-style="western"><surname>Newsome</surname> <given-names>W</given-names></name>, <name name-style="western"><surname>Britten</surname> <given-names>K</given-names></name> (<year>1994</year>) <article-title>Power spectrum analysis of bursting cells in area MT in the behaving monkey</article-title>. <source>J Neurosci</source> <volume>14</volume>: <fpage>2870</fpage>–<lpage>2892</lpage>. <object-id pub-id-type="pmid">8182445</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref025"><label>25</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Rivlin-Etzion</surname> <given-names>M</given-names></name>, <name name-style="western"><surname>Ritov</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Heimer</surname> <given-names>G</given-names></name>, <name name-style="western"><surname>Bergman</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>Bar-Gad</surname> <given-names>I</given-names></name> (<year>2006</year>) <article-title>Local shuffling of spike trains boosts the accuracy of spike train spectral analysis</article-title>. <source>J Neurophysiol</source> <volume>95</volume>: <fpage>3245</fpage>–<lpage>3256</lpage>. <object-id pub-id-type="pmid">16407432</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref026"><label>26</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Erez</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Czitron</surname> <given-names>H</given-names></name>, <name name-style="western"><surname>McCairn</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Belelovsky</surname> <given-names>K</given-names></name>, <name name-style="western"><surname>Bar-Gad</surname> <given-names>I</given-names></name> (<year>2009</year>) <article-title>Short-term depression of synaptic transmission during stimulation in the globus pallidus of 1-methyl-4-phenyl-1,2,3,6-tetrahydropyridine-treated primates</article-title>. <source>J Neurosci</source> <volume>29</volume>: <fpage>7797</fpage>–<lpage>7802</lpage>. <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1523/JNEUROSCI.0401-09.2009" xlink:type="simple">10.1523/JNEUROSCI.0401-09.2009</ext-link></comment> <object-id pub-id-type="pmid">19535591</object-id></mixed-citation></ref>
<ref id="pcbi.1004252.ref027"><label>27</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Welch</surname> <given-names>P</given-names></name> (<year>1967</year>) <article-title>The use of fast Fourier transform for the estimation of power spectra: A method based on time averaging over short, modified periodograms</article-title>. <source>IEEE Trans Audio Electroacoust</source> <volume>15</volume>: <fpage>70</fpage>–<lpage>73</lpage>.</mixed-citation></ref>
<ref id="pcbi.1004252.ref028"><label>28</label><mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Pinhasi</surname> <given-names>Y</given-names></name>, <name name-style="western"><surname>Lurie</surname> <given-names>Y</given-names></name> (<year>2002</year>) <article-title>Generalized theory and simulation of spontaneous and super-radiant emissions in electron devices and free-electron lasers</article-title>. <source>Phys Rev E</source> <volume>65</volume>: <fpage>1</fpage>–<lpage>8</lpage>. <object-id pub-id-type="pmid">11863669</object-id></mixed-citation></ref>
</ref-list>
</back>
</article>