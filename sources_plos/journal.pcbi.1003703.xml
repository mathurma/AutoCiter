<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article
  PUBLIC "-//NLM//DTD Journal Publishing DTD v3.0 20080202//EN" "http://dtd.nlm.nih.gov/publishing/3.0/journalpublishing3.dtd">
<article xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="3.0" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="publisher-id">plos</journal-id>
<journal-id journal-id-type="nlm-ta">PLoS Comput Biol</journal-id>
<journal-id journal-id-type="pmc">ploscomp</journal-id><journal-title-group>
<journal-title>PLoS Computational Biology</journal-title></journal-title-group>
<issn pub-type="ppub">1553-734X</issn>
<issn pub-type="epub">1553-7358</issn>
<publisher>
<publisher-name>Public Library of Science</publisher-name>
<publisher-loc>San Francisco, USA</publisher-loc></publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">PCOMPBIOL-D-13-01976</article-id>
<article-id pub-id-type="doi">10.1371/journal.pcbi.1003703</article-id>
<article-categories><subj-group subj-group-type="heading"><subject>Research Article</subject></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Biology and life sciences</subject><subj-group><subject>Genetics</subject><subj-group><subject>Genomics</subject><subj-group><subject>Genomic medicine</subject></subj-group></subj-group><subj-group><subject>Cancer genetics</subject></subj-group></subj-group></subj-group><subj-group subj-group-type="Discipline-v2"><subject>Medicine and health sciences</subject><subj-group><subject>Oncology</subject><subj-group><subject>Basic cancer research</subject></subj-group></subj-group></subj-group></article-categories>
<title-group>
<article-title>Inferring Clonal Composition from Multiple Sections of a Breast Cancer</article-title>
<alt-title alt-title-type="running-head">Inferring Clonal Composition of a Breast Cancer</alt-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Zare</surname><given-names>Habil</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" equal-contrib="yes" xlink:type="simple"><name name-style="western"><surname>Wang</surname><given-names>Junfeng</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Hu</surname><given-names>Alex</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Weber</surname><given-names>Kris</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Smith</surname><given-names>Josh</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Nickerson</surname><given-names>Debbie</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Song</surname><given-names>ChaoZhong</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Witten</surname><given-names>Daniela</given-names></name><xref ref-type="aff" rid="aff3"><sup>3</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Blau</surname><given-names>C. Anthony</given-names></name><xref ref-type="aff" rid="aff2"><sup>2</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
<contrib contrib-type="author" xlink:type="simple"><name name-style="western"><surname>Noble</surname><given-names>William Stafford</given-names></name><xref ref-type="aff" rid="aff1"><sup>1</sup></xref><xref ref-type="aff" rid="aff4"><sup>4</sup></xref><xref ref-type="corresp" rid="cor1"><sup>*</sup></xref></contrib>
</contrib-group>
<aff id="aff1"><label>1</label><addr-line>Department of Genome Sciences, University of Washington, Seattle, Washington, United States of America</addr-line></aff>
<aff id="aff2"><label>2</label><addr-line>Division of Hematology, Department of Medicine, University of Washington, Seattle, Washington, United States of America</addr-line></aff>
<aff id="aff3"><label>3</label><addr-line>Department of Biostatistics, University of Washington, Seattle, Washington, United States of America</addr-line></aff>
<aff id="aff4"><label>4</label><addr-line>Department of Computer Science and Engineering, University of Washington, Seattle, Washington, United States of America</addr-line></aff>
<contrib-group>
<contrib contrib-type="editor" xlink:type="simple"><name name-style="western"><surname>Tanay</surname><given-names>Amos</given-names></name>
<role>Editor</role>
<xref ref-type="aff" rid="edit1"/></contrib>
</contrib-group>
<aff id="edit1"><addr-line>Weizmann Institute of Science, Israel</addr-line></aff>
<author-notes>
<corresp id="cor1">* E-mail: <email xlink:type="simple">dwitten@uw.edu</email> (DW); <email xlink:type="simple">tblau@uw.edu</email> (CAB); <email xlink:type="simple">william-noble@uw.edu</email> (WSN)</corresp>
<fn fn-type="conflict"><p>The authors have declared that no competing interests exist.</p></fn>
<fn fn-type="con"><p>Conceived and designed the experiments: HZ JW DW CAB WSN. Performed the experiments: JW JS CS. Analyzed the data: HZ JW AH JS KW. Wrote the paper: HZ JW DN DW CAB WSN.</p></fn>
</author-notes>
<pub-date pub-type="collection"><month>7</month><year>2014</year></pub-date>
<pub-date pub-type="epub"><day>10</day><month>7</month><year>2014</year></pub-date>
<volume>10</volume>
<issue>7</issue>
<elocation-id>e1003703</elocation-id>
<history>
<date date-type="received"><day>8</day><month>11</month><year>2013</year></date>
<date date-type="accepted"><day>20</day><month>5</month><year>2014</year></date>
</history>
<permissions>
<copyright-year>2014</copyright-year>
<copyright-holder>Zare et al</copyright-holder><license xlink:type="simple"><license-p>This is an open-access article distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="http://creativecommons.org/licenses/by/4.0/" xlink:type="simple">Creative Commons Attribution License</ext-link>, which permits unrestricted use, distribution, and reproduction in any medium, provided the original author and source are credited.</license-p></license></permissions>
<abstract>
<p>Cancers arise from successive rounds of mutation and selection, generating clonal populations that vary in size, mutational content and drug responsiveness. Ascertaining the clonal composition of a tumor is therefore important both for prognosis and therapy. Mutation counts and frequencies resulting from next-generation sequencing (NGS) potentially reflect a tumor's clonal composition; however, deconvolving NGS data to infer a tumor's clonal structure presents a major challenge. We propose a generative model for NGS data derived from multiple subsections of a single tumor, and we describe an expectation-maximization procedure for estimating the clonal genotypes and relative frequencies using this model. We demonstrate, via simulation, the validity of the approach, and then use our algorithm to assess the clonal composition of a primary breast cancer and associated metastatic lymph node. After dividing the tumor into subsections, we perform exome sequencing for each subsection to assess mutational content, followed by deep sequencing to precisely count normal and variant alleles within each subsection. By quantifying the frequencies of 17 somatic variants, we demonstrate that our algorithm predicts clonal relationships that are both phylogenetically and spatially plausible. Applying this method to larger numbers of tumors should cast light on the clonal evolution of cancers in space and time.</p>
</abstract>
<abstract abstract-type="summary"><title>Author Summary</title>
<p>Cancers arise from a series of mutations that occur over time. As a result, as a tumor grows each cell inherits a distinctive <italic>genotype</italic>, defined by the set of all somatic mutations that distinguish the tumor cell from normal cells. Acertaining these genotype patterns, and identifying which ones are associated with the growth of the cancer and its ability to metastasize, can potentially give clinicians insights into how to treat the cancer. In this work, we describe a method for inferring the predominant genotypes within a single tumor. The method requires that a tumor be sectioned and that each section be subjected to a high-throughput sequencing procedure. The resulting mutations and their associated frequencies within each tumor section are then used as input to a probabilistic model that infers the underlying genotypes and their relative frequencies within the tumor. We use simulated data to demonstrate the validity of the approach, and then we apply our algorithm to data from a primary breast cancer and associated metastatic lymph node. We demonstrate that our algorithm predicts genotypes that are consistent with an evolutionary model and with the physical topology of the tumor itself. Applying this method to larger numbers of tumors should cast light on the evolution of cancers in space and time.</p>
</abstract>
<funding-group><funding-statement>This work was supported by National Institutes of Health awards 1R01CA135357-01A1 (CAB) and 1DP5OD009145 (DW). The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</funding-statement></funding-group><counts><page-count count="15"/></counts></article-meta>
</front>
<body><sec id="s1">
<title>Introduction</title>
<p>Many clones exist within each cancer, and selective pressure imposed by environmental factors, most notably treatments directed at tumor eradication, favors the emergence of clones that grow increasingly resistant to successive rounds of therapy. Incorporating this intra-tumor heterogeneity into strategies for planning, monitoring, and revising cancer treatment could improve outcomes for oncologists and their patients. Therefore, methods for estimating the number, size and mutational content of clones within a patient's tumor are being explored.</p>
<p>New approaches are being developed to assess the clonal content of a given tumor. Methods based on the interrogation of individual cells have relied on the use of fluorescent markers <xref ref-type="bibr" rid="pcbi.1003703-Irish1">[1]</xref>, <xref ref-type="bibr" rid="pcbi.1003703-Navin1">[2]</xref> or single cell sequencing <xref ref-type="bibr" rid="pcbi.1003703-Xu1">[3]</xref>–<xref ref-type="bibr" rid="pcbi.1003703-Potter1">[6]</xref>. Whereas fluorescence-based approaches are inevitably limited by the relatively small number of features they can accommodate, single cell sequencing brings the highest possible resolution to characterizing an individual patient's tumor. Nonetheless, single cell sequencing also faces obstacles to its widespread implementation. Evaluating sufficiently large numbers of single cells to obtain statistical power can be prohibitive, for technical or financial reasons. Additionally, it is often difficult to ascertain the identity of the cells being sequenced, and details regarding the spatial positioning of cells relative to each other and to other cells in the tumor are lost when the single cells are obtained. These disadvantages pose significant challenges to the widespread adoption of single cell sequencing as a means for assessing tumor heterogeneity.</p>
<p>Complementing single cell approaches are efforts to deconvolve clonal subpopulations based on the frequencies of mutated alleles within one or more bulk tumor specimens. Shah et al. <xref ref-type="bibr" rid="pcbi.1003703-Shah1">[7]</xref>, who sequenced a breast cancer at the time of diagnosis and nine years later, after metastasis, pointed out that allele frequencies of the mutations shared between the two samples could be used to segregate primary mutations into those that occur in a dominant versus subdominant clone. This insight is the basis for a variety of approaches that apply clustering algorithms to mutation allele frequencies, including kernel density estimation <xref ref-type="bibr" rid="pcbi.1003703-Welch1">[8]</xref> and Dirichlet process modeling applied either to the allele frequencies <xref ref-type="bibr" rid="pcbi.1003703-NikZainal1">[9]</xref> or to a combination of allele frequency, loss-of-heterozygosity status and copy number <xref ref-type="bibr" rid="pcbi.1003703-Ding1">[10]</xref>–<xref ref-type="bibr" rid="pcbi.1003703-Roth1">[13]</xref>.</p>
<p>Clearly, statistical power to infer variants and, ultimately, clonal composition, is increased if multiple samples are available for analysis. Accordingly, various studies have examined the progression of cancer within one or more patients over time. Sets of variants that exhibit similar allele frequencies within a single sample are suggestive of a clonal population. Hence, clustering methods to identify groups of mutations associated with a single clone have been applied. For example, kernel density estimation has been applied to allele frequencies from tumor-relapse pairs from eight acute myeloid leukemia (AML) patients <xref ref-type="bibr" rid="pcbi.1003703-Ding2">[14]</xref> and from seven secondary AML patients <xref ref-type="bibr" rid="pcbi.1003703-Walter1">[15]</xref>.</p>
<p>An orthogonal approach taken by Newberger et al. <xref ref-type="bibr" rid="pcbi.1003703-Newburger1">[16]</xref> employs triplet samples of neoplasia, matched normal and carcinoma from six patients to infer lineages of various genetic events. They characterize each locus in terms of a binary vector representing the presence of the mutation across the various samples and then group the loci into classes on the basis of these vectors. After filtering low frequency classes, the classes are used to manually construct a phylogenetic tree. The focus of the study is to identify the shared characteristics of the evolutionary process across six patients with breast cancer.</p>
<p>In the current study, we adopt an alternative approach to identify clonal structure. Rather than measuring allele frequencies in multiple samples from the same patient over time, we physically subdivide a single breast cancer specimen and measure allele frequencies within each subsection (<xref ref-type="fig" rid="pcbi-1003703-g001">Figure 1</xref>). We are aware of two previous studies that have adopted such an approach. Yachida et al. <xref ref-type="bibr" rid="pcbi.1003703-Yachida1">[17]</xref> analyzed seven metastatic pancreatic cancers, sequencing from multiple samples per patient. Clones are initially defined relative to sample types (peritoneal, liver and lung metastases). Subsequently, the tumors from two patients are resected and a clonal phylogeny is inferred manually. More recently, Gerlinger et al. <xref ref-type="bibr" rid="pcbi.1003703-Gerlinger1">[18]</xref> carried out exome sequencing followed by targeted deep sequencing on samples from four patients with renal carcinoma. Each primary tumor was divided into 9 regions, and a phylogeny was manually constructed by assuming that higher alternate allele frequencies correspond to earlier mutations. In neither of these studies was an algorithm proposed to automatically infer from such data both the clonal genotypes and the relative frequencies of the clones within each subsection.</p>
<fig id="pcbi-1003703-g001" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003703.g001</object-id><label>Figure 1</label><caption>
<title>Inference of tumor clonal content.</title>
<p>A collection of subsections of a tumor are subjected to next-generation sequencing to measure, across a common set of genomic loci, counts of two alleles—the <italic>normal</italic> allele that was observed in a matched normal sample at that locus, and a <italic>variant allele</italic>. The resulting counts matrices are provided as input to an inference procedure that estimates the clonal genotypes and frequencies.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003703.g001" position="float" xlink:type="simple"/></fig>
<p>The method proposed here bears some similarity to the recently proposed Tree Approach to Clonality (TrAp) method <xref ref-type="bibr" rid="pcbi.1003703-Strino1">[19]</xref>. The TrAp algorithm aims to identify the number, relative frequencies and genotypes of clones within a tumor using a formalism somewhat similar to ours, based on matrix decomposition. However, rather than analyzing data from multiple sections, the authors use as input a single set of variant allele frequencies and then constrain the resulting optimization problem by introducing a series of four assumptions about cancer evolution. It is not clear whether the method can easily generalize to analysis of data from multiple sections or multiple time points.</p>
<p>Here we describe a generative binomial model that incorporates information from multiple sections from a single tumor at a single time point to infer the frequencies and genotypes for a specified number of clones. An implementation of our algorithm is available through Bioconductor as an R package called Clomial (<ext-link ext-link-type="uri" xlink:href="http://www.bioconductor.org/packages/release/bioc/html/Clomial.html" xlink:type="simple">http://www.bioconductor.org/packages/release/bioc/html/Clomial.html</ext-link>). We use Clomial version 1.1.7 to apply this approach to a breast cancer specimen and demonstrate that the results from our model predict relationships that are phylogenetically and spatially plausible.</p>
</sec><sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>1 Inferring the clonal architecture of a tumor</title>
<p>We assume that a tumor is comprised of multiple populations of cells (“clones”), each with a unique genotype, and that these populations are heterogeneously distributed within the tumor itself. We collect, from several physical subsections of the tumor, shotgun sequencing reads. We also collect sequencing data from a non-tumor subsection from the same patient. Using the called genotypes from the normal subsection, and restricting ourselves to positions that are homozygous in the normal subsection, each read from a tumor subsection exhibits either a normal allele or a variant allele at each location. We exclude positions that exhibit homozygous normal alleles in all of the tumor subsections. Our goal is to infer, from the remaining <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e001" xlink:type="simple"/></inline-formula> mutated positions, the genotype of each clonal population and their relative frequencies within each physical subsection of the tumor.</p>
<p>Formally, the problem can be stated as follows. Note that we use bold face letters for random variables, and that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e002" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e003" xlink:type="simple"/></inline-formula> respectively denote the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e004" xlink:type="simple"/></inline-formula> row and the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e005" xlink:type="simple"/></inline-formula> column of matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e006" xlink:type="simple"/></inline-formula>. We are given two primary input matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e007" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e008" xlink:type="simple"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e009" xlink:type="simple"/></inline-formula> is the number of mutated loci, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e010" xlink:type="simple"/></inline-formula> is the number of subsections (of which one is normal and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e011" xlink:type="simple"/></inline-formula> are tumor), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e012" xlink:type="simple"/></inline-formula> is the total number of reads (i.e., the coverage) at locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e013" xlink:type="simple"/></inline-formula> in subsection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e014" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e015" xlink:type="simple"/></inline-formula> is the number of cancerous reads (those supporting the mutation) at locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e016" xlink:type="simple"/></inline-formula> in subsection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e017" xlink:type="simple"/></inline-formula>. We assume, without loss of generality, that the first of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e018" xlink:type="simple"/></inline-formula> subsections corresponds to normal tissue, and that the remaining <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e019" xlink:type="simple"/></inline-formula> subsections are from the tumor. In addition, we consider <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e020" xlink:type="simple"/></inline-formula>, the number of distinct clones in the tumor, as a hyperparameter, and train a model based on a given value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e021" xlink:type="simple"/></inline-formula>. We assume that the first clone corresponds to the normal cell population and the tumor is composed of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e022" xlink:type="simple"/></inline-formula> tumor clones. Later, we will discuss whether <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e023" xlink:type="simple"/></inline-formula> can be estimated from the data. Our task is to infer two matrices: a <italic>clone frequency matrix</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e024" xlink:type="simple"/></inline-formula> in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e025" xlink:type="simple"/></inline-formula> is the proportion of cells of clone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e026" xlink:type="simple"/></inline-formula> in subsection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e027" xlink:type="simple"/></inline-formula>, and a <italic>genotype matrix</italic> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e028" xlink:type="simple"/></inline-formula> in which <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e029" xlink:type="simple"/></inline-formula> if clone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e030" xlink:type="simple"/></inline-formula> has the variant allele at locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e031" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e032" xlink:type="simple"/></inline-formula> otherwise. The first column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e033" xlink:type="simple"/></inline-formula> contains all zeroes because it represents the “normal clone.” By definition, each column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e034" xlink:type="simple"/></inline-formula> sums to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e035" xlink:type="simple"/></inline-formula>. Also, by construction, the first column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e036" xlink:type="simple"/></inline-formula> corresponds to the normal subsection and hence consists almost entirely of zeroes, although small non-zero counts may be possible due to contamination from tumor or due to sequencing error. If the first column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e037" xlink:type="simple"/></inline-formula> consisted entirely of zeroes, then we would expect the first column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e038" xlink:type="simple"/></inline-formula> to be of the form <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e039" xlink:type="simple"/></inline-formula>, but in order to allow for the possibility that the allegedly normal subsection can have slight tumor contamination, we infer the first column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e040" xlink:type="simple"/></inline-formula> (as well as the other <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e041" xlink:type="simple"/></inline-formula> columns).</p>
<p>We propose to solve this problem using a generative model whose parameters are learned via expectation-maximization (EM) <xref ref-type="bibr" rid="pcbi.1003703-Dempster1">[20]</xref>. Accordingly, we define a matrix of hidden variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e042" xlink:type="simple"/></inline-formula> representing the unknown genotypes of the clones; for instance, if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e043" xlink:type="simple"/></inline-formula>, then the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e044" xlink:type="simple"/></inline-formula> clone has a tumor allele at the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e045" xlink:type="simple"/></inline-formula> locus. We assume that each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e046" xlink:type="simple"/></inline-formula> follows an independent Bernoulli distribution with parameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e047" xlink:type="simple"/></inline-formula>, i.e.,<disp-formula id="pcbi.1003703.e048"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e048" xlink:type="simple"/><label>(1)</label></disp-formula></p>
<p>We also assume that if a mutation is present in a particular clone, then at that locus the clone is heterozygous with copy number equal to 1. Therefore, for subsection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e049" xlink:type="simple"/></inline-formula>, if clone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e050" xlink:type="simple"/></inline-formula> has a mutation at locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e051" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e052" xlink:type="simple"/></inline-formula>), then its contribution to the observed count of cancer alleles is by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e053" xlink:type="simple"/></inline-formula>, half of its proportion in the subsection. Conversely, if a clone does not have a mutation at <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e054" xlink:type="simple"/></inline-formula> (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e055" xlink:type="simple"/></inline-formula>), then it does not contribute to the count of variant alleles. By summing up the contributions of all clones, we obtain the total probability that an observed read corresponds to a variant allele rather than a normal allele. Therefore, the probability that a read contains the variant allele at locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e056" xlink:type="simple"/></inline-formula> in subsection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e057" xlink:type="simple"/></inline-formula> is given by<disp-formula id="pcbi.1003703.e058"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e058" xlink:type="simple"/><label>(2)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e059" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e060" xlink:type="simple"/></inline-formula> row of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e061" xlink:type="simple"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e062" xlink:type="simple"/></inline-formula> is the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e063" xlink:type="simple"/></inline-formula> column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e064" xlink:type="simple"/></inline-formula>. Finally, we introduce a matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e065" xlink:type="simple"/></inline-formula> of random variables representing the observed data, where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e066" xlink:type="simple"/></inline-formula> is the number of reads exhibiting the variant allele at locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e067" xlink:type="simple"/></inline-formula> in subsection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e068" xlink:type="simple"/></inline-formula>. This matrix encodes our primary assumption about the distribution of the data: for each <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e069" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e070" xlink:type="simple"/></inline-formula>, we observe an independent sample of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e071" xlink:type="simple"/></inline-formula> that has a binomial distribution with two parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e072" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e073" xlink:type="simple"/></inline-formula>, i.e.,<disp-formula id="pcbi.1003703.e074"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e074" xlink:type="simple"/><label>(3)</label></disp-formula></p>
<p>The first parameter of this distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e075" xlink:type="simple"/></inline-formula> is the (known) total number of reads at locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e076" xlink:type="simple"/></inline-formula> in subsection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e077" xlink:type="simple"/></inline-formula>. The second parameter, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e078" xlink:type="simple"/></inline-formula>, is the probability of observing a variant allele; it will be inferred by EM.</p>
<p>Given the joint distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e079" xlink:type="simple"/></inline-formula> over observed variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e080" xlink:type="simple"/></inline-formula> and latent variables <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e081" xlink:type="simple"/></inline-formula>, governed by parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e082" xlink:type="simple"/></inline-formula>, our goal is to maximize the likelihood function <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e083" xlink:type="simple"/></inline-formula>. We do so using EM, exploiting three assumptions: (1) that each subsection contains non-zero normal contamination, i.e., <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e084" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e085" xlink:type="simple"/></inline-formula>, (2) independence of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e086" xlink:type="simple"/></inline-formula> subsections from each other, and (3) independence of mutations from each other. The first assumption is based on the widely accepted difficulty associated with obtaining perfectly pure samples of tumor cells <xref ref-type="bibr" rid="pcbi.1003703-Carter1">[21]</xref>, <xref ref-type="bibr" rid="pcbi.1003703-Mwenifumbo1">[22]</xref>. The two independence assumptions essentially state that each locus and each sample is informative. These assumptions are unavoidable: in the presence of very high dependence, only very limited information about the underlying clonal composition of the tumor would be provided by the loci and samples. Furthermore, it is worth noting that these independence assumptions are made <italic>conditional</italic> on the parameters in the model: that is, the elements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e087" xlink:type="simple"/></inline-formula> are independent conditional on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e088" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e089" xlink:type="simple"/></inline-formula>. In other words, if we knew the true underlying parameters for the model (that is, the true genotypes for the clones, and the true proportion of each clone present in each sample), then the actual number of “tumor” reads that we would observe for each locus-sample pair would be independent.</p>
<p>While the formulation of our inference problem shows some similarity to well-studied matrix factorization problems <xref ref-type="bibr" rid="pcbi.1003703-Rennie1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1003703-Engelhardt1">[25]</xref>, such techniques cannot be directly applied here. Unlike most matrix factorization techniques, which assume a normal distribution, our observations are binomially distributed. Moreover, the elements of the latent matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e090" xlink:type="simple"/></inline-formula> are binary, and each column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e091" xlink:type="simple"/></inline-formula> must sum to 1. These constraints required us to develop a customized inference algorithm.</p>
</sec><sec id="s2b">
<title>2 Log likelihood</title>
<p>To frame the EM optimization, we consider the following complete-data log likelihood function of the model:<disp-formula id="pcbi.1003703.e092"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e092" xlink:type="simple"/><label>(4)</label></disp-formula>which can be computed as follows (for details see Note S4 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>):<disp-formula id="pcbi.1003703.e093"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e093" xlink:type="simple"/><label>(5)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e094" xlink:type="simple"/></inline-formula>.</p>
</sec><sec id="s2c">
<title>3 Expectation maximization (EM) algorithm</title>
<p>Our goal is to find the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e095" xlink:type="simple"/></inline-formula> which maximize the likelihood. Because our model involves the hidden variable <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e096" xlink:type="simple"/></inline-formula>, we cannot directly maximize the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e097" xlink:type="simple"/></inline-formula> given in <xref ref-type="disp-formula" rid="pcbi.1003703.e093">Equation 5</xref> with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e098" xlink:type="simple"/></inline-formula>. Instead, we use the EM algorithm to fit the model to the data <xref ref-type="bibr" rid="pcbi.1003703-Bishop1">[26]</xref>. EM is an iterative algorithm with two steps—E (for expectation) and M (for maximization)—in each iteration. In the E step, we use the current estimates of the parameters, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e099" xlink:type="simple"/></inline-formula>, to compute the conditional expectation of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e100" xlink:type="simple"/></inline-formula>. In the M step, we find the new parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e101" xlink:type="simple"/></inline-formula> that maximize the conditional expectation.</p>
<sec id="s2c1">
<title>Overview</title>
<p>In this section, we present an overview of the EM algorithm, followed by the specific details of the E and M steps for our application.</p>
<list list-type="order"><list-item>
<p>Randomly initialize the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e102" xlink:type="simple"/></inline-formula>.</p>
</list-item><list-item>
<p>Repeat the following until a convergence criterion is satisfied (such as insignificant improvement in the log likelihood; see <xref ref-type="disp-formula" rid="pcbi.1003703.e180">Equation 12</xref>).</p>
<list list-type="alpha-lower"><list-item>
<p><bold>E Step.</bold> Evaluate the posterior <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e103" xlink:type="simple"/></inline-formula> using the current parameter values. Because each locus is independent, we will compute <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e104" xlink:type="simple"/></inline-formula> for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e105" xlink:type="simple"/></inline-formula>. This can be done by Bayes' theorem,<disp-formula id="pcbi.1003703.e106"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e106" xlink:type="simple"/><label>(6)</label></disp-formula></p>
</list-item><list-item>
<p><bold>M Step.</bold> Evaluate <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e107" xlink:type="simple"/></inline-formula> from<disp-formula id="pcbi.1003703.e108"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e108" xlink:type="simple"/></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e109" xlink:type="simple"/></inline-formula> is the following expected log likelihood with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e110" xlink:type="simple"/></inline-formula> conditioned on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e111" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e112" xlink:type="simple"/></inline-formula>:<disp-formula id="pcbi.1003703.e113"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e113" xlink:type="simple"/><label>(7)</label></disp-formula></p>
</list-item><list-item>
<p>Update the parameters by<disp-formula id="pcbi.1003703.e114"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e114" xlink:type="simple"/></disp-formula></p>
</list-item></list>
</list-item></list>
</sec><sec id="s2c2">
<title>Computation for the E step</title>
<p>To compute the posterior <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e115" xlink:type="simple"/></inline-formula>, we need to compute <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e116" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e117" xlink:type="simple"/></inline-formula> for the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e118" xlink:type="simple"/></inline-formula> locus (see <xref ref-type="disp-formula" rid="pcbi.1003703.e106">Equation 6</xref>). The latter is equal to the product of binomial probabilities because the samples are assumed to be independent. Using <xref ref-type="disp-formula" rid="pcbi.1003703.e058">Equations 2</xref> and <xref ref-type="disp-formula" rid="pcbi.1003703.e074">3</xref>, we have<disp-formula id="pcbi.1003703.e119"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e119" xlink:type="simple"/><label>(8)</label></disp-formula>Also, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e120" xlink:type="simple"/></inline-formula> is the product of Bernoulli probabilities. From <xref ref-type="disp-formula" rid="pcbi.1003703.e048">Equation 1</xref>, we have that<disp-formula id="pcbi.1003703.e121"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e121" xlink:type="simple"/></disp-formula></p>
</sec><sec id="s2c3">
<title>Computation for the M step</title>
<p>To get <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e122" xlink:type="simple"/></inline-formula>, we maximize <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e123" xlink:type="simple"/></inline-formula> defined in <xref ref-type="disp-formula" rid="pcbi.1003703.e113">Equation 7</xref>. First, we split <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e124" xlink:type="simple"/></inline-formula> into two terms such that one term depends only on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e125" xlink:type="simple"/></inline-formula>, and the other term depends only on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e126" xlink:type="simple"/></inline-formula>. This simplifies the process of finding the optimal parameters.<disp-formula id="pcbi.1003703.e127"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e127" xlink:type="simple"/><label>(9)</label></disp-formula>where we let <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e128" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e129" xlink:type="simple"/></inline-formula> for simplicity of notation. Similar to Equation S7 in Note S4 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>, we have used the fact that conditional on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e130" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e131" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e132" xlink:type="simple"/></inline-formula> is independent of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e133" xlink:type="simple"/></inline-formula>, as well as the fact that conditional on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e134" xlink:type="simple"/></inline-formula>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e135" xlink:type="simple"/></inline-formula> is independent of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e136" xlink:type="simple"/></inline-formula>.</p>
<p><bold>Computing</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e137" xlink:type="simple"/></inline-formula> Now that we have separated <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e138" xlink:type="simple"/></inline-formula> into two terms, we can first update <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e139" xlink:type="simple"/></inline-formula> by only maximizing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e140" xlink:type="simple"/></inline-formula>. We solve the following constrained optimization problem to get <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e141" xlink:type="simple"/></inline-formula> (for details see Note S5 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>):<disp-formula id="pcbi.1003703.e142"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e142" xlink:type="simple"/><label>(10)</label></disp-formula></p>
<p>We solve our simplified optimization problem using a quasi-Newton method called BFGS-B <xref ref-type="bibr" rid="pcbi.1003703-Fletcher1">[27]</xref>, <xref ref-type="bibr" rid="pcbi.1003703-Dennis1">[28]</xref>. The original BFGS algorithm uses the gradient to approximate the Hessian matrix of second derivatives; therefore, the algorithm is very efficient when the gradient is available <xref ref-type="bibr" rid="pcbi.1003703-Sun1">[29]</xref>, <xref ref-type="bibr" rid="pcbi.1003703-Wriggers1">[30]</xref>. BFGS-B is a variant that can handle simple box constraints. We compute the first derivative of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e143" xlink:type="simple"/></inline-formula> with respect to each entry of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e144" xlink:type="simple"/></inline-formula> by the chain rule, and provide it to BFGS-B for faster convergence (Note S2 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>).</p>
<p><bold>Computing</bold> <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e145" xlink:type="simple"/></inline-formula> Recall that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e146" xlink:type="simple"/></inline-formula> is the only part of the expected log likelihood which is a function of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e147" xlink:type="simple"/></inline-formula> (see <xref ref-type="disp-formula" rid="pcbi.1003703.e127">Equation 9</xref>). Therefore, we can compute <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e148" xlink:type="simple"/></inline-formula> by maximizing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e149" xlink:type="simple"/></inline-formula>. Because we are assuming that conditional on <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e150" xlink:type="simple"/></inline-formula>, the elements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e151" xlink:type="simple"/></inline-formula> are independent, we just need to maximize each term in the following sum:<disp-formula id="pcbi.1003703.e152"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e152" xlink:type="simple"/></disp-formula></p>
<p>The first column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e153" xlink:type="simple"/></inline-formula> corresponds to the normal cells, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e154" xlink:type="simple"/></inline-formula>, hence <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e155" xlink:type="simple"/></inline-formula> for all <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e156" xlink:type="simple"/></inline-formula>. For <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e157" xlink:type="simple"/></inline-formula>, we need to maximize, with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e158" xlink:type="simple"/></inline-formula>,<disp-formula id="pcbi.1003703.e159"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e159" xlink:type="simple"/><label>(11)</label></disp-formula></p>
<p>By single-variable calculus, the value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e160" xlink:type="simple"/></inline-formula> that maximizes (11) is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e161" xlink:type="simple"/></inline-formula>. For the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e162" xlink:type="simple"/></inline-formula> clone, the probability <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e163" xlink:type="simple"/></inline-formula> can be computed by marginalizing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e164" xlink:type="simple"/></inline-formula> over all other clones:<disp-formula id="pcbi.1003703.e165"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e165" xlink:type="simple"/></disp-formula></p>
<p>Because the posteriors <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e166" xlink:type="simple"/></inline-formula> are easy to compute by Bayes' rule (<xref ref-type="disp-formula" rid="pcbi.1003703.e106">Equation 6</xref>), <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e167" xlink:type="simple"/></inline-formula> can be updated as follows:<disp-formula id="pcbi.1003703.e168"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e168" xlink:type="simple"/></disp-formula></p>
<p>In principle, for each solution, the genotype matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e169" xlink:type="simple"/></inline-formula> can be obtained by rounding the inferred <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e170" xlink:type="simple"/></inline-formula>. However, in practice, the inferred values in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e171" xlink:type="simple"/></inline-formula> were always exactly 0 or 1 (with observed differences <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e172" xlink:type="simple"/></inline-formula>).</p>
</sec><sec id="s2c4">
<title>Initialization and convergence</title>
<p>We initialize elements of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e173" xlink:type="simple"/></inline-formula> with values independently sampled from a Uniform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e174" xlink:type="simple"/></inline-formula> distribution. Then we standardize each column such that the sum of the proportions of each clone in a subsection is <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e175" xlink:type="simple"/></inline-formula>. Similarly, we randomly initialize the matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e176" xlink:type="simple"/></inline-formula> with values independently sampled from a Uniform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e177" xlink:type="simple"/></inline-formula> distribution. In practice, we run EM to convergence from multiple random initializations for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e178" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e179" xlink:type="simple"/></inline-formula>, and we choose the run that results in the highest likelihood.</p>
<p>The convergence criterion is based on the change in the expectation of the complete-data log likelihood. Specifically, we stop the EM iterations if:<disp-formula id="pcbi.1003703.e180"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e180" xlink:type="simple"/><label>(12)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e181" xlink:type="simple"/></inline-formula> is a small positive number. We set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e182" xlink:type="simple"/></inline-formula> in our experiments. Using <xref ref-type="disp-formula" rid="pcbi.1003703.e093">Equation 5</xref>, we can compute <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e183" xlink:type="simple"/></inline-formula> in each iteration as follows:<disp-formula id="pcbi.1003703.e184"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e184" xlink:type="simple"/><label>(13)</label></disp-formula>where the sums are over locus indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e185" xlink:type="simple"/></inline-formula>, subsection indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e186" xlink:type="simple"/></inline-formula>, and clone indices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e187" xlink:type="simple"/></inline-formula>. We used the fact that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e188" xlink:type="simple"/></inline-formula> is binary and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e189" xlink:type="simple"/></inline-formula> to derive the above equation.</p>
</sec></sec><sec id="s2d">
<title>4 Simulation results</title>
<p>To validate our implementation of the EM optimization procedure and to understand our model's behavior, we produced simulated deep sequencing data and measured the extent to which the model successfully recovers the true clonal structure of the data.</p>
<p>For each simulation, we began by randomly generating four matrices. First, we generated a simulated matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e190" xlink:type="simple"/></inline-formula> of total read counts with respect to a fixed number (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e191" xlink:type="simple"/></inline-formula>) of loci and a fixed number (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e192" xlink:type="simple"/></inline-formula>) of subsections with a mean coverage of 1000 reads per locus. The matrix was generated by independently sampling each column (corresponding to a single subsection) from a multinomial distribution <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e193" xlink:type="simple"/></inline-formula>, where the parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e194" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e195" xlink:type="simple"/></inline-formula> correspond to the total number of trials, and the probability of success for each of the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e196" xlink:type="simple"/></inline-formula> loci, respectively. Second, for any clone number <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e197" xlink:type="simple"/></inline-formula>, we generated a corresponding Boolean matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e198" xlink:type="simple"/></inline-formula>, in which the entry at row <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e199" xlink:type="simple"/></inline-formula> and column <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e200" xlink:type="simple"/></inline-formula> indicates whether locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e201" xlink:type="simple"/></inline-formula> exhibits the variant allele in clone <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e202" xlink:type="simple"/></inline-formula>. Entries in <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e203" xlink:type="simple"/></inline-formula> were generated independently from a Bernoulli distribution with a probability of success <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e204" xlink:type="simple"/></inline-formula>, with the exception of the first (“normal”) column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e205" xlink:type="simple"/></inline-formula>, which contains all zeroes. Third, we generated a clone frequency matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e206" xlink:type="simple"/></inline-formula> as follows: each element of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e207" xlink:type="simple"/></inline-formula> is independently drawn from a Uniform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e208" xlink:type="simple"/></inline-formula> distribution, and then each column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e209" xlink:type="simple"/></inline-formula> was divided by the column sum, so that the columns summed to 1. We then set <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e210" xlink:type="simple"/></inline-formula> so that the first column of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e211" xlink:type="simple"/></inline-formula> corresponds to the normal subsection. Finally, for each locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e212" xlink:type="simple"/></inline-formula> and subsection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e213" xlink:type="simple"/></inline-formula>, we generated the observed number of variant alleles <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e214" xlink:type="simple"/></inline-formula> by sampling from a binomial distribution with parameters <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e215" xlink:type="simple"/></inline-formula> (representing the total number of reads) and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e216" xlink:type="simple"/></inline-formula> (representing the probability that a given read corresponds to the variant allele). This last step complies with our primary assumption about the distribution of the data (<xref ref-type="disp-formula" rid="pcbi.1003703.e074">Equation 3</xref>).</p>
<p>We ran the EM algorithm using the simulated data <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e217" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e218" xlink:type="simple"/></inline-formula> and then evaluated the extent to which the estimated clone frequency matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e219" xlink:type="simple"/></inline-formula> and mutation probability matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e220" xlink:type="simple"/></inline-formula> differed from the corresponding true matrices <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e221" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e222" xlink:type="simple"/></inline-formula>. Specifically, we computed the genotype error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e223" xlink:type="simple"/></inline-formula>, defined as<disp-formula id="pcbi.1003703.e224"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e224" xlink:type="simple"/></disp-formula>and the clone frequency error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e225" xlink:type="simple"/></inline-formula>,<disp-formula id="pcbi.1003703.e226"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e226" xlink:type="simple"/></disp-formula></p>
<p>Note that, because we did not know which columns of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e227" xlink:type="simple"/></inline-formula> correspond to which columns of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e228" xlink:type="simple"/></inline-formula>, we compared <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e229" xlink:type="simple"/></inline-formula> to every permutation of the columns of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e230" xlink:type="simple"/></inline-formula> and selected the permutation that resulted in the smallest genotype error. The selected permutation was then also used in the calculation of the clone frequency error.</p>
<p>Our simulation results (<xref ref-type="fig" rid="pcbi-1003703-g002">Figure 2</xref>) exhibit two primary trends. The overall error rate, as measured by either genotype or clone frequency error, decreases systematically as the number of subsections increases, and increases as the number of clones increases. Overall, both error rates are low, especially for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e231" xlink:type="simple"/></inline-formula>. The observed trends are expected: for a fixed number of clones, the availability of more subsections leads to more accurate estimation of the true parameter values; and for a fixed number of subsections, the presence of more clones leads to a greater number of parameters that must be inferred, leading to greater error in estimation.</p>
<fig id="pcbi-1003703-g002" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003703.g002</object-id><label>Figure 2</label><caption>
<title>Simulation results.</title>
<p>The figure plots the mean (A) genotype error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e232" xlink:type="simple"/></inline-formula> and (B) clone frequency error <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e233" xlink:type="simple"/></inline-formula> as a function of the number of subsections. Each mean is computed over 100 simulated data sets. For each data set, the EM optimization is repeated from 10 different random initializations, and the results corresponding to the largest log likelihood are reported.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003703.g002" position="float" xlink:type="simple"/></fig>
<p>To assess the affect of sequencing error on the performance of Clomial, we added noise to the simulated data and repeated the above experiments. Specifically, we modeled noise by Bernoulli random variables with probability of success interpreted as the probability that a non-tumor allele is read as a tumor allele or vica versa. Running the EM algorithm on the noisy data revealed that Clomial is robust with respect to noise for all reasonable levels of sequencing error (Figure S6) in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>.</p>
</sec><sec id="s2e">
<title>5 Application to a primary breast cancer</title>
<p>We obtained breast cancer tissue from a 44 year old premenopausal female with infiltrative ductal carcinoma (IDC) with ductal carcinoma in situ (DCIS), stage pT1c pN1, Grade II/III, estrogen receptor (ER) positive, progesterone receptor (PR) positive and Her2 negative. Axillary lymph node dissection revealed that one out of 13 nodes was positive for metastatic disease. A total of 6 tissue sections were obtained, including 2 sections from adjacent normal breast tissue, 3 from the primary breast cancer, and 1 from the positive lymph node. The tumor content, including both IDC and DCIS, ranged from 40% to 55% in the primary tumor and axillary lymph node tissue sections based on pathological examination. For subsequent analysis, each tissue section was subdivided into subsections (<xref ref-type="fig" rid="pcbi-1003703-g003">Figure 3</xref>).</p>
<fig id="pcbi-1003703-g003" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003703.g003</object-id><label>Figure 3</label><caption>
<title>Anatomic locations of the sections, and corresponding allele frequencies.</title>
<p>The figure shows (top) the anatomic locations of the three primary and one metastatic sections and (bottom) the corresponding alternative allele frequencies for each subsection. The full coordinates for each of the 17 loci are provided in <xref ref-type="supplementary-material" rid="pcbi.1003703.s002">Dataset S2</xref>.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003703.g003" position="float" xlink:type="simple"/></fig>
<p>To identify mutations and quantify allele frequencies, we performed two rounds of DNA sequencing. Initially, DNA was extracted from each individual subsection and subjected to exome capture followed by Illumina sequencing. Variants were detected independently in each subsection using the SeattleSeq Annotation Server. We focused on single nucleotide variants and short indels that exhibited a coverage of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e234" xlink:type="simple"/></inline-formula> reads in at least one of the subsections, ranking them using DeepSNV <xref ref-type="bibr" rid="pcbi.1003703-Gerstung1">[31]</xref> and Fisher's exact test (Methods). This analysis produced an initial set of 281 variants (<xref ref-type="supplementary-material" rid="pcbi.1003703.s001">Dataset S1</xref>).</p>
<p>To better quantify the allele frequencies at these loci, we designed primer pairs surrounding each locus and used these primers to perform a second round of targeted DNA sequencing. This experiment successfully sequenced 244 of the 281 loci, with a mean and median coverage of 1615 and 1118, respectively, reads per locus. Each of these loci was individually validated by visual inspection using the Integrative Genomics viewer (IGV). Manual inspection showed that many of the initially identified mutations were flanked by homopolymer repeats, suggesting that the alternate alleles were read calling errors, rather than true mutations <xref ref-type="bibr" rid="pcbi.1003703-Moore1">[32]</xref>. For all downstream analysis we focused on a set of 17 confirmed somatic variants. For clarity of presentation, we refer to each somatic variant by the chromosome where it resides, appending a letter if more than one somatic variant occurred within a chromosome (Table S1 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). The targeted sequencing thus produced two 17-by-12 matrices containing, respectively, the total coverage and the tumor allele count at each locus (Table S1 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). Visual inspection of the allele frequency profiles shows, not surprisingly, a markedly different pattern of allele frequencies among the subsections from primary and metastatic sites (<xref ref-type="fig" rid="pcbi-1003703-g003">Figure 3</xref>). In addition, several of the samples (e.g., P1-4 and P3-1) exhibit consistently lower frequencies across all loci, presumably indicating a higher prevalence of normal cells within these samples.</p>
<p>We applied our EM optimization procedure to the two counts matrices, varying the number of assumed clones from C = 3 up to C = 6. For each value of C, we ran EM 100,000 times from different random initializations, and we selected the solution with the highest likelihood (<xref ref-type="fig" rid="pcbi-1003703-g004">Figure 4</xref>). The resulting three-clone solution identifies two mutations, chr4a and chr9b, that occur in both the primary and metastatic samples and segregate the remaining mutations into nine that occurred in the primary tumor and six that occurred in the metastatic lymph node. The four- and five-clone solutions further subdivide the primary tumor mutations, and the six-clone solution separates the two metastatic mutations into distinct clones.</p>
<fig id="pcbi-1003703-g004" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003703.g004</object-id><label>Figure 4</label><caption>
<title>Inferred clonal genotypes and frequencies.</title>
<p>The top table lists, for each of the 17 loci, the inferred clonal genotypes using the EM procedure, assuming C = 3, 4, 5 and 6. In each case, the normal clone (C0) is omitted from the inferred matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e235" xlink:type="simple"/></inline-formula>, because its genotype consists entirely of zeroes by construction. For reference, each distinct genotype pattern per locus is assigned a unique color according to the scheme from <xref ref-type="fig" rid="pcbi-1003703-g006">Figure 6</xref>. In the table, bits with asterisks were flipped based on the phylogenetic analysis. The corresponding inferred clonal frequencies are listed in the bottom table, where each block shows a matrix <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e236" xlink:type="simple"/></inline-formula> for a value of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e237" xlink:type="simple"/></inline-formula>, and C0 denotes the normal clone.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003703.g004" position="float" xlink:type="simple"/></fig>
<p>To better understand the inferred clonal landscape, we investigated the relationship between clone frequencies and the anatomy of the three primary and one metastatic tumor sections. We hypothesized that clone frequencies should vary smoothly between adjacent subsections, reflecting the physical spread of successful clonal populations. This hypothesis is supported by the data (<xref ref-type="fig" rid="pcbi-1003703-g005">Figure 5</xref> and Figure S1 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). The trends are most striking in sections P1 and P2, for which we obtained four separate subsections. In each case, the primary clone frequencies vary in a monotonic fashion as we traverse the sample. Given that the EM inference procedure was provided with no information about which subsection was derived from which section, nor the relative orientation of the subsections to one another, the smoothly varying frequencies among adjacent subsections provides evidence that the method has successfully identified true clonal variation.</p>
<fig id="pcbi-1003703-g005" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003703.g005</object-id><label>Figure 5</label><caption>
<title>Clone frequencies vary smoothly across adjacent subsections.</title>
<p>The panels display the pattern of inferred clone frequencies across subsections (A) P1, (B) P2, (C) P3 and (D) M1. Each bar plot shows the relative frequencies of tumor clones in the corresponding subsection after accounting for normal contamination. Clones are numbered as in <xref ref-type="fig" rid="pcbi-1003703-g004">Figure 4</xref>, and the normal clone, C0, is not shown. This figure shows the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e238" xlink:type="simple"/></inline-formula> solution; Figure S1 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref> shows the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e239" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e240" xlink:type="simple"/></inline-formula> solutions.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003703.g005" position="float" xlink:type="simple"/></fig></sec><sec id="s2f">
<title>6 Tumor phylogeny</title>
<p>Cancer progression is an evolutionary process in which clones accrue mutations over time, forming new clones. Accordingly, it should be possible to organize the clonal progression of a tumor into a phylogenetic tree with the founder clone at the root. We therefore investigated whether the clones inferred by our EM procedure obey some simple phylogenetic constraints, with two complementary goals. First, because our EM procedure makes no use of phylogenetic constraints, this analysis can provide further evidence for the validity of our inferred solutions. Second, the phylogenetic analysis has the potential to provide significant insights into the clonal and mutational history of this specific cancer.</p>
<p>We started with the C = 3 solution to our EM algorithm, manually constructing a phylogenetic tree in which each node is a clonal population, and edges are marked with the mutations that occurred in the evolution from the parent clone to the offspring (<xref ref-type="fig" rid="pcbi-1003703-g006">Figure 6A</xref>). This particular tree shows two founder mutations, chr4a and chr9b, occurring prior to metastasis, six mutations occurring along the metastatic lineage, and nine along the primary lineage. This is the only phylogenetic tree that is consistent with the inferred clonal genotypes.</p>
<fig id="pcbi-1003703-g006" position="float"><object-id pub-id-type="doi">10.1371/journal.pcbi.1003703.g006</object-id><label>Figure 6</label><caption>
<title>Cancer phylogenies.</title>
<p>Each panel shows the inferred clonal phylogeny assuming (A) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e241" xlink:type="simple"/></inline-formula>, (B) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e242" xlink:type="simple"/></inline-formula>, (C) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e243" xlink:type="simple"/></inline-formula> and (D) <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e244" xlink:type="simple"/></inline-formula> clones, where C0 corresponds to the normal clone. Nodes correspond to inferred clonal populations, and edges are annotated with mutations that occur between the parent and child clones. Two mutations are grouped into a colored box if they both occur on the same branch in all four phylogenies.</p>
</caption><graphic mimetype="image" xlink:href="info:doi/10.1371/journal.pcbi.1003703.g006" position="float" xlink:type="simple"/></fig>
<p>In contrast, for the solutions inferred from the EM algorithm assuming C = 4 through 6, we found that it is not possible to construct a tree without requiring that the same mutation occur independently along multiple branches. We therefore considered all possible “nearby” trees (where “nearby” means that, among the distinct rows of the genotype matrix, the two trees differ by only one bit) that produce a valid phylogenetic tree with no repeated mutations. For example, for the C = 4 solution, we evaluated the likelihood of six nearby trees, yielding log-likelihoods of −28482, −21282, −7500, −6692, −5659, and −4333 (Table S2 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). The highest of these likelihoods is −4333, compared to −4244 for the solution initially inferred by EM. The selected solution requires changing only one bit in the genotype matrix from “0” to “1” (indicated by asterisks in <xref ref-type="fig" rid="pcbi-1003703-g004">Figure 4</xref>). The resulting phylogenetic tree (<xref ref-type="fig" rid="pcbi-1003703-g006">Figure 6B</xref>) closely resembles the C = 3 tree, except that one mutation initially assigned to the metastatic clone C3 is instead assigned to clone C2 in the C = 4 tree. Also, the nine mutations associated with the primary section in the C = 3 tree are further subdivided into three that occur shortly after metastasis and six that lead to clone C1. Reassuringly, the C = 5 and C = 6 solutions, constructed in a similar fashion (<xref ref-type="fig" rid="pcbi-1003703-g006">Figure 6C–D</xref>), are largely consistent with this story, each introducing a subdivision among the existing sets of mutations to produce a larger set of clones. Among these trees, the only inconsistencies concern (1) three mutations (chr5, chr9a and chr20b) that occur later according to the C = 4 solution than according to the C = 5 or C = 6 solutions and (2) two mutations (chr1 and chr4b) that are assigned their own branch, directly off the normal clone, in the C = 5 and C = 6 solutions. In practice, the chance that a randomly generated genotype matrix would produce a valid phylogenetic tree is vanishingly small (Note S3 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). Therefore, the fact that each of our inferred solutions very nearly produce a valid phylogenetic tree provides evidence for the validity of these solutions.</p>
<p>We also investigated the extent to which the observed mutation frequencies obey the phylogenetic tree. In principle, a mutation that occurs earlier in the evolution of the cancer should have a higher frequency than mutations that occur later along the same lineage because a child clone necessarily contains all of the mutations belonging to its parent clone. This investigation is hampered, however, by copy number variation. In practice, we cannot directly compare the allele frequencies of two distal sites because the observed allele frequencies are actually the product of mutation frequency and copy number. Empirically, we observe variation in copy number along the genome and differences in copy number variation from one subsection to the next (Figure S2 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). A consistent duplication of a large portion of chromosome 8 is known to occur commonly in breast cancer <xref ref-type="bibr" rid="pcbi.1003703-Curtis1">[33]</xref>. We were lucky, however, that two of our mutated loci occur quite close to one another on chromosome 9 (chr9a and chr9b, separated by only 3.3 Mbp). Given the observed data, the likelihood that a change in copy number occurring between these two loci is small, thereby allowing us to safely compare the corresponding mutation frequencies. Across all nine primary tumor subsections, we observe that the frequency of the parent mutation (chr9b) is higher than that of the child mutation (chr9a). Hence, these mutation frequencies are consistent with the inferred phylogeny.</p>
<p>To assess the stability of our inference, we performed leave-one-out analysis and compared the inferred phylogenies as follows. We held out each of the 12 tumor subsections one at a time and trained the model using the data from only 11 subsections for the case of C = 4. When samples p1-1 or p1-3 were excluded, the inferred genotypes were exactly the same as the genotype obtained from the full data. Excluding any of the other of 10 subsections resulted in a genotype which was different only in one bit; namely, the mutation chr4a was predicted to be present in all clones. However, this difference did not affect the inferred phylogeny because the change of this bit was in fact required to build a valid phylogenetic tree (<xref ref-type="fig" rid="pcbi-1003703-g004">Figure 4</xref>). In other words, by excluding any of the 12 tumor subsections, the inferred genotype always led to the same valid phylogenetic tree, which suggests that our algorithm is stable.</p>
</sec></sec><sec id="s3">
<title>Discussion</title>
<p>Once a tumor has been resected, clinicians pay a great deal of attention to characterizing its anatomy. Features such as necrosis, extension beyond normal anatomical boundaries, and microvascular invasion convey important prognostic information. In addition, the cancer cells within any given tumor are frequently heterogeneous with respect to features such as differentiation state, the fraction of cells undergoing mitosis (as determined by Ki67 staining), or (for breast cancer) the fraction of cells expressing HER-2 or estrogen receptor. The method described here provides a framework for linking a tumor's molecular anatomy to its structural anatomy as well as its phylogenetic evolution.</p>
<p>Several lines of evidence support the validity of the clonal genotypes and relative frequencies inferred by our model. One prediction from our phylogenetic reconstruction is that somatic variants at the trunk will be present at higher frequencies throughout all tumor subsections than variants appearing at the branches. While copy number variation across the somatic genome complicates these comparisons, one of two closely juxtaposed somatic variants (chr9b) is positioned at the trunk of our phylogenetic tree, while its neighbor (chr9a) arises in one of the branches. Consistent with this representation, the variant allele frequencies for chr9b are consistently higher than for chr9a in all ten tumor subsections examined.</p>
<p>Interestingly, phylogenies can be built from the inferred genotypes even given the relatively low purity of the tumor sections: contamination with normal tissue was <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e245" xlink:type="simple"/></inline-formula> in 9 out of 12 subsections in our data (<xref ref-type="fig" rid="pcbi-1003703-g004">Figure 4</xref>, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e246" xlink:type="simple"/></inline-formula>). In particular, although we estimate that the metastatic subsections contained <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e247" xlink:type="simple"/></inline-formula> tumor cells in M1-1 and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e248" xlink:type="simple"/></inline-formula> in M1-2, the corresponding branch of the phylogenies is stable and consistent.</p>
<p>Similar to phylogenetic analysis, reassembly of the tumor subsections indicates that our assignment of mutations to clones produces spatial representations that are anatomically reasonable. With further refinements, our method should enable reconstructions that layer a tumor's phylogeny on top of its spatial organization.</p>
<p>While our results underscore the potential power of this new method, our study also has several limitations. Our assessments were confined to heterozygous somatic variants, and did not take into account the many chromosomal structural changes that were present in the tumor we examined. A comparison of exome copy numbers between primary tumor and lymph node indicates that the vast majority of these chromosomal changes preceded the divergence shown in our phylogenetic tree (Figure S2 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). In theory, one could imagine generalizing our generative model to take copy number variations into account by replacing the 2 in the denominator of <xref ref-type="disp-formula" rid="pcbi.1003703.e058">Equation 2</xref> with a hidden random variable for each locus, but without some form of aggressive regularization, this formulation would lead to a prohibitively complex and overfit model.</p>
<p>Additionally, a key characteristic of our method is the requirement to specify the number of clones <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e249" xlink:type="simple"/></inline-formula> prior to the EM inference procedure. It is important to recognize that this choice should depend upon properties of the data set itself, rather than fundamental properties of the cancer. After all, each cell division results in multiple mutations, such that every cancer cell constitutes a distinct clone. Consequently, a picture of the full clonal history of a cancer would consist of a phylogenetic tree with one leaf for each cancer cell. In practice, such a tree would be of limited utility and, more importantly, could not be accurately estimated from any reasonably sized data set. Perhaps the most useful definition of a tumor clone is a population of cells that exhibit distinct spatial or functional properties. Our approach allows the user to specify the number of clones and, hence, the resolution at which the clonal history is viewed.</p>
<p>Because Clomial does not impose any assumption on the distribution of mutation frequencies, the number of inferred clones may not exceed the number of samples; otherwise, the resulting optimization problem will be under-constrained.</p>
<p>In the particular cancer studied here, the three-clone solution appears to provide an inaccurate view of the clonal history. The placement of the chr17c mutation along the path leading to metastatic clone C2 is surprising, given that this particular locus has such low counts for both metastatic subsections (2 counts for subsection M1-1 and 0 counts for M1-2, Table S1 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). This apparent anomaly can be explained by the small counts associated with chr17c in four out of the 10 primary tumor subsections (3 counts in P1-3, 4 in P1-4, and 21 in each of P2-1 and P2-2). Faced with the choice of what genotype profile to assign to this particular locus, the inference procedure selected a solution in which only two subsections, rather than four, are inconsistent. However, given the flexibility of a 4-clone model, the anomaly is resolved, and chr17c defines a novel clone C2 that occurs in the primary tumor samples and is completely absent from the metastatic samples.</p>
<p>In practice, it may be possible to estimate how many clones the data set can resolve using a method such as the Bayesian Information Criterion (BIC), with a smaller BIC value indicating a better fit to the data <xref ref-type="bibr" rid="pcbi.1003703-Schwarz1">[34]</xref>–<xref ref-type="bibr" rid="pcbi.1003703-Powers1">[36]</xref>. This approach has been used previously for estimating tumor clonal composition <xref ref-type="bibr" rid="pcbi.1003703-Oesper1">[37]</xref>, <xref ref-type="bibr" rid="pcbi.1003703-Chen1">[38]</xref>. BIC analysis of our model on simulated data suggests that, on average, the BIC accurately estimates the true number of clones, even in the presence of sequencing noise (Figure S3A–B in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>).</p>
<p>We also computed the BIC for models trained on our real breast cancer data (Figure S3C in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>) and observed a large decrease in BIC (45%) when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e250" xlink:type="simple"/></inline-formula> increases from 3 to 4, suggesting that the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e251" xlink:type="simple"/></inline-formula> model is too simple to describe the data. However, the subsequent improvements of the BIC are smaller: 29%, 20%, 9%, and 3% respectively, as <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e252" xlink:type="simple"/></inline-formula> grows from 4 to 8. In general, one should avoid increasing the complexity of the model when the BIC improvement is small because, in such situations, adding to the number of free parameters of the model can potentially lead to over-fitting <xref ref-type="bibr" rid="pcbi.1003703-Speed1">[39]</xref>–<xref ref-type="bibr" rid="pcbi.1003703-Lo1">[47]</xref>. Note that, as an alternative to a BIC approach, one could instead take an approach motivated by cross-validation, as has been explored in the context of matrix factorization models <xref ref-type="bibr" rid="pcbi.1003703-Wold1">[48]</xref>–<xref ref-type="bibr" rid="pcbi.1003703-Witten1">[50]</xref>.</p>
<p>Running the EM algorithm is very fast. In practice, using a 2.40 GHz processor with 2 GB memory, training a single EM instance on the real data set takes a few seconds up to several minutes, depending on the value of the hyperparameter <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e253" xlink:type="simple"/></inline-formula> (Figure S4 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). However, because the optimization problem in the M step is non-convex, many EM instances must be trained from different random initializations to avoid local optima.</p>
<p>We first noted that Clomial achieved good results on simulated data using only 10 random initializations when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e254" xlink:type="simple"/></inline-formula> (<xref ref-type="fig" rid="pcbi-1003703-g002">Figure 2</xref>). Then, to further assess the appropriate number of EM instances to run, we revisited the solutions from all of our 100,000 EM instances, counting how many instances are required to achieve the best observed model (Figure S5 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>). In practice, while 1000 EM instances is sufficient to find the optimum solution when <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e255" xlink:type="simple"/></inline-formula> or 3, a larger number of random initializations is required as the number of clones grows. This is an expected phenomenon because the complexity of the model grows significantly with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e256" xlink:type="simple"/></inline-formula>, resulting in an optimization surface with many more local optima. Consequently, despite the highly parallel nature of the computation, scaling up to analysis of larger data set with larger numbers of clones will likely require improved EM training strategies, such as noise injection or regularization.</p>
<p>Finally, although we used a simple phylogenetic tree construction procedure to evaluate the quality of our inferred clonal genotypes, the EM inference procedure described here does not explicitly model tumor evolution. Ultimately, we aim to produce a model that automatically infers not only clonal genotypes and clonal frequencies, but also the number of clones and the phylogenetic tree relating them.</p>
<p>Our method differs significantly from other approaches. A recent characterization of 21 breast cancers defined clones by clustering mutations with similar variant allele frequencies <xref ref-type="bibr" rid="pcbi.1003703-NikZainal1">[9]</xref>. The success of this strategy hinges on characterizing the frequencies of large numbers (hundreds or thousands) of somatic variants. In contrast, our method can reconstruct clonal phylogenies based on accurately measuring alleles of much smaller numbers of somatic variants. The view afforded by our method may provide novel insights into tumor biology. In particular, results from Nik-Zainal and colleagues <xref ref-type="bibr" rid="pcbi.1003703-NikZainal1">[9]</xref> were interpreted to indicate that cancers become clinically apparent only after one of the competing clones has achieved clonal dominance. In contrast to this “winner takes all” hypothesis, our model suggests that some cancers might be more accurately regarded as ecosystems, in which clones may be subject to spatial influences that affect their competitive fitness, or may even collaborate to support tumor growth.</p>
<p>An important difference between our method and many other methods based on clustering <xref ref-type="bibr" rid="pcbi.1003703-Welch1">[8]</xref>, <xref ref-type="bibr" rid="pcbi.1003703-NikZainal1">[9]</xref>, <xref ref-type="bibr" rid="pcbi.1003703-Shah2">[12]</xref> is our explicit probabilistic modeling of the random selection of normal and variant alleles during sequencing, according to a binomial distribution. By taking into account not just the relative frequency of the two alleles but the separate counts of normal and variant alleles, our model automatically assigns less importance to a locus with lower coverage, even if the locus yields the same variant allele frequency as a high-coverage locus.</p>
<p>While this manuscript was under review, two methods called PyClone <xref ref-type="bibr" rid="pcbi.1003703-Roth1">[13]</xref> and PhyloSub <xref ref-type="bibr" rid="pcbi.1003703-Jiao1">[51]</xref> were published, which do model allele counts using a binomial distribution. These methods attempt to simultaneously infer not only clonal genotypes and frequencies, as Clomial does, but also infer the number of clones and their phylogeny. Furthermore, PyClone and PhyloSub are not limited, as Clomial is, to situations in which the number of inferred clones is less than or equal to the number of available samples. How is this possible? To make these inferences feasible, these clustering methods must make certain distributional assumptions about the data. Specifically, PyClone assumes a Dirichlet Process prior for clone frequencies, where the base distribution is Uniform <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e257" xlink:type="simple"/></inline-formula> and the concentration parameter is Gamma distributed with shape and scale parameters equal to 1 and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e258" xlink:type="simple"/></inline-formula>, respectively. PhyloSub extends PyClone by using a tree-structured stick-breaking process <xref ref-type="bibr" rid="pcbi.1003703-Adams1">[52]</xref> to directly account for phylogenetic relationships during the inference. In principle, these assumptions enable PyClone and PhyloSub to infer information about a large number of clones from only a single sample. On the other hand, when multiple samples are available, Clomial can draw accurate inferences without requiring these distributional assumptions. In practice, our comparison showed that Clomial and PhyloSub produce similar results on three previously described chronic lymphocytic leukemia (CLL) cases <xref ref-type="bibr" rid="pcbi.1003703-Schuh1">[53]</xref> (Tables S3–S5 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>).</p>
<p>We note that if <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e259" xlink:type="simple"/></inline-formula> is the sequencing error rate at locus <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e260" xlink:type="simple"/></inline-formula>, then the probability of observing a variant allele at this locus in subsection <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e261" xlink:type="simple"/></inline-formula> is estimated by <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e262" xlink:type="simple"/></inline-formula>. In principle, sequencing noise could be incorporated into our model by replacing <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e263" xlink:type="simple"/></inline-formula>, defined in <xref ref-type="disp-formula" rid="pcbi.1003703.e058">Equation 2</xref>, with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e264" xlink:type="simple"/></inline-formula> in the likelihood and EM algorithm. However, given the robustness of the current method to noise (Figures S6 and S3C in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>), we opted to keep our model simple. In future applications, it may be beneficial to model noise in data produced by sequencing technologies that exhibit high error rates (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e265" xlink:type="simple"/></inline-formula>) such as PacBio RS <xref ref-type="bibr" rid="pcbi.1003703-Quail1">[54]</xref>.</p>
<p>The EM algorithm is not the only option for maximizing the log-likelihood for the observed data. In particular, one could instead treat both <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e266" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e267" xlink:type="simple"/></inline-formula> as optimization variables and seek to maximize <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e268" xlink:type="simple"/></inline-formula> with respect to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e269" xlink:type="simple"/></inline-formula> and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e270" xlink:type="simple"/></inline-formula>. This would amount to iteratively updating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e271" xlink:type="simple"/></inline-formula> and then updating <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e272" xlink:type="simple"/></inline-formula> until convergence, similar to the iterative algorithms typically used for matrix factorization models <xref ref-type="bibr" rid="pcbi.1003703-Rennie1">[23]</xref>–<xref ref-type="bibr" rid="pcbi.1003703-Engelhardt1">[25]</xref>, <xref ref-type="bibr" rid="pcbi.1003703-Witten1">[50]</xref>. However, this alternative approach would not have any computational advantage in terms of the update for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e273" xlink:type="simple"/></inline-formula>, which would still not have a closed-form solution, and would need to be solved using BFGS-B or an equivalent approach. Furthermore, the update for <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e274" xlink:type="simple"/></inline-formula> would be very complicated under the constraint that <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e275" xlink:type="simple"/></inline-formula> is a binary matrix. Therefore, we developed a customized inference algorithm based on EM.</p>
<p>Whereas genetic testing for cancer patients today focuses on mutations affecting a relatively small number of cancer-associated genes, most cancers are sustained by networks of aberrantly regulated genes that collaborate to promote tumor growth. The ability to assign mutations to clones, and to layer a tumor's clonal content on top of its structural anatomy in space and over time, can provide new insights into the mechanisms that enable cancers to invade, metastasize and escape treatment.</p>
</sec><sec id="s4" sec-type="materials|methods">
<title>Materials and Methods</title>
<sec id="s4a">
<title>Ethics statement</title>
<p>This research was reviewed and approved by the Cancer Consortium Institutional Review Board (IRB) located at the Fred Hutchinson Cancer Research Center (FHCRC). The FHCRC has an approved Federalwide Assurance on file with the Office for Human Research Protections (number 00001920). The Federalwide Assurance is a formal written, binding commitment that assures that the FHCRC promises to comply with the regulations and ethical guidelines governing research with human subjects, as stipulated by the U.S. Department of Health and Human Services under 45 CFR 46. Because this study involved the use of de-identified specimens obtained from an IRB-approved repository, we did not interface with patients. Patient consent was administered, in compliance with 45 CFR 46, by investigators who maintain the repository. Patients gave their consent for their specimens to be stored in the repository and subsequently used for research in cancer. The FHCRC IRB deemed that our research was in concordance with the purpose of the registry and the patient informed consent.</p>
</sec><sec id="s4b">
<title>Breast cancer tissue sample</title>
<p>We obtained breast cancer tissues from the Breast Cancer Biospecimen Repository of Fred Hutchinson Cancer Research Center after IRB approval. The patient was a 44 year old pre-menopausal woman diagnosed with infiltrative ductal carcinoma (IDC) and ductal carcinoma in situ (DCIS), stage pT1c pN1, Grade II/III, ER positive, PR positive and Her2 negative. Axillary lymph node dissection revealed that one out of 13 nodes was positive for metastatic disease. A total of 5 pieces were obtained from surgical samples including 1 tissue section from adjacent normal breast tissue (N1), 3 tissue sections from the primary breast cancer (P1, P2, P3), and 1 tissue section from the positive axillary lymph node (M1). Each section is about 1 cm by 1 cm by 0.5 cm. The tumor content, including both IDC and DCIS, ranges from 40% to 55% in the primary tumor and axillary lymph node tissue sections based on pathological examination (P1 55% IDC, P2 45% IDC, P3 40% IDC and 15% DCIS, M1 50% IDC).</p>
</sec><sec id="s4c">
<title>Tissue DNA extraction</title>
<p>Each individual section was subdivided into multiple subsections, and the anatomic locations of all the subsections were recorded (<xref ref-type="fig" rid="pcbi-1003703-g003">Figure 3</xref>). Using Qiagen AllPrep DNA/RNA Micro Kit, DNA was extracted from one normal subsection (N1-1), seven primary subsections (P1-2, P1-3, P1-5, P2-1, P2-3, P3-3, P3-4) and one metastatic subsection (M1-1). After quantification, all the DNA samples were subjected to exome capture followed by Illumina sequencing.</p>
</sec><sec id="s4d">
<title>Whole exome sequencing</title>
<p>Next generation sequencing was carried out at the Northwest Genome Center at University of Washington on the normal subsection, seven primary subsections, and one metastatic subsection. For each subsection, one microgram of genomic DNA was used to construct the random-shearing library per standard protocol with Covaris acoustic sonication. Libraries then underwent exome capture using the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e276" xlink:type="simple"/></inline-formula> Mb target from Roche/Nimblegen SeqCap EZ v2.0 (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e277" xlink:type="simple"/></inline-formula> exons and flanking sequence). Since each library was uniquely barcoded, samples were performed in multiplex. Massively parallel sequencing was carried out on the HiSeq sequencer.</p>
</sec><sec id="s4e">
<title>Read processing</title>
<p>Sequence reads were processed with a pipeline consisting of the following elements: (1) base calls generated in real-time on the HiSeq instrument (RTA 1.12.4.2); (2) Perl scripts developed in-house to produce demultiplexed fastq files by lane and index sequence; (3) demultiplexed BAM files aligned to a human reference (hg19) using BWA (Burrows-Wheeler Aligner; v0.5.9) <xref ref-type="bibr" rid="pcbi.1003703-Li1">[55]</xref>. Read-pairs not mapping within <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e278" xlink:type="simple"/></inline-formula> standard deviations of the average library size (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e279" xlink:type="simple"/></inline-formula> bp for exomes) are removed. All aligned read data were subjected to the following steps: (1) “duplicate removal” was performed, (i.e., the removal of reads with duplicate start positions; Picard MarkDuplicates; v1.14); (2) indel realignment was performed (GATK IndelRealigner; v1.0-6125) resulting in improved base placement and lower false variant calls; (3) base qualities were recalibrated (GATK TableRecalibration; v1.0-6125). All sequence data then underwent a previously described quality control protocol <xref ref-type="bibr" rid="pcbi.1003703-Tennessen1">[56]</xref>.</p>
</sec><sec id="s4f">
<title>Variant detection</title>
<p>Variant detection and genotyping were performed using the UnifiedGenotyper tool from GATK (v1.0-6125). Variant data for each sample were formatted (variant call format) as “raw” calls that contain individual genotype data for one or multiple samples, and flagged using the filtration walker (GATK) to mark sites that are of lower quality/false positives, e.g., low quality scores (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e280" xlink:type="simple"/></inline-formula>), allelic imbalance (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e281" xlink:type="simple"/></inline-formula>), long homopolymer runs (<inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e282" xlink:type="simple"/></inline-formula>) and/or low quality by depth (QD <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e283" xlink:type="simple"/></inline-formula>).</p>
</sec><sec id="s4g">
<title>Calling single nucleotide variants (SNVs) and indels</title>
<p>Most of the commonly used software for calling SNVs and indels, including SNVMix <xref ref-type="bibr" rid="pcbi.1003703-Goya1">[57]</xref> and VarScan <xref ref-type="bibr" rid="pcbi.1003703-Koboldt1">[58]</xref>, requires tumor content <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e284" xlink:type="simple"/></inline-formula>. To allow identification of low frequency alleles that occur in only one or a few subsections, we did not pool all of the data together. Instead, we designed a method that is appropriate for multiple samples from one patient, with relatively low tumor content, ranging from 45% to 55%. At each chromosomal position (locus), we considered six mutually exclusive possible outcomes: A, C, G, T, deletion, and unknown. The counts of these six outcomes at each locus between normal and each of the multiple tumor subsections were compared with a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e285" xlink:type="simple"/></inline-formula> Fisher's exact test. To correct for multiple testing, we used the <bold>qvalue</bold> R package to convert <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e286" xlink:type="simple"/></inline-formula> to <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e287" xlink:type="simple"/></inline-formula>. Only those chromosomal loci with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e288" xlink:type="simple"/></inline-formula> in at least one comparison between normal and tumor samples were accepted for downstream analysis. This analysis identified 6310 loci.</p>
<p>For each accepted locus, we used a heuristic procedure to identify which of the six alleles differed between the tumor and normal sample. For each subsection, we carried out six <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e289" xlink:type="simple"/></inline-formula> Fisher's exact tests, one for each of the six possible alleles. Thus, each such test compared one allele's counts to the sum of the counts for the other five alleles. Using a p-value threshold of 0.01, an allele was declared to be increased, decreased, or unchanged in the tumor subsection as compared to the normal sample. The changes that were classified as “increased” and had a normal count of zero were called tumor-specific mutations. This procedure identified a total of 268 such tumor-specific mutations, with a mean and median sequencing depth of 92 and 75, respectively. Corresponding annotations were obtained from SeattleSeq (<ext-link ext-link-type="uri" xlink:href="http://snp.gs.washington.edu/SeattleSeqAnnotation137" xlink:type="simple">http://snp.gs.washington.edu/SeattleSeqAnnotation137</ext-link>).</p>
<p>In parallel, we also analyzed our data using deepSNV <xref ref-type="bibr" rid="pcbi.1003703-Gerstung1">[31]</xref> by comparing the normal subsection to the 8 tumor subsections. We ran deepSNV on the loci with total coverage across all samples more than 50, which resulted in the identification of 29 loci with <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e290" xlink:type="simple"/></inline-formula>. The union of the two lists yielded 281 loci for further validation (<xref ref-type="supplementary-material" rid="pcbi.1003703.s001">Dataset S1</xref>).</p>
</sec><sec id="s4h">
<title>Targeted deep sequencing</title>
<p>Mutations were validated by targeted deep sequencing of DNA derived from one normal subsection (N1-1), 10 primary subsections (P1-1, P1-2, P1-3, P1-4, P2-1, P2-2, P2-3, P2-4, P3-1, P3-2) and two metastatic subsections (M1-1 and M1-2). The subsections were selected to have low normal content and to span the tumor anatomy. Genomic DNA was prepared as described for the initial exome sequencing. A HaloPlex probe capture library for selective capture of 281 target loci was generated with SureDesign (Agilent Technologies). Target enrichment for deep sequencing was carried out with the HaloPlexTM Target Enrichment System from Agilent Technologies following the manufacturer's protocol. Triplicate enrichments were performed for each sample. Target-enriched samples were sequenced using a MiSeq (Illumina). Of the 281 target loci, 244 were successfully sequenced with coverage more than 100 reads for the normal sample. The mean, median, and the standard deviation of the coverage were 1615, 1118, and 1600, respectively (<xref ref-type="supplementary-material" rid="pcbi.1003703.s002">Dataset S2</xref>).</p>
<p>All 244 loci were visualized using the Integrative Genomics Viewer <xref ref-type="bibr" rid="pcbi.1003703-Thorvaldsdttir1">[59]</xref>, <xref ref-type="bibr" rid="pcbi.1003703-Robinson1">[60]</xref>. A set of 17 loci were selected based upon three criteria: (1) at least 3 reads cover the locus in the normal sample, (2) the variant allele is not present in the normal tissue (allowing for a few variant counts, which may reflect sequencing error) and (3) there are no nearby clustered mutations, indicative of sequencing or mapping error. Independently, the data were also analyzed using deepSNV. Applying a <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e291" xlink:type="simple"/></inline-formula> threshold of <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e292" xlink:type="simple"/></inline-formula> yielded 19 loci, including all 17 of the initially selected loci. The 17 loci were retained for downstream analysis (Table S1 in <xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref>).</p>
</sec><sec id="s4i">
<title>Bayesian Information Criterion analysis</title>
<p>We computed BIC using the following formula:<disp-formula id="pcbi.1003703.e293"><graphic position="anchor" xlink:href="info:doi/10.1371/journal.pcbi.1003703.e293" xlink:type="simple"/><label>(14)</label></disp-formula>where <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e294" xlink:type="simple"/></inline-formula> is the expectation of the complete-data log likelihood, which is maximized in the last M step (see <xref ref-type="disp-formula" rid="pcbi.1003703.e113">Equations 7</xref> and <xref ref-type="disp-formula" rid="pcbi.1003703.e184">13</xref>). Also, <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e295" xlink:type="simple"/></inline-formula> represents the total number of free parameters, and <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e296" xlink:type="simple"/></inline-formula> is the total number of counts.</p>
</sec></sec><sec id="s5">
<title>Supporting Information</title>
<supplementary-material id="pcbi.1003703.s001" mimetype="application/vnd.ms-excel" xlink:href="info:doi/10.1371/journal.pcbi.1003703.s001" position="float" xlink:type="simple"><label>Dataset S1</label><caption>
<p>Dataset S1 includes, for each of the 281 targeted loci, the following information: (1) the chromosomal coordinates of the locus, (2) the variant allele, (3) for the 268 targeted loci identified by Fisher's exact test, the number of reads supporting the mutation and the coverage of the locus in each subsection, (4) the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e297" xlink:type="simple"/></inline-formula> from the <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e298" xlink:type="simple"/></inline-formula> Fisher's exact test, (5) the minimum <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e299" xlink:type="simple"/></inline-formula> from the six <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e300" xlink:type="simple"/></inline-formula> Fisher's exact tests, and (6) the q-value for each of the 29 target regions identified by deepSNV.</p>
<p>(XLS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003703.s002" mimetype="application/vnd.ms-excel" xlink:href="info:doi/10.1371/journal.pcbi.1003703.s002" position="float" xlink:type="simple"><label>Dataset S2</label><caption>
<p>Dataset S2 lists, for each of the 281 sequenced target regions, the following information: (1) the chromosomal coordinates of the locus, (2) the integer counts for each of the five possible alleles (A, C, G, T, -, where “-” denotes deletion or insertion) in each of the ten primary subsections, two metastatic subsections, and the normal subsection, (3) for each subsection, the deepSNV <inline-formula><inline-graphic xlink:href="info:doi/10.1371/journal.pcbi.1003703.e301" xlink:type="simple"/></inline-formula> for the test that the subsection has a mutation on each specific locus, and (4) the mnemonic for each of the 17 mutations used in our inference procedure.</p>
<p>(XLS)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003703.s003" mimetype="application/x-gzip" xlink:href="info:doi/10.1371/journal.pcbi.1003703.s003" position="float" xlink:type="simple"><label>Software S1</label><caption>
<p>Software S1 is an R package called <italic>Clomality</italic> that implements the EM algorithm described in this paper.</p>
<p>(GZ)</p>
</caption></supplementary-material><supplementary-material id="pcbi.1003703.s004" mimetype="application/pdf" xlink:href="info:doi/10.1371/journal.pcbi.1003703.s004" position="float" xlink:type="simple"><label>Text S1</label><caption>
<p><xref ref-type="supplementary-material" rid="pcbi.1003703.s004">Text S1</xref> includes five supplementary notes, six supplementary figures and five supplementary tables.</p>
<p>(PDF)</p>
</caption></supplementary-material></sec></body>
<back>
<ack>
<p>The authors would like to thank Peggy Porter and Barbara Stein for providing access to the breast cancer specimen through Northwest BioTrust.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="pcbi.1003703-Irish1"><label>1</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Irish</surname><given-names>JM</given-names></name>, <name name-style="western"><surname>Hovland</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Krutzik</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Perez</surname><given-names>OD</given-names></name>, <name name-style="western"><surname>Bruserud</surname><given-names>O</given-names></name>, <etal>et al</etal>. (<year>2004</year>) <article-title>Single cell profiling of potentiated phospho-protein networks in cancer cells</article-title>. <source>Cell</source> <volume>118</volume>: <fpage>217</fpage>–<lpage>228</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Navin1"><label>2</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Krasnitz</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Rodgers</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Cook</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Meth</surname><given-names>J</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Inferring tumor progression from genomic heterogeneity</article-title>. <source>Genome research</source> <volume>20</volume>: <fpage>68</fpage>–<lpage>80</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Xu1"><label>3</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Xu</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Yong</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Yin</surname><given-names>X</given-names></name>, <name name-style="western"><surname>Bao</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Tang</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Single-cell exome sequencing reveals single-nucleotide mutation characteristics of a kidney tumor</article-title>. <source>Cell</source> <volume>148</volume>: <fpage>886</fpage>–<lpage>895</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Hou1"><label>4</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Hou</surname><given-names>Y</given-names></name>, <name name-style="western"><surname>Song</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Zhu</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Zhang</surname><given-names>B</given-names></name>, <name name-style="western"><surname>Tao</surname><given-names>Y</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Single-cell exome sequencing and monoclonal evolution of a <italic>JAK2</italic>-negative myeloproliferative neoplasm</article-title>. <source>Cell</source> <volume>148</volume>: <fpage>873</fpage>–<lpage>885</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Navin2"><label>5</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Navin</surname><given-names>N</given-names></name>, <name name-style="western"><surname>Kendall</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Troge</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Andrews</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Rodgers</surname><given-names>L</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Tumour evolution inferred by single-cell sequencing</article-title>. <source>Nature</source> <volume>472</volume>: <fpage>90</fpage>–<lpage>94</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Potter1"><label>6</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Potter</surname><given-names>NE</given-names></name>, <name name-style="western"><surname>Ermini</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Papaemmanuil</surname><given-names>E</given-names></name>, <name name-style="western"><surname>Cazzaniga</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Vijayaraghavan</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Single cell mutational profiling and clonal phylogeny in cancer</article-title>. <source>Genome research</source> <volume>23</volume>: <fpage>2115</fpage>–<lpage>25</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.159913.113" xlink:type="simple">10.1101/gr.159913.113</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003703-Shah1"><label>7</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shah</surname><given-names>SP</given-names></name>, <name name-style="western"><surname>Morin</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Khattra</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Prentice</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Pugh</surname><given-names>T</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>Mutational evolution in a lobular breast tumour profiled at single nucleotide resolution</article-title>. <source>Nature</source> <volume>461</volume>: <fpage>809</fpage>–<lpage>813</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Welch1"><label>8</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Welch</surname><given-names>JS</given-names></name>, <name name-style="western"><surname>Ley</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Link</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Larson</surname><given-names>DE</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The origin and evolution of mutations in acute myeloid leukemia</article-title>. <source>Cell</source> <volume>150</volume>: <fpage>264</fpage>–<lpage>278</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-NikZainal1"><label>9</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Nik-Zainal</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Alexandrov</surname><given-names>LB</given-names></name>, <name name-style="western"><surname>Wedge</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>Van</surname><given-names>LP</given-names></name>, <name name-style="western"><surname>Greenman</surname><given-names>CD</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Mutational processes molding the genomes of 21 breast cancers</article-title>. <source>Cell</source> <volume>149</volume>: <fpage>979</fpage>–<lpage>993</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Ding1"><label>10</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ding</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ellis</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Li</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Larson</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Chen</surname><given-names>K</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Genome remodelling in a basal-like breast cancer metastasis and xenograft</article-title>. <source>Nature</source> <volume>464</volume>: <fpage>999</fpage>–<lpage>1005</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Bashashati1"><label>11</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Bashashati</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ha</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Tone</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ding</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Prentice</surname><given-names>LM</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Distinct evolutionary trajectories of primary high-grade serous ovarian cancers revealed through spatial mutational profiling</article-title>. <source>The Journal of pathology</source> <volume>231</volume>: <fpage>21</fpage>–<lpage>34</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Shah2"><label>12</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Shah</surname><given-names>SP</given-names></name>, <name name-style="western"><surname>Roth</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Goya</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Oloumi</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Ha</surname><given-names>G</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The clonal and mutational evolution spectrum of primary triple-negative breast cancers</article-title>. <source>Nature</source> <volume>486</volume>: <fpage>395</fpage>–<lpage>399</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Roth1"><label>13</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Roth</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Khattra</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Yap</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Wan</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Laks</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2014</year>) <article-title>Pyclone: statistical inference of clonal population structure in cancer</article-title>. <source>Nature methods</source> <volume>11</volume>: <fpage>396</fpage>–<lpage>8</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/nmeth.2883" xlink:type="simple">10.1038/nmeth.2883</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003703-Ding2"><label>14</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Ding</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Ley</surname><given-names>TJ</given-names></name>, <name name-style="western"><surname>Larson</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Miller</surname><given-names>CA</given-names></name>, <name name-style="western"><surname>Koboldt</surname><given-names>DC</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Clonal evolution in relapsed acute myeloid leukaemia revealed by whole-genome sequencing</article-title>. <source>Nature</source> <volume>481</volume>: <fpage>506</fpage>–<lpage>510</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Walter1"><label>15</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Walter</surname><given-names>MJ</given-names></name>, <name name-style="western"><surname>Shen</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Ding</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Shao</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Koboldt</surname><given-names>DC</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Clonal architecture of secondary acute myeloid leukemia</article-title>. <source>New England Journal of Medicine</source> <volume>366</volume>: <fpage>1090</fpage>–<lpage>1098</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Newburger1"><label>16</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Newburger</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>Kashef-Haghighi</surname><given-names>D</given-names></name>, <name name-style="western"><surname>Weng</surname><given-names>Z</given-names></name>, <name name-style="western"><surname>Salari</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sweeney</surname><given-names>RT</given-names></name>, <etal>et al</etal>. (<year>2013</year>) <article-title>Genome evolution during progression to breast cancer</article-title>. <source>Genome research</source> <volume>23</volume>: <fpage>1097</fpage>–<lpage>108</lpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1101/gr.151670.112" xlink:type="simple">10.1101/gr.151670.112</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003703-Yachida1"><label>17</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Yachida</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Jones</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Bozic</surname><given-names>I</given-names></name>, <name name-style="western"><surname>Antal</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Leary</surname><given-names>R</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Distant metastasis occurs late during the genetic evolution of pancreatic cancer</article-title>. <source>Nature</source> <volume>467</volume>: <fpage>1114</fpage>–<lpage>1117</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Gerlinger1"><label>18</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerlinger</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Rowan</surname><given-names>AJ</given-names></name>, <name name-style="western"><surname>Horswell</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Larkin</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Endesfelder</surname><given-names>D</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Intratumor heterogeneity and branched evolution revealed by multiregion sequencing</article-title>. <source>New England Journal of Medicine</source> <volume>366</volume>: <fpage>883</fpage>–<lpage>892</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Strino1"><label>19</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Strino</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Parisi</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Micsinai</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Kluger</surname><given-names>Y</given-names></name> (<year>2013</year>) <article-title>TrAp: a tree approach for fingerprinting subclonal tumor composition</article-title>. <source>Nucleic Acids Research</source> <volume>41</volume>: <fpage>e165</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Dempster1"><label>20</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Dempster</surname><given-names>AP</given-names></name>, <name name-style="western"><surname>Laird</surname><given-names>NM</given-names></name>, <name name-style="western"><surname>Rubin</surname><given-names>DB</given-names></name> (<year>1977</year>) <article-title>Maximum likelihood from incomplete data via the EM algorithm</article-title>. <source>Journal of the Royal Statistical Society Series B (Methodological)</source> <volume>39</volume>: <fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Carter1"><label>21</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Carter</surname><given-names>SL</given-names></name>, <name name-style="western"><surname>Cibulskis</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Helman</surname><given-names>E</given-names></name>, <name name-style="western"><surname>McKenna</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Shen</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Absolute quantification of somatic dna alterations in human cancer</article-title>. <source>Nature biotechnology</source> <volume>30</volume>: <fpage>413</fpage>–<lpage>421</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Mwenifumbo1"><label>22</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Mwenifumbo</surname><given-names>JC</given-names></name>, <name name-style="western"><surname>Marra</surname><given-names>MA</given-names></name> (<year>2013</year>) <article-title>Cancer genome-sequencing study design</article-title>. <source>Nature Reviews Genetics</source> <volume>14</volume>: <fpage>321</fpage>–<lpage>332</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Rennie1"><label>23</label>
<mixed-citation publication-type="book" xlink:type="simple">Rennie JDM, Srebro N (2005) Fast maximum margin matrix factorization for collaborative prediction. In: Proceedings of the 22nd international conference on Machine learning. ACM, pp. 713–719.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Wu1"><label>24</label>
<mixed-citation publication-type="book" xlink:type="simple">Wu J (2009) Binomial matrix factorization for discrete collaborative filtering. In: Data Mining, 2009. ICDM'09. Ninth IEEE International Conference on. IEEE, pp. 1046–1051.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Engelhardt1"><label>25</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Engelhardt</surname><given-names>BE</given-names></name>, <name name-style="western"><surname>Stephens</surname><given-names>M</given-names></name> (<year>2010</year>) <article-title>Analysis of population structure: a unifying framework and novel methods based on sparse factor analysis</article-title>. <source>PLoS genetics</source> <volume>6</volume>: <fpage>e1001117</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Bishop1"><label>26</label>
<mixed-citation publication-type="book" xlink:type="simple">Bishop C (2006) Pattern Recognition and Machine Learning. New York, NY, USA: Springer Science+Business Media, LLC.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Fletcher1"><label>27</label>
<mixed-citation publication-type="book" xlink:type="simple">Fletcher R (1981) Practical methods of optimization: Vol. 2: Constrained optimization. Wiley.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Dennis1"><label>28</label>
<mixed-citation publication-type="book" xlink:type="simple">Dennis JE, Schnabel RB (1987) Numerical Methods for Unconstrained Optimization and Nonlinear Equations, volume 16. Society for Industrial Mathematics.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Sun1"><label>29</label>
<mixed-citation publication-type="book" xlink:type="simple">Sun W, Yuan Y (2006) Optimization Theory and Methods: Nonlinear Programming, volume 1. Springer.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Wriggers1"><label>30</label>
<mixed-citation publication-type="book" xlink:type="simple">Wriggers P (2008) Nonlinear Finite Element Methods. Springer.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Gerstung1"><label>31</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Gerstung</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Beisel</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Rechsteiner</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Wild</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Schraml</surname><given-names>P</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Reliable detection of subclonal single-nucleotide variants in tumor cell populations</article-title>. <source>Nature Communications</source> <volume>3</volume>: <fpage>811</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Moore1"><label>32</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Moore</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Dhingra</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Soltis</surname><given-names>P</given-names></name>, <name name-style="western"><surname>Shaw</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Farmerie</surname><given-names>W</given-names></name>, <etal>et al</etal>. (<year>2006</year>) <article-title>Rapid and accurate pyrosequencing of angiosperm plastid genomes</article-title>. <source>BMC Plant Biology</source> <volume>6</volume>: <fpage>17</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Curtis1"><label>33</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Curtis</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Shah</surname><given-names>SP</given-names></name>, <name name-style="western"><surname>CHin</surname><given-names>SF</given-names></name>, <name name-style="western"><surname>Turashvili</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Rueda</surname><given-names>OM</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>The genomic and transcriptomic architecture of 2,000 breast tumours reveals novel subgroups</article-title>. <source>Nature</source> <volume>486</volume>: <fpage>346</fpage>–<lpage>352</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Schwarz1"><label>34</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schwarz</surname><given-names>G</given-names></name> (<year>1978</year>) <article-title>Estimating the dimension of a model</article-title>. <source>Annals of Statistics</source> <volume>6</volume>: <fpage>461</fpage>–<lpage>464</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Watkins1"><label>35</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Watkins</surname><given-names>LP</given-names></name>, <name name-style="western"><surname>Yang</surname><given-names>H</given-names></name> (<year>2005</year>) <article-title>Detection of intensity change points in time-resolved single-molecule measurements</article-title>. <source>The Journal of Physical Chemistry B</source> <volume>109</volume>: <fpage>617</fpage>–<lpage>628</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Powers1"><label>36</label>
<mixed-citation publication-type="book" xlink:type="simple">Powers DA, Xie Y (2008) Statistical methods for categorical data analysis. Emerald Group Publishing.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Oesper1"><label>37</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Oesper</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Mahmoody</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Raphael</surname><given-names>BJ</given-names></name> (<year>2013</year>) <article-title>Theta: inferring intra-tumor heterogeneity from high-throughput dna sequencing data</article-title>. <source>Genome biology</source> <volume>14</volume>: <fpage>R80</fpage>–<lpage>R80</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Chen1"><label>38</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Chen</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Gunel</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Zhao</surname><given-names>H</given-names></name> (<year>2013</year>) <article-title>Somatica: identifying, characterizing and quantifying somatic copy number aberrations from cancer genome sequencing data</article-title>. <source>PloS one</source> <volume>8</volume>: <fpage>e78143</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Speed1"><label>39</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Speed</surname><given-names>TP</given-names></name>, <name name-style="western"><surname>Yu</surname><given-names>B</given-names></name> (<year>1993</year>) <article-title>Model selection and prediction: normal regression</article-title>. <source>Annals of the institute of statistical mathematics</source> <volume>45</volume>: <fpage>35</fpage>–<lpage>54</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Shibata1"><label>40</label>
<mixed-citation publication-type="book" xlink:type="simple">Shibata R (1989) Statistical aspects of model selection. Springer.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Fraley1"><label>41</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Fraley</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Raftery</surname><given-names>AE</given-names></name> (<year>2002</year>) <article-title>Model-based clustering, discriminant analysis, and density estimation</article-title>. <source>Journal of the American Statistical Association</source> <volume>97</volume>: <fpage>611</fpage>–<lpage>631</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Zhao1"><label>42</label>
<mixed-citation publication-type="book" xlink:type="simple">Zhao Q, Xu M, Franti P (2008) Knee point detection on bayesian information criterion. In: Tools with Artificial Intelligence, 2008. ICTAI'08. 20th IEEE International Conference on. IEEE, volume 2, pp. 431–438.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Zhao2"><label>43</label>
<mixed-citation publication-type="book" xlink:type="simple">Zhao Q, Hautamaki V, Fränti P (2008) Knee point detection in bic for detecting the number of clusters. In: Advanced Concepts for Intelligent Vision Systems. Springer, pp. 664–673.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Satopaa1"><label>44</label>
<mixed-citation publication-type="book" xlink:type="simple">Satopaa V, Albrecht J, Irwin D, Raghavan B (2011) Finding a “kneedle” in a haystack: Detecting knee points in system behavior. In: Distributed Computing Systems Workshops (ICDCSW), 2011 31st International Conference on. IEEE, pp. 166–171.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Zang1"><label>45</label>
<mixed-citation publication-type="book" xlink:type="simple">Zang C, Chen B (2010) Automatic estimation the number of clusters in hierarchical data clustering. In: Mechatronics and Embedded Systems and Applications (MESA), 2010 IEEE/ASME International Conference on. IEEE, pp. 269–274.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Singh1"><label>46</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Singh</surname><given-names>DK</given-names></name>, <name name-style="western"><surname>Ku</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Wichaidit</surname><given-names>C</given-names></name>, <name name-style="western"><surname>Steininger</surname><given-names>RJ</given-names></name>, <name name-style="western"><surname>Wu</surname><given-names>LF</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>Patterns of basal signaling heterogeneity can distinguish cellular populations with different drug sensitivities</article-title>. <source>Molecular systems biology</source> <volume>6</volume>: <fpage>369</fpage> <comment>doi: <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1038/msb.2010.22" xlink:type="simple">10.1038/msb.2010.22</ext-link></comment></mixed-citation>
</ref>
<ref id="pcbi.1003703-Lo1"><label>47</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Lo</surname><given-names>K</given-names></name>, <name name-style="western"><surname>Hahne</surname><given-names>F</given-names></name>, <name name-style="western"><surname>Brinkman</surname><given-names>RRR</given-names></name>, <name name-style="western"><surname>Gottardo</surname><given-names>RG</given-names></name> (<year>2009</year>) <article-title>flowclust: a bioconductor package for automated gating of flow cytometry data</article-title>. <source>BMC Bioinformatics</source> <volume>10</volume>: <fpage>145</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Wold1"><label>48</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Wold</surname><given-names>V</given-names></name> (<year>1978</year>) <article-title>Cross-validatory estimation of the number of components in factor and principal components models</article-title>. <source>Technometrics</source> <volume>20</volume>: <fpage>397</fpage>–<lpage>405</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Owen1"><label>49</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Owen</surname><given-names>AB</given-names></name>, <name name-style="western"><surname>Perry</surname><given-names>PO</given-names></name> (<year>2009</year>) <article-title>Bi-cross-validation of the svd and the nonnegative matrix factorization</article-title>. <source>The Annals of Applied Statistics</source> <fpage>564</fpage>–<lpage>594</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Witten1"><label>50</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Witten</surname><given-names>DM</given-names></name>, <name name-style="western"><surname>Tibshirani</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Hastie</surname><given-names>T</given-names></name> (<year>2009</year>) <article-title>A penalized matrix decomposition, with applications to sparse principal components and canonical correlation analysis</article-title>. <source>Biostatistics</source> <volume>10</volume>: <fpage>515</fpage>–<lpage>534</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Jiao1"><label>51</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Jiao</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Vembu</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Deshwar</surname><given-names>AG</given-names></name>, <name name-style="western"><surname>Stein</surname><given-names>L</given-names></name>, <name name-style="western"><surname>Morris</surname><given-names>Q</given-names></name> (<year>2014</year>) <article-title>Inferring clonal evolution of tumors from single nucleotide somatic mutations</article-title>. <source>BMC Bioinformatics</source> <volume>15</volume>: <fpage>35</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Adams1"><label>52</label>
<mixed-citation publication-type="book" xlink:type="simple">Adams RP, Ghahramani Z, Jordan MI (2010) Tree-structured stick breaking for hierarchical data. In: NIPS. pp. 19–27.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Schuh1"><label>53</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Schuh</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Becq</surname><given-names>J</given-names></name>, <name name-style="western"><surname>Humphray</surname><given-names>S</given-names></name>, <name name-style="western"><surname>Alexa</surname><given-names>A</given-names></name>, <name name-style="western"><surname>Burns</surname><given-names>A</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Monitoring chronic lymphocytic leukemia progression by whole genome sequencing reveals heterogeneous clonal evolution patterns</article-title>. <source>Blood</source> <volume>120</volume>: <fpage>4191</fpage>–<lpage>4196</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Quail1"><label>54</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Quail</surname><given-names>MA</given-names></name>, <name name-style="western"><surname>Smith</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Coupland</surname><given-names>P</given-names></name>, <name name-style="western"><surname>T D Otto</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Harris</surname><given-names>SR</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>A tale of three next generation sequencing platforms: comparison of ion torrent, pacific biosciences and illumina miseq sequencers</article-title>. <source>BMC genomics</source> <volume>13</volume>: <fpage>341</fpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Li1"><label>55</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Li</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Durbin</surname><given-names>R</given-names></name> (<year>2010</year>) <article-title>Fast and accurate long-read alignment with Burrows–Wheeler transform</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>589</fpage>–<lpage>595</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Tennessen1"><label>56</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Tennessen</surname><given-names>JA</given-names></name>, <name name-style="western"><surname>Bigham</surname><given-names>AW</given-names></name>, <name name-style="western"><surname>OConnor</surname><given-names>TD</given-names></name>, <name name-style="western"><surname>Fu</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Kenny</surname><given-names>E</given-names></name>, <etal>et al</etal>. (<year>2012</year>) <article-title>Evolution and functional impact of rare coding variation from deep sequencing of human exomes</article-title>. <source>Science</source> <volume>337</volume>: <fpage>64</fpage>–<lpage>69</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Goya1"><label>57</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Goya</surname><given-names>R</given-names></name>, <name name-style="western"><surname>Sun</surname><given-names>MG</given-names></name>, <name name-style="western"><surname>Morin</surname><given-names>RD</given-names></name>, <name name-style="western"><surname>Leung</surname><given-names>G</given-names></name>, <name name-style="western"><surname>Ha</surname><given-names>H</given-names></name>, <etal>et al</etal>. (<year>2010</year>) <article-title>SNVMix: Predicting single nucleotide variants from next-generation sequencing of tumors</article-title>. <source>Bioinformatics</source> <volume>26</volume>: <fpage>730</fpage>–<lpage>736</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Koboldt1"><label>58</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Koboldt</surname><given-names>DC</given-names></name>, <name name-style="western"><surname>K</surname><given-names>KC</given-names></name>, <name name-style="western"><surname>Wylie</surname><given-names>T</given-names></name>, <name name-style="western"><surname>Larson</surname><given-names>DE</given-names></name>, <name name-style="western"><surname>McLellan</surname><given-names>MD</given-names></name>, <etal>et al</etal>. (<year>2009</year>) <article-title>VarScan: variant detection in massively parallel sequencing of individual and pooled samples</article-title>. <source>Bioinformatics</source> <volume>25</volume>: <fpage>2283</fpage>–<lpage>2285</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Thorvaldsdttir1"><label>59</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Thorvaldsdóttir</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Robinson</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Mesirov</surname><given-names>JP</given-names></name> (<year>2013</year>) <article-title>Integrative Genomics Viewer (IGV): high-performance genomics data visualization and exploration</article-title>. <source>Briefings in bioinformatics</source> <volume>14</volume>: <fpage>178</fpage>–<lpage>192</lpage>.</mixed-citation>
</ref>
<ref id="pcbi.1003703-Robinson1"><label>60</label>
<mixed-citation publication-type="journal" xlink:type="simple"><name name-style="western"><surname>Robinson</surname><given-names>JT</given-names></name>, <name name-style="western"><surname>Thorvaldsdóttir</surname><given-names>H</given-names></name>, <name name-style="western"><surname>Winckler</surname><given-names>W</given-names></name>, <name name-style="western"><surname>Guttman</surname><given-names>M</given-names></name>, <name name-style="western"><surname>Lander</surname><given-names>ES</given-names></name>, <etal>et al</etal>. (<year>2011</year>) <article-title>Integrative genomics viewer</article-title>. <source>Nature biotechnology</source> <volume>29</volume>: <fpage>24</fpage>–<lpage>26</lpage>.</mixed-citation>
</ref>
</ref-list></back>
</article>